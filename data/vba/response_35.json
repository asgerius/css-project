[{"tags": ["excel", "vba", "pivot-table", "show", "details"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 3220527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ff67537404b5aec4f63d2bfed802061a?s=128&d=identicon&r=PG&f=1", "display_name": "CJK", "link": "https://stackoverflow.com/users/3220527/cjk"}, "edited": false, "score": 0, "creation_date": 1441889781, "post_id": 32492486, "comment_id": 52864213, "body": "Thank you for the response!  I changed the script to your suggestion, however I still receive a compiling error for the name of the routine (I derived the <code>ShowDetails</code> from recording a macro and double-clicking on a PivotTable as a test).  Is there anything else that would make this BeforeDoubleClick procedure execute properly?"}], "tags": [], "owner": {"reputation": 2017, "user_id": 1698517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/366044619e6cb2094c95d889cb75a827?s=128&d=identicon&r=PG", "display_name": "Jaycal", "link": "https://stackoverflow.com/users/1698517/jaycal"}, "is_accepted": false, "score": 0, "last_activity_date": 1441854645, "creation_date": 1441854645, "answer_id": 32492486, "question_id": 32490712, "link": "https://stackoverflow.com/questions/32490712/pivottable-show-details-destination/32492486#32492486", "title": "PivotTable Show Details Destination", "body": "<p>Couple things...</p>\n\n<ol>\n<li>I believe it should be <code>ShowDetail</code>, not <code>ShowDetails</code>. </li>\n<li><code>ShowDetail</code>\nis a property that needs to be set to True if you want to display\nthe data for the selected cell.</li>\n</ol>\n\n<p>The following line should work.</p>\n\n<pre><code>Selection.ShowDetail = True\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 3220527, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ff67537404b5aec4f63d2bfed802061a?s=128&d=identicon&r=PG&f=1", "display_name": "CJK", "link": "https://stackoverflow.com/users/3220527/cjk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 272, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441854645, "creation_date": 1441841409, "last_edit_date": 1441841591, "question_id": 32490712, "link": "https://stackoverflow.com/questions/32490712/pivottable-show-details-destination", "title": "PivotTable Show Details Destination", "body": "<p>I know this may be solved with a more complicated script, but I simply want to have the <code>.ShowDetails</code> action for <strong>any</strong> PivotTable in my workbook (I have 15+) to send the associated data for a particular Pivot Item to a designated worksheet every time.  I have this script, but I believe I have coded something incorrectly (I am receiving a procedure declaration compiling error when I attempt to execute it).</p>\n\n<pre><code>Sub Workbook_SheetBeforeDoubleClick()\n\nDim WS As Worksheet\n\nIf Application.Range(ActiveCell.Address).PivotCell.PivotCellType = xlPivotCellValue Then\n    For Each WS In ThisWorkbook.Worksheets\n        If WS.Name = \"PivotTable Details\" Then\n        WS.Delete\n        End If\n    Next WS\n    Selection.ShowDetails\n    ActiveSheet.Name = \"PivotTable Details\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "loops", "hyperlink"], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 5, "last_activity_date": 1441840096, "creation_date": 1441840096, "answer_id": 32490530, "question_id": 32490379, "link": "https://stackoverflow.com/questions/32490379/loop-adding-hyperlinks-referencing-correct-cell-coordinates-but-on-the-wrong-she/32490530#32490530", "title": "Loop adding hyperlinks referencing correct cell coordinates but on the wrong sheet", "body": "<p>There are two issues in your code</p>\n\n<ol>\n<li><p>When using a <code>Range</code> object, it already includes the worksheet context, so for example rather than <code>Sheets(\"Main\").W2</code> use just <code>W2</code></p></li>\n<li><p>The <code>Hyperlinks.Add</code> method, <code>SubAddress</code> parameter needs to be a address string, including the worksheet reference.  So for example rather than <code>SubAddress:=R2</code> use <code>SubAddress:=R2.Address(External:=True)</code></p></li>\n</ol>\n\n<p>Putting this together, your Hyperlink code should be</p>\n\n<pre><code>Sh.Hyperlinks.Add Anchor:=R2, Address:=\"\", _\n  SubAddress:=W2.Address(External:=True), TextToDisplay:=R2.Value\n\nSheets(\"Main\").Hyperlinks.Add Anchor:=W2, Address:=\"\", _\n  SubAddress:=R2.Address(External:=True), TextToDisplay:=W2.Value\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 5266096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70c27aec6f2da767153e320f18171e94?s=128&d=identicon&r=PG&f=1", "display_name": "JP Krause", "link": "https://stackoverflow.com/users/5266096/jp-krause"}, "edited": false, "score": 0, "creation_date": 1441897317, "post_id": 32492653, "comment_id": 52870042, "body": "Works great, thank you! Interesting to see how you organized the code as well, it looks much cleaner."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 25, "user_id": 5266096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70c27aec6f2da767153e320f18171e94?s=128&d=identicon&r=PG&f=1", "display_name": "JP Krause", "link": "https://stackoverflow.com/users/5266096/jp-krause"}, "edited": false, "score": 0, "creation_date": 1441897938, "post_id": 32492653, "comment_id": 52870489, "body": "I made a small update to include the sheet name in <code>adr</code> - this will properly reference the cells in each sheet (this was the extra issue, and I  think I removed it at some point while testing)"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 1, "last_activity_date": 1441897706, "last_edit_date": 1441897706, "creation_date": 1441855661, "answer_id": 32492653, "question_id": 32490379, "link": "https://stackoverflow.com/questions/32490379/loop-adding-hyperlinks-referencing-correct-cell-coordinates-but-on-the-wrong-she/32492653#32492653", "title": "Loop adding hyperlinks referencing correct cell coordinates but on the wrong sheet", "body": "<p>Solutions from chris's answer applied to the code, plus an additional one:</p>\n\n<pre><code>Option Explicit\n\nSub hyperlinkinsert()\n   Dim wsC As Worksheet, wsM As Worksheet, celC As Range, celM As Range, adr As String\n\n   Set wsM = ThisWorkbook.Worksheets(\"Main\")\n\n   For Each wsC In ThisWorkbook.Worksheets\n      If wsC.Index &gt; 3 Then\n\n         Set celM = wsM.UsedRange.Find(What:=wsC.Cells(1, 1).Text)\n         Set celC = wsC.UsedRange.Find(What:=\"Chosen Value\")\n\n         If Not celM Is Nothing And Not celC Is Nothing Then\n\n            Set celM = celM.Offset(0, 2)\n            Set celC = celC.Offset(0, 1)\n\n            adr = \"'\" &amp; wsC.Name &amp; \"'!\" &amp; wsC.Cells(1, 1).Address\n\n            celC.Formula = \"=Index(Main!H12:H284,Match(\" &amp; adr &amp; \",Main!F12:F284,0))\"\n\n            If Not IsError(celC) Then\n               wsC.Hyperlinks.Add celC, \"\", celM.Address(External:=True)\n               wsM.Hyperlinks.Add celM, \"\", celC.Address(External:=True)\n            End If\n         End If\n      End If\n   Next\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Assuming: value for Cell A1 in the formula should be extracted from the current sheet</p>\n"}], "owner": {"reputation": 25, "user_id": 5266096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70c27aec6f2da767153e320f18171e94?s=128&d=identicon&r=PG&f=1", "display_name": "JP Krause", "link": "https://stackoverflow.com/users/5266096/jp-krause"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 967, "favorite_count": 0, "accepted_answer_id": 32492653, "answer_count": 2, "score": 1, "last_activity_date": 1441897706, "creation_date": 1441839045, "question_id": 32490379, "link": "https://stackoverflow.com/questions/32490379/loop-adding-hyperlinks-referencing-correct-cell-coordinates-but-on-the-wrong-she", "title": "Loop adding hyperlinks referencing correct cell coordinates but on the wrong sheet", "body": "<p>This code is meant to find a cell on the current sheet that corresponds to a cell on the 'Main' sheet, then insert hyperlinks that work both ways between the two cells. The actual text displayed on both hyperlinks should be the number value found in the cell on the 'Main' sheet.</p>\n\n<p>I keep running into two problems:</p>\n\n<p>a. 'Object not supported by this property or Method' error (line location noted below)</p>\n\n<p>b. 'inserts hyperlink to the correct coordinates but on the current sheet, instead of the 'main'</p>\n\n<p>All the examples I'm looking at online use sheet.hyperlink.add so I'm confused why I'm receiving this error using the same syntax</p>\n\n<p>Here is my code so far</p>\n\n<pre><code>Sub hyperlinkinsert()\n\nDim Sh As Worksheet\n\nDim r As Range\nDim R2 As Range\n\nDim w As Range\nDim W2 As Range\n\nDim S1 As String\nDim i As Integer\n\ni = 0\n\n    For Each Sh In ThisWorkbook.Worksheets\n\n    i = i + 1\n\n        If i &gt; 3 Then\n\n                S1 = Sh.Cells(1, 1).Text\n\n                Set r = Sh.Cells.Find(What:=\"Chosen Value\")\n\n                    If Not r Is Nothing Then\n\n                        Set R2 = r.Offset(0, 1)\n\n                        Set w = Sheets(\"Main\").Cells.Find(S1)\n\n                            If Not w Is Nothing Then\n\n                                  Set W2 = w.Offset(0, 2)\n\n\n                                      R2.Formula = \"=Index('Main'!H12:H284,Match(A1,'Main'!F12:F284,0))\"\n\n                           '**** ERROR MSG OCCURS HERE  ****\n                                      Sh.Hyperlinks.Add Anchor:=R2, Address:=\"\", _\n                                      SubAddress:=Sheets(\"Main\").W2, TextToDisplay:=R2.Value\n\n                                      Sheets(\"Main\").Hyperlinks.Add Anchor:=Sheets(\"Main\").W2, _\n                                      Address:=\"\", SubAddress:=R2, TextToDisplay:=Sheets(\"Main\").W2.Value\n\n                            End If\n\n                    End If\n\n\n                Set r = Nothing\n                Set R2 = Nothing\n                Set w = Nothing\n                Set W2 = Nothing\n\n        End If\n\n\n    Next\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1441837963, "post_id": 32489787, "comment_id": 52840953, "body": "This <a href=\"http://codereview.stackexchange.com/q/41601/36565\">question</a> and the answers over on Code Review are somewhat relevant."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1441839955, "post_id": 32489787, "comment_id": 52841574, "body": "I found that hard to read, and a bit beyond me.  However, I got something from it, I just couldn&#39;t say what right now.  I&#39;ll re-read it when I know more. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1441838418, "post_id": 32489815, "comment_id": 52841112, "body": "Also <code>&quot;&quot;</code> isn&#39;t <code>vbNullString</code>... but that&#39;s a different topic =)"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1441840222, "post_id": 32489815, "comment_id": 52841644, "body": "Oh My God fathers I though it was! Expand please."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1441840454, "post_id": 32489815, "comment_id": 52841708, "body": "Try <code>Debug.Print StrPtr(&quot;&quot;), StrPtr(vbNullString)</code> - only one of the two has an actual memory address! ;-)"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1441840604, "post_id": 32489815, "comment_id": 52841747, "body": "That&#39;s beyond me.  As is:   Debug.Print IsNull(Null), IsNull(vbNull)"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441859573, "post_id": 32489815, "comment_id": 52846365, "body": "vbNull is a VBA constant (value of 1). For me, a reliable way to convert NULLs when importing from record sets (usually strings) is to check each potential dbVal and assign it to my VBA string: <code>myStr = IIf(IsNull(dbVal), vbNullString, dbVal)</code>"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441864916, "post_id": 32489815, "comment_id": 52848330, "body": "@paulbica, the much easier equivalent is: <code>myStr = Nz(dbVal)</code> and, in case of a numeric: <code>myNumber = Nz(dbVal, 0)</code>."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441879170, "post_id": 32489815, "comment_id": 52857100, "body": "@Paul Massive thanks.  Why in gods name have I not done this before!  Except I will use Gustavs method, which is ABOUT the same.  (As vbNullString &lt;&gt; &quot;&quot; in terms of memory usage)."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441879933, "post_id": 32489815, "comment_id": 52857609, "body": "@Paul.  So would it make sense for the default value of a database text field to be EMPT STRING and prevent records from storing a NULL value in the table?   I think so (although I&#39;ve never done this!).  This way a field would only be null is an outer join has been done.  (I can&#39;t believe I&#39;m still struggling with this)"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441890462, "post_id": 32489815, "comment_id": 52864735, "body": "@Gustav - I didn&#39;t know about Nz() (I was importing in Excel). Harvey: it makes sense - I&#39;ll have to test it (haven&#39;t done it either)"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1441907609, "post_id": 32489815, "comment_id": 52876181, "body": "@Gustav  I added some code that explorers Nz to the answer above."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 10, "last_activity_date": 1441889748, "last_edit_date": 1441889748, "creation_date": 1441835961, "answer_id": 32489815, "question_id": 32489787, "link": "https://stackoverflow.com/questions/32489787/what-is-the-different-between-isnull-isempty-empty-and-an-empty-string-ie/32489815#32489815", "title": "What is the different between IsNull, IsEmpty, =Empty, and an empty string ie &quot;&quot; and why might I use variants", "body": "<p>A variant is the only type of variable that can store an empty value or a Null value, and is declared thus:</p>\n\n<pre><code>Dim aVar as Variant\nDim aVar2    '  if no type is given then it's declared as a variant\n</code></pre>\n\n<p>Immediately after declaration a variant stores no value and it is empty.\nAlso you can assign empty to a variant using <code>aVar = Empty</code> and it will be empty again. </p>\n\n<p>When a variant stores empty these are both true:</p>\n\n<pre><code>aVar = Empty   \nIsEmpty(aVar) \n</code></pre>\n\n<p>You can also set the value of a Variant variable to be Null </p>\n\n<pre><code>aVar = Null\n</code></pre>\n\n<p>These would now be false</p>\n\n<pre><code>aVar = Empty   \nIsEmpty(aVar) \n</code></pre>\n\n<p>However,  <code>IsNull(aVar)</code> would be true.</p>\n\n<p>Null is particularly useful when you use VBA variables to store data that has come from a database table that allows NULL values to be stored in it's fields. In this case it is generally advisable that all the variables need to accommodate storing NULL. So they all need to be variant as this is the only data type that stores NULL. </p>\n\n<p>This is very unfortunate as it would be better to have more strongly typed variables in use.</p>\n\n<p>A variant storing Null is not the same as a variant being Empty.  Null indicates that a value was assigned to a variable and the value was Null.   </p>\n\n<p>This gets confusing as Null is used by databases to indicate no value has been stored in a field, and most databases allow fields with any datatype to be Null.  When a database field stores Null, it is kind of the equivalent to a VBA variant variable having just been declared as \u201creceptacle\u201d for a value and not yet being given a value.  The variable, just like the table field is an receptacle without anything in it.  </p>\n\n<p>However, if a VBA variant variable is given a Null value from a database table, then it stores the fact that it is Null, as this is different to it never having been given a value and is information your program might want to treat differently.</p>\n\n<p>Also note that a variant storing and empty string \"\" is not the same as being empty.</p>\n\n<p>ie \"\" does not equal Empty (and it is not the same as Null either!)</p>\n\n<p>When using MS Access tables to store text, I would advise against setting the \"Allow Zero Length\" field property to true, which is the default setting, as this means your database field will be able to store \"\" (ie an empty string) as well as a Null value.  Any code you write then has to work with the possibility that the field will store a \"\" or a Null.  It's easier just to work with a Null.</p>\n\n<p>(It's very rare to need to store an empty string in a database table).</p>\n\n<p>Another useful technique is to use <code>MyString = Nz(MyStringDatabaseField)</code> to convert any nulls to be an empty string.  At least then your code only has to test for empty strings and not for Nulls as well.   This technique will also simplify code working with access tables that store empty strings.  Sometimes it may be appropriate to use `MyInteger=Nz(MyIntegerDatabaseField) to convert any nulls to 0, but I am very uncomfortable with this as 0 has a more meaning than an empty string and really Null &lt;> 0!</p>\n\n<p>Note that SQL statements which use an OUTER JOIN between their tables, can result in the returned recordset containing NULL values in fields where the underlying table field is defined to prevent NULLs being stored.  </p>\n\n<p>Note that if you do not use a variant the data types then default values may be used unexpectedly. Eg</p>\n\n<pre><code>    Dim aInt As Integer\n    aInt = Empty\n    Debug.Print aInt, \" This will print 0, as 0 is the default value for integer variables\"\n</code></pre>\n\n<p>The code below helped me to understand the difference between the various  functions that can be used to inspect variant variables</p>\n\n<pre><code>Sub ExperimentsWithVariants()\n\n    Dim aInt As Integer\n    aInt = Empty\n    Debug.Print aInt, \" This will print 0, as 0 is the default value for integer variables\"\n\n    Dim avar As Variant  ' The results shown as comments below were created when aVar was declared as a variant\n\n\n    Debug.Print \"-----------------------\"\n    Debug.Print \"NOT SET:\"\n    Debug.Print \"-----------------------\"\n    Debug.Print \"TypeName(avar)\", TypeName(avar)     ' Empty\n    Debug.Print \"aVar = Empty \", (avar = Empty)      ' True\n    Debug.Print \"aVar\", avar                         '             '' ie blank\n    Debug.Print \"IsNull(aVar)\", (IsNull(avar))       ' False\n    Debug.Print \"IsEmpty(aVar)\", (IsEmpty(avar))     ' True\n    Debug.Print \"aVar = \"\"\"\"\", (avar = \"\")           ' True\n    Debug.Print \"aVar = 0\", (avar = 0)               ' True\n\n\n    If avar = Empty Then\n        Debug.Print \" \"\n        Debug.Print \"avar = Empty so the above would be the same if you set avar = Empty explicitly\"\n        Debug.Print \" \"\"\"\n    Else\n        avar = Empty\n        Debug.Print \" \"\n        Debug.Print \"-----------------------\"\n        Debug.Print \" SET TO Empty\"\n        Debug.Print \"-----------------------\"\n        Debug.Print \"TypeName(avar)\", TypeName(avar)     ' Empty\n        Debug.Print \"aVar = Empty \", (avar = Empty)      ' True\n        Debug.Print \"aVar\", avar                         '            '' ie blank\n        Debug.Print \"IsNull(aVar)\", (IsNull(avar))       ' False\n        Debug.Print \"IsEmpty(aVar)\", (IsEmpty(avar))     ' True\n        Debug.Print \"aVar = \"\"\"\"\", (avar = \"\")           ' True\n        Debug.Print \"aVar = 0\", (avar = 0)               ' True\n    End If\n\n    avar = Null\n    Debug.Print \" \"\n    Debug.Print \"-----------------------\"\n    Debug.Print \" SET TO NULL\"\n    Debug.Print \"-----------------------\"\n    Debug.Print \"TypeName(avar)\", TypeName(avar)     ' Null\n    Debug.Print \"aVar = Empty \", (avar = Empty)      ' Null\n    Debug.Print \"aVar\", avar                         ' Null\n    Debug.Print \"IsNull(aVar)\", (IsNull(avar))       ' True\n    Debug.Print \"IsEmpty(aVar)\", (IsEmpty(avar))     ' False\n    Debug.Print \"aVar = \"\"\"\"\", (avar = \"\")           ' Null\n    Debug.Print \"aVar = 0\", (avar = 0)               ' Null\n\n\n    avar = \"\"\n    Debug.Print \" \"\n    Debug.Print \"-----------------------\"\n    Debug.Print \" SET TO EMPTY STRING ie \"\"\"\"\"\n    Debug.Print \"-----------------------\"\n    Debug.Print \"TypeName(avar)\", TypeName(avar)     '\n    Debug.Print \"aVar = Empty \", (avar = Empty)      ' True\n    Debug.Print \"aVar\", avar                         '            '' ie blank\n    Debug.Print \"IsNull(aVar)\", (IsNull(avar))       ' False\n    Debug.Print \"IsEmpty(aVar)\", (IsEmpty(avar))     ' False\n    Debug.Print \"aVar = \"\"\"\"\", (avar = \"\")           ' True\n    Debug.Print \"aVar = 0\", (avar = 0)               ' String\n    ' Note\n    ' Is empty returns false, whereas =\"\" returns NULL\n\n\n    avar = 1.23\n    Debug.Print \"-----------------------\"\n    Debug.Print \"SET to 1.23:\"\n    Debug.Print \"-----------------------\"\n    Debug.Print \"TypeName(avar)\", TypeName(avar)     ' Double\n    Debug.Print \"aVar = Empty \", (avar = Empty)      ' True\n    Debug.Print \"aVar\", avar                         '             '' ie blank\n    Debug.Print \"IsNull(aVar)\", (IsNull(avar))       ' False\n    Debug.Print \"IsEmpty(aVar)\", (IsEmpty(avar))     ' True\n    Debug.Print \"aVar = \"\"\"\"\", (avar = \"\")           ' True\n    Debug.Print \"aVar = 0\", (avar = 0)               ' True\n\n\n    ' You can test for both an IsEmpty AND an empty string (ie \"\" ) AND a null value with:\n\n    ' IIf(Len(avar &amp; vbNullString)\n\n    Debug.Print \"-----------------------\"\n    Debug.Print \"Using IIf(Len(avar &amp; vbNullString) \"\n    Debug.Print \"-----------------------\"\n    avar = \"\"\n    Debug.Print \"\"\"\"\"=\", IIf(Len(avar &amp; vbNullString) = 0, \"Null, IsEmpty, or Empty String\", \"NOT\")\n    avar = \"1\"\n    Debug.Print \"1 = \", IIf(Len(avar &amp; vbNullString) = 0, \"Null IsEmpty,or Empty String\", \"NOT\")\n    avar = Null\n    Debug.Print \"Null = \", IIf(Len(avar &amp; vbNullString) = 0, \"Null, IsEmpty or Empty String\", \"NOT\")\n    avar = Empty\n    Debug.Print \"Empty = \", IIf(Len(avar &amp; vbNullString) = 0, \"Null or Empty String\", \"NOT\")\n\n\n\n    Debug.Print \"-----------------------\"\n    Debug.Print \"using TypeName\"\n    Debug.Print \"-----------------------\"\n    Dim dbl1 As Double\n    Debug.Print \"TypeName(dbl1) \", TypeName(dbl1)    ' Double\n    Dim int1 As Integer\n    Debug.Print \"TypeName(int1) \", TypeName(int1)    ' Integer\n    Dim str1 As String\n    Debug.Print \"TypeName(str1) \", TypeName(str1)    ' String\n\nEnd Sub\n\n\nSub ExperimentsWithNz()\n\n    Debug.Print \" \"\n    Debug.Print \"---------------------------------------------------------------------- \"\n    Debug.Print \"---------------------------------------------------------------------- \"\n    Debug.Print \"1a  Nz(Null)=\"\"\"\"          =\", Nz(Null) = \"\"\n    Debug.Print \"1b  IsNull(Nz(Null))     =\", IsNull(Nz(Null))    ' False\n\n\n    Debug.Print \"---------------------------------------------------------------------- \"\n    Dim aVar As Variant\n\n    Debug.Print \"2a  Nz(aVar) Unassigned  =\", Nz(aVar)      ' Null\n\n    aVar = Empty\n    Debug.Print \"2b  Nz(aVar) Empty       =\", Nz(aVar)      ' Null\n\n    aVar = Null\n    Debug.Print \"2c  Nz(aVar) Null        =\", Nz(aVar)      ' Null\n    Debug.Print \"2d  IsNull(Nz(aVar)) Null=\", (IsNull(Nz(aVar)))      ' Null\n\n    aVar = \"\"\n    Debug.Print \"2e  Nz(aVar) \"\"\"\"          =\", Nz(aVar)      '         ' ie an empty string\n\n\n\n    Debug.Print \"---------------------------------------------------------------------- \"\n    Dim str1 As String\n\n    Debug.Print \"3a  Nz(str1) Unassigned =\", Nz(str1)      ' 0\n    str1 = Empty\n    Debug.Print \"3b  Nz(str1) Empty      =\", Nz(str1)      ' 0\n\n\n    Debug.Print \"---------------------------------------------------------------------- \"\n    Dim int1 As Integer\n\n    Debug.Print \"4a Nz(int1) Unassigned  =\", Nz(int1)      ' 0\n\n    int1 = Empty\n    Debug.Print \"5b Nz(int1) Empty       =\", Nz(int1)      ' 0\n\n    ' The following line cannot run as a string cannot be assigned Null\n    ' str1 = Null\n\nEnd Sub\n\n\nSub DealingWithEmptyStringsInADatabaseTable()\n\n    Dim aVar As Variant\n\n\n    Debug.Print \"UNdeclared: \", Nz(aVar, 1)\n\n    aVar = Empty\n    Debug.Print \"aVar=Empty \", Nz(aVar, 1)\n\n    aVar = Null\n    Debug.Print \"aVar=Null \", Nz(aVar, 1)\n\n    aVar = \"\"\n    Debug.Print \"aVar=\"\"\"\" \", Nz(aVar, 1)\n\n    Debug.Print \" -------------------------------------------------------\"\n    Debug.Print \"Dealing with empty string in a database table\"\n    aVar = \"\"\n    Debug.Print \"IIf(aVar = \"\", 1, 0) \", IIf(aVar = \"\", 1, 0)\n\n    Debug.Print \" \"\n    Debug.Print \" \"\n    Debug.Print \"-------------------------------------------------------\"\n    Debug.Print \"Dealing with a table field that can have Null or an Empty string\"\n    Debug.Print \"leads to more complex code than if is just stores NULL.\"\n    Debug.Print \" \"\n    Debug.Print \"The code below shows WHY you should set the \"\"; Allow Zero Length \"\" property of access tables to false\"\n    Debug.Print \" \"\n\n    aVar = Null\n    Debug.Print \"1 Null        : IIf(Nz(aVar &amp; \"\"\"\" ,\"\"\"\") = \"\"\"\", 1, 0) \", IIf(aVar &amp; \"\" = \"\", 1, 0)\n    aVar = \"\"\n    Debug.Print \"2 Empty String: IIf(Nz(aVar &amp; \"\"\"\" ,\"\"\"\") = \"\"\"\", 1, 0) \", IIf(aVar &amp; \"\" = \"\", 1, 0)\n\n    Debug.Print \" \"\n    Debug.Print \"Both lines 1 and 2 above work.\"\n    Debug.Print \" \"\n    Debug.Print \" \"\n\n    aVar = Null\n    Debug.Print \"3 Null         : Nz(aVar, 1) \", Nz(aVar, 1)\n    aVar = \"\"\n    Debug.Print \"4 Empty String:  Nz(aVar, 1) \", Nz(aVar, 1)\n\n    Debug.Print \" \"\n    Debug.Print \"however, line 4 does not work for empty string.\"\n    Debug.Print \"3 &amp; 4 are much simpler than 1 &amp; 2, but if your field can store \"\"\"\" and Null\"\n    Debug.Print \"you have to use 1 &amp; 2. Which is a shame as 3 &amp; 4 are simpler.\"\n    Debug.Print \"Queries and code accessing this data can get messy\"\n\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1441842100, "post_id": 32490688, "comment_id": 52842118, "body": "Good point about ALL fields on the OUTER side of a OUTER JOIN in a query potentially coming back as NULL and therefore variables needing to be declared as a variant. About empty strings.   If someone is filling in a form and wants 0 eggs they enter 0.  If someone leaves the &quot;I want eggs control empty&quot; a Null is stored.   However, if they fill in their middle name it&#39;s stored.  If they don&#39;t want to fill it in, it&#39;s left blank.  If they don&#39;t have a middle name they leave it blank too."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1441842164, "post_id": 32490688, "comment_id": 52842131, "body": "So on a form they might need to tick a &quot;I have no middle check name box&quot; to indicate the meaning of the Null which causes an empty string to be stored in the middle name indicating they don&#39;t have one. They you get crappy code to handle it.  I prefer just to have the checkbox linked to another field named &quot;I don&#39;t have a middle name&quot;.  I hate storing empty strings in databases. Always troble.  You can&#39;t &quot;see&quot; that they are there."}, {"owner": {"reputation": 4269, "user_id": 567326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ecb18cd54a1e3a9b76ffdd59d412a?s=128&d=identicon&r=PG", "display_name": "rskar", "link": "https://stackoverflow.com/users/567326/rskar"}, "reply_to_user": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1441843779, "post_id": 32490688, "comment_id": 52842504, "body": "One last thing for tonight, about &quot;Allow Zero Length String&quot;: <a href=\"http://bytes.com/topic/access/answers/892927-allow-zero-length-yes-no\" rel=\"nofollow noreferrer\">bytes.com/topic/access/answers/892927-allow-zero-length-yes-&zwnj;&#8203;no</a>"}], "tags": [], "owner": {"reputation": 4269, "user_id": 567326, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/977ecb18cd54a1e3a9b76ffdd59d412a?s=128&d=identicon&r=PG", "display_name": "rskar", "link": "https://stackoverflow.com/users/567326/rskar"}, "is_accepted": false, "score": 4, "last_activity_date": 1441842488, "last_edit_date": 1441842488, "creation_date": 1441841229, "answer_id": 32490688, "question_id": 32489787, "link": "https://stackoverflow.com/questions/32489787/what-is-the-different-between-isnull-isempty-empty-and-an-empty-string-ie/32490688#32490688", "title": "What is the different between IsNull, IsEmpty, =Empty, and an empty string ie &quot;&quot; and why might I use variants", "body": "<p>Adding to HarveyFrench's answer...</p>\n\n<p>The Variant of VBA gracefully handles NULL's, and it also handles Empty's. The concept of <code>Empty</code> is of debatable merit, and not represented in many database systems.</p>\n\n<p>NULL means an unobtained or unobtainable value. It was a concept made essential to the proper handling of OUTER JOIN's. An OUTER JOIN begins with a table (or subquery) that will have all of its rows selected. The condition of the JOIN is then used to link to another table (or subquery). In the case of an INNER JOIN, if the condition cannot be satisfied (i.e. resolved to TRUE) between the tables (or subqueries), then the rows of such situations do not get selected. However, in the case of an OUTER JOIN, the unsatisfied JOIN condition will still result in rows from the first table (or subquery) being selected alongside a set of NULL's for each column of the other table (or subquery). These NULL's would signal the failure of the JOIN; these would be the unobtainable values.</p>\n\n<p>An \"Empty\" isn't the same as a NULL. NULL means unobtained. \"Empty\" means \"this field is intentionally blank.\" It's a subtle difference, but an \"Empty\" is somthing definitive, whereas a NULL is something left unknown. An intentional blank is deliberate, not a mistake, unambiguously there specifically to mean there is nothing to find in the first place. </p>\n\n<p>Some folks may intentionally employ NULL to indicate an \"Empty\" for a column; or they may use NULL to indicate something else other than the unobtainable. There are some folks who would say using NULL in this way is bad practice. The reasoning to this is that now there isn't a clear way to distinguish the intentionally blank from the unknown, and you may confuse yourself in complicated queries. I would say to that \"just be careful, and are you sure that NULL is the best or only way to make it all work?\"</p>\n\n<p>As for the empty string, the <code>\"\"</code>, that is very much a value. As in something definitively known. It is also a specific datatype - namely that of a string (or text or varchar or whatever an array of characters may be taken as). Call it an \"Empty\" is you wish, although really it's limited to where strings are expected. In practice it may amount to the same thing. But it's not really \"Empty\", and it is most certainly not NULL.</p>\n\n<p>Personally I regard NULL as more of a signal, like \"not-a-number\" conditions you may encounter in floating point numbers. In other words, NULL isn't a particular value. It's the signal of not having a value. When you look up three-valued logic (3VL), particularly where SQL and NULL get involved, you'll better understand why the condition <code>NULL=NULL</code> simply isn't TRUE.</p>\n\n<p>\"Empty\" is also a signal, but a signal of \"whatever amounts to the same as a blank.\" Hence, the conditions EMPTY=\"\" and EMPTY=0 will both be TRUE - even though <code>\"\"=0</code> probably won't compute.</p>\n"}], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11564, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1594651685, "creation_date": 1441835804, "last_edit_date": 1594651685, "question_id": 32489787, "link": "https://stackoverflow.com/questions/32489787/what-is-the-different-between-isnull-isempty-empty-and-an-empty-string-ie", "title": "What is the different between IsNull, IsEmpty, =Empty, and an empty string ie &quot;&quot; and why might I use variants", "body": "<p>I'm trying to understand what a Null is and also what an Empty variable is.  Are they the same?  How do empty strings fit in?  </p>\n\n<p>When creating MS Access tables why do fields have an option of \"Allow Zero Length String\"?  </p>\n\n<p>I've been struggling with loading data from an Access database into variables (eg using DAO or ADO) and I find myself having to declare all the variables I use a Variant.  This seems so wrong to me.</p>\n\n<p>Does anyone have any good example code that demonstrates how these differ and can you explain why I might use a variant.</p>\n\n<p>Can anyone advise.  </p>\n\n<p>(I have posted my own answer with lots of simple example code that has helped me. It shows how lots of functions work with variants, I hope people with similar difficulties find this useful)</p>\n"}, {"tags": ["html", "vba", "iframe", "web-scraping"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441845009, "post_id": 32489504, "comment_id": 52842782, "body": "If you cannot provide the credentials to reach the web page you are trying to scrape then at least provide a web page URL that duplicates the situation but is openly available to the general public without credentials."}, {"owner": {"reputation": 11, "user_id": 5318548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d803af0d3f341d82c6438c577317874?s=128&d=identicon&r=PG&f=1", "display_name": "RayK", "link": "https://stackoverflow.com/users/5318548/rayk"}, "edited": false, "score": 0, "creation_date": 1441960771, "post_id": 32489504, "comment_id": 52896028, "body": "Jeeped, thanks for the direction. This was the first time I have used Stack and I wasn&#39;t quite sure what to include."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1530359181, "creation_date": 1530359181, "answer_id": 51114604, "question_id": 32489504, "link": "https://stackoverflow.com/questions/32489504/get-data-in-a-script-tag-within-an-iframe-inside-a-web-page-using-vba/51114604#51114604", "title": "Get data in a script tag within an iframe inside a web page using VBA", "body": "<p>Can't see your <code>script</code> tag in the above.</p>\n\n<p>You could start with </p>\n\n<pre><code>Dim a As Object\nSet a = ie.document.frames(\"reportFrame\").document.querySelector(\"#ln\")\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Set a = ie.document.frames(\"reportFrame\").document.querySelector(\"#ln script\")\n</code></pre>\n\n<p>This is based on grabbing first match. Look into <code>.querySelector</code> all to return a <code>nodeList</code> if expecting more than one and requiring an element other than the first.</p>\n\n<p>See the following answer to a SO question for more discussion: \n <a href=\"https://stackoverflow.com/a/44952913/6241235\">Accessing object in iframe using VBA</a></p>\n"}], "owner": {"reputation": 11, "user_id": 5318548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d803af0d3f341d82c6438c577317874?s=128&d=identicon&r=PG&f=1", "display_name": "RayK", "link": "https://stackoverflow.com/users/5318548/rayk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1640, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1563268957, "creation_date": 1441834353, "last_edit_date": 1563268957, "question_id": 32489504, "link": "https://stackoverflow.com/questions/32489504/get-data-in-a-script-tag-within-an-iframe-inside-a-web-page-using-vba", "title": "Get data in a script tag within an iframe inside a web page using VBA", "body": "<p>I am using VBA to scrape data from an html document. The document has an iframe within it.  I can use the web browser's \"inspect element\" an see the text; however, I cannot get to it with VBA.    Here is the code, I am using, it has worked well with other elements.    </p>\n\n<pre><code>Sub NewMain()\n\nDim i As Integer\nDim IE As InternetExplorer\n\nDim sc As MSHTML.IHTMLElementCollection\nDim scObj As MSHTML.IHTMLGenericElement\n\nSet objShell = CreateObject(\"Shell.Application\")\nIE_count = objShell.Windows.Count\nDebug.Print \"ie count \" &amp; IE_count\nFor x = 0 To (IE_count - 1)\n   On Error Resume Next    \n     my_URL = objShell.Windows(x).Document.Location\n     my_title = objShell.Windows(x).Document.title\n\n\n If my_URL like \"http://www.loopnet.com/xNet/Mainsite/Report/Report.aspx?\"      &amp; \"*\" Then\n\n       Debug.Print \"You have the document\"\n       Set IE = objShell.Windows(x)\n       Set mydoc = IE.Document\n\n       Set sc = mydoc.getElementsByTagName(\"script\")\n           For Each scObj In sc\n                Debug.Print scObj.innerText\n           Next\n\n\n   End If\nNext\n\n\nEnd Sub\n</code></pre>\n\n<p>The html that I am trying to read is below.  I am trying to get the data in a script tag that is inside the body element; although, I am also thinking the I can just access the html class=\"dj_ie je_ie10 dj_contentbox\" id=\"ln\" item.  However, I am at a loss on how to do it. Any help would be greatly appreciated. </p>\n\n<pre><code>    &lt;iframe name=\"reportFrame\" width=\"1100\" height=\"1100\" class=\"report-  \n     frame\" id=\"reportFrame\" src=\"http://reporting.loopnet.com\"\n     frameborder=\"0\" scrolling=\"no\" style=\"height: 2530px;\"&gt;&lt;/iframe&gt;\n\n     &lt;!DOCTYPE html&gt;\n     &lt;html class=\"dj_ie dj_ie10 dj_contentbox\" id=\"ln\"&gt;\n       &lt;head&gt;...&lt;/head&gt;\n       &lt;body&gt;...&lt;/body&gt;\n     &lt;/html&gt;\n    &lt;/iframe&gt;\n</code></pre>\n\n<p>the primary website is open source.  LoopNet.com  they list real estate for sale and lease. looking at the site, you select properties interest, then, you click \"create a report\".  This html snippet and what I am trying to scrape the data from is the \"listing comparison report\". </p>\n"}, {"tags": ["excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "edited": false, "score": 0, "creation_date": 1441837347, "post_id": 32489388, "comment_id": 52840737, "body": "What you could use is ActiveWorkbook.Worksheets(&quot;Mutual Funds&quot;).UsedRange.Address to determine how big the data is. I am guessing that you only need one range and want to sort all the data by something. Why do you specify multiple ranges? Do you need to sort by more than one vale?"}, {"owner": {"reputation": 27, "user_id": 5112374, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MJNMeu76Wt0/AAAAAAAAAAI/AAAAAAAAAqI/Gu6W92WNsiY/photo.jpg?sz=128", "display_name": "Byron LaFleur", "link": "https://stackoverflow.com/users/5112374/byron-lafleur"}, "reply_to_user": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "edited": false, "score": 0, "creation_date": 1441837997, "post_id": 32489388, "comment_id": 52840965, "body": "I was hoping to do a multi level sort. So that it would sort by column A first and formost, but then if there were duplicates, it would also sort column J, and then column H"}, {"owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "edited": false, "score": 0, "creation_date": 1441838726, "post_id": 32489388, "comment_id": 52841215, "body": "I don&#39;t believe the sort function works like that unless you are willing to ignore the data next to column A. For example if cell A1 has &quot;this&quot; in it and B1 has &quot;that&quot; in it A2 has &quot;A&quot; in it and B2 has &quot;Z&quot; in it. If you sort by column A ascending and do not include B column it will have &quot;A&quot; in cell A1 and &quot;this&quot; in cell A2. The B column will remain unchanged. Is this ok?"}], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 0, "last_activity_date": 1441844753, "creation_date": 1441844753, "answer_id": 32491151, "question_id": 32489388, "link": "https://stackoverflow.com/questions/32489388/sort-by-variable-range/32491151#32491151", "title": "Sort by variable Range", "body": "<p>Using <code>Range(\"Account\")</code> to reference a <code>Range</code> variable is wrong.</p>\n\n<p>Just use <code>Account</code></p>\n\n<p>Other issues:</p>\n\n<ul>\n<li>The <code>Key</code>'s need to exclude the header, </li>\n<li>Your method of getting the used ranges is highly inefficient.</li>\n</ul>\n\n<p>Here's your code refactored :</p>\n\n<pre><code>Sub Macro1()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim Account As Range\n    Dim Symbol As Range\n    Dim Quantity As Range\n    Dim EntireRange As Range\n\n    Set wb = ActiveWorkbook\n    Set ws = wb.Sheets(\"Mutual Funds\")\n\n    With ws\n        Set Account = .Range(.Cells(12, 1), .Cells(12, 1).End(xlDown))\n    End With\n    Set Symbol = Account.Offset(, 8)\n    Set Quantity = Account.Offset(, 6)\n    Set EntireRange = Account.Offset(-1, 0).Resize(Account.Rows.Count + 1, 45)\n\n    With ws.Sort ' EntireRange\n        .SortFields.Clear\n        .SortFields.Add Key:=Account, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortTextAsNumbers\n        .SortFields.Add Key:=Symbol, SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n        .SortFields.Add Key:=Quantity, SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n\n        .SetRange EntireRange\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5112374, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MJNMeu76Wt0/AAAAAAAAAAI/AAAAAAAAAqI/Gu6W92WNsiY/photo.jpg?sz=128", "display_name": "Byron LaFleur", "link": "https://stackoverflow.com/users/5112374/byron-lafleur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2296, "favorite_count": 0, "accepted_answer_id": 32491151, "answer_count": 1, "score": 0, "last_activity_date": 1441844753, "creation_date": 1441833805, "last_edit_date": 1441841477, "question_id": 32489388, "link": "https://stackoverflow.com/questions/32489388/sort-by-variable-range", "title": "Sort by variable Range", "body": "<p>I want code to figure how large a table of data is, then sort it. I assumed that I would declare a variable range once I knew how large the table is and tell Excel to sort first by the variable range \"Account\" and then \"Symbol\" and then \"Quantity.\"</p>\n\n<p>The problem occurs with the <code>ActiveWorkbook.Worksheets(\"Mutual Funds\").Sort.SortFields.Add Key:=Range(\"Account\")...</code>   </p>\n\n<p>Method <em>Range of Object' Global Failed</em> is my error message. It appears that this is not the correct way to give it a variable range.  </p>\n\n<p>Anyone know how to fix this?</p>\n\n<pre><code>Sub Macro1()\n     '\nActiveWorkbook.Sheets(\"Mutual Funds\").Activate\nRange(\"A12\").Select\n\nDo Until IsEmpty(ActiveCell)\n        ActiveCell.Offset(1).Select\nLoop\n\nActiveCell.Offset(-1).Select\n\n\n Dim Account As Range\n Dim Symbol As Range\n Dim Quantity As Range\n Dim EntireRange As Range\n\n Set Account = Range(ActiveCell, \"A11\")\n Set Symbol = Range(ActiveCell.Offset(, 9), \"J11\")\n Set Quantity = Range(ActiveCell.Offset(, 7), \"H11\")\n Set EntireRange = Range(ActiveCell, \"AS11\")\n\n ActiveWorkbook.Worksheets(\"Mutual Funds\").Sort.SortFields.Clear\n ActiveWorkbook.Worksheets(\"Mutual Funds\").Sort.SortFields.Add Key:=Range(\"Account\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortTextAsNumbers\nActiveWorkbook.Worksheets(\"Mutual Funds\").Sort.SortFields.Add Key:=Range(\"Symbol\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n ActiveWorkbook.Worksheets(\"Mutual Funds\").Sort.SortFields.Add Key:=Range(\"Quantity\"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal\n\nWith ActiveWorkbook.Worksheets(\"Mutual Funds\").Sort\n    .SetRange Range(\"EntireRange\")\n    .Header = xlYes\n    .MatchCase = False\n    .Orientation = xlTopToBottom\n    .SortMethod = xlPinYin\n    .Apply\nEnd With\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1441833357, "post_id": 32489249, "comment_id": 52839184, "body": "which line is raising the error?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1441833924, "post_id": 32489249, "comment_id": 52839445, "body": "You mean two different worksheets?"}, {"owner": {"reputation": 3, "user_id": 5042955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21af74da7ba73df8b35f3cbae46108fb?s=128&d=identicon&r=PG&f=1", "display_name": "User1310", "link": "https://stackoverflow.com/users/5042955/user1310"}, "edited": false, "score": 0, "creation_date": 1441834968, "post_id": 32489249, "comment_id": 52839827, "body": "At first it was the <code>match_row</code> then I got around that when I changed that to Variant. The second error, another type mismatch came from <code>test</code>."}, {"owner": {"reputation": 3, "user_id": 5042955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21af74da7ba73df8b35f3cbae46108fb?s=128&d=identicon&r=PG&f=1", "display_name": "User1310", "link": "https://stackoverflow.com/users/5042955/user1310"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1441835166, "post_id": 32489249, "comment_id": 52839906, "body": "@Excel Hero, No, two separate workbooks. I import some data from wb1 then try to match that to Backlog and have the results &amp; imported data in my macro workbook. I then compare the values (ex. purchase orders, quantities) and the errors represent things missing in my backlog."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5042955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21af74da7ba73df8b35f3cbae46108fb?s=128&d=identicon&r=PG&f=1", "display_name": "User1310", "link": "https://stackoverflow.com/users/5042955/user1310"}, "edited": false, "score": 0, "creation_date": 1441836563, "post_id": 32489506, "comment_id": 52840462, "body": "Instead of displaying a message box, could it be changed to just display text &quot;not found&quot;? Also, how would I be able to show the results in column <code>F:F</code>? Thanks!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 3, "user_id": 5042955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21af74da7ba73df8b35f3cbae46108fb?s=128&d=identicon&r=PG&f=1", "display_name": "User1310", "link": "https://stackoverflow.com/users/5042955/user1310"}, "edited": false, "score": 0, "creation_date": 1441836645, "post_id": 32489506, "comment_id": 52840494, "body": "Well yeah you could change it to do <i>anything</i>. Display a message box, highlight a cell, open internet explorer and navigate to CNN.com (or any other website), send you an email via Outlook, etc..."}, {"owner": {"reputation": 3, "user_id": 5042955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21af74da7ba73df8b35f3cbae46108fb?s=128&d=identicon&r=PG&f=1", "display_name": "User1310", "link": "https://stackoverflow.com/users/5042955/user1310"}, "edited": false, "score": 0, "creation_date": 1441837468, "post_id": 32489506, "comment_id": 52840774, "body": "I can&#39;t figure out how to get it to display the INDEX/MATCH value in column F."}, {"owner": {"reputation": 3, "user_id": 5042955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21af74da7ba73df8b35f3cbae46108fb?s=128&d=identicon&r=PG&f=1", "display_name": "User1310", "link": "https://stackoverflow.com/users/5042955/user1310"}, "edited": false, "score": 0, "creation_date": 1441838948, "post_id": 32489506, "comment_id": 52841280, "body": "I was trying to add something like <code>Range(&quot;F2&quot;).Value</code>type of thing, so that when I run the macro, through a form control button everything populates. I already have a code to autofill my index/match results. I am making this so a coworker can literally press a button and have all the information."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 3, "user_id": 5042955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21af74da7ba73df8b35f3cbae46108fb?s=128&d=identicon&r=PG&f=1", "display_name": "User1310", "link": "https://stackoverflow.com/users/5042955/user1310"}, "edited": false, "score": 0, "creation_date": 1441840554, "post_id": 32489506, "comment_id": 52841732, "body": "What do you mean by &quot;type of thing?&quot;  Update your question with your current attempt and describe the particular problem you&#39;re experiencing. Pretend that I am your busy coworker and that I don&#39;t have time to keep asking you &quot;what do you mean by this?&quot;"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1441834359, "creation_date": 1441834359, "answer_id": 32489506, "question_id": 32489249, "link": "https://stackoverflow.com/questions/32489249/dim-variable-error-type-mismatch/32489506#32489506", "title": "Dim variable error, type mismatch?", "body": "<p>If <code>match_row</code> evaluates to an error type (Error 2042 if the match is not found), the assignment to <code>test = Application.WorksheetFunction.Index(...</code> will fail, because the right-side of the assignment statement cannot evaluate, because you're passing the <code>Error 2042</code> to the <code>Index</code> function.</p>\n\n<pre><code>If Not IsError(match_row) Then\n    test = Application.WorksheetFunction.Index(bcklog1.Range(\"J:J\"), match_row, 1)\nElse\n    MsgBox \"something\"\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5042955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21af74da7ba73df8b35f3cbae46108fb?s=128&d=identicon&r=PG&f=1", "display_name": "User1310", "link": "https://stackoverflow.com/users/5042955/user1310"}, "edited": false, "score": 0, "creation_date": 1441835470, "post_id": 32489530, "comment_id": 52840022, "body": "I didn&#39;t get any errors! But how would I get it to populate in <code>F2</code>? Or all of column <code>F:F</code>?"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1441839728, "last_edit_date": 1441839728, "creation_date": 1441834477, "answer_id": 32489530, "question_id": 32489249, "link": "https://stackoverflow.com/questions/32489249/dim-variable-error-type-mismatch/32489530#32489530", "title": "Dim variable error, type mismatch?", "body": "<p><strong>EDIT</strong> - updated to use a loop</p>\n\n<p>I'd do it this way...</p>\n\n<pre><code>Sub test()\n\n    Dim Backlog As Workbook\n    Dim bcklog1 As Worksheet\n    Set Backlog = Workbooks.Open(Filename:=\"C:\\Users\\Desktop\\Backlog.xlsx\", UpdateLinks:=0)\n    Set bcklog1 = Backlog.Worksheets(\"backlog1\")\n\n    Dim  m, test, c\n    ' adjust following range as needed\n    For each c in ActiveSheet.Range(\"A2:A200\").Cells\n        v = c.Value\n        If Len(v) &gt; 0 then\n            'note no \"worksheetfunction\" or \"no match\" will raise an error\n            m = Application.Match(v, bcklog1.Range(\"W:W\"), 0)\n\n            'instead we test for no match here...\n            If Not IsError(m) Then\n                test = bcklog1.Range(\"J:J\").Cells(m).Value\n                'Debug.Print test\n                c.offset(0, 5).Value = test 'populate colF\n            End If\n        End If 'cell has a value\n\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 5042955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21af74da7ba73df8b35f3cbae46108fb?s=128&d=identicon&r=PG&f=1", "display_name": "User1310", "link": "https://stackoverflow.com/users/5042955/user1310"}, "edited": false, "score": 0, "creation_date": 1441933357, "post_id": 32492960, "comment_id": 52886568, "body": "This also worked! Thank you, this method is interesting and I will be looking at it to figure out how it works."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 3, "user_id": 5042955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21af74da7ba73df8b35f3cbae46108fb?s=128&d=identicon&r=PG&f=1", "display_name": "User1310", "link": "https://stackoverflow.com/users/5042955/user1310"}, "edited": false, "score": 0, "creation_date": 1441933762, "post_id": 32492960, "comment_id": 52886654, "body": "You are welcome. Please do study it. There is a lot going on there with minimal code."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 0, "last_activity_date": 1441857930, "creation_date": 1441857930, "answer_id": 32492960, "question_id": 32489249, "link": "https://stackoverflow.com/questions/32489249/dim-variable-error-type-mismatch/32492960#32492960", "title": "Dim variable error, type mismatch?", "body": "<p>Here is a way that does all of the comparisons an puts them in column F.</p>\n\n<p>This method is interesting from a technical perspective because it uses no VBA loops at all:</p>\n\n<pre><code>Public Sub excelhero()\n\n    Const BACKLOG_WB = \"C:\\Users\\Desktop\\Backlog.xlsx\"\n    Const BACKLOG_WS = \"backlog1\"\n\n    Dim n&amp;, ws As Worksheet\n    Set ws = Workbooks.Open(BACKLOG_WB, 0).Worksheets(BACKLOG_WS)\n    With ThisWorkbook.ActiveSheet\n        n = .Cells(.Rows.Count, \"a\").End(xlUp).Row\n        .Range(\"f2:f\" &amp; n) = ws.Evaluate(\"transpose(transpose(index(j:j,n(if(1,match([\" &amp; .Parent.Name &amp; \"]\" &amp; .Name &amp; \"!a2:a\" &amp; n &amp; \",w:w,))))))\")\n    End With\n    ws.Parent.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5042955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21af74da7ba73df8b35f3cbae46108fb?s=128&d=identicon&r=PG&f=1", "display_name": "User1310", "link": "https://stackoverflow.com/users/5042955/user1310"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 366, "favorite_count": 1, "accepted_answer_id": 32489530, "answer_count": 3, "score": 0, "last_activity_date": 1441857930, "creation_date": 1441833150, "question_id": 32489249, "link": "https://stackoverflow.com/questions/32489249/dim-variable-error-type-mismatch", "title": "Dim variable error, type mismatch?", "body": "<p>I got this code from someone who helped me convert this excel formula to vba. The Excel formula is:\n<code>=INDEX('C:\\Users\\Desktop\\[Backlog.xlsx]backlog1'!$J:$J,MATCH(A3,'C:\\Users\\Desktop\\[Backlog.xlsx]backlog1'!$W:$W,0))</code></p>\n\n<p>The code is: </p>\n\n<pre><code>SetAttr \"C:\\Users\\Desktop\\Backlog.xlsx\", vbNormal\nDim Backlog As Workbook\nDim bcklog1 As Worksheet\nSet Backlog = Workbooks.Open(Filename:=\"C:\\Users\\Desktop\\Backlog.xlsx\", UpdateLinks:=0)\nSet bcklog1 = Backlog.Worksheets(\"backlog1\")\n\nDim result As Variant, test As Variant\nDim frml As Variant, match_row As Variant\n\nfrml = \"match(A2, \" &amp; bcklog1.Range(\"W:W\").Address(external:=True) &amp; \", 0)\"\nDebug.Print frml\nmatch_row = Evaluate(frml)\nDebug.Print match_row\n\nfrml = \"index(\" &amp; bcklog1.Range(\"J:J\").Address(external:=True) &amp; \", \" &amp; frml &amp; \")\"\nDebug.Print frml\nresult = Evaluate(frml)\n\ntest = Application.WorksheetFunction.Index(bcklog1.Range(\"J:J\"), match_row, 1)\nDebug.Print test`\n</code></pre>\n\n<p>I keep getting an error mismatch, I have changed the variables all to <code>Variant</code> and still no success. The sub should use index/match to find values between two different workbooks. Some values will not be found resulting in an \"error\", which is what I also want to find, the error will represent things I need to focus on. The results should appear in column <code>F:F</code>. I have been stuck on this for a while now, any help is appreciated. </p>\n"}, {"tags": ["vba", "outlook", "text-files"], "answers": [{"comments": [{"owner": {"reputation": 3313, "user_id": 10235442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iqWfP.png?s=128&g=1", "display_name": "Nate May", "link": "https://stackoverflow.com/users/10235442/nate-may"}, "edited": false, "score": 0, "creation_date": 1441832898, "post_id": 32489173, "comment_id": 52838964, "body": "boss says we need to automate this"}, {"owner": {"reputation": 1738, "user_id": 1342231, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MUVfk.jpg?s=128&g=1", "display_name": "Machinegon", "link": "https://stackoverflow.com/users/1342231/machinegon"}, "reply_to_user": {"reputation": 3313, "user_id": 10235442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iqWfP.png?s=128&g=1", "display_name": "Nate May", "link": "https://stackoverflow.com/users/10235442/nate-may"}, "edited": false, "score": 0, "creation_date": 1441833367, "post_id": 32489173, "comment_id": 52839190, "body": "@NateMay Maybe the message was not open in plain text mode and that&#39;s why it wraps. Look at this : <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff868727.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/EN-US/library/office/ff868727.aspx</a>"}], "tags": [], "owner": {"reputation": 1738, "user_id": 1342231, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/MUVfk.jpg?s=128&g=1", "display_name": "Machinegon", "link": "https://stackoverflow.com/users/1342231/machinegon"}, "is_accepted": false, "score": 0, "last_activity_date": 1441832812, "creation_date": 1441832812, "answer_id": 32489173, "question_id": 32489066, "link": "https://stackoverflow.com/questions/32489066/outlook-mail-saveas-oltxt-method-wraps-text-after-100-characters-how-do-i-mak/32489173#32489173", "title": "Outlook mail SaveAs (olTXT) Method wraps text after 100 characters. How do I make it longer?", "body": "<p>You can look through the message properties and build your own text file instead of relying on the SaveAs method.</p>\n"}, {"tags": [], "owner": {"reputation": 1435, "user_id": 409320, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6f5eb62ec7acc37a9401a36c93f927b3?s=128&d=identicon&r=PG", "display_name": "Walter de Jong", "link": "https://stackoverflow.com/users/409320/walter-de-jong"}, "is_accepted": false, "score": 0, "last_activity_date": 1518670596, "creation_date": 1518670596, "answer_id": 48800175, "question_id": 32489066, "link": "https://stackoverflow.com/questions/32489066/outlook-mail-saveas-oltxt-method-wraps-text-after-100-characters-how-do-i-mak/48800175#48800175", "title": "Outlook mail SaveAs (olTXT) Method wraps text after 100 characters. How do I make it longer?", "body": "<p>The question: <a href=\"https://stackoverflow.com/questions/47527988/outlook-save-message-as-text-without-line-breaks/48800032#48800032\">Outlook &quot;save message as text&quot; without line breaks</a> points to a method for Adjusting the point at which text is wrapped which gives you some control (in OL 2013 Options | Mail | Message format) In the proposed answers for that question there is a reference to <a href=\"https://forums.slipstick.com/threads/84759-line-breaks-added-to-text-file/\" rel=\"nofollow noreferrer\">another discussion of the topic</a> in which it is suggested that the FileSystem object be used instead. I haven't found a way to avoid the SaveAs including line breaks.</p>\n"}], "owner": {"reputation": 3313, "user_id": 10235442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iqWfP.png?s=128&g=1", "display_name": "Nate May", "link": "https://stackoverflow.com/users/10235442/nate-may"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 515, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1518670596, "creation_date": 1441832330, "question_id": 32489066, "link": "https://stackoverflow.com/questions/32489066/outlook-mail-saveas-oltxt-method-wraps-text-after-100-characters-how-do-i-mak", "title": "Outlook mail SaveAs (olTXT) Method wraps text after 100 characters. How do I make it longer?", "body": "<p>I use the VBA below to pull email data into a text file, but when I do the lines want to wrap after 100 characters. Since I'm scripting the resulting .txt file, this wrap makes things difficult. Is there anyway to prevent the text from wrapping or to lengthen the maximum length of the .txt file line?</p>\n\n<pre><code>Sub saveEmail(Msg As Outlook.MailItem)\nDim saveFolder As String\nDim dateFormat\nDim dtDate As Date\ndateFormat = Format(Now, \"yyyy-mm-dd \")\nsaveFolder = \"C:\\Users\\########\\AppData\\Local\\Temp\\\"\n\n  ' assume an email is selected\n  Set Msg = ActiveExplorer.Selection.Item(1)\n\n  dtDate = Msg.ReceivedTime\n   sName = Format(dtDate, \"yyyy-mm-dd\", vbUseSystemDayOfWeek, _\n    vbUseSystem) &amp; Format(dtDate, \" (hh-nn-ss)\", _\n    vbUseSystemDayOfWeek, vbUseSystem)\n\n  ' save as text\n  Msg.SaveAs saveFolder &amp; \"\\\" &amp; \"New Matter Report.txt\", olTXT\n  Call SendMessage\nEnd Sub\n</code></pre>\n"}, {"tags": ["macos", "vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1441830903, "post_id": 32488646, "comment_id": 52837939, "body": "The macro recorder is usually a great tool for figuring out these API&#39;s."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1441831607, "post_id": 32488646, "comment_id": 52838270, "body": "This looks like: &quot;I want someone to develop a solution for me&quot; sort of question, which are generally frowned upon here unless they&#39;re extraordinarily simple (i.e., obvious runtime error, etc.).  Consider providing your VBA code attempts, and indicate <i>specific</i> problems you&#39;re encountering, not just &quot;show me how to do the full-blown solution&quot;.  Cheers."}, {"owner": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1441834809, "post_id": 32488646, "comment_id": 52839750, "body": "@DavidZemens Sorry, I figured for the meager amount of code it takes, that it wouldn&#39;t be worth seeing what I failed on. I&#39;ll post it up now."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "edited": false, "score": 0, "creation_date": 1441897052, "post_id": 32490820, "comment_id": 52869858, "body": "Awesome, that answered all of my fundamental questions and I was able to manipulate the ranges to where my data is. The main thing I was failing on then was the Axes Names, because I could get Series Collection to work, but couldn&#39;t get all the data and still get Axes without messing it up.  However, I do have a couple of questions regarding the solution so I understand it for the future. Why use the Shape/Chart objects instead of just Add.Chart, what benefit do they have? Why set everything to Nothing at the end? Is there a property that modifies the order of the Series or Columns themselves?"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "edited": false, "score": 0, "creation_date": 1441900392, "post_id": 32490820, "comment_id": 52872053, "body": "@S. Cannon. <b>Re Shape/Chart vs Add.Chart</b>: either way should work fine --- it&#39;s mostly a question of style. <b>Re setting Objects to Nothing</b>: VBA is supposed to do that automatically, but several years ago I had a VBA project with lots of objects that exhibited eratic behavior. Things stabilized when I cleaned up my objects, so I&#39;ve been doing it ever since (probably over-cautious)."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "edited": false, "score": 0, "creation_date": 1441901218, "post_id": 32490820, "comment_id": 52872601, "body": "@S. Cannon. <b>Re Series Order</b>: There are at least 3 ways to do this.     1. Use the Series.PlotOrder property to re-order the series.  2. Instead of .SetSourceData which adds all the series at once, you could use SeriesCollection.Add and add the series one at a time in your preferred order.  3. You could sort the data to a preferred order before making the graph. It may also be possible to re-order the items in the Legend, but I&#39;ve never tried that."}, {"owner": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "edited": false, "score": 0, "creation_date": 1441905733, "post_id": 32490820, "comment_id": 52875170, "body": "I looked up the API for SeriesCollection.Add and I can see how it can be done! Thanks for all the help."}, {"owner": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "edited": false, "score": 0, "creation_date": 1441915740, "post_id": 32490820, "comment_id": 52880597, "body": "So I ran into a problem. Some of the columns of data are empty (correctly empty). However, while the graph correctly plots all the values of the data in the range, it assigns them incorrectly. For example, Say E4-P4 are series names. E6-P6 is one set of data. E6 is empty. It correctly plots values in F6-P6, but using only the first 11 labels (E4:O4), instead of the correct labels (F4:P4), basically it assigns the empty header E4 to the first column with data, and continues from there. I tried using .DisplayBlanksAs = xlNotPlotted, but that didn&#39;t work. Any thoughts?"}, {"owner": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "edited": false, "score": 0, "creation_date": 1441921156, "post_id": 32490820, "comment_id": 52883087, "body": "Manage to be sneaky and create an array which iterated and found empty columns. Then surrounded the SeriesCollection.Name block with it to only add series names that had data. Now the only problem comes with adding additional series to the chart each time I need to update the chart for a new week&#39;s data. I&#39;d rather update than delete and remake (for efficiency). I&#39;m getting a lot of bugs with SeriesCollection.Add, primarily it not finding previous Series name schemes. Charts seem way more difficult in VBA compared to other things I&#39;ve done that seem like they should be harder but arent"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "edited": false, "score": 0, "creation_date": 1441921576, "post_id": 32490820, "comment_id": 52883282, "body": "I&#39;m not clear on what problems you&#39;re now encountering. Would it make sense to ask a new question? That might clarify what&#39;s working, what&#39;s not working, why updating with new data is hard, the buggy behavior you&#39;re seeing with adding new series, etc."}, {"owner": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "edited": false, "score": 0, "creation_date": 1441980821, "post_id": 32490820, "comment_id": 52908950, "body": "A new questions seems a bit overkill. Essentially I just want to be edit the graphs range of data after it has already been set. So in a later macro it will run, append one line of data to the source, and then the graph will need to recalculate it&#39;s source data."}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 0, "last_activity_date": 1441842127, "creation_date": 1441842127, "answer_id": 32490820, "question_id": 32488646, "link": "https://stackoverflow.com/questions/32488646/creating-a-stacked-column-graph/32490820#32490820", "title": "Creating a Stacked Column graph", "body": "<p>How about something like this:</p>\n\n<pre><code>Public Sub MakeGraph()\n    Dim ws As Excel.Worksheet\n    Dim data As Excel.Range\n    Dim x_axis_labels As Excel.Range\n    Dim series_names As Excel.Range\n    Dim sh As Excel.Shape\n    Dim ch As Excel.Chart\n    Dim I As Long\n\n    Set ws = Sheet1\n    Set data = ws.Range(\"E4:P12\")   ' Assumes the data are in E4:P12\n    Set x_axis_labels = ws.Range(\"A4:A12\")  ' Assumes the labels are in A4:A12\n    Set series_names = ws.Range(\"E2:P2\")  ' Assumes the labels are in E2:P2\n    Set sh = ws.Shapes.AddChart\n    Set ch = sh.Chart\n    With ch\n         .ChartType = xlColumnStacked\n         .SetSourceData Source:=data, PlotBy:=xlColumns\n         .HasTitle = True\n         .ChartTitle.Text = \"Weekly Report\"\n         .Axes(xlCategory, xlPrimary).CategoryNames = x_axis_labels\n\n         ' Add series names\n         For I = 1 To .SeriesCollection.Count\n            .SeriesCollection(I).Name = series_names.Cells(1, I)\n         Next I\n    End With\n\n    Set ch = Nothing\n    Set sh = Nothing\n    Set series_names = Nothing\n    Set x_axis_labels = Nothing\n    Set data = Nothing\n    Set ws = Nothing\nEnd Sub\n</code></pre>\n\n<p>Hope that helps</p>\n"}, {"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 0, "last_activity_date": 1442007634, "creation_date": 1442007634, "answer_id": 32532508, "question_id": 32488646, "link": "https://stackoverflow.com/questions/32488646/creating-a-stacked-column-graph/32532508#32532508", "title": "Creating a Stacked Column graph", "body": "<p>I take it your missing data would be a column in the range E6:P14? (I'm using E6:P14 because that's what you said first. Your code and @xidgel's later said E4:P12.)</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub MakeChart()\n  Dim rCats As Range\n  Dim rNames As Range\n  Dim rData As Range\n  Dim iCol As Long\n\n  Set rCats = ActiveSheet.Range(\"A6:A14\")\n  Set rNames = ActiveSheet.Range(\"E4:P4\")\n  Set rData = ActiveSheet.Range(\"E6:P14\")\n\n  With ActiveSheet.Shapes.AddChart(xlColumnStacked).Chart\n    Do Until .SeriesCollection.Count = 0\n      .SeriesCollection(1).Delete\n    Loop\n\n    For iCol = 1 To rData.Columns.Count\n      If WorksheetFunction.Count(rData.Columns(iCol)) &gt; 0 Then\n        ' it's not blank\n        With .SeriesCollection.NewSeries\n          .Values = rData.Columns(iCol)\n          .XValues = rCats\n          .Name = \"=\" &amp; rNames.Cells(1, iCol).Address(, , , True)\n        End With\n      End If\n    Next\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1403, "favorite_count": 0, "accepted_answer_id": 32490820, "answer_count": 2, "score": 1, "last_activity_date": 1443456004, "creation_date": 1441830703, "last_edit_date": 1443456004, "question_id": 32488646, "link": "https://stackoverflow.com/questions/32488646/creating-a-stacked-column-graph", "title": "Creating a Stacked Column graph", "body": "<p>So I've seen a couple posts on this topic, but can't seem to find a way to get it to work. My goal is to create a Stacked Column Graph using VBA with the following characteristics:</p>\n\n<ol>\n<li>Each column is based on data from a row (e.g. <code>E6:P6</code>, <code>E7:P7</code>, etc.).</li>\n<li>Each \"stack section\" is each column in that row (located at <code>E4:P4</code>)</li>\n<li>X Axes Labels are located in column A (e.g. <code>A6</code>, <code>A7</code>, etc.)</li>\n<li>Y Axes Labels dynamic based on data (non specific). </li>\n<li>Chart Title (which is the easy part - I got this).</li>\n</ol>\n\n<p>Granted I also need the legend which shows the color key used by item 2. </p>\n\n<p>This graph is one of three needed per report across 30+ reports that I generated via VBA from a raw data file. The last step to the reports is to make these graphs.\nI am able to get stacked graph created, but the biggest problem is that as the data ranges above show, there are gaps in the data. This causes split sections in the graph as well as additional labels that I don't want. Essentially I don't know how to format the graph, and reading the Object Window that pops up from typing \"ActiveChart.\" has only gotten me this far. If I know various formatting commands (alas I'm new to VBA with Excel), I can replicate it across all the charts that I need.</p>\n\n<pre><code>Dim data As Range\nSet data = Range(\"A4:P12\")\nWith Charts.Add\n     .ChartType = xlColumnStacked\n     .SetSourceData Source:=data, PlotBy:=xlColumns\n     .HasTitle = True\n     .ChartTitle.Text = \"Weekly Report\"\n     .Location Where:=xlLocationAsObject, Name:=\"Sheet1\"\nEnd With\n</code></pre>\n\n<p>Example of what I can make: \n<a href=\"http://i.imgur.com/kQ7d08q.png\" rel=\"nofollow\">Output Graph</a></p>\n\n<p>Side note about the blank data: The leftmost blank spot where a bar would be is the empty column D. Also I need to be able to edit the axes labels.</p>\n"}, {"tags": ["vba", "visio"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1443189299, "post_id": 32488401, "comment_id": 53406304, "body": "Did you ever get this figured out?"}, {"owner": {"reputation": 387, "user_id": 1951756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9a7d01d222449cc30000c1d35bcb876?s=128&d=identicon&r=PG", "display_name": "user1951756", "link": "https://stackoverflow.com/users/1951756/user1951756"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1443190943, "post_id": 32488401, "comment_id": 53407419, "body": "No, this was a request from a System Integrator I was working with but after looking around it seemed like any viable solutions were not worth the time because I had to rush through the project and clip non-essential parts. If you have a solution I&#39;d like to see it though."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1443191020, "post_id": 32488401, "comment_id": 53407468, "body": "If it was still something you were needed to solve I was going to put a bounty on it.  We&#39;ll save that for more urgent issues."}, {"owner": {"reputation": 791, "user_id": 5167180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111e003240a8e15dc9a887b022925473?s=128&d=identicon&r=PG&f=1", "display_name": "SmrtGrunt quit because Monica", "link": "https://stackoverflow.com/users/5167180/smrtgrunt-quit-because-monica"}, "edited": false, "score": 0, "creation_date": 1552669556, "post_id": 32488401, "comment_id": 97113088, "body": "I know this is an ancient question, but I just solved a similar problem by using the <code>EventDblClick</code> cell formula to launch a subroutine that populates a text rectangle in the lower left corner of the drawing and then hides it after a set amount of time. This allows me some control over the text formatting."}], "answers": [{"tags": [], "owner": {"reputation": 2368, "user_id": 683606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YugId.jpg?s=128&g=1", "display_name": "JohnGoldsmith", "link": "https://stackoverflow.com/users/683606/johngoldsmith"}, "is_accepted": false, "score": 0, "last_activity_date": 1444165249, "creation_date": 1444165249, "answer_id": 32979670, "question_id": 32488401, "link": "https://stackoverflow.com/questions/32488401/visio-vba-adding-bold-text-to-shape-comment/32979670#32979670", "title": "Visio VBA Adding Bold Text to Shape Comment", "body": "<p>You can't, as far as I'm aware.  Comment text is not formatable.</p>\n"}], "owner": {"reputation": 387, "user_id": 1951756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9a7d01d222449cc30000c1d35bcb876?s=128&d=identicon&r=PG", "display_name": "user1951756", "link": "https://stackoverflow.com/users/1951756/user1951756"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 696, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593554474, "creation_date": 1441829807, "last_edit_date": 1593554474, "question_id": 32488401, "link": "https://stackoverflow.com/questions/32488401/visio-vba-adding-bold-text-to-shape-comment", "title": "Visio VBA Adding Bold Text to Shape Comment", "body": "<p>I am writing a macro to read in rows from an excel file, create rectangles, auto-connect the rectangles, and add information to the connector screen tip from the Excel file. This is the section of code where I add the comment to the connector...</p>\n\n<pre><code>'Auto connect shapes\nDim vsoConnectorShape As Visio.Shape\nSet vsoConnectorShape = Visio.ActivePage.Shapes(\"Dynamic connector\")\nvsoConnectorShape.Text = xlWsh.Range(\"A\" &amp; r)\n\n'Populate screen tip with info from Excel\nDim PrintString As String\n\nPrintString = \"Interface #: \" + \"   \" + xlWsh.Range(\"A\" &amp; r) + vbCrLf &amp; _\n              \"Descr: \" + \"   \" + xlWsh.Range(\"B\" &amp; r) + vbCrLf &amp; _\n              \"Cat: \" + \"   \" + xlWsh.Range(\"C\" &amp; r) + vbCrLf &amp; _\n              \"Info Obj: \" + \"   \" + xlWsh.Range(\"D\" &amp; r) + vbCrLf &amp; _\n              \"Src: \" + \"   \" + xlWsh.Range(\"E\" &amp; r) &amp; _\n              \" Tgt: \" + \"   \" + xlWsh.Range(\"F\" &amp; r) + vbCrLf &amp; _\n              \"New/Changed: \" + \"   \" + xlWsh.Range(\"G\" &amp; r)\n\nvsoConnectorShape.Cells(\"Comment\").FormulaU = \"=\"\"\" &amp; PrintString &amp; \"\"\"\"\n</code></pre>\n\n<p>How do I make the labels in the comment (Interface #:, Descr:, Cat:, Info Obj, etc...) <strong>bold</strong> and leave the rest of the text as is?</p>\n"}, {"tags": ["vba", "excel", "match", "vlookup"], "answers": [{"tags": [], "owner": {"reputation": 594, "user_id": 1126927, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/d6701ce88607ae792d291de20eabf78b?s=128&d=identicon&r=PG", "display_name": "Brownish Monster", "link": "https://stackoverflow.com/users/1126927/brownish-monster"}, "is_accepted": false, "score": 0, "last_activity_date": 1451568933, "creation_date": 1451568933, "answer_id": 34547250, "question_id": 32488295, "link": "https://stackoverflow.com/questions/32488295/how-to-compare-two-worksheets-and-generate-difference-report-as-3rd-sheet/34547250#34547250", "title": "How to compare two worksheets and generate difference report as 3rd sheet?", "body": "<p>A simple function to get two ranges that are unique to two sheets.</p>\n\n<h1>VBA Code</h1>\n\n<p>This function contains two for-loops, it loops through each row on each sheet and compares the values. The values that are considered 'Unique' in sheet 1 anbd sheet 2 will be assigned to <code>outRng1</code> and <code>outRng2</code>, respectively, which you will pass as arguments (by reference). It loops until the last row on the two lists, this has it's limitations so you may want to define the last row to look at.</p>\n\n<pre><code>' Find the rows that are unique between two lists\n'   ws1     : First worksheet to look at\n'   ws2     : Second worksheet to look at\n'   col1    : The column in the first worksheet to compare values\n'   col2    : The column in the second worksheet to compare values\n'   row1    : Row to look at on sheet 1\n'   row2    : Row to look at on sheet 2\n'   outRng1 : Returns Range argument that's unique to sheet 1\n'   outRng2 : Returns Range argument that's unique to sheet 2\n'   Returns : if a unique Range has been found\nPublic Function GetUniqueRanges( _\n    ws1 As Worksheet, _\n    ws2 As Worksheet, _\n    col1 As Long, _\n    col2 As Long, _\n    row1 As Long, _\n    row2 As Long, _\n    ByRef outRng1 As Range, _\n    ByRef outRng2 As Range _\n    ) As Boolean\n\n    Dim tRow1 As Long, tRow2 As Long, endRow1 As Long, endRow2 As Long  ' Create Temp vars\n    endRow1 = ws1.Cells(1048576, col1).End(xlUp).Row                    ' Get last row in sheet 1\n    endRow2 = ws2.Cells(1048576, col2).End(xlUp).Row                    ' Get last row in sheet 2\n\n    GetUniqueRanges = False\n\n    For tRow1 = row1 To endRow1\n        For tRow2 = row2 To endRow2\n            If ws1.Cells(tRow1, col1) = ws2.Cells(tRow2, col2) Then\n                GetUniqueRanges = True\n                Set outRng1 = ws1.Range(tRow1 &amp; \":\" &amp; row1)\n                Set outRng2 = ws2.Range(tRow2 &amp; \":\" &amp; row2)\n                Exit Function\n            End If\n        Next\n    Next\n\nEnd Function\n</code></pre>\n\n<h1>Usage</h1>\n\n<p>Here's a quick to test. I had two lists on one Worksheet that goes from <code>A</code> to <code>I</code> and changed some cells. The two lists are as follows:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DGpI9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DGpI9.png\" alt=\"Showing two lists on Excel.\"></a></p>\n\n<p>The code for the test is below. It declares two ranges to pass. After calling the function these ranges will contain the rows that are unique between the two lists. It passes the <code>ActiveSheet</code> twice, as both lists are on the same sheet. <code>6</code> and <code>7</code> is the column numbers. <code>13</code> are the row numbers. After calling the function it sets <code>B1</code> and <code>B2</code> to the unique range addresses.</p>\n\n<pre><code>Public Sub test()\n    Dim UniqRng1 As Range, UniqRng2 As Range\n    If GetUniqueRanges(ActiveSheet, ActiveSheet, 6, 7, 13, 13, UniqRng1, UniqRng2) = True Then\n        Range(\"B1\") = UniqRng1.Address\n        Range(\"B2\") = UniqRng2.Address            \n    End If\nEnd Sub\n</code></pre>\n\n<h1>Limitations</h1>\n\n<p>The only limitation is it checks every cell in list two, you may want to limit this in case it comes with false positives.</p>\n"}], "owner": {"reputation": 11, "user_id": 5318590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edd72720d937899b3ef278bcd01731ca?s=128&d=identicon&r=PG&f=1", "display_name": "BuckeyeRJB", "link": "https://stackoverflow.com/users/5318590/buckeyerjb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 995, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1451568933, "creation_date": 1441829319, "last_edit_date": 1441833892, "question_id": 32488295, "link": "https://stackoverflow.com/questions/32488295/how-to-compare-two-worksheets-and-generate-difference-report-as-3rd-sheet", "title": "How to compare two worksheets and generate difference report as 3rd sheet?", "body": "<p>I am having an issue with some of my vba code. I am trying to have two reports compare themselves.  If there are differences it will highlight that cell red if its negative and green if its positive on sheet2.  On the difference report (sheet3) it will show the difference value with its respected color as well.  Sheet2 - Sheet1 would be the difference shown on sheet3.  </p>\n\n<p>If there is no difference it will display 0 for numeric values.  Text and dates will stay the same if there is no difference.  </p>\n\n<p>I have completed this task in full except I only have it to where it will work if the data and reports match up with cells.  I need it to have the capability to realize if the data starts in cell A15 on sheet1, and if sheet2's data would start at A17, I need it to know to not start at A15 on sheet2 but to start the comparison at A17.  So A15 on sheet1 would compare itself to A17 on sheet2 and so on and so forth for the entire report.  </p>\n\n<p>When I run this now it would break it or sense everything is different if the reports don't match up.  I need it to have a smart sense I guess and know that it needs to compare the correct data even if the cells don't match up.  I have done tons of research and don't know if I have to use vlookup, match, index, or what?  If so I don't even know where to begin.  Code will be below.</p>\n\n<pre><code>Option Explicit\n'This is where the program calls all sub procedures In Order.\nSub RunCompareSchedules()\nApplication.ScreenUpdating = False\nSheet3Creation \"Sheet1\", \"Sheet2\", \"Sheet3\"\nCopy_range \"Sheet1\", \"Sheet2\", \"Sheet3\"\ncompareSheets \"Sheet1\", \"Sheet2\", \"Sheet3\"\nDataPush \"Sheet1\", \"Sheet2\", \"Sheet3\"\nCellFormat \"Sheet1\", \"Sheet2\", \"Sheet3\"\nAutoFit \"Sheet1\", \"Sheet2\", \"Sheet3\"\nApplication.ScreenUpdating = True\nEnd Sub\n\n\nSub compareSheets(shtSheet1 As String, shtSheet2 As String, shtSheet3 As String)\n\nDim mycell As Range\nDim mydiffs As Integer\n\n\n'For each cell in sheet2 that is less in Sheet1, color it red, if it's more color it Green.  If neither of these are true that don't add interior color.\n For Each mycell In ActiveWorkbook.Worksheets(shtSheet2).UsedRange\n If Not IsDate(mycell.Value) Or Not IsNumeric(mycell.Value) Then\n If mycell.Value &lt;&gt; ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    mycell.Interior.ColorIndex = 33\n    mydiffs = mydiffs + 1\n Else\n    mycell.Interior.ColorIndex = 0\n End If\n End If\n Next\n\n\n For Each mycell In ActiveWorkbook.Worksheets(shtSheet2).UsedRange\n If IsNumeric(mycell.Value) Then\n If mycell.Value &gt; ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    mycell.Interior.Color = vbRed\n    mydiffs = mydiffs\n ElseIf mycell.Value &lt; ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    mycell.Interior.Color = vbGreen\n Else\n    mycell.Interior.ColorIndex = 0\n End If\n End If\n Next\n\n\n 'For each cell in the date colomn sheet2 that is not the same in Sheet1, color it yellow\n For Each mycell In ActiveWorkbook.Worksheets(shtSheet2).UsedRange\n If IsDate(mycell.Value) Then\n If mycell.Value &lt; ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    mycell.Interior.Color = vbGreen\n    mydiffs = mydiffs\n ElseIf mycell.Value &gt; ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    mycell.Interior.Color = vbRed\n Else\n    mycell.Interior.ColorIndex = 0\n End If\n End If\n Next\n\nIf Sheets(shtSheet2).Cells(1, 1).Value &lt;&gt; Sheets(shtSheet1).Cells(1, 1).Value Then\nSheets(shtSheet2).Cells(1, 1).Interior.Color = vbYellow\nmydiffs = mydiffs + 1\nElse\nSheets(shtSheet2).Cells(1, 1).Interior.ColorIndex = 0\nEnd If\n\n\n\nIf Sheets(shtSheet3).Cells(1, 1).Value &lt;&gt; Sheets(shtSheet1).Cells(1, 1).Value Then\nSheets(shtSheet3).Cells(1, 1).Interior.Color = vbYellow\nElse\nSheets(shtSheet3).Cells(1, 1).Interior.ColorIndex = 0\nEnd If\n\n\n'Display a message box to demonstrate the differences\nMsgBox mydiffs &amp; \" differences found.  If Date cells are highlighted yellow on Sheet3, they will show the amount of difference in days.\", vbInformation\nActiveWorkbook.Sheets(shtSheet2).Select\n\nEnd Sub\nSub Copy_range(shtSheet1 As String, shtSheet2 As String, shtSheet3 As String)\n\n 'Copy worksheet 2 to worksheet 3\n Worksheets(\"Sheet2\").UsedRange.Copy\n Worksheets(\"Sheet3\").UsedRange.PasteSpecial\n\n End Sub\n\n Sub DataPush(shtSheet1 As String, shtSheet2 As String, shtSheet3 As String)\n\n Dim mycell As Range\n Dim mydiffs As Integer\n Dim cellLoc As String\n\n\n 'For each cell in sheet3 that is not the same in Sheet2, color it red\n For Each mycell In ActiveWorkbook.Worksheets(shtSheet3).UsedRange\n If Not IsDate(mycell.Value) Or Not IsNumeric(mycell.Value) Then\n If mycell.Value &lt;&gt; ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    mycell.Interior.ColorIndex = 33\n    mydiffs = mydiffs + 1\n Else\n    mycell.Interior.ColorIndex = 0\n End If\n End If\n Next\n\n\n For Each mycell In ActiveWorkbook.Worksheets(shtSheet3).UsedRange\n If IsNumeric(mycell.Value) Then\n If mycell.Value &gt; ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    mycell.Interior.Color = vbRed\n    mydiffs = mydiffs\n ElseIf mycell.Value &lt; ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    mycell.Interior.Color = vbGreen\n Else\n    mycell.Interior.ColorIndex = 0\n End If\n End If\n Next\n\n\n 'For each cell in the date colomn sheet3 that is not the same in Sheet2, color it yellow\n For Each mycell In ActiveWorkbook.Worksheets(shtSheet3).UsedRange\n If IsDate(mycell.Value) Then\n If mycell.Value &lt; ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    mycell.Interior.Color = vbGreen\n ElseIf mycell.Value &gt; ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    mycell.Interior.Color = vbRed\n Else\n    mycell.Interior.ColorIndex = 0\n End If\n End If\n  Next\n\n\n 'This will show the difference between each cell with a numeric value from sheet1 and 2, in sheet3.  If it's not different, it will show a zero.\n For Each mycell In Sheets(shtSheet3).UsedRange\n If IsNumeric(mycell.Value) Then\n If Not mycell.Value = Sheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    ActiveWorkbook.Worksheets(shtSheet3).Cells(mycell.Row, mycell.Column).Value = _\n    ActiveWorkbook.Worksheets(shtSheet2).Cells(mycell.Row, mycell.Column).Value - ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value\n  ElseIf mycell.Value = \"\" Then\n    ActiveWorkbook.Worksheets(shtSheet3).Cells(mycell.Row, mycell.Column).Value = \"\"\n  Else\n    ActiveWorkbook.Worksheets(shtSheet3).Cells(mycell.Row, mycell.Column).Value = 0\n  End If\n  End If\n  Next\n\n  End Sub\n\n Public Sub CellFormat(shtSheet1 As String, shtSheet2 As String, shtSheet3 As String)\n\n\n Dim mycell As Range\n\n 'This will show the difference of dates, in days, from sheet1 and 2, in sheet3.  If it's not different it will still show the date.\n For Each mycell In Sheets(shtSheet3).UsedRange\n If IsDate(mycell.Value) Then\n If Not mycell.Value = Sheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    ActiveWorkbook.Worksheets(shtSheet3).Cells(mycell.Row, mycell.Column).Value = _\n    ActiveWorkbook.Worksheets(shtSheet2).Cells(mycell.Row, mycell.Column).Value - ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value\n End If\n End If\n Next\n\n\n 'This will format the cells in the date column to be in the General format if the cell is yellow.\n  For Each mycell In Sheets(shtSheet3).UsedRange\n  If IsDate(mycell.Value) Then\n  If mycell.Value &lt;&gt; ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    ActiveWorkbook.Worksheets(shtSheet3).Cells(mycell.Row, mycell.Column).NumberFormat = \"#,##0\"\n  ElseIf mycell.Value = ActiveWorkbook.Worksheets(shtSheet1).Cells(mycell.Row, mycell.Column).Value Then\n    ActiveWorkbook.Worksheets(shtSheet3).Cells(mycell.Row, mycell.Column).NumberFormat = \"m/d/yyyy\"\n  End If\n  End If\n  Next\n  End Sub\n\n  Sub Sheet3Creation(shtSheet1 As String, shtSheet2 As String, shtSheet3 As String)\n\n\n  Dim shName As String, Wsh As Worksheet\n  shName = \"Sheet3\"\n\n\n 'This will loop through existing sheets to see if there is a sheet named \"Sheet3\". If there is a \"Sheet3\", then a message box will appear to\n 'let the user know that \"Sheet3\" already exists.  If not it will exit loop and go to next area where it will create \"Sheet3\" at the end of\n 'excel sheets 1 and 2.\n For Each Wsh In Sheets\n If Wsh.Name = shName Then\n If MsgBox(\"\" &amp; shName &amp; \" already exists! Please press Yes to continue or No to cancel operation.\", vbYesNo) = vbNo Then\n End\n End If\n Exit Sub  'Exit sub will allow the entire sub procedure to end if the \"For If\" Loop is true.  If it's not true it will continue on.\n End If\n  Next\n\n'This section will create a worksheet called \"Sheet3\" if the \"For If\" loop above is false.\nSet Wsh = ThisWorkbook.Sheets.Add(After:= _\n      ThisWorkbook.Sheets(ThisWorkbook.Sheets.Count))\n      Wsh.Name = shName\n\n End Sub\n\n Sub AutoFit(shtSheet1 As String, shtSheet2 As String, shtSheet3 As String)\n\n ActiveWorkbook.Worksheets(shtSheet1).UsedRange.Columns.AutoFit\n ActiveWorkbook.Worksheets(shtSheet2).UsedRange.Columns.AutoFit\n ActiveWorkbook.Worksheets(shtSheet3).UsedRange.Columns.AutoFit\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "datetime", "vba"], "comments": [{"owner": {"reputation": 3870, "user_id": 2336725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20a0b96a26cf233d752469445595f872?s=128&d=identicon&r=PG", "display_name": "Teepeemm", "link": "https://stackoverflow.com/users/2336725/teepeemm"}, "edited": false, "score": 0, "creation_date": 1441834285, "post_id": 32488268, "comment_id": 52839582, "body": "Please <a href=\"https://stackoverflow.com/posts/32488268/edit\">edit</a> your post to link to the previous post.  While you&#39;re doing that, please pick better tags.  Is this vba?  vb?  excel?  c#?"}, {"owner": {"reputation": 11, "user_id": 5318435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3a8b0d15ccd0f1ec6c29191a4620ff?s=128&d=identicon&r=PG&f=1", "display_name": "H. Shayhorn", "link": "https://stackoverflow.com/users/5318435/h-shayhorn"}, "reply_to_user": {"reputation": 3870, "user_id": 2336725, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20a0b96a26cf233d752469445595f872?s=128&d=identicon&r=PG", "display_name": "Teepeemm", "link": "https://stackoverflow.com/users/2336725/teepeemm"}, "edited": false, "score": 0, "creation_date": 1441975086, "post_id": 32488268, "comment_id": 52904990, "body": "<a href=\"http://stackoverflow.com/questions/9311973/automatic-date-update-in-a-cell-when-another-cells-value-changes-as-calculated\" title=\"automatic date update in a cell when another cells value changes as calculated\">stackoverflow.com/questions/9311973/&hellip;</a>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1441975346, "post_id": 32488268, "comment_id": 52905165, "body": "<code>So I wanted to just add this question to the existing question but you need a 50 rating</code> - editing your questions into other people&#39;s questions might eventually get you banned."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 5318435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3a8b0d15ccd0f1ec6c29191a4620ff?s=128&d=identicon&r=PG&f=1", "display_name": "H. Shayhorn", "link": "https://stackoverflow.com/users/5318435/h-shayhorn"}, "edited": false, "score": 0, "creation_date": 1442234980, "post_id": 32524231, "comment_id": 52985347, "body": "Perfect!  Thank you!!"}, {"owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "reply_to_user": {"reputation": 11, "user_id": 5318435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3a8b0d15ccd0f1ec6c29191a4620ff?s=128&d=identicon&r=PG&f=1", "display_name": "H. Shayhorn", "link": "https://stackoverflow.com/users/5318435/h-shayhorn"}, "edited": false, "score": 0, "creation_date": 1442236006, "post_id": 32524231, "comment_id": 52986101, "body": "If this answer helped you than can you pls <a href=\"http://stackoverflow.com/help/accepted-answer\">accept the answer</a> so that other will know you have the answer now."}, {"owner": {"reputation": 11, "user_id": 5318435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3a8b0d15ccd0f1ec6c29191a4620ff?s=128&d=identicon&r=PG&f=1", "display_name": "H. Shayhorn", "link": "https://stackoverflow.com/users/5318435/h-shayhorn"}, "edited": false, "score": 0, "creation_date": 1442324283, "post_id": 32524231, "comment_id": 53028691, "body": "This actually did work... however... I tried to run the worksheet on a mobile device (which is what it needs to run on) and apparently you can&#39;t run VBA on the mobile version of Excel.  So, unless someone can point me to a version of Excel that runs on an Android device or on an iPad I actually need to accomplish the same thing as the code is doing without the code... Is that possible?"}], "tags": [], "owner": {"reputation": 3638, "user_id": 1652222, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/4W5ez.jpg?s=128&g=1", "display_name": "ManishChristian", "link": "https://stackoverflow.com/users/1652222/manishchristian"}, "is_accepted": false, "score": 0, "last_activity_date": 1441976692, "creation_date": 1441976692, "answer_id": 32524231, "question_id": 32488268, "link": "https://stackoverflow.com/questions/32488268/automatic-date-update-in-a-cell-when-another-cells-value-changes-as-calculated/32524231#32524231", "title": "Automatic date update in a cell when another cell&#39;s value changes (as calculated by a formula) (CONTINUED)", "body": "<p>Assuming <code>Sheet2</code> is your <code>SheetB</code>. You just need to change one line.  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim R1 As Range\n    Dim R2 As Range\n    Dim InRange As Boolean\n    Set R1 = Range(Target.Address)\n    Set R2 = Range(\"C2:C20\")\n    Set InterSectRange = Application.Intersect(R1, R2)\n\n    InRange = Not InterSectRange Is Nothing\n    Set InterSectRange = Nothing\n    If InRange = True Then\n        'R1.Offset(0, 1).Value = Now()  '&lt;-- Commented\n        Sheets(\"Sheet2\").Range(Target.Address).Offset(0, 1).Value = Now()   '&lt;-- Added\n    End If\n    Set R1 = Nothing\n    Set R2 = Nothing\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5318435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d3a8b0d15ccd0f1ec6c29191a4620ff?s=128&d=identicon&r=PG&f=1", "display_name": "H. Shayhorn", "link": "https://stackoverflow.com/users/5318435/h-shayhorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 300, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441976893, "creation_date": 1441829209, "last_edit_date": 1531164843, "question_id": 32488268, "link": "https://stackoverflow.com/questions/32488268/automatic-date-update-in-a-cell-when-another-cells-value-changes-as-calculated", "title": "Automatic date update in a cell when another cell&#39;s value changes (as calculated by a formula) (CONTINUED)", "body": "<p>So I wanted to just add this question to the existing <a href=\"https://stackoverflow.com/questions/9311973/automatic-date-update-in-a-cell-when-another-cells-value-changes-as-calculated\"><strong>question</strong></a>, but you need a 50 rating so I had to start a new one. I apologize. </p>\n\n<p>someone posted this code which works great however, the field I want to populate with the date and time is on another sheet.  I'm wondering if someone could tell me what to change to identify the sheet that needs to be changed. The cell offset is also off because the field that would be updated on sheetA needs the Now() in the same cell on sheetB.</p>\n\n<p>Here is the code from the previous post:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n Dim R1 As Range\n Dim R2 As Range\n Dim InRange As Boolean\n    Set R1 = Range(Target.Address)\n    Set R2 = Range(\"C2:C20\")\n    Set InterSectRange = Application.Intersect(R1, R2)\n\n  InRange = Not InterSectRange Is Nothing\n     Set InterSectRange = Nothing\n   If InRange = True Then\n     R1.Offset(0, 1).Value = Now()\n   End If\n     Set R1 = Nothing\n     Set R2 = Nothing\n End Sub\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1441830939, "creation_date": 1441830939, "answer_id": 32488708, "question_id": 32488233, "link": "https://stackoverflow.com/questions/32488233/layers-of-innerhml/32488708#32488708", "title": "Layers of InnerHML", "body": "<p>If the div has an id then you can get it directly using</p>\n\n<pre><code>Dim d\nSet d = ie.Document.getElementById(\"application\")\n</code></pre>\n\n<p>If you then want to access elements within that div then you can use that in place of the document object as your starting point.</p>\n\n<p>Eg:</p>\n\n<pre><code>Dim divs\nSet divs = d.getElementsByTagName(\"div\")\n</code></pre>\n\n<p>I can't account for why innerHTML isn't giving you the correct result, unless it's a timing issue (e.g. the page is not yet fully-rendered when your code runs)</p>\n"}], "owner": {"reputation": 1, "user_id": 5318574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b86aae9c76cd6964355ca8202371c63?s=128&d=identicon&r=PG&f=1", "display_name": "Clifton Sett", "link": "https://stackoverflow.com/users/5318574/clifton-sett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441830939, "creation_date": 1441829083, "last_edit_date": 1531164843, "question_id": 32488233, "link": "https://stackoverflow.com/questions/32488233/layers-of-innerhml", "title": "Layers of InnerHML", "body": "<p>I have accessed the source code of a webpage and Looped through each (\"div\") <code>elementByTagName</code> and returned the <code>InnerHTML</code>, the value returned is limited in scope. The best way to phrase it is that it returns the <code>InnerHTML</code> but the <code>InnerHTML</code> has another layer of information that is not being disclosed. However, if I was to use \"FireFox\" and Inspect Element and right-click the element and \"Copy Inner HTML\" then ALL of the <code>innerHTML</code> and layers of data will be available.</p>\n\n<pre><code>Set Levels = ie.Document.body.getElementsByTagName(\"div\")\n\nFor Each Level In Levels\n    If Level.ID = \"application\" Then\n        Ans = Level.InnerHTML\n        Cells(20, 1).Value = Ans\n\n    End If\nNext Level\n</code></pre>\n\n<p>How do I access all the <code>InnerHTML</code> layers? Or at the very least, how do I set the <code>innerHTML</code> (first layer) as a variable so I can loop through the various inner elements to acquire further information (second layer, third layer, etc.....)?  </p>\n"}, {"tags": ["arrays", "vba"], "comments": [{"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1441828446, "post_id": 32488012, "comment_id": 52836750, "body": "I chose to number the dimensions 1 and 2 because a null array could be considered to have 0 dimensions and I wouldn&#39;t want that to be confusing for myself later."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1441828783, "post_id": 32488012, "comment_id": 52836926, "body": "I fail to see how you could avoid copying &quot;everything except&quot; manually. You can create an array that <a href=\"http://stackoverflow.com/q/11713408/11683\">points the original array&#39;s data</a>, but that works because the data remains continuous. In your case it&#39;s not."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1441830077, "post_id": 32488012, "comment_id": 52837528, "body": "@GSerg Agreed, there is definitely not a way of doing it without copying. What I meant was the CopyMemory Win32 API function - I&#39;m not sure if there is a way of writing the function using only built-in VBA array manipulations."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1441832292, "post_id": 32488012, "comment_id": 52838619, "body": "Not sure I understand the specific problem, but have you tried any of the helper functions that Ron de Bruin has posted? Specifically there is one that tests the number of dimensions in an array, and another which tests whether an array is truly &quot;allocated&quot;, etc."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1441890998, "post_id": 32488012, "comment_id": 52865132, "body": "@DavidZemens I added a few more examples and cleared up some of my bad terminology - see if it makes more sense."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1441899139, "post_id": 32488012, "comment_id": 52871248, "body": "For the 2-d array it&#39;s pretty simple. Can you show a screenshot of what your 3d array looks like in the Locals window?"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1441977248, "post_id": 32488012, "comment_id": 52906358, "body": "@DavidZemens I&#39;ll do you one better and give you code that builds it so you can play with it yourself!"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 2, "creation_date": 1441978434, "post_id": 32488012, "comment_id": 52907283, "body": "I can imagine writing this function to handle just 2d arrays or just 3d arrays, but generalizing it to handle any number (to the limit imposed by VBA) of finite dimensions is what really bakes my noodle."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1441978776, "post_id": 32488012, "comment_id": 52907511, "body": "Since <code>VBA</code> does not have <code>Rank()</code> function like <code>VB.NET</code> I doubt you can use the same function for 2D, 3D, xD arrays. You will need to make separate functions like <code>ArraySlice2</code> and <code>ArraySlice3</code>. Also VBA does not have buffered copy so you will need to copy one by one the elements. Only if you can squeeze a <code>Redim Preserve arr(...)</code> statement in there you might save some time."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1441979504, "post_id": 32488012, "comment_id": 52908009, "body": "@ja72 See the link I provided for a &quot;Rank()&quot; function - I called it <code>GetDims</code>, but it does basically what you&#39;re talking about."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1441979814, "post_id": 32488012, "comment_id": 52908224, "body": "Right @ja72 -- there&#39;s just not a good built-in way to iterate over the dimensions in the array, the iteration loops would need to be dynamically built based on the number of dimensions in the array.  I would probably use some other data structure (Collection or Dictionary) and try to limit myself to manageable, expected cases (2- or 3-levels of nesting)."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1441984431, "post_id": 32488012, "comment_id": 52911428, "body": "@DavidZemens If I have that 3x3x3 array and I do <code>ArraySlice(array, 3, 1)</code>, I get a 3x3x1 array (you can think of it as a square whose edges are along the X and Y dimensions - a square &quot;standing on edge facing you&quot;) with the values of index 1 in the 3rd dimension.  With the same 3x3x3 array, if I do <code>ArraySlice(array, 2, 1)</code> I would get a 3x1x3 array (a square with the edges along the X and Z dimensions - a square lying &quot;flat on the floor&quot;) with the values of index 1 in the 2nd dimension."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1441984649, "post_id": 32488012, "comment_id": 52911566, "body": "The dimensions would be like a coordinate system flat on a wall in front of you. X is positive to the right and negative left. Y is positive down and negative upwards. Z is positive towards you and negative away from you. This is kind of relative - it doesn&#39;t matter which way you interpret the dimensions so long as it&#39;s consistent."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1441986913, "post_id": 32488012, "comment_id": 52912976, "body": "Do you really need to handle an unknown number of dimensions? And does the array at each dimension also need to account for unknown number of dimensions? Like, might you have to deal with an array like <code>Dim arr(5, 6, 3, 1 to 9)</code>  What I&#39;m getting at is that if you have some known constraints, this &quot;problem&quot; should be manageable, although there isn&#39;t an <i>easy</i> way to do it.  If you literally have to account for every possible combination, I think you&#39;re boned."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1441987277, "post_id": 32488012, "comment_id": 52913191, "body": "@DavidZemens Technically, no, I don&#39;t need an unknown number of dimensions. The problem I originally encountered required two, but when possible and reasonable I like to generalize. When I realized generalization wasn&#39;t trivial, I decided to post this question to see if someone else could see something I missed. Incidentally I should note that I appreciate all your time and effort! (also, for the sake of my sanity I only use 0 based array indices)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1441990464, "post_id": 32488012, "comment_id": 52915007, "body": "You can completely flatten the array in to an ArrayList, and then use some fancy modular iteration based on the number of dimensions, etc., probably. But I&#39;m not sure if that would be any better than brute force nested loops, and my Excel just crapped out on me without the &quot;recovery&quot; panel, so I lost my tinkerings...."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1441990657, "post_id": 32488012, "comment_id": 52915115, "body": "@DavidZemens I&#39;m going to put a bounty on the question as soon as SO lets me - I&#39;d be very interested to see any ideas you have!"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1441999954, "post_id": 32488012, "comment_id": 52919864, "body": "There&#39;s some weird symmetry to the example data I don&#39;t know if that was on purpose but it&#39;s making it more confusing than need be..."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1442000238, "post_id": 32488012, "comment_id": 52919998, "body": "@DavidZemens yeah... that has more to do with my laziness and the proximity of the keys on the keyboard than anything practical or necessary.  I could just as easily change the example to have the first slice be all 1&#39;s, the second all 2&#39;s and the third all 3&#39;s if that would help."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1442000592, "post_id": 32488012, "comment_id": 52920140, "body": "no, that would be even less helpful. when trying to step through this I need to be able to <i>see</i> that the right elements are being selected, etc.  I made a revision to use some string values, not sure if it needs further &quot;approval&quot; though but I gave values like <code>arr(0,0,0) = &quot;000&quot;</code>, etc., so that the value corresponds to its XYZ coordinate."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1442000664, "post_id": 32488012, "comment_id": 52920187, "body": "Could you update to show the expected return from the <code>ArraySlice(array, 3, 1)</code>  based on the string values in the array?"}, {"owner": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1442265607, "post_id": 32488012, "comment_id": 53003301, "body": "I think the only possible way to slice an array with an arbitrary number of dimensions is through recursion, although we can quickly run out of stack memory for large dimensions"}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 2601, "user_id": 1181864, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/d6c447dd2c215da3f494b5b5528bb6c6?s=128&d=identicon&r=PG", "display_name": "Jeanno", "link": "https://stackoverflow.com/users/1181864/jeanno"}, "edited": false, "score": 0, "creation_date": 1442266336, "post_id": 32488012, "comment_id": 53003651, "body": "@Jeanno Actually, the method that GSerg suggests is sufficient. I&#39;m about 90% done with it, and once I do I&#39;ll post back in an update."}], "answers": [{"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1442069770, "post_id": 32539884, "comment_id": 52937545, "body": "Now that I wrote all this, I&#39;m thinking whether it is actually a bad thing to hardcode all 60 cases (there can be at most 60 dimensions in a VBA array)? You&#39;d end up with a big <code>select case num</code> where each line accesses the array with increased number of dimensions. Realistically you&#39;re not even going to use 60 dimensions because it&#39;s an instant Out of Memory even if all sixty are as small as (0 to 1)."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1442070416, "post_id": 32539884, "comment_id": 52937759, "body": "YESSSSS! This is exactly the sort of thing I was looking for! As for the problem I am trying to solve, imagine a cube of nine children&#39;s building blocks. You could take &quot;slices&quot; of that cube: the top 9 blocks, or the bottom or the middle; likewise you could instead take the nine blocks that form the left face or the right face, or the back face or the front face as a slice. That&#39;s what my question is about except in any number of dimensions. In a 2d 3x3 array, a slice would either be 3x1 or 1x3 depending upon which dimension you slice."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1442244778, "post_id": 32539884, "comment_id": 52992312, "body": "I went with <code>SafeArrayCreate()</code> for dynamic array creation, and I&#39;m returning it as a Variant, so that part is good. I looked up the COM Automation documentation and it appears that only full on Objects get Reference Counts, so the Variant/Array destruction gets handled correctly by VBA. I&#39;m currently trying to adapt the put/get functions."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1442254954, "post_id": 32539884, "comment_id": 52997990, "body": "One note, per the MSDN <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms221255(v=vs.85).aspx\" rel=\"nofollow noreferrer\">SafeArrayGetElement</a> page, &quot;A vector of indexes for each dimension of the array. The right-most (least significant) dimension is rgIndices[0]. The left-most dimension is stored at rgIndices[psa-&gt;cDims \u2013 1]. &quot; Does that mean I&#39;d have to reverse the order when copying from <code>indices()</code> to <code>long_indices()</code>?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1442256049, "post_id": 32539884, "comment_id": 52998614, "body": "@Blackhawk That&#39;s what I thought too and reversed them, and it did not work. Then I stopped reversing them and it worked."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1442334515, "post_id": 32539884, "comment_id": 53036026, "body": "I haven&#39;t fully finished the implementation of <code>ArraySlice</code>, but <code>PutArrayElement</code>, <code>GetArrayElement</code>, <code>CreateArray</code> are done. One thing I did change in <code>GetArrayElement</code> was adding ParamArray unpacking - sometimes it&#39;s convenient or even necessary to simply provide a single array instead of multiple parameters, so there is a check to see if <code>indices(0)</code> is an array, and if so to use that directly. I have all the pieces I need to build ArraySlice and I will post it back as an update to the question. Thanks for all your help!"}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 6, "last_activity_date": 1552414029, "last_edit_date": 1552414029, "creation_date": 1442067799, "answer_id": 32539884, "question_id": 32488012, "link": "https://stackoverflow.com/questions/32488012/vba-array-slices-not-in-the-pythonic-sense/32539884#32539884", "title": "VBA array slices (not in the Pythonic sense)", "body": "<blockquote>\n  <p><strong>Note:</strong> the code has been updated, the original version can be found in the <a href=\"https://stackoverflow.com/posts/32539884/revisions\">revision history</a> (not that it is useful to find it). The updated code does not depend on the undocumented <code>GetMem*</code> functions and is compatible with Office 64-bit.</p>\n</blockquote>\n\n<p>I'm not sure I fully understand the logic and the connection between the function arguments and the result, but there already is a generic element accessor function, <code>SafeArrayGetElement</code>. It lets you access an element of an array with dimensions unknown at compile time, all you need is the <a href=\"https://stackoverflow.com/q/183353/11683\">array pointer</a>.</p>\n\n<p>In a separate module:</p>\n\n<pre><code>Option Explicit\n\n#If VBA7 Then\n  Private Declare PtrSafe Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (ByRef Destination As Any, ByRef Source As Any, ByVal length As LongPtr)\n  Private Declare PtrSafe Function SafeArrayGetElement Lib \"oleaut32.dll\" (ByVal psa As LongPtr, ByRef rgIndices As Long, ByRef pv As Any) As Long\n  Private Declare PtrSafe Function SafeArrayGetVartype Lib \"oleaut32.dll\" (ByVal psa As LongPtr, ByRef pvt As Integer) As Long\n#Else\n  Private Declare Sub CopyMemory Lib \"kernel32\" Alias \"RtlMoveMemory\" (ByRef Destination As Any, ByRef Source As Any, ByVal length As Long)\n  Private Declare Function SafeArrayGetElement Lib \"oleaut32.dll\" (ByVal psa As Long, ByRef rgIndices As Long, ByRef pv As Any) As Long\n  Private Declare Function SafeArrayGetVartype Lib \"oleaut32.dll\" (ByVal psa As Long, ByRef pvt As Integer) As Long\n#End If\n\nPrivate Const VT_BYREF As Long = &amp;H4000&amp;\nPrivate Const S_OK As Long = &amp;H0&amp;\n\n' When declared in this way, the passed array is wrapped in a Variant/ByRef. It is not copied.\n' Returns *SAFEARRAY, not **SAFEARRAY\n#If VBA7 Then\nPrivate Function pArrPtr(ByRef arr As Variant) As LongPtr\n#Else\nPrivate Function pArrPtr(ByRef arr As Variant) As Long\n#End If\n  'VarType lies to you, hiding important differences. Manual VarType here.\n  Dim vt As Integer\n  CopyMemory ByVal VarPtr(vt), ByVal VarPtr(arr), Len(vt)\n\n  If (vt And vbArray) &lt;&gt; vbArray Then\n    Err.Raise 5, , \"Variant must contain an array\"\n  End If\n\n  'see https://msdn.microsoft.com/en-us/library/windows/desktop/ms221627%28v=vs.85%29.aspx\n  If (vt And VT_BYREF) = VT_BYREF Then\n    'By-ref variant array. Contains **pparray at offset 8\n    CopyMemory ByVal VarPtr(pArrPtr), ByVal VarPtr(arr) + 8, Len(pArrPtr)  'pArrPtr = arr-&gt;pparray;\n    CopyMemory ByVal VarPtr(pArrPtr), ByVal pArrPtr, Len(pArrPtr)          'pArrPtr = *pArrPtr;\n  Else\n    'Non-by-ref variant array. Contains *parray at offset 8\n    CopyMemory ByVal VarPtr(pArrPtr), ByVal VarPtr(arr) + 8, Len(pArrPtr)  'pArrPtr = arr-&gt;parray;\n  End If\nEnd Function\n\n\nPublic Function GetArrayElement(ByRef arr As Variant, ParamArray indices() As Variant) As Variant\n\n#If VBA7 Then\n  Dim pSafeArray As LongPtr\n#Else\n  Dim pSafeArray As Long\n#End If\n\n  pSafeArray = pArrPtr(arr)\n\n  Dim long_indices() As Long\n  ReDim long_indices(0 To UBound(indices) - LBound(indices))\n\n  Dim i As Long\n  For i = LBound(long_indices) To UBound(long_indices)\n    long_indices(i) = indices(LBound(indices) + i)\n  Next\n\n\n  'Type safety checks - remove/cache if you know what you're doing.\n  Dim hresult As Long\n\n  Dim vt As Integer\n  hresult = SafeArrayGetVartype(pSafeArray, vt)\n\n  If hresult &lt;&gt; S_OK Then Err.Raise hresult, , \"Cannot get array var type.\"\n\n\n  Select Case vt\n  Case vbVariant\n    hresult = SafeArrayGetElement(ByVal pSafeArray, long_indices(LBound(long_indices)), GetArrayElement)\n  Case vbBoolean, vbCurrency, vbDate, vbDecimal, vbByte, vbInteger, vbLong, vbNull, vbEmpty, vbSingle, vbDouble, vbString, vbObject\n    hresult = SafeArrayGetElement(ByVal pSafeArray, long_indices(LBound(long_indices)), ByVal VarPtr(GetArrayElement) + 8)\n    If hresult = S_OK Then CopyMemory ByVal VarPtr(GetArrayElement), ByVal VarPtr(vt), Len(vt)\n  Case Else\n    Err.Raise 5, , \"Unsupported array element type\"\n  End Select\n\n  If hresult &lt;&gt; S_OK Then Err.Raise hresult, , \"Cannot get array element.\"\nEnd Function\n</code></pre>\n\n<p>Usage:</p>\n\n<pre><code>Private Sub Command1_Click()\n  Dim arrVariantByRef() As Variant\n  ReDim arrVariantByRef(1 To 2, 1 To 3)\n\n  Dim arrVariantNonByRef As Variant\n  ReDim arrVariantNonByRef(1 To 2, 1 To 3)\n\n  Dim arrOfLongs() As Long\n  ReDim arrOfLongs(1 To 2, 1 To 3)\n\n  Dim arrOfStrings() As String\n  ReDim arrOfStrings(1 To 2, 1 To 3)\n\n  Dim arrOfObjects() As Object\n  ReDim arrOfObjects(1 To 2, 1 To 3)\n\n  Dim arrOfDates() As Date\n  ReDim arrOfDates(1 To 2, 1 To 3)\n\n  arrVariantByRef(2, 3) = 42\n  arrVariantNonByRef(2, 3) = 42\n  arrOfLongs(2, 3) = 42\n  arrOfStrings(2, 3) = \"42!\"\n  Set arrOfObjects(2, 3) = Me\n  arrOfDates(2, 3) = Now\n\n  MsgBox GetArrayElement(arrVariantByRef, 2, 3)\n  MsgBox GetArrayElement(arrVariantNonByRef, 2, 3)\n  MsgBox GetArrayElement(arrOfLongs, 2, 3)\n  MsgBox GetArrayElement(arrOfStrings, 2, 3)\n  MsgBox GetArrayElement(arrOfObjects, 2, 3).Caption\n  MsgBox GetArrayElement(arrOfDates, 2, 3)\n\nEnd Sub\n</code></pre>\n\n<p>I believe you can easily build your logic using this base block, although it might be slower than you want.<br>\nThere are some type checks in the code which you can remove - then it will be faster, but you will have to make sure you only pass arrays of correct underlying type. You can also cache the <code>pArray</code> and make <code>GetArrayElement</code> accept that instead of a raw array.</p>\n"}, {"comments": [{"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1442237021, "post_id": 32540681, "comment_id": 52986897, "body": "I think I will still try and avoid 60 hand coded cases if at all possible :P I had completely forgotten about the oleaut32 SafeArray functions - I&#39;m playing around with SafeArrayCreateEx to find out if the memory management would prevent me from creating an array on the fly, returning it in a Variant and then using the functions you provided in your other answer."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 1, "last_activity_date": 1442072700, "last_edit_date": 1495540318, "creation_date": 1442072700, "answer_id": 32540681, "question_id": 32488012, "link": "https://stackoverflow.com/questions/32488012/vba-array-slices-not-in-the-pythonic-sense/32540681#32540681", "title": "VBA array slices (not in the Pythonic sense)", "body": "<p>Now that I wrote <a href=\"https://stackoverflow.com/a/32539884/11683\">all this</a> and realized that you will need a similar element setter (based on <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms221283%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\"><code>SafeArrayPutElement</code></a> instead of <code>SafeArrayGetElement</code>) and a generic <a href=\"https://stackoverflow.com/a/11713643/11683\">array creation routine</a>, I'm thinking whether it is actually a bad thing to hardcode all 60 cases.</p>\n\n<p>The reason is that there can be at most 60 dimensions in a VBA array, and 60 cases are not difficult to hardcode</p>\n\n<p>I did not even type this code in, I used some Excel formulas to generate it:</p>\n\n<pre><code>Public Function GetArrayElement(ByRef arr As Variant, ParamArray indices()) As Variant\n  Dim count As Long, lb As Long\n\n  lb = LBound(indices)\n  count = UBound(indices) - lb + 1\n\n  Select Case count\n  Case 1: GetArrayElement = arr(indices(lb))\n  Case 2: GetArrayElement = arr(indices(lb), indices(lb + 1))\n    ....\n  Case Else\n    Err.Raise 5, , \"There can be no more than 60 dimensions\"\n  End Select\n\nEnd Function\n\nPublic Sub SetArrayElement(ByRef arr As Variant, ByRef value As Variant, ParamArray indices())\n  Dim count As Long, lb As Long\n\n  lb = LBound(indices)\n  count = UBound(indices) - lb + 1\n\n  Select Case count\n  Case 1: arr(indices(lb)) = value\n  Case 2: arr(indices(lb), indices(lb + 1)) = value\n    ....\n  Case Else\n    Err.Raise 5, , \"There can be no more than 60 dimensions\"\n  End Select\nEnd Sub\n</code></pre>\n\n<p>Unfortunately it's about twice longer than it is allowed in a post, so there is a link to full version: <a href=\"http://pastebin.com/KVqV3vyU\" rel=\"nofollow noreferrer\">http://pastebin.com/KVqV3vyU</a></p>\n"}, {"comments": [{"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 1, "creation_date": 1442236666, "post_id": 32565782, "comment_id": 52986624, "body": "I appreciate the amount of effort you&#39;ve put in, but do you think you could find a way of generalizing it? I&#39;m specifically looking for method that extends to any number of dimensions without hand coding."}, {"owner": {"reputation": 640, "user_id": 5323498, "user_type": "registered", "profile_image": "https://graph.facebook.com/957949454262350/picture?type=large", "display_name": "Adisak Anusornsrirung", "link": "https://stackoverflow.com/users/5323498/adisak-anusornsrirung"}, "reply_to_user": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1442236849, "post_id": 32565782, "comment_id": 52986760, "body": "OK, I will try later."}, {"owner": {"reputation": 640, "user_id": 5323498, "user_type": "registered", "profile_image": "https://graph.facebook.com/957949454262350/picture?type=large", "display_name": "Adisak Anusornsrirung", "link": "https://stackoverflow.com/users/5323498/adisak-anusornsrirung"}, "reply_to_user": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1442281251, "post_id": 32565782, "comment_id": 53007683, "body": "Can you give me an example for 4D and more dimension?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1442305536, "post_id": 32565782, "comment_id": 53016330, "body": "So you&#39;re going to have all cases hardcoded @AdisakAnusornsrirung - but the OP <a href=\"http://stackoverflow.com/questions/32488012/vba-array-slices-not-in-the-pythonic-sense/32539884#comment52986897_32540681\">does not want that</a>."}, {"owner": {"reputation": 640, "user_id": 5323498, "user_type": "registered", "profile_image": "https://graph.facebook.com/957949454262350/picture?type=large", "display_name": "Adisak Anusornsrirung", "link": "https://stackoverflow.com/users/5323498/adisak-anusornsrirung"}, "edited": false, "score": 0, "creation_date": 1442320743, "post_id": 32565782, "comment_id": 53026194, "body": "My function return array not single number. Except you input 1 array in parameter arr."}], "tags": [], "owner": {"reputation": 640, "user_id": 5323498, "user_type": "registered", "profile_image": "https://graph.facebook.com/957949454262350/picture?type=large", "display_name": "Adisak Anusornsrirung", "link": "https://stackoverflow.com/users/5323498/adisak-anusornsrirung"}, "is_accepted": false, "score": 3, "last_activity_date": 1442236437, "creation_date": 1442236437, "answer_id": 32565782, "question_id": 32488012, "link": "https://stackoverflow.com/questions/32488012/vba-array-slices-not-in-the-pythonic-sense/32565782#32565782", "title": "VBA array slices (not in the Pythonic sense)", "body": "<p>My complete code is below, arr input is 1, 2 or 3 dimension array, 1 dimension array will return false. </p>\n\n<pre><code>Public Function ArraySlice(arr As Variant, dimension As Long, index As Long) As Variant\nDim arrDimension() As Byte\nDim retArray()\nDim i As Integer, j As Integer\nDim arrSize As Long\n\n' Get array dimension and size\nOn Error Resume Next\nFor i = 1 To 3\n    arrSize = 0\n    arrSize = CInt(UBound(arr, i))\n    If arrSize &lt;&gt; 0 Then\n        ReDim Preserve arrDimension(i)\n        arrDimension(i) = UBound(arr, i)\n    End If\nNext i\nOn Error GoTo 0\n\nSelect Case UBound(arrDimension)\nCase 2\n    If dimension = 1 Then\n        ReDim retArray(arrDimension(2))\n        For i = 0 To arrDimension(2)\n            retArray(i) = arr(index, i)\n        Next i\n    ElseIf dimension = 2 Then\n        ReDim retArray(arrDimension(1))\n        For i = 0 To arrDimension(1)\n            retArray(i) = arr(i, index)\n        Next i\n    End If\n\nCase 3\n    If dimension = 1 Then\n        ReDim retArray(0, arrDimension(2), arrDimension(3))\n        For j = 0 To arrDimension(3)\n            For i = 0 To arrDimension(2)\n                retArray(0, i, j) = arr(index, i, j)\n            Next i\n        Next j\n    ElseIf dimension = 2 Then\n        ReDim retArray(arrDimension(1), 0, arrDimension(3))\n        For j = 0 To arrDimension(3)\n            For i = 0 To arrDimension(1)\n                retArray(i, 0, j) = arr(i, index, j)\n            Next i\n        Next j\n    ElseIf dimension = 3 Then\n        ReDim retArray(arrDimension(1), arrDimension(2), 0)\n        For j = 0 To arrDimension(2)\n            For i = 0 To arrDimension(1)\n                retArray(i, j, 0) = arr(i, j, index)\n            Next i\n        Next j\n    End If\n\nCase Else\n    ArraySlice = False\n    Exit Function\n\nEnd Select\n\nArraySlice = retArray\nEnd Function\n</code></pre>\n\n<p><br>\nSimply test by the code below</p>\n\n<pre><code>Sub test()\nDim arr2D()\nDim arr3D()\nDim ret\n\nReDim arr2D(4, 3)\narr2D(0, 0) = 1\narr2D(1, 0) = 1\narr2D(2, 0) = 2\narr2D(3, 0) = 3\narr2D(4, 0) = 1\narr2D(0, 1) = 3\narr2D(1, 1) = 4\narr2D(2, 1) = 2\narr2D(3, 1) = 1\narr2D(4, 1) = 5\narr2D(0, 2) = 4\narr2D(1, 2) = 5\narr2D(2, 2) = 3\narr2D(3, 2) = 2\narr2D(4, 2) = 6\narr2D(0, 3) = 3\narr2D(1, 3) = 5\narr2D(2, 3) = 2\narr2D(3, 3) = 1\narr2D(4, 3) = 3\n\nReDim arr3D(2, 2, 2)\narr3D(0, 0, 0) = 1\narr3D(1, 0, 0) = 1\narr3D(2, 0, 0) = 1\narr3D(0, 1, 0) = 2\narr3D(1, 1, 0) = 2\narr3D(2, 1, 0) = 2\narr3D(0, 2, 0) = 3\narr3D(1, 2, 0) = 3\narr3D(2, 2, 0) = 3\narr3D(0, 0, 1) = 4\narr3D(1, 0, 1) = 4\narr3D(2, 0, 1) = 4\narr3D(0, 1, 1) = 5\narr3D(1, 1, 1) = 5\narr3D(2, 1, 1) = 5\narr3D(0, 2, 1) = 6\narr3D(1, 2, 1) = 6\narr3D(2, 2, 1) = 6\narr3D(0, 0, 2) = 7\narr3D(1, 0, 2) = 7\narr3D(2, 0, 2) = 7\narr3D(0, 1, 2) = 8\narr3D(1, 1, 2) = 8\narr3D(2, 1, 2) = 8\narr3D(0, 2, 2) = 9\narr3D(1, 2, 2) = 9\narr3D(2, 2, 2) = 9\n\nReDim arr3D(2, 2, 2)\narr3D(0, 0, 0) = \"000\"\narr3D(1, 0, 0) = \"100\"\narr3D(2, 0, 0) = \"200\"\narr3D(0, 1, 0) = \"010\"\narr3D(1, 1, 0) = \"110\"\narr3D(2, 1, 0) = \"210\"\narr3D(0, 2, 0) = \"020\"\narr3D(1, 2, 0) = \"120\"\narr3D(2, 2, 0) = \"220\"\narr3D(0, 0, 1) = \"001\"\narr3D(1, 0, 1) = \"101\"\narr3D(2, 0, 1) = \"201\"\narr3D(0, 1, 1) = \"011\"\narr3D(1, 1, 1) = \"111\"\narr3D(2, 1, 1) = \"211\"\narr3D(0, 2, 1) = \"021\"\narr3D(1, 2, 1) = \"121\"\narr3D(2, 2, 1) = \"221\"\narr3D(0, 0, 2) = \"001\"\narr3D(1, 0, 2) = \"102\"\narr3D(2, 0, 2) = \"202\"\narr3D(0, 1, 2) = \"012\"\narr3D(1, 1, 2) = \"112\"\narr3D(2, 1, 2) = \"212\"\narr3D(0, 2, 2) = \"022\"\narr3D(1, 2, 2) = \"122\"\narr3D(2, 2, 2) = \"222\"\n\n' Here is function call\nret = ArraySlice(arr3D, 3, 1)\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 884, "favorite_count": 3, "accepted_answer_id": 32539884, "answer_count": 3, "score": 9, "last_activity_date": 1552414029, "creation_date": 1441828201, "last_edit_date": 1495539875, "question_id": 32488012, "link": "https://stackoverflow.com/questions/32488012/vba-array-slices-not-in-the-pythonic-sense", "title": "VBA array slices (not in the Pythonic sense)", "body": "<p><strong>How should I implement this function?</strong></p>\n\n<pre><code>Public Function ArraySlice(arr As Variant, dimension as Long, index as Long) As Variant\n\n    'Implementation here\n\nEnd Function\n</code></pre>\n\n<p>Suppose I wanted a slice of an array. I specify an array, a dimension and an index on that dimension for which I want the slice.</p>\n\n<p>As a concrete example, suppose I have the following 5x4 2D array</p>\n\n<pre><code>   0  1  2  3  4\n  ______________\n0| 1  1  2  3  1\n1| 3  4  2  1  5\n2| 4  5  3  2  6\n3| 3  5  2  1  3\n</code></pre>\n\n<p>If the horizontal dimension is 1 and the vertical is 2, the return value of <code>ArraySlice(array, 1, 3)</code> would be a 1x4 2D array. The chosen dimension 2 was flattened and the only remaining values are the ones that were originally at index 3 on dimension 2:</p>\n\n<pre><code>   0\n  ____\n0| 3\n1| 1\n2| 2\n3| 1\n</code></pre>\n\n<p>How would you implement this in VBA? The only implementations I can think of would involve CopyMemory unless I limited the number of dimensions allowable and hard coded every case.</p>\n\n<p><em>NOTE: <a href=\"https://stackoverflow.com/a/26555865/2832561\">Here is how I would get the dimensions of the array</a></em></p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Here are a couple more examples of the operation</p>\n\n<p>For the 2D array</p>\n\n<pre><code>   0  1  2  3  4\n  ______________\n0| 1  1  2  3  1\n1| 3  4  2  1  5\n2| 4  5  3  2  6\n3| 3  5  2  1  3\n</code></pre>\n\n<p>The result of <code>ArraySlice(array, 2, 2)</code> would be</p>\n\n<pre><code>   0  1  2  3  4\n  ______________\n0| 4  5  3  2  6\n</code></pre>\n\n<p>Suppose I had a 3x3x3 array comprised of the following 2 dimensional slices\n<em>this example has been changed to make it clearer</em></p>\n\n<pre><code>     0  1  2        0  1  2         0  1  2\n0   _________   1   _________  2   _________\n  0| 1  1  1      0| 4  4  4     0| 7  7  7\n  1| 2  2  2      1| 5  5  5     1| 8  8  8 \n  2| 3  3  3      2| 6  6  6     2| 9  9  9\n</code></pre>\n\n<p>(constructed like so)</p>\n\n<pre><code>Dim arr() As Long\n\nReDim arr(2, 2, 2)\n\narr(0, 0, 0) = 1\narr(1, 0, 0) = 1\narr(2, 0, 0) = 1\narr(0, 1, 0) = 2\narr(1, 1, 0) = 2\narr(2, 1, 0) = 2\narr(0, 2, 0) = 3\narr(1, 2, 0) = 3\narr(2, 2, 0) = 3\narr(0, 0, 1) = 4\narr(1, 0, 1) = 4\narr(2, 0, 1) = 4\narr(0, 1, 1) = 5\narr(1, 1, 1) = 5\narr(2, 1, 1) = 5\narr(0, 2, 1) = 6\narr(1, 2, 1) = 6\narr(2, 2, 1) = 6\narr(0, 0, 2) = 7\narr(1, 0, 2) = 7\narr(2, 0, 2) = 7\narr(0, 1, 2) = 8\narr(1, 1, 2) = 8\narr(2, 1, 2) = 8\narr(0, 2, 2) = 9\narr(1, 2, 2) = 9\narr(2, 2, 2) = 9\n</code></pre>\n\n<p>(the dimensions are used in the mathematical x, y, z sense as opposed to the rows/cols sense)</p>\n\n<p>The result of <code>ArraySlice(array, 3, 1)</code> would be the 3x3x1 array</p>\n\n<pre><code>     0  1  2\n0   _________\n  0| 4  4  4  \n  1| 5  5  5  \n  2| 6  6  6 \n</code></pre>\n\n<p>The result of <code>ArraySlice(array, 2, 2)</code> would be the 3x1x3 array</p>\n\n<pre><code>     0  1  2        0  1  2         0  1  2\n0   _________   1   _________  2   _________\n  0| 3  3  3      0| 6  6  6     0| 9  9  9\n</code></pre>\n\n<p><strong>UPDATE2</strong></p>\n\n<p>For DavidZemens, here is an example that would allow easier tracking of the elements involved:</p>\n\n<p>For a 3x3x3 array constructed like so</p>\n\n<pre><code>Dim arr() As Long\n\nReDim arr(2, 2, 2)\n\narr(0, 0, 0) = \"000\"\narr(1, 0, 0) = \"100\"\narr(2, 0, 0) = \"200\"\narr(0, 1, 0) = \"010\"\narr(1, 1, 0) = \"110\"\narr(2, 1, 0) = \"210\"\narr(0, 2, 0) = \"020\"\narr(1, 2, 0) = \"120\"\narr(2, 2, 0) = \"220\"\narr(0, 0, 1) = \"001\"\narr(1, 0, 1) = \"101\"\narr(2, 0, 1) = \"201\"\narr(0, 1, 1) = \"011\"\narr(1, 1, 1) = \"111\"\narr(2, 1, 1) = \"211\"\narr(0, 2, 1) = \"021\"\narr(1, 2, 1) = \"121\"\narr(2, 2, 1) = \"221\"\narr(0, 0, 2) = \"001\"\narr(1, 0, 2) = \"102\"\narr(2, 0, 2) = \"202\"\narr(0, 1, 2) = \"012\"\narr(1, 1, 2) = \"112\"\narr(2, 1, 2) = \"212\"\narr(0, 2, 2) = \"022\"\narr(1, 2, 2) = \"122\"\narr(2, 2, 2) = \"222\"\n</code></pre>\n\n<p>The result of <code>ArraySlice(array, 3, 1)</code> would be the 3x3x1 array</p>\n\n<pre><code>       0     1     2\n0   ___________________\n  0| \"001\" \"101\" \"201\"  \n  1| \"011\" \"111\" \"211\"\n  2| \"021\" \"121\" \"221\"\n</code></pre>\n\n<p><strong>FINAL UPDATE</strong></p>\n\n<p>Here is the complete solution - you can assume that the Array functions are implemented as @GSerg suggests in the accepted answer. I decided that it makes more sense to completely flatten the sliced dimension, so if a slice of a 3x3x3 array (\"cube\") is 3x1x3, it gets flattened to 3x3. I still have to resolve the case where flattening a 1 dimensional array would yield a 0 dimensional array by this method.</p>\n\n<pre><code>Public Function ArraySlice(arr As Variant, dimension As Long, index As Long) As Variant\n\n    'TODO: Assert that arr is an Array\n    'TODO: Assert dimension is valid\n    'TODO: Assert index is valid\n\n    Dim arrDims As Integer\n    arrDims = GetArrayDim(arr) 'N dimensions\n    Dim arrType As Integer\n    arrType = GetArrayType(arr)\n\n    Dim zeroIndexedDimension As Integer\n    zeroIndexedDimension = dimension - 1 'Make the dimension zero indexed by subtracting one, for easier math\n\n\n    Dim newArrDims As Integer\n    newArrDims = arrDims - 1 'N-1 dimensions since we're flattening \"dimension\" on \"index\"\n\n    Dim arrDimSizes() As Variant\n    Dim newArrDimSizes() As Variant\n\n    ReDim arrDimSizes(0 To arrDims - 1)\n    ReDim newArrDimSizes(0 To newArrDims - 1)\n\n    Dim i As Long\n\n    For i = 0 To arrDims - 1\n        arrDimSizes(i) = UBound(arr, i + 1) - LBound(arr, i + 1) + 1\n    Next\n\n    'Get the size of each corresponding dimension of the original\n    For i = 0 To zeroIndexedDimension - 1\n        newArrDimSizes(i) = arrDimSizes(i)\n    Next\n\n    'Skip over \"dimension\" since we're flattening it\n\n    'Get the remaining dimensions, off by one\n    For i = zeroIndexedDimension To arrDims - 2\n        newArrDimSizes(i) = arrDimSizes(i + 1)\n    Next\n\n    Dim newArray As Variant\n    newArray = CreateArray(arrType, newArrDims, newArrDimSizes)\n\n\n    'Iterate through dimensions, copying\n\n    Dim arrCurIndices() As Variant\n    Dim newArrCurIndices() As Variant\n\n    ReDim arrCurIndices(0 To arrDims - 1)\n    ReDim newArrCurIndices(0 To newArrDims - 1)\n\n    arrCurIndices(zeroIndexedDimension) = index 'This is the slice\n\n    Do While 1\n\n        'Copy the element\n        PutArrayElement newArray, GetArrayElement(arr, arrCurIndices), newArrCurIndices\n\n        'Iterate both arrays to the next position\n        If Not IncrementIndices(arrCurIndices, arrDimSizes, zeroIndexedDimension) Then\n            'If we've copied all the elements\n            Exit Do\n        End If\n        IncrementIndices newArrCurIndices, newArrDimSizes\n    Loop\n\n    ArraySlice = newArray\nEnd Function\n\nPrivate Function IncrementIndices(arrIndices As Variant, arrDimensionSizes As Variant, Optional zeroIndexedDimension As Integer = -2) As Boolean\n    'IncrementArray iterates sequentially through all valid indices, given the sizes in arrDimensionSizes\n    'For example, suppose the function is called repeatedly with starting arrIndices of [0, 0, 0] and arrDimensionSizes of [3, 1, 3].\n    'The result would be arrIndices changing as follows:\n    '[0, 0, 0] first call\n    '[0, 0, 1]\n    '[0, 0, 2]\n    '[1, 0, 0]\n    '[1, 0, 1]\n    '[1, 0, 2]\n    '[2, 0, 0]\n    '[2, 0, 1]\n    '[2, 0, 2]\n\n    'The optional \"dimension\" parameter allows a dimension to be frozen and not included in the iteration.\n    'For example, suppose the function is called repeatedly with starting arrIndices of [0, 1, 0] and arrDimensionSizes of [3, 3, 3] and dimension = 2\n    '[0, 1, 0] first call\n    '[0, 1, 1]\n    '[0, 1, 2]\n    '[1, 1, 0]\n    '[1, 1, 1]\n    '[1, 1, 2]\n    '[2, 1, 0]\n    '[2, 1, 1]\n    '[2, 1, 2]\n\n\n    Dim arrCurDimension As Integer\n    arrCurDimension = UBound(arrIndices)\n\n    'If this dimension is \"full\" or if it is the frozen dimension, skip over it looking for a carry\n    While arrIndices(arrCurDimension) = arrDimensionSizes(arrCurDimension) - 1 Or arrCurDimension = zeroIndexedDimension\n        'Carry\n        arrCurDimension = arrCurDimension - 1\n\n        If arrCurDimension = -1 Then\n            IncrementIndices = False\n            Exit Function\n        End If\n\n    Wend\n    arrIndices(arrCurDimension) = arrIndices(arrCurDimension) + 1\n    While arrCurDimension &lt; UBound(arrDimensionSizes)\n        arrCurDimension = arrCurDimension + 1\n        If arrCurDimension &lt;&gt; zeroIndexedDimension Then\n            arrIndices(arrCurDimension) = 0\n        End If\n    Wend\n    IncrementIndices = True\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1441827795, "post_id": 32487848, "comment_id": 52836442, "body": "The file that is selected will not be active until after the dialog is gone. You will probably have to loop through workbooks setting the activeheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441828386, "post_id": 32487848, "comment_id": 52836716, "body": "Are these workbooks already open? The <code>msoFileDialogOpen</code> provides a list of names; it does NOT actually open the workbooks into the current application environment."}], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1441828592, "last_edit_date": 1441828592, "creation_date": 1441828154, "answer_id": 32488001, "question_id": 32487848, "link": "https://stackoverflow.com/questions/32487848/trying-to-use-a-with-statement-to-open-a-specific-page/32488001#32488001", "title": "Trying to use a with statement to open a specific page", "body": "<p>After you have your workbooks open, loop through each workbook setting the active ws.</p>\n\n<pre><code>Public Sub LoopOpenWorkbooks()\n    Dim wb As Workbook\n    Dim ws As Excel.Worksheet\n\n    'Loop though each workbook\n    For Each wb In Application.Workbooks\n\n        'Activate the workbook\n        wb.Activate\n\n        'Set the worksheet and activate it.\n        Set ws = ActiveWorkbook.Sheets(\"Report\")\n        ws.Activate\n\n        'Now here you can loop through a user selected range and copies and pastes to a new workbook\n\n    Next wb\n\nEnd Sub\n</code></pre>\n\n<p>Or you can set the worksheet by index.</p>\n\n<pre><code>Set ws = Application.Worksheets(1)\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1441828755, "creation_date": 1441828755, "answer_id": 32488141, "question_id": 32487848, "link": "https://stackoverflow.com/questions/32487848/trying-to-use-a-with-statement-to-open-a-specific-page/32488141#32488141", "title": "Trying to use a with statement to open a specific page", "body": "<p>You seem to want to select multiple workbooks and work on the first worksheet in each one. The <code>msoFileDialogOpen</code> provides a list of names; it does NOT actually open the workbooks into the current application environment.</p>\n\n<pre><code>Dim f As Long, TargetFiles As Object\nSet TargetFiles = Application.FileDialog(msoFileDialogOpen)\nWith TargetFiles\n    .AllowMultiSelect = True\n    .Title = \"Multi-select target data files:\"\n    .ButtonName = \"\"\n    .Filters.Clear\n    .Filters.Add \".xlsm files\", \"*.xlsm\"\n    .Show\n\n    For f = 1 To .SelectedItems.Count\n        Debug.Print .SelectedItems(f)\n        With Workbooks.Open(.SelectedItems(f))\n            With .Worksheets(1)\n                'work with the first worksheet in the open workbook\n            End With\n            .Close\n        End With\n    Next f\n\nEnd With\n</code></pre>\n\n<p>See <a href=\"https://msdn.microsoft.com/en-us/library/wc500chb.aspx\" rel=\"nofollow\">With ... End With statement</a> for more on using it for the parentage level(s) of the workbook/worksheet/cell range so you can avoid the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff838003.aspx\" rel=\"nofollow\">Worksheet.Activate method</a>.</p>\n"}], "owner": {"reputation": 127, "user_id": 4279612, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/ab3d41de0439212aaaa4216e7c273558?s=128&d=identicon&r=PG&f=1", "display_name": "MadChadders", "link": "https://stackoverflow.com/users/4279612/madchadders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1441828755, "creation_date": 1441827473, "last_edit_date": 1531161705, "question_id": 32487848, "link": "https://stackoverflow.com/questions/32487848/trying-to-use-a-with-statement-to-open-a-specific-page", "title": "Trying to use a with statement to open a specific page", "body": "<p>I've tried looking for this everywhere and been unable to find it anywhere.</p>\n\n<p>I have a code where I use a with statement to loop through data, my question is how to loop through while looking only at a specific page called \"Report\" it's always the first sheet in the worksheet. Here is the coding I have it is not working. </p>\n\n<pre><code>Set TargetFiles = Application.FileDialog(msoFileDialogOpen)\nWith TargetFiles\n.Application.Worksheets(1).Activate\n.AllowMultiSelect = True\n.Title = \"Multi-select target data files:\"\n.ButtonName = \"\"\n.Filters.Clear\n.Filters.Add \".xlsm files\", \"*.xlsm\"\n.Show\nEnd With\n</code></pre>\n\n<p>The part I put in </p>\n\n<pre><code> .Application.Worksheets(1).Activate \n</code></pre>\n\n<p>isn't doing what I want. Basically this is part of a bigger set of code that loops through a user selected range and copies and pastes to a new workbook, that only works if they were all saved on the correct sheet. I learned the overall coding from this question thread:\n<a href=\"https://stackoverflow.com/questions/22824001/copying-worksheets-from-multiple-workbooks-into-current-workbook\">Copying worksheets from multiple workbooks into current workbook</a></p>\n\n<p>So there were 2 options as answers (I upvoted both) and both work but I'd like to combine parts of each. One the user picks the sheets but for it to work they all have to be on the correct sheet, on the other you have to have the files saved to a specific folder. I'd like to have the user select option for files but still have them combined based off a specific sheet name \"Report\" or location like worksheets(1).</p>\n\n<p>Can anyone help with that?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 4912881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32fc9d1c2e83fbc05c18da2653e580dd?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4912881/helloworld"}, "edited": false, "score": 0, "creation_date": 1441826368, "post_id": 32487486, "comment_id": 52835752, "body": "Thank you for the fast answer. Unfortunately it still isn&#39;t matching correctly?"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 315, "user_id": 4912881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32fc9d1c2e83fbc05c18da2653e580dd?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4912881/helloworld"}, "edited": false, "score": 0, "creation_date": 1441826404, "post_id": 32487486, "comment_id": 52835770, "body": "Is the -SET2 in the column A or C?"}, {"owner": {"reputation": 315, "user_id": 4912881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32fc9d1c2e83fbc05c18da2653e580dd?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4912881/helloworld"}, "edited": false, "score": 0, "creation_date": 1441826448, "post_id": 32487486, "comment_id": 52835790, "body": "It&#39;s in Column A -- I need to create matches even if the image name doesn&#39;t include the &quot;SET-2&quot; does that make sense? So if the image name (which are all in column C) is MCR7009A-LEG.jpg I need it to still match the item number in Col. A"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 315, "user_id": 4912881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32fc9d1c2e83fbc05c18da2653e580dd?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4912881/helloworld"}, "edited": false, "score": 0, "creation_date": 1441826516, "post_id": 32487486, "comment_id": 52835820, "body": "I think so. So we need to take it out of the name. Let me modify."}, {"owner": {"reputation": 315, "user_id": 4912881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32fc9d1c2e83fbc05c18da2653e580dd?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4912881/helloworld"}, "edited": false, "score": 0, "creation_date": 1441826580, "post_id": 32487486, "comment_id": 52835857, "body": "Exactly that&#39;s what I need to do, just so it matches."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 315, "user_id": 4912881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32fc9d1c2e83fbc05c18da2653e580dd?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4912881/helloworld"}, "edited": false, "score": 0, "creation_date": 1441826785, "post_id": 32487486, "comment_id": 52835953, "body": "Changed it to take the -set2 off the right side of the string."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "reply_to_user": {"reputation": 315, "user_id": 4912881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32fc9d1c2e83fbc05c18da2653e580dd?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4912881/helloworld"}, "edited": false, "score": 0, "creation_date": 1441826863, "post_id": 32487486, "comment_id": 52835992, "body": "Glad to be able to help."}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": true, "score": 1, "last_activity_date": 1441826752, "last_edit_date": 1441826752, "creation_date": 1441826052, "answer_id": 32487486, "question_id": 32487353, "link": "https://stackoverflow.com/questions/32487353/modifying-simple-vba-script-to-account-for-a-different-match/32487486#32487486", "title": "Modifying simple VBA script to account for a different match?", "body": "<p>Check for -set2 on the end of v, if it is there, strip it out</p>\n\n<pre><code>Sub Test()\n    Dim NA As Long, NC As Long, v As String, I As Long, J As Long\n    Dim v2 As String\n    NA = Cells(Rows.count, \"A\").End(xlUp).Row\n    NC = Cells(Rows.count, \"C\").End(xlUp).Row\n    For I = 2 To NA\n        v = LCase(Cells(I, \"A\").Value)\n\n        'Check for -set2 on the end of v, if it is there, strip it out\n        If Right(v, 5) = \"-set2\" Then\n            v = Left(v, Len(v) - 5)\n        End If\n\n        v2 = \"\"\n        For J = 2 To NC\n            If InStr(LCase(Cells(J, \"C\").Value), v) &gt; 0 Then ' What to do here?\n                v2 = v2 &amp; \";\" &amp; Cells(J, \"C\").Value\n            End If\n        Next J\n        Cells(I, \"A\").Offset(0, 1).Value = Mid(v2, 2)\n    Next I\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 4912881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32fc9d1c2e83fbc05c18da2653e580dd?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4912881/helloworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 32487486, "answer_count": 1, "score": 1, "last_activity_date": 1441826752, "creation_date": 1441825506, "last_edit_date": 1441825893, "question_id": 32487353, "link": "https://stackoverflow.com/questions/32487353/modifying-simple-vba-script-to-account-for-a-different-match", "title": "Modifying simple VBA script to account for a different match?", "body": "<p>So I'm using this function:</p>\n\n<pre><code>Sub Test()\n    Dim NA As Long, NC As Long, v As String, I As Long, J As Long\n    Dim v2 As String\n    NA = Cells(Rows.Count, \"A\").End(xlUp).Row\n    NC = Cells(Rows.Count, \"C\").End(xlUp).Row\n    For I = 2 To NA\n        v = LCase(Cells(I, \"A\").Value)\n        v2 = \"\"\n        For J = 2 To NC\n            If InStr(LCase(Cells(J, \"C\").Value), v) &gt; 0 Then ' What to do here?\n                v2 = v2 &amp; \";\" &amp; Cells(J, \"C\").Value\n            End If\n        Next J\n        Cells(I, \"A\").Offset(0, 1).Value = Mid(v2,2)\n    Next I\nEnd Sub\n</code></pre>\n\n<p>To match a column of image names to the items they belong to in another column. This works great except in one case:</p>\n\n<blockquote>\n  <p>If the item number includes a <em>\"-SET2\"</em> string in the item name -- so <strong>MCR7009A-SET2</strong> instead of <strong>MCR7009A</strong> -- the images that don't have SET2 in the file name won't end up as a match. This causes many images to be ignored.</p>\n</blockquote>\n\n<p>How can I account for the possibility of <em>\"-SET2\"</em> being in the item name?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 1, "creation_date": 1441826464, "post_id": 32487245, "comment_id": 52835799, "body": "have you tried OnCurrent?  Or maybe OnDirty?  You can also try OnAfterUpdate."}, {"owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "reply_to_user": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 1, "creation_date": 1441826847, "post_id": 32487245, "comment_id": 52835986, "body": "Oh, I haven&#39;t tried OnCurrent. Didn&#39;t catch my attention when I was going through the list. If you create an answer, I&#39;ll set it as the accepted answer. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "is_accepted": true, "score": 2, "last_activity_date": 1441827051, "creation_date": 1441827051, "answer_id": 32487746, "question_id": 32487245, "link": "https://stackoverflow.com/questions/32487245/is-there-an-equivalent-to-an-on-record-changed-event-for-access/32487746#32487746", "title": "Is there an equivalent to an &quot;On Record Changed&quot; event for Access?", "body": "<p>Try OnCurrent, or maybe OnDirty, and can also try OnAfterUpdate.\nI usually put stops in all of the candidate events when I'm not sure which one to use.  There are differences, but running your application and seeing when the events fire can help you decide which one to use.</p>\n"}, {"comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1594186784, "post_id": 62787601, "comment_id": 111034228, "body": "Comparing this to the other answer your proposal seems oddly off the apparent naming pattern."}], "tags": [], "owner": {"reputation": 546, "user_id": 1068263, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/31ab9ee329605800291b893da1afae95?s=128&d=identicon&r=PG", "display_name": "Guy Cohen", "link": "https://stackoverflow.com/users/1068263/guy-cohen"}, "is_accepted": false, "score": 1, "last_activity_date": 1594186703, "last_edit_date": 1594186703, "creation_date": 1594182804, "answer_id": 62787601, "question_id": 32487245, "link": "https://stackoverflow.com/questions/32487245/is-there-an-equivalent-to-an-on-record-changed-event-for-access/62787601#62787601", "title": "Is there an equivalent to an &quot;On Record Changed&quot; event for Access?", "body": "<p>The event you are looking for is : Form_Current</p>\n"}], "owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1906, "favorite_count": 0, "accepted_answer_id": 32487746, "answer_count": 2, "score": 1, "last_activity_date": 1594235087, "creation_date": 1441825062, "last_edit_date": 1594235087, "question_id": 32487245, "link": "https://stackoverflow.com/questions/32487245/is-there-an-equivalent-to-an-on-record-changed-event-for-access", "title": "Is there an equivalent to an &quot;On Record Changed&quot; event for Access?", "body": "<p>I am trying to set permissions for my form fields (continuous form) and permissions need to be re-evaluated every time a different record gains focus/selection. Right now the only way I've found is to have an OnFocus event for each editable control, but there's gotta be a better way...</p>\n\n<p>I've already tried MouseMove, OnClick, etc. but they don't seem to work when clicking/moving from a control in one record to the next without clicking over empty space first. Also MouseMove seems to have a limit to how frequently it responds.</p>\n\n<p>I would also appreciate something equivalent to an \"On Focus Changed\" event, if \"On Record Changed\" is not possible. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2754, "user_id": 996908, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8f97d264193fb479fd7eb10cce0a55a1?s=128&d=identicon&r=PG", "display_name": "Mr Smith", "link": "https://stackoverflow.com/users/996908/mr-smith"}, "edited": false, "score": 0, "creation_date": 1441824525, "post_id": 32487065, "comment_id": 52834878, "body": "which line is it erroring on?"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1441827162, "last_edit_date": 1441827162, "creation_date": 1441826822, "answer_id": 32487699, "question_id": 32487065, "link": "https://stackoverflow.com/questions/32487065/run-time-error-9-subscript-out-of-range-when-copying/32487699#32487699", "title": "&quot;Run Time error 9 : subscript out of range&quot; when copying", "body": "<p>There are a number of unanswered parentage questions to your workbook/worksheet/cell references but if you are pasting into the same workbook as the one containing the code then something like this should work.</p>\n\n<pre><code>Sub updatemultiple()\n\n    Workbooks.Open (\"C:\\Users\\akpeko.zigah\\Documents\\EDC\\DESTINATION.xlsm\")\n    Range(\"B2:F2\").Copy Destination:=THISWORKBOOK.Worksheets(\u201cSheet1\u201d).Range(\"B2\")\n    'Application.DisplayAlerts = False\n    ActiveWorkbook.Close False\n\nEnd Sub\n</code></pre>\n\n<p>The problems start with how you are determining the currently active worksheet when you open the external workbook. If it was opened, the active worksheet changed then closed byt another person or process then when you opened it it is going to copy the wrong cells. If the destination worksheet is not contained in the workbook containing the code then the destination is an ambiguous reference that depends upon the current state of the application environment.</p>\n\n<p>A short rewrite of your code (with some made-up references thrown in) might be like the following.</p>\n\n<pre><code>Sub updatemultiple()\n    Dim wb As Workbook\n\n    Set wb = Workbooks.Open(\"C:\\Users\\akpeko.zigah\\Documents\\EDC\\DESTINATION.xlsm\", ReadOnly:=True)\n    With wb.Worksheets(\"Sheet1\")\n        .Range(\"B2:F2\").Copy Destination:=ThisWorkbook.Worksheets(\u201cSheet1\u201d).Range(\"B2:F2\")\n        .Close SaveChanges:=False\n    End With\n    Set wb = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>In short, be as explicit as you can by defining the workbook, worksheet and cell references for each side of every operation. Relying on 'what is active' can only lead to trouble.</p>\n"}, {"tags": [], "owner": {"reputation": 22785, "user_id": 3215948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mRU0y.jpg?s=128&g=1", "display_name": "Racil Hilan", "link": "https://stackoverflow.com/users/3215948/racil-hilan"}, "is_accepted": false, "score": 0, "last_activity_date": 1441828374, "creation_date": 1441828374, "answer_id": 32488052, "question_id": 32487065, "link": "https://stackoverflow.com/questions/32487065/run-time-error-9-subscript-out-of-range-when-copying/32488052#32488052", "title": "&quot;Run Time error 9 : subscript out of range&quot; when copying", "body": "<p>If I understood your code correctly, it seems to me that you have the code in one file. When you execute the code, it opens the DESTINATION.xlsm file, copy the cells, close the DESTINATION.xlsm file, then paste the data in the active sheet of the original file that contains the code.</p>\n\n<p>I don't know what data you're copying, but when you copy (manually, not in code) a lot of data from an excel file and then you close it, you get a warning:</p>\n\n<blockquote>\n  <p>There is a large amount of information on the Clipboard. Do you want to be able to paste this information to another program later?</p>\n</blockquote>\n\n<p>For that reason, I recommend you to paste your copied cells first, and then close the file you're copying from.</p>\n"}], "owner": {"reputation": 11, "user_id": 5313489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FcWz9FlMMHA/AAAAAAAAAAI/AAAAAAAAADY/HdkGwXZB0fo/photo.jpg?sz=128", "display_name": "Ing Kojo", "link": "https://stackoverflow.com/users/5313489/ing-kojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1274, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1441830068, "creation_date": 1441824361, "last_edit_date": 1441830068, "question_id": 32487065, "link": "https://stackoverflow.com/questions/32487065/run-time-error-9-subscript-out-of-range-when-copying", "title": "&quot;Run Time error 9 : subscript out of range&quot; when copying", "body": "<p>I am trying to copy values from one sheet to another and getting this error  </p>\n\n<blockquote>\n  <p>\"Run Time error 9 : subscript out of range\"</p>\n</blockquote>\n\n<p>when I run the code below.</p>\n\n<pre><code>Sub updatemultiple()\nWorkbooks.Open (\"C:\\Users\\akpeko.zigah\\Documents\\EDC\\DESTINATION.xlsm\")\nRange(\"B2:F2\").Copy\n'Application.DisplayAlerts = False\nActiveWorkbook.Close\nActiveSheet.Paste Destination:=Worksheets(\u201cSheet1\u201d).Range(\"B2:F2\")\nEnd Sub\n</code></pre>\n\n<p>Any help? I'm stuck.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "edited": false, "score": 0, "creation_date": 1441824488, "post_id": 32486902, "comment_id": 52834860, "body": "This post shows a working version of VBA code for you: <a href=\"http://stackoverflow.com/questions/14245712/cycle-through-sub-folders-and-files-in-a-user-specified-root-directory/28053914#28053914\" title=\"cycle through sub folders and files in a user specified root directory\">stackoverflow.com/questions/14245712/&hellip;</a>"}, {"owner": {"reputation": 299, "user_id": 2533460, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/35d73ceeb04e119bed48bbc6f0f40b08?s=128&d=identicon&r=PG", "display_name": "user2533460", "link": "https://stackoverflow.com/users/2533460/user2533460"}, "reply_to_user": {"reputation": 7225, "user_id": 1899628, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PAWN2.png?s=128&g=1", "display_name": "stenci", "link": "https://stackoverflow.com/users/1899628/stenci"}, "edited": false, "score": 0, "creation_date": 1441826375, "post_id": 32486902, "comment_id": 52835756, "body": "Hi I just tested it  -  For some reason Its not working. I&#39;m sure I&#39;m not doing something right"}, {"owner": {"reputation": 5684, "user_id": 1657610, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/kcTi0.png?s=128&g=1", "display_name": "Reg Edit", "link": "https://stackoverflow.com/users/1657610/reg-edit"}, "edited": false, "score": 0, "creation_date": 1441827445, "post_id": 32486902, "comment_id": 52836278, "body": "You use ActiveDocument but that is unchanged by your loops--ActiveDocument is just the document that was open at the start. You&#39;ll need to include a little more, probably to actually open the file first at that point."}, {"owner": {"reputation": 299, "user_id": 2533460, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/35d73ceeb04e119bed48bbc6f0f40b08?s=128&d=identicon&r=PG", "display_name": "user2533460", "link": "https://stackoverflow.com/users/2533460/user2533460"}, "edited": false, "score": 0, "creation_date": 1441827877, "post_id": 32486902, "comment_id": 52836472, "body": "Hi I simply want to apply  a macro to all the files found within a folder and its sub folders. I really have spent the whole day yesterday trying to find a working version. I am not a VBA programmer hence really needing some help from the Pros. The code whenever I paste it into word macro does not execute."}, {"owner": {"reputation": 299, "user_id": 2533460, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/35d73ceeb04e119bed48bbc6f0f40b08?s=128&d=identicon&r=PG", "display_name": "user2533460", "link": "https://stackoverflow.com/users/2533460/user2533460"}, "edited": false, "score": 0, "creation_date": 1441828645, "post_id": 32486902, "comment_id": 52836852, "body": "Hi Thanks, that&#39;s such an honorouble thing to do vote down - when I am clearly showing that I am testing the code and its not working for me. No body is helping to show me where the mistake is. This is meant to be a place for newbies to get help. But if nobody is willing to help and instead just redirect to threads that I&#39;ve already read and tested is just mean and arrogant."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441830870, "post_id": 32486902, "comment_id": 52837924, "body": "@user2533460 The code in your version 2 works exactly like stenci, wrote it to work.  The reason you are getting down voted is; it is becoming apparent that you want code written for you that is &#39;plug and play&#39;.  There is more than enough information in the two versions you have to create a custom code to do what you want.  SO is a place to help with bugs, not write custom code.  Also insulting those whom you propose to ask for help is bad form."}, {"owner": {"reputation": 299, "user_id": 2533460, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/35d73ceeb04e119bed48bbc6f0f40b08?s=128&d=identicon&r=PG", "display_name": "user2533460", "link": "https://stackoverflow.com/users/2533460/user2533460"}, "edited": false, "score": 0, "creation_date": 1441832968, "post_id": 32486902, "comment_id": 52839005, "body": "Hi as you can see I have referenced that I am using code from stack exchange - so apart from the original authors  - who have been credited - no one has written any additional code. I am simply asking that if I have made a mistake in my execution of the code can some one kindly point that out? also as I have tested the code in VBA editor for me it is not working. I am not a VBA programmer. Also if the code was working for me its a simple copy and paste job end of story."}, {"owner": {"reputation": 299, "user_id": 2533460, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/35d73ceeb04e119bed48bbc6f0f40b08?s=128&d=identicon&r=PG", "display_name": "user2533460", "link": "https://stackoverflow.com/users/2533460/user2533460"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441842776, "post_id": 32486902, "comment_id": 52842280, "body": "@ScottCraner The code was already written on stack exchange as referenced in my post - so it does not make sense for some one to rewrite whats already written. There is an error that may be I am making when executing the code - which some one could have easily spotted or explained to me.No one did"}], "answers": [{"tags": [], "owner": {"reputation": 299, "user_id": 2533460, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/35d73ceeb04e119bed48bbc6f0f40b08?s=128&d=identicon&r=PG", "display_name": "user2533460", "link": "https://stackoverflow.com/users/2533460/user2533460"}, "is_accepted": false, "score": 0, "last_activity_date": 1441986097, "creation_date": 1441986097, "answer_id": 32527257, "question_id": 32486902, "link": "https://stackoverflow.com/questions/32486902/loop-through-folders-apply-macro-to-all-files/32527257#32527257", "title": "Loop Through Folders - Apply Macro to All Files", "body": "<p>if any one still needs a solution to this. VBA to Loop through directory and sub folders.</p>\n\n<p>After I was unable to make the code found here work for what ever reason.</p>\n\n<p>I have found this VBA add in from - </p>\n\n<p>Graham Mayor\n<a href=\"http://www.gmayor.com/document_batch_processes.htm\" rel=\"nofollow\">http://www.gmayor.com/document_batch_processes.htm</a></p>\n\n<p>The only catch is you need to call the functions and not Macros.</p>\n\n<p>The macros need to be converted to functions.</p>\n\n<p>Thanks to Graham for the Great Add in for all those needing to batch process  documents in a directory  - full of deeply nested sub folders!</p>\n"}], "owner": {"reputation": 299, "user_id": 2533460, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/35d73ceeb04e119bed48bbc6f0f40b08?s=128&d=identicon&r=PG", "display_name": "user2533460", "link": "https://stackoverflow.com/users/2533460/user2533460"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1383, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441986097, "creation_date": 1441823810, "last_edit_date": 1495542576, "question_id": 32486902, "link": "https://stackoverflow.com/questions/32486902/loop-through-folders-apply-macro-to-all-files", "title": "Loop Through Folders - Apply Macro to All Files", "body": "<p>I am trying to loop through folders using VBA code Found here: <a href=\"https://stackoverflow.com/questions/22645347/loop-through-all-subfolders-using-vba\">Loop Through All Subfolders Using VBA</a></p>\n\n<p>The code I have simply copied and added my own macro. Although it does not give an error. The code is not working. It simply does not respond when I run the Macro.</p>\n\n<p>I have 500+ files I need to apply a macro to - some of the files are really deeply nested within folders.</p>\n\n<p>I really would appreciate some one to help me create a working Macro.\nThe ones found on stack exchange  - either give an error or simply don't respond.</p>\n\n<p>If any one has a macro enabled working version of the code submitted here - it would be a great help.</p>\n\n<p>I am well aware that there are VBA excel looping through folders code, there is also a recursive one -  when I test these solutions they do not work for me. That is not to say that they dont work at all.</p>\n\n<p>Pointing me to other threads is not helping me -Ive read all the threads. \nIve spent time testing them.</p>\n\n<p>This is What I need:</p>\n\n<p><strong>- Find file of Certain  type ie docx in Folder > SubFolder > Sub Folder\n - Apply my own macro to it</strong></p>\n\n<p>Version 1 Found on Stack exchange:</p>\n\n<pre><code>Sub NewFolder()\n    Dim FileSystem As Object\n    Dim HostFolder As String\n    HostFolder = \"C:\\Users\\Shana\\Desktop 2\\Folder1\\\"\n    Set FileSystem = CreateObject(\"Scripting.FileSystemObject\")\n    DoFolder FileSystem.GetFolder(HostFolder)\nEnd Sub\n\nSub DoFolder(Folder)\n    Dim SubFolder\n    For Each SubFolder In Folder.SubFolders\n        DoFolder SubFolder\n    Next\n    Dim File\n    For Each File In Folder.Files\n        ActiveDocument.Range.Text = \"Replaced\"\n        ' Operate on each file\n    Next\nEnd Sub\n</code></pre>\n\n<p>I have looked through the other VBA Loop though folders code. I have been unable to get them to work.</p>\n\n<p>The code when I create macro in the VBA editor simply does not work.</p>\n\n<p>Version 2 Found on stack exchange:</p>\n\n<pre><code>Function GetFilesIn(Folder As String) As Collection\n    Dim F As String\n    Set GetFilesIn = New Collection\n    F = Dir(Folder &amp; \"\\*\")\n    Do While F &lt;&gt; \"\"\n        GetFilesIn.Add F\n        F = Dir\n    Loop\nEnd Function\n\nFunction GetFoldersIn(Folder As String) As Collection\n    Dim F As String\n    Set GetFoldersIn = New Collection\n    F = Dir(Folder &amp; \"\\*\", vbDirectory)\n    Do While F &lt;&gt; \"\"\n        If GetAttr(Folder &amp; \"\\\" &amp; F) And vbDirectory Then GetFoldersIn.Add F\n        F = Dir\n    Loop\nEnd Function\n\nSub Test()\n    Dim C As Collection, F\n    Debug.Print\n    Debug.Print \"Files in C:\\\"\n    Set C = GetFilesIn(\"C:\\Users\\Shana\\Desktop 2\\Folder1\\\")\n    For Each F In C\n        Debug.Print F\n    Next F\n    Debug.Print\n    Debug.Print \"Folders in C:\\\"\n    Set C = GetFoldersIn(\"C:\\Users\\Shana\\Desktop 2\\Folder1\\\")\n    For Each F In C\n        ActiveDocument.Range.Text = \"Replaced\"\n        'Debug.Print F\n    Next F\nEnd Sub\n</code></pre>\n\n<p>The above also does not work - am I doing something wrong?</p>\n\n<p>This is What I need:</p>\n\n<p><strong>- Find file of Certain  type ie docx in Folder > SubFolder > Sub Folder\n - Apply my own macro to it</strong></p>\n\n<p><strong><em>Please do not mark as duplicate as I need a working version of VBA code to cycle through all my docx files.</em></strong></p>\n"}, {"tags": ["vba", "excel", "date", "date-range"], "comments": [{"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1441824347, "post_id": 32486571, "comment_id": 52834787, "body": "Will you need to look for those that have a complete overlap? So they start before another one and end after that one."}, {"owner": {"reputation": 449, "user_id": 2091660, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8fb68050e6c4f3f96092414fe7176f9a?s=128&d=identicon&r=PG", "display_name": "ajspacemanspiff", "link": "https://stackoverflow.com/users/2091660/ajspacemanspiff"}, "reply_to_user": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1441825066, "post_id": 32486571, "comment_id": 52835114, "body": "yes.  Anything that overlaps.  Basically, how many are happening at the same time."}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 0, "creation_date": 1441825332, "post_id": 32486571, "comment_id": 52835240, "body": "Answer is updated to catch complete overlaps."}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 2091660, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8fb68050e6c4f3f96092414fe7176f9a?s=128&d=identicon&r=PG", "display_name": "ajspacemanspiff", "link": "https://stackoverflow.com/users/2091660/ajspacemanspiff"}, "edited": false, "score": 0, "creation_date": 1441825131, "post_id": 32486827, "comment_id": 52835141, "body": "I can&#39;t seem to get it working though,  all results come back as 0."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 449, "user_id": 2091660, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8fb68050e6c4f3f96092414fe7176f9a?s=128&d=identicon&r=PG", "display_name": "ajspacemanspiff", "link": "https://stackoverflow.com/users/2091660/ajspacemanspiff"}, "edited": false, "score": 0, "creation_date": 1441825445, "post_id": 32486827, "comment_id": 52835310, "body": "It&#39;s working here. It assumes your phone call times begin in row 2 and go down from there as far as row 35006. You must make sure that none of the entries are actually TEXT instead of true numbers."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 449, "user_id": 2091660, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8fb68050e6c4f3f96092414fe7176f9a?s=128&d=identicon&r=PG", "display_name": "ajspacemanspiff", "link": "https://stackoverflow.com/users/2091660/ajspacemanspiff"}, "edited": false, "score": 0, "creation_date": 1441825575, "post_id": 32486827, "comment_id": 52835376, "body": "If you like, I am available to help. Just send me the file and I&#39;ll have it sorted quickly. My email address is: daniel.ferry@gmail.com"}, {"owner": {"reputation": 449, "user_id": 2091660, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8fb68050e6c4f3f96092414fe7176f9a?s=128&d=identicon&r=PG", "display_name": "ajspacemanspiff", "link": "https://stackoverflow.com/users/2091660/ajspacemanspiff"}, "edited": false, "score": 0, "creation_date": 1441834999, "post_id": 32486827, "comment_id": 52839843, "body": "I now recognize that there was a flaw in the way I asked this question.  Where it says &quot;2&quot; it should only say &quot;1&quot; as there is only one overlap at a time.. Yes, there are two records that overlap it, but they do not cross."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 449, "user_id": 2091660, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8fb68050e6c4f3f96092414fe7176f9a?s=128&d=identicon&r=PG", "display_name": "ajspacemanspiff", "link": "https://stackoverflow.com/users/2091660/ajspacemanspiff"}, "edited": false, "score": 0, "creation_date": 1441836902, "post_id": 32486827, "comment_id": 52840584, "body": "Please ask a new question."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 0, "last_activity_date": 1441823518, "creation_date": 1441823518, "answer_id": 32486827, "question_id": 32486571, "link": "https://stackoverflow.com/questions/32486571/number-of-overlapping-datetimes/32486827#32486827", "title": "Number of Overlapping datetime(s)", "body": "<p>I think you just need to subtract one from your current formula:</p>\n\n<pre><code>=SUMPRODUCT((A$2:A$35006&lt;=B2)*(B$2:B$35006&gt;=A2))-1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1441825417, "last_edit_date": 1441825417, "creation_date": 1441824157, "answer_id": 32487009, "question_id": 32486571, "link": "https://stackoverflow.com/questions/32486571/number-of-overlapping-datetimes/32487009#32487009", "title": "Number of Overlapping datetime(s)", "body": "<p>Since you have VBA in you tags, here is how you can do it.</p>\n\n<p>In you VBA IDE go to the tools menu and selecte references. Select \"Microstoft ActiveX data objects 2.8 Library.</p>\n\n<pre><code>Private Sub CheckOverlaps()\n    Dim ws1 As Excel.Worksheet\n    Dim iCount As Integer\n    Dim rs As New ADODB.Recordset\n    Dim lRow As Long\n\n    'Set the worksheet that you want to process by name\n    Set ws1 = ActiveWorkbook.Sheets(\"Sheet1\")\n\n    'Add fields to your recordset for storing data.\n    With rs\n        .Fields.Append \"Row\", adInteger\n        .Fields.Append \"Start\", adDate\n        .Fields.Append \"End\", adDate\n        .Open\n    End With\n\n    lRow = 1\n\n    ws1.Activate\n    'Loop through and record what is in the columns\n    Do While lRow &lt;= ws1.UsedRange.Rows.count\n\n        If ws1.Range(\"A\" &amp; lRow).Value &lt;&gt; \"\" Then\n            rs.AddNew\n            rs.Fields(\"Row\").Value = lRow\n            rs.Fields(\"Start\").Value = ws1.Range(\"A\" &amp; lRow).Value\n            rs.Fields(\"End\").Value = ws1.Range(\"B\" &amp; lRow).Value\n            rs.Update\n        End If\n\n        lRow = lRow + 1\n        ws1.Range(\"A\" &amp; lRow).Activate\n    Loop\n\n    lRow = 1\n\n    'Loop through and check for overlaps in the records.\n    Do While lRow &lt;= ws1.UsedRange.Rows.count\n\n        iCount = 0\n\n        If ws1.Range(\"A\" &amp; lRow).Value &lt;&gt; \"\" And ws1.Range(\"A\" &amp; lRow).Value &lt;&gt; \"\" Then\n\n            'Check for those that started in the timespan\n            rs.Filter = \"\"\n            rs.Filter = \"Start &gt;= '\" &amp; ws1.Range(\"A\" &amp; lRow).Value &amp; \"' AND Start &lt;='\" &amp; ws1.Range(\"B\" &amp; lRow).Value &amp; \"'\"\n            iCount = rs.RecordCount\n\n            'Check for those that ended in the timespan\n            rs.Filter = \"\"\n            rs.Filter = \"End &gt;= '\" &amp; ws1.Range(\"A\" &amp; lRow).Value &amp; \"' AND End &lt;='\" &amp; ws1.Range(\"B\" &amp; lRow).Value &amp; \"'\"\n            iCount = iCount + rs.RecordCount\n\n            'Check for those that started before and ended after the current timespan.\n            rs.Filter = \"\"\n            rs.Filter = \"Start &lt;= '\" &amp; ws1.Range(\"A\" &amp; lRow).Value &amp; \"' AND End &gt;='\" &amp; ws1.Range(\"B\" &amp; lRow).Value &amp; \"'\"\n            iCount = iCount + rs.RecordCount\n\n            'Report the number. You minus three because the records that are the time will get counted each time\n            ws1.Range(\"c\" &amp; lRow).Value = iCount - 3\n        End If\n\n        lRow = lRow + 1\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 2091660, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8fb68050e6c4f3f96092414fe7176f9a?s=128&d=identicon&r=PG", "display_name": "ajspacemanspiff", "link": "https://stackoverflow.com/users/2091660/ajspacemanspiff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 841, "favorite_count": 0, "accepted_answer_id": 32486827, "answer_count": 2, "score": 0, "last_activity_date": 1441825417, "creation_date": 1441822491, "last_edit_date": 1495539883, "question_id": 32486571, "link": "https://stackoverflow.com/questions/32486571/number-of-overlapping-datetimes", "title": "Number of Overlapping datetime(s)", "body": "<p>I have two columns of date/time(s) and need to find out how many of them overlap at a particular time.  </p>\n\n<p>Use case is this: These are start and end times for phone calls and am looking to find the number of simultaneous calls.  </p>\n\n<pre><code>Column A            Column B    \n8/06/15 00:17:59    8/06/15 00:19:21     \n8/09/15 00:21:06    8/09/15 00:22:06     \n8/09/15 00:21:21    8/09/15 00:22:43     \n8/09/15 00:22:11    8/09/15 00:22:46     \n8/10/15 00:24:28    8/10/15 00:24:51     \n</code></pre>\n\n<p>Expected Result:</p>\n\n<pre><code>Column A            Column B             Number Overlap    \n8/06/15 00:17:59    8/06/15 00:19:21     0\n8/09/15 00:21:06    8/09/15 00:22:06     1\n8/09/15 00:21:21    8/09/15 00:22:43     2\n8/09/15 00:22:11    8/09/15 00:22:46     1\n8/10/15 00:24:28    8/10/15 00:24:51     0\n</code></pre>\n\n<p>The formula I am trying is this:</p>\n\n<pre><code>=SUMPRODUCT((A$2:A$35006&lt;=B2)*(B$2:B$35006&gt;=A2))\n</code></pre>\n\n<p>I would also like to reference similar questions, that do not quite answer what I need here, but have helped me get this far:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/19596982/find-number-of-concurrent-overlapping-date-ranges/19608892#19608892\">Find number of concurrent, overlapping, date ranges</a></p>\n\n<p><a href=\"http://www.mrexcel.com/forum/excel-questions/388376-count-number-date-ranges-overlap-other-date-ranges.html\" rel=\"nofollow noreferrer\">http://www.mrexcel.com/forum/excel-questions/388376-count-number-date-ranges-overlap-other-date-ranges.html</a></p>\n"}, {"tags": ["vba", "excel", "datamodel"], "answers": [{"tags": [], "owner": {"reputation": 627, "user_id": 1880754, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8e6590b7616f23d2443a6a332b298a60?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1880754/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1441897020, "last_edit_date": 1441897020, "creation_date": 1441824784, "answer_id": 32487181, "question_id": 32486391, "link": "https://stackoverflow.com/questions/32486391/linking-slicers-from-pivottables-built-with-data-model/32487181#32487181", "title": "Linking slicers from PivotTables built with data model", "body": "<p>According to the information I found here <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff839561.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/EN-US/library/office/ff839561.aspx</a>, the SlicerItems property will not work directly with a pivot table connected to a data model (OLAP data source). Instead, I need to use SlicerItems with the SlicerCacheLevels object.</p>\n\n<p>Below is a working example.</p>\n\n<pre><code>Sub SlicerMonth()\n\n    Dim sc1, sc2, sc3 As SlicerCache\n    Dim si As SlicerItem\n    Dim sl1 As SlicerCacheLevel\n    Dim mnth, nokey, nomatch As String\n\n    Set sc1 = ActiveWorkbook.SlicerCaches(\"Slicer_ClickMonth\")\n    Set sc2 = ActiveWorkbook.SlicerCaches(\"Slicer_Visit_Month1\")\n    Set sc3 = ActiveWorkbook.SlicerCaches(\"Slicer_Visit_Month\")\n\n    Set sl1 = sc1.SlicerCacheLevels(1)\n\n    'Clears the strings\n    nokey = \"\"\n    nomatch = \"\"\n\n    'Cycles through the Master Slicer and populates the strings\n    For Each si In sl1.SlicerItems\n        If si.Selected Then\n            mnth = Right(si.Name, 7) '7 becaucse I always have 3 letter months\n            nokey = nokey &amp; \",[No Key].[Visit Month]\" &amp; mnth\n            nomatch = nomatch &amp; \",[No Match].[Visit Month]\" &amp; mnth\n            i = i + 1\n        End If\n    Next\n\n    'Trims off the first comma for the strings\n    nokey = Right(nokey, Len(nokey) - 1)\n    nomatch = Right(nomatch, Len(nomatch) - 1)\n\n    'Clears the filter in the slicers\n    sc2.ClearManualFilter\n    sc3.ClearManualFilter\n\n    'Sets the slicers to match the Master slicer\n    sc2.VisibleSlicerItemsList = Array(Split(nokey, \",\"))\n    sc3.VisibleSlicerItemsList = Array(Split(nomatch, \",\"))\n\n\nEnd Sub\n</code></pre>\n\n<p>The only other issue of note (which took me about half a day to figure out) is to make sure that there are no white spaces after the comma when creating the strings (nomatch &amp; nokey).</p>\n"}], "owner": {"reputation": 627, "user_id": 1880754, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8e6590b7616f23d2443a6a332b298a60?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/1880754/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1090, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441897020, "creation_date": 1441821771, "last_edit_date": 1441822365, "question_id": 32486391, "link": "https://stackoverflow.com/questions/32486391/linking-slicers-from-pivottables-built-with-data-model", "title": "Linking slicers from PivotTables built with data model", "body": "<p>I have a couple of pivot tables that use different caches. All of these tables are created through data connections, and all utilize the data model. What I am trying to created master slicer that filters all of the tables simultaneously. </p>\n\n<p>Using VBA, my thinking is to populate an array of all the visible pivotitems from pivotcache1 (the cache that my master slicer is linked to), and then cycle through this array to filter my other caches (pivotcache2 &amp; pivotcache3). </p>\n\n<p>However, the below code does not work - it breaks down at the For Each loop. </p>\n\n<pre><code>Sub FilterMonth()\n\n    Dim sc1, sc2, sc3 As SlicerCache\n    Dim si As SlicerItem\n\n    Set sc1 = ActiveWorkbook.SlicerCaches(\"Slicer_ClickMonth\")\n    Set sc2 = ActiveWorkbook.SlicerCaches(\"Slicer_Visit_Month1\")\n    Set sc3 = ActiveWorkbook.SlicerCaches(\"Slicer_Visit_Month\")\n\n    For Each si In sc1.SlicerItems\n        If si.Selected Then\n            'Add to my array\n        End If\n    Next \n\nEnd Sub\n</code></pre>\n\n<p>I believe that this is because there the syntax is different for caches built on data models.  </p>\n\n<p>Can anybody confirm this and/or provide me with code to filter all of my datamodel caches?</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1441822954, "post_id": 32486290, "comment_id": 52834068, "body": "Your column naming/lookup scheme seems unnecessarily ambiguous. Can you explain further?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441823272, "post_id": 32486290, "comment_id": 52834256, "body": "How come Column I is using three columns to multiply, but the others (J, K, L) don&#39;t? Do you need to multiply all three columns, or should it be two?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1441823502, "post_id": 32486290, "comment_id": 52834366, "body": "It has to do with the column names, becuase in column D the name (D1) is A1_A5 it needs to multiply its number (column D) with both columns listed A1 (Column A) and A5 (Column B).  At least that is what I am seeing.  And since the other columns only have one of the A1 of A5 in their names only those columns get multiplied."}, {"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441824418, "post_id": 32486290, "comment_id": 52834824, "body": "Sure, my data is defined by these headers A1, A2, A1_A2, and so on. The headers will always be in this A# or A#_A# format, but the numbers will change from case to case. Further more if in a case I have A1, A2, A1_A2, my need is to multiply my the data in A1_A2, by the data in the column A1 and the data in the column A2. I was trying to develop a macro that would look at the left and right two characters of the header, e.g, A1_A2, and look in a range for columns with the headers A1 and A2. If A1 and A2 are found, then multiply the data in these two columns by the data in the column with A1_A2."}, {"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441824509, "post_id": 32486290, "comment_id": 52834870, "body": "Yes @ScottCraner, that&#39;s correct."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1441825119, "post_id": 32486960, "comment_id": 52835134, "body": "Ah, you&#39;re right! I was playing around earlier and had it as an array formula. I must&#39;ve forgot I removed that part."}, {"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441825260, "post_id": 32486960, "comment_id": 52835206, "body": "Thank you for the cool formula @BruceWayne! The problem is that the number of A# and A#_A# columns is variable. In one case I could have columns with A1, A2, A3, A4, A1_A2, A1_A5, A2_A3, A4_A8, which based on my spacing conventions would only occupy columns A:I."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1441825198, "last_edit_date": 1441825198, "creation_date": 1441824008, "answer_id": 32486960, "question_id": 32486290, "link": "https://stackoverflow.com/questions/32486290/multiply-multiple-columns-based-on-if-then-logic/32486960#32486960", "title": "Multiply multiple columns based on if then logic", "body": "<p>If you don't mind a formula I got an Array Formula that works.</p>\n\n<p>Here's how the Data is laid out (you may need to adjust formula if it's different for you):</p>\n\n<p><a href=\"https://i.stack.imgur.com/eylCc.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eylCc.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The formula to put in <code>I2</code> is:\n<code>=IF(AND(COUNTIF($A$1:$G$1,LEFT(I$1,2)),COUNTIF($A$1:$G$1,RIGHT(I$1,2))),INDEX($A2:$G2,,MATCH(LEFT(I$1,2),$A$1:$B$1,0))*INDEX($A2:$G2,,MATCH(RIGHT(I$1,2),$A$1:$B$1,0))*INDEX($A2:$G2,,MATCH(I$1,$A$1:$G$1,0)),INDEX($A2:$G2,,MATCH(RIGHT(I$1,2),$A$1:$B$1,0))*INDEX($A2:$G2,,MATCH(I$1,$A$1:$G$1,0)))</code> </p>\n\n<p><s>and confirm with <code>CTRL+SHIFT+ENTER</code>.</s>  Just hit <code>ENTER</code>.</p>\n\n<p>This is basically three index/match formulas multiplied together.  The Index/Matching is using the left and right 2 characters of your header to find the column with the appropriate number.</p>\n\n<p>PS: Just for anyone else, here's the table of info in text form (so you can copy/paste). The brackets represent an empty column separating the others.</p>\n\n<pre><code>A1  A5  []  A1_A5   A3_A1   A3_A5   A9_A5   []  A1_A5   A3_A1   A3_A5   A9_A5\n16  16      61      17      38      46                  \n41  6       6       58      22      95                  \n39  38      19      37      92      14                  \n98  99      64      74      53      88                  \n14  35      92      47      34      58                  \n18  76      93      20      54      25                  \n94  47      78      37      96      44                  \n32  25      61      61      66      39                  \n9   74      31      43      75      22                  \n8   19      14      83      9       89\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441826689, "post_id": 32487179, "comment_id": 52835906, "body": "@user3290799 Is there something wrong with this approach in your case?"}, {"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441827514, "post_id": 32487179, "comment_id": 52836302, "body": "The problem is that the number of A# and A#_A# columns is variable. In one case I could have columns with A1, A2, A3, A4, A1_A2, A1_A5, A2_A3, A4_A8, which based on my spacing conventions would only occupy columns A:I."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441827646, "post_id": 32487179, "comment_id": 52836366, "body": "You could use named ranges in that case. This should still work."}, {"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441827955, "post_id": 32487179, "comment_id": 52836520, "body": "Oh OK, thanks ! I&#39;m not really sure whats going on with the brackets."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441904824, "post_id": 32487179, "comment_id": 52874673, "body": "@user3290799 You can learn about the <a href=\"http://blog.excelhero.com/2010/06/05/when_working_in_vba_we/\" rel=\"nofollow noreferrer\">square brackets here</a>."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 1, "last_activity_date": 1441826625, "last_edit_date": 1441826625, "creation_date": 1441824779, "answer_id": 32487179, "question_id": 32486290, "link": "https://stackoverflow.com/questions/32486290/multiply-multiple-columns-based-on-if-then-logic/32487179#32487179", "title": "Multiply multiple columns based on if then logic", "body": "<p>Here is a normal (non-array) formula to do it. Just enter it into cell <code>I2</code> and copy as needed:</p>\n\n<pre><code>=INDEX($D2:$G2,MATCH(I$1,$D$1:$G$1,))    *    IFERROR(INDEX($A2:$B2,MATCH(LEFT(I$1,2),$A$1:$B$1,)),1)   *    IFERROR(INDEX($A2:$B2,MATCH(RIGHT(I$1,2),$A$1:$B$1,)),1)\n</code></pre>\n\n<p>If you want this automated, you can use this VBA:</p>\n\n<pre><code>Public Sub excelhero()\n    [i2].Formula = \"=INDEX($D2:$G2,MATCH(I$1,$D$1:$G$1,))    *    IFERROR(INDEX($A2:$B2,MATCH(LEFT(I$1,2),$A$1:$B$1,)),1)   *    IFERROR(INDEX($A2:$B2,MATCH(RIGHT(I$1,2),$A$1:$B$1,)),1)\"\n    [i2].Copy [i2:L11]\n    [i2:L11].Value = [i2:L1].Value   '&lt;-- replaces formulas with literal values\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441826038, "post_id": 32487243, "comment_id": 52835587, "body": "Thank you very much @ScottCraner! I&#39;ll definitely have to read up on Split,  and L/RBound."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "edited": false, "score": 0, "creation_date": 1441826220, "post_id": 32487243, "comment_id": 52835672, "body": "@user3290799 That was just encase you ever want more than two columns in the title.  The problem was two things. 1. find out if it has a formula and add to it. 2. your counter needed a reset.  And just looking it over again, The second one could be dispatched if you switch your two outer loops."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1441825059, "creation_date": 1441825059, "answer_id": 32487243, "question_id": 32486290, "link": "https://stackoverflow.com/questions/32486290/multiply-multiple-columns-based-on-if-then-logic/32487243#32487243", "title": "Multiply multiple columns based on if then logic", "body": "<p>if you want it in VBA:</p>\n\n<pre><code>Sub IfThenLogic2()\nDim SrchRng1 As Range, cel1 As Range\nDim SrchRng2 As Range, cel2 As Range\nDim i As Integer\nDim sht As Worksheet\nSet sht = Sheets(\"Sheet2\")\nSet SrchRng1 = sht.Range(\"A1:B1\")\nSet SrchRng2 = sht.Range(\"D1:G1\")\n\n\nDim title() As String\nc = 13\n\nFor Each cel1 In SrchRng1\n\n    For Each cel2 In SrchRng2\n    title = Split(cel2, \"_\")\n        For i = LBound(title) To UBound(title)\n            If title(i) = cel1.Value Then\n            'If cel1.Value = cel2.Value Then\n            For r = 2 To 11\n                If sht.Cells(r, c).HasFormula Then\n                    sht.Cells(r, c).Formula = sht.Cells(r, c).Formula &amp; \"*\" &amp; cel1.Offset(r - 1, 0).Address\n                Else\n                    sht.Cells(r, c).Formula = \"=\" &amp; cel1.Offset(r - 1, 0).Address &amp; \"*\" &amp; cel2.Offset(r - 1, 0).Address\n                End If\n            Next r\n\n            End If\n        Next i\n        c = c + 1\n    Next cel2\n    c = 13\nNext cel1\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 775, "user_id": 3290799, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/222179b69991a27a161a7d42b7bdb433?s=128&d=identicon&r=PG&f=1", "display_name": "RTrain3k", "link": "https://stackoverflow.com/users/3290799/rtrain3k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1840, "favorite_count": 0, "accepted_answer_id": 32487243, "answer_count": 3, "score": 1, "last_activity_date": 1441826625, "creation_date": 1441821401, "question_id": 32486290, "link": "https://stackoverflow.com/questions/32486290/multiply-multiple-columns-based-on-if-then-logic", "title": "Multiply multiple columns based on if then logic", "body": "<p>I'm trying to formulate vba logic that will multiply cells in one column by other columns based on the header name. For example if I have the data below: \n<a href=\"https://i.stack.imgur.com/7f23g.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7f23g.png\" alt=\"enter image description here\"></a></p>\n\n<p>In column I, I'm trying to multiply cell range A2:A11 by B2:B11 by D2:D11. Since the value in A1 is the same as the left two characters in D1 and B1 is the same as the right two characters in D1. In column J it would be cell range A2:A11 multiply by E2:E11 and so on. The result should look as follows: \n<a href=\"https://i.stack.imgur.com/dAUTL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dAUTL.png\" alt=\"enter image description here\"></a></p>\n\n<p>The macro is attempting to do this by comparing the cell values in cell rage A1:B1 to D1:G1, but what I cannot figure out is how to multiply 3 cell ranges together.</p>\n\n<p>Vba:</p>\n\n<pre><code>Sub IfThenLogic2()\nDim SrchRng1 As Range, cel1 As Range\nDim SrchRng2 As Range, cel2 As Range\n\nSet SrchRng1 = Sheets(\"Sheet2\").Range(\"A1:B1\")\nSet SrchRng2 = Sheets(\"Sheet2\").Range(\"F1:G1\")\n\n\nc = 13\n\nFor Each cel1 In SrchRng1\n\n    For Each cel2 In SrchRng2\n    If (cel1.Value = Left(cel2.Value, 2) Or cel1.Value = Right(cel2.Value, 2)) Then\n    'If cel1.Value = cel2.Value Then\n        For r = 2 To 11\n            Cells(r, c).FormulaR1C1 = \"=\" &amp; cel1.Offset(r - 1, 0).Address(ReferenceStyle:=xlR1C1) &amp; \"*\" &amp; cel2.Offset(r - 1, 0).Address(ReferenceStyle:=xlR1C1) &amp; \"\"\n        Next r\n        c = c + 1\n        End If\n    Next cel2\nNext cel1\n\n\nEnd Sub\n</code></pre>\n\n<p>The <code>OR</code> operator produces (as expected):\n<a href=\"https://i.stack.imgur.com/ft4xX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ft4xX.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is there perhaps a better way to accomplish this by not using <code>for each loops</code>?\nThanks for any suggestions!</p>\n"}, {"tags": ["vba", "excel", "ssas"], "comments": [{"owner": {"reputation": 223, "user_id": 1091602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00a5546f78fa364361dc96d34079ea9c?s=128&d=identicon&r=PG", "display_name": "Travis", "link": "https://stackoverflow.com/users/1091602/travis"}, "edited": false, "score": 0, "creation_date": 1454430344, "post_id": 32486195, "comment_id": 58035610, "body": "I&#39;m experiencing the same behavior.  Did you ever find a solution?"}, {"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "reply_to_user": {"reputation": 223, "user_id": 1091602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00a5546f78fa364361dc96d34079ea9c?s=128&d=identicon&r=PG", "display_name": "Travis", "link": "https://stackoverflow.com/users/1091602/travis"}, "edited": false, "score": 0, "creation_date": 1455305198, "post_id": 32486195, "comment_id": 58447300, "body": "@Travis not really a work around, but  you can turn off screen updating. That only helps the looks, not the speed though."}, {"owner": {"reputation": 223, "user_id": 1091602, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00a5546f78fa364361dc96d34079ea9c?s=128&d=identicon&r=PG", "display_name": "Travis", "link": "https://stackoverflow.com/users/1091602/travis"}, "edited": false, "score": 0, "creation_date": 1455394833, "post_id": 32486195, "comment_id": 58474178, "body": "Thanks, I ended up turning to Power Query to get the needed data from the SSAS cube which avoided the filtering change problems I was having."}], "answers": [{"comments": [{"owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "edited": false, "score": 0, "creation_date": 1455655350, "post_id": 35387447, "comment_id": 58583034, "body": "I timed this by logging the start and end time of adding the <code>CubeFields . It didn&#39;t make any difference to include </code>ManualUpdate=True` before each action."}], "tags": [], "owner": {"reputation": 9093, "user_id": 5070440, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/338bae7e3d7db140be2d1544e859f9f2?s=128&d=identicon&r=PG", "display_name": "GregGalloway", "link": "https://stackoverflow.com/users/5070440/greggalloway"}, "is_accepted": false, "score": 1, "last_activity_date": 1455413739, "creation_date": 1455413739, "answer_id": 35387447, "question_id": 32486195, "link": "https://stackoverflow.com/questions/32486195/defer-layout-update-of-pivottable/35387447#35387447", "title": "Defer Layout Update of PivotTable", "body": "<p>My experience with ManualUpdate has been equally frustrating. There appear to be some actions where it doesn't work. </p>\n\n<p>My only advice would be to try setting  ManualUpdate = True before each individual action that changes the pivot. So in your code put ManualUpdate = True before each line that says CubeFields. I have had some success that way. </p>\n"}], "owner": {"reputation": 1556, "user_id": 5061821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3880a7c7ddf65d95ddd3152bd13a41b5?s=128&d=identicon&r=PG", "display_name": "Wyatt Shipman", "link": "https://stackoverflow.com/users/5061821/wyatt-shipman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1508, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1455413739, "creation_date": 1441821036, "last_edit_date": 1441823939, "question_id": 32486195, "link": "https://stackoverflow.com/questions/32486195/defer-layout-update-of-pivottable", "title": "Defer Layout Update of PivotTable", "body": "<p>I am creating some VBA Functions in Excel to build some PivotTable templates off of an Analysis Services Cube. For speed of execution and updating, I would like to use the functionality of the check box for Defer Layout Update. I expect the fields to be added all at once and then update at the end of the <code>With</code> block. I have tried:</p>\n\n<pre><code>With ActiveSheet.PivotTables(ptName)\n    .ManualUpdate = True\n    .CubeFields(\"[Fiscal Week Code - Last Week]\").Orientation = xlColumnField\n    .CubeFields(\"[DimDate].[Date]\").Orientation = xlRowField\n    .ManualUpdate = False\nEnd With\n</code></pre>\n\n<p>But the ManualUpdate Property isn't working appropriately according to this <a href=\"https://msdn.microsoft.com/en-us/library/office/ff823168.aspx\" rel=\"nofollow\">MSDN</a> article. MSDN says it is a read/write property, and the object browser doesn't mention it being a read-only property.</p>\n\n<p>I also tried with a PivotTable that is connected to a spreadsheet for the source data and the property didn't work there either.</p>\n\n<p>Thanks in advance!</p>\n\n<p>-Wyatt</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1441820996, "creation_date": 1441820996, "answer_id": 32486181, "question_id": 32485769, "link": "https://stackoverflow.com/questions/32485769/how-to-delete-search-folders/32486181#32486181", "title": "How to delete Search Folders", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863914.aspx\" rel=\"nofollow\">Delete</a> method of the Folder class. </p>\n"}], "owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 267, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1441820996, "creation_date": 1441819367, "last_edit_date": 1441819918, "question_id": 32485769, "link": "https://stackoverflow.com/questions/32485769/how-to-delete-search-folders", "title": "How to delete Search Folders", "body": "<p>Is it possible to delete Search Folders in Outlook using VBA?</p>\n\n<p>I'm trying to figure out, but I don't know how to do it.</p>\n\n<p>My goal is to make a search folder as a temporary storage of my mails and delete it after accessing the emails inside the search folder. I already have the code for creating search folder. But what I want to do is delete the search folder.</p>\n\n<p>I found a code in slipstick.com but my knowledge is not enough to understand the whole process of the program:</p>\n\n<p><a href=\"http://www.slipstick.com/developer/create-an-outlook-search-folder-using-vba/\" rel=\"nofollow\">http://www.slipstick.com/developer/create-an-outlook-search-folder-using-vba/</a></p>\n"}, {"tags": ["vba", "solidworks"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4613674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4f2fdd68568dd9492c2ccccce8dfa7?s=128&d=identicon&r=PG&f=1", "display_name": "JDP", "link": "https://stackoverflow.com/users/4613674/jdp"}, "edited": false, "score": 0, "creation_date": 1441825052, "post_id": 32486719, "comment_id": 52835108, "body": "Thanks, that&#39;s super helpful. I&#39;ve been reading a bit about objects vs interfaces, and your examples are really helpful, but somehow it&#39;s still not quite coming into focus. I think it&#39;s largely due to my shaky knowledge of object oriented languages in general. I&#39;m also having trouble finding almost any objects at all in the API that I&#39;m looking at. Maybe that&#39;s intentional for the reasons that you&#39;re mentioning."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 25, "user_id": 4613674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4f2fdd68568dd9492c2ccccce8dfa7?s=128&d=identicon&r=PG&f=1", "display_name": "JDP", "link": "https://stackoverflow.com/users/4613674/jdp"}, "edited": false, "score": 0, "creation_date": 1441826380, "post_id": 32486719, "comment_id": 52835760, "body": "I don&#39;t have Solidworks, but my guess is that the objects are exposed as a single hierarchy. There would be the Solidworks parent object and all the other objects would be levels of children below it."}, {"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "reply_to_user": {"reputation": 25, "user_id": 4613674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4f2fdd68568dd9492c2ccccce8dfa7?s=128&d=identicon&r=PG&f=1", "display_name": "JDP", "link": "https://stackoverflow.com/users/4613674/jdp"}, "edited": false, "score": 0, "creation_date": 1441826429, "post_id": 32486719, "comment_id": 52835777, "body": "@JamesPettit In Excel for example, you can create Shapes. Suppose I created a circle on the default Sheet1 of the Excel workbook through the Insert ribbon tab. I would then reference it in code by <code>Excel.Sheets(1).Shapes(1)</code>. You couldn&#39;t simply write <code>Dim thing as Shape; Set thing = new Shape</code> to create a new shape because shapes must have an existence on a particular worksheet - they can&#39;t exist in an abstract sense. Instead, you would have to let the hierarchy create it for you, automatically associating it with a parent object: <code>Excel.Sheet(1).Shapes.AddShape()</code>"}], "tags": [], "owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "is_accepted": false, "score": 0, "last_activity_date": 1441823082, "creation_date": 1441823082, "answer_id": 32486719, "question_id": 32485627, "link": "https://stackoverflow.com/questions/32485627/understanding-interfaces-vs-objects-in-api/32486719#32486719", "title": "Understanding Interfaces vs Objects in API", "body": "<p>There are plenty of articles which can explain the difference between objects and interfaces, but my understanding is that it boils down to this: Interfaces separate behavior from implementation. In many cases, this is used to allow dissimilar objects to be used collectively for a similar purpose. For example, you might have <code>Car</code>, <code>Bike</code>, <code>Truck</code>, <code>Boat</code>, <code>Train</code> and <code>Bus</code> classes which are all very different, but if they all implement an <code>ITransportation</code> interface with a single method called <code>transport(person, destination)</code>, I don't have to care about the underlying differences to move people around. </p>\n\n<p>In this case, though, I suspect that the interface is being used for future backwards compatibility. Suppose that 10-15 years down the road Solidworks is up to <code>ModelDoc34</code>. If your code is expecting the same set of properties and functions as <code>ModelDoc2</code>, you would more than likely be disappointed. However, suppose that <code>ModelDoc34</code> implements the <code>IModelDoc2</code> interface - that is, the developers provide a limited set of the new functionality that matches exactly the set of properties and functions of the old <code>ModelDoc2</code> class to allow your code to still be able to run, as long as you reference the new class name. In a similar vein as the earlier analogy, imagine it's 50 years into the future. Cars no longer have any manual controls, you just punch in your destination and away it goes. If the developers wanted to make this car backwards compatible, they could implement the <code>IStandardCar</code> interface which would include things like gas/brake pedals and a steering wheel. </p>\n\n<p>If you want to write your code to be as future-proof as possible, you would declare your variables to be of type <code>IModelDoc2</code>. Let the Solidworks API do the work of figuring out what the underlying object type will be and you can write your code as if it was always just a <code>ModelDoc2</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 4613674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de4f2fdd68568dd9492c2ccccce8dfa7?s=128&d=identicon&r=PG&f=1", "display_name": "JDP", "link": "https://stackoverflow.com/users/4613674/jdp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 542, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444319158, "creation_date": 1441818817, "last_edit_date": 1444319158, "question_id": 32485627, "link": "https://stackoverflow.com/questions/32485627/understanding-interfaces-vs-objects-in-api", "title": "Understanding Interfaces vs Objects in API", "body": "<p>So I've been using the API for Solidworks quite a bit at work to write very simple VBA scripts for task automation. It's been really helpful, but to say I'm not a programmer is a huge understatement. The thing I'm currently struggling with is why everything in the API seems to have an I in front of its name.</p>\n\n<p>The API reference is <a href=\"http://help.solidworks.com/2013/English/api/SWHelp_List.html?id=c64d3add5f4443bba1a7070ab6358873#Pg0\" rel=\"nofollow\">here</a> and everything is preceded by an I. It seems to work as well or better if I just declare things for instance as Sldworks.ModelDoc2 rather than IModelDoc2 as the API says. I've googled this quite a bit, and it seems to have something to do with interfaces vs. objects, but I'm not fully understanding the distinction. I feel like I'm missing something really obvious, but it hasn't come to me yet.</p>\n\n<p>Can anyone shed some light on what the I's are doing, and why things seem to work fine without them?</p>\n\n<p><strong>Edit:</strong> As a follow up, I ended up finding <a href=\"http://help.solidworks.com/2012/english/api/sldworksapiprogguide/OVERVIEW/In-process_Methods.htm\" rel=\"nofollow\">this</a>, which explains what the I was doing in the Solidworks API. It seems like it isn't exactly related to interfaces after all. </p>\n"}, {"tags": ["excel", "vba", "variables"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441816467, "post_id": 32484914, "comment_id": 52830817, "body": "So, you want to loop through each sheet and then use an if statement or case select statement to determine what to clear on any given sheet?"}], "answers": [{"tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 1, "last_activity_date": 1441817249, "creation_date": 1441817249, "answer_id": 32485191, "question_id": 32484914, "link": "https://stackoverflow.com/questions/32484914/reference-a-worksheet-via-a-variable/32485191#32485191", "title": "Reference a worksheet via a variable", "body": "<p>If you have just a few sheets that you wish to clear a range on, it's easy to reference them all at the same time like so:</p>\n\n<pre><code>Sheets(Array(\"Sheet36\", \"Sheet37\").Range(\"B3:T201\").ClearContents\n</code></pre>\n\n<p>But if you really want to loop all of the sheets, then this is how:</p>\n\n<pre><code>Dim sh\nFor Each sh In Worksheets\n    sh.Range(\"B3:T201\").ClearContents\nNext\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 1, "creation_date": 1441818939, "post_id": 32485339, "comment_id": 52832111, "body": "Each worksheet in a workbook is already a member of two built-in collections: <code>Sheets</code> and <code>Worksheets</code>. What would be the purpose of overtly adding them to another collection with regards to this question?"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1441827500, "post_id": 32485339, "comment_id": 52836298, "body": "I don&#39;t think the Op wants to iterate through the Worksheets collection of the Workbook object (ie every worksheet sheet). I think he wants to iterate through a list he&#39;s generated of specific worksheets (ie only some sheets). This answer was meant to show him a way of adding just those worksheets to his own iterable collection."}, {"owner": {"reputation": 9, "user_id": 5317996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b30155944b8b7989a89dbc2367f2d1?s=128&d=identicon&r=PG&f=1", "display_name": "Werdna", "link": "https://stackoverflow.com/users/5317996/werdna"}, "edited": false, "score": 0, "creation_date": 1441871791, "post_id": 32485339, "comment_id": 52852147, "body": "Thanks All. Second solution fits my need better (as i only want to clear certain sheets)."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 0, "last_activity_date": 1441849093, "last_edit_date": 1592644375, "creation_date": 1441817753, "answer_id": 32485339, "question_id": 32484914, "link": "https://stackoverflow.com/questions/32484914/reference-a-worksheet-via-a-variable/32485339#32485339", "title": "Reference a worksheet via a variable", "body": "<p><strong>Clarification added thanks to ExcelHero.</strong></p>\n<p>You could use a Collection of the specific worksheets you are interested in. Something like:</p>\n<pre><code>Private mChosenSheets As Collection\n\nSub Init()\n    Set mChosenSheets = New Collection\n    \n    ' Add here whichever worksheets you want in your iterable list\n    mChosenSheets.Add Sheet6\n    mChosenSheets.Add Sheet36\n    mChosenSheets.Add Sheet38\n    ' etc...\n    \nEnd Sub\n\nSub ClearChosenSheets()\n    Dim sht As Worksheet\n    \n    For Each sht In mChosenSheets\n        sht.Range(&quot;B3:T201&quot;).ClearContents\n    Next\n    \nEnd Sub\n</code></pre>\n<p>The <code>Workbook.Worksheets</code> collection can be used if you just want to iterate through every worksheet in the workbook.</p>\n"}], "owner": {"reputation": 9, "user_id": 5317996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5b30155944b8b7989a89dbc2367f2d1?s=128&d=identicon&r=PG&f=1", "display_name": "Werdna", "link": "https://stackoverflow.com/users/5317996/werdna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 32485339, "answer_count": 2, "score": 0, "last_activity_date": 1441849093, "creation_date": 1441816320, "last_edit_date": 1441822106, "question_id": 32484914, "link": "https://stackoverflow.com/questions/32484914/reference-a-worksheet-via-a-variable", "title": "Reference a worksheet via a variable", "body": "<p>I want to reference Sheets within a Workbook via an index. - essentially as I want to run through a loop and clear certain cells on several worksheets. </p>\n\n<p>At present I've written some vba which includes code like: </p>\n\n<p>Sheet36.Activate \nRange(\"B3:T201\").ClearContents</p>\n\n<p>repeated each time for each sheet, for instance: \nSheet37.Activate \nRange(\"B3:T201\").ClearContents</p>\n\n<p>All answers appreciated.</p>\n"}, {"tags": ["excel", "ms-access", "vba", "export-to-excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441816032, "post_id": 32484761, "comment_id": 52830570, "body": "One way would be to load everything then sort on the Pet_Type field then loop through till it changes and create a new sheet each time with the new Pet_type value becoming the name of the sheet."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441816885, "post_id": 32484761, "comment_id": 52831041, "body": "It would be much easier to use transferspreadsheet and suitable queries."}, {"owner": {"reputation": 329, "user_id": 2443317, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/VVHBJ.jpg?s=128&g=1", "display_name": "ealfons1", "link": "https://stackoverflow.com/users/2443317/ealfons1"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441818709, "post_id": 32484761, "comment_id": 52832007, "body": "@Fionnuala: Updated the VBA to reflect the easier way of using my current approach."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441819245, "post_id": 32484761, "comment_id": 52832266, "body": "With Fionnuala&#39;s approach you still need to create a new query for each distinct animal type.  To do this use sql to get a distinct list of animals then step through them creating each query dynamically.  Look <a href=\"http://stackoverflow.com/questions/390420/create-a-query-dynamically-through-code-in-msaccess-2003-vba\">here</a> for instruction on how to do that."}], "answers": [{"tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1441821132, "last_edit_date": 1441821132, "creation_date": 1441820669, "answer_id": 32486103, "question_id": 32484761, "link": "https://stackoverflow.com/questions/32484761/export-access-data-into-excel-workbook-and-split-data-into-multiple-sheets-based/32486103#32486103", "title": "Export Access data into Excel workbook and split data into multiple sheets based on column value", "body": "<p>Load a single recordset based on a query which gives you the unique pet types ...</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT DISTINCT p.Pet_Type\nFROM Pets_data_table AS p;\n</code></pre>\n\n<p>Then walk that recordset, alter a saved query (<em>qryExportMe</em>) to <code>SELECT</code> the current <code>Pet_Type</code>, and export the query ...</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As DAO.Database\nDim qdf As DAO.QueryDef\nDim rs As DAO.Recordset\nDim strPath As String\nDim strSelectOneType As String\nDim strSelectPetTypes As String\n\n' (change strPath back to what you need)\nstrPath = CurrentProject.Path &amp; Chr(92) &amp; \"Pets_dataset_export_\" &amp; _\n    Format(Date, \"yyyy-mm-dd\") &amp; \".xlsx\"\nstrSelectPetTypes = \"SELECT DISTINCT p.Pet_Type\" &amp; vbCrLf &amp; _\n    \"FROM Pets_data_table AS p;\"\n\nSet db = CurrentDb\nSet rs = db.OpenRecordset(strSelectPetTypes, dbOpenSnapshot)\nDo While Not rs.EOF\n    strSelectOneType = \"SELECT p.ID, p.Pet_Type, p.Pet_Owner\" &amp; vbCrLf &amp; _\n        \"FROM Pets_data_table AS p\" &amp; vbCrLf &amp; _\n        \"WHERE p.Pet_Type='\" &amp; rs!Pet_Type.Value &amp; \"';\"\n    Debug.Print strSelectOneType\n    Set qdf = db.QueryDefs(\"qryExportMe\")\n    qdf.SQL = strSelectOneType\n    qdf.Close\n    DoCmd.TransferSpreadsheet acExport, acSpreadsheetTypeExcel12Xml, _\n        \"qryExportMe\", strPath, True, rs!Pet_Type.Value\n    rs.MoveNext\nLoop\nrs.Close\n</code></pre>\n\n<p>Note that code requires that the saved query, <em>qryExportMe</em>, exists.  But its SQL property doesn't matter because you'll change it each time through the main <code>Do While</code> loop.</p>\n"}], "owner": {"reputation": 329, "user_id": 2443317, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/VVHBJ.jpg?s=128&g=1", "display_name": "ealfons1", "link": "https://stackoverflow.com/users/2443317/ealfons1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3345, "favorite_count": 0, "accepted_answer_id": 32486103, "answer_count": 1, "score": 1, "last_activity_date": 1441821132, "creation_date": 1441815840, "last_edit_date": 1441818669, "question_id": 32484761, "link": "https://stackoverflow.com/questions/32484761/export-access-data-into-excel-workbook-and-split-data-into-multiple-sheets-based", "title": "Export Access data into Excel workbook and split data into multiple sheets based on column value", "body": "<p><strong>Sample data (local Access table called 'Pets_data_table')</strong></p>\n\n<pre><code>ID | Pet_Type | Pet_Owner\n\n1      Dog        Jane Doe         \n2      Cat        John Doe\n3      Hamster    Bob Doe\n4      Dog        Melissa Doe \n5      Cat        Aaron Doe\n</code></pre>\n\n<p>At the moment, I can export the data in this table to one Excel workbook, and split the data into multiple sheets within that Excel workbook according to distinct values of a specific field. I use the following VBA to split the data according to distinct values of the 'Pet_Type' field:</p>\n\n<pre><code>    Dim db As DAO.Database\n    Set db = CurrentDb()\n    Dim strPath As String\n    strPath = \"C:\\Desktop\\\" &amp; \"Pets_dataset_export_\" &amp; format(date(),\"yyyy-mm-dd\") &amp; \".xlsx\" \n    DoCmd.TransferSpreadsheet acExport, 10, \"Qry - Dog\", strPath, True, \"Dog\"\n    DoCmd.TransferSpreadsheet acExport, 10, \"Qry - Cat\", strPath, True, \"Cat\"\n    DoCmd.TransferSpreadsheet acExport, 10, \"Qry - Hamster\", strPath, True, \"Hamster\"\n\n    Set db = Nothing\n    MsgBox \"Export operation completed\"\n</code></pre>\n\n<p>This performs well when the field I am splitting the data with has a small number of distinct values. </p>\n\n<p>However, it is inefficient when there are a large number of distinct values in the field I want to split the data with.</p>\n\n<p>I would like to implement a more dynamic approach that allows me to split a dataset with a field that has 1...n number of distinct values.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 45, "user_id": 4651080, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/x8fZ2.png?s=128&g=1", "display_name": "Rynoc", "link": "https://stackoverflow.com/users/4651080/rynoc"}, "edited": false, "score": 0, "creation_date": 1441818344, "post_id": 32484747, "comment_id": 52831818, "body": "Does the detail footer not load before the page footer?"}, {"owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "edited": false, "score": 0, "creation_date": 1441820227, "post_id": 32484747, "comment_id": 52832743, "body": "You&#39;re trying to sum a calculated field. MS doesn&#39;t store the values of calculated fields so this isn&#39;t going to work. Instead of sum(Text34) try sum([record source of textbox 34]), so if text34 is =(nz([TL],0)+nz([TM],0) you would do SUM(nz([TL],0)+nz([TM],0))."}, {"owner": {"reputation": 45, "user_id": 4651080, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/x8fZ2.png?s=128&g=1", "display_name": "Rynoc", "link": "https://stackoverflow.com/users/4651080/rynoc"}, "reply_to_user": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "edited": false, "score": 0, "creation_date": 1441822917, "post_id": 32484747, "comment_id": 52834051, "body": "Ah, I usually use the <code>NZ</code> function.. except I got lazy this time and used sum!  Mark this as an answer and i&#39;ll add it."}], "answers": [{"tags": [], "owner": {"reputation": 402, "user_id": 4555708, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75c3e6254a423100c074be583a775a51?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/4555708/gene"}, "is_accepted": true, "score": 0, "last_activity_date": 1441830722, "creation_date": 1441830722, "answer_id": 32488651, "question_id": 32484747, "link": "https://stackoverflow.com/questions/32484747/adding-footer-to-report-causes-erros-ms-access-07/32488651#32488651", "title": "Adding footer to report causes erros [MS Access 07]", "body": "<p>Access does not store the values of calculated fields. As a result you can't sum the values that it produces. Instead of summing the calculated field, sum the calculation used to produce it.</p>\n\n<p>example:</p>\n\n<pre><code>textbox24 = nz([TL],0) + nz([TM],0)\n</code></pre>\n\n<p>to sum this field use:</p>\n\n<pre><code>sum_field = sum(nz([TL],0) + nz([TM],0))\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4651080, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/x8fZ2.png?s=128&g=1", "display_name": "Rynoc", "link": "https://stackoverflow.com/users/4651080/rynoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 32488651, "answer_count": 1, "score": 0, "last_activity_date": 1441830722, "creation_date": 1441815806, "question_id": 32484747, "link": "https://stackoverflow.com/questions/32484747/adding-footer-to-report-causes-erros-ms-access-07", "title": "Adding footer to report causes erros [MS Access 07]", "body": "<p>I have a form that opens a report based on two combo boxes. It is opening an invoice for shipments. You can either open the report based on customer or shipment. Everything works fine for shipments and the total for all items is added correctly. However when I add a grand total within the page footer I am suddenly unable to open the form because access asks what the total is. I have a attached a picture to help explain better.</p>\n\n<p><a href=\"https://i.stack.imgur.com/dGl7A.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dGl7A.jpg\" alt=\"Explination\"></a></p>\n"}, {"tags": ["vba", "outlook", "ampersand"], "comments": [{"owner": {"reputation": 58518, "user_id": 1623007, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/40931bddde219f1a9e4514d2f4cfa826?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/1623007/joe"}, "edited": false, "score": 0, "creation_date": 1441814978, "post_id": 32484435, "comment_id": 52829865, "body": "My guess is it&#39;s the same as <a href=\"http://stackoverflow.com/questions/23129359/how-to-put-an-ampersand-in-a-header-footer-in-excel\">this question</a> - double the ampersand."}, {"owner": {"reputation": 2080, "user_id": 3100456, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3749442ae7500c62ca244a0631024055?s=128&d=identicon&r=PG&f=1", "display_name": "Orphid", "link": "https://stackoverflow.com/users/3100456/orphid"}, "edited": false, "score": 0, "creation_date": 1441815314, "post_id": 32484435, "comment_id": 52830122, "body": "Also, <code>olItms</code> is <code>Dim</code>med but not initialized in the code sample"}, {"owner": {"reputation": 63, "user_id": 4462912, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1a4995ae9cff3f035b3198c8700b1525?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/4462912/ken"}, "edited": false, "score": 0, "creation_date": 1441815374, "post_id": 32484435, "comment_id": 52830165, "body": "Thanks for the input Joe. Unfortunately I tried that and still have the issue. Thanks you Orphid, I will add it now."}], "answers": [{"comments": [{"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 63, "user_id": 4462912, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1a4995ae9cff3f035b3198c8700b1525?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/4462912/ken"}, "edited": false, "score": 0, "creation_date": 1441817046, "post_id": 32484817, "comment_id": 52831133, "body": "Did you try to debug the code? What error do you get?"}, {"owner": {"reputation": 63, "user_id": 4462912, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1a4995ae9cff3f035b3198c8700b1525?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/4462912/ken"}, "edited": false, "score": 0, "creation_date": 1441817955, "post_id": 32484817, "comment_id": 52831617, "body": "Awesome! That did it! Yeah I was looking at the .Find method in MSDN and I wasn&#39;t having much luck. So I guess I use Ch(34) for the quotation mark. But yeah, That made it work. Thank you so much."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 63, "user_id": 4462912, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1a4995ae9cff3f035b3198c8700b1525?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/4462912/ken"}, "edited": false, "score": 0, "creation_date": 1441818781, "post_id": 32484817, "comment_id": 52832033, "body": "@Ken : you should now &quot;Accept&quot; this answer by clicking the checkamrk on the left."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1441817105, "last_edit_date": 1441817105, "creation_date": 1441816003, "answer_id": 32484817, "question_id": 32484435, "link": "https://stackoverflow.com/questions/32484435/ampersand-error-with-find/32484817#32484817", "title": "Ampersand (&amp;) error with .Find", "body": "<p>Try to declare a string variable using the Chr(38) statement:</p>\n\n<pre><code>Dim olApp As Outlook.Application\nDim olNs As Namespace\nDim olFldr As MAPIFolder\nDim olMi As MailItem\nDim olItms As Items\nDim subj As String\n\nSet olApp = GetObject(, \"Outlook.Application\")\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet olFldr = olNs.GetDefaultFolder(olFolderInbox)\nSet olItms = olFldr.Items\nSet subj = \"Life\" &amp; Chr(38) &amp; \"Health Insurance\"\n\nSet olMi = olItms.Find(\"[Subject] = \" &amp; Chr(34) &amp; subj &amp; Chr(34)) \n</code></pre>\n\n<p>Also when filtering text fields, you can use either a pair of single quotes (') or a pair of double quotes (\") to delimit the values that are part of the filter. See the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869662.aspx\" rel=\"nofollow\">Find</a> method of the Items class described in MSDN.</p>\n"}], "owner": {"reputation": 63, "user_id": 4462912, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1a4995ae9cff3f035b3198c8700b1525?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/4462912/ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 32484817, "answer_count": 1, "score": 0, "last_activity_date": 1441817105, "creation_date": 1441814852, "last_edit_date": 1441815516, "question_id": 32484435, "link": "https://stackoverflow.com/questions/32484435/ampersand-error-with-find", "title": "Ampersand (&amp;) error with .Find", "body": "<p>I have created a program that searches through my outlook emails for a specific subject line. It works great, however I receive an error whenever one of my strings to search for contains an \"&amp;\" symbol in it. Here is a sample of the code I'm working with.</p>\n\n<pre><code>Dim olApp As Outlook.Application\nDim olNs As Namespace\nDim olFldr As MAPIFolder\nDim olMi As MailItem\nDim olItms As Items\n\nDim subj As String\n\nSet olApp = GetObject(, \"Outlook.Application\")\nSet olNs = olApp.GetNamespace(\"MAPI\")\nSet olFldr = olNs.GetDefaultFolder(olFolderInbox)\nSet olItms = olFldr.Items\n\nsubj = \"Life&amp;Health Insurance\"\n\nSet olMi = olItms.Find(\"[Subject] = \" &amp; subj) \n</code></pre>\n\n<p>I get a \"condition is not valid\" error when it runs into anything with an ampersand. Please help.</p>\n"}, {"tags": ["vba", "ms-word", "clipboard", "word-contentcontrol"], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 1314420, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c2b6de34a1bb2c0bdacf57e8652f4c1c?s=128&d=identicon&r=PG", "display_name": "ffrugone", "link": "https://stackoverflow.com/users/1314420/ffrugone"}, "is_accepted": true, "score": 0, "last_activity_date": 1442431959, "creation_date": 1442431959, "answer_id": 32617162, "question_id": 32484425, "link": "https://stackoverflow.com/questions/32484425/determine-if-new-contentcontrols-were-inserted-after-paste/32617162#32617162", "title": "Determine if New ContentControls Were Inserted After Paste?", "body": "<p>There is an event handler built in that fires after a ContentControl is added:</p>\n\n<pre><code>Private Sub Document_ContentControlAfterAdd(ByVal NewContentControl As ContentControl, ByVal InUndoRedo As Boolean)\n</code></pre>\n\n<p>Put the event handler in the ThisDocument module, (you can automatically create it from the VBA dropdown when inside of ThisDocument).</p>\n\n<p>It doesn't matter how the control is added (both paste and insert commands trigger the event).  Each new ContentControl fires the event.  I can test each one to see if it is already in the document.</p>\n\n<p>Works like a charm.</p>\n"}], "owner": {"reputation": 51, "user_id": 1314420, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c2b6de34a1bb2c0bdacf57e8652f4c1c?s=128&d=identicon&r=PG", "display_name": "ffrugone", "link": "https://stackoverflow.com/users/1314420/ffrugone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 32617162, "answer_count": 1, "score": -1, "last_activity_date": 1545420575, "creation_date": 1441814817, "last_edit_date": 1545420575, "question_id": 32484425, "link": "https://stackoverflow.com/questions/32484425/determine-if-new-contentcontrols-were-inserted-after-paste", "title": "Determine if New ContentControls Were Inserted After Paste?", "body": "<p>I need to determine if any new ContentControls were inserted into a Word 2010 (docx) document after a paste so that I can create a new XML node to which I can map them.</p>\n\n<p>The way I see it, there are two challenges:</p>\n\n<ol>\n<li>How do I capture the paste event? (I've seen suggestions to detect a button combination, or toolbar press, etc.)</li>\n<li>What is the best way to check the pasted content for controls? (Should I check the clipboard, a range in the document, etc.)</li>\n</ol>\n\n<p>Once I have a collection of the new ContentControls, I already have functions that can check for prior existence, and create new mappings if the ContentControls are new.  I just need to be able to detect the presence of a new ContentControl when it is inserted.</p>\n\n<p>****UPDATE****</p>\n\n<p>I have not been able to successfully check the clipboard contents for ContentControls.  I cannot enumerate throught the clipboard data to find the controls.</p>\n"}, {"tags": ["excel", "outlook", "ms-office", "vba"], "comments": [{"owner": {"reputation": 3557, "user_id": 5154907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0123b2acc91eae7a50b5cf298ba1908?s=128&d=identicon&r=PG&f=1", "display_name": "ryuichiro", "link": "https://stackoverflow.com/users/5154907/ryuichiro"}, "edited": false, "score": 0, "creation_date": 1441816447, "post_id": 32484365, "comment_id": 52830807, "body": "I would probably try <a href=\"https://onedrive.live.com/about/en-us/\" rel=\"nofollow noreferrer\">to colaborate</a> using <a href=\"https://office.live.com/start/Excel.aspx?omkt=en-US#\" rel=\"nofollow noreferrer\">Excel online</a>."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441834493, "post_id": 32484365, "comment_id": 52839655, "body": "That method of sending a <b>sheet</b> as the body of an outlook email, actually converts the range to HTML format. The recipient will be able to edit the (all) data if they reply to the email, but the response will also be in HTML format (you&#39;ll need to copy and paste it back into the Excel file)"}], "answers": [{"tags": [], "owner": {"reputation": 5418, "user_id": 519226, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/dSD4J.jpg?s=128&g=1", "display_name": "Eric Legault", "link": "https://stackoverflow.com/users/519226/eric-legault"}, "is_accepted": true, "score": 1, "last_activity_date": 1442005789, "creation_date": 1442005789, "answer_id": 32532157, "question_id": 32484365, "link": "https://stackoverflow.com/questions/32484365/is-is-possible-to-edit-an-excel-workbook-that-has-been-emailed-as-the-body-of-an/32532157#32532157", "title": "Is is possible to edit an excel workbook that has been emailed as the body of an Outlook email", "body": "<p>Unfortunately you cannot make edits and forward the changes when working in the message body (or with a file previewer).</p>\n\n<p>An alternative is to open the email with the attachment and put the email into Edit mode.  You can then open the attachment, make changes and save, then save the email and forward it.</p>\n"}], "owner": {"reputation": 3000, "user_id": 292973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/de98e76d77be51182efd9eb4bddffb2a?s=128&d=identicon&r=PG", "display_name": "Mutuelinvestor", "link": "https://stackoverflow.com/users/292973/mutuelinvestor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7799, "favorite_count": 0, "accepted_answer_id": 32532157, "answer_count": 1, "score": 0, "last_activity_date": 1442005789, "creation_date": 1441814625, "last_edit_date": 1531161705, "question_id": 32484365, "link": "https://stackoverflow.com/questions/32484365/is-is-possible-to-edit-an-excel-workbook-that-has-been-emailed-as-the-body-of-an", "title": "Is is possible to edit an excel workbook that has been emailed as the body of an Outlook email", "body": "<p>I'm trying to find an easy way to disseminate an excel template to a group of people and them input some data and then email the updated template back to me.<br>\nOne alternative that I've investigated is sending the excel template as the body of an outlook email and then have the users make there input and email it back. </p>\n\n<p>I came across this <a href=\"http://www.extendoffice.com/documents/excel/1355-excel-send-sheet-by-email.html#a1\" rel=\"nofollow\">article that explains how to email a workbook as the body of an outlook email</a>. The process works great, however, it appears the emailed spreadsheet can not be edited by the recipient.   </p>\n\n<p>Question:\n**Is it possible to not only email the workbook/template as a body of an outlook email, but also make the template editable so the recipient can input data into select cells. </p>\n"}, {"tags": ["excel", "vba", "vbscript"], "comments": [{"owner": {"reputation": 25, "user_id": 3736073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9412af27b6839a6dfbaf3647ff6cfd30?s=128&d=identicon&r=PG&f=1", "display_name": "user3736073", "link": "https://stackoverflow.com/users/3736073/user3736073"}, "reply_to_user": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "edited": false, "score": 0, "creation_date": 1441815244, "post_id": 32484268, "comment_id": 52830068, "body": "Thank you for the formatting edits @Bond !"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 3736073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9412af27b6839a6dfbaf3647ff6cfd30?s=128&d=identicon&r=PG&f=1", "display_name": "user3736073", "link": "https://stackoverflow.com/users/3736073/user3736073"}, "edited": false, "score": 0, "creation_date": 1441815151, "post_id": 32484382, "comment_id": 52829993, "body": "Ahhh, that makes a great deal of sense!  Thank you!  When I do this, it does not find the value in the second excel sheet, even though when I hardcode the value to find, it finds it no problem.  Any ideas?"}, {"owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "reply_to_user": {"reputation": 25, "user_id": 3736073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9412af27b6839a6dfbaf3647ff6cfd30?s=128&d=identicon&r=PG&f=1", "display_name": "user3736073", "link": "https://stackoverflow.com/users/3736073/user3736073"}, "edited": false, "score": 0, "creation_date": 1441815494, "post_id": 32484382, "comment_id": 52830236, "body": "I would set a breakpoint on your <code>Find()</code> statement and ensure that <code>val</code> is what you expect it to be. The default parameters for <code>Find()</code> will search for a partial match (<code>LookAt:=xlPart</code> vs <code>xlWhole</code>) and also search without regard to case (<code>MatchCase:=False</code>) so it&#39;s pretty &quot;open&quot; by default. The names in Worksheet2 are typed in directly, correct? They&#39;re not formula-driven?"}, {"owner": {"reputation": 25, "user_id": 3736073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9412af27b6839a6dfbaf3647ff6cfd30?s=128&d=identicon&r=PG&f=1", "display_name": "user3736073", "link": "https://stackoverflow.com/users/3736073/user3736073"}, "edited": false, "score": 0, "creation_date": 1441817300, "post_id": 32484382, "comment_id": 52831266, "body": "Thank you - ended up having an exra white space in Worksheet 1 and that is why it wasn&#39;t able to find it in worksheet 2.  Thank you again for all of your help!"}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 0, "last_activity_date": 1441814683, "creation_date": 1441814683, "answer_id": 32484382, "question_id": 32484268, "link": "https://stackoverflow.com/questions/32484268/vbscript-search-excel-workbook-for-value-from-another-workbook/32484382#32484382", "title": "VBScript Search Excel Workbook for Value from another Workbook", "body": "<p>The <code>Find()</code> function returns a <code>Range</code> object if successful or <code>Nothing</code> if not. So you need to test the return value to ensure it's a <code>Range</code> object before you try accessing its properties and methods.</p>\n\n<pre><code>For Each c In objworksheet.Range(\"A2:A3\").Cells\n    val = c.value\n    Set objRange = objWorksheet2.UsedRange\n    Set found = objRange.Find(val)\n\n    ' Test for success!\n    If Not found Is Nothing Then\n        Wscript.Echo found.AddressLocal(False,False)\n    End If\nNext\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 3736073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9412af27b6839a6dfbaf3647ff6cfd30?s=128&d=identicon&r=PG&f=1", "display_name": "user3736073", "link": "https://stackoverflow.com/users/3736073/user3736073"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3593, "favorite_count": 0, "accepted_answer_id": 32484382, "answer_count": 1, "score": 1, "last_activity_date": 1441814924, "creation_date": 1441814291, "last_edit_date": 1441814924, "question_id": 32484268, "link": "https://stackoverflow.com/questions/32484268/vbscript-search-excel-workbook-for-value-from-another-workbook", "title": "VBScript Search Excel Workbook for Value from another Workbook", "body": "<p>I am new to VB scripting, so please, bear with me!  I am trying to create a script that uses worksheets from two different excel workbooks.  It opens the first worksheet and iterates through a specified range.  I want it to then take the value of each cell in that range and search the second worksheet (in a different workbook) and search for the value that was found in the first worksheet, and if the value is found, return the address of the cell it was found in.  For example:</p>\n\n<pre><code>Worksheet1\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 Name \u2551 Age \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Matt \u2551  22 \u2551\n\u2551 Jeff \u2551  13 \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u255d\n\nWorksheet2\n\u2554\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2566\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2557\n\u2551 Name  \u2551    DOB     \u2551\n\u2560\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256c\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2563\n\u2551 Dave  \u2551 09/12/2001 \u2551\n\u2551 Frank \u2551 01/25/1992 \u2551\n\u2551 Jeff  \u2551 10/10/2013 \u2551\n\u255a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2569\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255d\n</code></pre>\n\n<p>So the script would output: <code>A4</code>\nBecause it found one of the values from the specified range (<code>A2:A3</code>) of the first worksheet in the second worksheet and is returning the location of that cell.</p>\n\n<p>Here is the code I have:</p>\n\n<pre><code>Set objExcel = CreateObject(\"Excel.Application\")\nobjExcel.Visible = True\n\nDim val\n\nSet objWorkbook = objExcel.Workbooks.Open(\"C:\\Users\\username\\file.xlsx\")\nSet objWorksheet = objWorkbook.Worksheets(\"Sheet1\")\n\nSet objWorkbook2 = objExcel.Workbooks.Open(\"C:\\Users\\username\\file2.xlsx\")\nSet objWorksheet2 = objWorkbook2.Worksheets(\"Sheet1\")\n\n\nFor Each c In objworksheet.Range(\"A2:A3\").Cells\n    val = c.value\n    Set objRange = objWorksheet2.UsedRange\n    Set found = objRange.Find(val)\n    Wscript.Echo found.AddressLocal(False,False)\nNext\n</code></pre>\n\n<p>When I run this code, I get the following error:</p>\n\n<blockquote>\n  <p>Error: Object required: 'found'</p>\n</blockquote>\n\n<p>I am sure there is something obvious I am missing here but I have been spinning my wheels for quite some time and was hoping someone could provide some feedback.  Any help is greatly appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "edited": false, "score": 0, "creation_date": 1441814903, "post_id": 32484191, "comment_id": 52829800, "body": "What part of the code is giving you the error? I suspect it is here: Sheets(&quot;Time Allocation&quot;).NextRow.PasteSpecial Paste:=1, Operation:=xlNone, SkipBlanks:=False, Transpose:=False"}, {"owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "reply_to_user": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "edited": false, "score": 0, "creation_date": 1441815010, "post_id": 32484191, "comment_id": 52829891, "body": "@ClintStreet yes that&#39;s correct, see updated answer"}, {"owner": {"reputation": 11225, "user_id": 471129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cec5a6cce700294c7c564becb11fa3c1?s=128&d=identicon&r=PG", "display_name": "Erik Eidt", "link": "https://stackoverflow.com/users/471129/erik-eidt"}, "edited": false, "score": 0, "creation_date": 1441815401, "post_id": 32484191, "comment_id": 52830183, "body": "Basic debugging &amp; troubleshooting tip: break your statement down into multiple statements, connected by variables.  <code>Set aSheet = Sheets(&quot;Time Allocation&quot;)</code>, then <code>Set aRow = aSheet.NextRow</code> ...  when you break it down like that you&#39;ll get more insight into the error."}, {"owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "edited": false, "score": 0, "creation_date": 1441816124, "post_id": 32484191, "comment_id": 52830629, "body": "Where do you want the copied data to go into the active sheet or into the &quot;Time Allocation&quot; sheet? Right now it is going into the active sheet because you didn&#39;t properly set the range"}], "answers": [{"tags": [], "owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "is_accepted": true, "score": 0, "last_activity_date": 1441829519, "last_edit_date": 1441829519, "creation_date": 1441817692, "answer_id": 32485321, "question_id": 32484191, "link": "https://stackoverflow.com/questions/32484191/copy-row-from-non-active-sheet-and-past-on-non-active-sheet-on-next-available-ro/32485321#32485321", "title": "Copy row from non active sheet and past on non active sheet on next available row?", "body": "<p>From what I can tell this is what you need, not sure what you are using it for as the UsedRange will keep resizing the range but you are not copying using the object so you will get a duplicated copy happening. Here is my code for you:</p>\n\n<pre><code>Dim NextRow As Range\nSub Save8()\nDim sht As Worksheet, currentRow As Range\nApplication.ScreenUpdating = False\nSet sht = Sheets(\"Time Allocation\")\nSet currentRow = sht.Range(sht.UsedRange.Address)\nSet NextRow = currentRow.Offset(currentRow.Rows.Count, 0)\n\nSheets(\"Time Allocation\").Range(\"B506:L515\").Copy\n'NextRow.PasteSpecial Paste:=1, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\nNextRow.PasteSpecial xlPasteAll\nApplication.CutCopyMode = False\nSet NextRow = Nothing\nSet currentRow = Nothing\nSet sht = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "edited": false, "score": 0, "creation_date": 1441820527, "post_id": 32485928, "comment_id": 52832885, "body": "Only problem is next row is not the row after his range that he has specified because he has not set next row properly."}, {"owner": {"reputation": 301, "user_id": 4551492, "user_type": "registered", "profile_image": "https://graph.facebook.com/1534368113/picture?type=large", "display_name": "Leonardo Atalla", "link": "https://stackoverflow.com/users/4551492/leonardo-atalla"}, "reply_to_user": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "edited": false, "score": 0, "creation_date": 1441821025, "post_id": 32485928, "comment_id": 52833106, "body": "Uhmm you can use that syntax anyway if you know your data upon, (i.e. , you know it start from the first row and you just add one statically) on top of the userange.rows.count. you Solution works keeping any offset from the top in account, so he can combine both like this:"}, {"owner": {"reputation": 301, "user_id": 4551492, "user_type": "registered", "profile_image": "https://graph.facebook.com/1534368113/picture?type=large", "display_name": "Leonardo Atalla", "link": "https://stackoverflow.com/users/4551492/leonardo-atalla"}, "reply_to_user": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "edited": false, "score": 0, "creation_date": 1441821670, "post_id": 32485928, "comment_id": 52833451, "body": "@Clint Street: I apologize , I&#39;m new to So and i didn&#39;t know i can&#39;t edit a comment for more than 5 minutes, and i also didn&#39;t saw your answer (i was just answering his question) .  Both snippets works, you also added the dynamic offset"}, {"owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "edited": false, "score": 0, "creation_date": 1441821726, "post_id": 32485928, "comment_id": 52833477, "body": "No worries I also found out the hard way no edits after 5 minutes."}], "tags": [], "owner": {"reputation": 301, "user_id": 4551492, "user_type": "registered", "profile_image": "https://graph.facebook.com/1534368113/picture?type=large", "display_name": "Leonardo Atalla", "link": "https://stackoverflow.com/users/4551492/leonardo-atalla"}, "is_accepted": false, "score": 0, "last_activity_date": 1441820004, "creation_date": 1441820004, "answer_id": 32485928, "question_id": 32484191, "link": "https://stackoverflow.com/questions/32484191/copy-row-from-non-active-sheet-and-past-on-non-active-sheet-on-next-available-ro/32485928#32485928", "title": "Copy row from non active sheet and past on non active sheet on next available row?", "body": "<p>Because here</p>\n\n<pre><code>Sheets(\"Time Allocation\").NextRow.PasteSpecial (etc ...)\n</code></pre>\n\n<p>you are telling Excel to look for a property <code>NextRow</code> on the <code>Worksheet Object</code> , property that doesn't exist. </p>\n\n<p>Instead , simply call the <code>PasteSpecial</code> method like this:</p>\n\n<pre><code>NextRow.PasteSpecial (etc ...)\n</code></pre>\n\n<p>and it will work.</p>\n"}], "owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 32485321, "answer_count": 2, "score": 0, "last_activity_date": 1441829519, "creation_date": 1441814081, "last_edit_date": 1441814971, "question_id": 32484191, "link": "https://stackoverflow.com/questions/32484191/copy-row-from-non-active-sheet-and-past-on-non-active-sheet-on-next-available-ro", "title": "Copy row from non active sheet and past on non active sheet on next available row?", "body": "<p>I am using the following macro to copy a range of rows from my non active worksheet in the background and paste it also on the non active worksheet on the next available row.</p>\n\n<p>For some reason I am getting the error object doesn't support this property or method, runtime error 438.</p>\n\n<pre><code>Sub Save8()\nApplication.ScreenUpdating = False\nSet NextRow = Range(\"B\" &amp; Sheets(\"Time Allocation\").UsedRange.Rows.Count + 1)\nSheets(\"Time Allocation\").Range(\"B506:L515\").Copy\nSheets(\"Time Allocation\").NextRow.PasteSpecial Paste:=1, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\nApplication.CutCopyMode = False\nSet NextRow = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>The part of the code giving the error is:</p>\n\n<pre><code>Sheets(\"Time Allocation\").NextRow.PasteSpecial Paste:=1, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n</code></pre>\n\n<p>however if I use the below code it works fine and pastes it onto the specified range, however I can't use this because I intend to have multiple copies and pastes of the same range of rows going down the page onto the next available rows:</p>\n\n<pre><code>Sub Save8()\nApplication.ScreenUpdating = False\nSet NextRow = Range(\"B\" &amp; Sheets(\"Time Allocation\").UsedRange.Rows.Count + 1)\nSheets(\"Time Allocation\").Range(\"B506:L515\").Copy\nSheets(\"Time Allocation\").Range(\"B516\").PasteSpecial\nApplication.CutCopyMode = False\nSet NextRow = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Please can someone show me where I am going wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1441814245, "post_id": 32484189, "comment_id": 52829337, "body": "What error is it giving you?"}, {"owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "reply_to_user": {"reputation": 2832, "user_id": 1161309, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b27b718aa1e9d3835ef807359666eb34?s=128&d=identicon&r=PG", "display_name": "Raystafarian", "link": "https://stackoverflow.com/users/1161309/raystafarian"}, "edited": false, "score": 0, "creation_date": 1441814317, "post_id": 32484189, "comment_id": 52829391, "body": "No error, just crashing. How do I see an error if there is one?"}, {"owner": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 0, "creation_date": 1441814564, "post_id": 32484189, "comment_id": 52829575, "body": "You said &quot;test it in the VBA editor,&quot; what exactly do you mean by that? Did you step through the <code>Sub</code> with no issues or simply compile your project without issues?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441814727, "post_id": 32484189, "comment_id": 52829676, "body": "Just add the line <code>msgbox Activecell.address</code> after <code>Sub rma_new()</code>. What do you get?"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1441815163, "post_id": 32484189, "comment_id": 52830004, "body": "It doesn&#39;t crash for me when running with blank sheets so it&#39;s probably related to the data in the cells. Any chance you can post a screenshot of example data?"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 1, "creation_date": 1441815307, "post_id": 32484189, "comment_id": 52830113, "body": "Also, note that when you&#39;re saying <code>ActiveCell.Row</code> you&#39;re not qualifying a sheet."}, {"owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "reply_to_user": {"reputation": 1668, "user_id": 5019691, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/93494c08d9bc6418d7a02846a51c5299?s=128&d=identicon&r=PG&f=1", "display_name": "aLearningLady", "link": "https://stackoverflow.com/users/5019691/alearninglady"}, "edited": false, "score": 0, "creation_date": 1441815312, "post_id": 32484189, "comment_id": 52830120, "body": "In the VBA editor I click RUN @Dr.Trey"}, {"owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 1, "creation_date": 1441815375, "post_id": 32484189, "comment_id": 52830166, "body": "@user1274820 how do i qualify the sheet? Does it not do it with: Set wsI = ThisWorkbook.Sheets(&quot;Sheet 1&quot;)"}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1441815421, "post_id": 32484189, "comment_id": 52830198, "body": "I just mean that it&#39;s the same as using <code>ActiveSheet.ActiveCell.Row</code>. it will return the row of whatever cell is selected for whichever sheet has the button. This may be as intended - I was just pointing it out."}, {"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1441815519, "post_id": 32484189, "comment_id": 52830253, "body": "I&#39;ve been running it over and over with random data and I have had no issues with it crashing. (Excel 2010)"}, {"owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "edited": false, "score": 0, "creation_date": 1441815609, "post_id": 32484189, "comment_id": 52830308, "body": "Its strange because it doesn&#39;t crash when I run it in the Editor, but when I assign it to a button it crashes every time! Im going to remove some of the code to see which part makes it crash."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441815622, "post_id": 32484189, "comment_id": 52830315, "body": "Did you see my last message?"}, {"owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441815673, "post_id": 32484189, "comment_id": 52830351, "body": "@SiddharthRout Yes, But I only got a cell reference of the cell selected!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1441815715, "post_id": 32484189, "comment_id": 52830373, "body": "Yup that is what it was supposed to do. Now do you know how to step through the code?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441815754, "post_id": 32484189, "comment_id": 52830403, "body": "Wait.. did you get the cell address when you went via the button click or via the vba editor?"}, {"owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "edited": false, "score": 0, "creation_date": 1441815756, "post_id": 32484189, "comment_id": 52830407, "body": "Yes, sort of. Do I just put that code after each line?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "edited": false, "score": 0, "creation_date": 1441815765, "post_id": 32484189, "comment_id": 52830410, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/89185/discussion-between-siddharth-rout-and-tbowden\">continue this discussion in chat</a>."}], "answers": [{"tags": [], "owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "is_accepted": false, "score": 0, "last_activity_date": 1441906129, "creation_date": 1441906129, "answer_id": 32508209, "question_id": 32484189, "link": "https://stackoverflow.com/questions/32484189/excel-crashing-when-button-with-macro-attached-clicked/32508209#32508209", "title": "Excel Crashing when button with macro attached clicked", "body": "<p>I wrote this code and now my excel doesn't crash! I hope it helps.</p>\n\n<pre><code>Sub rma_New ()\n\n    Dim LRow As Long, Sno As Long\n    Dim myData As Workbook\n\n    '--Get data from current sheet--\n    ActiveWorkbook.ActiveSheet.Select\n    orderValue = Range(\"a\" &amp; (ActiveCell.Row))\n    customerRef = Range(\"c\" &amp; (ActiveCell.Row))\n    customerName = Range(\"d\" &amp; (ActiveCell.Row))\n    customerCountry = Range(\"e\" &amp; (ActiveCell.Row))\n\n    '--Open Sheet 2--\n    Worksheets(\"Sheet 2\").Select\n\n    '--Get value of previous cell in the row above in column A and add 1, inside Sheet 2--\n    LRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Sno = Range(\"A\" &amp; LRow).Value + 1\n\n    '--Find the next empty row and append a new line with the data in the corresponding cells--\n    Worksheets(\"Sheet 2\").Range(\"a8\").Select\n    RowCount = Worksheets(\"Sheet 2\").Range(\"a8\").CurrentRegion.Rows.Count\n    With Worksheets(\"Sheet 2\").Range(\"a8\")\n\n  .Offset(RowCount, 0) = Sno\n  .Offset(RowCount, 1) = customerRef\n  .Offset(RowCount, 2) = customerName\n  .Offset(RowCount, 3) = customerCountry\n\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 747, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441906129, "creation_date": 1441814077, "last_edit_date": 1441814904, "question_id": 32484189, "link": "https://stackoverflow.com/questions/32484189/excel-crashing-when-button-with-macro-attached-clicked", "title": "Excel Crashing when button with macro attached clicked", "body": "<p>I have a macro that is attached to a button. However, when I test it in the VBA Editor, it runs fine. When the button is clicked with the macro attached it crashes excel. I have other macros attached which run fine.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Option Explicit\n\nSub rma_new()\n\nDim Sno As Long, LRow As Long, NewRow As Long\nDim wsO As Worksheet, wsI As Worksheet\nDim customeRef, customerName, customerCountry\nDim customerCompany, datePaid, dateShipped\nDim webInvoiceNumber, invoiceNumber, postCode\nDim assignedTo, salesChnl, orderValue\n\nSet wsO = ThisWorkbook.Sheets(\"RMA\")\nSet wsI = ThisWorkbook.Sheets(\"Sheet 1\")\n\n'~~&gt; Get values from Sheet1\nWith wsI\n    customeRef = .Range(\"c\" &amp; (ActiveCell.Row))\n    customerName = .Range(\"d\" &amp; (ActiveCell.Row))\n    customerCountry = .Range(\"e\" &amp; (ActiveCell.Row))\n    customerCompany = .Range(\"f\" &amp; (ActiveCell.Row))\n    datePaid = .Range(\"g\" &amp; (ActiveCell.Row))\n    dateShipped = .Range(\"h\" &amp; (ActiveCell.Row))\n    webInvoiceNumber = .Range(\"i\" &amp; (ActiveCell.Row))\n    invoiceNumber = .Range(\"j\" &amp; (ActiveCell.Row))\n    postCode = .Range(\"k\" &amp; (ActiveCell.Row))\n    salesChnl = .Range(\"o\" &amp; (ActiveCell.Row))\n    orderValue = .Range(\"a\" &amp; (ActiveCell.Row))\n\n\nEnd With\n\n'~~&gt; Work with RMA Sheet\nWith wsO\n    '~~&gt; Get the last Row\n    LRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    '~~&gt; Increment the number\n    Sno = .Range(\"A\" &amp; LRow).Value + 1\n    '~~&gt; New row where we need to write\n    NewRow = LRow + 1\n\n    .Cells(NewRow, 1) = Sno\n    .Cells(NewRow, 2) = customeRef\n    .Cells(NewRow, 3) = customerName\n    .Cells(NewRow, 4) = customerCountry\n    .Cells(NewRow, 5) = customerCompany\n    .Cells(NewRow, 6) = datePaid\n    .Cells(NewRow, 7) = dateShipped\n    .Cells(NewRow, 8) = webInvoiceNumber\n    .Cells(NewRow, 9) = invoiceNumber\n    .Cells(NewRow, 10) = postCode\n    .Cells(NewRow, 12) = salesChnl\n    .Cells(NewRow, 14) = orderValue\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sorting"], "comments": [{"owner": {"reputation": 1515, "user_id": 3241481, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4FsW1.jpg?s=128&g=1", "display_name": "Naren Neelamegam", "link": "https://stackoverflow.com/users/3241481/naren-neelamegam"}, "edited": false, "score": 0, "creation_date": 1441812525, "post_id": 32483502, "comment_id": 52828104, "body": "Are you ok to use macros/vba?"}, {"owner": {"reputation": 1515, "user_id": 3241481, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4FsW1.jpg?s=128&g=1", "display_name": "Naren Neelamegam", "link": "https://stackoverflow.com/users/3241481/naren-neelamegam"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1441881139, "post_id": 32483502, "comment_id": 52858346, "body": "@pnuts oops didn&#39;t see that :)"}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 5075024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZLBiDmq6mVs/AAAAAAAAAAI/AAAAAAAACbo/w3CHZ771iRQ/photo.jpg?sz=128", "display_name": "mumfy", "link": "https://stackoverflow.com/users/5075024/mumfy"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1441812666, "post_id": 32483650, "comment_id": 52828207, "body": "@pnuts You just put it in a loop I believe he was saying he didn&#39;t want to highlight and sort 41 times and wanted to automate it..."}, {"owner": {"reputation": 135, "user_id": 5075024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZLBiDmq6mVs/AAAAAAAAAAI/AAAAAAAACbo/w3CHZ771iRQ/photo.jpg?sz=128", "display_name": "mumfy", "link": "https://stackoverflow.com/users/5075024/mumfy"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1441812796, "post_id": 32483650, "comment_id": 52828286, "body": "This community is to help people solve their programming issues not do it for them!  The source link has a loop written in it as well, so he could look it up that way."}], "tags": [], "owner": {"reputation": 135, "user_id": 5075024, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ZLBiDmq6mVs/AAAAAAAAAAI/AAAAAAAACbo/w3CHZ771iRQ/photo.jpg?sz=128", "display_name": "mumfy", "link": "https://stackoverflow.com/users/5075024/mumfy"}, "is_accepted": false, "score": 0, "last_activity_date": 1441812516, "creation_date": 1441812516, "answer_id": 32483650, "question_id": 32483502, "link": "https://stackoverflow.com/questions/32483502/arrange-data-in-excel-from-maximum-to-minimum/32483650#32483650", "title": "Arrange data in Excel from maximum to minimum", "body": "<p>Something like this should work.  You select a specific range from C1 - C38 then sort.  Next sort C39 - C77 and so on.</p>\n\n<pre><code>Range(\"C1\") = \"Index\"\nColumns(\"A:C\").Sort key1:=Range(\"C2\"), _\n    order1:=xlAscending, header:=xlYes\n</code></pre>\n\n<p>Source\n<a href=\"https://msdn.microsoft.com/en-us/library/office/ff840646.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff840646.aspx</a></p>\n"}, {"tags": [], "owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "is_accepted": true, "score": 1, "last_activity_date": 1441813408, "last_edit_date": 1441813408, "creation_date": 1441812627, "answer_id": 32483687, "question_id": 32483502, "link": "https://stackoverflow.com/questions/32483502/arrange-data-in-excel-from-maximum-to-minimum/32483687#32483687", "title": "Arrange data in Excel from maximum to minimum", "body": "<p>Yes it is possible:  Here's a excel formula way of doing it.  The key point here is row() must start at line 1, or we have to subtract from row() before the division to get it to line 1.  the -0.01 is to ensure increments of 38 do not get moved to the next group; while ensuring the 1st record is kept in the first group.</p>\n\n<p>Insert a column using formula<code>=ROUNDDOWN(ROW()/38-0.01,0)</code> and then fill down (assuming you start in cell A1.) then sort on column a, then your next column containing the numbers you want to sort max to min.</p>\n\n<p>What this does is generate a column of like numbers for each group of 38, which then allows you to first sort by it ascending, then sort by your next column descending, retaining each group of 38, and sorting max to min within each group.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hE6Gk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hE6Gk.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": false, "score": 0, "last_activity_date": 1441813498, "last_edit_date": 1441813498, "creation_date": 1441813165, "answer_id": 32483862, "question_id": 32483502, "link": "https://stackoverflow.com/questions/32483502/arrange-data-in-excel-from-maximum-to-minimum/32483862#32483862", "title": "Arrange data in Excel from maximum to minimum", "body": "<p>A quick VBA loop should do it. Just step by 38 to sort each group. Assuming your data is in column A and starts at row 1, you could use the following:</p>\n\n<pre><code>Dim i As Long\nFor i = 1 To 1558 Step 38\n    Range(Cells(i, \"A\"), Cells(i + 37, \"A\")).Sort Range(\"A1\"), xlDescending\nNext\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1515, "user_id": 3241481, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4FsW1.jpg?s=128&g=1", "display_name": "Naren Neelamegam", "link": "https://stackoverflow.com/users/3241481/naren-neelamegam"}, "is_accepted": false, "score": 0, "last_activity_date": 1441882039, "creation_date": 1441882039, "answer_id": 32499784, "question_id": 32483502, "link": "https://stackoverflow.com/questions/32483502/arrange-data-in-excel-from-maximum-to-minimum/32499784#32499784", "title": "Arrange data in Excel from maximum to minimum", "body": "<p>I know, xQbert answered this already in a simple way. Below is the funny magic formula I could do, which can do it in a go,</p>\n\n<p>Considering the values are starting from A1 cell running down till whatever range (here A1558). Copy paste this formula into any other column eg: B1 and pull it down till B1558 (or any max range you have).</p>\n\n<pre><code>=SMALL(INDIRECT(\"A\"&amp;(38*(ROUNDDOWN((ROW()-1)/38,0)))+1&amp;\":\"&amp;\"A\"&amp;(38*((ROUNDDOWN(ROW()/38,0)+IF(MOD(ROW(),38)=0,0,1))))),IF(ROW()&gt;38,IF(MOD(ROW(),38)=0,38,MOD(ROW(),38)),ROW()))\n</code></pre>\n\n<p>Oh! You said larget to smallest? Change the SMALL() function to LARGE()</p>\n\n<pre><code>=LARGE(INDIRECT(\"A\"&amp;(38*(ROUNDDOWN((ROW()-1)/38,0)))+1&amp;\":\"&amp;\"A\"&amp;(38*((ROUNDDOWN(ROW()/38,0)+IF(MOD(ROW(),38)=0,0,1))))),IF(ROW()&gt;38,IF(MOD(ROW(),38)=0,38,MOD(ROW(),38)),ROW()))\n</code></pre>\n\n<p>Nothing else need to be done, you got your sorted groups as something like below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/yan6X.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yan6X.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 107, "user_id": 4309291, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/c74f20a3e25734d1061af0831fcea048?s=128&d=identicon&r=PG&f=1", "display_name": "Jerry", "link": "https://stackoverflow.com/users/4309291/jerry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5299, "favorite_count": 0, "accepted_answer_id": 32483687, "answer_count": 4, "score": 0, "last_activity_date": 1441882039, "creation_date": 1441812069, "last_edit_date": 1441813456, "question_id": 32483502, "link": "https://stackoverflow.com/questions/32483502/arrange-data-in-excel-from-maximum-to-minimum", "title": "Arrange data in Excel from maximum to minimum", "body": "<p>Is it possible to arrange data in Excel from maximum to minimum value? This is not a typical sort. I have a column of data which contains 1558 numbers. However, I want to select the first 38 numbers and order them from highest value to lowest value. Following this, I want to do the same for the next 38 numbers etc until all 1558 numbers are processed. Is this possible without having to highlight each 38 numbers and using the sort function 41 times?</p>\n"}, {"tags": ["excel", "vba", "button", "command"], "comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1441812310, "post_id": 32483382, "comment_id": 52827960, "body": "I suspect that the SpellCheck() subroutine is placed in a standard code module? When you save that particular sheet as a new workbook, Excel has no choice but to link back to that procedure in the standard code module. What happens if you instead place the SpellCheck() routine in the worksheet module and then save that sheet as a new file?"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 5177280, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c45b60dd58f4907a6f792448ac6f363?s=128&d=identicon&r=PG&f=1", "display_name": "heyhey33", "link": "https://stackoverflow.com/users/5177280/heyhey33"}, "edited": false, "score": 0, "creation_date": 1441876192, "post_id": 32483833, "comment_id": 52854981, "body": "Hi there, ok makes sense. I put the SpellCheckUnlockedCells() into the sheet instead of a regular module. I put the button onto the sheet and assign the macro Sheet2.SpellCheckUnlockedCells().  When I click on OK it will assign main_excel.xlsm!Sheet2.SpellCheckUnlockedCells. When I open the exported sheet, is will link back to the original excel file."}, {"owner": {"reputation": 29, "user_id": 5177280, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c45b60dd58f4907a6f792448ac6f363?s=128&d=identicon&r=PG&f=1", "display_name": "heyhey33", "link": "https://stackoverflow.com/users/5177280/heyhey33"}, "edited": false, "score": 0, "creation_date": 1441876892, "post_id": 32483833, "comment_id": 52855452, "body": "BTW: The new file does have the macro included if I check in the VBA editor. However, the sheet is now Sheet8 instead of Sheet2. But that doesn&#39;t really matter as long as the button is link to the old file..."}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 29, "user_id": 5177280, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c45b60dd58f4907a6f792448ac6f363?s=128&d=identicon&r=PG&f=1", "display_name": "heyhey33", "link": "https://stackoverflow.com/users/5177280/heyhey33"}, "edited": false, "score": 0, "creation_date": 1441878413, "post_id": 32483833, "comment_id": 52856545, "body": "@heyhey33 You will need to ise an ActiveX command button, not a Form Control button."}, {"owner": {"reputation": 29, "user_id": 5177280, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c45b60dd58f4907a6f792448ac6f363?s=128&d=identicon&r=PG&f=1", "display_name": "heyhey33", "link": "https://stackoverflow.com/users/5177280/heyhey33"}, "edited": false, "score": 0, "creation_date": 1441891931, "post_id": 32483833, "comment_id": 52865861, "body": "Perfect! Thanks you made my day ;)"}, {"owner": {"reputation": 29, "user_id": 5177280, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c45b60dd58f4907a6f792448ac6f363?s=128&d=identicon&r=PG&f=1", "display_name": "heyhey33", "link": "https://stackoverflow.com/users/5177280/heyhey33"}, "edited": false, "score": 0, "creation_date": 1441895873, "post_id": 32483833, "comment_id": 52869007, "body": "I ran into another issue. The password for unprotecting the sheet is plain text in the code. Obviously I can manually protect the VBA code in the editor property windows. However, I need to do this automatically with VBA. Is this possible?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 29, "user_id": 5177280, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c45b60dd58f4907a6f792448ac6f363?s=128&d=identicon&r=PG&f=1", "display_name": "heyhey33", "link": "https://stackoverflow.com/users/5177280/heyhey33"}, "edited": false, "score": 0, "creation_date": 1441897156, "post_id": 32483833, "comment_id": 52869932, "body": "@heyhey33 That&#39;s a tough one. Read <a href=\"http://stackoverflow.com/questions/17777770/vba-project-password-protect-with-sendkeys-not-working-correctly\">this</a>. In the end, even if you get it working, VBA Project password protection is not secure for someone who knows what they are doing. If you are after a certain degree of difficulty for the end user to retrieve the password over and above clear text in the VBA code, then you could try an encryption approach. Leave the password text in the code, but have the character encrypted and then have the code decrypt before unprotecting the sheet."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1441813089, "creation_date": 1441813089, "answer_id": 32483833, "question_id": 32483382, "link": "https://stackoverflow.com/questions/32483382/export-sheet-including-vba-and-a-command-button/32483833#32483833", "title": "Export sheet including VBA and a command button", "body": "<p>If you want the worksheet to be self contained after you export it from the workbook, make it self contained to start with.</p>\n\n<p>Place all routines that are accessed from the sheet into that sheet's code module (instead of into a shared standard code module).</p>\n\n<p>This way the sheet has no dependencies and will be self contained once exported to a new workbook.</p>\n"}], "owner": {"reputation": 29, "user_id": 5177280, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5c45b60dd58f4907a6f792448ac6f363?s=128&d=identicon&r=PG&f=1", "display_name": "heyhey33", "link": "https://stackoverflow.com/users/5177280/heyhey33"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1335, "favorite_count": 0, "accepted_answer_id": 32483833, "answer_count": 1, "score": 0, "last_activity_date": 1441813089, "creation_date": 1441811715, "last_edit_date": 1441811816, "question_id": 32483382, "link": "https://stackoverflow.com/questions/32483382/export-sheet-including-vba-and-a-command-button", "title": "Export sheet including VBA and a command button", "body": "<p>I need to save several Excel sheets to separate files.\nThe sheets are protected and locked, however I want to make spellcheck available.\nThis is possible with VBA using a small routine to unlock>spellcheck>relock</p>\n\n<pre><code>Sub SpellCheck()\nActiveSheet.Unprotect\nCells.CheckSpelling CustomDictionary:=\"CUSTOM.DIC\", IgnoreUppercase:=False, AlwaysSuggest:=True, SpellLang:=1033\nActiveSheet.Protect\nEnd Sub()\n</code></pre>\n\n<p>Now I placed command button on the sheets I want to export and assigned my spell check macro.\nI save the files with vba as XLSM</p>\n\n<pre><code>Sheets(\"exportsheet\").SaveAs Filename:=\"mysheet.xlsm\", FileFormat:=52\n</code></pre>\n\n<p>If I click on the button in the newly saved file, the macro is linked to the original source excel which will open. The assigned macro link looks something like this: original_excel.xlsm!spellCheck()</p>\n\n<p>How can I export a sheet including the VBA code which is assigned to a command button in a way that the macro is not assigned to the original workbook.</p>\n\n<p>Any thoughts on that?</p>\n"}, {"tags": ["vba", "publisher"], "comments": [{"owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "edited": false, "score": 0, "creation_date": 1441811657, "post_id": 32483209, "comment_id": 52827486, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/5527073/get-shape-by-id-or-name\">Get shape by Id or Name</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5317647, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QFqPS2Vnf6Y/AAAAAAAAAAI/AAAAAAAAAGk/h_za16ghx80/photo.jpg?sz=128", "display_name": "Angel Orenes", "link": "https://stackoverflow.com/users/5317647/angel-orenes"}, "is_accepted": false, "score": 0, "last_activity_date": 1441813114, "creation_date": 1441813114, "answer_id": 32483847, "question_id": 32483209, "link": "https://stackoverflow.com/questions/32483209/how-to-get-the-shape-in-publisher-with-vba-when-its-outside-of-a-page/32483847#32483847", "title": "How to get the Shape in Publisher with VBA when it&#39;s outside of a page?", "body": "<p>I've found it!!</p>\n\n<p>There are a ScratchArea under Document with all the shapes out of the pages.</p>\n\n<p>So I can modify the code with something like this:</p>\n\n<pre><code>Sub main()\n    Dim oPage As Page\n    Dim oTable As Table\n    Dim oBox As Shape\n    Dim oLine As Shape\n    Dim oScratch As ScratchArea\n\n\n    Set oPage = ActiveDocument.Pages(1)\n    Set oScratch = ActiveDocument.ScratchArea\n    Set oBox = oPage.Shapes.AddTable(2, 1, -150, 50, 120, 30, False)\n    oBox.Name = \"Pepe\"\n    oBox.Tags.Add \"Cuadro\", \"Pepe\"\n\n    Set oBox = oPage.Shapes.AddTable(2, 1, 350, 150, 120, 30, False)\n    oBox.Name = \"Pepa\"\n    oBox.Tags.Add \"Cuadro\", \"Pepa\"\n\n    Set oLine = oPage.Shapes.AddConnector(msoConnectorElbow, 0, 0, 100, 100)\n\n        With oLine.ConnectorFormat\n            On Error Resume Next\n            .BeginConnect oPage.Shapes.Item(\"Pepe\"), 1\n            If Err.Number &lt;&gt; 0 Then\n                Err.Clear\n                .BeginConnect oScratch.Shapes.Item(\"Pepe\"), 1\n            End If\n            .EndConnect oPage.Shapes.Item(\"Pepa\"), 1\n            If Err.Number &lt;&gt; 0 Then\n                Err.Clear\n                .EndConnect oScratch.Shapes.Item(\"Pepa\"), 1\n            End If\n            On Error GoTo 0\n        End With\n\n    End Sub\n</code></pre>\n\n<p>Thanks!!</p>\n"}], "owner": {"reputation": 11, "user_id": 5317647, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-QFqPS2Vnf6Y/AAAAAAAAAAI/AAAAAAAAAGk/h_za16ghx80/photo.jpg?sz=128", "display_name": "Angel Orenes", "link": "https://stackoverflow.com/users/5317647/angel-orenes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 256, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441813114, "creation_date": 1441811211, "question_id": 32483209, "link": "https://stackoverflow.com/questions/32483209/how-to-get-the-shape-in-publisher-with-vba-when-its-outside-of-a-page", "title": "How to get the Shape in Publisher with VBA when it&#39;s outside of a page?", "body": "<p>i've a external process which adds a lot of shapes to a Publisher page.\nSadly some of the shapes have been placed outside of the page.</p>\n\n<p>This shapes are not in the Shapes collection of that page. Anybody know where can I get them?</p>\n\n<p>Here a sample code that replicate the problem:</p>\n\n<pre><code>Sub main()\n    Dim oPage As Page\n    Dim oTable As Table\n    Dim oBox As Shape\n    Dim oLine As Shape\n\n\n    Set oPage = ActiveDocument.Pages(1)\n    Set oBox = oPage.Shapes.AddTable(2, 1, -150, 50, 120, 30, False)\n    oBox.Name = \"Pepe\"\n\n    Set oBox = oPage.Shapes.AddTable(2, 1, 350, 150, 120, 30, False)\n    oBox.Name = \"Pepa\"\n\n    Set oLine = oPage.Shapes.AddConnector(msoConnectorElbow, 0, 0, 100, 100)\n\n    With oLine.ConnectorFormat\n        .BeginConnect oPage.Shapes.Item(\"Pepe\"), 1 'here are the error!!!\n        .EndConnect oPage.Shapes.Item(\"Pepa\"), 1\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>What I want is to get the Shapes.Item(\"Pepe\") even when is not in the page (Left -150). Where are the shapes that are not in the page?</p>\n\n<p>Thanks in advance.</p>\n\n<p>Angel.</p>\n"}, {"tags": ["vba", "excel", "is-empty"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 5317462, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcbfa19868b3a035fb1ae6bcec1e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5317462/matt"}, "edited": false, "score": 0, "creation_date": 1441827479, "post_id": 32483525, "comment_id": 52836291, "body": "Thanks for this solution. Usually I&#39;m not a big fan of variant, I prefer to have all my variables declared with the right type. In this case though, I see no other solution so I will use it. Still, I don&#39;t know if I will use variant for all the arguments: easier to understand and to duplicate (I have many more things to read in fact) or just use it for the arguments that can have the value -1 : probably faster and with less type related errors. I&#39;ll see. Thanks again."}], "tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 2, "last_activity_date": 1441812167, "creation_date": 1441812167, "answer_id": 32483525, "question_id": 32483128, "link": "https://stackoverflow.com/questions/32483128/how-can-i-build-a-default-empty-object-that-can-be-differentiated-from-0-in-vba/32483525#32483525", "title": "How can I build a default empty object that can be differentiated from 0 in vba?", "body": "<p><code>Empty</code> is used with the <code>Variant</code> type. Setting a <code>String</code> or <code>Long</code> to <code>Empty</code> and then testing its emptiness with <code>IsEmpty()</code> won't work.</p>\n\n<p>You <em>can</em> use variants to store your data, however, and then you can safely use the <code>Empty</code> value to signify an empty/missing value.</p>\n\n<p>You're right that VB will cast <code>Empty</code> to <code>0</code> for numeric comparisons. For example:</p>\n\n<pre><code>Dim v As Variant\nDebug.Print (v = 0)        ' =&gt; True \n</code></pre>\n\n<p>But you can use the <code>VarType()</code> function to test if a variant has the <code>Empty</code> value:</p>\n\n<pre><code>Dim v As Variant\nDebug.Print VarType(v) = vbEmpty    ' =&gt; True (empty/uninitialized)\nv = 0\nDebug.Print VarType(v) = vbEmpty    ' =&gt; False\nv = Empty\nDebug.Print VarType(v) = vbEmpty    ' =&gt; True (empty)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 57, "user_id": 5317462, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcbfa19868b3a035fb1ae6bcec1e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5317462/matt"}, "edited": false, "score": 0, "creation_date": 1441827473, "post_id": 32484997, "comment_id": 52836287, "body": "Thanks for this solution. Usually I&#39;m not a big fan of variant, I prefer to have all my variables declared with the right type. In this case though, I see no other solution so I will use it. Still, I don&#39;t know if I will use variant for all the arguments: easier to understand and to duplicate (I have many more things to read in fact) or just use it for the arguments that can have the value -1 : probably faster and with less type related errors. I&#39;ll see."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 57, "user_id": 5317462, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcbfa19868b3a035fb1ae6bcec1e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5317462/matt"}, "edited": false, "score": 0, "creation_date": 1441832142, "post_id": 32484997, "comment_id": 52838545, "body": "I agree. I feel very uncomfortable using variants.  When you use VBA variables to store data that has come from a database table, if the fields in the table allow NULL values then all the variables need to accomodate storing NULL.  So they all need to be variant as this is the only data type that stores NULL (ie empty).  What a bugger."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 57, "user_id": 5317462, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcbfa19868b3a035fb1ae6bcec1e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5317462/matt"}, "edited": false, "score": 0, "creation_date": 1441832617, "post_id": 32484997, "comment_id": 52838805, "body": "BTW Null is not the same as empty - see my answer below (in case you are interested)"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 1, "last_activity_date": 1441832013, "last_edit_date": 1441832013, "creation_date": 1441816600, "answer_id": 32484997, "question_id": 32483128, "link": "https://stackoverflow.com/questions/32483128/how-can-i-build-a-default-empty-object-that-can-be-differentiated-from-0-in-vba/32484997#32484997", "title": "How can I build a default empty object that can be differentiated from 0 in vba?", "body": "<p>Declare all of these a variant.</p>\n\n<pre><code> type as string\n number as long\n master as long\n slave as long\n</code></pre>\n\n<p>Their default value after being declared will be vbEmpty.  </p>\n\n<p>You can test for this </p>\n\n<pre><code>Dim av As Variant\n\nIf IsEmpty(av) Then Debug.Print \"if isempty(av ) \"\n\n' I Wouldn't use this (it works but is overkill)\n' If VarType(av) = vbEmpty Then Debug.Print \"If VarType(av)= vbEmpty \"\n</code></pre>\n\n<p>You can assign Empty explicitly eg</p>\n\n<pre><code>av = Empty\n</code></pre>\n\n<p>VB will cast Empty to 0 for numeric comparisons.</p>\n"}, {"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 1, "last_activity_date": 1441832958, "last_edit_date": 1441832958, "creation_date": 1441832640, "answer_id": 32489142, "question_id": 32483128, "link": "https://stackoverflow.com/questions/32483128/how-can-i-build-a-default-empty-object-that-can-be-differentiated-from-0-in-vba/32489142#32489142", "title": "How can I build a default empty object that can be differentiated from 0 in vba?", "body": "<pre><code>Sub ExperimentsWithVariants()\n\nDim avar As Variant\n\n' is not set\n\n' When a variant has not been assigned\n\nDebug.Print \"-----------------------\"\nDebug.Print \"NOT SET:\"\nDebug.Print \"-----------------------\"\nDebug.Print \"aVar = Empty \", (avar = Empty)      ' True\nDebug.Print \"aVar\", avar                         '             '' ie blank\nDebug.Print \"IsNull(aVar)\", (IsNull(avar))       ' False\nDebug.Print \"IsEmpty(aVar)\", (IsEmpty(avar))     ' True\nDebug.Print \"aVar = \"\"\"\"\", (avar = \"\")           ' True\nDebug.Print \"aVar = 0\", (avar = 0)               ' True\n\nIf avar = Empty Then\n    Debug.Print \" \"\n    Debug.Print \"avar = Empty so the above would be the saem if you set avar = Empty explicitly\"\n    Debug.Print \" \"\"\"\nElse\n    avar = Empty\n    Debug.Print \" \"\n    Debug.Print \"-----------------------\"\n    Debug.Print \" SET TO Empty\"\n    Debug.Print \"-----------------------\"\n    Debug.Print \"aVar = Empty \", (avar = Empty)      ' True\n    Debug.Print \"aVar\", avar                         '            '' ie blank\n    Debug.Print \"IsNull(aVar)\", (IsNull(avar))       ' False\n    Debug.Print \"IsEmpty(aVar)\", (IsEmpty(avar))     ' True\n    Debug.Print \"aVar = \"\"\"\"\", (avar = \"\")           ' True\n    Debug.Print \"aVar = 0\", (avar = 0)               ' True\nEnd If\n\navar = Null\nDebug.Print \" \"\nDebug.Print \"-----------------------\"\nDebug.Print \" SET TO NULL\"\nDebug.Print \"-----------------------\"\nDebug.Print \"aVar = Empty \", (avar = Empty)      ' Null\nDebug.Print \"aVar\", avar                         ' Null\nDebug.Print \"IsNull(aVar)\", (IsNull(avar))       ' True\nDebug.Print \"IsEmpty(aVar)\", (IsEmpty(avar))     ' False\nDebug.Print \"aVar = \"\"\"\"\", (avar = \"\")           ' Null\nDebug.Print \"aVar = 0\", (avar = 0)               ' Null\n\n\navar = \"\"\nDebug.Print \" \"\nDebug.Print \"-----------------------\"\nDebug.Print \" SET TO \"\"\"\"\"\nDebug.Print \"-----------------------\"\nDebug.Print \"aVar = Empty \", (avar = Empty)      ' True\nDebug.Print \"aVar\", avar                         '            '' ie blank\nDebug.Print \"IsNull(aVar)\", (IsNull(avar))       ' False\nDebug.Print \"IsEmpty(aVar)\", (IsEmpty(avar))     ' False\nDebug.Print \"aVar = \"\"\"\"\", (avar = \"\")           ' True\nDebug.Print \"aVar = 0\", (avar = 0)               ' False\n' Note\n' Is empty returns false, whereas =\"\" returns NULL\n\n\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 5317462, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/8bcbfa19868b3a035fb1ae6bcec1e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/5317462/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 32483525, "answer_count": 3, "score": 2, "last_activity_date": 1498594970, "creation_date": 1441810992, "last_edit_date": 1498594970, "question_id": 32483128, "link": "https://stackoverflow.com/questions/32483128/how-can-i-build-a-default-empty-object-that-can-be-differentiated-from-0-in-vba", "title": "How can I build a default empty object that can be differentiated from 0 in vba?", "body": "<p>I'm reading a text file that contains data about mechanical fasteners. I built an object fastener (via a class) with the following attributes :</p>\n\n<pre><code>type as string\nnumber as long\nmaster as long\nslave as long\n</code></pre>\n\n<p>I want to fill a collection of fasteners:</p>\n\n<pre><code>Cfastener as collection\n</code></pre>\n\n<p>In the text file the type, number, master and slave can come in random order and are not always all present. In order to deal with that I defined a current fastener (sort of buffer) and a default \"empty\" fastener:</p>\n\n<pre><code>currentfastener as fastener\ninitfastener as fastener\nwith initfastener\n    .type = \"-1\"\n    .number = -1\n    .master = -1\n    .slave = -1\nend with\n</code></pre>\n\n<p>I read my text file and when I detect a keyword that refers to one of these attribute I test for the value in <code>current fastener</code>:</p>\n\n<pre><code>Do until .atendofstream\n    line = .readline\n    Select case line\n        Case masterkeyword\n            if currentfastener.master &lt;&gt; -1 then 'We already have a master. This means that we need to save the currentfastener and start a new one.\n                Cfasteners.add currentfastener\n                currentfastener = initfastener\n            else 'master is \"empty\": we fill the currentfastener. \n                currentfastener.master= \"value read from the text stream\"\n            end if\n    End Select\nLoop\n</code></pre>\n\n<p>Until now I\u2019m using <code>-1</code> for numbers and <code>\"-1\"</code> for string as default empty argument. Until now it was fine because the arguments could not get this value. But now, I want to add a spatial position for the master and slave, and it can be <code>-1</code>. So I wanted to go back to my first idea that was do define all <code>initfixation</code> arguments as <code>empty</code>.</p>\n\n<p>But if I\u2019m not mistaken it is not possible to differentiate the <code>0</code> value from the <code>empty</code> value in vba, and this will cause trouble.</p>\n\n<p>Do you know a default value, that is not 0, that can be differentiated from 0 and that is not -1?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1441811163, "post_id": 32482978, "comment_id": 52827169, "body": "If all you need is the color.  than pass the color index into an array. <code>arrNewData(i, j) = Sheets(&quot;Old Data&quot;).Cells(i, j).Interior.ColorIndex</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441811642, "post_id": 32482978, "comment_id": 52827470, "body": "@ScottCraner - thanks for that. In my brain it clicked that you could use an array(i,j) which matches the <code>cells(x,y)</code> format - don&#39;t know how I overlooked that before!"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 4171779, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87165c67aa50c08877ffd5935128bc2e?s=128&d=identicon&r=PG&f=1", "display_name": "Zee_K", "link": "https://stackoverflow.com/users/4171779/zee-k"}, "edited": false, "score": 0, "creation_date": 1441878971, "post_id": 32483936, "comment_id": 52856965, "body": "The porblem is that I need to compare the two arrays together... using a vlookup solution matching each entry together and checking if the colours have been changed etc.."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 39, "user_id": 4171779, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87165c67aa50c08877ffd5935128bc2e?s=128&d=identicon&r=PG&f=1", "display_name": "Zee_K", "link": "https://stackoverflow.com/users/4171779/zee-k"}, "edited": false, "score": 0, "creation_date": 1441880946, "post_id": 32483936, "comment_id": 52858226, "body": "That&#39;s no problem. If you need two arrays for other tasks then simply adjust the code as I&#39;ve added in my edit."}, {"owner": {"reputation": 39, "user_id": 4171779, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87165c67aa50c08877ffd5935128bc2e?s=128&d=identicon&r=PG&f=1", "display_name": "Zee_K", "link": "https://stackoverflow.com/users/4171779/zee-k"}, "edited": false, "score": 0, "creation_date": 1441965443, "post_id": 32483936, "comment_id": 52898934, "body": "Hi. Having some issues with your solution... i get some errors with regards to the array size, as it needs to be in proportion to how many cells are present. Please see what ive done above."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 39, "user_id": 4171779, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87165c67aa50c08877ffd5935128bc2e?s=128&d=identicon&r=PG&f=1", "display_name": "Zee_K", "link": "https://stackoverflow.com/users/4171779/zee-k"}, "edited": false, "score": 0, "creation_date": 1441972301, "post_id": 32483936, "comment_id": 52903248, "body": "What&#39;s the error and what line does it occur on? Also, check your two worksheet UsedRanges are the same size."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 0, "last_activity_date": 1441881563, "last_edit_date": 1441881563, "creation_date": 1441813354, "answer_id": 32483936, "question_id": 32482978, "link": "https://stackoverflow.com/questions/32482978/compare-two-sheets-in-terms-of-cell-colour/32483936#32483936", "title": "Compare two sheets in terms of cell colour", "body": "<p>You could create multidimensional arrays - indeed, if you're wanting to read the Value from a large number of cells, a variant array is a good way to do it \n        Dim arrNewData As Variantas you don't need to loop through cells. So your code could be shortened to:</p>\n\n<pre><code>    dim arrOldData as Variant\n    arrNewData = ThisWorkbook.Worksheets(\"Combine\").UsedRange.Value\n    arrOldData = ThisWorkbook.Worksheets(\"Old Data\").UsedRange.Value\n</code></pre>\n\n<p>However, the Value is no use to you, as you want the ColorIndex (or Color) of each cell's Font or Interior property (depending on whether you're testing font or fill colour). You, therefore, must run a loop.</p>\n\n<p>Given the loop is unavoidable, I wouldn't bother reading the ColorIndex into an array and then looping through that array to test it. In effect you're looping through the same data twice. So I'd probably go for the following:</p>\n\n<pre><code>    Dim newSheet As Worksheet\n    Dim oldSheet As Worksheet\n    Dim newColorIndex As Integer\n    Dim oldColorIndex As Integer        \n    Dim r As Integer\n    Dim c As Integer\n\n    Set newSheet = ThisWorkbook.Worksheets(\"Combine\")\n    Set oldSheet = ThisWorkbook.Worksheets(\"Old Data\")\n\n    For r = 1 To 30 ' this is the number of rows in your range\n        For c = 8 To 19\n            newColorIndex = newSheet.Cells(r, c).Font.ColorIndex\n            oldColorIndex = oldSheet.Cells(r, c).Font.ColorIndex\n            Debug.Print \"New ColorIndex is \" &amp; newColorIndex &amp; \", \" &amp; _\n                        \"Old ColorIndex is \" &amp; oldColorIndex\n        Next\n    Next\n</code></pre>\n\n<p><strong>Edit: The array version</strong></p>\n\n<pre><code>    Dim newColourArray(29, 11) ' using zero-based array, adjust if you wish\n    Dim oldColourArray(29, 11) ' using zero-based array, adjust if you wish\n\n    For r = 1 To 30 ' this is the number of rows in your range\n        For c = 8 To 19\n            newColourArray(r - 1, c - 8) = newSheet.Cells(r, c).Font.ColorIndex\n            oldColourArray(r - 1, c - 8) = oldSheet.Cells(r, c).Font.ColorIndex\n        Next\n    Next\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 4171779, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/87165c67aa50c08877ffd5935128bc2e?s=128&d=identicon&r=PG&f=1", "display_name": "Zee_K", "link": "https://stackoverflow.com/users/4171779/zee-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 32483936, "answer_count": 1, "score": 0, "last_activity_date": 1441967925, "creation_date": 1441810615, "last_edit_date": 1441967925, "question_id": 32482978, "link": "https://stackoverflow.com/questions/32482978/compare-two-sheets-in-terms-of-cell-colour", "title": "Compare two sheets in terms of cell colour", "body": "<p>I have two sheets which have the same data, but one is old data and one updated... Each Sheet has different columns with cells which have colours affiliated with each and a value. My issue is finding a way of comparing the two sheets in terms of the colours so need to capture what has changed for example column 2 ID 2113 changed its colour from amber to green, or from green to red etc etc...</p>\n\n<p>I tried putting the two into arrays however i found out it doesn't capture the format, which is all I need, I have formulas to capture the value data change...</p>\n\n<p>This is what I have so far, any ideas how to take this forward?<br>\nAre multidimentional arrays the way forward to solve this?</p>\n\n<p><strong>Combine sheet = the new data (updated)\nOld Data = the old data</strong></p>\n\n<p><strong>There are 19 columns, however its only Columns H-S (8-19) which have the pricing</strong></p>\n\n<pre><code>    Sheets(\"Combine\").Select\n\n    Dim arrNewData()\n\n    Dim intRows\n\n    intRows = Sheets(\"Combine\").UsedRange.Rows.Count\n\n    ReDim Preserve arrNewData(1 To intRows, 1 To 19)\n\n    For i = 1 To UBound(arrNewData, 1)\n\n        For j = 1 To UBound(arrNewData, 2)\n\n            arrNewData(i, j) = Sheets(\"Combine\").Cells(i, j)\n\n      Next\n\n   Next\n\n    '---------------------------------------\n\n    Sheets(\"Old Data\").Select\n\n    Dim arrNewData()\n\n    Dim intRows\n\n    intRows = Sheets(\"Old Data\").UsedRange.Rows.Count\n\n    ReDim Preserve arrNewData(1 To intRows, 1 To 19)\n\n    For i = 1 To UBound(arrNewData, 1)\n\n        For j = 1 To UBound(arrNewData, 2)\n\n            arrNewData(i, j) = Sheets(\"Old Data\").Cells(i, j)\n\n      Next\n\n   Next\n\n   '----------------------------------------\n</code></pre>\n\n<p>--------------------------UPDATE-------------------------------------\nSo I still need to get a reference to the row using the first column A.. as that contains an ID which I can then use the two arrays together to compare..</p>\n\n<p>I also need to make the array size dynamic thus introducing <strong>intRows</strong></p>\n\n<p>Apparently a zero based array is better? but not sure how to define it?</p>\n\n<pre><code>    Dim newSheet As Worksheet\nDim oldSheet As Worksheet\n\nDim r As Integer\nDim c As Integer\n\nSet newSheet = ThisWorkbook.Worksheets(\"Combine\")\nSet oldSheet = ThisWorkbook.Worksheets(\"Old Data\")\n\nintRowsNew = newSheet.UsedRange.Rows.Count\nintRowsOld = oldSheet.UsedRange.Rows.Count\n\nDim newColourArray()\nReDim Preserve newColourArray(1 To intRowsNew, 7 To 19)\n\nDim oldColourArray()\nReDim Preserve oldColourArray(1 To intRowsOld, 7 To 19)\n\nFor r = 1 To intRowsNew ' this is the number of rows in your range\n\n        newColourArray(r, 7) = newSheet.Cells(r, 1).Value\n        oldColourArray(r, 7) = oldSheet.Cells(r, 1).Value\n\n        Debug.Print \"New is \" &amp; newColourArray(r, 7) &amp; \", \" &amp; _\n                    \"Old is \" &amp; oldColourArray(r, 7)\n\n    For c = 8 To 19\n\n        newColourArray(r, c) = newSheet.Cells(r, c).Font.ColorIndex\n        oldColourArray(r, c) = oldSheet.Cells(r, c).Font.ColorIndex\n\n        Debug.Print \"New is \" &amp; newColourArray(r, c) &amp; \", \" &amp; _\n                    \"Old is \" &amp; oldColourArray(r, c)\n\n    Next\n\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 422, "user_id": 2216106, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZEajV.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/2216106/sean"}, "edited": false, "score": 1, "creation_date": 1441810593, "post_id": 32482832, "comment_id": 52826729, "body": "What code have you tried?"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 4045948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a30affe8a55d485c03721d778bd3aaa1?s=128&d=identicon&r=PG&f=1", "display_name": "JS142", "link": "https://stackoverflow.com/users/4045948/js142"}, "edited": false, "score": 0, "creation_date": 1441811599, "post_id": 32482966, "comment_id": 52827442, "body": "Hi MattewD. Thanks for that. Yes I would think so, but not really sure where to paste that and what to prefix it with? (private sub etc). Apologies but I have a very basic and patchy knowledge of VBA! Thank you"}, {"owner": {"reputation": 23, "user_id": 4045948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a30affe8a55d485c03721d778bd3aaa1?s=128&d=identicon&r=PG&f=1", "display_name": "JS142", "link": "https://stackoverflow.com/users/4045948/js142"}, "edited": false, "score": 0, "creation_date": 1441813157, "post_id": 32482966, "comment_id": 52828523, "body": "Sorry I&#39;ve managed to get it now. Thanks for your suggestion any how"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1441810590, "creation_date": 1441810590, "answer_id": 32482966, "question_id": 32482832, "link": "https://stackoverflow.com/questions/32482832/run-separate-macros-depending-on-checkbox-value/32482966#32482966", "title": "Run separate macros depending on checkbox value", "body": "<p>Are you simply talking about an if statement?</p>\n\n<pre><code>If CheckBox1.Value = True Then\n    RunSomeSub\nElse\n    RunSomeOtherSub\nEnd IF\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4045948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a30affe8a55d485c03721d778bd3aaa1?s=128&d=identicon&r=PG&f=1", "display_name": "JS142", "link": "https://stackoverflow.com/users/4045948/js142"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 528, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1441810590, "creation_date": 1441810261, "question_id": 32482832, "link": "https://stackoverflow.com/questions/32482832/run-separate-macros-depending-on-checkbox-value", "title": "Run separate macros depending on checkbox value", "body": "<p>I would like to call a different macro depending on whether my checkbox (form control) is checked (true) or not (false).</p>\n\n<p>Any idea on the syntax?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "compiler-errors"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 10, "creation_date": 1441809927, "post_id": 32482558, "comment_id": 52826221, "body": "<code>FullSeriesCollection</code> was added in Excel 2013. See <a href=\"https://msdn.microsoft.com/en-us/library/office/jj230578.aspx\" rel=\"nofollow noreferrer\">This</a>. What happens when you replace <code>FullSeriesCollection</code> object with <code>SeriesCollection</code>?"}, {"owner": {"reputation": 61, "user_id": 5317494, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bxi-BWk4EaI/AAAAAAAAAAI/AAAAAAAADcY/eCIuTrL-s2E/photo.jpg?sz=128", "display_name": "JPerez", "link": "https://stackoverflow.com/users/5317494/jperez"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1441830695, "post_id": 32482558, "comment_id": 52837832, "body": "It works! I also had to remove this row: <code>Application.CommandBars(&quot;Format Object&quot;).Visible = False</code>. I&#39;m not sure why. If you don&#39;t mind me asking, what is the difference between <code>FullSeriesCollection</code> and <code>SeriesCollection</code>?  My macro performs the same action with either in Excel 2013."}], "answers": [{"comments": [{"owner": {"reputation": 8303, "user_id": 1737251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/744f56deb6b34d40f07d878fb5d37fec?s=128&d=identicon&r=PG", "display_name": "eli-k", "link": "https://stackoverflow.com/users/1737251/eli-k"}, "edited": false, "score": 0, "creation_date": 1552902123, "post_id": 40917352, "comment_id": 97171817, "body": "Can you (or @SiddharthRout) say if once changed from <code>FullSeriesCollection</code> to <code>SeriesCollection</code> in order to be compatible with excel 2010, will the same code still work in excel 2013?"}, {"owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "reply_to_user": {"reputation": 8303, "user_id": 1737251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/744f56deb6b34d40f07d878fb5d37fec?s=128&d=identicon&r=PG", "display_name": "eli-k", "link": "https://stackoverflow.com/users/1737251/eli-k"}, "edited": false, "score": 0, "creation_date": 1552909725, "post_id": 40917352, "comment_id": 97176275, "body": "@eli-k I guess it&#39;s just a question of trying and see if it works?"}, {"owner": {"reputation": 8303, "user_id": 1737251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/744f56deb6b34d40f07d878fb5d37fec?s=128&d=identicon&r=PG", "display_name": "eli-k", "link": "https://stackoverflow.com/users/1737251/eli-k"}, "edited": false, "score": 0, "creation_date": 1552911541, "post_id": 40917352, "comment_id": 97177306, "body": "Well I did and it does - but this is just in one specific case. What I was wondering is whether there are scenarios where using <code>SeriesCollection</code> instead of <code>FullSeriesCollection</code> in excel 2013(+) might fail, and therefore require different versions of the code for different versions of Excel."}], "tags": [], "owner": {"reputation": 34352, "user_id": 119775, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/fK5bc.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Corbett", "link": "https://stackoverflow.com/users/119775/jean-fran%c3%a7ois-corbett"}, "is_accepted": false, "score": 5, "last_activity_date": 1517299539, "last_edit_date": 1517299539, "creation_date": 1480615140, "answer_id": 40917352, "question_id": 32482558, "link": "https://stackoverflow.com/questions/32482558/fullseriescollection-generates-compile-error-method-or-data-member-not-found/40917352#40917352", "title": "FullSeriesCollection generates &quot;Compile Error: Method or Data Member not found&quot; in Excel 2010", "body": "<p><code>FullSeriesCollection</code> was <a href=\"https://msdn.microsoft.com/en-us/library/office/jj230578.aspx\" rel=\"nofollow noreferrer\">added in Excel 2013</a>. It isn't a valid property in earlier versions. </p>\n\n<p>Replace <code>FullSeriesCollection</code> with <code>SeriesCollection</code>, which is valid in Excel 2010.</p>\n\n<p>Credits to <a href=\"https://stackoverflow.com/users/1140579/siddharth-rout\">Siddharth Rout</a> who posted this answer as a <a href=\"https://stackoverflow.com/questions/32482558/macro-works-in-2013-not-in-2010-with-compile-error-method-or-data-member-not/40917352?noredirect=1#comment52826221_32482558\">comment</a>. </p>\n"}], "owner": {"reputation": 61, "user_id": 5317494, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bxi-BWk4EaI/AAAAAAAAAAI/AAAAAAAADcY/eCIuTrL-s2E/photo.jpg?sz=128", "display_name": "JPerez", "link": "https://stackoverflow.com/users/5317494/jperez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5495, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1558263441, "creation_date": 1441809515, "last_edit_date": 1558263441, "question_id": 32482558, "link": "https://stackoverflow.com/questions/32482558/fullseriescollection-generates-compile-error-method-or-data-member-not-found", "title": "FullSeriesCollection generates &quot;Compile Error: Method or Data Member not found&quot; in Excel 2010", "body": "<p>I created a macro that adds data labels to the two series in my pivot chart.</p>\n\n<pre><code>Sub Data_Labels_On_Pivot2()\n'\n' Data_Labels_On_Pivot2 Macro\n'\n\n'\n    ActiveSheet.Unprotect\n    ActiveSheet.ChartObjects(\"Chart 14\").Activate\n    ActiveChart.SetElement (msoElementDataLabelCenter)\n    ActiveSheet.ChartObjects(\"Chart 14\").Activate\n    ActiveChart.FullSeriesCollection(1).DataLabels.Select\n    Selection.Position = xlLabelPositionOutsideEnd\n    Application.CommandBars(\"Format Object\").Visible = False\n    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True\nEnd Sub\n</code></pre>\n\n<p>This works on machines running Excel 2013.</p>\n\n<p>With Excel 2010 <code>.FullSeriesCollection(1)</code> generates an error:</p>\n\n<blockquote>\n  <p>\"Compile Error: Method or data member not found\"</p>\n</blockquote>\n\n<p>I googled this topic and was not able to find anything.  I did come across the ActiveX issues from the Windows update earlier this year and was not able to find any .exd files on the machine running Excel 2010 that I am testing with.</p>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441813508, "post_id": 32482469, "comment_id": 52828782, "body": "A shot in the dark.. try this...   <code>.PivotCache.SourceData = Sheets(&quot;Data&quot;).Name &amp; &quot;!&quot; &amp; rng.Address(True, True, xlR1C1, True)</code>"}, {"owner": {"reputation": 101, "user_id": 3737057, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/f1da49020a914ba0e505e58794d6d60a?s=128&d=identicon&r=PG&f=1", "display_name": "user3737057", "link": "https://stackoverflow.com/users/3737057/user3737057"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441813831, "post_id": 32482469, "comment_id": 52829022, "body": "Thanks for the suggestion, but still getting the same error."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441814547, "post_id": 32482469, "comment_id": 52829560, "body": "I tested the code and your code works for me. Though I am not in favor of how you are finding the last row and last column. <code>Sheets(&quot;Data&quot;).Cells(RowCount, ColCount)</code>. If there is a blank cell in Col A then your row count will go for a toss. I would recommend using <a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">This</a> to find the last row and last column to construct your range"}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 3737057, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/f1da49020a914ba0e505e58794d6d60a?s=128&d=identicon&r=PG&f=1", "display_name": "user3737057", "link": "https://stackoverflow.com/users/3737057/user3737057"}, "is_accepted": false, "score": 0, "last_activity_date": 1441875033, "creation_date": 1441875033, "answer_id": 32497219, "question_id": 32482469, "link": "https://stackoverflow.com/questions/32482469/pivotcache-sourcedata-causing-application-or-object-defined-error/32497219#32497219", "title": ".PivotCache.SourceData causing Application or object defined error", "body": "<p>After hours of investigation I couldn't work out what was causing the error in my file. I ended up using an alternative to <code>.PivotCache.SourceData = rng.Address(True, True, xlR1C1, True)</code> which is <code>Sheets(PivotSht).PivotTableWizard SourceType:=xlDatabase, SourceData:=rng</code>. In order to use this approach you must have a cell within the chosen pivot table selected. To get around this you can locate the top left cell of the pivot table using <code>Sheets(PivotSht).PivotTables(PivotNme).TableRange2.Cells(1).Address</code>. My full code is below, it references the \"Static\" sheet, which is where all of my pivot table names and sheets are listed. (Also see the comment from Siddharth Rout for a better way to find the range of data).</p>\n\n<pre><code>Sub CurrentPeriodPivots()\n\nDim RowCount As Integer\nDim ColCount As Integer\nDim rng As Range\nDim CurrentPeriod As String\nDim PivotList As Variant\nDim Piv As String\nDim PivotSht As String\nDim PivotNme As String\nDim PivotLoc As String\n\nRowCount = WorksheetFunction.CountA(Sheets(\"Data\").Range(\"A:A\"))\nColCount = WorksheetFunction.CountA(Sheets(\"Data\").Range(\"1:1\"))\n\nSet rng = Sheets(\"Data\").Range(Sheets(\"Data\").Cells(1, 1), Sheets(\"Data\").Cells(RowCount, ColCount))\n\nCurrentPeriod = Sheets(\"Static\").Range(\"CurrentPeriod\")\n\nFor i = 8 To 9\n    PivotSht = Sheets(\"Static\").Cells(i, 1).Value\n    PivotNme = Sheets(\"Static\").Cells(i, 2).Value\n    PivotLoc = Sheets(PivotSht).PivotTables(PivotNme).TableRange2.Cells(1).Address\n    Sheets(PivotSht).Select\n    Range(PivotLoc).Select\n    Sheets(PivotSht).PivotTableWizard SourceType:=xlDatabase, SourceData:=rng\n    Sheets(PivotSht).PivotTables(PivotNme).PivotFields(\"Period_id\").CurrentPage = CurrentPeriod\n    Sheets(PivotSht).PivotTables(PivotNme).PivotCache.Refresh\nNext i\n\n\nFor i = 10 To 16\n    PivotSht = Sheets(\"Static\").Cells(i, 1).Value\n    PivotNme = Sheets(\"Static\").Cells(i, 2).Value\n    PivotLoc = Sheets(PivotSht).PivotTables(PivotNme).TableRange2.Cells(1).Address\n    Sheets(PivotSht).Select\n    Range(PivotLoc).Select\n    Sheets(PivotSht).PivotTableWizard SourceType:=xlDatabase, SourceData:=rng\n    Sheets(PivotSht).PivotTables(PivotNme).PivotCache.Refresh\nNext i\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 3737057, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/f1da49020a914ba0e505e58794d6d60a?s=128&d=identicon&r=PG&f=1", "display_name": "user3737057", "link": "https://stackoverflow.com/users/3737057/user3737057"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 638, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441875033, "creation_date": 1441809265, "last_edit_date": 1531164843, "question_id": 32482469, "link": "https://stackoverflow.com/questions/32482469/pivotcache-sourcedata-causing-application-or-object-defined-error", "title": ".PivotCache.SourceData causing Application or object defined error", "body": "<p>I have written the following code to edit the range of a two pivot tables. Up until the line of stars my code functions properly, however I get a \"Run-time error '1004': Application-defined or object-defined\" error on the <code>.PivotCache.SourceData = rng.Address(True, True, xlR1C1, True)</code> line. I have no idea what the cause of the error is as I copied the code from above and only changed the sheet name and pivot table name (they both definitely exist in my file). Any help?</p>\n\n<pre><code>Dim RowCount As Integer\nDim ColCount As Integer\nDim rng As Range\nDim CurrentPeriod As String\nDim PivotList As Variant\nDim Piv As String\nDim PivotSht As String\nDim PivotNme As String\n\nRowCount = WorksheetFunction.CountA(Sheets(\"Data\").Range(\"A:A\"))\nColCount = WorksheetFunction.CountA(Sheets(\"Data\").Range(\"1:1\"))\n\nSet rng = Sheets(\"Data\").Range(Sheets(\"Data\").Cells(1, 1), Sheets(\"Data\").Cells(RowCount, ColCount))\n\nCurrentPeriod = Sheets(\"Static\").Range(\"CurrentPeriod\")\n\nWith Sheets(\"Val Cat Current Returns (Adj)\").PivotTables(\"CatCurrentPivot1\")\n    .PivotCache.SourceData = rng.Address(True, True, xlR1C1, True)\n    .PivotFields(\"Period_id\").CurrentPage = CurrentPeriod\n    .PivotCache.Refresh\nEnd With\n\n**********************************\nWith Sheets(\"Val Cat Trend Returns (Adj)\").PivotTables(\"CatTrendPivot1\")\n    .PivotCache.SourceData = rng.Address(True, True, xlR1C1, True)\n    .PivotCache.Refresh\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 376, "user_id": 4218722, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3rJVb.png?s=128&g=1", "display_name": "tittaen&#228;lg", "link": "https://stackoverflow.com/users/4218722/tittaen%c3%a4lg"}, "is_accepted": true, "score": 0, "last_activity_date": 1441810574, "creation_date": 1441810574, "answer_id": 32482954, "question_id": 32482405, "link": "https://stackoverflow.com/questions/32482405/how-to-stop-excel-vbs-running-if-cell-has-contents/32482954#32482954", "title": "How to stop Excel VBS running if cell has contents", "body": "<p>Checking if the cell in column B is empty before writing the date into it is fairly straightforward. Inside your <code>With</code> statement just check if the value of the cell in B is blank and exit the sub if there is something in it. Otherwise run through your code to write the date to the cell.</p>\n\n<pre><code>With Target(1, -0)\n    If .Value &lt;&gt; \"\" Then Exit Sub\n\n    .Value = Now\n\n    .EntireColumn.AutoFit\n\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5317507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fe0db96d12e504a488e5730754097b6?s=128&d=identicon&r=PG&f=1", "display_name": "iGavB", "link": "https://stackoverflow.com/users/5317507/igavb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 32482954, "answer_count": 1, "score": 0, "last_activity_date": 1441810574, "creation_date": 1441809104, "last_edit_date": 1531161705, "question_id": 32482405, "link": "https://stackoverflow.com/questions/32482405/how-to-stop-excel-vbs-running-if-cell-has-contents", "title": "How to stop Excel VBS running if cell has contents", "body": "<p>I have created a spreadsheet which auto-fills date/time in column B when there are contents entered into column C. There is a risk however of double clicking or making changes in the cell will update the date and time, I don't want it to do this if it has already been populated.</p>\n\n<p>What do I need to add to my code to stop the macro running IF the cell has contents?</p>\n\n<p>This is the coding I used:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n    If Not Intersect(Target, Range(\"C8:C27\")) Is Nothing Then\n\n        With Target(1, -0)\n\n            .Value = Now\n\n            .EntireColumn.AutoFit\n\n        End With\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 3005564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53941e4543e0c0daf2ec3b8e56361a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Chase", "link": "https://stackoverflow.com/users/3005564/chase"}, "edited": false, "score": 0, "creation_date": 1441809785, "post_id": 32482277, "comment_id": 52826111, "body": "You got it...thank you much. Thanks for the answer AND explanation as well."}], "tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1441808769, "creation_date": 1441808769, "answer_id": 32482277, "question_id": 32482147, "link": "https://stackoverflow.com/questions/32482147/vba-append-character-to-beginning-of-filename-in-directory/32482277#32482277", "title": "VBA Append Character to Beginning of Filename in Directory", "body": "<p><code>Name .. As</code> is the move operation which is semantically a rename already, so specify the new name as <code>\"\\0\" &amp; f</code>:</p>\n\n<pre><code>If Len(f) = 13 Then Name srcDir &amp; \"\\\" &amp; f As dstDir &amp; \"\\0\" &amp; f\n</code></pre>\n"}], "owner": {"reputation": 449, "user_id": 3005564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53941e4543e0c0daf2ec3b8e56361a6c?s=128&d=identicon&r=PG&f=1", "display_name": "Chase", "link": "https://stackoverflow.com/users/3005564/chase"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 32482277, "answer_count": 1, "score": 1, "last_activity_date": 1441811487, "creation_date": 1441808452, "last_edit_date": 1441811487, "question_id": 32482147, "link": "https://stackoverflow.com/questions/32482147/vba-append-character-to-beginning-of-filename-in-directory", "title": "VBA Append Character to Beginning of Filename in Directory", "body": "<p>I am wondering if anyone can help me edit this VBA script so that it not only moves the files (this part is complete by the way), but it also appends a 0 to the front of the filename (this part has not been started.</p>\n\n<p>So, if the original filename is 123456789.tif, then the resultant will be 0123456789.tif.</p>\n\n<p>Thank you!</p>\n\n<pre><code>Sub MoveIfFilelength()\n'This script moves files from a source directory to a final directory based on the number of characters in the filename (e.g., 14, as below)\n\nDim srcDir As String\nDim dstDir As String\nDim f As String\n\nsrcDir = \"S:\\\\\" 'Input source directory\ndstDir = \"S:\\\\\" 'Input destination directory\n\nf = Dir(srcDir)\nDo While f &lt;&gt; \"\"\n  If Len(f) = 13 Then Name srcDir &amp; \"\\\" &amp; f As dstDir &amp; \"\\\" &amp; f 'Input filename length\n  f = Dir()\n  Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "reply_to_user": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "edited": false, "score": 0, "creation_date": 1441810024, "post_id": 32481453, "comment_id": 52826282, "body": "Error says Unable to get the Vlookup property of the WorksheetFunction class"}], "answers": [{"comments": [{"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1441812911, "post_id": 32483562, "comment_id": 52828366, "body": "Is my syntax ok? And yes my first column is numbers and second is names in the range I called Officers from my Tables worksheet. Something with the Vlookup is the problem....Argggh. Is there is another way to write this?"}, {"owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "reply_to_user": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1441813470, "post_id": 32483562, "comment_id": 52828753, "body": "Your syntax is good. When you get the error code and pointing your combo box value, does it show some value or empty? It it shows a value, is it found in officers?"}, {"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1441813753, "post_id": 32483562, "comment_id": 52828965, "body": "yes it shows me the value and yes it is in my Officer range"}, {"owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "reply_to_user": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1441813902, "post_id": 32483562, "comment_id": 52829076, "body": "What about case sensitive issues? A sapce perhaps? Format changes?"}, {"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1441814294, "post_id": 32483562, "comment_id": 52829377, "body": "now I got it where it wont give me an error but it wont populate the last name in textbox 531. Let me see if we are on the same page. When I open my worksheet my userform opens. The first thing I do in Combobox9 is to put the employee number and upon tabbing or entering, I want textbox531 to, pop in the last name from my Tables worksheet in the same workbook in the range called Officers. Seems I cant get the name to populate now. error is gone but nothing shows up in textbox531."}, {"owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "reply_to_user": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1441816511, "post_id": 32483562, "comment_id": 52830840, "body": "Instead of the combobox try to enter a valid number that exist in officers"}, {"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1441821219, "post_id": 32483562, "comment_id": 52833208, "body": "No, it will not show the name in the textbox531 with just the number. Thats why I am wondering if the syntax is wrong using 2010 excel."}, {"owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "reply_to_user": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1441821544, "post_id": 32483562, "comment_id": 52833389, "body": "msgbox(LName) gives nothing as well?"}, {"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1441822436, "post_id": 32483562, "comment_id": 52833823, "body": "Unable to get the Vlookup property of the WorksheetFunction. Same error."}, {"owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "edited": false, "score": 0, "creation_date": 1441892195, "post_id": 32483562, "comment_id": 52866072, "body": "I am so lost with this. Maybe a dumb question but, If I change the first ComboBox9 and then hit enter, the cursor tabs to my TextBox531. Where would I put the above code? Would it go in the Sub TextBox531 change?"}], "tags": [], "owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "is_accepted": false, "score": 0, "last_activity_date": 1441812274, "creation_date": 1441812274, "answer_id": 32483562, "question_id": 32481453, "link": "https://stackoverflow.com/questions/32481453/how-to-use-vlookup-to-populate-a-listbox-on-a-userform-after-inputting-a-number/32483562#32483562", "title": "how to use vlookup to populate a listbox on a userform after inputting a number in a combobox on the same userform using excel 2010", "body": "<p>When running your code:</p>\n\n<pre><code>Private Sub TextBox531_Change()\n   Dim LName As String\n   LName = WorksheetFunction.VLookup(ComboBox9.Value, Worksheets(\"Tables\").Range(\"Officers\"), 2, False)\n   TextBox531.Value = LName\nEnd Sub\n</code></pre>\n\n<p>I get no errors. </p>\n\n<p>one of the options to get the error: \"Unable to get the Vlookup property of the WorksheetFunction\" as you got means that there was no lookup found. meaning, if I will put this lookup in excel I will get #NA.</p>\n\n<p>To resolve this you can use <code>ifna</code> function or first check that the value from your combob ox (ComboBox9.value) is exist in the left most column of you officers range.</p>\n"}], "owner": {"reputation": 95, "user_id": 4932944, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/8d7dca986a4ab8ef50e9cfd85f9a7689?s=128&d=identicon&r=PG&f=1", "display_name": "George", "link": "https://stackoverflow.com/users/4932944/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2335, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441816037, "creation_date": 1441806750, "last_edit_date": 1531161705, "question_id": 32481453, "link": "https://stackoverflow.com/questions/32481453/how-to-use-vlookup-to-populate-a-listbox-on-a-userform-after-inputting-a-number", "title": "how to use vlookup to populate a listbox on a userform after inputting a number in a combobox on the same userform using excel 2010", "body": "<p>I am using a userform in excel 2010. I want to input an employee number in ComboBox9 and when I press tab, I want another listbox to show the lastname of who has that employee number. Then I can continue with entering data in the other userform boxes...I am working with this so far but it wont work.</p>\n\n<pre><code>Private Sub TextBox531_Change()\n   Dim LName As String\n   LName = WorksheetFunction.VLookup(ComboBox9.Value, Worksheets(\"Tables\").Range(\"Officers\"), 2, False)\n   TextBox531.Value = LName\nEnd Sub\n</code></pre>\n\n<p>It returns the error:</p>\n\n<blockquote>\n  <p>Error says Unable to get the Vlookup property of the WorksheetFunction\n  class</p>\n</blockquote>\n"}, {"tags": ["vba", "ms-access", "append"], "owner": {"reputation": 31, "user_id": 4043835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79f6614e6f9601fe7ca08e9860120a0e?s=128&d=identicon&r=PG&f=1", "display_name": "steve", "link": "https://stackoverflow.com/users/4043835/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "closed_date": 1441807276, "answer_count": 0, "score": 2, "last_activity_date": 1441810614, "creation_date": 1441806647, "last_edit_date": 1441810614, "question_id": 32481412, "link": "https://stackoverflow.com/questions/32481412/locking-record-on-ms-access-append-insert", "closed_reason": "Duplicate", "title": "Locking record on MS ACCESS append/insert", "body": "<p>I have split MSACCESS database with  about four users.</p>\n\n<p>In setting up the \"master table\" I made a bad choice but I will have to live that for a while.\nI did not use AutoNumber on the prime field simply used index no-dupicate</p>\n\n<p>On the client programs using VBA,I acquire a reference number - \"ENTRYNUM\" by doing a Dmax on the relevant field in the table and adding 1.</p>\n\n<p>There is just a few coding lines between acquiring the number and writing a record using it. BUT it appears that even in that tiny interval another user can start the same sequence and acquire the SAME  reference number,  </p>\n\n<p>Oh WOE!<br>\nI cannot do any major changes since the system is full active and busy but there surely must be something simple to fix this or I am just being stupid and overlooking the obvious ! </p>\n\n<p>I have record locking on </p>\n\n<p>A subset of the relevant VBA is as below and there is no other intervening code missed out</p>\n\n<pre><code>DoCmd.SetWarnings False\nDoCmd.OpenQuery \"EqCnt\"\n DoCmd.SetWarnings True\n\n\n\nDC = DMax(\"ENTRYNUM\", \"tbl_TRANSACTIONS\")\nIf IsNull(DC) Then\nENVAL = 1\nElse\nENVAL = DC + 1\n\nEnd If\n\n\ng_INPUTSOURCE = \"ENTERED\"\ng_ROUTE = Me.RT_PICK\n'a = Me.DELADDPC\nG_PACKNOTE = Me.PACKNOTE\nMe.DELADDPC.SetFocus\n  Me.DELADDPC.Selected(0) = True\n\n\n'b = Me.DELADDPC\ng_DELADDR = Me.DELADDPC\ng_STATUS = \"QUEUED\"\n\n\n'MsgBox (\"enval = \" &amp; ENVAL)\ng_ENTERTIME = Now()\n\n\n\nstrSQL = \"INSERT INTO tbl_TRANSACTIONS ( ENTRYNUM, _\nOPERATOR, TRANSTATUS, INPUTSOURCE, CustomerID, SiteID, _\nTRANERRFLAG, DELDATE, DELADDR,SPECINST, ROUTE, _\nTAGFLAGS, OWNER, ENTERTIME,PACKNOTE,PRIORITY) SELECT '\"\n\nstrSQL = strSQL &amp; ENVAL\nstrSQL = strSQL &amp; \"' AS Expr1, '\"\n\nstrSQL = strSQL &amp; g_OPERATOR\nstrSQL = strSQL &amp; \"' AS Expr2, '\"\n\nstrSQL = strSQL &amp; g_STATUS\nstrSQL = strSQL &amp; \"' AS Expr3, '\"\n\nstrSQL = strSQL &amp; g_INPUTSOURCE\nstrSQL = strSQL &amp; \"' AS Expr4, '\"\n\nstrSQL = strSQL &amp; g_CUSTOMERID\nstrSQL = strSQL &amp; \"' AS Expr5, '\"\n\nstrSQL = strSQL &amp; g_SITEID\nstrSQL = strSQL &amp; \"' AS Expr6, '\"\n\nstrSQL = strSQL &amp; ig_TRANERRFLAG\nstrSQL = strSQL &amp; \"' AS Expr7, '\"\n\n\nstrSQL = strSQL &amp; g_DELDATE\nstrSQL = strSQL &amp; \"' AS Expr8, '\"\n\nstrSQL = strSQL &amp; g_DELADDR\nstrSQL = strSQL &amp; \"' AS Expr9, '\"\n\nstrSQL = strSQL &amp; g_SPECINST\nstrSQL = strSQL &amp; \"' AS Expr10, '\"\n\nstrSQL = strSQL &amp; g_ROUTE\nstrSQL = strSQL &amp; \"' AS Expr11, '\"\n\n\nstrSQL = strSQL &amp; g_TAGFLAGS\nstrSQL = strSQL &amp; \"' AS Expr12, '\"\n\nstrSQL = strSQL &amp; g_OWNER\nstrSQL = strSQL &amp; \"' AS Expr13, '\"\n\nstrSQL = strSQL &amp; g_ENTERTIME\nstrSQL = strSQL &amp; \"' AS Expr14, '\"\n\nstrSQL = strSQL &amp; G_PACKNOTE\nstrSQL = strSQL &amp; \"' AS Expr15, '\"\n\nstrSQL = strSQL &amp; g_PRIORITY\nstrSQL = strSQL &amp; \"' AS Expr16;\"\n\n\n\n'MsgBox (strSQL)\nCurrentDb.Execute strSQL\n</code></pre>\n\n<p>I am still puzzled that the small interval should be so vulnerable but meanwhile I am looking for a quick fix to stop possible dupliaction of this sort - So far all the methods I have thought of imply possible the same vulnerability.</p>\n\n<p>I also am wondering that, under the circumstances, if  the Execute was the best way to carry this out.  I have tried using </p>\n\n<pre><code> With CurrentDb\n\n        .Execute strSQL, dbFailOnError\n        Debug.Print .RecordsAffected &amp; \" were added\"\n\n    End With\n</code></pre>\n\n<p>as a possible way to detect a problem.</p>\n\n<p>Can I plead for a clearer head  to have a think !</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 2, "last_activity_date": 1441805735, "creation_date": 1441805735, "answer_id": 32481067, "question_id": 32480577, "link": "https://stackoverflow.com/questions/32480577/printing-on-a-different-sheet-why-isnt-it-working/32481067#32481067", "title": "Printing on a different sheet, why isn&#39;t it working?", "body": "<p>You need to declare the worksheet object and then you can write to it.</p>\n\n<pre><code>Dim ws1 As Excel.Worksheet\nSet ws1 = ActiveWorkbook.Sheets(\"Timesheet\")\n\nws1.Range(\"A1\").Value = Time\n</code></pre>\n\n<p>I'm not sure about the protected sheet, but my guess is you will have to unprotect it temporarily.</p>\n"}, {"comments": [{"owner": {"reputation": 51, "user_id": 5274020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zrvbE.jpg?s=128&g=1", "display_name": "KjosN1", "link": "https://stackoverflow.com/users/5274020/kjosn1"}, "edited": false, "score": 0, "creation_date": 1441808938, "post_id": 32481209, "comment_id": 52825351, "body": "It is still printing in the main sheet, which I do not want. I don&#39;t know what is going on"}, {"owner": {"reputation": 520, "user_id": 5289214, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-II2pZVRGeoI/AAAAAAAAAAI/AAAAAAAAJxs/B19uiSlUBc0/photo.jpg?sz=128", "display_name": "Justin McCartney", "link": "https://stackoverflow.com/users/5289214/justin-mccartney"}, "reply_to_user": {"reputation": 51, "user_id": 5274020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zrvbE.jpg?s=128&g=1", "display_name": "KjosN1", "link": "https://stackoverflow.com/users/5274020/kjosn1"}, "edited": false, "score": 0, "creation_date": 1441813768, "post_id": 32481209, "comment_id": 52828974, "body": "What is the name of the main sheet? I updated the code  - Try that and see if the more explicit ref to wsT and wsA help."}, {"owner": {"reputation": 51, "user_id": 5274020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zrvbE.jpg?s=128&g=1", "display_name": "KjosN1", "link": "https://stackoverflow.com/users/5274020/kjosn1"}, "edited": false, "score": 0, "creation_date": 1441814435, "post_id": 32481209, "comment_id": 52829489, "body": "The name of my Main sheet is Main"}, {"owner": {"reputation": 520, "user_id": 5289214, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-II2pZVRGeoI/AAAAAAAAAAI/AAAAAAAAJxs/B19uiSlUBc0/photo.jpg?sz=128", "display_name": "Justin McCartney", "link": "https://stackoverflow.com/users/5289214/justin-mccartney"}, "reply_to_user": {"reputation": 51, "user_id": 5274020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zrvbE.jpg?s=128&g=1", "display_name": "KjosN1", "link": "https://stackoverflow.com/users/5274020/kjosn1"}, "edited": false, "score": 0, "creation_date": 1441814938, "post_id": 32481209, "comment_id": 52829837, "body": "@KjosN1 no problem at all. Mind marking this as answered? Thanks!"}], "tags": [], "owner": {"reputation": 520, "user_id": 5289214, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-II2pZVRGeoI/AAAAAAAAAAI/AAAAAAAAJxs/B19uiSlUBc0/photo.jpg?sz=128", "display_name": "Justin McCartney", "link": "https://stackoverflow.com/users/5289214/justin-mccartney"}, "is_accepted": true, "score": 1, "last_activity_date": 1441813905, "last_edit_date": 1441813905, "creation_date": 1441806074, "answer_id": 32481209, "question_id": 32480577, "link": "https://stackoverflow.com/questions/32480577/printing-on-a-different-sheet-why-isnt-it-working/32481209#32481209", "title": "Printing on a different sheet, why isn&#39;t it working?", "body": "<pre><code>Sub StampNext()\n\n    'Declare a variable as a worksheet and a variable for the named range\n    Dim wsT As Worksheet\n    Dim wsA as Worksheet\n    Dim rngT As Range\n\n    'Set that variable to the worksheet named \"Timesheet\"\n    Set wsT = ThisWorkbook.Worksheets(\"Timesheet\")\n    Set wsA = ActiveSheet\n\n    'Unprotect the sheet using the password.\n    '(Note: you should protect the VBA project from viewing to\n    ' prevent others from viewing the password.)\n    wsT.Unprotect (\"sheetPassword\")\n    wsT.Activate\n\n    'Set Range variable\n    On Error Resume Next\n    Set rngT = wsT.Range(\"Timesheet\")\n    On Error GoTo 0\n\n    If rngT Is Nothing Then\n        wsT.Range(\"A1\").Name = \"Timesheet\"\n        Set rngT = wsT.Range(\"Timesheet\")\n    End If\n\n\n   'Add value and update the named range \"Timesheet\"\n   With rngT\n        .Value = Time\n        .NumberFormat = \"hh:mm\"\n\n        If .Row = 1 Then\n            .Offset(2, 0).Name = \"Timesheet\"\n        Else\n            .Offset(-2, 1).Name = \"Timesheet\"\n        End If\n    End With\n\n    'Reprotect sheet with password\n    wsT.Protect (\"sheetPassword\")\n    wsA.activate\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 5274020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zrvbE.jpg?s=128&g=1", "display_name": "KjosN1", "link": "https://stackoverflow.com/users/5274020/kjosn1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 32481209, "answer_count": 2, "score": 1, "last_activity_date": 1441813905, "creation_date": 1441804453, "question_id": 32480577, "link": "https://stackoverflow.com/questions/32480577/printing-on-a-different-sheet-why-isnt-it-working", "title": "Printing on a different sheet, why isn&#39;t it working?", "body": "<p>So I have this button code to clock in and clock out and it works fine, but my problem is that the button is on the first sheet and I need it to stamp the time on a different sheet called Timesheet.  Here is my code.  I thought if I replaced the word Location that was in every parenthesis with the word Timesheet and it will just not stamp the time in the Timesheet. </p>\n\n<pre><code>Sub StampNext()\n    Dim r As Range\n    On Error Resume Next\n    Set r = Range(\"Timesheet\")\n    On Error GoTo 0\n    If r Is Nothing Then Range(\"A1\").Name = \"Timesheet\"\n    With Range(\"Timesheet\")\n        .Value = Time\n        .NumberFormat = \"hh:mm\"\n        If .Row = 1 Then\n            .Offset(2, 0).Name = \"Timesheet\"\n        Else\n            .Offset(-2, 1).Name = \"Timesheet\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>I also have the Timesheet protected because my boss doesn't want the employee to tamper with the sheet. I don't know if that would be a hindering problem to the code or if that just doesn't matter.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2953, "user_id": 2801253, "user_type": "registered", "profile_image": "https://graph.facebook.com/1332362525/picture?type=large", "display_name": "Mark Fitzgerald", "link": "https://stackoverflow.com/users/2801253/mark-fitzgerald"}, "edited": false, "score": 0, "creation_date": 1441804214, "post_id": 32480151, "comment_id": 52821764, "body": "Do you have all those subs in a single worksheet module?"}], "answers": [{"tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 1, "last_activity_date": 1441804767, "creation_date": 1441804767, "answer_id": 32480695, "question_id": 32480151, "link": "https://stackoverflow.com/questions/32480151/combining-multiple-worksheet-change-macros/32480695#32480695", "title": "Combining multiple Worksheet_Change macros", "body": "<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"J1:O1\")) Is Nothing Then\n    Application.EnableEvents = False\n        Range(\"J2:O3\").ClearContents\n        Range(\"D15:E15\").ClearContents\n            Range(\"B16:E16\").ClearContents\n                Range(\"B17:E19\").ClearContents\n        Range(\"D20:E20\").ClearContents\n            Range(\"B21:E21\").ClearContents\n                Range(\"B22:E24\").ClearContents\n        Range(\"D25:E25\").ClearContents\n            Range(\"B26:E26\").ClearContents\n                 Range(\"B27:E29\").ClearContents\n        Range(\"D30:E30\").ClearContents\n            Range(\"B31:E31\").ClearContents\n                 Range(\"B32:E34\").ClearContents\n        Range(\"B3:H14\").ClearContents\n    Application.EnableEvents = True\nEnd If\n\nIf Not Intersect(Target, Range(\"J2:K2\")) Is Nothing Then\n    Application.EnableEvents = False\n        Range(\"J3:K3\").ClearContents\n    Application.EnableEvents = True\nEnd If\n\nIf Not Intersect(Target, Range(\"L2:M2\")) Is Nothing Then\n    Application.EnableEvents = False\n        Range(\"L3:M3\").ClearContents\n    Application.EnableEvents = True\nEnd If\n\nIf Not Intersect(Target, Range(\"N2:O2\")) Is Nothing Then\n    Application.EnableEvents = False\n        Range(\"N3:O3\").ClearContents\n    Application.EnableEvents = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "is_accepted": true, "score": 2, "last_activity_date": 1441804777, "creation_date": 1441804777, "answer_id": 32480702, "question_id": 32480151, "link": "https://stackoverflow.com/questions/32480151/combining-multiple-worksheet-change-macros/32480702#32480702", "title": "Combining multiple Worksheet_Change macros", "body": "<p>The code below is simply your code put together in 1 <code>Sub</code> with multiple <code>If statements</code>. The only change is that the <code>If</code> is now an <code>If Not</code> which will process the code if there is an <code>Intersect</code> and then <code>Exit sub</code>.</p>\n\n<p>The following code will do the trick:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"J1:O1\")) Is Nothing Then\n        Application.EnableEvents = False\n        Range(\"J2:O3\").ClearContents\n        Range(\"D15:E15\").ClearContents\n        Range(\"B16:E16\").ClearContents\n        Range(\"B17:E19\").ClearContents\n        Range(\"D20:E20\").ClearContents\n        Range(\"B21:E21\").ClearContents\n        Range(\"B22:E24\").ClearContents\n        Range(\"D25:E25\").ClearContents\n        Range(\"B26:E26\").ClearContents\n        Range(\"B27:E29\").ClearContents\n        Range(\"D30:E30\").ClearContents\n        Range(\"B31:E31\").ClearContents\n        Range(\"B32:E34\").ClearContents\n        Range(\"B3:H14\").ClearContents\n        Application.EnableEvents = True\n        Exit Sub\n    End If\n    If Not Intersect(Target, Range(\"J2:K2\")) Is Nothing Then\n        Application.EnableEvents = False\n        Range(\"J3:K3\").ClearContents\n        Application.EnableEvents = True\n        Exit Sub\n    End If\n    If Not Intersect(Target, Range(\"L2:M2\")) Is Nothing Then\n        Application.EnableEvents = False\n        Range(\"L3:M3\").ClearContents\n        Application.EnableEvents = True\n        Exit Sub\n    End If\n    If Not Intersect(Target, Range(\"N2:O2\")) Is Nothing Then\n        Application.EnableEvents = False\n        Range(\"N3:O3\").ClearContents\n        Application.EnableEvents = True\n        Exit Sub\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5317164"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1373, "favorite_count": 0, "accepted_answer_id": 32480702, "answer_count": 2, "score": 0, "last_activity_date": 1441805396, "creation_date": 1441803359, "last_edit_date": 1441803745, "question_id": 32480151, "link": "https://stackoverflow.com/questions/32480151/combining-multiple-worksheet-change-macros", "title": "Combining multiple Worksheet_Change macros", "body": "<p>I am trying to combine multiple worksheet_change macros (see code below).  My goal is that whenever the \"target\" range (a merged, drop-down list cell) is changed, the ranges below (again, merged cells) will clear.  I need to do this for when MULTIPLE different cells are changed, hence the multiple worksheet change codes.</p>\n\n<pre><code>    Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"J1:O1\")) Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n        Range(\"J2:O3\").ClearContents\n        Range(\"D15:E15\").ClearContents\n            Range(\"B16:E16\").ClearContents\n                Range(\"B17:E19\").ClearContents\n        Range(\"D20:E20\").ClearContents\n            Range(\"B21:E21\").ClearContents\n                Range(\"B22:E24\").ClearContents\n        Range(\"D25:E25\").ClearContents\n            Range(\"B26:E26\").ClearContents\n                 Range(\"B27:E29\").ClearContents\n        Range(\"D30:E30\").ClearContents\n            Range(\"B31:E31\").ClearContents\n                 Range(\"B32:E34\").ClearContents\n        Range(\"B3:H14\").ClearContents\n    Application.EnableEvents = True\n    End Sub\n\n    Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"J2:K2\")) Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n        Range(\"J3:K3\").ClearContents\n    Application.EnableEvents = True\n    End Sub\n\n    Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"L2:M2\")) Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n        Range(\"L3:M3\").ClearContents\n    Application.EnableEvents = True\n    End Sub\n\n    Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"N2:O2\")) Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n        Range(\"N3:O3\").ClearContents\n    Application.EnableEvents = True\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2058, "user_id": 4721734, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/514054622e745c08541d6b1674b8ac1e?s=128&d=identicon&r=PG&f=1", "display_name": "M&#225;t&#233; Juh&#225;sz", "link": "https://stackoverflow.com/users/4721734/m%c3%a1t%c3%a9-juh%c3%a1sz"}, "edited": false, "score": 0, "creation_date": 1441803330, "post_id": 32479868, "comment_id": 52821113, "body": "please clarify your question. Do you want to remove all #148 characters from cell, entire worksheet / workbook? Please also share what have you already tried."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1441803616, "creation_date": 1441803616, "answer_id": 32480247, "question_id": 32479868, "link": "https://stackoverflow.com/questions/32479868/macro-to-remove-ascii-code/32480247#32480247", "title": "Macro to remove ASCII code", "body": "<p>Do you mean something like:</p>\n\n<pre><code>Sub kleanup()\n  Cells.Replace what:=Chr(148), replacement:=\"\"\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 5277649, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f3d51e7bfebdbafd5d40d1f1d3af2857?s=128&d=identicon&r=PG&f=1", "display_name": "User04", "link": "https://stackoverflow.com/users/5277649/user04"}, "edited": false, "score": 0, "creation_date": 1441811709, "post_id": 32480864, "comment_id": 52827521, "body": "Thanks in fact i would like to apply it to all ranges cells of my excel file"}], "tags": [], "owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "is_accepted": false, "score": 0, "last_activity_date": 1441805161, "creation_date": 1441805161, "answer_id": 32480864, "question_id": 32479868, "link": "https://stackoverflow.com/questions/32479868/macro-to-remove-ascii-code/32480864#32480864", "title": "Macro to remove ASCII code", "body": "<p>You can search a given cell for the char and replace it with whatever you want.</p>\n\n<pre><code>Dim iIndex as integer\nDim szValue as String\n\nszValue = Range(\"A1\").Value\n\niIndex = InStr(szValue, Chr(148))\nIf iIndex &lt;&gt; 0 Then\n    Mid(szValue, iIndex, 1) = \" \"\nEnd If\n\nRange(\"A1\").Value = szValue\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5277649, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/f3d51e7bfebdbafd5d40d1f1d3af2857?s=128&d=identicon&r=PG&f=1", "display_name": "User04", "link": "https://stackoverflow.com/users/5277649/user04"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1441805683, "creation_date": 1441802561, "last_edit_date": 1531161705, "question_id": 32479868, "link": "https://stackoverflow.com/questions/32479868/macro-to-remove-ascii-code", "title": "Macro to remove ASCII code", "body": "<p>Any idea if there is a Excel macro to remove ASCII code such as &amp; #148; and so on.  </p>\n\n<p>There is a function like CLEAN for non-printable characters to do it?</p>\n"}, {"tags": ["vba", "excel", "loops"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5317097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f07e46a023bdf69c68707e8338c3326?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/5317097/red"}, "edited": false, "score": 0, "creation_date": 1441806675, "post_id": 32480326, "comment_id": 52823597, "body": "Thanks Guys these both work , Except for the cell verification. If cell AE4 &gt;= AD4 then copy cell AE4 value to AD4 which worked"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441806859, "post_id": 32480326, "comment_id": 52823747, "body": "Using <code>.Select</code> is &quot;bad&quot; coding practice as there is no real need for it in VBA. instead your code should read: <code>Worksheets(&quot;Sheet1&quot;).Cells(i,30).Value = Worksheets(&quot;Sheet1&quot;).Cells(i,31).Value</code>"}, {"owner": {"reputation": 48, "user_id": 4563803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f7b31a656c0a7dd278c88b6275733cb?s=128&d=identicon&r=PG", "display_name": "Vaizard27", "link": "https://stackoverflow.com/users/4563803/vaizard27"}, "edited": false, "score": 0, "creation_date": 1441807414, "post_id": 32480326, "comment_id": 52824149, "body": "aware of that; just didn&#39;t want to confuse more than neccessary. It doesn&#39;t make the thing any slower and for debugging it is actually better in my opinion because it is clearer what the code actually does when you go through it for testing. if you stack some of those loops and then have to debug looking for that one cell index you set wrong it&#39;s a massive pain."}], "tags": [], "owner": {"reputation": 48, "user_id": 4563803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f7b31a656c0a7dd278c88b6275733cb?s=128&d=identicon&r=PG", "display_name": "Vaizard27", "link": "https://stackoverflow.com/users/4563803/vaizard27"}, "is_accepted": false, "score": 0, "last_activity_date": 1441803800, "creation_date": 1441803800, "answer_id": 32480326, "question_id": 32479847, "link": "https://stackoverflow.com/questions/32479847/looping-a-cut-and-paste-if-criteria-is-met/32480326#32480326", "title": "Looping a cut and paste if criteria is met", "body": "<p>Easiest way is probably a lopp that just repeats what you are doing.\nInstead of defining x and y as ranges, you would only need a count variable:</p>\n\n<pre><code>dim lastrow as integer\nlastrow = Cells(Rows.count, \"AE\").End(xlUp).row 'counts the amount of cells you have with values in the row\n\nfor i = 2 to lastrow 'set 2 = whatever, but I guess you have header rows, if you want to start in the 4th row set it 4\n\nif CELLS(i,31).Value &gt;= CELLS(i,30).Value THEN 'the cell commands uses 1-indexed numbers to refer to cells on an x-y axis, rows go on the x axis so Cells(2,1) is \"B1\" for some reason.\n    'insert your loop here\n    Cells(i,31).Select\n    Selection.Copy\n    Cells(i,30).Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n       :=False, Transpose:=False\nEnd if\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 5317097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f07e46a023bdf69c68707e8338c3326?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/5317097/red"}, "edited": false, "score": 0, "creation_date": 1441808120, "post_id": 32480565, "comment_id": 52824685, "body": "Thank you.  Only issue i have with this is it seems to ignore the          If cell.Value &gt;= cell.Offset(, -1).Value Then                          cell.Offset(, -1).Value = cell.Value It copies the cell value regardless. if the value is below then i would like this to ignore the copy."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 5, "user_id": 5317097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f07e46a023bdf69c68707e8338c3326?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/5317097/red"}, "edited": false, "score": 0, "creation_date": 1441809056, "post_id": 32480565, "comment_id": 52825455, "body": "Hmm. Check the values of each cell just above the if statement. Try Debug.Print (cell.Address(False, False) &amp; &quot;=&quot; &amp; cell.Offset(, -1).Value &amp; &quot; v. &quot; &amp; cell.Offset(, -1).Address(False, False) &amp; &quot;=&quot; &amp; cell.Value)."}, {"owner": {"reputation": 5, "user_id": 5317097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f07e46a023bdf69c68707e8338c3326?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/5317097/red"}, "edited": false, "score": 0, "creation_date": 1441813877, "post_id": 32480565, "comment_id": 52829057, "body": "I have tried to paste in;          Debug.Print (cell.Address(False, False) &amp; &quot;=&quot; &amp; cell.Offset(, -1).Value &amp; &quot; v. &quot; &amp; cell.Offset(, -1).Address(False, False) &amp; &quot;=&quot; &amp; cell.Value)     Above the if statement and this runs, however the  &gt;= is still being ignored and all cells with a value greter that cell.value are still being overwriten. I also have very little idea what this extra line is doing."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 5, "user_id": 5317097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f07e46a023bdf69c68707e8338c3326?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/5317097/red"}, "edited": false, "score": 0, "creation_date": 1441814985, "post_id": 32480565, "comment_id": 52829871, "body": "The Debug.Print line just writes the cell results to the immediate window of your editor (usually at the very bottom) so you can see it - it&#39;ll give you the cell address and value contained within it. My suspicion is we&#39;re either testing the wrong cells or the values aren&#39;t as we think they should be. Just noticed, line should say: Debug.Print (cell.Address(False, False) &amp; &quot;=&quot; &amp; cell.Value &amp; &quot; v. &quot; &amp; cell.Offset(, -1).Address(False, False) &amp; &quot;=&quot; &amp; cell.Offset(, -1).Value). Run it again and see what the values say. If you can&#39;t see the immediate window, go to View -&gt; ImmediateWindow."}, {"owner": {"reputation": 5, "user_id": 5317097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f07e46a023bdf69c68707e8338c3326?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/5317097/red"}, "edited": false, "score": 0, "creation_date": 1441869630, "post_id": 32480565, "comment_id": 52850759, "body": "The values all look ok.  AE4=5 v. AD4=9.    :  Added the debug after the if statement as well and get the following results.  AE4=5 v. AD4=9  ; AE4=5 v. AD4=5  ; AE5=1 v. AD5=9 ; AE5=1 v. AD5=1  ;"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 5, "user_id": 5317097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f07e46a023bdf69c68707e8338c3326?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/5317097/red"}, "edited": false, "score": 0, "creation_date": 1441879940, "post_id": 32480565, "comment_id": 52857616, "body": "Hmm, that&#39;s odd. You&#39;re going to have to step through the code to see what&#39;s going on. Place a stop marker on the If line (do this by clicking in the margin next to the line). Run the code and when it stops, click &#39;Step into&#39; (or it F8) and use the Locals window to see what all the values are. I&#39;m going to edit my post to make this easier for you to see the variables, so use the edited code."}, {"owner": {"reputation": 5, "user_id": 5317097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f07e46a023bdf69c68707e8338c3326?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/5317097/red"}, "edited": false, "score": 0, "creation_date": 1442483382, "post_id": 32480565, "comment_id": 53104187, "body": "OK this is now sorted.  Issue was with the multiple &quot;&quot; in the formula not the comparison.  By removing the &quot;&quot; from around the numbers the formula and comparisions now work as expected.  THank you all for your assistance. : startCell.Formula = &quot;=IF(RC[-2]&gt;=TODAY()-28,1,IF(AND(RC[-2]&lt;TODAY()-28,RC[-2]&gt;=T&zwnj;&#8203;ODAY()-35),4,IF(AND(&zwnj;&#8203;RC[-2]&lt;TODAY()-35,RC&zwnj;&#8203;[-2]&gt;=TODAY()-42),5,&zwnj;&#8203;IF(AND(RC[-2]&lt;TODAY(&zwnj;&#8203;)-42,RC[-2]&gt;=TODAY()&zwnj;&#8203;-49),6,IF(AND(RC[-2]&zwnj;&#8203;&lt;TODAY()-49,RC[-2]&gt;=&zwnj;&#8203;TODAY()-56),7,IF(AND&zwnj;&#8203;(RC[-2]&lt;TODAY()-56,R&zwnj;&#8203;C[-2]&gt;=TODAY()-63),8&zwnj;&#8203;,IF(AND(RC[-2]&lt;TODAY&zwnj;&#8203;()-63,RC[-2]&gt;=TODAY(&zwnj;&#8203;)-70),9,IF(RC[-2]&lt;TO&zwnj;&#8203;DAY()-70,10))))))))&quot;"}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 5, "user_id": 5317097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f07e46a023bdf69c68707e8338c3326?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/5317097/red"}, "edited": false, "score": 0, "creation_date": 1442501972, "post_id": 32480565, "comment_id": 53115976, "body": "Nice one. Hope that Locals window helped."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "reply_to_user": {"reputation": 5, "user_id": 5317097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f07e46a023bdf69c68707e8338c3326?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/5317097/red"}, "edited": false, "score": 0, "creation_date": 1442892845, "post_id": 32480565, "comment_id": 53259112, "body": "Could you accept one of the answers so that this question is closed. Thanks."}], "tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": true, "score": 2, "last_activity_date": 1441880468, "last_edit_date": 1441880468, "creation_date": 1441804420, "answer_id": 32480565, "question_id": 32479847, "link": "https://stackoverflow.com/questions/32479847/looping-a-cut-and-paste-if-criteria-is-met/32480565#32480565", "title": "Looping a cut and paste if criteria is met", "body": "<p>Below is some code that'll do what I think you're asking. It looks as though you're relying on the macro generator quite heavily which tends to 'select' a lot more than a developer needs to do. Have a play with your code and look at other posts to see how others do it.</p>\n\n<pre><code>Sub Test()\n    Dim ws As Worksheet\n    Dim startCell as Range\n    Dim fullRng As Range\n    Dim thisCell As Range\n    Dim leftCell as Range\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set startCell = ws.Range(\"AE4\")\n    Set fullRng = startCell.Resize(196)\n\n    startCell.Formula = \"=IF(RC[-2]&gt;=TODAY()-28,\"\"1\"\",IF(AND(RC[-2]&lt;TODAY()-28,RC[-2]&gt;=TODAY()-35),\"\"4\"\",IF(AND(RC[-2]&lt;TODAY()-35,RC[-2]&gt;=TODAY()-42),\"\"5\"\",IF(AND(RC[-2]&lt;TODAY()-42,RC[-2]&gt;=TODAY()-49),\"\"6\"\",IF(AND(RC[-2]&lt;TODAY()-49,RC[-2]&gt;=TODAY()-56),\"\"7\"\",IF(AND(RC[-2]&lt;TODAY()-56,RC[-2]&gt;=TODAY()-63),\"\"8\"\",IF(AND(RC[-2]&lt;TODAY()-63,RC[-2]&gt;=TODAY()-70),\"\"9\"\",IF(RC[-2]&lt;TODAY()-70,\"\"10\"\"))))))))\"\n    startCell.AutoFill fullRng\n\n    For Each thisCell In fullRng.Cells\n        Set leftCell = thisCell.Offset(, -1)\n        Debug.Print(\"Before If: \" &amp; thisCell.Address(False, False) &amp; \"=\" &amp; thisCell.Value2 &amp; \" v. \" &amp; leftCell.Address(False, False) &amp; \"=\" &amp; leftCell.Value2)\n        If thisCell.Value2 &gt;= leftCell.Value2 Then\n            leftCell.Value2 = cell.Value2\n            Debug.Print(\"After If: \" &amp; thisCell.Address(False, False) &amp; \"=\" &amp; thisCell.Value2 &amp; \" v. \" &amp; leftCell.Address(False, False) &amp; \"=\" &amp; leftCell.Value2)\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5317097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f07e46a023bdf69c68707e8338c3326?s=128&d=identicon&r=PG&f=1", "display_name": "Red", "link": "https://stackoverflow.com/users/5317097/red"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 32480565, "answer_count": 2, "score": 0, "last_activity_date": 1441880468, "creation_date": 1441802481, "last_edit_date": 1441802793, "question_id": 32479847, "link": "https://stackoverflow.com/questions/32479847/looping-a-cut-and-paste-if-criteria-is-met", "title": "Looping a cut and paste if criteria is met", "body": "<p>I am trying to loop the following </p>\n\n<pre><code>Dim x As Integer\nDim y As Integer\n\nx = Range(\"AE4\")\ny = Range(\"AD4\")\n\nIf x &gt;= y Then\nRange(\"AE4\").Select\nSelection.Copy\nRange(\"AD4\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nElse\n\nEnd If\n</code></pre>\n\n<p>Once this cell AE4 has been checked and then copied or not depeding of it is greater or = to AD4 i would like this to then move on to AE5, AE6 etc to the end of the data set. any ideas what i need to do next? I currently have the rest of the script executed before this checking iof the a cell date is below 4 weeks and then 5 weeks, 6 weeks old up to 10 weeks. and is currenlty working as expected checking the date of the cell and then checking and copying the first cell in the data. </p>\n\n<p>Full script is as follows.</p>\n\n<pre><code>Sub Test()\n\n  Range(\"AE4\").Select\n    ActiveCell.Formula = _\n      \"=IF(RC[-2]&gt;=TODAY()-28,\"\"1\"\",IF(AND(RC[-2]&lt;TODAY()-28,RC[-2]&gt;=TODAY()-35),\"\"4\"\",IF(AND(RC[-2]&lt;TODAY()-35,RC[-2]&gt;=TODAY()-42),\"\"5\"\",IF(AND(RC[-2]&lt;TODAY()-42,RC[-2]&gt;=TODAY()-49),\"\"6\"\",IF(AND(RC[-2]&lt;TODAY()-49,RC[-2]&gt;=TODAY()-56),\"\"7\"\",IF(AND(RC[-2]&lt;TODAY()-56,RC[-2]&gt;=TODAY()-63),\"\"8\"\",IF(AND(RC[-2]&lt;TODAY()-63,RC[-2]&gt;=TODAY()-70),\"\"9\"\",IF(RC[-2]&lt;TODAY()-70,\"\"10\"\"))))))))\"\n  Range(\"AE4\").Select\n  Selection.AutoFill Destination:=Range(\"AE4:AE200\")\n  Range(\"AE4:AE200\").Select\n\n  Dim x As Integer\n  Dim y As Integer\n\n  x = Range(\"AE4\")\n  y = Range(\"AD4\")\n\n  If x &gt;= y Then\n  Range(\"AE4\").Select\n  Selection.Copy\n  Range(\"AD4\").Select\n  Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n  Else\n\n  End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441803762, "post_id": 32479872, "comment_id": 52821444, "body": "Great research! I have a few more related links <a href=\"http://stackoverflow.com/questions/32447670/hiding-vars-in-strings-vs-using-objects-with-properties/32448252#32448252\">here</a>, maybe it will help"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441804982, "post_id": 32479872, "comment_id": 52822344, "body": "thanks for the feedback and reading it.  I found the links you provided useful and have incorporated some of them and some of your text) into my answer."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441805094, "post_id": 32479872, "comment_id": 52822429, "body": "@Paul your comment elsewhere covers a lot of what I wrote, but what I like about the info in a table, is that it gives info at a glance and really allows you to more easily choose whether to use a collection or not."}, {"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 4, "creation_date": 1441805354, "post_id": 32479872, "comment_id": 52822604, "body": "My favorite feature of Dicts is that I can output the values or keys as an array. If this table were not an image, I would have added that feature, but alas..."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 1, "creation_date": 1441806710, "post_id": 32479872, "comment_id": 52823622, "body": "@Dick I&#39;ve added this for you.  Is there anything else you want added or any mistakes you notice?   (I&#39;ve restructured the table)  PS.  I tried to reformat my OneNote table to insert it as a table into the answer and couldn&#39;t work out how it could be done!  (Any ideas)"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1441806802, "post_id": 32479872, "comment_id": 52823693, "body": "You may be missing that using Dictionary requires setting a reference while Collection is native to Access."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1441807731, "post_id": 32479872, "comment_id": 52824380, "body": "@Gustav.  Thanks. I&#39;ve added it and reworded the above text to point people towards this."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1441814207, "post_id": 32479872, "comment_id": 52829302, "body": "That&#39;s why I like your research - short, visual summary, and easy to compare! I always forget about the advantage that @Dick mentioned - it&#39;s can be very effective; I&#39;ll have to review it in more details see if I can remember anything else - it&#39;s a great reference to have"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1441816063, "post_id": 32479872, "comment_id": 52830587, "body": "Thanks @Paul.  there is so much to remember, I rely on creating crib sheets like this in Onenote (often with screen grabs using snagit).  I&#39;m glad I shared it now.  I&#39;m generally a bit frustrated that a lot of documentation and help is not more consice and comparative."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441820065, "post_id": 32479872, "comment_id": 52832677, "body": "It&#39;s covering quite a few aspects! I&#39;m not sure about this but for dictionaries it may not be possible to retrieve the the item using an index (for collections it is), but dictionaries have the array feature, so an indirect index retrieval might be acceptable. You should probably make this more dynamic (easier to update, somehow) instead of a picture - I want to keep it as a quick reference (good thing you shared it!)"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 1, "creation_date": 1441823043, "post_id": 32479872, "comment_id": 52834126, "body": "As I see it the two significant advantages of collections are: 1. You can access and item using it&#39;s index.  2: You need not populate the key.  So they&#39;re good for lots of scenarios with objects where you just want to keep a collection of object references and loop through them... Am I right?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441827247, "post_id": 32479872, "comment_id": 52836180, "body": "You&#39;re right - some of the obvious ones, but this is why it&#39;s good to have this kind of list: to compare advantages for scenarios that are not that common. I&#39;ll add an answer with some more basic details and differences"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441842248, "post_id": 32479872, "comment_id": 52842156, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/89204/discussion-between-harveyfrench-and-paul-bica\">continue this discussion in chat</a>."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 0, "creation_date": 1539126793, "post_id": 32479872, "comment_id": 92386011, "body": "Thanks for this useful summary. I&#39;ve attempted to edit and replace the screenshot with a table."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 0, "creation_date": 1540763489, "post_id": 32479872, "comment_id": 92972938, "body": "One more difference from <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office2000/aa164502(v=office.10)\" rel=\"nofollow noreferrer\">docs.microsoft</a> &quot;if you&#39;re creating a custom object model, you can use a Collection object to store a reference to a custom collection, but you can&#39;t use a Dictionary object to do this.&quot;"}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1540763774, "post_id": 32479872, "comment_id": 92973017, "body": "I&#39;m not entirely sure how to interpret the statement quoted in my previous comment, but since I learned the technique of representing a collection with a custom class from <a href=\"https://rads.stackoverflow.com/amzn/click/com/1119067723\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">this great book</a> (p. 677) by @DickKusleika, I thought maybe you could shed some additional light on this?"}, {"owner": {"reputation": 118, "user_id": 14131395, "user_type": "registered", "profile_image": "https://graph.facebook.com/2643173585949806/picture?type=large", "display_name": "MD Ismail Hosen", "link": "https://stackoverflow.com/users/14131395/md-ismail-hosen"}, "edited": false, "score": 0, "creation_date": 1617871232, "post_id": 32479872, "comment_id": 118430797, "body": "First point isn&#39;t correct in case of adding, deleting or searching..Dictionary perform way more worst than collection. If you want to see the comparison then please see this &gt;&gt; <a href=\"https://www.facebook.com/photo?fbid=2788518801415283&amp;set=pcb.1340532979641819\" rel=\"nofollow noreferrer\">facebook.com/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 56, "last_activity_date": 1594544566, "last_edit_date": 1594544566, "creation_date": 1441802569, "answer_id": 32479872, "question_id": 32479842, "link": "https://stackoverflow.com/questions/32479842/comparison-of-dictionary-collections-and-arrays/32479872#32479872", "title": "Comparison of Dictionary, Collections and Arrays", "body": "<p>Please see the table below for a useful comparison of collections and dictionaries.</p>\n<p>(The table summarises <a href=\"http://www.experts-exchange.com/articles/3391/Using-the-Dictionary-Class-in-VBA.html\" rel=\"noreferrer\">this page</a> up to the section on &quot;Early And late binding&quot;. FYI the page also has more detailed info about using dictionaries)</p>\n<p>In summary it's usually best to use a dictionary or an array.</p>\n<p>When considering using collections it may be more appropriate to use an array if the size does not change, or changes only rarely.  In this case an array is likely to be more efficient than a collection as Arrays\u00a0are very efficient to populate and retrieve all items at once (eg. range to array and array back to range).</p>\n<p>Also note:</p>\n<p>Compared to Arrays, collections offer good performance for adding and inserting items, and accessing and removing them by their Keys. However, performance is poor if items are to be accessed by index.  For information about doing this efficiently see <a href=\"http://www.vbaccelerator.com/home/VB/Code/Techniques/A_Fast_Index-Based_Object_Collection/article.asp\" rel=\"noreferrer\">here</a> which also discusses the inner workings of these list objects.</p>\n<p><a href=\"http://www.cpearson.com/excel/CollectionsAndDictionaries.htm\" rel=\"noreferrer\">This cpearson page</a> has has very useful code for working with dictionaries, collections and arrays (sorting them, and also converting them to be each other!)</p>\n<p>Some text from cpearson's page:</p>\n<blockquote>\n<p>The Collection object and the Dictionary object are very useful for\nstoring groups of related data.  All else being equal, I use a\nDictionary object rather than a Collection object because you have\naccess (read, write, change) to the Key property associated with an\nItem in the Dictionary. In a rather poor object design, the Key of an\nitem in a Collection is write-only. You can assign a Key to an Item\nwhen you add the Item to the Collection, but you cannot retrieve the\nKey associated with an Item nor can you determine (directly) whether a\nkey exists in a Collection. Dictionaries are much friendly and open\nwith their keys. Dictionaries are also considerably faster than\nCollections.</p>\n</blockquote>\n<p>Why can arrays be a bad choice.\nArrays are much slower at re-sizing and inserting items in the middle as each Redim copies the entire memory block to a larger location, and if Preserve is used, all values copied over as well. This may translate to perceived slowness for every operation - in a potential application)</p>\n<p><strong>Collections vs. Dictionaries in VBA</strong></p>\n<pre><code>Feature                 | COLLECTION | DICTIONARY | Remark\n------------------------+------------+------------+--------------------------------\nUsually faster          |            |     X      | \n------------------------+------------+------------+--------------------------------\nSupported by VB Script  |            |     X      | Collections do not exist in VBS.\n------------------------+------------+------------+--------------------------------\n                        |            |            | Dicts: Add ref to Miscrosoft \nNative to VBA           |     X      |            | Scripting Library. Usage:\n                        |            |            | Dim MyDict As Scripting.Dictionary\n                        |            |            | Set MyDict = New Scripting.Dictionary\n------------------------+------------+------------+--------------------------------\nCan change Keys and     |            |            | Dict properties are writable.\nItems                   |            |     X      | For collections, remove the item\n                        |            |            | and add a new item.\n------------------------+------------+------------+--------------------------------\n                        |            |            | A collection enumerates its items:\n                        |            |            |  For Each x In MyCollection\n                        |            |            |      Debug.Print x\nEnumerated              |     X      |     X      |  Next x\n                        |            |            | A dict enumerates its keys:\n                        |            |            |  For Each x In MyDictionary\n                        |            |            |      Debug.Print MyDictionary.Item(x)\n                        |            |            |  Next x\n------------------------+------------+------------+--------------------------------\n                        |            |            | A 1-d array of keys \nDirectly output to      |            |            | and items can be returned by \narray                   |            |     X      | dict methods .Keys and .Items.\n                        |            |            | (The array is zero-based even \n                        |            |            |  with Option Base 1.)\n------------------------+------------+------------+--------------------------------\nRetrieve and access     |     X      |     X      |\nitems                   |            |            |  \n------------------------+------------+------------+--------------------------------\nAdd items               |     X      |     X      |\n------------------------+------------+------------+--------------------------------\nImplicitly add items    |            |     X      | Dicts can implicitly add items \n                        |            |            | using .Item property.\n------------------------+------------+------------+--------------------------------\nRemove items            |     X      |     X      |\n------------------------+------------+------------+--------------------------------\nRemove all items in     |            |            | With collections, each item must\none step                |            |     X      | be removed in turn, or the \n                        |            |            | collection destroyed and recreated.\n------------------------+------------+------------+--------------------------------\nCount items             |     X      |     X      |\n------------------------+------------+------------+--------------------------------\nReturn item using key   |     X      |     X      |\nas lookup value         |            |            |\n------------------------+------------+------------+--------------------------------\nReturn item using       |            |            |\nordinal position        |     X      |   (Slow)   |\nas lookup value         |            |            |\n------------------------+------------+------------+--------------------------------\nReturn ordinal          |            |            |\nposition using item     |     X      |     ??     |\nas lookup value         |            |            |\n------------------------+------------+------------+--------------------------------\nRetrieve and access     |            |     X      | Collection keys only used to\nkeys                    |            |            | look up data, not retrievable.\n------------------------+------------+------------+--------------------------------\nKeys optional           |     X      |            | Big + of collections, assuming keys\n                        |            |            | are not needed. (Access via index.)\n------------------------+------------+------------+--------------------------------\nCase sensitivity        |            |     X      |\noptional                |            |            |  \n------------------------+------------+------------+--------------------------------\n                        |            |            | Collection keys must be strings.\nKeys can be any type    |            |     X      | Dict keys can have any type\n                        |            |            | (except arrays), incl. mixed types.\n------------------------+------------+------------+--------------------------------\nKeys must be unique     |     X      |     X      |\n------------------------+------------+------------+--------------------------------\n                        |            |            | * For collections, add code:\n                        |            |            |  Public Function _\n                        |            |            |     Contains(col As Collection, _\nSupports .Exists method |  Remark*   |     X      |     key As Variant) As Boolean\n                        |            |            |     On Error Resume Next\n                        |            |            |     col(key)\n                        |            |            |     Contains = (Err.Number = 0)\n------------------------+------------+------------+--------------------------------\nPreserve key order when |            |     X      | This is because collection keys \nsorting by item value   |            |            | are write-only, not read. Poor design!\n</code></pre>\n<p>The original image, which has more information and is more clearly arranged:</p>\n<p><img src=\"https://i.stack.imgur.com/EvuOh.jpg\" alt=\"Comparison table image\" /></p>\n"}, {"comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1442445425, "post_id": 32487945, "comment_id": 53090866, "body": "Thanks Paul - thats a useful resource."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 21, "last_activity_date": 1441827887, "creation_date": 1441827887, "answer_id": 32487945, "question_id": 32479842, "link": "https://stackoverflow.com/questions/32479842/comparison-of-dictionary-collections-and-arrays/32487945#32487945", "title": "Comparison of Dictionary, Collections and Arrays", "body": "<pre><code>Option Explicit\n\nSub CollectionsVSdictionaries() ' Requires ref to \"Microsoft Scripting Runtime\" Library\n    Dim c As Collection         ' TypeName 1-based indexed\n    Dim d As Dictionary         ' 0-based arrays\n    Set c = New Collection      ' or: \"Dim c As New Collection\"\n    Set d = New Dictionary      ' or: \"Dim d As New Dictionary\"\n\n    c.Add Key:=\"A\", Item:=\"AA\": c.Add Key:=\"B\", Item:=\"BB\": c.Add Key:=\"C\", Item:=\"CC\"\n    d.Add Key:=\"A\", Item:=\"AA\": d.Add Key:=\"B\", Item:=\"BB\": d.Add Key:=\"C\", Item:=\"CC\"\n\n    Debug.Print TypeName(c)    ' -&gt; \"Collection\"\n    Debug.Print TypeName(d)    ' -&gt; \"Dictionary\"\n\n    Debug.Print c(3)            ' -&gt; \"CC\"\n    Debug.Print c(\"C\")          ' -&gt; \"CC\"\n    'Debug.Print c(\"CC\")       ' --- Invalid ---\n\n    Debug.Print d(\"C\")          ' -&gt; \"CC\"\n    Debug.Print d(\"CC\")        ' Adds Key:=\"CC\", Item:=\"\"\n    Debug.Print d.Items(2)      ' -&gt; \"CC\"\n    Debug.Print d.Keys(2)       ' -&gt; \"C\"\n    Debug.Print d.Keys()(0)     ' -&gt; \"A\"    - Not well known ***************************\n    Debug.Print d.Items()(0)    ' -&gt; \"AA\"   - Not well known ***************************\n\n    'Collection methods:\n    '    .Add                   ' c.Add Item, [Key], [Before], [After] (Key is optional)\n    '    .Count\n    '    .Item(Index)           ' Default property;   \"c.Item(Index)\" same as \"c(Index)\"\n    '    .Remove(Index)\n    'Dictionary methods:\n    '    .Add                   ' d.Add Key, Item (Key is required, and must be unique)\n    '    .CompareMode           ' 1. BinaryCompare     - case-sensitive   (\"A\" &lt; \"a\")\n    '    .CompareMode           ' 2. DatabaseCompare   - MS Access only\n    '    .CompareMode           ' 3. TextCompare       - case-insensitive (\"A\" = \"a\")\n    '    .Count\n    '    .Exists(Key)           ' Boolean **********************************************\n    '    .Item(Key)\n    '    .Items                 ' Returns full array: .Items(0)(0)\n    '    .Key(Key)\n    '    .Keys                  ' Returns full array: .Keys(0)(0)\n    '    .Remove(Key)\n    '    .RemoveAll             ' ******************************************************\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2093, "user_id": 2437521, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/RuvcM.jpg?s=128&g=1", "display_name": "C. Tewalt", "link": "https://stackoverflow.com/users/2437521/c-tewalt"}, "edited": false, "score": 5, "creation_date": 1533659979, "post_id": 51731459, "comment_id": 90424093, "body": "Thanks for wanting to contribute to Stack Overflow. The OP was asking for a simple table that compares the various features. Posting an answer with a bunch of code without an explanation on how it relates to the question isn&#39;t very helpful."}], "tags": [], "owner": {"reputation": 1, "user_id": 10193167, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/36f29e4aad947f1e53c5e5b4f0ed5f56?s=128&d=identicon&r=PG", "display_name": "rishi", "link": "https://stackoverflow.com/users/10193167/rishi"}, "is_accepted": false, "score": 0, "last_activity_date": 1548203129, "last_edit_date": 1548203129, "creation_date": 1533659225, "answer_id": 51731459, "question_id": 32479842, "link": "https://stackoverflow.com/questions/32479842/comparison-of-dictionary-collections-and-arrays/51731459#51731459", "title": "Comparison of Dictionary, Collections and Arrays", "body": "<pre><code>Option Explicit\n\nSub UpdateSummary()\n\n    Dim varData\n    Dim objDicCountry As Object\n    Dim objDicCity As Object\n    Dim objDicData As Object\n    Dim lngR As Long\n    Dim varResult\n    Dim lngC As Long\n    Dim strKey As String\n    Dim varUnique\n\n    varData = Sheet12.Range(\"A1\").CurrentRegion\n    Set objDicCity = CreateObject(\"Scripting.Dictionary\")\n    Set objDicCountry = CreateObject(\"Scripting.Dictionary\")\n    Set objDicData = CreateObject(\"Scripting.Dictionary\")\n\n    For lngR = LBound(varData) + 1 To UBound(varData)\n\n        strKey = varData(lngR, 1) '--Country\n        objDicCountry.Item(strKey) = \"\"\n\n        strKey = varData(lngR, 2) '--City\n        objDicCity.Item(strKey) = \"\"\n\n        strKey = varData(lngR, 1) &amp; \"|\" &amp; varData(lngR, 2) '--Country and City\n        objDicData.Item(strKey) = objDicData.Item(strKey) + varData(lngR, 3)\n\n    Next lngR\n\n    ReDim varResult(1 To objDicCountry.Count + 1, 1 To objDicCity.Count + 1)\n\n    varUnique = objDicCountry.keys '--get Unique Country\n\n    For lngR = LBound(varUnique) To UBound(varUnique)\n        varResult(lngR + 2, 1) = varUnique(lngR)\n    Next lngR\n\n    varUnique = objDicCity.keys '--get Unique City\n\n    For lngC = LBound(varUnique) To UBound(varUnique)\n        varResult(1, lngC + 2) = varUnique(lngC)\n    Next lngC\n\n\n    For lngR = LBound(varResult) + 1 To UBound(varResult)\n        For lngC = LBound(varResult) + 1 To UBound(varResult, 2)\n            strKey = varResult(lngR, 1) &amp; \"|\" &amp; varResult(1, lngC) '--Country &amp; \"|\" &amp; City\n            varResult(lngR, lngC) = objDicData.Item(strKey)\n        Next lngC\n    Next lngR\n\n    Sheet12.Range(\"F6\").Resize(UBound(varResult), UBound(varResult, 2)).Value = varResult\n    MsgBox \"Done\", vbInformation\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 161, "user_id": 1382318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5c3c40a891ce36f8a0b8dbd3ccb7e12?s=128&d=identicon&r=PG", "display_name": "neilt17", "link": "https://stackoverflow.com/users/1382318/neilt17"}, "is_accepted": false, "score": 8, "last_activity_date": 1561019558, "creation_date": 1561019558, "answer_id": 56682050, "question_id": 32479842, "link": "https://stackoverflow.com/questions/32479842/comparison-of-dictionary-collections-and-arrays/56682050#56682050", "title": "Comparison of Dictionary, Collections and Arrays", "body": "<p>With regards to the performance of collections versus dictionaries, I am finding that writing to dictionaries performs similarly to writing to collections, reading from a dictionary takes about twice as long as reading from a collection. Creating a dictionary in the first place is way slower than creating a collection.</p>\n\n<p>These are results I got for doing 100,000 iterations of reading from, writing to, and creating dictionaries/collections:</p>\n\n<pre><code>Creating Multiple Dictionaries:   731ms\nWriting To Dictionary:            494ms\nReading From Dictionary:           65ms\n\nCreating Multiple Collections:     29ms\nWriting To Collection:            459ms\nReading From Collection:           26ms\n</code></pre>\n\n<p>Note adding a reference to the Microsoft Scripting Runtine improves the speed of creating multiple dictionaries (to 495ms here).</p>\n\n<p>This is the code I used for testing this:</p>\n\n<pre><code>Option Explicit\n\nPrivate p_lngTestCount As Long\n\nSub SetUp()\n  p_lngTestCount = 100000\nEnd Sub\n\nSub TestAll()\n  CreatingMultipleDictionaries\n  WritingToDictionary\n  ReadingFromDictionary\n\n  CreatingMultipleCollections\n  WritingToCollection\n  ReadingFromCollection\nEnd Sub\n\nSub CreatingMultipleDictionaries()\n\n  Const sSOURCE As String = \"CreatingMultipleDictionaries\"\n\n  Dim oPerfMon As CDevPerformanceMonitor\n  Set oPerfMon = New CDevPerformanceMonitor\n  Dim i As Long\n  Dim dcTest As Dictionary\n  SetUp\n\n  Dim dblTimeElapsed As Double\n  oPerfMon.StartCounter\n\n  For i = 0 To p_lngTestCount\n    'Set dcTest = CreateObject(\"Scripting.Dictionary\")\n    Set dcTest = New Dictionary\n  Next i\n\n  dblTimeElapsed = oPerfMon.TimeElapsed\n\n  Debug.Print sSOURCE &amp; \": \" &amp; p_lngTestCount &amp; \" iterations. \" &amp; vbCrLf &amp; _\n              \"Time elapsed: \" &amp; Round(dblTimeElapsed, 0) &amp; \"ms\" &amp; vbCrLf\nEnd Sub\n\nSub CreatingMultipleCollections()\n\n  Const sSOURCE As String = \"CreatingMultipleCollections\"\n\n  Dim oPerfMon As CDevPerformanceMonitor\n  Set oPerfMon = New CDevPerformanceMonitor\n  Dim i As Long\n  Dim colTest As Collection\n  SetUp\n\n  Dim dblTimeElapsed As Double\n  oPerfMon.StartCounter\n\n  For i = 0 To p_lngTestCount\n    Set colTest = New Collection\n  Next i\n\n  dblTimeElapsed = oPerfMon.TimeElapsed\n\n  Debug.Print sSOURCE &amp; \": \" &amp; p_lngTestCount &amp; \" iterations. \" &amp; vbCrLf &amp; _\n              \"Time elapsed: \" &amp; Round(dblTimeElapsed, 0) &amp; \"ms\" &amp; vbCrLf\nEnd Sub\n\nSub WritingToDictionary()\n\n  Const sSOURCE As String = \"WritingToDictionary\"\n\n  Dim oPerfMon As CDevPerformanceMonitor\n  Set oPerfMon = New CDevPerformanceMonitor\n  Dim i As Long\n  Dim dcTest\n  SetUp\n\n  Set dcTest = CreateObject(\"Scripting.Dictionary\")\n  'Set dcTest = New Dictionary\n\n  Dim dblTimeElapsed As Double\n  oPerfMon.StartCounter\n\n  For i = 0 To p_lngTestCount\n   ' Performance about the same for both ways:\n    dcTest.Item(CStr(i)) = \"test\"\n    'dcTest.Add CStr(i), \"test\"\n  Next i\n\n  dblTimeElapsed = oPerfMon.TimeElapsed\n\n  Debug.Print sSOURCE &amp; \": \" &amp; p_lngTestCount &amp; \" iterations. \" &amp; vbCrLf &amp; _\n              \"Time elapsed: \" &amp; Round(dblTimeElapsed, 0) &amp; \"ms\" &amp; vbCrLf\nEnd Sub\n\nSub WritingToCollection()\n\n  Const sSOURCE As String = \"WritingToCollection\"\n\n  Dim oPerfMon As CDevPerformanceMonitor\n  Set oPerfMon = New CDevPerformanceMonitor\n  Dim i As Long\n  Dim colTest As Collection\n  SetUp\n\n  Dim dblTimeElapsed As Double\n  Set colTest = New Collection\n\n  oPerfMon.StartCounter\n\n  For i = 0 To p_lngTestCount\n    colTest.Add \"test\", CStr(i)\n  Next i\n\n  dblTimeElapsed = oPerfMon.TimeElapsed\n\n  Debug.Print sSOURCE &amp; \": \" &amp; p_lngTestCount &amp; \" iterations. \" &amp; vbCrLf &amp; _\n              \"Time elapsed: \" &amp; Round(dblTimeElapsed, 0) &amp; \"ms\" &amp; vbCrLf\nEnd Sub\n\nSub ReadingFromDictionary()\n\n  Const sSOURCE As String = \"ReadingFromDictionary\"\n\n  Dim oPerfMon As CDevPerformanceMonitor\n  Set oPerfMon = New CDevPerformanceMonitor\n  Dim i As Long\n  Dim dcTest\n  SetUp\n\n  Set dcTest = CreateObject(\"Scripting.Dictionary\")\n  'Set dcTest = New Dictionary\n  dcTest.Add \"key\", \"test\"\n\n  Dim stTest As String\n  Dim dblTimeElapsed As Double\n\n  oPerfMon.StartCounter\n\n  For i = 0 To p_lngTestCount\n    stTest = dcTest.Item(\"key\")\n  Next i\n\n  dblTimeElapsed = oPerfMon.TimeElapsed\n\n  Debug.Print sSOURCE &amp; \": \" &amp; p_lngTestCount &amp; \" iterations. \" &amp; vbCrLf &amp; _\n              \"Time elapsed: \" &amp; Round(dblTimeElapsed, 0) &amp; \"ms\" &amp; vbCrLf\nEnd Sub\n\nSub ReadingFromCollection()\n\n  Const sSOURCE As String = \"ReadingFromCollection\"\n\n  Dim oPerfMon As CDevPerformanceMonitor\n  Set oPerfMon = New CDevPerformanceMonitor\n  Dim i As Long\n  Dim colTest As Collection\n  SetUp\n\n  Dim stTest As String\n  Dim dblTimeElapsed As Double\n  Set colTest = New Collection\n  colTest.Add \"test\", \"key\"\n\n  oPerfMon.StartCounter\n\n  For i = 0 To p_lngTestCount\n    stTest = colTest.Item(\"key\")\n  Next i\n\n  dblTimeElapsed = oPerfMon.TimeElapsed\n\n  Debug.Print sSOURCE &amp; \": \" &amp; p_lngTestCount &amp; \" iterations. \" &amp; vbCrLf &amp; _\n              \"Time elapsed: \" &amp; Round(dblTimeElapsed, 0) &amp; \"ms\" &amp; vbCrLf\nEnd Sub\n</code></pre>\n\n<p>Performance monitor class (CDevPerformanceMonitor):</p>\n\n<pre><code>Option Explicit\n\n' Performance monitoring used in logging\n' See: https://stackoverflow.com/questions/198409/how-do-you-test-running-time-of-vba-code\n\nPrivate Type LARGE_INTEGER\n  lowpart As Long\n  highpart As Long\nEnd Type\n\n#If VBA7 Then\n  Private Declare PtrSafe Function QueryPerformanceCounter Lib \"kernel32\" (lpPerformanceCount As LARGE_INTEGER) As Long\n#Else\n  Private Declare Function QueryPerformanceCounter Lib \"kernel32\" (lpPerformanceCount As LARGE_INTEGER) As Long\n#End If\n\n#If VBA7 Then\n  Private Declare PtrSafe Function QueryPerformanceFrequency Lib \"kernel32\" (lpFrequency As LARGE_INTEGER) As Long\n#Else\n  Private Declare Function QueryPerformanceFrequency Lib \"kernel32\" (lpFrequency As LARGE_INTEGER) As Long\n#End If\n\nPrivate m_CounterStart As LARGE_INTEGER\nPrivate m_CounterEnd As LARGE_INTEGER\nPrivate m_crFrequency As Double\n\nPrivate Const TWO_32 = 4294967296#               ' = 256# * 256# * 256# * 256#\n\nPrivate Function LI2Double(LI As LARGE_INTEGER) As Double\n  Dim Low As Double\n  Low = LI.lowpart\n  If Low &lt; 0 Then\n    Low = Low + TWO_32\n  End If\n  LI2Double = LI.highpart * TWO_32 + Low\nEnd Function\n\nPrivate Sub Class_Initialize()\n  Dim PerfFrequency As LARGE_INTEGER\n  QueryPerformanceFrequency PerfFrequency\n  m_crFrequency = LI2Double(PerfFrequency)\nEnd Sub\n\nPublic Sub StartCounter()\n  QueryPerformanceCounter m_CounterStart\nEnd Sub\n\nPublic Function PerformanceCount() As Double\n  Dim liPerformanceCount As LARGE_INTEGER\n  QueryPerformanceCounter liPerformanceCount\n  PerformanceCount = LI2Double(liPerformanceCount)\nEnd Function\n\nPublic Function MicroTime() As Double\n  MicroTime = Me.PerformanceCount * 1000000# / m_crFrequency\nEnd Function\n\nPublic Property Get TimeElapsed() As Double\n  Dim crStart As Double\n  Dim crStop As Double\n  QueryPerformanceCounter m_CounterEnd\n  crStart = LI2Double(m_CounterStart)\n  crStop = LI2Double(m_CounterEnd)\n  TimeElapsed = 1000# * (crStop - crStart) / m_crFrequency\nEnd Property\n</code></pre>\n"}], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44790, "favorite_count": 24, "accepted_answer_id": 32479872, "answer_count": 4, "score": 29, "last_activity_date": 1594544566, "creation_date": 1441802460, "last_edit_date": 1594540839, "question_id": 32479842, "link": "https://stackoverflow.com/questions/32479842/comparison-of-dictionary-collections-and-arrays", "title": "Comparison of Dictionary, Collections and Arrays", "body": "<p>I am trying to work out the relative benefits and features of dictionaries compared with collections and arrays.</p>\n\n<p>I found an excellent article <a href=\"http://www.experts-exchange.com/articles/3391/Using-the-Dictionary-Class-in-VBA.html\" rel=\"noreferrer\">here</a> but can't find a simple table that compares all the various features.</p>\n\n<p>Does anyone know of one?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1441802747, "post_id": 32479431, "comment_id": 52820636, "body": "I avoid loops whenever I can, but you need it for comparing values. In your case the main problem is inserting rows, and CountIf(). You can improve the speed significantly if you copy both ranges to array, and write the second one back only once (it would helpful if you include the full function)"}], "answers": [{"tags": [], "owner": {"reputation": 1484, "user_id": 4248728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a21PJ.jpg?s=128&g=1", "display_name": "Balinti", "link": "https://stackoverflow.com/users/4248728/balinti"}, "is_accepted": false, "score": 1, "last_activity_date": 1441802607, "creation_date": 1441802607, "answer_id": 32479881, "question_id": 32479431, "link": "https://stackoverflow.com/questions/32479431/compare-2-columns-without-using-loop/32479881#32479881", "title": "Compare 2 columns without using loop", "body": "<p>Make a vertical lookup in excel first and then search for NAs in the loop. It will be much faster. You can delete the lookup after your work is done.</p>\n"}], "owner": {"reputation": 119, "user_id": 5215694, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/2eacff7729d672a8b33e03fbb2bfed57?s=128&d=identicon&r=PG&f=1", "display_name": "Souma", "link": "https://stackoverflow.com/users/5215694/souma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441802607, "creation_date": 1441801249, "question_id": 32479431, "link": "https://stackoverflow.com/questions/32479431/compare-2-columns-without-using-loop", "title": "Compare 2 columns without using loop", "body": "<p>I have to compare 2 columns in 2 different sheets then add the missing cells in the second sheet. But the problem is that i used a loop and it takes too much time. Do someone have an idea of how to compare these 2 columns without using a loop.</p>\n\n<pre><code>    Set col_1 = Worksheets(\"Plan Traitement Risque\").Range(\"B6:B700\")\n\n      With ThisWorkbook.Sheets(\"Analyse de risque\")\n        For i = 200 To 6 Step -1\n          'Test si valeur cellule feuil1!=Ax est dans Plage col_2(feuil2!A1:A50))\n        If Application.CountIf(col_1, .Range(\"B\" &amp; i).Value) = 0 Then\n            'Delete ligne i feuil1\n            .Rows(i).Copy\n             Sheets(\"Plan Traitement Risque\").Rows(i).Insert (xlShiftDown)\nEnd If\n    Next i\n  End With\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts"], "comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441802318, "post_id": 32479161, "comment_id": 52820307, "body": "I think it would be useful to see your code to understand what it is doing."}, {"owner": {"reputation": 1, "user_id": 5314057, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153630956459345/picture?type=large", "display_name": "Phil Gray", "link": "https://stackoverflow.com/users/5314057/phil-gray"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441804368, "post_id": 32479161, "comment_id": 52821880, "body": "Effectively the code identifies the active unit from the list, pastes that value into a key cell referenced by the other formulae in the worksheets that generate the local stores.  Once that&#39;s done the code runs &quot;calculate&quot; (on all open workbooks) and then selects the sheets to be outputted... All aspects of this have worked well before (over a period of a year) but in this instance the result is not as expected."}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441805898, "post_id": 32479161, "comment_id": 52823028, "body": "So you are saying your code has always worked but now its creating an issue? If that is not the case I would still suggest to post your code in your question as there could always be something not 100% with the code, or is there a reason why you won&#39;t or can&#39;t post?"}, {"owner": {"reputation": 1, "user_id": 5314057, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153630956459345/picture?type=large", "display_name": "Phil Gray", "link": "https://stackoverflow.com/users/5314057/phil-gray"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441806649, "post_id": 32479161, "comment_id": 52823579, "body": "Will post when I can access file..."}, {"owner": {"reputation": 1, "user_id": 5314057, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153630956459345/picture?type=large", "display_name": "Phil Gray", "link": "https://stackoverflow.com/users/5314057/phil-gray"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 1, "creation_date": 1441871836, "post_id": 32479161, "comment_id": 52852171, "body": "resolved - the issue is Excel&#39;s ability to refresh the cached series data for charts, which apparently is finite.  Adding coding to update an aspect of the chart flushes the cached data, so refreshing the data in the chart."}], "owner": {"reputation": 1, "user_id": 5314057, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153630956459345/picture?type=large", "display_name": "Phil Gray", "link": "https://stackoverflow.com/users/5314057/phil-gray"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1441866585, "creation_date": 1441800460, "last_edit_date": 1441866585, "question_id": 32479161, "link": "https://stackoverflow.com/questions/32479161/calculate-partial-update-of-charts", "title": "Calculate - partial update of charts", "body": "<p>Background:</p>\n\n<p>I have a workbook which is structured as follows:</p>\n\n<p>Summary sheet - holds the data bank, organised by unit code.</p>\n\n<p>Worksheet(s) - formulae on these sheets report elements from the data bank to a local store on the sheet, based on the selected unit code.  Concatenation formulae report the data from the local store as part of a text string, and a simple bar chart refers to the same local store.</p>\n\n<p>Iteration runs through a list of unit codes to output a series of reports unique to that unit code.  As calculation is disabled the VBA includes a Calculate function to refresh the values based on the selected unit code before outputting each report.</p>\n\n<p>Issue:</p>\n\n<p>From a specific code (lets call it Code Q) onward the calculate function appears to be only partly effective. Although the local store of data is successfully updated to reflect the active unit code (as evidenced by the concatenated text), some (not all) of the charts appear to be static (do not reflect the data for the active unit code but the data for Code Q) - even more intriguingly, from my POV, on some charts (scatterplots) the local store holds the correct x and y values, but the chart reflects the active code's x value and the Code Q's Y value??</p>\n\n<p>Is this a VBA issue, an Excel issue or something else?</p>\n\n<p>[Added code]</p>\n\n<pre><code>'define the name of the survey as it will appear in the filename\nDim File_Short_Name As String\n\nFile_Short_Name = InputBox(\"What is the SHORT title of the file - for use in the filename?\")\n\n\n'Defines the Source workbook\nDim wbSource As Workbook\nSet wbSource = ThisWorkbook\n\n'Prompts the user for the path to the commentary files.\n\nSet diaFolder2 = Application.FileDialog(msoFileDialogFolderPicker)\ndiaFolder2.AllowMultiSelect = False\ndiaFolder2.Title = \"Where are the commentary Files?\"\ndiaFolder2.Show\n\nMsgBox diaFolder2.SelectedItems(1)\n\nDim ESPath As String\n\nESPath = diaFolder2.SelectedItems(1)\n\nSet diaFolder2 = Nothing\n\n'Define contents pages\n\n\n'Define the survey long name for use in the footer\nDim File_Long_Name As String\n\nFile_Long_Name = wbSource.Worksheets(\"Cover (M)\").Range(\"K6\") 'added 10/8/15\n\n\n'Prompts the user for the path to the commentary files.\n\n\n'Iteration\n\n\n\n\n'Start_code = the row number of the first unit code\n'Dim i As Long\n\n'i = InputBox(\"What is the row  number of the first unit to be output?\") '7\n\nDim Start_code As Long\nStart_code = Application.InputBox(\"What's the first row to output?\", \"Enter the number of the row to start the output\", Type:=1)\n'Start_code = Sheets(\"Master\").Range(\"Start_Code\").Row\n\n\n'countend is the number of rows in the list \nDim CountEnd As Long\n\nCountEnd = WorksheetFunction.CountA(Sheets(\"Master\").Range(\"Unit_Codes\"))\n\n\n'Bespoke is the variable used for the maximum iteration\nDim ReportCount As Long\n\n'if the following procedure fails then VBA will prompt the user and return to the input box\nOn Error Resume Next\n\n'Inputbox allows user to specify the number of times to run the iteration.  the default value is Countend (the full list)\n ReportCount = Application.InputBox(\"How many units do you want to output?\", \"Enter the number of units to output\", CountEnd, Type:=1)\n\n\n'If the user keys in a value greater than the number of rows in the list it will override the input value and use Countend.\n\nIf ReportCount &gt; CountEnd Then ReportCount = CountEnd\n\n\n'set the number of times to perform the iteration\nDim Iterate As Long\n\n'will run from 1 to the number selected in the input box above.\n\nFor Iterate = 1 To ReportCount\n\n'go to Master\nSheets(\"Master\").Activate\n\n\n'set the range that holds the unit code\nDim CopyRange As String\n\nCopyRange = \"B\" &amp; Start_code 'Unit code is assumed to be in column B, using the row value for Start_Code\n\n'copy this to C3 on the same sheet (this will trigger the updating of charts and tables in the file\nRange(CopyRange).Copy Sheets(\"Master\").Range(\"B2\")\n\n'Colour the cell just copied green so we know it's been copied.\nRange(CopyRange).Select\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .Color = 5296274\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\n\n'Define the Unit code and name for use later on.\nDim Unit_Code As String\n\nUnit_Code = Worksheets(\"Master\").Range(\"B2\").Value\n\n\n'\n\nCalculate 'force calculation of the new values\n\n'========================================\n'New code to update Scatterplot chart axes\n'1 Activate sheet\n'2 Select chart\n'3 update chart references\n'4 repeat for next sheet\n'========================================\n\nWorksheets(\"XXX (M)\").Activate\n\nActiveSheet.ChartObjects(\"Chart_XXX_Scatter_Q3\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q3_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nWorksheets(\"YYY (M)\").Activate\n\nActiveSheet.ChartObjects(\"Chart_YYY_Scatter_Q4\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q4_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_YYY_Scatter_Q5\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q5_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_YYY_Scatter_Q6\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q6_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nWorksheets(\"ZZZ (M)\").Activate\n\nActiveSheet.ChartObjects(\"Chart_ZZZ_Scatter_Q7\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q7_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_ZZZ_Scatter_Q9\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q9_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_ZZZ_Scatter_Q10\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q10_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nWorksheets(\"AAA (M)\").Activate\n\nActiveSheet.ChartObjects(\"Chart_AAA_Scatter_Q11\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q11_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_AAA_Scatter_Q12\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q12_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_AAA_Scatter_Q13\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q13_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nWorksheets(\"BBB (M)\").Activate\n\nActiveSheet.ChartObjects(\"Chart_BBB_Scatter_Q14\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q14_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_BBB_Scatter_Q15\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q15_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_BBB_Scatter_Q16\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q16_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nWorksheets(\"CCC (M)\").Activate\n\nActiveSheet.ChartObjects(\"Chart_CCC_Scatter_Q18\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q18_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_CCC_Scatter_Q19\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q19_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nWorksheets(\"DDD (M)\").Activate\n\nActiveSheet.ChartObjects(\"Chart_DDD_Scatter_Q20\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q20_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_DDD_Scatter_Q22\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q22_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nWorksheets(\"EEE (M)\").Activate\n\nActiveSheet.ChartObjects(\"Chart_EEE_Scatter_Q24\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q24_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_EEE_Scatter_Q26\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q26_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_EEE_Scatter_Q28\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q28_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_EEE_Scatter_Q30\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q30_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\n\nWorksheets(\"FFF (M)\").Activate\n\nActiveSheet.ChartObjects(\"Chart_FFF_Scatter_Q31\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q31_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_FFF_Scatter_Q32\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q32_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_FFF_Scatter_Q33\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q33_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_FFF_Scatter_Q34\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q34_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_FFF_Scatter_Q35\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q35_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_FFF_Scatter_Q36\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q36_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_FFF_Scatter_Q37\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q37_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_FFF_Scatter_Q38\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q38_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_FFF_Scatter_Q39\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q39_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_FFF_Scatter_Q40\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q40_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nWorksheets(\"GGG (M)\").Activate\n\nActiveSheet.ChartObjects(\"Chart_GGG_Scatter_Q41\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q41_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nActiveSheet.ChartObjects(\"Chart_GGG_Scatter_Q42\").Activate\nActiveChart.Axes(xlValue).Select\nActiveChart.Axes(xlValue).MinimumScale = Range(\"Min_RAG_Variance\")\nActiveChart.Axes(xlValue).MaximumScale = Range(\"Max_Rag_Variance\")\nActiveChart.Axes(xlValue).CrossesAt = 0\nActiveChart.Axes(xlCategory).CrossesAt = Range(\"Q42_Average\")\nActiveChart.Axes(xlValue).TickLabelPosition = xlNextToAxis\n\nDim Unit_Name As String\nUnit_Name = Worksheets(\"Master\").Range(\"C2\").Value\n\nWorksheets(\"Master\").Activate\n\n\n'==============================\n'21/1/14 Update\n'Use boolean to select sheets based on Unit List for reports.\n\nCore = False\n\n\n\nFor Each sh In Worksheets\nIf UCase(Right(sh.Name, 3)) = \"(M)\" _\nOr UCase(Right(sh.Name, 3)) = \"(A)\" _\nThen 'open name selection\nIf Core Then 'if name selection note found then\nsh.Select (False)\nElse\nsh.Select (True)\nCore = True\nEnd If 'close not found option\nEnd If 'close name selection\nWith sh.PageSetup\n.LeftFooter = \"&amp;K02-024\" &amp; File_Long_Name &amp; Chr(10) &amp; Unit_Name\n.CenterFooter = \"\"\n.RightFooter = \"&amp;K02-024Page &amp;P of &amp;N\"\n.CenterHorizontally = True\n.DifferentFirstPageHeaderFooter = True\n    End With\nNext sh\n\n\n\n\n\n\n'define the sheets to be exported to PDF\nFor Each sh In Worksheets\nIf UCase(Right(sh.Name, 3)) = \"(M)\" _\nOr UCase(Right(sh.Name, 3)) = \"(A)\" _\nThen 'open name selection\nIf Core Then 'if name selection note found then\nsh.Select (False)\nElse\nsh.Select (True)\nCore = True\nEnd If 'close not found option\nEnd If 'close name selection\nNext sh\n'export the selected sheets to PDF\nActiveSheet.ExportAsFixedFormat _\n    Type:=xlTypePDF, _\n    Filename:=SavePath &amp; \"\\\" &amp; Unit_Code &amp; \" \" &amp; Unit_Name &amp; \" \" &amp; File_Short_Name &amp; \".pdf\", _\n    Quality:=xlQualityStandard, _\n    IncludeDocProperties:=True, _\n    IgnorePrintAreas:=False, _\n    OpenAfterPublish:=False\n\n\n'update the value for i by 1\nStart_code = Start_code + 1\n\n'update the value for the unit code so that it uses the new value for i\n\nCopyRange = \"B\" &amp; Start_code\n\n'repeat\nNext Iterate\n</code></pre>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1441803108, "creation_date": 1441803108, "answer_id": 32480048, "question_id": 32479082, "link": "https://stackoverflow.com/questions/32479082/vba-outlook-how-to-determine-the-last-item-of-folder/32480048#32480048", "title": "VBA Outlook: How to determine the last item of folder?", "body": "<p>See <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736(v=office.14).aspx\" rel=\"nofollow\">Getting Started with VBA in Outlook 2010</a>.</p>\n\n<p>You can use the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863914.aspx\" rel=\"nofollow\">Delete</a> method of the Folder class.</p>\n"}], "owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1441803108, "creation_date": 1441800201, "question_id": 32479082, "link": "https://stackoverflow.com/questions/32479082/vba-outlook-how-to-determine-the-last-item-of-folder", "title": "VBA Outlook: How to determine the last item of folder?", "body": "<p>How can I delete a search folder in Outlook using VBA?</p>\n\n<p>I found the code here that deletes the search folder: <a href=\"http://www.slipstick.com/developer/create-an-outlook-search-folder-using-vba/\" rel=\"nofollow\">http://www.slipstick.com/developer/create-an-outlook-search-folder-using-vba/</a></p>\n\n<p>Because I'm still noob in VBA, I can't understand some parts of the code.</p>\n\n<p>Is there another way to delete outlook search folder using VBA?</p>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441800109, "post_id": 32478782, "comment_id": 52818724, "body": "Why can you not use the query to build the report? It is often good to have a small form to supply all the parameters for a query or report."}, {"owner": {"reputation": 1068, "user_id": 5316882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3334dfb5e2c251108a538f2f49215cc5?s=128&d=identicon&r=PG&f=1", "display_name": "anotherfred", "link": "https://stackoverflow.com/users/5316882/anotherfred"}, "reply_to_user": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 0, "creation_date": 1441909800, "post_id": 32478782, "comment_id": 52877365, "body": "Thanks...I&#39;m trying!"}], "answers": [{"comments": [{"owner": {"reputation": 1068, "user_id": 5316882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3334dfb5e2c251108a538f2f49215cc5?s=128&d=identicon&r=PG&f=1", "display_name": "anotherfred", "link": "https://stackoverflow.com/users/5316882/anotherfred"}, "edited": false, "score": 0, "creation_date": 1441909888, "post_id": 32489485, "comment_id": 52877419, "body": "I&#39;ve been trying that...not quite working for me but at least it means I&#39;m on the right track. Thanks. I&#39;ll post any specific problems when I get them."}, {"owner": {"reputation": 88348, "user_id": 2548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adb9f3f81dc0b13a7339a10d0abedbfc?s=128&d=identicon&r=PG", "display_name": "Fionnuala", "link": "https://stackoverflow.com/users/2548/fionnuala"}, "edited": false, "score": 1, "creation_date": 1441922828, "post_id": 32489485, "comment_id": 52883743, "body": ".Text property is only available when the control has focus. Either do not use a property (best) or use value."}], "tags": [], "owner": {"reputation": 26, "user_id": 4612330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99db8803f164391286ad438530461983?s=128&d=identicon&r=PG", "display_name": "Derek Gee", "link": "https://stackoverflow.com/users/4612330/derek-gee"}, "is_accepted": true, "score": 1, "last_activity_date": 1441834254, "creation_date": 1441834254, "answer_id": 32489485, "question_id": 32478782, "link": "https://stackoverflow.com/questions/32478782/ms-access-2013-filter-report-from-multiple-tables-using-unbound-form/32489485#32489485", "title": "MS Access 2013 filter report from multiple tables, using unbound form", "body": "<p>In the criteria section (or the WHERE clause if you are using SQL) you would add the filter in this format:</p>\n\n<p><strong>=[Forms]![YourFormName]![YourUnboundField].[Text]</strong></p>\n\n<p>One other option is to use the Expression Builder and navigate to your form containing the unbound fields and select the expression value you want - in this example I chose [Text]. </p>\n\n<p>One thing to note, your form containing the fields will need to remain open when you run the report.</p>\n"}], "owner": {"reputation": 1068, "user_id": 5316882, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/3334dfb5e2c251108a538f2f49215cc5?s=128&d=identicon&r=PG&f=1", "display_name": "anotherfred", "link": "https://stackoverflow.com/users/5316882/anotherfred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 32489485, "answer_count": 1, "score": 0, "last_activity_date": 1441834254, "creation_date": 1441799339, "question_id": 32478782, "link": "https://stackoverflow.com/questions/32478782/ms-access-2013-filter-report-from-multiple-tables-using-unbound-form", "title": "MS Access 2013 filter report from multiple tables, using unbound form", "body": "<p>I have a database of students and exam results, with several tables.</p>\n\n<p>Users need to generate reports on a subset of students: only some years, dates, etc.</p>\n\n<p>I already have a pretty report of the whole joined database. I have a query that returns the right records based on parameters it asks for at run time. I have a 'start page' form with unbound fields for entering the parameters. None of these 3 are connected up to each other...</p>\n\n<p>This sounds basic and hopefully it is but I'm stuck... I'm OK with VBA, SQL or whatever anyone would like to suggest.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "ms-word", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 15405, "user_id": 2237785, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iXptK.png?s=128&g=1", "display_name": "Bond", "link": "https://stackoverflow.com/users/2237785/bond"}, "is_accepted": true, "score": 2, "last_activity_date": 1441801361, "creation_date": 1441801361, "answer_id": 32479472, "question_id": 32478761, "link": "https://stackoverflow.com/questions/32478761/select-from-4th-line-onwards-word-vba/32479472#32479472", "title": "Select from 4th line onwards Word VBA", "body": "<p>You can use the <code>GoTo()</code> function with the <code>wdGoToLine</code> value to set the insertion point to a specific line. From there, the <code>MoveEnd()</code> function can set the end of your selection to the end of your document.</p>\n\n<pre><code>' Set start to line 4...   \nSelection.GoTo What:=wdGoToLine, Which:=wdGoToAbsolute, Count:=4\n\n' Select up to end of document...\nSelection.MoveEnd Unit:=wdStory\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 3845582, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a958deb3889cb1f266ed4339e6fd6163?s=128&d=identicon&r=PG&f=1", "display_name": "user3845582", "link": "https://stackoverflow.com/users/3845582/user3845582"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 32479472, "answer_count": 1, "score": 2, "last_activity_date": 1441801437, "creation_date": 1441799282, "last_edit_date": 1441801437, "question_id": 32478761, "link": "https://stackoverflow.com/questions/32478761/select-from-4th-line-onwards-word-vba", "title": "Select from 4th line onwards Word VBA", "body": "<p>I am using the following code to copy text and images from Microsoft Word and paste to the body of an Outlook e-mail. I am trying to exclude the first 4 lines from being copied (this code is copying everything in the document). How can I go about doing this?</p>\n\n<pre><code>Sub CopycontentintoOutlook()\n\nDim oMailItem As Object\nDim oWordApp As Object\nDim oWordDoc As Object\nDim oMailWordDoc As Object\n\nSet oWordApp = CreateObject(\"Word.Application\")\nSet oWordDoc = ActiveDocument\n\noWordDoc.Content.Copy\n\nSet oMailApp = CreateObject(\"Outlook.Application\")\nSet oMailItem = oMailApp.CreateItem(0)\n\nWith oMailItem\n.To = \"email\"\n.Subject = \"This email contains Word-formatted text\"\n.Display\nEnd With\n\nSet oMailWordDoc = oMailApp.ActiveInspector.WordEditor\n\noMailWordDoc.Application.Selection.Paste\n\nEnd Sub\n</code></pre>\n\n<p>I am also wondering if it is possible to use the text in the first line and set this as the email subject?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441799019, "post_id": 32478160, "comment_id": 52817910, "body": "You can do it with event sinks but it&#39;s going to be hard to maintain. It would be much easier to have some sort of identifier on Sheet1 (and its copies) that Sheet2 can use to populate the relevant cells on any sheet with that identifier."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 4869070, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51c8b5ead6e5214c15e4600e3a171e03?s=128&d=identicon&r=PG&f=1", "display_name": "Kartiki ", "link": "https://stackoverflow.com/users/4869070/kartiki"}, "edited": false, "score": 0, "creation_date": 1441802548, "post_id": 32479672, "comment_id": 52820489, "body": "Actually I need to include the Sheet2 change event in Sheet1&#39;s module.. the only reason is that Sheet1 gets duplicated for different revisions and I need this Sheet2 change event getting copied every time Sheet1 is getting duplicated."}], "tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 0, "last_activity_date": 1441801973, "creation_date": 1441801973, "answer_id": 32479672, "question_id": 32478160, "link": "https://stackoverflow.com/questions/32478160/function-to-detect-another-worksheet-change-event-in-vba/32479672#32479672", "title": "Function to detect another worksheet change event in VBA", "body": "<p>Not exactly sure what you're after - maybe this is a step in the right direction:</p>\n\n<p>Add a class module called <strong>clsSheet2Events</strong>.  Add this code to the module:</p>\n\n<pre><code>Private WithEvents SheetEvent As Worksheet\nPrivate ThisSheet As Worksheet\n\nPublic Property Set Attach_SheetEvent(Value As Worksheet)\n    Set SheetEvent = Value\nEnd Property\nPublic Property Set Attach_ThisSheet(Value As Worksheet)\n    Set ThisSheet = Value\nEnd Property\n\nPrivate Sub SheetEvent_Change(ByVal Target As Range)\n\n    MsgBox Target.Address &amp; \" on \" &amp; Target.Parent.Name &amp; \" has changed.\" &amp; vbCr &amp; _\n        \"Updating value on \" &amp; ThisSheet.Name\n\n    ThisSheet.Cells(1, 1) = \"I've changed\"\n\nEnd Sub\n</code></pre>\n\n<p>In a normal module, or in the worksheet module enter this code:</p>\n\n<pre><code>Public Sub DetectSheetEvent()\n\n    Dim Sheet2Class As clsSheet2Events\n    Set Sheet2Class = New clsSheet2Events\n\n    Set Sheet2Class.Attach_SheetEvent = ThisWorkbook.Worksheets(\"Sheet2\")\n    Set Sheet2Class.Attach_ThisSheet = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    Sheet2.Cells(1, 1) = \"A\"\n\nEnd Sub\n</code></pre>\n\n<p>When you run the DetectSheetEvent code the class module will start monitoring the worksheet events on Sheet2 and update a value in Sheet1 if a change event occurs - which fires when A is entered to Sheet2 cell A1.</p>\n"}], "owner": {"reputation": 75, "user_id": 4869070, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/51c8b5ead6e5214c15e4600e3a171e03?s=128&d=identicon&r=PG&f=1", "display_name": "Kartiki ", "link": "https://stackoverflow.com/users/4869070/kartiki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 903, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441801973, "creation_date": 1441797575, "last_edit_date": 1531164843, "question_id": 32478160, "link": "https://stackoverflow.com/questions/32478160/function-to-detect-another-worksheet-change-event-in-vba", "title": "Function to detect another worksheet change event in VBA", "body": "<p>I need to write a function in lets say 'Sheet1', to detect a cell change on 'Sheet2' and update some values in Sheet1. \nI cannt use worksheet change event on Sheet2, cause Sheet1 gets duplicated and I need to carry this code while duplication. \nIs there a way I can write Worksheet_Change event in Sheet1 for Sheet2?</p>\n"}, {"tags": ["excel", "vba", "hyperlink", "formula"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 2, "creation_date": 1441799500, "post_id": 32478027, "comment_id": 52818280, "body": "I don&#39;t know if I understood it right. Will <code>ActiveSheet.Range(&quot;AD&quot; &amp; ActiveCell.Row).FormulaR1C1 = &quot;=HYPERLINK(&quot;&quot;S:\\Tasks\\&quot;&quot; &amp; RC[-27] &amp; &quot;&quot;\\log.txt&quot;&quot;,&quot;&quot;View Log&quot;&quot;)&quot;</code> do what you want?"}], "answers": [{"tags": [], "owner": {"reputation": 520, "user_id": 5289214, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-II2pZVRGeoI/AAAAAAAAAAI/AAAAAAAAJxs/B19uiSlUBc0/photo.jpg?sz=128", "display_name": "Justin McCartney", "link": "https://stackoverflow.com/users/5289214/justin-mccartney"}, "is_accepted": false, "score": 0, "last_activity_date": 1441804915, "creation_date": 1441804915, "answer_id": 32480753, "question_id": 32478027, "link": "https://stackoverflow.com/questions/32478027/excel-vba-insert-formula-with-dynamic-cell-reference-using-vba/32480753#32480753", "title": "excel vba: insert formula with dynamic cell reference using vba?", "body": "<p>Your code is taking the value from column C and building a string using that value that looks like this:</p>\n\n<p><code>\"S:\\Tasks\\FolderName\\log.txt\"</code></p>\n\n<p>Instead, what you want to do is build the following string: </p>\n\n<p><code>\"S:\\Tasks\\\" &amp; C2 &amp; \"\\log.txt\"</code></p>\n\n<p>To do that, use this VBA code: </p>\n\n<p><code>ActiveSheet.Range(\"AD\" &amp; ActiveCell.Row).Formula = \"=HYPERLINK(\"\"S:\\Tasks\\\"\" &amp; C\" &amp; ActiveCell.Row() &amp; \" &amp; \"\"\\log.txt\"\",\"\"View Log\"\")\"</code></p>\n"}], "owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1455, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441804915, "creation_date": 1441797185, "question_id": 32478027, "link": "https://stackoverflow.com/questions/32478027/excel-vba-insert-formula-with-dynamic-cell-reference-using-vba", "title": "excel vba: insert formula with dynamic cell reference using vba?", "body": "<p>I am inserting the following hyperlink as a formula using vba:</p>\n\n<pre><code>ActiveSheet.Range(\"AD\" &amp; ActiveCell.Row).Formula = \"=HYPERLINK(\"\"S:\\Tasks\\\" &amp; Range(\"C\" &amp; ActiveCell.Row).Value &amp; \"\\log.txt\"\",\"\"View Log\"\")\"\n</code></pre>\n\n<p>This works fine, however if my value in cell C was to change then my hyperlink becomes invalid and won't work because it has retained the value of the cell at the time in which the formula was entered.</p>\n\n<p>I need a way of making a dynamic reference to my cell C in the event that the value should change then my link will also change.</p>\n\n<p>Can someone please show me how to do this? Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441796845, "post_id": 32477862, "comment_id": 52816433, "body": "<a href=\"http://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-vba\">This</a> will get you started..."}, {"owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441797606, "post_id": 32477862, "comment_id": 52816951, "body": "The information on that sheet adds rows I need to use the value in the cells!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441799782, "post_id": 32477862, "comment_id": 52818485, "body": "You are finding the row number incorrectly. Ok, Lets start from the beginning. You have two sheets say &quot;Sheet1&quot; and &quot;RMA&quot;. Now explain what do you need to exactly do?"}, {"owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441800501, "post_id": 32477862, "comment_id": 52818995, "body": "I am trying to add the next number in a list in column A, in the RMA Sheet using a macro. So if there is a 2 in cell A5 when I start the macro I would like 3 to show in A6 then if I begin the macro again a 4 should show in A7. But the macro uses some information from Sheet 1 and the macro button is on sheet 1 too, thats why its a bit complicated!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441801140, "post_id": 32477862, "comment_id": 52819421, "body": "it is not complicated :) Let me post an answer.. quick question.. When you say <code>customeRef = Range(&quot;c&quot; &amp; (ActiveCell.Row))</code> Where are you picking this data from? <code>Sheet1</code> or <code>RMA</code>?"}, {"owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441801862, "post_id": 32477862, "comment_id": 52819949, "body": "Sheet1 has that information"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441801973, "post_id": 32477862, "comment_id": 52820036, "body": "One moment posting the solution"}, {"owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441810970, "post_id": 32477862, "comment_id": 52827045, "body": "The code worked very well!"}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1441802242, "creation_date": 1441802242, "answer_id": 32479763, "question_id": 32477862, "link": "https://stackoverflow.com/questions/32477862/add-1-to-the-cell-above-in-another-sheet/32479763#32479763", "title": "Add 1 to the cell above in another sheet", "body": "<p>What you need to do is fully qualify your object. Once you do that you will not get random values. Excel will know which sheet, which cell you are referring to. See this example</p>\n\n<pre><code>Sub update_Number()\n    Dim Sno As Long, LRow As Long, NewRow As Long\n    Dim wsO As Worksheet, wsI As Worksheet\n    Dim customeRef, customerName, customerCountry\n    Dim customerCompany, datePaid\n\n    Set wsO = ThisWorkbook.Sheets(\"RMA\")\n    Set wsI = ThisWorkbook.Sheets(\"Sheet1\")\n\n    '~~&gt; Get values from Sheet1\n    With wsI\n        customeRef = .Range(\"c\" &amp; (ActiveCell.Row))\n        customerName = .Range(\"d\" &amp; (ActiveCell.Row))\n        customerCountry = .Range(\"e\" &amp; (ActiveCell.Row))\n        customerCompany = .Range(\"f\" &amp; (ActiveCell.Row))\n        datePaid = .Range(\"g\" &amp; (ActiveCell.Row))\n    End With\n\n    '~~&gt; Work with RMA Sheet\n    With wsO\n        '~~&gt; Get the last Row\n        LRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n        '~~&gt; Increment the number\n        Sno = .Range(\"A\" &amp; LRow).Value + 1\n        '~~&gt; New row where we need to write\n        NewRow = LRow + 1\n\n        .Cells(NewRow, 1) = Sno\n        .Cells(NewRow, 2) = customeRef\n        .Cells(NewRow, 3) = customerName\n        .Cells(NewRow, 4) = customerCountry\n        .Cells(NewRow, 5) = customerCompany\n        .Cells(NewRow, 6) = datePaid\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 783, "user_id": 4442935, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9e5111226aee4bac41f5143e832665bc?s=128&d=identicon&r=PG&f=1", "display_name": "tbowden", "link": "https://stackoverflow.com/users/4442935/tbowden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 0, "accepted_answer_id": 32479763, "answer_count": 1, "score": 1, "last_activity_date": 1441802242, "creation_date": 1441796712, "question_id": 32477862, "link": "https://stackoverflow.com/questions/32477862/add-1-to-the-cell-above-in-another-sheet", "title": "Add 1 to the cell above in another sheet", "body": "<p>I am trying to run a macro that: Adds 1 to the cell above IN another sheet in the workbook and places it in the cell below. However the cell that it adds to is dynamic, the macro adds a new line for a new entry. Below is the code I have so far. <code>cellRef</code> should do the adding, but I am getting random figures and errors! (mismatch once and random figures other times)</p>\n\n<pre><code>Sub update_Number()\n\ncellRef = ActiveWorkbook.Sheets(\"RMA\").Range(\"A\" &amp; (ActiveCell.Row)).Offset(-1, 0).Value\n\nActiveWorkbook.ActiveSheet.Select\ncustomeRef = Range(\"c\" &amp; (ActiveCell.Row))\ncustomerName = Range(\"d\" &amp; (ActiveCell.Row))\ncustomerCountry = Range(\"e\" &amp; (ActiveCell.Row))\ncustomerCompany = Range(\"f\" &amp; (ActiveCell.Row))\ndatePaid = Range(\"g\" &amp; (ActiveCell.Row))\n\nDim wks As Worksheet\nSet wks = Sheets(\"RMA\")\n\nWith wks\n\nDim RowCount As Long\nRowCount = .Range(\"A8\").End(xlDown).Row + 1\n\n.Cells(RowCount, 1) = cellRef + 1\n.Cells(RowCount, 2) = customeRef\n.Cells(RowCount, 3) = customerName\n.Cells(RowCount, 4) = customerCountry\n.Cells(RowCount, 5) = customerCompany\n.Cells(RowCount, 6) = datePaid\n\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 3035986, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/94c0bc40d3274717509a5c228f304ab0?s=128&d=identicon&r=PG&f=1", "display_name": "Nindi", "link": "https://stackoverflow.com/users/3035986/nindi"}, "edited": false, "score": 0, "creation_date": 1441799219, "post_id": 32478625, "comment_id": 52818072, "body": "I tried altering the code, but it still outputs the formula which changes the number."}], "tags": [], "owner": {"reputation": 746, "user_id": 4733869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7f0b856d3215d1cbde059e0d411ab55?s=128&d=identicon&r=PG&f=1", "display_name": "Dawid", "link": "https://stackoverflow.com/users/4733869/dawid"}, "is_accepted": false, "score": 0, "last_activity_date": 1441801127, "last_edit_date": 1441801127, "creation_date": 1441798955, "answer_id": 32478625, "question_id": 32477665, "link": "https://stackoverflow.com/questions/32477665/count-and-remove-duplicates-leaving-number-of-duplicates-removed-plus-unique-va/32478625#32478625", "title": "Count and Remove Duplicates, leaving number of duplicates removed plus unique value (Function Key/Send Key/Calculate)", "body": "<p>You can try copy and paste values before remove duplicates:</p>\n\n<p>1 - in loop:</p>\n\n<p>change:</p>\n\n<pre><code>Application.SendKeys \"{F2}\", True\nApplication.SendKeys \"{F9}\", True\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>With ActiveCell\n.Copy\n.PasteSpecial xlPasteValues\nEnd With\n</code></pre>\n\n<p>2 - or after loop copy and paste all column:</p>\n\n<pre><code>Columns(\"C:C\").Select\nSelection.Copy\nSelection.PasteSpecial xlPasteValues\n</code></pre>\n\n<p>Its should work</p>\n\n<p>Edit:</p>\n\n<p>change your formula countif to:</p>\n\n<p><code>ActiveCell.FormulaR1C1 = \"=COUNTIFS(C1,RC1,C2,RC2)\"</code></p>\n\n<p>change parameters in <code>.RemoveDuplicates</code> to:</p>\n\n<p><code>Columns:=Array(1, 2), Header:=xlNo</code> (No header)</p>\n\n<p>now OK?</p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 3035986, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/94c0bc40d3274717509a5c228f304ab0?s=128&d=identicon&r=PG&f=1", "display_name": "Nindi", "link": "https://stackoverflow.com/users/3035986/nindi"}, "is_accepted": false, "score": 0, "last_activity_date": 1441800666, "creation_date": 1441800666, "answer_id": 32479225, "question_id": 32477665, "link": "https://stackoverflow.com/questions/32477665/count-and-remove-duplicates-leaving-number-of-duplicates-removed-plus-unique-va/32479225#32479225", "title": "Count and Remove Duplicates, leaving number of duplicates removed plus unique value (Function Key/Send Key/Calculate)", "body": "<p>Managed to figure it out.</p>\n\n<pre><code>Sub Marco()\nDim x As Integer\nDim sh As Worksheet\n'Used to remove unwanted characters from text within cells\nCells.Replace What:=\"'\", Replacement:=\"\", LookAt:=xlPart, SearchOrder:= _\n    xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\nCells.Replace What:=\",\", Replacement:=\"\", LookAt:=xlPart, SearchOrder:= _\n    xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n\n'Counts rows within column \"A\"\n  NumRows = Range(\"A1\", Range(\"A1\").End(xlDown)).Rows.Count\n\n'Selects Cell \"C1\" to process the proceeding loop\n  Range(\"C1\").Select\n\n  'A loop that carries out given functions for all cells with data.\n  For x = 1 To NumRows\n\n  'Creates a count if statement for all duplicate information\n    ActiveCell.FormulaR1C1 = \"=COUNTIF(C1,RC1)\"\n    ActiveCell.Select\n\n    'Moves down to next cell in column\n    ActiveCell.Offset(1, 0).Select\n  Next\n'Changes all forumlas to values\nFor Each sh In ActiveWorkbook.Worksheets\n    With sh.UsedRange\n        .Value = .Value\n    End With\nNext sh\n\n'Removes all duplicate values only leaving require information\nActiveSheet.Range(\"$A$1:$C$500\").RemoveDuplicates Columns:=Array(1, 2), Header _\n    :=xlYes\nRange(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>Parts added:</p>\n\n<pre><code>For Each sh In ActiveWorkbook.Worksheets\n    With sh.UsedRange\n        .Value = .Value\n    End With\nNext sh\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3035986, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/94c0bc40d3274717509a5c228f304ab0?s=128&d=identicon&r=PG&f=1", "display_name": "Nindi", "link": "https://stackoverflow.com/users/3035986/nindi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1313, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1441801127, "creation_date": 1441796192, "last_edit_date": 1441797138, "question_id": 32477665, "link": "https://stackoverflow.com/questions/32477665/count-and-remove-duplicates-leaving-number-of-duplicates-removed-plus-unique-va", "title": "Count and Remove Duplicates, leaving number of duplicates removed plus unique value (Function Key/Send Key/Calculate)", "body": "<p>ive been trying to figure this out for a few days now and it is now time to turn to the coding wizards :). I have tried to comment the code below as much as possible to make it clear the procedure i am trying to achieve, but i will try to explain. </p>\n\n<p>Essentially i have a document that will contain data in columns \"A\" and \"B\" which also correspond to each other, for example in column A i could have \"Fiesta\" and in column B \"Ford\", all down the columns would be this type of information where multiple duplicates can occur. i want to number the numerical value of the duplicates in column \"C\" and to remove the duplicates, leaving me with the unique entries and the number of duplicates plus the one remaining.</p>\n\n<p>I have looked in lots of places for different methods on how to do this and below i have inserted the code which i created and is almost working perfectly. However im having issues with extracting the value out of the formula before removing the duplicates because obviously the value will change with the countif statement after i have removed the duplicate values.</p>\n\n<p>Example of Spreadsheet:</p>\n\n<p>(\"A\" and \"B\" should be other way around)</p>\n\n<p>Initial Entry- <a href=\"https://gyazo.com/2813c54391564af6346132e1d27f32a5\" rel=\"nofollow\">https://gyazo.com/2813c54391564af6346132e1d27f32a5</a><br>\nDesired Output -<a href=\"https://gyazo.com/9933e4f5e5278e15d038ff7df55617ec\" rel=\"nofollow\">https://gyazo.com/9933e4f5e5278e15d038ff7df55617ec</a></p>\n\n<pre><code>Sub Marco()\nDim x As Integer\n'Used to remove unwanted characters from text within cells\nCells.Replace What:=\"'\", Replacement:=\"\", LookAt:=xlPart, SearchOrder:= _\n    xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\nCells.Replace What:=\",\", Replacement:=\"\", LookAt:=xlPart, SearchOrder:= _\n    xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n\n'Counts rows within column \"A\"\n  NumRows = Range(\"A1\", Range(\"A1\").End(xlDown)).Rows.Count\n\n'Selects Cell \"C1\" to process the proceeding loop\n  Range(\"C1\").Select\n\n  'A loop that carries out given functions for all cells with data.\n  For x = 1 To NumRows\n\n  'Creates a count if statement for all duplicate information\n    ActiveCell.FormulaR1C1 = \"=COUNTIF(C1,RC1)\"\n    ActiveCell.Select\n\n    'Change the forumla for countif to the value\n    Application.SendKeys \"{F2}\", True\n    Application.SendKeys \"{F9}\", True\n\n    'Moves down to next cell in column\n    ActiveCell.Offset(1, 0).Select\n  Next\n'Removes all duplicate values only leaving require information\nActiveSheet.Range(\"$A$1:$C$500\").RemoveDuplicates Columns:=Array(1, 2), Header _\n    :=xlYes\n\nEnd Sub\n</code></pre>\n\n<p>If you require anymore information just comment below :). Thank you in advance!!</p>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "comments": [{"owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1441798602, "post_id": 32477565, "comment_id": 52817613, "body": "Why not simply <code>.Save</code> the <code>MailMessages</code> as draft?"}, {"owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "reply_to_user": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "edited": false, "score": 0, "creation_date": 1441814842, "post_id": 32477565, "comment_id": 52829761, "body": "That wouldn&#39;t be useful because it would be quicker if the emails went into the outbox so that all that needs doing to send them is to turn the working offline mode off"}], "answers": [{"tags": [], "owner": {"reputation": 971, "user_id": 3177855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/909e8e34e0ec4b66788e190c7bf1e4f3?s=128&d=identicon&r=PG&f=1", "display_name": "DanL", "link": "https://stackoverflow.com/users/3177855/danl"}, "is_accepted": false, "score": 0, "last_activity_date": 1441799758, "creation_date": 1441799758, "answer_id": 32478931, "question_id": 32477565, "link": "https://stackoverflow.com/questions/32477565/vba-how-to-test-if-outlook-is-working-offline-and-if-not-then-put-it-in-offlin/32478931#32478931", "title": "VBA: How to test if Outlook is Working Offline, and if not then put it in Offline Mode", "body": "<p>To check for offline-mode on an Exchange connected Outlook client, you can check the <code>ExchangeConnectionMode</code> property of the <code>Session</code> object.</p>\n\n<p>For example, you can do the following:</p>\n\n<pre><code>Dim oNS As NameSpace\nSet oNS = Application.Session\n\nIf oNS.ExchangeConnectionMode = olCachedOffline Or _\n   oNS.ExchangeConnectionMode = olOffline Then\n   ... Work, work! ...\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 789, "user_id": 4596273, "user_type": "registered", "accept_rate": 59, "profile_image": "https://graph.facebook.com/816411745073346/picture?type=large", "display_name": "Ben Smith", "link": "https://stackoverflow.com/users/4596273/ben-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1101, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441799758, "creation_date": 1441795914, "question_id": 32477565, "link": "https://stackoverflow.com/questions/32477565/vba-how-to-test-if-outlook-is-working-offline-and-if-not-then-put-it-in-offlin", "title": "VBA: How to test if Outlook is Working Offline, and if not then put it in Offline Mode", "body": "<p>Before emails are sent out using VBA in Excel I place Outlook in offline mode so that the emails do not sent and I can check them.</p>\n\n<p>The problem with this is that I would have to make sure Outlook is in offline mode every time.</p>\n\n<p>I have found the following code to put Outlook in offline mode:</p>\n\n<pre><code>Outlook.ActiveExplorer().CommandBars.FindControl(, 5613).Execute\n</code></pre>\n\n<p>But the problem with this is that if Outlook in Offline mode it will take it out of Offline mode, so what I want is to test whether Outlook is in Offline mode, and if not run the code.</p>\n\n<p>Is there a way of doing this?</p>\n"}, {"tags": ["object", "ms-access", "vba", "return-type"], "answers": [{"tags": [], "owner": {"reputation": 954, "user_id": 3898606, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85f8b8ea74a1d7fde222a1863b571b71?s=128&d=identicon&r=PG&f=1", "display_name": "oracle certified professional", "link": "https://stackoverflow.com/users/3898606/oracle-certified-professional"}, "is_accepted": false, "score": 0, "last_activity_date": 1441796437, "creation_date": 1441796437, "answer_id": 32477759, "question_id": 32477296, "link": "https://stackoverflow.com/questions/32477296/function-returning-an-object-throws-error/32477759#32477759", "title": "Function returning an object throws error", "body": "<p>I think you just need to add a <code>Set</code> statement to your event handler:</p>\n\n<pre><code>Private Sub Button_Click()\n    Dim sqlController As New clsSQLController\n    Dim person As clsPerson\n\n    Set person = sqlController.GetPerson(1)\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 4063792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/70cc100b88b160305f23da45e462efc7?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/4063792/nils"}, "is_accepted": true, "score": 0, "last_activity_date": 1441801263, "last_edit_date": 1441801263, "creation_date": 1441800769, "answer_id": 32479271, "question_id": 32477296, "link": "https://stackoverflow.com/questions/32477296/function-returning-an-object-throws-error/32479271#32479271", "title": "Function returning an object throws error", "body": "<p>Okay so I got the answer by myself. It is not that hard if you know it, I guess.</p>\n\n<p>With <code>Public Function GetPerson(personID As Integer) As clsPerson</code> you seem to only declare the function type as clsPerson, but the function has no instance of <code>clsPerson</code>.\nSo you need to create an instance inside the function, like this:</p>\n\n<pre><code>Public Function GetPerson(personID As Integer) As clsPerson\n\n    Set GetPerson = New clsPerson '&lt;- This line is the important part\n\n    'All the other code\n\n    Set GetPerson = person\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 67, "user_id": 4063792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/70cc100b88b160305f23da45e462efc7?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/4063792/nils"}, "edited": false, "score": 0, "creation_date": 1441801418, "post_id": 32479405, "comment_id": 52819633, "body": "This is VBA, not VB.net. I found the answer myself, see this <a href=\"http://stackoverflow.com/questions/32477296/function-returning-an-object-throws-error/32479271#32479271\">answer</a>."}], "tags": [], "owner": {"reputation": 145, "user_id": 5020414, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xzf9L.png?s=128&g=1", "display_name": "KMan", "link": "https://stackoverflow.com/users/5020414/kman"}, "is_accepted": false, "score": 0, "last_activity_date": 1441801158, "creation_date": 1441801158, "answer_id": 32479405, "question_id": 32477296, "link": "https://stackoverflow.com/questions/32477296/function-returning-an-object-throws-error/32479405#32479405", "title": "Function returning an object throws error", "body": "<p>Use</p>\n\n<p>'Return person' instead of 'Set GetPerson = person'</p>\n"}], "owner": {"reputation": 67, "user_id": 4063792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/70cc100b88b160305f23da45e462efc7?s=128&d=identicon&r=PG&f=1", "display_name": "Nils", "link": "https://stackoverflow.com/users/4063792/nils"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 32479271, "answer_count": 3, "score": 0, "last_activity_date": 1594643694, "creation_date": 1441795089, "last_edit_date": 1594643694, "question_id": 32477296, "link": "https://stackoverflow.com/questions/32477296/function-returning-an-object-throws-error", "title": "Function returning an object throws error", "body": "<p>I have a function that should return an object of a class. The function looks like this:</p>\n\n<pre><code>Public Function GetPerson(personID As Integer) As clsPerson\n    Dim sqlAdapter As New clsSQLAdapter\n    Dim person As New clsPerson\n    Dim recordset As recordset\n\n    query = \"SELECT ID, Anrede_ID, Nachname, Vorname FROM Person WHERE Person.ID = \" &amp; personID\n\n    Set recordset = sqlAdapter.recordset(query)\n    person.personID = recordset.Fields(0).Value\n    If (recordset.Fields(1).Value = kAnrede.FRAU) Then\n        Set person.anrede = kAnrede.FRAU\n    ElseIf (recordset.Fields(1).Value = kAnrede.HERR) Then\n        Set person.anrede = kAnrede.HERR\n    End If\n    person.nachName = recordset.Fields(2).Value\n    person.vorName = recordset.Fields(3).Value\n    Set GetPerson = person\nEnd Function\n</code></pre>\n\n<p>But when I call the the function from another module, I get an error 91 at the line</p>\n\n<pre><code>person = sqlController.GetPerson(1)\n</code></pre>\n\n<p>stating: \"Object variable or with block variable not set\":</p>\n\n<pre><code>Private Sub Button_Click()\n    Dim sqlController As New clsSQLController\n    Dim person As New clsPerson\n\n    person = sqlController.GetPerson(1)\n\nEnd Sub\n</code></pre>\n\n<p>Also when I debug the programm, it tells me that the Type of <em>sqlController.GetPerson(1)</em> is Integer.\nIs it even possible to do this, or did I miss something?</p>\n"}, {"tags": ["c#", "excel", "excel-interop", "vba"], "comments": [{"owner": {"reputation": 422, "user_id": 2216106, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZEajV.jpg?s=128&g=1", "display_name": "Sean", "link": "https://stackoverflow.com/users/2216106/sean"}, "edited": false, "score": 0, "creation_date": 1441794858, "post_id": 32477138, "comment_id": 52815106, "body": "Do you have other instances of Excel open?"}, {"owner": {"reputation": 2709, "user_id": 4579015, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/56bbb7da70756a6470a57e2ee5ca341f?s=128&d=identicon&r=PG&f=1", "display_name": "LocEngineer", "link": "https://stackoverflow.com/users/4579015/locengineer"}, "edited": false, "score": 0, "creation_date": 1441795652, "post_id": 32477138, "comment_id": 52815650, "body": "1) What is your macro security setting in Excel? 2) Saving in C.\\ directly is always a bad idea. 3) Please add tags C# and/or Interop tags."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441797007, "post_id": 32477138, "comment_id": 52816533, "body": "Debug the code and check what is the value of <code>macro</code> in <code>excelApplication.Run(macro, Type.Missing...</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1441799132, "post_id": 32477138, "comment_id": 52818000, "body": "Unless your workbook name contains no spaces, you need to enclose it in single quotes when you build the macro name string for <code>Run</code> to use."}, {"owner": {"reputation": 489, "user_id": 3548593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b8b7726370bd04ea525703e37204bca2?s=128&d=identicon&r=PG&f=1", "display_name": "user3548593", "link": "https://stackoverflow.com/users/3548593/user3548593"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441801078, "post_id": 32477138, "comment_id": 52819379, "body": "@Rory yes exact , you&#39;re awesome ."}], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1441798688, "creation_date": 1441798688, "answer_id": 32478527, "question_id": 32477138, "link": "https://stackoverflow.com/questions/32477138/can-not-run-the-macro-xx-may-not-be-available-in-this-workbook-or-all-macros-ar/32478527#32478527", "title": "Can not run the macro xx. may not be available in this workbook or all macros are disabled", "body": "<p>I just modified your code little bit and it works just fine</p>\n\n<pre><code>using System;\nusing System.Collections.Generic;\nusing System.ComponentModel;\nusing System.Data;\nusing System.Drawing;\nusing System.Linq;\nusing System.Text;\nusing System.Threading.Tasks;\nusing System.Windows.Forms;\nusing Excel = Microsoft.Office.Interop.Excel;\nusing VBIDE = Microsoft.Vbe.Interop;\n\nnamespace WindowsFormsApplication3\n{\n    public partial class Form1 : Form\n    {\n        public Form1()\n        {\n            InitializeComponent();\n        }\n\n        private void button1_Click(object sender, EventArgs e)\n        {\n            Excel.Application xlexcel;\n            Excel.Workbook xlWorkBook;\n            VBIDE.VBComponent newStandardModule;\n            VBIDE.CodeModule codeModule;\n\n            object misValue = System.Reflection.Missing.Value;\n\n            const string excelFile = @\"C:\\Users\\Siddharth\\Desktop\\Sid.xlsm\";\n\n            xlexcel = new Excel.Application();\n            xlexcel.Visible = true;\n\n            // Open a File\n            xlWorkBook = xlexcel.Workbooks.Open(excelFile, misValue, \n                         misValue, misValue, misValue, misValue, misValue,\n                         misValue, misValue, misValue, misValue, misValue, \n                         misValue, misValue, misValue);\n\n            newStandardModule = xlWorkBook.VBProject.VBComponents.Add(\n                                VBIDE.vbext_ComponentType.vbext_ct_StdModule);\n\n            codeModule = newStandardModule.CodeModule;\n\n            // add vba code to module\n            var lineNum = codeModule.CountOfLines + 1;\n\n            var macroName = \"test\";\n\n            var codeText = \"Sub \" + macroName + \"()\" + \"\\r\\n\";\n            codeText +=    \"    Dim xsheet As Worksheet\" + \"\\r\\n\";\n            codeText +=    \"    For Each xsheet In ThisWorkbook.Worksheets\" + \"\\r\\n\";\n            codeText +=    \"        xsheet.UsedRange.Value = xsheet.UsedRange.Value\" + \"\\r\\n\";\n            codeText +=    \"    Next xsheet\" + \"\\r\\n\";\n            codeText +=    \"End Sub\";\n\n            codeModule.InsertLines(lineNum, codeText);\n            xlWorkBook.Save();\n\n            // run the macro\n            var macro = string.Format(\"{0}!{1}.{2}\", xlWorkBook.Name, newStandardModule.Name, macroName);\n            xlexcel.Run(macro,misValue, misValue, misValue,misValue, misValue, misValue,\n            misValue, misValue, misValue, misValue, misValue, misValue,   misValue, misValue, misValue,\n            misValue, misValue, misValue, misValue, misValue, misValue,  misValue, misValue, misValue,\n            misValue, misValue, misValue, misValue, misValue, misValue);\n            xlexcel.Quit();\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 3548593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b8b7726370bd04ea525703e37204bca2?s=128&d=identicon&r=PG&f=1", "display_name": "user3548593", "link": "https://stackoverflow.com/users/3548593/user3548593"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1157, "favorite_count": 0, "accepted_answer_id": 32478527, "answer_count": 1, "score": 0, "last_activity_date": 1441938145, "creation_date": 1441794602, "last_edit_date": 1531161705, "question_id": 32477138, "link": "https://stackoverflow.com/questions/32477138/can-not-run-the-macro-xx-may-not-be-available-in-this-workbook-or-all-macros-ar", "title": "Can not run the macro xx. may not be available in this workbook or all macros are disabled", "body": "<p>I am trying to execute the following code </p>\n\n<pre><code>const string excelFile = @\"C:\\test.xls\";\n\n                var excelApplication = new ExcelInterop.Application { Visible = true };\n                var targetExcelFile = excelApplication.Workbooks.Open(excelFile,\nType.Missing, Type.Missing, Type.Missing, Type.Missing,\nType.Missing, Type.Missing, Type.Missing, Type.Missing,\nType.Missing, Type.Missing, Type.Missing, Type.Missing,\nType.Missing, Type.Missing);\n                var newStandardModule = targetExcelFile.VBProject.VBComponents.Add(vbext_ComponentType.vbext_ct_StdModule);\n                var codeModule = newStandardModule.CodeModule;\n\n                // add vba code to module\n                var lineNum = codeModule.CountOfLines + 1;\n                var macroName = \"test\";\n                var codeText = \" Sub \" + macroName + \"()\" + \"\\r\\n\";\n                codeText += \" Dim xsheet As Worksheet\" + \"\\r\\n\";\n                codeText += \"For Each xsheet In ThisWorkbook.Worksheets\" + \"\\r\\n\";\n                codeText += \" xsheet.Select\" + \"\\r\\n\";\n                codeText += \"With xsheet.UsedRange\" + \"\\r\\n\";\n                codeText += \"    .Value = .Value\" + \"\\r\\n\";\n                codeText += \"  End With\" + \"\\r\\n\";\n                codeText += \"Next xsheet    \" + \"\\r\\n\";\n                codeText += \"End Sub\";\n\n                codeModule.InsertLines(lineNum, codeText);\n                targetExcelFile.Save();\n\n                // run the macro\n                var macro = string.Format(\"{0}!{1}.{2}\", targetExcelFile.Name, newStandardModule.Name, macroName);\n                excelApplication.Run(macro,\nType.Missing, Type.Missing, Type.Missing,  \nType.Missing, Type.Missing, Type.Missing, \nType.Missing, Type.Missing, Type.Missing,  \nType.Missing, Type.Missing, Type.Missing, \nType.Missing, Type.Missing, Type.Missing,  \nType.Missing, Type.Missing, Type.Missing, \nType.Missing, Type.Missing, Type.Missing,  \nType.Missing, Type.Missing, Type.Missing, \nType.Missing, Type.Missing, Type.Missing,  \nType.Missing, Type.Missing, Type.Missing\n);\n                excelApplication.Quit();\n</code></pre>\n\n<p>I always got the following error </p>\n\n<blockquote>\n  <p>\"Can not run the macro xx. may not be available in this workbook or all\n  macros are disabled.\"</p>\n</blockquote>\n\n<p>How to resolve the error? Any suggestions ?</p>\n"}, {"tags": ["image", "vba", "hide", "show"], "comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1441794100, "post_id": 32476883, "comment_id": 52814634, "body": "try &#39;.visible = False&#39;"}], "answers": [{"tags": [], "owner": {"reputation": 1124, "user_id": 5315239, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Q5f7T.jpg?s=128&g=1", "display_name": "Gabriel Rodriguez", "link": "https://stackoverflow.com/users/5315239/gabriel-rodriguez"}, "is_accepted": false, "score": 2, "last_activity_date": 1441794997, "creation_date": 1441794997, "answer_id": 32477267, "question_id": 32476883, "link": "https://stackoverflow.com/questions/32476883/show-and-hide-img-using-vba/32477267#32477267", "title": "Show and Hide img using vba", "body": "<p>Just check if is already visible or not and do the oppsite:</p>\n\n<pre><code>Sub showhide()\n With ActiveSheet.Shapes(\"Picture 1\") \n  If .Visible = False Then\n    .Visible = True\n  Else\n    .Visible = False        \n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 4737518, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a103b051b000eae18aee5d80e73860c8?s=128&d=identicon&r=PG&f=1", "display_name": "Gino", "link": "https://stackoverflow.com/users/4737518/gino"}, "is_accepted": false, "score": 0, "last_activity_date": 1441795770, "creation_date": 1441795770, "answer_id": 32477515, "question_id": 32476883, "link": "https://stackoverflow.com/questions/32476883/show-and-hide-img-using-vba/32477515#32477515", "title": "Show and Hide img using vba", "body": "<p>I'd rather have a foreach statement where you can loop trough your imgs and set them as you please</p>\n\n<pre><code>Set shapeList = ActiveSheet.Shapes\n        For Each shp In shapeList\n            If shp.Visible = true Then\n                shp.Visible=false\n           else\n                shp.Visible=false\n            End If\n        Next shp\n</code></pre>\n\n<p>Of course you have to launch your event on each page with a button or something.\nOr even when the page loads set the img to this function</p>\n"}], "owner": {"reputation": 1, "user_id": 5316573, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BAz1d.jpg?s=128&g=1", "display_name": "akaCAV", "link": "https://stackoverflow.com/users/5316573/akacav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1884, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1441798655, "creation_date": 1441793853, "last_edit_date": 1441798655, "question_id": 32476883, "link": "https://stackoverflow.com/questions/32476883/show-and-hide-img-using-vba", "title": "Show and Hide img using vba", "body": "<p>I have to show or hide an image on different sheets. Can anyone help me?</p>\n\n<p>Here is my vba code:</p>\n\n<pre><code>Sub showhide()\n    With ActiveSheet.Shapes(\"Picture 1\")\n    .Visible = Not .Visible\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1441794035, "post_id": 32476790, "comment_id": 52814587, "body": "What error are you getting?"}, {"owner": {"reputation": 11, "user_id": 2161062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b499093c89bb2e365f13f376b4d9c62d?s=128&d=identicon&r=PG", "display_name": "udz", "link": "https://stackoverflow.com/users/2161062/udz"}, "reply_to_user": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1441794425, "post_id": 32476790, "comment_id": 52814824, "body": "result value isn&#39;t captured properly."}, {"owner": {"reputation": 11, "user_id": 2161062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b499093c89bb2e365f13f376b4d9c62d?s=128&d=identicon&r=PG", "display_name": "udz", "link": "https://stackoverflow.com/users/2161062/udz"}, "reply_to_user": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1441794485, "post_id": 32476790, "comment_id": 52814855, "body": "If you have an alternate way of solving the problem you can post it as well."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1441795147, "post_id": 32476790, "comment_id": 52815293, "body": "<code>Application.WorksheetFunction.VLookup</code>? I also think it would not have an error as output, it would halt into an error. IMO you&#39;re better off testing for the range by yourself. In this case you can also make a <code>LCase</code>/<code>UCase</code> transition beforehand and use wildcards(<code>*</code>,<code>?</code>,<code>[A-Z]</code>) extensively."}, {"owner": {"reputation": 11, "user_id": 2161062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b499093c89bb2e365f13f376b4d9c62d?s=128&d=identicon&r=PG", "display_name": "udz", "link": "https://stackoverflow.com/users/2161062/udz"}, "edited": false, "score": 0, "creation_date": 1441796708, "post_id": 32476790, "comment_id": 52816325, "body": "The data in two sheets are just an example. But in reality I have tons of data in each sheet (probably about 30k-40k each day) That&#39;s why I think VLookup would be best option to use. The surnames in sheet 2 remains same though."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1441795845, "creation_date": 1441795845, "answer_id": 32477539, "question_id": 32476790, "link": "https://stackoverflow.com/questions/32476790/vba-excel-vlookup/32477539#32477539", "title": "VBA Excel VLookup", "body": "<p>The most efficient lookup for a partial match would likely be through the worksheet's own <a href=\"https://support.office.com/en-us/article/match-function-0600e189-9f3c-4e4f-98c1-943a0eb427ca\" rel=\"nofollow\">MATCH function</a> with wildcards.</p>\n\n<pre><code>Sub del_surname()\n    Dim rw As Long, ws1 As Worksheet\n\n    Set ws1 = Worksheets(\"Sheet1\")\n\n    With Worksheets(\"Sheet2\")\n        For rw = 2 To .Cells(Rows.Count, 1).End(xlUp).Row\n            If Not IsError(Application.Match(Chr(42) &amp; .Cells(rw, 1) &amp; Chr(42), ws1.Columns(1), 0)) Then\n                ws1.Rows(Application.Match(Chr(42) &amp; .Cells(rw, 1) &amp; Chr(42), ws1.Columns(1), 0)).EntireRow.Delete\n            End If\n        Next rw\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The match function will retrieve the row number where the wildcarded lookup finds its target. If the <em>surname</em> was always the last word in the string(s) then <code>Chr(42) &amp; .Cells(rw, 1) &amp; Chr(42)</code> could be altered to <code>Chr(42) &amp; .Cells(rw, 1)</code>.</p>\n\n<p>If more than a single potential match is a possibility, either a repeating loop or an alternate method with the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff839746.aspx\" rel=\"nofollow\">Range.Find method</a> and <a href=\"https://msdn.microsoft.com/en-us/library/office/ff196143.aspx\" rel=\"nofollow\">Range.FindNext method</a> would be necessary.</p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 2161062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b499093c89bb2e365f13f376b4d9c62d?s=128&d=identicon&r=PG", "display_name": "udz", "link": "https://stackoverflow.com/users/2161062/udz"}, "edited": false, "score": 0, "creation_date": 1441798882, "post_id": 32477674, "comment_id": 52817810, "body": "This is great.. but using vlookup would be more efficient since there are lots of surnames (reused every time) and about 30k-40k lines of record every day."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 11, "user_id": 2161062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b499093c89bb2e365f13f376b4d9c62d?s=128&d=identicon&r=PG", "display_name": "udz", "link": "https://stackoverflow.com/users/2161062/udz"}, "edited": false, "score": 0, "creation_date": 1441800254, "post_id": 32477674, "comment_id": 52818831, "body": "Then I&#39;d read them into a string array (<code>sirnamesarray</code>) and not check against cells. Your code checks each name as many times as many first- middle- and last names each person has which is really inefficient."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 11, "user_id": 2161062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b499093c89bb2e365f13f376b4d9c62d?s=128&d=identicon&r=PG", "display_name": "udz", "link": "https://stackoverflow.com/users/2161062/udz"}, "edited": false, "score": 0, "creation_date": 1441800564, "post_id": 32477674, "comment_id": 52819042, "body": "By the way, your proposed edit would delete all the lines that should stay and popup a messagebox when there&#39;s no match found (should delete)."}, {"owner": {"reputation": 11, "user_id": 2161062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b499093c89bb2e365f13f376b4d9c62d?s=128&d=identicon&r=PG", "display_name": "udz", "link": "https://stackoverflow.com/users/2161062/udz"}, "edited": false, "score": 1, "creation_date": 1441816088, "post_id": 32477674, "comment_id": 52830606, "body": "Yes I realized that when I ran the code. I did undo of the edit. Thanks!"}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": true, "score": 0, "last_activity_date": 1441819543, "last_edit_date": 1441819543, "creation_date": 1441796219, "answer_id": 32477674, "question_id": 32476790, "link": "https://stackoverflow.com/questions/32476790/vba-excel-vlookup/32477674#32477674", "title": "VBA Excel VLookup", "body": "<pre><code>Sub vlookupcode()\n'Find last row with data in Column A\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n'the range to which you want to compare\nDim comparerng As Range\n    Set comparerng = Sheet2.Range(\"A2:A6\")\n'the boolean that stores whether there were occurences\nDim result As Boolean\n\n'Start at bottom and delete rows with no matching values in the other set\nFor myNA = lastrow To 1 Step -1\n\n  tmp = Cells(myNA, 1).Value\n  'there are no occurrences until found\n  result = True\n\n    For Each cell In comparerng.Cells\n        If LCase(tmp) Like \"*\" &amp; LCase(cell.Value2) &amp; \"*\" Then result = False 'if there's a match then set the boolean to false\n    Next cell\n\n    'if there was no value found then delete\n    If result Then\n        ert = MsgBox(\"Do you want to delete \" &amp; tmp &amp; \"?\", vbOKCancel) 'if you prompt then why not ask for feedback?\n        If ert = vbOK Then Cells(myNA, 1).EntireRow.Delete\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 2161062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b499093c89bb2e365f13f376b4d9c62d?s=128&d=identicon&r=PG", "display_name": "udz", "link": "https://stackoverflow.com/users/2161062/udz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 32477674, "answer_count": 2, "score": 0, "last_activity_date": 1441951913, "creation_date": 1441793598, "last_edit_date": 1441951913, "question_id": 32476790, "link": "https://stackoverflow.com/questions/32476790/vba-excel-vlookup", "title": "VBA Excel VLookup", "body": "<p>I have a first worksheet with the following set of values</p>\n\n<pre>Column A\n**Sender Name**\nSAAD MAJID S R AL SAAD\nIBRAHIM BIN SABTU ATAU ZULKIFLEE BIN ABDUL RAHMAN\nPUSPA LAL JONES\nRENJA BAHADUR NEPAL\nRENJA BAHADUR RANGER\nRENJA BAHADUR HAMAL\nPARSHU RAM KARKI\n</pre>\n\n<p>A second worksheet has the below values</p>\n\n<pre>\nColumn A\n**Sir Names**\nJones\nRanger\nBrown\nHamal\nKarki\n</pre>\n\n<p>I want to use VLookup in VBA to find and delete the lines of data in the first worksheet if the surnames mentioned in second sheet appear as a part of the full name.</p>\n\n<p>Essentially it'll leave following records.</p>\n\n<pre>\nSAAD MAJID S R AL SAAD\nIBRAHIM BIN SABTU ATAU ZULKIFLEE BIN ABDUL RAHMAN\nRENJA BAHADUR NEPAL </pre>\n\n<p>I've written following code in VBA but I am getting an error. </p>\n\n<pre><code>Dim NameArray() As String\nDim result\n\nSub vlookupcode()\n'Find last row with data in Column A\nlastrow = Range(\"A\" &amp; Rows.Count).End(xlUp).row\n'Start at bottom and delete rows with errors\nFor myNA = lastrow To 1 Step -1\n    'If IsError(Cells(myNA, 1)) Then\n\n  tmp = Cells(myNA, 1).Value\n  'MsgBox tmp\n  NameArray() = Split(tmp, \" \")\n  For i = LBound(NameArray) To UBound(NameArray)\n\n    'MsgBox i &amp; \" \" &amp; NameArray(i)\n\n    result = Application.VLookup(NameArray(i), Sheet2.Range(\"A2:A6\"), 1, False)\n\n    If IsError(result) Then\n        MsgBox \"Error\"\n        Cells(myNA, 1).EntireRow.Delete\n    End If\n  Next\n\n Next\nEnd Sub\n</code></pre>\n\n<p>Could you please help me solve this.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "is_accepted": false, "score": 0, "last_activity_date": 1441803221, "last_edit_date": 1441803221, "creation_date": 1441801306, "answer_id": 32479451, "question_id": 32476786, "link": "https://stackoverflow.com/questions/32476786/add-new-row-when-cell-value-changes/32479451#32479451", "title": "Add new row when cell value changes", "body": "<p>I'm not exactly sure how you want to add your rows. It looks as if you want to test the changed cell and if it doesn't match the cell above add a row. I guess it's also possible that you want to add one row per unmatching cell pair in your columns. You'll see both in the code below - take your pick.</p>\n\n<p>I put this code in the Sheet_Change event but you could put it in a module and call it from this event if you wished. You'll see I've disabled events, this could be the problem with your code.</p>\n\n<p>This routine doesn't test if someone pasted values (ie Target.Cells.Count > 1). You might want to handle the possibility of Target being multiple cells.</p>\n\n<pre><code>For Each item in Target.Cells\n    ..//..\nNext\n</code></pre>\n\n<p>could work for you.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim MyColumns As Range\n\n    ' Define the value columns we're interested in\n    If MyColumns Is Nothing Then\n        Set MyColumns = Union(Columns(\"C\"), _\n                              Columns(\"D\"), _\n                              Columns(\"G\"))\n    End If\n\n    ' If you just want to add one row for a non-matching change in one of the three columns changes\n    If Not Intersect(Target, MyColumns) Is Nothing Then\n        If Target.Row &gt; 1 Then\n            If Target.Offset(-1).Value &lt;&gt; Target.Value Then\n                Application.EnableEvents = False\n                Target.Offset(1).EntireRow.Insert\n                Application.EnableEvents = True\n            End If\n        End If\n    End If\n\n    ' If you want to add one row for each non-matching cell value in the three columns\n    Dim cell As Range\n\n    If Not Intersect(Target, MyColumns) Is Nothing Then\n        If Target.Row &gt; 1 Then\n            For Each cell In Intersect(MyColumns, Target.EntireRow).Cells\n                If cell.Offset(-1).Value &lt;&gt; cell.Value Then\n                    Application.EnableEvents = False\n                    cell.Offset(1).EntireRow.Insert\n                    Application.EnableEvents = True\n                End If\n            Next\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 4046856, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/65e93bfd4d2697a5eefaa2d0f66ffbea?s=128&d=identicon&r=PG&f=1", "display_name": "A Anderson", "link": "https://stackoverflow.com/users/4046856/a-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 746, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441820800, "creation_date": 1441793590, "last_edit_date": 1441820800, "question_id": 32476786, "link": "https://stackoverflow.com/questions/32476786/add-new-row-when-cell-value-changes", "title": "Add new row when cell value changes", "body": "<p>I need to add a new row whenever a cell values changes in a defined column. I then need it to do the same for another column, then another column after that. </p>\n\n<p>I used the same code three times, with different columns referenced, but I think it is not working due to the new (blank) rows entered from the first run. I've written it as three separate <code>Subs</code>.</p>\n\n<pre><code>Sub LineTestCODE()\n\nDim lRow As Long\nFor lRow = Cells(Cells.Rows.Count, \"C\").End(xlUp).Row To 2 Step -1\n    If Cells(lRow, \"C\") &lt;&gt; Cells(lRow - 1, \"C\") Then Rows(lRow).EntireRow.Insert\nNext lRow    \n\nEnd Sub\n\n\nSub LineTestENHANCEMENT()\n\nDim lRow2 As Long\nFor lRow2 = Cells(Cells.Rows.Count, \"D\").End(xlUp).Row To 2 Step -1\n    If Cells(lRow2, \"D\") &lt;&gt; Cells(lRow2 - 1, \"D\") Then Rows(lRow2).EntireRow.Insert\nNext lRow2\n\nEnd Sub\n\n\nSub LineTestZONE()\n\nDim lRow3 As Long\nFor lRow3 = Cells(Cells.Rows.Count, \"G\").End(xlUp).Row To 2 Step -1\n    If Cells(lRow3, \"G\") &lt;&gt; Cells(lRow3 - 1, \"G\") Then Rows(lRow3).EntireRow.Insert\nNext lRow3   \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["matlab", "vba", "excel", "com"], "comments": [{"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "reply_to_user": {"reputation": 32443, "user_id": 1485872, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/9XWSA.png?s=128&g=1", "display_name": "Ander Biguri", "link": "https://stackoverflow.com/users/1485872/ander-biguri"}, "edited": false, "score": 0, "creation_date": 1441793360, "post_id": 32476474, "comment_id": 52814134, "body": "Just edited the question"}], "answers": [{"comments": [{"owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "edited": false, "score": 0, "creation_date": 1441799521, "post_id": 32478210, "comment_id": 52818294, "body": "Absolutely perfect, thank you so much. Worked like a charm"}], "tags": [], "owner": {"reputation": 11146, "user_id": 3460361, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O31Mu.png?s=128&g=1", "display_name": "Hoki", "link": "https://stackoverflow.com/users/3460361/hoki"}, "is_accepted": true, "score": 5, "last_activity_date": 1441799168, "last_edit_date": 1441799168, "creation_date": 1441797716, "answer_id": 32478210, "question_id": 32476474, "link": "https://stackoverflow.com/questions/32476474/export-excel-chart-as-picture-through-automation/32478210#32478210", "title": "Export excel chart as picture (through automation)", "body": "\n\n<p>The excel <code>Chart</code> objects have an <code>Export</code> method.</p>\n\n<p>Microsoft documentation : <a href=\"https://msdn.microsoft.com/en-us/library/office/ff198129.aspx\" rel=\"nofollow\">Chart.Export Method (Excel)</a></p>\n\n<hr>\n\n<p>For the example, I created a simple excel file (named <code>test_save_chart.xlsx</code>) with a chart in the first sheet. To export this chart as a <code>PNG</code> picture is pretty straightforward:</p>\n\n<pre class=\"lang-matlab prettyprint-override\"><code>xfile = 'test_save_chart.xlsx' ;\nexl = actxserver('excel.application');                  %// Create a COM server\nexlFile    = exl.Workbooks.Open( [pwd '\\' xfile] );     %'// Open the file\n\nchartobj = exlFile.Sheets.Item('Sheet1').ChartObjects(1) ;                %// get a handle to the chart object\nchartobj.Chart.Export('C:\\TEMP\\StackExchange\\testChartExport.png','PNG')  %// export to PNG\n</code></pre>\n\n<hr>\n\n<p>In your case, inside your loop, it is as simple as:</p>\n\n<pre class=\"lang-matlab prettyprint-override\"><code>chartobj = Activesheet.ChartObjects(j) ;\nchartobj.Chart.Export('your_filename_here.png','PNG')\n</code></pre>\n\n<hr>\n\n<p>Since you are doing that in a loop, you will have to generate the file name dynamically (otherwise you are going to overwrite the same file over and over again).</p>\n\n<p>Note that <code>png</code> format is recommended over <code>jpg</code>, specially for \"line art\" style of picture like excel chart produce.</p>\n"}], "owner": {"reputation": 277, "user_id": 4845418, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/ceb266d1e9d130d899117344c25c330d?s=128&d=identicon&r=PG&f=1", "display_name": "Lererferler", "link": "https://stackoverflow.com/users/4845418/lererferler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1001, "favorite_count": 0, "accepted_answer_id": 32478210, "answer_count": 1, "score": 3, "last_activity_date": 1441799168, "creation_date": 1441792682, "last_edit_date": 1441798160, "question_id": 32476474, "link": "https://stackoverflow.com/questions/32476474/export-excel-chart-as-picture-through-automation", "title": "Export excel chart as picture (through automation)", "body": "<p>I am trying to get a handle on an excel graph and save it through MATLAB. </p>\n\n<p>So far I have managed to cycle through sheets and get a handle on the graph object but I can't save it.<br>\nDoes anyone know how to export the object as a <code>jpg</code> or <code>png</code> or other graphic format?</p>\n\n<p>I tried the code below using the <code>SaveAs</code> method but it doesn't work</p>\n\n<pre><code>Workbook = Workbooks.Open(['file.name]);\nSheets = Workbook.Sheets;\nfor i = 1:Sheets.Count\n    Activesheet = get(Sheets, 'Item',i);\n    for j = 1:Activesheet.ChartObjects.Count\n        obj = Activesheet.ChartObjects(j);\n        obj.SaveAs('asfasfa.jpg')\n\n    end\nend\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441793770, "post_id": 32476426, "comment_id": 52814393, "body": "Outside of your sub declare <code>intX</code> as this: <code>Public intX as Integer</code> see <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264241.aspx\" rel=\"nofollow noreferrer\">Declaring Variables</a> for more information"}, {"owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441794006, "post_id": 32476426, "comment_id": 52814562, "body": "@DragonSamu thanks for this suggestion however when I try this it gives me the number 0 in my message box instead of the cell value which should be &#39;test&#39;"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441794112, "post_id": 32476426, "comment_id": 52814643, "body": "That is logical as its an Integer.  If you want a String declare your variable as a String"}, {"owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "reply_to_user": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441794209, "post_id": 32476426, "comment_id": 52814701, "body": "@DragonSamu ok thanks I tried labelling it as a string instead and now it is blank"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441796740, "post_id": 32476426, "comment_id": 52816350, "body": "What is your specific reason to use <code>Intersect</code>? Your issue is (besides the <code>String</code> problem) that in your <code>SelectionChange event</code> <code>Target</code> will <code>Match</code> if the <code>ActiveCell</code> is in <code>Column M</code>. But your <code>Change event</code> will never <code>Match</code> because the <code>Target</code> is always the <code>Cell</code> you were in."}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1442073583, "post_id": 32476426, "comment_id": 52938762, "body": "Was the below answer useful?"}], "answers": [{"tags": [], "owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "is_accepted": false, "score": 0, "last_activity_date": 1441799163, "creation_date": 1441799163, "answer_id": 32478716, "question_id": 32476426, "link": "https://stackoverflow.com/questions/32476426/get-value-of-cell-on-click-and-store-as-variable-in-worksheet-selectionchange-su/32478716#32478716", "title": "Get value of cell on click and store as variable in worksheet_selectionChange sub and then pass variable to worksheet_Change sub?", "body": "<p>Your problem is you are trying to pass a <code>String</code> but declared it as an <code>Integer</code>.</p>\n\n<p>And in your <code>SelectionChange event</code> <code>Target</code> will <code>Match</code> if the <code>ActiveCell</code> is in <code>Column M</code>. But your <code>Change event</code> will never <code>Match</code> because the <code>Target</code> is always the <code>Cell</code> you were in.</p>\n\n<p>To solve this you need to check wether the <code>Target</code> is within the <code>Range(\"M:M\")</code></p>\n\n<p>see code below:</p>\n\n<pre><code>If Not Intersect(Target, Range(\"M:M\")) Is Nothing And _\nRange(\"M\" &amp; ActiveCell.Row).Value &lt;&gt; \"Please Select...\" And _\nRange(\"AD\" &amp; ActiveCell.Row).Value = \"View Log\" Then\n</code></pre>\n"}], "owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 857, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441799236, "creation_date": 1441792511, "last_edit_date": 1441799236, "question_id": 32476426, "link": "https://stackoverflow.com/questions/32476426/get-value-of-cell-on-click-and-store-as-variable-in-worksheet-selectionchange-su", "title": "Get value of cell on click and store as variable in worksheet_selectionChange sub and then pass variable to worksheet_Change sub?", "body": "<p>I am trying to store a cell value as a variable when the user clicks on the cell as part of a function for a worksheet_selectionChange  event. Like so:</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If Not Intersect(Target, Range(\"M\" &amp; ActiveCell.Row)) Is Nothing Then\n\n    Dim intX As Integer\n       intX = Range(\"M\" &amp; ActiveCell.Row).Value\n\n    End If\n\n    End Sub\n</code></pre>\n\n<p>I then want to be able to retrieve this variable in my worksheet change event and display it in a message box when the user changes a value in my dropdown box.</p>\n\n<p>Please can someone show me how I would do this?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Not Intersect(Target, Range(\"M\" &amp; ActiveCell.Row)) Is Nothing And Range(\"M\" &amp; ActiveCell.Row).Value &lt;&gt; \"Please Select...\" And Range(\"AD\" &amp; ActiveCell.Row).Value = \"View Log\" Then\n\n\nMsgBox intX \n\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441799260, "post_id": 32475628, "comment_id": 52818100, "body": "You can&#39;t do that with a pivot table."}, {"owner": {"reputation": 41, "user_id": 5309292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b85f8aab4911589d8ff3ccc12a757?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Oldman", "link": "https://stackoverflow.com/users/5309292/eugene-oldman"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441799653, "post_id": 32475628, "comment_id": 52818398, "body": "@Rory, thank you. Do you know may be Power-Pivot can do that?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441799899, "post_id": 32475628, "comment_id": 52818560, "body": "Not with functions written in VBA, but you can use DAX to create measures or calculated columns."}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 5309292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b85f8aab4911589d8ff3ccc12a757?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Oldman", "link": "https://stackoverflow.com/users/5309292/eugene-oldman"}, "is_accepted": true, "score": 2, "last_activity_date": 1442845202, "creation_date": 1442845202, "answer_id": 32697609, "question_id": 32475628, "link": "https://stackoverflow.com/questions/32475628/using-custom-function-vba-in-custom-field-of-pivot-table/32697609#32697609", "title": "Using custom function VBA in custom field of pivot-table", "body": "<p>Pivot-Table don't work with custom functions, only with default.</p>\n"}], "owner": {"reputation": 41, "user_id": 5309292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b52b85f8aab4911589d8ff3ccc12a757?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Oldman", "link": "https://stackoverflow.com/users/5309292/eugene-oldman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "accepted_answer_id": 32697609, "answer_count": 1, "score": 1, "last_activity_date": 1442845202, "creation_date": 1441790205, "last_edit_date": 1531161705, "question_id": 32475628, "link": "https://stackoverflow.com/questions/32475628/using-custom-function-vba-in-custom-field-of-pivot-table", "title": "Using custom function VBA in custom field of pivot-table", "body": "<p>When I try to use custom function (written on VBA), in custom field of pivot table excel give me an error: \"Element not found.\"</p>\n\n<p>Function code:</p>\n\n<pre><code>Function testfunc(keks)\n   testfunc = keks * 2\nEnd Function\n</code></pre>\n\n<p>On the worksheets this little function work fine.</p>\n"}, {"tags": ["excel", "vba", "createfile"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1441799306, "post_id": 32474904, "comment_id": 52818132, "body": "You mean the 60-odd Excel Tag points I lost recently on my route to a gold badge? Sure."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 0, "creation_date": 1441799879, "post_id": 32474904, "comment_id": 52818546, "body": "Sorry but I&#39;m just not smart enough to find a room by that moniker."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1441788233, "creation_date": 1441788233, "answer_id": 32474904, "question_id": 32474451, "link": "https://stackoverflow.com/questions/32474451/vba-check-if-directory-exists-if-exists-exit-sub-else-if-does-not-exist-create/32474904#32474904", "title": "vba check if directory exists, if exists exit sub else if does not exist, create", "body": "<p>The <code>MkDir</code> command is only going to create a single new level of subdirectory.</p>\n\n<pre><code>Sub directory()\n    Dim rw As Long, f As String\n\n    rw = ActiveCell.Row\n    f = \"s:\\Tasks\"\n    If Not CBool(Len(Dir(f, vbDirectory))) Then\n        MkDir Path:=f\n        Debug.Print \"made \" &amp; f\n    End If\n    f = f &amp; Chr(92) &amp; Range(\"C\" &amp; rw).Value\n    If Not CBool(Len(Dir(f, vbDirectory))) Then\n        MkDir Path:=f\n        Debug.Print \"made \" &amp; f\n    End If\n    f = f &amp; Chr(92) &amp; Range(\"M\" &amp; rw).Value\n    If Not CBool(Len(Dir(f, vbDirectory))) Then\n        MkDir Path:=f\n        Debug.Print \"made \" &amp; f\n    End If\n    f = f &amp; Chr(92) &amp; Range(\"Z\" &amp; rw).Value\n    If Not CBool(Len(Dir(f, vbDirectory))) Then\n        MkDir Path:=f\n        Debug.Print \"made \" &amp; f\n    Else\n        Debug.Print \"it was already there\"\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 2, "last_activity_date": 1441788324, "creation_date": 1441788324, "answer_id": 32474935, "question_id": 32474451, "link": "https://stackoverflow.com/questions/32474451/vba-check-if-directory-exists-if-exists-exit-sub-else-if-does-not-exist-create/32474935#32474935", "title": "vba check if directory exists, if exists exit sub else if does not exist, create", "body": "<p>I wrote some time ago this little thing that I keep in my library:  </p>\n\n<pre><code>Function CreateFolder(ByVal sPath As String) As Boolean\n'by Patrick Honorez - www.idevlop.com\n'create full sPath at once, if required\n'returns False if folder does not exist and could NOT be created, True otherwise\n'sample usage: If CreateFolder(\"C:\\toto\\test\\test\") Then debug.print \"OK\"\n'updated 20130422 to handle UNC paths correctly (\"\\\\MyServer\\MyShare\\MyFolder\")\n\n    Dim fs As Object \n    Dim FolderArray\n    Dim Folder As String, i As Integer, sShare As String\n\n    If Right(sPath, 1) = \"\\\" Then sPath = Left(sPath, Len(sPath) - 1)\n    Set fs = CreateObject(\"Scripting.FileSystemObject\")\n    'UNC path ? change 3 \"\\\" into 3 \"@\"\n    If sPath Like \"\\\\*\\*\" Then\n        sPath = Replace(sPath, \"\\\", \"@\", 1, 3)\n    End If\n    'now split\n    FolderArray = Split(sPath, \"\\\")\n    'then set back the @ into \\ in item 0 of array\n    FolderArray(0) = Replace(FolderArray(0), \"@\", \"\\\", 1, 3)\n    On Error GoTo hell\n    'start from root to end, creating what needs to be\n    For i = 0 To UBound(FolderArray) Step 1\n        Folder = Folder &amp; FolderArray(i) &amp; \"\\\"\n        If Not fs.FolderExists(Folder) Then\n            fs.CreateFolder (Folder)\n        End If\n    Next\n    CreateFolder = True\nhell:\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1441789231, "post_id": 32475048, "comment_id": 52811250, "body": "Impressively short and efficient! But does not seem to word with UNC paths, so I&#39;m not deleting my little function yet."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1441789362, "post_id": 32475048, "comment_id": 52811344, "body": "@iDevlop It doesn&#39;t handle Unicode paths either. Documentation suggests you use <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb762131%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">SHCreateDirectoryEx</a> for Unicode paths, I assume it can handle UNC too, but documentation says it might be removed."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": false, "score": 2, "last_activity_date": 1441788654, "creation_date": 1441788654, "answer_id": 32475048, "question_id": 32474451, "link": "https://stackoverflow.com/questions/32474451/vba-check-if-directory-exists-if-exists-exit-sub-else-if-does-not-exist-create/32475048#32475048", "title": "vba check if directory exists, if exists exit sub else if does not exist, create", "body": "<pre><code>Private Declare Function MakeSureDirectoryPathExists Lib \"imagehlp.dll\" (ByVal DirPath As String) As Long\n</code></pre>\n\n\n\n<pre><code>MakeSureDirectoryPathExists \"S:\\Tasks\\\" &amp; Range(\"C\" &amp; ActiveCell.Row).Value &amp; \"\\\" &amp; Range(\"M\" &amp; ActiveCell.Row).Value &amp; \"\\\" &amp; Range(\"Z\" &amp; ActiveCell.Row).Value\n</code></pre>\n"}], "owner": {"reputation": 505, "user_id": 4983280, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/1cdfa48482a093d4c9855b274aa98dc3?s=128&d=identicon&r=PG&f=1", "display_name": "Mark harris", "link": "https://stackoverflow.com/users/4983280/mark-harris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1733, "favorite_count": 0, "accepted_answer_id": 32474935, "answer_count": 3, "score": 0, "last_activity_date": 1441788654, "creation_date": 1441786819, "question_id": 32474451, "link": "https://stackoverflow.com/questions/32474451/vba-check-if-directory-exists-if-exists-exit-sub-else-if-does-not-exist-create", "title": "vba check if directory exists, if exists exit sub else if does not exist, create", "body": "<p>Ok so I have the following vba code which I am using to check if a directory exists and if not create the folder structure like so:</p>\n\n<pre><code>If Dir(\"S:\\Tasks\\\" &amp; Range(\"C\" &amp; ActiveCell.Row).Value &amp; \"\\\" &amp; Range(\"M\" &amp; ActiveCell.Row).Value &amp; \"\\\" &amp; Range(\"Z\" &amp; ActiveCell.Row).Value, vbDirectory) = \"\" Then\n    MkDir Path:=\"S:\\Tasks\\\" &amp; Range(\"C\" &amp; ActiveCell.Row).Value &amp; \"\\\" &amp; Range(\"M\" &amp; ActiveCell.Row).Value &amp; \"\\\" &amp; Range(\"Z\" &amp; ActiveCell.Row).Value\n    MsgBox \"Done\"\nElse\n    MsgBox \"found it\"\nEnd If\n</code></pre>\n\n<p>So my destination path is my <code>S:\\</code> drive </p>\n\n<p>then depending on the value in cell c I want it to check if that folder exists, so if cell c had the word 'tender' in it then the directory would look like:</p>\n\n<pre><code>'S:\\Tender'\n</code></pre>\n\n<p>If this does not exist, then create, else if this exists then move on and create another folder within this folder with the value in cell M like so:</p>\n\n<pre><code>Cell M = Telecoms\n\n'S:\\Tender\\Telecoms'\n</code></pre>\n\n<p>Then finally, check if a folder with the value in cell Z exists within 'S:\\Tender\\Telecoms' and if not create it.</p>\n\n<pre><code>Cell Z = 12345\n</code></pre>\n\n<p>so we would end up with:</p>\n\n<pre><code>'S:\\Tender\\Telecoms\\12345\\'\n</code></pre>\n\n<p>Fore some reason I keep getting the error message path not found. Please can someone show me where I am going wrong? Thanks in advance</p>\n"}, {"tags": ["excel", "comments", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441785245, "post_id": 32473884, "comment_id": 52808765, "body": "What does the sizing properties of the code look like when you record the action?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1441785711, "post_id": 32473884, "comment_id": 52809040, "body": "The <code>Shape.TextFrame</code>  doesn&#39;t have the property <code>.Size</code>. If you record a macro like @Jeeped mentioned, you will come to know how the size can be set using <code>ScaleWidth</code> and <code>ScaleHeight</code>"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1441786047, "post_id": 32473884, "comment_id": 52809240, "body": "While you are at it, I would be tempted to changed teh comment boxes to another sort of shape  as I&#39;ve found comments seem to randomly resize and move themselves (I think when freeze panes is used - but I&#39;ve never got to the bottom of it)."}, {"owner": {"reputation": 11, "user_id": 5315993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85c2c03030d5ff7874a061434e4bc5e8?s=128&d=identicon&r=PG&f=1", "display_name": "David Osborne", "link": "https://stackoverflow.com/users/5315993/david-osborne"}, "edited": false, "score": 0, "creation_date": 1441791542, "post_id": 32473884, "comment_id": 52812859, "body": "I&#39;m pretty fresh at this, I&#39;m not overly familiar with Marcos. I shall experiment shortly. - Was hopping it would be a simple language/code change to the above. Thanks"}, {"owner": {"reputation": 11, "user_id": 5315993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85c2c03030d5ff7874a061434e4bc5e8?s=128&d=identicon&r=PG&f=1", "display_name": "David Osborne", "link": "https://stackoverflow.com/users/5315993/david-osborne"}, "edited": false, "score": 0, "creation_date": 1441794055, "post_id": 32473884, "comment_id": 52814600, "body": "Here&#39;s a macro recording of me changing a cell comment size.  &#39;     Range(&quot;L9&quot;).Select     Range(&quot;L9&quot;).Comment.Text Text:=&quot;&quot;     With Selection.Font         .Name = &quot;Calibri&quot;         .FontStyle = &quot;Regular&quot;         .Size = 11         .Strikethrough = False         .Superscript = False         .Subscript = False         .OutlineFont = False         .Shadow = False         .Underline = xlUnderlineStyleNone         .ThemeColor = xlThemeColorLight1         .TintAndShade = 0         .ThemeFont = xlThemeFontNone     End With End Sub"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5315993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85c2c03030d5ff7874a061434e4bc5e8?s=128&d=identicon&r=PG&f=1", "display_name": "David Osborne", "link": "https://stackoverflow.com/users/5315993/david-osborne"}, "is_accepted": false, "score": 0, "last_activity_date": 1441799282, "last_edit_date": 1441799282, "creation_date": 1441795601, "answer_id": 32477445, "question_id": 32473884, "link": "https://stackoverflow.com/questions/32473884/resize-multiple-comments-to-fixed-size/32477445#32477445", "title": "Resize multiple comments to fixed size", "body": "<pre><code>Sub SizeComments()\n    Dim cmt As Comment\n\n    For Each cmt In ActiveSheet.Comments\n        With cmt.Shape\n            .ScaleWidth 2, msoFalse, msoScaleFromTopLeft\n            .ScaleHeight 2, msoFalse, msoScaleFromTopLeft\n        End With\n    Next cmt\nEnd Sub\n</code></pre>\n\n<p>I found and ran this code, this seems to double the current size of all comments I have, which works quite well for the time being, but I'm unable to set them to a specific size annoyingly and with the random distortion to the sizes the ratio will get warped.</p>\n"}], "owner": {"reputation": 11, "user_id": 5315993, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85c2c03030d5ff7874a061434e4bc5e8?s=128&d=identicon&r=PG&f=1", "display_name": "David Osborne", "link": "https://stackoverflow.com/users/5315993/david-osborne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1441799282, "creation_date": 1441785063, "last_edit_date": 1531161705, "question_id": 32473884, "link": "https://stackoverflow.com/questions/32473884/resize-multiple-comments-to-fixed-size", "title": "Resize multiple comments to fixed size", "body": "<p>I've created a excel sheet to replicate a desk plan of an office, using comment display boxes <code>filled with picture</code> to display mugshots on mouse-overs.</p>\n\n<p>I painstakingly sized them to <code>4.5cm x 4cm</code> via format object. But since some minor alterations the sizing had changed.</p>\n\n<p>I found that using VBA people have done a mass size change for a 'Autofit', thought I could tailor it to a fixed size to save me time.</p>\n\n<p>This is what I have, <code>*4.5cm x 4cm*</code> being the area in question, unless it's all in need of change, help?</p>\n\n<pre><code>Sub FitComments()\n    Dim xComment As Comment\n    For Each xComment In Application.ActiveSheet.Comments\n        xComment.Shape.TextFrame.Size = * 4.5cm x 4cm *\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1441783680, "post_id": 32473237, "comment_id": 52807813, "body": "you can&#39;t select ranges on different spreadsheets at a same time"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2140173"}, "edited": false, "score": 0, "creation_date": 1441784158, "post_id": 32473237, "comment_id": 52808103, "body": "although if you are trying to select the same Range on multiple sheets you may wanna give this a try ; <code>Sheets(Array(&quot;Sheet1&quot;, &quot;Sheet2&quot;, &quot;Sheet3&quot;)).Select</code> and then <code>Range(&quot;A1:D30&quot;).Select</code>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 5306075, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0050fc89d3c58454d68bb00ea1bf274b?s=128&d=identicon&r=PG&f=1", "display_name": "Xcel", "link": "https://stackoverflow.com/users/5306075/xcel"}, "edited": false, "score": 0, "creation_date": 1441786343, "post_id": 32473531, "comment_id": 52809428, "body": "This is simply amazing! Thanks. ;)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1441784092, "creation_date": 1441784092, "answer_id": 32473531, "question_id": 32473237, "link": "https://stackoverflow.com/questions/32473237/select-range-in-all-worksheets/32473531#32473531", "title": "Select range in all worksheets", "body": "<p>While I usually try and deter the use of <code>.Select</code> as a method of accomplishing a goal, in this case the operation may be expedient (although the particulars of the actual operation are lacking).</p>\n\n<pre><code>Sub sel_all()\n    Dim w As Long, vWSs As Variant\n\n    ReDim vWSs(0 To Worksheets.Count - 1)\n    For w = 1 To Worksheets.Count\n        vWSs(w - 1) = Worksheets(w).Name\n    Next w\n\n    Worksheets(vWSs).Select\n    Worksheets(vWSs(LBound(vWSs))).Activate\n    Range(\"A1:D30\").Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5306075, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0050fc89d3c58454d68bb00ea1bf274b?s=128&d=identicon&r=PG&f=1", "display_name": "Xcel", "link": "https://stackoverflow.com/users/5306075/xcel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1441784650, "creation_date": 1441783185, "last_edit_date": 1531161705, "question_id": 32473237, "link": "https://stackoverflow.com/questions/32473237/select-range-in-all-worksheets", "title": "Select range in all worksheets", "body": "<p>I would like to select <code>Range(\"A1:D30\")</code> in all the worksheets. Yet the code below does not work.</p>\n\n<pre><code>Sub selectRange()\n    Dim ws As Worksheet\n\n    For Each ws In Sheets\n        ws.Range(\"A1:D30\").Select\n    Next ws      \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "edited": false, "score": 0, "creation_date": 1441783744, "post_id": 32472789, "comment_id": 52807854, "body": "@Axel Kemper. Thanks. But what kind of variable is colItems? Is it an integer or an Outlook.item?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441783858, "post_id": 32472789, "comment_id": 52807924, "body": "++ However you do not need <code>GetFirst</code>"}, {"owner": {"reputation": 7889, "user_id": 1911064, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/F8Vxe.jpg?s=128&g=1", "display_name": "Axel Kemper", "link": "https://stackoverflow.com/users/1911064/axel-kemper"}, "edited": false, "score": 0, "creation_date": 1441784943, "post_id": 32472789, "comment_id": 52808569, "body": "GetFirst returns &quot;nothing&quot;, if the collection is empty. Item(1) would throw an &quot;index out of bounds&quot; error in this case. Basically, a matter of taste. And I usually do not remember if Items are indexed zero-based or one-based."}], "tags": [], "owner": {"reputation": 7889, "user_id": 1911064, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/F8Vxe.jpg?s=128&g=1", "display_name": "Axel Kemper", "link": "https://stackoverflow.com/users/1911064/axel-kemper"}, "is_accepted": false, "score": 5, "last_activity_date": 1441781794, "creation_date": 1441781794, "answer_id": 32472789, "question_id": 32472392, "link": "https://stackoverflow.com/questions/32472392/get-the-latest-date-of-email-in-a-folder/32472789#32472789", "title": "Get the latest date of email in a folder", "body": "<p>You can sort the <code>Items</code> collection in descending order:</p>\n\n<pre><code>Set colItems = objFolder.Items\ncolItems.Sort \"ReceivedTime\", True\n</code></pre>\n\n<p>Retrieve the first item using the <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff861538.aspx\" rel=\"noreferrer\">GetFirst</a> method. The date of this item is the latest date in the folder.</p>\n\n<p>Add some error checking for empty folders and items of unexpected types.</p>\n"}, {"comments": [{"owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "edited": false, "score": 0, "creation_date": 1441784631, "post_id": 32473429, "comment_id": 52808383, "body": "Thanks @Siddhart Rout. But its getting the email with the oldest date. Where do I put  the myItems.Sort &quot;ReceivedTime&quot;? Is it before the For Each statement where it loops thru every email or inside the For Each statement?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "edited": false, "score": 0, "creation_date": 1441784689, "post_id": 32473429, "comment_id": 52808421, "body": "You don&#39;t use a For Loop :) <code>1</code> Are you sure you have set the correct folder &quot;Set objFolder = objNS.GetDefaultFolder(olFolderInbox)&quot;"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "edited": false, "score": 0, "creation_date": 1441784743, "post_id": 32473429, "comment_id": 52808452, "body": "Copy my code as it is and paste it in Outlook. Change folder as required and then run the code"}, {"owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "edited": false, "score": 0, "creation_date": 1441784883, "post_id": 32473429, "comment_id": 52808528, "body": "Yup. I used For Each because I have to loop thru each mails and open the latest mail."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "edited": false, "score": 0, "creation_date": 1441784975, "post_id": 32473429, "comment_id": 52808588, "body": "But that is what I am trying to tell you.. you do not need to loop. As far as opening that email is concerned you can work with <code>myItem</code>"}, {"owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "edited": false, "score": 0, "creation_date": 1441785951, "post_id": 32473429, "comment_id": 52809174, "body": "Yes @Siddharth Rout. But I have to get the email that has a tag inside the content. If there are two emails that has the same tag, I have to sort them by latest date then get the latest email and open it. Sorry, I didn&#39;t explain it completely earlier."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "edited": false, "score": 0, "creation_date": 1441786078, "post_id": 32473429, "comment_id": 52809260, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/89135/discussion-between-siddharth-rout-and-bigbryan\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 4, "last_activity_date": 1441785138, "last_edit_date": 1441785138, "creation_date": 1441783791, "answer_id": 32473429, "question_id": 32472392, "link": "https://stackoverflow.com/questions/32472392/get-the-latest-date-of-email-in-a-folder/32473429#32473429", "title": "Get the latest date of email in a folder", "body": "<p>This is how I would do it</p>\n\n<pre><code>Sub Sample()\n    Dim objNS As NameSpace\n    Dim objFolder As MAPIFolder\n    Dim myItems As Items\n    Dim myItem As MailItem\n\n    Set objNS = GetNamespace(\"MAPI\")\n    Set objFolder = objNS.GetDefaultFolder(olFolderInbox)\n\n    Set myItems = objFolder.Items\n    myItems.Sort \"ReceivedTime\", True\n\n    If myItems.Count &gt; 0 Then\n        Set myItem = myItems.Item(1)\n\n        Debug.Print myItem.ReceivedTime\n    Else\n        Msgbox \"This folder doesn't have any emails/items\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2426, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1592943937, "creation_date": 1441780289, "last_edit_date": 1592943937, "question_id": 32472392, "link": "https://stackoverflow.com/questions/32472392/get-the-latest-date-of-email-in-a-folder", "title": "Get the latest date of email in a folder", "body": "<p>How do I get the latest date in a folder with emails inside it?</p>\n\n<p>Is there a method in VBA-Outlook that gets the latest date of an emails?</p>\n\n<p>For Example: I have three mails inside the folder with the same content but differect Received Time. How do I get the latest email from the three?</p>\n"}, {"tags": ["vba", "formatting", "ms-word"], "comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1441788140, "post_id": 32472020, "comment_id": 52810530, "body": "Why not record a macro to reformat the imported file/cv and then copy/paste this macro into your code?"}], "answers": [{"tags": [], "owner": {"reputation": 952, "user_id": 4583203, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/pUNn5.jpg?s=128&g=1", "display_name": "Tom K.", "link": "https://stackoverflow.com/users/4583203/tom-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1441791493, "creation_date": 1441791493, "answer_id": 32476080, "question_id": 32472020, "link": "https://stackoverflow.com/questions/32472020/add-word-document-and-keep-formatting/32476080#32476080", "title": "Add word document and keep formatting", "body": "<p>I'm afraid that you can't use the InsertFile-method but have to open the file and copy&amp;paste with <code>wdFormatOriginalFormatting</code></p>\n\n<p>I have found this:</p>\n\n<pre><code>Set rtffile = wdApp.Documents.Open(Filename:=\"C:\\temp\\rtf_stapler_problem\\concat\\cars2.rtf\", ConfirmConversions:=False, ReadOnly:=True)\nwdApp.Selection.WholeStory\nwdApp.Selection.Copy\nwdApp.ActiveWindow.Close savechanges:=wdDoNotSaveChanges\ndestdoc.Activate\nwdApp.Selection.PasteAndFormat (wdFormatOriginalFormatting)\nwdApp.Selection.InsertBreak Type:=wdSectionBreakNextPage\n</code></pre>\n\n<p><a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/05ddc564-a669-4822-8bab-311119c76362/method-pasteandformat-with-wdformatoriginalformatting-stripping-rtf-formatting?forum=worddev\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 25, "user_id": 5067461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0b19e0aa3ef658be28d5f9a3841948c?s=128&d=identicon&r=PG&f=1", "display_name": "confusedDude", "link": "https://stackoverflow.com/users/5067461/confuseddude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2385, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1441808645, "creation_date": 1441778866, "last_edit_date": 1441808645, "question_id": 32472020, "link": "https://stackoverflow.com/questions/32472020/add-word-document-and-keep-formatting", "title": "Add word document and keep formatting", "body": "<p>I am attempting to add my CV to the end of a document. The following code does just that but the formatting of the CV is messed up once it is inserted into the new document. Can I insert the file and keep the original formatting of the CV (I dont want to copy and paste from an open document):</p>\n\n<pre><code>objword1.Selection.InsertFile Filename:=cv1Address, _\n    ConfirmConversions:=False, Link:=False, Attachment:=False\n</code></pre>\n"}, {"tags": ["vba", "excel", "combobox"], "answers": [{"comments": [{"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1441781871, "post_id": 32472610, "comment_id": 52806783, "body": "Nope it is on the worksheet itself . No userform involved!"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1441782141, "post_id": 32472610, "comment_id": 52806926, "body": "Then Instead of <code>UserForm_Initialize</code>, Use <code>Workbook_Open</code> Event"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1441782145, "post_id": 32472610, "comment_id": 52806930, "body": "It works perfectly but everytime i run it again, the sheetnames repeat itself. For example i have sheets 1 to 4 but it has at least 3 sheet1s in the drop downlist since i ran it thrice. Any ways to stop this?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1441782207, "post_id": 32472610, "comment_id": 52806975, "body": "Add <code>Comboxo1.Clear</code> (But do not add it in the Change Event)"}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1441782584, "post_id": 32472610, "comment_id": 52807199, "body": "Now the combo box is blank."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1441782862, "post_id": 32472610, "comment_id": 52807370, "body": "You need to close and reopen the workbook for it to work. Alternatively, you can put a button on the sheet. Rename the button to <code>Refresh</code> and put the code which poupulates the combobox in that."}, {"owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "edited": false, "score": 0, "creation_date": 1441783465, "post_id": 32472610, "comment_id": 52807686, "body": "Thanks alot for taking the trouble! It works just fine now:)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 2, "last_activity_date": 1441783107, "last_edit_date": 1441783107, "creation_date": 1441781099, "answer_id": 32472610, "question_id": 32471954, "link": "https://stackoverflow.com/questions/32471954/activate-combo-box-action-on-select-value-using-excel-vba/32472610#32472610", "title": "Activate combo-box action on select value using Excel VBA", "body": "<p>You are adding the sheet names in the <code>Change Event</code>? That will <strong>re-fire</strong> the Change Event. I would recommend populating that, say in the <code>UserForm_Initialize</code> event.</p>\n\n<p>Is this what you are trying?</p>\n\n<pre><code>Dim Sh As Worksheet\n\nPrivate Sub UserForm_Initialize()\n    For Each Sh In ThisWorkbook.Sheets\n        If Sh.Name &lt;&gt; \"Inputs\" Then\n            ComboBox1.AddItem Sh.Name\n        End If\n    Next\n\n    ComboBox1.Style = fmStyleDropDownList\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\n    With ThisWorkbook.Sheets(ComboBox1.Text)\n        .Visible = xlSheetVisible\n        .Activate\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>My Assumption</strong></p>\n\n<p>You have this Combobox on a Userform. If not, then make relevant changes to the code. But the gist remains the same.</p>\n\n<p><strong>Followup From Comments</strong></p>\n\n<p>Add a button on the worksheet. Name it say <code>Refresh</code> and use this code</p>\n\n<pre><code>Dim Sh As Worksheet\n\nPrivate Sub CommandButton1_Click()\n    ComboBox1.Clear\n\n    For Each Sh In ThisWorkbook.Sheets\n        If Sh.Name &lt;&gt; \"Inputs\" Then\n            ComboBox1.AddItem Sh.Name\n        End If\n    Next\n\n    ComboBox1.Style = fmStyleDropDownList\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\n    With ThisWorkbook.Sheets(ComboBox1.Text)\n        .Visible = xlSheetVisible\n        .Activate\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 294, "user_id": 5183998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9a67401eae9c3e4afd872a931c9afc7b?s=128&d=identicon&r=PG&f=1", "display_name": "Niva", "link": "https://stackoverflow.com/users/5183998/niva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8413, "favorite_count": 0, "accepted_answer_id": 32472610, "answer_count": 1, "score": 1, "last_activity_date": 1441783107, "creation_date": 1441778565, "last_edit_date": 1441779569, "question_id": 32471954, "link": "https://stackoverflow.com/questions/32471954/activate-combo-box-action-on-select-value-using-excel-vba", "title": "Activate combo-box action on select value using Excel VBA", "body": "<p>I am displaying a combo-box which contains all sheet names of the workbook.\nIf i select a value, i want Excel to jump to the selected sheet.</p>\n\n<p>I tried doing an activate code line on this code, but it does not seem to work.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\nDim Sh As Worksheet\nDim sVal As String\n\nWith ComboBox1\nsVal = .Text\n.Clear\nFor Each Sh In ActiveWorkbook.Sheets\nIf Sh.Name &lt;&gt; \"Inputs\" Then\n.AddItem Sh.Name\nEnd If\nNext\n.Value = sVal\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-2007", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 5295987, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e759687fbe2f8e03ba07a4fad22bf37?s=128&d=identicon&r=PG&f=1", "display_name": "Philip.T", "link": "https://stackoverflow.com/users/5295987/philip-t"}, "edited": false, "score": 0, "creation_date": 1441786124, "post_id": 32472275, "comment_id": 52809297, "body": "For some reason my Excel named the worksheet &quot;Tabelle1&quot; instead of &quot;Sheet1&quot; in the Output file, but now I get the run-time error &#39;1004&#39;. Autofit method of Range class failed."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1441779897, "creation_date": 1441779897, "answer_id": 32472275, "question_id": 32471942, "link": "https://stackoverflow.com/questions/32471942/gathering-data-from-multiple-worksheets-from-a-selected-workbook/32472275#32472275", "title": "Gathering data from multiple worksheets from a selected workbook", "body": "<p><code>AutoFit</code> is a method of a <code>Range</code> object, not a <code>WorkSheet</code> object.  </p>\n\n<p>So something like:</p>\n\n<pre><code>wbk.Worksheets(outputSheetName).UsedRange.AutoFit\n</code></pre>\n\n<p>should work</p>\n"}], "owner": {"reputation": 45, "user_id": 5295987, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0e759687fbe2f8e03ba07a4fad22bf37?s=128&d=identicon&r=PG&f=1", "display_name": "Philip.T", "link": "https://stackoverflow.com/users/5295987/philip-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 32472275, "answer_count": 1, "score": 0, "last_activity_date": 1441779897, "creation_date": 1441778507, "last_edit_date": 1531161705, "question_id": 32471942, "link": "https://stackoverflow.com/questions/32471942/gathering-data-from-multiple-worksheets-from-a-selected-workbook", "title": "Gathering data from multiple worksheets from a selected workbook", "body": "<p>I'm trying to gather data from multiple sheets from a selected workbook, but I get the run-time error '9' Subscript out of range.</p>\n\n<p>I'm using the following code:</p>\n\n<pre><code>Sub MultipleSheets()\n\nDim filepath As Variant\nDim outputFilePath As String\nDim outputSheetName As String\n\n'To which file and sheet within the file should the output go?\noutputFilePath = \"C:\\Users\\z003k50s\\Desktop\\Test\\Output.xlsx\"\noutputSheetName = \"Sheet1\"\n\nFor Each filepath In Application.GetOpenFilename(FileFilter:=\"Excel Files (*.xl*), *.xl*\", MultiSelect:=True)\n    Dim conn As New ADODB.Connection\n    Dim schema As ADODB.Recordset\n    Dim sql As String\n    Dim sheetname As Variant\n\n    With conn\n        .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n        .ConnectionString = \"Data Source=\"\"\" &amp; filepath &amp; \"\"\";\" &amp; _\n            \"Extended Properties=\"\"Excel 12.0;HDR=Yes\"\"\"\n        .Open\n    End With\n    Set schema = conn.OpenSchema(adSchemaTables)\n    For Each sheetname In schema.GetRows(, , \"TABLE_NAME\") 'returns a 2D array of one column\n sql = \"SELECT * FROM [\" &amp; sheetname &amp; \"]\"\n\n        'If you want a specific range, you can change that in the last line:\n        'Dim topLeft As String, bottomRight As String\n        'topLeft = \"D4\"\n        'bottomRight = \"F100\"\n        'sql = _\n        '    \"INSERT INTO [\" &amp; outputSheetName &amp; \"$] IN \"\"\" &amp; outputFilePath &amp; \"\"\" \"\"Excel 12.0;\"\" \" &amp; _\n        '    \"SELECT * \" &amp; _\n        '    \"FROM [\" &amp; sheetname &amp; topLeft &amp; \":\" &amp; bottomRight &amp; \"]\"\n\n        conn.Execute sql\n    Next\nNext\n\nDim wbk As Workbook\nSet wbk = Workbooks.Open(outputFilePath)\nwbk.Worksheets(outputSheetName).AutoFit\n\nEnd Sub\n</code></pre>\n\n<p>Credit Zev Spitz for code sample.</p>\n\n<p>When I'm debugging, it highlights the following line:</p>\n\n<pre><code>wbk.Worksheets(outputSheetName).AutoFit\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1441773575, "post_id": 32470855, "comment_id": 52803610, "body": "For starters, writing 200,000 cells addresses to the VBE&#39;s Immediate window via <code>Debug.Print cell.Address</code> is going to negatively impact performance. Actually, writing 200,000 of <i>anything</i> to <i>anywhere</i> when it is not important is going to negatively impact performance."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1441774287, "post_id": 32470855, "comment_id": 52803814, "body": "Load the values from the tracker sheet into a dictionary object, with the values as keys and the row numbers as values.  Read the whole  A2:B200000 range into a variant array and loop over that, checking the dictionary for matches: when you find a match copy the value from the second &quot;column&quot; of the array to the tracker sheet at the row you found from the dictionary object."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1441774518, "post_id": 32470855, "comment_id": 52803872, "body": "Similar question: <a href=\"http://stackoverflow.com/questions/24998958/excel-macro-to-compare-and-copy-data-from-one-sheet-to-another-taking-a-long-tim/24999397#24999397\" title=\"excel macro to compare and copy data from one sheet to another taking a long tim\">stackoverflow.com/questions/24998958/&hellip;</a>"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441775882, "post_id": 32470855, "comment_id": 52804264, "body": "Same approach as @TimWilliams, except I&#39;d copy both sheets to arrays"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441778380, "post_id": 32470855, "comment_id": 52805165, "body": "To put the numbers from your narrative into perspective, you say that you can run 1000 values through in &#39;less than a minute&#39;. Round that up to a minute. 1,000,000 rows is 1000&#178; so even without accounting for performance degradation on the larger data set, that means that 1,000,000 rows will take 1000 minutes or 16 hours and 40 minutes."}, {"owner": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "edited": false, "score": 0, "creation_date": 1441779029, "post_id": 32470855, "comment_id": 52805432, "body": "Do you mean i should remove the Debug.Printcell.Address? @Jeeped"}, {"owner": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441779060, "post_id": 32470855, "comment_id": 52805444, "body": "Thanks i will take a look at the similar question which you have given :) @TimWilliams"}, {"owner": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441779112, "post_id": 32470855, "comment_id": 52805466, "body": "What do you mean copy it to arrays? @paulbica"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1441779562, "post_id": 32470855, "comment_id": 52805656, "body": "That would a start. I&#39;m working on a revised method for you involving a combination of variant arrays and a scripting dictionary that should improve performance. Testing is taking a while."}, {"owner": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "edited": false, "score": 0, "creation_date": 1441780162, "post_id": 32470855, "comment_id": 52805896, "body": "Alright thank you! :) @Jeeped"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "edited": false, "score": 1, "creation_date": 1441784292, "post_id": 32472168, "comment_id": 52808199, "body": "Hi i tried the code you gave however it does not work when Sheet 1 is in a pivot table, is there any additional code i would need to do in order for the code to work on pivot table? @TimWilliams"}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "edited": false, "score": 1, "creation_date": 1441788828, "post_id": 32472168, "comment_id": 52810979, "body": "@nabilah.  What! Sheet1 (tracker) data cannot be updated if it is in a pivot table!  You might be able to update the range that the pivot table is based on to have the value looked up from sheet2 (master) and then change the definition of the pivot table to display this new value."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 1, "creation_date": 1441793245, "post_id": 32472168, "comment_id": 52814057, "body": "Thanks for this @Tim, I learn a lot.  I posted an answer too (a coy of yours) which a couple of points and slightly easier to understand variable names.  (I found replacing dict with dictTracker helped me to understand it more easily.)  Nice code."}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 1, "creation_date": 1441801949, "post_id": 32472168, "comment_id": 52820021, "body": "You even included a tmp for efficiency !"}, {"owner": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "reply_to_user": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1441851627, "post_id": 32472168, "comment_id": 52844327, "body": "Sorry I dont get what you are trying to say. Do you mean i have to remove the pivot table and run the code and after that do a pivot table again? @HarveyFrench"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 6, "last_activity_date": 1441779458, "creation_date": 1441779458, "answer_id": 32472168, "question_id": 32470855, "link": "https://stackoverflow.com/questions/32470855/run-through-a-loop-for-more-than-100-000-rows-of-data-in-two-sheets-in-the-same/32472168#32472168", "title": "Run through a loop for more than 100,000 rows of data in two sheets in the same workbook", "body": "<p>Incorporating @paulbica's suggestion, this ran in several seconds for me.</p>\n\n<pre><code>Sub Sample()\n\n    Dim rngTracker As Range\n    Dim rngMaster As Range\n    Dim arrT, arrM\n    Dim dict As Object, r As Long, tmp\n\n    With Workbooks(\"test.xlsm\")\n        Set rngTracker = .Sheets(\"Tracker\").Range(\"A2:B43000\")\n        Set rngMaster = .Sheets(\"Master\").Range(\"A2:C200000\")\n    End With\n\n    'get values in arrays\n    arrT = rngTracker.Value\n    arrM = rngMaster.Value\n\n    'load the dictionary\n    Set dict = CreateObject(\"scripting.dictionary\")\n    For r = 1 To UBound(arrT, 1)\n        dict(arrT(r, 1)) = r\n    Next r\n\n    'map between the two arrays using the dictionary\n    For r = 1 To UBound(arrM, 1)\n        tmp = arrM(r, 1)\n        If dict.exists(tmp) Then\n            arrT(dict(tmp), 2) = arrM(r, 3)\n        End If\n    Next r\n\n    rngTracker.Value = arrT\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "edited": false, "score": 1, "creation_date": 1441782785, "post_id": 32472871, "comment_id": 52807328, "body": "Alright thank you! Really appreciate your help :) @Jeeped"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "edited": false, "score": 1, "creation_date": 1441782929, "post_id": 32472871, "comment_id": 52807401, "body": "If you have time, please offer up some speed trial times of before and after for the benefit of others (after both offerings of course). I&#39;m very interested in how the two responses worked on actual data vs. the randomized sample data I created."}, {"owner": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "edited": false, "score": 1, "creation_date": 1441785006, "post_id": 32472871, "comment_id": 52808606, "body": "Alright i will try :). However do you know any additional code that i would need to use if the rows are in the pivot table?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "edited": false, "score": 1, "creation_date": 1441785112, "post_id": 32472871, "comment_id": 52808688, "body": "tbh, I really didn&#39;t take a pivot table into consideration while writing the above code. That might have been something to mention."}, {"owner": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "edited": false, "score": 0, "creation_date": 1441785628, "post_id": 32472871, "comment_id": 52808992, "body": "Its Okay, but most codes does not work on the pivot table unless some additional code is added. But i am unsure of what code that is needed to add in @Jeeped"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 2, "creation_date": 1441792214, "post_id": 32472871, "comment_id": 52813336, "body": "@Jeepad Typo error <code>Set master = Workbooks(&quot;test.xlsm&quot;).Sheets(&quot;Sheet2)</code> to be as <code>Set master = Workbooks(&quot;test.xlsm&quot;).Sheets(&quot;Sheet2&quot;)</code>"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441801261, "post_id": 32472871, "comment_id": 52819533, "body": "++ great implementation! I think populating the dictionary might be the slowest part, but I&#39;m curious to see the difference before and after"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1441835300, "post_id": 32472871, "comment_id": 52839953, "body": "Add a reference to <b>Microsoft Scripting Runtime</b> (<b>Tools -&gt; References...</b>). Then you can write <code>Dim dMaster As New Scripting.Dictionary</code> instead of <code>Dim dMaster As Object: Set dMaster = CreateObject(&quot;Scripting.Dictionary&quot;)</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1441835833, "post_id": 32472871, "comment_id": 52840150, "body": "@ZevSpitz - My code was specifically written using the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264813.aspx\" rel=\"nofollow noreferrer\">CreateObject function</a> as I wished to avoid situations like <a href=\"http://stackoverflow.com/questions/29384575/combine-rows-sum-values-in-a-worksheet/29386035#29386035\">this</a> or <a href=\"http://stackoverflow.com/questions/31891059/extracting-the-collection-of-unique-values-from-a-filter-in-vba/31891475#31891475\">this</a>."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1441836627, "post_id": 32472871, "comment_id": 52840485, "body": "<i>situations like this</i>: That someone might misread <b>Microsoft Scripting Runtime</b> as <b>Windows Scripting Runtime</b>? (I&#39;m not sure what is the second situation you are referring to.) My own feeling is that it provides Intellisense to users who are unfamiliar with the Dictionary, and is worth a little explanation; but I can agree to disagree."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1441837010, "post_id": 32472871, "comment_id": 52840631, "body": "Is there any particular reason to write <code>dMASTER.Add Key:=vMASTER(v, 1), Item:=vMASTER(v, 3)</code> instead of <code>dMASTER(vMASTER(v, 1)) = vMASTER(v, 3)</code>?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1441837115, "post_id": 32472871, "comment_id": 52840658, "body": "And <code>vTRACKER(v, 2) = dMASTER.Item(vTRACKER(v, 1))</code> instead of <code>vTRACKER(v, 2) = dMASTER(vTRACKER(v, 1))</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1441837277, "post_id": 32472871, "comment_id": 52840711, "body": "@ZevSpitz - Beyond a verbose method of building (and extracting) the dictionary, no there is not. I used the <code>.Exists</code> method instead of a forced write (and possible overwrite) because I felt it explained the process a little better. Same for extracting the <code>.Item</code> from a match."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1441792355, "last_edit_date": 1441792355, "creation_date": 1441782029, "answer_id": 32472871, "question_id": 32470855, "link": "https://stackoverflow.com/questions/32470855/run-through-a-loop-for-more-than-100-000-rows-of-data-in-two-sheets-in-the-same/32472871#32472871", "title": "Run through a loop for more than 100,000 rows of data in two sheets in the same workbook", "body": "<p>You could use the index of a <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251825.aspx\" rel=\"nofollow\">Dictionary object</a> and use its native indexing properties  to perform the lokups. I'm not sure just how well that will perform in a data set of 200K records where a high report of failure was going to occur and you are showing at least a 78% failure rate (200K records to match and update 43K records).</p>\n\n<pre><code>Sub Sample3()\n    Dim tracker As Worksheet, master As Worksheet\n    Dim OutPut As Long\n    Dim v As Long, p As Long, vMASTER As Variant, vTRACKER As Variant, dMASTER As Object\n\n    Set tracker = Workbooks(\"test.xlsm\").Sheets(\"Sheet1\")\n    Set master = Workbooks(\"test.xlsm\").Sheets(\"Sheet2\")\n    Set dMASTER = CreateObject(\"Scripting.Dictionary\")\n\n    Debug.Print Timer\n    'Application.ScreenUpdating = False '&lt;~~no real need to do this if working in memory\n\n    With tracker\n        vTRACKER = .Range(.Cells(5, 2), .Cells(Rows.Count, 1).End(xlUp)).Value2\n    End With\n\n    With master\n        vMASTER = .Range(.Cells(2, 1), .Cells(Rows.Count, 3).End(xlUp)).Value2\n        For v = LBound(vMASTER, 1) To UBound(vMASTER, 1)\n            If Not dMASTER.exists(vMASTER(v, 1)) Then _\n                dMASTER.Add Key:=vMASTER(v, 1), Item:=vMASTER(v, 3)\n        Next v\n    End With\n\n    For v = LBound(vTRACKER, 1) To UBound(vTRACKER, 1)\n        If dMASTER.exists(vTRACKER(v, 1)) Then _\n            vTRACKER(v, 2) = dMASTER.Item(vTRACKER(v, 1))\n    Next v\n\n    With ThisWorkbook.Sheets(\"Sheet1\")  'tracker\n        .Cells(5, 1).Resize(UBound(vTRACKER, 1), 2) = vTRACKER\n    End With\n\n    'Application.ScreenUpdating = True '&lt;~~no real need to do this if working in memory\n    Debug.Print Timer\n    OutPut = MsgBox(\"Update over!\", vbOKOnly, \"Update Status\")\n\n    dMASTER.RemoveAll: Set dMASTER = Nothing\n    Set tracker = Nothing\n    Set master = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Once both ranges are mirrored into variant arrays, a dictionary is created in order to fully utilize its indexing properties for identification.</p>\n\n<p>The above shows about a significant increase in efficiency over 200K records in <strong>master</strong> vs 43K records in <strong>tracker</strong>.</p>\n\n<p>btw, I did use an .XLSB for this; not an .XLSM.</p>\n"}, {"tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 2, "last_activity_date": 1441840881, "last_edit_date": 1495541751, "creation_date": 1441797925, "answer_id": 32478268, "question_id": 32470855, "link": "https://stackoverflow.com/questions/32470855/run-through-a-loop-for-more-than-100-000-rows-of-data-in-two-sheets-in-the-same/32478268#32478268", "title": "Run through a loop for more than 100,000 rows of data in two sheets in the same workbook", "body": "<p>It might also be faster to use ADODB.</p>\n\n<pre><code>Dim filepath As String\nDim conn As New ADODB.Connection\nDim sql As String\n\nfilepath = \"c:\\path\\to\\excel\\file\\book.xlsx\"\n\nWith conn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .ConnectionString = \"Data Source=\"\"\" &amp; filepath &amp; \"\"\";\" &amp; _\n        \"Extended Properties=\"\"Excel 12.0;HDR=No\"\"\"\n\n    sql = _\n        \"UPDATE [Sheet1$A2:B200000] AS master \" &amp; _\n        \"INNER JOIN [Sheet2$] AS tracker ON master.F1 = tracker.F1 \" &amp; _\n        \"SET master.F2 = tracker.F2\"\n    .Execute sql\nEnd With\n</code></pre>\n\n<p>This works with Office 2007. Office 2010 (I haven't tested on 2013) has a <a href=\"https://stackoverflow.com/a/30976606/111794\">security measure that prevents updating Excel spreadsheets with an SQL statement</a>. In this case you can either use the old Jet provider, which doesn't have this security measure. This provider doesn't support <code>.xlsx</code>, <code>.xlsm</code> or <code>.xlsb</code> files; only <code>.xls</code>.</p>\n\n<pre><code>With conn\n    .Provider = \"Microsoft.Jet.OLEDB.4.0\"\n    .ConnectionString = \"Data Source=\"\"\" &amp; filepath &amp; \"\"\";\" &amp; _\n        \"Extended Properties=\"\"Excel 8.0;HDR=No\"\"\"\n</code></pre>\n\n<p>Alternatively, you can read the resulting data into a disconnected recordset and paste the recordset into the original worksheet:</p>\n\n<pre><code>Dim filepath As String\nDim conn As New ADODB.Connection\nDim sql As String\nDim rs As New ADODB.Recordset\n\nfilepath = \"c:\\path\\to\\excel\\file\\book.xlsx\"\n\nWith conn\n    .Provider = \"Microsoft.ACE.OLEDB.12.0\"\n    .ConnectionString = \"Data Source=\"\"\" &amp; filepath &amp; \"\"\";\" &amp; _\n        \"Extended Properties=\"\"Excel 12.0;HDR=No\"\"\"\n\n    sql = _\n        \"SELECT master.F1, IIF(tracker.F1 Is Not Null, tracker.F2, master.F2) \" &amp; _\n        \"FROM [Sheet1$A2:B200000] AS master \" &amp; _\n        \"LEFT JOIN [Sheet2$] AS tracker ON master.F1 = tracker.F1 \"\n\n    rs.CursorLocation = adUseClient\n    rs.Open sql, conn, adOpenForwardOnly, adLockReadOnly\n    conn.Close\nEnd With\n\nWorkbooks.Open(filepath).Sheets(\"Sheet1\").Cells(2, 1).CopyFromRecordset rs\n</code></pre>\n\n<p>If using CopyFromRecordset, keep in mind that there is no guarantee of the order in which the records are returned, which might be a problem if there is other data in the <code>master</code> worksheet besides columns A and B. To resolve this, you can include those other columns in the recordset as well. Alternatively, you can enforce the order of the records using an <code>ORDER BY</code> clause, and sort the data in the worksheet before you begin.</p>\n"}], "owner": {"reputation": 53, "user_id": 5188140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75d59a06f71c0710181502cb8f5a3d5d?s=128&d=identicon&r=PG&f=1", "display_name": "nabilah", "link": "https://stackoverflow.com/users/5188140/nabilah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3268, "favorite_count": 1, "accepted_answer_id": 32472168, "answer_count": 3, "score": 5, "last_activity_date": 1441840881, "creation_date": 1441772434, "last_edit_date": 1441840719, "question_id": 32470855, "link": "https://stackoverflow.com/questions/32470855/run-through-a-loop-for-more-than-100-000-rows-of-data-in-two-sheets-in-the-same", "title": "Run through a loop for more than 100,000 rows of data in two sheets in the same workbook", "body": "<p>I currently have code to allow me to look through the rows with matching ID from Sheet 1 and Sheet 2. When both IDs match, Sheet 2 information will be pasted to the Sheet 1 rows with the same IDs. My code works on less than 1,000 rows and when I tested it gave results within a minute.  </p>\n\n<p>The problem is that when I tried to run it for 1,000,000 rows it keeps running and for more than 20 minutes and never stop running since then. I hope anyone could assist me in making changes to the code to allow me to do a loop and copy paste the information from Sheet 2 to Sheet 1 for 200,000 rows.</p>\n\n<pre><code>Sub Sample()\n\n\n  Dim tracker As Worksheet\n    Dim master As Worksheet\n    Dim cell As Range\n    Dim cellFound As Range\n    Dim OutPut As Long\n\n   Set tracker = Workbooks(\"test.xlsm\").Sheets(\"Sheet1\")\n   Set master = Workbooks(\"test.xlsm\").Sheets(\"Sheet2\")\n\n   Application.ScreenUpdating = False\n    For Each cell In master.Range(\"A2:A200000\")\n\n        Set cellFound = tracker.Range(\"A5:A43000\").Find(What:=cell.Value, LookIn:=xlValues, LookAt:=xlWhole)\n        If Not cellFound Is Nothing Then\n      matching value\n\n            cellFound.Offset(ColumnOffset:=1).Value2 = cell.Offset(ColumnOffset:=2).Value2\n\n\n        Else\n\n        End If\n        Set cellFound = Nothing\n        Debug.Print cell.Address\n    Next\n    Application.ScreenUpdating = True\n    OutPut = MsgBox(\"Update over!\", vbOKOnly, \"Update Status\")\n\n\nEnd Sub\n</code></pre>\n\n<p>Above is the code that I have for now.</p>\n"}, {"tags": ["excel", "vba"], "owner": {"reputation": 25493, "user_id": 1152000, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2c630cc34411652bd3659f1272d71dbc?s=128&d=identicon&r=PG", "display_name": "lakesh", "link": "https://stackoverflow.com/users/1152000/lakesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3352, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1525106756, "creation_date": 1441770281, "question_id": 32470563, "link": "https://stackoverflow.com/questions/32470563/this-formula-contains-unrecognized-text-error-in-excel-and-vba", "title": "This formula contains unrecognized text Error in Excel and VBA", "body": "<p>I am running a macro in Excel using VBA and in the VBA, I am changing text = \"Yes\". If it is changed, the rest of cells that depend on this should be activated or I should see a change in the value of the cell. </p>\n\n<p>However, I am seeing a #Name? Error in all the cells and the error reads as \"This formula contains unrecognized text\". </p>\n\n<p>The cell contains this: <code>=IF($D$2=\"Yes\",RtContribute($C$2,B4,$C$3:$D$3,C4:D4,$C$1),\"\")</code></p>\n\n<p>Not sure what is causing the error. </p>\n"}, {"tags": ["vba", "email", "foreach", "outlook"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1441773568, "post_id": 32470467, "comment_id": 52803609, "body": "The <b>i</b> in <code>.Items(i)</code> are not unique so you cannot use it as <b>ID</b>. There is a unique ID called <b><code>.EntryID</code></b>. See Outlook&#39;s <a href=\"https://msdn.microsoft.com/en-us/library/office/ff866458(v=office.14).aspx\" rel=\"nofollow noreferrer\">MailItem.EntryID</a>. So in your case you can try <code>myMail.EntryID</code> (it&#39;s a very long string)."}], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1441782238, "creation_date": 1441782238, "answer_id": 32472932, "question_id": 32470467, "link": "https://stackoverflow.com/questions/32470467/vba-outlook-how-to-get-the-item-number-of-an-email/32472932#32472932", "title": "VBA Outlook: How to Get the Item Number of an Email?", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff866458.aspx\" rel=\"nofollow\">EntryID</a> property which returns a String representing the unique Entry ID of the object. Here is what MSDN states for the EntryID:</p>\n\n<blockquote>\n  <p>A MAPI store provider assigns a unique ID string when an item is created in its store. Therefore, the EntryID property is not set for an Outlook item until it is saved or sent. The Entry ID changes when an item is moved into another store, for example, from your Inbox to a Microsoft Exchange Server public folder, or from one Personal Folders (.pst) file to another .pst file. Solutions should not depend on the EntryID property to be unique unless items will not be moved. </p>\n</blockquote>\n\n<pre><code>For each myMail In myFolder.Items\n Msgbox myMail.EntryID\nNext\n</code></pre>\n\n<p>Note, iterating though each item in the folder may take a lot of time. If you need to find a mail item in the folder I'd recommend using the <code>Find</code>/<code>FindNext</code> or <code>Restrict</code> methods of the <code>Items</code> class. </p>\n"}], "owner": {"reputation": 321, "user_id": 4563989, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a75767e3032017ddbb28f4cf8f4b3e40?s=128&d=identicon&r=PG&f=1", "display_name": "bigbryan", "link": "https://stackoverflow.com/users/4563989/bigbryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1364, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1441782238, "creation_date": 1441769521, "question_id": 32470467, "link": "https://stackoverflow.com/questions/32470467/vba-outlook-how-to-get-the-item-number-of-an-email", "title": "VBA Outlook: How to Get the Item Number of an Email?", "body": "<p>I'm looping thru each email in Outlook and I want to MsgBox the Item ID of Each Email</p>\n\n<pre><code> For each myMail In myFolder.Items\n\n    Msgbox \n\n Next\n</code></pre>\n\n<p>The output should be like item(1) or item(2).</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5315027, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wmLmEH7M1-0/AAAAAAAAAAI/AAAAAAAAABA/yi6Q4lwmYKs/photo.jpg?sz=128", "display_name": "Kevin Sanders", "link": "https://stackoverflow.com/users/5315027/kevin-sanders"}, "edited": false, "score": 0, "creation_date": 1441816781, "post_id": 32469975, "comment_id": 52830971, "body": "I&#39;m not sure why they were reversed either. Thanks for the help!"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 2, "last_activity_date": 1441765723, "last_edit_date": 1441765723, "creation_date": 1441765310, "answer_id": 32469975, "question_id": 32469561, "link": "https://stackoverflow.com/questions/32469561/copying-and-pasting-visible-cells-only/32469975#32469975", "title": "Copying and pasting visible cells only", "body": "<p>You can't do it that way even if you manually do it.<br>\nYou will have to loop to get what you want. So give this a try.</p>\n\n<pre><code>Dim c As Range\nFor Each c In Sheet1.Range(\"A1:A100\").SpecialCells(xlCellTypeVisible)\n    If Len(c) &lt;&gt; 0 Then c.Offset(0, 1) = c\nNext\n</code></pre>\n\n<p>The odd thing about your result is why does it copy the values in reverse order.<br>\nI can understand if it copies all the visible cells at B1 onwards, but not the reversal of values.<br>\nAnyways, try above first if it gets you going.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5315027, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wmLmEH7M1-0/AAAAAAAAAAI/AAAAAAAAABA/yi6Q4lwmYKs/photo.jpg?sz=128", "display_name": "Kevin Sanders", "link": "https://stackoverflow.com/users/5315027/kevin-sanders"}, "edited": false, "score": 1, "creation_date": 1441816764, "post_id": 32470440, "comment_id": 52830968, "body": "Thank you very much! Very helpful!"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1441769254, "creation_date": 1441769254, "answer_id": 32470440, "question_id": 32469561, "link": "https://stackoverflow.com/questions/32469561/copying-and-pasting-visible-cells-only/32470440#32470440", "title": "Copying and pasting visible cells only", "body": "<p>I'm not sure how you have the output in reverse order, but for me your code works:</p>\n\n<pre><code>Sub TryMe()\n\n    '1. some visible values in col A will be will be hidden in col B by hidden rows\n\n    Sheet1.Range(\"A1:A10\").SpecialCells(xlCellTypeVisible).Copy _\n        Destination:=Range(\"A1\").Offset(ColumnOffset:=1)\n\n    '2. all visible values in col A will be will be visible bellow\n\n    Sheet1.Range(\"A1:A10\").SpecialCells(xlCellTypeVisible).Copy _\n        Destination:=Range(\"A11\").Offset(ColumnOffset:=1)\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/DN1oM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DN1oM.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10567874, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/--W0U06FvTqY/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbBEnf3GPwi1c7rLzK3CMUesE10IhA/mo/photo.jpg?sz=128", "display_name": "Jappa Langua", "link": "https://stackoverflow.com/users/10567874/jappa-langua"}, "is_accepted": false, "score": 0, "last_activity_date": 1540658234, "creation_date": 1540658234, "answer_id": 53024092, "question_id": 32469561, "link": "https://stackoverflow.com/questions/32469561/copying-and-pasting-visible-cells-only/53024092#53024092", "title": "Copying and pasting visible cells only", "body": "<p>Use this code guys! Works like a charm :)</p>\n\n<pre><code>Sub PasteToFilteredCells()\n\nDim rng1 As Range\nDim rng2 As Range\nDim InputRng As Range\nDim OutRng As Range\nDim n As Integer\nn = 0\nDim x As Integer\nDim c As Integer\nc = 0\n\nxTitleId = \"Paste Buddy\"\nSet InputRng = Application.Selection\nSet InputRng = Application.InputBox(\"Copy Range :\", xTitleId, InputRng.Address, Type:=8)\nSet OutRng = Application.InputBox(\"Paste Range:\", xTitleId, Type:=8)\nx = InputRng.SpecialCells(xlCellTypeVisible).Count   \n\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\nApplication.DisplayStatusBar = False    \n\nFor Each rng1 In InputRng\n If rng1.EntireRow.RowHeight &gt; 0 Then\n    rng1.Copy\n    c = c + 1\n Else\n    GoTo NextIte\n End If    \n    Do While (c &lt; (x + 1))            \n     If (OutRng.Offset(n, 0).EntireRow.RowHeight &gt; 0) Then      \n      OutRng.Offset(n, 0).PasteSpecial\n      n = n + 1\n      GoTo NextIte        \n     Else\n      n = n + 1\n     End If       \n    Loop        \nNextIte:\nNext rng1\n\nApplication.CutCopyMode = False\nApplication.Calculation = xlCalculationAutomatic\nApplication.ScreenUpdating = True\nApplication.DisplayStatusBar = True\n\nEnd Sub\n</code></pre>\n\n<p></p>\n"}], "owner": {"reputation": 31, "user_id": 5315027, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wmLmEH7M1-0/AAAAAAAAAAI/AAAAAAAAABA/yi6Q4lwmYKs/photo.jpg?sz=128", "display_name": "Kevin Sanders", "link": "https://stackoverflow.com/users/5315027/kevin-sanders"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31581, "favorite_count": 1, "protected_date": 1562358448, "answer_count": 3, "score": 3, "last_activity_date": 1576264182, "creation_date": 1441762054, "last_edit_date": 1576264182, "question_id": 32469561, "link": "https://stackoverflow.com/questions/32469561/copying-and-pasting-visible-cells-only", "title": "Copying and pasting visible cells only", "body": "<p>I need to copy a column of visible cells and paste to the next column over.</p>\n\n<p>I can't find a macro that works. I had one going, but it only copies some numbers. </p>\n\n<p>Here is the code</p>\n\n<pre><code>Sub TryMe()\nSheet1.Range(\"A1:A100\").SpecialCells(xlCellTypeVisible).Copy _\n  Destination:=Range(\"A1\").Offset(ColumnOffset:=1)\nEnd Sub\n</code></pre>\n\n<p>This image is before I run the macro. Notice the rows that are hidden. I need these numbers to copy to the next column.<br>\n<a href=\"https://i.stack.imgur.com/Sz55d.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Sz55d.png\" alt=\"enter image description here\"></a></p>\n\n<p>This image is after I run the macro. I don't understand why only some of the numbers are copying. The hidden rows contain the numbers 3 and 6. Why are they in the outcome, but not the visible numbers? I need to copy what is seen.<br>\n<a href=\"https://i.stack.imgur.com/QRsJG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QRsJG.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3487874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a7fdc09a4853c8aa50a0f31b1ec0861?s=128&d=identicon&r=PG&f=1", "display_name": "user3487874", "link": "https://stackoverflow.com/users/3487874/user3487874"}, "edited": false, "score": 0, "creation_date": 1441838933, "post_id": 32472850, "comment_id": 52841276, "body": "Thanks for the response, but he message has been sent as it is in the sent items folder. Point been that the macro does what it needs to do even after it throws the error. The sent item still gets copied to the other folders.. I just don&#39;t get why it was fine last week."}, {"owner": {"reputation": 3, "user_id": 3487874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a7fdc09a4853c8aa50a0f31b1ec0861?s=128&d=identicon&r=PG&f=1", "display_name": "user3487874", "link": "https://stackoverflow.com/users/3487874/user3487874"}, "edited": false, "score": 0, "creation_date": 1441840003, "post_id": 32472850, "comment_id": 52841585, "body": "Right, now I am very confused.. If I add &quot;MsgBox (&quot;Message Moved&quot;)&quot; to the end,just before the endsub, the runtime error is not thrown... What is going on here? I forgot to say that I get the runtime error on multiple computers. Thanks"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 3, "user_id": 3487874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a7fdc09a4853c8aa50a0f31b1ec0861?s=128&d=identicon&r=PG&f=1", "display_name": "user3487874", "link": "https://stackoverflow.com/users/3487874/user3487874"}, "edited": false, "score": 0, "creation_date": 1441870198, "post_id": 32472850, "comment_id": 52851116, "body": "What line of code generates an error? Did you try to debug the code?"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": -1, "last_activity_date": 1441781977, "creation_date": 1441781977, "answer_id": 32472850, "question_id": 32469527, "link": "https://stackoverflow.com/questions/32469527/runtime-error-in-outlook-macro-item-sendername/32472850#32472850", "title": "Runtime error in outlook macro - Item.senderName", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869598.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">SenderName</a> property returns a String indicating the display name of the sender for the Outlook item. It is set after the mail item has been sent. New items (unsent) don't have this property set.</p>\n\n<p>You may consider using the <a href=\"https://msdn.microsoft.com/EN-US/library/office/ff868473.aspx\" rel=\"nofollow\">SaveSentMessageFolder</a> property which allows to set a Folder object that represents the folder in which a copy of the e-mail message will be saved after being sent. For example, you may handle the ItemSend event where you can set this property.</p>\n\n<pre><code> Sub SetSentFolder()  \n  Dim myItem As Outlook.MailITem \n  Dim myResponse As Outlook.MailITem \n  Dim mpfInbox As Outlook.Folder \n  Dim mpf As Outlook.Folder \n  Set mpfInbox = Application.Session.GetDefaultFolder(olFolderInbox) \n  Set mpf = mpfInbox.Folders.Add(\"SaveMyPersonalItems\") \n  Set myItem = Application.ActiveInspector.CurrentItem \n  Set myResponse = myItem.Reply \n  myResponse.Display \n  myResponse.To = \"Eugene Astafiev\" \n  Set myResponse.SaveSentMessageFolder = mpf \n  myResponse.Send \n End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3487874, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a7fdc09a4853c8aa50a0f31b1ec0861?s=128&d=identicon&r=PG&f=1", "display_name": "user3487874", "link": "https://stackoverflow.com/users/3487874/user3487874"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 897, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593075991, "creation_date": 1441761765, "last_edit_date": 1593075991, "question_id": 32469527, "link": "https://stackoverflow.com/questions/32469527/runtime-error-in-outlook-macro-item-sendername", "title": "Runtime error in outlook macro - Item.senderName", "body": "<p>I have the following macro;</p>\n\n<pre><code>Private WithEvents MySents As Outlook.Items\n\nPrivate Sub Application_Startup()\nSet MySents = Session.GetDefaultFolder(olFolderSentMail).Items\nEnd Sub\n\nPrivate Sub MySents_ItemAdd(ByVal Item As Object)\n\nDim objNS As Outlook.NameSpace\nDim targetFolder As Outlook.MAPIFolder\n\nSet objNS = Outlook.GetNamespace(\"MAPI\")\n\nIf TypeOf Item Is Outlook.MailItem Then\n   If Item.SenderName = \"Sender 1\" Then\n      Set targetFolder = objNS.Folders(\"Folder 1\").Folders(\"Sent Items\")\n      Set newItem = Item.Copy\n      newItem.Move targetFolder\n   End If\n\n   If Item.SenderName = \"Sender 2\" Then\n      Set targetFolder = objNS.Folders(\"Folder 2\").Folders(\"Sent Items\")\n      Set newItem = Item.Copy\n      newItem.Move targetFolder\n   End If\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Last week this worked fine. Now when the macro runs I get a \"Runtime error -2147221241 (80040107) The operation failed\"</p>\n\n<p>Looking at the debugger it fails on;</p>\n\n<pre><code>If Item.SenderName =\n</code></pre>\n\n<p>If I have a look at Items in the watch window most properties have \"The operation failed\" in the values. </p>\n\n<p>Most strange about this is the fact that the message still gets copied anyway.</p>\n\n<p>Can anyone see something silly I am doing?</p>\n"}, {"tags": ["vba", "powerpoint", "office-addins"], "comments": [{"owner": {"reputation": 9777, "user_id": 2342399, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/da7b3bf63455228a889008a1cd76109a?s=128&d=identicon&r=PG", "display_name": "Boosted_d16", "link": "https://stackoverflow.com/users/2342399/boosted-d16"}, "edited": false, "score": 0, "creation_date": 1557707446, "post_id": 32468624, "comment_id": 98843320, "body": "Try www.pptxbuilder.com"}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1441759786, "last_edit_date": 1495541200, "creation_date": 1441759786, "answer_id": 32469304, "question_id": 32468624, "link": "https://stackoverflow.com/questions/32468624/automate-powerpoint-macro/32469304#32469304", "title": "Automate Powerpoint Macro", "body": "<p>Two ways to do this come to mind:</p>\n\n<ol>\n<li><p>An Add-in that has an <em>application-level</em> event handler. Then, you could leverage the application class <code>PresentationOpen</code> event, compare the filename against the known file which you want to operate on, and then run the macro only when the right file has been opened. See <a href=\"https://msdn.microsoft.com/EN-US/library/ff746018.aspx\" rel=\"nofollow noreferrer\">this MSDN link</a> for some information about creating an application-level event handler class.  </p></li>\n<li><p>Use the Ribbon XML framework to call a procedure from the ribbon's <code>OnLoad</code> event.  </p></li>\n</ol>\n\n<p>The second method would be essentially self-contained whereas the previous method would require at least one additional Add-in file to control the process.</p>\n\n<p>The second method would use VBA that looks something like:</p>\n\n<pre><code>Option Explicit\nPublic Rib As IRibbonUI\n\n'Callback for customUI.onLoad\nSub RibbonOnLoad(ribbon As IRibbonUI)\n    Set Rib = ribbon\n    Call Auto_Open()  '### I would recommend changing your procedure name just to avoid confusion...\nEnd Sub\nSub Auto_Open()\n    '### This is your procedure/macro that you want to run\n    ' etc\n    ' etc\n\nEnd Sub\n</code></pre>\n\n<p>And you would need the ribbon XML (use the <a href=\"http://openxmldeveloper.org/archive/2009/08/06/7293.aspx\" rel=\"nofollow noreferrer\">CustomUI editor</a> to insert this, it can be done otherwise but this is probably the simplest): </p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n   &lt;customUI onLoad=\"RibbonOnLoad\" xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\"&gt;\n   &lt;/customUI&gt;\n</code></pre>\n\n<p>The way this works is that when the file is opened, the <code>RibbonOnLoad</code> procedure is called, and that procedure then calls the procedure which executes your macro code.  Note that <a href=\"https://stackoverflow.com/questions/27154573/powerpoint-add-in-loss-of-ribbonui\">unhandled run-time errors may cause the loss of the ribbon object variable</a> which can be disastrous in larger applications, but in your specific use-case this shouldn't be a problem as re-opening the file from disk will always reload the ribbon anyways.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/library/office/ee691832(v=office.14).aspx\" rel=\"nofollow noreferrer\">This link</a> also has more info about the basics of ribbon customization, but for your purposes, I think the above code is all you should need.</p>\n"}], "owner": {"reputation": 11, "user_id": 5314756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3aaa050441f2a0e34bc1a6666e865f7b?s=128&d=identicon&r=PG&f=1", "display_name": "Bryce W", "link": "https://stackoverflow.com/users/5314756/bryce-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1084, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1441759862, "creation_date": 1441754021, "last_edit_date": 1441759862, "question_id": 32468624, "link": "https://stackoverflow.com/questions/32468624/automate-powerpoint-macro", "title": "Automate Powerpoint Macro", "body": "<p>I have a PowerPoint Presentation that gets filled with pictures by a VBA script attached to it.  I want to automatically open the Presentation and run the macro. Here's what I have tried:</p>\n\n<ul>\n<li>turning the script into an add-in as shown <a href=\"http://www.pptfaq.com/FAQ00031_Create_an_ADD-IN_with_TOOLBARS_that_run_macros.htm\" rel=\"nofollow\">here</a>: it ran when I clicked activated it, but never when I simply opened powerpoint. </li>\n<li>downloaded a pre-built add in, and called my script sub auto_open(). This worked, but because it is a macro enabled file(?), but I have to open powerpoint up and enable the add in before opening the file, so it's not much more automatic than just running the macro</li>\n<li><p>Running PowerPoint through MatLab. I used the following commands that I found <a href=\"http://www.mathworks.com/matlabcentral/newsreader/view_thread/243292\" rel=\"nofollow\">here</a>, which do open powerpoint, and the file I am interested in.</p>\n\n<ul>\n<li><code>g = actxserver('PowerPoint.Application');</code></li>\n<li><code>Presentation = invoke(g.Presentations,'Open','\\\\path\\Automatic_NEdN_Template2.pptm')</code></li>\n<li><code>a = invoke(Presentation.Application,'Run','Auto_Open',[])</code></li>\n</ul>\n\n<p>With small test cases, it even seemed to work--I could call a vba function that read data from a file and it would return the data to matlab, but when I tried to call the one that makes pictures, it returned NaN and the PowerPoint was not filled.</p></li>\n</ul>\n\n<p>Ideally, I'd like to double click on something, then have PowerPoint open, and run my script.</p>\n\n<p>Here are some code snippets if they'll help:</p>\n\n<pre><code>    Function read_in_data_from_txt_file(strFileName As String) As String()\n\n    Dim dataArray() As String\n    Dim i As Integer\n\n    'Const strFileName As String = \"C:\\H5_Samples\\Plots\\WeeklyPlots\\zz_avgTemp.txt\"\n    Open strFileName For Input As #1\n\n     ' -------- read from txt file to dataArrayay -------- '\n\n     i = 0\n     Do Until EOF(1)\n        ReDim Preserve dataArray(i)\n        Line Input #1, dataArray(i)\n        i = i + 1\n     Loop\n     Close #1\n\n    read_in_data_from_txt_file = dataArray\n    End Function\n</code></pre>\n\n<p>And here is the code for the pictures:</p>\n\n<pre><code>   Function Auto_Open() As String  \n\n   Dim oSlide As Slide\n   Dim oPicture As Shape\n   Dim oText As Variant\n   Dim heightScaleFactor As Single\n   Dim widthScaleFactor As Single\n   Dim width As Single\n   heightScaleFactor = 2.1\n   widthScaleFactor = 2.1\n   width = 205\n   Height = 360\n\n   ActiveWindow.View.GotoSlide 2\n\n    Set oSlide = ActiveWindow.Presentation.Slides(2)\n\n    Set oPicture = oSlide.Shapes.AddPicture(\"C:\\H5_Samples\\Plots\\WeeklyPlots\\Nominal DS Real spectra.png\", _\n        msoFalse, msoTrue, 1, 150, Height, width)\n\n\n    Set oPicture = oSlide.Shapes.AddPicture(\"C:\\H5_Samples\\Plots\\WeeklyPlots\\Nominal DS Imaginary spectra.png\", _\n        msoFalse, msoTrue, 350, 150, Height, width)\n\n    'Full Resolution\n    ActiveWindow.View.GotoSlide 3\n\n    Set oSlide = ActiveWindow.Presentation.Slides(3)\n\n    Set oPicture = oSlide.Shapes.AddPicture(\"C:\\H5_Samples\\Plots\\WeeklyPlots\\Full Resolution DS Real spectra.png\", _\n        msoFalse, msoTrue, 1, 150, Height, width)\n\n\n    Set oPicture = oSlide.Shapes.AddPicture(\"C:\\H5_Samples\\Plots\\WeeklyPlots\\Full Resolution DS Imaginary spectra.png\", _\n        msoFalse, msoTrue, 350, 150, Height, width)\n    End Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1441754067, "creation_date": 1441754067, "answer_id": 32468630, "question_id": 32468540, "link": "https://stackoverflow.com/questions/32468540/delete-values-of-cells-in-the-last-column-created/32468630#32468630", "title": "delete values of cells in the last column created", "body": "<p>Is this what you are trying?</p>\n\n<pre><code>Sub Copy_Column()\n    Dim LastCol As Integer\n    Dim NewCol As String\n\n    With Worksheets(\"BO_Corretora\")\n        LastCol = .Cells(4, .Columns.Count).End(xlToLeft).Column\n        .Columns(LastCol).Copy\n        .Columns(LastCol + 1).PasteSpecial Paste:=xlPasteFormats\n        .Columns(LastCol + 1).PasteSpecial Paste:=xlPasteFormulas\n\n        '~~&gt; Get the Column Letter of the new column\n        NewCol = Split(.Cells(, LastCol + 1).Address, \"$\")(1)\n\n        '~~&gt; Range would be like Range(\"A6:A24,A56:A78\")\n        .Range(NewCol &amp; \"6:\" &amp; NewCol &amp; \"24,\" &amp; _\n               NewCol &amp; \"56:\" &amp; NewCol &amp; \"78\").ClearContents\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 2348519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f961678f77483097d179f18be290cb72?s=128&d=identicon&r=PG", "display_name": "RobDogNZ", "link": "https://stackoverflow.com/users/2348519/robdognz"}, "is_accepted": false, "score": 1, "last_activity_date": 1441757924, "creation_date": 1441757924, "answer_id": 32469102, "question_id": 32468540, "link": "https://stackoverflow.com/questions/32468540/delete-values-of-cells-in-the-last-column-created/32469102#32469102", "title": "delete values of cells in the last column created", "body": "<p>You could use <code>intersect</code>.  This keeps the rows to be deleted easy to read and you could store them in a constant for easy editing if required.</p>\n\n<pre><code>Sub Copy_Column()\n    Dim LastCol As Integer\n    Dim NewCol As String\n\n    With Worksheets(\"BO_Corretora\")\n        LastCol = .Cells(4, .Columns.Count).End(xlToLeft).Column\n        .Columns(LastCol).Copy\n        .Columns(LastCol + 1).PasteSpecial Paste:=xlPasteFormats\n        .Columns(LastCol + 1).PasteSpecial Paste:=xlPasteFormulas\n\n        Intersect(.Columns(LastCol + 1), .Range(\"6:24,56:78\")).ClearContents\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 4738768, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/dcf8048dcb33cc94c43150b813a1d15f?s=128&d=identicon&r=PG&f=1", "display_name": "user7004", "link": "https://stackoverflow.com/users/4738768/user7004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1441767404, "creation_date": 1441753358, "last_edit_date": 1531161705, "question_id": 32468540, "link": "https://stackoverflow.com/questions/32468540/delete-values-of-cells-in-the-last-column-created", "title": "delete values of cells in the last column created", "body": "<p>I have been working on a code that copy the last column and insert a new one, copying its formula and format. However, I need to delete the values of the cells from row <code>6</code> to <code>24</code> and then from <code>56</code> to <code>78</code> in the new column created. I couldn't find a way to refer to those cells in order to delete their values, could anyone help me on this? My code is below:</p>\n\n<pre><code>Sub Copy_Column()\n   Dim LastCol As Integer\n   With Worksheets(\"BO_Corretora\")\n       LastCol = .Cells(4, .Columns.Count).End(xlToLeft).Column\n       Columns(LastCol).Copy\n       Columns(LastCol + 1).PasteSpecial Paste:=xlPasteFormats\n       Columns(LastCol + 1).PasteSpecial Paste:=xlPasteFormulas\n   End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 16874, "user_id": 3743222, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/12f03e5bb18f6cc77efaa8eb7193d5dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3743222", "link": "https://stackoverflow.com/users/3743222/user3743222"}, "is_accepted": false, "score": 0, "last_activity_date": 1441758251, "creation_date": 1441758251, "answer_id": 32469132, "question_id": 32468515, "link": "https://stackoverflow.com/questions/32468515/how-do-i-count-occurrences-of-a-property-value-in-a-collection/32469132#32469132", "title": "How do I count occurrences of a property value in a collection?", "body": "<p>You described well the two possibilities that you have:</p>\n\n<ol>\n<li>Loop over your collection every time you need the count</li>\n<li>Precompute the statistics, and access it when needed</li>\n</ol>\n\n<p>This is a common choice one often has to do. I think here it is between performance vs. complexity.</p>\n\n<p>Option 1 with a naive loop implementation will take you an O(n) time, where n is the size of your collection. And, unless your collection is static, you will have to compute it everytime you need your statistics. On the bright side, the naive looping is fairly trivial to write. Performance on frequent queries and/or large collections could suffer.</p>\n\n<p>Option 2 is fast for retrieval, O(1) basically. But everytime your collection changes, you need to recompute your statistics. However this is incremental recomputing, i.e. you do not have to go through the whole collection but just over the changed items. But that means you need to deal with all the possibilities of updates (new item, deleted item, updated items). So that's a bit more complex than the naive loop. Now if your collections are entirely new all the time, and you query them only once, you have little to gain here.</p>\n\n<p>So up to you to decide where to tradeoff according to the parameters of your problems.</p>\n"}], "owner": {"reputation": 63, "user_id": 5313490, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/fb41bf86b2e9d43dc56b2fdd5898095c?s=128&d=identicon&r=PG&f=1", "display_name": "S Barry", "link": "https://stackoverflow.com/users/5313490/s-barry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1441758251, "creation_date": 1441753134, "question_id": 32468515, "link": "https://stackoverflow.com/questions/32468515/how-do-i-count-occurrences-of-a-property-value-in-a-collection", "title": "How do I count occurrences of a property value in a collection?", "body": "<p>I have some data that I arrange into a collection of custom class objects.</p>\n\n<p>Each object has a couple of properties aside from its unique name, which I will refer to as <code>batch</code> and <code>exists</code></p>\n\n<p>There are many objects in my collection, but only a few possible values of <code>batch</code> (although the number of possibilities is not pre-defined). </p>\n\n<p>What is the easiest way to count occurrences of each possible value of <code>batch</code>?</p>\n\n<p>Ultimately I want to create a userform something like this (values are arbitrary, for illustration):</p>\n\n<pre><code>Batch A  25 parts  (2 missing)\nBatch B  17 parts\nBatch C  16 parts  (1 missing)\n</code></pre>\n\n<p>One of my ideas was to make a custom \"batch\" class, which would have properties <code>.count</code> and <code>.existcount</code> and create a collection of those objects.  </p>\n\n<p>I want to know if there is a simpler, more straightforward way to count these values.  Should I scrap the idea of a secondary collection and just create some loops and counter variables when I generate my userform? </p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5314763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f4305980932c887260761559d3e608?s=128&d=identicon&r=PG&f=1", "display_name": "JD R", "link": "https://stackoverflow.com/users/5314763/jd-r"}, "edited": false, "score": 0, "creation_date": 1441813556, "post_id": 32475027, "comment_id": 52828810, "body": "Thanks for the response! That did create a chart for me in the proper dimensions. However, I simply want to change the height of a chart that already exists. I have to have specific formatting for my bar chart, and so I can&#39;t just create a new one. Is this even simpler?"}, {"owner": {"reputation": 3, "user_id": 5314763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f4305980932c887260761559d3e608?s=128&d=identicon&r=PG&f=1", "display_name": "JD R", "link": "https://stackoverflow.com/users/5314763/jd-r"}, "edited": false, "score": 0, "creation_date": 1441813847, "post_id": 32475027, "comment_id": 52829035, "body": "Sorry, don&#39;t think I mentioned: I also need it to automatically resize. I know I tried just using worksheet_open and worksheet_change, neither of which  have given me any luck."}, {"owner": {"reputation": 226, "user_id": 3664754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2cda4b82993a659ee7779a46e3a146?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas N.", "link": "https://stackoverflow.com/users/3664754/andreas-n"}, "reply_to_user": {"reputation": 3, "user_id": 5314763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f4305980932c887260761559d3e608?s=128&d=identicon&r=PG&f=1", "display_name": "JD R", "link": "https://stackoverflow.com/users/5314763/jd-r"}, "edited": false, "score": 0, "creation_date": 1441881979, "post_id": 32475027, "comment_id": 52858895, "body": "Added an edit with a modification to the code that updates an existing chart, when the pivot is updated"}], "tags": [], "owner": {"reputation": 226, "user_id": 3664754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2cda4b82993a659ee7779a46e3a146?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas N.", "link": "https://stackoverflow.com/users/3664754/andreas-n"}, "is_accepted": true, "score": 1, "last_activity_date": 1441881915, "last_edit_date": 1525816150, "creation_date": 1441788588, "answer_id": 32475027, "question_id": 32468511, "link": "https://stackoverflow.com/questions/32468511/change-height-of-pivotchart-to-match-height-of-pivottable/32475027#32475027", "title": "Change Height of PivotChart to match height of PivotTable", "body": "<p>One way to do it, is to use a range object to size your chart like so:</p>\n\n<pre><code>Sub test()\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Worksheets(\"Summary\")\n    Dim vPiv As PivotTable\n    Dim vRowCount As Long\n    Dim graphSizer As Range\n    Dim theChart As ChartObject\n\n    Set vPiv = ws.PivotTables(\"IdleSummary\")\n    vRowCount = ws.Range(vPiv.TableRange2.Address).Rows.Count + 3\n    Set graphSizer = ws.Range(\"D3:J\" &amp; vRowCount)\n\n    Set theChart = ws.ChartObjects.Add(Left:=graphSizer.Left, Top:=graphSizer.Top, Width:=graphSizer.Width, Height:=graphSizer.Height)\n    With theChart.Chart\n        .SetSourceData vPiv.TableRange2\n        .ChartType = xlArea 'replace with desired chartType\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>EDIT, to answer comments:\nModifying the above code, and using the worksheet PivotTableUpdate event you could do like so:</p>\n\n<pre><code>Private Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)\n\n    If Target.Name = \"IdleSummary\" Then\n        Call Resize\n    End If\n\nEnd Sub\n\nSub Resize()\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Worksheets(\"Summary\")\n    Dim vPiv As PivotTable\n    Dim vRowCount As Long\n    Dim graphSizer As Range\n    Dim theChart As ChartObject\n    Dim charObj As ChartObject\n\n    Set vPiv = ws.PivotTables(\"IdleSummary\")\n    vRowCount = ws.Range(vPiv.TableRange2.Address).Rows.Count + 3\n    Set graphSizer = ws.Range(\"D3:J\" &amp; vRowCount)\n\n    Set theChart = ws.ChartObjects(1)\n    With theChart.Chart.Parent\n        .Left = graphSizer.Left\n        .Top = graphSizer.Top\n        .Width = graphSizer.Width\n        .Height = graphSizer.Height\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>This is assuming you have just one chart, else you can replace the index (1) with the chart name, e.g. (\"Chart 1\"). If you interested in reading about events you can find an introduction here: <a href=\"http://www.cpearson.com/excel/Events.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/Events.aspx</a></p>\n"}], "owner": {"reputation": 3, "user_id": 5314763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67f4305980932c887260761559d3e608?s=128&d=identicon&r=PG&f=1", "display_name": "JD R", "link": "https://stackoverflow.com/users/5314763/jd-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 725, "favorite_count": 0, "accepted_answer_id": 32475027, "answer_count": 1, "score": -1, "last_activity_date": 1441881915, "creation_date": 1441753064, "last_edit_date": 1495540685, "question_id": 32468511, "link": "https://stackoverflow.com/questions/32468511/change-height-of-pivotchart-to-match-height-of-pivottable", "title": "Change Height of PivotChart to match height of PivotTable", "body": "<p>I work heavily with PivotCharts, but have absolutely zero VBA experience. I have excel templates that are uploaded to a database, then can be downloaded as a report with the data from that database. I have a pivotTable/PivotChart combo on one sheet. Sometimes the table has 5 rows of data, and sometimes is has 1200 rows of data, depending on the database, timeframe, etc. </p>\n\n<p>What I'd like to do, is have the chart take up the same number of rows as the table  + 3 in height, and always display in D3:J3 for width and starting position. This aligns the data with the charts.</p>\n\n<p>I have found a similar ? from last year here: <a href=\"https://stackoverflow.com/questions/26180486/resize-pivot-chart-when-selecting-different-less-more-values\">Resize pivot chart when selecting different less/more values</a></p>\n\n<p>It has not gotten me any results (or I'm doing something wrong).</p>\n\n<p>Relevant info: table/chart is on Sheet4 (\"Summary\"), and under PivotTable Options, it is called \"IdleSummary\".</p>\n\n<p>I appreciate any help that can be given, thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1441782552, "post_id": 32467982, "comment_id": 52807178, "body": "Do you have any error values in the cells?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1441831924, "post_id": 32467982, "comment_id": 52838430, "body": "Updating your Post to change the question to address a new error exposed by a given answer is not how this site works.  I&#39;ve rolled back to the previous version.  If you still need help, ask a new (good quality) question, although in this case you already have the anser in the link Sid gave you"}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 5188702, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/86edd035a7a436b0b6c815dd86ad81b7?s=128&d=identicon&r=PG&f=1", "display_name": "Errorum", "link": "https://stackoverflow.com/users/5188702/errorum"}, "edited": false, "score": 0, "creation_date": 1441751664, "post_id": 32468189, "comment_id": 52798421, "body": "Still getting that same error, this time debugger highlights:      Case &quot;BHPL&quot;, &quot;CAISO&quot;,..."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 213, "user_id": 5188702, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/86edd035a7a436b0b6c815dd86ad81b7?s=128&d=identicon&r=PG&f=1", "display_name": "Errorum", "link": "https://stackoverflow.com/users/5188702/errorum"}, "edited": false, "score": 0, "creation_date": 1441751714, "post_id": 32468189, "comment_id": 52798439, "body": "I hope you removed those extra DOTS in the end? They are for demonstration puprpose"}, {"owner": {"reputation": 213, "user_id": 5188702, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/86edd035a7a436b0b6c815dd86ad81b7?s=128&d=identicon&r=PG&f=1", "display_name": "Errorum", "link": "https://stackoverflow.com/users/5188702/errorum"}, "edited": false, "score": 0, "creation_date": 1441752562, "post_id": 32468189, "comment_id": 52798671, "body": "Give me a little credit; I didn&#39;t include your dots, haha.  I may work on removing the selection if I get it working, but my priority is getting this macro to work first, before worrying about reusability.  I replaced my cell=selection parts with your if statement, and everything else is identical... same problem, same place :("}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 213, "user_id": 5188702, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/86edd035a7a436b0b6c815dd86ad81b7?s=128&d=identicon&r=PG&f=1", "display_name": "Errorum", "link": "https://stackoverflow.com/users/5188702/errorum"}, "edited": false, "score": 0, "creation_date": 1441752725, "post_id": 32468189, "comment_id": 52798710, "body": "Can you please update your question with the current code that you are using?"}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1441758112, "post_id": 32468189, "comment_id": 52800045, "body": "In this case where <code>source</code> is a whole column the <code>For Each cell In source</code> returns the whole column into <code>Cell</code>.  Use <code>For Each cell In source.Cells</code> instead.  Also worth noting this will take a <i>long</i> time to run.  Reduce the <code>source</code> range to used cells only (and once this is done the <code>.Cells</code> is no longer needed)."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1441779719, "post_id": 32468189, "comment_id": 52805725, "body": "@chrisneilsen: Long Time No See! :) Yeah that is a good point. I am still waiting for the user to come back on the basic errors first"}, {"owner": {"reputation": 213, "user_id": 5188702, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/86edd035a7a436b0b6c815dd86ad81b7?s=128&d=identicon&r=PG&f=1", "display_name": "Errorum", "link": "https://stackoverflow.com/users/5188702/errorum"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1441820092, "post_id": 32468189, "comment_id": 52832684, "body": "@chrisneilsen: You were right, adding the .cells made the type mismatch go away, and it was super slow.  However, it seemed to just delete rows at random.  Some were the ones I specified, others were those I wanted to keep.  Any more ideas?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1441820767, "post_id": 32468189, "comment_id": 52832993, "body": "The answer to your question is &quot;Did you see the first link in my answer above on how to delete the rows?&quot; You are still deleting the rows from top to down."}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 0, "last_activity_date": 1441751673, "last_edit_date": 1495542121, "creation_date": 1441750889, "answer_id": 32468189, "question_id": 32467982, "link": "https://stackoverflow.com/questions/32467982/type-mismatch-on-range-selection/32468189#32468189", "title": "Type Mismatch on range= selection", "body": "<p>Your IF Cond is incorrect.</p>\n\n<p>You can't write it as <code>If cell.Value = \"BHPL\" Or \"CAISO\"...</code></p>\n\n<p>Use this</p>\n\n<pre><code>If cell.Value = \"BHPL\" Or cell.Value = \"CAISO\" Or '..And So On..\n</code></pre>\n\n<p>Better still use a Select Case</p>\n\n<pre><code>Select Case cell.Value\n    Case \"BHPL\", \"CAISO\", \"CECD\"  '..And So On..\n    Case Else\n        cell.EntireRow.Delete\nEnd Select\n</code></pre>\n\n<p>As far as actual deleting is concerned, delete in a reverse loop or use a temp range as shown <a href=\"https://stackoverflow.com/questions/9379673/excel-vba-delete-empty-rows\">HERE</a></p>\n\n<p><strong>Edit</strong></p>\n\n<p>Another suggestion</p>\n\n<p>When ever you are using the <code>Selection</code> object as shown below</p>\n\n<pre><code>Set cell = Selection\n</code></pre>\n\n<p>It is better to check if it is a range.</p>\n\n<pre><code>'~~&gt; Check if what the user selected is a valid range\nIf TypeName(Selection) &lt;&gt; \"Range\" Then\n    MsgBox \"Select a range first.\"\n    Exit Sub\nElse\n    Set cell = Selection\nEnd If\n</code></pre>\n\n<p>Better still. Avoid the use of <code>Selection</code>. You may want to see <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">THIS</a></p>\n"}], "owner": {"reputation": 213, "user_id": 5188702, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/86edd035a7a436b0b6c815dd86ad81b7?s=128&d=identicon&r=PG&f=1", "display_name": "Errorum", "link": "https://stackoverflow.com/users/5188702/errorum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 676, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1441833262, "creation_date": 1441749760, "last_edit_date": 1531161705, "question_id": 32467982, "link": "https://stackoverflow.com/questions/32467982/type-mismatch-on-range-selection", "title": "Type Mismatch on range= selection", "body": "<p>I'm running a fairly simple code and getting runtime error 13 (type mismatch).  I've run macros similar to this many times before and I'm not sure what's causing this.</p>\n\n<pre><code>    Private Sub CommandButton21_Click()\nDim source As Range, source2 As Range, ICCP As Range, ICCP2 As Range, Devtype As Range, Devtype2 As Range, cell As Range, cell2 As Range, destination As Range, i As Long, j As Long\n\n\nSet source = Sheet2.Columns(1)\nSet source2 = Sheet3.Columns(1)\nSet ICCP = Sheet2.Columns(2)\nSet ICCP2 = Sheet3.Columns(2)\nSet Devtype = Sheet2.Columns(4)\nSet Devtype2 = Sheet3.Columns(4)\n\n\nIf TypeName(Selection) &lt;&gt; \"Range\" Then\n    MsgBox \"Select a range first.\"\n    Exit Sub\nElse\n    Set cell = Selection\nEnd If\nIf TypeName(Selection) &lt;&gt; \"Range\" Then\n    MsgBox \"Select a range first.\"\n    Exit Sub\nElse\n    Set cell2 = Selection\nEnd If\n\nSet destination = Sheet1.Columns(1)\n\nFor Each cell In source\nSelect Case cell.Value\nCase \"BHPL\", \"CAISO\", \"CECD\", \"CFE\", \"CSU\", \"EPE\", \"FEUS\", \"HHWP\", \"IID\", \"PNW\", \"POPD\", \"PRPA\", \"PSCO\", \"ROSA\", \"ROSP\", \"SCE\", \"SDGE\", \"SRSG\", \"SWTC\", \"TEP\", \"TSGT\", \"VEA\", \"WALC\"\nCase Else\ncell.EntireRow.Delete\nEnd Select\nNext cell\n\nFor Each cell2 In source2\nSelect Case cell2.Value\nCase \"BHPL\", \"CAISO\", \"CECD\", \"CFE\", \"CSU\", \"EPE\", \"FEUS\", \"HHWP\", \"IID\", \"PNW\", \"POPD\", \"PRPA\", \"PSCO\", \"ROSA\", \"ROSP\", \"SCE\", \"SDGE\", \"SRSG\", \"SWTC\", \"TEP\", \"TSGT\", \"VEA\", \"WALC\"\nCase Else\ncell.EntireRow.Delete\nEnd Select\nNext cell2\n End Sub\n</code></pre>\n\n<p>That's the updated code, debugger is catching it at this line:</p>\n\n<pre><code>Case \"BHPL\",...\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "edited": false, "score": 0, "creation_date": 1441747506, "post_id": 32467436, "comment_id": 52796975, "body": "Perhaps I am missing something, but does <a href=\"https://support.office.com/en-nz/article/Split-names-by-using-the-Convert-Text-to-Columns-Wizard-2cd989db-2b1f-4d89-b17b-534250ff9905\" rel=\"nofollow noreferrer\">Text to Columns</a> not help?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 4913, "user_id": 2280567, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LA8CO.jpg?s=128&g=1", "display_name": "Ioannis", "link": "https://stackoverflow.com/users/2280567/ioannis"}, "edited": false, "score": 0, "creation_date": 1441747631, "post_id": 32467436, "comment_id": 52797026, "body": "@loannis - I&#39;ve tried that too. I&#39;ll update my OP with my full procedure, to prevent any <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY Problem</a> issues."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1441748200, "post_id": 32467436, "comment_id": 52797257, "body": "How about <code>Replace(Replace(Selection, &quot; &quot;, &quot;&quot;), &quot;,&quot;, &quot;.&quot;) * -1 * -1</code>?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1441764168, "post_id": 32467436, "comment_id": 52801456, "body": "What type of file is this Excel sheet?  If it is truly Excel (e.g. xls, xls?) the values, if numeric, should just convert to using the separators on your machine.  However, if those values are text, then some will convert and some won&#39;t, leaving you with a mess.  If the sheet is a .csv file, then you need to import the file, and use the text import wizard to convert the numbers before Excel has a chance to munge things up."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1441811975, "post_id": 32467436, "comment_id": 52827714, "body": "@RonRosenfeld - it&#39;s .xlsx."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1441813259, "post_id": 32467436, "comment_id": 52828607, "body": "Then at least some of the values are probably text. After running the conversion macro, I would check to be sure that the new values are what you require. Some may have  been converted improperly from your perspective, if Excel initially saw them as a number."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1441813737, "post_id": 32467436, "comment_id": 52828951, "body": "@RonRosenfeld - will do, thanks for pointing that out!"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441812231, "post_id": 32468149, "comment_id": 52827910, "body": "Not quite - the decimals in the list are correct, but the commas should also be decimals."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441836090, "post_id": 32468149, "comment_id": 52840264, "body": "Change the first empty double quotes to have a full stop in"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1441750681, "creation_date": 1441750681, "answer_id": 32468149, "question_id": 32467436, "link": "https://stackoverflow.com/questions/32467436/including-a-decimal-in-a-string-not-working/32468149#32468149", "title": "Including a decimal in a string not working", "body": "<p>Does this work for you?</p>\n\n<pre><code>=VALUE(SUBSTITUTE(SUBSTITUTE(A1,\",\",\"\"),\" \",\"\"))\n</code></pre>\n\n<p>Substitute spaces and commas with nothing then convert to a value <code>1 293 99.90</code> returned as <code>129399.9</code> for me:</p>\n\n<pre><code>18890           18890\n18 644          18644\n19 264          19264\n19 318.02       19318.02\n19 113,6        191136\n7 407,75        740775\n17 988,75       1798875\n14 456          14456\n19.168          19.168\n18 922          18922\n19 504,5        195045\n18 310,29375    1831029375\n1 293 99.90     129399.9\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441812223, "post_id": 32468309, "comment_id": 52827906, "body": "Tried - if <code>14 456</code> is in A1, putting this in B1, <code>=14  456+0</code> won&#39;t work, I get the error that the formula I typed contains an error.  Thanks though."}], "tags": [], "owner": {"reputation": 95, "user_id": 5144853, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/25ea020cb02ece23fd13550233d48139?s=128&d=identicon&r=PG&f=1", "display_name": "Panthersfball234", "link": "https://stackoverflow.com/users/5144853/panthersfball234"}, "is_accepted": false, "score": 0, "last_activity_date": 1441751603, "creation_date": 1441751603, "answer_id": 32468309, "question_id": 32467436, "link": "https://stackoverflow.com/questions/32467436/including-a-decimal-in-a-string-not-working/32468309#32468309", "title": "Including a decimal in a string not working", "body": "<p>try =(field)+0 in the raw file</p>\n"}, {"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441812444, "post_id": 32468424, "comment_id": 52828052, "body": "&quot;Your <code>k</code> variable is not a string...` - Ahaha, D&#39;oh! I don&#39;t know how I missed that...time to break out my <a href=\"https://en.wikipedia.org/wiki/Rubber_duck_debugging\" rel=\"nofollow noreferrer\">rubber ducky</a>.  Thanks for the sub too, I&#39;ll check that out and see if it works.  Why use an array though?  Couldn&#39;t you just do <code>for i = 1 to ubound(v) &#47;&#47; s = Cells(i,1)</code>?  Also, <code>val()</code> is pretty neat, haven&#39;t seen that before!  (Also, why does <code>?Ubound([a1:a12])</code> give a type mismatch error in the Immediate Window?"}, {"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1441812721, "post_id": 32468424, "comment_id": 52828239, "body": "I always try to minimize the number of times I ask VBA to pierce the boundary between VBA and Excel. Doing so is expensive... as in it is not efficient. So getting all of the cell values with one call to an array is cheap. I process each array element entirely on the VBA side. When done, write them all back to the worksheet in one go. Again, cheap. Two total calls across the boundary instead of two calls for every cell!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441813708, "post_id": 32468424, "comment_id": 52828928, "body": "Ahhh, great explanation - thanks! I&#39;ll have to start trying to do that as well..."}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": true, "score": 1, "last_activity_date": 1441752380, "creation_date": 1441752380, "answer_id": 32468424, "question_id": 32467436, "link": "https://stackoverflow.com/questions/32467436/including-a-decimal-in-a-string-not-working/32468424#32468424", "title": "Including a decimal in a string not working", "body": "<p>Your <code>k</code> variable is not a string, so you will never be able to concatenate a decimal character to it. It is a Long.</p>\n\n<p>Here's a squib I put together for you to convert the numbers. I just hard coded the ranges for the example of what to do with the strings. You can use whatever technique you like for the real ranges.</p>\n\n<pre><code>Public Sub ConvertNumbers2US()\n    Dim i&amp;, s$, v\n    v = [a1:a12]\n    For i = 1 To UBound(v)\n        s = v(i, 1)\n        s = Replace(s, Chr$(160), \"\")\n        s = Replace(s, \" \", \"\")\n        s = Replace(s, \".\", \"\")\n        s = Replace(s, \",\", \".\")\n        v(i, 1) = Val(s)\n    Next\n    [b1:b12] = v\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 32468424, "answer_count": 3, "score": 0, "last_activity_date": 1441752380, "creation_date": 1441747241, "last_edit_date": 1531161705, "question_id": 32467436, "link": "https://stackoverflow.com/questions/32467436/including-a-decimal-in-a-string-not-working", "title": "Including a decimal in a string not working", "body": "<p>I have an excel sheet I get from someone in Europe, so the number formats are funky:</p>\n\n<pre><code>18890.00\n18\u00a0644\n19\u00a0264\n19\u00a0318\n19\u00a0113,6\n7\u00a0407,75\n17\u00a0988,75\n14\u00a0456\n19.168\n18\u00a0922\n19\u00a0504,5\n18\u00a0310,29375\n</code></pre>\n\n<p>(a screenshot <a href=\"http://i.imgur.com/iq5Mzs5.jpg\" rel=\"nofollow\">here</a>, just for your visual delight)</p>\n\n<p>Note: that's in column \"H\" (so it's all one column, multiple rows).  You <em>cannot</em> add these as numbers, or use math (doing <code>=Sum(H1:H2)</code> returns a <code>#VALUE</code> error).  The first number is formatted like I need - however, all the ones after that aren't.  You'll notice there's a space in them, the decimal marker is a comma, and the thousands separator is a decimal.  (I'm aware that this is standard EUR format). Using \"text to columns\" and choosing \"Text\" data format, then \"Advanced\" and telling it the decimal separator is a space, and the thousands is a decimal, does nothing -- the numbers stay the same.</p>\n\n<p>So, to fix this, I have a macro that uses each cell as a string, then removes the spaces and such (note: using find/replace on <code>\" \"</code> doesn't work on its own).  It works great when the numbers have no decimals.  However, when it hits a number with a decimal, it doesn't include it.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub format_Worksheet()\nDim cel as Range, rng as Range\nSet rng = (\"A1:A10\")\n\nFor each cel in rng\n     cel.value = Change_Weight_to_Proper_Numbers(cel.value)\nnext cel\n\nEnd Sub\n</code></pre>\n\n<p>and the function:</p>\n\n<pre><code>Private Function Change_Weight_to_Proper_Numbers(val As String)\nDim cel As Range\nDim str$, slice$\nDim i&amp;, k&amp;\n\nFor i = 1 To Len(val)\n    slice = Mid(val, i, 1)\n    Debug.Print slice\n    If slice &lt;&gt; \"\u00a0\" And slice &lt;&gt; \",\" And slice &lt;&gt; \".\" Then\n        k = k &amp; slice\n    End If\n    If slice = \",\" Or slice = \".\" Then\n        k = k &amp; \".\"  '  HERE! This line DOES run, but there's no decimal added to the string??\n    End If\n    Debug.Print \"So far you have: \" &amp; k\nNext i\n\nDebug.Print Trim(k)\n\nChange_Weight_to_Proper_Numbers = Trim(k)\n\nEnd Function\n</code></pre>\n\n<p>Again, this works fine when the number is, say, <code>1 293 999</code>, but doesn't when it's <code>1 293 99.90</code>.  It ignores the <code>.</code> altogether in my loop.  The line that adds the decimal runs, but the decimal doesn't get added to the string??</p>\n\n<p>Guesses as to what's happening: I think it's something to do with the <code>String</code> being viewed as an <code>integer</code> or something? (that's not right, but I don't know how to say it)...I thought a string could take any character, hence my use of <code>String</code>.  Should I instead change this to be a <code>Long</code> or <code>Double</code>?  </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 315, "user_id": 4912881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32fc9d1c2e83fbc05c18da2653e580dd?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4912881/helloworld"}, "edited": false, "score": 0, "creation_date": 1441748818, "post_id": 32467755, "comment_id": 52797493, "body": "Brilliant! Thank you for the fast answer. May you explain the <code>&lt;&gt;</code>? Thanks"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 315, "user_id": 4912881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32fc9d1c2e83fbc05c18da2653e580dd?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4912881/helloworld"}, "edited": false, "score": 0, "creation_date": 1441748845, "post_id": 32467755, "comment_id": 52797504, "body": "Glad to be of help :)"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 3, "last_activity_date": 1441748715, "creation_date": 1441748715, "answer_id": 32467755, "question_id": 32467406, "link": "https://stackoverflow.com/questions/32467406/merging-two-columns-but-only-certain-cells/32467755#32467755", "title": "Merging two columns but only certain cells?", "body": "<p>No Need for VBA. Put this formula in Cell <code>C1</code></p>\n\n<pre><code>=IF(B1&lt;&gt;\"\",B1,A1)\n</code></pre>\n\n<p>and drag it down. Next Do this. </p>\n\n<ol>\n<li>Copy Column C and Paste Special Values on Column C it self.</li>\n<li>Delete Col A and Col B</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/gYOoo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gYOoo.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 315, "user_id": 4912881, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32fc9d1c2e83fbc05c18da2653e580dd?s=128&d=identicon&r=PG&f=1", "display_name": "HelloWorld", "link": "https://stackoverflow.com/users/4912881/helloworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 32467755, "answer_count": 1, "score": 2, "last_activity_date": 1441748715, "creation_date": 1441747120, "question_id": 32467406, "link": "https://stackoverflow.com/questions/32467406/merging-two-columns-but-only-certain-cells", "title": "Merging two columns but only certain cells?", "body": "<p>Consider a CSV that contains images within a directory. Now for whatever reason, some file names end up in column A and some end up in column B. I'm using command prompt <code>dir &gt; foo.csv</code> in a directory to retrieve a list of files.</p>\n\n<p>So it ends up as something like:</p>\n\n<pre><code>   A           B\n\n203 foo.jpg\n204 bar.jpg\n205          345 baz.jpg\n206          346 foo1.jpg\n204 bar1.jpg\n</code></pre>\n\n<p>So I need to merge cell A &amp; B but only where the image is missing (in column A). It's important that the number in column A be replaced by the number in column B (because I use text to columns after to split the number/file name). </p>\n\n<p>I couldn't figure out a way after an hour besides manually copy/pasting which I refuse to do. It seems simple enough maybe I need another pair of eyes because I can't figure it out.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1701, "user_id": 340322, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8ddb7e050630225704ee5b628235c5f5?s=128&d=identicon&r=PG", "display_name": "Fabiano Francesconi", "link": "https://stackoverflow.com/users/340322/fabiano-francesconi"}, "edited": false, "score": 1, "creation_date": 1441748600, "post_id": 32467275, "comment_id": 52797416, "body": "What problem has your code? Where did you get stuck? Can you elaborate more?"}], "answers": [{"tags": [], "owner": {"reputation": 339, "user_id": 5042263, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4GD2iGS817g/AAAAAAAAAAI/AAAAAAAAAd4/o-nfiJZs8Us/photo.jpg?sz=128", "display_name": "Clint Street", "link": "https://stackoverflow.com/users/5042263/clint-street"}, "is_accepted": true, "score": 0, "last_activity_date": 1441751934, "creation_date": 1441751934, "answer_id": 32468359, "question_id": 32467275, "link": "https://stackoverflow.com/questions/32467275/dynamic-ranges-in-two-workbooks/32468359#32468359", "title": "Dynamic Ranges in two workbooks", "body": "<p>This is quite easily done if you use the following module code to find the  last row that is not blank:</p>\n\n<pre><code>Function FindLastRowNotBlank(ByRef ws As Worksheet, ByRef firstRow As Long, _ \nByRef column As Long) As Long\nDim lastRow As Long\nlastRow = firstRow\nIf ws.Cells(lastRow, column).Value &lt;&gt; \"\" Then\n    Do While ws.Cells(lastRow, column).Value &lt;&gt; \"\"\n        lastRow = lastRow + 1\n    Loop\n    FindLastRowNotBlank = lastRow - 1 'the last entry is the blank row so needs to subtract 1 from the result\nElse\n    FindLastRowNotBlank = 0 'Returns 0 if the firstRow is empty\n    Exit Function\nEnd If\nEnd Function\n</code></pre>\n\n<p>Then you can use the number obtained in your code like this:</p>\n\n<pre><code>Sub InspectionCheck()\n\nDim colI_Cell As Range\nDim colI_Range As Range\nDim rngLookupRange As Range\nDim rngFound As Range\nDim rngInspected As Range\nDim FileName As Variant\nDim wb As Workbook\nDim i as Long, rngStr as String\n\ni = FindLastRowNotBlank(ActiveSheet, 2,1) 'I have added this\nrngStr = \"A2:A\" &amp; i 'I have added this\nSet colI_Range = ActiveSheet.Range(rngStr).Cells 'I have modified this\nFileName = Application.GetOpenFilename(filefilter:=\"Excel Files(*.xlsx),*.xlsx\")\n\nSet wb = Workbooks.Open(FileName)\n\ni = FindLastRowNotBlank(wb.Worksheets(\"yoursheetnamehere\"), 2,5) 'I have added this you need to fill in the worksheet name\nrngStr = \"E2:E\" &amp; i 'I have added this\nSet rngLookupRange = wb.Worksheets(\"owssvr\").Range(rngStr) ' I have modified this\nThisWorkbook.Activate\n\nFor Each colI_Cell In colI_Range\nWith rngLookupRange\n  Set rngFound = .Find(What:=colI_Cell.Value, LookIn:=xlValues, LookAt:=xlWhole)\nIf Not rngFound Is Nothing Then\n    colI_Cell.Offset(0, 1) = \"Yes\"\nElse: colI_Cell.Offset(0, 1) = \"No\"\n\nEnd If\nEnd With\nNext\n\n\nSet rngLookupRange = Nothing\nwb.Close False\nSet wb = Nothing\nSet colI_Range = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Let me know how it works. Thanks,\nClint</p>\n"}], "owner": {"reputation": 13, "user_id": 5314570, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3cae79c6aa53b3b4409b4a9c6d9111c?s=128&d=identicon&r=PG&f=1", "display_name": "matt1133", "link": "https://stackoverflow.com/users/5314570/matt1133"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 32468359, "answer_count": 1, "score": 0, "last_activity_date": 1441751934, "creation_date": 1441746551, "last_edit_date": 1441751038, "question_id": 32467275, "link": "https://stackoverflow.com/questions/32467275/dynamic-ranges-in-two-workbooks", "title": "Dynamic Ranges in two workbooks", "body": "<p>I am trying to compare a column in a master sheet to a column in sheet that is being opened via a request box. I would like the ranges to be dynamic compared to what I have currently in the code. In the master sheet I would like for it to look a column A starting in cell A2 and go to the last entry and in the opened sheet it should look at column E starting in cell C2 and go to the last entry. Code I am currently using is below:</p>\n\n<pre><code>Sub InspectionCheck()\n\n Dim colI_Cell As Range\n Dim colI_Range As Range\n Dim rngLookupRange As Range\n Dim rngFound As Range\n Dim rngInspected As Range\n Dim FileName As Variant\n Dim wb As Workbook\n\nSet colI_Range = ActiveSheet.Range(\"A2:A350\").Cells\nFileName = Application.GetOpenFilename(filefilter:=\"Excel Files(*.xlsx),*.xlsx\")\nSet wb = Workbooks.Open(FileName)\n\nSet rngLookupRange = wb.Worksheets(\"owssvr\").Range(\"E2:E350\")\nThisWorkbook.Activate\n\nFor Each colI_Cell In colI_Range\nWith rngLookupRange\n  Set rngFound = .Find(What:=colI_Cell.Value, LookIn:=xlValues, LookAt:=xlWhole)\n  If Not rngFound Is Nothing Then\n   colI_Cell.Offset(0, 1) = \"Yes\"\n  Else: colI_Cell.Offset(0, 1) = \"No\"\n\n  End If\nEnd With\nNext\n\n\nSet rngLookupRange = Nothing\nwb.Close False\nSet wb = Nothing\nSet colI_Range = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "formatting", "underline", "vba"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1441756165, "post_id": 32467579, "comment_id": 52799627, "body": "Thank you very much for helping me Siddharth. That code is very nice and is almost perfect. the only issue is that it only selects the first &quot;<i>&quot;. The &quot;</i>&quot; shows up multiple times in col q at random intervals. everything else is perfect. Thanks again and hopefully its just a minor change.  As for the orginal code it was many pieces of many  unsuccessful google searches. Thanks for the tips. I used them in the rest of the macro that this is a part of"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1441803242, "post_id": 32467579, "comment_id": 52821047, "body": "Thank you, the code is now perfect and does exactly.What I want. I&#39;ll ask you the same question I did in the other answer that worked. Is there anyway to make this macro always on. so that as soon as the * is typed the underline appears?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "reply_to_user": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1441803335, "post_id": 32467579, "comment_id": 52821116, "body": "<a href=\"http://stackoverflow.com/questions/13860894/ms-excel-crashes-when-vba-code-runs/13861640#13861640\">THIS</a> will get you started. If you are stuck then feel free to ask a new question. Hope I have answered your main query here?"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1441888530, "post_id": 32467579, "comment_id": 52863364, "body": "I added the code found on that link but it doesn&#39;t appear to run the code all the time. I dont know if I need to unlink the macro from the button I created or if I need to insert the autrun code and the underline code into a new module. I&#39;ll try again in a bit and let you know"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": true, "score": 1, "last_activity_date": 1441779574, "last_edit_date": 1441779574, "creation_date": 1441747919, "answer_id": 32467579, "question_id": 32467231, "link": "https://stackoverflow.com/questions/32467231/macro-double-underline-range-if-col-q/32467579#32467579", "title": "Macro double underline range if col q = *", "body": "<p>Is this what you are trying? I have commented the code so you shouldn't have a problem understanding it. If you still do or you get an error, simply let me know :)</p>\n\n<pre><code>Sub Reformat()\n    Dim rng As Range\n    Dim aCell As Range, bCell As Range\n    Dim ws As Worksheet\n    Dim lRow As Long\n\n    '~~&gt; Change as applicable. Do not use Activesheet.\n    '~~&gt; The Activesheet may not be the sheet you think\n    '~~&gt; is active when the macro runs\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n\n    With ws\n        '~~&gt; Find last row in Col Q\n        lRow = .Range(\"Q\" &amp; .Rows.Count).End(xlUp).Row\n\n        '~~&gt; Set your Find Range\n        Set rng = .Range(\"Q5:Q\" &amp; lRow)\n\n        '~~&gt; Find (When searching for \"*\" after add \"~\" before it.\n        Set aCell = rng.Find(What:=\"~\" &amp; .Range(\"AK2\"), LookIn:=xlFormulas, _\n                    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                    MatchCase:=False, SearchFormat:=False)\n\n        If Not aCell Is Nothing Then\n            Set bCell = aCell\n\n            '~~&gt; Create the necessary border that you are creating\n            With .Range(\"A\" &amp; aCell.Row &amp; \":AF\" &amp; aCell.Row).Borders(xlEdgeBottom)\n                .LineStyle = xlDouble\n                .ThemeColor = 4\n                .TintAndShade = 0.399945066682943\n                .Weight = xlThick\n            End With\n\n            Do\n                Set aCell = rng.FindNext(After:=aCell)\n\n                If Not aCell Is Nothing Then\n                    If aCell.Address = bCell.Address Then Exit Do\n\n                    '~~&gt; Create the necessary border that you are creating\n                    With .Range(\"A\" &amp; aCell.Row &amp; \":AF\" &amp; aCell.Row).Borders(xlEdgeBottom)\n                        .LineStyle = xlDouble\n                        .ThemeColor = 4\n                        .TintAndShade = 0.399945066682943\n                        .Weight = xlThick\n                    End With\n                Else\n                   Exit Do\n                End If\n            Loop\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>Screenshot</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/znvFk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/znvFk.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 1, "creation_date": 1441802678, "post_id": 32470229, "comment_id": 52820590, "body": "Thanks @PaulBica, this option did work almost perfectly and quite rapidly. Thank you for reminding me to use  screenupdating to speed things up. I have many cobwebs on my macro skills, thanks for the code.     If there are two * in a row sometimes the code doesn&#39;t grab the first or the second. Do I need to  modify the offset to correct this?  Also this macro may be run multiple times on the same sheet is there anyway to have this &quot;always running&quot; / as soon as * is placed in Col Q the macro will auto format that row?  Sorry for all the follow ups but I like to make things idiot proof"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1441814804, "post_id": 32470229, "comment_id": 52829733, "body": "I updated the answer to fix the issue you mentioned and to allow it to be &quot;on&quot; all the time - thanks for the feedback!"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1441888434, "post_id": 32470229, "comment_id": 52863287, "body": "I inserted a new module and input the first option you presented and it doesn&#39;t seem to be working. I&#39;ll try again after my meeting, But again thank you for the help"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1441889844, "post_id": 32470229, "comment_id": 52864266, "body": "<code>Worksheet_Change()</code> has to go in the module for the <b>sheet</b> (not a new VBA module) - so if you want to update Sheet1, open VBA module for Sheet1 (under &quot;Microsoft Excel Objects&quot;, not &quot;Modules&quot;)"}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1441904740, "post_id": 32470229, "comment_id": 52874627, "body": "That was my problem and again Thanks. The auto update is perfect now. Like I said lots of cobwebs but now this project is idiot proof for the most."}, {"owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 1, "creation_date": 1441906083, "post_id": 32470229, "comment_id": 52875328, "body": "The auto update works very well, my only issue is I run into an error if I try to clear the data on the page or use my other macro to place data on the page  &quot; runtime error 13 type mismatch &quot;          Option Explicit  Private Sub Worksheet_Change(ByVal Target As Range)      &#39;restrict the call to column Q only, and if the new value is same as cell AK2      If Target.Column = 17 And Target.Value2 = Me.Range(&quot;AK2&quot;).Value2 Then &#39;this is where the debugger highlights         &#39;showSymbol code      End If  End Sub"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "reply_to_user": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "edited": false, "score": 0, "creation_date": 1441910039, "post_id": 32470229, "comment_id": 52877499, "body": "I updated the last 2 subs to execute only when you edit one cell. Replace <code>Worksheet_Change()</code> with the latest one and try clearing the data on the page (or placing data on it)"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1441909879, "last_edit_date": 1441909879, "creation_date": 1441767500, "answer_id": 32470229, "question_id": 32467231, "link": "https://stackoverflow.com/questions/32467231/macro-double-underline-range-if-col-q/32470229#32470229", "title": "Macro double underline range if col q = *", "body": "<p>The AutoFilter version:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub showSymbol()\n    Dim lRow As Long, ur As Range, fr As Range\n\n    Application.ScreenUpdating = False\n    With ActiveSheet\n        lRow = .Range(\"Q\" &amp; .Rows.Count).End(xlUp).Row\n        Set ur = .Range(\"A5:AF\" &amp; lRow)\n        Set fr = ur.Offset(1).Resize(ur.Rows.Count - 1)\n\n        ur.Columns(17).AutoFilter Field:=1, Criteria1:=\"~\" &amp; .Range(\"AK2\").Value2\n        fr.Borders(xlEdgeBottom).LineStyle = xlDouble\n        fr.Borders(xlInsideHorizontal).LineStyle = xlDouble\n        ur.AutoFilter\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>To execute it for every OnCahange event of one particular sheet add this to its VBA module:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n    With Target\n        If .CountLarge = 1 Then 'run only if one cell was updated\n\n            'restrict the call to column Q only, and if the new value is same as cell AK2\n            If .Column = 17 And .Value2 = Me.Range(\"AK2\").Value2 Then showSymbol\n\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>To execute it for all sheets in the file, add this to the VBA module for ThisWorkbook:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\n    If Target.CountLarge = 1 Then If Target.Column = 17 Then showSymbol\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 5314545, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh6.googleusercontent.com/-ioQSOathyqE/AAAAAAAAAAI/AAAAAAAAAHg/OBQbChIvN08/photo.jpg?sz=128", "display_name": "Alberto Brown", "link": "https://stackoverflow.com/users/5314545/alberto-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "accepted_answer_id": 32467579, "answer_count": 2, "score": 1, "last_activity_date": 1441909879, "creation_date": 1441746356, "last_edit_date": 1531161705, "question_id": 32467231, "link": "https://stackoverflow.com/questions/32467231/macro-double-underline-range-if-col-q", "title": "Macro double underline range if col q = *", "body": "<p>I have a question that I cant solve. The problem lies in col Q. What I want is simple:</p>\n\n<p>Scan col Q from row 5 until last row (last row value is in cell \"AL1\")\nIf there is a \"*\" (symbol is stored in cell \"AK2\") in that row of Q. \nThen double underline cells A thru AF in that row, continue scanning down until last row. </p>\n\n<pre><code>    Sub Reformat()\n\n    Dim SrchRng3 As Range\n    Dim c3 As Range, f As String\n\n   Set SrchRng3 = ActiveSheet.Range(\"Q5\",          ActiveSheet.Range(\"Q100000\").End(xlUp))\nSet c3 = SrchRng3.Find(Range(\"ak2\"), LookIn:=xlValues)\nIf Not c3 Is Nothing Then\n    f = c3.Address\n    Do\n        With ActiveSheet.Range(\"A\" &amp; c3.Row &amp; \":AF\" &amp; c3.Row)\n        Range(\"A\" &amp; c3.Row &amp; \":AF\" &amp; c3.Row).Select\n                .Borders (xlEdgeBottom)\n                .LineStyle = xlDouble\n                .ThemeColor = 4\n                .TintAndShade = 0.399945066682943\n                .Weight = xlThick\n        End With\n        Set c3 = SrchRng3.FindNext(c3)\n    Loop While c3.Address &lt;&gt; f\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1441745900, "post_id": 32467057, "comment_id": 52796229, "body": "Do a filter on column A for blanks then delete? Depending on how many rows and your memory, could still take minutes but considerably less than 16 hours XD"}, {"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "reply_to_user": {"reputation": 2871, "user_id": 4971065, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3f544b76d9c90389498351c861a134c5?s=128&d=identicon&r=PG&f=1", "display_name": "findwindow", "link": "https://stackoverflow.com/users/4971065/findwindow"}, "edited": false, "score": 0, "creation_date": 1441746234, "post_id": 32467057, "comment_id": 52796399, "body": "Okay, so I think I could work out a filter, but then what is the VBA command to select all non-hidden cells? Even if I filter first, If I say &quot;Select all&quot;, wont it delete everything?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441746278, "post_id": 32467057, "comment_id": 52796432, "body": "<a href=\"http://excelribbon.tips.net/T008524_Selecting_Visible_Cells_in_a_Macro.html\" rel=\"nofollow noreferrer\">To select just the visible cells from a range of selected cells, you can use the following line of code: <code>Selection.SpecialCells(xlCellTypeVisible).Select</code></a>"}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1441746305, "post_id": 32467057, "comment_id": 52796440, "body": "why do you always have to fill to the bottom of the sheet?  Can&#39;t you just fill down as far as the data?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 0, "creation_date": 1441746593, "post_id": 32467057, "comment_id": 52796584, "body": "Filter the column on blanks and then delete it. See <a href=\"http://stackoverflow.com/questions/11317172/delete-row-based-on-condition/11317372#11317372\">This</a> Simply use the criteria as <code>Criteria1:=&quot;=&quot;</code> for blanks"}, {"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1441746726, "post_id": 32467057, "comment_id": 52796633, "body": "@aucuparia If you can do that, I do not know how. I looked and did not find a method to make an autofill automatically know how many rows of data there actually are."}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1441746797, "post_id": 32467057, "comment_id": 52796667, "body": "are you using VBA to fill in the formulae?"}, {"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "edited": false, "score": 0, "creation_date": 1441746890, "post_id": 32467057, "comment_id": 52796702, "body": "Yes, VBA is doing everything. Im taking a command line DIR export and trying to format that in a way that is conducive for non-technical resources to work with. There are just under 100 transformations in the process to get to the file format that is being asked for. Needed to macro it so it took 45 minutes instead of 2 days to do a file."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "edited": false, "score": 0, "creation_date": 1441842535, "post_id": 32468205, "comment_id": 52842236, "body": "Just to round back, you are my hero. I marked as answered because the theory made sense to me, but I just got around to trying to put it into practice. This is EXACTLY what I needed. I knew Excel was smart enough to do it. I also knew I wasnt :)"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 0, "last_activity_date": 1441750957, "creation_date": 1441750957, "answer_id": 32468205, "question_id": 32467057, "link": "https://stackoverflow.com/questions/32467057/using-vba-to-delete-rows/32468205#32468205", "title": "Using VBA to delete &quot;&quot; rows", "body": "<p>Something like this should do it in one go:</p>\n\n<pre><code>Range(\"E2:E\" &amp; Range(\"A\" &amp; Rows.count).end(xlup).row).formula = \"=IF(B2=\"\"\"\",\"\"\"\",CONCATENATE(B2,C2)\"\n</code></pre>\n\n<p>I have made the following assumptions:</p>\n\n<p>You want the formula in column E, change here if not: <code>Range(\"E2:E\"</code></p>\n\n<p>Column A has data all the way down to where you want the formula, change here if not: <code>&amp; Range(\"A\"</code></p>\n\n<p>Excel is smart enough to increment this formula as it posts it to a range, no need to fill down after filling in just one cell.</p>\n"}], "owner": {"reputation": 173, "user_id": 2989297, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/628a99d3db020096dd08168e37273c10?s=128&d=identicon&r=PG&f=1", "display_name": "user2989297", "link": "https://stackoverflow.com/users/2989297/user2989297"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 32468205, "answer_count": 1, "score": 0, "last_activity_date": 1441750957, "creation_date": 1441745634, "last_edit_date": 1441746508, "question_id": 32467057, "link": "https://stackoverflow.com/questions/32467057/using-vba-to-delete-rows", "title": "Using VBA to delete &quot;&quot; rows", "body": "<p>I have a giant macro. Because the macro needs to be applied to datasets ranging for 1 to 200,000 rows, there are a lot of steps where I use an =IF formula where one of the outputs is \"\". Ex: </p>\n\n<pre><code>=IF(B2=\"\",\"\",CONCATENATE(B2,C2)\n</code></pre>\n\n<p>These formulas are then autofilled to the bottom of the worksheet. Since \"\" is not a true blank, the files at the end of the output end up being at least 80 mb each, when some could be 10kb.</p>\n\n<p>I can trim the file again if I export to CSV, change the file extension to txt, open in notepad, and delete all of the rows consisting of nothing but commas, then re-importing the txt file back into Excel, but that requires me to do the extension changing and comma deleting manually, which gets very time consuming.</p>\n\n<p>Does anyone have any tricks (like a substitute for \"\" that leave behind a true blank after a paste values, or a command that can delete all rows where A = \"\" that wont take 16 hours to run, evaluating and deleting each of the 1.54 million rows individually)?</p>\n"}, {"tags": ["sql", "vba", "ms-access", "oracle-sqldeveloper", "pass-through"], "comments": [{"owner": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "edited": false, "score": 0, "creation_date": 1441962093, "post_id": 32466679, "comment_id": 52896794, "body": "Have you checked that the connect string works? Try replacing your sql statement with a simple SELECT statement to verify the connection string is working OK."}, {"owner": {"reputation": 11, "user_id": 5314127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03a6f94907b458ac905719a7f7b127f?s=128&d=identicon&r=PG&f=1", "display_name": "SSampat", "link": "https://stackoverflow.com/users/5314127/ssampat"}, "reply_to_user": {"reputation": 710, "user_id": 5021236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16637c5be814c194e7dde84f653d36d7?s=128&d=identicon&r=PG&f=1", "display_name": "jhTuppeny", "link": "https://stackoverflow.com/users/5021236/jhtuppeny"}, "edited": false, "score": 0, "creation_date": 1441985069, "post_id": 32466679, "comment_id": 52911805, "body": "Thanks for your response. The connection string is fine and a simpler SQL query also works fine. The issue was with the ODBC connection getting timed out. I&#39;ve posted the answer below."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5314127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03a6f94907b458ac905719a7f7b127f?s=128&d=identicon&r=PG&f=1", "display_name": "SSampat", "link": "https://stackoverflow.com/users/5314127/ssampat"}, "is_accepted": true, "score": 0, "last_activity_date": 1441984890, "creation_date": 1441984890, "answer_id": 32526897, "question_id": 32466679, "link": "https://stackoverflow.com/questions/32466679/access-vba-to-import-oracle-table-odbc-call-failed/32526897#32526897", "title": "Access VBA to Import Oracle Table: ODBC--Call Failed", "body": "<p>I was able to solve this error. Just copy the below code into your error handler and it will give you a more detailed description of the ODBC--Call Failed error</p>\n\n<pre><code>'DAO Error Handler\nDim MyError As Error\nDebug.print Errors.Count\nFor Each MyError In DBEngine.Errors\nWith MyError\nMsgBox .Number &amp; \" \" &amp; .Description\nEnd With\nNext MyError\n</code></pre>\n\n<p>This told me that my ODBC connection was being timed out due to the large size of the SQL query. Just follow the steps in the link below to resolve the error.</p>\n\n<p><a href=\"http://its.uiowa.edu/support/article/101855\" rel=\"nofollow\">http://its.uiowa.edu/support/article/101855</a></p>\n"}], "owner": {"reputation": 11, "user_id": 5314127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a03a6f94907b458ac905719a7f7b127f?s=128&d=identicon&r=PG&f=1", "display_name": "SSampat", "link": "https://stackoverflow.com/users/5314127/ssampat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "accepted_answer_id": 32526897, "answer_count": 1, "score": 1, "last_activity_date": 1594643681, "creation_date": 1441744134, "last_edit_date": 1594643681, "question_id": 32466679, "link": "https://stackoverflow.com/questions/32466679/access-vba-to-import-oracle-table-odbc-call-failed", "title": "Access VBA to Import Oracle Table: ODBC--Call Failed", "body": "<p>I have written a VBA code in Access 2007 to run a SQL query on Oracle and insert results in an Access table using a Pass-Through query. I am getting the following error: \"<em>ODBC--Call Failed</em>\". Below is the code:</p>\n\n<pre><code>If TableExists(\"\" &amp; TblName) = True Then DoCmd.DeleteObject acTable, TblName\n\nCurrentDb.Execute \"CREATE TABLE \" &amp; TblName &amp; \"(Merch_Nbr Text, Month_End_Date Text, Passer Text, PasserMonth Text, Volume Long, DiscountRevenue Long)\"\n\n'Create a Pass through query to extract MID List from Oracle table\nDim PassThruQuery As QueryDef\nIf QueryExists(\"Query_oracle\") = True Then DoCmd.DeleteObject acQuery, \"Query_oracle\"\nSet PassThruQuery = CurrentDb.CreateQueryDef(\"Query_oracle\")\n\n'SQL query to be executed on Oracle database\nsql_stmt = \"SELECT M.MERCH_NBR as Merch_Nbr,CM.MONTH_END_DATE as Month_End_Date,PSR.PASSER as Passer,PSR.MONTH as PasserMonth,sum(F.MERCH_BILLED_ASSESSMENTS) as Assessments,\"\nsql_stmt = sql_stmt &amp; \"sum(F.SALES_VOLUME-F.RETURNS_VOLUME) as Volume,sum(F.DISCOUNT_REVENUE) as DiscountRevenue \"\nsql_stmt = sql_stmt &amp; \"FROM WH_TARGET.RPSI_MONETARY_FACT F,WH_TARGET.RPSI_MERCHANT_DIM M,WH_TARGET.RPSI_CARD_TYPE_CHARGE_TYPE_DIM CT\"\nsql_stmt = sql_stmt &amp; \",WH_TARGET.RPSI_PRICING_CATEGORY_DIM PC,WH_TARGET.RPSI_CALENDAR_MONTH_DIM CM,WH_TARGET.RPSI_BACK_END_VENDOR_DIM BEV\"\nsql_stmt = sql_stmt &amp; \",WH_TARGET.RPSI_SALES_GROUP_DIM SG_H,WH_TARGET.RPSI_SALES_REP_DIM SR_H,WH_TARGET.RPSI_AGENT_BANK_DIM AB_H\"\nsql_stmt = sql_stmt &amp; \",WH_TARGET.RPSI_ASSOCIATION_DIM ASSC_H,WH_TARGET.RPSI_SALES_GROUP_DIM SG_C,WH_TARGET.RPSI_SALES_REP_DIM SR_C\"\nsql_stmt = sql_stmt &amp; \",WH_TARGET.RPSI_AGENT_BANK_DIM AB_C,WH_TARGET.RPSI_ASSOCIATION_DIM ASSC_C,dw_biz.portfolio_mgmt PSR \"\nsql_stmt = sql_stmt &amp; \"WHERE Month_End_Date &gt;= '01-OCT-2014' AND PSR.MONTH = '01-JAN-2015' \"\nsql_stmt = sql_stmt &amp; \"AND psr.TYPE = 'MON' AND CT.CARD_TYPE in ('1','2','5') AND PSR.MID = M.MERCH_NBR \"\nsql_stmt = sql_stmt &amp; \"AND F.MERCHANT_SID_FK = M.MERCHANT_SID_PK AND F.CARD_TYPE_CHARGE_TYPE_SID_FK = CT.CARD_TYPE_CHARGE_TYPE_SID_PK \"\nsql_stmt = sql_stmt &amp; \"AND F.PRICING_CATEGORY_SID_FK = PC.PRICING_CATEGORY_SID_PK AND F.CALENDAR_MONTH_SID_FK = CM.CALENDAR_MONTH_SID_PK \"\nsql_stmt = sql_stmt &amp; \"AND F.BACK_END_VENDOR_SID_FK = BEV.BACK_END_VENDOR_SID_PK AND F.SALES_GROUP_SID_FK = SG_H.SALES_GROUP_SID_PK \"\nsql_stmt = sql_stmt &amp; \"AND F.SALES_REP_SID_FK = SR_H.SALES_REP_SID_PK AND F.AGENT_BANK_SID_FK = AB_H.AGENT_BANK_SID_PK \"\nsql_stmt = sql_stmt &amp; \"AND F.ASSOCIATION_SID_FK = ASSC_H.ASSOCIATION_SID_PK AND M.SALES_GROUP_SID_FK = SG_C.SALES_GROUP_SID_PK \"\nsql_stmt = sql_stmt &amp; \"AND M.SALES_REP_SID_FK = SR_C.SALES_REP_SID_PK AND M.AGENT_BANK_SID_FK = AB_C.AGENT_BANK_SID_PK \"\nsql_stmt = sql_stmt &amp; \"AND M.ASSOCIATION_SID_FK = ASSC_C.ASSOCIATION_SID_PK \"\nsql_stmt = sql_stmt &amp; \"GROUP BY M.MERCH_NBR,CM.MONTH_END_DATE,PSR.PASSER,PSR.MONTH\"\n\n\nPassThruQuery.SQL = sql_stmt\n\nPassThruQuery.Connect = \"ODBC;DSN=RDW1;UID=dw_biz;PWD=dw_biz\"\nPassThruQuery.ReturnsRecords = True\n\n'Insert the Query results into Access Table\nCurrentDb.Execute \"INSERT INTO \" &amp; TblName &amp; \"(Merch_Nbr, Month_End_Date, Passer, PasserMonth, Volume, DiscountRevenue) \" &amp; _\n\"SELECT Query_oracle.Merch_Nbr, Query_oracle.Month_End_Date, Query_oracle.Passer, Query_oracle.PasserMonth, Query_oracle.Volume, Query_oracle.DiscountRevenue  From Query_oracle;\"\n\n\nExit Sub\n</code></pre>\n\n<p>I exported this query to a text file and ran it on Oracle, it is running fine! Also, I created a temp table on Oracle with the above SQL query and replaced sql_stmt in VBA with \"select * from new_oracle_table\". Strangely, this seems to be working fine as well. Do you think it's something to do with the length of the SQL query in sql_stmt itself? Any ideas on how to fix this would be greatly appreciated.</p>\n\n<p>-SS</p>\n"}, {"tags": ["vba", "visio"], "answers": [{"tags": [], "owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "is_accepted": true, "score": 2, "last_activity_date": 1441848735, "creation_date": 1441848735, "answer_id": 32491642, "question_id": 32466535, "link": "https://stackoverflow.com/questions/32466535/vba-add-connection-points-to-a-shape/32491642#32491642", "title": "VBA add connection points to a shape", "body": "<p>You add connection points by adding rows to the shape's connection points section (visSectionConnectionPts).\nCode would look like:</p>\n\n<pre><code>Dim NewRow as Integer\nNewRow = shp1.AddRow( visSectionConnectionPts , visRowLast, visTagDefault)\nshp1.CellsSRC( visSectionConnectionPts, NewRow, visX).formula = \"Width*0.5\"\nshp1.CellsSRC( visSectionConnectionPts, NewRow, visY).formula = \"Height*0.5\"\n</code></pre>\n\n<p>This code adds a new connection point to shp1, and sets the point in the center of the shape.</p>\n"}], "owner": {"reputation": 387, "user_id": 1951756, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9a7d01d222449cc30000c1d35bcb876?s=128&d=identicon&r=PG", "display_name": "user1951756", "link": "https://stackoverflow.com/users/1951756/user1951756"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2678, "favorite_count": 0, "accepted_answer_id": 32491642, "answer_count": 1, "score": 1, "last_activity_date": 1441848735, "creation_date": 1441743507, "question_id": 32466535, "link": "https://stackoverflow.com/questions/32466535/vba-add-connection-points-to-a-shape", "title": "VBA add connection points to a shape", "body": "<p>How do I add connection points to a shape? </p>\n\n<p>I began this project adding regular rectangles to the page and using AutoConnect to connect them which worked perfectly because each connection created a new connection point on the rectangle. When I switched to rounded rectangles new connection points were not created and the connectors ended up overlapping each other. </p>\n\n<p>I add rounded rectangles like this...</p>\n\n<pre><code>        Application.ActiveWindow.Page.Drop Application.Documents.Item(\"BASIC_U.VSS\").Masters.ItemU(\"Rounded rectangle\"), 0, 0\n</code></pre>\n\n<p>I AutoConnect like this...</p>\n\n<pre><code>        Dim vsoConnectorShape As Visio.Shape\n        Set vsoConnectorShape = Visio.ActivePage.Shapes(\"Dynamic connector\")\n        vsoConnectorShape.CellsU(\"LineColor\").Formula = \"rgb(\" + CStr(red) + \", \" + CStr(green) + \", \" + CStr(blue) + \")\"\n\n        shp1.AutoConnect shp2, visAutoConnectDirNone, vsoConnectorShape\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1441743155, "post_id": 32466385, "comment_id": 52794886, "body": "Also this: <code>For i = 2 To i = 254 Step 1</code> should be: <code>For i = 2 To 254 Step 1</code> (though the Step 1 is optional)"}, {"owner": {"reputation": 6311, "user_id": 5073840, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yRIIb.jpg?s=128&g=1", "display_name": "MatthewD", "link": "https://stackoverflow.com/users/5073840/matthewd"}, "edited": false, "score": 1, "creation_date": 1441743249, "post_id": 32466385, "comment_id": 52794941, "body": "If you place the words &quot;Option Explicit&quot; at the very top of your form or module you will be able to stay away from some of these issues. It will tell you when things are not right."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5314450, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-T46EWk8zT_Q/AAAAAAAAAAI/AAAAAAAAADo/3o1qK8uxtj8/photo.jpg?sz=128", "display_name": "Ben Lanier", "link": "https://stackoverflow.com/users/5314450/ben-lanier"}, "edited": false, "score": 0, "creation_date": 1441744924, "post_id": 32466437, "comment_id": 52795721, "body": "I updated the code to this  Sub GetTickers1()  Set WS = ThisWorkbook.Worksheets(&quot;Sheet1&quot;)   Dim i As Integer  For i = 2 To 254 Step 1    Set WS.Cells(i, 2) = Left(Right(&quot;&quot; + WS.Cells(i, 1), 5), 4)  Next i  End Sub  but now it just gives me run time error 424 on the 5th line"}, {"owner": {"reputation": 13, "user_id": 5314450, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-T46EWk8zT_Q/AAAAAAAAAAI/AAAAAAAAADo/3o1qK8uxtj8/photo.jpg?sz=128", "display_name": "Ben Lanier", "link": "https://stackoverflow.com/users/5314450/ben-lanier"}, "edited": false, "score": 0, "creation_date": 1441745344, "post_id": 32466437, "comment_id": 52795972, "body": "This is my code nowSub GetTickers1()  Set WS = ThisWorkbook.Worksheets(&quot;Sheet1&quot;)   Dim i As Integer  For i = 2 To 254 Step 1    Set WS.Cells(i, 2) = Left(Right(&quot;&quot; + WS.Cells(i, 1), 5), 4)  Next i  End Sub"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1441743082, "creation_date": 1441743082, "answer_id": 32466437, "question_id": 32466385, "link": "https://stackoverflow.com/questions/32466385/run-time-error-9-out-of-range-error-438-error-1009/32466437#32466437", "title": "Run time error 9, out of range, error 438, error 1009", "body": "<p>You need to use <strong>Set</strong> in the first line.</p>\n"}, {"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 7, "last_activity_date": 1441758297, "last_edit_date": 1441758297, "creation_date": 1441743107, "answer_id": 32466442, "question_id": 32466385, "link": "https://stackoverflow.com/questions/32466385/run-time-error-9-out-of-range-error-438-error-1009/32466442#32466442", "title": "Run time error 9, out of range, error 438, error 1009", "body": "<p>This code was never working (at least not as it is currently written). </p>\n\n<p>The very first line cannot execute without the <code>Set</code> keyword and will raise the 438 error.  </p>\n\n<p>If you rectify that error, then you can expect a 1009 error if either:</p>\n\n<ul>\n<li>The workbook specified on the right-side of that statement isn't open in the current active instance of Excel Application</li>\n<li>The worksheet specified on the right-side of that statement doesn't exist within the workbook specified.</li>\n</ul>\n\n<p>For your 424 error, while you can sometimes rely on an object's <em>default property</em> while (e.g., <code>Debug.Print Range(\"A1\")</code> will print the <code>.Value</code>), an assignment statement doesn't automatically assign to the default property, so you'll have to specify: <code>WS.Cells(i, 2).Value = ...</code> Also, I'm not sure what you were trying to do with the <code>\"\" +</code> but that could causing a type mismatch -- read up on whether it's preferable to use the <code>+</code> or <code>&amp;</code> operator for concatenating strings -- both are allowable, but the <code>+</code> can get you in trouble sometimes, so revised as:</p>\n\n<pre><code>WS.Cells(i, 2).Value = Left(Right(WS.Cells(i, 1), 5), 4)\n</code></pre>\n\n<p>NB also that your <code>For i = 2 To i = 254 Step 1</code> will not do anything. Try instead <code>For i = 2 to 254</code>.  A step of 1 is always implied unless otherwise specified, so you don't need to explicitly do <code>Step 1</code>.</p>\n"}], "owner": {"reputation": 13, "user_id": 5314450, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh4.googleusercontent.com/-T46EWk8zT_Q/AAAAAAAAAAI/AAAAAAAAADo/3o1qK8uxtj8/photo.jpg?sz=128", "display_name": "Ben Lanier", "link": "https://stackoverflow.com/users/5314450/ben-lanier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 32466442, "answer_count": 2, "score": 0, "last_activity_date": 1441758297, "creation_date": 1441742839, "last_edit_date": 1531164843, "question_id": 32466385, "link": "https://stackoverflow.com/questions/32466385/run-time-error-9-out-of-range-error-438-error-1009", "title": "Run time error 9, out of range, error 438, error 1009", "body": "<p>My excel VBA code keeps giving me errors. I was running a lot of code perfectly fine a few days ago. Now I am working on new code, and it is not working!</p>\n\n<p>some errors it gives me include </p>\n\n<pre><code>Run time error 9, out of range\nerror 438\nerror 1009\n</code></pre>\n\n<p>I think something is wrong, that does not necessarily have to do with the code</p>\n\n<pre><code>Sub GetTickers1()\n\n    WS = Workbooks(\"Ticker Symbols for Rodman and Renshaw Conference 2015\").Worksheets(\"Sheet1\")\n\n    Dim i As Integer\n\n    For i = 2 To i = 254 Step 1\n\n\n\n    WS.Cells(i, 2) = Left(Right(\"\" + WS.Cells(i, 1), 5), 4)\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["macos", "vba", "excel"], "comments": [{"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441740669, "post_id": 32465674, "comment_id": 52793492, "body": "Check <code>findFirstEmptyRow</code> for <code>Application.ScreenUpdating = True</code> (or the Workbook_Open() sub)"}, {"owner": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441741790, "post_id": 32465674, "comment_id": 52794059, "body": "Paul, findFirstEmptyRow row does not have that line. I don&#39;t have a Workbook_Open() sub."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1441742542, "post_id": 32465674, "comment_id": 52794531, "body": "Check if there is a <code>Workbook_Open</code> event in <code>library.xlsm</code> which may be setting <code>Application.ScreenUpdating = False</code>"}, {"owner": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "edited": false, "score": 0, "creation_date": 1441743218, "post_id": 32465674, "comment_id": 52794916, "body": "Again, there is no Workbook_Open event that I know of. I certainly didn&#39;t create one. Further when I checked the ThisWorkbook module in VBA, I didn&#39;t find any code there. Also, wouldn&#39;t you want that function to contain the line <code>Application.ScreenUpdating = False</code> if it wasn&#39;t already? Second, Shouldn&#39;t <code>Application.EnableEvents = False</code> automatically block the event <code>Workbook_Open()</code> event?"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "edited": false, "score": 0, "creation_date": 1441744880, "post_id": 32466804, "comment_id": 52795706, "body": "While I&#39;m fine with experimenting with different Add-Ins, if you have a recommendation for one that suits well, it would be awesome. Also, any chance you know what the difference is between <a href=\"http://stackoverflow.com/questions/11469215/vba-to-add-new-sheet-in-a-closed-excel-without-opening-get-the-sheet-name-adde\">link</a> and my own situation is in regards to the answer by Alistair Weir?"}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "reply_to_user": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "edited": false, "score": 0, "creation_date": 1441745204, "post_id": 32466804, "comment_id": 52795879, "body": "What I&#39;m saying is create your own add-in.  I&#39;m not talking about an add-in  for you to get, you can save your VBA code as an .xla or .xlam from the saveas drop down list.  Excel will default save it to your add-ins directory.  Add this newly created add-in to your add-in references and away you go."}], "tags": [], "owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "is_accepted": true, "score": 2, "last_activity_date": 1441744885, "last_edit_date": 1441744885, "creation_date": 1441744591, "answer_id": 32466804, "question_id": 32465674, "link": "https://stackoverflow.com/questions/32465674/screenupdating-not-working-when-opening-a-file/32466804#32466804", "title": "ScreenUpdating not working when opening a file", "body": "<p>Setting ScreenUpdating to false only prevents spreadsheet updates from showing. It wont on its own hide the opening of a workbook.  Although there are ways to hide the opening of a workbook, or access workbook data without creating an instance of Excel, for the task you're describing of creating a VBA library, the way to go about that is to create an Excel add-in.  An add-in not only allows you to use a macro from any instance of Excel, but you can also edit your code and add new macros to a common repository from any instance also.</p>\n"}], "owner": {"reputation": 107, "user_id": 5261779, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9a2de131dc3202d4e5c9f937de39bdd0?s=128&d=identicon&r=PG&f=1", "display_name": "S. Cannon", "link": "https://stackoverflow.com/users/5261779/s-cannon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2205, "favorite_count": 0, "accepted_answer_id": 32466804, "answer_count": 1, "score": 1, "last_activity_date": 1441744885, "creation_date": 1441740317, "last_edit_date": 1441740406, "question_id": 32465674, "link": "https://stackoverflow.com/questions/32465674/screenupdating-not-working-when-opening-a-file", "title": "ScreenUpdating not working when opening a file", "body": "<p>So I'm creating a library of commonly used macros for excel for my Excel 2011 for Mac. I'm running a couple of tests to make sure it's working properly. The biggest problem I'm running into is that when I run the code (despite having ScreenUpdating set to False), it visibly opens the library file while it runs the macro.</p>\n\n<p>To make sure this is efficient going forward, I want to prevent that from happening. Here is currently what my code looks like: </p>\n\n<pre><code>Sub findRow()\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\n\nDim bk As Workbook\nDim result As Long\nDim aWB As Workbook\nDim aWS As Worksheet\nSet aWB = ActiveWorkbook\nSet aWS = ActiveWorkbook.ActiveSheet\n\nWith Application\n    .ScreenUpdating = False\n    .DisplayAlerts = False\n    .EnableEvents = False\nSet bk = .Workbooks.Open _\n(ActiveWorkbook.Path &amp; \":library.xlsm\")\n'Set bk = ActiveWorkbook.Path &amp; \":library.xlsm\"\nEnd With\n\n'Workbooks.Open (ActiveWorkbook.Path &amp; \":library.xlsm\")\n'Workbooks.Open (bk)\nresult = Application.Run(\"'\" &amp; ActiveWorkbook.Name &amp; \"'!findFirstEmptyRow\", aWS)\nActiveWorkbook.Close\nCells(result, 1) = result\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>There is quite a few redundancies in there as well as commented out lines that show various things I've tried. Originally I simply ran code that set Application.X settings to False, opened the Workbook, ran the macro, and closed. </p>\n\n<p>Hopefully someone can come up with a reason for ScreenUpdating not taking effect when I open a new Workbook. </p>\n"}, {"tags": ["image", "vba", "ms-access"], "comments": [{"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1441740183, "post_id": 32465445, "comment_id": 52793242, "body": "So are you trying to read the width and heigh from the files properties.  (The width and height are not in the filename string are they?)"}, {"owner": {"reputation": 3907, "user_id": 3791372, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xEZFO.jpg?s=128&g=1", "display_name": "user3791372", "link": "https://stackoverflow.com/users/3791372/user3791372"}, "reply_to_user": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "edited": false, "score": 0, "creation_date": 1441740282, "post_id": 32465445, "comment_id": 52793294, "body": "That&#39;s correct, I&#39;ve edited the original question to be clearer."}], "answers": [{"comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 4, "creation_date": 1538129792, "post_id": 32465724, "comment_id": 92045017, "body": "An ironic side effect of making statements like <i><code>Just try googling &quot;Use vba to read image file dimensions&quot;</code></i> is that <b>this post</b> is now the number one hit on Google, when one Googles <i>&quot;Use vba to read image file dimensions&quot;</i>.  Way to go -- you created a paradox. Now the universe is gonna implode or something..."}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 4, "last_activity_date": 1441784586, "last_edit_date": 1441784586, "creation_date": 1441740480, "answer_id": 32465724, "question_id": 32465445, "link": "https://stackoverflow.com/questions/32465445/microsoft-access-vba-determining-image-dimensions/32465724#32465724", "title": "Microsoft Access VBA - determining image dimensions", "body": "<p>Just try googling \"Use vba to read image file dimensions\"</p>\n\n<p>eg \n<a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/5f375529-a002-4312-a54b-b70d6d3eb6ae/how-to-retrieve-image-dimensions-using-vba-?forum=accessdev\" rel=\"nofollow\">https://social.msdn.microsoft.com/Forums/office/en-US/5f375529-a002-4312-a54b-b70d6d3eb6ae/how-to-retrieve-image-dimensions-using-vba-?forum=accessdev</a></p>\n\n<p>for example</p>\n\n<pre><code>Dim objShell As Object\nDim objFolder As Object\nDim objFile As Object\n\nSet objShell = CreateObject(\"Shell.Application\")\n\nSet objFolder = objShell.NameSpace(\"C:\\Documents and     Settings\\Administrator\\Desktop\")\nSet objFile = objFolder.ParseName(\"file_name.bmp\") \n\nMsgBox objFile.ExtendedProperty(\"Dimensions\")\n</code></pre>\n\n<p>You can extract what you need from the string displayed in the message box</p>\n"}, {"comments": [{"owner": {"reputation": 3907, "user_id": 3791372, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xEZFO.jpg?s=128&g=1", "display_name": "user3791372", "link": "https://stackoverflow.com/users/3791372/user3791372"}, "edited": false, "score": 0, "creation_date": 1441856774, "post_id": 32466290, "comment_id": 52845600, "body": "Thanks, instead of Find, use InStr, and it&#39;s (haystack,needle) for InStr, also I&#39;ve found the dimensions string to be something like &quot;?1024 x ?768&quot;, so I&#39;ve had to offset the sub string indexes by 1. Also to convert the string to an int, CInt(.....) did the trick. If you want to update your answer, I&#39;ll mark it as the answer"}], "tags": [], "owner": {"reputation": 8233, "user_id": 2174085, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/oMs90.jpg?s=128&g=1", "display_name": "Johnny Bones", "link": "https://stackoverflow.com/users/2174085/johnny-bones"}, "is_accepted": false, "score": 3, "last_activity_date": 1441892472, "last_edit_date": 1441892472, "creation_date": 1441742481, "answer_id": 32466290, "question_id": 32465445, "link": "https://stackoverflow.com/questions/32465445/microsoft-access-vba-determining-image-dimensions/32466290#32466290", "title": "Microsoft Access VBA - determining image dimensions", "body": "<p>You can do this:</p>\n\n<pre><code>Dim objShell As Object\nDim objFolder As Object\nDim objFile As Object\n\nSet objShell = CreateObject(\"Shell.Application\")\n\nSet objFolder = objShell.NameSpace(\"C:\\Documents and Settings\\Administrator\\Desktop\")\nSet objFile = objFolder.ParseName(\"file_name.bmp\") \n\nMsgBox objFile.ExtendedProperty(\"Dimensions\")\n</code></pre>\n\n<p>That messagebox should give you something along the lines of \"300 X 500\" (or whatever the Length X Width is).  If you need the individual dimensions, you'll need to use something like </p>\n\n<pre><code>FileLen = CInt(Trim(Mid(objFile.ExtendedProperty, 2, InStr(objFile.ExtendedProperty, \"X\") - 1)))\n</code></pre>\n\n<p>and</p>\n\n<pre><code>FileWid = CInt(Trim(Mid(objFile.ExtendedProperty, InStr(objFile.ExtendedProperty, \"X\") + 2, Len(objFile.ExtendedProperty))))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2351, "user_id": 5640342, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/mCXYH.jpg?s=128&g=1", "display_name": "ChrisB", "link": "https://stackoverflow.com/users/5640342/chrisb"}, "is_accepted": false, "score": 2, "last_activity_date": 1518487038, "creation_date": 1518487038, "answer_id": 48758361, "question_id": 32465445, "link": "https://stackoverflow.com/questions/32465445/microsoft-access-vba-determining-image-dimensions/48758361#48758361", "title": "Microsoft Access VBA - determining image dimensions", "body": "<p>You can also accomplish this with a class, which lets you use code like this:</p>\n\n<pre><code>targetImage.PixelWidth\ntargetImage.PixelHeight\n</code></pre>\n\n<ol>\n<li>Create a new Class Module and name it <code>ImageDimensions</code>.</li>\n<li>Paste the following code into that class module:</li>\n</ol>\n\n<h2>Class Module Code</h2>\n\n<pre><code>Option Explicit\n\nPrivate pPixelWidth As Long\nPrivate pPixelHeight As Long\nPrivate pImageFullPath As String\n\nPublic Property Get ImageFullPath() As String\n  ImageFullPath = pImageFullPath\nEnd Property\nPublic Property Let ImageFullPath(fullPath As String)\n  pImageFullPath = fullPath\n  Dim dimensionsText As String\n\n  dimensionsText = GetImageDimensions(fullPath)\n  pPixelWidth = Left$(dimensionsText, InStr(dimensionsText, \",\") - 1)\n  pPixelHeight = Mid$(dimensionsText, InStr(dimensionsText, \",\") + 1)\nEnd Property\n\nPublic Property Get PixelWidth() As Long\n  PixelWidth = pPixelWidth\nEnd Property\nPrivate Property Let PixelWidth(value As Long)\n  pPixelWidth = value\nEnd Property\n\nPublic Property Get PixelHeight() As Long\n  PixelHeight = pPixelHeight\nEnd Property\nPrivate Property Let PixelHeight(value As Long)\n  pPixelHeight = value\nEnd Property\n\nPrivate Function GetImageDimensions(ByVal fullPath As String)\n  Dim fileName As String\n  Dim fileFolder As String\n  fileName = FilenameFromPath(fullPath)\n  fileFolder = FolderFromFilePath(fullPath)\n\n  Dim objShell As Object\n  Set objShell = CreateObject(\"Shell.Application\")\n\n  Dim targetFolder As Object\n  Set targetFolder = objShell.Namespace(fileFolder &amp; vbNullString)\n\n  Const IMAGE_DIMENSIONS As Long = 31\n  Dim dimensionsPrep As String\n  dimensionsPrep = targetFolder.GetDetailsOf( _\n    targetFolder.Items.Item(fileName &amp; vbNullString), _\n    IMAGE_DIMENSIONS)\n\n  dimensionsPrep = Replace(dimensionsPrep, \" x \", \",\")\n  dimensionsPrep = Mid$(dimensionsPrep, 2, Len(dimensionsPrep) - 2)\n  GetImageDimensions = dimensionsPrep\nEnd Function\n\nPrivate Function FolderFromFilePath(ByVal filePath As String) As String\n  Dim filesystem As Object\n  Set filesystem = CreateObject(\"Scripting.FileSystemObject\")\n  FolderFromFilePath = filesystem.GetParentFolderName(filePath) &amp; \"\\\"\nEnd Function\n\nPrivate Function FilenameFromPath(ByVal filePathAndName As String) As String\n  Dim pathLength As Long\n  Dim iString As String\n  pathLength = Len(filePathAndName)\n  iString = vbNullString\n\n  Dim iCount As Long\n  For iCount = pathLength To 1 Step -1\n    If Mid$(filePathAndName, iCount, 1) = Application.PathSeparator Then\n      FilenameFromPath = iString\n      Exit Function\n    End If\n    iString = Mid$(filePathAndName, iCount, 1) &amp; iString\n  Next iCount\n\n  FilenameFromPath = filePathAndName\nEnd Function\n</code></pre>\n\n<h2>Example Usage</h2>\n\n<p>Put this code in a regular code module (not a class module):</p>\n\n<pre><code>Sub ExampleImageDimensions()\n  Dim targetImage As ImageDimensions\n  Set targetImage = New ImageDimensions\n  targetImage = \"C:\\Users\\ChrisB\\Downloads\\Screenshot.jpg\"\n  Debug.Print targetImage.PixelHeight\n  Debug.Print targetImage.PixelWidth\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3907, "user_id": 3791372, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xEZFO.jpg?s=128&g=1", "display_name": "user3791372", "link": "https://stackoverflow.com/users/3791372/user3791372"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4659, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1518487038, "creation_date": 1441739350, "last_edit_date": 1441740266, "question_id": 32465445, "link": "https://stackoverflow.com/questions/32465445/microsoft-access-vba-determining-image-dimensions", "title": "Microsoft Access VBA - determining image dimensions", "body": "<p>I have an Access database which has a filename field, along with width and height fields for an image. Instead of populating the width and height manually, I'm trying to read the height and width from the filename alone (full file path) and then insert into a record. </p>\n\n<p>The reading of dimensions is fairly trivial in most languages, but can't find much for Access VBA. All I can find is for Excel which assumes the image is already in the spreadsheet as an object.</p>\n"}, {"tags": ["vba", "excel", "cells"], "comments": [{"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1441739469, "post_id": 32465349, "comment_id": 52792877, "body": "I was reading <a href=\"http://stackoverflow.com/questions/17720395/access-vba-to-split-out-all-merged-cell-in-excel\">this post</a> and it seems I can access merged cell range but as my cells could be result of merging 2 or more without previously knowing it, how can I make it generic?"}, {"owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441740752, "post_id": 32465349, "comment_id": 52793535, "body": "Which one is column F Key or UUID? Also, are the merged cells always in one column?"}, {"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "reply_to_user": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "edited": false, "score": 0, "creation_date": 1441740820, "post_id": 32465349, "comment_id": 52793566, "body": "Oh yeah, didn&#39;t clarify that. F column is key&#39;s one and yes, merged cells are only in Key column"}], "answers": [{"comments": [{"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1441741669, "post_id": 32465978, "comment_id": 52794000, "body": "What is the formula method for?"}, {"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1441743074, "post_id": 32465978, "comment_id": 52794837, "body": "Not working as I should. Some additional info: Key and UUID columns are not adjacent, Key colum has an index value of 6( column #6) and uuid column of 31 so, I modified your code as per those offsets but no use. Don&#39;t know If I&#39;m doing it wrong. <code>If c.MergeCells Then c.Offset(3, 31).Formula = c.MergeArea.Cells(1, 31).Offset(0, 31).Formula Else If c.Formula = c.Offset(-1, 31).Formula Then c.Offset(0, 31).Formula = c.Offset(-1, 31).Formula End If End If Next c</code>"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 1, "creation_date": 1441743095, "post_id": 32465978, "comment_id": 52794853, "body": "Range.Formula gets/sets the formula in a cell. It can be an excel formula, e.g., <code>=PI()</code> or a constant e.g. <code>UUID</code>. If the data you&#39;re working on contains only string constants then you could also use Range.Value."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "reply_to_user": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1441743618, "post_id": 32465978, "comment_id": 52795112, "body": "For merged cells use <code>c.Offset(0, 25).Formula = c.MergeArea.Cells(1, 1).Offset(0, 25).Formula</code>. For unmerged cells use <code>c.Offset(0, 25).Formula = c.Offset(-1, 25).Formula</code>. If Keys are in column 6, offsetting by 25 columns gets you to column 31 for UUIDs"}], "tags": [], "owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "is_accepted": true, "score": 0, "last_activity_date": 1441741395, "creation_date": 1441741395, "answer_id": 32465978, "question_id": 32465349, "link": "https://stackoverflow.com/questions/32465349/check-merged-cell-and-compare-adjacent-to-set-unique-value-from-compared-cells-v/32465978#32465978", "title": "Check merged cell and compare adjacent to set unique value from compared cells values", "body": "<p>Try the following code. Note that this is going to overwrite the current contents of UUID, so make a backup copy before testing. If you don't want the UUID column modified, you can modify this to suit your needs.</p>\n\n<pre><code>Sub CopyUUID()\n    Dim lRow As Long\n    Dim rng As Range\n    Dim c As Range\n    Dim ws As Worksheet\n    Dim rMerged As Range\n    Dim value As Variant\n\n    Set ws = Sheets(ActiveSheet.Name)\n\n    On Error GoTo ExitProgram 'If an error happens within the execution, skips it and continue in next step\n    ' Application.DisplayAlerts = False 'We can cancel the procedure without errors\n\n    With ws\n        lRow = .Range(\"F\" &amp; .Rows.Count).End(xlUp).Row\n        Set rng = .Range(.Cells(3, 6), .Cells(lRow, 6))\n        ' rng.Select\n        For Each c In rng\n\n            If c.MergeCells Then\n                'Code for merged cells\n                c.Offset(0, 1).Formula = c.MergeArea.Cells(1, 1).Offset(0, 1).Formula\n            Else\n                'Code to use for single cells\n                If c.Formula = c.Offset(-1, 0).Formula Then\n                    c.Offset(0, 1).Formula = c.Offset(-1, 1).Formula\n                End If\n            End If\n        Next c\n    End With\n    ExitProgram:\n       Exit Sub\nEnd Sub\n</code></pre>\n\n<p>When in a MergedCell, it makes the UUID the same as the UUID of the first cell in the merged area. When not in a MergedCell, it copies UUID from the row above if Key is the same as the row above.</p>\n\n<p>I changed your variable <code>cell</code> to <code>c</code> (I don't like to use variable names that can be confused with built-ins) and commented out a couple of lines. </p>\n\n<p>Hope this helps</p>\n"}, {"comments": [{"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1441742403, "post_id": 32466196, "comment_id": 52794455, "body": "But I don&#39;t have any merged column. &quot;Key&quot; columns is composed of column merged cells and single cells. Besides, I don&#39;t need to unmerge them, I need to set a unique value for n different cells that are adjacent to a merged or a single cell."}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "reply_to_user": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 0, "creation_date": 1441746330, "post_id": 32466196, "comment_id": 52796454, "body": "I followed your initial image and assumed structure of cells. After going through intervening comments, perhaps it may be preferable for you to go for more customized program to suit your needs."}], "tags": [], "owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1441742132, "creation_date": 1441742132, "answer_id": 32466196, "question_id": 32465349, "link": "https://stackoverflow.com/questions/32465349/check-merged-cell-and-compare-adjacent-to-set-unique-value-from-compared-cells-v/32466196#32466196", "title": "Check merged cell and compare adjacent to set unique value from compared cells values", "body": "<p>I adopt a simple approach to this problem as illustrated through steps taken by me.</p>\n\n<ol>\n<li><p>sample sheet showing data with merged cells and unmerged cells.\n<a href=\"https://i.stack.imgur.com/u2XzV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u2XzV.jpg\" alt=\"sample data\"></a></p></li>\n<li><p>Run the program code to unmerge the cells. Output of the program is appended below.</p></li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/YbYkl.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YbYkl.jpg\" alt=\"Unmerged Sample data First stage\"></a></p>\n\n<ol start=\"3\">\n<li>If this structure of data matches your case then addition of 2 lines of code for column B will leave the data as per following image.</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/ukAQO.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ukAQO.jpg\" alt=\"unmerged data after deleting column through program code\"></a></p>\n\n<ol start=\"4\">\n<li>Program code is as follows:</li>\n</ol>\n\n<p>'Without column deletion:</p>\n\n<pre><code>Sub UnMergeRanges()\n    Dim cl As Range\n    Dim rMerged As Range\n    Dim v As Variant\n\n    For Each cl In ActiveSheet.UsedRange\n        If cl.MergeCells Then\n            Set rMerged = cl.MergeArea\n            v = rMerged.Cells(1, 1)\n            rMerged.MergeCells = False\n            rMerged = v\n        End If\n    Next\nEnd Sub\n'With coumn deletion   \nSub UnMergeRangesB()\n    Dim cl As Range\n    Dim rMerged As Range\n    Dim v As Variant\n\n    For Each cl In ActiveSheet.UsedRange\n        If cl.MergeCells Then\n            Set rMerged = cl.MergeArea\n            v = rMerged.Cells(1, 1)\n            rMerged.MergeCells = False\n            rMerged = v\n        End If\n    Next\n    Columns(\"B:B\").Select\n    Selection.Delete Shift:=xlToLeft\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "edited": false, "score": 1, "creation_date": 1441743418, "post_id": 32466433, "comment_id": 52795011, "body": "I forgot to tell, &quot;Key&quot; column is, as my example, in column F (index 6) but uuid column is at column AE (index 31)"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 1, "last_activity_date": 1441744582, "last_edit_date": 1441744582, "creation_date": 1441743059, "answer_id": 32466433, "question_id": 32465349, "link": "https://stackoverflow.com/questions/32465349/check-merged-cell-and-compare-adjacent-to-set-unique-value-from-compared-cells-v/32466433#32466433", "title": "Check merged cell and compare adjacent to set unique value from compared cells values", "body": "<pre><code>Option Explicit\n\nSub CopyUUID()\n\n    Const UUID As Long = 31 'col AE\n\n    Dim lRow As Long, cel As Range, isM As Boolean, copyID As Boolean, kCol As Long\n\n    With ActiveSheet\n        kCol = -25          'col F\n        lRow = .Cells(.Rows.Count, UUID + kCol).End(xlUp).Row\n\n        For Each cel In .Range(.Cells(3, UUID), .Cells(lRow, UUID))\n\n            isM = cel.Offset(0, kCol).MergeCells\n            copyID = isM And Len(cel.Offset(0, kCol)) = 0\n            copyID = copyID Or (Not isM And cel.Offset(0, kCol) = cel.Offset(-1, kCol))\n\n            If copyID Then cel = cel.Offset(-1)\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 255, "user_id": 2197793, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/JUPyO.png?s=128&g=1", "display_name": "Edgar Sampere", "link": "https://stackoverflow.com/users/2197793/edgar-sampere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1554, "favorite_count": 0, "accepted_answer_id": 32465978, "answer_count": 3, "score": 0, "last_activity_date": 1441744582, "creation_date": 1441738912, "last_edit_date": 1441741003, "question_id": 32465349, "link": "https://stackoverflow.com/questions/32465349/check-merged-cell-and-compare-adjacent-to-set-unique-value-from-compared-cells-v", "title": "Check merged cell and compare adjacent to set unique value from compared cells values", "body": "<p>I'm writing a macro in Excel 2010 for a problem that is as follows: <br>\nI have two columns, one with a Key string value and one with a uuid. The idea is that every key should have only one uuid but as the table is now, key cell could be merged cells or single cells.\nThe macro needs to recognize which cells are merged and which are not, so, I have two options:</p>\n\n<ul>\n<li>If cell is merged, check all its adjacent cells, pick first uuid value and copy/paste it to other adjacent cells, that is to say, cell below(Could be with an <code>Offset()</code>)</li>\n<li>If cell is not merged , but key value is repeated in multiple cells, copy/paste uuid value to adjacent cells.</li>\n</ul>\n\n<p>So basically is to check merged cells <code>MergeArea</code> but I don't know if I need to iterate through its addresses or check cells in the range with an offset of <code>Offset(0,1)</code> or what.\nWith my code I can know if the cells are merged but now, how con I iterate through it's adjacent cells values?<br></p>\n\n<p>Code as is now:<br></p>\n\n<pre><code>Sub CopyUUID()\nDim lRow As Long\nDim rng As Range\nDim ws As Worksheet\nDim rMerged As Range\nDim value As Variant\n\nSet ws = Sheets(ActiveSheet.Name)\n\nOn Error GoTo ExitProgram 'If an error happens within the execution, skips it and continue in next step\nApplication.DisplayAlerts = False 'We can cancel the procedure without errors\n\nWith ws\n    lRow = .Range(\"F\" &amp; .Rows.count).End(xlUp).row\n    Set rng = .Range(.Cells(3, 6), .Cells(lRow, 6))\n    rng.Select\n    For Each cell In rng\n        If cell.MergeCells Then\n            'Code for merged cells\n        Else\n            'Code to use for single cells\n        End If\n    Next cell\nEnd With\nExitProgram:\n   Exit Sub\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/HsLzU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HsLzU.png\" alt=\"Table Example\"></a></p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1441797750, "post_id": 32465335, "comment_id": 52817051, "body": "can the other users open the linked tables ?"}, {"owner": {"reputation": 137, "user_id": 3883612, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f20e8186c559012c683c0ee584436ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Adam44", "link": "https://stackoverflow.com/users/3883612/adam44"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1441800739, "post_id": 32465335, "comment_id": 52819166, "body": "No, they can only open the database in a sort of &#39;display mode&#39;. I&#39;ve tried doing it before on a user account with the navigation panel enabled and everything and it just doesn&#39;t load any forms."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1441801648, "post_id": 32465335, "comment_id": 52819776, "body": "I rephrase my question: do the tables properly open from the other users machines ? (if the tables don&#39;t open, don&#39;t lose time to examine the forms!)"}, {"owner": {"reputation": 137, "user_id": 3883612, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f20e8186c559012c683c0ee584436ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Adam44", "link": "https://stackoverflow.com/users/3883612/adam44"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1441802570, "post_id": 32465335, "comment_id": 52820504, "body": "The users only see the tables through subforms. Forms with bound controls just cause an error when I try to open them, and one form without bound controls opens up but doesn&#39;t display the content, just the form header. Its like any interaction with the backend tables at all causes an error."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1441803151, "post_id": 32465335, "comment_id": 52820968, "body": "that&#39;s hopeless ! (your reply)"}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 3883612, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f20e8186c559012c683c0ee584436ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Adam44", "link": "https://stackoverflow.com/users/3883612/adam44"}, "edited": false, "score": 0, "creation_date": 1441800871, "post_id": 32477943, "comment_id": 52819239, "body": "All my tables are pointing to the right place yeah, I used a UNC path to for them too as I did with the previous drive without any issues."}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 137, "user_id": 3883612, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f20e8186c559012c683c0ee584436ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Adam44", "link": "https://stackoverflow.com/users/3883612/adam44"}, "edited": false, "score": 0, "creation_date": 1441803463, "post_id": 32477943, "comment_id": 52821218, "body": "ah ok. It seems obscure but I&#39;ll keep thinking. Unfortunately, I Couldn&#39;t add a comment before as I don&#39;t have enough reputation. What are the run-time error numbers that users are getting?"}, {"owner": {"reputation": 137, "user_id": 3883612, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f20e8186c559012c683c0ee584436ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Adam44", "link": "https://stackoverflow.com/users/3883612/adam44"}, "edited": false, "score": 0, "creation_date": 1441805489, "post_id": 32477943, "comment_id": 52822708, "body": "It won&#39;t even show the error numbers, even if I use &#39;On Error goto x&#39; with &#39;MsgBox Err.Number &amp; &quot; &quot; &amp; Err.Description&#39;. It just gives the standard &#39;Execution of this application has stopped...&#39; message and closes down."}, {"owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "reply_to_user": {"reputation": 137, "user_id": 3883612, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f20e8186c559012c683c0ee584436ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Adam44", "link": "https://stackoverflow.com/users/3883612/adam44"}, "edited": false, "score": 0, "creation_date": 1441870484, "post_id": 32477943, "comment_id": 52851307, "body": "well I am stumped on this. I recently had an issue where I installed access runtime on a PC and any interaction with the backend threw back errors. It was due to the new PC not having a registry key stating that the trusted filepath/location. Don&#39;t think it is likely but worth checking your regedit to see if the new backend location is trusted?"}], "tags": [], "owner": {"reputation": 1482, "user_id": 5043393, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/effb702a40d17cd670f56f051847b33f?s=128&d=identicon&r=PG&f=1", "display_name": "LiamH", "link": "https://stackoverflow.com/users/5043393/liamh"}, "is_accepted": false, "score": 0, "last_activity_date": 1441796928, "creation_date": 1441796928, "answer_id": 32477943, "question_id": 32465335, "link": "https://stackoverflow.com/questions/32465335/ms-access-split-database-run-time-error-with-backend-in-new-drive-location/32477943#32477943", "title": "MS Access Split Database - Run time error with backend in new drive location?", "body": "<p>In the front end of your DB you may have to change the path which links to the tables. The tables are in the back end of the database, which you have now moved and therefore changed the filepath. the frontend wont find them. You can delete the table links in the front end then use <em>External data > import and Link > Access.</em> In order to re-link the tables using their new filepath. You would then need to redistribute your frontend to the users. </p>\n\n<p>I'm not sure if you have already done this, however, you haven't suggested so in your question. hope this helps, apologies if it was helpless.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 5914533, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdfbe4d78fa6367823f10790be9eea1c?s=128&d=identicon&r=PG&f=1", "display_name": "grasshopper", "link": "https://stackoverflow.com/users/5914533/grasshopper"}, "is_accepted": false, "score": 0, "last_activity_date": 1459258878, "creation_date": 1459258878, "answer_id": 36286095, "question_id": 32465335, "link": "https://stackoverflow.com/questions/32465335/ms-access-split-database-run-time-error-with-backend-in-new-drive-location/36286095#36286095", "title": "MS Access Split Database - Run time error with backend in new drive location?", "body": "<p>I hope you have found an answer to this. I wanted to answer as well, because I had the exact same problem yesterday. It turned out that the location was referring other users back to the folder's shortcut name versus it's full length name (it is called the W drive on my computer and the K drive on theirs). I solved the issue by spelling out the name in full.</p>\n"}], "owner": {"reputation": 137, "user_id": 3883612, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f20e8186c559012c683c0ee584436ddf?s=128&d=identicon&r=PG&f=1", "display_name": "Adam44", "link": "https://stackoverflow.com/users/3883612/adam44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 510, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1459258878, "creation_date": 1441738845, "question_id": 32465335, "link": "https://stackoverflow.com/questions/32465335/ms-access-split-database-run-time-error-with-backend-in-new-drive-location", "title": "MS Access Split Database - Run time error with backend in new drive location?", "body": "<p>I have an MS Access split database and I'm trying to get it to work with the backend on a new, more secure drive on our network. I've used a UNC path for the backend location.</p>\n\n<p>This database has been running without problem on another drive which is totally public to everyone in the company (~4k people, not secure) for about a year. We have a generic account for users to access the database throughout our factory and haven't encountered this problem before I tried to switch it to the new drive. I've contacted our IT department and they've given myself and all my user's accounts read/write access to the drive, but only I can run it.</p>\n\n<p>Other user accounts get these problems...</p>\n\n<ul>\n<li>All of my forms with objects bound to a table immediately throw a runtime error before even getting to Form_Load.</li>\n<li>My userforms will run DLookup functions and execute message boxes but throw a runtime error when they go to execute a query.</li>\n<li>I've tried using an 'On Error goto' to try and actually find the problem but it throws a runtime error before that.</li>\n</ul>\n\n<p>I can't think at all what the problem might be. IT have told me I have the same permissions as the other users. Any suggestions on what to do?</p>\n"}, {"tags": ["forms", "vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "edited": false, "score": 0, "creation_date": 1441738766, "post_id": 32465225, "comment_id": 52792522, "body": "Would something like <code>cbDesAccWanted.ListIndex = -1</code> work?"}], "answers": [{"comments": [{"owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "edited": false, "score": 0, "creation_date": 1441905090, "post_id": 32465345, "comment_id": 52874826, "body": "@JoeDion Did either of these solutions work in your scenario?"}], "tags": [], "owner": {"reputation": 12614, "user_id": 3566998, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S7lz6.png?s=128&g=1", "display_name": "Excel Hero", "link": "https://stackoverflow.com/users/3566998/excel-hero"}, "is_accepted": false, "score": 2, "last_activity_date": 1441738901, "creation_date": 1441738901, "answer_id": 32465345, "question_id": 32465225, "link": "https://stackoverflow.com/questions/32465225/excel-form-vba-combobox-reset/32465345#32465345", "title": "Excel Form VBA Combobox reset", "body": "<p>There are two ways to reset the combobox. Take your pick:</p>\n\n<h1>1</h1>\n\n<pre><code>cbDesAccWanted.Value = Null\n</code></pre>\n\n<h1>2</h1>\n\n<pre><code>cbDesAccWanted.ListIndex = -1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": false, "score": 0, "last_activity_date": 1441739261, "creation_date": 1441739261, "answer_id": 32465426, "question_id": 32465225, "link": "https://stackoverflow.com/questions/32465225/excel-form-vba-combobox-reset/32465426#32465426", "title": "Excel Form VBA Combobox reset", "body": "<p>the line </p>\n\n<p>cbDesAccWanted.Text = desacc</p>\n\n<p>is totally unnecessary.</p>\n\n<p>Using cbDesAccWanted_DropButtonClick is not the right place to populate the list of values.  This list should be set up when the form is first shown to the user.\n(unelss the values it shows chnages in which case change it when the row changes or something, not when the user clicks on it)</p>\n\n<p>So when theuser clicks the down arrow to move to thenext record include the following line </p>\n\n<pre><code>Me.cbDesAccWanted.text = Me.cbDesAccWanted.List(1) \n</code></pre>\n\n<p>Note (1) access teh 2nd item in the list which is No.</p>\n\n<p>So this reset it to the default value of No.</p>\n\n<p>Ok.</p>\n"}], "owner": {"reputation": 1, "user_id": 5314130, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153004227366447/picture?type=large", "display_name": "Joe Dion", "link": "https://stackoverflow.com/users/5314130/joe-dion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6497, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1441739261, "creation_date": 1441738482, "last_edit_date": 1441739140, "question_id": 32465225, "link": "https://stackoverflow.com/questions/32465225/excel-form-vba-combobox-reset", "title": "Excel Form VBA Combobox reset", "body": "<p>This should be easy but I can't seem to find anything to solve. I have a Form in Excel using VBA.  The Excel sheet has four columns populated with data and the Form displays those fields.  </p>\n\n<p>The user then selects a value in a combobox, uses a command button to submit the responses and the values from the combobox are written to the Excel sheet.</p>\n\n<p>The user then uses a command button to advance one row down in the spreadsheet and load the four values from a new row. This all works great.</p>\n\n<p>The issue I am trying to solve is that the combobox remains selected to the value in the prior selection. I'd like to reset the combobox so nothing is selected and the user has to make a selection again for the next row. </p>\n\n<p>Below is the code I am using to load the combobox and to set a variable for what the user selected.  Can't seem to get the combobox back to it's default state after the user has submitted the form.</p>\n\n<pre><code>Private Sub cbDesAccWanted_Change()\n    Select Case cbDesAccWanted.Text\n        Case \"Yes\"\n            desacc = \"Yes\"\n        Case \"No\"\n            desacc = \"No\"\n    End Select\n    cbDesAccWanted.Text = desacc\nEnd Sub\n\nPrivate Sub cbDesAccWanted_DropButtonClick()\n    cbDesAccWanted.List = Array(\"Yes\", \"No\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "forms", "vba", "checkbox"], "comments": [{"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "edited": false, "score": 0, "creation_date": 1441736512, "post_id": 32464583, "comment_id": 52791314, "body": "Did you have multiple crashes with the above code? As you stated at one point it works perfect and at the same time it crashes. Its either option A or B."}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1441736661, "post_id": 32464583, "comment_id": 52791414, "body": "Set the checkbox value = True (aka -1) OR False (aka 0)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1441740332, "post_id": 32464583, "comment_id": 52793314, "body": "Do any of the checkboxes which are being set from (eg) <code>Gate60Tb_Click</code>  also have their own event handlers?"}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 5261992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bc5f1417593b0f460429ccb95c68cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "vividillusion", "link": "https://stackoverflow.com/users/5261992/vividillusion"}, "edited": false, "score": 0, "creation_date": 1441739183, "post_id": 32465212, "comment_id": 52792721, "body": "This is a far more elegant execution definitely and will reduce my code by a couple hundred lines however I am still getting the same crash..  I am fairly new to coding and I suspect maybe it is how my full code is laid out potentially."}, {"owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "reply_to_user": {"reputation": 99, "user_id": 5261992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bc5f1417593b0f460429ccb95c68cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "vividillusion", "link": "https://stackoverflow.com/users/5261992/vividillusion"}, "edited": false, "score": 0, "creation_date": 1441739942, "post_id": 32465212, "comment_id": 52793121, "body": "I ha da play.  I tried setting locked and enable properties.  I tried using other event handlers as well.  I could not get any issues to happen. I can&#39;t help more.  All I woudl suggest is to half the nubmer of contorls (to simplyfy the probelm) and see if the error still happens.  That will at least help you narrow it down. See here: <a href=\"http://stackoverflow.com/questions/2689794/what-is-the-maximum-number-of-controls-that-a-vba-form-can-hold\" title=\"what is the maximum number of controls that a vba form can hold\">stackoverflow.com/questions/2689794/&hellip;</a>.  Which says that once you get above about 200 controls, you may start noticing some strange/intermittent occurrences/errors."}, {"owner": {"reputation": 99, "user_id": 5261992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bc5f1417593b0f460429ccb95c68cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "vividillusion", "link": "https://stackoverflow.com/users/5261992/vividillusion"}, "edited": false, "score": 0, "creation_date": 1441740925, "post_id": 32465212, "comment_id": 52793618, "body": "Hi, if you would take one moment I have put the full code in an edit on the post. Could it be that how it is all laid out in the code under the form? do i need to split it into smaller parts?"}, {"owner": {"reputation": 99, "user_id": 5261992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bc5f1417593b0f460429ccb95c68cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "vividillusion", "link": "https://stackoverflow.com/users/5261992/vividillusion"}, "edited": false, "score": 0, "creation_date": 1441741221, "post_id": 32465212, "comment_id": 52793769, "body": "i deleted half the controls as proof of concept and it seems that there is no crash occurring, so it&#39;s not ideal and i will have to review my code nonetheless but at least i know the root cause, regards!"}], "tags": [], "owner": {"reputation": 4022, "user_id": 4413676, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh6.googleusercontent.com/-voVpW4gy9dA/AAAAAAAAAAI/AAAAAAAACqY/6b-0Iza8ws8/photo.jpg?sz=128", "display_name": "HarveyFrench", "link": "https://stackoverflow.com/users/4413676/harveyfrench"}, "is_accepted": true, "score": 1, "last_activity_date": 1441740053, "last_edit_date": 1495542121, "creation_date": 1441738445, "answer_id": 32465212, "question_id": 32464583, "link": "https://stackoverflow.com/questions/32464583/checkbox-to-control-other-check-boxes-intermittently-causing-excel-to-crash/32465212#32465212", "title": "CheckBox to control other check boxes INTERMITTENTLY causing Excel to crash", "body": "<p>I have found people elsewhere that have experience of forms with many controls and they say that once you get above about 200 controls, you may start noticing some strange/intermittent occurrences/errors. </p>\n\n<p>See <a href=\"https://stackoverflow.com/questions/2689794/what-is-the-maximum-number-of-controls-that-a-vba-form-can-hold\">here</a></p>\n\n<p>I would reduce the number of controls on your form.</p>\n\n<p>Also you might simplify the code:</p>\n\n<pre><code>Private Sub Gate60Tb_Click()\n\n    '60\u00b0 Gate TickBox Control\n\n    Me.W1T60.Value = Me.Gate60Tb.Value\n\n    Me.W2T60.Value = Me.Gate60Tb.Value\n\n    Me.W3T60.Value = Me.Gate60Tb.Value\n\n    Me.W4T60.Value = Me.Gate60Tb.Value\n\nEnd Sub\n</code></pre>\n\n<p>Note that addin \"Me\" fully qualifies the control.  I wonder if you are inadvertantly picking up another in scope object with the name that has teh same name as a control that you THINK is on your form.</p>\n\n<p>Other possibles:</p>\n\n<pre><code>Private Sub Gate60Tb_Click()\n\n    '60\u00b0 Gate TickBox Control\n\n    with Me.Gate60Tb\n\n    Me.W1T60.Value = .Value\n\n    Me.W2T60.Value = .Value\n\n    Me.W3T60.Value = .Value\n\n    Me.W4T60.Value = .Value\n\n    end with\n\nEnd Sub\n\n\nPrivate Sub Gate60Tb_Click()\n\n    '60\u00b0 Gate TickBox Control\n\n    Dim bln as boolean \n\n    bln =  Me.Gate60Tb\n\n    Me.W1T60.Value = bln \n\n    Me.W2T60.Value = bln \n\n    Me.W3T60.Value = bln \n\n    Me.W4T60.Value = bln \n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5261992, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bc5f1417593b0f460429ccb95c68cdfa?s=128&d=identicon&r=PG&f=1", "display_name": "vividillusion", "link": "https://stackoverflow.com/users/5261992/vividillusion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 32465212, "answer_count": 1, "score": 0, "last_activity_date": 1441740855, "creation_date": 1441736106, "last_edit_date": 1441740855, "question_id": 32464583, "link": "https://stackoverflow.com/questions/32464583/checkbox-to-control-other-check-boxes-intermittently-causing-excel-to-crash", "title": "CheckBox to control other check boxes INTERMITTENTLY causing Excel to crash", "body": "<p>Greatly appreciated. I can literally halve the code on the text boxes. I don't know if I am over that limit but If you have a moment to glance over it here is the full code.</p>\n\n<p>80% of it is the True/False statements in the old syntax, but could it be because it is such a large sub?</p>\n\n<pre><code>Private Sub CommandButton2_Click()\nDim irow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"Master Data\")\n\n' Confirmation of Entry to Form\n\nIf MsgBox(\"Have you double checked your data is correct and ALL test points have been selected before entering on the spreadsheet?\", vbYesNo) = vbNo Then    Exit Sub\n\n' Find first empty cell in Column A after existing data\n\nNextFree = Range(\"A10:A\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\nRange(\"A\" &amp; NextFree).Select\n\n' Insert row below active cell\nActiveCell.Offset(1).EntireRow.Insert\n\n' Copy Live formula and Out Today formulas down from cells above in Col A, B and C\n' Enters the data from the corresponding VBA form into offset cells from active cell reference\n\nDim lstRw As Long\nDim Rng As Range\nlstRw = Cells(Rows.Count, \"A\").End(xlUp).Row\nSet Rng = Range(\"A\" &amp; lstRw + 1)\nRange(\"A\" &amp; lstRw &amp; \":NK\" &amp; lstRw).Copy Range(\"A\" &amp; lstRw + 1)\nWith Rng\n.Offset(, 3) = DateTextBox.Value\n.Offset(, 4) = GroupComboBox.Value\n.Offset(, 5) = ProjectTextBox.Value\n.Offset(, 6) = ReqTextBox.Value\n.Offset(, 7) = PartTextBox.Value\n\n.Offset(, 9) = COSHHTextBox.Value\n.Offset(, 10) = ContainerComboBox.Value\n.Offset(, 11) = SampleIDTextBox.Value\n\n\n.Offset(, 14) = TechComboBox.Text\n.Offset(, 15) = ChemComboBox.Text\n\n    ' Locations For temperatures\n\n.Offset(, 17) = TextBox60Tray.Text\n.Offset(, 19) = TextBox50Tray.Text\n.Offset(, 21) = TextBox40Tray.Text\n.Offset(, 23) = RTTb.Text\n.Offset(, 25) = Minus15Tb.Text\n\n    'Brookfield CheckBox Logic statement\n\n    If BrookfieldCB.Value = True Then .Offset(, 27).Value = 1\n    If BrookfieldCB.Value = False Then .Offset(, 27).Value = \"\"\n\n.Offset(, 28) = BrookfieldKitTextBox.Value\n\n    'AntonParr CheckBox Logic statement\n\n    If AntonParrCB.Value = True Then .Offset(, 29).Value = 1\n    If AntonParrCB.Value = False Then .Offset(, 29).Value = \"\"\n\n'Filter Index OptionButtons Logic statement\n\n    If Option1.Value = True Then .Offset(, 30).Value = 1\n    If Option2.Value = True Then .Offset(, 31).Value = 1\n\n.Offset(, 32) = FilterIndexKitTextBox.Value\n\n    'Malvern Dv90 CheckBox Logic statement\n\n    If MalvernDv90CB.Value = True Then .Offset(, 33).Value = 1\n    If MalvernDv90CB.Value = False Then .Offset(, 33).Value = \"\"\n\n    'Malvern Dn90 CheckBox Logic statement\n\n    If MalvernDv90CB.Value = True Then .Offset(, 34).Value = 1\n    If MalvernDv90CB.Value = False Then .Offset(, 34).Value = \"\"\n\n    'Solvent Malvern CheckBox Logic statement\n\n    If SolvMalvCB.Value = True Then .Offset(, 35).Value = 1\n    If SolvMalvCB.Value = False Then .Offset(, 35).Value = \"\"\n\n    'Microscope CheckBox Logic statement\n\n    If MicroscopeCB.Value = True Then .Offset(, 36).Value = 1\n    If MicroscopeCB.Value = False Then .Offset(, 36).Value = \"\"\n\n    'Accusizer CheckBox Logic statement\n\n    If AccusizerCB.Value = True Then .Offset(, 37).Value = 1\n    If AccusizerCB.Value = False Then .Offset(, 37).Value = \"\"\n\n    'Lumisizer CheckBox Logic statement\n\n    If LumisizerCB.Value = True Then .Offset(, 38).Value = 1\n    If LumisizerCB.Value = False Then .Offset(, 38).Value = \"\"\n\n    'Surface Tension CheckBox Logic statement\n\n    If SurfaceTCB.Value = True Then .Offset(, 39).Value = 1\n    If SurfaceTCB.Value = False Then .Offset(, 39).Value = \"\"\n\n    'Phase Angle CheckBox Logic statement\n\n    If PhaseACB.Value = True Then .Offset(, 40).Value = 1\n    If PhaseACB.Value = False Then .Offset(, 40).Value = \"\"\n\n    'Water Content CheckBox Logic statement\n\n    If WaterContCB.Value = True Then .Offset(, 41).Value = 1\n    If WaterContCB.Value = False Then .Offset(, 41).Value = \"\"\n\n    'pH Testing CheckBox Logic statement\n\n    If pHCB.Value = True Then .Offset(, 42).Value = 1\n    If pHCB.Value = False Then .Offset(, 42).Value = \"\"\n\n    'Film Properties CheckBox Logic statement\n\n    If FilmPropsCB.Value = True Then .Offset(, 43).Value = 1\n    If FilmPropsCB.Value = False Then .Offset(, 43).Value = \"\"\n\n    'Karl Fischer CheckBox Logic statement\n\n    If KarlFischerCB.Value = True Then .Offset(, 44).Value = 1\n    If KarlFischerCB.Value = False Then .Offset(, 44).Value = \"\"\n\n    'Panelling CheckBox Logic statement\n\n    If PanellingCB.Value = True Then .Offset(, 45).Value = 1\n    If PanellingCB.Value = False Then .Offset(, 45).Value = \"\"\n\n    'Sedimentation CheckBox Logic statement\n\n    If SedimentationCB.Value = True Then .Offset(, 46).Value = 1\n    If SedimentationCB.Value = False Then .Offset(, 46).Value = \"\"\n\n  '60\u00b0 CheckBox logic statements\n\n    If W1T60.Value = True Then .Offset(, 48).Value = 1\n    If W1T60.Value = False Then .Offset(, 48).Value = \"\"\n\n    If W2T60.Value = True Then .Offset(, 50).Value = 1\n    If W2T60.Value = False Then .Offset(, 50).Value = \"\"\n\n    If W3T60.Value = True Then .Offset(, 52).Value = 1\n    If W3T60.Value = False Then .Offset(, 52).Value = \"\"\n\n    If W4T60.Value = True Then .Offset(, 54).Value = 1\n    If W4T60.Value = False Then .Offset(, 54).Value = \"\"\n\n    If W5T60.Value = True Then .Offset(, 56).Value = 1\n    If W5T60.Value = False Then .Offset(, 56).Value = \"\"\n\n    If W6T60.Value = True Then .Offset(, 58).Value = 1\n    If W6T60.Value = False Then .Offset(, 58).Value = \"\"\n\n    If W7T60.Value = True Then .Offset(, 60).Value = 1\n    If W7T60.Value = False Then .Offset(, 60).Value = \"\"\n\n    If W8T60.Value = True Then .Offset(, 62).Value = 1\n    If W8T60.Value = False Then .Offset(, 62).Value = \"\"\n\n  '50\u00b0 CheckBox logic statements\n\n    If Wk1T50.Value = True Then .Offset(, 64).Value = 1\n    If Wk1T50.Value = False Then .Offset(, 64).Value = \"\"\n\n    If Wk2T50.Value = True Then .Offset(, 66).Value = 1\n    If Wk2T50.Value = False Then .Offset(, 66).Value = \"\"\n\n    If WK3T50.Value = True Then .Offset(, 68).Value = 1\n    If WK3T50.Value = False Then .Offset(, 68).Value = \"\"\n\n    If WK4T50.Value = True Then .Offset(, 70).Value = 1\n    If WK4T50.Value = False Then .Offset(, 70).Value = \"\"\n\n    If WEEK5T50.Value = True Then .Offset(, 72).Value = 1\n    If WEEK5T50.Value = False Then .Offset(, 72).Value = \"\"\n\n    If WK6T50.Value = True Then .Offset(, 74).Value = 1\n    If WK6T50.Value = False Then .Offset(, 74).Value = \"\"\n\n    If WK7T50.Value = True Then .Offset(, 76).Value = 1\n    If WK7T50.Value = False Then .Offset(, 76).Value = \"\"\n\n    If WK8T50.Value = True Then .Offset(, 78).Value = 1\n    If WK8T50.Value = False Then .Offset(, 78).Value = \"\"\n\n    If WK10T50.Value = True Then .Offset(, 80).Value = 1\n    If WK10T50.Value = False Then .Offset(, 80).Value = \"\"\n\n    If WK12T50.Value = True Then .Offset(, 82).Value = 1\n    If WK12T50.Value = False Then .Offset(, 82).Value = \"\"\n\n    If WK14T50.Value = True Then .Offset(, 84).Value = 1\n    If WK14T50.Value = False Then .Offset(, 84).Value = \"\"\n\n    If WK16T50.Value = True Then .Offset(, 86).Value = 1\n    If WK16T50.Value = False Then .Offset(, 86).Value = \"\"\n\n '40\u00b0 CheckBox logic statements\n\n    If WK1T40.Value = True Then .Offset(, 88).Value = 1\n    If WK1T40.Value = False Then .Offset(, 88).Value = \"\"\n\n    If WK2T40.Value = True Then .Offset(, 90).Value = 1\n    If WK2T40.Value = False Then .Offset(, 90).Value = \"\"\n\n    If WK3T40.Value = True Then .Offset(, 92).Value = 1\n    If WK3T40.Value = False Then .Offset(, 92).Value = \"\"\n\n    If WK4T40.Value = True Then .Offset(, 94).Value = 1\n    If WK4T40.Value = False Then .Offset(, 94).Value = \"\"\n\n    If WK5T40.Value = True Then .Offset(, 96).Value = 1\n    If WK5T40.Value = False Then .Offset(, 96).Value = \"\"\n\n    If WK6T40.Value = True Then .Offset(, 98).Value = 1\n    If WK6T40.Value = False Then .Offset(, 98).Value = \"\"\n\n    If WK7T40.Value = True Then .Offset(, 100).Value = 1\n    If WK7T40.Value = False Then .Offset(, 100).Value = \"\"\n\n    If WK8T40.Value = True Then .Offset(, 102).Value = 1\n    If WK8T40.Value = False Then .Offset(, 102).Value = \"\"\n\n    If WK10T40.Value = True Then .Offset(, 104).Value = 1\n    If WK10T40.Value = False Then .Offset(, 104).Value = \"\"\n\n    If WK12T40.Value = True Then .Offset(, 106).Value = 1\n    If WK12T40.Value = False Then .Offset(, 106).Value = \"\"\n\n    If WK14T40.Value = True Then .Offset(, 108).Value = 1\n    If WK14T40.Value = False Then .Offset(, 108).Value = \"\"\n\n    If WK16T40.Value = True Then .Offset(, 110).Value = 1\n    If WK16T40.Value = False Then .Offset(, 110).Value = \"\"\n\n    If WK20T40.Value = True Then .Offset(, 112).Value = 1\n    If WK20T40.Value = False Then .Offset(, 112).Value = \"\"\n\n    If WK24T40.Value = True Then .Offset(, 114).Value = 1\n    If WK24T40.Value = False Then .Offset(, 114).Value = \"\"\n\n    If WK28T40.Value = True Then .Offset(, 116).Value = 1\n    If WK28T40.Value = False Then .Offset(, 116).Value = \"\"\n\n    If WK32T40.Value = True Then .Offset(, 118).Value = 1\n    If WK32T40.Value = False Then .Offset(, 118).Value = \"\"\n\n\n   '1 - 104wk CheckBox logic statements\n\n    If wk1tb.Value = True Then .Offset(, 120).Value = 1\n    If wk1tb.Value = False Then .Offset(, 120).Value = \"\"\n\n    If wk2tb.Value = True Then .Offset(, 122).Value = 1\n    If wk2tb.Value = False Then .Offset(, 122).Value = \"\"\n\n    If wk3tb.Value = True Then .Offset(, 124).Value = 1\n    If wk3tb.Value = False Then .Offset(, 124).Value = \"\"\n\n    If wk4tb.Value = True Then .Offset(, 126).Value = 1\n    If wk4tb.Value = False Then .Offset(, 126).Value = \"\"\n\n    If wk5tb.Value = True Then .Offset(, 128).Value = 1\n    If wk5tb.Value = False Then .Offset(, 128).Value = \"\"\n\n    If wk6tb.Value = True Then .Offset(, 130).Value = 1\n    If wk6tb.Value = False Then .Offset(, 130).Value = \"\"\n\n    If wk7tb.Value = True Then .Offset(, 132).Value = 1\n    If wk7tb.Value = False Then .Offset(, 132).Value = \"\"\n\n    If wk8tb.Value = True Then .Offset(, 134).Value = 1\n    If wk8tb.Value = False Then .Offset(, 134).Value = \"\"\n\n    If wk9tb.Value = True Then .Offset(, 136).Value = 1\n    If wk9tb.Value = False Then .Offset(, 136).Value = \"\"\n\n    If wk10tb.Value = True Then .Offset(, 138).Value = 1\n    If wk10tb.Value = False Then .Offset(, 138).Value = \"\"\n\n    If wk11tb.Value = True Then .Offset(, 140).Value = 1\n    If wk11tb.Value = False Then .Offset(, 140).Value = \"\"\n\n    If wk12tb.Value = True Then .Offset(, 142).Value = 1\n    If wk12tb.Value = False Then .Offset(, 142).Value = \"\"\n\n    If wk13tb.Value = True Then .Offset(, 144).Value = 1\n    If wk13tb.Value = False Then .Offset(, 144).Value = \"\"\n\n    If wk14tb.Value = True Then .Offset(, 146).Value = 1\n    If wk14tb.Value = False Then .Offset(, 146).Value = \"\"\n\n    If wk15tb.Value = True Then .Offset(, 148).Value = 1\n    If wk15tb.Value = False Then .Offset(, 148).Value = \"\"\n\n    If wk16tb.Value = True Then .Offset(, 150).Value = 1\n    If wk16tb.Value = False Then .Offset(, 150).Value = \"\"\n\n    If wk17tb.Value = True Then .Offset(, 152).Value = 1\n    If wk17tb.Value = False Then .Offset(, 152).Value = \"\"\n\n    If wk18tb.Value = True Then .Offset(, 154).Value = 1\n    If wk18tb.Value = False Then .Offset(, 154).Value = \"\"\n\n    If wk19tb.Value = True Then .Offset(, 156).Value = 1\n    If wk19tb.Value = False Then .Offset(, 156).Value = \"\"\n\n    If wk20tb.Value = True Then .Offset(, 158).Value = 1\n    If wk20tb.Value = False Then .Offset(, 158).Value = \"\"\n\n    If wk21tb.Value = True Then .Offset(, 160).Value = 1\n    If wk21tb.Value = False Then .Offset(, 160).Value = \"\"\n\n    If wk22tb.Value = True Then .Offset(, 162).Value = 1\n    If wk22tb.Value = False Then .Offset(, 162).Value = \"\"\n\n    If wk23tb.Value = True Then .Offset(, 164).Value = 1\n    If wk23tb.Value = False Then .Offset(, 164).Value = \"\"\n\n    If wk24tb.Value = True Then .Offset(, 166).Value = 1\n    If wk24tb.Value = False Then .Offset(, 166).Value = \"\"\n\n    If wk25tb.Value = True Then .Offset(, 168).Value = 1\n    If wk25tb.Value = False Then .Offset(, 168).Value = \"\"\n\n    If wk26tb.Value = True Then .Offset(, 170).Value = 1\n    If wk26tb.Value = False Then .Offset(, 170).Value = \"\"\n\n    If wk27tb.Value = True Then .Offset(, 172).Value = 1\n    If wk27tb.Value = False Then .Offset(, 172).Value = \"\"\n\n    If wk28tb.Value = True Then .Offset(, 174).Value = 1\n    If wk28tb.Value = False Then .Offset(, 174).Value = \"\"\n\n    If wk29tb.Value = True Then .Offset(, 176).Value = 1\n    If wk29tb.Value = False Then .Offset(, 176).Value = \"\"\n\n    If wk30tb.Value = True Then .Offset(, 178).Value = 1\n    If wk30tb.Value = False Then .Offset(, 178).Value = \"\"\n\n    If wk31tb.Value = True Then .Offset(, 180).Value = 1\n    If wk31tb.Value = False Then .Offset(, 180).Value = \"\"\n\n    If wk32tb.Value = True Then .Offset(, 182).Value = 1\n    If wk32tb.Value = False Then .Offset(, 182).Value = \"\"\n\n    If wk33tb.Value = True Then .Offset(, 184).Value = 1\n    If wk33tb.Value = False Then .Offset(, 184).Value = \"\"\n\n    If wk34tb.Value = True Then .Offset(, 186).Value = 1\n    If wk34tb.Value = False Then .Offset(, 186).Value = \"\"\n\n    If wk35tb.Value = True Then .Offset(, 188).Value = 1\n    If wk35tb.Value = False Then .Offset(, 188).Value = \"\"\n\n    If wk36tb.Value = True Then .Offset(, 190).Value = 1\n    If wk36tb.Value = False Then .Offset(, 190).Value = \"\"\n\n    If wk37tb.Value = True Then .Offset(, 192).Value = 1\n    If wk37tb.Value = False Then .Offset(, 192).Value = \"\"\n\n    If wk38tb.Value = True Then .Offset(, 194).Value = 1\n    If wk38tb.Value = False Then .Offset(, 194).Value = \"\"\n\n    If wk39tb.Value = True Then .Offset(, 196).Value = 1\n    If wk39tb.Value = False Then .Offset(, 196).Value = \"\"\n\n    If wk40tb.Value = True Then .Offset(, 198).Value = 1\n    If wk40tb.Value = False Then .Offset(, 198).Value = \"\"\n\n    If wk41tb.Value = True Then .Offset(, 200).Value = 1\n    If wk41tb.Value = False Then .Offset(, 200).Value = \"\"\n\n    If wk42tb.Value = True Then .Offset(, 202).Value = 1\n    If wk42tb.Value = False Then .Offset(, 202).Value = \"\"\n\n    If wk43tb.Value = True Then .Offset(, 204).Value = 1\n    If wk43tb.Value = False Then .Offset(, 204).Value = \"\"\n\n    If wk44tb.Value = True Then .Offset(, 206).Value = 1\n    If wk44tb.Value = False Then .Offset(, 206).Value = \"\"\n\n    If wk45tb.Value = True Then .Offset(, 208).Value = 1\n    If wk45tb.Value = False Then .Offset(, 208).Value = \"\"\n\n    If wk46tb.Value = True Then .Offset(, 210).Value = 1\n    If wk46tb.Value = False Then .Offset(, 210).Value = \"\"\n\n    If wk47tb.Value = True Then .Offset(, 212).Value = 1\n    If wk47tb.Value = False Then .Offset(, 212).Value = \"\"\n\n    If wk48tb.Value = True Then .Offset(, 214).Value = 1\n    If wk48tb.Value = False Then .Offset(, 214).Value = \"\"\n\n    If wk49tb.Value = True Then .Offset(, 216).Value = 1\n    If wk49tb.Value = False Then .Offset(, 216).Value = \"\"\n\n    If wk50tb.Value = True Then .Offset(, 218).Value = 1\n    If wk50tb.Value = False Then .Offset(, 218).Value = \"\"\n\n    If wk51tb.Value = True Then .Offset(, 220).Value = 1\n    If wk51tb.Value = False Then .Offset(, 220).Value = \"\"\n\n    If wk52tb.Value = True Then .Offset(, 222).Value = 1\n    If wk52tb.Value = False Then .Offset(, 222).Value = \"\"\n\n\n    '-15\u00b0 CheckBox logic statements\n\n    If WK1T15.Value = True Then .Offset(, 328).Value = 1\n    If WK1T15.Value = False Then .Offset(, 328).Value = \"\"\n\n    If WK2T15.Value = True Then .Offset(, 330).Value = 1\n    If WK2T15.Value = False Then .Offset(, 330).Value = \"\"\n\n    If WK3T15.Value = True Then .Offset(, 332).Value = 1\n    If WK3T15.Value = False Then .Offset(, 332).Value = \"\"\n\n    If WK4T15.Value = True Then .Offset(, 334).Value = 1\n    If WK4T15.Value = False Then .Offset(, 334).Value = \"\"\n\n    If WK5T15.Value = True Then .Offset(, 336).Value = 1\n    If WK5T15.Value = False Then .Offset(, 336).Value = \"\"\n\n    If WK6T15.Value = True Then .Offset(, 338).Value = 1\n    If WK6T15.Value = False Then .Offset(, 338).Value = \"\"\n\n    If WK7T15.Value = True Then .Offset(, 340).Value = 1\n    If WK7T15.Value = False Then .Offset(, 340).Value = \"\"\n\n    If WK8T15.Value = True Then .Offset(, 342).Value = 1\n    If WK8T15.Value = False Then .Offset(, 342).Value = \"\"\n\n '-15\u00b0 CheckBox logic statements\n\n    If WK1TFRIDGE.Value = True Then .Offset(, 344).Value = 1\n    If WK1TFRIDGE.Value = False Then .Offset(, 344).Value = \"\"\n\n    If WK2TFRIDGE.Value = True Then .Offset(, 346).Value = 1\n    If WK2TFRIDGE.Value = False Then .Offset(, 346).Value = \"\"\n\n    If WK3TFRIDGE.Value = True Then .Offset(, 348).Value = 1\n    If WK3TFRIDGE.Value = False Then .Offset(, 348).Value = \"\"\n\n    If WK4TFRIDGE.Value = True Then .Offset(, 350).Value = 1\n    If WK4TFRIDGE.Value = False Then .Offset(, 350).Value = \"\"\n\n    If WK5TFRIDGE.Value = True Then .Offset(, 352).Value = 1\n    If WK5TFRIDGE.Value = False Then .Offset(, 352).Value = \"\"\n\n    If WK6TFRIDGE.Value = True Then .Offset(, 354).Value = 1\n    If WK6TFRIDGE.Value = False Then .Offset(, 354).Value = \"\"\n\n    If WK7TFRIDGE.Value = True Then .Offset(, 356).Value = 1\n    If WK7TFRIDGE.Value = False Then .Offset(, 356).Value = \"\"\n\n    If WK8TFRIDGE.Value = True Then .Offset(, 358).Value = 1\n    If WK8TFRIDGE.Value = False Then .Offset(, 358).Value = \"\"\n\n\nEnd With\n\n\nEnd Sub\n\n\nPrivate Sub Gate60Tb_Click()\n\n'60\u00b0 Gate TickBox Control\n\nMe.W1T60.Value = Me.Gate60Tb.Value\n\nMe.W2T60.Value = Me.Gate60Tb.Value\n\nMe.W3T60.Value = Me.Gate60Tb.Value\n\nMe.W4T60.Value = Me.Gate60Tb.Value\n\nEnd Sub\nPrivate Sub Gate50Tb_Click()\n\n    '50\u00b0 Gate TickBox Control\n\n    If Gate50Tb.Value = True Then Wk2T50.Value = 1\n    If Gate50Tb.Value = False Then Wk2T50.Value = 0\n\n    If Gate50Tb.Value = True Then WK4T50.Value = 1\n    If Gate50Tb.Value = False Then WK4T50.Value = 0\n\n    If Gate50Tb.Value = True Then WK6T50.Value = 1\n    If Gate50Tb.Value = False Then WK6T50.Value = 0\n\n    If Gate50Tb.Value = True Then WK8T50.Value = 1\n    If Gate50Tb.Value = False Then WK8T50.Value = 0\n\n\nEnd Sub\n\nPrivate Sub Gate40Tb_Click()\n\n    ' Gate 40\u00b0 Tickbox Control\n\n    If Gate40Tb.Value = True Then WK4T40.Value = 1\n    If Gate40Tb.Value = False Then WK4T40.Value = 0\n\n    If Gate40Tb.Value = True Then WK8T40.Value = 1\n    If Gate40Tb.Value = False Then WK8T40.Value = 0\n\n    If Gate40Tb.Value = True Then WK12T40.Value = 1\n    If Gate40Tb.Value = False Then WK12T40.Value = 0\n\n    If Gate40Tb.Value = True Then WK16T40.Value = 1\n    If Gate40Tb.Value = False Then WK16T40.Value = 0\n\nEnd Sub\n\nPrivate Sub GateRT48wk_Click()\n\n\n    If GateRT48wk.Value = True Then wk6tb.Value = 1\n    If GateRT48wk.Value = False Then wk6tb.Value = 0\n\n    If GateRT48wk.Value = True Then wk12tb.Value = 1\n    If GateRT48wk.Value = False Then wk12tb.Value = 0\n\n    If GateRT48wk.Value = True Then wk18tb.Value = 1\n    If GateRT48wk.Value = False Then wk18tb.Value = 0\n\n    If GateRT48wk.Value = True Then wk24tb.Value = 1\n    If GateRT48wk.Value = False Then wk24tb.Value = 0\n\n    If GateRT48wk.Value = True Then wk30tb.Value = 1\n    If GateRT48wk.Value = False Then wk30tb.Value = 0\n\n    If GateRT48wk.Value = True Then wk36tb.Value = 1\n    If GateRT48wk.Value = False Then wk36tb.Value = 0\n\n    If GateRT48wk.Value = True Then wk42tb.Value = 1\n    If GateRT48wk.Value = False Then wk42tb.Value = 0\n\n    If GateRT48wk.Value = True Then wk48tb.Value = 1\n    If GateRT48wk.Value = False Then wk48tb.Value = 0\n\nEnd Sub\n\nPrivate Sub GateRT52wk_Click()\n\n    ' Gate RT Tickbox Control\n\n    If GateRT52wk.Value = True Then wk4tb.Value = 1\n    If GateRT52wk.Value = False Then wk4tb.Value = 0\n\n    If GateRT52wk.Value = True Then wk8tb.Value = 1\n    If GateRT52wk.Value = False Then wk8tb.Value = 0\n\n    If GateRT52wk.Value = True Then wk12tb.Value = 1\n    If GateRT52wk.Value = False Then wk12tb.Value = 0\n\n    If GateRT52wk.Value = True Then wk16tb.Value = 1\n    If GateRT52wk.Value = False Then wk16tb.Value = 0\n\n    If GateRT52wk.Value = True Then wk20tb.Value = 1\n    If GateRT52wk.Value = False Then wk20tb.Value = 0\n\n    If GateRT52wk.Value = True Then wk24tb.Value = 1\n    If GateRT52wk.Value = False Then wk24tb.Value = 0\n\n    If GateRT52wk.Value = True Then wk28tb.Value = 1\n    If GateRT52wk.Value = False Then wk28tb.Value = 0\n\n    If GateRT52wk.Value = True Then wk32tb.Value = 1\n    If GateRT52wk.Value = False Then wk32tb.Value = 0\n\n    If GateRT52wk.Value = True Then wk36tb.Value = 1\n    If GateRT52wk.Value = False Then wk36tb.Value = 0\n\n    If GateRT52wk.Value = True Then wk40tb.Value = 1\n    If GateRT52wk.Value = False Then wk40tb.Value = 0\n\n    If GateRT52wk.Value = True Then wk44tb.Value = 1\n    If GateRT52wk.Value = False Then wk44tb.Value = 0\n\n    If GateRT52wk.Value = True Then wk48tb.Value = 1\n    If GateRT52wk.Value = False Then wk48tb.Value = 0\n\n    If GateRT52wk.Value = True Then wk52tb.Value = 1\n    If GateRT52wk.Value = False Then wk52tb.Value = 0\n\nEnd Sub\n\n\nPrivate Sub GateRTQ1_Click()\n\n    ' Gate RT Year 1 Qtly Tickbox Control\n\n    If GateRTQ1.Value = True Then wk13tb.Value = 1\n    If GateRTQ1.Value = False Then wk13tb.Value = 0\n\n    If GateRTQ1.Value = True Then wk26tb.Value = 1\n    If GateRTQ1.Value = False Then wk26tb.Value = 0\n\n    If GateRTQ1.Value = True Then wk39tb.Value = 1\n    If GateRTQ1.Value = False Then wk39tb.Value = 0\n\n    If GateRTQ1.Value = True Then wk52tb.Value = 1\n    If GateRTQ1.Value = False Then wk52tb.Value = 0\n\nEnd Sub\n\nPrivate Sub GateRTQ2_Click()\n\n    ' Gate RT Year 2 Qtly Tickbox Control\n\n    If GateRTQ2.Value = True Then wk65tb.Value = 1\n    If GateRTQ2.Value = False Then wk65tb.Value = 0\n\n    If GateRTQ2.Value = True Then wk78tb.Value = 1\n    If GateRTQ2.Value = False Then wk78tb.Value = 0\n\n    If GateRTQ2.Value = True Then wk91tb.Value = 1\n    If GateRTQ2.Value = False Then wk91tb.Value = 0\n\n    If GateRTQ2.Value = True Then wk104tb.Value = 1\n    If GateRTQ2.Value = False Then wk104tb.Value = 0\n\nEnd Sub\n\n\nPrivate Sub Gate158wk_Click()\n\n    '-15\u00b0 8@8 Gate TickBox Control\n\n    If Gate158wk.Value = True Then WK8T15.Value = 1\n    If Gate158wk.Value = False Then WK8T15.Value = 0\n\nEnd Sub\n\nPrivate Sub Gate151wk_Click()\n\n    '-15\u00b0 8@1 Gate TickBox Control\n\n    If Gate151wk.Value = True Then WK1T15.Value = 1\n    If Gate151wk.Value = False Then WK1T15.Value = 0\n\n    If Gate151wk.Value = True Then WK2T15.Value = 1\n    If Gate151wk.Value = False Then WK2T15.Value = 0\n\n    If Gate151wk.Value = True Then WK3T15.Value = 1\n    If Gate151wk.Value = False Then WK3T15.Value = 0\n\n    If Gate151wk.Value = True Then WK4T15.Value = 1\n    If Gate151wk.Value = False Then WK4T15.Value = 0\n\n    If Gate151wk.Value = True Then WK5T15.Value = 1\n    If Gate151wk.Value = False Then WK5T15.Value = 0\n\n    If Gate151wk.Value = True Then WK6T15.Value = 1\n    If Gate151wk.Value = False Then WK6T15.Value = 0\n\n    If Gate151wk.Value = True Then WK7T15.Value = 1\n    If Gate151wk.Value = False Then WK7T15.Value = 0\n\n    If Gate151wk.Value = True Then WK8T15.Value = 1\n    If Gate151wk.Value = False Then WK8T15.Value = 0\n\n\nEnd Sub\nPrivate Sub GateFridge8wk_Click()\n\n    'Fridge 8@8 Gate TickBox Control\n\n    If GateFridge8wk.Value = True Then WK8TFRIDGE.Value = 1\n    If GateFridge8wk.Value = False Then WK8TFRIDGE.Value = 0\n\nEnd Sub\n\nPrivate Sub GateFridge1wk_Click()\n\n    '-15\u00b0 8@1 Gate TickBox Control\n\n    If GateFridge1wk.Value = True Then WK1TFRIDGE.Value = 1\n    If GateFridge1wk.Value = False Then WK1TFRIDGE.Value = 0\n\n    If GateFridge1wk.Value = True Then WK2TFRIDGE.Value = 1\n    If GateFridge1wk.Value = False Then WK2TFRIDGE.Value = 0\n\n    If GateFridge1wk.Value = True Then WK3TFRIDGE.Value = 1\n    If GateFridge1wk.Value = False Then WK3TFRIDGE.Value = 0\n\n    If GateFridge1wk.Value = True Then WK4TFRIDGE.Value = 1\n    If GateFridge1wk.Value = False Then WK4TFRIDGE.Value = 0\n\n    If GateFridge1wk.Value = True Then WK5TFRIDGE.Value = 1\n    If GateFridge1wk.Value = False Then WK5TFRIDGE.Value = 0\n\n    If GateFridge1wk.Value = True Then WK6TFRIDGE.Value = 1\n    If GateFridge1wk.Value = False Then WK6TFRIDGE.Value = 0\n\n    If GateFridge1wk.Value = True Then WK7TFRIDGE.Value = 1\n    If GateFridge1wk.Value = False Then WK7TFRIDGE.Value = 0\n\n    If GateFridge1wk.Value = True Then WK8TFRIDGE.Value = 1\n    If GateFridge1wk.Value = False Then WK8TFRIDGE.Value = 0\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "date"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1441735318, "post_id": 32464292, "comment_id": 52790654, "body": "What&#39;s your default system date format?  mm/dd/yyyy or dd/mm/yyyy  ?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441735895, "post_id": 32464292, "comment_id": 52790966, "body": "This is most likely due to the system&#39;s date format (8th of September = 09/08/2015 in <code>mm&#47;dd&#47;yyyy</code>, but 8th of September = 08/09/2015 in <code>dd&#47;mm&#47;yyyy</code> format).  Try forcing the <code>Me.tbDate</code> to be text, <code>Me.tbDate = Text(me.tbDate,&quot;mm&#47;dd&#47;yyyy&quot;)</code> (or whatever format)."}, {"owner": {"reputation": 81, "user_id": 4466525, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-KxfvxWcQGtc/AAAAAAAAAAI/AAAAAAAACdQ/_W02YlPdzG8/photo.jpg?sz=128", "display_name": "Makis Kahrimanidis", "link": "https://stackoverflow.com/users/4466525/makis-kahrimanidis"}, "edited": false, "score": 0, "creation_date": 1441736889, "post_id": 32464292, "comment_id": 52791547, "body": "yes but if i change {me.tbDate} in text then how it will aquire automatically the date from the laptop?"}, {"owner": {"reputation": 1162, "user_id": 5218425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YxBQi.jpg?s=128&g=1", "display_name": "DragonSamu", "link": "https://stackoverflow.com/users/5218425/dragonsamu"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1441737975, "post_id": 32464292, "comment_id": 52792180, "body": "@BruceWayne he can force the correct date Format() to set it back to his system date instead of US date"}], "answers": [{"comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1441874600, "post_id": 32466081, "comment_id": 52853899, "body": "This doesn&#39;t really fix your issue long term, it is just a quick fix for now. I&#39;d look into what Tim Williams said in his comment to see if you can resolve the issue as I think your systems date format and excels date format defaults might differ"}], "tags": [], "owner": {"reputation": 81, "user_id": 4466525, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-KxfvxWcQGtc/AAAAAAAAAAI/AAAAAAAACdQ/_W02YlPdzG8/photo.jpg?sz=128", "display_name": "Makis Kahrimanidis", "link": "https://stackoverflow.com/users/4466525/makis-kahrimanidis"}, "is_accepted": false, "score": 1, "last_activity_date": 1441741761, "creation_date": 1441741761, "answer_id": 32466081, "question_id": 32464292, "link": "https://stackoverflow.com/questions/32464292/date-format-is-switching-month-and-day/32466081#32466081", "title": "Date format is switching month and day", "body": "<p>I found this and sorted my issue. Now everything its working like a charm.</p>\n\n<pre><code>Me.tbDate = Format(Date, \"dd/mm/yyyy\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13750258, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/53868b62e7adb56a0ed2bf2d70a29fba?s=128&d=identicon&r=PG", "display_name": "Jack", "link": "https://stackoverflow.com/users/13750258/jack"}, "is_accepted": false, "score": 0, "last_activity_date": 1592232611, "last_edit_date": 1592232611, "creation_date": 1592231016, "answer_id": 62390270, "question_id": 32464292, "link": "https://stackoverflow.com/questions/32464292/date-format-is-switching-month-and-day/62390270#62390270", "title": "Date format is switching month and day", "body": "<p>I resolved my issue with this code. I intentionally formated the cell the wrong way (excel default) and then formated it as I needed.</p>\n\n<pre><code>For j = 0 To LISTBOXNAME.ListCount - 1\nLISTBOXNAME.List(j) = Format(DateValue(LISTBOXNAME.List(j)), \"m/d/yyyy\")\nLISTBOXNAME.List(j) = Format(DateValue(LISTBOXNAME.List(j)), \"dd.mm.yyyy\")\nNext j\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 4466525, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-KxfvxWcQGtc/AAAAAAAAAAI/AAAAAAAACdQ/_W02YlPdzG8/photo.jpg?sz=128", "display_name": "Makis Kahrimanidis", "link": "https://stackoverflow.com/users/4466525/makis-kahrimanidis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2863, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1593764787, "creation_date": 1441735046, "last_edit_date": 1593764787, "question_id": 32464292, "link": "https://stackoverflow.com/questions/32464292/date-format-is-switching-month-and-day", "title": "Date format is switching month and day", "body": "<p>Could you please someone can help me on how to change the date formatting cause i use the following code and instead of today's date it gives me august date. I mean it takes the date of my laptop (08-sep-2015) and it returns on the excel cell (09-Aug-2015).</p>\n<pre><code>Private Sub UserForm_Initialize()\n'testing variable\n'Dim LValue As String\n\n'LValue = Format(#4/17/2004#, &quot;Long Date&quot;)\n'close testing variable\n\nMe.tbDate = Date\n\n\n'fill combobox\n\n\nFor Each cell In [cartridges]\n    Me.cmbCartridges.AddItem cell\nNext cell\n\nEnd Sub\n</code></pre>\n<p>The part that i exclude form the code is a test i made for a solution i found over the internet.</p>\n<p>Also the text box that i want to present the date has the following code</p>\n<pre><code>ssheet.Cells(nr, 1) = CDate(Me.tbDate)\n</code></pre>\n"}]