[{"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507161272, "post_id": 46575796, "comment_id": 80105058, "body": "(a) Which line gives the type mismatch?  (b) I would have expected your <code>Debug.Print</code> to usually print <code>Error 2042</code> because it will be unlikely that a random number will appear <b>exactly</b> in a sample of only 998 values."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1507161396, "post_id": 46575796, "comment_id": 80105091, "body": "@SMeaden <code>Debug.Print</code> will automatically handle the error type, which is why it is printing <code>Error 2042</code> when not matched."}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1507161429, "post_id": 46575796, "comment_id": 80105101, "body": "@SMeaden, thanks for the suggestion. returned value is <code>True</code>. but I am not sure how to trace the error..."}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507161518, "post_id": 46575796, "comment_id": 80105128, "body": "@YowE3K, error code is Runtime error 13"}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507161676, "post_id": 46575796, "comment_id": 80105173, "body": "@YowE3K, it is that <code>Debug.Print </code> line"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507161679, "post_id": 46575796, "comment_id": 80105174, "body": "The OP&#39;s original code worked for me - will now try the revised code."}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1507161770, "post_id": 46575796, "comment_id": 80105193, "body": "@SMeaden, I tried to pass range.value, but failed."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507161878, "post_id": 46575796, "comment_id": 80105219, "body": "New code works for me too - <code>Debug.Print</code> prints <code>Error 2042</code>.  <code>Debug.Print</code> should be able to cope with a <code>Variant&#47;Error</code>, so I can&#39;t think of anything that <code>VLookup</code> could return that would cause a type mismatch."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1507161936, "post_id": 46575796, "comment_id": 80105237, "body": "Why not <code>Debug.Print Application.VLookup(sss0, LookUp_Range, 2, -1)</code>?  FALSE=0 , TRUE=-1 in VBA"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507161980, "post_id": 46575796, "comment_id": 80105249, "body": "Try creating a dummy <code>Variant</code> value (<code>Dim temp As Variant</code>) and then use it instead of <code>Debug.Print</code> (i.e. <code>temp = Application.VLookup(...</code>) and look at the value of <code>temp</code> in a watch window."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1507162079, "post_id": 46575796, "comment_id": 80105277, "body": "@SMeaden Yeah - an exact match for a random number is ... strange.  But it doesn&#39;t explain the type mismatch.  I wouldn&#39;t expect a type mismatch unless the result was being put into a numeric or string variable."}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507162106, "post_id": 46575796, "comment_id": 80105288, "body": "@YowE3K, the error code is <code>2042</code>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507162147, "post_id": 46575796, "comment_id": 80105299, "body": "@YowE3K: I agree Excel VBA reports #N/A as 2042  And I cannot recreate type mismatch error 13."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507162262, "post_id": 46575796, "comment_id": 80105319, "body": "Are you sure you are getting a type mismatch on the <code>Debug.Print</code>.  That should handle the error code happily.  But if you were doing something like <code>Dim x As Double : x = Application.VLookup(sss0, LookUp_Range, 2, 0)</code> <b>that</b> would give a type mismatch."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507162304, "post_id": 46575796, "comment_id": 80105328, "body": "What version of Excel is this?"}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507162339, "post_id": 46575796, "comment_id": 80105339, "body": "@YowE3K, EXCEL 2013 on WINDOWS 10 64 bit. ANd <code>temp = Application.VLookup(0.015, LookUp_Range, 2, 0)</code> gave me ERROR 2042, in which temp is defined as a variant."}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1507162416, "post_id": 46575796, "comment_id": 80105357, "body": "@tao.hong : And if you make the last line <code>Debug.Print temp</code> ?"}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1507162476, "post_id": 46575796, "comment_id": 80105370, "body": "@SMeaden, yes, and it printed out <code>Error 2042</code>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1507162514, "post_id": 46575796, "comment_id": 80105382, "body": "So the Type mismatch went away?  Cool."}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507162598, "post_id": 46575796, "comment_id": 80105402, "body": "@YowE3K SMeaden, but it did not returned the desired result... I tested using an existing value and result is 2042"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 1, "creation_date": 1507162630, "post_id": 46575796, "comment_id": 80105411, "body": "@tao.hong: you want closest match pass =-1 in final argument, if you pass 0 you get exact match."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1507162682, "post_id": 46575796, "comment_id": 80105424, "body": "@tao.hong the reason you aren&#39;t getting the desired result is (a) you are doing an <b>exact</b> match, and (b) [once you fix (a)] you are searching for a number between 0 and 1 in a set of values that starts at 6."}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507162813, "post_id": 46575796, "comment_id": 80105451, "body": "@YowE3K, I assume, the vlookup could find something in Col B"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507162888, "post_id": 46575796, "comment_id": 80105462, "body": "@tao.hong <code>VLookup</code> looks for a value in the <b>first</b> column and then returns a value from the same row but the specified column (you specified column 2)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507162961, "post_id": 46575796, "comment_id": 80105481, "body": "@tao.hong If you want to return the value in the first column based on a search on the second column, you either need to do an Index / Match, or switch the columns."}, {"owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507162990, "post_id": 46575796, "comment_id": 80105488, "body": "@YowE3K, yes, I will switch the column."}], "answers": [{"tags": [], "owner": {"reputation": 7536, "user_id": 979580, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IZ5iY.jpg?s=128&g=1", "display_name": "Alexander Bell", "link": "https://stackoverflow.com/users/979580/alexander-bell"}, "is_accepted": true, "score": 1, "last_activity_date": 1507164755, "last_edit_date": 1507164755, "creation_date": 1507164123, "answer_id": 46576209, "question_id": 46575796, "link": "https://stackoverflow.com/questions/46575796/error-2042-n-a-in-excel-vlookup-worksheet-function/46576209#46576209", "title": "Error 2042 (&quot;N/A&quot;) in Excel VLookup() Worksheet Function", "body": "<p>The <code>Error 2042</code> (\"N/A\") seems to be caused by the fact that the value returned by the Excel Worksheet function:</p>\n\n<pre><code>Aplication.WorksheetFunction.Max(Rnd(), 0.005)\n</code></pre>\n\n<p>which is always less than 1 will never get into specified range of values (>6) in <code>column A</code>. For testing purpose, try to substitute it with any number in that range of values in <code>Column A</code>, for example, <code>sss0 =6.15</code> and modify the VLOOKUP() statement as following:</p>\n\n<pre><code>Debug.Print Application.VLookup(sss0, LookUp_Range, 2, 1)\n</code></pre>\n\n<p>(where 1 stands for logical <code>TRUE</code>) to get it working, i.e. finding the closest value (not exact match) as per your definition.</p>\n\n<p>Hope this may help.</p>\n"}], "owner": {"reputation": 3834, "user_id": 1231509, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/PoKGH.png?s=128&g=1", "display_name": "TTT", "link": "https://stackoverflow.com/users/1231509/ttt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "accepted_answer_id": 46576209, "answer_count": 1, "score": 1, "last_activity_date": 1507165270, "creation_date": 1507160851, "last_edit_date": 1507165270, "question_id": 46575796, "link": "https://stackoverflow.com/questions/46575796/error-2042-n-a-in-excel-vlookup-worksheet-function", "title": "Error 2042 (&quot;N/A&quot;) in Excel VLookup() Worksheet Function", "body": "<p>Need some help to figure out strange VBA <code>VLOOKUP</code> <code>Type Missmatch</code> error. The code is really simple, since sss0 is a random number and all I want is to find closest value in a range (sheet 'BMD_CDF', Range(\"A2:B999\")). In the spreadsheet, I set format for Sheets(\"BMD_CDF\").Range(\"A2:B999\") to scientific already...</p>\n\n<pre><code>Dim LookUp_Range As Range\nDim sss0 As Double\nSet LookUp_Range = Sheets(\"BMD_CDF\").Range(\"A2:B999\")\n\nsss0=Application.WorksheetFunction.Max(Rnd(), 0.005)\nDebug.Print Application.VLookup(sss0, LookUp_Range, 2, 0)\n</code></pre>\n\n<h3>ERROR MSG</h3>\n\n<p><a href=\"https://i.stack.imgur.com/qJCAU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qJCAU.png\" alt=\"enter image description here\"></a></p>\n\n<h3>What Range looks like</h3>\n\n<p><a href=\"https://i.stack.imgur.com/Gmb3K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Gmb3K.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 159, "user_id": 5896449, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156759638110508/picture?type=large", "display_name": "xthestreams", "link": "https://stackoverflow.com/users/5896449/xthestreams"}, "edited": false, "score": 1, "creation_date": 1507163731, "post_id": 46575713, "comment_id": 80105651, "body": "Try using <code>enddate = .Cells(.Rows.Count, &quot;A&quot;).End(xlUp).Value</code> instead of Row"}, {"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1507163735, "post_id": 46575713, "comment_id": 80105652, "body": "You have a variable - <code>b</code> - that isn&#39;t defined in what you provided, which throws an error (on my side, at least). Can you please provide a visual of your worksheet data so we can better understand how its structured?"}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 159, "user_id": 5896449, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156759638110508/picture?type=large", "display_name": "xthestreams", "link": "https://stackoverflow.com/users/5896449/xthestreams"}, "edited": false, "score": 0, "creation_date": 1507217437, "post_id": 46575713, "comment_id": 80132083, "body": "@xthestreams thank you - that did enable the macro to work; however, the value given was &quot;-43074&quot;, which means that it&#39;s not working properly yet."}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1507217472, "post_id": 46575713, "comment_id": 80132104, "body": "@TotsieMae you&#39;re right! I apologize, I edited my code and missed that.  &quot;b&quot; should be &quot;ust&quot;.  I will update the question."}], "answers": [{"tags": [], "owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "is_accepted": true, "score": 0, "last_activity_date": 1507227452, "creation_date": 1507227452, "answer_id": 46592334, "question_id": 46575713, "link": "https://stackoverflow.com/questions/46575713/identifying-length-of-date-gap-given-list-of-dates/46592334#46592334", "title": "Identifying Length of Date Gap Given List of Dates", "body": "<pre><code>Sub IdentifyGaps()\n\nDim ws As Worksheet\nDim Date1 As Long, Date2 As Long, Gap As Long, lRow As Long\n\nSet ws = Sheet6\nlRow = ws.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\nFor x = 1 To ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    Date1 = ws.Cells(x, 1).Value\n    Date2 = ws.Cells(x + 1, 1).Value\n    Gap = DateDiff(\"d\", Date1, Date2)\n    If Gap &gt; 1 Then\n        ws.Range(\"C\" &amp; lRow).Value = Gap\n        lRow = lRow + 1\n    End If\nNext x\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "edited": false, "score": 0, "creation_date": 1507244559, "post_id": 46592560, "comment_id": 80144800, "body": "Thanks Ryan!  I just tried this and it seemed to work the first time, but the second time I got a Type Mismatch error at &#39;ReadArray=Sheet6.Range(&quot;A1&quot;).CurrentRegion&#39;, the only difference being that I was on Sheet1 when I ran it, which is what will happen when this workbook is used.  I don&#39;t know enough to know if that&#39;s the issue, but if so, what would I need to change to allow the script to run effectively regardless of the active sheet?"}, {"owner": {"reputation": 33, "user_id": 8650598, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n7M6sFV141Y/AAAAAAAAAAI/AAAAAAAAABc/WqAq6wwyx0A/photo.jpg?sz=128", "display_name": "Ryan W.", "link": "https://stackoverflow.com/users/8650598/ryan-w"}, "reply_to_user": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "edited": false, "score": 0, "creation_date": 1507297819, "post_id": 46592560, "comment_id": 80166408, "body": "@khelm <code>ActiveSheet</code> is the object the represents the Worksheet that is currently active. It has all the same properties and methods as any other <code>Worksheet</code> object (although in my experience IntelliSense does not recognize it as such, so won&#39;t autocomplete for you)."}], "tags": [], "owner": {"reputation": 33, "user_id": 8650598, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n7M6sFV141Y/AAAAAAAAAAI/AAAAAAAAABc/WqAq6wwyx0A/photo.jpg?sz=128", "display_name": "Ryan W.", "link": "https://stackoverflow.com/users/8650598/ryan-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1507228377, "creation_date": 1507228377, "answer_id": 46592560, "question_id": 46575713, "link": "https://stackoverflow.com/questions/46575713/identifying-length-of-date-gap-given-list-of-dates/46592560#46592560", "title": "Identifying Length of Date Gap Given List of Dates", "body": "<p>Looking at my calendar, I believe your expected result should actually be 17, not 15. This code will return the gap value as a <code>Long</code> value with which you can do whatever you want.</p>\n\n<pre><code>'Reads a column of dates and returns the length of the first gap found\nFunction IdentifyGaps() As Long\n    Dim StartDate As Date\n    Dim EndDate As Date\n\n    'This Variable is not needed for this solution, it is instead replaced by Gap\n    'Dim ust As Date\n    Dim Gap As Long\n\n    'Read cell values into an array for more efficient operation\n    Dim ReadArray() As Variant\n    ReadArray = Sheet6.Range(\"A1\").CurrentRegion\n\n    Dim LastRow As Long\n    LastRow = UBound(ReadArray, 1)\n\n    StartDate = ReadArray(1, 1)\n    EndDate = ReadArray(LastRow, 1)\n\n    'ThisDate and PreviousDate are declared explicitly to highlight program flow\n    Dim Row As Long\n    Dim ThisDate As Date\n    Dim PreviousDate As Date\n    For Row = 2 To UBound(ReadArray, 1)\n        ThisDate = ReadArray(Row, 1)\n        PreviousDate = ReadArray(Row - 1, 1)\n        Gap = ThisDate - PreviousDate\n        If Gap &gt; 1 Then Exit For\n        Gap = 0\n    Next Row\n\n    IdentifyGaps = Gap\nEnd Function\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\nSub ProveIt()\n    Debug.Print IdentifyGaps\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 46592334, "answer_count": 2, "score": 0, "last_activity_date": 1507228377, "creation_date": 1507160161, "last_edit_date": 1507218703, "question_id": 46575713, "link": "https://stackoverflow.com/questions/46575713/identifying-length-of-date-gap-given-list-of-dates", "title": "Identifying Length of Date Gap Given List of Dates", "body": "<p>I am trying to write a script that searches a list of dates, and identifyies how long date gaps are.  I'm new to VBA, and this may be completely wrong, but after referencing several sites, here is what I came up with:</p>\n\n<pre><code>Sub IdentifyGaps()\n\nDim startdate As Date 'first date in column\nDim enddate As Date 'last date in column\nDim ust As Date 'first date of unemployment\nDim i As Long\nust = ActiveCell.Offset(1, 0).Value\n\nWith Sheet6\n    startdate = [A1]\n    enddate = .Cells(.Rows.Count, \"A\").End(xlUp).Value\n\n    For i = startdate To enddate\n        If ust &lt;&gt; DateAdd(\"d\", 1, i) Then\n            Sheet6.[C1].Value = DateDiff(\"d\", i, ust)\n        End If\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I'm not receiving an error, but the macro is not working properly.  Right now, it's returning -43074 when it should be returning 15.  Any help would be much appreciated!</p>\n\n<p>Here is a screenshot of the data, with the lone date gap it should pick up.</p>\n\n<p><a href=\"https://i.stack.imgur.com/OZqEP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OZqEP.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "charts", "colors"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507163689, "post_id": 46575647, "comment_id": 80105639, "body": "If you added some sample data and a screenshot of a typical plot that&#39;s going to increase your chances of getting help."}, {"owner": {"reputation": 21, "user_id": 8723213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fecada1b4c6b5236872f0c92f1f02b9a?s=128&d=identicon&r=PG&f=1", "display_name": "Giles Walker", "link": "https://stackoverflow.com/users/8723213/giles-walker"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507227631, "post_id": 46575647, "comment_id": 80137750, "body": "Thanks for your advice - I have added some images showing what I need to get to, and the pivots currently being linked from."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1507269472, "post_id": 46575647, "comment_id": 80150220, "body": "looking at the charts, it does not look like you need VBA for this. the columns always retain the same color. just modify the style of each chart to fit the requirement."}], "answers": [{"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 4, "last_activity_date": 1507729520, "last_edit_date": 1507729520, "creation_date": 1507725953, "answer_id": 46688545, "question_id": 46575647, "link": "https://stackoverflow.com/questions/46575647/change-fill-color-of-series-on-chart/46688545#46688545", "title": "Change Fill Color Of Series On Chart", "body": "<p>Here's a simple little routine for your first question, recoloring the series in your chart blue, orange, and gray but reverse the default order:</p>\n\n<pre><code>Sub ReverseDefaultColors()\n  Dim iSrs As Long, nsrs As Long\n\n  If ActiveChart Is Nothing Then\n    MsgBox \"Select a chart and try again.\", vbExclamation, \"No Active Chart\"\n  Else\n    With ActiveChart\n      nsrs = .SeriesCollection.Count\n      ' work backwards from last series\n      For iSrs = nsrs To 1 Step -1\n        Select Case nsrs - iSrs\n          Case 0 ' last series\n            .SeriesCollection(iSrs).Format.Fill.ForeColor.ObjectThemeColor = _\n                msoThemeColorAccent1\n          Case 1 ' next to last series\n            .SeriesCollection(iSrs).Format.Fill.ForeColor.ObjectThemeColor = _\n                msoThemeColorAccent2\n          Case 2 ' etc.\n            .SeriesCollection(iSrs).Format.Fill.ForeColor.ObjectThemeColor = _\n                msoThemeColorAccent3\n        End Select\n      Next\n    End With\n  End If\nEnd Sub\n</code></pre>\n\n<p>Here's another for your second question, coloring green, light green, and red based on series name (adjust RGB as required). You should note that some people (about 8% of males, less than 1% of females) may have problems distinguishing between green and red. For this reason, blue and orange are often used as a preferred color scheme.</p>\n\n<pre><code>Sub ColorGreenToRed()\n  Dim iSrs As Long, nSrs As Long\n  If ActiveChart Is Nothing Then\n    MsgBox \"Select a chart and try again.\", vbExclamation, \"No Active Chart\"\n  Else\n    With ActiveChart\n      nSrs = .SeriesCollection.Count\n      For iSrs = 1 To nSrs\n        ' only format series whose names are found\n        Select Case LCase$(.SeriesCollection(iSrs).Name)\n          Case \"on time\"\n            .SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = _\n                RGB(0, 176, 80) ' Green\n          Case \"in tolerance\"\n            .SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = _\n                RGB(146, 208, 80) ' Light Green\n          Case \"late\"\n            .SeriesCollection(iSrs).Format.Fill.ForeColor.RGB = _\n                RGB(255, 0, 0) ' Red\n        End Select\n      Next\n    End With\n  End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8723213, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fecada1b4c6b5236872f0c92f1f02b9a?s=128&d=identicon&r=PG&f=1", "display_name": "Giles Walker", "link": "https://stackoverflow.com/users/8723213/giles-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15743, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1606402530, "creation_date": 1507159592, "last_edit_date": 1606402530, "question_id": 46575647, "link": "https://stackoverflow.com/questions/46575647/change-fill-color-of-series-on-chart", "title": "Change Fill Color Of Series On Chart", "body": "<p>I have two types of charts that will be populated into Excel by a BI tool. I need to colour the available series in them according to some rules.</p>\n<p>The <strong>first chart</strong> shows expenditure by year (year is the series), and there are varying degrees of history from a few months, up to 24 months.  This means my 24 months of data is spread over <em><strong>years</strong></em> 2015, 2016, 2017. Next year this changes to 2016, 2017, 2018 as I\u2019m keeping a rolling 24 months.</p>\n<p>Whatever the data set, I need the most recent year (e.g. 2017) in the bar chart data to be displayed in blue, the year before that (e.g. 2016) in orange, and then the year before that (e.g. 2015) in grey.</p>\n<p>It is possible I won\u2019t have 24 months (e.g. new clients). If there are only six months, the same colouring logic applies, and that most recent year would need to display in blue.</p>\n<p><strong>Expenditure Chart</strong>\n<img src=\"https://i.stack.imgur.com/dQQEV.jpg\" alt=\"\" /></p>\n<p>The <strong>second chart</strong> shows series values based on performance. These series are called  \u2018on time\u2019, \u2018in tolerance\u2019 and \u2018late\u2019.</p>\n<p>Their colours need to be: \u2018on time\u2019 = mid green, \u2018in tolerance\u2019 = light green, \u2018late\u2019 = red.</p>\n<p>1 <strong>or</strong> 2 <strong>or</strong> all 3 of these series may be present in a given chart with no predictability. I need the VBA to determine which series are available and colour accordingly.</p>\n<p><strong>Performance Chart</strong><br />\n<img src=\"https://i.stack.imgur.com/5u8Yv.jpg\" alt=\"\" /></p>\n<p>I cobbled together code from other feeds, and isn\u2019t a base to build from. I think I need to use ForEach type syntax, as I know I need to loop through each of the SeriesCollection objects.</p>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507164289, "post_id": 46575646, "comment_id": 80105783, "body": "&quot;search...&quot; is not equal to &quot;Search...&quot;"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1507269629, "post_id": 46575646, "comment_id": 80150272, "body": "tip #2: &quot;search...&quot; is equal to lcase(&quot;Search...&quot;)"}, {"owner": {"reputation": 27, "user_id": 8678518, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/647408fcf09d61e913980302232753e4?s=128&d=identicon&r=PG&f=1", "display_name": "n1xn1x", "link": "https://stackoverflow.com/users/8678518/n1xn1x"}, "edited": false, "score": 0, "creation_date": 1507656806, "post_id": 46575646, "comment_id": 80293697, "body": "Still doesn&#39;t seem to be working for some reason.  WHen I make that change IE navigates to a google search for: [*object HTMLInputElement].  I must be not be defining the SearchElements tag correctly right?"}], "owner": {"reputation": 27, "user_id": 8678518, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/647408fcf09d61e913980302232753e4?s=128&d=identicon&r=PG&f=1", "display_name": "n1xn1x", "link": "https://stackoverflow.com/users/8678518/n1xn1x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507159583, "creation_date": 1507159583, "question_id": 46575646, "link": "https://stackoverflow.com/questions/46575646/html-search-button-identify-interact-with-only-tag-name-and-value", "title": "HTML Search button - Identify &amp; Interact with only tag name and value", "body": "<p>I am writing a bit of code to enter text into the search bar of <a href=\"http://www.boxofficemojo.com/\" rel=\"nofollow noreferrer\">http://www.boxofficemojo.com/</a> and then hit \"search\".  I can input the appropriate text into the search bar but am having trouble actually clicking the link.  Here is my code:</p>\n\n<pre><code>Dim objIE As New InternetExplorer \nDim Doc As HTMLDocument\nDim oSearch As HTMLDivElement\nDim SearchElements As MSHTML.IHTMLElementCollection\nDim SearchButton As MSHTML.IHTMLElement\nWith objIE\n    .Visible = True\n    .Navigate \"http://www.boxofficemojo.com/\"\n        Do While objIE.Busy Or objIE.ReadyState &lt;&gt; 4\n            DoEvents\n        Loop\n    Set Doc = objIE.Document\nEnd With\n\nSet oSearch = Doc.forms(\"searchbox\").elements(\"q\")\n    oSearch.Value = \"Rogue One\"\nSet SearchElements = Doc.getElementsByTagName(\"input\")\n        For Each SearchButton In SearchElements\n            If SearchButton.Value = \"search...\" Then\n            SearchButton.Click\n            End If\n        Exit For\n            Next SearchButton\n</code></pre>\n\n<p>Any ideas?  I've experimented with doc.forms(3).submit but that seems inconsistent - sometimes it navigates me to the wrong webpage.  </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 159, "user_id": 5896449, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156759638110508/picture?type=large", "display_name": "xthestreams", "link": "https://stackoverflow.com/users/5896449/xthestreams"}, "edited": false, "score": 0, "creation_date": 1507165812, "post_id": 46575523, "comment_id": 80106106, "body": "I just tried your code and got the same results. As a hack you could try rerunning the function once when you get the 76 error code. When I did this it &quot;always&quot; (10,000 trials) returns the correct result of -1, compared to incorrect result 3 times in 10000 otherwise"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1507174842, "post_id": 46575523, "comment_id": 80107989, "body": "I would use <a href=\"https://msdn.microsoft.com/en-us/library/hww8txat(v=vs.84).aspx\" rel=\"nofollow noreferrer\">FileSystemObject</a> when it comes to network drives."}, {"owner": {"reputation": 11, "user_id": 6461825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8945a23796a7f9a405d28fb4fefc7c3?s=128&d=identicon&r=PG&f=1", "display_name": "dave76", "link": "https://stackoverflow.com/users/6461825/dave76"}, "edited": false, "score": 0, "creation_date": 1507591316, "post_id": 46575523, "comment_id": 80261842, "body": "Thanks xthestreams and PatricK, both of these approaches worked, I ended up going with FSO as the built-in FileExists and FolderExists methods allowed me to distinguish between the possible situations. I&#39;d like to accept the FSO answer and upvote the other, however I&#39;m new to Stack Overflow and am not seeing the upvote/accept options to the left of your answers that I think I need to use. I&#39;ll look more online to try to figure this out, thanks for the help in any case."}], "owner": {"reputation": 11, "user_id": 6461825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8945a23796a7f9a405d28fb4fefc7c3?s=128&d=identicon&r=PG&f=1", "display_name": "dave76", "link": "https://stackoverflow.com/users/6461825/dave76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1507158681, "creation_date": 1507158681, "question_id": 46575523, "link": "https://stackoverflow.com/questions/46575523/excel-vba-getting-file-status-on-a-network-path-is-inconsistent", "title": "Excel VBA: Getting File Status on a Network Path is Inconsistent", "body": "<p>I'm trying to fix an intermittent bug in an Excel VBA macro that I've boiled down to being due to Excel returning inconsistent error codes when running the Open command on a file on a network drive.</p>\n\n<p>The GEN_File_Status function below returns an integer code that my other code uses to determine the status of a file (passed as the fName argument). Some error codes (e.g., 52 &amp; 53) lead to the same value being returned, as my calling code does not need to distinguish between these. fName is expected to contain the full file path and filename.</p>\n\n<pre><code>Public Function GEN_File_Status(ByVal fName As String) As Integer\n\n  Dim fileInd As Long\n\n  On Error GoTo errHandle\n  fileInd = FreeFile()\n  Open fName For Input Lock Read As #fileInd\n  Close fileInd\n  On Error GoTo 0\n\n  GEN_File_Status = 0       ' File exists and is unopened\n  Exit Function\n\nerrHandle:\n  Select Case Err.Number\n    Case 52                 ' Bad filename or number\n      GEN_File_Status = -1\n    Case 53                 ' File not found\n      GEN_File_Status = -1\n    Case 70                 ' Permission denied (file may already be open)\n      GEN_File_Status = 1\n    Case 76                 ' Path not found\n      GEN_File_Status = -2\n    Case Else               ' Unknown error code\n      GEN_File_Status = -2\n  End Select\nEnd Function\n</code></pre>\n\n<p>This works fine if I'm running on a local drive, but when I run on a network drive I occasionally get crashes later in the calling code apparently due to Excel 'giving up' too quickly on establishing whether the filepath does not exist, or whether it just wasn't able to be determined over the network. This failure does not require the network to be all that slow by 'human' standards - based on the code execution time Excel must be giving up fairly quickly.</p>\n\n<p>To troubleshoot, I deliberately used an invalid path on the network in the fName argument, to see what error code Excel would return. Sure enough, I'm getting Err.Number = 76 (Path is not found) most of the time, but also getting Err.Number = 53 (File is not found) some of the time as well, which leads to problems in my calling code. Obviously both error codes are correct in some sense, but if alternatively I use an invalid path on my local C drive, I consistently get '76' error codes. So clearly the 'path not found' 76 error takes precedence, and I need a way to consistently determine this.</p>\n\n<p>Is there any way to tell Excel to more or less \"slow down and get the error code right\"? I tried inserting DoEvents before this to at least get the processor running optimally but this didn't help, so it does seem to be a network issue. Ultimately, using this or some other approach, I need a way to consistently distunguish between the following situations on a network drive:</p>\n\n<ol>\n<li><p>File exists already</p></li>\n<li><p>File does not exist, but the file path exists</p></li>\n<li><p>File path does not exist</p></li>\n</ol>\n\n<p>Any help would be appreciated, thanks.</p>\n"}, {"tags": ["html", "vba"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1507270437, "post_id": 46574934, "comment_id": 80150588, "body": "makes no sense what you are saying. i just recorded a query for that webpage and i was able to get any of the tables on that page."}, {"owner": {"reputation": 1, "user_id": 1399729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed588398ded960248990a00966a8a93?s=128&d=identicon&r=PG", "display_name": "bill", "link": "https://stackoverflow.com/users/1399729/bill"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1507291377, "post_id": 46574934, "comment_id": 80162181, "body": "thanks for looking at it, jsotola.  Can you show me your code for getting the team_pitching table?  If you view the source of this page and search for &quot;team_pitching&quot;, you&#39;ll find four occurrences.  The fourth one is the id for the table.  You&#39;ll see that that table is in an html comment: &lt; ! - -   and - - &gt;.  The QueryTable above doesn&#39;t seem to &quot;see&quot; that table and doesn&#39;t retrieve it."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1507310927, "post_id": 46574934, "comment_id": 80173957, "body": "just create a <code>new query</code> in the <code>data</code> tab, and have the macro recorder running while doing it. .... you will have to do it every time the webpage changes its format."}, {"owner": {"reputation": 1, "user_id": 1399729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed588398ded960248990a00966a8a93?s=128&d=identicon&r=PG", "display_name": "bill", "link": "https://stackoverflow.com/users/1399729/bill"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1507330017, "post_id": 46574934, "comment_id": 80181808, "body": "That&#39;s a great idea, jstola, but it didn&#39;t work for me.  When I try and &quot;Get External Data From the Web&quot;, the page selection window only offers me a single yellow-box arrow to select the entire page.  There are no yellow-box arrows for the individual tables (which seems really odd - after you suggested this, I remembered that I&#39;d done this before.)  Even if I import the entire page, though, it still only imports the team_batting table."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1507351189, "post_id": 46574934, "comment_id": 80185031, "body": "you are not reading what i wrote <code>new query</code>, not <code>Get External Data From the Web</code>"}, {"owner": {"reputation": 1, "user_id": 1399729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed588398ded960248990a00966a8a93?s=128&d=identicon&r=PG", "display_name": "bill", "link": "https://stackoverflow.com/users/1399729/bill"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1507393091, "post_id": 46574934, "comment_id": 80195412, "body": "I read &quot;new query&quot; but didn&#39;t know what you meant by that - I didn&#39;t see that option on the data tab.  I see now that you assumed I was using the same version of Excel that you are.  I do see that option on another computer with a newer version of Excel and the query did work (not exactly as I wanted, but I&#39;ll work on that), so thank you for your help jstola."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 1399729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed588398ded960248990a00966a8a93?s=128&d=identicon&r=PG", "display_name": "bill", "link": "https://stackoverflow.com/users/1399729/bill"}, "edited": false, "score": 0, "creation_date": 1507492949, "post_id": 46623551, "comment_id": 80220136, "body": "Thanks, jstola.  I was actually able to record the query on my work computer (which has a newer version of Excel), though I haven&#39;t had a chance to work through it yet.  I will compare what I captured against your version.  Thanks again - I appreciate your help."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1507400170, "creation_date": 1507400170, "answer_id": 46623551, "question_id": 46574934, "link": "https://stackoverflow.com/questions/46574934/vba-querytable-and-commented-out-table/46623551#46623551", "title": "VBA QueryTable and commented-out table", "body": "<p>since you are not able to record the query because of the excel version, here is a recording (prettyprinted)</p>\n\n<pre><code>Sub Macro1()\n\n    ActiveWorkbook.Queries.Add Name:=\"Team Pitching\", _\n        Formula:=\"let\" &amp; vbCrLf _\n               &amp; \"    Source = Web.Page(Web.Contents(\"\"https://www.baseball-reference.com/register/team.cgi?id=5983843c\"\")),\" &amp; vbCrLf _\n               &amp; \"    Data3 = Source{3}[Data],\" &amp; vbCrLf _\n               &amp; \"    #\"\"Changed Type\"\" = Table.TransformColumnTypes(\" _\n               &amp; \"                          Data3,{\" _\n               &amp; \"                                  {\"\"Rk\"\",   Int64.Type }, {\"\"Name\"\",  type text  }, \" _\n               &amp; \"                                  {\"\"Age\"\",  Int64.Type }, {\"\"W\"\",     Int64.Type }, \" _\n               &amp; \"                                  {\"\"L\"\",    Int64.Type }, {\"\"W-L%\"\",  type number}, \" _\n               &amp; \"                                  {\"\"ERA\"\",  type number}, {\"\"G\"\",     Int64.Type }, \" _\n               &amp; \"                                  {\"\"GS\"\",   Int64.Type }, {\"\"GF\"\",    Int64.Type }, \" _\n               &amp; \"                                  {\"\"CG\"\",   Int64.Type }, {\"\"SHO\"\",   Int64.Type }, \" _\n               &amp; \"                                  {\"\"SV\"\",   Int64.Type }, {\"\"IP\"\",    type number}, \" _\n               &amp; \"                                  {\"\"H\"\",    Int64.Type }, {\"\"R\"\",     Int64.Type }, \" _\n               &amp; \"                                  {\"\"ER\"\",   Int64.Type }, {\"\"HR\"\",    Int64.Type }, \" _\n               &amp; \"                                  {\"\"BB\"\",   Int64.Type }, {\"\"IBB\"\",   Int64.Type }, \" _\n               &amp; \"                                  {\"\"SO\"\",   Int64.Type }, {\"\"HBP\"\",   Int64.Type }, \" _\n               &amp; \"                                  {\"\"BK\"\",   Int64.Type }, {\"\"WP\"\",    Int64.Type }, \" _\n               &amp; \"                                  {\"\"BF\"\",   Int64.Type }, {\"\"WHIP\"\",  type number}, \" _\n               &amp; \"                                  {\"\"H9\"\",   type number}, {\"\"HR9\"\",   type number}, \" _\n               &amp; \"                                  {\"\"BB9\"\",  type number}, {\"\"SO9\"\",   type number}, \" _\n               &amp; \"                                  {\"\"SO/W\"\", type number}, {\"\"Notes\"\", type text  }  \" _\n               &amp; \"                                })\" &amp; vbCrLf _\n               &amp; \"in\" &amp; vbCrLf _\n               &amp; \"    #\"\"Changed Type\"\"\"\n\n    Sheets.Add After:=ActiveSheet           ' put data in new worsheet\n\n    With ActiveSheet.ListObjects.Add( _\n            SourceType:=0, _\n            Source:=\"OLEDB;\" _\n                  &amp; \"Provider=Microsoft.Mashup.OleDb.1;\" _\n                  &amp; \"Data Source=$Workbook$;\" _\n                  &amp; \"Location=\"\"Team Pitching\"\"\", _\n            Destination:=Range(\"$A$1\")).QueryTable\n\n        .CommandType = xlCmdSql\n        .CommandText = Array(\"SELECT * FROM [Team Pitching]\")\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .PreserveColumnInfo = False\n        .ListObject.DisplayName = \"Team_Pitching\"\n        .Refresh BackgroundQuery:=False\n    End With\n\n    Selection.ListObject.QueryTable.Refresh BackgroundQuery:=False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 1399729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed588398ded960248990a00966a8a93?s=128&d=identicon&r=PG", "display_name": "bill", "link": "https://stackoverflow.com/users/1399729/bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 229, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507400170, "creation_date": 1507154975, "question_id": 46574934, "link": "https://stackoverflow.com/questions/46574934/vba-querytable-and-commented-out-table", "title": "VBA QueryTable and commented-out table", "body": "<p>I have a VBA routine that used QueryTable.Add very successfully to insert a table from a web page into my worksheet - last year.  I'm trying to import minor league baseball stats from (for example) the following page:  <a href=\"https://www.baseball-reference.com/register/team.cgi?id=5983843c\" rel=\"nofollow noreferrer\">https://www.baseball-reference.com/register/team.cgi?id=5983843c</a></p>\n\n<p>The routine below worked fine last year, but this year Baseball-Reference is rendering their page a little differently.  What is odd is that the team_batting table is normal html code and the team_pitching table is \"commented out\" with  tags.  It still displays in a browser, though - it looks like there is some code somewhere that extracts the team_pitching table from the comment and displays it.  You can see this behavior when you load the page - team_batting comes right up and there is a briefly-blank frame that is then filled with the team_pitching table.  The QueryTable command still works fine for the team_batting table, but ignores the team_pitching table.</p>\n\n<p>This worked so beautifully for the past few years ... any idea on how to get around this problem?</p>\n\n<p>Here's my code:</p>\n\n<pre><code>    InsertAt = ActiveCell.Address(False, False)\nWith ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; PgURL, Destination:=Range(InsertAt))\n    .Name = \"team\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlSpecifiedTables\n    .WebFormatting = xlWebFormattingAll\n    .WebTables = \"\"\"team_batting\"\"\"\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = False\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\n    .Delete\nEnd With\n\nSet FirstBlankCell = Range(\"C\" &amp; Rows.count).End(xlUp).Offset(2, 0)\nFirstBlankCell.Activate\n\nInsertAt = ActiveCell.Address(False, False)\n\nWith ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; PgURL, Destination:=Range(InsertAt))\n    .Name = \"team\"\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = False\n    .RefreshOnFileOpen = False\n    .BackgroundQuery = True\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .WebSelectionType = xlSpecifiedTables\n    .WebFormatting = xlWebFormattingAll\n    .WebTables = \"\"\"team_pitching\"\"\"\n    .WebPreFormattedTextToColumns = True\n    .WebConsecutiveDelimitersAsOne = True\n    .WebSingleBlockTextImport = False\n    .WebDisableDateRecognition = False\n    .WebDisableRedirections = False\n    .Refresh BackgroundQuery:=False\n    .Delete\nEnd With\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1766, "user_id": 1670134, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/L4ejd.jpg?s=128&g=1", "display_name": "sirandy", "link": "https://stackoverflow.com/users/1670134/sirandy"}, "edited": false, "score": 0, "creation_date": 1507156662, "post_id": 46574902, "comment_id": 80103970, "body": "Could you be more specific? If you could put an expected output."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8722993, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LcpQVWzzcM8/AAAAAAAAAAI/AAAAAAAAAhk/vlgZn1BVImw/photo.jpg?sz=128", "display_name": "SP Syd Pierr", "link": "https://stackoverflow.com/users/8722993/sp-syd-pierr"}, "edited": false, "score": 0, "creation_date": 1507186276, "post_id": 46577768, "comment_id": 80111791, "body": "Thanks !  I works on the sleceted sheet. I have actually 6 sheets in the workbook."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "reply_to_user": {"reputation": 1, "user_id": 8722993, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LcpQVWzzcM8/AAAAAAAAAAI/AAAAAAAAAhk/vlgZn1BVImw/photo.jpg?sz=128", "display_name": "SP Syd Pierr", "link": "https://stackoverflow.com/users/8722993/sp-syd-pierr"}, "edited": false, "score": 0, "creation_date": 1507244288, "post_id": 46577768, "comment_id": 80144738, "body": "@SPSydPierr If all these 6 worksheets require the same check, you need to create a generic sub in a normal module, and paste 2nd part into each worksheet module and calling the Sub (pass the Target Range instead of the row). The generic sub can get the worksheet from the range."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1507177028, "creation_date": 1507177028, "answer_id": 46577768, "question_id": 46574902, "link": "https://stackoverflow.com/questions/46574902/how-to-make-several-columns-mandatory-basing-on-1-other-column/46577768#46577768", "title": "How to make several columns mandatory basing on 1 other column", "body": "<p>You need to check if the Column C is empty before going to loop into the columns.</p>\n\n<p>Code below is doing what you after, but why check only when workbook is before save? If those columns are madatory for that particular worksheet, you should use the worksheet events (<strong>Worksheet_Activate</strong>, <strong>Worksheet_SelectionChange</strong>), tracking the current selected row and when selection changed row, check for column C, etc.</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n\n    Dim rngCell As Range\n    Dim lngLstRow As Long, lngRow As Long\n    Dim arrColsToCheck As Variant, oItem As Variant\n\n    arrColsToCheck = Array(\"E\", \"I\", \"J\", \"L\", \"M\")\n\n    With ActiveSheet ' Only 1 sheet in workbook?\n        lngLstRow = .UsedRange.SpecialCells(xlLastCell).Row\n        For lngRow = 1 To lngLstRow\n            ' Check if column C is filled (not empty)\n            If Not IsEmpty(.Cells(lngRow, \"C\")) Then\n                ' Check the mandatory columns\n                For Each oItem In arrColsToCheck\n                    Set rngCell = .Cells(lngRow, oItem)\n                    If IsEmpty(rngCell) Then\n                        rngCell.Select\n                        MsgBox (\"Please enter an input in cell \" &amp; rngCell.Address(0, 0))\n                    End If\n                    Set rngCell = Nothing\n                Next\n            End If\n        Next lngRow\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>For code on the Worksheet that requires this check:</p>\n\n<pre><code>Option Explicit\n\nPrivate ActiveRow As Long\n\nPrivate Sub Worksheet_Activate()\n    ActiveRow = ActiveCell.row\nEnd Sub\n\nPrivate Sub Worksheet_SelectionChange(ByVal Target As Range)\n    If Target.row &lt;&gt; ActiveRow Then\n        ' Call the Column C check for Madatory fields, passing the ActiveRow to it\n        ' You implement this Sub with a \"Long\" as argument\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8722993, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LcpQVWzzcM8/AAAAAAAAAAI/AAAAAAAAAhk/vlgZn1BVImw/photo.jpg?sz=128", "display_name": "SP Syd Pierr", "link": "https://stackoverflow.com/users/8722993/sp-syd-pierr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507177028, "creation_date": 1507154751, "question_id": 46574902, "link": "https://stackoverflow.com/questions/46574902/how-to-make-several-columns-mandatory-basing-on-1-other-column", "title": "How to make several columns mandatory basing on 1 other column", "body": "<p>I'm having an issue making 5 columns to be filled mandatory (E I J L M) if the cells in a column (C) is filled.</p>\n\n<p>i have written this code but i really having trouble linking the column C to that :(</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, _\nCancel As Boolean)\n\n\nDim rngCell As Range\nDim lngLstRow As Long, lngTCols As Long\nDim lngRowCheck(1 To 5) As String\n\n\nlngRowCheck(1) = \"E\"\nlngRowCheck(2) = \"I\"\nlngRowCheck(3) = \"J\"\nlngRowCheck(4) = \"L\"\nlngRowCheck(5) = \"M\"\n\nlngLstRow = ActiveSheet.UsedRange.Rows.Count\n\nFor i = 1 To UBound(lngRowCheck)\n    For Each rngCell In Range(lngRowCheck(i) &amp; \"2:\" &amp; lngRowCheck(i) &amp; lngLstRow)\n        If rngCell.Value = \"\" Then\n            MsgBox (\"Please enter an input in cell \" &amp; rngCell.Address)\n            rngCell.Select\n        End If\n    Next\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1507156410, "post_id": 46574842, "comment_id": 80103902, "body": "Maybe with <code>CallByName</code>, see <a href=\"https://stackoverflow.com/questions/21661103/using-callbyname-with-an-event-sink-for-a-field-on-a-form\" title=\"using callbyname with an event sink for a field on a form\">stackoverflow.com/questions/21661103/&hellip;</a>"}, {"owner": {"reputation": 33, "user_id": 8650598, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n7M6sFV141Y/AAAAAAAAAAI/AAAAAAAAABc/WqAq6wwyx0A/photo.jpg?sz=128", "display_name": "Ryan W.", "link": "https://stackoverflow.com/users/8650598/ryan-w"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1507219561, "post_id": 46574842, "comment_id": 80133327, "body": "@Andre Alright, I tried <code>CallByName Me, CtrlName &amp; &quot;_AfterUpdate&quot;, vbMethod, Array(...valid arguements...)</code> and it didn&#39;t work. I think I&#39;m just going to call <code>ToggleGroup</code> on its own and pass it <code>iTag</code>."}], "owner": {"reputation": 33, "user_id": 8650598, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n7M6sFV141Y/AAAAAAAAAAI/AAAAAAAAABc/WqAq6wwyx0A/photo.jpg?sz=128", "display_name": "Ryan W.", "link": "https://stackoverflow.com/users/8650598/ryan-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594638997, "creation_date": 1507154389, "last_edit_date": 1594638997, "question_id": 46574842, "link": "https://stackoverflow.com/questions/46574842/programmatically-assign-then-trigger-control-event-handler", "title": "Programmatically assign then trigger control event handler", "body": "<p>I have a form with several groups of controls and I want to be able to toggle enabled/disabled those groups individually with a Toggle Button control. When the form loads, I programmatically assign a UDF called <code>ToggleGroup</code> to each toggle button's <code>AfterUpdate()</code> event handler. I have tested this part of the code and know that it performs as intended.</p>\n\n<p>I want the groups to start in a disabled state, so I want to trigger the <code>AfterUpdate()</code> handler for each toggle button after I assign the function. I know that I could achieve this in a few other ways (I could change the properties of the grouped controls in Design View or I could call <code>ToggleGroup</code> on them as part of the form's initialization), but for my own curiosity and interest, I want to know if the method I described is feasible.</p>\n\n<pre><code>'''GroupTags is a collection of all Tags associated with control groups\nFor Each iTag In GroupTags\n    CtrlName = \"Toggle_\" &amp; iTag\n\n    Me(CtrlName).AfterUpdate = _\n        \"=ToggleGroup( ...valid arguments... )\"\n\n    '''Here: trigger the AfterUpdate event for this control based on CtrlName\nNext iTag\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1507152952, "post_id": 46574565, "comment_id": 80102652, "body": "Remove the <code>()</code> around <code>xlPasteValues</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1507152991, "post_id": 46574565, "comment_id": 80102666, "body": "And change <code>&quot;E3&quot;</code> to <code>&quot;E3:E&quot;</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1507153621, "post_id": 46574565, "comment_id": 80102913, "body": "@ScottCraner that also needs a <code>.Row</code> if the OP wants a single column copied, but I think they want <code>Range(&quot;E3&quot;,.Range(&quot;P&quot; &amp; .Rows.Count).End(xlUp))</code> to get multiple columns"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1507153774, "post_id": 46574565, "comment_id": 80102974, "body": "Which cells are you trying to copy - something like E3:E456?  Or something like E3:P456?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1507153798, "post_id": 46574565, "comment_id": 80102986, "body": "If you just need values, you could do <code>.Range(&quot;D3:D&quot; &amp; .Range(&quot;C&quot; &amp; .Rows.Count).End(xlUp).Row).Value = .Range(&quot;E3:E&quot; &amp; .Range(&quot;P&quot; &amp; .Rows.Count).End(xlUp).Row).Value</code>  Assuming you mean to copy column E data, and not <code>E:P</code>  ...even if that&#39;s not truly right, just set the ranges&#39; values equal to eachother, it is faster and avoids using the clipboard."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507153813, "post_id": 46574565, "comment_id": 80102999, "body": "And does column C and column P always have the same number of rows populated?"}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1507153911, "post_id": 46574565, "comment_id": 80103043, "body": "I made a post regarding <a href=\"https://stackoverflow.com/a/30406676/2685412\">Range Syntax</a> before and I think this will help you. Now, on top of what Scott and YowE3k said (and Bruce), make sure you reference all your objects explicitly when you use <code>With Clause</code> by preceding all objects associated to the worksheet with a dot. Also, you shouldn&#39;t be using <code>&amp;</code> but a comma <code>,</code> instead in your copy line."}, {"owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507154038, "post_id": 46574565, "comment_id": 80103087, "body": "@YowE3K, yes, I am trying to copy a range like E3:P456"}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1507154323, "creation_date": 1507154323, "answer_id": 46574827, "question_id": 46574565, "link": "https://stackoverflow.com/questions/46574565/i-cannot-figure-out-why-my-copy-and-paste-is-not-working-vba/46574827#46574827", "title": "I cannot figure out why my copy and paste is not working VBA?", "body": "<p>To fix your code using your current methodology:</p>\n\n<pre><code>With PTrend\n    If .Range(\"P3\").Value &gt; 0 Then\n        .Range(\"E3\", .Range(\"P\" &amp; .Rows.Count).End(xlUp)).Copy\n        .Range(\"D3:D\" &amp; .Range(\"P\" &amp; .Rows.Count).End(xlUp).Row).PasteSpecial xlPasteValues\n    End If    \nEnd With\n</code></pre>\n"}], "owner": {"reputation": 285, "user_id": 8151230, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/526acc467e32a5fc6068f8e8ec58d772?s=128&d=identicon&r=PG&f=1", "display_name": "GCC", "link": "https://stackoverflow.com/users/8151230/gcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 46574827, "answer_count": 1, "score": 0, "last_activity_date": 1507154323, "creation_date": 1507152818, "question_id": 46574565, "link": "https://stackoverflow.com/questions/46574565/i-cannot-figure-out-why-my-copy-and-paste-is-not-working-vba", "title": "I cannot figure out why my copy and paste is not working VBA?", "body": "<p>I have been sitting for a while trying to figure out why this code isnt working.</p>\n\n<pre><code>With PTrend\n\n    If Range(\"P3\") &gt; 0 Then\n        .Range(\"E3\" &amp; .Range(\"P\" &amp; Rows.Count).End(xlUp)).Copy\n        .Range(\"D3:D\" &amp; .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row).PasteSpecial (xlPasteValues)\n    End If\n\nEnd With\n</code></pre>\n\n<p>I am trying to copy the range E3 to the last row of P and paste the special values starting in D3. For some reason, it is taking cell E30 and using that value as all the values to copy and paste</p>\n\n<p>Any help would be greatly appreciated.</p>\n\n<p>Thanks,</p>\n\n<p>G</p>\n"}, {"tags": ["vba", "excel", "hyperlink", "vlookup"], "comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1507152180, "post_id": 46574342, "comment_id": 80102362, "body": "You cannot have hyperlink on msgbox - <a href=\"https://stackoverflow.com/questions/28705916/putting-a-hyperlink-in-a-messagebox\" title=\"putting a hyperlink in a messagebox\">stackoverflow.com/questions/28705916/&hellip;</a>"}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1507155619, "post_id": 46574342, "comment_id": 80103624, "body": "Hyperlink to where? why do you need a hyperlink?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1507175538, "post_id": 46574342, "comment_id": 80108147, "body": "You can&#39;t have a hyperlink on a <code>MsgBox</code>, but you could put up a <code>vbYesNo</code> box and ask the user if they want to follow the hyperlink, then programatically send them to it."}, {"owner": {"reputation": 11, "user_id": 8722855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06fe6b36ba1e51275231abb8c8a1bca5?s=128&d=identicon&r=PG&f=1", "display_name": "Stoke_man", "link": "https://stackoverflow.com/users/8722855/stoke-man"}, "edited": false, "score": 0, "creation_date": 1507186044, "post_id": 46574342, "comment_id": 80111681, "body": "Thanks for your replies. How do i put a vbYesNo box on to the end of my macro with the option to programatically send them the relevant hyperlink?"}, {"owner": {"reputation": 11, "user_id": 8722855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06fe6b36ba1e51275231abb8c8a1bca5?s=128&d=identicon&r=PG&f=1", "display_name": "Stoke_man", "link": "https://stackoverflow.com/users/8722855/stoke-man"}, "edited": false, "score": 0, "creation_date": 1507188990, "post_id": 46574342, "comment_id": 80113275, "body": "I wanted some way of giving the option to view or be redirected the relevent file that was returned by the vlookup. Is that possible?"}], "owner": {"reputation": 11, "user_id": 8722855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06fe6b36ba1e51275231abb8c8a1bca5?s=128&d=identicon&r=PG&f=1", "display_name": "Stoke_man", "link": "https://stackoverflow.com/users/8722855/stoke-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1507168279, "answer_count": 0, "score": 0, "last_activity_date": 1507152038, "creation_date": 1507151892, "last_edit_date": 1531164843, "question_id": 46574342, "link": "https://stackoverflow.com/questions/46574342/vba-to-return-hyperlink", "closed_reason": "Duplicate", "title": "VBA to return hyperlink", "body": "<p>I have written a macro that performs a <code>VLookup</code> but I need it to return a hyperlink and not just a text string. There is a hyperlink in the range so all I need it to do is copy it into my result.</p>\n\n<p>How can I change this VBA?</p>\n\n<pre><code>Sub check()\n    On Error GoTo MyerrorHandler:\n    Dim claim_number As String\n    Dim here As String\n    claim_number = InputBox(\"please enter claim number\")\n    If Len(claim_number) &gt; 0 Then\n    Set myrange = Range(\"claims\")\n    here = Application.WorksheetFunction.VLookup(claim_number, myrange, 3, False)\n    MsgBox \"Claim has been investigted, info is here \" &amp; here\n\n    Else\n    MsgBox \"You didn't enter a claim number\"\n    End If\n    Exit Sub\n\n    MyerrorHandler:\n    If Err.Number = 1004 Then\n    MsgBox \"Claim has not been invsetigated\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The <code>VLookup</code> works fine but instead of copying the hyperlink from my range it just returns the text. I have tried everything but cannot get it to work.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1507152741, "post_id": 46574322, "comment_id": 80102562, "body": "What&#39;s the deal with 65,536 rows? (2^16-1 is 65,535 BTW, i.e. 65,536 <i>already</i> overflows a <code>uint16</code>). Are you running 32-bit Excel? I&#39;m looking at a successful <code>INDEX</code> result here, pulling an item at index 65538 out of a column with 1048576 rows, no problems. Also your answer looks like it&#39;s begging for upvotes, something that tends to attract the opposite reaction."}, {"owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507153823, "post_id": 46574322, "comment_id": 80103006, "body": "@Mat&#39;sMug I sure would like some Rep :).  I will update the title to &gt;=.  Did you pass an array as column criteria and have success?"}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1507159089, "post_id": 46574322, "comment_id": 80104590, "body": "What do you need the <code>Application.Index()</code> function for, as long as you are using VBA? Wouldn&#39;t <code>MyRange.Cells(x, y)</code> work for you?"}, {"owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "reply_to_user": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1507159746, "post_id": 46574322, "comment_id": 80104736, "body": "@Gene I&#39;m trying to fill an entire array and using index on entire columns.  Not just a single cell.  You suggest a for loop through cells?  Great.  Post up an answer.  I hope to time all the responses to find the fastest."}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1507160587, "post_id": 46574322, "comment_id": 80104894, "body": "@Joshua: No, I am not suggesting looping through cells. Apparently I misunderstood you reference to the Index()? If you are you using it to get to you data the Range.Cells works, or if you are trying to use it to collect your data then how would you even do that?"}, {"owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "reply_to_user": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1507161819, "post_id": 46574322, "comment_id": 80105206, "body": "@Gene Read the answer I posted.  I said I had one."}], "answers": [{"tags": [], "owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "is_accepted": false, "score": 0, "last_activity_date": 1507154601, "last_edit_date": 1507154601, "creation_date": 1507151816, "answer_id": 46574323, "question_id": 46574322, "link": "https://stackoverflow.com/questions/46574322/how-do-i-use-index-to-create-a-2d-variant-array-of-non-adjacent-columns-greate/46574323#46574323", "title": "How do I use Index() to create a 2D Variant Array of non adjacent columns greater than or equal to 65536 rows", "body": "<h2>One Very Fast Solution:  .Evaluate()</h2>\n\n<p><code>Application.Index([Range/Array],[Row],[Column])</code> is an extremely useful function.  </p>\n\n<h1>Answer:</h1>\n\n<pre><code>Dim arr as Variant 'This is the array you want to create.\nDim varRows as Variant 'This will hold the rows want to index\nDim LastRow as Long 'This is the last row of data you are needing\n\nLastRow = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row  'set the last row\n\nvarRows = Evaluate(\"row(1:\" &amp; LastRow &amp; \")\") 'Evaluate is the make or break here. You can modify your start row as well by changing the 1.\n\narr = Application.Index(Sheets(\"Sheet1\").Cells, varRows, Array(1, 3, 5)) 'You can set your array to be any columns you want.\n\n'arr will now be a 2D array arr(1 to varRows, 1 to 3) in this example.\n</code></pre>\n\n<p>This method is so very fast it is dumb.  It beats the pants off of a For Loop.<br>\nI passed a Range in this example but an array can also be passed if you need to Slice out 1 or more columns into a new array</p>\n\n<h1>Slice columns from an existing array Of any Type!:</h1>\n\n<p>This creates a Variant array and variants are so easy to get and return to the sheet.</p>\n\n<pre><code>Dim arr as Variant 'This is the array you want to create.\nDim SmallerArr as Variant 'the new array\nDim varRows as Variant 'This will hold the rows want to index\nDim LastRow as Long 'This is the last row of data you are needing\n\nLastRow = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row  'set the last row\n\nvarRows = Evaluate(\"row(1:\" &amp; LastRow &amp; \")\") 'Evaluate is the make or break here. You can modify your start row as well by changing the 1.\n\narr = Application.Index(Sheets(\"Sheet1\").Cells, varRows, Array(1, 3, 5)) 'You can set your array to be any columns you want.\n\n'read a single column into a new variant array\nSmallerArr = Application.Index(arr, varRows, 1) 'You can set your array to be any columns you want.\n\n'read multiple columns into a new variant array\nSamllerArr = Application.Index(arr, varRows, Array(1, 2)) 'The columns must exist in arr or you will get an error.\n\nDim lngArr(1 To 100000, 1 To 3) As Long 'create 2D array of type long\n'Fill array\nFor h = 1 To 3\n    For j = 1 To 100000\n        lngArr(j, h) = j * h\n    Next j\nNext h\n\nSamllerArr = Application.Index(lngArr, varRows, Array(1, 2)) 'The columns must\n'we just turned a long array into a variant array!\n'we can read it to the sheet without a For loop!\n</code></pre>\n\n<h1>Read columns back to the sheet:</h1>\n\n<pre><code>Dim arr as Variant 'This is the array you want to create.\nDim SmallerArr as Variant 'the new array\nDim varRows as Variant 'This will hold the rows want to index\nDim LastRow as Long 'This is the last row of data you are needing\n\nLastRow = Sheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row  'set the last row\n\nvarRows = Evaluate(\"row(1:\" &amp; LastRow &amp; \")\") 'Evaluate is the make or break here. You can modify your start row as well by changing the 1.\n\narr = Application.Index(Sheets(\"Sheet1\").Cells, varRows, Array(1, 3, 5)) 'You can set your array to be any columns you want.\n\n'Read 1 column to the sheet\nSheets(\"Sheet2\").Range(\"A1:A\" &amp; LastRow) = Application.Index(arr, varRows, 1) ' cange the range and column accordingly\n\n'Read multiple columns to the sheet\nSheets(\"Sheet2\").Range(\"A1:B\" &amp; LastRow) = Application.Index(arr, varRows, Array(1, 2))\n</code></pre>\n\n<h1>Notes:</h1>\n\n<p>1)  <code>varRows</code> can be modified to accept any position of elements.</p>\n\n<p>2)  In Excel 2013 at least, when using <code>Index()</code> without passing arrays as arguments for row/column, there does not appear to be any row limitations.  </p>\n\n<p>3A)  All arrays created this way are 2D.  Even if they are 1 column they are still 1 wide.</p>\n\n<p>3B)  <code>Application.Transpose()</code> has row limitations as well just in case you were trying it...</p>\n"}, {"comments": [{"owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "edited": false, "score": 0, "creation_date": 1507162076, "post_id": 46575903, "comment_id": 80105275, "body": "A 3D array.  Neat"}], "tags": [], "owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "is_accepted": false, "score": 0, "last_activity_date": 1507161578, "creation_date": 1507161578, "answer_id": 46575903, "question_id": 46574322, "link": "https://stackoverflow.com/questions/46574322/how-do-i-use-index-to-create-a-2d-variant-array-of-non-adjacent-columns-greate/46575903#46575903", "title": "How do I use Index() to create a 2D Variant Array of non adjacent columns greater than or equal to 65536 rows", "body": "<p>I am not quite sure how to interpret the question but here is a method (two variations) of doing what I guess is asked for. This can be expanded/automated/adjusted as desired.</p>\n\n<pre><code>Sub ForJoshua1()\n' Say, you want 2 columns: \"B:B\", \"H:H\"\n    Dim vX(1 To 2) As Variant\n    vX(1) = Range(\"B:B\")\n    vX(2) = Range(\"H:H\")\nEnd Sub\n\nSub ForJoshua2()\n' Say, you want 2 columns: 2, 8\n    Dim vX(1 To 2) As Variant\n    vX(1) = Sheet1.Columns(2)\n    vX(2) = Sheet1.Columns(8)\nEnd Sub\n</code></pre>\n\n<p>If you have an \"a\" in the cell \"B12\", for example, then\n   <code>vX(1)(12,1)</code> would equal \"a\"</p>\n"}], "owner": {"reputation": 211, "user_id": 8651782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27d71f253fb066108065e8b7ff5a747f?s=128&d=identicon&r=PG&f=1", "display_name": "Joshua Fenner", "link": "https://stackoverflow.com/users/8651782/joshua-fenner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1507161578, "creation_date": 1507151816, "last_edit_date": 1531164843, "question_id": 46574322, "link": "https://stackoverflow.com/questions/46574322/how-do-i-use-index-to-create-a-2d-variant-array-of-non-adjacent-columns-greate", "title": "How do I use Index() to create a 2D Variant Array of non adjacent columns greater than or equal to 65536 rows", "body": "<p>I want to create a 2D variant array from data in a worksheet.  The issue is The columns I want to use are not adjacent and the amount of elements exceeds 65,536. (the apparent limit for <code>Application.Index()</code> using an <code>Array()</code> as <code>Arg3</code>.  How should I proceed?</p>\n\n<p>I have an answer to this question that works for me. I have read a great deal on this topic and I am curious if anyone else has had significant success with any other methods, because they are out there.</p>\n"}, {"tags": ["vba", "internet-explorer"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1507147886, "post_id": 46573301, "comment_id": 80100401, "body": "Change <code>mahSub (ieIE)</code> to <code>mahSub ieIE</code> - putting brackets around it is forcing it to be converted from an object to the object&#39;s default property."}, {"owner": {"reputation": 1, "user_id": 8359883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c153a7b7ecba45d2e34929f562603c4?s=128&d=identicon&r=PG&f=1", "display_name": "KonserNad756BC", "link": "https://stackoverflow.com/users/8359883/konsernad756bc"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507147957, "post_id": 46573301, "comment_id": 80100429, "body": "Thanks a bunch, sorry for wasting your time, @YowE3K. <i>Feeling deeply dumb</i> This post should be shut down."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1507148001, "post_id": 46573301, "comment_id": 80100451, "body": ":D (We&#39;ve all been there!)"}], "owner": {"reputation": 1, "user_id": 8359883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c153a7b7ecba45d2e34929f562603c4?s=128&d=identicon&r=PG&f=1", "display_name": "KonserNad756BC", "link": "https://stackoverflow.com/users/8359883/konsernad756bc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 17, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507147505, "creation_date": 1507147505, "question_id": 46573301, "link": "https://stackoverflow.com/questions/46573301/procedure-type-influence-on-outcome-typename-and-typeof-behaving-differently-in", "title": "Procedure Type Influence On Outcome: TypeName and TypeOf Behaving Differently Inside Subs and Functions", "body": "<p>Working with Win64, VBA7 32bits on a simple combo of procedures to do things to an instance of Internet Explorer (IE instance), I've found that:</p>\n\n<p>a. the function correctly identifies the IE instance type as IWebBrowser2;</p>\n\n<p>b. the sub incorrectly identifies the IE instance type as String.</p>\n\n<p>Would anyone gently share why?</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>Sub SimpleTest()\n    Dim iemIE As InternetExplorer\n    Dim oDummy As Object\n\n    Set ieIE = New InternetExplorer\n\n    Set oDummy = mahFunction(ieIE)\n\n    mahSub (ieIE)\n\n    ieIE.Quit\nEnd Sub\n\nFunction mahFunction(InternetExplorerThatHasMahObject As Variant) As Object\n    Dim sFunctionTypeName As String\n    Dim bFunctionTestIE As Boolean, bFunctionTestIEM As Boolean\n\n    sFunctionTypeName = TypeName(InternetExplorerThatHasMahObject) 'returns \"IWebBrowser2\"\n    bFunctionTestIE = TypeOf InternetExplorerThatHasMahObject Is InternetExplorer 'returns True\n    bFunctionTestIEM = TypeOf InternetExplorerThatHasMahObject Is InternetExplorerMedium 'returns True\n\n    MsgBox sFunctionTypeName &amp; \", \" &amp; bFunctionTestIE &amp; \", \" &amp; bFunctionTestIEM\n\n    Set mahFunction = Nothing\nEnd Function\n\nSub mahSub(InternetExplorerToWaitFor As Variant)\n    Dim sSubTypeName As String\n    Dim bSubTestIE As Boolean, bSubTestIEM As Boolean\n\n    sSubTypeName = TypeName(InternetExplorerToWaitFor) 'returns \"String\"\n    bSubTestIE = TypeOf InternetExplorerToWaitFor Is InternetExplorer 'returns False\n    bSubTestIEM = TypeOf InternetExplorerToWaitFor Is InternetExplorerMedium 'returns False\n\n    MsgBox sSubTypeName &amp; \", \" &amp; bSubTestIE &amp; \", \" &amp; bSubTestIEM\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1507147230, "post_id": 46572864, "comment_id": 80100045, "body": "Do you want this for a <b>row</b> or a <b>column</b> ??"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1507147380, "post_id": 46572864, "comment_id": 80100122, "body": "Will there be any <b>empty</b> cells between the first data point and the last datapoint ??"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1507147666, "post_id": 46572864, "comment_id": 80100272, "body": "Do you want to include the last 6 cells from the last value or the last 6 values skipping any blanks?"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 6320750, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bc546db4533a133f87c7130f6c14961e?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny T.", "link": "https://stackoverflow.com/users/6320750/kenny-t"}, "edited": false, "score": 0, "creation_date": 1507215478, "post_id": 46573369, "comment_id": 80130745, "body": "Hi Scott, how do you work around it if there aren&#39;t 6 values in the cell? Say there&#39;s only 2 input, the formula will come out as a #NUM!. How can you tweak it to be dynamic in a way that it averages out even when there are less than 6 values in place?  =AVERAGE(INDEX(135:135,AGGREGATE(14,6,COLUMN(H135:AA135)/(H1&zwnj;&#8203;35:AA135&lt;&gt;&quot;&quot;),IF(COU&zwnj;&#8203;NTA(H135:AA135)&lt;6,CO&zwnj;&#8203;UNTA(H135:AA135),6))&zwnj;&#8203;):INDEX(135:135,AGGR&zwnj;&#8203;EGATE(14,6,COLUMN(H1&zwnj;&#8203;35:AA135)/(H135:AA13&zwnj;&#8203;5&lt;&gt;&quot;&quot;),1)))"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 1, "last_activity_date": 1507147853, "creation_date": 1507147853, "answer_id": 46573369, "question_id": 46572864, "link": "https://stackoverflow.com/questions/46572864/average-the-last-6-records-entered-within-the-row/46573369#46573369", "title": "Average the last 6 records entered within the row", "body": "<p>To get the last 6 values in a row, excluding all blanks:</p>\n\n<pre><code>=AVERAGE(INDEX(135:135,AGGREGATE(14,6,COLUMN(H135:AA135)/(H135:AA135&lt;&gt;\"\"),6)):INDEX(135:135,AGGREGATE(14,6,COLUMN(H135:AA135)/(H135:AA135&lt;&gt;\"\"),1)))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 43, "user_id": 6320750, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bc546db4533a133f87c7130f6c14961e?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny T.", "link": "https://stackoverflow.com/users/6320750/kenny-t"}, "edited": false, "score": 0, "creation_date": 1507167725, "post_id": 46574693, "comment_id": 80106502, "body": "Both of these are great solution! thank you so much Scott and Gary!"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1507153522, "creation_date": 1507153522, "answer_id": 46574693, "question_id": 46572864, "link": "https://stackoverflow.com/questions/46572864/average-the-last-6-records-entered-within-the-row/46574693#46574693", "title": "Average the last 6 records entered within the row", "body": "<p>This small <em>UDF()</em> should work for any row or column:</p>\n\n<pre><code>Option Base 1\n\nPublic Function SuperAverage(rng As Range, N As Long) As Double\n    Dim RngCnt As Long, i As Long, Zum As Double, j As Long\n    Dim ary() As Double\n    ReDim ary(1)\n\n    j = 1\n    RngCnt = rng.Count\n\n    For i = RngCnt To 1 Step -1\n        If rng(i).Value &lt;&gt; \"\" Then\n            ary(j) = rng(i).Value\n            If j = N Then Exit For\n            ReDim Preserve ary(j + 1)\n            j = j + 1\n        End If\n    Next i\n\n    SuperAverage = Application.WorksheetFunction.Average(ary)\n\nEnd Function\n</code></pre>\n\n<p>For example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/6UKsj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6UKsj.png\" alt=\"enter image description here\"></a>\n<br><br>The first argument is the range and the second argument is the item count.</p>\n"}], "owner": {"reputation": 43, "user_id": 6320750, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/bc546db4533a133f87c7130f6c14961e?s=128&d=identicon&r=PG&f=1", "display_name": "Kenny T.", "link": "https://stackoverflow.com/users/6320750/kenny-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1556, "favorite_count": 0, "accepted_answer_id": 46573369, "answer_count": 2, "score": 0, "last_activity_date": 1507163823, "creation_date": 1507145879, "last_edit_date": 1507163823, "question_id": 46572864, "link": "https://stackoverflow.com/questions/46572864/average-the-last-6-records-entered-within-the-row", "title": "Average the last 6 records entered within the row", "body": "<p>So I've made an Average/Offset formula that averages the last 6 records it sees. For example if I'm working with cells A1 to J1, and I enter values in A1 to H1, it will average values from C1 to H1. And if I add a value in I1, it will average D1 to I1. See the formula below:</p>\n\n<pre><code>AVERAGE(OFFSET(A1,0,COUNT(A1:J1)-6,1,6))\n\nAVERAGE(OFFSET(first cell, COUNT(entire range)-N,0,N,1))\n</code></pre>\n\n<p>Here's an example: The average should be 3.5</p>\n\n<pre><code>        A   B   C   D   E   F   G   H   I   J\nrow 1:          4   2   3   4   5   5   2\n</code></pre>\n\n<p>The problem with the offset formula is that if there's a black cell between A1 to J1, it miscalculates because it believes the last data was at the break (if that makes sense). I'm looking for an alternative formula that reads from the right-most value from the selected array (since I'll be adding values to the right all the time).</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1507146699, "post_id": 46572770, "comment_id": 80099813, "body": "What&#39;s wrong with your code? It&#39;s searching just Column A. If <code>Rng</code> is found, then you can just do <code>Rng.select</code> to activate the cell where the value is found. You can also do say <code>If Rng.Row = 3 Then ...</code> if the value is in row three...?  If you want to search the whole sheet, just do <code>Set Rng = .Cells.Find(...</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 4, "creation_date": 1507147085, "post_id": 46572770, "comment_id": 80099980, "body": "FWIW <code>LookIn:=xlFormulas, LookAt:=xlWhole</code> is a strange combination to be searching for, especially when the user prompt is &quot;Give me a <b>value</b> to look for&quot; - are you sure you don&#39;t want to look in <code>xlValues</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "edited": false, "score": 0, "creation_date": 1507149723, "post_id": 46573028, "comment_id": 80101194, "body": "thank you very much, your code is great. There is one little issue im having with it, its not looking through formulas. i just realized that the values im trying to find with the code are being reference from a different sheet so they are formulas. unfortunately i cannot just copy and paste into values, they have to remain formulas. do you know if there&#39;s something i can add to your code to make it look though formulas?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "edited": false, "score": 1, "creation_date": 1507149885, "post_id": 46573028, "comment_id": 80101274, "body": "@S.MART Are you trying to search for text in the formulas (i.e. <code>LookIn:=xlFormulas</code>), or search for text in the values calculated by those formulas (i.e. <code>LookIn:=xlValues</code>)?  E.g.  If you had a formula in Excel of <code>=&quot;ab&quot;&amp;&quot;cd&quot;</code> then searching for <code>&quot;abcd&quot;</code> in <code>xlFormulas</code> would fail, but searching for it in <code>xlValues</code> will find it."}], "tags": [], "owner": {"reputation": 3640, "user_id": 5463636, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hwpDa.jpg?s=128&g=1", "display_name": "freginold", "link": "https://stackoverflow.com/users/5463636/freginold"}, "is_accepted": false, "score": 0, "last_activity_date": 1507148068, "last_edit_date": 1507148068, "creation_date": 1507146545, "answer_id": 46573028, "question_id": 46572770, "link": "https://stackoverflow.com/questions/46572770/search-box-button-similar-to-ctrl-f-in-vba/46573028#46573028", "title": "Search box/button similar to CTRL + F in VBA", "body": "<p><a href=\"https://github.com/freginold/Excel-finder-macro\" rel=\"nofollow noreferrer\">excel-finder-macro</a> (on GitHub) is an Excel macro I made a while back, that you can play around with and change the range for.</p>\n\n<p>Since it's just a VBA macro, you can customize it however you want, including restricting the search to only column A. From the README:</p>\n\n<blockquote>\n  <p>The macro currently searches all cells within a range from the farthest row that has a value in column A, all the way over to column ZZ. It can be made to search farther over, or search rows based on a different column, by changing the  <code>cellRange</code>  variable. The macro is case-insensitive and will find a character or partial string inside other text.</p>\n</blockquote>\n\n<p><code>cellRange</code> is by default set up as:</p>\n\n<pre><code>numRows = ActiveSheet.Range(\"A1048576\").End(xlUp).Row \ncellRange = \"a1:zz\" &amp; numRows\n</code></pre>\n\n<p>You can play with the values and constrain them any way you want. For example, to only search in column A, you could change <code>cellRange</code> to:</p>\n\n<pre><code>cellRange = \"a1:a1\" &amp; numRows\n</code></pre>\n\n<p>This finder macro also goes to the found value, like you said you wanted, and highlights it.</p>\n\n<p>The code is open source and public domain, so feel free to use and/or change it.</p>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1507146814, "creation_date": 1507146814, "answer_id": 46573097, "question_id": 46572770, "link": "https://stackoverflow.com/questions/46572770/search-box-button-similar-to-ctrl-f-in-vba/46573097#46573097", "title": "Search box/button similar to CTRL + F in VBA", "body": "<p>If you change the last part of your code to:</p>\n\n<pre><code>  If Rng Is Nothing Then\n    ' The entered value could not be found\n    Prompt = \"I could not find \"\"\" &amp; RetValue &amp; \"\"\"\" &amp; vbLf\n  Else\n    ' The entered value was found\n    Application.GoTo Rng\n    Prompt = \"\"\n  End If\nLoop\n</code></pre>\n\n<p>I think you will get what you want.</p>\n"}], "owner": {"reputation": 21, "user_id": 8642998, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/456f8997b0327f4b89c0c1d4a8fdb07b?s=128&d=identicon&r=PG&f=1", "display_name": "S.MART", "link": "https://stackoverflow.com/users/8642998/s-mart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1604, "favorite_count": 0, "accepted_answer_id": 46573097, "answer_count": 2, "score": 0, "last_activity_date": 1507148068, "creation_date": 1507145485, "last_edit_date": 1507147181, "question_id": 46572770, "link": "https://stackoverflow.com/questions/46572770/search-box-button-similar-to-ctrl-f-in-vba", "title": "Search box/button similar to CTRL + F in VBA", "body": "<p>I'm trying to figure out what is the actual code for the <kbd>CTRL</kbd> + <kbd>F</kbd> command but can't find it. The closest I found is pasted below; the only problem is that I can't change the range properly.</p>\n\n<p>I would like to change the range to look for values in the whole sheet on only column A. I would also like, if instead of returning a message saying it found the value in X row, I would prefer if it actually goes to it. I'm new to VBA and I'm having the hardest time understanding active ranges. </p>\n\n<pre><code>Sub PlayMacro()\n\n  Dim Prompt As String\n  Dim RetValue As String\n  Dim Rng As Range\n  Dim RowCrnt As Long\n\n  Prompt = \"\"\n\n  ' The macro recorder has used the active worksheet.  This says which\n  ' worksheet is to be used whether it is active or not.  Change \"Sheet4\"\n  ' to the name of your worksheet.\n  With Sheets(\"Sheet4\")\n\n    ' This will loop forever unless a statement within\n    ' the loop exits the Do.\n    Do While True\n\n      RetValue = InputBox(Prompt &amp; \"Give me a value to look for\")\n      'RetValue will be empty if you click cancel\n      If RetValue = \"\" Then\n        Exit Do\n      End If\n\n      ' I do not wish to active the cell containing the required value.\n      ' I want to know where it is.\n      Set Rng = .Columns(\"A:A\").Find(What:=RetValue, After:=.Range(\"A1\"), _\n                LookIn:=xlFormulas, LookAt:=xlWhole, SearchOrder:=xlByRows, _\n                SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\n\n      If Rng Is Nothing Then\n        ' The entered value could not be found\n        Prompt = \"I could not find \"\"\" &amp; RetValue &amp; \"\"\"\"\n      Else\n        ' The entered value was found\n        RowCrnt = Rng.Row\n        Prompt = \"I found \"\"\" &amp; RetValue &amp; \"\"\" on row \" &amp; RowCrnt\n      End If\n      Prompt = Prompt &amp; vbLf\n    Loop\n\n  End With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1507148005, "post_id": 46572724, "comment_id": 80100453, "body": "Is B2 a data validation cell or did you use a drop down box?"}, {"owner": {"reputation": 189, "user_id": 5656327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahQ4O.png?s=128&g=1", "display_name": "Worst SQL Noob", "link": "https://stackoverflow.com/users/5656327/worst-sql-noob"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1507148833, "post_id": 46572724, "comment_id": 80100820, "body": "it is a data validation cell, sorry for confusion"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1507148970, "post_id": 46572724, "comment_id": 80100873, "body": "Do you want to print each employee on a separate page?"}, {"owner": {"reputation": 189, "user_id": 5656327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahQ4O.png?s=128&g=1", "display_name": "Worst SQL Noob", "link": "https://stackoverflow.com/users/5656327/worst-sql-noob"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1507150169, "post_id": 46572724, "comment_id": 80101424, "body": "Yes, normally. I pick one name from the list then wait the data is refreshing, then i will print this page. then i go next employee, i think it is a loop, but i spend some time, cannot figure it out."}], "answers": [{"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 2, "last_activity_date": 1507151303, "creation_date": 1507151303, "answer_id": 46574203, "question_id": 46572724, "link": "https://stackoverflow.com/questions/46572724/how-to-print-all-options-in-drop-down-menu-in-excel-via-vba/46574203#46574203", "title": "How to print all options in drop-down menu in Excel via VBA", "body": "<p>Here is the code to iterate through the data validation cell. Change the worksheet name and cell reference as needed.\nYou will have to add the print code inside the for/each/next loop</p>\n\n<pre><code>Sub Iterate_Through_data_Validation()\nDim dvCell As Range\nDim inputRange As Range\nDim c As Range\n\n\n'Which cell has data validation\n   Set dvCell = Worksheets(\"Sheet1\").Range(\"B1\")\n'Determine where validation comes from\n   Set inputRange = Evaluate(dvCell.Validation.Formula1)\n\nFor Each c In inputRange\n    dvCell = c.Value\n    'add some print page code here\nNext c\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "is_accepted": false, "score": 1, "last_activity_date": 1507228272, "last_edit_date": 1507228272, "creation_date": 1507155022, "answer_id": 46574943, "question_id": 46572724, "link": "https://stackoverflow.com/questions/46572724/how-to-print-all-options-in-drop-down-menu-in-excel-via-vba/46574943#46574943", "title": "How to print all options in drop-down menu in Excel via VBA", "body": "<p>If you want to iterate through the combobox list:</p>\n\n<p>I threw this together for you.  I didn't have time to test but it should work.  You need to replace \"ComboBox1\" with whatever your control name is.  You also need to change <code>el.Name = \"EmployeeList\"</code> to the correct sheet name.</p>\n\n<pre><code>Sub printEmployees()\n    On Error GoTo catch\n    Err.Clear\n    GoTo try\n\ntry:\n    Dim el, sc As Worksheet\n\n\n    Set sc = ActiveSheet\n    Set el = Sheets.Add\n    el.Name = \"EmployeeList\"\n\n    sc.Activate\n\n    i = 0\n    For Each lItem In Me.ComboBox1.List\n        el.Cells(1, i) = Me.ComboBox1.List(i)\n    i = i + 1\n    Next\n\n    el.PrintOut\n\nfinally:\n    On Error Resume Next\n\n    Application.DisplayAlerts = False\n    el.Delete\n    Application.DisplayAlerts = True\n    Set sc = Nothing\n    Set el = Nothing\n    Exit Sub\n\ncatch:\n\n    MsgBox Err.Description\n    Resume finally\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 189, "user_id": 5656327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ahQ4O.png?s=128&g=1", "display_name": "Worst SQL Noob", "link": "https://stackoverflow.com/users/5656327/worst-sql-noob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3188, "favorite_count": 0, "accepted_answer_id": 46574203, "answer_count": 2, "score": 0, "last_activity_date": 1507228272, "creation_date": 1507145317, "last_edit_date": 1592644375, "question_id": 46572724, "link": "https://stackoverflow.com/questions/46572724/how-to-print-all-options-in-drop-down-menu-in-excel-via-vba", "title": "How to print all options in drop-down menu in Excel via VBA", "body": "<p>I have a employee scorecard in Excel, basically it looks like that:\n<a href=\"https://i.stack.imgur.com/RuT1w.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RuT1w.jpg\" alt=\"enter image description here\" /></a></p>\n<p>So Cell B2 is a drop-down list(data validation cell) that read employees' name from another tab(Tab 2, columns A1:A1000), so after people pick different name, those core metrics will refresh(the data generate those metrics is already linked to the data source).</p>\n<p><a href=\"https://i.stack.imgur.com/357mw.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/357mw.jpg\" alt=\"enter image description here\" /></a></p>\n<p>Supervisor will print this scorecard and talk to their employees.</p>\n<p>However there are more than hundreds of employees, so I wonder is there any easy way via VBA that can print all the options in the drop-down lists for every employees.I did some searches in Google, and cannot find anything works for me.</p>\n<p>Much appreciated</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1507145232, "post_id": 46572572, "comment_id": 80099013, "body": "Why not use SUMIFS()?"}, {"owner": {"reputation": 81, "user_id": 8227225, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/71fae0fe43a6514240d64d07ce8b7ef8?s=128&d=identicon&r=PG&f=1", "display_name": "chairSitter", "link": "https://stackoverflow.com/users/8227225/chairsitter"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1507145403, "post_id": 46572572, "comment_id": 80099101, "body": "Hmm, so something along the lines of (inside the loop) summing if the cell in column 3 AND column 5 contain the requested data?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1507145633, "post_id": 46572572, "comment_id": 80099225, "body": "yes; <code>sum = Application.WorksheetFunction.SumIfs(sh1.Range(&quot;G:G&quot;),sh1.Ra&zwnj;&#8203;nge(&quot;C:C&quot;),sh2.Cells&zwnj;&#8203;(i, 1),sh1.Range(&quot;E:E&quot;),sh2.Cells(i, 2))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 33, "user_id": 8650598, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-n7M6sFV141Y/AAAAAAAAAAI/AAAAAAAAABc/WqAq6wwyx0A/photo.jpg?sz=128", "display_name": "Ryan W.", "link": "https://stackoverflow.com/users/8650598/ryan-w"}, "is_accepted": false, "score": 0, "last_activity_date": 1507145795, "creation_date": 1507145795, "answer_id": 46572840, "question_id": 46572572, "link": "https://stackoverflow.com/questions/46572572/speeding-up-filtering-macro/46572840#46572840", "title": "Speeding up filtering Macro", "body": "<p>If you are doing anything that reads and/or writes in a very large range of cells, I would recommend converting the range to an array and iterating over that (and then write the array back to the range if necessary). Try code that looks something like this:</p>\n\n<pre><code>Dim ReadArray() as Variant\nReadArray = MyRange\n\nDim Count as Long\nDim Criteria1 as String, Criteria2 as String\n\nCriteria1 = \"Alpha\"\nCriteria2 = \"Bravo\"\n\nDim Row as long, Col as long\nFor Row = 1 to Ubound(ReadArray, 1)\n    for Col = 1 to Ubound(ReadArray, 2)\n        if ReadArray(Row, Col) = Criteria1 or ReadArray(Row, Col) = Criteria2 then\n            Count = Count + 1\n        End If\n    next Col\nNext Row\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 8227225, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/71fae0fe43a6514240d64d07ce8b7ef8?s=128&d=identicon&r=PG&f=1", "display_name": "chairSitter", "link": "https://stackoverflow.com/users/8227225/chairsitter"}, "edited": false, "score": 0, "creation_date": 1507146595, "post_id": 46572944, "comment_id": 80099767, "body": "Wow. This is amazing. Thanks so much!! If you don&#39;t mind me asking, what is the reasoning for having the single then double quotation marks after the open parenthesis in the SUMIFS( part?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 81, "user_id": 8227225, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/71fae0fe43a6514240d64d07ce8b7ef8?s=128&d=identicon&r=PG&f=1", "display_name": "chairSitter", "link": "https://stackoverflow.com/users/8227225/chairsitter"}, "edited": false, "score": 0, "creation_date": 1507147017, "post_id": 46572944, "comment_id": 80099950, "body": "<code>Sh1</code> is a vba variable, so we need to remove it from the string and concatenate it.  The <code>&#39;</code> is in case <code>sh1.Name</code> has spaces in it."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1507146179, "creation_date": 1507146179, "answer_id": 46572944, "question_id": 46572572, "link": "https://stackoverflow.com/questions/46572572/speeding-up-filtering-macro/46572944#46572944", "title": "Speeding up filtering Macro", "body": "<p>Better yet get rid of the loop completely:</p>\n\n<pre><code>With sh2\n    With .Range(\"D2:D\" &amp; lr2)\n        .FormulaR1C1 = \"=SUMIFS('\" &amp; sh1.Name &amp; \"'!C7:C7,'\" &amp; sh1.Name &amp; \"'!C3:C3,RC1,'\" &amp; sh1.Name &amp; \"'!C5:C5,RC2)\"\n        .Value = .Value\n    End With\n    With .Range(\"C2:C\" &amp; lr2)\n        .FormulaR1C1 = \"=COUNTIFS('\" &amp; sh1.Name &amp; \"'!C3:C3,RC1,'\" &amp; sh1.Name &amp; \"'!C5:C5,RC2)\"\n        .Value = .Value\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 8227225, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/71fae0fe43a6514240d64d07ce8b7ef8?s=128&d=identicon&r=PG&f=1", "display_name": "chairSitter", "link": "https://stackoverflow.com/users/8227225/chairsitter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 46572944, "answer_count": 2, "score": 0, "last_activity_date": 1507146353, "creation_date": 1507144715, "last_edit_date": 1531164843, "question_id": 46572572, "link": "https://stackoverflow.com/questions/46572572/speeding-up-filtering-macro", "title": "Speeding up filtering Macro", "body": "<p>I am writing a macro for Excel that is searching for two unique criteria and counting and summing all data that contains the criteria in the proper fields. I have been able to do this with AutoFilters, but my code runs extremely slow. It needs to churn through almost 25,000 rows, and it got through about 180 in 5 minutes which is not ideal. I am wondering if there is a better, more efficient way to do this.</p>\n\n<p>My code is:</p>\n\n<pre><code>For i = 2 To lr2\n    sh1.Range(\"A1\").AutoFilter Field:=3, Criteria1:=sh2.Cells(i, 1)\n\n    sh1.Range(\"A1\").AutoFilter Field:=5, Criteria1:=sh2.Cells(i, 2)\n\n    count = sh1.AutoFilter.Range.Columns(1).SpecialCells(xlCellTypeVisible).Cells.count\n    sh2.Cells(i, 3).Value = (count - 1)\n\n    Set rng = sh1.Range(\"G2:G\" &amp; lr1)\n    sum = sh1.Application.WorksheetFunction.sum(rng.SpecialCells(xlCellTypeVisible))\n\n    sh2.Cells(i, 4).Value = sum\nNext i\n</code></pre>\n\n<p>sh1 and sh2 are worksheets 1 and 2, and lr2 is the number of the last row in the reference spreadsheet in sh2. </p>\n"}, {"tags": ["arrays", "string", "vba", "loops", "copy-paste"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1507143910, "post_id": 46572319, "comment_id": 80098324, "body": "For starters, fix this line - <code>ARow = Sheets(&quot;AG&quot;).Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row</code> with a qualified reference to Rows like this - <code>ARow = Sheets(&quot;AG&quot;).Range(&quot;A&quot; &amp; Sheets(&quot;AG&quot;).Rows.Count).End(xlUp).Row</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507144170, "post_id": 46572319, "comment_id": 80098462, "body": "Your <code>Count = Count + 1</code> immediately before the <code>End Sub</code> seems suspicious - there is absolutely no point incrementing a procedure-level variable and then discarding it by exiting the procedure.   Should that be inside your loop somewhere?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1507144231, "post_id": 46572319, "comment_id": 80098492, "body": "Comment out that <code>On Error Resume Next</code> unless there&#39;s a good reason for it there."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507144331, "post_id": 46572319, "comment_id": 80098541, "body": "Your <code>Do</code> <code>...</code> <code>Loop Until i = ARow + 1</code> is pointless - the value of <code>i</code> when it hits the <code>Loop</code> statement will be <code>ARow + 1</code>, so the <code>Do</code> loop is being executed exactly once - never less, never more."}, {"owner": {"reputation": 9, "user_id": 8114553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d66d8be43aaeeecca57a38c1850ce0?s=128&d=identicon&r=PG&f=1", "display_name": "vinnie", "link": "https://stackoverflow.com/users/8114553/vinnie"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507144888, "post_id": 46572319, "comment_id": 80098846, "body": "@YowE3K yes there is a problem there. It looks through the AG_Label but when that is complete till the last row, how do I then increment M_Label so that is goes through the same If statement again for the new M_label value"}, {"owner": {"reputation": 9, "user_id": 8114553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d66d8be43aaeeecca57a38c1850ce0?s=128&d=identicon&r=PG&f=1", "display_name": "vinnie", "link": "https://stackoverflow.com/users/8114553/vinnie"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507144975, "post_id": 46572319, "comment_id": 80098888, "body": "@TimWilliams Thanks Tim. This was in the wrong place and has been moved just under AG_Label = Sheets(&quot;AG&quot;).Cells(i, &quot;N&quot;).Value as there are some issues with certain values"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507145138, "post_id": 46572319, "comment_id": 80098968, "body": "@vinnie The <code>On Error Resume Next</code> masks errors from the time the statement is executed until you execute an <code>On Error GoTo 0</code>.  So, if you have a problem with the <code>AG_Label =</code> line, you should put the <code>On Error Resume Next</code> <b>before</b> that line, and the <code>On Error GoTo 0</code> <b>after</b> that line."}], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 0, "last_activity_date": 1507145975, "creation_date": 1507145975, "answer_id": 46572890, "question_id": 46572319, "link": "https://stackoverflow.com/questions/46572319/vba-loop-error-only-pasting-one-result/46572890#46572890", "title": "VBA Loop error. Only pasting one result", "body": "<p>This may not be exactly what you want, but it should give you a better idea of how to structure a loop within a loop:</p>\n\n<pre><code>    Dim mrow As Long, ARow As Long, iRows As Long, srow As String\n    Dim x As Long, j As Long, i As Long\n    Dim AG_Label As String, AG_val As String, SNL_val As String, SNL_Label As String, M_Label As String, Rng As Range\n    Dim Vval As Long, Speriod As String, aperiod As String\n    Dim Count As Long, Ajay As Variant\n\n    ARow = Sheets(\"AG\").Range(\"A\" &amp; Sheets(\"AG\").Rows.Count).End(xlUp).Row\n    mrow = Sheets(\"Mappings\").Range(\"A\" &amp; Sheets(\"Mappings\").Rows.count).End(xlUp).Row\n    For i = 2 To ARow\n        On Error Resume Next\n        AG_Label = Sheets(\"AG\").Cells(i, \"N\").Value\n        On Error GoTo 0\n        For Count = 2 To mrow\n            'M_Match_1 = Sheets(\"Mappings\").Cells(j, \"P\").Value\n            M_Label = Sheets(\"Mappings\").Cells(Count, \"C\").Value\n\n            If AG_Label = M_Label And Sheets(\"Mappings\").Cells(Count, \"L\").Value = \"FRY-9C\" Then\n                Sheets(\"Mappings\").Cells(Count, \"J\").copy\n                Sheets(\"AG\").Cells(i, \"AM\").PasteSpecial Paste:=xlPasteValues, _\n                   Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            End If    \n        Next\n    Next\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Note: I think using error masking around the setting of the variable <code>AG_Label</code> is a bad, bad, idea.  (It means you will execute multiple times through the loop with the same value of <code>AG_Label</code>, until you get to a situation where a new, valid, value is obtained from column N.)  Below is some alternative code which stops processing of things like <code>#N/A</code>, which is what I suspect you might have been wanting the <code>On Error</code> for:</p>\n\n<pre><code>    Dim mrow As Long, ARow As Long, iRows As Long, srow As String\n    Dim x As Long, j As Long, i As Long\n    Dim AG_Label As String, AG_val As String, SNL_val As String, SNL_Label As String, M_Label As String, Rng As Range\n    Dim Vval As Long, Speriod As String, aperiod As String\n    Dim Count As Long, Ajay As Variant\n\n    ARow = Sheets(\"AG\").Range(\"A\" &amp; Sheets(\"AG\").Rows.Count).End(xlUp).Row\n    mrow = Sheets(\"Mappings\").Range(\"A\" &amp; Sheets(\"Mappings\").Rows.count).End(xlUp).Row\n    For i = 2 To ARow\n        If Not IsError(Sheets(\"AG\").Cells(i, \"N\").Value) Then\n            AG_Label = Sheets(\"AG\").Cells(i, \"N\").Value\n            For Count = 2 To mrow\n                'M_Match_1 = Sheets(\"Mappings\").Cells(j, \"P\").Value\n                M_Label = Sheets(\"Mappings\").Cells(Count, \"C\").Value\n\n                If AG_Label = M_Label And Sheets(\"Mappings\").Cells(Count, \"L\").Value = \"FRY-9C\" Then\n                    Sheets(\"Mappings\").Cells(Count, \"J\").copy\n                    Sheets(\"AG\").Cells(i, \"AM\").PasteSpecial Paste:=xlPasteValues, _\n                       Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                End If    \n            Next\n        End If\n    Next\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8114553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d66d8be43aaeeecca57a38c1850ce0?s=128&d=identicon&r=PG&f=1", "display_name": "vinnie", "link": "https://stackoverflow.com/users/8114553/vinnie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507145975, "creation_date": 1507143705, "question_id": 46572319, "link": "https://stackoverflow.com/questions/46572319/vba-loop-error-only-pasting-one-result", "title": "VBA Loop error. Only pasting one result", "body": "<p>If AG_Label = M_Label the code runs and pastes but only for the first instance.\nThere is something wrong with my loop but I am very new to VBA and so I do not know how to fix it. </p>\n\n<pre><code>    Dim mrow As Long, ARow As Long, iRows As Long, srow As String\nDim x As Long, j As Long, i As Long\nDim AG_Label As String, AG_val As String, SNL_val As String, SNL_Label As String, M_Label As String, Rng As Range\nDim Vval As Long, Speriod As String, aperiod As String\nDim Count As Integer, Ajay As Variant\n\nCount = 2\n\nARow = Sheets(\"AG\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nDo\nFor i = 2 To ARow\n    AG_Label = Sheets(\"AG\").Cells(i, \"N\").Value\n    'mrow = Sheets(\"Mappings\").Range(\"A\" &amp; Rows.count).End(xlUp).Row\n    'For j = 2 To mrow\n        'M_Match_1 = Sheets(\"Mappings\").Cells(j, \"P\").Value\n        M_Label = Sheets(\"Mappings\").Cells(Count, \"C\").Value\n\n\n        If AG_Label = M_Label And Sheets(\"Mappings\").Cells(Count, \"L\").Value = \"FRY-9C\" Then\n            Sheets(\"Mappings\").Cells(Count, \"J\").copy\n            Sheets(\"AG\").Cells(i, \"AM\").PasteSpecial Paste:=xlPasteValues, _\n              Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                On Error Resume Next\n        End If\n\nApplication.CutCopyMode = False\n\nNext\n'i = i + 1\n\nLoop Until i = ARow + 1\n\nCount = Count + 1\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "late-binding"], "comments": [{"owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1507143641, "post_id": 46572182, "comment_id": 80098181, "body": "<a href=\"https://msdn.microsoft.com/en-us/library/aa231060(v=vs.60).aspx\" rel=\"nofollow noreferrer\">error 429</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1507143913, "post_id": 46572182, "comment_id": 80098325, "body": "What does &#39;fails&#39; mean - error message, wrong results, nothing happens? Review <a href=\"https://support.office.com/en-us/article/FileDialog-Property-8510B02D-E455-44A9-BF38-3787E6D5C8C1\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>. Maybe <code>Set obj = Application.FileDialog(msoFileDialogFilePicker)</code>"}, {"owner": {"reputation": 1067, "user_id": 1193491, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ae585652404eee099c2b2e079e0c817?s=128&d=identicon&r=PG", "display_name": "LostInTheTrees", "link": "https://stackoverflow.com/users/1193491/lostinthetrees"}, "reply_to_user": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "edited": false, "score": 0, "creation_date": 1507144064, "post_id": 46572182, "comment_id": 80098406, "body": "@SeanC I have been over that list. It does not seem to apply. All of the objects I am testing for are present and work in my main application, where they are early bound. Why would the CreateObject fail in this context?"}, {"owner": {"reputation": 1067, "user_id": 1193491, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ae585652404eee099c2b2e079e0c817?s=128&d=identicon&r=PG", "display_name": "LostInTheTrees", "link": "https://stackoverflow.com/users/1193491/lostinthetrees"}, "edited": false, "score": 0, "creation_date": 1507144135, "post_id": 46572182, "comment_id": 80098437, "body": "Fails == it branches to xyzzy. I&#39;ll try the mso..."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507144201, "post_id": 46572182, "comment_id": 80098475, "body": "Is everyone on Office 16.0?"}, {"owner": {"reputation": 1067, "user_id": 1193491, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ae585652404eee099c2b2e079e0c817?s=128&d=identicon&r=PG", "display_name": "LostInTheTrees", "link": "https://stackoverflow.com/users/1193491/lostinthetrees"}, "edited": false, "score": 0, "creation_date": 1507144259, "post_id": 46572182, "comment_id": 80098510, "body": "Adding (msoFileDialogFilePicker) did not help, but it was a good idea."}, {"owner": {"reputation": 1067, "user_id": 1193491, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ae585652404eee099c2b2e079e0c817?s=128&d=identicon&r=PG", "display_name": "LostInTheTrees", "link": "https://stackoverflow.com/users/1193491/lostinthetrees"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507144413, "post_id": 46572182, "comment_id": 80098595, "body": "@Mat&#39;sMug Office 16.0? Probably not, but I have it and it fails on my machines. An advantage of late binding is that it should load objects that are equivalent but from another generation."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507144609, "post_id": 46572182, "comment_id": 80098692, "body": "I&#39;m not sure you can necessarily use CreateObject on <i>any</i> type of object...  Can you list the one which work and the ones which don&#39;t?"}, {"owner": {"reputation": 1067, "user_id": 1193491, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ae585652404eee099c2b2e079e0c817?s=128&d=identicon&r=PG", "display_name": "LostInTheTrees", "link": "https://stackoverflow.com/users/1193491/lostinthetrees"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507145076, "post_id": 46572182, "comment_id": 80098937, "body": "@TimWilliams Works:         Set obj = CreateObject(&quot;Access.Application&quot;)     Set obj = CreateObject(&quot;ADODB.Connection&quot;)     Set dict = CreateObject(&quot;Scripting.Dictionary&quot;)          Doesn&#39;t Work:      Set obj = CreateObject(&quot;DAO.Database&quot;)     Set obj = CreateObject(&quot;Office.FileDialog&quot;)     Set dict = CreateObject(&quot;stdole.Stdfont&quot;)     Set dict = CreateObject(&quot;VBA.FileSystem&quot;)"}, {"owner": {"reputation": 1067, "user_id": 1193491, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ae585652404eee099c2b2e079e0c817?s=128&d=identicon&r=PG", "display_name": "LostInTheTrees", "link": "https://stackoverflow.com/users/1193491/lostinthetrees"}, "edited": false, "score": 0, "creation_date": 1507145253, "post_id": 46572182, "comment_id": 80099020, "body": "Each test I am doing represents one &quot;checked&quot; reference in the main application. Some of these I am sure are standard Win modules, but surprisingly I have been unable to find any source that tells me what objects are standard in any version of Windows."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507145306, "post_id": 46572182, "comment_id": 80099056, "body": "Wouldn&#39;t the references menu (given early-bound refs) already say which libraries are missing?"}, {"owner": {"reputation": 1067, "user_id": 1193491, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ae585652404eee099c2b2e079e0c817?s=128&d=identicon&r=PG", "display_name": "LostInTheTrees", "link": "https://stackoverflow.com/users/1193491/lostinthetrees"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507145508, "post_id": 46572182, "comment_id": 80099163, "body": "@Mat&#39;sMug Perhaps, but I need something that will execute on a random system, not only with Access or VB installed. The test app will not run until the Access Runtime is installed, but that is a more containable problem."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1507146592, "post_id": 46572182, "comment_id": 80099762, "body": "Well you can&#39;t use <code>CreateObject</code> to create an instance of an object you wouldn&#39;t be able to <code>New</code> up with early-bound code anyway, so there&#39;s very little hope for that Office library test. Make a separate module that doesn&#39;t reference any other code, and write a macro that inspects the project references and warns about any <code>Reference</code> instance with <code>IsBroken</code> returning <code>True</code>. Yes that&#39;s early-bound and requires trusting the VBIDE API, but you&#39;ll get your missing references."}, {"owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "edited": false, "score": 0, "creation_date": 1507154114, "post_id": 46572182, "comment_id": 80103114, "body": "Remove the failing references and use late binding. Then to determine if the object is supported, check if the related interface is present in the registry in <code>HKCR\\Interface</code>. Use Ole/COM Viewer (oleview.exe) to get the clsid of each interface."}], "answers": [{"comments": [{"owner": {"reputation": 1067, "user_id": 1193491, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ae585652404eee099c2b2e079e0c817?s=128&d=identicon&r=PG", "display_name": "LostInTheTrees", "link": "https://stackoverflow.com/users/1193491/lostinthetrees"}, "edited": false, "score": 0, "creation_date": 1507150273, "post_id": 46573665, "comment_id": 80101475, "body": "If a program cannot start when it has broken references, how can this code be executed?"}, {"owner": {"reputation": 1067, "user_id": 1193491, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ae585652404eee099c2b2e079e0c817?s=128&d=identicon&r=PG", "display_name": "LostInTheTrees", "link": "https://stackoverflow.com/users/1193491/lostinthetrees"}, "edited": false, "score": 0, "creation_date": 1507152924, "post_id": 46573665, "comment_id": 80102638, "body": "Put another way, if there are broken references, does the program fail because references cannot be satisfied or the first time a broken reference is used?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1507154544, "post_id": 46573665, "comment_id": 80103270, "body": "I don&#39;t think that code works with late bindings (and when having problems with references, it&#39;s often a good idea to use late bindings to bind to any version of a specific object)."}, {"owner": {"reputation": 1276, "user_id": 38988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e2d585fabb5cde7a84bafa766ab35b?s=128&d=identicon&r=PG&f=1", "display_name": "John Mo", "link": "https://stackoverflow.com/users/38988/john-mo"}, "edited": false, "score": 0, "creation_date": 1507167839, "post_id": 46573665, "comment_id": 80106530, "body": "I used it in a startup sub before I tried to do anything else. Access can start up and call a sub procedure before hitting anything that requires a reference. And maybe you don&#39;t need to use late bindings if you can detect that something you&#39;re expecting is missing."}, {"owner": {"reputation": 1067, "user_id": 1193491, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ae585652404eee099c2b2e079e0c817?s=128&d=identicon&r=PG", "display_name": "LostInTheTrees", "link": "https://stackoverflow.com/users/1193491/lostinthetrees"}, "edited": false, "score": 0, "creation_date": 1508545499, "post_id": 46573665, "comment_id": 80665468, "body": "@JohnMo OK, this works fine in my Access program. I had to set up an AutoExec macro that calls an InitFunc() function that performs this check. At the end I then open my form that opens and creates everything else in my application. That way the check code runs before anything else. I am now looking for a way to encapsulate this code. I tried the free version of VB but It does not seem to support the COM. How can I code this so that it will run on any system? Do I need a copy of VB6? I assume a .accdr will not execute at all on a system without the Access Runtime installed."}, {"owner": {"reputation": 1276, "user_id": 38988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e2d585fabb5cde7a84bafa766ab35b?s=128&d=identicon&r=PG&f=1", "display_name": "John Mo", "link": "https://stackoverflow.com/users/38988/john-mo"}, "edited": false, "score": 0, "creation_date": 1508761006, "post_id": 46573665, "comment_id": 80725389, "body": "I&#39;m not sure what you&#39;re trying to do next when you say you want to encapsulate the code. You will need the Access Runtime or a full installation of Access to run the application parts of your database. If your next step is to eliminate the Access interface and just keep the database part, you will have to develop a UI in another tool, like Visual Studio."}], "tags": [], "owner": {"reputation": 1276, "user_id": 38988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e2d585fabb5cde7a84bafa766ab35b?s=128&d=identicon&r=PG&f=1", "display_name": "John Mo", "link": "https://stackoverflow.com/users/38988/john-mo"}, "is_accepted": true, "score": 0, "last_activity_date": 1507149060, "creation_date": 1507149060, "answer_id": 46573665, "question_id": 46572182, "link": "https://stackoverflow.com/questions/46572182/how-do-i-detect-the-presence-of-objects-using-vba-in-access-2016/46573665#46573665", "title": "How do I detect the presence of objects using VBA in Access 2016?", "body": "<p>You're trying to detect broken References. Here's a procedure to check for and report broken references:</p>\n\n<pre><code>Sub CheckReferences()\n    Dim ref As Reference\n\n    For Each ref In References\n        If ref.IsBroken Then\n            MsgBox \"Broken reference detected: \" &amp; vbCrLf &amp; ref.Name &amp; vbCrLf &amp; ref.FullPath, vbOKOnly + vbCritical, \"Broken Reference\"\n        End If\n    Next ref\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 0, "last_activity_date": 1507160895, "creation_date": 1507160895, "answer_id": 46575804, "question_id": 46572182, "link": "https://stackoverflow.com/questions/46572182/how-do-i-detect-the-presence-of-objects-using-vba-in-access-2016/46575804#46575804", "title": "How do I detect the presence of objects using VBA in Access 2016?", "body": "<p>The problem here is that the file dialog is not available as a separate COM object, and thus you can\u2019t use CreateObject() to create such an instance.</p>\n\n<p>However, if you plan to distribute your application without an office reference (and I think you safe to do so \u2013 even with runtime), then you can change the FileDialog code to late binding:</p>\n\n<p>Eg this:</p>\n\n<pre><code>Dim f    As FileDialog\nSet f = Application.FileDialog(msoFileDialogFilePicker) \nf.Show \nMsgBox \"file choose was \" &amp; f.SelectedItems(1)\n</code></pre>\n\n<p>Becomes this:</p>\n\n<pre><code>Dim f    As Object \nSet f = Application.FileDialog(3) \nf.AllowMultiSelect = True \nf.Show \nMsgBox \"file choosen was \" &amp; f.SelectedItems(1)\n</code></pre>\n\n<p>So in your case, the filedialog is not available as a separate COM object, but you can still as above shows adopt late binding anyway. However, in my experience, it IS safe to distribute the runtime with a office reference and thus at least for the office dialog you don't need late binding. For reliability, since in the case of FileDialog the late binding code is not a big deal, then I would continue distribution without the office reference for the FileDialog and use the above late binding.</p>\n"}], "owner": {"reputation": 1067, "user_id": 1193491, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ae585652404eee099c2b2e079e0c817?s=128&d=identicon&r=PG", "display_name": "LostInTheTrees", "link": "https://stackoverflow.com/users/1193491/lostinthetrees"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 46573665, "answer_count": 2, "score": 1, "last_activity_date": 1507160895, "creation_date": 1507143197, "question_id": 46572182, "link": "https://stackoverflow.com/questions/46572182/how-do-i-detect-the-presence-of-objects-using-vba-in-access-2016", "title": "How do I detect the presence of objects using VBA in Access 2016?", "body": "<p>I have an Access 2016 application that gets distributed to many users who are not sophisticated users. They usually have to install the MS Runtime for Access. Despite clear directions, too many users still find that the application will not open. It appears that early bound objects are not present on the system. With bound objects not present no code ever loads or runs, so it is not even possible to give a good error message.</p>\n\n<p>I am now attempting to write a small program in which all the objects needed by the application are late bound, thus being able to say which modules are missing, if any. What I am finding though is that my method for detection is failing even when I KNOW the object is present. The code below is an example of one test for a required object. This test always fails and I cannot figure out why. I have about 7 of these. Three seem to work correctly, but the others do not. Is there some different way I should be coding the \"CreateObject\"?</p>\n\n<pre><code>Private Sub btnOffice_Click()\n    'Office    FileDialog    MSO.DLL       Microsoft Office 16.0 Object Library\n    Dim obj As Object\n\n    On Error GoTo xyzzy\n    Set obj = CreateObject(\"Office.FileDialog\")\n    lblOffice.Caption = \"Office module present\"\n    Exit Sub\nxyzzy:\n    lblOffice.Caption = officeWarning\n    MsgBox Err.Description\nEnd Sub\n</code></pre>\n"}, {"tags": ["regex", "excel", "vba", "replace"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1507142699, "post_id": 46572004, "comment_id": 80097679, "body": "If you have tried using VBA, please post the code you tried."}, {"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "edited": false, "score": 2, "creation_date": 1507143173, "post_id": 46572004, "comment_id": 80097921, "body": "<code>\\b(A\\d{6})\\b</code> and <code>$1 FA</code>"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1507143194, "post_id": 46572004, "comment_id": 80097936, "body": "Do you have a pattern like First character is A and number, or are you finding many exact matches? If it is the late option, you won&#39;t need <a href=\"https://regex101.com/r/paE6u4/1\" rel=\"nofollow noreferrer\">ReGex</a>. And should the output of <code>101878</code> contain <code>FA</code>?"}, {"owner": {"reputation": 97, "user_id": 7668200, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EEl6BFWrPOs/AAAAAAAAAAI/AAAAAAAAA-s/2AhVU9aH9uo/photo.jpg?sz=128", "display_name": "Michael Kapp", "link": "https://stackoverflow.com/users/7668200/michael-kapp"}, "edited": false, "score": 0, "creation_date": 1507150603, "post_id": 46572004, "comment_id": 80101613, "body": "ctwheels, what language is that for? I could not get that to work in Excels Find/Replace window."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507150745, "post_id": 46572004, "comment_id": 80101676, "body": "@MichaelKapp Refer to <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">this</a> to program Regex on Excel"}, {"owner": {"reputation": 97, "user_id": 7668200, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EEl6BFWrPOs/AAAAAAAAAAI/AAAAAAAAA-s/2AhVU9aH9uo/photo.jpg?sz=128", "display_name": "Michael Kapp", "link": "https://stackoverflow.com/users/7668200/michael-kapp"}, "edited": false, "score": 0, "creation_date": 1507150786, "post_id": 46572004, "comment_id": 80101699, "body": "Everything I need to replace starts with &quot;A&quot; followed by 6 digits. These correspond to our issues in a different tracking tool. I need to import the data from excel, but the import is failing, because the Issues need to be followed by &quot; FA&quot;. This is the reason for why I need this find / replace. Would like to know in general as well how to find and replace portions of strings. Seems like something good to know."}, {"owner": {"reputation": 97, "user_id": 7668200, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EEl6BFWrPOs/AAAAAAAAAAI/AAAAAAAAA-s/2AhVU9aH9uo/photo.jpg?sz=128", "display_name": "Michael Kapp", "link": "https://stackoverflow.com/users/7668200/michael-kapp"}, "edited": false, "score": 0, "creation_date": 1507151033, "post_id": 46572004, "comment_id": 80101820, "body": "Is there an easier way? Possibly without Regex?"}, {"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "edited": false, "score": 0, "creation_date": 1507151797, "post_id": 46572004, "comment_id": 80102186, "body": "@MichaelKapp VBA. I followed the information here: <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a> (which is the same link posted by daniel) and <a href=\"https://stackoverflow.com/questions/11867580/vba-excel-regex-b-word-boundary-doesnt-match-if-word-is-at-beginning-of-stri\" title=\"vba excel regex b word boundary doesnt match if word is at beginning of stri\">stackoverflow.com/questions/11867580/&hellip;</a> for word boundary"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1507169897, "post_id": 46572004, "comment_id": 80106956, "body": "You will need regexp, or you will can use VBA to search the cell contents and do the replace without regexp.  There&#39;s limited support for wildcards in the Excel built-in Search/Replace dialog, and no support for RegExp."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507210166, "post_id": 46572004, "comment_id": 80126758, "body": "@MichaelKapp What is confusing is that <code>101878</code> don&#39;t start with A and still needs <code>FA</code> to be added. Your example is confusing and don&#39;t match your comment description of the problem. And <a href=\"https://stackoverflow.com/a/45437646/7690982\">here</a> is a great example on how to use ReGex (the one ctwheels wrote) or how to use LIKE with wildcards."}, {"owner": {"reputation": 97, "user_id": 7668200, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EEl6BFWrPOs/AAAAAAAAAAI/AAAAAAAAA-s/2AhVU9aH9uo/photo.jpg?sz=128", "display_name": "Michael Kapp", "link": "https://stackoverflow.com/users/7668200/michael-kapp"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507232801, "post_id": 46572004, "comment_id": 80140404, "body": "@danieltakeshi Let me be more clear. In my real life issue, there are cases where there is no letter &quot;A&quot; preceding the 6 digit issue number. As far as just getting a simple answer here on Stackoverflow, I don&#39;t care of someone posts a solution of how to handle the letter &quot;A&quot; or not. There are not many cases where the letter &quot;A&quot; is missing."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528100289, "post_id": 46572004, "comment_id": 88361830, "body": "By [Alt+Enter] do you mean split across separate lines within a cell with Chr(10) ? And is it always a capital A?"}], "answers": [{"tags": [], "owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "is_accepted": false, "score": 1, "last_activity_date": 1528066767, "creation_date": 1528066767, "answer_id": 50671725, "question_id": 46572004, "link": "https://stackoverflow.com/questions/46572004/how-to-use-regex-in-excel-to-find-replace-the-end-of-a-string/50671725#50671725", "title": "How to use Regex in excel to find/replace the end of a string", "body": "<p>Realize that this is an old question, but have been practicing with regex a bit and used this problem as practice. I think it will accomplish what you would like. Replace the string that I reference with the cell values/range that holds the strings that you want to test. Instead of printing swap cell value with item + \" FA\" ie cells(1,1) = item + \" FA\"</p>\n\n<pre><code>Sub NewNew()\n\n    Dim reg As RegExp\n    Set reg = New RegExp\n\n        reg.Pattern = \"\\b([aA\\d]?\\d{6})\"\n        reg.Global = True\n\n    Dim arr As Variant\n\n    Dim str As String\n        str = \"123456 A1456 B156221 A742121 C654123 A123456 D123456 E876543\"\n\n    Set arr = reg.Execute(str)\n\n    For Each Item In arr\n        Debug.Print Item + \" FA\"\n    Next Item\n\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/KliEk.png\" alt=\"\"></p>\n"}], "owner": {"reputation": 97, "user_id": 7668200, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-EEl6BFWrPOs/AAAAAAAAAAI/AAAAAAAAA-s/2AhVU9aH9uo/photo.jpg?sz=128", "display_name": "Michael Kapp", "link": "https://stackoverflow.com/users/7668200/michael-kapp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5605, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528066767, "creation_date": 1507142528, "question_id": 46572004, "link": "https://stackoverflow.com/questions/46572004/how-to-use-regex-in-excel-to-find-replace-the-end-of-a-string", "title": "How to use Regex in excel to find/replace the end of a string", "body": "<p>I am looking to do a quick find replace in Excel (or VBA) to Find strings in specific format and append some text at the end.</p>\n\n<p>Example: Find: A123456</p>\n\n<p>Replace with: A123456 FA</p>\n\n<p>I know my first character is \"A\" followed by 6 digits. I just need to append a space and a few characters like \" FA\" in my example above. </p>\n\n<p>Some cells contain multiple strings separated with either a space or [Alt+Enters]. Ex. \"A123456 [Alt+Enter]A987654\"</p>\n\n<p>Ex: Find: A123456[Alt+Enter]A987654[Alt+Enter]101878</p>\n\n<p>Replace: A123456 FA[Alt+Enter]A987654 FA[Alt+Enter]101878 FA</p>\n\n<p>I tried random configurations of <em>,?,&lt;</em>>,~*,~?, but I don't see what will work. \nI did not find what I need for this issue, but seemed most useful. \n<a href=\"https://support.office.com/en-us/article/Find-and-replace-text-and-other-data-in-a-Word-document-c6728c16-469e-43cd-afe4-7708c6c779b7?ui=en-US&amp;rs=en-US&amp;ad=US#ex1\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/Find-and-replace-text-and-other-data-in-a-Word-document-c6728c16-469e-43cd-afe4-7708c6c779b7?ui=en-US&amp;rs=en-US&amp;ad=US#ex1</a></p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1507142932, "post_id": 46571963, "comment_id": 80097815, "body": "If this is Excel VBA code, try <code>appAccess.DoCmd</code> so that the correct Access application is invoked."}, {"owner": {"reputation": 11, "user_id": 8615329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15a08c0fe270958485fa839c1e34fe76?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmeet Sidhu", "link": "https://stackoverflow.com/users/8615329/gurmeet-sidhu"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507143341, "post_id": 46571963, "comment_id": 80098014, "body": "My man, thank you. @YowE3K, your right it&#39;s referencing the associated importexports specs from the first opened access. Your comment is exactly what I need to load the next set of specs thanks!"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1507189123, "post_id": 46571963, "comment_id": 80113358, "body": "I guess this question is answered, then. Tip: don&#39;t use <code>KillProcess &quot;MSACCESS.exe&quot;</code> when you can just use <code>accApp.Quit</code>. You can gently ask Access to quit, or you can murder Access and risk corrupting the database in doing so."}, {"owner": {"reputation": 11, "user_id": 8615329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15a08c0fe270958485fa839c1e34fe76?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmeet Sidhu", "link": "https://stackoverflow.com/users/8615329/gurmeet-sidhu"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1507228690, "post_id": 46571963, "comment_id": 80138279, "body": "Thanks @ErikvonAsmuth I was hoping that would release the specs that were currently being stored and starting a new instance right after would load the new specs. I was wrong. The question is answered yes but I tried answering it on YowE3K&#39;s behalf but it didn&#39;t work"}], "owner": {"reputation": 11, "user_id": 8615329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15a08c0fe270958485fa839c1e34fe76?s=128&d=identicon&r=PG&f=1", "display_name": "Gurmeet Sidhu", "link": "https://stackoverflow.com/users/8615329/gurmeet-sidhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3523, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1507142816, "creation_date": 1507142382, "last_edit_date": 1531164843, "question_id": 46571963, "link": "https://stackoverflow.com/questions/46571963/better-way-to-run-docmd-runsavedimportexport", "title": "Better way to run DoCmd.RunSavedImportExport", "body": "<p>Current situation is I have my machine (C:) starting script/macro \"Start\" which opens up access db on shared drive (Q:\\Database.accdb) and runs numerous specifications to update table (<code>DoCmd.RunSavedImportExport</code>) and runs numerous specifications from frontend (Q:\\Dashboard.accdb) to produce \"reports\" (<code>DoCmd.RunSavedImportExport</code>). I can't seem to get both to execute 100% of time without various errors popping up. </p>\n\n<p>Currently I have managed to get the first set of <code>DoCmd.RunSavedImportExport</code>s to run properly but I keep getting the following error when I attempt to launch the next set:</p>\n\n<p>Run time error '462'</p>\n\n<p>The remote server machine does not exist or is unavailable. </p>\n\n<p>I want to say the issue is I am getting some sort of lock but I am opening a whole new file? Any help?</p>\n\n<pre><code>Public Function Start()\n\nDim appAccess As Access.Application\nSet appAccess = CreateObject(\"Access.Application\")\nappAccess.OpenCurrentDatabase \"Q:\\Database.accdb\"\nappAccess.Application.Visible = True\n\nDoCmd.RunSavedImportExport \"CoolUploadToDB1\"\nDoCmd.RunSavedImportExport \"CoolUploadToDB2\"\n\nKillProcess \"MSACCESS.exe\"\nExportReports\n\nEnd Function\n\nPublic Function ExportReports()\n\nDim appAccess As Access.Application\nSet appAccess = CreateObject(\"Access.Application\")\nappAccess.OpenCurrentDatabase \"Q:\\Dashboard.accdb\"\nappAccess.Application.Visible = True\nApplication.Wait (Now + TimeValue(\"0:00:05\"))\n\n#Consistently works up until here:\n#Gives error: Run time error '462': The remote server machine does not exist or is unavailable.\n\nDoCmd.RunSavedImportExport \"ExportCoolReport1\"\nCoolFuncToAnnoySomePeopleWithReport \"OneGuyITotallyHate@coolcompany.com\"\n\nappAccess.CloseCurrentDatabase\nappAccess.Application.Quit\nSet appAccess = Nothing\nApplication.DisplayAlerts = True\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 6, "creation_date": 1507141748, "post_id": 46571747, "comment_id": 80097124, "body": "When deleting rows it is recommended to run the loop backwards i.e. <code>For i = 100 to 1 Step -1</code> Your issue is caused as you&#39;re putting it into an infinite loop by setting your DataRange to the entire Column"}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1507141824, "post_id": 46571747, "comment_id": 80097178, "body": "Ok, that&#39;s good to know.  I&#39;m not familiar, but I&#39;ll look it up now.  Thanks for your response! @Tom"}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 5, "last_activity_date": 1507141987, "creation_date": 1507141987, "answer_id": 46571866, "question_id": 46571747, "link": "https://stackoverflow.com/questions/46571747/for-next-loop-freezing/46571866#46571866", "title": "For Next Loop Freezing", "body": "<p>Further to my comment above give this a go</p>\n\n<pre><code>Public Sub DeletePriorDates()\n'Delete any dates before two years past\n    Dim twoyrpast As Date\n    Dim i As Long\n\n    With Sheet6\n        twoyrpast = DateAdd(\"yyyy\", -2, Sheet1.[B].Value)\n\n        For i = .Cells(.Rows.Count, \"A\").End(xlUp).Row To 1 Step -1\n            If .Cells(i, 1) &lt; twoyrpast Then .Rows(i).EntireRow.Delete\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 46571866, "answer_count": 1, "score": 0, "last_activity_date": 1507141987, "creation_date": 1507141583, "question_id": 46571747, "link": "https://stackoverflow.com/questions/46571747/for-next-loop-freezing", "title": "For Next Loop Freezing", "body": "<p>I have the following code to search a list of dates and delete any rows associated with a date prior to two years ago.  When I run, excel freezes.  I'm new to VBA, and think I'm probably having a conceptual misunderstanding regarding using this particular loop:</p>\n\n<pre><code>Sub DeletePriorDates()\n'Delete any dates before two years past\n    Dim twoyrpast As Date\n    Dim c As Range\n    Dim DataRange As Range\n    Set DataRange = Sheet6.Range(\"A:A\")\n    twoyrpast = DateAdd(\"yyyy\", -2, Sheet1.[B].Value)\n\n    For Each c In DataRange\n        If c &lt; twoyrpast Then c.EntireRow.Delete\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>When I stop running the macro, the debugger highlights the \"Next\".  I've tried different iterations of Next, and code online seems almost identical.  I can't find what I'm doing wrong.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 0, "creation_date": 1507141692, "post_id": 46571633, "comment_id": 80097088, "body": "The error occurs at the below code:                                                           ActiveSheet.PasteSpecial Format:=&quot;Text&quot;, Link:=False, DisplayAsIcon:=False"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507142120, "post_id": 46571633, "comment_id": 80097340, "body": "Please add your comment to your post. <code>PasteSpecial</code> is a method of the <code>Range</code> object, not the <code>Sheet</code>."}, {"owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507142255, "post_id": 46571633, "comment_id": 80097422, "body": "Issue with a run-time error 1004: PasteSpecial method of Rang Class failed. The macro works perfectly for me. But when try running in some other systems, the bug occurs"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1507142340, "post_id": 46571633, "comment_id": 80097479, "body": "@Rin - Make this line: <code>ActiveSheet.Range(&quot;A1&quot;).PasteSpecial ...</code> and remove <code>Range(&quot;a1&quot;).Select</code>"}, {"owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 0, "creation_date": 1507142711, "post_id": 46571633, "comment_id": 80097692, "body": "I tries as suggested. But no luck. Now its showing application defined error"}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "edited": false, "score": 0, "creation_date": 1507143730, "post_id": 46571633, "comment_id": 80098235, "body": "What about <code>ActiveSheet.Paste</code> or <code>ActiveSheet.Paste Destination:=Range(&quot;A1&quot;)</code>?"}, {"owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "reply_to_user": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "edited": false, "score": 0, "creation_date": 1507143997, "post_id": 46571633, "comment_id": 80098373, "body": "@u8it -  the data table should be pasted  as paste special format"}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "edited": false, "score": 0, "creation_date": 1507144345, "post_id": 46571633, "comment_id": 80098555, "body": "What about directly accessing the clipboard like this <a href=\"https://stackoverflow.com/a/9024237/3546415\">stackoverflow.com/a/9024237/3546415</a>? I know sometimes PasteSpecial can act funny, case in point. At the very least it&#39;d let you troubleshoot at the clipboard data level."}, {"owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 0, "creation_date": 1507145127, "post_id": 46571633, "comment_id": 80098961, "body": "Thank you very much for your reply. The wierd part is like it works perfectly for me and  couple of others. its only one person who is facing this bug. Is that something that can be done with laptop of the person who is getting the bug. Also, as u said, if we try pasting it directly from the clipboard of that person? not sure about it. Just a thought"}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "edited": false, "score": 0, "creation_date": 1507147113, "post_id": 46571633, "comment_id": 80099998, "body": "Yes, there are system/OS/software factors that are probably causing this. Without knowing anything about the working and non-working systems though, it&#39;s hard to say. So any info like OS and version, version of Office, virtual or RDP session, KVM switch, etc could be a factor. I&#39;d list whatever info you can find between your machines, but also try to separate your two major variables here: PasteSpecial vs. Clipboard behavior. By testing against the clipboard directly you can verify that the problem is PasteSpecial, and it may be better anyway in the long run."}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "edited": false, "score": 0, "creation_date": 1507219210, "post_id": 46571633, "comment_id": 80133113, "body": "@Rin, did you try the first code snippet I provided in my answer, the one with <code>On Error Resume Next</code>? Try that and if it works try placing breakpoints after every <code>PasteSpecial</code> attempt to see which ones are failing. Also, I&#39;m adding to my answer how to check clipboard content type in Excel."}], "answers": [{"comments": [{"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "edited": false, "score": 0, "creation_date": 1507149930, "post_id": 46573702, "comment_id": 80101298, "body": "This is exactly what Scott Holtzman suggested and the OP said didn&#39;t work... Also, if you look in the object browser, PasteSpecial is both a Range as well as Worksheet method, and these methods are actually different. Apparently, the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-pastespecial-method-excel\" rel=\"nofollow noreferrer\">Worksheet method is better for pasting between applications</a>.... There&#39;s also a <a href=\"https://msdn.microsoft.com/en-us/vba/powerpoint-vba/articles/textrange-pastespecial-method-powerpoint\" rel=\"nofollow noreferrer\">TextRange.PasteSpecial</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "edited": false, "score": 0, "creation_date": 1507150424, "post_id": 46573702, "comment_id": 80101541, "body": "This problem has been asked before and the range method solved it. Beyond the OP&#39;s use of a default parent worksheet as the new worksheet and use of select to achieve an activecell, this should resolve the problem. If it doesn&#39;t, there isn&#39;t enough information."}, {"owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 0, "creation_date": 1507210950, "post_id": 46573702, "comment_id": 80127421, "body": "Thank you Jeeped &amp; u8it  for all your comments. I wil try it out and will let you know the result. Once again Thank you and really appreciate for your detailed explanation."}, {"owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 0, "creation_date": 1507213374, "post_id": 46573702, "comment_id": 80129217, "body": "I replaced my code with &quot;ThisWorkbook.Sheets.Add(After:=Sheets(Sheets.Count)).Name = &quot;Table_&quot; &amp; ia &#39; add new sheet ActiveSheet.Range(&quot;a1&quot;).PasteSpecial Format:=&quot;Text&quot;, Link:=False, DisplayAsIcon:=False&quot;, but no luck."}, {"owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 0, "creation_date": 1507213617, "post_id": 46573702, "comment_id": 80129383, "body": "@Jeeped The thing I noticed is that, when the template tries to paste the data from the clipboard for the first time, the error shoots up, but the data is already copied to the clipboard and when I try to paste directly from the clipboard, it gets pasted in to spreadsheet. however, when it again loops through, the same bug happens and I have to manually paste it from the clipboard because macro fails to paste into the spreadsheet."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1507149240, "creation_date": 1507149240, "answer_id": 46573702, "question_id": 46571633, "link": "https://stackoverflow.com/questions/46571633/vba-pastespecial-error-in-activesheet-pastespecial/46573702#46573702", "title": "VBA PasteSpecial error in ActiveSheet.PasteSpecial", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-pastespecial-method-excel\" rel=\"nofollow noreferrer\">.PasteSpecial</a> is a method of a <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-object-excel\" rel=\"nofollow noreferrer\">Range object</a>, not a  <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-object-excel\" rel=\"nofollow noreferrer\">Worksheet object</a>. <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-paste-method-excel\" rel=\"nofollow noreferrer\">.Paste</a> is a method of the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-object-excel\" rel=\"nofollow noreferrer\">Worksheet object</a>.</p>\n\n<p>Try replacing,</p>\n\n<pre><code>ThisWorkbook.Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"Table_\" &amp; ia ' add new sheet\nRange(\"a1\").Select ' paste table\nActiveSheet.PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:=False\n</code></pre>\n\n<p>... with,</p>\n\n<pre><code>ThisWorkbook.Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"Table_\" &amp; ia ' add new sheet\nActiveSheet.Range(\"a1\").PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:=False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 1, "creation_date": 1507233324, "post_id": 46574394, "comment_id": 80140635, "body": "Hi all, Thank you very much for all the help and support. The template works perfect for me now. The issue was caused by concurrency management between applications: the word app has not filled the clipboard before the Excel app calls the clipboard to paste. I confirmed this by investigating the clipboard at run-time using another object type. I tried with \u2022\tHave Excel hang for a specific amount of time before continuing to the paste function. Application.Wait Now + (TimeValue(&quot;00:00:01&quot;))"}, {"owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 0, "creation_date": 1507233345, "post_id": 46574394, "comment_id": 80140650, "body": "also, I used On Error Resume Next            Do             Err.Clear             ActiveSheet.PasteSpecial Format:=&quot;Text&quot;, Link:=False, DisplayAsIcon:=False     Loop Until Err.Number = 0            On Error GoTo 0"}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "reply_to_user": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 0, "creation_date": 1507233938, "post_id": 46574394, "comment_id": 80140872, "body": "@Rin Concurrency issue definitely makes sense. I like where you&#39;re going with the code you posted but you can use a couple improvements there. I&#39;ll edit my answer with these."}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "reply_to_user": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 0, "creation_date": 1507234623, "post_id": 46574394, "comment_id": 80141189, "body": "@Rin Also, if this answer has helped you solve your problem it&#39;d be great if you could up-vote and accept it. To accept it, click the check mark beside the answer. Thanks!"}, {"owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 0, "creation_date": 1507294907, "post_id": 46574394, "comment_id": 80164528, "body": "@ u8it  - Yes. Done! Thank you very much for the support. I can use your edited code which you gonna post for future references. Thank you."}, {"owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "reply_to_user": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 0, "creation_date": 1507295206, "post_id": 46574394, "comment_id": 80164703, "body": "@Rin Just so you know, I already posted the edited code at the top of my answer. I won&#39;t be adding anything else to that."}, {"owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "edited": false, "score": 0, "creation_date": 1507312552, "post_id": 46574394, "comment_id": 80174836, "body": "@ u8it - Ok.Thank you"}], "tags": [], "owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "is_accepted": true, "score": 3, "last_activity_date": 1507235440, "last_edit_date": 1507235440, "creation_date": 1507152102, "answer_id": 46574394, "question_id": 46571633, "link": "https://stackoverflow.com/questions/46571633/vba-pastespecial-error-in-activesheet-pastespecial/46574394#46574394", "title": "VBA PasteSpecial error in ActiveSheet.PasteSpecial", "body": "<h2><strong>EDIT</strong></h2>\n\n<p>The OP diagnosed the problem as being a concurrency issue where the clipboard was not copied to in time for the paste operation. The code below will solve this issue while maintaining a responsive UI and reasonable timeout and notification.</p>\n\n<pre><code>On Error Resume Next\nDim TimeoutLimit\nTimeoutLimit = 300\nDim TimeoutCounter\nTimeoutCounter = 0\nDo\n    Err.Clear\n    DoEvents 'Yield thread execution\n    ActiveSheet.PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:=False\n    TimeoutCounter = TimeoutCounter + 1\nLoop Until (Err.Number = 0 Or TimeoutCounter &gt; TimeoutLimit )\nOn Error GoTo 0\nIf TimeoutCounter &gt; TimeoutLimit Then\n    MsgBox \"Paste failed because of operation timeout\", vbCritical\n    'Is this fatal? Abort by proper exiting...\n    'Exit Sub\n    'Exit Function\nEnd If\n</code></pre>\n\n<hr>\n\n<p>I think your use of <code>ActiveSheet.PasteSpecial</code> is probably fine, based on the testing you've done and this <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-pastespecial-method-excel\" rel=\"nofollow noreferrer\">MSDN Documentation</a>. However, your problem might be that you're getting data incompatable with a <code>text</code> format as discussed below.</p>\n\n<p>Regarding the method, the <code>Worksheet.PasteSpecial</code> method is entirely different from the <code>Range.PasteSpecial</code>. I find it odd that the error you're getting says that a range method failed if you're calling the worksheet method. If that's accurate, I suspect that the Worksheet method calls the range method at some point.</p>\n\n<p>I can reproduce the specific error</p>\n\n<blockquote>\n  <p>PasteSpecial method of Range class failed</p>\n</blockquote>\n\n<p>for <code>Range.PasteSpecial</code> under the following conditions: </p>\n\n<ul>\n<li>the clipboard is empty</li>\n<li>the data was not copied from an Office\nApplication.</li>\n</ul>\n\n<p>Turns out, there is an office clipboard and a Windows clipboard. For instance, <code>Application.CutCopyMode</code> only controls the office clipboard. <code>Range.PasteSpecial</code> works off of the Office clipboard, while <code>Workbook.PasteSpecial</code> works off of the system or Windows clipboard. So it doesn't throw error if the office clipboard is empty, in fact, it throws an error for the opposite condition where an excel range is copied if it's being forced to use <code>Text</code> as its format.</p>\n\n<blockquote>\n  <p>PasteSpecial method of Worksheet class failed</p>\n</blockquote>\n\n<p>It also throws this error if the clipboard data cannot be converted to text (like a picture). You can handle this by <strong>not specifying a format and a default format will be used</strong>. It won't necessarily be text then, but this resolves the error for pasting an Excel Range.</p>\n\n<p>To illistrate this and check to see how your clipboard content is stored, view it from Excel as shown below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/uB4co.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uB4co.png\" alt=\"enter image description here\"></a></p>\n\n<p>Since it is possible that one thing or the other might be giving you different problems under different conditions, you could try to progress through your options like this...</p>\n\n<pre><code>On Error Resume Next\nActiveSheet.Range(\"A1\").PasteSpecial Paste:=xlPasteValues\nIf Err &gt; 0 Then\n    Err.Clear\n    ActiveSheet.PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:=False\n    If Err &gt; 0 Then\n        Err.Clear\n        'You could also try to manually retrieve data from clipboard at this point\n        ActiveSheet.PasteSpecial\n    End If\nEnd If\nOn Error GoTo 0\n</code></pre>\n\n<p>Like I said in my comments, <code>PasteSpecial</code> can be finicky. Thus I reccomended removing that as a factor and testing if you can directly access clipboard content like the code below (<a href=\"https://stackoverflow.com/a/9024237/3546415\">copied from here</a>)... </p>\n\n<pre><code>Sub GetClipBoardText()\n   Dim DataObj As MSForms.DataObject\n   Set DataObj = New MsForms.DataObject '&lt;~~ Amended as per jp's suggestion\n\n   On Error GoTo Whoa\n\n   '~~&gt; Get data from the clipboard.\n   DataObj.GetFromClipboard\n\n   '~~&gt; Get clipboard contents\n   myString = DataObj.GetText(1)\n   MsgBox myString\n\n   Exit Sub\nWhoa:\n   If Err &lt;&gt; 0 Then MsgBox \"Data on clipboard is not text or is empty\"\nEnd Sub\n</code></pre>\n\n<p>See this <a href=\"https://www.thespreadsheetguru.com/blog/2014/2/26/caution-creating-creating-pastespecial-macros\" rel=\"nofollow noreferrer\">documented case of the same error</a> that was being caused by the clipboard being empty and how easily this can happen with Office Macros. You are copying within your macro, so I wouldn't expect this to be your problem. Also, this code snippet will protect against a null for the <code>Range</code> method but not for the <code>Worksheet</code> method, since it only checks the application's clipboard and not the system's. </p>\n\n<pre><code>If Application.CutCopyMode = True Then\n  ActiveSheet.PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:=False\nElse\n  MsgBox(\"There is no data on the clipboard to be pasted.\")\nEnd If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2476, "user_id": 2674672, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/AvMmQ.jpg?s=128&g=1", "display_name": "Jamie Garroch - MVP", "link": "https://stackoverflow.com/users/2674672/jamie-garroch-mvp"}, "edited": false, "score": 0, "creation_date": 1594916294, "post_id": 54232927, "comment_id": 111301256, "body": "Application.Wait isn&#39;t available in all Office apps so I use the Sleep API instead, incrementing the sleep time by 50ms in a 1 to 10 paste retry loop. This forces the app to wait between a variable 50-500ms before timing out and that has been pretty reliable across lots of different specs of machines with lots of running task variables thrown into the mix in addition to the complexity of the data being copied to the clipboard."}], "tags": [], "owner": {"reputation": 1, "user_id": 6062040, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EkJkHfGHO1Y/AAAAAAAAAAI/AAAAAAAAAg0/5b6fqropMnY/photo.jpg?sz=128", "display_name": "Raju Khadgi", "link": "https://stackoverflow.com/users/6062040/raju-khadgi"}, "is_accepted": false, "score": 0, "last_activity_date": 1547718274, "last_edit_date": 1547718274, "creation_date": 1547717946, "answer_id": 54232927, "question_id": 46571633, "link": "https://stackoverflow.com/questions/46571633/vba-pastespecial-error-in-activesheet-pastespecial/54232927#54232927", "title": "VBA PasteSpecial error in ActiveSheet.PasteSpecial", "body": "<p>@Rin and @ it would be better to add wait function to reduce CPU load.\n<code>Application.Wait(Now + TimeValue(\"0:00:10\"))</code> 'wait for 10 seconds or as desired to make sure loop doesn't overload cpu and we can reduce TimeoutCounter </p>\n\n<pre><code>--revised code sample-\nOn Error Resume Next\nDim TimeoutLimit\nTimeoutLimit = 6 'counter reduced to 6 attempts\nDim TimeoutCounter\nTimeoutCounter = 0\nDo\n    Err.Clear\n    DoEvents 'Yield thread execution\n    ActiveSheet.PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:=False\n        If Err.Number &lt;&gt; 0 Then Application.Wait (Now + TimeValue(\"00:00:10\")) 'reduces CPU load\n    TimeoutCounter = TimeoutCounter + 1\nLoop Until (Err.Number = 0 Or TimeoutCounter &gt; TimeoutLimit )\nOn Error GoTo 0\nIf TimeoutCounter &gt; TimeoutLimit Then\n    MsgBox \"Paste failed because of operation timeout\", vbCritical\n    'Is this fatal? Abort by proper exiting...\n    'Exit Sub\n    'Exit Function\nEnd If\n--------------\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8722032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8d9de7406c0c29e3cd9613ed7be3b0e?s=128&d=identicon&r=PG&f=1", "display_name": "Rin", "link": "https://stackoverflow.com/users/8722032/rin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7980, "favorite_count": 0, "accepted_answer_id": 46574394, "answer_count": 3, "score": 3, "last_activity_date": 1554788630, "creation_date": 1507141190, "last_edit_date": 1554788630, "question_id": 46571633, "link": "https://stackoverflow.com/questions/46571633/vba-pastespecial-error-in-activesheet-pastespecial", "title": "VBA PasteSpecial error in ActiveSheet.PasteSpecial", "body": "<p>I have a macro to open a Word document in the backend and pull all the data tables into an Excel template.</p>\n\n<p>When I tested it in some of my colleagues' machines, they get a \"VBA PasteSpecial error\".</p>\n\n<p>I checked the references and add ins in my colleagues' machines are that of mine.</p>\n\n<pre><code>Dim sht As Worksheet\nDim WordDoc As Word.Document\nDim WordApp As Word.Application\nDim i As Long, r As Long, c As Long\nDim rng As Range, t As Word.Table\nDim ia As Integer\nDim OpenForms\nDim target As Range\nia = 1\nSet WordApp = CreateObject(\"Word.Application\")\nWordApp.Visible = False\nSet WordDoc = WordApp.Documents.Open(DOC_PATH, ReadOnly:=True)\nSet sht = Sheets(\"test\")\nSet rng = sht.Range(\"A5\")\nsht.Activate\nFor Each t In WordDoc.Tables\n    OpenForms = DoEvents\n    t.Range.Copy\n    OpenForms = DoEvents\n    ThisWorkbook.Sheets.Add(After:=Sheets(Sheets.Count)).Name = \"Table_\" &amp; ia ' add new sheet\n    Range(\"a1\").Select ' paste table\n    ActiveSheet.PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:=False\n    OpenForms = DoEvents\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1507140341, "post_id": 46571269, "comment_id": 80096340, "body": "<a href=\"https://support.office.com/en-us/article/SUMIFS-function-c9e748f5-7ea7-455d-9406-611cebce642b\" rel=\"nofollow noreferrer\">SUMIFS function</a>, and the ranges change based on demographic.  Something like <code>SUMIFS(IF(&lt;demographic=&quot;Person&quot;,&lt;Person Percent column&gt;,IF(&lt;demographic=&quot;Men&quot;,&lt;Men Percent column&gt;,.....</code> etc"}], "answers": [{"tags": [], "owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "is_accepted": false, "score": 0, "last_activity_date": 1507141277, "creation_date": 1507141277, "answer_id": 46571662, "question_id": 46571269, "link": "https://stackoverflow.com/questions/46571269/creating-a-formula-or-macro-to-sum-across-age-ranges-in-different-tables/46571662#46571662", "title": "Creating a formula or macro to sum across age ranges in different tables", "body": "<p>You can setup something like this to start:</p>\n\n<p><img src=\"https://i.stack.imgur.com/YD8OF.jpg\" alt=\"\"></p>\n\n<p><code>=VLOOKUP(G2,$A$2:$D$13,MATCH(G3,$A$1:$D$1,0),1)</code></p>\n\n<p>The key here in <code>VLOOKUP</code> is the 4th parameter needs to set to <code>TRUE</code> or <code>1</code>.  This will find the closest match so you just need the start points (don't need to input a range) in your data.</p>\n"}, {"tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1507147536, "creation_date": 1507147536, "answer_id": 46573311, "question_id": 46571269, "link": "https://stackoverflow.com/questions/46571269/creating-a-formula-or-macro-to-sum-across-age-ranges-in-different-tables/46573311#46573311", "title": "Creating a formula or macro to sum across age ranges in different tables", "body": "<p>Building on ian's post, you will need the sunproduct to be able to sum all the percentages for any given \"range\"\nThe first 3 parts check for a true false on every intersection giving a 1 or 0 and the last part (b2:d13) is the numbers you want summed.\n<a href=\"https://i.stack.imgur.com/YxNFT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YxNFT.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 8185649, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gj27XjXNkEQ/AAAAAAAAAAI/AAAAAAAAAAo/iL4VoeL67Y4/photo.jpg?sz=128", "display_name": "Michelle Zheng", "link": "https://stackoverflow.com/users/8185649/michelle-zheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 114, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1507147536, "creation_date": 1507139900, "last_edit_date": 1507140050, "question_id": 46571269, "link": "https://stackoverflow.com/questions/46571269/creating-a-formula-or-macro-to-sum-across-age-ranges-in-different-tables", "title": "Creating a formula or macro to sum across age ranges in different tables", "body": "<p>I currently have 3 tables that are separated into Person, Women, and Men, and their percentage breakouts in a product I am analyzing. The data looks something like this:</p>\n\n<pre><code>Person\nAge | Percent Breakout\n13-17 | 1%\n18-20 | 2%\n...\n\nWomen\nAge | Percent Breakout\n13-17 | 0.2%\n18-20 | 1%\n...\n\nMen\nAge | Percent Breakout\n13-17 | 0.8%\n18-20 | 1%\n</code></pre>\n\n<p>What I was wondering was how I could create a formula or a macro which will help me calculate the breakouts given filtering by whether it is person, women, or men, and also the beginning number for the age range and the end number for the age range. </p>\n\n<p>Right now, I have a skeleton set up where I have data validated dropdown cells where I have:</p>\n\n<pre><code>Demographic: Person, Women, Men\nAge Start: 13,18,21,25,30,35,40,45,50,55,65+\nAge End: 17,20,24,29,34,39,44,49,54,64,65+\n</code></pre>\n\n<p>Now I'm trying to create an if statement which will first check which table to look at, then check the number at the beginning of the range, check the number at the end of the range, and through that criteria, sum up all of the relevant percentages. </p>\n\n<p>I feel like there's definitely a straightforward way to do this, and I would love some help!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507139689, "post_id": 46571145, "comment_id": 80095994, "body": "<code>If ActiveSheet.Shapes(Application.Caller).Name = ....</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507139730, "post_id": 46571145, "comment_id": 80096008, "body": "To base it on the location instead of the name: <code>If ActiveSheet.Shapes(Application.Caller).TopLeftCell.Address = ....</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507139884, "post_id": 46571145, "comment_id": 80096079, "body": "To base it on the text shown in the shape: <code>If ActiveSheet.Shapes(Application.Caller).TextFrame2.TextRange.&zwnj;&#8203;Characters.Text = ....</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507141214, "post_id": 46571145, "comment_id": 80096829, "body": "@tigeravatar - Ah, right. I misread the question."}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 7983597, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-Q32yv1hay3k/AAAAAAAAAAI/AAAAAAAAADc/d-53BjJOB6Y/photo.jpg?sz=128", "display_name": "Rohan Goel", "link": "https://stackoverflow.com/users/7983597/rohan-goel"}, "is_accepted": false, "score": 0, "last_activity_date": 1507142073, "creation_date": 1507142073, "answer_id": 46571880, "question_id": 46571145, "link": "https://stackoverflow.com/questions/46571145/associate-macro-to-forms-in-an-sheet/46571880#46571880", "title": "Associate macro to forms in an Sheet", "body": "<p>The easiest way I can think of doing what you want to do is to have a form control button instead of a shape.</p>\n\n<p>If you open the developer tab, click insert and under form controls, put a button. In the button macro, you can add the code you want, so if that button is pressed, it will execute that macro.</p>\n\n<p>Then you can add the second code (currently under elseif in your code) to the second form control button.</p>\n"}], "owner": {"reputation": 1, "user_id": 8612016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81a4028656dc7ee9d332f77c3d137afa?s=128&d=identicon&r=PG&f=1", "display_name": "Israel Almeida", "link": "https://stackoverflow.com/users/8612016/israel-almeida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507143354, "creation_date": 1507139475, "last_edit_date": 1507143354, "question_id": 46571145, "link": "https://stackoverflow.com/questions/46571145/associate-macro-to-forms-in-an-sheet", "title": "Associate macro to forms in an Sheet", "body": "<p>Could anyone give me a tip on this problem?</p>\n\n<p>I have added these two \"Rounded Rectangle\" (B1 and B2) in my worksheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/P8qIi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/P8qIi.png\" alt=\"Rectangles in the WorkSheet\"></a></p>\n\n<p>I also have written the macro (mainMacro) below:</p>\n\n<pre><code>Sub mainMacro() \n\nif \"B1 was selected\" then\n  'do something\nelseif \"B2 was selected\" then\n   'do other thing.\nend If \n\nEnd Sub\n</code></pre>\n\n<p>My question is: Is there any way to write a VBA code who will do something based on what retangle a user has clicked (as I wrote in the 'If' statement of the mainMacro)?</p>\n\n<p>Obs:I have noted that VBA identifies these rectangles as  :<strong>Array(\"Rounded Rectangle x\")</strong></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1507139535, "post_id": 46571054, "comment_id": 80095912, "body": "Use <code>wb.Sheets(cmb).Rows(1).Find(Form.ComboBox2.Value).Column</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1507139541, "post_id": 46571054, "comment_id": 80095919, "body": "<code>OutputColumn = Application.Match(Form.ComboBox2.Value,wb.Worksheets(cmb).Ro&zwnj;&#8203;ws(1),0)</code>"}, {"owner": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1507144690, "post_id": 46571054, "comment_id": 80098745, "body": "@ScottCraner: This returns column number instead of the alphabet. ie: returns 2 instead of &#39;B&#39;"}, {"owner": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507144702, "post_id": 46571054, "comment_id": 80098750, "body": "@tigeravatar This returns column number instead of the alphabet. ie: returns 2 instead of &#39;B&#39;"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507144995, "post_id": 46571054, "comment_id": 80098896, "body": "Typically you want it to return the number, not the letter. If it absolutely must be the letter, this will work for you: <code>Replace(wb.Worksheets(cmb).Rows(1).Find(FormComboBox2Value).&zwnj;&#8203;Address(0, 0), &quot;1&quot;, vbNullString)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1507145135, "post_id": 46571054, "comment_id": 80098966, "body": "Columns also allows for and index; <code>Set sourceColumn = wb.Worksheets(cmb).Columns(OutputColumn)</code>"}], "owner": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1507139135, "creation_date": 1507139135, "question_id": 46571054, "link": "https://stackoverflow.com/questions/46571054/find-match-in-a-particular-row-of-a-particular-sheet", "title": "Find/ Match in a particular row of a particular sheet", "body": "<p>I want to match a text/ string in Row 1 of a different workbook and sheet and return (<code>wb.Worksheets(cmb)</code>) its column number. \nMy code copies a column from a spreadsheet to another:</p>\n\n<pre><code>If Form.ComboBox4.Value &lt;&gt; \"\" Then\n        Set sourceColumn = wb.Worksheets(cmb).Columns(\"E\")\n        Set targetColumn = Workbooks(\"B.xlsm\").ActiveSheet.Columns(\"C\")\n        sourceColumn.Copy Destination:=targetColumn\nEnd If\n</code></pre>\n\n<p>Typically, I want to do something like:</p>\n\n<pre><code>wb.Worksheets(cmb).Match(Form.ComboBox2.Value, Rows(1))\n</code></pre>\n\n<p>This doesnt work because obviously, the syntax is wrong. \nWhat is the right way to do this? **If the value (<code>Form.ComboBox2.Value</code>) matches, I want it to return the corresponding column number of the resulting match ** that I can substitute here <code>wb.Worksheets(cmb).Columns(\"E\")</code></p>\n\n<p>This is how the sheet looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8994K.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8994K.png\" alt=\"enter image description here\"></a></p>\n\n<p>Say if <code>Form.ComboBox2.Value</code> = '<code>ITEM.</code>', Then it should return '<code>A</code>'</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1507142449, "post_id": 46571027, "comment_id": 80097543, "body": "Try using <code>deficit = Cells(6, &quot;CI&quot;).value2</code>. As far as I was aware VBA only uses the <code>.</code> for a decimal separator and doesn&#39;t do locale settings so even if the cell uses a comma separator vba will see it as a point separator. Using <code>.Value2</code> though strips out any formatting and just returns the underlying value of a <code>Range</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507142562, "post_id": 46571027, "comment_id": 80097604, "body": "The comma used in your locale as a decimal separator will not be affecting things, unless the cell contains text that looks like a number, rather than an actual number."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507142708, "post_id": 46571027, "comment_id": 80097689, "body": "Are you sure that your Excel formulas are set up so that, as you change CJ6, CI6 will converge to zero?  Try single-stepping through your code while also watching what values are being put into CJ6 and what is being calculated in CI6 based on the new value."}, {"owner": {"reputation": 4626, "user_id": 3541320, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/tO4gK.png?s=128&g=1", "display_name": "pmiranda", "link": "https://stackoverflow.com/users/3541320/pmiranda"}, "edited": false, "score": 0, "creation_date": 1507143148, "post_id": 46571027, "comment_id": 80097911, "body": "Yes, I will add a gif here showing how it&#39;s working. Its ok when <code>tolerancia</code>is 1 or higher. Look: <a href=\"https://i.imgur.com/e5fW4Jv.gif\" rel=\"nofollow noreferrer\">i.imgur.com/e5fW4Jv.gif</a>"}, {"owner": {"reputation": 4626, "user_id": 3541320, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/tO4gK.png?s=128&g=1", "display_name": "pmiranda", "link": "https://stackoverflow.com/users/3541320/pmiranda"}, "edited": false, "score": 0, "creation_date": 1507143378, "post_id": 46571027, "comment_id": 80098033, "body": "When <code>deficit = 0,33</code>is not entering to <code>If (deficit &gt; 0) Then</code>"}, {"owner": {"reputation": 4626, "user_id": 3541320, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/tO4gK.png?s=128&g=1", "display_name": "pmiranda", "link": "https://stackoverflow.com/users/3541320/pmiranda"}, "edited": false, "score": 0, "creation_date": 1507144006, "post_id": 46571027, "comment_id": 80098384, "body": "Ok guys, I got it. <code>deficit</code>will no change anymore if is a <code>Single</code>data type, that&#39;s why get stucked in -0,32557734381407500000 plus, the Excel was considering only 4 decimals, so it tries to reach a <code>tolerancia</code> that will never reach"}, {"owner": {"reputation": 4626, "user_id": 3541320, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/tO4gK.png?s=128&g=1", "display_name": "pmiranda", "link": "https://stackoverflow.com/users/3541320/pmiranda"}, "edited": false, "score": 0, "creation_date": 1507144143, "post_id": 46571027, "comment_id": 80098445, "body": "With doube it reach the value:  0,00136849842965603000 , and that&#39;s below than <code>tolerancia</code>so it stops. Finally!"}], "answers": [{"tags": [], "owner": {"reputation": 1553, "user_id": 7806300, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/S7U65.jpg?s=128&g=1", "display_name": "addohm", "link": "https://stackoverflow.com/users/7806300/addohm"}, "is_accepted": false, "score": 1, "last_activity_date": 1507143879, "creation_date": 1507143879, "answer_id": 46572363, "question_id": 46571027, "link": "https://stackoverflow.com/questions/46571027/macro-on-vba-get-stucked-on-values-under-1/46572363#46572363", "title": "Macro on VBA get stucked on values under 1", "body": "<p>When dealing with floating point values it's best to use floating point when referencing a number, even as a literal, or the assumed data type will be the type entered as a literal.  0 = INT, 0.0 = FLOATING POINT.</p>\n"}, {"tags": [], "owner": {"reputation": 4626, "user_id": 3541320, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/tO4gK.png?s=128&g=1", "display_name": "pmiranda", "link": "https://stackoverflow.com/users/3541320/pmiranda"}, "is_accepted": false, "score": 1, "last_activity_date": 1507144669, "creation_date": 1507144669, "answer_id": 46572554, "question_id": 46571027, "link": "https://stackoverflow.com/questions/46571027/macro-on-vba-get-stucked-on-values-under-1/46572554#46572554", "title": "Macro on VBA get stucked on values under 1", "body": "<p>Ok, the problem was with the value type of the numbers, I had tu use Long, now it works, with Single the deficit would never reach the If case when listo is true (with tolerancia under 0.1). The code is:</p>\n\n<pre><code>Sub SolverPaulo()\n\n    Dim listo As Boolean\n    Dim min As Double\n    Dim max As Double\n    Dim beta As Double\n    Dim tolerancia As Double\n    Dim deficit As Double\n    Dim prom As Double\n\n    listo = False\n    min = 0\n    max = 1\n    beta = 0\n    tolerancia = 0.1\n\n    While listo = False\n        prom = (min + max) / 2\n        Cells(6, \"CJ\") = prom\n        deficit = Cells(6, \"CI\").Value2\n\n        If (deficit &gt; 0) Then\n            If (deficit &lt; tolerancia) Then\n                beta = prom\n                listo = True\n            Else: min = prom\n            End If\n\n        Else\n            If (Abs(deficit) &lt; tolerancia) Then\n                beta = prom\n                listo = True\n            Else: max = prom\n            End If\n        End If\n    Wend\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>A video working:</p>\n\n<p><a href=\"https://i.imgur.com/qRRXZ4Y.gif\" rel=\"nofollow noreferrer\">https://i.imgur.com/qRRXZ4Y.gif</a></p>\n"}], "owner": {"reputation": 4626, "user_id": 3541320, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/tO4gK.png?s=128&g=1", "display_name": "pmiranda", "link": "https://stackoverflow.com/users/3541320/pmiranda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507144669, "creation_date": 1507139052, "last_edit_date": 1531164843, "question_id": 46571027, "link": "https://stackoverflow.com/questions/46571027/macro-on-vba-get-stucked-on-values-under-1", "title": "Macro on VBA get stucked on values under 1", "body": "<p>I have this macro:</p>\n\n<pre><code>Sub SolverPaulo()\n\n    Dim listo As Boolean\n    Dim min As Single\n    Dim max As Single\n    Dim beta As Single\n    Dim tolerancia As Single\n    Dim deficit As Single\n    Dim prom As Single\n\n    listo = False\n    min = 0\n    max = 1\n    beta = 0\n    tolerancia = 0.1\n\n    While listo = False\n        prom = (min + max) / 2\n        Cells(6, \"CJ\") = prom\n        deficit = Cells(6, \"CI\")\n\n        If (deficit &gt; 0) Then\n            If (deficit &lt; tolerancia) Then\n                beta = prom\n                listo = True\n            Else: min = prom\n            End If\n\n        Else\n            If (Abs(deficit) &lt; tolerancia) Then\n                beta = prom\n                listo = True\n            Else: max = prom\n            End If\n        End If\n    Wend\n\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>If I define <code>tolerancia = 1</code> or any value higher than 1 the macro works fine, but if I define values like <code>tolerancia = 0.1</code> or inferior under 1, the macro keeps working there in an infinite loop. I need to use <code>tolerancia = 0.00001</code></p>\n\n<p>I'm not sure of <code>Single</code> is a correct data type for the vars that I'm using, this is the first time that I work with VBA.</p>\n\n<p>The idea is the macro should stop when <code>deficit</code> becomes minor than the <code>tolerancia</code></p>\n\n<p>At a certain point, the macro decide this:</p>\n\n<pre><code>If (0.33 &lt; tolerancia)\n</code></pre>\n\n<p>There's when it crash... if <code>tolerancia</code> is actually minor than <code>0.33</code>. When I compare <code>tolerancia</code> with numbers higher than 1 there's no problem.</p>\n\n<p>Now, in my Excel file, the configuration is in spanish, so the decimals are separated with <code>,</code> and not with <code>.</code> could be a reason that is failing on do that:</p>\n\n<pre><code>if (0,33 &lt; 0.5)\n</code></pre>\n\n<p>comparing coma and point?</p>\n\n<p>Any hint?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1507139818, "post_id": 46570937, "comment_id": 80096041, "body": "<i>What I want is, in case of any error occurs with in the loop then loop has to restart.</i>  Why do you suppose that this won&#39;t simply cause the error to occur again. And again. And again..."}, {"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1507140333, "post_id": 46570937, "comment_id": 80096336, "body": "Actually you are correct, however the reason I am asking is because - I have tested this code in my colleague&#39;s system the error happens only when the IE takes time to load after entering the credentials and clicking the login button and this happens only for the &quot;first time&quot; so if we logout and close the IE and then run the code again it works. I know we could add this line of code &quot; Application.Wait (Now + TimeValue(&quot;0:00:8&quot;))&quot; to make sure it waits, but I want it to be accurate and time saving so restarting the loop will help my situation."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1507140536, "post_id": 46570937, "comment_id": 80096452, "body": "This is an x/y question. Don&#39;t use <code>Application.Wait</code>. Use a proper ready/waiting loop to ensure IE object isn&#39;t busy."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1507140614, "post_id": 46570937, "comment_id": 80096503, "body": "<a href=\"https://stackoverflow.com/questions/24923608/vba-html-not-running-on-all-computers/24934878#24934878\" title=\"vba html not running on all computers\">stackoverflow.com/questions/24923608/&hellip;</a>"}, {"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1507141576, "post_id": 46570937, "comment_id": 80097021, "body": "Thank a lot David it worked !!!  I will also look at the link and enhance my coding skill. Also i have a doubt from the below coding at this line &quot;  Err.Clear()&quot; it says compile error: Expected: = and when I removed the &quot;()&quot; it worked !! Could you please explain me !! Thank in advance for you help !!"}, {"owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1507204791, "post_id": 46570937, "comment_id": 80122937, "body": "Hi David Zemens, I tried all the steps in the link but it only works for the initial loading time which is the very first login, after entering into the webpage, but after that it does not works (Meaning it skips and Do events and goes to next line of code."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1507206203, "post_id": 46570937, "comment_id": 80123868, "body": "you need to ask a new question. include the code you&#39;re using, and link to the other answers so people can see what exactly you&#39;re doing."}], "answers": [{"tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1507140681, "last_edit_date": 1507140681, "creation_date": 1507140228, "answer_id": 46571354, "question_id": 46570937, "link": "https://stackoverflow.com/questions/46570937/how-to-restart-for-loop-when-error-occurs-vba/46571354#46571354", "title": "How to restart for loop when error occurs vba", "body": "<p>Sounds like your real problem is that your code isn't properly waiting. Instead of <code>Application.Wait</code>, use a proper waiting loop any time you invoke the <code>IE.Navigate</code> or any element <code>.Click</code> or form <code>.Submit</code> event.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/24923608/vba-html-not-running-on-all-computers/24934878#24934878\">VBA HTML not running on all computers</a></p>\n\n<p>Otherwise, you don't have any active error-trapping in your code. Wrap your loop with <code>On Error</code> statements, as below. </p>\n\n<p>The first one, <code>On Error GoTo MyErrorHandler</code> instructs the program of what to do if an error is encountered within the loop. If there's an error, the code underneath the <code>MyErrorHandler</code> label will execute, and resume at the <code>NextJ</code> label. Once the loop finishes, <code>On Error GoTo 0</code> returns normal (i.e., none) error-handling. Any errors occurring outside the loop still raise an exception during runtime.</p>\n\n<pre><code>Option Explicit\nSub Get_Data()\n    '// Dim your variables\n\n    '// Executable code starts here\n\nJumpToHere:    \n    For j = S To E\n        On Error GoTo MyErrorHandler\n        ' Now ANY ERROR, ANYWHERE in the loop will go to the error handler\n\nNextJ:\n    Next j\n    '// Code below this line won't be subject to the error handler\n    On Error GoTo 0\n\n    '// more code if you have it\n\n    ' Exit gracefully if there was no error:\n    Exit Sub\n\n    '// Here is the error handler:\n    MyErrorHandler:\n        Err.Clear()\n        Resume NextJ\nEnd Sub\n</code></pre>\n\n<p>If you truly want to re-start the loop, then instead of <code>NextJ</code>, do <code>Resume JumpToHere</code>.</p>\n"}], "owner": {"reputation": 139, "user_id": 6354197, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a567a09d6c27f9bcf8332bd45e3101fc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6354197/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1373, "favorite_count": 0, "accepted_answer_id": 46571354, "answer_count": 1, "score": 0, "last_activity_date": 1507140681, "creation_date": 1507138710, "last_edit_date": 1531164843, "question_id": 46570937, "link": "https://stackoverflow.com/questions/46570937/how-to-restart-for-loop-when-error-occurs-vba", "title": "How to restart for loop when error occurs vba", "body": "<p>I am doing IE automation using VBA (Basically I open IE and goto the specific URL from the sheet and then login using credentials from the sheet and then extract data from the webpage to excel) This has to happen for 20 websites so I added for loop and it works fine.</p>\n\n<p>What I want is, in case of any error occurs with in the loop then loop has to restart.\nI also tried \"on error got 0, on error got -1\" but it did not work.\nBelow is my Code - Kindly pardon me for poor coding I am new to VBA.</p>\n\n<pre><code>    Sub Get_Data()\n    Sheets(\"Sheet2\").Select\n    Range(\"E2\").Select\n    Range(\"H6:H120\").ClearContents\n    Dim IE As Object\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    IE.Visible = True\n    Dim E As Long\n    Dim S As Long\n    E = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nJumpToHere:\n    For j = S To E\n        S = Range(\"H\" &amp; Rows.Count).End(xlUp).Row\n        Sheets(\"Sheet2\").Select\n        Range(\"E\" &amp; S).Select\n        ActiveCell.Offset(1, -2).Select\n        Dim X As Variant\n        X = ActiveCell.Value\n        IE.navigate X\n        Do\n            If IE.ReadyState = 4 Then\n                IE.Visible = True\n                Exit Do\n            Else\n                DoEvents\n            End If\n        Loop\n\n        ActiveCell.Offset(0, 1).Select\n        Dim Y As Variant\n        Y = ActiveCell.Value\n        IE.document.all(\"username\").Value = Y\n        ActiveCell.Offset(0, 1).Select\n        Dim Z As Variant\n        Z = ActiveCell.Value\n        IE.document.all(\"password\").Value = Z\n        IE.document.all(\"merchant_login_submit_button\").Click\n        Application.Wait (Now + TimeValue(\"0:00:8\"))\n\n        Set ElementCol = IE.document.getElementsByTagName(\"span\")\n        For Each link In ElementCol\n            If link.innerHTML = \"Authentication Failed\" Then\n                ActiveCell.Offset(0, 3).Value = \"Authentication Failed\"\n                GoTo JumpToHere\n            End If\n        Next\n\n        Set tags = IE.document.getElementsByTagName(\"input\")\n        For Each tagx In tags\n            If tagx.Value = \"Continue to Control Panel\" Then\n                tagx.Click\n                Application.Wait (Now + TimeValue(\"0:00:3\"))\n                Exit For\n            End If\n        Next\n\n\n        Set ElementCol = IE.document.getElementsByTagName(\"a\")\n        For Each link In ElementCol\n            If link.innerHTML = \"Reports\" Then\n                link.Click\n            End If\n        Next\n        Application.Wait (Now + TimeValue(\"0:00:06\"))\n        Dim checkdate As Integer\n        checkdate = Format(Date, \"dd\") - 1\n\n        IE.document.getElementById(\"snapshot_group_by\").Value = \"payment_processor\"\n        IE.document.getElementById(\"snapshot_end_date_day\").Value = checkdate\n        IE.document.all(\"reports_submit_button\").Click\n        Application.Wait (Now + TimeValue(\"0:00:3\"))\n\n        Dim ws As Worksheet\n        Dim rng As Range\n        Dim tbl As Object\n        Dim rw As Object\n        Dim cl As Object\n        Dim tabno As Long\n        Dim nextrow As Long\n        Dim I As Long\n\n        Set ws = Worksheets.Add\n\n        For Each tbl In IE.document.getElementsByTagName(\"TABLE\")\n            tabno = tabno + 1\n            nextrow = nextrow + 1\n            Set rng = ws.Range(\"B\" &amp; nextrow)\n            rng.Offset(, -1) = \"Table \" &amp; tabno\n            For Each rw In tbl.Rows\n                For Each cl In rw.Cells\n                    rng.Value = cl.outerText\n                    Set rng = rng.Offset(, 1)\n                    I = I + 1\n                Next cl\n                nextrow = 0\n                Set rng = rng.Offset(1, -I)\n                I = 0\n            Next rw\n        Next tbl\n\n        ws.Cells.ClearFormats\n        Sheets(\"Sheet2\").Select\n        ActiveCell.Offset(0, 3).Value = ActiveSheet.Previous.Range(\"F4\")\n        Application.DisplayAlerts = False\n        ActiveSheet.Previous.Delete\n        Application.DisplayAlerts = True\n\n        Set ElementCol = IE.document.getElementsByTagName(\"a\")\n        For Each link In ElementCol\n            If link.innerHTML = \"Logout\" Then\n                link.Click\n            End If\n        Next\n    Next j\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 657, "user_id": 5994620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjudG.jpg?s=128&g=1", "display_name": "BerticusMaximus", "link": "https://stackoverflow.com/users/5994620/berticusmaximus"}, "edited": false, "score": 1, "creation_date": 1507138757, "post_id": 46570920, "comment_id": 80095514, "body": "SO isn&#39;t a free coding service. Do some research and come back with an actual question on where you&#39;re getting stuck. Please refer to <a href=\"https://stackoverflow.com/help/how-to-ask\">How to ask</a> for more information."}], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 1, "user_id": 8721836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9852f799ba2b70b841742c0c53279d44?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch Hom", "link": "https://stackoverflow.com/users/8721836/mitch-hom"}, "edited": false, "score": 0, "creation_date": 1507320953, "post_id": 46597786, "comment_id": 80178728, "body": "Mark it as an answer if it helped you."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1507260188, "creation_date": 1507260188, "answer_id": 46597786, "question_id": 46570920, "link": "https://stackoverflow.com/questions/46570920/macro-function-for-webscraping/46597786#46597786", "title": "Macro Function for webscraping", "body": "<p>Try this.</p>\n\n<pre><code>'Samir Khan\n'simulationconsultant@gmail.com\n'The latest version of this spreadsheet can be downloaded from http://investexcel.net/multiple-stock-quote-downloader-for-excel/\n'Please link to http://investexcel.net if you like this spreadsheet\n\n\nSub DownloadStockQuotes(ByVal stockTicker As String, ByVal StartDate As Date, ByVal EndDate As Date, ByVal DestinationCell As String, ByVal freq As String)\n\nDim qurl As String\nDim StartMonth, StartDay, StartYear, EndMonth, EndDay, EndYear As String\n\nqurl = \"http://finance.google.com/finance/historical?q=\" &amp; stockTicker\nqurl = qurl &amp; \"&amp;startdate=\" &amp; MonthName(Month(StartDate), True) &amp; _\n       \"+\" &amp; Day(StartDate) &amp; \"+\" &amp; Year(StartDate) &amp; _\n       \"&amp;enddate=\" &amp; MonthName(Month(EndDate), True) &amp; _\n       \"+\" &amp; Day(EndDate) &amp; \"+\" &amp; Year(EndDate) &amp; \"&amp;output=csv\"\n\nOn Error GoTo ErrorHandler:\n\nQueryQuote:\nWith ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; qurl, Destination:=Range(DestinationCell))\n    .BackgroundQuery = True\n    .TablesOnlyFromHTML = False\n    .Refresh BackgroundQuery:=False\n    .SaveData = True\nEnd With\n\nErrorHandler:\n\nEnd Sub\n\nSub DownloadData()\n\nDim frequency As String\nDim numRows As Integer\nDim lastRow As Integer\nDim lastErrorRow As Integer\nDim lastSuccessRow As Integer\nDim stockTicker As String\nDim numStockErrors As Integer\nDim numStockSuccess As Integer\n\nnumStockErrors = 0\nnumStockSuccess = 0\n\nApplication.Calculation = xlCalculationManual\nApplication.ScreenUpdating = False\n\nlastErrorRow = ActiveSheet.Cells(Rows.Count, \"J\").End(xlUp).Row\nlastSuccessRow = ActiveSheet.Cells(Rows.Count, \"L\").End(xlUp).Row\n\nClearErrorList lastErrorRow\nClearSuccessList lastSuccessRow\n\nlastRow = ActiveSheet.Cells(Rows.Count, \"a\").End(xlUp).Row\nfrequency = Worksheets(\"Parameters\").Range(\"b7\")\n\n'Delete all sheets apart from Parameters sheet\nDim ws As Worksheet\nApplication.DisplayAlerts = False\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Parameters\" And ws.Name &lt;&gt; \"About\" Then ws.Delete\nNext\n\nApplication.DisplayAlerts = True\n\n'Loop through all tickers\nFor ticker = 12 To lastRow\n\n    stockTicker = Worksheets(\"Parameters\").Range(\"$a$\" &amp; ticker)\n\n    If stockTicker = \"\" Then\n        GoTo NextIteration\n    End If\n\n    Sheets.Add After:=Sheets(Sheets.Count)\n\n    If InStr(stockTicker, \":\") &gt; 0 Then\n        ActiveSheet.Name = Replace(stockTicker, \":\", \"\")\n    Else\n        ActiveSheet.Name = stockTicker\n    End If\n\n    Cells(1, 1) = \"Stock Quotes for \" &amp; stockTicker\n    Call DownloadStockQuotes(stockTicker, Worksheets(\"Parameters\").Range(\"$b$5\"), Worksheets(\"Parameters\").Range(\"$b$6\"), \"$a$2\", frequency)\n    Columns(\"a:a\").TextToColumns Destination:=Range(\"a1\"), DataType:=xlDelimited, _\n                                 TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n                                 Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1))\n\n\n    If InStr(stockTicker, \":\") &gt; 0 Then\n        stockTicker = Replace(stockTicker, \":\", \"\")\n    End If\n\n    Sheets(stockTicker).Columns(\"A:G\").ColumnWidth = 10\n\n    lastRow = Sheets(stockTicker).UsedRange.Row - 2 + Sheets(stockTicker).UsedRange.Rows.Count\n\n    If lastRow &lt; 3 Then\n        Application.DisplayAlerts = False\n        Sheets(stockTicker).Delete\n        numStockErrors = numStockErrors + 1\n        ErrorList stockTicker, numStockErrors\n        GoTo NextIteration\n        Application.DisplayAlerts = True\n    Else\n        numStockSuccess = numStockSuccess + 1\n        If Left(stockTicker, 1) = \"^\" Then\n            SuccessList Replace(stockTicker, \"^\", \"\"), numStockSuccess\n        Else\n            SuccessList stockTicker, numStockSuccess\n        End If\n    End If\n\n    Sheets(stockTicker).Sort.SortFields.Add Key:=Range(\"A3:A\" &amp; lastRow), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal\n    With Sheets(stockTicker).Sort\n        .SetRange Range(\"A2:G\" &amp; lastRow)\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n\n    Range(\"a3:a\" &amp; lastRow).NumberFormat = \"yyyy-mm-dd;@\"\n\n    'Delete final blank row otherwise will get ,,,, at bottom of CSV\n    Sheets(stockTicker).Rows(lastRow + 1 &amp; \":\" &amp; Sheets(stockTicker).Rows.Count).Delete\n\n    'Remove initial ^ in ticker names from Sheets\n    If Left(stockTicker, 1) = \"^\" Then\n        ActiveSheet.Name = Replace(stockTicker, \"^\", \"\")\n    Else\n        ActiveSheet.Name = stockTicker\n    End If\n\n    'Remove hyphens in ticker names from Sheet names, otherwise error in collation\n    If InStr(stockTicker, \"-\") &gt; 0 Then\n        ActiveSheet.Name = Replace(stockTicker, \"-\", \"\")\n    End If\n\n\nNextIteration:\nNext ticker\n\nApplication.DisplayAlerts = False\n\nIf Sheets(\"Parameters\").Shapes(\"WriteToCSVCheckBox\").ControlFormat.Value = xlOn Then\n    On Error GoTo ErrorHandler:\n    Call CopyToCSV\nEnd If\n\nIf Sheets(\"Parameters\").Shapes(\"CollateDataCheckBox\").ControlFormat.Value = xlOn Then\n    On Error GoTo ErrorHandler:\n    Call CollateData\nEnd If\n\nErrorHandler:\n\nWorksheets(\"Parameters\").Select\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nWorksheets(\"Parameters\").Select\nFor Each C In ThisWorkbook.Connections\n    C.Delete\nNext\n\nEnd Sub\nSub CollateData()\n\nDim ws As Worksheet\nDim i As Integer, first As Integer\nDim maxRow As Integer\nDim maxTickerWS As Worksheet\n\nmaxRow = 0\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Parameters\" Then\n        If ws.UsedRange.Rows.Count &gt; maxRow Then\n            maxRow = ws.UsedRange.Rows.Count\n            Set maxTickerWS = ws\n        End If\n    End If\nNext\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Open\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"High\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Low\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Close\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Volume\"\n\nSheets.Add After:=Sheets(Sheets.Count)\nActiveSheet.Name = \"Adjusted Close\"\n\ni = 1\nmaxTickerWS.Range(\"A2\", \"B\" &amp; maxRow).Copy Destination:=Sheets(\"Open\").Cells(1, i)\nSheets(\"Open\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"High\").Cells(1, i)\nmaxTickerWS.Range(\"c2\", \"c\" &amp; maxRow).Copy Destination:=Sheets(\"High\").Cells(1, i + 1)\nSheets(\"High\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"Low\").Cells(1, i)\nmaxTickerWS.Range(\"d2\", \"d\" &amp; maxRow).Copy Destination:=Sheets(\"Low\").Cells(1, i + 1)\nSheets(\"Low\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"Close\").Cells(1, i)\nmaxTickerWS.Range(\"e2\", \"e\" &amp; maxRow).Copy Destination:=Sheets(\"Close\").Cells(1, i + 1)\nSheets(\"Close\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"Volume\").Cells(1, i)\nmaxTickerWS.Range(\"f2\", \"f\" &amp; maxRow).Copy Destination:=Sheets(\"Volume\").Cells(1, i + 1)\nSheets(\"Volume\").Cells(1, i + 1) = maxTickerWS.Name\n\nmaxTickerWS.Range(\"A2\", \"a\" &amp; maxRow).Copy Destination:=Sheets(\"Adjusted Close\").Cells(1, i)\nmaxTickerWS.Range(\"g2\", \"g\" &amp; maxRow).Copy Destination:=Sheets(\"Adjusted Close\").Cells(1, i + 1)\nSheets(\"Adjusted Close\").Cells(1, i + 1) = maxTickerWS.Name\n\ni = i + 2\n\nFor Each ws In Worksheets\n\n    If ws.Name &lt;&gt; \"Parameters\" And ws.Name &lt;&gt; \"About\" And ws.Name &lt;&gt; maxTickerWS.Name And ws.Name &lt;&gt; \"Open\" And ws.Name &lt;&gt; \"High\" And ws.Name &lt;&gt; \"Low\" And ws.Name &lt;&gt; \"Close\" And ws.Name &lt;&gt; \"Volume\" And ws.Name &lt;&gt; \"Adjusted Close\" Then\n\n        Sheets(\"Open\").Cells(1, i) = ws.Name\n        Sheets(\"Open\").Range(Sheets(\"Open\").Cells(2, i), Sheets(\"Open\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",2,0)\"\n\n        Sheets(\"High\").Cells(1, i) = ws.Name\n        Sheets(\"High\").Range(Sheets(\"High\").Cells(2, i), Sheets(\"High\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",3,0)\"\n\n        Sheets(\"Low\").Cells(1, i) = ws.Name\n        Sheets(\"Low\").Range(Sheets(\"Low\").Cells(2, i), Sheets(\"Low\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",4,0)\"\n\n        Sheets(\"Close\").Cells(1, i) = ws.Name\n        Sheets(\"Close\").Range(Sheets(\"Close\").Cells(2, i), Sheets(\"Close\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",5,0)\"\n\n        Sheets(\"Volume\").Cells(1, i) = ws.Name\n        Sheets(\"Volume\").Range(Sheets(\"Volume\").Cells(2, i), Sheets(\"Volume\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",6,0)\"\n\n        Sheets(\"Adjusted Close\").Cells(1, i) = ws.Name\n        Sheets(\"Adjusted Close\").Range(Sheets(\"Adjusted Close\").Cells(2, i), Sheets(\"Adjusted Close\").Cells(maxRow - 1, i)).Formula = _\n        \"=vlookup(A2,\" &amp; ws.Name &amp; \"!A$2:G$\" &amp; maxRow &amp; \",7,0)\"\n\n        i = i + 1\n\n    End If\nNext\n\nOn Error Resume Next\n\nSheets(\"Open\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"Close\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"High\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"Low\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"Volume\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\nSheets(\"Adjusted Close\").UsedRange.SpecialCells(xlFormulas, xlErrors).Clear\n\nOn Error GoTo 0\n\nSheets(\"Open\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"High\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"Low\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"Close\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"Volume\").Columns(\"A:A\").EntireColumn.AutoFit\nSheets(\"Adjusted Close\").Columns(\"A:A\").EntireColumn.AutoFit\nEnd Sub\n\nSub SuccessList(ByVal stockTicker As String, ByVal numStockSuccess As Integer)\n\nSheets(\"Parameters\").Range(\"L\" &amp; 10 + numStockSuccess) = stockTicker\n\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlDiagonalDown).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlDiagonalUp).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeLeft).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeTop).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeBottom).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeRight).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlInsideVertical).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlInsideHorizontal).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlDiagonalDown).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlDiagonalUp).LineStyle = xlNone\n\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\n\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlInsideVertical).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Borders(xlInsideHorizontal).LineStyle = xlNone\n\nWith Sheets(\"Parameters\").Range(\"L10:L\" &amp; 10 + numStockSuccess).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent2\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\n\nEnd Sub\n\nSub ErrorList(ByVal stockTicker As String, ByVal numStockErrors As Integer)\n\nSheets(\"Parameters\").Range(\"J\" &amp; 10 + numStockErrors) = stockTicker\n\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlDiagonalDown).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlDiagonalUp).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeLeft).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeTop).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeBottom).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeRight).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlInsideVertical).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlInsideHorizontal).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlDiagonalDown).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlDiagonalUp).LineStyle = xlNone\n\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlMedium\nEnd With\n\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlInsideVertical).LineStyle = xlNone\nSheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Borders(xlInsideHorizontal).LineStyle = xlNone\n\nWith Sheets(\"Parameters\").Range(\"J10:J\" &amp; 10 + numStockErrors).Interior\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorAccent2\n    .TintAndShade = 0.799981688894314\n    .PatternTintAndShade = 0\nEnd With\n\nEnd Sub\n\nSub ClearErrorList(ByVal lastErrorRow As Integer)\nIf lastErrorRow &gt; 10 Then\n    Worksheets(\"Parameters\").Range(\"J11:J\" &amp; lastErrorRow).Clear\n    With Sheets(\"Parameters\").Range(\"J10\").Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"J10\").Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"J10\").Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"J10\").Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\nEnd If\nEnd Sub\n\nSub ClearSuccessList(ByVal lastSuccessRow As Integer)\nIf lastSuccessRow &gt; 10 Then\n    Worksheets(\"Parameters\").Range(\"L11:L\" &amp; lastSuccessRow).Clear\n    With Sheets(\"Parameters\").Range(\"L10\").Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"L10\").Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"L10\").Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\n    With Sheets(\"Parameters\").Range(\"L10\").Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlMedium\n    End With\nEnd If\nEnd Sub\n\n\nSub CopyToCSV()\n\nDim MyPath As String\nDim MyFileName As String\n\ndateFrom = Worksheets(\"Parameters\").Range(\"$b$5\")\ndateTo = Worksheets(\"Parameters\").Range(\"$b$6\")\nfrequency = Worksheets(\"Parameters\").Range(\"$b$7\")\nMyPath = Worksheets(\"Parameters\").Range(\"$b$8\")\n\nFor Each ws In Worksheets\n    If ws.Name &lt;&gt; \"Parameters\" And ws.Name &lt;&gt; \"About\" Then\n        ticker = ws.Name\n        MyFileName = ticker &amp; \" \" &amp; Format(dateFrom, \"dd-mm-yyyy\") &amp; \" - \" &amp; Format(dateTo, \"dd-mm-yyyy\") &amp; \" \" &amp; frequency\n        If Not Right(MyPath, 1) = \"\\\" Then MyPath = MyPath &amp; \"\\\"\n        If Not Right(MyFileName, 4) = \".csv\" Then MyFileName = MyFileName &amp; \".csv\"\n        Sheets(ticker).Copy\n        With ActiveWorkbook\n            .SaveAs Filename:= _\n                    MyPath &amp; MyFileName, _\n                    FileFormat:=xlCSV, _\n                    CreateBackup:=False\n            .Close False\n        End With\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/d4lmb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/d4lmb.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"http://investexcel.net/multiple-stock-quote-downloader-for-excel/\" rel=\"nofollow noreferrer\">http://investexcel.net/multiple-stock-quote-downloader-for-excel/</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8721836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9852f799ba2b70b841742c0c53279d44?s=128&d=identicon&r=PG&f=1", "display_name": "Mitch Hom", "link": "https://stackoverflow.com/users/8721836/mitch-hom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1507260188, "creation_date": 1507138636, "last_edit_date": 1531161705, "question_id": 46570920, "link": "https://stackoverflow.com/questions/46570920/macro-function-for-webscraping", "title": "Macro Function for webscraping", "body": "<p>How do I create a macro for excel to web scrape certain data from a website(s) and have those data(s) implemented into a database, and have that macro loop for many websites in the same database? For example I want to pull the open and close prices from <a href=\"https://finance.yahoo.com/quote/CSCO?p=CSCO\" rel=\"nofollow noreferrer\">https://finance.yahoo.com/quote/CSCO?p=CSCO</a> and <a href=\"https://finance.yahoo.com/quote/BBRY/\" rel=\"nofollow noreferrer\">https://finance.yahoo.com/quote/BBRY/</a></p>\n\n<p>Thank you</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8721459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d574bc3806319af518e1c44c4e0227?s=128&d=identicon&r=PG&f=1", "display_name": "Paul F.", "link": "https://stackoverflow.com/users/8721459/paul-f"}, "is_accepted": false, "score": 0, "last_activity_date": 1507148101, "creation_date": 1507148101, "answer_id": 46573432, "question_id": 46570804, "link": "https://stackoverflow.com/questions/46570804/vba-define-string-to-worksheet-name-without-reference/46573432#46573432", "title": "VBA - Define string to worksheet.name without reference", "body": "<p>Well, I started all over again and just used the most important code and now it works. I don't know why but it does. So I think it was just an error by Excel itself. \nAnyways thank you braX for editing advice </p>\n"}], "owner": {"reputation": 1, "user_id": 8721459, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d574bc3806319af518e1c44c4e0227?s=128&d=identicon&r=PG&f=1", "display_name": "Paul F.", "link": "https://stackoverflow.com/users/8721459/paul-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 491, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507148101, "creation_date": 1507138179, "last_edit_date": 1507139935, "question_id": 46570804, "link": "https://stackoverflow.com/questions/46570804/vba-define-string-to-worksheet-name-without-reference", "title": "VBA - Define string to worksheet.name without reference", "body": "<p>I am new to VBA and got that problem which I don't know how to fix.\nI have a workbook with some sheets and I create a new workbook for each sheet in that first one with the name of the sheets. That works...\nNow, I declare a variable of type string which defines the path to one of these new workbooks.<br>\nAfter defining that string I use that in the open function and when i change something in that workbook i opened, it also changes it in the worksheet where i get the name from(e.g. the name of the worksheet, like below)  </p>\n\n<pre><code>Public Sub ProcessWorksheet(ByVal Worksheet As Excel.Worksheet)\n     Dim fileName As String\n     Dim currProFile as Workbook\n     Dim currProSheet as Worksheet\n     fileName =\"some path\" &amp; \"\\\" &amp; worksheet.name &amp; \".xlsx\"\n     Set currProFile = Workbooks.Open(fileName)\n     Set currProSheet = currProFile.ActiveSheet\n     currProSheet.name = \"DATA\"\nEnd Sub\n</code></pre>\n\n<p>So I think there is a reference to that worksheet i just use for the name cause of that worksheet.name.<br>\nMy question is: How can I get the name without a reference to the worksheet.</p>\n\n<p>I hope it is all cleal and thanks for help!</p>\n"}, {"tags": ["vba", "excel", "loops", "find"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1507138329, "post_id": 46570338, "comment_id": 80095277, "body": "How do you identify which cells on the sheet contain the question of interest ??"}, {"owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1507140452, "post_id": 46570338, "comment_id": 80096406, "body": "The question is &quot;Additional Collateral?&quot; I use Cells.Find... to get find the question then OFFSET(0,1), which takes me to the answer. The every time I change the answer, it triggers the macro to run."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 0, "creation_date": 1507141336, "post_id": 46570338, "comment_id": 80096898, "body": "Why not directly check if the <code>Target</code> (the cell which got the change) is the yes/no cell and has your question to the left... this way only changed cells would be checked (which also is faster)???"}, {"owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "edited": false, "score": 0, "creation_date": 1507142609, "post_id": 46570338, "comment_id": 80097629, "body": "I would be open to that if I am understanding you correctly... Do you have an example? Mind you, there are may other questions that have the answer of yes or no. &quot;Additional Collateral?&quot; is a more unique value. So either way i think i have to check both values."}, {"owner": {"reputation": 7854, "user_id": 5461205, "user_type": "registered", "profile_image": "https://graph.facebook.com/1112471818782668/picture?type=large", "display_name": "Dirk Reichel", "link": "https://stackoverflow.com/users/5461205/dirk-reichel"}, "edited": false, "score": 1, "creation_date": 1507142977, "post_id": 46570338, "comment_id": 80097832, "body": "Whenever <code>Worksheet_Change</code> is triggered the <code>Target</code> has a range which has been changed =&gt; if <code>Target</code> is &quot;yes&quot; or &quot;no&quot;, check if <code>Target.Offset(0,-1)</code> is the <i>question</i>..."}, {"owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "edited": false, "score": 0, "creation_date": 1507144827, "post_id": 46570338, "comment_id": 80098813, "body": "I have updated with a new code. I am getting a Type Mismatch error that I am working on, but is the what you mean Dirk?"}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "is_accepted": true, "score": 1, "last_activity_date": 1507146445, "creation_date": 1507146445, "answer_id": 46573010, "question_id": 46570338, "link": "https://stackoverflow.com/questions/46570338/worksheet-change-macro-with-moving-trigger-cells/46573010#46573010", "title": "Worksheet_Change Macro with moving trigger cells", "body": "<p>The following code works just fine for my purposes.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Value = \"Yes\" Then\n    If Target.Offset(0, -3).Value = \"Additional Collateral?\" Then\n        Coll\n    Else\n        Exit Sub\n    End If\nElseIf Target.Value = \"No\" Then\n    If Target.Offset(0, -3).Value = \"Additional Collateral?\" Then\n        Coll\n    Else\n        Exit Sub\n    End If\nElse\n    Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>**</p>\n\n<pre><code>Sub Coll()\n\nDim r As Range, cell As Range\n\nSet r = Range(\"$X$1:X$1000\")\n\nFor Each cell In r\n    If cell.Value = \"Yes\" Then\n        Sheets(\"Additional Collateral\").Visible = True\n        Exit Sub\n    Else\n        Sheets(\"Additional Collateral\").Visible = xlVeryHidden\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 6520017, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/6b9dc53195f313e49b052444921e34a6?s=128&d=identicon&r=PG&f=1", "display_name": "Devin Roberts", "link": "https://stackoverflow.com/users/6520017/devin-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 46573010, "answer_count": 1, "score": 0, "last_activity_date": 1507146445, "creation_date": 1507136429, "last_edit_date": 1531164843, "question_id": 46570338, "link": "https://stackoverflow.com/questions/46570338/worksheet-change-macro-with-moving-trigger-cells", "title": "Worksheet_Change Macro with moving trigger cells", "body": "<p><strong>UPDATED</strong></p>\n\n<p>I need to show or hide a worksheet based on the answer to a question in the sheet. If the answer is \"Yes\", then show the sheet. If \"No\", then hide it. So that part is easy...</p>\n\n<p>Now, this question might exist multiple times on the sheet. If the answer to the question is \"Yes\" for ANY of the questions, then show the sheet; if ALL answers are \"No\", then hide the sheet. Assuming the questions and answers were always located in the same place that would be easy enough as well...</p>\n\n<p>Where I get lost is, the question and answers cells could really be almost anywhere within the sheet and could also occur an infinite number of times (would likely never exceed 10... but it could).</p>\n\n<p>So what I need, is a code that finds the question, OFFSETS(0,1), then triggers the macro if it equals the target.address. I can do that for the first time the question occurs in sheet, but if I answer the question further down, I can't get it trigger the macro.</p>\n\n<p>Here is where I am now:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Value = \"Yes\" Then\n    If Target.Offset(0, -3).Value = \"Additional Collateral?\" Then\n        Coll\n    Else\n        Exit Sub\n    End If\nElseIf Target.Value = \"No\" Then\n    If Target.Offset(0, -3).Value = \"Additional Collateral?\" Then\n        Coll\n    Else\n        Exit Sub\n    End If\nElse\n    Exit Sub\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>**</p>\n\n<pre><code>Sub Coll()\n\nIf ActiveCell.Value = \"Yes\" Then\nSheets(\"Additional Collateral\").Visible = True\nExit Sub\nElse\nSheets(\"Additional Collateral\").Visible = xlVeryHidden\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>This code does everything except If the answer is \"Yes\" for any of the \"Additional Collateral?\" questions I need the sheet to be visible. This code is only based on the most recent answer...</p>\n"}, {"tags": ["vba", "loops", "textbox"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1507136307, "post_id": 46570223, "comment_id": 80094240, "body": "You are the expert regarding your case and you know everything about it. Please do not assume that other people also have the full knowledge of it. Please be more specific and detailed: What do you want to acheive? What is working already? What is not working like it should? What are the error messages?"}], "answers": [{"tags": [], "owner": {"reputation": 6597, "user_id": 2967965, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jxcI6.png?s=128&g=1", "display_name": "MatSnow", "link": "https://stackoverflow.com/users/2967965/matsnow"}, "is_accepted": false, "score": 0, "last_activity_date": 1507186192, "creation_date": 1507186192, "answer_id": 46579491, "question_id": 46570223, "link": "https://stackoverflow.com/questions/46570223/textbox-values-inside-a-loop/46579491#46579491", "title": "TextBox values inside a loop", "body": "<p>You have to address the code-generated controls like this: <code>Controls.Item(\"ControlName\").Value</code></p>\n\n<p>So the following should work:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Cells(10, 10) = Controls(\"TxtBx1\").Value\n    Cells(10, 11) = Controls(\"TxtBx2\").Value\n    Cells(10, 12) = Controls(\"TxtBx3\").Value\n\n    'This works too\n    'Cells(10, 10) = Controls.Item(\"TxtBx1\").Value\nEnd sub\n</code></pre>\n\n<p>Furthermore the setting of the <code>Textbox.Name</code>-property is redundant.<br>\nThis line is not required:</p>\n\n<pre><code>.Name = \"TxtBx\" &amp; NL\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8721054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56c4cfa1375656fc7c3a1cc8cc10c1a3?s=128&d=identicon&r=PG&f=1", "display_name": "Ale348", "link": "https://stackoverflow.com/users/8721054/ale348"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507190369, "creation_date": 1507136061, "last_edit_date": 1507190369, "question_id": 46570223, "link": "https://stackoverflow.com/questions/46570223/textbox-values-inside-a-loop", "title": "TextBox values inside a loop", "body": "<p>Please i need your help, i have a problem with the next code, i want to write in different cells all the values that user enters, in the <code>Private Sub CommandButton1_Click()</code> i only write 3 of them, but i can\u00b4t do that even the fist value appears, only appears an error:</p>\n\n<blockquote>\n  <p>object doesn\u00b4t support this property or method.</p>\n</blockquote>\n\n<pre><code>Dim Label1 As Object\nDim txtB1 As Control\n\nFor NL = 1 To NumeroLineas\n    Set txtB1 = UserForm2.Controls.Add(\"Forms.TextBox.1\", \"TxtBx\" &amp; NL, True)\n\n    With txtB1\n        .Name = \"TxtBx\" &amp; NL\n        .Height = 25.5\n        .Width = 150\n        .Left = 150\n        .Top = 18 * NL * 2\n    End With    \nNext NL\nUserForm2.Show\n\n'This is UserForm2\nPrivate Sub CommandButton1_Click()\n    Cells(10, 10) = Controls.TxtBx1.Value\n    Cells(10, 11) = Controls.TxtBx2.Value\n    Cells(10, 12) = Controls.TxtBx3.Value\nEnd sub\n</code></pre>\n"}, {"tags": ["mysql", "vba", "unicode", "odbc", "adodb"], "comments": [{"owner": {"reputation": 119223, "user_id": 5070879, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/7534153a9cc70ad4e20680d6ca1b09ff?s=128&d=identicon&r=PG&f=1", "display_name": "Lukasz Szozda", "link": "https://stackoverflow.com/users/5070879/lukasz-szozda"}, "edited": false, "score": 2, "creation_date": 1507135016, "post_id": 46569745, "comment_id": 80093596, "body": "Welcome to world of SQL Injection. What if user writes <code>x&#39;);DROP DATABASE db_name;--</code>?"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1507135133, "post_id": 46569745, "comment_id": 80093659, "body": "Did you see the post re Unicode / ANSI - &quot; use MySQL ODBC UNICODE Driver instead of ANSI&quot;   <a href=\"https://stackoverflow.com/questions/25777214/vba-adodb-query-mysql-returns-character-corruption\" title=\"vba adodb query mysql returns character corruption\">stackoverflow.com/questions/25777214/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507135288, "post_id": 46569745, "comment_id": 80093744, "body": "What type is the <code>name</code> column? Is it a unicode type or a <code>varchar</code>? Also, use parameterized queries."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507135375, "post_id": 46569745, "comment_id": 80093783, "body": "Very very curious about that <code>Printf</code> function. If it&#39;s anything like <a href=\"https://stackoverflow.com/a/14534361/1188513\">this</a> then it&#39;s a very cool thing to have, but not for anything that involves SQL strings."}, {"owner": {"reputation": 153, "user_id": 4168141, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iRrEzWMUwtc/AAAAAAAAAAI/AAAAAAAAAFE/scyQw-v7q4w/photo.jpg?sz=128", "display_name": "Danny Holstein", "link": "https://stackoverflow.com/users/4168141/danny-holstein"}, "edited": false, "score": 0, "creation_date": 1507143618, "post_id": 46569745, "comment_id": 80098163, "body": "The <code>name</code> column is VarChar and I was always able to store &#176; in it, I switched it to NVarChar and nothing changed. I am able to store &#176; in it from Workbench  The print function yields a string that includes &#176;, I checked it with MsgBox."}, {"owner": {"reputation": 153, "user_id": 4168141, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iRrEzWMUwtc/AAAAAAAAAAI/AAAAAAAAAFE/scyQw-v7q4w/photo.jpg?sz=128", "display_name": "Danny Holstein", "link": "https://stackoverflow.com/users/4168141/danny-holstein"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1507144260, "post_id": 46569745, "comment_id": 80098511, "body": "@WayneG.Dunn You nailed it, thanks!"}, {"owner": {"reputation": 105038, "user_id": 1766831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ee974306d2def46eb69534fbcf95cc5?s=128&d=identicon&r=PG", "display_name": "Rick James", "link": "https://stackoverflow.com/users/1766831/rick-james"}, "edited": false, "score": 0, "creation_date": 1507242917, "post_id": 46569745, "comment_id": 80144399, "body": "See &quot;question mark&quot; in <a href=\"https://stackoverflow.com/questions/38363566/trouble-with-utf-8-characters-what-i-see-is-not-what-i-stored\" title=\"trouble with utf 8 characters what i see is not what i stored\">stackoverflow.com/questions/38363566/&hellip;</a>"}], "owner": {"reputation": 153, "user_id": 4168141, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-iRrEzWMUwtc/AAAAAAAAAAI/AAAAAAAAAFE/scyQw-v7q4w/photo.jpg?sz=128", "display_name": "Danny Holstein", "link": "https://stackoverflow.com/users/4168141/danny-holstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1507134323, "creation_date": 1507134323, "question_id": 46569745, "link": "https://stackoverflow.com/questions/46569745/how-do-i-insert-unicode-symbols-such-as-ohm-degree-with-odbc-mysql-using-vba", "title": "How do I INSERT unicode symbols (such as Ohm/degree) with ODBC (MySQL) using VBA", "body": "<p>My VBA code snippet is:</p>\n\n<pre><code>        Set rsRecords = CreateObject(\"ADODB.Recordset\")\n        strQuery = Printf(\"INSERT INTO `parameters` (`name`) VALUES ('%s');\", Cells(Row, 1).Text)\n        MsgBox (strQuery)\n        rsRecords.Open strQuery, oConn\n</code></pre>\n\n<p>The MsgBox properly displays the symbol (\u00b0) but MySQL Workbench shows me a (?) has been inserted instead. I can use Workbench to replace the ? with \u00b0, so I know it's not an issue with the DB table.</p>\n\n<p>It appears the issue is in ADODB. Any ideas on how to fix?</p>\n\n<p>Dan</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1507134314, "post_id": 46569595, "comment_id": 80093215, "body": "Actually, Column A appears to be &quot;<b><i>ITEM.</i></b>&quot;, not &quot;<b><i>ITEM</i></b>&quot;.  Do you still want it to match?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1507134987, "post_id": 46569595, "comment_id": 80093578, "body": "You would use <code>Find()</code> or possible <code>Match()</code> for this - have you tried anything?"}, {"owner": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "reply_to_user": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1507135607, "post_id": 46569595, "comment_id": 80093912, "body": "@RBarryYoung Oh no then. It should match &quot;ITEM.&quot;"}, {"owner": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507136260, "post_id": 46569595, "comment_id": 80094214, "body": "@TimWilliams I want the matching to happen in a particular workbook and sheet, how do I do that using match or find?"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1507140846, "creation_date": 1507140846, "answer_id": 46571539, "question_id": 46569595, "link": "https://stackoverflow.com/questions/46569595/vba-find-the-corresponding-column-of-a-given-header-string-in-a-particular-row/46571539#46571539", "title": "VBA - Find the corresponding column of a given header/string in a particular row &amp; workbook", "body": "<p>Untested but should get you started:</p>\n\n<pre><code>Sub Tester()\n\n    Dim f, sht As Worksheet, hdr, sourceColumn As Range\n\n    Set sht = Workbooks(\"B.xlsm\").ActiveSheet\n\n    If Form.ComboBox2.Value &lt;&gt; \"\" Then\n\n        Set sourceColumn = wb.Worksheets(cmb).Columns(\"B\")\n        hdr = sourceColumn.Cells(1).Value 'get the source header\n\n        Set f = sht.Rows(1).Find(what:=hdr, lookat:=xlWhole)\n\n        If Not f Is Nothing Then\n            sourceColumn.Copy Destination:=f\n        Else\n            MsgBox \"Destination column header '\" &amp; hdr &amp; \"' not found!\"\n        End If\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 677, "user_id": 3231292, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/94dc156ac93cb59d72c42ce1b43dc874?s=128&d=identicon&r=PG&f=1", "display_name": "user248884", "link": "https://stackoverflow.com/users/3231292/user248884"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 534, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1507140846, "creation_date": 1507133806, "last_edit_date": 1531164843, "question_id": 46569595, "link": "https://stackoverflow.com/questions/46569595/vba-find-the-corresponding-column-of-a-given-header-string-in-a-particular-row", "title": "VBA - Find the corresponding column of a given header/string in a particular row &amp; workbook", "body": "<p>My excelsheet is such:\n<a href=\"https://i.stack.imgur.com/xIb32.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xIb32.png\" alt=\"enter image description here\"></a></p>\n\n<p>As seen, Row 1 is the column headers (ITEM, PART NUMBER, ATA 2 ..)\nUsing VBA, How do I find the corresponding column in which a specific header is present (In Row 1)?</p>\n\n<p>Example: </p>\n\n<p>ITEM. is in Column A, so it should return 'A'</p>\n\n<p>MTBR is in Column L, so it should return 'L'</p>\n\n<p>The intent of this is to automate copy of particular columns from one spreadsheet to another. The current code is:</p>\n\n<pre><code>If Form.ComboBox2.Value &lt;&gt; \"\" Then\n        Set sourceColumn = wb.Worksheets(cmb).Columns(\"B\")\n        Set targetColumn = Workbooks(\"B.xlsm\").ActiveSheet.Columns(\"A\")\n        sourceColumn.Copy Destination:=targetColumn\nEnd If\n</code></pre>\n\n<p>As seen above, I am manually giving the column name. I want that the particular column is found after matching the text in <code>Form.ComboBox2.Value</code> in <code>wb.Worksheets(cmb)</code></p>\n\n<p>How do I search for the string in <code>Form.ComboBox2.Value</code> in Row 1 of <code>wb.Worksheets(cmb)</code> and return its column number that I can plug here <code>Set sourceColumn = wb.Worksheets(cmb).Columns(\"B\")</code></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1507133221, "post_id": 46569386, "comment_id": 80092561, "body": "You never copy anything to paste.  Also, note that each time it loops and goes to the next <code>z</code>, your <code>j</code> resets to <code>1</code>.  Also, you can take the <code>Dim wbk...</code> and <code>Set wbk...</code> out of the loop.  You&#39;re going to be trying to open al already opened workbook which could cause issues as well."}, {"owner": {"reputation": 1, "user_id": 8721307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/328bc0c1f9d95940ae711049153b4c10?s=128&d=identicon&r=PG&f=1", "display_name": "ant23rcc", "link": "https://stackoverflow.com/users/8721307/ant23rcc"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1507138527, "post_id": 46569386, "comment_id": 80095386, "body": "Sorry, I copied something on the line before I set the dimensions, just forgot to include it. What would you advise to do?"}], "owner": {"reputation": 1, "user_id": 8721307, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/328bc0c1f9d95940ae711049153b4c10?s=128&d=identicon&r=PG&f=1", "display_name": "ant23rcc", "link": "https://stackoverflow.com/users/8721307/ant23rcc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507138655, "creation_date": 1507133056, "last_edit_date": 1507138655, "question_id": 46569386, "link": "https://stackoverflow.com/questions/46569386/loop-to-write-paste-data-horizontally-until-certain-boundry-and-then-go-to-next", "title": "Loop to write paste data horizontally until certain boundry, and then go to next row", "body": "<p>Good afternoon. I started learning VBA recently and this site has been very helpful so far. I am not sure if this is quite a dumb question or not but here it goes: </p>\n\n<p>I have a loop that goes through all the files in a folder and formats them and analyzes them. It works fine, but the next step is to copy the range of formated data and paste it in a \"master\" workbook so the people who need to see the data do not need to sift through the different folders. The problem I have is that if I just input the data using a simple for loop, there will be either a long column or long row of data and I would like to use all of the workbook. I have trying to write something that would paste data horizontally and once it reaches around column \"z\" or so, it would carry over to row 35ish. Each block of data is appoximately 4 columns by 35 rows.\nBelow is what I tried to write and it keeps giving me error 1004 Application-defined or object-defined error (which may be from not selecting the master spreadsheet properly?)  </p>\n\n<pre><code> range(\"q28:t59\").Copy\n Dim z As Long\n For z = 1 To 26 Step 6\n     j = 1\n     Dim wbk As Excel.Workbook\n     Set wbk = Workbooks.Open(\"H:\\master_workbook_trial.xlsx\")\n     wbk.Sheets(\"sheet1\").range(j, z).PasteSpecial xlPasteValues\n     If z &gt;= 25 Then\n        j = j + 1\n     End If\n Next z\n</code></pre>\n\n<p>Thank you in advance for the help!</p>\n"}, {"tags": ["r", "excel", "vba"], "comments": [{"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1507184175, "post_id": 46569252, "comment_id": 80110859, "body": "You can replace clipboard content with something else, e.g. <code>ActiveSheet.Cells(1,1).Copy</code>"}], "owner": {"reputation": 11, "user_id": 8721328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aac38d9b6a78633ab661c5c6fc932c12?s=128&d=identicon&r=PG", "display_name": "sree22", "link": "https://stackoverflow.com/users/8721328/sree22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1507193814, "creation_date": 1507132634, "last_edit_date": 1531164843, "question_id": 46569252, "link": "https://stackoverflow.com/questions/46569252/empty-clipboard-using-vba", "title": "Empty clipboard using vba", "body": "<p>I am trying to read data from excel, send it to R for analysis and paste results in R. A warning message must be displayed whenever there is an error in connection to R and clipboard needs to be emptied before that.</p>\n\n<p>Problem in emptying clipboard. \nI tried </p>\n\n<pre><code>Application.CutCopyMode = False\n</code></pre>\n\n<p>But it doesn't work.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 299, "user_id": 8703483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/290da4be3d6762921c9b4501ea4f123c?s=128&d=identicon&r=PG&f=1", "display_name": "Stacking For Heap", "link": "https://stackoverflow.com/users/8703483/stacking-for-heap"}, "edited": false, "score": 0, "creation_date": 1507132311, "post_id": 46569108, "comment_id": 80091974, "body": "Shouldn&#39;t&quot; Worksheets(&quot;sheet6&quot;).Range(&quot;A1&quot;).Select&quot; give you SOME sort of hint what to do?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1507132492, "post_id": 46569108, "comment_id": 80092103, "body": "You shouldn&#39;t use Select as it&#39;s inefficient and usually unnecessary. If you are going to, the problem here is that you must first activate the sheet and then select the cell - you can&#39;t select a cell on a sheet which is not active."}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1507132563, "post_id": 46569108, "comment_id": 80092150, "body": "Oh ok, that&#39;s helpful.  I&#39;ll look into that.  Thank you for your reply. @SJR"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507132740, "post_id": 46569108, "comment_id": 80092257, "body": "My pleasure. As an aside, I assume CZ and DA are named ranges? Possible confusion with column letters so you might want to consider renaming."}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507133401, "post_id": 46569108, "comment_id": 80092693, "body": "That&#39;s good advice.  I&#39;m really deep into my cell references for this sheet (800+), but I&#39;ll keep that in mind for future projects. @SJR"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "edited": false, "score": 0, "creation_date": 1507132775, "post_id": 46569253, "comment_id": 80092282, "body": "That worked perfectly! Thank you.  I&#39;m going to go through your code and really understand it so I can duplicate it in the future.  I really appreciate your help."}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": true, "score": 1, "last_activity_date": 1507132638, "creation_date": 1507132638, "answer_id": 46569253, "question_id": 46569108, "link": "https://stackoverflow.com/questions/46569108/creating-a-list-on-another-sheet-run-time-error-9/46569253#46569253", "title": "Creating a List on Another Sheet - Run-Time Error 9", "body": "<p>Basically, always try to set and fully qualify your worksheet and range variables.  Then work with those directly instead of using Select/Activate.</p>\n\n<pre><code>Sub GenerateDates()\n\n    Dim wb As Workbook\n    Dim wsData As Worksheet\n    Dim wsDest As Worksheet\n    Dim rDest As Range\n    Dim FirstDate As Date\n    Dim LastDate As Date\n    Dim NextDate As Date\n\n    Set wb = ActiveWorkbook\n    Set wsData = wb.Sheets(1)\n    Set wsDest = wb.Sheets(6)\n    Set rDest = wsDest.Range(\"A1\")\n\n    FirstDate = wsData.Range(\"CZ\").Value\n    LastDate = wsData.Range(\"DA\").Value\n    NextDate = FirstDate\n\n    Do Until NextDate &gt; LastDate\n        rDest.Value = NextDate\n        Set rDest = rDest.Offset(1)\n        NextDate = NextDate + 1\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 46569253, "answer_count": 1, "score": 0, "last_activity_date": 1507132638, "creation_date": 1507132174, "question_id": 46569108, "link": "https://stackoverflow.com/questions/46569108/creating-a-list-on-another-sheet-run-time-error-9", "title": "Creating a List on Another Sheet - Run-Time Error 9", "body": "<p>I'm using the following code that I edited from <a href=\"https://stackoverflow.com/questions/21761451/generating-a-list-of-dates-given-the-start-and-end-dates\">another post</a> to list all the dates between a start and end date.  The list is being created on a different sheet than the cells containing start and end dates.  The code works if I have sheet6 open, but not if I'm on sheet1.  I get a 'run-time error 9: subscript out of range.' Debugging highlights the reference to sheet6.  How can I amend this code to work regardless of the active sheet?   </p>\n\n<pre><code>Sub GenerateDates()\n\nDim FirstDate As Date\nDim LastDate As Date\nDim NextDate As Date\n\nFirstDate = Sheet1.Range(\"CZ\").Value\nLastDate = Sheet1.Range(\"DA\").Value\n\nNextDate = FirstDate\nWorksheets(\"sheet6\").Range(\"A1\").Select\nDo Until NextDate &gt; LastDate\n\n    ActiveCell.Value = NextDate\n    ActiveCell.Offset(1, 0).Select\n    NextDate = NextDate + 1\n\nLoop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "namespaces", "subdirectory", "createobject"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507134983, "post_id": 46569660, "comment_id": 80093574, "body": "I&#39;ve looked at using the <code>FileSystemObject</code> the thing is that grabs all subfolders in the <code>C:\\..</code> drive and it grabs the second and third set of subfolders down from those subfolder. Your file loop will then grab all subsequent files.  I only want to pull the first and second set of files and subfolders not the 3rd or 4th set of subfolders down from the initial <code>C:\\.</code> drive"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "reply_to_user": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507135627, "post_id": 46569660, "comment_id": 80093922, "body": "This code will only return the first level of folders (tested Win7, Excel 2010 just now).  It&#39;s true that <code>fso</code> can be used to deep-dive.  That&#39;s normally achieved using a method called <a href=\"http://www.cpearson.com/excel/recursionandfso.htm\" rel=\"nofollow noreferrer\">recursion</a>, which I haven&#39;t used in this example."}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507139767, "post_id": 46569660, "comment_id": 80096022, "body": "right you can modify it either way but I want to do something in the middle. Not a &quot;deep dive&quot; as you put it and not just the first level. (I have like 7 levels of folders with a total of 140,000 files) I only want to grab say level 2-3 info"}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": false, "score": 0, "last_activity_date": 1507133967, "creation_date": 1507133967, "answer_id": 46569660, "question_id": 46568924, "link": "https://stackoverflow.com/questions/46568924/file-info-pull-from-sub-folders-only-2-3-levels-deep/46569660#46569660", "title": "File info pull from sub folders only 2-3 levels deep", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/library/aa242706(v=vs.60).aspx\" rel=\"nofollow noreferrer\">file system object</a> can do this for you.</p>\n\n<p>In this example, the code returns every subfolder on your C:\\ drive.</p>\n\n<pre><code>' Returns every folder under the C:\\.\nSub CrawlFolder()\n    Dim fso As FileSystemObject     ' Access the Windows file system.\n    Dim folder As folder            ' Used to loop over folders.\n\n\n    Set fso = New FileSystemObject\n    For Each folder In fso.GetFolder(\"C:\\\").SubFolders\n\n        Debug.Print folder.Name\n    Next\nEnd Sub\n</code></pre>\n\n<p>To view the results make sure you've turned the <code>Immediate</code> window on (<em>View</em> >> <em>Immediate Window</em>).</p>\n\n<p>To use the file system object you'll need to add a reference (<em>Tools</em> >> <em>References</em> >> <em>Windows Script Host Object Model</em>).</p>\n\n<p>You can add a second <code>For Each Loop</code> to view the files:</p>\n\n<pre><code>' Returns every folder under the C:\\.\nSub CrawlFolder()\n    Dim fso As FileSystemObject     ' Access the Windows file system.\n    Dim folder As folder            ' Used to loop over folders.\n    Dim file As file                ' Used to loop over files.\n\n    Set fso = New FileSystemObject\n    For Each folder In fso.GetFolder(\"C:\\\").SubFolders\n\n        For Each file In folder.Files\n\n            Debug.Print file.Name\n        Next\n    Next\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507140161, "post_id": 46571015, "comment_id": 80096241, "body": "I appreciate your help. This looks interesting but it didn&#39;t work. I got an error on the array line:  <code>results = Application.Transpose(results)</code>  I&#39;m also not positive your code will do what I want. It may not be possible. As mentioned above  I don&#39;t just want a &quot;deep dive&quot; and I don&#39;t just want the first level. (I have like 7 levels of folders with a total of 140,000 files) I only want to grab say level 2-3 info. (over even better have the user determine how many levels deep)"}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507142673, "post_id": 46571015, "comment_id": 80097660, "body": "So it doesn&#39;t seem to be working. I already have a code that pulls the file information of the first folder just fine. I want to know if I can grab specific levels of a folderpath. Does this code do that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507142792, "post_id": 46571015, "comment_id": 80097741, "body": "Yes it does. I&#39;m not sure why it won&#39;t work for you."}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507143560, "post_id": 46571015, "comment_id": 80098123, "body": "Where in your code do you determine how deep the folder/file pull goes?"}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507144890, "post_id": 46571015, "comment_id": 80098848, "body": "So I opened a new excel workbook and pasted exactly what you have above in a module there. I connected the <code>Sub ProcessFolder()</code> to a button. When I click it it pulls up the folder select window. When I select a folder and hit okay nothing happens"}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507230776, "post_id": 46571015, "comment_id": 80139284, "body": "thank you so much for this solution. I&#39;ve modified it to work for me. I was wondering if you have any suggestions on making it faster? I have to filter through quite a few files (140,000) and I&#39;m running on a laptop with weak processing power"}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507233181, "post_id": 46571015, "comment_id": 80140576, "body": "Also I don&#39;t want to print the titles of the columns everytime I click the button. How can I get rid of that feature"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507234885, "post_id": 46571015, "comment_id": 80141327, "body": "I updated <code>Sub ProcessFolder()</code> .  Changing the value of <code>RemoveTiles</code>  will give you the option of printing the titles."}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507300362, "post_id": 46571015, "comment_id": 80168077, "body": "What did you do to update <code>Sub ProcessFolder()</code> because now the username is printing all over the place?"}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507301690, "post_id": 46571015, "comment_id": 80168956, "body": "Yeah the original <code>Sub ProcessFolder()</code> worked great except for that titles line would screw up my formula and the <code>Const RemoveTiles As Boolean = True</code> didn&#39;t remove the titles and messed up the code. Any thoughts?"}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507302440, "post_id": 46571015, "comment_id": 80169420, "body": "Basically this line of code <code>Target.Offset(1, -1).Resize(UBound(results) - 1).Formula = &quot;=IFERROR(VLOOKUP(D3,$A$3:$B$10,2,FALSE),&quot;&quot;User Not Found&quot;&quot;)&quot;</code> references the wrong cells for <code>D3</code> as the Sub sorts through the different files. I&#39;ve also added: <code>Target.Offset(1, 13).Resize(UBound(results) - 1).Formula = &quot;=IFERROR(LOOKUP(REPT(&quot;&quot;z&quot;&quot;,255),MID(E3,SEARCH({&quot;&quot;dw&quot;&quot;,&quot;&quot;lex&zwnj;&#8203;&quot;&quot;,&quot;&quot;tex&quot;&quot;,&quot;&quot;qex&quot;&quot;,&quot;&zwnj;&#8203;&quot;qnxr&quot;&quot;,&quot;&quot;rex&quot;&quot;},E3)&zwnj;&#8203;,{6,7,7,7,8,7})),&quot;&quot;N&zwnj;&#8203;ot Found&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507302840, "post_id": 46571015, "comment_id": 80169652, "body": "Is there a way I could just share the file with you? It would probably be easier for you to look at. Sorry I&#39;m a little new to this whole stackoverflow thing"}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507303159, "post_id": 46571015, "comment_id": 80169851, "body": "Essentially my header will be set and does not need to be run by the code and I&#39;d like the code to just start in cell C3."}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507304853, "post_id": 46571015, "comment_id": 80170810, "body": "We are getting so close. I have headers in columns C2 to U2. The current code puts the data starting in C3 but it deletes the headers in columns C2 to I2. Also the relative reference for the formula is off because the first line of data the the code prints is the path of the folder selected. If the code could just not print that path way then the relative reference in the formula will sink up with the correct row"}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507305330, "post_id": 46571015, "comment_id": 80171051, "body": "I also want to be able to run the code multiple times. Is there a way to have it start the code at the next available row?"}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "edited": false, "score": 0, "creation_date": 1507306139, "post_id": 46571015, "comment_id": 80171504, "body": "Okay everything is fixed except for the issue above ^ I want to run the macro multiple time and have the data fill into the next available row"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 0, "last_activity_date": 1507303685, "last_edit_date": 1507303685, "creation_date": 1507139016, "answer_id": 46571015, "question_id": 46568924, "link": "https://stackoverflow.com/questions/46568924/file-info-pull-from-sub-folders-only-2-3-levels-deep/46571015#46571015", "title": "File info pull from sub folders only 2-3 levels deep", "body": "<p>I modified your code to work with arrays and use a recursive function to return the folder file information.</p>\n\n<hr>\n\n<pre><code>Sub ProcessFolder()\n    Dim FolderPath As String\n    Dim results As Variant\n    Dim Target As Range\n\n    FolderPath = getFileDialogFolder\n\n    If Len(FolderPath) = 0 Then Exit Sub\n\n    getFolderItems FolderPath, results\n    CompactResults results\n\n    With Worksheets(\"Sheet1\")\n        .Range(\"C3\", .Range(\"I\" &amp; Rows.Count).End(xlUp)).ClearContents\n        Set Target = .Range(\"C3\")\n        Set Target = Target.EntireRow.Cells(1, 4)\n        Target.Resize(UBound(results), UBound(results, 2)).Value = results\n        Target.Offset(1, -1).Resize(UBound(results) - 1).Formula = \"=IFERROR(VLOOKUP(D3,$A$3:$B$10,2,FALSE),\"\"User Not Found\"\")\"\n    End With\n\nEnd Sub\n\nSub CompactResults(ByRef results As Variant)\n    Dim data As Variant\n    Dim x As Long, x1 As Long, y As Long, y1 As Long\n\n    ReDim data(1 To UBound(results) + 1, 1 To UBound(results(0)) + 1)\n\n    For x = LBound(results) To UBound(results)\n        x1 = x1 + 1\n        y1 = 0\n        For y = LBound(results(x)) To UBound(results(x))\n            y1 = y1 + 1\n            data(x1, y1) = results(x)(y)\n        Next\n    Next\n\n    results = data\nEnd Sub\n\nFunction getFileDialogFolder() As String\n    With Application.FileDialog(msoFileDialogFolderPicker)\n        .Title = \"Select the Folder...\"\n        .AllowMultiSelect = False\n        If .Show Then\n            getFileDialogFolder = .SelectedItems(1)\n        End If\n    End With\nEnd Function\n\nSub getFolderItems(FolderPath As String, ByRef results As Variant, Optional MaxLevels As Long = 1, Optional oShell As Object, Optional Level As Long)\n    Dim oFile As Object, oFldr As Object\n\n    If oShell Is Nothing Then\n        ReDim results(0)\n        Set oShell = CreateObject(\"Shell.Application\")\n    End If\n\n    If Not IsEmpty(results(UBound(results))) Then ReDim Preserve results(UBound(results) + 1)\n\n    Set oFldr = oShell.Namespace(CStr(FolderPath))\n\n    results(UBound(results)) = getFolderFileDetailArray(oFldr.Self, oFldr)\n    results(UBound(results))(1) = oFldr.Self.Path\n    For Each oFile In oFldr.Items\n        ReDim Preserve results(UBound(results) + 1)\n        If oFldr.getDetailsOf(oFile, 2) = \"File folder\" Then\n            If Level &lt; MaxLevels Then\n                getFolderItems oFile.Path, results, MaxLevels, oShell, Level + 1\n            End If\n        End If\n        results(UBound(results)) = getFolderFileDetailArray(oFile, oFldr)\n    Next oFile\n\nEnd Sub\n\nFunction getFolderFileDetailArray(obj As Object, oFldr As Object) As Variant\n    Dim iCol As Integer\n    Dim vDetailSettings As Variant\n    vDetailSettings = Array(10, 0, 1, 156, 2, 4, 144, 146, 183, 185)\n\n    For iCol = LBound(vDetailSettings) To UBound(vDetailSettings)\n        vDetailSettings(iCol) = oFldr.getDetailsOf(obj, vDetailSettings(iCol))\n    Next iCol\n\n    getFolderFileDetailArray = vDetailSettings\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1193, "favorite_count": 1, "accepted_answer_id": 46571015, "answer_count": 2, "score": 0, "last_activity_date": 1507303685, "creation_date": 1507131661, "last_edit_date": 1507140525, "question_id": 46568924, "link": "https://stackoverflow.com/questions/46568924/file-info-pull-from-sub-folders-only-2-3-levels-deep", "title": "File info pull from sub folders only 2-3 levels deep", "body": "<p>I currently have a code that will allow the user to pick a folder and then the code will pull the file information for the files in that folder but not for any files in sub folders. I have 7 levels of subfolders containing about 140,000 files. I was wondering if there is a way for me to pull only pull the info of files in subfolder level 2-3 not solely 1 and not from all 7 levels. Thank you for your help.</p>\n\n<p>I don't think the \"pasting formula in column 3\" section will be relevant for this problem. </p>\n\n<p>The sections that probably matter are \"Picking a folder\" and \"Running through each file in the selected folder\"</p>\n\n<pre><code>Sub Compile3()\n  Dim oShell As Object\n  Dim oFile As Object\n  Dim oFldr As Object\n  Dim lRow As Long\n  Dim iCol As Integer\n  Dim vArray As Variant\n  vArray = Array(10, 0, 1, 156, 2, 4, 144, 146, 183, 185)\n\n  Set oShell = CreateObject(\"Shell.Application\")\n\n  Dim iRow As Long\n   iRow = Cells.find(What:=\"*\", SearchOrder:=xlRows, SearchDirection:=xlPrevious, LookIn:=xlValues).Row\n   lRow = iRow\n'----------------------Picking a folder-------------------------------------\n\n\n  With Application.FileDialog(msoFileDialogFolderPicker)\n    .title = \"Select the Folder...\"\n    If .Show Then\n      Set oFldr = oShell.Namespace(.SelectedItems(1))\n      With oFldr\n\n      'Don't show update on the screen until the macro is finished\n      Application.EnableEvents = False\n\n'---------------Column header information-----------------------------------\n\n        For iCol = LBound(vArray) To UBound(vArray)\n          If lRow = 2 Then\n            Cells(lRow, iCol + 4) = .getdetailsof(.items, vArray(iCol))\n          Else\n            Cells(lRow, iCol + 4) = \"...\"\n          End If             \n        Next iCol\n'---------------Running through each file in the selected folder------------   \n        For Each oFile In .items\n          lRow = lRow + 1\n\n          For iCol = LBound(vArray) To UBound(vArray)                   \n             Cells(lRow, iCol + 4) = .getdetailsof(oFile, vArray(iCol))    \n          Next iCol\n ' ---------------Pasting formula in column 3 -----------------------------             \n               If lRow &lt; 4 Then\n                        Cells(lRow, 3).Formula = \"=IFERROR(VLOOKUP(D3,$A$3:$B$10,2,FALSE),\"\"User Not Found\"\")\"\n\n           Else\n                    Cells((lRow - 1), 3).Copy\n                    Cells(lRow, 3).PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    Cells(lRow, 3).PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                    Application.CutCopyMode = False                                       \n\n           End If              \n'------------------------------------------------------------------------------            \n\n        Next oFile\n      End With\n    End If\nApplication.EnableEvents = True\n  End With  \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "drop-down-menu", "overflow"], "answers": [{"tags": [], "owner": {"reputation": 314, "user_id": 4404302, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/B3l7I.jpg?s=128&g=1", "display_name": "July", "link": "https://stackoverflow.com/users/4404302/july"}, "is_accepted": false, "score": 0, "last_activity_date": 1507134915, "creation_date": 1507134915, "answer_id": 46569904, "question_id": 46568809, "link": "https://stackoverflow.com/questions/46568809/select-ran-sharing-file-erroroverflow-vba-excel/46569904#46569904", "title": "Select Ran sharing file errorOverflow Vba excel", "body": "<p>Issue solved!</p>\n\n<p>It was due to some variables were declared as Integer into some functions, redeclared to long was the solution.  </p>\n"}], "owner": {"reputation": 314, "user_id": 4404302, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/B3l7I.jpg?s=128&g=1", "display_name": "July", "link": "https://stackoverflow.com/users/4404302/july"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507143432, "creation_date": 1507131378, "last_edit_date": 1507143432, "question_id": 46568809, "link": "https://stackoverflow.com/questions/46568809/select-ran-sharing-file-erroroverflow-vba-excel", "title": "Select Ran sharing file errorOverflow Vba excel", "body": "<p>I developed a macro that update information about counters per hour in a graph with a action function. It sense the user action with <code>Worksheet_Change</code> that go to a DATA sheet and filter all the cells with the same information.</p>\n\n<p><a href=\"https://i.stack.imgur.com/4LZMY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4LZMY.png\" alt=\"enter image description here\"></a>\nThe cell B1 (Validation data) is updated with <code>Worksheet_SelectionChange</code> eliminating duplicates from the data and then User can select the option they want. There are not any issues running the macro but when the update function filter more than 550 values. A MsgBox is thrown with the following message:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lmpvX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lmpvX.png\" alt=\"enter image description here\"></a></p>\n\n<p>All the values before that index is working, it doesnt matter with string user select. This an example of a DATA table. </p>\n\n<p><a href=\"https://i.stack.imgur.com/bEcB6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bEcB6.png\" alt=\"enter image description here\"></a></p>\n\n<p>The next block code update the drop-down list:</p>\n\n<pre><code>Function Get_CluName()\n    Dim Dic_Clu As Object\n    Dim i As Long\n    Dim Col As Integer\n\n    Set Dic_Clu = CreateObject(\"Scripting.Dictionary\")\n\n    Call InitSht\n\n    If ShtData.Range(\"B1\").Value = \"LTE Cell Group\" Then\n        Worksheets(\"GRAPH\").Range(\"A1\").Value = \"Select Cluster:\"\n        Col = 2\n    ElseIf ShtData.Range(\"D1\").Value = \"Cell Name\" Then\n        Worksheets(\"GRAPH\").Range(\"A1\").Value = \"Select Cell:\"\n        Col = 4\n    End If\n\n    For i = 2 To ShtData.Range(\"A1048576\").End(xlUp).Row\n        If Len(ShtData.Cells(i, Col).Value) &gt; 0 Then\n            Dic_Clu(Trim(ShtData.Cells(i, Col).Value)) = Trim(ShtData.Cells(i, Col).Value)\n        End If\n    Next\n\n    If Dic_Clu.Count &gt; 0 Then\n        Worksheets(\"GRAPH\").Range(\"Z1\").Resize(Dic_Clu.Count) = Application.Transpose(Dic_Clu.keys)\n        Worksheets(\"SUMMARY LTE KPI\").Range(\"Z1\").Resize(Dic_Clu.Count) = Application.Transpose(Dic_Clu.keys)\n\n        With Worksheets(\"GRAPH\").Range(\"B1\").Validation\n            .Delete\n            .Add Type:=xlValidateList, Formula1:=\"=\" &amp; Worksheets(\"GRAPH\").Range(\"Z1\").Resize(Dic_Clu.Count).Address\n        End With\n\n        With Worksheets(\"SUMMARY LTE KPI\").Range(\"B1\").Validation\n            .Delete\n            .Add Type:=xlValidateList, Formula1:=\"=\" &amp; Worksheets(\"SUMMARY LTE KPI\").Range(\"Z1\").Resize(Dic_Clu.Count).Address\n        End With\n    End If\nEnd Function \n</code></pre>\n\n<p>**Is there any option to resize the memory of drop-down list? ** as it seems that is overflowing the list. </p>\n"}, {"tags": ["excel", "vba", "google-sheets"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507135242, "post_id": 46568574, "comment_id": 80093721, "body": "I&#39;ve seen this before - the only solution seems to be to export all of your code and the worksheets you want to keep into a &quot;clean&quot; workbook.  There seems to be no way to remove the &quot;phantom&quot; sheets.  (I don&#39;t recall if I tried round-tripping through different Excel file formats though)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507140464, "post_id": 46568574, "comment_id": 80096414, "body": "OK not the same problem I described...  Lucky for you!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3076017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/800709203/picture?type=large", "display_name": "Keith Dickens", "link": "https://stackoverflow.com/users/3076017/keith-dickens"}, "edited": false, "score": 0, "creation_date": 1507137684, "post_id": 46568915, "comment_id": 80094930, "body": "Dude.  I&#39;ve never used &#39;very hidden&#39; before.  Thank you for your answer, it worked perfectly."}, {"owner": {"reputation": 230, "user_id": 5768847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qz9e-gLgqOc/AAAAAAAAAAI/AAAAAAAAHvU/bxWGUutbgJA/photo.jpg?sz=128", "display_name": "Blake", "link": "https://stackoverflow.com/users/5768847/blake"}, "reply_to_user": {"reputation": 11, "user_id": 3076017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/800709203/picture?type=large", "display_name": "Keith Dickens", "link": "https://stackoverflow.com/users/3076017/keith-dickens"}, "edited": false, "score": 0, "creation_date": 1507145595, "post_id": 46568915, "comment_id": 80099202, "body": "I don&#39;t know how you did it, but I am glad it worked."}], "tags": [], "owner": {"reputation": 230, "user_id": 5768847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qz9e-gLgqOc/AAAAAAAAAAI/AAAAAAAAHvU/bxWGUutbgJA/photo.jpg?sz=128", "display_name": "Blake", "link": "https://stackoverflow.com/users/5768847/blake"}, "is_accepted": true, "score": 1, "last_activity_date": 1507131622, "creation_date": 1507131622, "answer_id": 46568915, "question_id": 46568574, "link": "https://stackoverflow.com/questions/46568574/erroneous-sheet-objects-in-excel-wont-delete/46568915#46568915", "title": "Erroneous Sheet Objects in Excel won&#39;t delete", "body": "<p>Open the VBA editor and click on one of the hidden sheets. In the VBA editor there should be a properties panel, usually under the project explorer, look at the visible property and set it to \"1 - xlSheetVisible.\" 0 is a normal hidden sheet and 2 is a very hidden sheet. Nothing can be done to a very hidden sheet.</p>\n"}], "owner": {"reputation": 11, "user_id": 3076017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/800709203/picture?type=large", "display_name": "Keith Dickens", "link": "https://stackoverflow.com/users/3076017/keith-dickens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 46568915, "answer_count": 1, "score": 0, "last_activity_date": 1507131622, "creation_date": 1507130705, "question_id": 46568574, "link": "https://stackoverflow.com/questions/46568574/erroneous-sheet-objects-in-excel-wont-delete", "title": "Erroneous Sheet Objects in Excel won&#39;t delete", "body": "<p>I had an error in my code that I have since corrected but it made a bunch of sheets objects while it was running that I didn't notice.  The sheets are not simply hidden, they don't exist in the Excel frontend and can't be unhidden.</p>\n\n<p>normally I just write a code like sheet15.delete and let the VBA takes care of this kind of thing for me.  But these sheets can't seem to be deleted that way.  I've also checked the window setting on the view tab in Excel and the unhide option is greyed out.</p>\n\n<p>I've also saved the workbook as xlsx, stripping out the VBA, with intention of importing the VBA back in from backups.  But before I can even inport the VBA, the sheets are listed in the VBA editor of the xlsx file.  Very frustrating and weird.</p>\n\n<p>Any idea how I can delete these false sheets without starting a new project and just importing the forms?\n<a href=\"https://i.stack.imgur.com/R2g8T.png\" rel=\"nofollow noreferrer\">too many sheeeeeets</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 1, "creation_date": 1507131163, "post_id": 46568505, "comment_id": 80091173, "body": "if it is to prevent end-user from accidentally saving and overwriting original WorkBook, than you could just make original file Read-Only."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 2, "creation_date": 1507131483, "post_id": 46568505, "comment_id": 80091390, "body": "Using <code>ActiveWorkbook.SaveCopyAs</code> will bypass the <code>Workbook_BeforeSave</code>"}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1507131793, "post_id": 46568505, "comment_id": 80091623, "body": "@Robby   Would turning the original workbook into a template be an option?"}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "reply_to_user": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1507210597, "post_id": 46568505, "comment_id": 80127145, "body": "@GlennG What do you mean exactly by &quot;template?&quot;"}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "reply_to_user": {"reputation": 1250, "user_id": 5382796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iNY1n.jpg?s=128&g=1", "display_name": "GSazheniuk", "link": "https://stackoverflow.com/users/5382796/gsazheniuk"}, "edited": false, "score": 0, "creation_date": 1507211481, "post_id": 46568505, "comment_id": 80127858, "body": "@GSazheniuk I don&#39;t want the workbook to be read-only for me though. I should be able to save it."}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1507314175, "post_id": 46568505, "comment_id": 80175564, "body": "@Robby - I mean saving it as an excel template, either a .xlt or a .xltm file"}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1507314953, "post_id": 46568505, "comment_id": 80175947, "body": "Well, a template would inherently mean that no one could perform a Save, right? I wanted it to be where, based on the user&#39;s username, they would be able to save."}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1507564864, "post_id": 46568505, "comment_id": 80250161, "body": "@Robby - It wouldn&#39;t stop them from saving, but it wouldn&#39;t allow them to overwrite the original without specifically opening the original in edit mode.  It would prompt them to Save As in the same manner that it would with a new blank workbook."}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "edited": false, "score": 0, "creation_date": 1507565377, "post_id": 46568505, "comment_id": 80250452, "body": "I guess I&#39;m not understanding. I saved it as a .xltm file, I made changes to it, and it let me save it."}, {"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1507571929, "post_id": 46568505, "comment_id": 80253687, "body": "@Robby You have to place it in the Templates folder.  For  Office 2010 that location is C:\\ Users\\ [UserName] \\AppData\\ Roaming\\ Microsoft\\ Templates   For Office 2013 that location is: C:\\ Users\\ [UserName] \\ Documents\\ Custom Office Templates   I&#39;m not sure that this is a viable solution for you, it just depends on your application and needs"}], "owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507139126, "creation_date": 1507130458, "last_edit_date": 1507139126, "question_id": 46568505, "link": "https://stackoverflow.com/questions/46568505/prevent-user-from-performing-save-but-not-saveas-on-a-workbook", "title": "Prevent user from performing Save, but not SaveAs, on a workbook", "body": "<p>I have a workbook that I don't want anyone to perform a Save on, but they can perform a SaveAs. The problem I'm running into is that when they do a SaveAs (using a <code>ActiveWorkbook.SaveAs</code> statement rather than File > Save As), it is not using the standard SaveAsUI. So I can't do a <code>If SaveAsUI = False Then</code> method.</p>\n\n<p>Here's what I had it place until I realized it doesn't do what I need.</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\n  If Not SaveAsUI Then\n    If Application.UserName &lt;&gt; \"Robby\" Then\n      MsgBox \"You can't save this workbook!\"\n      Cancel = True\n    End If\n  End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507135435, "post_id": 46568356, "comment_id": 80093821, "body": "You will need to save the zip to a temp folder and extract it from there: pretty sure you cannot do this without saving it first."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507140421, "post_id": 46568356, "comment_id": 80096391, "body": "Those two lines inside your <code>With oApp</code> block should be on one line."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8720958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bac00de2b1d36ca337ff0b33118d79?s=128&d=identicon&r=PG&f=1", "display_name": "Harwood95", "link": "https://stackoverflow.com/users/8720958/harwood95"}, "edited": false, "score": 0, "creation_date": 1507130908, "post_id": 46568490, "comment_id": 80091014, "body": "PeakPeak, I&#39;m getting the error on the line above also, i tried to dim n as integer and then set n = 1 and added an (n) after items like you suggested but this did not work, do you have any other suggestions?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "reply_to_user": {"reputation": 1, "user_id": 8720958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bac00de2b1d36ca337ff0b33118d79?s=128&d=identicon&r=PG&f=1", "display_name": "Harwood95", "link": "https://stackoverflow.com/users/8720958/harwood95"}, "edited": false, "score": 0, "creation_date": 1507138214, "post_id": 46568490, "comment_id": 80095216, "body": "You are the expert regarding your case and you know everything about it. Please do not assume that other people also have the full knowledge of it. Please be more specific and detailed: What do you want to acheive? What is working already? What is not working like it should? What are the error messages?"}, {"owner": {"reputation": 1, "user_id": 8720958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bac00de2b1d36ca337ff0b33118d79?s=128&d=identicon&r=PG&f=1", "display_name": "Harwood95", "link": "https://stackoverflow.com/users/8720958/harwood95"}, "edited": false, "score": 0, "creation_date": 1507139175, "post_id": 46568490, "comment_id": 80095737, "body": "Hi peak peak, I believe if you read the original post you&#39;ll see I have answered all of that"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "reply_to_user": {"reputation": 1, "user_id": 8720958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bac00de2b1d36ca337ff0b33118d79?s=128&d=identicon&r=PG&f=1", "display_name": "Harwood95", "link": "https://stackoverflow.com/users/8720958/harwood95"}, "edited": false, "score": 0, "creation_date": 1507139583, "post_id": 46568490, "comment_id": 80095941, "body": "&quot;Did not work&quot; is not helpful to the people here who are trying to help you."}, {"owner": {"reputation": 1, "user_id": 8720958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bac00de2b1d36ca337ff0b33118d79?s=128&d=identicon&r=PG&f=1", "display_name": "Harwood95", "link": "https://stackoverflow.com/users/8720958/harwood95"}, "edited": false, "score": 0, "creation_date": 1507139668, "post_id": 46568490, "comment_id": 80095985, "body": "Read the original post not my reply to you, I state what already works and what I&#39;ve tried so far, I&#39;ve also stated what I&#39;m trying to achieve. And I&#39;ve included the error message. When I tried what you said I put &quot;dim n as integer&quot; at the top, then I put &quot;set n = 1&quot;, at the end of the code which ends .item I put &quot;(n)&quot; as you suggested, the error code in this instance was on the &quot;set n = 1&quot; line and it said that n needed to be an object."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "is_accepted": false, "score": 0, "last_activity_date": 1507130406, "creation_date": 1507130406, "answer_id": 46568490, "question_id": 46568356, "link": "https://stackoverflow.com/questions/46568356/outlook-vba-unzip-attachment-and-save-to-folder/46568490#46568490", "title": "Outlook VBA unzip attachment and save to folder", "body": "<p>look: \nNameSpace(Atchmt.FileName).Items\nsuggests there are several items. You are trying to collect them all in one item.</p>\n\n<p>Try\nfor n = 1 to (number of attachments)\nNameSpace(Atchmt.FileName).Items(n)\n.. etc ...</p>\n"}], "owner": {"reputation": 1, "user_id": 8720958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bac00de2b1d36ca337ff0b33118d79?s=128&d=identicon&r=PG&f=1", "display_name": "Harwood95", "link": "https://stackoverflow.com/users/8720958/harwood95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1333, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593325963, "creation_date": 1507129983, "last_edit_date": 1593325963, "question_id": 46568356, "link": "https://stackoverflow.com/questions/46568356/outlook-vba-unzip-attachment-and-save-to-folder", "title": "Outlook VBA unzip attachment and save to folder", "body": "<p>I receive system generated e-mails from an ERP system which contain .zip files, inside the zip file is an excel file which contains data I'd like to import into a dashboard i have made.</p>\n\n<p>At the moment i have this code which successfully saves the .zip attachment into the folder when i receive the email:</p>\n\n<pre><code>Sub saveAttachment2(Item As Outlook.MailItem)\nDim selItems            As Selection\nDim objItem             As Object\nDim iCount               As Integer\nDim atmts                 As Attachments\nDim oAttachment As Attachment\nDim sSaveFolder As String\n\nSet selItems = ActiveExplorer.Selection\nsSaveFolder = \"C:\\Users\\212357980\\Documents\\Accounts Coordination\\Oracle    Exports\\\"\nFor Each objItem In selItems\n    Set atmts = objItem.Attachments\n    For Each oAttachment In atmts\n        oAttachment.SaveAsFile sSaveFolder &amp; \"\\Service Requests.zip\"\n    Next\nNext\nEnd Sub\n</code></pre>\n\n<p>Now i would like it to unzip the file before it saves in the location, this is what i have so far:</p>\n\n<pre><code>Sub Unzip2()\n\n    Dim ns As NameSpace             'variables for the main functionality\n    Dim Inbox As MAPIFolder\n    Dim SubFolder As MAPIFolder\n    Dim Atchmt As Attachment\n    Dim FileName As String\n    Dim msg As Outlook.MailItem\n\n    Dim FSO As Object               'variables for unzipping\n    Dim oApp As Object\n    Dim FileNameFolder As Variant\n    Set ns = GetNamespace(\"MAPI\")\n    Set Inbox = ns.GetDefaultFolder(olFolderInbox)\n    Set SubFolder = Inbox.Folders(\"Sales Orders\")\n\n   For Each msg In SubFolder.Items\n            For Each Atchmt In msg.Attachments\n                    If (Right(Atchmt.FileName, 3) = \"zip\") Then\n\n                                    FileNameFolder = \"C:\\Users\\212357980\\Documents\\Accounts Coordination\\Oracle Exports\\\"\n                                    Set oApp = CreateObject(\"Shell.Application\")\n                                    With oApp\n                                        .NameSpace(FileNameFolder).CopyHere\n                                        .NameSpace(Atchmt.FileName).Items\n                                    End With\n\n                                    On Error Resume Next\n                                    Set FSO = CreateObject(\"scripting.filesystemobject\")\n                                FSO.deletefolder Environ(\"Temp\") &amp; \"\\Temporary Directory*\", True\n                    End If\n             Next\n    Next\nEnd Sub\n</code></pre>\n\n<p>I get the error \"Wrong number of arguments or invalid property assignment\" on the two lines after the with. </p>\n\n<p>Any help you can provide would be great!</p>\n"}, {"tags": ["vba", "ms-access", "reserved"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1507130030, "post_id": 46568288, "comment_id": 80090490, "body": "1. What is the error message? 2. Try Key(&quot;Name&quot;)  3. Result?"}, {"owner": {"reputation": 567, "user_id": 5805795, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5e306c676900f1dc3f798f3915879f03?s=128&d=identicon&r=PG&f=1", "display_name": "jcarroll", "link": "https://stackoverflow.com/users/5805795/jcarroll"}, "edited": false, "score": 0, "creation_date": 1507130805, "post_id": 46568288, "comment_id": 80090942, "body": "Try wrapping name in square brackets. Something like Key.[Name] More information <a href=\"https://support.office.com/en-us/article/Access-2007-reserved-words-and-symbols-E33EB3A9-8BAA-4335-9F57-DA237C63EABE\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 31, "user_id": 8720985, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214721039477596/picture?type=large", "display_name": "Mehrez Neji", "link": "https://stackoverflow.com/users/8720985/mehrez-neji"}, "edited": false, "score": 0, "creation_date": 1507141625, "post_id": 46568288, "comment_id": 80097049, "body": "I tried both i got the same error, Execution error 438  object doesn&#39;t support this property or method"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1507208595, "post_id": 46568288, "comment_id": 80125531, "body": "What sort of object is <code>jsonDecode1</code>? What does <code>production_companies()</code> do?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1507208643, "post_id": 46568288, "comment_id": 80125577, "body": "Use the debugger: put a breakpoint in the loop, and use the Watch window to see the attributes of <code>Key</code>. <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">How to debug VBA code</a>"}, {"owner": {"reputation": 31, "user_id": 8720985, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214721039477596/picture?type=large", "display_name": "Mehrez Neji", "link": "https://stackoverflow.com/users/8720985/mehrez-neji"}, "edited": false, "score": 0, "creation_date": 1507215267, "post_id": 46568288, "comment_id": 80130596, "body": "I can see in the debugger all the key attributes they are there and i can use them even the attribute called &quot;name&quot; exists but when i try to accessed using the code it doesn&#39;t work may be because the code editor automatically change the attribute &quot;name&quot; to &quot;Name&quot;, i think that&#39;s the problem, how can i disable the making the first letter to uppercase automatically?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1507219709, "post_id": 46568288, "comment_id": 80133413, "body": "This is starting to look interesting. :) If you can post reproducible sample code (with a working URL, if this isn&#39;t confidential or a paid service), you will greatly increase your chance of finding a solution. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 31, "user_id": 8720985, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214721039477596/picture?type=large", "display_name": "Mehrez Neji", "link": "https://stackoverflow.com/users/8720985/mehrez-neji"}, "edited": false, "score": 0, "creation_date": 1507235151, "post_id": 46568288, "comment_id": 80141465, "body": "try it with this url: <a href=\"https://api.themoviedb.org/3/movie/336203?language=fr-FR&amp;api_key=myapikey\" rel=\"nofollow noreferrer\">api.themoviedb.org/3/movie/&hellip;</a> but you need to replace myapikey with your apikey   in the themoviedb website, if you don&#39;t have one i can send you mine by email or in anothe way if youo want i don&#39;t want to post it :) Thank you"}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1507259287, "post_id": 46568288, "comment_id": 80147849, "body": "Does the code compile, and compile if you have option explicit at the start of each module? The case of VBA vars does not matter."}, {"owner": {"reputation": 31, "user_id": 8720985, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214721039477596/picture?type=large", "display_name": "Mehrez Neji", "link": "https://stackoverflow.com/users/8720985/mehrez-neji"}, "edited": false, "score": 0, "creation_date": 1507294935, "post_id": 46568288, "comment_id": 80164551, "body": "it compiles but without the &quot;option explicit&quot; i don&#39;t use the &quot;option explicit&quot; because i don&#39;t declare all the variables, should I? :)"}], "answers": [{"tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": false, "score": 1, "last_activity_date": 1507162608, "creation_date": 1507162608, "answer_id": 46576060, "question_id": 46568288, "link": "https://stackoverflow.com/questions/46568288/access-vba-reserved-word-name/46576060#46576060", "title": "Access VBA reserved word &quot;name&quot;", "body": "<p>From what I can see, this has ZERO to do with reserved words.</p>\n\n<p>The use of name is a valid property of a GAZILLION built in objects such as forms, reports, column names pulled from a record set etc.</p>\n\n<p>The \u201cconflict\u201d of reserved words is ONLY in regards to SQL or using VBA variables you define (and name is in fact NOT a reserved word anyway). </p>\n\n<p>You are using \u201csomeobject.Name\u201d and thus this has ZERO to do with reserved words since a property or method of an object called \u201cname\u201d NEVER was a source of errors or issues in Access VBA. In fact built in methods can use reserved words.</p>\n\n<p>Ignoring that you left out the data type of this function? (cannot stress how you want to code with option explicit and ALSO cannot stress how you should give a data type to that function).</p>\n\n<p>However I shall make a BIG guess and assume it is a VBA collection object.</p>\n\n<p>Collections in VBA don\u2019t have a name property. So this works:</p>\n\n<pre><code>Dim c        As New Collection\n\nc.Add \"Apple\", \"testkey1\"\nc.Add \"Grape\", \"testkey2\"\n\nDim f        As Variant\n\nFor Each f In c\n  Debug.Print f\nNext\n</code></pre>\n\n<p>However f.name will fail since \u201c.name\u201d is NOT a property or method of a collection. So this issue has nothing to do with reserved words but the simple fact that \u201c.name\u201d never been part of or a valid syntax for a collection object.</p>\n\n<p>And if you really do need each element of the collection to have values, then your function can return a collection of \u201cstructures\u201d but that structure will have to be a class object. So this code shows this in Action:</p>\n\n<p>So the class module can be:</p>\n\n<pre><code>Class module clsStruct:\n\nOption Compare Database\nOption Explicit\n\nPublic Name As String\nPublic KeyName  As String\nPublic Value As String\n</code></pre>\n\n<p>Now in our code:</p>\n\n<pre><code>Dim c        As New Collection\n\nDim MyStruct  As New clsStruct\n\nMyStruct.KeyName = \"hello\"\nMyStruct.Name = \"myname\"\nMyStruct.Value = \"my value\"\n\nc.Add MyStruct\n\nDim f As Variant\n\nFor Each f In c\n  Debug.Print f.Name, f.Value, f.KeyName\nNext\n\nOutput:\nmyname        my value      hello\n</code></pre>\n\n<p>So you are MOST free to use \u201c.name\u201d as a valid property of a object you create, but the collection object by default has no such name property and thus will fail at runtime.</p>\n"}, {"comments": [{"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1507334154, "post_id": 46609664, "comment_id": 80182591, "body": "And this fixes the use of object.name? That is a surprise - thanks for the follow up."}], "tags": [], "owner": {"reputation": 31, "user_id": 8720985, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214721039477596/picture?type=large", "display_name": "Mehrez Neji", "link": "https://stackoverflow.com/users/8720985/mehrez-neji"}, "is_accepted": false, "score": 2, "last_activity_date": 1507305492, "creation_date": 1507305492, "answer_id": 46609664, "question_id": 46568288, "link": "https://stackoverflow.com/questions/46568288/access-vba-reserved-word-name/46609664#46609664", "title": "Access VBA reserved word &quot;name&quot;", "body": "<p>I fixed it :), it is weird but i fixed it.\nwhat you need to do is declare a variable \"name\" with the lower case \"n\" and after that i remove it and now the code editor don't capitalize the word \"name\" anymore. If i declare a variable with the first letter capital it will save it and even if i remove the declaration the next time you use it it will automatically capitalize it and you cannot remove until you declare it again with all lower :) </p>\n\n<p>Thank you all</p>\n"}], "owner": {"reputation": 31, "user_id": 8720985, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214721039477596/picture?type=large", "display_name": "Mehrez Neji", "link": "https://stackoverflow.com/users/8720985/mehrez-neji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1507305492, "creation_date": 1507129789, "last_edit_date": 1507236389, "question_id": 46568288, "link": "https://stackoverflow.com/questions/46568288/access-vba-reserved-word-name", "title": "Access VBA reserved word &quot;name&quot;", "body": "<p>I am using Access VBA to access movie information using the API. It is working fine but I have a problem with attributes that have as name the word \"name\" which is a reserved word.</p>\n\n<p>Let's say I want to access the production companies. I am using this code, and it is working fine if I want to get the id, but it doesn't work if I am trying to get the names because the word \"name\" is a reserved word in line 4.</p>\n\n<p>Does anyone have an idea how to fix it?</p>\n\n<p>The working code: </p>\n\n<pre><code>Set Keys1 = VBA.CallByName(jsonDecode1, \"production_companies\", VbGet)\nmovie_companies = \"\"\nFor Each Key In Keys1\n    movie_companies = movie_companies &amp; **key.id** &amp; \",\"\nNext\n</code></pre>\n\n<p>The not working code: </p>\n\n<pre><code>Set Keys1 = VBA.CallByName(jsonDecode1, \"production_companies\", VbGet)\nmovie_companies = \"\"\nFor Each Key In Keys1\n    movie_companies = movie_companies &amp; **Key.Name** &amp; \",\"\nNext\n</code></pre>\n\n<p>The json file:</p>\n\n<pre><code>production_companies: [ { name: \"France 2 Cin\u00e9ma\", id: 83 }, { name: \"SBS Productions\", id: 8997 }, { name: \"Les Films Fran\u00e7ais\", id: 16782 } ],\n</code></pre>\n\n<p>Thank you for your reply, but i need to give you more details of what i am doing. yes i am using a collection but i didn't create it i am just importing data do the collection from a website using API, also i want to let you know that all the other properties works fine except the \"name\" may be because the editor capitalize the first letter of the word \"Name\" automatically but it doesn't capitalize the other words, how can i avoid the editor to capitalize the word \"name\" maybe that's the issue. Thank you again</p>\n\n<p>That's the whole code:</p>\n\n<pre><code>Set sc = CreateObject(\"ScriptControl\"): sc.language = \"JScript\"  \nSet oXMLHTTP1 = CreateObject(\"MSXML2.XMLHTTP\")\noXMLHTTP1.Open \"GET\",  URL, False   'Open socket to get the website\noXMLHTTP1.setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded; charset=UTF-8\"\noXMLHTTP1.send 'send request\nDo While oXMLHTTP1.ReadyState &lt;&gt; 4\n    DoEvents\nLoop\noResp = oXMLHTTP1.responseText 'Returns the results as a byte array\nSet jsonDecode1 = sc.Eval(\"(\" + oResp + \")\")\nSet Keys1 = VBA.CallByName(jsonDecode1, \"production_countries\", VbGet)\nFor Each Key In Keys1\n       movie_companies = movie_companies &amp; Key.id &amp; \",\"\n       movie_companies = movie_companies &amp; Key.Name &amp; \",\"\nNext\n</code></pre>\n\n<p>Now i am sure that the problem is the fact that the first letter is uppercase, because i have another property named \"key\"  and because the editor change it to \"Key\" with uppercase K, it is not working too :) is there a way to disabled changing the first letter to uppercase in the code editor? this will definitely fix the problem</p>\n"}, {"tags": ["vba", "excel", "loops"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 5, "last_activity_date": 1507129822, "creation_date": 1507129822, "answer_id": 46568302, "question_id": 46568171, "link": "https://stackoverflow.com/questions/46568171/miss-something-in-simple-loops/46568302#46568302", "title": "Miss something in simple loops", "body": "<p>It's <code>Cells</code> not <code>Cell</code>. In any case, your code won't work because it will overwrite (j restarts at 1 every time). Try this instead (adjust sheet references to suit).</p>\n\n<pre><code>Sub REPLICATE()\n\nDim i As Long\n\nFor i = 1 To Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n    Sheets(\"Sheet2\").Cells(Rows.Count, 1).End(xlUp)(2).Resize(4).Value = Sheet1.Cells(i, 1).Value\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507133083, "post_id": 46569330, "comment_id": 80092476, "body": "Most educative, as ever."}, {"owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "edited": false, "score": 0, "creation_date": 1507142112, "post_id": 46569330, "comment_id": 80097336, "body": "Thank you for the quality of the explanation and your time, this is so usefull."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1507132886, "creation_date": 1507132886, "answer_id": 46569330, "question_id": 46568171, "link": "https://stackoverflow.com/questions/46568171/miss-something-in-simple-loops/46569330#46569330", "title": "Miss something in simple loops", "body": "<p>The <code>Sheets</code> collection returns an <code>Object</code>, which means anything you type after accessing it will not give you <em>IntelliSense</em> or auto-complete assistance, and VBA will happily compile it, because any call made against the <code>Object</code> interface is late-bound and therefore only resolved at run-time.</p>\n\n<p>The solution is to stick to early-bound code and declare a <code>Worksheet</code> object. Also, use the <code>Worksheets</code> collection if you mean to pull a <code>Worksheet</code>, since the <code>Sheets</code> collection can give you <code>Chart</code> objects (i.e. not all sheets are <em>worksheets</em>).</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = Workbooks(\"Libro1\").Worksheets(\"Hoja1\")\n</code></pre>\n\n<p>And now when you type <code>ws.</code> you'll see that <code>Cell</code> is indeed not a member of the <code>Worksheet</code> type (hence \"Object doesn't support property or method\"):</p>\n\n<pre><code>For i = 1 To ws.Cells(...)\n</code></pre>\n\n<p>That said if <code>Workbooks(\"Libro1\")</code> is <code>ThisWorkbook</code> (the book that contains the VBA code), then you should be using the <em>existing</em> worksheet object instead.</p>\n\n<p>You get a \"free\", global-scope <code>Worksheet</code> object variable for each <code>Worksheet</code> document module in your VBA project - just use it!</p>\n\n<pre><code>For i = 1 To Sheet1.Cells(...)\n</code></pre>\n\n<p>Like <a href=\"https://stackoverflow.com/a/46568302/1188513\">SJR's answer</a> does.</p>\n\n<p>You can rename that global-scope object variable by finding the sheet in the Project Explorer (Ctrl+R), and then changing its <code>(Name)</code> property in the <em>properties</em> toolwindow (F4). Note, changing the name like this will <strong>not</strong> automatically update your existing code that uses <code>Sheet1</code>. If you want to rename and <em>propagate</em> the change, you need to <em>refactor</em> your code. <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> (an open-source VBIDE add-in project I manage) can do that for you:</p>\n\n<p>Right-click the worksheet in Rubberduck's <em>Code Explorer</em>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/PDjeX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PDjeX.png\" alt=\"before refactoring\"></a></p>\n\n<p>Supply a new name:</p>\n\n<p><a href=\"https://i.stack.imgur.com/1FrHZ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1FrHZ.png\" alt=\"supplying the new name\"></a></p>\n\n<p>Every reference to the old name across the entire code is now updated:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bfOTk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bfOTk.png\" alt=\"after refactoring\"></a></p>\n\n<p>You can also try performing that refactoring with Ctrl+H \"Find/Replace\", but that can be tedious, and risks introducing more issues. Rubberduck builds a symbol table for this, so it's much more robust than a simple find &amp; replace.</p>\n"}], "owner": {"reputation": 57, "user_id": 8581758, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/b78e6124bef1134fb518c973f0f54d55?s=128&d=identicon&r=PG&f=1", "display_name": "IlvarNourtan", "link": "https://stackoverflow.com/users/8581758/ilvarnourtan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 46568302, "answer_count": 2, "score": 2, "last_activity_date": 1507132886, "creation_date": 1507129451, "last_edit_date": 1531164843, "question_id": 46568171, "link": "https://stackoverflow.com/questions/46568171/miss-something-in-simple-loops", "title": "Miss something in simple loops", "body": "<p>I have a range of cell in one sheet I wish copy n times in another sheet:\nfor n=4 one would have: </p>\n\n<pre><code>Input (Sheet1)              Output (Sheet2)\n ABC                           ABC\n DEF                           ABC\n GHI                           ABC\n                               ABC\n                               DEF\n                               DEF\n                               DEF\n                               DEF\n                               GHI\n                               GHI\n                               GHI\n                               GHI\n</code></pre>\n\n<p>What I did is simply: </p>\n\n<pre><code>Sub REPLICATE()\n  Dim i As Integer\n  Dim j As Integer\n  Dim TEMP As String\n\n  For i = 1 To 400\n    TEMP = Workbooks(\"Libro1\").Sheets(\"Hoja1\").Cell(i, 1).Value\n      For j = 1 To 4\n        Workbooks(\"Libro1\").Sheets(\"Hoja2\").Cell(j, 1) = TEMP\n      Next j\n  Next i\nEnd Sub\n</code></pre>\n\n<p>And I got the error 438. I thought the problem could have been that I use string, but I tried with simple Integer in my Sheet1, and I've gotten the same problem. Thanks for advices. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1507129456, "post_id": 46568036, "comment_id": 80090092, "body": "Code that &quot;blows up when I run it but works fine when I step through&quot; typically involves implicit <code>ActiveSheet</code> or <code>ActiveWorkbook</code> references. How many does <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> find in that code?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1507129565, "post_id": 46568036, "comment_id": 80090155, "body": "<code>Range(&quot;N2&quot;)</code> in <code>Worksheets(&quot;WS1&quot;).Range(&quot;A2&quot;, &quot;A&quot; &amp; Range(&quot;N2&quot;).End(xlDown).Row)</code> would be one. <code>Worksheets</code> unqualified with a <code>Workbook</code> object would be another."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1507129898, "post_id": 46568036, "comment_id": 80090367, "body": "Add <code>On Error Resume Next</code> just before the <code>Application.Match</code> calls (add <code>On Error GoTo 0</code> just after them too!), and do <code>Debug.Assert Err.Number = 0</code> to break on error, then do <code>Debug.Print WS1_L1Rng.Parent.Name, WS1_SearchRng.Parent.Name</code> - does it output what you expect?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8720738"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507130674, "post_id": 46568036, "comment_id": 80090867, "body": "I&#39;ve worked through all my <code>Worksheet</code> and <code>Range</code> references and made sure they&#39;re qualified properly. So far, so good. I still wonder why it was inconsistent, though. Did it sometimes just happen to be referring to the correct objects based on how things were left when the previous execution stopped?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1507131191, "post_id": 46568036, "comment_id": 80091190, "body": "Implicit <code>ActiveWorkbook</code> and <code>ActiveSheet</code> references make your code depend on what book/sheet happens to be active when the code runs. Source of many, many, many bugs. Hence why we made it a Rubberduck inspection ;-)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8720738"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507131404, "post_id": 46568036, "comment_id": 80091333, "body": "Awesome; thank you for the quick and helpful solution!"}], "answers": [{"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1507131709, "creation_date": 1507131709, "answer_id": 46568944, "question_id": 46568036, "link": "https://stackoverflow.com/questions/46568036/why-does-application-match-behave-inconsistently-when-run-multiple-times-on-the/46568944#46568944", "title": "Why does Application.Match behave inconsistently when run multiple times on the same data?", "body": "<p>Watch for implicit references to the active workbook/worksheet; what workbook/worksheet these instructions are referring to at run-time will depend on whatever workbook/worksheet is active at that time, and this is often responsible for such errors.</p>\n\n<p>You can use <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a> (an open-source VBIDE add-in project I manage) to easily locate them for you (and other potential code issues).</p>\n\n<p><code>Range(\"N2\")</code> in <code>Worksheets(\"WS1\").Range(\"A2\", \"A\" &amp; Range(\"N2\").End(xlDown).Row)</code> would be one. <code>Worksheets</code> used unqualified with a <code>Workbook</code> object would be another.</p>\n\n<p><a href=\"https://i.stack.imgur.com/cn3ow.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cn3ow.png\" alt=\"Rubberduck code inspections toolwindow\"></a></p>\n\n<p>The solution is to explicitly qualify them with a <code>Workbook</code> or <code>Worksheet</code> object reference.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8720738"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 46568944, "answer_count": 1, "score": 1, "last_activity_date": 1507131709, "creation_date": 1507129018, "last_edit_date": 1531164843, "question_id": 46568036, "link": "https://stackoverflow.com/questions/46568036/why-does-application-match-behave-inconsistently-when-run-multiple-times-on-the", "title": "Why does Application.Match behave inconsistently when run multiple times on the same data?", "body": "<p><strong>The background:</strong></p>\n\n<p>I have a workbook, <code>Outline.xlsm</code>, with a five-level hierarchy. In the first worksheet (<code>WS1</code>), the first three levels are described the first two columns, while the next two levels each have their own set of two columns:\n<a href=\"https://i.stack.imgur.com/yP4u3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yP4u3.jpg\" alt=\"Outline sample\"></a></p>\n\n<p>In the second worksheet (<code>WS2</code>), there is no level 3, but everything else is the same. All cells are formatted as text.</p>\n\n<p>I have some code that splits out each first-level section (\"General thing\") into its own workbook to allow users to make changes to the descriptions (and some other fields off to the right). The code in question then goes out and gets those new descriptions from each file and matches them to the ID number. Here is a sanitized version: </p>\n\n<pre><code>Option Explicit\n\nSub GatherData()\n\n    'Set up for speed\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.Calculation = xlCalculationManual\n\n    'Get files to be processed\n    Dim DataFolder As String\n    Dim DataFile As String\n    DataFolder = \"\\\\SomeNetworkLocation\"\n    DataFile = Dir(DataFolder &amp; \"\\GeneralThing*.xlsx\")\n\n    'Define ranges to search\n    Dim WS1_L1Rng As Range\n    Dim L2rng As Range\n    Dim L3rng As Range\n    Set WS1_L1Rng = Worksheets(\"WS1\").Range(\"A2\", \"A\" &amp; Range(\"N2\").End(xlDown).Row)\n    Set L2rng = Worksheets(\"WS1\").Range(\"C2\", \"C\" &amp; Range(\"N2\").End(xlDown).Row)\n    Set L3rng = Worksheets(\"WS1\").Range(\"E2\", \"E\" &amp; Range(\"N2\").End(xlDown).Row)\n\n    Dim WS2_L1Rng As Range\n    Dim WS2_L2Rng As Range\n    Set WS2_L1Rng = Worksheets(\"WS2\").Range(\"A2\", \"A\" &amp; Range(\"K2\").End(xlDown).Row)\n    Set WS2_L2Rng = Worksheets(\"WS2\").Range(\"C2\", \"C\" &amp; Range(\"K2\").End(xlDown).Row)\n\n    Dim MatchPos As Variant\n    Dim WS1_SearchRng As Range\n    Dim WS2_SearchRng As Range\n    Dim Cell As Range\n\n    'Find and copy data\n    Do While DataFile &lt;&gt; \"\"\n        Workbooks.Open Filename:=DataFolder &amp; \"\\\" &amp; DataFile\n        With Workbooks(DataFile).Worksheets(\"WS1\")\n            Set WS1_SearchRng = .Range(\"A2:\" &amp; \"A\" &amp; .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row &amp; \",C2:\" &amp; \"C\" &amp; .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row &amp; \",E2:\" &amp; \"E\" &amp; .Range(\"E\" &amp; .Rows.Count).End(xlUp).Row)\n        End With\n        For Each Cell In WS1_SearchRng\n            If IsNumeric(Left(Cell.Value2, 2)) Then\n                Select Case Cell.Rows.OutlineLevel\n                    Case Is &lt; 4\n                        MatchPos = Application.Match(Cell.Value2, WS1_L1Rng, 0)\n                    Case 4\n                        MatchPos = Application.Match(Cell.Value2, L2rng, 0)\n                    Case 5\n                        MatchPos = Application.Match(Cell.Value2, L3rng, 0)\n                End Select\n                If IsError(MatchPos) Then\n                    Debug.Print \"WS1 \" &amp; Cell.Value2\n                Else\n                    MatchPos = MatchPos + 1\n                    Workbooks(DataFile).Worksheets(\"WS1\").Range(\"A\" &amp; Cell.Row, \"L\" &amp; Cell.Row).Copy Destination:=Workbooks(\"Outline.xlsm\").Worksheets(\"WS1\").Range(\"A\" &amp; MatchPos, \"L\" &amp; MatchPos)\n                End If\n            End If\n            DoEvents\n        Next Cell\n        If Workbooks(DataFile).Worksheets.Count &gt; 1 Then\n        With Workbooks(DataFile).Worksheets(\"WS2\")\n            Set WS2_SearchRng = .Range(\"A2:\" &amp; \"A\" &amp; .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row &amp; \",C2:\" &amp; \"C\" &amp; .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row)\n        End With\n        For Each Cell In WS2_SearchRng\n            If IsNumeric(Left(Cell.Value2, 2)) Then\n                Select Case Cell.Rows.OutlineLevel\n                    Case Is &lt; 4\n                        MatchPos = Application.Match(Cell.Value2, WS2_L1Rng, 0)\n                    Case 4\n                        MatchPos = Application.Match(Cell.Value2, WS2_L2Rng, 0)\n                End Select\n                If IsError(MatchPos) Then\n                    Debug.Print \"WS2 \" &amp; Cell.Value2\n                Else\n                    MatchPos = MatchPos + 1\n                    Workbooks(DataFile).Worksheets(\"WS2\").Range(\"A\" &amp; Cell.Row, \"I\" &amp; Cell.Row).Copy Destination:=Workbooks(\"Outline.xlsm\").Worksheets(\"WS2\").Range(\"A\" &amp; MatchPos, \"I\" &amp; MatchPos)\n                End If\n            End If\n            DoEvents\n        Next Cell\n        End If\n        With Workbooks(DataFile)\n            .Save\n            .Close\n        End With\n        DataFile = Dir\n    Loop\n\n\n    'Return to regular configuration\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n\n<p><strong>The problem:</strong></p>\n\n<p>Often, when I go to run this code, <code>Application.Match</code> throws an error when it tries to match to anything in <code>WS2</code>. It usually works fine if I just kill the execution and start over on the same data (sometimes it takes a few tries). Very rarely, it can't find anything in <code>WS1</code> either; again, if I simply restart the execution it usually works just fine. Sometimes everything works great on the first try. Why does it not behave consistently?</p>\n"}, {"tags": [".net", "vba", "visual-studio", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1507130308, "post_id": 46568004, "comment_id": 80090660, "body": "<code>Environment.Exit(0)</code> is the very last thing you want to do here: that&#39;s a big huge red NUKE IT button akin to the <code>End</code> keyword in VBA - don&#39;t use that. Let your application exit through its <code>Main</code> procedure (i.e. let your &quot;main form&quot; close and return to its caller). Then <code>Marshal.ReleaseComObject</code> for every single COM object you&#39;re using - including the <code>Excel.Application</code>, any <code>Worksheet</code> object and <code>Worksheets</code> collection, <code>Range</code> - everything."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1507130417, "post_id": 46568004, "comment_id": 80090723, "body": "You&#39;ll have to stop using Environment.Exit().  On such a very large spreadsheet, there is a technical risk that you&#39;ve created so many RCWs that a normal shutdown takes more than 2 seconds.  Which causes a finalizer thread abort and Excel will keep running.  That delay is noticeable, make sure you do not try to hide it.  If that is the case then you have to help by calling GC.Collect + GC.WaitForPendingFinalizers.  That takes as long as necessary, so probably more than 2 seconds, avoiding the finalizer thread abort."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1507133326, "post_id": 46568004, "comment_id": 80092644, "body": "@HansPassant is it a coincidence that calling <code>Marshal.ReleaseComObject</code> on every single accessed COM object seems to work for me?"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1507133430, "post_id": 46568004, "comment_id": 80092710, "body": "Yes, usually it does not work because you don&#39;t get every RCW.  And if you miss one then you can&#39;t find out which one it might be.  COM programming is supposed to be painful, but neither VB.NET nor C# make it painful enough.  Not a problem, the GC never gets it wrong."}, {"owner": {"reputation": 388, "user_id": 7672005, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-R-OYfkK3E2M/AAAAAAAAAAI/AAAAAAAAABA/6paHCK6AaaY/photo.jpg?sz=128", "display_name": "Zyzyx", "link": "https://stackoverflow.com/users/7672005/zyzyx"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507548730, "post_id": 46568004, "comment_id": 80239769, "body": "@Mat&#39;sMug Thank you for the suggestion. I&#39;ve removed any Environment.Exits but am now trying to figure out what the main forms caller is. I don&#39;t specifically call for the MainWindow, it just appears after the Application_Startup is done. I was thinking of putting the Marshal.ReleaseComObject in the Application_Exit handler but it does not ever fire. Currently the application just sits running (but essentially doing nothing) after MainWindow closes. Any ideas?"}], "owner": {"reputation": 388, "user_id": 7672005, "user_type": "registered", "accept_rate": 85, "profile_image": "https://lh5.googleusercontent.com/-R-OYfkK3E2M/AAAAAAAAAAI/AAAAAAAAABA/6paHCK6AaaY/photo.jpg?sz=128", "display_name": "Zyzyx", "link": "https://stackoverflow.com/users/7672005/zyzyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 130, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1507136088, "creation_date": 1507128928, "last_edit_date": 1531164843, "question_id": 46568004, "link": "https://stackoverflow.com/questions/46568004/application-startup-and-application-exit-vba", "title": "Application_startup and application_exit VBA", "body": "<p>I'm having a problem with closing an excel process I start up using the Application_Startup handler.</p>\n\n<p>First I'll describe my program roughly:\nApplication.xaml.vb Application_startup reads an options file (and allows for changes if needed), then proceeds to load a gigantic excel file while the user is hit with a loading screen.</p>\n\n<pre><code>' Start Excel and get Application object.\nXLapp = CreateObject(\"Excel.Application\")\nXLapp.Visible = False\nXLwb = XLapp.Workbooks.Open(HistoryPath, [ReadOnly]:=True)\n</code></pre>\n\n<p>When this is all done the MainWindow.xaml.vb shows up, where I use <code>My.Application.XLwb</code> to access the data. When I close MainWindow, a handler uses </p>\n\n<pre><code>Environment.Exit(0)\n</code></pre>\n\n<p>I had hoped this would fire the following sub in Application.xaml.vb:</p>\n\n<pre><code>Public Sub Application_Exit(sender As Object, e As ExitEventArgs) Handles Me.Exit\n    Debug.Print(\"close\")\n    XLwb.Close(SaveChanges:=False)\n    XLapp.Application.Quit()\n    Environment.Exit(0)\nEnd Sub\n</code></pre>\n\n<p>However this does not work.\nI've also tried the following:</p>\n\n<pre><code>Private Sub MainWindow_Closed(sender As Object, e As EventArgs) Handles Me.Closed\n    Try\n        My.Application.XLapp.Application.Quit()\n    Catch ex As Exception\n    End Try\n    Environment.Exit(0)\nEnd Sub\n</code></pre>\n\n<p>But the EXCEL.EXE process stays.</p>\n\n<p>Any ideas on how to do this?</p>\n\n<p>PS. For now I'm using <a href=\"https://stackoverflow.com/questions/26303173/how-can-i-kill-task-manager-processes-through-vba-code\">How can I kill task manager processes through VBA code?</a> to remove the processes, but this removes them indiscriminately (i.e. some excel sheet someone was working on on the side will also get shut down)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1507129349, "post_id": 46567762, "comment_id": 80090028, "body": "Just as a tip, use <code>Application.InputBox</code> instead of <code>InputBox</code>. You can then force the user to enter a number instead of using <code>On Error</code>. i.e. <b><code>Application.InputBox(&quot;How many rows do you wish to add?&quot;, Type:=1)</code></b>. This will only accept a number"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1507136148, "creation_date": 1507136148, "answer_id": 46570253, "question_id": 46567762, "link": "https://stackoverflow.com/questions/46567762/copy-function-not-pasting-when-data-set-is-filtered/46570253#46570253", "title": "Copy Function Not Pasting When Data Set is Filtered", "body": "<pre><code>Sub Transfer()\n\n    Dim sht As Worksheet\n    Dim lastrow As Long, lngRows\n\n    Application.ScreenUpdating = False\n\n    Set sht = Sheets(\"ForecastedMovement\")\n\n    lastrow = sht.Cells(sht.Rows.Count, 1).End(xlUp).Row + 1\n    'account for filtered rows at end of dataset\n    Do While Application.CountA(sht.Rows(lastrow)) &gt; 0\n        lastrow = lastrow + 1\n    Loop\n\n    On Error GoTo Finish\n    lngRows = CLng(InputBox(\"How many rows do you wish to add?\"))\n\n    ActiveCell.EntireRow.Range(\"A1:BX1\").Copy\n\n    sht.Cells(lastrow, 1).Resize(lngRows).PasteSpecial Paste:=xlPasteValues\n\nFinish:\n    If Err.Number &lt;&gt; 0 Then MsgBox Prompt:=\"Please ensure you only enter numeric values!\"\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7793096, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/51e5f1c3c8eda8e59ceea7c5a15dfc8c?s=128&d=identicon&r=PG&f=1", "display_name": "NeilD137", "link": "https://stackoverflow.com/users/7793096/neild137"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 46570253, "answer_count": 1, "score": 0, "last_activity_date": 1507136148, "creation_date": 1507128207, "question_id": 46567762, "link": "https://stackoverflow.com/questions/46567762/copy-function-not-pasting-when-data-set-is-filtered", "title": "Copy Function Not Pasting When Data Set is Filtered", "body": "<p>I have the following code which is used to copy the active line and paste it a number of times at the first blank, or available line, at the end of the data. The code prompts the user to specify the number of times to paste the copied row at the end of the data. \nHowever, it is not working properly when the data set it is being used on is filtered on a certain field. Instead it is pasting over existing data that is within the filtered data. For example, if the row 699 is not visible because of the filter choice being applied and the data ends at row 700, so 701 would be the first blank row, it is pasting over row 699. However, it does work when the user saves in between. \nAny thoughts on how to fix this issue?</p>\n\n<pre><code>Sub Transfer()\n\nApplication.ScreenUpdating = False\n\nDim lastrow As Long\nlastrow = Sheets(\"ForecastedMovement\").Range(\"A65536\").End(xlUp).Row    '   or + 1\n\nOn Error GoTo Finish\nlngRows = CLng(InputBox(\"How many rows do you wish to add?\"))\nlngNextRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\nRange(\"A\" &amp; ActiveCell.Row &amp; \":BX\" &amp; ActiveCell.Row).Copy\nRange(\"A\" &amp; lastrow + 1 &amp; \":BX\" &amp; lastrow + lngRows).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n\nFinish:\nIf Err.Number &lt;&gt; 0 Then MsgBox Prompt:=\"Please ensure you only enter numeric values!\"\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "filter"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507128634, "post_id": 46567690, "comment_id": 80089512, "body": "Quite possibly not the cause of your problem, but <code>Dim a1, a2, a3, a4, a5, a6 As String</code> declares only a6 as String. You need to repeat that for each of them."}, {"owner": {"reputation": 31, "user_id": 8103280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a1dff8c8fa9cef7fb9c4bc9fd2c7811?s=128&d=identicon&r=PG&f=1", "display_name": "HammerUser", "link": "https://stackoverflow.com/users/8103280/hammeruser"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507129590, "post_id": 46567690, "comment_id": 80090175, "body": "you can declare variables many with one &quot;dim&quot;. the problem is with input as a number. When I put in input numbers &#39;123456 it works, but it&#39;s far from perfect."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507148299, "post_id": 46567690, "comment_id": 80100573, "body": "<code>a5 = .Cells(2, 8).Value</code> <code>a5 = .Cells(2, 9).Value</code>, shouldn&#39;t be  <code>a6 = .Cells(2, 9).Value</code>? And did you try <code>a6 = CStr(.Cells(2, 9))</code>"}, {"owner": {"reputation": 31, "user_id": 8103280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a1dff8c8fa9cef7fb9c4bc9fd2c7811?s=128&d=identicon&r=PG&f=1", "display_name": "HammerUser", "link": "https://stackoverflow.com/users/8103280/hammeruser"}, "edited": false, "score": 0, "creation_date": 1507553139, "post_id": 46567690, "comment_id": 80242543, "body": "Thank you! CStr worked:) I didn&#39;t know this function."}], "owner": {"reputation": 31, "user_id": 8103280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a1dff8c8fa9cef7fb9c4bc9fd2c7811?s=128&d=identicon&r=PG&f=1", "display_name": "HammerUser", "link": "https://stackoverflow.com/users/8103280/hammeruser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507127970, "creation_date": 1507127970, "question_id": 46567690, "link": "https://stackoverflow.com/questions/46567690/vba-filtering-based-on-cells-array-input-cells-numbers", "title": "vba Filtering, based on cells array, input cells numbers", "body": "<p>This part prepares, a list for printing, earlier in a code I clear all filters.\nIn column 5 I have strings of numbers &amp; numbers and letters.\n<strong>In input cells I have only numbers.</strong> that seems to be the issue</p>\n\n<p>When I put in input cells numbers and letters it works just fine.</p>\n\n<p>My values are numbers, so I tried to change them from string to long.\nI try formatting them as text. </p>\n\n<p>I tried When I manually paste those values it's ok.<br>\nI can see that VBA gets proper values from cells, it put it in an array then nothing.</p>\n\n<pre><code> Dim lr1, r, f As Long\n Dim rngFilter As Range\n Dim i, x\n Dim a1, a2, a3, a4, a5, a6 As String\n\n    With Worksheets(\"a\")\n\n        Set rngFilter = .ListObjects(\"Tabela2\").Range\n\n\n    a1 = .Cells(2, 4).Value\n    a2 = .Cells(2, 5).Value\n    a3 = .Cells(2, 6).Value\n    a4 = .Cells(2, 7).Value\n    a5 = .Cells(2, 8).Value\n    a5 = .Cells(2, 9).Value\n        If Cells(1, 10).Value = 1 Then\n         rngFilter.AutoFilter Field:=5, Criteria1:=Array(a1), Operator:=xlFilterValues\n        End If\n        If Cells(1, 10).Value = 2 Then\n         rngFilter.AutoFilter Field:=5, Criteria1:=Array(a1, a2), Operator:=xlFilterValues\n        End If\n        If Cells(1, 10).Value = 3 Then\n         rngFilter.AutoFilter Field:=5, Criteria1:=Array(a1, a2, a3), Operator:=xlFilterValues\n        End If\n        If Cells(1, 10).Value = 4 Then\n         rngFilter.AutoFilter Field:=5, Criteria1:=Array(a1, a2, a3, a4), Operator:=xlFilterValues\n        End If\n        If Cells(1, 10).Value = 5 Then\n         rngFilter.AutoFilter Field:=5, Criteria1:=Array(a1, a2, a3, a4, a5), Operator:=xlFilterValues\n        End If\n        If Cells(1, 10).Value = 6 Then\n         rngFilter.AutoFilter Field:=5, Criteria1:=Array(a1, a2, a3, a4, a5, a6), Operator:=xlFilterValues\n        End If\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "module", "export-to-excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1507127731, "post_id": 46567536, "comment_id": 80088861, "body": "Please be more specific and detailed: What do you want to acheive? What is NOT working? Error messages?"}, {"owner": {"reputation": 17, "user_id": 8055679, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a72768c9d181f7f15a3306d399fbff7c?s=128&d=identicon&r=PG&f=1", "display_name": "James T", "link": "https://stackoverflow.com/users/8055679/james-t"}, "edited": false, "score": 0, "creation_date": 1507127894, "post_id": 46567536, "comment_id": 80088998, "body": "Apologies that my question was not that specific. I have just updated to double-check that &#39;xlWS.Cells&#39; points to cell K17 @peakpeak"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1507128256, "post_id": 46567536, "comment_id": 80089251, "body": "What is the question?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1507128593, "post_id": 46567536, "comment_id": 80089486, "body": "You are the expert regarding your case and you know everything about it. Please do not assume that other people also have the full knowledge of it. Please be more specific and detailed: What do you want to acheive? What is working already? What is not working like it should? What are the error messages?"}, {"owner": {"reputation": 17, "user_id": 8055679, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a72768c9d181f7f15a3306d399fbff7c?s=128&d=identicon&r=PG&f=1", "display_name": "James T", "link": "https://stackoverflow.com/users/8055679/james-t"}, "edited": false, "score": 0, "creation_date": 1507128605, "post_id": 46567536, "comment_id": 80089495, "body": "@peakpeak &#39;xlWS.Cells&#39; and &#39;xlRow+1&#39; is not pointing out to cell K17. How can I fix this? I set c to store colum nnumbers. Thank you for being patient with me!"}, {"owner": {"reputation": 17, "user_id": 8055679, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a72768c9d181f7f15a3306d399fbff7c?s=128&d=identicon&r=PG&f=1", "display_name": "James T", "link": "https://stackoverflow.com/users/8055679/james-t"}, "edited": false, "score": 0, "creation_date": 1507128737, "post_id": 46567536, "comment_id": 80089582, "body": "@peakpeak Nothing is working except that the excel file tells me the right last modified time. The query should be exported to the Excel, the exact cell that I pinpoint to. There is no error message regarding syntax of the code. Thank you!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1507128918, "post_id": 46567536, "comment_id": 80089702, "body": "I suggest you review your code, single-step it and use an abundance of breakpoints and prints in the Immediate Window. There&#39;s no shortcut here. If someone suggests a solution, you&#39;d still be lost next time your code fails. You MUST learn to code and DEBUG. No shortcut unless you hire someone of course ...."}, {"owner": {"reputation": 17, "user_id": 8055679, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a72768c9d181f7f15a3306d399fbff7c?s=128&d=identicon&r=PG&f=1", "display_name": "James T", "link": "https://stackoverflow.com/users/8055679/james-t"}, "edited": false, "score": 0, "creation_date": 1507129021, "post_id": 46567536, "comment_id": 80089783, "body": "@peakpeak gotcha thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 25, "user_id": 4942330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7268b4363552c2dd1e3d6ff30391db44?s=128&d=identicon&r=PG&f=1", "display_name": "mak&#233;man", "link": "https://stackoverflow.com/users/4942330/mak%c3%a9man"}, "is_accepted": false, "score": 0, "last_activity_date": 1507326310, "creation_date": 1507326310, "answer_id": 46614347, "question_id": 46567536, "link": "https://stackoverflow.com/questions/46567536/excel-file-updated-but-no-change-export-query-to-excel-without-header/46614347#46614347", "title": "Excel file updated but no change: Export query to excel without header", "body": "<p>Is there a reason why you are using a Do Until loop? If the recordset only has 1 row of data (the total) it looks like you could remove the loop and just use something like:</p>\n\n<pre><code>xlWS.Range(\"K17\").Value = rst.Fields(0)\n</code></pre>\n\n<p>This would appear after the \"Set rst..\" line.</p>\n"}], "owner": {"reputation": 17, "user_id": 8055679, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/a72768c9d181f7f15a3306d399fbff7c?s=128&d=identicon&r=PG&f=1", "display_name": "James T", "link": "https://stackoverflow.com/users/8055679/james-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507326310, "creation_date": 1507127540, "last_edit_date": 1507128776, "question_id": 46567536, "link": "https://stackoverflow.com/questions/46567536/excel-file-updated-but-no-change-export-query-to-excel-without-header", "title": "Excel file updated but no change: Export query to excel without header", "body": "<p>My VBA code is supposed to transfer my <strong>query</strong> in MS Access (without header)<a href=\"https://i.stack.imgur.com/wc2ho.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wc2ho.jpg\" alt=\"enter image description here\"></a>\nto <strong>cell K17</strong> on an existing excel spreadsheet named <strong>Totals</strong>. </p>\n\n<p>When I run the module, under the property of the excel file, last modified time did get updated to when I run the module. But I don't see my query on the excel spreadsheet. </p>\n\n<p>Any advice on my code will be highly appreciated. Thank you so much! </p>\n\n<pre><code>Sub TransToXL()\n\n    Dim xlApp As Excel.Application\n    Dim xlWB As Excel.Workbook\n    Dim xlWS As Excel.Worksheet\n    Dim acRng As Variant\n    Dim xlRow As Integer\n\n    Dim qry As QueryDef\n    Dim rst As Recordset\n    Set xlApp = New Excel.Application\n    Set xlWB = xlApp.Workbooks.Open(\"C:\\Users\\MyName\\Desktop\\August 2017.xlsx\")\n    Set xlWS = xlWB.Worksheets(\"Totals\")\n\n    xlRow = (xlWS.Columns(\"K\").End(xlDown).Row)\n\n    Set qry = CurrentDb.QueryDefs(\"DollarsSold\")\n    Set rst = qry.OpenRecordset\n\n    Dim c As Integer\n    c = 11\n    xlRow = xlRow + 16\n\n    Do Until rst.EOF\n        For Each acRng In rst.Fields\n            xlWS.Cells(xlRow, c).Formula = acRng\n            c = c + 1\n        Next acRng\n        xlRow = xlRow + 1\n        c = 1\n        rst.MoveNext\n        If xlRow &gt; 25 Then GoTo rq_Exit\n    Loop\n\nrq_Exit:\n    rst.Close\n    Set rst = Nothing\n    Set xlWS = Nothing\n    xlWB.Close acSaveYes\n    Set xlWB = Nothing\n    xlApp.Quit\n    Set xlApp = Nothing\n    Exit Sub\n\nEnd Sub\n</code></pre>\n\n<p>The variable c is the one that stores colum number, in which c =1 means column A, 11 will be K. In this code, I'm confused about the way I set <code>xlRow+16</code>. <code>xlRow+16</code> , and c = 11 is not pointing out to K17. Any advise on this? Thank you! </p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1507127532, "post_id": 46567400, "comment_id": 80088703, "body": "Can you provide a sample of your sheet?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1507127579, "post_id": 46567400, "comment_id": 80088741, "body": "What is not working? Error messages?"}, {"owner": {"reputation": 11, "user_id": 8627445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e330c2607e7aeebd3109896fcb25b0?s=128&d=identicon&r=PG&f=1", "display_name": "johnnywin", "link": "https://stackoverflow.com/users/8627445/johnnywin"}, "edited": false, "score": 0, "creation_date": 1507130049, "post_id": 46567400, "comment_id": 80090505, "body": "Where I get confused on how to write the logic is where I&#39;ve written &#39;this is where it gets confusing&#39;. The code comments denote the logic about how to achieve the task but my noodle is unable to guide my fingers to write logical VBA code!"}, {"owner": {"reputation": 11, "user_id": 8627445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e330c2607e7aeebd3109896fcb25b0?s=128&d=identicon&r=PG&f=1", "display_name": "johnnywin", "link": "https://stackoverflow.com/users/8627445/johnnywin"}, "reply_to_user": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1507131194, "post_id": 46567400, "comment_id": 80091191, "body": "I have added HTML code to illustrate a sample of the table layout @Zac. Hope this helps!"}], "owner": {"reputation": 11, "user_id": 8627445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/26e330c2607e7aeebd3109896fcb25b0?s=128&d=identicon&r=PG&f=1", "display_name": "johnnywin", "link": "https://stackoverflow.com/users/8627445/johnnywin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507131019, "creation_date": 1507127137, "last_edit_date": 1507131019, "question_id": 46567400, "link": "https://stackoverflow.com/questions/46567400/sorting-named-ranges-into-order-based-on-range-name", "title": "Sorting named ranges into order based on range name", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;style type=\"text/css\"&gt;\r\n\ttable.tableizer-table {\r\n\t\tfont-size: 12px;\r\n\t\tborder: 1px solid #CCC; \r\n\t\tfont-family: Arial, Helvetica, sans-serif;\r\n\t} \r\n\t.tableizer-table td {\r\n\t\tpadding: 4px;\r\n\t\tmargin: 3px;\r\n\t\tborder: 1px solid #CCC;\r\n\t}\r\n\t.tableizer-table th {\r\n\t\tbackground-color: #104E8B; \r\n\t\tcolor: #FFF;\r\n\t\tfont-weight: bold;\r\n\t}\r\n&lt;/style&gt;\r\n&lt;table class=\"tableizer-table\"&gt;\r\n&lt;thead&gt;&lt;tr class=\"tableizer-firstrow\"&gt;&lt;th&gt;Apr-17&lt;/th&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;th&gt;Heading&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;tbody&gt;\r\n &lt;tr&gt;&lt;td&gt;row label&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;row label&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;row label&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;row label&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;Totals&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;May-17&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;row label&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;row label&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;row label&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;row label&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;Totals&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;Jun-17&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;td&gt;Heading&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;row label&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;row label&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;row label&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;row label&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n &lt;tr&gt;&lt;td&gt;Totals&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;td&gt;Data&lt;/td&gt;&lt;/tr&gt;\r\n&lt;/tbody&gt;&lt;/table&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I have been trying to write a VBA macro to sort named ranges into reverse chronological order. I have a number of sheets where tables start from cell A1 and end a few rows down, where another table will start with the same characteristics. I will need to move the entire rows where the table is located.</p>\n\n<p>Currently I have written code to run down the sheet, finding start and end rows using the <code>.End(xlDown)</code> function and then add names to the ranges based on the top left-most cell denoted by the date in dd/mm/yyyy format (converted into serial for sorting later)</p>\n\n<p>Here is the code I have currently written:</p>\n\n<pre><code>Sub Rearrange()\n\nDim block As Range\nDim firstCell As Range\n\nSet firstCell = Range(\"A1\")\n\nDo ' run through the entire sheet\nSet block = Range(firstCell, firstCell.End(xlDown).EntireRow) 'define the block as the first cell to the last column in the row\n\nblock.Name = CDbl(firstCell) 'set the range name as the firstCell value (date in serial format)\n\nSet firstCell = firstCell.End(xlDown).End(xlDown) 'move to the next table by using xlDown twice\n\nLoop Until firstCell.Row &gt; 100000 ' loop until the firstCell row reaches the bottom of the sheet\n\n\n'move named ranges based on descending named range order with an empty row separator\n\nFor Each ActiveSheet.Name In ActiveSheet ' this is where it gets confusing\n\n'cut and insert the highest value named range in cell A1\n'insert blank row below named range\n\n'Cut and insert the next highest value named range between cell under blank row from table above.\n'insert blank row below named range.\n\n'rinse and repeat for the entire sheet.\n\nEnd Sub\n</code></pre>\n\n<p>I will be eternally grateful for any help with this!</p>\n\n<p>EDIT: sample table structure</p>\n"}, {"tags": ["vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1507126698, "post_id": 46567132, "comment_id": 80088017, "body": "How is the DropDown list generated? Have a look at the <code>DoEvents</code> command and also, you could change the <code>ComboBox</code> <code>Change</code> event to the <code>Exit</code> Event"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1507127285, "post_id": 46567132, "comment_id": 80088510, "body": "It will help to see your code. I suspect you want something like what happens when you start typing in google search? If that&#39;s the case, consider importing the column from your database into an XML prior to user interaction with the field (i.e. at form load or workbook open). You can achieve the dropdown options list a lot more efficiently then. I have created something like this before but I used threading. Unfortunately, to my knowledge, you don&#39;t have the option to thread in VBA"}, {"owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "edited": false, "score": 0, "creation_date": 1507128014, "post_id": 46567132, "comment_id": 80089078, "body": "Very similar to a google search yes. I wish I could start a separate thread. My code is long and I&#39;m not sure posting it will be helpful in gathering ideas.  I&#39;ll put a short pseudo up though. I have not explored using a .xml and will do some research, but that would only shorten the amount of time of loading between letters, I want to avoid running the code all together."}, {"owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "edited": false, "score": 0, "creation_date": 1507128318, "post_id": 46567132, "comment_id": 80089295, "body": "Tom, my backup plan is to use LoseFocus but it deviates from the UE I was aiming for. I want it to show results as you type, because you may not know the exact wording of the desired title."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "edited": false, "score": 0, "creation_date": 1507128646, "post_id": 46567132, "comment_id": 80089521, "body": "May be <a href=\"https://stackoverflow.com/a/46406042/1726522\">this</a> can help you, or at least give a hint"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "edited": false, "score": 0, "creation_date": 1507130881, "post_id": 46568245, "comment_id": 80090994, "body": "YES! I&#39;ve tested and this is perfect Peh, someday I hope to be as smart as you. Cant thank you enough for the quick answer."}, {"owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "reply_to_user": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "edited": false, "score": 0, "creation_date": 1507135499, "post_id": 46568245, "comment_id": 80093848, "body": "@EndUserAbuser If it fits your needs, please mark answer as &quot;accepted&quot;. Thats the way we say &quot;Thank you&quot; here... :)"}, {"owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "edited": false, "score": 0, "creation_date": 1507137493, "post_id": 46568245, "comment_id": 80094820, "body": "ha It took me longer than it should have but I finally found the green check, thanks for the tip."}, {"owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "edited": false, "score": 1, "creation_date": 1508518553, "post_id": 46568245, "comment_id": 80654996, "body": "The note is correct, I started running into issues where the sub was not being started (intermittently), if I change it back to 2 it runs every-time. That&#39;s good info @Peh"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1507130043, "last_edit_date": 1507130043, "creation_date": 1507129692, "answer_id": 46568245, "question_id": 46567132, "link": "https://stackoverflow.com/questions/46567132/wait-until-user-has-stopped-typing-in-combobox-to-run-macro-vba/46568245#46568245", "title": "Wait until user has stopped typing in ComboBox to run macro (VBA)", "body": "<p>This is a bit tricky as VBA doesn't support multi-threading. But we can use the <code>Application.OnTime</code> event to trigger a test in the future to test if the last key event is at least 3 seconds ago.</p>\n\n<p>In a <strong>Module</strong> insert:</p>\n\n<pre><code>Option Explicit\n\nPublic LastKeyEvent As Date\nPublic Const WaitTimeValue As String = \"00:00:03\" 'test for key event in 3 seconds\n\nPublic Sub TestKeyEvent()\n    'test if last key event is at least 3 seconds ago. \n    'If so: run your search or message box \n    'If not: do nothing\n    If LastKeyEvent &lt;&gt; 0 And LastKeyEvent + TimeValue(WaitTimeValue) &lt;= Now Then\n        LastKeyEvent = 0 'Ensure this is only triggered once:\n                         'If we don't do this and multiple keys are pressed within 1 second \n                         'then it would run multiple times.\n\n        MsgBox \"3 seconds without keypress, we can start search\"\n        'start your search here (instead of message box) \u2026\n    End If\nEnd Sub\n</code></pre>\n\n<p>Now you can use for your textbox change event eg <code>TextBox1</code>:</p>\n\n<pre><code>Private Sub TextBox1_Change()\n    Dim alertTime As Date\n\n    LastKeyEvent = Now 'remember when the last key event was\n    alertTime = LastKeyEvent + TimeValue(WaitTimeValue)\n    Application.OnTime alertTime, \"TestKeyEvent\" 'run TestKeyEvent in 3 seconds\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p><strong>Note:</strong><br>\n  This is a workaround that works for 2 or more seconds. But does not for less then 2 seconds.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "is_accepted": false, "score": 1, "last_activity_date": 1507134242, "creation_date": 1507134242, "answer_id": 46569718, "question_id": 46567132, "link": "https://stackoverflow.com/questions/46567132/wait-until-user-has-stopped-typing-in-combobox-to-run-macro-vba/46569718#46569718", "title": "Wait until user has stopped typing in ComboBox to run macro (VBA)", "body": "<p>An alternative using <code>Application.OnTime</code> again:</p>\n\n<p>In <strong>Userform</strong>:</p>\n\n<pre><code>Private Sub ComboBox1_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)\n    StartTimer\nEnd Sub\n</code></pre>\n\n<p>In <strong>Module</strong>:</p>\n\n<pre><code>Public RunTime As Double\n\nPublic Sub StartTimer()\n    On Error Resume Next\n    Application.OnTime EarliestTime:=RunTime, Procedure:=\"YourCode\", Schedule:=False\n    RunTime = Now() + TimeValue(\"00:00:03\")\n    Application.OnTime RunTime, \"YourCode\"\nEnd Sub\n\nPublic Sub YourCode()\n    MsgBox \"It's working!\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 8372214, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/hOFR1.png?s=128&g=1", "display_name": "EndUserAbuser", "link": "https://stackoverflow.com/users/8372214/enduserabuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1955, "favorite_count": 0, "accepted_answer_id": 46568245, "answer_count": 2, "score": 2, "last_activity_date": 1507134242, "creation_date": 1507126398, "last_edit_date": 1507130286, "question_id": 46567132, "link": "https://stackoverflow.com/questions/46567132/wait-until-user-has-stopped-typing-in-combobox-to-run-macro-vba", "title": "Wait until user has stopped typing in ComboBox to run macro (VBA)", "body": "<p>I'm programming a sort of cross-reference database. An ID is generated based on the document name chosen or created. </p>\n\n<p>The ComboBox I've referred to in the title acts on change (after 3 letters), checks the database for similar entries to what was typed, and displays the drop downof options that match. Once an entry is picked from the match list or a new name created - the appropriate number is generated. </p>\n\n<p>Since the DropDown list is generated after every letter is typed, it takes a while to type what you want. I want to wait a few seconds after the <em>last</em> change to run the macro. </p>\n\n<p>Any Ideas on how I can accomplish this?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "is_accepted": false, "score": 6, "last_activity_date": 1507126805, "creation_date": 1507126805, "answer_id": 46567276, "question_id": 46567042, "link": "https://stackoverflow.com/questions/46567042/why-does-debug-print-differentiate-between-boolean-and-integer/46567276#46567276", "title": "Why does Debug.print differentiate between Boolean and Integer?", "body": "<p>Line 1 evaluates to (if -1 equals true) then print true else print false</p>\n\n<p>Line 2 evaluates to print -1 (as you asked)</p>\n\n<p>Line 3 evaluates to print true (as you asked)</p>\n\n<p>-1 is true and 0 is false in VBA</p>\n"}, {"tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 3, "last_activity_date": 1507127368, "creation_date": 1507127368, "answer_id": 46567475, "question_id": 46567042, "link": "https://stackoverflow.com/questions/46567042/why-does-debug-print-differentiate-between-boolean-and-integer/46567475#46567475", "title": "Why does Debug.print differentiate between Boolean and Integer?", "body": "<p>You could also assume that a string is an array of bytes, or that a 16-bit integer is a series of 0's and 1's.</p>\n\n<p>The answer is <em>because VBA as a language provides an abstraction for Boolean values</em>.</p>\n\n<p>That's all there is to it: it <em>knows</em> and <em>defines</em> that <code>True</code> and <code>False</code> are <code>Boolean</code> literals; their respective underlying values are nothing but plumbing to make it work: <code>False</code> maps to <code>0</code>, and any non-zero value converts to <code>True</code>, with <code>-1</code> being returned for Boolean-to-numeric conversions.</p>\n\n<p>IOW, this isn't about <code>Debug.Print</code>, it's about VBA's type system.</p>\n"}, {"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 3, "last_activity_date": 1507127464, "creation_date": 1507127464, "answer_id": 46567509, "question_id": 46567042, "link": "https://stackoverflow.com/questions/46567042/why-does-debug-print-differentiate-between-boolean-and-integer/46567509#46567509", "title": "Why does Debug.print differentiate between Boolean and Integer?", "body": "<p>Boolean variables are stored as 16-bit (2-byte) numbers, but they can only be True or False.</p>\n\n<blockquote>\n  <p>When other numeric types are converted to Boolean values, 0 becomes\n  False and all other values become True.\n  When Boolean values are converted to other data types, False becomes 0 and True becomes -1.</p>\n</blockquote>\n\n<p>On your first Debug.Print you evaluate an expression (-1 = True) which is True.<br></p>\n\n<p>The second prints an Integer.<br></p>\n\n<p>The third prints a Boolean.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/boolean-data-type\" rel=\"nofollow noreferrer\">Boolean Data Type</a></p>\n"}], "owner": {"reputation": 6420, "user_id": 480894, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5449cd50eb589e8be56164de5584057c?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/480894/roland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 609, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1507127464, "creation_date": 1507126170, "last_edit_date": 1531164843, "question_id": 46567042, "link": "https://stackoverflow.com/questions/46567042/why-does-debug-print-differentiate-between-boolean-and-integer", "title": "Why does Debug.print differentiate between Boolean and Integer?", "body": "<p>I'm assuming that in vba the type <code>Boolean</code> is just a 16 bit integer. So why and how does <code>Debug.Print</code> differentiate between the two?</p>\n\n<pre><code>Debug.Print -1 = True\nDebug.Print -1\nDebug.Print True\n</code></pre>\n\n<p>Will output:</p>\n\n<pre><code>True\n-1  \nTrue\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 663, "user_id": 3701067, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3098bfaa0c93735c09e7bc8f0fecbcfc?s=128&d=identicon&r=PG", "display_name": "Mindsers", "link": "https://stackoverflow.com/users/3701067/mindsers"}, "edited": false, "score": 1, "creation_date": 1507127085, "post_id": 46566958, "comment_id": 80088342, "body": "Hi and welcome to StackOverflow. Please refer to <a href=\"http://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a> on how to ask a proper question and improve yours according the guidelines. A first step could be adding the code you already wrote and explain his behavior."}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "is_accepted": false, "score": 0, "last_activity_date": 1507212092, "creation_date": 1507212092, "answer_id": 46587625, "question_id": 46566958, "link": "https://stackoverflow.com/questions/46566958/suppress-warnings-in-ms-access-vba/46587625#46587625", "title": "Suppress warnings in ms-access VBA", "body": "<p>Are you using a click event for any buttons?  If so I would just suppress warnings in there.  This setting will remain this way until you close the database and open it again.</p>\n\n<pre><code>DoCmd.SetWarnings (False)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8720443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc0255b25c243229c76f58449f7e20b0?s=128&d=identicon&r=PG&f=1", "display_name": "grahamh", "link": "https://stackoverflow.com/users/8720443/grahamh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3412, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1507212092, "creation_date": 1507125941, "question_id": 46566958, "link": "https://stackoverflow.com/questions/46566958/suppress-warnings-in-ms-access-vba", "title": "Suppress warnings in ms-access VBA", "body": "<p>While developing forms in Access VBA I am trying to prevent access from adding a new record and then not giving any warning message. I can stop the record from being inserted but cannot supress the warning message. I have set warnings to false on the after update event (and set warnings to true on the close event ). Can anyone tell me which events I should code for this. The reason for doing this is only while I develop the forms</p>\n"}, {"tags": ["excel", "search", "filter", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8720563, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159444655235013/picture?type=large", "display_name": "Bill Fraser", "link": "https://stackoverflow.com/users/8720563/bill-fraser"}, "edited": false, "score": 0, "creation_date": 1507280174, "post_id": 46574161, "comment_id": 80155711, "body": "Thanks a lot! Works perfectly and has saved me so much time!"}], "tags": [], "owner": {"reputation": 1135, "user_id": 3165466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef259905fd034ee6a4c74269b89d0457?s=128&d=identicon&r=PG&f=1", "display_name": "Gordon", "link": "https://stackoverflow.com/users/3165466/gordon"}, "is_accepted": true, "score": 0, "last_activity_date": 1507151096, "creation_date": 1507151096, "answer_id": 46574161, "question_id": 46566927, "link": "https://stackoverflow.com/questions/46566927/input-box-filter-macro/46574161#46574161", "title": "Input Box Filter Macro", "body": "<p>You need to change the <code>\"560623\"</code> at the end of the 2 Autofilter lines to </p>\n\n<p><code>Sheets(\"Report Input\").range(\"B2\")</code></p>\n"}], "owner": {"reputation": 3, "user_id": 8720563, "user_type": "registered", "profile_image": "https://graph.facebook.com/10159444655235013/picture?type=large", "display_name": "Bill Fraser", "link": "https://stackoverflow.com/users/8720563/bill-fraser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 46574161, "answer_count": 1, "score": 0, "last_activity_date": 1507151096, "creation_date": 1507125857, "last_edit_date": 1531161705, "question_id": 46566927, "link": "https://stackoverflow.com/questions/46566927/input-box-filter-macro", "title": "Input Box Filter Macro", "body": "<p>I have searched for a solution to the following issue and tried to solve it myself but unfortunately my limited knowledge of macros has led me to a dead end!</p>\n\n<p>The following is a code from my current macro that I am trying to setup to make a repetitive role in work easier.</p>\n\n<p>I would like to filter 2 separate reports on separate tabs in the same workbook, copy and paste the results to new tabs with a paste values based on an input box to be populated with search criteria. if this makes sense.</p>\n\n<p>The macro works apart from the fact it has saved the search criteria as a definite number in bedded into the macro instead of using the cell reference I tried to link it to being \"B2\" in this case on a tab called \"Report Input\"</p>\n\n<p>Basically - Copy values in \"B2\" from Tab 1 \"Report Input\", regardless of the number (not necessarily 560623), look at tab 2 \"Invoice Backup\" and filter based on cell \"b2\" from tab 1...copy and paste values to tab 3....then repeat the process with another report... </p>\n\n<p>Any help would be appreciated.</p>\n\n<pre><code>    Sub ReportFilter()\n    '\n    ' ReportFilter Macro\n    '\n\n    '\n        Range(\"B2\").Select\n    Selection.Copy\n    Sheets(\"TDR Backup\").Select\n    ActiveSheet.Range(\"$A$1:$AA$56298\").AutoFilter Field:=3, Criteria1:= _\n        \"560623\"\n    Cells.Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"TDR\").Select\n    Cells.Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Sheets(\"Report Input\").Select\n    Range(\"B2\").Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Invoice Backup\").Select\n    Application.CutCopyMode = False\n    Selection.AutoFilter\n    ActiveWindow.ScrollColumn = 6\n    ActiveWindow.ScrollColumn = 5\n    ActiveWindow.ScrollColumn = 4\n    ActiveWindow.ScrollColumn = 3\n    ActiveWindow.ScrollColumn = 1\n    Sheets(\"Report Input\").Select\n    Selection.Copy\n    Sheets(\"Invoice Backup\").Select\n    ActiveSheet.Range(\"$A$1:$T$340548\").AutoFilter Field:=2, Criteria1:= _\n        \"560623\"\n    ActiveWindow.SmallScroll Down:=-18\n    Cells.Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"Invoice\").Select\n    Cells.Select\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    ActiveWindow.SmallScroll Down:=-48\n    Range(\"E546\").Select\n    Selection.End(xlUp).Select\n    Range(\"E67\").Select\n    Selection.End(xlUp).Select\n    Selection.End(xlUp).Select\n    Selection.End(xlUp).Select\n    Range(\"E2\").Select\n    Sheets(\"TDR\").Select\n    Range(\"D39\").Select\n    ActiveWindow.SmallScroll Down:=-66\n    Sheets(\"TDR Backup\").Select\n    Rows(\"1:1\").Select\n    Application.CutCopyMode = False\n    Selection.AutoFilter\n    Sheets(\"Invoice Backup\").Select\n    Rows(\"1:1\").Select\n    Selection.AutoFilter\n    Range(\"G8\").Select\n    ActiveWindow.SmallScroll Down:=-18\nEnd Sub\n</code></pre>\n"}, {"tags": ["database", "vba", "ms-access"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 1, "creation_date": 1507125351, "post_id": 46566692, "comment_id": 80087021, "body": "A PK can only be made of fields belonging to its table. Your question is unclear to me."}, {"owner": {"reputation": 61, "user_id": 7126181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ada6444b673dc480c8e629f03d7a61a?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Houston", "link": "https://stackoverflow.com/users/7126181/danny-houston"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1507126394, "post_id": 46566692, "comment_id": 80087779, "body": "Edited question to be more clear. (I meant making a primary key in access with two other fields in the table)"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1507127426, "post_id": 46566692, "comment_id": 80088614, "body": "This is not how you work with databases. Create a regular PK, e.g. a Autonumber. Use this as foreign key in the other table. Then when you need the combined string, join the tables and concatenate the columns. Don&#39;t store calculated values in the database. <a href=\"http://allenbrowne.com/casu-14.html\" rel=\"nofollow noreferrer\">Calculated fields belong in queries, not tables.</a>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1507127480, "post_id": 46566692, "comment_id": 80088661, "body": "But surely a primary key made from two fields is a composite key?  Or do you mean one of those new fangled calculated fields which just seems wrong as @Andre has linked to."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1507127482, "post_id": 46566692, "comment_id": 80088667, "body": "And if you need the combination of both columns to be unique, create a UNIQUE index on the two columns."}], "answers": [{"tags": [], "owner": {"reputation": 1276, "user_id": 38988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e2d585fabb5cde7a84bafa766ab35b?s=128&d=identicon&r=PG&f=1", "display_name": "John Mo", "link": "https://stackoverflow.com/users/38988/john-mo"}, "is_accepted": false, "score": 1, "last_activity_date": 1507132252, "creation_date": 1507132252, "answer_id": 46569133, "question_id": 46566692, "link": "https://stackoverflow.com/questions/46566692/creating-a-custom-primary-key-in-access/46569133#46569133", "title": "Creating a custom primary key in access", "body": "<p>You can create a composite primary key and reference it in another table, but I don't recommend it. As you may be anticipating, it will be extra work to propagate both columns to the related table and all joins on both tables will then have to reference both of the columns in the composite key. Access does provide a little help in working with composite keys in the form of cascading updates and deletes, but the overall effort involved in dealing with composite keys probably isn't worth it.</p>\n\n<p>I recommend using an autonumber column as a surrogate primary key and creating a unique index on the columns that represent your natural key.</p>\n"}], "owner": {"reputation": 61, "user_id": 7126181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3ada6444b673dc480c8e629f03d7a61a?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Houston", "link": "https://stackoverflow.com/users/7126181/danny-houston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593588359, "creation_date": 1507125172, "last_edit_date": 1593588359, "question_id": 46566692, "link": "https://stackoverflow.com/questions/46566692/creating-a-custom-primary-key-in-access", "title": "Creating a custom primary key in access", "body": "<p>Is there a way to create a primary key in access based on provided attributes? For example, say I have a school database, with an entity containing a course's code being in the form LL and it's qualification being in the form LLLA. How would I make it so that whenever a new course is entered into this entity, the primary key for that record is the two attributes amended together in the form LL\\LLLA? (Eg IT\\BTEC, RM\\GCSE)</p>\n\n<p>(Just for reference, a composite key is not an option here as this attribute needs to be referenced in another table)</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 3578975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d51b15de72183480ea2ab2d6f0e52f?s=128&d=identicon&r=PG&f=1", "display_name": "user3578975", "link": "https://stackoverflow.com/users/3578975/user3578975"}, "edited": false, "score": 0, "creation_date": 1507192920, "post_id": 46566715, "comment_id": 80115437, "body": "One question for improvement- When the data in the cell is large with lot of spaces and ========, there is a run time error: Application-defined or object- defined error at line &quot;r.Value = translate_using_vba(s, l)&quot;. Is there a way to avoid it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "reply_to_user": {"reputation": 13, "user_id": 3578975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d51b15de72183480ea2ab2d6f0e52f?s=128&d=identicon&r=PG&f=1", "display_name": "user3578975", "link": "https://stackoverflow.com/users/3578975/user3578975"}, "edited": false, "score": 0, "creation_date": 1507212068, "post_id": 46566715, "comment_id": 80128294, "body": "Well, debug your code by single-stepping through it and make use of the Immediate window to find out why"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "is_accepted": true, "score": 0, "last_activity_date": 1507125234, "creation_date": 1507125234, "answer_id": 46566715, "question_id": 46566564, "link": "https://stackoverflow.com/questions/46566564/translating-an-entire-column-in-excel-and-pasting-results-in-the-next-column/46566715#46566715", "title": "Translating an entire column in excel and pasting results in the next column", "body": "<p>Try this:</p>\n\n<pre><code>Set r = Range(\"B2\") ' Initial (starting) cell\nFor Each s In Range(\"A2:A3\").Cells\n    l = s\n    r.value = translate_using_vba(s, l)\n    Set r = r.Offset(1, 0) 'Next row\nNext s\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3578975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84d51b15de72183480ea2ab2d6f0e52f?s=128&d=identicon&r=PG&f=1", "display_name": "user3578975", "link": "https://stackoverflow.com/users/3578975/user3578975"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1263, "favorite_count": 0, "accepted_answer_id": 46566715, "answer_count": 1, "score": 1, "last_activity_date": 1507125234, "creation_date": 1507124798, "question_id": 46566564, "link": "https://stackoverflow.com/questions/46566564/translating-an-entire-column-in-excel-and-pasting-results-in-the-next-column", "title": "Translating an entire column in excel and pasting results in the next column", "body": "<p>Translating an entire column in excel and pasting results in the next column.My code is as follows:</p>\n\n<pre><code>Sub test()\nDim s, r As Range, l As String\n\nFor Each s In Range(\"A2:A3\").Cells\n        l = s\n        **Range(\"B2:B3\").Cells = translate_using_vba(s, l)**\n\n     Next s\n\nEnd Sub\n\n\nPublic Function translate_using_vba(str, l) As String\n' Tools Refrence Select Microsoft internet Control\n    Dim IE As Object, i As Long, j As Long\n    Dim inputstring As String, outputstring As String, text_to_convert As String, result_data As String, CLEAN_DATA\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    '   TO CHOOSE INPUT LANGUAGE\n    inputstring = \"auto\"\n    '   TO CHOOSE OUTPUT LANGUAGE\n    outputstring = \"en\"\n\n    text_to_convert = str\n    'open website\n    IE.Visible = False\n    IE.navigate \"http://translate.google.com/#\" &amp; inputstring &amp; \"/\" &amp;outputstring &amp; \"/\" &amp; text_to_convert\n    Do Until IE.ReadyState = 4\n        DoEvents\n    Loop\n    Application.Wait (Now + TimeValue(\"0:00:5\"))\n    Do Until IE.ReadyState = 4\n        DoEvents\n    Loop\n\n    CLEAN_DATA = Split(Application.WorksheetFunction.Substitute(IE.Document.getElementById(\"result_box\").innerHTML, \"&lt;/SPAN&gt;\", \"\"), \"&lt;\")\n\n    For j = LBound(CLEAN_DATA) To UBound(CLEAN_DATA)\n        result_data = result_data &amp; Right(CLEAN_DATA(j), Len(CLEAN_DATA(j)) - InStr(CLEAN_DATA(j), \"&gt;\"))\n    Next   \n\n    IE.Quit\n    translate_using_vba = result_data\n\n\nEnd Function\n</code></pre>\n\n<p>Question: It works fine but my result in column B is overwritten each time. How can I can store B2 value first and then move to B3?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 230, "user_id": 5768847, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-qz9e-gLgqOc/AAAAAAAAAAI/AAAAAAAAHvU/bxWGUutbgJA/photo.jpg?sz=128", "display_name": "Blake", "link": "https://stackoverflow.com/users/5768847/blake"}, "is_accepted": false, "score": 1, "last_activity_date": 1507126341, "creation_date": 1507126341, "answer_id": 46567113, "question_id": 46566547, "link": "https://stackoverflow.com/questions/46566547/shorten-copy-and-paste-vba-to-paste-filtered-cells-from-one-sheet-to-another/46567113#46567113", "title": "Shorten Copy and Paste VBA to paste filtered cells from one sheet to another", "body": "<p>Using select is very slow and is generally avoided if you can help it. I would recommend using a with statement to do all of the operations on a given sheet. Something like this should help. Instead of using select, try activate. </p>\n\n<pre><code>With Sheets(\"Paster\").Range(\"$A$1:$AK$801\")\n    .AutoFilter Field:=10, Criteria1:= _\n    xlFilterLastYear, Operator:=xlFilterDynamic\n    .Copy\nEnd With\n\nWith Sheets(\"Hidden\")\n    .Range(\"A1\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _ \n        SkipBlanks:=False, Transpose:=False 'I just pasted into cell A1\nEnd With\nSheets(\"Overall\").Activate\n</code></pre>\n\n<p>I hope something like this will help! I do not know what type of data you are using, but it did copy a bunch of random generated data to the Hidden worksheet.</p>\n\n<p>Another thing you can do to avoid the screen flashing/flickering is to turn screen updating off at the start of the macro and then turn it back on at the end.</p>\n\n<pre><code>Application.ScreenUpdating = False ' This should be the first line of a sub\nApplication.ScreenUpdating = True  ' This should be the last line of the sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 8720451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9db7d18f0b7785c7d1726b3556005436?s=128&d=identicon&r=PG&f=1", "display_name": "Fordy", "link": "https://stackoverflow.com/users/8720451/fordy"}, "edited": false, "score": 0, "creation_date": 1507127021, "post_id": 46567128, "comment_id": 80088275, "body": "Works perfect, I assume the VBA will work the same for this year, this quarter ect."}, {"owner": {"reputation": 657, "user_id": 5994620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjudG.jpg?s=128&g=1", "display_name": "BerticusMaximus", "link": "https://stackoverflow.com/users/5994620/berticusmaximus"}, "reply_to_user": {"reputation": 85, "user_id": 8720451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9db7d18f0b7785c7d1726b3556005436?s=128&d=identicon&r=PG&f=1", "display_name": "Fordy", "link": "https://stackoverflow.com/users/8720451/fordy"}, "edited": false, "score": 0, "creation_date": 1507127234, "post_id": 46567128, "comment_id": 80088476, "body": "@Fordy as far as i&#39;m aware yes. You can find all the options <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.excel.xldynamicfiltercriteria.aspx\" rel=\"nofollow noreferrer\">here</a>."}], "tags": [], "owner": {"reputation": 657, "user_id": 5994620, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UjudG.jpg?s=128&g=1", "display_name": "BerticusMaximus", "link": "https://stackoverflow.com/users/5994620/berticusmaximus"}, "is_accepted": true, "score": 0, "last_activity_date": 1507126387, "creation_date": 1507126387, "answer_id": 46567128, "question_id": 46566547, "link": "https://stackoverflow.com/questions/46566547/shorten-copy-and-paste-vba-to-paste-filtered-cells-from-one-sheet-to-another/46567128#46567128", "title": "Shorten Copy and Paste VBA to paste filtered cells from one sheet to another", "body": "<p>Anytime you use <code>.Copy</code> <code>.Paste</code> or <code>.Select</code> it's slowing you down significantly. You can make it slightly faster by turning off Screen Updating and Calculation. Then working with the ranges themselves is always going to be faster see below for how I got rid of using <code>.Select</code> you can read more about it <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">here</a>. Normally when you want to skip using <code>.copy</code> it's better to say to <code>This Range = That Range</code> then you can skip the clipboard completely but with filtered data it's a bit of a nightmare.</p>\n\n<pre><code>Sub CopyAndPaste()\n\n    Dim wbk As Workbook\n    Dim Paste As Worksheet, Hidden As Worksheet, Overall As Worksheet\n\n    Set wbk = ActiveWorkbook\n    Set Paste = wbk.Worksheets(\"Paster\")\n    Set Hidden = wbk.Worksheets(\"Hidden\")\n    Set Overall = wbk.Worksheets(\"Overall\")\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n        Paste.Range(\"$A$1:$AK$801\").AutoFilter Field:=10, Criteria1:=xlFilterLastYear, Operator:=xlFilterDynamic\n        Paste.Cells.Copy\n\n        Hidden.Cells.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 8720451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9db7d18f0b7785c7d1726b3556005436?s=128&d=identicon&r=PG&f=1", "display_name": "Fordy", "link": "https://stackoverflow.com/users/8720451/fordy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "accepted_answer_id": 46567128, "answer_count": 2, "score": 1, "last_activity_date": 1507126387, "creation_date": 1507124765, "question_id": 46566547, "link": "https://stackoverflow.com/questions/46566547/shorten-copy-and-paste-vba-to-paste-filtered-cells-from-one-sheet-to-another", "title": "Shorten Copy and Paste VBA to paste filtered cells from one sheet to another", "body": "<p>I am pretty new to VBA and would like a bit of advice on the below, I am currently trying to filter certain dates then copy and paste them into a separate sheet to then =SUBTOTAL ect. The VBA works but does take slightly longer than desired.  Can anyone provide me a solution please, I've googled this and cannot get it to work when shortened.</p>\n\n<pre><code>Sheets(\"Paster\").Select\nActiveSheet.Range(\"$A$1:$AK$801\").AutoFilter Field:=10, Criteria1:= _\n    xlFilterLastYear, Operator:=xlFilterDynamic\nCells.Select\nSelection.Copy\nSheets(\"Hidden\").Select\nCells.Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nSheets(\"Overall\").Select\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 0, "creation_date": 1507129996, "post_id": 46566836, "comment_id": 80090461, "body": "I get <code>While MyInput</code>  Invalid qualifier.  Thank you :)."}, {"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 0, "creation_date": 1507130719, "post_id": 46566836, "comment_id": 80090890, "body": "I removed the <code>.value</code> and the error is gone, however it looks like the 1 or 2 is being stored, not the <code>00000</code> or <code>11111</code>, is that beacause of the <code>.value</code>?  Thank you )."}, {"owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 0, "creation_date": 1507132130, "post_id": 46566836, "comment_id": 80091833, "body": "I have edited the <code>vba</code> in my post to convert the  user choice (or so I think). Is this correct/the right way?  Thank you :)."}, {"owner": {"reputation": 26, "user_id": 8720397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f3e5565044dde2d3234e64cf4c0e03?s=128&d=identicon&r=PG&f=1", "display_name": "overflowed", "link": "https://stackoverflow.com/users/8720397/overflowed"}, "reply_to_user": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 1, "creation_date": 1507171930, "post_id": 46566836, "comment_id": 80107365, "body": "&quot;strInput&quot; is declared as an Integer. Change it to String"}, {"owner": {"reputation": 26, "user_id": 8720397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f3e5565044dde2d3234e64cf4c0e03?s=128&d=identicon&r=PG&f=1", "display_name": "overflowed", "link": "https://stackoverflow.com/users/8720397/overflowed"}, "reply_to_user": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "edited": false, "score": 1, "creation_date": 1507171982, "post_id": 46566836, "comment_id": 80107381, "body": "And yes, remove .Values from all MyValues"}], "tags": [], "owner": {"reputation": 26, "user_id": 8720397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13f3e5565044dde2d3234e64cf4c0e03?s=128&d=identicon&r=PG&f=1", "display_name": "overflowed", "link": "https://stackoverflow.com/users/8720397/overflowed"}, "is_accepted": true, "score": 1, "last_activity_date": 1507125571, "creation_date": 1507125571, "answer_id": 46566836, "question_id": 46566505, "link": "https://stackoverflow.com/questions/46566505/excel-2010-vba-user-menu-to-store-selection-as-variable/46566836#46566836", "title": "excel 2010 vba user menu to store selection as variable", "body": "<p>The user entered value is stored however this may not be 1 or 2 as there is no restriction in place to inhibit users from entering an incorrect value. Try the code below which keeps on asking the question until a valid number (1 or 2) has been entered by the user.</p>\n\n<pre><code>Dim Msg, Title As String\nDim MyInput As Integer\n\n ' Define message.\"\nMsg = \"Which array was used ? \" _\n&amp; vbNewLine &amp; \"Enter 1 for Design: 00000\" &amp; vbNewLine _\n&amp; \"Enter 2 for Design: 11111\"\n\nTitle = \"Selection of Application\" ' Define title.\n\nWhile MyInput.Value &lt;&gt; 1 And MyInput.Value &lt;&gt; 2\n\n    MyInput = InputBox(Msg, Title)\n    Select Case MyInput\n        Case 1\n            MsgBox \"User chose Design 1\"\n        Case 2\n            MsgBox \"User chose Design 2\"\n        Case Else\n            MsgBox \u201cInvalid Entry. Try again.\u201d\n    End Select\n\nWend\n\n'STORE SELECTION '\nDim strInput As Integer\nstrInput = MyInput.Value\n</code></pre>\n"}], "owner": {"reputation": 2528, "user_id": 4668368, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/70b77439d7ee9bb7410105b7bc912afb?s=128&d=identicon&r=PG&f=1", "display_name": "justaguy", "link": "https://stackoverflow.com/users/4668368/justaguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 46566836, "answer_count": 1, "score": 0, "last_activity_date": 1507132069, "creation_date": 1507124653, "last_edit_date": 1531164843, "question_id": 46566505, "link": "https://stackoverflow.com/questions/46566505/excel-2010-vba-user-menu-to-store-selection-as-variable", "title": "excel 2010 vba user menu to store selection as variable", "body": "<p>In the below <code>excel 2010 VBA</code> I am trying to create a user menu that stores a selection (there are only 2 choices) in the variable <code>strInput</code>. That selection will be used later on but I am not sure if I am doing that in the below. Is the 1 or 2 from the section being stored or the unique 5 digit code? Is there a better way? Thank you very much:).</p>\n\n<p><strong>VBA</strong></p>\n\n<pre><code>Dim Msg, Title As String\nDim MyInput As Integer\n\n' Define message.\"\nMsg = \"Which array was used ? \" _\n&amp; vbNewLine &amp; \"Enter 1 for Design: 00000\" &amp; vbNewLine _\n&amp; \"Enter 2 for Design: 11111\"\n\nTitle = \"Selection of Application\" ' Define title.\n\nWhile MyInput.Value &lt;&gt; 1 And MyInput.Value &lt;&gt; 2\n\nMyInput = InputBox(Msg, Title)\nSelect Case MyInput\n    Case 1\n        MsgBox \"User chose Design 1\"\n    Case 2\n        MsgBox \"User chose Design 2\"\n    Case Else\n        MsgBox \u201cInvalid Entry. Try again.\u201d\nEnd Select\n\nWend\n\n'STORE SELECTION '\nDim strInput As Integer\nstrInput = MyInput.Value\n\n' CONVERT USER CHOICE '\nIf MyInput = 1 Then\nstrInput = \"00000\"\nElse\nstrInput = \"11111\"\nEnd If\n</code></pre>\n\n<p><strong>desired:</strong></p>\n\n<p>user selects 1, so <code>00000</code> would be stored in <code>strInput</code> but user selects 2, so <code>11111</code> would be stored in <code>strInput</code></p>\n"}, {"tags": ["string", "vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1507124168, "post_id": 46566309, "comment_id": 80086211, "body": "Try <code>If InStr(1, ss, &quot;dw&quot;, vbTextCompare) &gt; 0 Then</code> and make the same change to the rest of your InStr statements"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507125554, "post_id": 46566309, "comment_id": 80087174, "body": "Alternately, instead of using any InStr statements, just use this single formula: <code>&quot;=IFERROR(LOOKUP(REPT(&quot;&quot;z&quot;&quot;,255),MID(E&quot; &amp; lRow &amp; &quot;,SEARCH({&quot;&quot;dw&quot;&quot;,&quot;&quot;lex&quot;&quot;,&quot;&quot;tex&quot;&quot;,&quot;&quot;qex&quot;&quot;,&quot;&quot;qnxr&quot;&quot;},E&quot; &amp; lRow &amp; &quot;),{6,7,7,7,8})),&quot;&quot;Not Found&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507125590, "post_id": 46566309, "comment_id": 80087202, "body": "Or use the formula directly in the cell: <code>=IFERROR(LOOKUP(REPT(&quot;z&quot;,255),MID(E2,SEARCH({&quot;dw&quot;,&quot;lex&quot;,&quot;tex&zwnj;&#8203;&quot;,&quot;qex&quot;,&quot;qnxr&quot;},E2),&zwnj;&#8203;{6,7,7,7,8})),&quot;Not Found&quot;)</code>"}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507127126, "post_id": 46566309, "comment_id": 80088381, "body": "Your first answer worked great! thank you!"}, {"owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507132922, "post_id": 46566309, "comment_id": 80092387, "body": "@tigeravatar I like your alternate solutions. What does the rept(&quot;&quot;z&quot;&quot;,255) do though?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507133970, "post_id": 46566309, "comment_id": 80093009, "body": "It creates a 255 string that is just the letter z over and over.  This is used by the Lookup function to return the match that is less than that value ignoring errors."}], "owner": {"reputation": 15, "user_id": 8672342, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/cafb6f2b3d800d01f7d673ba5e4e6f14?s=128&d=identicon&r=PG&f=1", "display_name": "Picapiedra", "link": "https://stackoverflow.com/users/8672342/picapiedra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1379, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507128751, "creation_date": 1507124052, "last_edit_date": 1507128751, "question_id": 46566309, "link": "https://stackoverflow.com/questions/46566309/extract-text-from-cell-and-define-as-string-in-vba", "title": "Extract text from cell and define as string in vba", "body": "<p>I am hoping to pull text from a cell in my active sheet, define that information as a string and pass it through this If, ElseIf, Else loop. The issue I'm facing is that even though the text I pull contains \"dw\" the output is always \"Not Found\". </p>\n\n<p>Its strange because I use message box to see if ss is actually getting defined correctly and it does so I don't think my issue is with pulling the text or defining the string.</p>\n\n<p>(It may not be necessary information but lrow changes because the code below is a part of a larger loop) </p>\n\n<pre><code>Dim ss As String\nDim iRow As Long\n\niRow = Cells.find(What:=\"*\", SearchOrder:=xlRows, SearchDirection:=xlPrevious, LookIn:=xlValues).Row\nlRow = iRow\n\nss = Cells(lRow, 5).Text\n'the message box below shows me that ss is pulling the info from the sheet that I'm looking for\n'msgbox (ss)\n\nIf InStr(ss, \"dw\") &gt; 0 Then\n   Cells(lRow, 18).Formula = \"=MID(E12,SEARCH(\"\"dw\"\",\" &amp; Chr(34) &amp; ss &amp; Chr(34) &amp; \"),6)\"\n\nElseIf InStr(ss, \"lex\") &gt; 0 Then\n   Cells(lRow, 18).Formula = \"=MID(E12,SEARCH(\"\"lex\"\",\" &amp; Chr(34) &amp; ss &amp; Chr(34) &amp; \"),7)\"\n\nElseIf InStr(ss, \"tex\") &gt; 0 Then\n   Cells(lRow, 18).Formula = \"=MID(E12,SEARCH(\"\"tex\"\",\" &amp; Chr(34) &amp; ss &amp; Chr(34) &amp; \"),7)\"\n\nElseIf InStr(ss, \"qex\") &gt; 0 Then\n   Cells(lRow, 18).Formula = \"=MID(E12,SEARCH(\"\"qex\"\",\" &amp; Chr(34) &amp; ss &amp; Chr(34) &amp; \"),7)\"\n\nElseIf InStr(ss, \"qnxr\") &gt; 0 Then\n   Cells(lRow, 18).Formula = \"=MID(E12,SEARCH(\"\"qnxr\"\",\" &amp; Chr(34) &amp; ss &amp; Chr(34) &amp; \"),8)\"\n\nElse\n   Cells(lRow, 18).Value = \"Not Found\"\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1507124205, "post_id": 46565953, "comment_id": 80086251, "body": "Show your code."}, {"owner": {"reputation": 13, "user_id": 5277299, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a3a23bb6ef8fc3ea39c584b568ab175a?s=128&d=identicon&r=PG&f=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/5277299/alice"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1507125772, "post_id": 46565953, "comment_id": 80087335, "body": "The code works."}, {"owner": {"reputation": 13, "user_id": 5277299, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a3a23bb6ef8fc3ea39c584b568ab175a?s=128&d=identicon&r=PG&f=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/5277299/alice"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1507127298, "post_id": 46565953, "comment_id": 80088522, "body": "Ok, figured it out. Grouped the columns and then called the function from worksheet_selectionchange. see <a href=\"https://stackoverflow.com/questions/28370883/excel-vba-when-i-click-the-beside-a-group-of-rows\" title=\"excel vba when i click the beside a group of rows\">stackoverflow.com/questions/28370883/&hellip;</a>"}], "owner": {"reputation": 13, "user_id": 5277299, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a3a23bb6ef8fc3ea39c584b568ab175a?s=128&d=identicon&r=PG&f=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/5277299/alice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507125676, "creation_date": 1507123137, "last_edit_date": 1507125676, "question_id": 46565953, "link": "https://stackoverflow.com/questions/46565953/excel-determine-if-user-hides-unhides-columns", "title": "Excel Determine if user hides/unhides columns", "body": "<p>I've got worksheets that users will be hiding/unhiding columns on for printing purposes. Within those columns are certain cells which need to be copied to a visible area when those columns are hidden and the process reversed when they are not. The function works fine to detect the columns' visible status when the worksheet is activated. However it does not update at the time the column statuses are changed. I understand that the worksheet_calculate sub will detect changes in row visibility, but not columns, nor does it work in worksheet_change. Worksheet_SelectionChange seems buggy (selects more than selected even without code). Suggestions?</p>\n\n<pre><code>Public Function Copy_Hidden_ChargeCode_Descriptions(ByRef sht As String)\nOn Error GoTo ErrorHandler\n    Application.EnableEvents = False\n    If Worksheets(sht).Columns(\"C:G\").Hidden = False Then\n        If Not IsEmpty(Worksheets(sht).Range(\"H4\")) Then\n            Worksheets(sht).Range(\"H1\").Cut Worksheets(sht).Range(\"C1\")\n            Worksheets(sht).Range(\"H4:N9\").Cut Worksheets(sht).Range(\"C4:H9\")\n        End If\n    Else\n        If IsEmpty(Worksheets(sht).Range(\"H4\")) Then\n            Worksheets(sht).Range(\"C1\").Cut Worksheets(sht).Range(\"H1\")\n            Worksheets(sht).Range(\"C4:H9\").Cut Worksheets(sht).Range(\"H4:N9\")\n        End If\n    End If\n    Application.EnableEvents = True\nExit Function\n\nErrorHandler:\n    Debug.Print Err.Number, Err.Description\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1507122794, "post_id": 46565614, "comment_id": 80085169, "body": "Fastest way or more convenient way?"}, {"owner": {"reputation": 279, "user_id": 767102, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3acc6194ae647b222a4ac8eff551a69c?s=128&d=identicon&r=PG&f=1", "display_name": "NetTechie", "link": "https://stackoverflow.com/users/767102/nettechie"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1507199112, "post_id": 46565614, "comment_id": 80119489, "body": "Faster preferred!"}], "answers": [{"comments": [{"owner": {"reputation": 279, "user_id": 767102, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3acc6194ae647b222a4ac8eff551a69c?s=128&d=identicon&r=PG&f=1", "display_name": "NetTechie", "link": "https://stackoverflow.com/users/767102/nettechie"}, "edited": false, "score": 0, "creation_date": 1507199841, "post_id": 46565819, "comment_id": 80119941, "body": "Thanks @Vityata, this works :)  But just want to know if this could still be simplified..."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1507122752, "creation_date": 1507122752, "answer_id": 46565819, "question_id": 46565614, "link": "https://stackoverflow.com/questions/46565614/fastest-way-to-replace-a-character-in-string-in-vba/46565819#46565819", "title": "Fastest way to replace a character in string in VBA", "body": "<p>Something like this will work. It is not a lot simpler, but it looks simple:</p>\n\n<pre><code>Public Sub ReplaceString()\n\n    Dim strInput    As String\n    Dim lngFrom     As Long\n    Dim lngTo       As Long\n\n    strInput = \"$A$1:$AB$1200\"\n\n    lngFrom = InStr(2, strInput, \"$\")\n    lngTo = InStr(1, strInput, \":\")\n\n    Debug.Print Left(strInput, lngFrom) &amp; \"77\" &amp; Right(strInput, Len(strInput) - lngFrom-1)\n\nEnd Sub\n</code></pre>\n\n<p>It takes the left and the right positions of the string and puts in the middle the new value, in this case <code>77</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 279, "user_id": 767102, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3acc6194ae647b222a4ac8eff551a69c?s=128&d=identicon&r=PG&f=1", "display_name": "NetTechie", "link": "https://stackoverflow.com/users/767102/nettechie"}, "edited": false, "score": 0, "creation_date": 1507199260, "post_id": 46565843, "comment_id": 80119567, "body": "Sorry, I forgot to mention that the range in example &quot;$A$1:$AB$1200&quot; is a dynamic one / known only at run time.. I have no information, so I cannot apply offset. However, the solution is nice :)"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 279, "user_id": 767102, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3acc6194ae647b222a4ac8eff551a69c?s=128&d=identicon&r=PG&f=1", "display_name": "NetTechie", "link": "https://stackoverflow.com/users/767102/nettechie"}, "edited": false, "score": 0, "creation_date": 1507204544, "post_id": 46565843, "comment_id": 80122784, "body": "@NetTechie, you might need to explain your <i>actual</i> problem a bit better because from what I can tell this works perfectly with an unknown range -- see above edits as evidence"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 3, "last_activity_date": 1507204486, "last_edit_date": 1507204486, "creation_date": 1507122824, "answer_id": 46565843, "question_id": 46565614, "link": "https://stackoverflow.com/questions/46565614/fastest-way-to-replace-a-character-in-string-in-vba/46565843#46565843", "title": "Fastest way to replace a character in string in VBA", "body": "<p>This is pretty quick and very straight forward!</p>\n\n<pre><code>Sub test()\n    Dim s1 As String, s2 As String\n\n    s1 = \"$A$1:$AB$1200\"\n    s2 = Intersect(Range(s1), Range(s1).Offset(5, 0)).Address 'evaluates to $A$6:$AB$1200\nEnd Sub\n</code></pre>\n\n<p>As per your comments, here you can see it works perfectly well with a completely random range, only determined at runtime</p>\n\n<pre><code>Sub test()\n    Dim usdRange As String, usdRange2 As String\n    Dim lastRow As Long, lastCol As Long\n    lastRow = Application.WorksheetFunction.RandBetween(10, 100)\n    lastCol = Application.WorksheetFunction.RandBetween(1, 100)\n\n    usdRange = Range(\"A1\", Cells(lastRow, lastCol)).Address\n    usdRange2 = Intersect(Range(usdRange), Range(usdRange).Offset(5, 0)).Address\n\n    Debug.Print usdRange, usdRange2\nEnd Sub\n</code></pre>\n\n<p>Outputs the following, offsetting all ranges by the specified amount:</p>\n\n<pre><code>Old string    New string\n$A$1:$CF$22   $A$6:$CF$22\n$A$1:$AA$93   $A$6:$AA$93\n$A$1:$N$82    $A$6:$N$82\n</code></pre>\n"}], "owner": {"reputation": 279, "user_id": 767102, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3acc6194ae647b222a4ac8eff551a69c?s=128&d=identicon&r=PG&f=1", "display_name": "NetTechie", "link": "https://stackoverflow.com/users/767102/nettechie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "accepted_answer_id": 46565843, "answer_count": 2, "score": 1, "last_activity_date": 1507208316, "creation_date": 1507122182, "last_edit_date": 1507208316, "question_id": 46565614, "link": "https://stackoverflow.com/questions/46565614/fastest-way-to-replace-a-character-in-string-in-vba", "title": "Fastest way to replace a character in string in VBA", "body": "<p>I have a string (an excel range) something like \"$A$1:$AB$1200\".</p>\n\n<p>I need to replace the row of starting range (here, 1) to some other value, say, 6 (so string becomes  \"$A$6:$AB$1200\")</p>\n\n<p>I tried with below code, but it seems to getting too complicated</p>\n\n<pre><code> Dim stRng As String\n  stRng = Split(usdRange, \":\")(0)\n\n   Dim row2bRepl As Long\n   row2bRepl = Right(stRng, Len(stRng) - InStr(2, stRng, \"$\"))\n\n   usdRange = Replace(stRng, row2bRepl, hdrRow, InStr(2, stRng, \"$\"))\n</code></pre>\n\n<p>Any help on how to achieve this simpler?</p>\n\n<p>TIA!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1507121819, "post_id": 46565315, "comment_id": 80084445, "body": "This would be a good task for Regular Expressions (regex) to extract specific data. See <a href=\"https://regex101.com/r/0BMJQK/1\" rel=\"nofollow noreferrer\">regex101.com/r/0BMJQK/1</a> for an example of how a pattern could look like. There are also <a href=\"https://stackoverflow.com/search?q=Regular+Expressions+VBA+excel\">many examples</a> on Stack Overflow how to use Regular Expressions in VBA."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507123893, "post_id": 46565315, "comment_id": 80085991, "body": "Or perhaps the <code>Find</code> method will serve your purposes. Either way, have a go, post your code if you get stuck and you can get specific advice."}], "owner": {"reputation": 1, "user_id": 8719506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rm2vd.jpg?s=128&g=1", "display_name": "anna", "link": "https://stackoverflow.com/users/8719506/anna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507121299, "creation_date": 1507121299, "question_id": 46565315, "link": "https://stackoverflow.com/questions/46565315/import-selected-data-from-multiple-text-files-into-single-excel-worksheet", "title": "Import selected data from multiple text files into single excel worksheet", "body": "<p>I would really appreciate some help with this. I've tried code from similar examples but I have not been able to bend existing solutions to my will...</p>\n\n<p>My problem:\nI have hundreds of textfiles with analysis results where I need specific data extracted into a single excel worksheet for further processing.</p>\n\n<p>If you look at the example txt: \n\"Hemoglobin: [20.3 - 37.7] mg/dL    IL Threshold: 500.00000000  User Threshold: 70.00000000\n\" (way down in the file).\nI need this information copied to a worksheet, in space and tab separated columns I guess, to get the interval numbers in separate cells for further processing. </p>\n\n<p>For all files in the same folder I want this information extracted and put in the same worksheet. (A bonus would be to have the filename copied to a cell prior or after the information for traceability).</p>\n\n<p>I used <a href=\"https://stackoverflow.com/questions/37220488/importing-data-from-multiple-text-files-into-excel-vba\">this</a> example from stackoverflow to get the whole line extracted, but I'm stuck on getting the interval numbers into separate cells.</p>\n\n<p>Very thankful for any help with this.</p>\n\n<p>/anna</p>\n\n<pre><code>************************ DR INTERMEDIATE RESULTS REPORT v2.2 ************************\n\nRAW DATA REPORT\n\n#Date-Of-Report: 2017-10-03 13:57:55\n#SampleID: 081394260022\n#Test: APTT-SS  Test Release: 7.7\n#Type: Patient\n#AquisitionMode: Standard\nNot a Shadow/Parent Not a Paired Test\nReport generated by: bma    [23]\n\nINTERMEDIATE VALUES FOR SINGLE DETERMINATION (PRIMARY WAVELENGTH)\n\n#Wavelength: 671nm-Red  #SampleRate: 1\n#ORUChannel: 0  #ORUHead: 0\n#AMErrors: 0\n#Concentration: 0   #Determination: 0   Delay Points: 160   \n\nORU Blank Value: 0.93298700\n\n\n#Time   AM_Data Flags   Raw Normalized  Deriv1  Deriv2  \n-----   ------- -----   --- ----------  ------  ------  \n    ...\n\n#End\n\n\nJOB DATA\nJob UID: &lt;1506076487_192670&gt;    Sample UID:  &lt;1506075157_192475&gt;    Test UID:  &lt;1409942324_1953&gt;\nMaterial UID:  &lt;0_0&gt;    Quality Control UID: &lt;0_0&gt;\n#SampleID: 081394260022 #Test: APTT-SS  #Type   Test Release: 7.7\nWavelength: 671nm-Red   EndOfDelay - Time:  16.00000000 Acquisition Time: 120.00000000  #AquisitionMode Standard\n#Type: Patient\n\nLot Type: Unknown lot   Lot Status: Active Lot\n\nCalibration UID: &lt;0_0&gt; Finish Date \nMaster Calibration UID: &lt;0_0&gt; Finish Date \nPaired Master UID: &lt;0_0&gt; Finish Date \nRerun Master UID: &lt;0_0&gt; Finish Date \nNormalPoolPlasma UID: &lt;0_0&gt; Finish Date \n\nTracking materials: 2\nMaterial: APTT-SS   Mat Def UID: &lt;1409942324_1792&gt;  Vial: &lt;1505888472_171077&gt;\n    Type: Reagent   Lot ID: N1065660    Expiration Date: 2018-10-31 23:59:59\n\nMaterial: APTT-SS CaCl2 Mat Def UID: &lt;1409942324_1793&gt;  Vial: &lt;1505975574_181431&gt;\n    Type: Reagent   Lot ID: N1065543    Expiration Date: 2019-10-31 23:59:59\n\n\nUser Revision:  Order Date: 2017-09-22 12:34:47 Finish Date: \nPriority: Normal    Job Status: Complete    Persistent Job Status: Complete\nTrack: 09   Is CTS: 0   Is TFH: 0   Slot: 5 AM: 1   Rack Area: Sample   Position: 0\nHighest Error: --\nAdded by: user\nDisplay Clot Curves as Primary Wavelength: Normalized   Y Axis Setup    [0.000 - 3000.000]  AutoScale   Enabled\n    Smooth with degree: 11  5   3   \nNormalization is: Normalize using absorbance\n\nCompleted Date: 2017-09-22 12:40:46 Calculated Date: 2017-09-22 12:40:46\nValidated Date: 2017-09-22 12:40:46 Verifier: bma\nResult Status   OK  Validation Status: OK\nUpload Status: Uploaded Print Status: Not printed\n\n\nPrecision: 3    \nTest Range: [-999999.999 - 999999.999]\nNPP Mode:   User input valueNormal Pool Value: Result: 0.00000000   s\n    Normal Range: Disabled\n    Test Range: [16.000 - 120.000]\n\nCalibration:    Result Status   Undefined\nCalibrated Delta Check: 0.00000000\nOverall Calibration (all segments) Result Status    FAILED Segment Cut Off: 0.00000000\nCalibration curve results computed with following axis configuration\n    Calibration Results along X axis, Measured Results along Y axis\nOverall Calibration (all segments)\n *** Calibration Results used in Parallelism ***\n    with x transformation:  X=X\n    with Y transformation:  Y=Y\nResult Status   Undefined\nthis model failed estimation due to Indetermination error\n\n\n\nHIL Results\n    TestCode: APTT-SS   Completed Date: 2017-09-22 12:38:52 Status: OK\n    Hemoglobin: [20.3 - 37.7] mg/dL IL Threshold: 500.00000000  User Threshold: 70.00000000\n    Bilirubin: [0.6 - 1.2] mg/dL    IL Threshold: 26.00000000   User Threshold: Disabled\n    Lipemia: [44.8 - 54.7] mAbs IL Threshold: 4886.00000000 User Threshold: Disabled\n\n\nConcentration: 1    Concentration: 100.00000000 Liquid Name     Target: 100.00000000\nDetermination: 1    Completed Date: 2017-09-22 12:40:46\nPrimary Wavelength  Determination Wavelength Results\nMeasuredResultResult: 29.10000000   s\n    Normal Range: [-999999.900 - 999999.900]\n    Test Range: [16.000 - 120.000]\n\nUpperClotPoint: Has not been established    ClotPoint: 131.00000000\n\nResult: 29.10000000 s\n    Normal Range: [-999999.900 - 999999.900]\n    Test Range: [16.000 - 120.000]\n\n\nFirst deriv peak max: 207.76553401  Second deriv peak max: 849.28084124 Second deriv peak min: -408.66120386\n\nPrimary Wavelength  Concentration Wavelength Results\n\nMeasuredResult  %CV:    Failed\nResult: 29.10000000 s\n    Normal Range: [-999999.900 - 999999.900]\n    Test Range: [16.000 - 120.000]\n\nResult: 29.10000000 s\n    Normal Range: [-999999.900 - 999999.900]\n    Test Range: [16.000 - 120.000]\n\nCalibration Result Result: Undefined    \n    Normal Range: Disabled\n    Test Range: Disabled\n\n\nREPORTABLE RESULTS FOR JOB\n\nHighest Error: --\n\n\nResult: 29.10000000 s\n    Normal Range: [-999999.900 - 999999.900]\n    Test Range: [16.000 - 120.000]\n\n\nErrors and Warnings:\n    NONE\n</code></pre>\n"}, {"tags": ["vba", "type-conversion", "coercion", "type-coercion"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1507121303, "post_id": 46565072, "comment_id": 80084073, "body": "<code>Len()</code> returns an integer value, not a boolean. Yes, <code>False</code> in VBA is a zero, but it is not in good form to code in this manner."}], "answers": [{"comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1611140739, "post_id": 65808008, "comment_id": 116352962, "body": "Be careful, your links lead to VB.Net, not VBA"}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1611142599, "post_id": 65808008, "comment_id": 116353847, "body": "@FunThomas thanks for pointing that out."}, {"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 1, "creation_date": 1611591864, "post_id": 65808008, "comment_id": 116495497, "body": "@Dean no one gave good answer to my &quot;bounty&quot;. FunThomas and GSerg narrowed down title&#39;s topic only to the simplest well-documented cases. Even question&#39;s authors Roland wrote that &quot;The question is about any two types&quot;. But I must choose the answer to reward. Your answer isn&#39;t good too, but you linked some very interesting off-topic links and the bounty is yours."}], "tags": [], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "is_accepted": false, "score": -2, "last_activity_date": 1611142590, "last_edit_date": 1611142590, "creation_date": 1611139693, "answer_id": 65808008, "question_id": 46565072, "link": "https://stackoverflow.com/questions/46565072/what-are-the-implicit-type-conversion-rules-in-vba/65808008#65808008", "title": "What are the implicit type conversion rules in vba?", "body": "<p>I came across this in a recent textbook I was reading on C++ - I'll add a link at the end. Although a different language, both have similarities to some degree. One of these similarities is what you call 'implicit type conversion' or more technically, type casting.</p>\n<p>For any Boolean expression in your project when you compile your VBA project (Debug &gt; Compile VBAProject) any nonzero value will be treated as the value <code>true</code> and will treat the value 0 as <code>false</code>. Essentially this comes down to the how the compiler treats these statesments and also to operator precedence rules as well as boolean expression rules.</p>\n<p>For further reading please see below links:</p>\n<ol>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/operator-precedence\" rel=\"nofollow noreferrer\">Operator precedence</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/boolean-data-type\" rel=\"nofollow noreferrer\">Boolean data type</a></li>\n</ol>\n<p>In C++ (as far as I am aware) this term is called copy initialisation, you can read more here:</p>\n<ol>\n<li><a href=\"https://en.cppreference.com/w/cpp/language/copy_initialization\" rel=\"nofollow noreferrer\">Copy initialization</a></li>\n</ol>\n<p>The book that brought this deep thought recently:</p>\n<p><a href=\"https://www.goodreads.com/book/show/2545938.Problem_Solving_with_C_\" rel=\"nofollow noreferrer\">Problem Solving with C++: The Object of Programming</a></p>\n<p>I know this doesn't necessarily answer your question, but hopefully some of the references help.</p>\n"}, {"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 2, "creation_date": 1611142808, "post_id": 65808228, "comment_id": 116353950, "body": "<i>A boolean variable can have only two states ... an implementation detail and your programming should not care about it</i> - unless you <a href=\"https://stackoverflow.com/q/59310779/11683\">have to</a>."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1611143599, "post_id": 65808228, "comment_id": 116354329, "body": "@GSerg: Good catch - was not aware about it. Frankly, this seems to be a bug in VBA (and I am usually not that quick with such a statement), because the result in that example manage to write a <code>1</code> into a boolean variable - and that&#39;s against it&#39;s definition."}, {"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1611233259, "post_id": 65808228, "comment_id": 116388026, "body": "InputBox returns False if cancelled: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.inputbox\" rel=\"nofollow noreferrer\">Microsoft documentation</a>. So what&#39;s the road from click Cancel on InputBox to return &quot;Falsch&quot; string <a href=\"https://stackoverflow.com/questions/55453256/vba-inputbox-and-cancel-button\">german problem here on SO</a>? How regional setting are involved into this ridiculous result or/and casting? Bool&lt;-&gt;Long casting is quite obvious here, but what about Bool&lt;-&gt; String like False = &quot;False&quot; and given &quot;Falsch&quot; case?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1611233736, "post_id": 65808228, "comment_id": 116388256, "body": "Problem with the InputBox that is returns either a boolean value (False) or a string containing whatever was entered. Read the result into a Variant and check the VarType (see accepted answer) so that you can distinguish between Cancel and entering something like &quot;0&quot;. This avoids the implicit conversion from a boolean into a string."}, {"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1611234230, "post_id": 65808228, "comment_id": 116388493, "body": "I know the solution in that case. I am just asking HOW could be False casted to string &quot;Falsch&quot; it&#39;s very strange to me... Is Bool-&gt;String casting documented or not? BTW thanks for your effort."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1611235197, "post_id": 65808228, "comment_id": 116388986, "body": "I guess the implicit conversion result within VBA is the same as using it explicitly (<code>cStr</code>), and that should always result in the English terms as VBA is not language dependent. However, as the called function is a method of the <code>Application</code>-object (which is Excel, not VBA), maybe the conversion is done already within the function. But that&#39;s only guessing, I cannot test it because although I live in Germany, my Office is English."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1611235983, "post_id": 65808228, "comment_id": 116389372, "body": "@Rafa\u0142B. That question appears to be based on a wrong premise. Pressing Cancel on <code>Application.InputBox</code> returns Variant/Boolean, not a string."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1611236069, "post_id": 65808228, "comment_id": 116389427, "body": "@FunThomas <code>CStr</code> is specifically language-dependent and will use the current locale&#39;s number and/or date formatting. It does not, however, attempt to localise True and False."}, {"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1611236282, "post_id": 65808228, "comment_id": 116389538, "body": "@GSerg When the &#39;answer&#39; variable (ans = InputBox()) is String type (not Variant), then we get ans = &quot;False&quot; after cancel. But someone can get &quot;Falsch&quot; here. Isn&#39;t it implicite casting from boolean (False)? If my question would be InputBox-related I wouldn&#39;t ask in &quot;What are the implicit type conversion rules in vba?&quot; thread I think."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1611236611, "post_id": 65808228, "comment_id": 116389727, "body": "@Rafa\u0142B. It is. And it uses <code>CStr(False)</code>, which returns <code>&quot;False&quot;</code> even in non-English Excel on non-English locale. If you have access to a system where <code>CStr(False)</code> produces something else, I would be willing to know about that."}, {"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1611237247, "post_id": 65808228, "comment_id": 116390087, "body": "I&#39;ve just heard about this problem on one Polish Excel board. It sounded incredible for me too (!) so I searched over the internet and found similar thread on SO, that I&#39;ve linked above. That&#39;s why I&#39;ve started bounty because I cannot get to understand what&#39;s happening here. I&#39;ll ask the user experiencing a problem to check what MsgBox VBA.CStr(False) shows on his PC."}, {"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "edited": false, "score": 0, "creation_date": 1611251730, "post_id": 65808228, "comment_id": 116397663, "body": "1) MsgBox VBA.CStr(False) shows string <i>False</i> in the test described above 2) someone gave a screenshot from <i>Excel 2007 VBA Programmer&#39;s Reference</i> by John Green et al.  which have a slightly suggestion that it DOES NOT use inbuilt Cstr such and it returns bool name taken from <i>Windows Regional Settings</i> not VBA itself  like running <code>MsgBox Prompt:=False</code>. Ok, and my final conclusion at the moment is: it seems that the casting result may depends on system, this implicit conversion (assignation boolean to string) should be avoid because is not reliable and also IS NOT documented by Microsoft."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 2, "last_activity_date": 1611141985, "last_edit_date": 1611141985, "creation_date": 1611140500, "answer_id": 65808228, "question_id": 46565072, "link": "https://stackoverflow.com/questions/46565072/what-are-the-implicit-type-conversion-rules-in-vba/65808228#65808228", "title": "What are the implicit type conversion rules in vba?", "body": "<p>A <code>boolean</code> variable can have only two states, <code>True</code> and <code>False</code>. That's true in all programming languages (except if a nullable datatype exists, eg <code>bool?</code> in C# where the variable can have also the value <code>null</code> signaling it is not defined).</p>\n<p>In VBA, a boolean is stored as 16-bit integer. <code>False</code> is defined as 0 and <code>True</code> as -1. Thats similar in other languages, simply because 0 has all bits set to 0 and -1 has all bits set to 1. But this is an implementation detail and your programming should not care about it. You deal with <code>True</code> and <code>False</code> and Boolean algebra using <code>AND</code>, <code>OR</code> and <code>NOT</code>.</p>\n<p>Implicit conversion rules are straight forward: Numeric data types are converted to boolean <code>False</code> if they are 0 and to <code>True</code> in all other cases (that is, if the value has <em>any</em> bit set to 1). Converting a boolean value to a number results in 0 resp. -1.</p>\n<pre><code>Dim i As Integer\nDim b As Boolean    \ni = 3\nb = i   ' Implicit conversion from 3 to TRUE\ni = b   ' Implicit conversion from TRUE to -1\n</code></pre>\n<p>Strings are converted to numbers first, and if that fails, you get a runtime error. Dates are implemented as numbers (Double) in VBA, so every date/time is <code>True</code> except the date+time that is represented as 0 (that is 30 Dec 1899 00:00)</p>\n<p>But from my point of view (and &gt;30 years of programming), <strong>implicit conversions are evil and should be avoided</strong>. They are source of numerous errors, they lead to code that is harder to read - and there is simply no reason to rely on implicit conversations. There is no reason to write <code>If len(str) Then</code>. You want to check if the length of a string is greater than 0, so write it: <code>If len(str) &gt; 0 Then</code>. Always.</p>\n<p>Have a look to the following example: Obviously, the VBA runtime need to execute an implicit conversion, but can you tell the outcome?</p>\n<pre><code>Dim i As Integer\nDim b As Boolean  \ni = 3\nb = i\nIf b = i Then Debug.Print &quot;B=I&quot;\n</code></pre>\n<hr />\n<p>Here you can find the official documentation from Microsoft: <a href=\"https://docs.microsoft.com/en-US/office/vba/language/reference/user-interface-help/boolean-data-type\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-US/office/vba/language/reference/user-interface-help/boolean-data-type</a></p>\n"}], "owner": {"reputation": 6420, "user_id": 480894, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5449cd50eb589e8be56164de5584057c?s=128&d=identicon&r=PG", "display_name": "Roland", "link": "https://stackoverflow.com/users/480894/roland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1611142846, "creation_date": 1507120677, "question_id": 46565072, "link": "https://stackoverflow.com/questions/46565072/what-are-the-implicit-type-conversion-rules-in-vba", "title": "What are the implicit type conversion rules in vba?", "body": "<p>I know the following is possible in vba:</p>\n\n<pre><code>If Len(str) Then\n</code></pre>\n\n<p><code>Len(str)</code> will evaluate to <code>false</code> if <code>Len(str)</code> is <code>0</code>, <code>true</code> otherwise.</p>\n\n<p>What are the exact conversion rules for vba? Please provide a link to official documentation if possible.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1507120008, "post_id": 46564724, "comment_id": 80083148, "body": "&quot;<i>\u2026 but have an issue when \u2026</i>&quot; is a completely useless error description as you can imagine. Be detailed in what is working and what is going wrong. Do you get any errors if so which errors and in which line of code. Describe what your code does and what you expect (<b>be very exactly</b>). If possible provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Please <a href=\"https://stackoverflow.com/posts/46564724/edit\">edit</a> your original question to improve it and add all the details."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1507126419, "post_id": 46564724, "comment_id": 80087799, "body": "Agree with Peh. Many questions are thrown in without much detail and a LOT of code. The asker is then expecting a complete and error-free code on reply."}, {"owner": {"reputation": 25, "user_id": 8640156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79db2e97871a62814475215158d90095?s=128&d=identicon&r=PG&f=1", "display_name": "Hazat Bangurah", "link": "https://stackoverflow.com/users/8640156/hazat-bangurah"}, "edited": false, "score": 0, "creation_date": 1507132178, "post_id": 46564724, "comment_id": 80091862, "body": "Sorry about the confusion, it was hard when thinking about asking the right way. My goal is to be able to adjust for the table in my worksheet data needing more or less rows based on the lastrow of the new source data. I have had some success working the code since I posted this I will post a more clearer follow up soon."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1507186037, "post_id": 46564724, "comment_id": 80111678, "body": "@HazatBangurah You still only tell us what you want/need, but that&#39;s not what we need to know. We need to know what is not working in your code that you have tried. If we don&#39;t know what&#39;s wrong then we can&#39;t tell you how to correct it."}], "owner": {"reputation": 25, "user_id": 8640156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79db2e97871a62814475215158d90095?s=128&d=identicon&r=PG&f=1", "display_name": "Hazat Bangurah", "link": "https://stackoverflow.com/users/8640156/hazat-bangurah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507119574, "creation_date": 1507119574, "question_id": 46564724, "link": "https://stackoverflow.com/questions/46564724/vba-adjusting-for-last-row", "title": "VBA Adjusting for last row", "body": "<p>I have a workbook in which I have created a macro for 9 different worksheets and while working properly I want to be able to add code for the <strong>last row</strong> So I can either Insert or Delete rows depending on need. I was able to do this for one worksheet but have an issue when I apply the same technique for others. What could be the issue with applying the code to multiple worksheets? The top portion of the code is what I am attempting to use to assign the last row function and the bottom is a sample worksheet I am attempting to add last row code.</p>\n\n<pre><code>Dim LastRowT As Long, LastRowS As Long\nDim wks1    As Worksheet\nDim wks2    As Worksheet\n\nSet wks2 = Workbooks(\"UMROI_Standard Cost Audit Reports.xlsm\").Worksheets(\"Before n After Remap Review\")\nSet wks1 = Workbooks(\"before_n_after_remap_audit_umroi.txt\").Worksheets(\"before_n_after_remap_audit_umro\")\n\nLastRowS = Workbooks(\"before_n_after_remap_audit_umroi.txt\").Worksheets(\"before_n_after_remap_audit_umro\").Range(\"A:E\").Find(\"*\", , xlValues, xlPart, xlByRows, xlPrevious, False).Row\nLastRowS = Workbooks(\"before_n_after_remap_audit_umroi.txt\").Worksheets(\"before_n_after_remap_audit_umro\").Range(\"F:G\").Find(\"*\", , xlValues, xlPart, xlByRows, xlPrevious, False).Row\nLastRowT = Workbooks(\"UMROI_Standard Cost Audit Reports.xlsm\").Worksheets(\"Before n After Remap Review\").Range(\"A:E\").Find(\"*\", , xlValues, xlPart, xlByRows, xlPrevious, False).Row\nLastRowT = Workbooks(\"UMROI_Standard Cost Audit Reports.xlsm\").Worksheets(\"Before n After Remap Review\").Range(\"I:J\").Find(\"*\", , xlValues, xlPart, xlByRows, xlPrevious, False).Row\n\n\nRange(\"A9:F147\").Select\nSelection.ClearContents\nWorkbooks.OpenText Filename:= _\n    \"K:\\1900\\dwprod1900\\data\\export\\general\\ent_component_audit_umroi.txt\", Origin _\n    :=437, StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote _\n    , ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:= _\n    False, Space:=False, Other:=False, FieldInfo:=Array(Array(1, 2), Array(2, 1) _\n    , Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1), Array(8, 1)), _\n    TrailingMinusNumbers:=True\nRange(\"A1:F139\").Select\nSelection.Copy\nWindows(\"UMROI_Standard Cost Audit Reports.xlsm\").Activate\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n Windows(\"ent_component_audit_umroi.txt\").Activate\nApplication.CutCopyMode = False\nActiveWindow.Close\n</code></pre>\n"}, {"tags": ["excel", "vba", "named-ranges"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1507119512, "post_id": 46564579, "comment_id": 80082751, "body": "You need a.Sheets(), b.Sheets() etc... like you do on the left hand side \u2014 rather than a.Application, b.Application, etc..."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8719787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a3ddc4bc0e9901171b6b01af1163b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff D.", "link": "https://stackoverflow.com/users/8719787/jeff-d"}, "edited": false, "score": 0, "creation_date": 1507128585, "post_id": 46564817, "comment_id": 80089476, "body": "This combined with CallumDA resolved my problem.  Thanks for the support."}, {"owner": {"reputation": 1093, "user_id": 7814526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/leMzB.png?s=128&g=1", "display_name": "JensS", "link": "https://stackoverflow.com/users/7814526/jenss"}, "reply_to_user": {"reputation": 3, "user_id": 8719787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a3ddc4bc0e9901171b6b01af1163b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff D.", "link": "https://stackoverflow.com/users/8719787/jeff-d"}, "edited": false, "score": 0, "creation_date": 1507128705, "post_id": 46564817, "comment_id": 80089563, "body": "Excellent. Could you then please accept the answer to close the question."}], "tags": [], "owner": {"reputation": 1093, "user_id": 7814526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/leMzB.png?s=128&g=1", "display_name": "JensS", "link": "https://stackoverflow.com/users/7814526/jenss"}, "is_accepted": true, "score": 0, "last_activity_date": 1507119879, "creation_date": 1507119879, "answer_id": 46564817, "question_id": 46564579, "link": "https://stackoverflow.com/questions/46564579/excel-vba-copy-from-various-workbooks-named-range-to-one-recap-workbook/46564817#46564817", "title": "Excel VBA - Copy from various workbooks named range to one &quot;recap&quot; workbook", "body": "<p>This would work under the assumption that the ranges are on the first sheet:</p>\n\n<pre><code>ThisWorkbook.Sheets(\"Data\").Range(\"C3\") = a.Sheets(1).Range(\"Project1_Total\")\nThisWorkbook.Sheets(\"Data\").Range(\"D3\") = b.Sheets(1).Range(\"Project2_Total\")\nThisWorkbook.Sheets(\"Data\").Range(\"E3\") = c.Sheets(1).Range(\"Project3_Total\")\n</code></pre>\n\n<p>I assumed that you didn't want to overwrite C3 multiple times. If you don't know which sheet the ranges are on, you could use <code>find</code> to find a range in a workbook.</p>\n"}], "owner": {"reputation": 3, "user_id": 8719787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85a3ddc4bc0e9901171b6b01af1163b8?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff D.", "link": "https://stackoverflow.com/users/8719787/jeff-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 46564817, "answer_count": 1, "score": -1, "last_activity_date": 1507130966, "creation_date": 1507119128, "last_edit_date": 1507130966, "question_id": 46564579, "link": "https://stackoverflow.com/questions/46564579/excel-vba-copy-from-various-workbooks-named-range-to-one-recap-workbook", "title": "Excel VBA - Copy from various workbooks named range to one &quot;recap&quot; workbook", "body": "<p>Hi everyone and thanks in advance for your time.</p>\n\n<p>I am not a huge specialist in vba but sometimes it helps me to gain some good times on repetitive tasks I am working on.</p>\n\n<p>I would like to gathered information from various files to one \"recap\" file.\nI named some ranges (one cell each) to ease the lookup for the these informations in all the files.</p>\n\n<hr>\n\n<p>Here are the lines I began to write:</p>\n\n<pre><code>Sub collectdata()\n  Set a = Workbooks.Open(\"C:\\full address\\Project1.xlsx\")\n  Set b = Workbooks.Open(\"C:\\full address\\Project2.xlsx\")\n  Set c = Workbooks.Open(\"C:\\full address\\Project3.xlsx\")\n\n  ThisWorkbook.Sheets(\"Data\").Range(\"C3\") = a.Application.Range(\"Project1_Total\")\n  ThisWorkbook.Sheets(\"Data\").Range(\"C3\") = b.Application.Range(\"Project2_Total\")\n  ThisWorkbook.Sheets(\"Data\").Range(\"C3\") = c.Application.Range(\"Project3_Total\")\n\n  a.Close savechanges:=False\n  b.Close savechanges:=False\n  c.Close savechanges:=False\nEnd Sub\n</code></pre>\n\n<p>I am stuck with error 1004.  I think I know why but I don't know how to correct that.</p>\n\n<p>With one \"project\" everything everything is okay.<br>\nBut once I add a second file I get Error 1004.</p>\n\n<p>With one named range from one project it is okay.\nBut once I add a second named range from the same file I get Error 1004.</p>\n\n<p>Thanks for your time.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507118635, "post_id": 46564223, "comment_id": 80082084, "body": "<code>MyRange</code> is not defined as any of the sheets referred to below (in fact no sheet is specified) so that is probably the problem. Do you mean you want the results to start in M10?"}, {"owner": {"reputation": 3, "user_id": 8719822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e6ab4b1d1a7fbccbdc69b9fafad1c79?s=128&d=identicon&r=PG&f=1", "display_name": "Belgium_Fries", "link": "https://stackoverflow.com/users/8719822/belgium-fries"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507118816, "post_id": 46564223, "comment_id": 80082213, "body": "I use a userform to input the serial number in a textbox and then I select the correct car via a rollbox (both in the same userform). So now I would like the serial numbers to start in the correct worksheet at M10, for all cars."}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1507119701, "last_edit_date": 1507119701, "creation_date": 1507119184, "answer_id": 46564604, "question_id": 46564223, "link": "https://stackoverflow.com/questions/46564223/putting-values-in-the-next-free-cell-in-a-specific-sheet/46564604#46564604", "title": "Putting values in the next free cell in a specific sheet", "body": "<p>Try this. You can shorten your code as you are doing the same thing in each case and your sheet names correspond with the combobox list.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n\nDim emptyRow As Long\n\nemptyRow = WorksheetFunction.Max(10, Sheets(ComboBox1.Value).Range(\"M\" &amp; Rows.Count).End(xlUp).Row + 1)\n\nSheets(ComboBox1.Value).Cells(emptyRow, \"M\").Value = serial_textbox.Text\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8725474, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155837122924954/picture?type=large", "display_name": "Andrewse20", "link": "https://stackoverflow.com/users/8725474/andrewse20"}, "is_accepted": false, "score": 0, "last_activity_date": 1507198109, "last_edit_date": 1507198109, "creation_date": 1507197281, "answer_id": 46582755, "question_id": 46564223, "link": "https://stackoverflow.com/questions/46564223/putting-values-in-the-next-free-cell-in-a-specific-sheet/46582755#46582755", "title": "Putting values in the next free cell in a specific sheet", "body": "<p>How about this:</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n\nDim emptyRow As Long\nDim MyRange As Range\nDim wsSheet As Excel.Worksheet\n\nSet wsSheet = ThisWorkbook.Worksheets(ComboBox1.Value)\nSet MyRange = wsSheet.Range(\"M:M\")\n\nemptyRow = Application.WorksheetFunction.CountA(MyRange) + 1\nwsSheet.Cells(emptyRow, 1).Value = serial_textbox.Text\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8719822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e6ab4b1d1a7fbccbdc69b9fafad1c79?s=128&d=identicon&r=PG&f=1", "display_name": "Belgium_Fries", "link": "https://stackoverflow.com/users/8719822/belgium-fries"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 46564604, "answer_count": 2, "score": 0, "last_activity_date": 1507198109, "creation_date": 1507118109, "last_edit_date": 1507128156, "question_id": 46564223, "link": "https://stackoverflow.com/questions/46564223/putting-values-in-the-next-free-cell-in-a-specific-sheet", "title": "Putting values in the next free cell in a specific sheet", "body": "<p>I need to make a VBA program that can put serial numbers in a list in a specific worksheet based on what the user enters via the rollbox. </p>\n\n<p>This is what I have now:</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    Dim emptyRow As Long\n    Dim MyRange As Range\n\n    Set MyRange = Range(\"M:M\")\n\n    emptyRow = Application.WorksheetFunction.CountA(MyRange) + 1\n\n    If ComboBox1.Value = \"BMW\" Then Sheets(\"BMW\").Cells(emptyRow, 1).Value = serial_textbox.Text\n    If ComboBox1.Value = \"AUDI\" Then Sheets(\"AUDI\").Cells(emptyRow, 1).Value = serial_textbox.Text\n    If ComboBox1.Value = \"VW\" Then Sheets(\"VW\").Cells(emptyRow, 1).Value = serial_textbox.Text\n    If ComboBox1.Value = \"Porsche\" Then Sheets(\"Porsche\").Cells(emptyRow, 1).Value = serial_textbox.Text\n    If ComboBox1.Value = \"Lamborghini\" Then Sheets(\"Lamborghini\").Cells(emptyRow, 1).Value = serial_textbox.Text\nEnd Sub\n</code></pre>\n\n<p>Unfortunately, it only enters the values in A1 (in the correct sheet) and pasts it over each other.</p>\n"}, {"tags": ["date", "ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1507119659, "creation_date": 1507119659, "answer_id": 46564754, "question_id": 46564063, "link": "https://stackoverflow.com/questions/46564063/ms-access-vba-form-date-picker-written-in-access-2003-inoperable-in-access-2016/46564754#46564754", "title": "MS Access VBA form date picker written in Access 2003 inoperable in Access 2016 please advise how to convert or make this work in Access 2016", "body": "<p>Oh my - that code needs a thorough clean-up. <em>Never</em> use string handling for date manipulations, no exceptions.</p>\n\n<p>As for the date picker - it is built-in in newer Access versions. Just set a date format for the textbox, and a small button is shown at the right which opens the date picker.</p>\n\n<p>Then trash the old ActiveX control.</p>\n"}], "owner": {"reputation": 191, "user_id": 3531893, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7425ce0efe6a53ae48d1cc6aff5636cf?s=128&d=identicon&r=PG&f=1", "display_name": "Derek", "link": "https://stackoverflow.com/users/3531893/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594639001, "creation_date": 1507117683, "last_edit_date": 1594639001, "question_id": 46564063, "link": "https://stackoverflow.com/questions/46564063/ms-access-vba-form-date-picker-written-in-access-2003-inoperable-in-access-2016", "title": "MS Access VBA form date picker written in Access 2003 inoperable in Access 2016 please advise how to convert or make this work in Access 2016", "body": "<p>I am on Windows 10 and running 32 bit Office 2016.</p>\n\n<p>When I try to execute this piece of code:</p>\n\n<pre><code>Private Sub Form_Load() \n    If DatePart(\"ww\", Format(\"01/\" &amp; Month(Date) &amp; \"/\" &amp; Year(Date), \"dd/mm/yyyy\", vbUseSystemDayOfWeek), vbThursday) = DatePart(\"ww\", Date, vbThursday) Then\n        FromDate.Value = Format(\"01/\" &amp; Month(Date) - 1 &amp; \"/\" &amp; Year(Date), \"dd/mm/yyyy\")\n        ToDate.Value = DateAdd(\"d\", -1, Format(\"01/\" &amp; Month(Date) &amp; \"/\" &amp; Year(Date), \"dd/mm/yyyy\"))\n    Else\n        FromDate.Value = Format(\"01/\" &amp; Month(Date) &amp; \"/\" &amp; Year(Date), \"dd/mm/yyyy\")\n        ToDate.Value = DateAdd(\"d\", -1, Format(\"01/\" &amp; Month(Date) + 1 &amp; \"/\" &amp; Year(Date), \"dd/mm/yyyy\"))\n    End If\n    If CountRows(\"rpt_all_hours\") &gt; 0 Then\n        cmdClearTable.Enabled = True\n        ViewTable.Enabled = True\n    Else\n        cmdClearTable.Enabled = False\n        ViewTable.Enabled = False\n    End If\nEnd Sub\n</code></pre>\n\n<p>I get an error:</p>\n\n<blockquote>\n  <p>Run Time Error 2683 there is no object in this control</p>\n</blockquote>\n\n<p>The code stops at this line:</p>\n\n<pre><code>FromDate.Value = Format(\"01/\" &amp; Month(Date) - 1 &amp; \"/\" &amp; Year(Date),\"dd/mm/yyyy\")\n</code></pre>\n\n<p>I also got an Active X error when importing the form into an Access 2016 database from an <code>.mdb</code> file:</p>\n\n<blockquote>\n  <p>There was an error loading an ActiveX control on one of your forms or reports.</p>\n</blockquote>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1507116616, "post_id": 46563584, "comment_id": 80080841, "body": "Why not use loops to cut down on the repetitious code?"}, {"owner": {"reputation": 15, "user_id": 8719678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9640b3c2d7485f748fe2bb50bd5070e3?s=128&d=identicon&r=PG&f=1", "display_name": "Guaca24", "link": "https://stackoverflow.com/users/8719678/guaca24"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1507116808, "post_id": 46563584, "comment_id": 80080964, "body": "Still fairly new to inserting code into Excel...most of the code is stuff I found online"}], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 0, "last_activity_date": 1507118579, "creation_date": 1507118579, "answer_id": 46564390, "question_id": 46563584, "link": "https://stackoverflow.com/questions/46563584/using-a-clear-button-to-clear-cells-checkboxes-and-comboboxes-in-a-separate-wo/46564390#46564390", "title": "Using a clear button to clear cells, checkboxes, and comboboxes in a separate workbook", "body": "<p>What you could do is to create a sub with a workbook parameter that clears the passed workbook. Something like:</p>\n\n<pre><code>Sub ClearWorkBook(wb As Workbook)\n    Dim Shp As Shape\n\n    wb.Sheets(\"Sheet1\").ComboBox172.Text = \"-\"\n    wb.Sheets(\"Sheet1\").ComboBox174.Text = \"-\"\n    wb.Sheets(\"Sheet1\").ComboBox175.Text = \"-\"\n\n    wb.Sheets(\"Sheet1\").CheckBox1.Value = False\n    wb.Sheets(\"Sheet1\").CheckBox2.Value = False\n    wb.Sheets(\"Sheet1\").CheckBox3.Value = False\n\n    wb.Sheets(\"Sheet1\").TextBox1.Text = \"\"\n    wb.Sheets(\"Sheet1\").TextBox2.Text = \"\"\n    wb.Sheets(\"Sheet1\").TextBox3.Text = \"\"\n    wb.Sheets(\"Sheet1\").TextBox4.Text = \"\"\n    wb.Sheets(\"Sheet1\").TextBox5.Text = \"\"\n    wb.Sheets(\"Sheet1\").TextBox6.Text = \"\"\n    wb.Sheets(\"Sheet1\").TextBox7.Text = \"\"\n    wb.Sheets(\"Sheet1\").TextBox9.Text = \"\"\n    wb.Sheets(\"Sheet1\").TextBox10.Text = \"\"\n    wb.Sheets(\"Sheet1\").TextBox11.Text = \"\"\n    wb.Sheets(\"Sheet1\").TextBox12.Text = \"\"\n\n    wb.Sheets(\"Sheet1\").Range(\"D9:D21,D25:D36,D42:D52,D56:D60,D65:D67,D71:D76,D80:D83,D87:D91,D95:D100,D104:D106,L9:L20,L25:L35,L42:L52,L56:L61,L65:L67,L71:L75,L80:L82,L87:L90,L95:L100\").Value = \"-\"\n\n    For Each Shp In wb.Sheets(\"Sheet1\").Shapes\n        If Not (Shp.Type = msoOLEControlObject Or Shp.Type = msoFormControl Or Shp.Type = msoPicture) Then Shp.Delete\n    Next Shp\n\n    For Each Shp In wb.Sheets(\"Sheet2\").Shapes\n        If Not (Shp.Type = msoOLEControlObject Or Shp.Type = msoFormControl Or Shp.Type = msoPicture) Then Shp.Delete\n    Next Shp\n\n    wb.Sheets(\"Sheet2\").ComboBox2.Text = \"-\"\n    wb.Sheets(\"Sheet2\").ComboBox3.Text = \"-\"\n    wb.Sheets(\"Sheet2\").ComboBox4.Text = \"-\"\n\n    wb.Sheets(\"Sheet2\").CheckBox1.Value = False\n    wb.Sheets(\"Sheet2\").CheckBox2.Value = False\n    wb.Sheets(\"Sheet2\").CheckBox3.Value = False\n    wb.Sheets(\"Sheet2\").CheckBox4.Value = False\n    wb.Sheets(\"Sheet2\").CheckBox5.Value = False\n    wb.Sheets(\"Sheet2\").CheckBox8.Value = False\n    wb.Sheets(\"Sheet2\").CheckBox9.Value = False\n    wb.Sheets(\"Sheet2\").CheckBox10.Value = False\n    wb.Sheets(\"Sheet2\").CheckBox11.Value = False\n\n    wb.Sheets(\"Sheet2\").Range(\"F9,F11,F15,F17,F21,F23,F27,F29,F35,F37,F39,F45,F47,F53,F55,K35\").Value = 0\n    wb.Sheets(\"Sheet2\").Range(\"J9:M9,J15:M15,J21:M21,J27:M27\").ClearContents\n\n    wb.Sheets(\"Sheet3\").ComboBox1.Text = \"-\"\n    wb.Sheets(\"Sheet3\").ComboBox2.Text = \"-\"\n    wb.Sheets(\"Sheet3\").ComboBox3.Text = \"-\"\n    wb.Sheets(\"Sheet3\").ComboBox4.Text = \"-\"\n    wb.Sheets(\"Sheet3\").ComboBox6.Text = \"-\"\n\n    wb.Sheets(\"Sheet3\").TextBox1.Text = \"\"\n    wb.Sheets(\"Sheet3\").TextBox2.Text = \"\"\n    wb.Sheets(\"Sheet3\").TextBox3.Text = \"\"\n    wb.Sheets(\"Sheet3\").TextBox5.Text = \"\"\n    wb.Sheets(\"Sheet3\").TextBox6.Text = \"\"\n\n    wb.Sheets(\"Sheet3\").CheckBox1.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox2.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox3.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox4.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox5.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox6.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox7.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox8.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox9.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox10.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox11.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox12.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox13.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox14.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox15.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox16.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox17.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox18.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox19.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox20.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox21.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox22.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox23.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox24.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox25.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox26.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox27.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox28.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox29.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox30.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox31.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox32.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox33.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox34.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox35.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox36.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox37.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox38.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox39.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox41.Value = False\n    wb.Sheets(\"Sheet3\").CheckBox43.Value = False\n\n    wb.Sheets(\"Sheet3\").Range(\"C9,C11,H9,H11,L(,L11\").Value = \"\"\n    wb.Sheets(\"Sheet3\").Range(\"L17:N17,L18:N18,L19:N19,L20:N20\").Value = 0\n\nEnd Sub\n</code></pre>\n\n<p>This workbook would be stored in the tracking workbook. Then in that tracking workbook you would have something like:</p>\n\n<pre><code>Sub ClearWorkBooks()\n    Dim wb As Workbook\n    For Each wb In Workbooks\n        If wb.Name &lt;&gt; \"Tracking\" Then ClearWorkBook wb\n    Next wb\nEnd Sub\n</code></pre>\n\n<p>Note that I streamlined the code by collapsing many of your statements into one by using noncontiguous ranges. Further streamlining is possible, though it is somewhat tangential to your question. You might have to do work on the loop in <code>ClearWorkBooks()</code> so that it only runs on the workbooks that you want to clear.</p>\n"}], "owner": {"reputation": 15, "user_id": 8719678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9640b3c2d7485f748fe2bb50bd5070e3?s=128&d=identicon&r=PG&f=1", "display_name": "Guaca24", "link": "https://stackoverflow.com/users/8719678/guaca24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1507126398, "creation_date": 1507116198, "last_edit_date": 1507126398, "question_id": 46563584, "link": "https://stackoverflow.com/questions/46563584/using-a-clear-button-to-clear-cells-checkboxes-and-comboboxes-in-a-separate-wo", "title": "Using a clear button to clear cells, checkboxes, and comboboxes in a separate workbook", "body": "<p>I am working with about 10 separate excel workbooks and one tracking workbook.  I have clear buttons on all 10 workbooks but would like a clear all button on the tracking one so my employees don't have to open each individual one to clear its contents.  The VBA code in each workbook is shown below:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Sheet1.ComboBox172.Text = \"-\"\n    Sheet1.ComboBox174.Text = \"-\"\n    Sheet1.ComboBox175.Text = \"-\"\n\n    Sheet1.CheckBox1.Value = False\n    Sheet1.CheckBox2.Value = False\n    Sheet1.CheckBox3.Value = False\n\n    Sheet1.TextBox1.Text = \"\"\n    Sheet1.TextBox2.Text = \"\"\n    Sheet1.TextBox3.Text = \"\"\n    Sheet1.TextBox4.Text = \"\"\n    Sheet1.TextBox5.Text = \"\"\n    Sheet1.TextBox6.Text = \"\"\n    Sheet1.TextBox7.Text = \"\"\n    Sheet1.TextBox9.Text = \"\"\n    Sheet1.TextBox10.Text = \"\"\n    Sheet1.TextBox11.Text = \"\"\n    Sheet1.TextBox12.Text = \"\"\n\n    Sheet1.Range(\"D9:D21\").Value = \"-\"\n    Sheet1.Range(\"D25:D36\").Value = \"-\"\n    Sheet1.Range(\"D42:D52\").Value = \"-\"\n    Sheet1.Range(\"D56:D60\").Value = \"-\"\n    Sheet1.Range(\"D65:D67\").Value = \"-\"\n    Sheet1.Range(\"D71:D76\").Value = \"-\"\n    Sheet1.Range(\"D80:D83\").Value = \"-\"\n    Sheet1.Range(\"D87:D91\").Value = \"-\"\n    Sheet1.Range(\"D95:D100\").Value = \"-\"\n    Sheet1.Range(\"D104:D106\").Value = \"-\"\n    Sheet1.Range(\"L9:L20\").Value = \"-\"\n    Sheet1.Range(\"L25:L35\").Value = \"-\"\n    Sheet1.Range(\"L42:L52\").Value = \"-\"\n    Sheet1.Range(\"L56:L61\").Value = \"-\"\n    Sheet1.Range(\"L65:L67\").Value = \"-\"\n    Sheet1.Range(\"L71:L75\").Value = \"-\"\n    Sheet1.Range(\"L80:L82\").Value = \"-\"\n    Sheet1.Range(\"L87:L90\").Value = \"-\"\n    Sheet1.Range(\"L95:L100\").Value = \"-\"\n\n    Dim Shp As Shape\n\n    For Each Shp In Sheet1.Shapes\n        If Not (Shp.Type = msoOLEControlObject Or Shp.Type = msoFormControl Or Shp.Type = msoPicture) Then Shp.Delete\n    Next Shp\n\n    For Each Shp In Sheet2.Shapes\n        If Not (Shp.Type = msoOLEControlObject Or Shp.Type = msoFormControl Or Shp.Type = msoPicture) Then Shp.Delete\n    Next Shp\n\n    Sheet2.ComboBox2.Text = \"-\"\n    Sheet2.ComboBox3.Text = \"-\"\n    Sheet2.ComboBox4.Text = \"-\"\n\n    Sheet2.CheckBox1.Value = False\n    Sheet2.CheckBox2.Value = False\n    Sheet2.CheckBox3.Value = False\n    Sheet2.CheckBox4.Value = False\n    Sheet2.CheckBox5.Value = False\n    Sheet2.CheckBox8.Value = False\n    Sheet2.CheckBox9.Value = False\n    Sheet2.CheckBox10.Value = False\n    Sheet2.CheckBox11.Value = False\n\n    Sheet2.Range(\"F9:F9\").Value = 0\n    Sheet2.Range(\"F11:F11\").Value = 0\n    Sheet2.Range(\"F15:F15\").Value = 0\n    Sheet2.Range(\"F17:F17\").Value = 0\n    Sheet2.Range(\"F21:F21\").Value = 0\n    Sheet2.Range(\"F23:F23\").Value = 0\n    Sheet2.Range(\"F27:F27\").Value = 0\n    Sheet2.Range(\"F29:F29\").Value = 0\n    Sheet2.Range(\"F35:F35\").Value = 0\n    Sheet2.Range(\"F37:F37\").Value = 0\n    Sheet2.Range(\"F39:F39\").Value = 0\n    Sheet2.Range(\"F45:F45\").Value = 0\n    Sheet2.Range(\"F47:F47\").Value = 0\n    Sheet2.Range(\"F53:F53\").Value = 0\n    Sheet2.Range(\"F55:F55\").Value = 0\n    Sheet2.Range(\"K35:K35\").Value = 0\n    Sheet2.Range(\"J9:M9\").ClearContents\n    Sheet2.Range(\"J15:M15\").ClearContents\n    Sheet2.Range(\"J21:M21\").ClearContents\n    Sheet2.Range(\"J27:M27\").ClearContents\n\n    Sheet3.ComboBox1.Text = \"-\"\n    Sheet3.ComboBox2.Text = \"-\"\n    Sheet3.ComboBox3.Text = \"-\"\n    Sheet3.ComboBox4.Text = \"-\"\n    Sheet3.ComboBox6.Text = \"-\"\n\n    Sheet3.TextBox1.Text = \"\"\n    Sheet3.TextBox2.Text = \"\"\n    Sheet3.TextBox3.Text = \"\"\n    Sheet3.TextBox5.Text = \"\"\n    Sheet3.TextBox6.Text = \"\"\n\n    Sheet3.CheckBox1.Value = False\n    Sheet3.CheckBox2.Value = False\n    Sheet3.CheckBox3.Value = False\n    Sheet3.CheckBox4.Value = False\n    Sheet3.CheckBox5.Value = False\n    Sheet3.CheckBox6.Value = False\n    Sheet3.CheckBox7.Value = False\n    Sheet3.CheckBox8.Value = False\n    Sheet3.CheckBox9.Value = False\n    Sheet3.CheckBox10.Value = False\n    Sheet3.CheckBox11.Value = False\n    Sheet3.CheckBox12.Value = False\n    Sheet3.CheckBox13.Value = False\n    Sheet3.CheckBox14.Value = False\n    Sheet3.CheckBox15.Value = False\n    Sheet3.CheckBox16.Value = False\n    Sheet3.CheckBox17.Value = False\n    Sheet3.CheckBox18.Value = False\n    Sheet3.CheckBox19.Value = False\n    Sheet3.CheckBox20.Value = False\n    Sheet3.CheckBox21.Value = False\n    Sheet3.CheckBox22.Value = False\n    Sheet3.CheckBox23.Value = False\n    Sheet3.CheckBox24.Value = False\n    Sheet3.CheckBox25.Value = False\n    Sheet3.CheckBox26.Value = False\n    Sheet3.CheckBox27.Value = False\n    Sheet3.CheckBox28.Value = False\n    Sheet3.CheckBox29.Value = False\n    Sheet3.CheckBox30.Value = False\n    Sheet3.CheckBox31.Value = False\n    Sheet3.CheckBox32.Value = False\n    Sheet3.CheckBox33.Value = False\n    Sheet3.CheckBox34.Value = False\n    Sheet3.CheckBox35.Value = False\n    Sheet3.CheckBox36.Value = False\n    Sheet3.CheckBox37.Value = False\n    Sheet3.CheckBox38.Value = False\n    Sheet3.CheckBox39.Value = False\n    Sheet3.CheckBox41.Value = False\n    Sheet3.CheckBox43.Value = False\n\n    Sheet3.Range(\"C9:C9\").Value = \"\"\n    Sheet3.Range(\"C11:C11\").Value = \"\"\n    Sheet3.Range(\"H9:H9\").Value = \"\"\n    Sheet3.Range(\"H11:H11\").Value = \"\"\n    Sheet3.Range(\"L9:L9\").Value = \"\"\n    Sheet3.Range(\"L11:L11\").Value = \"\"\n    Sheet3.Range(\"L17:N17\").Value = 0\n    Sheet3.Range(\"L18:N18\").Value = 0\n    Sheet3.Range(\"L19:N19\").Value = 0\n    Sheet3.Range(\"L20:N20\").Value = 0\nEnd Sub\n</code></pre>\n\n<p>I am having an issue with the clear button on the tracking sheet referencing any of the other workbooks.</p>\n"}, {"tags": ["vba", "excel", "date", "time", "type-conversion"], "comments": [{"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1507116766, "post_id": 46563537, "comment_id": 80080937, "body": "what&#39;s the results? At work, images are blocked."}, {"owner": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1507117303, "post_id": 46563537, "comment_id": 80081256, "body": "should be visible now, it&#39;s 539"}, {"owner": {"reputation": 1027, "user_id": 2543601, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40e3e80e7c8697ec26e33e49cb8336bc?s=128&d=identicon&r=PG", "display_name": "Jarom", "link": "https://stackoverflow.com/users/2543601/jarom"}, "edited": false, "score": 0, "creation_date": 1507120229, "post_id": 46563537, "comment_id": 80083312, "body": "I put these dates into two different date calculators I found on google and they both resulted in 539."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1507121151, "post_id": 46563537, "comment_id": 80083975, "body": "Check your computer&#39;s international settings and make sure it is set to dd/mm/yyyy format."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1507121325, "post_id": 46563537, "comment_id": 80084086, "body": "You shouldn&#39;t convert your dates to String. A simple <code>DateDiff(&quot;y&quot;, Now(), CDate(wsM.Range(&quot;M10&quot;).Value))</code> should be enough."}], "answers": [{"tags": [], "owner": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "is_accepted": true, "score": 1, "last_activity_date": 1507188505, "creation_date": 1507188505, "answer_id": 46580155, "question_id": 46563537, "link": "https://stackoverflow.com/questions/46563537/days-between-two-date-in-vba/46580155#46580155", "title": "Days between two date in vba", "body": "<p>I got answer from other forum:</p>\n\n<pre><code>Dim date_today As Date, test_date As Date\nDim result As Long\ndate_today = Date\n\ntest_date = wsM.Range(\"M10\").Value\n\nresult = DateDiff(\"D\", date_today, test_date)\n</code></pre>\n\n<p>It's tested and it's working.</p>\n"}], "owner": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4851, "favorite_count": 0, "accepted_answer_id": 46580155, "answer_count": 1, "score": 0, "last_activity_date": 1507188505, "creation_date": 1507116015, "last_edit_date": 1507123558, "question_id": 46563537, "link": "https://stackoverflow.com/questions/46563537/days-between-two-date-in-vba", "title": "Days between two date in vba", "body": "<p>I have two dates. I want to count number of days between.</p>\n\n<pre><code>date_today = Format(Now(), \"dd/mm/yyyy\")\n\ntest_date = Format(wsM.Range(\"M10\").Value, \"dd/mm/yyyy\")\n\nresult= DateDiff(\"D\", date_today, test_date)\n</code></pre>\n\n<p>I see in debug:</p>\n\n<p><a href=\"https://i.stack.imgur.com/dsMKJ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dsMKJ.jpg\" alt=\"debug\"></a></p>\n\n<p>The result is wrong. How can I fix this?</p>\n"}, {"tags": ["vba", "loops"], "comments": [{"owner": {"reputation": 4163, "user_id": 6401403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5e6e113b3335b200f4d4946e1bcaff84?s=128&d=identicon&r=PG&f=1", "display_name": "Michael O.", "link": "https://stackoverflow.com/users/6401403/michael-o"}, "edited": false, "score": 0, "creation_date": 1507115380, "post_id": 46563251, "comment_id": 80080119, "body": "Where is line 160?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1507115431, "post_id": 46563251, "comment_id": 80080158, "body": "Does it throw an error if you remove the <code>On Error Resume Next</code> line?  You say it stops at line 160 - number of ways to interpret that.  You&#39;ve only got about 16 lines of code, so it&#39;ll never reach line 160.  Or do you mean row 160 on the spreadsheet? Is row 160 the last line with data?"}, {"owner": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1507115677, "post_id": 46563251, "comment_id": 80080299, "body": "Amend as follows: <code>Arow = Sheets(&quot;AG&quot;).Range(&quot;A&quot; &amp; Sheets(&quot;AG&quot;).Rows.count).End(xlUp).Row</code> <code>mrow = Sheets(&quot;Mappings&quot;).Range(&quot;A&quot; &amp; Sheets(&quot;Mappings&quot;).Rows.count).End(xlUp).Row</code> <code>Sheets(&quot;AG&quot;).Cells(Sheets(&quot;AG&quot;).Rows.count, &quot;AM&quot;)...</code> you&#39;ve got the point?"}, {"owner": {"reputation": 9, "user_id": 8114553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d66d8be43aaeeecca57a38c1850ce0?s=128&d=identicon&r=PG&f=1", "display_name": "vinnie", "link": "https://stackoverflow.com/users/8114553/vinnie"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1507115765, "post_id": 46563251, "comment_id": 80080352, "body": "@DarrenBartrup-Cook yes. runtime error 13"}, {"owner": {"reputation": 9, "user_id": 8114553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d66d8be43aaeeecca57a38c1850ce0?s=128&d=identicon&r=PG&f=1", "display_name": "vinnie", "link": "https://stackoverflow.com/users/8114553/vinnie"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1507115924, "post_id": 46563251, "comment_id": 80080428, "body": "@Tehscript Now the code does not run"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1507116154, "post_id": 46563251, "comment_id": 80080574, "body": "Which line did the error occur on and what was the value of the variables on that line?  Also you <i>should</i> add <code>Option Explicit</code> at the very top of your module - that will point out you haven&#39;t declared the variable <code>j</code>."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1507116468, "post_id": 46563251, "comment_id": 80080754, "body": "@Tehscript is trying to say that <code>Arow = Sheets(&quot;AG&quot;).Range(&quot;A&quot; &amp; Sheets(&quot;AG&quot;).Rows.count).End(xlUp).Row</code> should be one line, <code>mrow = Sheets(&quot;Mappings&quot;).Range(&quot;A&quot; &amp; Sheets(&quot;Mappings&quot;).Rows.count).End(xlUp).Row</code> is another line.  Although it will only make a difference if you have a 2003 file and a 2007+ file open (<code>Rows.Count</code> will count the rows on the currently active sheet if you don&#39;t specify the sheet.  If you&#39;re working in 2003 but have a 2007+ sheet active it will return more rows than are available in the 2003 workbook)."}, {"owner": {"reputation": 9, "user_id": 8114553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d66d8be43aaeeecca57a38c1850ce0?s=128&d=identicon&r=PG&f=1", "display_name": "vinnie", "link": "https://stackoverflow.com/users/8114553/vinnie"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1507118986, "post_id": 46563251, "comment_id": 80082334, "body": "@DarrenBartrup-Cook the error is that it does not paste the value on every single occurance. only the first"}, {"owner": {"reputation": 9, "user_id": 8114553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d66d8be43aaeeecca57a38c1850ce0?s=128&d=identicon&r=PG&f=1", "display_name": "vinnie", "link": "https://stackoverflow.com/users/8114553/vinnie"}, "reply_to_user": {"reputation": 2506, "user_id": 7866972, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tsl55.jpg?s=128&g=1", "display_name": "Tehscript", "link": "https://stackoverflow.com/users/7866972/tehscript"}, "edited": false, "score": 0, "creation_date": 1507119251, "post_id": 46563251, "comment_id": 80082550, "body": "@Tehscript the code only populates the output values of the If statement of the first instance and not for all others"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1507121232, "post_id": 46563251, "comment_id": 80084032, "body": "That&#39;s not an error - that&#39;s the code not doing what you expect it to do, but somewhere in the code it gives error code 13 which is a data type mismatch - trying to assign a letter to a numeric variable for example.  From what you&#39;ve said it appears to be skipping some of the loops - have you tested the value of <code>mRow</code> &amp; <code>aRow</code>?  If you&#39;re sheet is blank it will return a number less than 2 - so your loop may be doing something like <code>For j=2 to 1</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1507121370, "post_id": 46563251, "comment_id": 80084122, "body": "Have just noticed that at this line:  <code>AG_Label = Sheets(&quot;AG&quot;).Cells(j, &quot;N&quot;).Value</code> you haven&#39;t set a value for <code>j</code> yet so it will be 0 and you&#39;re trying to get the value of the cell <code>N0</code> which doesn&#39;t exist."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507174843, "post_id": 46563251, "comment_id": 80107990, "body": "FWIW (because your later question shows that you have fixed it since this question), your <code>Sheets(&quot;AG&quot;).Cells(Rows.count, &quot;AM&quot;).PasteSpecial</code> was pasting the value to cell AM1048576 all the time."}], "owner": {"reputation": 9, "user_id": 8114553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3d66d8be43aaeeecca57a38c1850ce0?s=128&d=identicon&r=PG&f=1", "display_name": "vinnie", "link": "https://stackoverflow.com/users/8114553/vinnie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507115548, "creation_date": 1507115007, "last_edit_date": 1507115548, "question_id": 46563251, "link": "https://stackoverflow.com/questions/46563251/vba-not-looping-through-entire-data", "title": "VBA not looping through entire data", "body": "<p>The code stops at line 160. I need it to run through the entire list till the last populated cell</p>\n\n<pre><code>Dim mrow As Long, Arow As Long, iRows As Long, srow As String\nDim x As Long, y As Long, i As Long\nDim AG_Label As String, AG_val As String, SNL_val As String, SNL_Label As     String, M_Label As String, Rng As Range\nDim Vval As Long, Speriod As String, aperiod As String\nDim M_Match_1\n\n\nArow = Sheets(\"AG\").Range(\"A\" &amp; Rows.count).End(xlUp).Row\nFor i = 2 To Arow\n    AG_Label = Sheets(\"AG\").Cells(j, \"N\").Value\n    mrow = Sheets(\"Mappings\").Range(\"A\" &amp; Rows.count).End(xlUp).Row\n    For j = 2 To mrow\n        M_Match_1 = Sheets(\"Mappings\").Cells(j, \"P\").Value\n        M_Label = Sheets(\"Mappings\").Cells(j, \"C\").Value\n        If AG_Label = M_Label And Sheets(\"Mappings\").Cells(j, \"L\").Value = \"FRY-9C\" Then\n            Sheets(\"Mappings\").Cells(j, \"J\").copy\n            Sheets(\"AG\").Cells(Rows.count, \"AM\").PasteSpecial Paste:=xlPasteValues, _\n              Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n                On Error Resume Next\n        End If\n    Next j\nNext i\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 1093, "user_id": 7814526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/leMzB.png?s=128&g=1", "display_name": "JensS", "link": "https://stackoverflow.com/users/7814526/jenss"}, "edited": false, "score": 0, "creation_date": 1507118687, "post_id": 46562981, "comment_id": 80082127, "body": "You mean the last row in a given cell (as the code indicates) - not the last column in any row. right?"}], "answers": [{"tags": [], "owner": {"reputation": 1093, "user_id": 7814526, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/leMzB.png?s=128&g=1", "display_name": "JensS", "link": "https://stackoverflow.com/users/7814526/jenss"}, "is_accepted": false, "score": 0, "last_activity_date": 1507118876, "last_edit_date": 1507118876, "creation_date": 1507118491, "answer_id": 46564358, "question_id": 46562981, "link": "https://stackoverflow.com/questions/46562981/replace-comma-with-blank-in-vba/46564358#46564358", "title": "Replace comma with blank in vba", "body": "<p>This should do the trick: It will remove the last character in the last row if it is a comma (this assumes that you want to replace in column C as your code indicates):</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  Dim lRow As Long\n\n  lRow = ActiveSheet.UsedRange.Rows.Count\n  If Right(Range(\"C\" &amp; lRow).Value, 1) = \",\" Then\n    Range(\"C\" &amp; lRow).Value = Left(Range(\"C\" &amp; lRow), Len(Range(\"C\" &amp; lRow)) - 1)\n  End If\n\n  Range(\"B2:B\" &amp; lRow).ClearContents\nEnd Sub\n</code></pre>\n\n<p>You could also use the replace, but it is trickier that way.</p>\n"}], "owner": {"reputation": 49, "user_id": 4015167, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/12d74c5c1f8af0acc59727ddf4328b23?s=128&d=identicon&r=PG&f=1", "display_name": "Nitin Tayal", "link": "https://stackoverflow.com/users/4015167/nitin-tayal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 179, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507128080, "creation_date": 1507114108, "last_edit_date": 1507128080, "question_id": 46562981, "link": "https://stackoverflow.com/questions/46562981/replace-comma-with-blank-in-vba", "title": "Replace comma with blank in vba", "body": "<p>I have to replace comma in the last column of any row with blank.I have below in excel.</p>\n\n<pre><code> 1      _1 \"\",\n 2      _2 \"\",\n 3      _3 \"\",\n 4      _4 \"\",\n 5      _5 \"\",\n</code></pre>\n\n<p>My code. but it is not working.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n  Dim lRow As Long\n  Dim length As Long\n\n  'Find the last non-blank cell in column A(1)\n  lRow = Cells(Rows.Count, 1).End(xlUp).Row\n  length = Len(Range(\"C\" &amp; lRow)) - 1\n  Range(\"C\" &amp; lRow).Value = Replace(Range(\"C\" &amp; lRow), \",\", \"\", length)\n  Range(\"B2:B\" &amp; lRow).ClearContents\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1507111209, "post_id": 46561934, "comment_id": 80077577, "body": "You cannot read a file without opening it. But you can open that file, read the values you need and close it."}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1507111430, "post_id": 46561934, "comment_id": 80077709, "body": "If it is really something you need then search for &quot;indirect.ext&quot;. Personally i&#39;d open the workbook, retrieve the values, close the workbook."}, {"owner": {"reputation": 11, "user_id": 8719189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a02036c88e0d86a4195fe8522d090ae?s=128&d=identicon&r=PG&f=1", "display_name": "srivignesh", "link": "https://stackoverflow.com/users/8719189/srivignesh"}, "edited": false, "score": 0, "creation_date": 1507527259, "post_id": 46561934, "comment_id": 80227875, "body": "Thanks for your suggestion Peh and Zerk"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8719189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a02036c88e0d86a4195fe8522d090ae?s=128&d=identicon&r=PG&f=1", "display_name": "srivignesh", "link": "https://stackoverflow.com/users/8719189/srivignesh"}, "edited": false, "score": 0, "creation_date": 1507117644, "post_id": 46562872, "comment_id": 80081462, "body": "I got a answer ,i have added GetObject function to read the cell value without open the workbook  eg : Set ObjWB = GetObject(&quot;c:\\Test.xlsx&quot;)"}, {"owner": {"reputation": 11, "user_id": 8719189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a02036c88e0d86a4195fe8522d090ae?s=128&d=identicon&r=PG&f=1", "display_name": "srivignesh", "link": "https://stackoverflow.com/users/8719189/srivignesh"}, "edited": false, "score": 0, "creation_date": 1507527303, "post_id": 46562872, "comment_id": 80227896, "body": "Thanks for your suggestion"}, {"owner": {"reputation": 105, "user_id": 9808154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd6a98412f53a13e79ec56c431df064?s=128&d=identicon&r=PG&f=1", "display_name": "ThisGuyJustNeedsHelp", "link": "https://stackoverflow.com/users/9808154/thisguyjustneedshelp"}, "edited": false, "score": 0, "creation_date": 1533233435, "post_id": 46562872, "comment_id": 90283147, "body": "I&#39;m getting object error when running this code?"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1507113750, "creation_date": 1507113750, "answer_id": 46562872, "question_id": 46561934, "link": "https://stackoverflow.com/questions/46561934/read-the-cell-value-without-opening-the-workbook/46562872#46562872", "title": "Read the cell value without opening the workbook", "body": "<p>Run the Sub <code>GetValue</code> after setting the parameters in <code>ReadFromClosedWorkbook</code> (Workbook &amp; Worksheet). You could pass either or both of them as arguments from the calling procedure.</p>\n\n<pre><code>Sub GetValue()\n    Debug.Print ReadFromClosedWorkbook(\"A1\")\nEnd Sub\n\nPrivate Function ReadFromClosedWorkbook(Target As String) As Variant\n\n    Const WbFullName = \"D:\\My Documents\\Your file name.xlsx\"\n\n    Dim PathName As String\n    Dim WbName As String\n    Dim WsName As String\n    Dim Target As String\n    Dim Sp() As String\n\n    WsName = \"My Worksheet's Name\"\n\n    Sp = Split(WbFullName, \"\\\")\n    WbName = Sp(UBound(Sp))\n    ReDim Preserve Sp(UBound(Sp) - 1)\n    PathName = Join(Sp, \"\\\") &amp; \"\\\"\n    If Len(Dir(WbFullName)) Then\n        Target = \"'\" &amp; PathName &amp; _\n                 \"[\" &amp; WbName &amp; \"]\" &amp; WsName &amp; _\n                 \"'!\" &amp; Range(Target).Address(True, True, xlR1C1)\n        ReadFromClosedWorkbook = ExecuteExcel4Macro(Target)\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8719189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a02036c88e0d86a4195fe8522d090ae?s=128&d=identicon&r=PG&f=1", "display_name": "srivignesh", "link": "https://stackoverflow.com/users/8719189/srivignesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 5444, "favorite_count": 0, "closed_date": 1507117835, "answer_count": 1, "score": 1, "last_activity_date": 1612390104, "creation_date": 1507110879, "last_edit_date": 1612390104, "question_id": 46561934, "link": "https://stackoverflow.com/questions/46561934/read-the-cell-value-without-opening-the-workbook", "closed_reason": "Duplicate", "title": "Read the cell value without opening the workbook", "body": "<pre><code>Set ObjWB = Workbooks.Open(\"c:\\Test.xlsx\")\n</code></pre>\n\n<p>If I used <code>workbooks.open</code> command, that Excel workbook opens.</p>\n\n<p>I need without open that Excel workbook to read the cell value.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1507109903, "post_id": 46561451, "comment_id": 80076821, "body": "What type of button? Forms or ActiveX?"}, {"owner": {"reputation": 511, "user_id": 1120162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/37557d2c5edabc38d02282048134de08?s=128&d=identicon&r=PG", "display_name": "Terran Brown", "link": "https://stackoverflow.com/users/1120162/terran-brown"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1507111036, "post_id": 46561451, "comment_id": 80077474, "body": "Hi - its a Forms button. Thanks"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1507111554, "post_id": 46561451, "comment_id": 80077787, "body": "Clicking the button doesn&#39;t change the ActiveCell. You can get which button was pressed by looking at Application.Caller"}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 1120162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/37557d2c5edabc38d02282048134de08?s=128&d=identicon&r=PG", "display_name": "Terran Brown", "link": "https://stackoverflow.com/users/1120162/terran-brown"}, "edited": false, "score": 0, "creation_date": 1507115199, "post_id": 46562157, "comment_id": 80080020, "body": "Hi - so I&#39;ve tried to pull your suggestion in to my code but I seem to be having a seniuor moment. The following does seem to work but does not copy any thing in the end. I needed in effect to select the row I want to copy and copy x amount of times based on user in put below. So while your code @Thomas G does work it only allows one row at a time."}, {"owner": {"reputation": 511, "user_id": 1120162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/37557d2c5edabc38d02282048134de08?s=128&d=identicon&r=PG", "display_name": "Terran Brown", "link": "https://stackoverflow.com/users/1120162/terran-brown"}, "edited": false, "score": 0, "creation_date": 1507115203, "post_id": 46562157, "comment_id": 80080025, "body": "Sub InsertRows()   Dim x As Integer Dim iRow As Integer    x = Application.InputBox(&quot;Number of Rows&quot;, &quot;Number of Rows&quot;, Type:=1)   If x = False Then Exit Sub          iRow = ActiveSheet.Shapes(Application.Caller).TopLeftCell.Row          ActiveCell.EntireRow.Copy     Range(ActiveCell, ActiveCell.Offset(x - 1, iRow)).EntireRow.Insert Shift:=xlDown     Application.CutCopyMode = False      End Sub"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "reply_to_user": {"reputation": 511, "user_id": 1120162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/37557d2c5edabc38d02282048134de08?s=128&d=identicon&r=PG", "display_name": "Terran Brown", "link": "https://stackoverflow.com/users/1120162/terran-brown"}, "edited": false, "score": 0, "creation_date": 1507116621, "post_id": 46562157, "comment_id": 80080848, "body": "@TerranBrown See my adapted answer. It wasnt that hard, was it?"}, {"owner": {"reputation": 511, "user_id": 1120162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/37557d2c5edabc38d02282048134de08?s=128&d=identicon&r=PG", "display_name": "Terran Brown", "link": "https://stackoverflow.com/users/1120162/terran-brown"}, "edited": false, "score": 0, "creation_date": 1507118176, "post_id": 46562157, "comment_id": 80081770, "body": "Hi Thomas - your right... off to give my self a beating :) Thanks for your help. Terran"}], "tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1507116647, "last_edit_date": 1507116647, "creation_date": 1507111531, "answer_id": 46562157, "question_id": 46561451, "link": "https://stackoverflow.com/questions/46561451/excel-vba-add-new-line-script-not-adding-row-based-on-where-the-button-is-been-p/46562157#46562157", "title": "Excel VBA Add New Line Script Not Adding Row Based On Where The Button Is Been Pressed", "body": "<p>Use this to get the row of the button you have just clicked:</p>\n\n<pre><code>ActiveSheet.Shapes(Application.Caller).TopLeftCell.Row\n</code></pre>\n\n<p>I don't really understand what you are trying to do with your msgbox collecting an offset. So here's the code to do excatly what you asked, ie copy the row where the button is, on the row right underneath:</p>\n\n<pre><code>Sub Button1_Click()\n\n    Dim iRow As Integer\n    iRow = ActiveSheet.Shapes(Application.Caller).TopLeftCell.Row\n    Range(\"A\" &amp; iRow).EntireRow.Copy\n    Range(\"A\" &amp; iRow + 1).PasteSpecial\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>EDIT: \nIf you want to copy it several times just do this :</p>\n\n<pre><code>Sub Button1_Click()\n\n    Dim iRow As Integer\n    Dim x As Integer\n    Dim i As Integer\n\n    x = Application.InputBox(\"Number of Rows\", \"Number of Rows\", Type:=1)\n    iRow = ActiveSheet.Shapes(Application.Caller).TopLeftCell.Row\n\n    For i = 0 To (x - 1)\n\n        Range(\"A\" &amp; iRow).EntireRow.Copy\n        Range(\"A\" &amp; iRow + 1 + i).PasteSpecial\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 1120162, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/37557d2c5edabc38d02282048134de08?s=128&d=identicon&r=PG", "display_name": "Terran Brown", "link": "https://stackoverflow.com/users/1120162/terran-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 46562157, "answer_count": 1, "score": 1, "last_activity_date": 1507120552, "creation_date": 1507109290, "last_edit_date": 1507120552, "question_id": 46561451, "link": "https://stackoverflow.com/questions/46561451/excel-vba-add-new-line-script-not-adding-row-based-on-where-the-button-is-been-p", "title": "Excel VBA Add New Line Script Not Adding Row Based On Where The Button Is Been Pressed", "body": "<p>I have a excel spread sheet where I have added a button on a row which I wanted to click, take a copy of that row and then duplicate underneath.</p>\n\n<p>For some reason it does not seem to be selecting the row where I click the button but where ever the cursor is meaning the wrong line is copied.</p>\n\n<p>Is there any way I can change the below to make the active cell where ever the button has just been pressed ?</p>\n\n<pre><code>Sub InsertRows()\nDim x As Integer\n  x = Application.InputBox(\"Number of Rows\", \"Number of Rows\", Type:=1)\n  If x = False Then Exit Sub\n    ActiveCell.EntireRow.Copy\n    Range(ActiveCell, ActiveCell.Offset(x - 1, 0)).EntireRow.Insert Shift:=xlDown\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>Many thanks in advance</p>\n\n<p>Terran</p>\n\n<p>EDIT</p>\n\n<p>My final solution with Thomas' help.</p>\n\n<p>The slight difference is that this allows the button its self to also be copied as well as the row.</p>\n\n<pre><code>Sub InsertRows()\n\n\n    Dim iRow As Integer\n    Dim x As Integer\n    Dim i As Integer\n\n    x = Application.InputBox(\"Number of Rows\", \"Number of Rows\", Type:=1)\n    iRow = ActiveSheet.Shapes(Application.Caller).TopLeftCell.Row\n    If x = False Then Exit Sub\n\n    For i = 0 To (x - 1)\n\n\n    'Range(ActiveCell, ActiveCell.Offset(x - 1, 0)).EntireRow.Insert Shift:=xlDown\n\n\n    Range(\"A\" &amp; iRow).EntireRow.Copy\n    Range(\"A\" &amp; iRow + 1 + i).EntireRow.Insert Shift:=xlDown\n\n    Next i\n    Application.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "runtime-error"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1507110608, "post_id": 46561298, "comment_id": 80077222, "body": "(1) On which line do you get the error?  (2) Note: You should avoid using <code>.Select</code> or <code>.Activate</code> as this is bad practice and leads into many issues. There are several tutorials out there how to avoid them both. After you cleaned up your code from <code>.Select</code> and <code>.Activate</code> it will be much easier to find an issue."}], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "edited": false, "score": 0, "creation_date": 1507116115, "post_id": 46562638, "comment_id": 80080552, "body": "Having an error running this line     With Windows(&quot;InstData_TEMS_Existing&quot;).Sheets(&quot;L&quot;)      Pop out error message which say &quot;Run time error 9, Subscript out of range&quot;"}, {"owner": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "edited": false, "score": 0, "creation_date": 1507116564, "post_id": 46562638, "comment_id": 80080801, "body": "There&#39;s also this error message running it from the excel workbook itself  we didn&#39;t fill in the values because the display formatting for some of the cells in the active column is using a different level of precision underlying value"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1507112908, "creation_date": 1507112908, "answer_id": 46562638, "question_id": 46561298, "link": "https://stackoverflow.com/questions/46561298/error-re-running-code/46562638#46562638", "title": "Error re-running code", "body": "<p>Try the code below, without all the unnecessary <code>Select</code>, <code>Activate</code>, and <code>Selection</code>:</p>\n\n<pre><code>Sub Graph()\n'\n' Graph Macro\n'\n' Keyboard Shortcut: Ctrl+e\n'\n'Select values in a column from specified workbook and sheet\nDim LR As Long, cell As Range, rng As Range\n\nWith Workbooks(\"Area3-LG\").Sheets(\"Graph data\")\n    LR = .Range(\"B\" &amp; .Rows.Count).End(xlUp).Row\n    For Each cell In .Range(\"B4:B\" &amp; LR)\n        If cell.Value &lt;&gt; \"\" Then\n            If rng Is Nothing Then\n                Set rng = cell\n            Else\n                Set rng = Union(rng, cell)\n            End If\n        End If\n    Next cell\nEnd With\nrng.Copy ' copy the union range (no need to select it first)\n\n' paste without all the selecting\nWith Windows(\"InstData_TEMS_Existing\").Sheets(\"L\")\n    ' Paste (without select) un the next empty cell fromn column AA\n    .Range(\"AA\" &amp; .Rows.Count).End(xlUp).Offset(1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, _\n                            SkipBlanks:=False, Transpose:=False\nEnd With\n\nApplication.CutCopyMode = False\n\n'Go back to previous workbook &amp; delete column\nWorkbooks(\"Area3-LG\").Sheets(\"Graph data\").Columns(\"B:B\").Delete Shift:=xlToLeft\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 350, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1507112908, "creation_date": 1507108791, "last_edit_date": 1507112433, "question_id": 46561298, "link": "https://stackoverflow.com/questions/46561298/error-re-running-code", "title": "Error re-running code", "body": "<p>firstly, I'm having error running the code from Excel workbook directly. It leads to the error message mentioned below</p>\n\n<blockquote>\n  <p>We looked at all the data next to your selection and didn't see a pattern for filling in values for you. To use Flash Fill, enter a couple of examples of the output you'd like to see, keep the active cell in the column you want filled in and click the Flash Fill button again</p>\n</blockquote>\n\n<p>However, I could run the code if is played from VBA windows under the developers tab. But Is limited to only 1 run before an error message 1004 pops up and also code error when played again.</p>\n\n<p>Please help. Never taught or learnt VBA in ever. Code below is a mash up of researched on the net and trial &amp; error.</p>\n\n<pre><code>Sub Graph()\n'\n' Graph Macro\n'\n' Keyboard Shortcut: Ctrl+e\n'\n'Select values in a column from specified workbook and sheet\nDim LR As Long, cell As Range, rng As Range\n\nWindows(\"Area3-LG\").Activate\nWith Sheets(\"Graph data\")\n    LR = .Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    For Each cell In .Range(\"B4:B\" &amp; LR)\n        If cell.Value &lt;&gt; \"\" Then\n            If rng Is Nothing Then\n                Set rng = cell\n            Else\n                Set rng = Union(rng, cell)\n            End If\n        End If\n    Next cell\n    'Error with rng.select when Macro is runned again\n    rng.Select    \nEnd With\nSelection.Copy\n\n'Open next workbook\nWindows(\"InstData_TEMS_Existing\").Activate\n'Open Sheet L\nSheets(\"L\").Select\n'Select empty field fromn column AA\nRange(\"AA\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n'paste selection to empty field\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n'Go back to previous workbook &amp; delete column\nWindows(\"Area3-LG\").Activate\nSheets(\"Graph data\").Select\nColumns(\"B:B\").Select\nApplication.CutCopyMode = False\nSelection.Delete Shift:=xlToLeft\nSheets(\"Graph Data\").Select\n\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance (:</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4573, "user_id": 395685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/506a37c8660a6faa6382086e4a538811?s=128&d=identicon&r=PG", "display_name": "Nyerguds", "link": "https://stackoverflow.com/users/395685/nyerguds"}, "edited": false, "score": 0, "creation_date": 1507108992, "post_id": 46561283, "comment_id": 80076194, "body": "Formatting hint: indent code with at least 4 spaces to make it show up as a code block."}, {"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 2, "creation_date": 1507109708, "post_id": 46561283, "comment_id": 80076689, "body": "Top google result (<a href=\"http://www.excel-easy.com/vba/loop.html\" rel=\"nofollow noreferrer\">excel-easy.com/vba/loop.html</a>). Please attempt doing it yourself first."}], "answers": [{"tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 0, "last_activity_date": 1507111036, "creation_date": 1507111036, "answer_id": 46561993, "question_id": 46561283, "link": "https://stackoverflow.com/questions/46561283/how-can-i-loop-the-above-code/46561993#46561993", "title": "How can i loop the above code?", "body": "<p>As @Zerk suggested try to figure out how this works. \nLooping and Selecting is not required at all.\nTry to think this as you were to put formula in column X and then google how to put that formula through VBA.</p>\n\n<pre><code>Sub test()\n    Sheets(\"Programare\").Range(\"A:W\").Copy Destination:=Sheets(\"Result\").Range(\"A:W\")\n    Sheets(\"Result\").Range(\"X2:X1000\").Formula = \"=IF(U2&gt;V2,\"\"+\"\",IF(V2&gt;U2,\"\"-\"\",IF(U2=V2,\"\"=\"\",\"\"\"\")))\"\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8719071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f8ef6e0d866b39ff5794ab4aef1587?s=128&d=identicon&r=PG&f=1", "display_name": "Caius", "link": "https://stackoverflow.com/users/8719071/caius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1507111036, "creation_date": 1507108774, "last_edit_date": 1507110504, "question_id": 46561283, "link": "https://stackoverflow.com/questions/46561283/how-can-i-loop-the-above-code", "title": "How can i loop the above code?", "body": "<pre><code>Sub CalculateWFR()\n        'select 1st sheet\n        Worksheets(1).Activate\n\n        'select range A:W\n        Worksheets(1).Cells.Select\n        Columns(\"A:W\").Select\n\n        'copy paste sheet programare in results\n        Sheets(\"Programare\").Range(\"A:W\").Copy Destination:=Sheets(\"Result\").Range(\"A:W\")\n\n        'compare values from column U with column V and put +/-/= if value from U2 is higher,smaller or equals value from column V2\n        Dim X As Integer Dim y As Integer\n        X = Worksheets(\"Result\").Range(\"U2\").Value\n        y = Worksheets(\"Result\").Range(\"V2\").Value\n\n        If X &gt; y Then\n            Worksheets(\"Result\").Range(\"X2\") = \"+\"\n        ElseIf X &lt; y Then\n            Worksheets(\"Result\").Range(\"X2\") = \"-\"\n        ElseIf X = y Then\n            Worksheets(\"Result\").Range(\"X2\") = \"=\"\n        End If\n    End Sub\n</code></pre>\n\n<p>I am trying to loop the above code on column X, which has over 1000 Rows. Also there are no blank spaces. How can I do this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1507107980, "post_id": 46560915, "comment_id": 80075563, "body": "Remove <code>exit sub</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "edited": false, "score": 0, "creation_date": 1507108625, "post_id": 46561013, "comment_id": 80075970, "body": "great, where to put also : With Selection.Borders(xlEdgeLeft)         .LineStyle = xlContinuous     End With ???"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "edited": false, "score": 0, "creation_date": 1507109130, "post_id": 46561013, "comment_id": 80076285, "body": "@4est, see update -- you can apply borders to the destination range as above"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "edited": false, "score": 0, "creation_date": 1507109505, "post_id": 46561013, "comment_id": 80076538, "body": "If B6 can be empty then <code>xlUp</code> is required rather than <code>xlDown</code> -- I&#39;ve updated to allow for this occurrence."}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 2, "last_activity_date": 1507109453, "last_edit_date": 1507109453, "creation_date": 1507107993, "answer_id": 46561013, "question_id": 46560915, "link": "https://stackoverflow.com/questions/46560915/copy-value-to-next-empty-cell/46561013#46561013", "title": "Copy value to next empty cell", "body": "<p>No need to loop through your rows until you find an empty one. You can replace the entire sub with this:</p>\n\n<pre><code>Sub add_value()\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        .Cells(.Rows.Count, \"B\").End(xlUp).Offset(1, 0).Resize(1, 2).Value = .Range(\"B3:C3\").Value\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>As per your comments, to also add borders you can reorganise the code a bit like this:</p>\n\n<pre><code>Sub add_value()\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Offset(1, 0).Resize(1, 2)\n        .Value = ws.Range(\"B3:C3\").Value\n        .Borders(xlEdgeLeft).LineStyle = xlContinuous\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1507108439, "creation_date": 1507108439, "answer_id": 46561161, "question_id": 46560915, "link": "https://stackoverflow.com/questions/46560915/copy-value-to-next-empty-cell/46561161#46561161", "title": "Copy value to next empty cell", "body": "<p>I would have done something like this:</p>\n\n<pre><code>Sub FindFirstEmptyValue()\n\n    Dim lastRow     As Long\n\n    With Worksheets(\"Sheet1\")\n        lastRow = .Cells(.Rows.Count, 2).End(xlUp).Row + 1\n        .Cells(lastRow, 2) = .Range(\"B3\").value\n        .Cells(lastRow, 3) = .Range(\"C3\").value\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>It gives you the last row, you increment it with 1 and on this row you write the <code>B3</code> and <code>C3</code> values.</p>\n"}], "owner": {"reputation": 2420, "user_id": 2207426, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/G5kTR.png?s=128&g=1", "display_name": "4est", "link": "https://stackoverflow.com/users/2207426/4est"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 46561013, "answer_count": 2, "score": 2, "last_activity_date": 1507109453, "creation_date": 1507107682, "last_edit_date": 1507108072, "question_id": 46560915, "link": "https://stackoverflow.com/questions/46560915/copy-value-to-next-empty-cell", "title": "Copy value to next empty cell", "body": "<p>I want to find empty cells and copy there values:</p>\n\n<p><a href=\"https://i.stack.imgur.com/HXt4a.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HXt4a.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>Values: \"10/11/2017\" and \"Yes\" should be copied to row 7 (colB &amp; colC).</p>\n\n<p>What I have:</p>\n\n<pre><code>Sub add_value()\n\nDim wbA As Workbook\nDim wsA As Worksheet\n\nSet wbA = ActiveWorkbook\nSet wsA = wbA.Worksheets(\"Sheet1\")\n\nDim nrow As Long\n\nnrow = 6\n\n    Do Until wsA.Range(\"B\" &amp; nrow).Value = \"\"\n        wsA.Range(\"B\" &amp; nrow).Value = wsA.Range(\"B3\").Value\n        wsA.Range(\"C\" &amp; nrow).Value = wsA.Range(\"C3\").Value\n            Exit Sub\n        nrow = nrow + 1\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>Something is wrong with my loop and I don't know how to fix it.</p>\n"}, {"tags": ["excel", "vba", "cell", "commandbutton"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4657988, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/942fc54a2588d7b682dbef9db2f34ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4657988/erik"}, "edited": false, "score": 0, "creation_date": 1507111099, "post_id": 46561284, "comment_id": 80077518, "body": "It works when I press F5 in VBA, but how can I make it appear automatically when typing &quot;Something&quot; in Cell C5 and press Enter?"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "reply_to_user": {"reputation": 13, "user_id": 4657988, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/942fc54a2588d7b682dbef9db2f34ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4657988/erik"}, "edited": false, "score": 0, "creation_date": 1507115929, "post_id": 46561284, "comment_id": 80080430, "body": "I have updated the code , basically you need to put the code in worksheet selection change if you want it to work when you type in something and change the cell."}, {"owner": {"reputation": 13, "user_id": 4657988, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/942fc54a2588d7b682dbef9db2f34ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4657988/erik"}, "edited": false, "score": 0, "creation_date": 1507118184, "post_id": 46561284, "comment_id": 80081776, "body": "Works perfectly now. Thanks. Do you also know how I can build on the code to change both the underlying name from Commandbutton1 to for example &quot;CommandbuttonEL1&quot; as well as change the caption to &quot;Complete&quot;?"}, {"owner": {"reputation": 13, "user_id": 4657988, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/942fc54a2588d7b682dbef9db2f34ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4657988/erik"}, "edited": false, "score": 0, "creation_date": 1507122143, "post_id": 46561284, "comment_id": 80084675, "body": "When running the code it returns the following error message:  Object variable or With block variable not set  What am I doing wrong? And how can I apply a slightly different version of the code should i want another button created on the same worksheet by using a reference from C6 instead of C5 used in this code?  Thank you for all your help."}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "reply_to_user": {"reputation": 13, "user_id": 4657988, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/942fc54a2588d7b682dbef9db2f34ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4657988/erik"}, "edited": false, "score": 0, "creation_date": 1507123253, "post_id": 46561284, "comment_id": 80085524, "body": "@Erik I&#39;m not getting any error while I&#39;m running the code. To add one more condition you can add OR condition in IF statement."}], "tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 0, "last_activity_date": 1507121030, "last_edit_date": 1507121030, "creation_date": 1507108774, "answer_id": 46561284, "question_id": 46560876, "link": "https://stackoverflow.com/questions/46560876/create-commandbutton-by-cell-value/46561284#46561284", "title": "Create commandbutton by cell value", "body": "<p>Try search the basic <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/oleobjects-add-method-excel\" rel=\"nofollow noreferrer\">syntax</a>  first ,\nMake sure your cell C5 has value \"Something\" </p>\n\n<pre><code>  Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\n    If ActiveSheet.Range(\"C5\").Value = \"Something\" Then\n            Dim button As OLEObject\n            Set button = ActiveSheet.OLEObjects.Add(ClassType:=\"Forms.CommandButton.1\", Link:=False _\n                       , DisplayAsIcon:=False, Left:=396.75, Top:=18.75, Width:=64.5, Height:=26.25)\n        End If\n\n    button.Object.Caption = \"Complete\"\n    button.Name = \"CommandbuttonEL1\"\n\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4657988, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/942fc54a2588d7b682dbef9db2f34ed7?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4657988/erik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507121030, "creation_date": 1507107571, "question_id": 46560876, "link": "https://stackoverflow.com/questions/46560876/create-commandbutton-by-cell-value", "title": "Create commandbutton by cell value", "body": "<p>I am trying to get Excel to automatically create a commandbutton if a certain cell has text in it. Through running macro recorder and via googling, this is where I'm stuck.</p>\n\n<pre><code>Private Sub button()\n\nIf ActiveSheet.Range(\"C5\") = Text Then\n\nActiveSheet.OLEObjects.Add(ClassType:=\"Forms.CommandButton.1\", Link:=False _\n    , DisplayAsIcon:=False, Left:=396.75, Top:=18.75, Width:=64.5, Height _\n    :=26.25).Select\nSelection.Verb Verb:=xlPrimary\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": true, "score": 0, "last_activity_date": 1507107994, "creation_date": 1507107994, "answer_id": 46561014, "question_id": 46560648, "link": "https://stackoverflow.com/questions/46560648/modifying-shape-colour-based-on-cell-value/46561014#46561014", "title": "Modifying shape colour based on cell value", "body": "<p>Change your code to this , your with statement is wrong.\nYou are not working with worksheet hence you cannot access range with .Range.</p>\n\n<pre><code>Sub CChange()\nDim ws As Worksheet\nSet ws = ThisWorkbook.ActiveSheet\n\n   With ws.Shapes.Range(Array(\"test\"))\n        If ws.Range(\"X11\") = 1 Then\n            .Fill.ForeColor.RGB = RGB(18, 38, 43)\n        ElseIf ws.Range(\"X11\") = 2 Then\n            .Fill.ForeColor.RGB = 0\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 123, "user_id": 7746302, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/600d7439413cb33871a0962cdb0c2e8e?s=128&d=identicon&r=PG&f=1", "display_name": "tj123", "link": "https://stackoverflow.com/users/7746302/tj123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 46561014, "answer_count": 1, "score": 1, "last_activity_date": 1507107994, "creation_date": 1507106844, "question_id": 46560648, "link": "https://stackoverflow.com/questions/46560648/modifying-shape-colour-based-on-cell-value", "title": "Modifying shape colour based on cell value", "body": "<p>Am looking to modify the shape colour based on a linked cell value ...</p>\n\n<p>The shape is 'test' and the cell value \"X11\". I'm getting the error that the object does not support this property or method ...</p>\n\n<pre><code>Sub CChange()\nDim ws As Worksheet\nSet ws = ThisWorkbook.ActiveSheet\n\n   With ws.Shapes.Range(Array(\"test\"))\n        If .Range(\"X11\") = 1 Then\n            .Fill.ForeColor.RGB = RGB(18, 38, 43)\n        ElseIf .Range(\"X11\") = 2 Then\n            .Fill.ForeColor.RGB = 0\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1507112042, "post_id": 46560560, "comment_id": 80078092, "body": "you can use <code>vlookup</code>"}], "owner": {"reputation": 986, "user_id": 1249379, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f321bb5ca87c13f07555ae616d1bdedf?s=128&d=identicon&r=PG", "display_name": "TheMightyLlama", "link": "https://stackoverflow.com/users/1249379/themightyllama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1507106940, "creation_date": 1507106540, "last_edit_date": 1507106940, "question_id": 46560560, "link": "https://stackoverflow.com/questions/46560560/excel-macro-to-match-and-concatenate-data-into-a-single-cell", "title": "Excel Macro to match and concatenate data into a single cell", "body": "<p>I've had a hunt around for some macros that might be able to do this, however my expertise is just about good enough that I can understand what's going on in other answers but sadly not yet good enough to modify the proposed solution to suit my needs. This, of course would be avoided if I could use an updated version of excel with the new <code>TextJoin</code> function. </p>\n\n<p>I currently have data in multiple sheets all of which is related. For example:</p>\n\n<p><strong>Sheet 1</strong></p>\n\n<pre><code>      A            B            C        \nROW   1 Red       url1            comment 1\nROW   2 Orange    url1            comment 2\nROW   3 Yellow    url2            comment 3\nROW   4 Green     url3            comment 4\n</code></pre>\n\n<p><strong>Sheet 2</strong></p>\n\n<pre><code>      A            B            C        \nROW   1 Red-Bike     url1         comment 1-1\nROW   2 Red-Car      url1         comment 1-2\nROW   3 Orange-Bike  url1         comment 1-3\nROW   4 Yellow-Bike  url2         comment 2-1\nROW   5 Green-Bike   url3         comment 3-1\n</code></pre>\n\n<p>The comments from the rows where urls match across sheets need to be concatenated into a third sheet like so:</p>\n\n<p><strong>Sheet 3</strong></p>\n\n<pre><code>        A            B               C\nROW 1   url1         comment 1       comment 1-1\n                     comment 2       comment 1-2\n                                     comment 1-3\n\nROW 2   url2         comment 3       comment 2-1\n\nROW 3   url3         comment 4       comment 3-1\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 3, "creation_date": 1507105100, "post_id": 46560129, "comment_id": 80073905, "body": "<code>xlUp</code>, not <code>x1Up</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1507105227, "post_id": 46560129, "comment_id": 80073972, "body": "use <code>Option Explicit</code> to avoid typos like that."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1507105552, "post_id": 46560129, "comment_id": 80074157, "body": "And <code>rng = Range(Cells(TopCell, 12), Cells(EndCell, 12)).Value</code> should be <code>Set rng = Range(Cells(TopCell + 1, 12), Cells(EndCell, 12))</code> (i.e. needs to be <code>Set</code>, don&#39;t want the <code>.Value</code> property, and probably add 1 to <code>TopCell</code> so that you don&#39;t overwrite whatever was in the last used row in column L)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8718648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f0034aa09dc3c70689e065e58ac305?s=128&d=identicon&r=PG&f=1", "display_name": "RGil", "link": "https://stackoverflow.com/users/8718648/rgil"}, "edited": false, "score": 0, "creation_date": 1507112085, "post_id": 46560318, "comment_id": 80078112, "body": "Thank you for all the comments and updates! I really appreciate the help and it is working perfectly now with the suggestion above - thanks!"}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 1, "last_activity_date": 1507106410, "last_edit_date": 1507106410, "creation_date": 1507105697, "answer_id": 46560318, "question_id": 46560129, "link": "https://stackoverflow.com/questions/46560129/finding-a-range-from-different-columns-and-inserting-a-value/46560318#46560318", "title": "Finding a range from different columns and inserting a value", "body": "<p>Something like this should work. Mainly collating the comments:</p>\n\n<ul>\n<li><code>xlUp</code> rather than <code>x1Up</code> (and <code>Option Explicit</code> to catch that yourself in future!)</li>\n<li><code>+1</code> to <code>TopCell</code> so that you don't overwrite your last value in that row</li>\n<li>Fully qualified your <code>Range</code> and <code>Cell</code> references using <code>With</code> and <code>.</code></li>\n<li>Cleaned up variables which aren't necessary -- e.g. for multiple future use or readability</li>\n</ul>\n\n<hr>\n\n<pre><code>Option Explicit    \n\nSub FillTestType(TestType As String)\n    Dim EndCell As Long\n    Dim TopCell As Long\n\n    With Worksheets(\"Sheet1\")\n        EndCell = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        TopCell = .Cells(.Rows.Count, \"L\").End(xlUp).Row + 1\n        .Range(.Cells(TopCell, 12), .Cells(EndCell, 12)).Value = TestType\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8718648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73f0034aa09dc3c70689e065e58ac305?s=128&d=identicon&r=PG&f=1", "display_name": "RGil", "link": "https://stackoverflow.com/users/8718648/rgil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1507106410, "creation_date": 1507105049, "last_edit_date": 1507105711, "question_id": 46560129, "link": "https://stackoverflow.com/questions/46560129/finding-a-range-from-different-columns-and-inserting-a-value", "title": "Finding a range from different columns and inserting a value", "body": "<p>My current challenge is that I have a list of data that has been pulled in from another workbook in Columns A-K which all finish on the same row. I want to label the data with all the same value in Column L </p>\n\n<p>The code I have is trying to find the last cell in Column A and the last cell in Column L.</p>\n\n<p>I am then trying to use the range between these two rows to insert a value across the range in Column L: </p>\n\n<pre><code>    Sub FillTestType(TestType As String)\n\n    Dim rng As Range\n    Dim wsh As Worksheet\n    Dim Row As Long\n    Dim EndCell As Long\n    Dim TopCell As Long\n\n      Set wsh = Worksheets(\"Sheet1\")\n      wsh.Activate\n\n      EndCell = Cells(Rows.count, \"A\").End(x1Up).Row\n      TopCell = Cells(Rows.count, \"L\").End(x1Up).Row\n\n      rng = Range(Cells(TopCell, 12), Cells(EndCell, 12)).Value\n\n      rng = TestType\n\n    End Sub\n</code></pre>\n\n<p>I keep getting a runtime error - Any help would be greatly appreciated! Or if I am being stupid and there is a better way to tackle the problem please do let me know.</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1507104710, "post_id": 46559907, "comment_id": 80073688, "body": "Can you also give the sweb site you are trying to scrap?"}, {"owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1507104936, "post_id": 46559907, "comment_id": 80073818, "body": "@Vityata <a href=\"https://www.europcar.co.za/\" rel=\"nofollow noreferrer\">europcar.co.za</a>"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1507107573, "post_id": 46559907, "comment_id": 80075294, "body": "Have a look at this: <a href=\"https://stackoverflow.com/questions/41688620/selecting-value-from-a-dropdown-list-on-a-webpage-using-vba\" title=\"selecting value from a dropdown list on a webpage using vba\">stackoverflow.com/questions/41688620/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1529442963, "creation_date": 1529442963, "answer_id": 50937057, "question_id": 46559907, "link": "https://stackoverflow.com/questions/46559907/how-to-select-a-time-in-a-time-picker-while-web-scraping-in-excel-vba/50937057#50937057", "title": "How to select a time in a time picker while web-scraping in excel VBA", "body": "<p><strong><a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">CSS selectors:</a></strong></p>\n\n<p>Try selector <code>#timepicker-pickup li:nth-child(10)</code></p>\n\n<pre><code>appIE.document.querySelector(\"#timepicker-pickup li:nth-child(10)\").Click\n</code></pre>\n\n<p>The <code>#</code> means className and so selects the 10th <code>li</code> tag within element with className <code>timepicker-pickup</code> </p>\n\n<p>or selector <code>#timepicker-pickup [data-value='09']</code></p>\n\n<pre><code>appIE.document.querySelector(\"#timepicker-pickup *[data-value='09']\").Click\n</code></pre>\n\n<p>This is simply an abbreviation where I look for anything with  attribute <code>data-value='09'</code> within the className of <code>timepicker-pickup</code></p>\n\n<p>I tested with the latest which works.</p>\n\n<hr>\n\n<p><strong>CSS selector:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/8EJ1O.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8EJ1O.png\" alt=\"CSS query\"></a></p>\n\n<hr>\n\n<p><strong>VBA code:</strong></p>\n\n<pre><code>Public Sub test()\n    Dim ieApp As InternetExplorer, URL As String\n\n    URL = \"https://www.europcar.co.za/\"\n    Set ieApp = New InternetExplorer\n\n    With ieApp\n        .Visible = True\n        .navigate URL\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        .document.querySelector(\"#timepicker-pickup [data-value='09']\").Click\n\n        Stop '&lt;== Delete me\n        '.Quit &lt;'== Uncomment me\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 438, "user_id": 7546144, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/185d34367f3bb1b78249439381110c9a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony", "link": "https://stackoverflow.com/users/7546144/anthony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 2, "accepted_answer_id": 50937057, "answer_count": 1, "score": 0, "last_activity_date": 1529442963, "creation_date": 1507104347, "question_id": 46559907, "link": "https://stackoverflow.com/questions/46559907/how-to-select-a-time-in-a-time-picker-while-web-scraping-in-excel-vba", "title": "How to select a time in a time picker while web-scraping in excel VBA", "body": "<p>I am trying to select 09 from the time picker below using excel VBA. I have got as far as the line below but do not know how to proceed. Any assistance would be greatly appreciated.</p>\n\n<pre><code>Set e = appIE.document.getElementbyid(\"timepicker-pickup\")\n\n\n&lt;div class=\"timepicker\" id=\"timepicker-pickup\"&gt;\n        &lt;div class=\"arrow\"&gt;&lt;/div&gt;\n        &lt;div class=\"icon close-btn\"&gt;&lt;/div&gt;\n        &lt;div class=\"inner-time-picker clearfix\"&gt;\n            &lt;div class=\"section hours\"&gt;\n                &lt;div class=\"up-arrow\"&gt;&lt;span class=\"icon arrow\"&gt;&lt;/span&gt;&lt;/div&gt;\n                &lt;div class=\"selectors\"&gt;\n                    &lt;ul&gt;\n                        &lt;li data-value=\"00\"&gt;00&lt;/li&gt;\n                        &lt;li data-value=\"01\"&gt;01&lt;/li&gt;\n                        &lt;li data-value=\"02\"&gt;02&lt;/li&gt;\n                        &lt;li data-value=\"03\"&gt;03&lt;/li&gt;\n                        &lt;li data-value=\"04\"&gt;04&lt;/li&gt;\n                        &lt;li data-value=\"05\"&gt;05&lt;/li&gt;\n                        &lt;li data-value=\"06\"&gt;06&lt;/li&gt;\n                        &lt;li data-value=\"07\"&gt;07&lt;/li&gt;\n                        &lt;li data-value=\"08\" class=\"selected\"&gt;08&lt;/li&gt;\n                        &lt;li data-value=\"09\"&gt;09&lt;/li&gt;\n                        &lt;li data-value=\"10\"&gt;10&lt;/li&gt;\n                        &lt;li data-value=\"11\"&gt;11&lt;/li&gt;\n                    &lt;/ul&gt;\n                &lt;/div&gt;\n                &lt;div class=\"down-arrow\"&gt;&lt;span class=\"icon arrow\"&gt;&lt;/span&gt;&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507104355, "post_id": 46559481, "comment_id": 80073519, "body": "I haven&#39;t tried the following but perhaps have a go with this? <a href=\"https://www.excelforum.com/excel-programming-vba-macros/378928-copy-sheet-without-links.html\" rel=\"nofollow noreferrer\">excelforum.com/excel-programming-vba-macros/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 534, "user_id": 5576580, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/o1Z7u.jpg?s=128&g=1", "display_name": "krib", "link": "https://stackoverflow.com/users/5576580/krib"}, "is_accepted": true, "score": 0, "last_activity_date": 1507104438, "creation_date": 1507104438, "answer_id": 46559931, "question_id": 46559481, "link": "https://stackoverflow.com/questions/46559481/excel-macro-copy-sheet-without-links-just-data/46559931#46559931", "title": "Excel Macro: Copy sheet without links - just data", "body": "<p>One way is this.</p>\n\n<pre><code>Sub Copy_sheet()\n\nDim wbNew As Workbook\n\nThisWorkbook.Sheets(\"Overview\").Copy \nSet wbNew = ActiveWorkbook\n\nWith wbNew\n    With .Worksheets(1).UsedRange\n         .Value = .Value\n    End With\n\n    .SaveAs \"C:\\testfolder\\testfile.xlsx\"\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 2, "last_activity_date": 1507104666, "creation_date": 1507104666, "answer_id": 46560009, "question_id": 46559481, "link": "https://stackoverflow.com/questions/46559481/excel-macro-copy-sheet-without-links-just-data/46560009#46560009", "title": "Excel Macro: Copy sheet without links - just data", "body": "<p>Add the following to your code before the <code>End sub</code>:</p>\n\n<pre><code>With ThisWorkbook.Worksheets(\"Overview\").UsedRange\n    .Value = .Value\nEnd With\n</code></pre>\n\n<p>It would change the formulas to values. If you want to do it for the whole workbook, this is the way to go:</p>\n\n<pre><code>Public Sub CopyJustData()\n\n    Dim lngCount    As Long\n\n    For lngCount = 1 To Worksheets.Count\n        With Worksheets(lngCount).UsedRange\n            .Value = .Value\n        End With\n    Next lngCount\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 12087153, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zYYBpxGkgKg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rc4exNKFK5SaUa6pvXtzTkKloo0aA/photo.jpg?sz=128", "display_name": "Miguel Angel Cortez Rodriguez", "link": "https://stackoverflow.com/users/12087153/miguel-angel-cortez-rodriguez"}, "is_accepted": false, "score": 0, "last_activity_date": 1614130094, "creation_date": 1614130094, "answer_id": 66343391, "question_id": 46559481, "link": "https://stackoverflow.com/questions/46559481/excel-macro-copy-sheet-without-links-just-data/66343391#66343391", "title": "Excel Macro: Copy sheet without links - just data", "body": "<pre><code>Sub SaveCopy\n    ThisWorkbook.Sheets(&quot;your sheet name&quot;).Select\n    ActiveSheet.Copy\n    ActiveSheet.SaveAs FileName:=&quot;your path to save &quot;&amp; &quot;.xlsx&quot; 'xlsx or your other\n    BreakLinks ' \nEnd Sub\n\nSub BreakLinks()\n    On Error Resume Next\n    Dim vLinks As Variant\n    Dim lLink As Long\n \n    ' Define variable as an Excel link type.\n    vLinks = ActiveWorkbook.LinkSources(Type:=xlLinkTypeExcelLinks)\n    If vLinks = vbNullString Then Exit Sub\n \n    ' Break all links in the active workbook.\n    For lLink = LBound(vLinks) To UBound(vLinks)\n        ActiveWorkbook.BreakLink _\n                Name:=vLinks(lLink), _\n                Type:=xlLinkTypeExcelLinks\n    Next lLink\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 8010886, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/602004aa56f2ad6b5001601d00494c8e?s=128&d=identicon&r=PG&f=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/8010886/andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4682, "favorite_count": 0, "accepted_answer_id": 46559931, "answer_count": 3, "score": 1, "last_activity_date": 1614130094, "creation_date": 1507102799, "last_edit_date": 1507103034, "question_id": 46559481, "link": "https://stackoverflow.com/questions/46559481/excel-macro-copy-sheet-without-links-just-data", "title": "Excel Macro: Copy sheet without links - just data", "body": "<p>I would like to copy one specific sheet in MS Excel to a new file. The following Macro does the job, but the problem is that the copy always links the cells to the original file. Is there a way to insert only the values of this sheet without the links?</p>\n\n<pre><code>Sub Copy_sheet()\n\n    ThisWorkbook.Sheets(\"Overview\").Copy\n\n    ActiveWorkbook.SaveAs \"C:\\testfolder\\testfile.xlsx\", FileFormat:=51\n\nEnd Sub\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "crash", "vba"], "comments": [{"owner": {"reputation": 432, "user_id": 3626597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xju6d.jpg?s=128&g=1", "display_name": "Tima", "link": "https://stackoverflow.com/users/3626597/tima"}, "edited": false, "score": 0, "creation_date": 1507103379, "post_id": 46559233, "comment_id": 80072993, "body": "To know the difference take a look at these: <a href=\"https://www.ablebits.com/office-addins-blog/2011/09/23/excel-tables-ranges/\" rel=\"nofollow noreferrer\">ablebits.com/office-addins-blog/2011/09/23/excel-tables-rang&zwnj;&#8203;es</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1507103580, "post_id": 46559233, "comment_id": 80073118, "body": "cool. What kind of error is it? If it is a VBA error, then the code would be useful."}, {"owner": {"reputation": 432, "user_id": 3626597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xju6d.jpg?s=128&g=1", "display_name": "Tima", "link": "https://stackoverflow.com/users/3626597/tima"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1507103741, "post_id": 46559233, "comment_id": 80073212, "body": "No, its not a VBA error at all its a Windows Error &quot;The Program has stopped working&quot; and excel is terminated after. Its the error that you get when an application crashes."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1507103799, "post_id": 46559233, "comment_id": 80073242, "body": "cool. Do you have some events in those worksheets?"}, {"owner": {"reputation": 432, "user_id": 3626597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xju6d.jpg?s=128&g=1", "display_name": "Tima", "link": "https://stackoverflow.com/users/3626597/tima"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1507105542, "post_id": 46559233, "comment_id": 80074152, "body": "I have many events but I am not sure if this the case as there are other sheets are working normally."}], "owner": {"reputation": 432, "user_id": 3626597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/xju6d.jpg?s=128&g=1", "display_name": "Tima", "link": "https://stackoverflow.com/users/3626597/tima"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507109359, "creation_date": 1507101871, "last_edit_date": 1531164843, "question_id": 46559233, "link": "https://stackoverflow.com/questions/46559233/excel-crashes-on-direct-input-excel-vba", "title": "Excel crashes on Direct Input - Excel (VBA)", "body": "<p>I have a strange bug problem where excel keeps crashing when I simply input a value in a <strong>Table cell</strong> not range.</p>\n\n<p>More Illustration on the problem:</p>\n\n<p>I made a workbook (Shorthand: WB) full of codes using (MS Excel 2010), the WB have more than 15 sheets and lots of <em>tables</em> and <em>defined names</em>; each sheet has at least 1 table.Everything works fine, now, when I tried the WB on (MS Excel 2016) <strong>some</strong> sheets causes the application to crash when I input values (e.g. 10,20,A,B, ... , etc) in <strong>table cells</strong>, not a normal range, but when I input my value as formula (e.g. =10) everything is fine, also I have tried entering the values in an empty range then copying them to the table cells and this works fine.</p>\n\n<p>At first I suspected that it has something to do with the missing reference as I was using OWC11 in the PC with (MS Excel 2010) and it was not there on the PC with (MS Excel 2016) so I installed but the problem is still there.</p>\n\n<p>Also, for info I tried the WB on multiple PCs with (MS Excel 2013 &amp; 2016)</p>\n\n<p>I really can't find any logical reason for this crash.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vi3oh.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vi3oh.png\" alt=\"Table vs Range\"></a></p>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>I tried adding data validation to the cell causing the crash then remove it and I was surprised that the crash was gone !!!</p>\n"}, {"tags": ["vba", "pdf", "printing"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1507103780, "post_id": 46559063, "comment_id": 80073236, "body": "use google to find out how to check the default printer and how to change it"}, {"owner": {"reputation": 31, "user_id": 8695413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c81bb131fb36ed23b4f4e0c82c30eb?s=128&d=identicon&r=PG&f=1", "display_name": "linke95", "link": "https://stackoverflow.com/users/8695413/linke95"}, "reply_to_user": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1507104096, "post_id": 46559063, "comment_id": 80073388, "body": "i tried to find the solution but i havent find any thats why i ask question on stack"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 8695413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c81bb131fb36ed23b4f4e0c82c30eb?s=128&d=identicon&r=PG&f=1", "display_name": "linke95", "link": "https://stackoverflow.com/users/8695413/linke95"}, "edited": false, "score": 0, "creation_date": 1507275908, "post_id": 46573274, "comment_id": 80153361, "body": "Thanks for your answer, but how can i print website to a specific folder. I have a path to the folder."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 31, "user_id": 8695413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c81bb131fb36ed23b4f4e0c82c30eb?s=128&d=identicon&r=PG&f=1", "display_name": "linke95", "link": "https://stackoverflow.com/users/8695413/linke95"}, "edited": false, "score": 0, "creation_date": 1507310707, "post_id": 46573274, "comment_id": 80173816, "body": "that is not your original question. please submit another post for this question."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1507147425, "creation_date": 1507147425, "answer_id": 46573274, "question_id": 46559063, "link": "https://stackoverflow.com/questions/46559063/print-wesite-to-pdf-using-vba/46573274#46573274", "title": "Print Wesite to PDF using VBA", "body": "<p>this took less than 10 minutes to find</p>\n\n<p>just change your <code>default printer</code> in windows and check the value of <code>Application.ActivePrinter</code> to get the exact name of the printer that you want to use</p>\n\n<p>there are ways to get a list of system printers by executing system calls.</p>\n\n<pre><code>Option Explicit\n\nSub switchPrinters()\n    Dim ptr As String\n\n    ptr = Application.ActivePrinter\n    Application.ActivePrinter = \"HP Deskjet 3520 USB on Ne03:\" ' \"printer_name on port_name\" \n    Activesheet.Printout\n    Application.ActivePrinter = ptr\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 8695413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c81bb131fb36ed23b4f4e0c82c30eb?s=128&d=identicon&r=PG&f=1", "display_name": "linke95", "link": "https://stackoverflow.com/users/8695413/linke95"}, "is_accepted": false, "score": 1, "last_activity_date": 1507282352, "creation_date": 1507282352, "answer_id": 46602650, "question_id": 46559063, "link": "https://stackoverflow.com/questions/46559063/print-wesite-to-pdf-using-vba/46602650#46602650", "title": "Print Wesite to PDF using VBA", "body": "<p>My code looks like this and now i would like to print website to PDF  </p>\n\n<pre><code>Dim sPrinter As String\nDim sDefaultPrinter As String\nDebug.Print \"Default printer: \", Application.ActivePrinter\nsDefaultPrinter = Application.ActivePrinter ' store default printer\nsPrinter = GetPrinterFullName(\"Microsoft Print to PDF\")\nIf sPrinter = vbNullString Then ' no match\n    Debug.Print \"No match\"\nElse\n    Application.ActivePrinter = sPrinter\n    Debug.Print \"Temp printer: \", Application.ActivePrinter\n    ' do something with the temp printer\n    ' Przechodzenie przez strony wraz z zapisem\n    For Each URL In URLs\n     Dim IEs As InternetExplorerMedium\n     Set IEs = CreateObject(\"InternetExplorer.Application\")\n     str_text = Replace(URL.getAttribute(\"href\"), \"\", \"\")\n     str_text = Replace(str_text, \"\", \"\")\n\n     IEs.Navigate str_text\n     IEs.Visible = True\n     Do While IEs.ReadyState &lt;&gt; READYSTATE_COMPLETE Or IEs.Busy\n     Loop\n\n\n\n     'HERE I WOLULD LIKE TO PRINT IEs TO PDF (specific path, and filename:)\n\n\n     IEs.Quit\n     Set IEs = Nothing\n    i = i + 1\n    If i = 5 Then Exit For\n    Next URL\n    Application.ActivePrinter = sDefaultPrinter ' restore default printer\nEnd If\nDebug.Print \"Default printer: \", Application.ActivePrinter\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8695413, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38c81bb131fb36ed23b4f4e0c82c30eb?s=128&d=identicon&r=PG&f=1", "display_name": "linke95", "link": "https://stackoverflow.com/users/8695413/linke95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4030, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1507282352, "creation_date": 1507101270, "last_edit_date": 1507101559, "question_id": 46559063, "link": "https://stackoverflow.com/questions/46559063/print-wesite-to-pdf-using-vba", "title": "Print Wesite to PDF using VBA", "body": "<p>I am trying to save HTML as PDF using VBA.</p>\n\n<p>I don't know how to check what is the default printer change it to Microsoft Print to PDF and then back to the old printer.</p>\n\n<p>Below is my code: I search something on Google, then enter the links on the first Google Search page and then I would like to print searches to PDF. </p>\n\n\n\n<pre class=\"lang-vba prettyprint-override\"><code>Sub Main()\n\n    Dim search As String\n    Dim save_path As String\n    Dim number As Integer\n\n    number = 5\n    save_path = \"\"\n\n    Dim query As String\n    query = InputBox(\"Enter here your search\", \"Google Search\")\n    search = query\n    search = Replace(search, \" \", \"+\")\n    PDFFolderSelection save_path, search\n\n    Debug.Print save_path, search\n    Google_Search search, save_path, number\nEnd Sub\n\nSub Google_Search(search As String, save_path As String, number As Integer)    \n    Dim IE As InternetExplorerMedium\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n    Dim HTMLDoc As MSHTML.HTMLDocument\n\n    IE.Navigate \"http://google.com/#q=\" &amp; search\n    IE.Visible = True\n\n    Do While IE.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    Loop\n\n    Set HTMLDoc = IE.Document\n\n\n    Dim RCS As MSHTML.IHTMLElementCollection\n    Dim RC As MSHTML.IHTMLElement\n    Set RCS = HTMLDoc.getElementsByClassName(\"rc\")\n    Dim Atags As MSHTML.IHTMLElementCollection\n    Dim Atag As MSHTML.IHTMLElement\n\n    Dim URLs As New Collection\n    Dim URL As MSHTML.IHTMLElement\n    Set URLs = Nothing\n\n\n    For Each RC In RCS\n     Dim RS As MSHTML.IHTMLElementCollection\n     Dim R As MSHTML.IHTMLElement\n     Set RS = RC.getElementsByClassName(\"r\")\n        For Each R In RS\n         Set Atags = R.getElementsByTagName(\"a\")\n            For Each Atag In Atags\n             URLs.Add Atag\n            Next Atag\n        Next R\n    Next RC\n\n    For Each URL In URLs\n        Dim IEs As InternetExplorerMedium\n        Set IEs = CreateObject(\"InternetExplorer.Application\")\n        str_text = Replace(URL.getAttribute(\"href\"), \"\", \"\")\n        str_text = Replace(str_text, \"\", \"\")\n        'Debug.Print str_text\n        IEs.Navigate str_text\n        IEs.Visible = True\n        Do While IEs.ReadyState &lt;&gt; READYSTATE_COMPLETE Or IEs.Busy\n        Loop\n\n        IEs.Quit\n        Set IEs = Nothing\n    Next URL\n\n    IE.Quit\n    Set IE = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1507100842, "post_id": 46558817, "comment_id": 80071594, "body": "First thing is that you should get rid of <code>.Select</code> this is a very bad practice and always slows down your code. There are many tutorials out there how to avoid using <code>.Select</code>. Also look at <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-screenupdating-property-excel\" rel=\"nofollow noreferrer\">Application.ScreenUpdating Property (Excel)</a> and consider switching to manual calculation mode at the beginning of your code and switch back to automatic in the end, see <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-calculation-property-excel\" rel=\"nofollow noreferrer\">Application.Calculation Property (Excel)</a>."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507100997, "post_id": 46558817, "comment_id": 80071674, "body": "Avoid .Select e.g. Cells(10 + a, 7 + i).Select  ActiveCell.FormulaR1C1   can be written as  Cells(10 + a, 7 + i).FormulaR1C1. Also, use With Statement when working with Objects e.g. <a href=\"http://www.ozgrid.com/VBA/SpeedingUpVBACode.htm\" rel=\"nofollow noreferrer\">ozgrid.com/VBA/SpeedingUpVBACode.htm</a>"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 1, "creation_date": 1507298810, "post_id": 46558817, "comment_id": 80167078, "body": "Without .select I went down from 166 processing time to 41s and then 26s with manual calculation Thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1507298950, "post_id": 46559090, "comment_id": 80167159, "body": "This helped a lot already, but the .SpecialCells(xlCellTypeBlanks) didn t work out for me because the sheet is protected. And using Range(myRange).FormulaR1C1 = ... without the SpecialCells ended up even more slow than my 2 loops. Did I do something wrong?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1507299063, "post_id": 46559090, "comment_id": 80167229, "body": "What error message were you getting with the .SpecialCells method?"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1507299470, "post_id": 46559090, "comment_id": 80167473, "body": "Runtime error 1004: You cannot use this command on a protected sheet. [...]"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1507299693, "post_id": 46559090, "comment_id": 80167626, "body": "1) Do you know the password for the sheet?  2) What are you trying to achieve with the long formula? Is there an example input and expected output you could give?"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1507299890, "post_id": 46559090, "comment_id": 80167768, "body": "No I do not have the password. The formula is getting something from another sheet (index Match match) then translating it through a third sheet (index match match) in case the first word is a word."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1507300028, "post_id": 46559090, "comment_id": 80167855, "body": "Can you manually type the formula into one of the target cells? I am trying to understand how you would input formulas into a protected sheet if that is the case."}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1507300150, "post_id": 46559090, "comment_id": 80167933, "body": "Yes it works I am also confused. The only thing that changes is the SpecialCells part."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1507101721, "last_edit_date": 1507101721, "creation_date": 1507101363, "answer_id": 46559090, "question_id": 46558817, "link": "https://stackoverflow.com/questions/46558817/using-an-array-with-table-and-loop/46559090#46559090", "title": "Using an Array with table and loop", "body": "<p>If you are effectively defining a range you can use the first and last columns and rows addresses and create a range object.\nSee examples here: <a href=\"https://www.thespreadsheetguru.com/blog/5-ways-to-create-a-dynamic-auto-adjusting-vba-range\" rel=\"nofollow noreferrer\">Dynamic ranges</a></p>\n\n<p>You can then do:\nRange(myRange).SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"LongFormula\"\nwhich effectively replaces all blank cells with your formula without having to do all the loops.</p>\n\n<p>Combine those steps with the items mentioned in the comments such as avoiding .select.</p>\n\n<p>Summary:</p>\n\n<p>Avoid the .select</p>\n\n<p>Use WITH where possible when working with objects</p>\n\n<p>Get the first cell address and last cell address and create your range object</p>\n\n<p>Use the special cells method to set blanks in this range to your formula.</p>\n"}], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507101721, "creation_date": 1507100392, "last_edit_date": 1507100888, "question_id": 46558817, "link": "https://stackoverflow.com/questions/46558817/using-an-array-with-table-and-loop", "title": "Using an Array with table and loop", "body": "<p>I am sorry if this sort of questions has already been asked, I couldn't find the answer I needed and I am quite new to VBA. </p>\n\n<p>I am trying to match some values from one table to the other via an Index Match which is moving between 2 Workbooks. To do this properly I have used two loops For To. But my Code is really slow when it comes to a few thousands lines. Can I improve it with an Array or something else?</p>\n\n<pre><code>Dim mainWB  As Workbook\nDim mainWS  As Worksheet\nSet mainWB = ActiveWorkbook\nSet mainWS = mainWB.Sheets(1)\n\nDim RowsToProcess As Long\nRowsToProcess = mainWS.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\n\nDim lastCol As Long\nlastCol = mainWS.Cells(10, Columns.Count).End(xlToLeft).Column\n\nRange(Cells(11, 8), Cells(RowsToProcess, lastCol)).Select\nSelection.NumberFormat = \"General\"\n\nFor i = 1 To lastCol\n    For a = 1 To RowsToProcess\n        If Workbooks(\"template.xls\").Sheets(\"#\").Cells(10 + a, 7 + i).Value &lt;&gt; vbNullString Then\n            Cells(10 + a, 7 + i).Select\n            ActiveCell.FormulaR1C1 = _\n                \"= \"Long Formula\" \"\n        End If\n    Next\nNext\n</code></pre>\n\n<p>For my Long formula. It is basically doing 2 Index(Match. between this Workbook and 2 others, but I thought I would take it out here to keep it clearer</p>\n\n<p>Thank you very much for the help! </p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 8095118, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb9ec0f3a30a819ecd9621b06d1918e5?s=128&d=identicon&r=PG&f=1", "display_name": "shaadi", "link": "https://stackoverflow.com/users/8095118/shaadi"}, "edited": false, "score": 0, "creation_date": 1507101692, "post_id": 46558991, "comment_id": 80072083, "body": "Thanks micheal do I need to paste this formula in Column A or different column basically I don&#39;&#39;t really understand this formula"}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "reply_to_user": {"reputation": 131, "user_id": 8095118, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb9ec0f3a30a819ecd9621b06d1918e5?s=128&d=identicon&r=PG&f=1", "display_name": "shaadi", "link": "https://stackoverflow.com/users/8095118/shaadi"}, "edited": false, "score": 0, "creation_date": 1507157885, "post_id": 46558991, "comment_id": 80104304, "body": "A2:B4 represents where your data is as per your example. The formula would go into E2 in your example. It can go into any column, but must start in the 2nd row and then be filled down."}], "tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1507101011, "creation_date": 1507101011, "answer_id": 46558991, "question_id": 46558816, "link": "https://stackoverflow.com/questions/46558816/how-to-combine-cell-vertically-in-excel/46558991#46558991", "title": "how to combine cell vertically in excel", "body": "<p>You can use the INDEX function to refer to each cell. If data is in A2:B4, this formula works in any column but must start in row 2 and can then be filled down:</p>\n\n<pre><code>=INDEX($A$2:$B$4,ROW()/2,MOD(ROW(),2)+1)\n</code></pre>\n\n<p>The formula uses the current row as a counter. On every even row it gets a value from the first column of data and on every odd row it gets a value from the second column of data. After every 2 rows it gets values from the next row of data.</p>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 8095118, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb9ec0f3a30a819ecd9621b06d1918e5?s=128&d=identicon&r=PG&f=1", "display_name": "shaadi", "link": "https://stackoverflow.com/users/8095118/shaadi"}, "edited": false, "score": 0, "creation_date": 1507102174, "post_id": 46559092, "comment_id": 80072320, "body": "Thanks Michael it is working I want to learn what  output.Offset(i, 0) = cell and     i = i + 1 is doing?"}, {"owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "reply_to_user": {"reputation": 131, "user_id": 8095118, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb9ec0f3a30a819ecd9621b06d1918e5?s=128&d=identicon&r=PG&f=1", "display_name": "shaadi", "link": "https://stackoverflow.com/users/8095118/shaadi"}, "edited": false, "score": 0, "creation_date": 1507157823, "post_id": 46559092, "comment_id": 80104289, "body": "Read up on the Offset property. Each loop is putting the value from the current cell in the data range into the next row below the starting output range D2. <a href=\"https://msdn.microsoft.com/en-us/library/office/aa221543(v=office.11).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": true, "score": 3, "last_activity_date": 1507101372, "creation_date": 1507101372, "answer_id": 46559092, "question_id": 46558816, "link": "https://stackoverflow.com/questions/46558816/how-to-combine-cell-vertically-in-excel/46559092#46559092", "title": "how to combine cell vertically in excel", "body": "<p>You can create a simple loop in VBA that runs through each cell in the data range then adds it to the output column</p>\n\n<pre><code>Sub Merge()\n\nDim data As Range\nDim cell As Range\nDim output As Range\nDim i As Integer\n\nSet data = Range(\"A2:B4\")\nSet output = Range(\"D2\")\ni = 0\n\nFor Each cell In data\n    output.Offset(i, 0) = cell\n    i = i + 1\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 8095118, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fb9ec0f3a30a819ecd9621b06d1918e5?s=128&d=identicon&r=PG&f=1", "display_name": "shaadi", "link": "https://stackoverflow.com/users/8095118/shaadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1745, "favorite_count": 0, "accepted_answer_id": 46559092, "answer_count": 2, "score": 0, "last_activity_date": 1507104670, "creation_date": 1507100392, "last_edit_date": 1507104670, "question_id": 46558816, "link": "https://stackoverflow.com/questions/46558816/how-to-combine-cell-vertically-in-excel", "title": "how to combine cell vertically in excel", "body": "<p>It might be the most silly question in planet. how can I merge two cell values vertically in a repeated manner. as like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/doLSM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/doLSM.png\" alt=\"enter image description here\"></a></p>\n\n<p>Column A and B has 400+ cells therefore it is impossible to do what I want to achieve manually.</p>\n\n<p>Note: I want to merge B into A.</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 7236036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-bVSLUV0vRnU/AAAAAAAAAAI/AAAAAAAAAWY/FhE3mrs_gjM/photo.jpg?sz=128", "display_name": "Jakes Van Niekerk", "link": "https://stackoverflow.com/users/7236036/jakes-van-niekerk"}, "edited": false, "score": 0, "creation_date": 1507625069, "post_id": 46594430, "comment_id": 80272958, "body": "I hear what you are saying. Let me break it down from your solution and then try it in sections. For now i&#39;ve set it up to count folder items, and i&#39;ve set a rule to move the responses into that folder in order to use the macro to keep count and automatically respond with a template.  Counting the attendees would be a much cleaner solution, maybe, if i&#39;m brave enough, i&#39;ll attempt to remove cancellations automatically :-D  I will take another shot at it in a bit and come back."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 57, "user_id": 7236036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-bVSLUV0vRnU/AAAAAAAAAAI/AAAAAAAAAWY/FhE3mrs_gjM/photo.jpg?sz=128", "display_name": "Jakes Van Niekerk", "link": "https://stackoverflow.com/users/7236036/jakes-van-niekerk"}, "edited": false, "score": 1, "creation_date": 1507657037, "post_id": 46594430, "comment_id": 80293833, "body": "@Jakes answer now includes a count of responses"}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 1, "last_activity_date": 1507656861, "last_edit_date": 1507656861, "creation_date": 1507235914, "answer_id": 46594430, "question_id": 46558706, "link": "https://stackoverflow.com/questions/46558706/how-do-i-count-meeting-participants-before-adding-another-in-outlook/46594430#46594430", "title": "How do I count meeting participants before adding another in Outlook", "body": "<p>I believe the question is too broad and could be split into at least three separate questions. Focusing on \"How do I count the total participants of a meeting\" without the adding and sending part.</p>\n\n<p>I have to assume you run the code when a response arrives.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub objNewMailItems_ItemAdd_Test()\n    ' first open up a response to a meeting invitation\n    objNewMailItems_ItemAdd ActiveInspector.currentItem\nEnd Sub\n\n\nPrivate Sub objNewMailItems_ItemAdd(ByVal Item As Object)\n\nDim oAppt As AppointmentItem\n\nDim objAttendees As Recipients\nDim objAttendee As Recipient\n\nDim lRequiredAttendeeCount As Long\nDim lOptionalAttendeeCount  As Long\nDim lResourceCount As Long\n\nDim possibleAttendees As Long\n\nDim limitedAtendees As Long\n\n' For testing purposes\nlimitedAtendees = InputBox(Prompt:=\"Enter the maximum number of invitations allowed\", Default:=\"2\")\n\n'limitedAtendees = some maximum\n\n\n' Kiss of death removed\n'On Error Resume Next\n\nIf TypeOf Item Is MeetingItem Then\n\n    ' Bypass one error only, for a specific purpose\n    On Error Resume Next\n    Set oAppt = Item.GetAssociatedAppointment(True)\n    ' Turn off bypass\n    On Error GoTo 0\n\n    If oAppt Is Nothing Then\n        MsgBox \"No associated appointment found.\"\n        Exit Sub\n    End If\n\n    Set objAttendees = oAppt.Recipients\n    'Debug.Print objAttendees.count\n\n    lRequiredAttendeeCount = 0\n    lOptionalAttendeeCount = 0\n    lResourceCount = 0\n\n    'Count the required &amp; optional attendees and resources, etc.\n\n    For Each objAttendee In objAttendees\n\n        'Debug.Print objAttendee\n\n        If objAttendee.Type = olRequired Then\n            lRequiredAttendeeCount = lRequiredAttendeeCount + 1\n        'ElseIf objAttendee.Type = olOptional Then\n        '    lOptionalAttendeeCount = lOptionalAttendeeCount + 1\n        'ElseIf objAttendee.Type = olResource Then\n        '    lResourceCount = lResourceCount + 1\n        End If\n\n    Next\n\n    If lRequiredAttendeeCount &gt; limitedAtendees Then\n        MsgBox \"Invitations to Required Atendees: \" &amp; lRequiredAttendeeCount &amp; vbCr &amp; _\n          \"This is more than the limit of.......: \" &amp; limitedAtendees, vbOKOnly\n    Else\n        MsgBox \"Invitations to Required Atendees: \" &amp; lRequiredAttendeeCount &amp; vbCr &amp; _\n          \"This is within the limit of...........: \" &amp; limitedAtendees, vbOKOnly\n    End If\n\n    If objAttendees.count &gt; limitedAtendees Then\n        MsgBox \"Invitations to All Atendees..: \" &amp; objAttendees.count &amp; vbCr &amp; _\n          \"This is more than the limit of: \" &amp; limitedAtendees, vbOKOnly\n    Else\n        MsgBox \"Invitations to All Atendees: \" &amp; lRequiredAttendeeCount &amp; vbCr &amp; _\n          \"This is within the limit of....: \" &amp; limitedAtendees, vbOKOnly\n    End If\n\nEnd If\n\nExitRoutine:\n    Set oAppt = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Edit 2071010</p>\n\n<p>The code in the question points to a count of invitations but appears you need a count of responses.</p>\n\n<pre><code>Private Sub objNewMailItems_ItemAdd(ByVal Item As Object)\n\nDim objAppt As AppointmentItem\nDim objAttendee As Recipient\n\nDim lOrganizerAttendeeCount As Long\nDim lRequiredAttendeeCount As Long\nDim lOptionalAttendeeCount As Long\nDim lResourceCount As Long\n\nDim attendeeOrganizerNoneCount As Long\nDim attendeeAcceptedCount As Long\nDim attendeeTentativeCount As Long\nDim attendeeDeclinedCount As Long\nDim attendeeNotRespondedCount As Long\n\nDim invitedAttendees As Long\nDim respondingAttendees As Long\n\nDim uPrompt As String\nDim uTitle As String\n\nDebug.Print\nDebug.Print \"Item.Class: \" &amp; Item.Class\n\n'  26 - AppointmentItem\n'\n' Various MeetingItems\n'  53 to 57\n'  53 - should be the initial invitation\n' 181 - Meeting Forward Notification\n'  - with no response (0), the invited person counts as a \"None\" response\n\nIf Item.Class = 26 Then\n    Set objAppt = Item\n\n' tested\n'   olMeetingResponsePositive\n'    53\n'   181\nElseIf Item.Class = olMeetingResponsePositive Or _\n  Item.Class = olMeetingResponseTentative Or _\n  Item.Class = olMeetingResponseNegative Or _\n  Item.Class = 53 Or _\n  Item.Class = 54 Or _\n  Item.Class = 55 Or _\n  Item.Class = 56 Or _\n  Item.Class = 57 Or _\n  Item.Class = 181 Then\n\n    ' Bypass errors for a specific purpose\n    On Error Resume Next\n    Set objAppt = Item.GetAssociatedAppointment(True)\n    ' Turn error bypass off\n    On Error GoTo 0\n\n    If objAppt Is Nothing Then\n        MsgBox \"No appointment associated with the meeting response \" &amp; _\n          vbCr &amp; vbCr &amp; Item.Subject\n        Exit Sub\n    End If\n\nElse\n    MsgBox \"Item class \" &amp; Item.Class &amp; \" not recognized in this code. \"\n    Exit Sub\n\nEnd If\n\nFor Each objAttendee In objAppt.Recipients\n\n    Debug.Print\n    Debug.Print \"Invitee name...: \" &amp; objAttendee.name\n\n    'Count the invitations\n\n    Debug.Print \"Invitation Type: \" &amp; objAttendee.Type\n\n    ' https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/olmeetingrecipienttype-enumeration-outlook\n    ' 0 = olOrganizer\n    ' 1 = olRequired\n    ' 2 = olOptional\n    ' 3 = olResource\n\n    Select Case objAttendee.Type\n\n        Case 0\n            lOrganizerAttendeeCount = lOrganizerAttendeeCount + 1\n\n        Case 1\n            lRequiredAttendeeCount = lRequiredAttendeeCount + 1\n\n        Case 2\n            lOptionalAttendeeCount = lOptionalAttendeeCount + 1\n\n        Case 3\n            lResourceCount = lResourceCount + 1\n\n    End Select\n\n    ' Count the responses\n\n    Debug.Print \"Response Status: \" &amp; objAttendee.MeetingResponseStatus\n\n    ' https://msdn.microsoft.com/VBA/Outlook-VBA/articles/olresponsestatus-enumeration-outlook\n    ' 0 = \"None\" - This is what I get as the organizer\n    ' 1 = \"Organized\"\n    ' 2 = \"Tentative\"\n    ' 3 = \"Accepted\"\n    ' 4 = \"Declined\"\n    ' 5 = \"Not Responded\"\n\n    Select Case objAttendee.MeetingResponseStatus\n\n        Case 0\n             attendeeOrganizerNoneCount = attendeeOrganizerNoneCount + 1\n\n        Case 1\n            attendeeOrganizerNoneCount = attendeeOrganizerNoneCount + 1\n\n        Case 2\n            attendeeTentativeCount = attendeeTentativeCount + 1\n\n        Case 3\n            attendeeAcceptedCount = attendeeAcceptedCount + 1\n\n        Case 4\n            attendeeDeclinedCount = attendeeDeclinedCount + 1\n\n        Case 5\n            attendeeNotRespondedCount = attendeeNotRespondedCount + 1\n\n    End Select\n\n    Set objAttendee = Nothing\n\nNext\n\ninvitedAttendees = lOrganizerAttendeeCount + lRequiredAttendeeCount + _\n                    lOptionalAttendeeCount + lResourceCount\n\nrespondingAttendees = attendeeOrganizerNoneCount + attendeeAcceptedCount + _\n                    attendeeTentativeCount + attendeeDeclinedCount + attendeeNotRespondedCount\n\n' Display results\nuTitle = \"Attendees for \" &amp; objAppt.Subject\n\nuPrompt = \"Invitations:\" &amp; vbCr &amp; _\n  \" \" &amp; lOrganizerAttendeeCount &amp; \" :Organizer\" &amp; vbCr &amp; _\n  \" \" &amp; lRequiredAttendeeCount &amp; \" :Required\" &amp; vbCr &amp; _\n  \" \" &amp; lOptionalAttendeeCount &amp; \" :Optional\" &amp; vbCr &amp; _\n  \" \" &amp; lResourceCount &amp; \" :Resource\" &amp; vbCr &amp; _\n  \" \" &amp; invitedAttendees &amp; \" : TOTAL\" &amp; vbCr &amp; vbCr\n\nuPrompt = uPrompt &amp; \" Responses:\" &amp; vbCr &amp; _\n  \" \" &amp; attendeeOrganizerNoneCount &amp; \" :organizer none\" &amp; vbCr &amp; _\n  \" \" &amp; attendeeAcceptedCount &amp; \" :accepts\" &amp; vbCr &amp; _\n  \" \" &amp; attendeeTentativeCount &amp; \" :tentatives\" &amp; vbCr &amp; _\n  \" \" &amp; attendeeDeclinedCount &amp; \" :declines\" &amp; vbCr &amp; _\n  \" \" &amp; attendeeNotRespondedCount &amp; \" :no responses\" &amp; vbCr &amp; _\n  \" \" &amp; respondingAttendees &amp; \" : TOTAL\"\n\n    MsgBox Prompt:=uPrompt, Title:=uTitle\n\nExitRoutine:\n    Set objAppt = Nothing\n    Set objAttendee = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 7236036, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh4.googleusercontent.com/-bVSLUV0vRnU/AAAAAAAAAAI/AAAAAAAAAWY/FhE3mrs_gjM/photo.jpg?sz=128", "display_name": "Jakes Van Niekerk", "link": "https://stackoverflow.com/users/7236036/jakes-van-niekerk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 733, "favorite_count": 0, "accepted_answer_id": 46594430, "answer_count": 1, "score": 0, "last_activity_date": 1593071412, "creation_date": 1507100012, "last_edit_date": 1593071412, "question_id": 46558706, "link": "https://stackoverflow.com/questions/46558706/how-do-i-count-meeting-participants-before-adding-another-in-outlook", "title": "How do I count meeting participants before adding another in Outlook", "body": "<p><strong>How do i count the total participants of a meeting before adding another and sending it?</strong></p>\n\n<p>I've managed to automate calendar invites based on specific responses. </p>\n\n<p>I now need to set a max number of participants and respond with a mail if the maximum number of participants for that meeting or event has been reached.</p>\n\n<p>It seems to stay on \"1\" if i check the value.</p>\n\n<p>This is as far as i've been able to come without reaching out for help on it.</p>\n\n<pre><code>Private Sub objNewMailItems_ItemAdd(ByVal Item As Object)\n\n\nDim objMeetingInvitation As Outlook.MeetingItem\nDim objMeeting As Outlook.AppointmentItem\nDim objAttendees As Outlook.Recipients\nDim objAttendee As Outlook.Recipient\nDim lRequiredAttendeeCount, lOptionalAttendeeCount, lResourceCount As Long\nDim strMsg As String\nDim nPrompt As Integer\n\n\nOn Error Resume Next\n\nDim olMailItem As MailItem\nDim strAttachementName As String\nDim oRespond As Outlook.MailItem\nDim mesgBody As String\nDim oApp As Outlook.Application\nDim oCalFolder As Outlook.MAPIFolder\nDim oAppt As Outlook.AppointmentItem\nDim sOldText As String\nDim sNewText As String\nDim iCalChangedCount As Integer\nDim mail As Outlook.MailItem\nSet oApp = Outlook.Application\nDim nmSpace As Outlook.NameSpace\nSet nmSpace = oApp.GetNamespace(\"MAPI\")\nSet oCalFolder = nmSpace.GetDefaultFolder(olFolderCalendar)\n\n        If TypeOf Item Is MailItem Then\n\n                    Set olMailItem = Item\n                    Set objMeetingInvitation = Item\n                    Set objMeeting = objMeetingInvitation.GetAssociatedAppointment(True)\n                    Set objAttendees = objMeetingInvitation.Recipients\n\n                    lRequiredAttendeeCount = 0\n                    lOptionalAttendeeCount = 0\n                    lResourceCount = 0\n\n                   'Count the required &amp; optional attendees and resources, etc.\n\n\n                    '===============================================================================================================\n                    ' Please note...\n                    '\n                    '   I used mailto:jakes@******.co.za?subject=Yes,%20please%20include%20me&amp;body=I%20would%20like%20to%20join\n                    '   as a \"mailto:\" response\n                    '\n                    '===============================================================================================================\n\n\n                        If InStr(olMailItem.Subject, \"Testing the Calendar\") &gt; 0 Then\n                        sOldText = \"Test Calendar\"\n\n                            For Each objAttendee In objAttendees\n                                If objAttendee.Type = olRequired Then\n                                   lRequiredAttendeeCount = lRequiredAttendeeCount + 1\n                                ElseIf objAttendee.Type = olOptional Then\n                                   lOptionalAttendeeCount = lOptionalAttendeeCount + 1\n                                ElseIf objAttendee.Type = olResource Then\n                                   lResourceCount = lResourceCount + 1\n                                End If\n                            Next\n\n                            If lRequiredAttendeeCount &gt; 1 Then\n                                MsgBox \"Attendees on list too many :\" &amp; lRequiredAttendeeCount, vbOKOnly\n                                Exit Sub\n                            End If\n\n                        Do\n                            If Not (oCalFolder Is Nothing) Then\n                                If (oCalFolder.DefaultItemType = olAppointmentItem) Then Exit Do\n\n                            End If\n\n\n\n                            'MsgBox (\"Please select a calendar folder from the following list.\")\n                            'Set oCalFolder = GetDefaultFolder(olFolderCalendar)\n                            On Error GoTo ErrHandler:\n                                Loop Until oCalFolder.DefaultItemType = olAppointmentItem\n                                ' Loop through appointments in calendar, change text where necessary, keep count\n                                iCalChangedCount = 0\n                            For Each oAppt In oCalFolder.Items\n                                If InStr(oAppt.Subject, sOldText) &lt;&gt; 0 Then\n                                    Debug.Print \"Changed: \" &amp; oAppt.Subject &amp; \" - \" &amp; oAppt.Start\n                                    oAppt.Recipients.Add (olMailItem.SenderEmailAddress)\n                                    'oAppt.Display\n                                    oAppt.Save\n                                    oAppt.Send\n                                    iCalChangedCount = iCalChangedCount + 1\n                                End If\n                            Next\n                            ' Display results and clear table\n                            MsgBox (iCalChangedCount &amp; \" appointments have been updated. You have \" &amp; lRequiredAttendeeCount &amp; \"attendees.\")\n\n                        Set oAppt = Nothing\n                        Set oCalFolder = Nothing\n                        Exit Sub\n                        End If\n\n\n  ErrHandler:\n        MsgBox (\"Macro terminated.\")\n\n\n\n                        End If\n                    Set Item = Nothing\n                    Set olMailItem = Nothing\n\n  End Sub\n</code></pre>\n\n<p>I've been able to count the participants with this but i'm lost trying to combine the two...</p>\n\n<pre><code>Private Sub Application_ItemSend(ByVal Item As Object, Cancel As Boolean)\nDim objMeetingInvitation As Outlook.MeetingItem\nDim objMeeting As Outlook.AppointmentItem\nDim objAttendees As Outlook.Recipients\nDim objAttendee As Outlook.Recipient\nDim lRequiredAttendeeCount, lOptionalAttendeeCount, lResourceCount As Long\nDim strMsg As String\nDim nPrompt As Integer\n\nIf TypeOf Item Is MeetingItem Then\n   Set objMeetingInvitation = Item\n   Set objMeeting = objMeetingInvitation.GetAssociatedAppointment(True)\n   Set objAttendees = objMeetingInvitation.Recipients\nEnd If\n\nlRequiredAttendeeCount = 0\nlOptionalAttendeeCount = 0\nlResourceCount = 0\n\n'Count the required &amp; optional attendees and resources, etc.\nFor Each objAttendee In objAttendees\n     If objAttendee.Type = olRequired Then\n        lRequiredAttendeeCount = lRequiredAttendeeCount + 1\n     ElseIf objAttendee.Type = olOptional Then\n        lOptionalAttendeeCount = lOptionalAttendeeCount + 1\n     ElseIf objAttendee.Type = olResource Then\n        lResourceCount = lResourceCount + 1\n     End If\nNext\n\n\n\n'Double check the meeting invitation details\nstrMsg = \"Meeting Details:\" &amp; vbCrLf &amp; vbCrLf &amp; _\n \"Required Attendees: \" &amp; lRequiredAttendeeCount &amp; vbCrLf &amp; _\n \"Optional Attendees: \" &amp; lOptionalAttendeeCount &amp; vbCrLf &amp; _\n \"Resources: \" &amp; lResourceCount &amp; vbCrLf &amp; _\n \"Duration: \" &amp; GetDuration(objMeeting) &amp; vbCrLf &amp; vbCrLf &amp; _\n \"Are you sure to send this meeting invitation?\"\n\nnPrompt = MsgBox(strMsg, vbExclamation + vbYesNo, \"Double Check Meeting Invitation\")\n\nIf nPrompt = vbYes Then\n   Cancel = False\nElse\n   Cancel = True\nEnd If\n\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas at all will be appreciated!</p>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 14672, "user_id": 8967612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EEhyd.png?s=128&g=1", "display_name": "41686d6564", "link": "https://stackoverflow.com/users/8967612/41686d6564"}, "is_accepted": true, "score": 0, "last_activity_date": 1507100867, "last_edit_date": 1507100867, "creation_date": 1507100012, "answer_id": 46558707, "question_id": 46558417, "link": "https://stackoverflow.com/questions/46558417/split-a-string-and-store-into-a-list-array-in-outlook-macro/46558707#46558707", "title": "Split a String and store into a List/Array in Outlook Macro", "body": "<ul>\n<li><p>Don't use <code>Set</code> to assign the array returned by the <code>Split()</code> function to your <code>stringList</code> variable. The <code>Set</code> keyword is used to <a href=\"https://msdn.microsoft.com/VBA/Language-Reference-VBA/articles/set-statement\" rel=\"nofollow noreferrer\">assign an object reference</a>. </p></li>\n<li><p>It's better to declare the <code>stringList</code> as an array of String instead of a <code>Variant</code> since you already know the type of the value to be assigned.</p></li>\n<li><p>One more thing, you might want to split the string using <code>vbNewLine</code> instead of <code>vbLf</code>.</p></li>\n</ul>\n\n<p>This should work:</p>\n\n<pre><code>Sub SplitMsgBody()\n    Dim stringList() As String\n    stringList = Split(myMessage.Body, vbNewLine) 'or vbLf depending on your requirements.\n\n    For Each s In stringList\n        Debug.Print s\n    Next\nEnd Sub\n</code></pre>\n\n<p>Hope that helps. </p>\n"}], "owner": {"reputation": 1514, "user_id": 4056736, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/fb80113bb3b5cd54c8358680fd56bafc?s=128&d=identicon&r=PG&f=1", "display_name": "Prateek Narendra", "link": "https://stackoverflow.com/users/4056736/prateek-narendra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1808, "favorite_count": 0, "accepted_answer_id": 46558707, "answer_count": 1, "score": 0, "last_activity_date": 1593043053, "creation_date": 1507098829, "last_edit_date": 1593043053, "question_id": 46558417, "link": "https://stackoverflow.com/questions/46558417/split-a-string-and-store-into-a-list-array-in-outlook-macro", "title": "Split a String and store into a List/Array in Outlook Macro", "body": "<p>I'm writing a macro to read through emails and parse the Body. For this, I need to split by newline character.</p>\n\n<p>I wrote - </p>\n\n<pre><code>Dim stringList As Variant\nSet stringList = Split(myMessage.Body, vbLf)\nDebug.Print stringList(0)\n</code></pre>\n\n<p>But it says type mismatch. How do I fix it?</p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1507098782, "post_id": 46558318, "comment_id": 80070544, "body": "If pass is the variable you want to access from a standard module, all you need is to declare pass as a public variable as &quot;Public pass as String&quot; on a standard module so that once you assign a value to the pass variable on userform, it can be accessed in any sub routine on a standard module"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1507098797, "post_id": 46558318, "comment_id": 80070555, "body": "Examples here: <a href=\"https://www.mrexcel.com/forum/excel-questions/528707-pass-value-userform-textbox-vba-procedure.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1507102613, "creation_date": 1507102613, "answer_id": 46559439, "question_id": 46558318, "link": "https://stackoverflow.com/questions/46558318/excel-vba-userform-to-module-sub/46559439#46559439", "title": "Excel VBA Userform to Module/sub", "body": "<p>Setup a Method which accepts two parameters in a Standard Module and pass the TextBox values as arguments:</p>\n\n<pre><code>Public Sub TestMethod(ByVal param1 As Variant, ByVal param2 As Variant)\n    MsgBox \"You passed: \" &amp; param1 &amp; \" and \" &amp; param2\nEnd Sub\n</code></pre>\n\n<p>Then you only need to call the method in your button's Click event:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    TestMethod myuserform.TextBoxA.Value, myuserform.TextBoxB.Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 1832238, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/645bc009b2c36aaaedf5ef326fe03f99?s=128&d=identicon&r=PG", "display_name": "Regenbui", "link": "https://stackoverflow.com/users/1832238/regenbui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1599, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507102613, "creation_date": 1507098424, "question_id": 46558318, "link": "https://stackoverflow.com/questions/46558318/excel-vba-userform-to-module-sub", "title": "Excel VBA Userform to Module/sub", "body": "<p>All,</p>\n\n<p>I'm struggling with passing input variables from a userform to a module/sub. I've searched the form, but can't find a matching example.</p>\n\n<p>E.g.</p>\n\n<p>Form 1: Two input fields named <strong>TextBoxA</strong> and <strong>TextBoxB</strong> and 1 <strong>Submit button.</strong>\nModule 1: some code in which I would like to use the input variables of TextBoxA and TextBoxB</p>\n\n<p>Code in userform:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    pass = myuserform.TextBoxA\nEnd Sub\n</code></pre>\n\n<p>Who can point me in the right direction. Much appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1507097757, "post_id": 46558086, "comment_id": 80070063, "body": "Your <code>With Sheets(&quot;Graph data&quot;)</code> about 5 lines from the bottom has no corresponding <code>End With</code>.  At the moment though, you aren&#39;t making use of the <code>With</code> (no subsequent code has any methods / properties starting with just a <code>.</code>) so you may as well get rid of the <code>With</code> (or fix the subsequent code to use it)."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1507098160, "post_id": 46558086, "comment_id": 80070248, "body": "If you format your code nicely and indent it correctly (what I did for you in your question) then you clearly see that issue. The first rule you should <b>always</b> follow is &quot;<i>format your code nicely and use correct indentation</i>&quot; and use human readable variable naming. Otherwise finding errors can be very cumbersome or even impossible."}, {"owner": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507098545, "post_id": 46558086, "comment_id": 80070450, "body": "@YowE3K I see. Thanks for explaining (: Appreciate it"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1507098418, "post_id": 46558140, "comment_id": 80070389, "body": "The <code>With</code> statement is completely useless and doesn&#39;t affect the code in any way. It can be removed without changing the behavior of that code."}, {"owner": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1507098635, "post_id": 46558140, "comment_id": 80070493, "body": "@Peh Got it, thanks for letting me know &amp; formatting my codes too. Appreciate it"}], "tags": [], "owner": {"reputation": 186, "user_id": 7528039, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I1pwD.jpg?s=128&g=1", "display_name": "Kyoujin", "link": "https://stackoverflow.com/users/7528039/kyoujin"}, "is_accepted": true, "score": 0, "last_activity_date": 1507104446, "last_edit_date": 1507104446, "creation_date": 1507097744, "answer_id": 46558140, "question_id": 46558086, "link": "https://stackoverflow.com/questions/46558086/error-on-automating-data-entry/46558140#46558140", "title": "Error on automating data entry", "body": "<p>You've missed and end with at the bottom of your code. </p>\n\n<p>Try this (untested)</p>\n\n<pre><code>Sub Book1UpdateDelete()\n'\n' Book1UpdateDelete Macro\n'\n' Keyboard Shortcut: Ctrl+g\n'\n'Select values in a column from specified workbook and sheet\nDim LR As Long, cell As Range, rng As Range\nWindows(\"Y738 Data\").Activate\nWith Sheets(\"Graph data\")\nLR = .Range(\"B\" &amp; Rows.Count).End(xlUp).Row\nFor Each cell In .Range(\"B4:B\" &amp; LR)\n    If cell.Value &lt;&gt; \"\" Then\n        If rng Is Nothing Then\n            Set rng = cell\n        Else\n            Set rng = Union(rng, cell)\n        End If\n    End If\nNext cell\nrng.Select\n\nEnd With\nSelection.Copy\n\n'Open next workbook\nWindows(\"Y783\").Activate\n'Open Sheet L\nSheets(\"L\").Select\n'Select empty field fromn column AA\nRange(\"AA\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n'paste selection to empty field\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n'Go back to previous workbook &amp; delete column\nWindows(\"Y738\").Activate\nWith Sheets(\"Graph data\")\nColumns(\"B:B\").Select\nApplication.CutCopyMode = False\nSelection.Delete Shift:=xlToLeft\nSheets(\"Graph Data\").Select\nEnd with\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 318, "user_id": 1570670, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/3xMxf.jpg?s=128&g=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/1570670/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 46558140, "answer_count": 1, "score": 1, "last_activity_date": 1507104446, "creation_date": 1507097528, "last_edit_date": 1507097906, "question_id": 46558086, "link": "https://stackoverflow.com/questions/46558086/error-on-automating-data-entry", "title": "Error on automating data entry", "body": "<p>I recorded a macro &amp; integrated together with some codes I researched and tested, which worked individually. However, having combined them all together, I stumbled across errors running the macro. Pop out a message box which displays </p>\n\n<blockquote>\n  <p>Compile Error: Expected End With</p>\n</blockquote>\n\n<p>Would appreciate all the help I could get to solve it</p>\n\n<pre><code>Sub Book1UpdateDelete()\n    '\n    ' Book1UpdateDelete Macro\n    '\n    ' Keyboard Shortcut: Ctrl+g\n    '\n    'Select values in a column from specified workbook and sheet\n    Dim LR As Long, cell As Range, rng As Range\n\n    Windows(\"Y738 Data\").Activate\n\n    With Sheets(\"Graph data\")\n        LR = .Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n        For Each cell In .Range(\"B4:B\" &amp; LR)\n            If cell.Value &lt;&gt; \"\" Then\n                If rng Is Nothing Then\n                    Set rng = cell\n                Else\n                    Set rng = Union(rng, cell)\n                End If\n            End If\n        Next cell\n\n        rng.Select\n    End With\n\n    Selection.Copy\n\n    'Open next workbook\n    Windows(\"Y783\").Activate\n    'Open Sheet L\n    Sheets(\"L\").Select\n    'Select empty field fromn column AA\n    Range(\"AA\" &amp; Rows.Count).End(xlUp).Offset(1).Select\n    'paste selection to empty field\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    'Go back to previous workbook &amp; delete column\n    Windows(\"Y738\").Activate\n\n    With Sheets(\"Graph data\")\n        Columns(\"B:B\").Select\n        Application.CutCopyMode = False\n        Selection.Delete Shift:=xlToLeft\n        Sheets(\"Graph Data\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba"], "comments": [{"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 1, "creation_date": 1507097497, "post_id": 46558055, "comment_id": 80069939, "body": "You need to escape the &quot;quote&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 28547, "user_id": 1162620, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f8bd1c472fe5832e125fd4008578608a?s=128&d=identicon&r=PG", "display_name": "Ravi", "link": "https://stackoverflow.com/users/1162620/ravi"}, "is_accepted": false, "score": 0, "last_activity_date": 1507097975, "creation_date": 1507097975, "answer_id": 46558204, "question_id": 46558055, "link": "https://stackoverflow.com/questions/46558055/using-sql-in-vba/46558204#46558204", "title": "Using sql in vba", "body": "<p>You need to escape all double quote by using extra double quote.</p>\n\n<pre><code>newSQL = newSQL &amp; \" WHERE TAXIDATA.HkDt = #\" &amp; Format(d, \"\"MM/dd/yyyy\"\") &amp; \"# AND ((TAXIDATA.DevID)&lt;\"\"002000\"\"))\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8718119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfc1fd33895dfa137c379c1cd167ad69?s=128&d=identicon&r=PG&f=1", "display_name": "whale black", "link": "https://stackoverflow.com/users/8718119/whale-black"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1507097975, "creation_date": 1507097376, "question_id": 46558055, "link": "https://stackoverflow.com/questions/46558055/using-sql-in-vba", "title": "Using sql in vba", "body": "<p>I have tried to write a program to create queries in access using the sql as the following</p>\n\n<pre><code>For d = DateSerial(2011, 12, 4) To DateSerial(2011, 12, 10)\n\nnewSQL = \" SELECT TAXIDATA.HkDt, TAXIDATA.DevID, TAXIDATA.HkTm, TAXIDATA.Lat, TAXIDATA.Lon, TAXIDATA.FlagDown\" 'sql code\nnewSQL = newSQL &amp; \" FROM TAXIDATA\"\nnewSQL = newSQL &amp; \" WHERE TAXIDATA.HkDt = #\" &amp; Format(d, \"MM/dd/yyyy\") &amp; \"# AND ((TAXIDATA.DevID)&lt;\"002000\"))\"\nnewSQL = newSQL &amp; \" ORDER BY TAXIDATA.HkDt, TAXIDATA.DevID, TAXIDATA.HkTm; \"\n</code></pre>\n\n<p>However, there is a error when I run the 4th line. There is something wrong with ((TAXIDATA.DevID)&lt;\"002000\"))\" . TAXIDATA.DevID is a short text in the access. So I suppose \"002000\" will work just fine but it isn't. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1507095375, "creation_date": 1507095375, "answer_id": 46557687, "question_id": 46557488, "link": "https://stackoverflow.com/questions/46557488/cell-border-not-found/46557687#46557687", "title": "Cell border not &quot;found&quot;", "body": "<pre><code>While C.Offset(0, i).Interior.Color = FirstColor And _\n                                   C.Offset(0, i).Value = \"\" And _\n                     C.Offset(0, i).Borders(xlEdgeRight).LineStyle &lt;&gt; xlNone\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>While C.Offset(0, i).Interior.Color = FirstColor And _\n                                   C.Offset(0, i).Value = \"\" And _\n                     C.Offset(0, i).Borders(xlEdgeRight).LineStyle = xlNone\n</code></pre>\n"}], "owner": {"reputation": 24120, "user_id": 5159168, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/r0oiE.jpg?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5159168/andreas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 46557687, "answer_count": 1, "score": 0, "last_activity_date": 1507095375, "creation_date": 1507094269, "last_edit_date": 1507094594, "question_id": 46557488, "link": "https://stackoverflow.com/questions/46557488/cell-border-not-found", "title": "Cell border not &quot;found&quot;", "body": "<p>I have a sheet that looks like this:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/ay1uj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ay1uj.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want a VBA code to find customer number and \"measure\" how large the block is that it's in.  </p>\n\n<p>Example:<br>\n8887 has two columns.<br>\n8736 has two columns.<br>\n8602 has one column.</p>\n\n<p>I use range.find to find the customer number and from there i loop a offset in columns to find where the \"block\" ends.<br>\nThe block ends when it's not the same interior color, another customer is written in the cell or when a cell border is found.  </p>\n\n<pre><code>Set C = rng.Find(Search, _\n        LookIn:=xlValues, _\n        LookAt:=xlWhole, _\n        SearchOrder:=xlByRows, _\n        SearchDirection:=xlNext, _\n        MatchCase:=False)\n\nIf Not C Is Nothing Then\n    FirstAddress = C.Address\n    FirstColor = C.Interior.Color\n    Do\n        ' If it's just one cell width (column CJ) \n        If C.Borders(xlEdgeRight).LineStyle &lt;&gt; xlNone Then\n            Platser = Platser &amp; Mid(C.Address, 2) &amp; \",\" 'append the locations string\n        Else\n            Platser = Platser &amp; Mid(C.Address, 2) &amp; \",\" 'append the locations string\n            i = 1\n\n            ' This is the loop that is causing problem. \n            'As I see it it should stop at i=1 but it keeps looping\n            While C.Offset(0, i).Interior.Color = FirstColor And _\n                                   C.Offset(0, i).Value = \"\" And _\n                     C.Offset(0, i).Borders(xlEdgeRight).LineStyle &lt;&gt; xlNone\n                'append the locations string\n                Platser = Platser &amp; Mid(C.Offset(0, i).Address, 2) &amp; \",\" \n                i = i + 1\n            Wend\n        End If\n\n        ' here I find the next cell with the same value, \n        '     but this has nothing to do with the problem.\n        Set C = rng.Find(Search, _\n            LookIn:=xlValues, _\n            LookAt:=xlWhole, _\n            SearchOrder:=xlByRows, _\n            SearchDirection:=xlNext, _\n            after:=C, _\n            MatchCase:=False)\n    Loop While Not C Is Nothing And FirstAddress &lt;&gt; C.Address\n</code></pre>\n\n<p>After this code i the cell addresses to get the numbers on row 3.<br>\nThe output of the code above is:  </p>\n\n<p>364,363,362,361,360,359,358,357,356,354,354  </p>\n\n<p>So it finds the value 8736, but then it doesn't see the cell border which should make it stop looping.<br>\nWhat could cause this behavior?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1507095922, "creation_date": 1507095922, "answer_id": 46557787, "question_id": 46557372, "link": "https://stackoverflow.com/questions/46557372/how-to-dynamically-add-links-to-shapes-and-download-the-corresponding-csv-file/46557787#46557787", "title": "How to dynamically add links to shapes and download the corresponding CSV file?", "body": "<p>If this doesn't work what happens instead?</p>\n\n<pre><code>Sub Macro2()\n\n    Dim wb As Workbook, fName, a, b, c\n\n    a = 2017\n    b = 10\n    c = 3\n\n    fName = \"https://example.com.uk/Download/Report/\" &amp; a &amp; \"-\" &amp; _\n            Format(b, \"00\") &amp; \"-\" &amp; Format(c, \"00\") &amp; \"_successful.csv\"\n\n    Set wb = Workbooks.Open(Filename:=fName)\n\n    Debug.Print wb.Name\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4118670, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRdub.jpg?s=128&g=1", "display_name": "Sheikh Wasiu Al Hasib", "link": "https://stackoverflow.com/users/4118670/sheikh-wasiu-al-hasib"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507100987, "creation_date": 1507093509, "last_edit_date": 1507100987, "question_id": 46557372, "link": "https://stackoverflow.com/questions/46557372/how-to-dynamically-add-links-to-shapes-and-download-the-corresponding-csv-file", "title": "How to dynamically add links to shapes and download the corresponding CSV file?", "body": "<p>I have a link like this \"<a href=\"https://example.com.uk/Download/Report/2017-10-01_successful.csv\" rel=\"nofollow noreferrer\">https://example.com.uk/Download/Report/2017-10-01_successful.csv</a>\", and I am unable to download the CSV file.</p>\n\n<p>I have to change the date every day through this link to download the CSV file. So, I tried the following code where a, b, and c are the given inputs for a specific date. </p>\n\n<p><strong>My requirements are:</strong></p>\n\n<p>I want to download this report by changing the date value inside the link. My code adds the links but unable to download data. </p>\n\n<p>What do I have to do? Are there any libraries need to be referenced in Excel VBA?</p>\n\n<p><strong>Here's my code:</strong></p>\n\n<pre><code>Sub Macro2()\n\n    Range(\"D14:L14\").Select\n    Sheets(\"RAW_DATA\").Select\n    Range(\"B26\").Select\n\n    a = 2017\n    b = 10\n    c = 3\n    ActiveSheet.Shapes.Range(Array(\"Rectangle 11\")).Select\n    'Selection.ShapeRange.Item(1).Hyperlink.Delete\n    ActiveSheet.Hyperlinks.Add Anchor:=Selection.ShapeRange.Item(1), Address:= _\n        \"https://example.com.uk/Download/Report/\" &amp; a &amp; \"-\" &amp; b &amp; \"-\" &amp; c &amp; \"_successful.csv\"\n    Range(\"D20\").Select\n    Selection.ShapeRange.Item(1).Hyperlink.Follow NewWindow:=False, AddHistory:=True\n    Workbooks.Open Filename:= _\n        \"https://example.com.uk/Download/Report/\" &amp; a &amp; \"-\" &amp; b &amp; \"-\" &amp; c &amp; \"_successful.csv\"\n    ActiveWindow.Visible = False\n    Windows(\"2017-10-01_successful.csv\").Visible = True\n    'Windows(\"ARC_ASC_TEMPLATE_VBA_V3.xlsm\").Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1507101988, "post_id": 46556894, "comment_id": 80072230, "body": "You can&#39;t combine an array with another filter."}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1507111439, "creation_date": 1507111439, "answer_id": 46562128, "question_id": 46556894, "link": "https://stackoverflow.com/questions/46556894/excel-vba-use-an-array-containing-operator-and-numbers-stored-in-variable-as/46562128#46562128", "title": "Excel VBA: Use an array (containing operator and numbers stored in variable) as criteria in autofilter", "body": "<p>This is the basic code you need for your endeavour. You should install it in the user form's code sheet. Then you construct the rest of your code to meet the requirements of this skeleton.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CmdOK_Click()\n    ' 04 Oct 2017\n    ' CmdOK is the OK button on your Userform\n\n    Dim Fld As Long\n    Dim Crit1 As Variant\n    Dim Optor As XlAutoFilterOperator\n    Dim Crit2 As Variant\n    Dim NewFilter As Boolean\n\n    Fld = 1\n    Crit1 = \"g\"\n    ' Optor = xlAnd\n    ' Crit2 = \"\"\n    ' NewFilter = True            ' False to apply a second filter (on another field)\n                                ' on the already filtered sheet\n\n    ApplyAutoFilter Fld, Crit1, Optor, Crit2, NewFilter\nEnd Sub\n\nPrivate Sub ApplyAutoFilter(ByVal Fld As Long, _\n                            ByVal Crit1 As Variant, _\n                            Optional ByVal Optor As XlAutoFilterOperator = xlAnd, _\n                            Optional ByVal Crit2 As Variant, _\n                            Optional ByVal NewFilter As Boolean = True)\n    ' 04 Oct 2017\n    ' \"Optional\" means you don't have to provide these arguments\n    ' in the function call\n\n    If IsEmpty(Crit2) Then Optor = xlOr\n    With Worksheets(\"Sheet1\")\n        If NewFilter Then .AutoFilterMode = False\n\n        ' specify the caption row: A1 = Field 1, B1 = Field 2, etc.\n        With .Range(\"A1:K1\")\n            .AutoFilter Field:=Fld, _\n                        Criteria1:=Crit1, _\n                        Operator:=Optor, _\n                        Criteria2:=Crit2\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<p>Start by modifying the Sheet name and filter range in the Sub <code>ApplyAutoFilter</code>. After that you don't need to touch this procedure anymore.</p>\n\n<p>Next step is to have an OK button on your user form which is called <code>CmdOK</code>. Now the <code>CmdOK_Click</code> procedure will run whenever you click that button.</p>\n\n<p>There are 5 parameters you have to provide for each call on the filter. I made it that you only really need two, <code>Fld</code> (the cell number in the filter range, starting from 1 for the first cell) and <code>Crit1</code>, a first criterion. The other three will be set automatically why you don't need them. Start your trials with two and then expand step by step.</p>\n\n<p>All parameters can be set dynamically (if you want). It seems that your Field number is <code>Age_Day</code> which doesn't need a variable because it seems not variable. But make sure that the range you have set in the filter sub does have 10 cells. If all you want is to filter on one columns the normal procedure is to set the range as \"J1\" which has only one cell, so that Fld = 1.</p>\n\n<p>Your <code>Crit1</code> appears to be a concatenation of a combobox and textbox. Write all your many IF conditions into the creation of this one parameter which, finally, you pass to the filter. Note that you can't pass an array as <code>Crit2</code> (nor <code>Crit1</code>). You will have to extract the value you want to assign before you pass the argument.</p>\n\n<p>I hope this puts you on your path to success. Good luck!</p>\n"}], "owner": {"reputation": 791, "user_id": 7689318, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/8f1cb679b9ddd3e6cc685fcc6547dba9?s=128&d=identicon&r=PG&f=1", "display_name": "doyz", "link": "https://stackoverflow.com/users/7689318/doyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 394, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1517679151, "creation_date": 1507090361, "last_edit_date": 1517679151, "question_id": 46556894, "link": "https://stackoverflow.com/questions/46556894/excel-vba-use-an-array-containing-operator-and-numbers-stored-in-variable-as", "title": "Excel VBA: Use an array (containing operator and numbers stored in variable) as criteria in autofilter", "body": "<p>I have a UserForm where users can select the range of numbers to filter the date from: ComboBox1 (select the operator, eg >=), Textbox3 (select number), ComboBox2 (select the operator, eg &lt;=), , TextBox4 ((select number).</p>\n\n<p>Furthermore, there is a Checkbox7 where users can tick to choose to include a text string in the filter too. (There is a combination of both strings and numbers in the column.)</p>\n\n<p>Only the first 2 and last if/elseif condition works, the others do generate a filtered selection, but only the text string (if Checkbox7 = True) and numbers that meet the criteria in ComboBox2 &amp; TextBox4 appear.</p>\n\n<p>I don't understand how autofilter arrays with a range of numbers work. I'm also not sure whether to use xlAnd or xlOr when filtering a range of numbers with multiple criteria..</p>\n\n<p>Any suggestions on how to make the code less verbose would be great.</p>\n\n<pre><code>Dim arr_Filter() As Variant\nDim arr_moreless() As Variant\nDim Age_Day As Integer: Age_Day = 10\n\narr_Filter = Array(ComboBox1 &amp; TextBox3, ComboBox2 &amp; TextBox4)\narr_moreless = Array(ComboBox2 &amp; TextBox4, \"No Date\")\n\nIf ComboBox2.Value = \"\" And TextBox4.Value = \"\" And CheckBox7 = True Then\n  FilterRange.AutoFilter Field:=Age_Day, Criteria1:=ComboBox1 &amp; TextBox3, Operator:=xlOr, Criteria2:=\"No Date\"\n\nElseIf ComboBox2.Value = \"\" And TextBox4.Value = \"\" And CheckBox7 = False Then\n  FilterRange.AutoFilter Field:=Age_Day, Criteria1:=ComboBox1 &amp; TextBox3, Operator:=xlFilterValues\n\nElseIf ComboBox1.Value = \"&lt;=\" And ComboBox2.Value = \"&gt;=\" And CheckBox7 = True Then\n  FilterRange.AutoFilter Field:=Age_Day, Criteria1:=arr_Filter, Operator:=xlOr, Criteria2:=\"No Date\"\n\nElseIf ComboBox1.Value = \"&lt;=\" And ComboBox2.Value = \"&gt;=\" And CheckBox7 = False Then\n  FilterRange.AutoFilter Field:=Age_Day, Criteria1:=arr_Filter, Operator:=xlFilterValues\n\nElseIf ComboBox1.Value = \"&gt;=\" And ComboBox2.Value = \"&lt;=\" And CheckBox7 = True Then\n\n  FilterRange.AutoFilter Field:=Age_Day, Criteria1:=ComboBox1 &amp; TextBox3, Operator:=xlAnd, Criteria2:=arr_moreless\n\nElseIf ComboBox1.Value = \"&gt;=\" And ComboBox2.Value = \"&lt;=\" And CheckBox7 = False Then\n  FilterRange.AutoFilter Field:=Age_Day, Criteria1:=ComboBox1 &amp; TextBox3, Operator:=xlAnd, Criteria2:=ComboBox2 &amp; TextBox4\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1507089541, "post_id": 46556769, "comment_id": 80067406, "body": "Please post the actual code as text, not a link to an image!"}, {"owner": {"reputation": 11, "user_id": 8673160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8595d70e299903e8aee1bd70eba2b8b?s=128&d=identicon&r=PG&f=1", "display_name": "aichang", "link": "https://stackoverflow.com/users/8673160/aichang"}, "reply_to_user": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1507089626, "post_id": 46556769, "comment_id": 80067426, "body": "I don&#39;t have a code yet. @KenY-N it&#39;s a really simple table but I&#39;m not sure what to use"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507089922, "post_id": 46556769, "comment_id": 80067500, "body": "Why does this even need to be VBA?  Can&#39;t you just use a <code>SUMIFS</code> multiplied by another <code>SUMIFS</code>?"}, {"owner": {"reputation": 11, "user_id": 8673160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8595d70e299903e8aee1bd70eba2b8b?s=128&d=identicon&r=PG&f=1", "display_name": "aichang", "link": "https://stackoverflow.com/users/8673160/aichang"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507090523, "post_id": 46556769, "comment_id": 80067660, "body": "@YowE3K I&#39;m doing a more complicated piece, but I just need to simplify it as I am not very good in VBA"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1507096380, "post_id": 46556769, "comment_id": 80069529, "body": "is there any reason why <code>ID&#47;fruit&#47;price&#47;discount&#47;answer</code> are not column names  .... and <code>1&#47;apple&#47;500&#47;5%&#47;525</code> are not in one row ???"}], "answers": [{"comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1507096415, "post_id": 46557122, "comment_id": 80069539, "body": "Good one Mrig! +1 You beat me to it. I was about to post the similar answer, though using Arrays. :)"}, {"owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1507097499, "post_id": 46557122, "comment_id": 80069942, "body": "@sktneer - Even array is good option here, probably you should post it as answer."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1507098185, "post_id": 46557122, "comment_id": 80070268, "body": "I derived a solution using Dictionary and Array and as I said I was about to post it when I saw that you already posted the similar answer except I used arrays instead of range variable so discarded the file without saving it. Lol"}], "tags": [], "owner": {"reputation": 11329, "user_id": 6075259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f08e6fd3c96625a1c153c825ac01b110?s=128&d=identicon&r=PG&f=1", "display_name": "Mrig", "link": "https://stackoverflow.com/users/6075259/mrig"}, "is_accepted": false, "score": 3, "last_activity_date": 1507092291, "last_edit_date": 1507092291, "creation_date": 1507091935, "answer_id": 46557122, "question_id": 46556769, "link": "https://stackoverflow.com/questions/46556769/simple-if-then-multiply-vba/46557122#46557122", "title": "Simple IF then multiply VBA", "body": "<p>Assuming <code>Answer</code> will appear below <code>Price</code> and <code>Discount</code>, following should be helpful.</p>\n\n<pre><code>Sub Demo()\n    Dim ws As Worksheet\n    Dim lastRow As Long, i As Long\n    Dim dictPrice As Object, dictDiscount As Object\n    Dim rng As Range, cel As Range\n\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")      'change Sheet1 to your data sheet\n    Set dictPrice = CreateObject(\"Scripting.Dictionary\")\n    Set dictDiscount = CreateObject(\"Scripting.Dictionary\")\n\n    With ws\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row    'get last row with data using Column A\n        For Each cel In .Range(\"A2:A\" &amp; lastRow)            'loop though all cells in Column A\n            If cel.Value = \"Price\" Then                     'check if its Price\n                dictPrice.Add cel.Offset(0, 1).Value, cel.Offset(0, 3).Value    'add id and correspoding price in dictionary\n            ElseIf cel.Value = \"Discount\" Then              'check if its Discount\n                dictDiscount.Add cel.Offset(0, 1).Value, cel.Offset(0, 3).Value 'add id and correspoding discount in dictionary\n            ElseIf cel.Value = \"Answer\" Then                'check if its Answer\n                cel.Offset(0, 3).Value = dictPrice(cel.Offset(0, 1).Value) * (1 + dictDiscount(cel.Offset(0, 1).Value))\n            End If\n        Next cel\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/xA0st.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xA0st.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong><em>Note :</em></strong> <code>If cel.Value = \"Price\" Then</code> is case-sensitive match and will match only <code>Price</code> and not <code>price</code> and same applies to <code>ElseIf cel.Value = \"Discount\" Then</code> and <code>ElseIf cel.Value = \"Answer\" Then</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 8673160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8595d70e299903e8aee1bd70eba2b8b?s=128&d=identicon&r=PG&f=1", "display_name": "aichang", "link": "https://stackoverflow.com/users/8673160/aichang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1507098341, "creation_date": 1507089350, "last_edit_date": 1507098341, "question_id": 46556769, "link": "https://stackoverflow.com/questions/46556769/simple-if-then-multiply-vba", "title": "Simple IF then multiply VBA", "body": "<p><a href=\"https://i.stack.imgur.com/XydNi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XydNi.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have a table such as the image above and I just want to have a simple code where if the ID is equal to each other, (1=1) then it will return another set of rows on the bottom (Answer) that will show </p>\n\n<pre><code>answer = price * (1 + discount)\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 8148077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f58bdce24744590aad09254a09efa23c?s=128&d=identicon&r=PG&f=1", "display_name": "Michu1", "link": "https://stackoverflow.com/users/8148077/michu1"}, "edited": false, "score": 0, "creation_date": 1507096565, "post_id": 46557870, "comment_id": 80069581, "body": "Dang it, I knew it would refer to the ActiveSheet but I didn&#39;t know that the function could be otherwise called in such a way. Thanks!!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1507096342, "creation_date": 1507096342, "answer_id": 46557870, "question_id": 46556742, "link": "https://stackoverflow.com/questions/46556742/vba-custom-function-refreshing-itself-with-wrong-input/46557870#46557870", "title": "(VBA) Custom function refreshing itself with wrong input?", "body": "<p>Without a qualifying worksheet object, your <code>Range(\"W\" &amp; rCell.Row)</code> will always refer to the ActiveSheet, which is not always the one calling your function.</p>\n\n<p>Here's one way to fix it:</p>\n\n<pre><code>Option Explicit\n\n\nFunction SUMSubCost(rRange As Range) As Double\n    Application.Volatile\n\n    Dim Total, rCell As Range\n    For Each rCell In rRange\n          If (Not IsEmpty(rCell)) And (Not IsError(rCell)) Then\n               Total = Total + (rCell.Value * rCell.Worksheet.Range(\"W\" &amp; rCell.Row).Value)\n          End If\n    Next rCell\n    SUMSubCost = Total\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 8148077, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f58bdce24744590aad09254a09efa23c?s=128&d=identicon&r=PG&f=1", "display_name": "Michu1", "link": "https://stackoverflow.com/users/8148077/michu1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 46557870, "answer_count": 1, "score": 0, "last_activity_date": 1507096342, "creation_date": 1507089133, "last_edit_date": 1531164843, "question_id": 46556742, "link": "https://stackoverflow.com/questions/46556742/vba-custom-function-refreshing-itself-with-wrong-input", "title": "(VBA) Custom function refreshing itself with wrong input?", "body": "<p>My problem is hard to explain, therefore I added a picture and also shared the sample excel file via my google drive.</p>\n\n<p>What the function should do: Have different item total prices in row \"W\" and the percentage of transportation costs within the total prices in row \"Q\" (several other percentage-rows exist for different cost items, this is just to simplify).\nNow I SUM the individual item totals.</p>\n\n<p>Then, I apply below function to all percentages in row \"Q\", which should then give me the total amount of costs, which I then can devide again by row \"W\" to get the cost percentage of the total.\nIn my example file, all sub-percentages are equal, but they could as well be different.</p>\n\n<p>The problem that I encounter occurs when I have two sheets with the function below. For some reasons, whenever the function updates on one sheet (and shows the correct value), the function on the other sheet becomes a mess. When I then manually update (\"press enter\") on the messed-up function, it shows the correct value, but when I go back to the previous sheet, the function is messed up there... I am going crazy : ( \nAnd, if I have a third sheet that references \"Q\" on each sheet, I can never get it to show the correct value for both sheets at the same time, one is always incorrect.</p>\n\n<pre><code>Option Explicit\nDim rCell As Range\n\nFunction SUMSubCost(rRange As Range) As Double\nApplication.Volatile\nDim Total\nFor Each rCell In rRange\n  If (Not IsEmpty(rCell)) And (Not IsError(rCell)) Then\n    Total = Total + (rCell.Value * Range(\"W\" &amp; rCell.Row).Value)\n  Else\n  End If\nNext rCell\nSUMSubCost = Total\nEnd Function\n</code></pre>\n\n<p><a href=\"https://drive.google.com/open?id=0B4W0JIpnfttKaEFQX0p1RHVJYkU\" rel=\"nofollow noreferrer\">Excel Document</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/4iCLF.png\" rel=\"nofollow noreferrer\">Picture</a></p>\n"}, {"tags": ["excel", "vba", "merge"], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1507107997, "creation_date": 1507107997, "answer_id": 46561015, "question_id": 46556528, "link": "https://stackoverflow.com/questions/46556528/vba-referencing-new-mail-merge-document/46561015#46561015", "title": "VBA Referencing new mail merge document", "body": "<p>You need to look into the <a href=\"https://msdn.microsoft.com/en-us/vba/word-vba/articles/application-mailmergeaftermerge-event-word\" rel=\"nofollow noreferrer\">MailMergeAfterMerge</a> Event of the Word Document. </p>\n\n<p>However in order to be able to handle the event, you need to declare the Document as <code>Private WithEvents wdDoc As Word.Document</code> at module level.  </p>\n\n<pre><code>Private Sub wdDoc_MailMergeAfterMerge(Doc As Document, DocResult As Document)\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Occurs after all records in a mail merge have merged successfully.</p>\n</blockquote>\n\n<pre><code>Name       Data-Type  Description\n\nDoc        Document   The mail merge main document.\nDocResult  Document   The document created from the mail merge\n</code></pre>\n\n<p><br>\nNote <code>WithEvents</code> cannot be declared in a standard module. </p>\n"}], "owner": {"reputation": 75, "user_id": 4472483, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/7d381b3b8b6e7544976612087ee6b332?s=128&d=identicon&r=PG&f=1", "display_name": "roffster", "link": "https://stackoverflow.com/users/4472483/roffster"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 285, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507107997, "creation_date": 1507087539, "question_id": 46556528, "link": "https://stackoverflow.com/questions/46556528/vba-referencing-new-mail-merge-document", "title": "VBA Referencing new mail merge document", "body": "<p>I'm currently working on an Excel Spreadsheet that creates a mail merge, then splits the mail merge into component files, without requiring any intervention once the program has started.</p>\n\n<p>I'm having the issue that after the mail merge, the wdApplication focus moves back to the original word document, and I can't figure out how to either make the mail merge the active document, or to set a variable to be the new mail merge so I can manipulate it there.</p>\n\n<p>Here's my current code:</p>\n\n<pre><code>Dim wdApp As New Word.Application, wdDoc As Word.Document\nDim strWorkbookName As String: strWorkbookName = ThisWorkbook.FullName\nDim sections As Integer\nDim fileName As String\n\nWith wdApp\n    .DisplayAlerts = wdAlertsNone\n\n    Set wdDoc = .Documents.Open(ThisWorkbook.Path &amp; \"\\Potential Template.docx\", ConfirmConversions:=False, ReadOnly:=True, AddToRecentFiles:=False)\n\n    With wdDoc\n        With .MailMerge\n            .MainDocumentType = wdFormLetters\n            .Destination = wdSendToNewDocument\n            .SuppressBlankLines = True\n            .OpenDataSource Name:=strWorkbookName, ReadOnly:=True, _\n                LinkToSource:=False, AddToRecentFiles:=False, _\n                Format:=wdOpenFormatAuto, _\n                Connection:=\"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=strWorkbookName;\" &amp; _\n                \"Mode=Read;Extended Properties=\"\"HDR=YES;IMEX=1\"\";\", _\n                SQLStatement:=\"SELECT * FROM `'Final Data Set$'`\", _\n                SubType:=wdMergeSubTypeAccess\n            With .DataSource\n                .FirstRecord = wdDefaultFirstRecord\n                .LastRecord = wdDefaultLastRecord\n            End With\n            .Execute\n            .MainDocumentType = wdNotAMergeDocument\n        End With\n        .Close SaveChanges:=wdDoNotSaveChanges\n\n    End With\n\n    .Browser.Target = wdBrowseSection\n    For i = 1 To ((ActiveDocument.sections.Count) - 1)\n        ActiveDocument.Bookmarks(\"\\Section\").Range.Copy\n\n        Documents.Add\n        Selection.Paste\n\n        Selection.MoveUp Unit:=wdLine, Count:=1, Extend:=wdExtend\n        Selection.Delete Unit:=wdCharacter, Count:=1\n        fileName = filePath &amp; Worksheets(\"Final Data Set\").Range(Cells(i + 1, 4)).value\n        ActiveDocument.SaveAs (fileName)\n        ActiveDocument.Close\n\n        .Browser.Next\n    Next i\n\n\n\n\n    .DisplayAlerts = wdAlertsAll\n    .Visible = True\n    .Quit SaveChanges:=wdDoNotSaveChanges\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1507088851, "post_id": 46556488, "comment_id": 80067254, "body": "What have you tried?  Could you post a code snippet?"}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1507089120, "post_id": 46556488, "comment_id": 80067321, "body": "are those &quot;print output&quot; or are you depicting rows and columns of a worksheet?"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1507089345, "creation_date": 1507089345, "answer_id": 46556768, "question_id": 46556488, "link": "https://stackoverflow.com/questions/46556488/vba-to-change-excel-data-transpose-in-rows/46556768#46556768", "title": "VBA to change excel data transpose in rows", "body": "<p>A1:B7</p>\n\n<pre><code>1   10\n2   20\n3   30\n1   40\n2   50\n4   60\n1   80\n\n\nSub copyit()\nDim LastRow As Long\nDim myRange, MyRange1 As Range\nLastRow = Cells(Rows.count, \"A\").End(xlUp).Row\nFor X = 1 To LastRow\nFor Y = 1 + X To LastRow\nIf Cells(X, 1).Value = Cells(Y, 1).Value Then\nIf MyRange1 Is Nothing Then\nSet MyRange1 = Rows(Y).EntireRow\nRows(X).End(xlToRight).Offset(, 1).Value = Cells(Y, 2).Value\nElse\nSet MyRange1 = Union(MyRange1, Rows(Y).EntireRow)\nRows(X).End(xlToRight).Offset(, 1).Value = Cells(Y, 2).Value\nEnd If\nEnd If\nNext\nNext\nMyRange1.Select\nSelection.Delete\nEnd Sub\n</code></pre>\n\n<p>OR . . .</p>\n\n<pre><code>Sub ConcatData()\nDim X As Double\nDim DataArray(5000, 2) As Variant\nDim NbrFound As Double\nDim Y As Double\nDim Found As Integer\nDim NewWks As Worksheet\n\nCells(1, 1).Select\nLet X = ActiveCell.Row\nDo While True\nIf Len(Cells(X, 1).Value) = Empty Then\nExit Do\nEnd If\nIf NbrFound = 0 Then\nNbrFound = 1\nDataArray(1, 1) = Cells(X, 1)\nDataArray(1, 2) = Cells(X, 2)\nElse\nFor Y = 1 To NbrFound\nFound = 0\nIf DataArray(Y, 1) = Cells(X, 1).Value Then\nDataArray(Y, 2) = DataArray(Y, 2) &amp; \", \" &amp; Cells(X, 2)\nFound = 1\nExit For\nEnd If\nNext\nIf Found = 0 Then\nNbrFound = NbrFound + 1\nDataArray(NbrFound, 1) = Cells(X, 1).Value\nDataArray(NbrFound, 2) = Cells(X, 2).Value\nEnd If\nEnd If\nX = X + 1\nLoop\n\nSet NewWks = Worksheets.Add\nNewWks.Name = \"SummarizedData\"\nCells(1, 1).Value = \"Names\"\nCells(1, 2).Value = \"Results\"\nX = 2\nFor Y = 1 To NbrFound\nCells(X, 1).Value = DataArray(Y, 1)\nCells(X, 2).Value = DataArray(Y, 2)\nX = X + 1\nNext\nBeep\nMsgBox (\"Summary is done!\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 8706729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/363c62b69c6d9e6cafa8daab0fc3c5b0?s=128&d=identicon&r=PG&f=1", "display_name": "Rana", "link": "https://stackoverflow.com/users/8706729/rana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507089345, "creation_date": 1507087241, "last_edit_date": 1507087682, "question_id": 46556488, "link": "https://stackoverflow.com/questions/46556488/vba-to-change-excel-data-transpose-in-rows", "title": "VBA to change excel data transpose in rows", "body": "<p>i had input like below </p>\n\n<pre><code>1   10\n2   20\n3   30\n1   40\n2   50\n4   60\n1   80\n</code></pre>\n\n<p>and output , if had multiple matches corresponding value should be like below.</p>\n\n<pre><code>1   10  40  80\n2   20  50  \n3   30      \n4   60      \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507087348, "post_id": 46556115, "comment_id": 80066888, "body": "If you can sort the data on column A ascending and then column B ascending, the formula becomes very simple (starting from C2, I think it would be <code>=IF(B2=&quot;&quot;,C1,B2)</code>).  If you can&#39;t sort it, I think you can do it with two columns (C2 would be <code>=IF(B2=&quot;&quot;,IF(A2=A1,C1,&quot;&quot;),B2)</code> and D2 would be <code>=IF(C2=&quot;&quot;,D3,C2)</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "is_accepted": false, "score": 0, "last_activity_date": 1507088600, "creation_date": 1507088600, "answer_id": 46556670, "question_id": 46556115, "link": "https://stackoverflow.com/questions/46556115/generating-a-new-column-with-corresponding-values/46556670#46556670", "title": "Generating a new column with corresponding values", "body": "<ol>\n<li><p>Resort Columns(\"A:B\") by \"A:A\", \"B:B\"</p></li>\n<li><p>Make sure there is a blank row above the resorted table</p>\n\n<pre><code> Column A      Column B   Column C\n1  \n2  3/2/2017    Cake       =IF(B2&gt;\"\",B2,IF(A2=A1,C1,\"x\"))\n3  3/2/2017               =IF(B3&gt;\"\",B3,IF(A3=A2,C2,\"x\"))\n4  4/5/2017    Rice         etc.\n5  4/5/2017 \n6  12/1/2017   Pizza\n7  12/1/2017    \n8  12/1/2017    \n</code></pre></li>\n<li><p>Copy down the formula from \"C2\"; \"x\" in the formula is irrelevant</p></li>\n</ol>\n"}], "owner": {"reputation": 1, "user_id": 8717446, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a4efb37732cd4665e1baf953b54490?s=128&d=identicon&r=PG&f=1", "display_name": "Stacy", "link": "https://stackoverflow.com/users/8717446/stacy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507088600, "creation_date": 1507084344, "question_id": 46556115, "link": "https://stackoverflow.com/questions/46556115/generating-a-new-column-with-corresponding-values", "title": "Generating a new column with corresponding values", "body": "<p>I have a spreadsheet as follows:</p>\n\n<pre><code>Column A          Column B\n12/01/17          \n12/01/17          Pizza\n12/01/17\n03/02/17          Cake\n03/02/17\n04/05/17          \n04/05/17          Rice\n</code></pre>\n\n<p>Each food corresponds to a single date, but some cells in the food column are empty.  I need to create a new column which has the proper food values for each row according to date.  It should look like this:</p>\n\n<pre><code>Column A          Column B          Column C\n12/01/17                            Pizza\n12/01/17          Pizza             Pizza\n12/01/17                            Pizza\n03/02/17          Cake              Cake\n03/02/17                            Cake\n04/05/17                            Rice\n04/05/17          Rice              Rice\n</code></pre>\n\n<p>I am thinking a formula is the best way, but am struggling to come up with what it should look like.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": true, "score": 0, "last_activity_date": 1507083324, "creation_date": 1507083324, "answer_id": 46556001, "question_id": 46555920, "link": "https://stackoverflow.com/questions/46555920/wildcard-search-on-excel/46556001#46556001", "title": "Wildcard search on Excel", "body": "<p>If you fire up the macro recorder and perform a search for \"ABC123\" with the option to look in formulas and the option \"Match entire cell contents\" NOT selected, Excel will find the cell with the value ABC123.def</p>\n\n<p>You could then study the code created by the macro recorder and would notice the difference to your code. You use <code>lookat:=xlWhole</code>, i.e. you're looking at the whole cell. Change it to <code>LookAt:=xlPart</code>. This is the equivalent of using a wildcard.</p>\n\n<p>Or build the search term by wrapping it in a set of asterisks. </p>\n\n<pre><code> Set g = .Find(\"*\" &amp; Sheets(3).Range(\"A\" &amp; hName) &amp; \"*\", lookat:=xlWhole)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8717399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c5820d9c6d180457b2c1533ae29fd6b?s=128&d=identicon&r=PG&f=1", "display_name": "Cancel-", "link": "https://stackoverflow.com/users/8717399/cancel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 46556001, "answer_count": 1, "score": 0, "last_activity_date": 1507083324, "creation_date": 1507082508, "last_edit_date": 1531161705, "question_id": 46555920, "link": "https://stackoverflow.com/questions/46555920/wildcard-search-on-excel", "title": "Wildcard search on Excel", "body": "<p>Im creating a macro in excel that has search function. so basically. i will put the list of servers in Sheet3 Column A and it will search the servers ing Sheet1 column A. Once done, it will display the result in Sheet 2 column A. However, im having issue in searching for wildcard. for example. i want to seach server \"ABC123\" but it will not display the result because it needs to be the whole name of the server \"ABC123.def\" can anyone help me with the codes?</p>\n\n<pre><code>    Option Explicit\nSub HostNameFinder()\nDim srchLen, hName, nxtRw As String\nDim g As Range\n'Clear Sheet 2 and Copy Column Headings\n Sheets(2).Cells.ClearContents\n Sheets(1).Rows(1).Copy Destination:=Sheets(2).Rows(1)\n'Determine length of Search Column from Sheet3\n   srchLen = Sheets(3).Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n'Loop through list in Sheet3, Column A. As each value is 'found in Sheet1, Column A, copy it top the next row in Sheet2\n  With Sheets(1).Columns(\"A\")\n    For hName = 2 To srchLen\n      Set g = .Find(Sheets(3).Range(\"A\" &amp; hName), lookat:=xlWhole)\n        If Not g Is Nothing Then\n          nxtRw = Sheets(2).Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n          g.EntireRow.Copy Destination:=Sheets(2).Range(\"A\" &amp; nxtRw)\n        End If\n    Next\n  End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1507096753, "post_id": 46555810, "comment_id": 80069651, "body": "web search &quot;VBA how to open word file&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1507103996, "creation_date": 1507103996, "answer_id": 46559797, "question_id": 46555810, "link": "https://stackoverflow.com/questions/46555810/word-vba-to-reopen-word-file-without-saving/46559797#46559797", "title": "Word vba to reopen Word file without saving", "body": "<pre><code>Sub ReOpen()\n\n    Dim Ffn As String                   ' full file name\n\n    With ActiveDocument\n        Ffn = .FullName\n        .Close SaveChanges:=wdDoNotSaveChanges\n    End With\n    Documents.Open Ffn\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7607935, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209909021096354/picture?type=large", "display_name": "Daniel", "link": "https://stackoverflow.com/users/7607935/daniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 485, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507103996, "creation_date": 1507081415, "last_edit_date": 1507082835, "question_id": 46555810, "link": "https://stackoverflow.com/questions/46555810/word-vba-to-reopen-word-file-without-saving", "title": "Word vba to reopen Word file without saving", "body": "<p>Similar to \"Excel vba to reopen Excel file without saving\"</p>\n\n<pre><code>Sub ReOpen()\n    Application.DisplayAlerts = False\n    Workbooks.Open ActiveWorkbook.Path &amp; \"\\\" &amp; ActiveWorkbook.Name\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>How do I do this with MS Word?</p>\n"}]