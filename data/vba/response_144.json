[{"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 8756048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f74018e4c4714a8fcc1628fbdd78ba10?s=128&d=identicon&r=PG&f=1", "display_name": "Jae", "link": "https://stackoverflow.com/users/8756048/jae"}, "is_accepted": false, "score": 0, "last_activity_date": 1507789974, "last_edit_date": 1507789974, "creation_date": 1507789144, "answer_id": 46702710, "question_id": 46699256, "link": "https://stackoverflow.com/questions/46699256/ms-excel-to-limit-data-in-range-of-cells/46702710#46702710", "title": "MS Excel to Limit Data in Range of Cells", "body": "<p>Did you try to use<code>=countif</code> ? or search for \"countif multiple criteria\" or try to read the other question here. Try to search this question. \"Wrong cell when conditional formatting with values\".</p>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 5054930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b3799f65460fc915e15cfe37e8c238?s=128&d=identicon&r=PG&f=1", "display_name": "kelvin 004", "link": "https://stackoverflow.com/users/5054930/kelvin-004"}, "is_accepted": false, "score": 0, "last_activity_date": 1507790408, "creation_date": 1507790408, "answer_id": 46703020, "question_id": 46699256, "link": "https://stackoverflow.com/questions/46699256/ms-excel-to-limit-data-in-range-of-cells/46703020#46703020", "title": "MS Excel to Limit Data in Range of Cells", "body": "<p>If I get you right:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n     'Let Range(\"A1:G1\") be the seven cells\n\n     If Union(Range(\"A1:G1\"), Target).Address = Range(\"A1:G1\").Address Then\n         If Application.WorksheetFunction.CountIf(Range(\"A1:G1\"), Target.Value) &gt; 3 Then\n            MsgBox \"Cannot input \" &amp; Target.Value &amp; \" more than 3 times.\"\n            Target = \"\"  'Erase\n         End If\n     End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8762074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3996ac8d1587efe2364d3f0a8678d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Claw Dogs", "link": "https://stackoverflow.com/users/8762074/claw-dogs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1507790408, "creation_date": 1507765937, "question_id": 46699256, "link": "https://stackoverflow.com/questions/46699256/ms-excel-to-limit-data-in-range-of-cells", "title": "MS Excel to Limit Data in Range of Cells", "body": "<p>I know this is not a coding service where I ask for something and you spit out a result.  I am looking for the following help:  </p>\n\n<p>say I have 2 unique text data that I can assign to a cell (via data validation or typing in each cell) on a row of 7 cells. Now say I want to allow the text to be assigned to only 3 of those 7 cells each . Is this possible?  If any text is selected more than 3 times within the 7 cells I return an error or grey out the remaining cells?  In other words, once I input the data in a cell, it loops through the 7 cells and counts the number of unique text data found. if more than three of the same text data is found then error, else allow text input..</p>\n\n<p>Any info on this is helpful. Links etc.  I am very grateful for any insight.  </p>\n\n<p>PS I know a bit about data validation and vba macros. Just looking for pointers.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8761961, "user_type": "registered", "profile_image": "https://graph.facebook.com/1862862550392276/picture?type=large", "display_name": "Mechnech046d", "link": "https://stackoverflow.com/users/8761961/mechnech046d"}, "edited": false, "score": 0, "creation_date": 1507821062, "post_id": 46704049, "comment_id": 80372602, "body": "thank you for the prompt response, i will give it a try."}, {"owner": {"reputation": 5, "user_id": 8761961, "user_type": "registered", "profile_image": "https://graph.facebook.com/1862862550392276/picture?type=large", "display_name": "Mechnech046d", "link": "https://stackoverflow.com/users/8761961/mechnech046d"}, "edited": false, "score": 0, "creation_date": 1507823073, "post_id": 46704049, "comment_id": 80373912, "body": "Kelvin 004, Thank you for that, that has definitely sent us in the right direction. I am absolutely amazed. However, once it does its thing right before the it moves on to the next one the values reset to zero as if the value isn&#39;t fully being pasted or stored in the cell."}, {"owner": {"reputation": 5, "user_id": 8761961, "user_type": "registered", "profile_image": "https://graph.facebook.com/1862862550392276/picture?type=large", "display_name": "Mechnech046d", "link": "https://stackoverflow.com/users/8761961/mechnech046d"}, "edited": false, "score": 0, "creation_date": 1507848000, "post_id": 46704049, "comment_id": 80386536, "body": "I got it but i had to modify the last bit of your cod as follows: [code/] wsDm.Range(&quot;T2:X2&quot;).Copy       wsB1.Range(&quot;r2:v2&quot;).Offset(i - 2).PasteSpecial xlPasteValues       Next i [code/]"}, {"owner": {"reputation": 403, "user_id": 5054930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b3799f65460fc915e15cfe37e8c238?s=128&d=identicon&r=PG&f=1", "display_name": "kelvin 004", "link": "https://stackoverflow.com/users/5054930/kelvin-004"}, "reply_to_user": {"reputation": 5, "user_id": 8761961, "user_type": "registered", "profile_image": "https://graph.facebook.com/1862862550392276/picture?type=large", "display_name": "Mechnech046d", "link": "https://stackoverflow.com/users/8761961/mechnech046d"}, "edited": false, "score": 0, "creation_date": 1508146803, "post_id": 46704049, "comment_id": 80479668, "body": "Yes. Do necessary changes to suit your situation. I guess the range to be copied contains formulas that involve other ranges. Thank you."}], "tags": [], "owner": {"reputation": 403, "user_id": 5054930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9b3799f65460fc915e15cfe37e8c238?s=128&d=identicon&r=PG&f=1", "display_name": "kelvin 004", "link": "https://stackoverflow.com/users/5054930/kelvin-004"}, "is_accepted": true, "score": 1, "last_activity_date": 1507794045, "creation_date": 1507794045, "answer_id": 46704049, "question_id": 46699168, "link": "https://stackoverflow.com/questions/46699168/looping-copy-from-multiple-rows-pasting-them-individually-in-the-same-row/46704049#46704049", "title": "looping copy from multiple rows pasting them individually in the same row....", "body": "<p>You need not to select or activate a range or window before copying and pasting. Below is the modified code from I can understand you.</p>\n\n<pre><code>Sub macro_54_Modified()\n'Let your working sheets in Book1 and  DMAutoCalcs are Sheet1 and Sheet2, respectively\n\n   Workbooks.Open \"C:\\Users\\Legacy\\Desktop\\DMAutoCalcs.xlsm\"\n\n   Dim wsDm As Worksheet, wsB1 As Worksheet, lastRow As Long, i As Long\n   Set wsB1 = Workbooks(\"Book1.xlsm\").Sheets(\"Sheet1\")\n   Set wsDm = Workbooks(\"DMAutoCalcs.xlsm\").Sheets(\"Sheet2\")\n\n   'Last row number in column A\n   lastRow = wsB1.Cells(Rows.Count, 1).End(xlUp).Row\n\n   For i = 2 To lastRow\n      wsB1.Range(\"A2:L2\").Offset(i - 2).Copy wsDm.Range(\"a1:q1\")\n      'VBA code for Refresh ... ?\n      wsDm.Range(\"T2:X2\").Copy wsB1.Range(\"M2:q2\").Offset(i - 2)\n   Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8761961, "user_type": "registered", "profile_image": "https://graph.facebook.com/1862862550392276/picture?type=large", "display_name": "Mechnech046d", "link": "https://stackoverflow.com/users/8761961/mechnech046d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 46704049, "answer_count": 1, "score": 0, "last_activity_date": 1507794045, "creation_date": 1507765261, "question_id": 46699168, "link": "https://stackoverflow.com/questions/46699168/looping-copy-from-multiple-rows-pasting-them-individually-in-the-same-row", "title": "looping copy from multiple rows pasting them individually in the same row....", "body": "<p>.....on a separate workbook indefinitely.</p>\n\n<p>Hello First off I am new here and very new to VBA. I have a workbook that has a list that will grow indefinitely named \"book1\" and the code i pieced together grabs data from a range in that book and pastes it into another book \"DMAutocalcs\"in one specific row one at a time and the the code executes a refresh and wait time, after which it copy certain pricing date from a specific range in \"DMautoCalcs\" back into Book1. As of Now i am manually copying the code and modifying it for each range of calls it needs to transfer. so there in lies the issue, inherently it will be limited by the number of times i wish to copy what i have existing. I intend to modify the code to loop and perform the copy paste between the workbooks until it reaches an empty cell in \"book1\" however every attempt i have made has failed, it only continually works the same ranges over and over unless i manually copy the code and modify for each new line. i fear i do not fully understand the range rows and cell aspects when it comes to relatives and absolutes and the proper syntax on how to call the out accurately.\nhow do i achieve this? Any help would be appreciated.</p>\n\n<pre><code>Public Sub macro_54()\n' Keyboard Shortcut: Ctrl+p\nDim StartTime As Double\nDim SecondsElapsed As Double\n\nStartTime = Timer\n\nWorkbooks.Open (\"C:\\Users\\Legacy\\Desktop\\DMAutoCalcs.xlsm\")\n\nWindows(\"Book1.xlsm\").Activate\nRange(\"a2:l2\").Select\nSelection.Copy\nWindows(\"DMAutoCalcs.xlsm\").Activate\nRange(\"a1:q1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                       :=False, Transpose:=False\n'Refresh\nActiveWorkbook.RefreshAll\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\nActiveWorkbook.RefreshAll\n\nWindows(\"DMAutoCalcs.xlsm\").Activate\nRange(\"T2:x2\").Select\n'Application.CutCopyMode = False\nSelection.Copy\nWindows(\"Book1.xlsm\").Activate\nRange(\"M2:q2\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                       :=False, Transpose:=False\n' copy from calcs pricing info and past into pricelist\n' return to pricelist\n ' Selects cell down 1 row from active cell.\n'New Line\nWindows(\"Book1.xlsm\").Activate\nRange(\"a3:l3\").Select\nSelection.Copy\nWindows(\"DMAutoCalcs.xlsm\").Activate\nRange(\"a1:q1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                       :=False, Transpose:=False\n' Refresh\n\nActiveWorkbook.RefreshAll\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\nActiveWorkbook.RefreshAll\n\nWindows(\"DMAutoCalcs.xlsm\").Activate\nRange(\"T2:x2\").Select\n'Application.CutCopyMode = False\nSelection.Copy\nWindows(\"Book1.xlsm\").Activate\nRange(\"M3:q3\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                       :=False, Transpose:=False\n\n' copy from calcs pricing info and past into pricelist\n' return to pricelist\n' Selects cell down 1 row from active cell.\n\n'New Line\nWindows(\"Book1.xlsm\").Activate\nRange(\"a4:l4\").Select\nSelection.Copy\nWindows(\"DMAutoCalcs.xlsm\").Activate\nRange(\"a1:q1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                       :=False, Transpose:=False\n' Refresh\nActiveWorkbook.RefreshAll\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\nActiveWorkbook.RefreshAll\n\nWindows(\"DMAutoCalcs.xlsm\").Activate\nRange(\"T2:x2\").Select\n'Application.CutCopyMode = False\nSelection.Copy\nWindows(\"Book1.xlsm\").Activate\nRange(\"M4:q4\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                       :=False, Transpose:=False\n\n' copy from calcs pricing info and past into pricelist\n' return to pricelist\n'\n' Selects cell down 1 row from active cell.\n' And so on and so forth....\nWindows(\"DMAutoCalcs.xlsm\").Activate\nActiveWorkbook.Close savechanges:=False\nWindows(\"Book1.xlsm\").Activate\n'Determine how many seconds code took to run\nSecondsElapsed = Round(Timer - StartTime, 2)\n'Notify user in seconds\nMsgBox \"All Ranges Updated, Calc sheet closed successfully in \" &amp; SecondsElapsed &amp; \" seconds\", vbInformation\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["sql-server", "vba"], "comments": [{"owner": {"reputation": 69229, "user_id": 53341, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/98geJ.png?s=128&g=1", "display_name": "MatBailie", "link": "https://stackoverflow.com/users/53341/matbailie"}, "edited": false, "score": 0, "creation_date": 1507764411, "post_id": 46698998, "comment_id": 80345573, "body": "I really hope the password is NOT what you have in that connection string"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1507765283, "post_id": 46698998, "comment_id": 80345751, "body": "Take the VBA piece out of the equation. Use SSMS or the UDL method to test connectivity. Can you connect at all with SSMS? If so, browse to the server logins and make sure sa is enabled"}, {"owner": {"reputation": 671797, "user_id": 13302, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/b4779212f57ff2e9549ea90a4499c2d7?s=128&d=identicon&r=PG", "display_name": "marc_s", "link": "https://stackoverflow.com/users/13302/marc-s"}, "edited": false, "score": 1, "creation_date": 1507783984, "post_id": 46698998, "comment_id": 80350329, "body": "<code>MSSQLSERVER</code> is the default service name for the default (unnamed) instance - is that <b>really</b> your database name, also??"}, {"owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 0, "creation_date": 1507792480, "post_id": 46698998, "comment_id": 80353993, "body": "Don&#39;t use the &#39;sa&#39; user for making connections."}, {"owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 0, "creation_date": 1507792503, "post_id": 46698998, "comment_id": 80354005, "body": "<a href=\"https://support.microsoft.com/en-us/help/4009936/solving-connectivity-errors-to-sql-server\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/4009936/&hellip;</a>"}, {"owner": {"reputation": 3, "user_id": 8761927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a696922d85207bba3d80922db85dcd7?s=128&d=identicon&r=PG&f=1", "display_name": "Liz", "link": "https://stackoverflow.com/users/8761927/liz"}, "edited": false, "score": 0, "creation_date": 1507907142, "post_id": 46698998, "comment_id": 80412205, "body": "I&#39;ve already confirmed that sa is enabled and yes (oddly enough), MSSQLSERVER is the name of our instance - there was nothing else listed. And no, that&#39;s not my password...I&#39;ll try a couple of the suggestions below."}], "answers": [{"comments": [{"owner": {"reputation": 279739, "user_id": 16076, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/D29fm.jpg?s=128&g=1", "display_name": "Mitch Wheat", "link": "https://stackoverflow.com/users/16076/mitch-wheat"}, "edited": false, "score": 0, "creation_date": 1507792527, "post_id": 46699071, "comment_id": 80354015, "body": "Don&#39;t enable the &#39;sa&#39; user. Disable it and rename it. That&#39;s best practice!"}], "tags": [], "owner": {"reputation": 39, "user_id": 3607835, "user_type": "registered", "profile_image": "https://graph.facebook.com/1425925739/picture?type=large", "display_name": "olpro123", "link": "https://stackoverflow.com/users/3607835/olpro123"}, "is_accepted": false, "score": 0, "last_activity_date": 1507764642, "creation_date": 1507764642, "answer_id": 46699071, "question_id": 46698998, "link": "https://stackoverflow.com/questions/46698998/cannot-open-database-mssqlserver-requested-by-the-login-the-login-failed-log/46699071#46699071", "title": "Cannot open database \u201cMSSQLSERVER\u201d requested by the login. The login failed. Login failed for user sa", "body": "<p>sa user is disabled for logging by default, you need to enable it, try this:</p>\n\n<p><a href=\"https://sudeeptaganguly.wordpress.com/2010/04/20/how-to-enable-sa-account-in-sql-server/\" rel=\"nofollow noreferrer\">https://sudeeptaganguly.wordpress.com/2010/04/20/how-to-enable-sa-account-in-sql-server/</a></p>\n"}, {"tags": [], "owner": {"reputation": 7849, "user_id": 7610456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5431d63c7d37a62d083ffc45c6fc599b?s=128&d=identicon&r=PG&f=1", "display_name": "sepupic", "link": "https://stackoverflow.com/users/7610456/sepupic"}, "is_accepted": true, "score": 1, "last_activity_date": 1507792374, "creation_date": 1507792374, "answer_id": 46703541, "question_id": 46698998, "link": "https://stackoverflow.com/questions/46698998/cannot-open-database-mssqlserver-requested-by-the-login-the-login-failed-log/46703541#46703541", "title": "Cannot open database \u201cMSSQLSERVER\u201d requested by the login. The login failed. Login failed for user sa", "body": "<blockquote>\n  <p>Cannot open database <strong>\u201cMSSQLSERVER\u201d</strong> requested by the login. The login\n  failed. Login failed for user sa</p>\n</blockquote>\n\n<p>Database MSSQLSERVER does not exist, so it can't be open.</p>\n\n<p>Just pass nothing as Database in your connection string, or pass <code>master</code>, or any existing database that you should use.</p>\n"}], "owner": {"reputation": 3, "user_id": 8761927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a696922d85207bba3d80922db85dcd7?s=128&d=identicon&r=PG&f=1", "display_name": "Liz", "link": "https://stackoverflow.com/users/8761927/liz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1792, "favorite_count": 0, "accepted_answer_id": 46703541, "answer_count": 2, "score": -1, "last_activity_date": 1507792374, "creation_date": 1507764097, "last_edit_date": 1507783951, "question_id": 46698998, "link": "https://stackoverflow.com/questions/46698998/cannot-open-database-mssqlserver-requested-by-the-login-the-login-failed-log", "title": "Cannot open database \u201cMSSQLSERVER\u201d requested by the login. The login failed. Login failed for user sa", "body": "<p>I'm fairly new to both SQL Server, as well as VBA. I'm trying to connect to our SQL Server using VBA and after troubleshooting several issues, I've finally hit a roadblock. I'm receiving the following error message: </p>\n\n<blockquote>\n  <p>Cannot open database \u201cMSSQLSERVER\u201d requested by the login. The login failed. Login failed for user sa</p>\n</blockquote>\n\n<p>I realize that using the <code>sa</code> username is not ideal for security purposes, but it's what I have to work with right now. I've tried restarting SQL Server, I've ensured that mixed mode authentication is on. The code I'm using is listed below, I'm just using a test query for now to pull one line of data from the db. Any help would be greatly appreciated</p>\n\n<pre><code>Dim conn As ADODB.Connection\nDim rs As ADODB.Recordset\nDim sConnString As String\n\n' Create the connection string.\nsConnString = \"Provider=SQLNCLI11;Server=servername;Database=MSSQLSERVER;Uid=sa;Pwd=password;\"\n\n' Create the Connection and Recordset objects.\nSet conn = New ADODB.Connection\nSet rs = New ADODB.Recordset\n\n' Open the connection and execute.\nconn.Open sConnString\nSet rs = conn.Execute(\"SELECT IM_BARCOD.BARCOD FROM IM_BARCOD WHERE BARCOD = '793661061274';\")\n\n' Check we have data.\nIf Not rs.EOF Then\n    ' Transfer result.\n    Sheets(1).Range(\"A1\").CopyFromRecordset rs\n' Close the recordset\n    rs.Close\nElse\n    MsgBox \"Error: No records returned.\", vbCritical\nEnd If\n\n' Clean up\nIf CBool(conn.State And adStateOpen) Then conn.Close\nSet conn = Nothing\nSet rs = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1507766958, "post_id": 46698981, "comment_id": 80346159, "body": "Use a scripting dictionary with keys and items."}], "answers": [{"comments": [{"owner": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1507802604, "post_id": 46699591, "comment_id": 80360092, "body": "Thanks man, it could have work just fine, only problem is when I have two different words with the same score, and then it takes the higher one in the column twice. Appreciate it!"}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "reply_to_user": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1507824619, "post_id": 46699591, "comment_id": 80374817, "body": "You were right. I have updated the formula to account for repeated scores, it should work as expected now."}, {"owner": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1507906543, "post_id": 46699591, "comment_id": 80411790, "body": "I Would consider replacing it. Hope it&#39;s not too much trouble, do you mind explaining how you built it? how it works? I would love to use it, but since I know programming but not EXCEL formulas, in case I need to change stuff, it&#39;s much easier for me to try to understand what needs to be changed in VBA than formulas. But if you&#39;ll help me understand a little bit how it works? Thanks!!"}, {"owner": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1508105830, "post_id": 46699591, "comment_id": 80466428, "body": "Hey man! this also works great, just few questions, if I want it to give back 5 keywords? what should I change? Also, if I want to change the term, for example when Rank A equals = &quot;-&quot; and Rank B is not equal to  &quot;-&quot;??"}], "tags": [], "owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "is_accepted": false, "score": 0, "last_activity_date": 1507824452, "last_edit_date": 1507824452, "creation_date": 1507768440, "answer_id": 46699591, "question_id": 46698981, "link": "https://stackoverflow.com/questions/46698981/select-cells-by-condition-and-print-them-in-different-range/46699591#46699591", "title": "Select cells by condition and print them in different range", "body": "<p>If you're open to a formula solution instead of VBA, you could go with - entered as individual array formulas in each cell (ctrl+shift+enter):</p>\n\n<pre><code>G3-G5: {=INDEX($A$2:$A$8,MATCH(1,INDEX(($B$2:$B$8=LARGE($B$2:$B$8*--($C$2:$C$8&gt;$D$2:$D$8),ROWS(G$2:G2)))*(COUNTIF(G$2:G2,$A$2:$A$8)=0),),0))}\n</code></pre>\n\n<p>And in column H, entered as individual array formulas (ctrl+shift+enter):</p>\n\n<pre><code>H3-5: {=LARGE($B$2:$B$8*--($C$2:$C$8&gt;$D$2:$D$8),row()-2)}\n</code></pre>\n\n<p>Attached is a screenshot to see it in use. Generally, I'd recommend against using VBA for something you could solve with formulas, but that's just me.\n<a href=\"https://i.stack.imgur.com/AZBy2.png\" rel=\"nofollow noreferrer\">Screenshot of result</a></p>\n"}, {"comments": [{"owner": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1507796092, "post_id": 46699607, "comment_id": 80356005, "body": "Hi, this works amazing! Thank you! if you don&#39;t mind, can you please explain how you did it?"}, {"owner": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1507798240, "post_id": 46699607, "comment_id": 80357241, "body": "I see I can extend the number of keywords to be taken out if I change the offset value in the last row, still not sure why"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1507798411, "post_id": 46699607, "comment_id": 80357353, "body": "@sale108, if 5 rngDB.Offset(4).Clear  to  rngDB.Offset(6).Clear  if 4  to rngDB.Offset(5).Clear"}, {"owner": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1507803064, "post_id": 46699607, "comment_id": 80360373, "body": "thank you again! I have just one more problem, it seems that I exceed some sort of limit, I am not sure what is the origin of the error... maybe you can help me with that too? it&#39;s updated above in the thread."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1507820088, "post_id": 46699607, "comment_id": 80371888, "body": "@sale108, can you show the sheet of  table (300 Rows, 12 Columns)."}, {"owner": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1507937985, "post_id": 46699607, "comment_id": 80425534, "body": "Hey man, actually, I found out that the size is not the problem. The problem is the exceptions. When there are less than 3 words that meet the terms (Rank B is lower than Rank A). and then it fails on line &quot;Range(&quot;g3&quot;).Resize(n, 2) = WorksheetFunction.Transpose(vR)&quot;. I want excel to print the result if there&#39;s only one word that meet the requirements."}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1507957277, "post_id": 46699607, "comment_id": 80428525, "body": "If n=1 then Range(&quot;g3&quot;).Resize(n, 2) = vR elseif n&gt;1 then Range(&quot;g3&quot;).Resize(n, 2) = WorksheetFunction.Transpose(vR)"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "reply_to_user": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "edited": false, "score": 0, "creation_date": 1507957891, "post_id": 46699607, "comment_id": 80428614, "body": "Elseif n= 0 then exit sub  end if"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": false, "score": 1, "last_activity_date": 1507966477, "last_edit_date": 1507966477, "creation_date": 1507768649, "answer_id": 46699607, "question_id": 46698981, "link": "https://stackoverflow.com/questions/46698981/select-cells-by-condition-and-print-them-in-different-range/46699607#46699607", "title": "Select cells by condition and print them in different range", "body": "<p>Try this</p>\n\n<pre><code>Sub test()\n    Dim vDB, vR()\n    Dim i As Long, n As Long\n    Dim rngDB As Range\n\n    vDB = Range(\"a1\").CurrentRegion\n\n    For i = 1 To UBound(vDB, 1)\n        If vDB(i, 3) &gt; vDB(i, 4) Then\n            n = n + 1\n            ReDim Preserve vR(1 To 2, 1 To n)\n            vR(1, n) = vDB(i, 1)\n            vR(2, n) = vDB(i, 2)\n        End If\n    Next i\n    Range(\"g1\").CurrentRegion.Offset(2).Clear\n    If n = 0 Then\n        MsgBox \"No data matches the condition!!\"\n        Exit Sub\n    ElseIf n = 1 Then\n        Range(\"g3\").Resize(n, 2) = vR\n    Else\n        Range(\"g3\").Resize(n, 2) = WorksheetFunction.Transpose(vR)\n    End If\n    Set rngDB = Range(\"g2\").Resize(n + 1, 2)\n    rngDB.Sort key1:=Range(\"h2\"), order1:=xlDescending, Header:=xlYes\n    rngDB.Offset(4).Clear\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 455, "user_id": 7841035, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ad1f08db3d97e02860ffed186b613ab2?s=128&d=identicon&r=PG&f=1", "display_name": "sale108", "link": "https://stackoverflow.com/users/7841035/sale108"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1557495936, "creation_date": 1507763971, "last_edit_date": 1557495936, "question_id": 46698981, "link": "https://stackoverflow.com/questions/46698981/select-cells-by-condition-and-print-them-in-different-range", "title": "Select cells by condition and print them in different range", "body": "<p>I want code to:<br>\nFor keywords that their \"Rank B\" is lower than \"Rank A\", take only the first 3 that have the highest score and put them, along with their score, under the \"selected\" table on the right.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZdPUi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZdPUi.png\" alt=\"enter image description here\"></a></p>\n\n<p>I've been trying to collect them to an array.</p>\n\n<p>Update:\nI used Dy.Lee solution, it works, unless I have a big table (300 Rows, 12 Columns), then it fails on the following line:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zGkaE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zGkaE.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/dxA0w.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dxA0w.png\" alt=\"enter image description here\"></a></p>\n\n<p>I found the problem, I had 2 identical column in the end of the table. Any way to catch this exception? </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 7547802, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/71fb689e6af993d16b319d80de0e5aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Rose", "link": "https://stackoverflow.com/users/7547802/jon-rose"}, "edited": false, "score": 0, "creation_date": 1507767294, "post_id": 46699210, "comment_id": 80346233, "body": "Genius!  Thank you for the help.  I&#39;ll take note of this structure for future reference."}], "tags": [], "owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "is_accepted": true, "score": 0, "last_activity_date": 1507765581, "creation_date": 1507765581, "answer_id": 46699210, "question_id": 46698976, "link": "https://stackoverflow.com/questions/46698976/why-is-my-error-handler-only-working-once/46699210#46699210", "title": "Why is my Error Handler only working once?", "body": "<p>Because you are not resuming from your error. There are a couple of technical issues with your code. Try this:</p>\n\n<pre><code>    Sub InitializeFormat()\n    On Error GoTo SheetDoesNotExist\n\n        Dim ws As Worksheet\n\n\n        For Each ws In Worksheets\n            If Right(ws.Name, 4) &lt;&gt; \"(FF)\" Then\n                Sheets(ws.Name &amp; \"(FF)\").Cells.Copy\n                Sheets(ws.Name).Cells.PasteSpecial Paste:=xlFormats\n            End If\n    NextSheet:\n         Next ws\n         Exit Sub\n    SheetDoesNotExist:\n        Resume NextSheet\n\n    End Sub\n</code></pre>\n\n<p>Now when you get an error, you HANDLE it by RESUMING (Which clears the error). If you do not receive an error, the program will exit before it reaches the error handler.</p>\n"}], "owner": {"reputation": 99, "user_id": 7547802, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/71fb689e6af993d16b319d80de0e5aa5?s=128&d=identicon&r=PG&f=1", "display_name": "Jon Rose", "link": "https://stackoverflow.com/users/7547802/jon-rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 494, "favorite_count": 0, "accepted_answer_id": 46699210, "answer_count": 1, "score": 0, "last_activity_date": 1507765581, "creation_date": 1507763959, "last_edit_date": 1531164843, "question_id": 46698976, "link": "https://stackoverflow.com/questions/46698976/why-is-my-error-handler-only-working-once", "title": "Why is my Error Handler only working once?", "body": "<p>I'm attempting to cycle through all the worksheets in a specific workbook and attempting to copy formatting from one worksheet to another.  The objective here is to find the corresponding worksheet, which has the same name but is appended by \"(FF)\".  Then I want to copy that Sheet's format to the sheet that doesn't contain the appended version of \"(FF)\".  Unfortunately, not all sheets contain it's corresponding sheet with the appended \"(FF)\".  That being said, I've written the Macro below to help me blow through any \"Subscript out of range\" errors by way of sending it to an Error Handler.  The problem is, when testing this out on a workbook where no sheet has a corresponding sheet appended by \"(FF)\" it only blows through the first \"Subscript out of range\" error and that's it.</p>\n\n<p>Why is my Error Handler only working once?</p>\n\n<pre><code>Sub InitializeFormat()\n\n    Dim ws As Worksheet\n\n\n    For Each ws In Worksheets\n        If Right(ws.Name, 4) &lt;&gt; \"(FF)\" Then\n            On Error GoTo SheetDoesNotExist\n            Sheets(ws.Name &amp; \"(FF)\").Cells.Copy\n            Sheets(ws.Name).Cells.PasteSpecial Paste:=xlFormats\n        End If\nSheetDoesNotExist:\n    Next ws\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "while-loop", "vba"], "comments": [{"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1507766036, "post_id": 46698842, "comment_id": 80345954, "body": "Looks fine to me. I see some cells where Product COde is blank...you sure there are values in the ones &#39;Due&#39;? (I assume you highlited the one that isn&#39;t working with the **)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507766862, "post_id": 46698842, "comment_id": 80346138, "body": "Judging by your data, it seems likely that column G is always blank on the rows where you have a due date that falls in the current week.  Is column G only populated on the rows that appear to be a &quot;header&quot; record for each &quot;CAPA#&quot;?"}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 5388889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7469cf0f416d51d9d7cc8e5546c477?s=128&d=identicon&r=PG&f=1", "display_name": "Dheerendra Pratap Singh", "link": "https://stackoverflow.com/users/5388889/dheerendra-pratap-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1507859760, "creation_date": 1507859760, "answer_id": 46721353, "question_id": 46698842, "link": "https://stackoverflow.com/questions/46698842/i-have-a-specific-line-in-while-loop-in-vba-which-doesnt-execute-but-every-othe/46721353#46721353", "title": "I have a specific line in while loop in VBA which doesn&#39;t execute but every other line executes", "body": "<p>@KacireeSoftware - So I am testing if the current date falls in this week and the column O Child status is not equal to Closed-Done then copy CAPA#, Child Task Number, Short Description, Due Date, Workstream member and Entity to the new sheet.\nYour assumption is right. I have highlighted the code which is not working. \nCurrently, how the spreadsheet is set up, wherever there is a product, there is no Child Due date and where there is child task there is no due date.</p>\n\n<p>@YowE3K - Yes Column G is only populated for header record for each CAPA#.</p>\n\n<p>Thank you @KacireeSoftware and @YowE3K  for your help. Your questions made me help find the problem.</p>\n\n<p>The problem with the code was that it is currently testing if current date falls in this week and the column O Child status is not equal to Closed-Done then copy CAPA#, Child Task Number, Short Description, Due Date, Workstream member and Entity to the new sheet. However, the Product/Process Entity column is empty in the spreadsheet for those rows. So even though it executes it, it finds nothing to copy there and copies blank in those rows.</p>\n\n<p>Thank you once again making me think in that direction. You guys are awesome.</p>\n"}], "owner": {"reputation": 9, "user_id": 5388889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba7469cf0f416d51d9d7cc8e5546c477?s=128&d=identicon&r=PG&f=1", "display_name": "Dheerendra Pratap Singh", "link": "https://stackoverflow.com/users/5388889/dheerendra-pratap-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507859760, "creation_date": 1507763073, "last_edit_date": 1531164843, "question_id": 46698842, "link": "https://stackoverflow.com/questions/46698842/i-have-a-specific-line-in-while-loop-in-vba-which-doesnt-execute-but-every-othe", "title": "I have a specific line in while loop in VBA which doesn&#39;t execute but every other line executes", "body": "<p>Thank you in advance for going through this question. I am a newbie in Excel VBA world.</p>\n\n<p>I have a spreadsheet which I am working on. This spreadsheet had some raw data with multiple columns and rows. I am trying to loop through the whole sheet and based on certain conditions (like the date falls in this week or item has a value Open), I am trying to copy the certain cells of a row to the other tab (sheet) of the spreadsheet.</p>\n\n<p>So now, my while loop works okay and some cell values are getting copied to the next tab but just one cell value is not getting copied. When I try to debug it. I see the line is getting executed but the value is not getting copied. I double checked to see if I am referring to the correct column and it is correct. Please see the code below. I have <code>Sht1</code> and <code>Sht2</code> as public constants defined outside of <code>Sub</code> which is for sheet names \"Tracking Sheet\" and \"ItemsDueSheet\".</p>\n\n<pre><code>Public Const Sht1 = \"Tracking Sheet\"\nPublic Const Sht2 = \"ItemsDueSheet\"\n\nSub ItemsDueThisWeek()\n\nDim rwCounter As Integer\nDim rstart As Integer\nDim rEnd As Integer\nDim increment As Integer\nrstart = 3\nrEnd = 249\nrwCounter = 5\nincrement = 1\nWhile (rstart &lt;= rEnd)\n    'MsgBox (Format(Sheets(1).Cells(rStart, 16)))\n    If (Format(Sheets(Sht1).Cells(rstart, 16), \"ww-yyyy\") = Format(Date, \"ww-yyyy\") And Sheets(Sht1).Cells(rstart, 15) &lt;&gt; \"Closed - Done\") Then\n        Sheets(Sht2).Cells(rwCounter, 2) = increment\n        Sheets(Sht2).Cells(rwCounter, 4) = Sheets(Sht1).Cells(rstart, 1)\n        Sheets(Sht2).Cells(rwCounter, 5) = Sheets(Sht1).Cells(rstart, 2)\n        **Sheets(Sht2).Cells(rwCounter, 8) = Sheets(Sht1).Cells(rstart, 7)**\n        Sheets(Sht2).Cells(rwCounter, 3) = Sheets(Sht1).Cells(rstart, 13)\n        Sheets(Sht2).Cells(rwCounter, 6) = Sheets(Sht1).Cells(rstart, 16)\n        Sheets(Sht2).Cells(rwCounter, 7) = Sheets(Sht1).Cells(rstart, 12)\n\n        rwCounter = rwCounter + 1\n        increment = increment + 1\n        'MsgBox (\"A\")\n\n    Else\n\n        'Sheets(2).Cells(rwcounter, 5) = Sheets(1).Cells(rStart, 1)\n        'Sheets(2).Cells(rwcounter, 6) = Sheets(1).Cells(rStart, 2)\n    End If\n\n    rstart = rstart + 1\n\nWend\n\nEnd Sub\n</code></pre>\n\n<p>Here is the layout of ItemsdueSheet where I am trying to copy the cell based on button click from tracking sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NmlV2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NmlV2.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/PLXoT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PLXoT.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1507774001, "post_id": 46698828, "comment_id": 80347800, "body": "So the <b>Table</b> is just normal Range and not a ListObject?"}, {"owner": {"reputation": 1, "user_id": 8716831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1185ffa51612cc3595bc33165ca287?s=128&d=identicon&r=PG&f=1", "display_name": "San", "link": "https://stackoverflow.com/users/8716831/san"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1507822399, "post_id": 46698828, "comment_id": 80373460, "body": "It is a listObject"}], "answers": [{"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1507845944, "creation_date": 1507845944, "answer_id": 46719607, "question_id": 46698828, "link": "https://stackoverflow.com/questions/46698828/how-to-traverse-column-from-table-header-in-vba/46719607#46719607", "title": "how to traverse column from table header in vba", "body": "<p>Have not gone through your code, but you can access the actual Column from <code>WorksheetObject.Range(\"TableName[HeaderCaption]\").Column</code>.</p>\n\n<p>Say I have a Table \"<strong>Table1</strong>\" (ListObject) in Sheet1 with <code>Dim oWS as Worksheet; Set oWS = Thisworkbook.Worksheets(\"Sheet1\")</code>, then:</p>\n\n<ul>\n<li>Header address can be accessed by: <code>oWS.Range(\"Table1[#Headers]\").Address</code></li>\n<li>Column of a particular Header: <code>oWS.Range(\"Table1[MyHeader]\").Column</code></li>\n</ul>\n\n<p>Ref: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/listobject-object-excel\" rel=\"nofollow noreferrer\">ListObject Object (Excel)</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8716831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b1185ffa51612cc3595bc33165ca287?s=128&d=identicon&r=PG&f=1", "display_name": "San", "link": "https://stackoverflow.com/users/8716831/san"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507845944, "creation_date": 1507762957, "last_edit_date": 1507763784, "question_id": 46698828, "link": "https://stackoverflow.com/questions/46698828/how-to-traverse-column-from-table-header-in-vba", "title": "how to traverse column from table header in vba", "body": "<p>I am new to VBA and I have written a code to highlight few things in my excel file. But I have one problem I want to traverse column from table header in vba and I am not able to do it as my column number may change in future.  Please help.</p>\n\n<p>Below is my code-</p>\n\n<p>Thank you!</p>\n\n<pre><code>Sub LoopThroughRows()\n\n    Application.EnableCancelKey = xlDisabled\n    Dim k As Long, lastrow As Long, lastCol As Long, i As Integer, j As Integer, CurrentYear As String, TableHeader As String, CurrentQuarter As String, TargetYear As String, TargetQuarter As String\n    lastCol = Range(\"AA1\").End(xlToRight).Column\n\n    With Worksheets(\"Sheet1\")\n        lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n    Application.ScreenUpdating = False\n\n    For j = 2 To lastrow                              'Starting the loop from the 2nd row\n        For i = 27 To lastCol                         ' Starting the loop from the 27th column AA1\n            With Worksheets(\"Sheet1\")\n                If .Cells(j, i).Value &gt; 0 Then\n                    TableHeader = Cells(1, i).Text\n                    Exit For\n                End If\n            End With\n        Next                                          'Loop to traverse columns ends if the condition is met\n\n        CurrentYear = Right(Cells(1, i), 2)           ' Extracting the last 2 characters\n        CurrentQuarter = Mid(Cells(1, i), 2, 1)       'Extracting the Quarter number 2nd character\n        TargetYear = Right(Range(\"R\" &amp; j), 2)         'Extracting the last 2 characters\n        TargetQuarter = Right(Range(\"Q\" &amp; j), 1)      'Extracting the quarter number\n        Range(\"BX1\" &amp; j) = \"Status\"\n\n\n        If Not IsNull(CurrentYear &amp; TargetYear) Then\n            If CurrentYear &lt; TargetYear Then\n                Range(\"A\" &amp; j).EntireRow.Interior.ColorIndex = 3\n                Range(\"BX\" &amp; j) = \"Early Start\"\n            ElseIf TargetYear = CurrentYear Then\n                If CurrentQuarter &lt; TargetQuarter Then\n                    Range(\"A\" &amp; j).EntireRow.Interior.ColorIndex = 3\n                    Range(\"BX\" &amp; j) = \"Early Start\"\n                End If\n            End If\n\n        End If\n\n        If Not IsNull(CurrentYear &amp; TargetYear) Then\n            If CurrentYear &gt; TargetYear Then\n                Range(\"A\" &amp; j).EntireRow.Interior.ColorIndex = 6\n                Range(\"BX\" &amp; j) = \"Late Start\"\n            ElseIf TargetYear = CurrentYear Then\n                If CurrentQuarter &gt; TargetQuarter Then\n                    Range(\"A\" &amp; j).EntireRow.Interior.ColorIndex = 6\n                    Range(\"BX\" &amp; j) = \"Late Start\"\n                End If\n            End If\n\n        End If\n\n        If WorksheetFunction.Sum(Range(\"AA\" &amp; j &amp; \":BW\" &amp; lastCol)) = 0 Then\n            Range(\"A\" &amp; j).EntireRow.Interior.ColorIndex = 5\n            Range(\"BX\" &amp; j) = \"Not Started\"\n        End If\n    Next                                              ' Moving on to next row\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1507762837, "post_id": 46698725, "comment_id": 80345188, "body": "Is <code>CurrentWeek</code> a table or a query? If it&#39;s query, we&#39;ll need to see the query&#39;s definition as it might be actually causing problems."}, {"owner": {"reputation": 19, "user_id": 8202179, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2187cdef95de863403a6ab068a40d605?s=128&d=identicon&r=PG&f=1", "display_name": "delnav222", "link": "https://stackoverflow.com/users/8202179/delnav222"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1507869867, "post_id": 46698725, "comment_id": 80391580, "body": "CurrentWeek is a table. I figured it out and I&#39;m going to adjust the code."}], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1507792123, "post_id": 46698823, "comment_id": 80353817, "body": "This makes no sense. It is inside a constant string - Access wouldn&#39;t care about brackets in there (at least it wouldn&#39;t cause a syntax error)."}], "tags": [], "owner": {"reputation": 19, "user_id": 8202179, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2187cdef95de863403a6ab068a40d605?s=128&d=identicon&r=PG&f=1", "display_name": "delnav222", "link": "https://stackoverflow.com/users/8202179/delnav222"}, "is_accepted": false, "score": 1, "last_activity_date": 1507869979, "last_edit_date": 1507869979, "creation_date": 1507762908, "answer_id": 46698823, "question_id": 46698725, "link": "https://stackoverflow.com/questions/46698725/whats-wrong-with-the-syntax-for-this-sql-statement-in-vba-access/46698823#46698823", "title": "What&#39;s wrong with the syntax for this SQL statement in VBA access?", "body": "<p>The Direct Cite portion was missing brackets. Corrected code piece shown below:</p>\n\n<pre><code>Like \" * [direct cite] * \"))\n</code></pre>\n\n<p>The above code should've worked but what actually ended up working was:</p>\n\n<pre><code>Like ' *[direct cite]* '))\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1507763516, "creation_date": 1507763516, "answer_id": 46698910, "question_id": 46698725, "link": "https://stackoverflow.com/questions/46698725/whats-wrong-with-the-syntax-for-this-sql-statement-in-vba-access/46698910#46698910", "title": "What&#39;s wrong with the syntax for this SQL statement in VBA access?", "body": "<p>Your code should be enclosed in double quotes <code>\"</code> not blockquotes <code>\u201c \u201c</code>.  You will also need to escape all double quotes by doubling them up in the query (e.g. change <code>\"*direct cite*\"</code> to <code>\"\"*direct cite*\"\"</code>. </p>\n\n<pre><code>SELECT TOP 1 Max(CurrentWeek.WeekEnding) AS MaxOfWeekEnding, CurrentWeek.NWA, CurrentWeek.[NWA Description], CurrentWeek.Plan FROM CurrentWeek INNER JOIN (tblNWABasic INNER JOIN tblProjects ON tblNWABasic.ProjectID = tblProjects.ProjectID) ON CurrentWeek.NWA = tblNWABasic.NWA GROUP BY CurrentWeek.NWA, CurrentWeek.[NWA Description], CurrentWeek.Plan HAVING (((CurrentWeek.[NWA Description]) Like \"\"*direct cite*\"\")) ORDER BY Max(CurrentWeek.WeekEnding) DESC;\n</code></pre>\n\n<hr>\n\n<p>This subroutine will simplify the process of escaping the quotes.  Simply copy the string to the Windows Clipboard, run the EscapeDoubleQuotesInClipboard and paste the new string into your code. </p>\n\n<pre><code>Sub EscapeDoubleQuotesInClipboard()\n    With CreateObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n        .GetFromClipboard\n        .SetText Replace(.GetText, Chr(34), Chr(34) &amp; Chr(34))\n        .PutInClipboard\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8202179, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2187cdef95de863403a6ab068a40d605?s=128&d=identicon&r=PG&f=1", "display_name": "delnav222", "link": "https://stackoverflow.com/users/8202179/delnav222"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507869979, "creation_date": 1507762254, "last_edit_date": 1507788743, "question_id": 46698725, "link": "https://stackoverflow.com/questions/46698725/whats-wrong-with-the-syntax-for-this-sql-statement-in-vba-access", "title": "What&#39;s wrong with the syntax for this SQL statement in VBA access?", "body": "<p>The code below returns a syntax error in Access VBA and I was using this same code in a query design which worked fine. I understand the SQL code can be different when in query design mode vs. VBA query but I can't identify how to make this code run without error in Access VBA.</p>\n\n<pre><code>SELECT TOP 1 \n    MAX(CurrentWeek.WeekEnding) AS MaxOfWeekEnding, \n    CurrentWeek.NWA, CurrentWeek.[NWA Description], CurrentWeek.Plan \nFROM \n    CurrentWeek \nINNER JOIN \n    (tblNWABasic \nINNER JOIN \n    tblProjects ON tblNWABasic.ProjectID = tblProjects.ProjectID) ON CurrentWeek.NWA = tblNWABasic.NWA \nGROUP BY \n    CurrentWeek.NWA, CurrentWeek.[NWA Description], CurrentWeek.Plan \nHAVING \n    (((CurrentWeek.[NWA Description]) Like \"*direct cite*\")) \nORDER BY \n    MAX(CurrentWeek.WeekEnding) DESC;\n</code></pre>\n"}, {"tags": ["vba", "excel", "outlook", "appointment"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1507762595, "post_id": 46698706, "comment_id": 80345122, "body": "Where&#39;s the <code>Send</code> command? Also, you say it&#39;s not going to the right person in the top paragraph, but then say it&#39;s definitely grabbing the info you want.  Is it correctly filling in the email, just not sending?"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1507771941, "post_id": 46698706, "comment_id": 80347328, "body": "outMail.to = range(&quot;m3&quot;)"}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1507817850, "post_id": 46698706, "comment_id": 80370250, "body": "There is no send command. Do I need one? It&#39;s not creating a mail item, just an appointment that opens up on my screen. And it&#39;s pulling the right information from the sheet to fill out the appt macro, that&#39;s what I meant. - To BruceWayne"}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1507818443, "post_id": 46698706, "comment_id": 80370696, "body": "To Dy.Lee - Didn&#39;t work. Any other suggestions/additions"}, {"owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "edited": false, "score": 0, "creation_date": 1507843606, "post_id": 46698706, "comment_id": 80384819, "body": "awww guys don&#39;t give up on me now :-("}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508049778, "post_id": 46698706, "comment_id": 80450564, "body": "comment out the <code>on error ...</code> line and run code again"}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508049866, "post_id": 46698706, "comment_id": 80450587, "body": "put the <code>stop</code> command before the <code>Set OutMail = Nothing</code> line"}], "answers": [{"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1509191641, "creation_date": 1509191641, "answer_id": 46989430, "question_id": 46698706, "link": "https://stackoverflow.com/questions/46698706/send-appointment-vba/46989430#46989430", "title": "Send Appointment VBA", "body": "<p>I didn't try the scripts, but it looks like they will do what you want.</p>\n\n<pre><code>Sub ResolveName()  \n Dim myNamespace As Outlook.NameSpace  \n Dim myRecipient As Outlook.Recipient  \n Dim CalendarFolder As Outlook.Folder \n Set myNamespace = Application.GetNamespace(\"MAPI\")  \n Set myRecipient = myNamespace.CreateRecipient(\"Dan Wilson\")  \n myRecipient.Resolve  \n If myRecipient.Resolved Then  \n    Call ShowCalendar(myNamespace, myRecipient)  \n End If  \nEnd Sub \nSub ShowCalendar(myNamespace, myRecipient)  \n  Dim CalendarFolder As Outlook.Folder \n  Set CalendarFolder = _  \n  myNamespace.GetSharedDefaultFolder _  \n  (myRecipient, olFolderCalendar)  \n  CalendarFolder.Display  \nEnd Sub\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/28025736/excel-vba-create-appointment-in-someone-elses-calendar\">excel vba create appointment in someone elses calendar</a></p>\n\n<pre><code>Sub MultiCalendars()\n    Dim objPane As Outlook.NavigationPane\n    Dim objModule As Outlook.CalendarModule\n    Dim objGroup As Outlook.NavigationGroup\n    Dim objNavFolder As Outlook.NavigationFolder\n    Dim objFolder As Folder\n    Dim calItem As Object\n    Dim mtgAttendee As Outlook.Recipient\n\n    Dim i As Integer\n\n    Set Application.ActiveExplorer.CurrentFolder = Session.GetDefaultFolder(olFolderCalendar)\n    DoEvents\n\n    Set objPane = Application.ActiveExplorer.NavigationPane\n    Set objModule = objPane.Modules.GetNavigationModule(olModuleCalendar)\n\n    With objModule.NavigationGroups\n        Set objGroup = .GetDefaultNavigationGroup(olMyFoldersGroup)\n\n    ' To use a different calendar group\n'        Set objGroup = .Item(\"Shared Calendars\")\n    End With\n\n\n    For i = 1 To objGroup.NavigationFolders.Count\n        If (objGroup.NavigationFolders.Item(i).Folder.FullFolderPath = \"\\\\Mailbox - Doe, John T\\Calendar\") Then\n            Set objNavFolder = objGroup.NavigationFolders.Item(i)\n            Set calItem = objNavFolder.Folder.Items.Add(olAppointmentItem)\n            calItem.MeetingStatus = olMeeting\n            calItem.Subject = \"Test Meeting - Ignore\"\n            calItem.Location = \"TBD Location\"\n            calItem.Start = #1/19/2015 1:30:00 PM#\n            calItem.Duration = 90\n            Set mtgAttendee = calItem.Recipients.Add(\"John Doe\")\n            mtgAttendee.Type = olRequired\n            Set mtgAttendee = calItem.Recipients.Add(\"Jane Doe\")\n            mtgAttendee.Type = olOptional\n            Set mtgAttendee = calItem.Recipients.Add(\"CR 101\")\n            mtgAttendee.Type = olResource\n            calItem.Save\n            If (calItem.Recipients.ResolveAll) Then\n                calItem.Send\n            Else\n                calItem.Display\n            End If\n        End If\n    Next\n\n    Set objPane = Nothing\n    Set objModule = Nothing\n    Set objGroup = Nothing\n    Set objNavFolder = Nothing\n    Set objFolder = Nothing\n    Set calItem = Nothing\n    Set mtgAttendee = Nothing\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://answers.microsoft.com/en-us/office/forum/office_2010-customize/excel-vba-create-an-appointment-in-someone-elses/4c2ec8d1-82f2-4b02-abb7-8c2de2fd7656?auth=1\" rel=\"nofollow noreferrer\">https://answers.microsoft.com/en-us/office/forum/office_2010-customize/excel-vba-create-an-appointment-in-someone-elses/4c2ec8d1-82f2-4b02-abb7-8c2de2fd7656?auth=1</a></p>\n"}], "owner": {"reputation": 85, "user_id": 7370496, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3228b7ce8618bc620f3e1c67bce9d2db?s=128&d=identicon&r=PG&f=1", "display_name": "ladymrt", "link": "https://stackoverflow.com/users/7370496/ladymrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2848, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509191641, "creation_date": 1507762149, "last_edit_date": 1507762529, "question_id": 46698706, "link": "https://stackoverflow.com/questions/46698706/send-appointment-vba", "title": "Send Appointment VBA", "body": "<p>So, I've been wrestling with this task for WAY too long now. I am trying to make a button that creates an appointment and sends it to someone. So far, I've been successful in creating the appointment with the variables I want, but I can't figure out how to send it to the right person. Or send it at all for that matter. I'm very new to Outlook applications within VBA, so be gentle with me, but here is my code so far:</p>\n\n<pre><code>Sub appt()\n\nDim OutApp As Object\nDim OutMail As Object\nDim duedate As String\nDim currentrow As String\nDim currentsheet As String\nDim owner As String    \n\ncurrentsheet = ActiveSheet.Name\ncurrentrow = Range(\"C10:C\" &amp; Rows.Count).Cells.SpecialCells(xlCellTypeBlanks).Row\nduedate = Range(\"C\" &amp; currentrow).Offset(0, 1)\nowner = Range(\"C\" &amp; currentrow).Offset(0, 2)\nWith Application\n    .EnableEvents = False\n    .ScreenUpdating = False\nEnd With\n\nSet OutApp = CreateObject(\"Outlook.Application\")\nSet OutMail = OutApp.CreateItem(1)\nOn Error Resume Next\nWith OutMail\n    .Recipients = Range(\"M3\")\n    .Subject = \"Next PDB Task for \" &amp; currentsheet\n    .Importance = True\n    .Start = \"8:00 AM\" &amp; duedate\n    .End = \"8:00 AM\" &amp; Format(Date + 5)\n    .ReminderMinutesBeforeStart = 10080\n    .Body = \"Text and Stuff\"\n    .Display\nEnd With\n\nSet OutMail = Nothing\nSet OutApp = Nothing\nUnload Emy\nEnd Sub\n</code></pre>\n\n<p>So, this is definitely grabbing the information I want from the sheet it's run in, however it's not going anywhere. Do I need to use something other than .Recipients? Is it possible to forward this (with .Forward maybe?)? Any help would be greatly appreciated!!!</p>\n\n<p>P.S. The email address I want to send the appointment to is in cell M3.</p>\n"}, {"tags": ["arrays", "vba", "variant"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1507759636, "post_id": 46698250, "comment_id": 80344255, "body": "<code>Array()</code> returns a variant containing an array, so you can&#39;t assign the return value to an integer array.  <a href=\"https://msdn.microsoft.com/en-us/library/aa262675(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa262675(v=vs.60).aspx</a>"}, {"owner": {"reputation": 69, "user_id": 8358987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/725f25469668eac1eceba65e33bde1bb?s=128&d=identicon&r=PG&f=1", "display_name": "mpmcderm", "link": "https://stackoverflow.com/users/8358987/mpmcderm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507842880, "post_id": 46698250, "comment_id": 80384485, "body": "So is there a better way to do the assignment of the array values? One that  is more efficient than n(1) = a, n(2) = b, etc? I like the &quot;Array()&quot; because it has less lines and the code looks neater."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507844685, "post_id": 46698250, "comment_id": 80385343, "body": "I don&#39;t think there&#39;s any real problem with using the variant array, unless you really need integer-typed values."}], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 8358987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/725f25469668eac1eceba65e33bde1bb?s=128&d=identicon&r=PG&f=1", "display_name": "mpmcderm", "link": "https://stackoverflow.com/users/8358987/mpmcderm"}, "is_accepted": true, "score": 0, "last_activity_date": 1512076261, "creation_date": 1512076261, "answer_id": 47582681, "question_id": 46698250, "link": "https://stackoverflow.com/questions/46698250/vba-array-variable/47582681#47582681", "title": "VBA Array variable", "body": "<p>No downside, used n as variant</p>\n"}], "owner": {"reputation": 69, "user_id": 8358987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/725f25469668eac1eceba65e33bde1bb?s=128&d=identicon&r=PG&f=1", "display_name": "mpmcderm", "link": "https://stackoverflow.com/users/8358987/mpmcderm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 47582681, "answer_count": 1, "score": 0, "last_activity_date": 1512076261, "creation_date": 1507759428, "last_edit_date": 1507760521, "question_id": 46698250, "link": "https://stackoverflow.com/questions/46698250/vba-array-variable", "title": "VBA Array variable", "body": "<p>The following code works well if I use <code>n</code> as a <code>Variant</code> but gives me \"Run time error 13 Type mismatch\" if I dim <code>n</code> as <code>Integer</code>. Are there any downsides to using the <code>Variant</code>? Any other suggestions?</p>\n\n<pre><code>Sub Update_Yest()\n\n    Dim tbl As ListObject\n    Dim n() As Variant\n\n    n = Array(10, 13, 17, 20, 28, 31, 35, 38)\n\n    For i = 0 To UBound(n)\n        Debug.Print n(i)\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1507760219, "post_id": 46698242, "comment_id": 80344425, "body": "Thanks, that was definitely what I needed. Thanks for the quick reply - I&#39;ll now proceed to uninstall Office for not knowing something so basic."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1507789558, "post_id": 46698242, "comment_id": 80352560, "body": "Not really that basic ;-)"}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1507824752, "post_id": 46698242, "comment_id": 80374891, "body": "Sorry to keep asking in a closed Q, but how would I do it if I wanted to retrieve the data from an array instead of a range (as I originally wanted to do but gave up)?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1507825635, "post_id": 46698242, "comment_id": 80375401, "body": "Your question is a bit vague - an array from where, constructed how?"}, {"owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1507827349, "post_id": 46698242, "comment_id": 80376286, "body": "Sorry,  I added a clarification to the original question, thanks for the help!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "edited": false, "score": 0, "creation_date": 1507827807, "post_id": 46698242, "comment_id": 80376556, "body": "See my edit above - it&#39;s a very similar process (<code>rng.Value</code> is already an array)"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1507827762, "last_edit_date": 1507827762, "creation_date": 1507759395, "answer_id": 46698242, "question_id": 46698207, "link": "https://stackoverflow.com/questions/46698207/how-to-paste-array-into-a-range-vba-error-1004/46698242#46698242", "title": "How to paste array into a range [VBA] - Error 1004", "body": "<p>This is not valid:</p>\n\n<pre><code>.Range(.Cells(rowsOut + 1, 3)).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>You could use:</p>\n\n<pre><code>.Cells(rowsOut + 1, 3).PasteSpecial xlPasteValues\n</code></pre>\n\n<p>You can do this without using copy/paste though:</p>\n\n<pre><code>Sub testy()\n\n    Dim rowsIn, rowsOut As Long, rng As Range\n\n    With Worksheets(\"Sheet1\")\n        rowsIn = .Cells.SpecialCells(xlLastCell).Row\n        Set rng = .Range(.Cells(4, 1), .Cells(rowsIn, 3))\n    End With\n\n    With Worksheets(\"Sheet2\")\n        rowsOut = .Cells.SpecialCells(xlLastCell).Row\n        .Cells(rowsOut + 1, 3)).Resize(rng.Rows.Count, _\n                                       rng.Columns.Count).Value = rng.Value\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: using your <code>arr</code> example instead is quite similar:</p>\n\n<pre><code>    With Worksheets(\"Sheet2\")\n        rowsOut = .Cells.SpecialCells(xlLastCell).Row\n        .Cells(rowsOut + 1, 3)).Resize(UBound(arr, 1), _\n                                       UBound(arr, 2)).Value = arr\n    End With\n</code></pre>\n"}], "owner": {"reputation": 711, "user_id": 8256178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a0aa974defe6351f68eab06709fa8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fernando J. Rivera", "link": "https://stackoverflow.com/users/8256178/fernando-j-rivera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2132, "favorite_count": 0, "accepted_answer_id": 46698242, "answer_count": 1, "score": 1, "last_activity_date": 1507827762, "creation_date": 1507759172, "last_edit_date": 1507827323, "question_id": 46698207, "link": "https://stackoverflow.com/questions/46698207/how-to-paste-array-into-a-range-vba-error-1004", "title": "How to paste array into a range [VBA] - Error 1004", "body": "<p>I've been trying to copy a simple table from 1 sheet into the last rows of a second sheet.\nOriginally I tried with arrays, because both sheets have a different structure (columns are not in the same order, so I couldn't just copy &amp; paste), but I always get error 1004.\nNow I gave up with that and changed the tables so both of them have the same structure and now I can just simply copy &amp; paste, but I'm still getting the same error.\nThis is what I have so far. I know it's a very simple thing but I don't know where I've got it wrong.</p>\n\n<pre><code>Sub testy()\nDim rowsIn, rowsOut As Long\n\nWith Worksheets(\"Sheet1\")\n    rowsIn = .Cells.SpecialCells(xlLastCell).Row\n    .Range(.Cells(4, 1), .Cells(rowsIn, 3)).Copy\nEnd With\nWith Worksheets(\"Sheet2\")\n    rowsOut = .Cells.SpecialCells(xlLastCell).Row\n    .Range(.Cells(rowsOut + 1, 3)).PasteSpecial xlPasteValues\nEnd With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>EDIT: Solved as per Tim Williams' suggestion. However, I'm still curious as to how this could be done with an array, as I originally intended.\nAssuming data in Sheet1 has columns in different order than in Sheet2, I tried using a temporary array to order the columns so I can just paste it. I managed to populate the array just fine, but can't figure out how to get the contents of the array into Sheet2. Added the code I used to populate (in a terribly inneficient manner) the array.</p>\n\n<pre><code>Sub testy2ElectricBoogaloo()\n Dim arr() As Variant\n Dim rowsIn, rowsOut, i As Long\n    With Worksheets(\"Sheet1\")\n        rowsIn = .Cells.SpecialCells(xlLastCell).Row\n        ReDim arr(1 To rowsIn - 3, 1 To 5)\n'Array populated with a loop because columns are not in the same order, don't know if this is the most efficient method\n        For i = 1 To UBound(arr)\n            arr(i, 1) = \"Constant1\" 'data collected from other source\n            arr(i, 2) = \"Constant2\" 'data collected from other source\n            arr(i, 3) = .Cells(i + 3, 2).Value\n            arr(i, 4) = .Cells(i + 3, 1).Value\n            arr(i, 5) = .Cells(i + 3, 3).Value\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1507761345, "post_id": 46698025, "comment_id": 80344766, "body": "What have you tried? Also, to note, it&#39;s best to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid the use of <code>.Select</code>/<code>.Activate</code></a>"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8761712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69d2a7a709f14c937b28e6a8e75a1f7?s=128&d=identicon&r=PG&f=1", "display_name": "EricW", "link": "https://stackoverflow.com/users/8761712/ericw"}, "edited": false, "score": 0, "creation_date": 1507832192, "post_id": 46698805, "comment_id": 80378942, "body": "Valli, thanks for sharing this. I see how you&#39;re mapping columns from Sheet1 to Master, Sheet2 to Master, etc. I did a simple test but it doesn&#39;t seem to be working. I uploaded the sample here: <a href=\"https://drive.google.com/file/d/0B6qW2z_2XgKbaktZOUlMcl9kQWc/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/0B6qW2z_2XgKbaktZOUlMcl9kQWc/&hellip;</a>"}, {"owner": {"reputation": 1373, "user_id": 2524830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8747a131c11d0f535df92a8eaceb4550?s=128&d=identicon&r=PG", "display_name": "Valli", "link": "https://stackoverflow.com/users/2524830/valli"}, "reply_to_user": {"reputation": 29, "user_id": 8761712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69d2a7a709f14c937b28e6a8e75a1f7?s=128&d=identicon&r=PG&f=1", "display_name": "EricW", "link": "https://stackoverflow.com/users/8761712/ericw"}, "edited": false, "score": 0, "creation_date": 1507838329, "post_id": 46698805, "comment_id": 80382126, "body": "@EricW It does&#39;nt work as such. You have to edit the mapping, sheet names. I have written one for the sheet you shared. Hope it helps"}, {"owner": {"reputation": 29, "user_id": 8761712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69d2a7a709f14c937b28e6a8e75a1f7?s=128&d=identicon&r=PG&f=1", "display_name": "EricW", "link": "https://stackoverflow.com/users/8761712/ericw"}, "edited": false, "score": 1, "creation_date": 1507840744, "post_id": 46698805, "comment_id": 80383337, "body": "that worked beautifully! Thank you so, so, much! I am going to work with this going forward."}], "tags": [], "owner": {"reputation": 1373, "user_id": 2524830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8747a131c11d0f535df92a8eaceb4550?s=128&d=identicon&r=PG", "display_name": "Valli", "link": "https://stackoverflow.com/users/2524830/valli"}, "is_accepted": true, "score": 0, "last_activity_date": 1507838258, "last_edit_date": 1507838258, "creation_date": 1507762774, "answer_id": 46698805, "question_id": 46698025, "link": "https://stackoverflow.com/questions/46698025/excel-vba-combine-rows-and-columns-from-worksheets-into-one-with-varying-sour/46698805#46698805", "title": "Excel/VBA - Combine rows and columns from worksheets into one, with varying source columns", "body": "<p>I have made some changes to your code, to make it suitable for mapping any column from master to sheet1. You have to hard code the mapping inside the code \n    Sub CombineData()\n    Dim Sht As Worksheet\n    Dim colname As String\n    Dim Lastrow As Integer, rowcount As Integer\n    'This If will clear Master before combining\n    Worksheets(\"Master\").Range(\"A2:ZZ9000\").ClearContents\n    colname = 1\n    For Each Sht In ActiveWorkbook.Worksheets</p>\n\n<pre><code>  If Sht.Name = \"Sheet2\" And Sht.Range(\"A2\").Value &lt;&gt; \"\" Then\n     Lastrow = Range(\"A9000\").End(xlUp).Row\n     Sheets(\"Master\").Select\n     rowcount = Range(\"A9000\").End(xlUp).Row\n     Sht.Select\n'Map the columns of sheet2 to master\n     Sheets(\"Master\").Range(\"A\" &amp; rowcount &amp; \":A\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"A2:A\" &amp; Lastrow).Value\n     Sheets(\"Master\").Range(\"B\" &amp; rowcount &amp; \":B\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"C2:C\" &amp; Lastrow).Value\n\n  ElseIf Sht.Name = \"Sheet3\" And Sht.Range(\"A2\").Value &lt;&gt; \"\" Then\n     Lastrow = Range(\"A9000\").End(xlUp).Row\n     Sheets(\"Master\").Select\n     rowcount = Range(\"A9000\").End(xlUp).Row\n     Sht.Select\n'Map the columns of sheet3 to master\n     Sheets(\"Master\").Range(\"A\" &amp; rowcount &amp; \":A\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"A2:A\" &amp; Lastrow).Value\n     Sheets(\"Master\").Range(\"B\" &amp; rowcount &amp; \":B\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"B2:B\" &amp; Lastrow).Value\n  End If\n Next Sht\n\nEnd Sub\n</code></pre>\n\n<p>**************Edited********************</p>\n\n<pre><code>Sub CombineData()\nDim Sht As Worksheet\nDim colname As String\n Dim Lastrow As Integer, rowcount As Integer\n'This If will clear Master before combining\nWorksheets(\"Master\").Range(\"A2:ZZ9000\").ClearContents\n colname = 1\nFor Each Sht In ActiveWorkbook.Worksheets\n  If Sht.Name = \"Sheet1\" And Sht.Range(\"A2\").Value &lt;&gt; \"\" Then\nSheets(\"Sheet1\").Select\n\nLastrow = Range(\"A9000\").End(xlUp).Row\n\n     Sheets(\"Master\").Select\n     rowcount = Range(\"A9000\").End(xlUp).Row + 1\n     Sht.Select\n'Map the columns of sheet2 to master\n     Sheets(\"Master\").Range(\"A\" &amp; rowcount &amp; \":A\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"A2:A\" &amp; Lastrow).Value\n     Sheets(\"Master\").Range(\"B\" &amp; rowcount &amp; \":B\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"B2:B\" &amp; Lastrow).Value\n     Sheets(\"Master\").Range(\"C\" &amp; rowcount &amp; \":C\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"C2:C\" &amp; Lastrow).Value\n     Sheets(\"Master\").Range(\"D\" &amp; rowcount &amp; \":D\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"D2:D\" &amp; Lastrow).Value\n\n  ElseIf Sht.Name = \"Sheet2\" And Sht.Range(\"A2\").Value &lt;&gt; \"\" Then\nSheets(\"Sheet2\").Select\n\n     Lastrow = Range(\"A9000\").End(xlUp).Row\n     Sheets(\"Master\").Select\n     rowcount = Range(\"A9000\").End(xlUp).Row + 1\n     Sht.Select\n'Map the columns of sheet3 to master\n     Sheets(\"Master\").Range(\"A\" &amp; rowcount &amp; \":A\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"A2:A\" &amp; Lastrow).Value\n     Sheets(\"Master\").Range(\"E\" &amp; rowcount &amp; \":E\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"B2:B\" &amp; Lastrow).Value\n     Sheets(\"Master\").Range(\"F\" &amp; rowcount &amp; \":F\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"C2:C\" &amp; Lastrow).Value\n     Sheets(\"Master\").Range(\"G\" &amp; rowcount &amp; \":G\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"D2:D\" &amp; Lastrow).Value\n     Sheets(\"Master\").Range(\"C\" &amp; rowcount &amp; \":C\" &amp; rowcount + Lastrow - 2).Value = Sht.Range(\"E2:E\" &amp; Lastrow).Value\n\n End If\n Next Sht\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 8761712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f69d2a7a709f14c937b28e6a8e75a1f7?s=128&d=identicon&r=PG&f=1", "display_name": "EricW", "link": "https://stackoverflow.com/users/8761712/ericw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "accepted_answer_id": 46698805, "answer_count": 1, "score": 0, "last_activity_date": 1507838258, "creation_date": 1507758211, "last_edit_date": 1507761412, "question_id": 46698025, "link": "https://stackoverflow.com/questions/46698025/excel-vba-combine-rows-and-columns-from-worksheets-into-one-with-varying-sour", "title": "Excel/VBA - Combine rows and columns from worksheets into one, with varying source columns", "body": "<p>I am working on combining multiple Excel worksheets into a single Master worksheet. The following code works for when all worksheets have identical columns:</p>\n\n<pre><code>Sub CombineData()\nDim Sht As Worksheet\n\n'This If will clear Master before combining\nWorksheets(\"Master\").Range(\"A2:ZZ9000\").ClearContents\n\nFor Each Sht In ActiveWorkbook.Worksheets\n    If Sht.Name &lt;&gt; \"Master\" And Sht.Range(\"A2\").Value &lt;&gt; \"\" Then\n        Sht.Select\n        LastRow = Range(\"A9000\").End(xlUp).Row\n        Range(\"A2\", Cells(LastRow, \"ZZ\")).Copy\n        Sheets(\"Master\").Select\n        Range(\"A9000\").End(xlUp).Offset(1, 0).Select\n        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n            :=False, Transpose:=False\n    Else\n    End If\nNext Sht\n\nEnd Sub\n</code></pre>\n\n<p>However, I now need to go one step further and merge worksheets when the columns differ from the source worksheets, into a master which has all coluns listed.</p>\n\n<p><a href=\"https://i.stack.imgur.com/k8VYx.jpg\" rel=\"nofollow noreferrer\">This shows the layout of the worksheets I'm testing with, to keep things simple.</a></p>\n\n<p>I'm open to either mapping all source to destination columns (e.g. </p>\n\n<p>-Source1, Column A to Master, Column A</p>\n\n<p>-Source2, Column B to Master, Column D</p>\n\n<p>-Etc</p>\n\n<p>Or simply recreating Master with all columns from source worksheets - which is preferable in case source worksheets change. </p>\n\n<p>Cheers-</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1507758141, "post_id": 46697984, "comment_id": 80343733, "body": "Split into a variant array on Chr(10) then cycle through the array from lbound(arr)+1 to ubound(arr) step 2."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1507758778, "post_id": 46698111, "comment_id": 80343986, "body": "I reread your question and it seems like you want the questions bold, not the answers. Make appropriate adjustments to the above."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1507758667, "creation_date": 1507758667, "answer_id": 46698111, "question_id": 46697984, "link": "https://stackoverflow.com/questions/46697984/specify-certain-string-of-text-as-bold-while-adding-multiple-strings-to-a-single/46698111#46698111", "title": "Specify certain string of text as bold while adding multiple strings to a single cell", "body": "<p>Split into a variant array on Chr(10) then cycle through the array from lbound(arr)+1 to ubound(arr) step 2.</p>\n\n<pre><code>Dim arr As Variant, a As Long\n\nWith ActiveSheet.Range(\"A1\")\n    arr = Split(.Value2, Chr(10))\n\n    For a = LBound(arr) + 1 To UBound(arr) Step 2\n        With .Cells(1).Characters(Start:=InStr(1, .Value2, arr(a)), Length:=Len(arr(a))).Font\n            .Bold = True\n            .ColorIndex = 5\n        End With\n    Next a\nEnd With\n</code></pre>\n\n<p>I threw in a blue font as well.</p>\n\n<p>This will actually fail if the answers are identical but you can control that by advancing the start of the InStr by the previous answer lengths.</p>\n"}, {"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 1, "last_activity_date": 1507759243, "creation_date": 1507759243, "answer_id": 46698218, "question_id": 46697984, "link": "https://stackoverflow.com/questions/46697984/specify-certain-string-of-text-as-bold-while-adding-multiple-strings-to-a-single/46698218#46698218", "title": "Specify certain string of text as bold while adding multiple strings to a single cell", "body": "<p>Here is a solution which simply uses the Chr(10) characters to determine where to start and end the bolding:</p>\n\n<pre><code>Sub HighLightIt()\n    Dim rng As Range\n    Set rng = ActiveSheet.Range(\"A1\")\n    Dim p1 As Long\n    Dim p2 As Long\n    Do\n        'point to the end of the question\n        p2 = InStr(p1 + 1, rng.Value, vbLf)\n        If p2 = 0 Then\n            Exit Do\n        End If\n        With rng.Characters(Start:=p1 + 1, Length:=p2 - p1).Font\n            .Bold = True\n        End With\n        'point to the end of the user input\n        p1 = InStr(p2 + 1, rng.Value, vbLf)\n        If p1 = 0 Then\n            Exit Do\n        End If\n    Loop\nEnd Sub\n</code></pre>\n\n<p>This will fail if any of the questions, or any of the answers, include a line feed.  You probably don't want the questions or answers to permit line feeds anyway, so you might consider using <code>Replace(userTxtBox1.value, vbLf, \"|\")</code> (or similar) when storing the questions and answers into your consolidated cell.</p>\n"}], "owner": {"reputation": 97, "user_id": 6267555, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/365978593e520eaf56ae04cb4317a3e5?s=128&d=identicon&r=PG&f=1", "display_name": "Awill", "link": "https://stackoverflow.com/users/6267555/awill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507759243, "creation_date": 1507757979, "question_id": 46697984, "link": "https://stackoverflow.com/questions/46697984/specify-certain-string-of-text-as-bold-while-adding-multiple-strings-to-a-single", "title": "Specify certain string of text as bold while adding multiple strings to a single cell", "body": "<p>I'm wondering if there is a way to dictate which text within a cell to bold without knowing the start or length of the characters. What I am needing to do is enter multiple strings(some user input)of text on separate consecutive lines within a single cell while making the predetermined strings (every other line) bold.</p>\n\n<p>I am compiling the free text from multiple text boxes into the same cell on different lines using <code>chr(10)</code>. For example:</p>\n\n<pre><code>CmpTxt = myTxt1 &amp; Chr(10) &amp; userTxtBox1.value\nCmpTxt = CmpTxt &amp; Chr(10) &amp; myTxt2 &amp; Chr(10) &amp; userTxtBox2.value\n\nactivesheet.range(\"A1\").value = CmpTxt\n</code></pre>\n\n<p>Where each myTxt is bolded, followed by the user's text under it in the same cell, A1. </p>\n\n<pre><code>My first line of text posed as a question\nUsers' corresponding answer\nMy second line of text posed as a question\nUsers' second corresponding answer\n</code></pre>\n\n<p>Here I could use <code>.characters</code> to make the <code>myTxt1</code> bold, but because I have no idea how long the second line/user text will be, I cannot know where to start in order to bold the third line which is <code>myTxt2</code>. </p>\n\n<p>Is there a way to predetermine <code>myTxt</code>'s as a bold font type when adding it to the string? If not is there a way to <strong>a)</strong> identify each line of text in the cell as if a row within a cell or <strong>b)</strong> find the specific strings of text that is <code>myTxt</code> or the character start,length of those strings and set only those to bold after adding the text to A1?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1507753942, "post_id": 46696941, "comment_id": 80341818, "body": "(a) I assume there is another <code>End Select</code> immediately after the last line of your second code block (b) Ignore what I wrote as point b - I was silly"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 2, "creation_date": 1507754018, "post_id": 46696941, "comment_id": 80341858, "body": "I think in concert with @YowE3K suggestion replace first <code>Select Case</code> (<code>Select Case extendedgap)</code> with <code>If extendedgap Then</code> ... then build your cases?"}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507754049, "post_id": 46696941, "comment_id": 80341874, "body": "Thanks @YowE3K.  I may be misunderstanding your question, but the reason I have Case True is because if &#39;extendedgap&#39; is false, I don&#39;t want any of the subsequent Select Cases to run, as they won&#39;t be relevant."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507754125, "post_id": 46696941, "comment_id": 80341913, "body": "@khelm Yeah - my point (b) was absolutely stupid - I can only blame the fact that I am an hour overdue to go down and get my morning coffee"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1507754179, "post_id": 46696941, "comment_id": 80341952, "body": "This really, really, really looks like <code>Select Case</code> abuse. each <code>Select</code> block has 2 branches. What you have is a very convoluted way to write a nested <code>If...Else...End If</code> block."}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507754319, "post_id": 46696941, "comment_id": 80342024, "body": "@YowE3K No problem - can&#39;t VBA without coffee!"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507754321, "post_id": 46696941, "comment_id": 80342026, "body": "^^ and it may actually benefit from just setting <code>cp121</code> to either <code>True</code> or <code>False</code> to start with, and then using the <code>If</code> statements to just work out when it needs to be the opposite value."}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507754340, "post_id": 46696941, "comment_id": 80342034, "body": "@Mat&#39;sMug Ok, thanks for saying that.  I&#39;ll go back and reconfigure!"}, {"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507754375, "post_id": 46696941, "comment_id": 80342059, "body": "@YowE3K That&#39;s a really good idea too, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "edited": false, "score": 1, "creation_date": 1507755207, "post_id": 46697266, "comment_id": 80342458, "body": "That was SO helpful, thank you! You always give really thorough, conceptual answers and I appreciate them so much."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 9, "last_activity_date": 1507754783, "creation_date": 1507754783, "answer_id": 46697266, "question_id": 46696941, "link": "https://stackoverflow.com/questions/46696941/error-16-expression-too-complex-nested-select-case/46697266#46697266", "title": "Error 16: Expression Too Complex - Nested Select Case", "body": "<p>It's really just a big nested conditional structure. Don't use <code>Select...Case</code> for that. Use it e.g. when you're looking at some enum value:</p>\n\n<pre><code>Select Case MsgBox(\"Yes, no, or cancel?\", vbYesNoCancel)\n    Case vbYes\n        'stuff\n    Case vbNo\n        'stuff\n    Case vbCancel\n        'stuff\nEnd Select\n</code></pre>\n\n<hr>\n\n<p><strong>Refactoring step 1</strong>: Turn all these 2-branch <code>Select...Case</code> blocks into <code>If...Else...End If</code> blocks. That should already take care of the \"expression too complex\" compile error.</p>\n\n<p><strong>Refactoring step 2</strong>: Implement Boolean assignments as such:</p>\n\n<p>For example in <s>one place</s> <em>two places</em> you have:</p>\n\n<blockquote>\n<pre><code>Select Case DateDiff(\"d\", Sheet1.[z1IE], Sheet1.[z1DA]) 'If not, was employment between E1/E2 6 mos?\n    Case Is &gt;= 180\n        cp121 = True\n    Case Is &lt; 180\n        cp121 = False\nEnd Select\n</code></pre>\n</blockquote>\n\n<p>Replace that with:</p>\n\n<pre><code>cp121 = (DateDiff(\"d\", Sheet1.[z1IE], Sheet1.[z1DA]) &gt;= 180)\n</code></pre>\n\n<p><strong>Refactoring step 3</strong>: Extract functions and procedures out of the <code>If</code> and <code>Else</code> branches where applicable; eliminate the duplicated branches, <em>Don't Repeat Yourself</em>.</p>\n\n<p>Once you have something that works, take it to <a href=\"http://codereview.stackexchange.com\">Code Review</a> for further refactoring and simplification ideas.</p>\n"}], "owner": {"reputation": 153, "user_id": 8616093, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/449c43c0a8434cca6223baa9cf0e1b86?s=128&d=identicon&r=PG&f=1", "display_name": "Kim", "link": "https://stackoverflow.com/users/8616093/kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "accepted_answer_id": 46697266, "answer_count": 1, "score": 3, "last_activity_date": 1507754783, "creation_date": 1507753499, "question_id": 46696941, "link": "https://stackoverflow.com/questions/46696941/error-16-expression-too-complex-nested-select-case", "title": "Error 16: Expression Too Complex - Nested Select Case", "body": "<p>I am getting a \"Run-Time Error 16: Expression Too Complex\" for the sencond code block.  I read online that the maximum allowed number of nested expressions is 8, but if nested statements are defined by every \"Select Case,\" then I haven't yet hit that.  Is it possible it's because the Cases are dependent upon a variable?  The first code block shows the possible values of egapend, while the second shows the code that is returning the error.  Thanks in advance for your help.</p>\n\n<p>First:</p>\n\n<pre><code>Select Case ge1e2\n    Case Is &lt;= 0\n        Select Case ge2e3\n            Case Is &lt;= 0\n                egap18a = 0\n                egap18b = 0\n            Case Is &gt; 0\n                egap18a = 0\n                egap18b = ge2e3\n                egapend = Sheet1.[z1IE]\n        End Select\n    Case Is &gt; 0\n        Select Case ge2e3\n            Case Is &lt;= 0\n                egap18a = ge1e2\n                egap18b = 0\n                egapend = Sheet1.[z1CZ]\n            Case Is &gt; 0\n                Select Case ge1e2\n                    Case Is &gt;= 180\n                        egap18a = ge1e2\n                        egap18b = ge2e3\n                        egapend = Sheet1.[z1CZ]\n                    Case Is &lt; 180\n                        egap18a = ge1e2\n                        egap18b = ge2e3\n                        egapend = Sheet1.[z1IE]\n                End Select\n        End Select\nEnd Select\n</code></pre>\n\n<p>Second:</p>\n\n<pre><code>Dim e1length As Long\nDim e2length As Long\nDim cp121 As Boolean\n\ne1length = DateDiff(\"d\", Sheet1.[z1CZ], Sheet1.[z1DA])\ne2length = DateDiff(\"d\", Sheet1.[z1IE], Sheet1.[z1IF])\n\nSelect Case extendedgap\n    Case True\n        Select Case egapend\n            Case Sheet1.[z1IE] 'end of egap is start of E2\n                Select Case e2length 'was borrower employed by E2 for more than 6 months?\n                    Case Is &gt;= 180\n                        cp121 = True\n                    Case Is &lt; 180\n                        Select Case ge1e2 'if not, was there a gap between E1 and E2\n                            Case Is &gt; 1\n                                cp121 = False\n                            Case Else\n                                Select Case DateDiff(\"d\", Sheet1.[z1IE], Sheet1.[z1DA]) 'If not, was employment between E1/E2 6 mos?\n                                    Case Is &gt;= 180\n                                        cp121 = True\n                                    Case Is &lt; 180\n                                        cp121 = False\n                                End Select\n                        End Select\n                End Select\n            Case Sheet1.[z1CZ] 'end of egap is start of E1\n                Select Case DateDiff(\"d\", Sheet1.[z1CZ], Sheet1.[z1DA]) 'was borrower employed by E1 for at least 6 mos?\n                    Case Is &gt;= 180\n                        cp121 = True\n                    Case Is &lt; 180\n                        cp121 = False\n                End Select\n        End Select\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1507752017, "post_id": 46696474, "comment_id": 80340909, "body": "Are you looking to setup named ranges? Is your data in a table? A little more detail as to the significance of the named entities would help here."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507752195, "post_id": 46696474, "comment_id": 80341007, "body": "Writing an application to parse Excel formulas and determine which bits are cell references (and therefore need to be changed) and which bits are operators, and which bits are named ranges, and which bits are function names, etc, will not be a trivial exercise.  You also need to consider what you want to happen if the formula was, for instance, <code>=SUM($AB11:$AF11)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1507755921, "post_id": 46696710, "comment_id": 80342800, "body": "Rohan, it&#39;s not that easy.  I just updated my original post.  I&#39;m trying to pick out the cell references in row 11 and replace them with strings (headers from an Access table) which all sit in row 10.  Any thoughts?  This seems to be somewhat tricky."}], "tags": [], "owner": {"reputation": 43, "user_id": 7983597, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh5.googleusercontent.com/-Q32yv1hay3k/AAAAAAAAAAI/AAAAAAAAADc/d-53BjJOB6Y/photo.jpg?sz=128", "display_name": "Rohan Goel", "link": "https://stackoverflow.com/users/7983597/rohan-goel"}, "is_accepted": false, "score": 0, "last_activity_date": 1507752549, "creation_date": 1507752549, "answer_id": 46696710, "question_id": 46696474, "link": "https://stackoverflow.com/questions/46696474/replace-cell-references-with-string-from-a-corresponding-cell/46696710#46696710", "title": "Replace cell references with string from a corresponding cell", "body": "<p>I'm pretty new to this so don't have enough 'reputation' to comment and clarify your question. \nIf the cells V11, AB11 and AF11 have the text \"EAD: On Balance Sheet\", \"PD Low \" and \"Collateral LGD High\" and you want this cell to show those words.\nThen the following code could work:</p>\n\n<pre><code>sub combine_words()\ndim i as string\ndim j as string\ndim k as string\n\ni = range(\"V11\").value\nj = range(\"AB11\").value\nk = range(\"AF11\").value\n\nrange(\"A11\").value = \"[\" &amp; i &amp; \"]*[\" &amp; j &amp; \"]*[\" &amp; k &amp; \"]\"\n\nend sub\n</code></pre>\n\n<p>replace the cell A11 with whichever cell you wanted the text inputed into.</p>\n\n<p>Let me know if I understood your question incorrectly and I will change the code to match your needs if I can.</p>\n"}, {"comments": [{"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1507758245, "post_id": 46697953, "comment_id": 80343779, "body": "Yeah, Ryan, that works in one specific example.  I need to loop through a couple hundred cells in M11:GZ11, find multiple references in each cell, and replace all references with the relative strings in row 10.  Here is one more example: =ABS(DQ11+DT11) --&gt; =ABS([Base+Imprecision]+[Concentration Risk]).  So, DQ10=[Base+Imprecision] and DT10=[Concentration Risk]."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1507811637, "post_id": 46697953, "comment_id": 80365853, "body": "Can you iterate over the header row and add the header as the key and the address of the offset cell as the value into the dict?"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1507815573, "post_id": 46697953, "comment_id": 80368566, "body": "Sounds good to me, but I don&#39;t know how to do that.  I think I need to parse through the cell addresses, and replace each one with the header, but I don&#39;t know how to do it."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1507820909, "post_id": 46697953, "comment_id": 80372492, "body": "See my edited answer, see if that is getting closer."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 0, "last_activity_date": 1507820891, "last_edit_date": 1507820891, "creation_date": 1507757821, "answer_id": 46697953, "question_id": 46696474, "link": "https://stackoverflow.com/questions/46696474/replace-cell-references-with-string-from-a-corresponding-cell/46697953#46697953", "title": "Replace cell references with string from a corresponding cell", "body": "<p>Perhaps a simple find and replace in the formula would work well enough. I'm sure there are <em>lots</em> of edge cases I'm not thinking about. Hopefully this steers the conversation in the right direction.</p>\n\n<pre><code>Sub SOExample()\n    Dim mySheet         As Worksheet: Set mySheet = ThisWorkbook.Sheets(\"Sheet1\")\n    Dim headerRng       As Range: Set headerRng = mySheet.Range(\"A1:J1\") 'Specify where to do replacements\n    Dim mycell          As Range\n    Dim vkey            As Variant\n    Dim myDict          As Object: Set myDict = CreateObject(\"Scripting.Dictionary\")\n\n    'Iterate each header row add the address as the key, and the NEXT row's Text as the value\n    For Each mycell In headerRng\n        If Not myDict.exists(mycell.Offset(1, 0).Address) Then\n            myDict.Add mycell.Offset(1, 0).Address, mycell.Text\n        End If\n    Next\n\n    'Iterate each cells formula and replace it\n    For Each mycell In headerRng\n        For Each vkey In myDict.keys\n            mycell.Offset(1, 0).Formula = Replace(mycell.Offset(1, 0).Formula, vkey, myDict(vkey), , , vbTextCompare)\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 485, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1508678808, "creation_date": 1507751714, "last_edit_date": 1531164843, "question_id": 46696474, "link": "https://stackoverflow.com/questions/46696474/replace-cell-references-with-string-from-a-corresponding-cell", "title": "Replace cell references with string from a corresponding cell", "body": "<p>I have cells with calculations.</p>\n\n<p>Here is one simple example, which is in row 11.</p>\n\n<pre><code>=$V11*$AB11*AF11\n</code></pre>\n\n<p>I'm trying to get this: </p>\n\n<pre><code>=[EAD: On Balance Sheet]*[PD Low]*[Collateral LGD High]\n</code></pre>\n\n<p>These 3 strings all come from row 10, in Column V, AB, and AF.  </p>\n\n<p>Here is another example:</p>\n\n<p>Change this:</p>\n\n<pre><code>=$V11*VLOOKUP($AA11,Rates!AQ:AU,5,FALSE)*AE11\n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>'[EAD: On Balance Sheet]*VLOOKUP([Proposed Risk Rating],Rates!AQ:AU,5,FALSE)*[Collateral LGD Low]\n</code></pre>\n\n<p>All formulas are on row 11, and I want to get the corresponding headers, which are all strings, from row 10.</p>\n\n<p>I'm thinking that there must be a way to do this, since Excel knows all the relevant cell references, and keeps track of everything.</p>\n\n<p>I can't figure out how to replace the reference with the string (in this case the corresponding header in row 10).</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1507751518, "post_id": 46696397, "comment_id": 80340623, "body": "That does not look like <code>vb.net</code>... well some of it is mixed with <code>vb6</code>. Can you describe what <code>it doesn&#39;t work for outlook item</code>?"}, {"owner": {"reputation": 33, "user_id": 5008704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b1dfd41a641233096e70250484b14e?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish s", "link": "https://stackoverflow.com/users/5008704/ashish-s"}, "reply_to_user": {"reputation": 7175, "user_id": 1797425, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d4058e92c18018dcb24d13cc8c24cc94?s=128&d=identicon&r=PG&f=1", "display_name": "Codexer", "link": "https://stackoverflow.com/users/1797425/codexer"}, "edited": false, "score": 0, "creation_date": 1507751729, "post_id": 46696397, "comment_id": 80340734, "body": "sry.......... its not vb.net its vba code. this code works for attachments which are in .txt or .excel or other formats but doesnt work for file type outlook . view image for how  outlook format looks like"}], "answers": [{"tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": false, "score": 1, "last_activity_date": 1507762518, "creation_date": 1507762518, "answer_id": 46698767, "question_id": 46696397, "link": "https://stackoverflow.com/questions/46696397/download-outlook-attachment-that-is-an-outlook-item/46698767#46698767", "title": "Download Outlook attachment that is an Outlook item", "body": "<p>Outlook items may be named / have subjects with characters that are illegal in file names.</p>\n\n<p>For example the colon character in</p>\n\n<blockquote>\n  <p>Task Name:KM_CEM_GY</p>\n</blockquote>\n\n<p>There are at least two standard methods to address this.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/28746506/outlook-2010-vba-how-to-save-message-including-attachment\">Outlook 2010 VBA How to save message including attachment</a></p>\n\n<pre><code>Private Sub ReplaceCharsForFileName(sName As String, sChr As String)\n    sName = Replace(sName, \"'\", sChr)\n    sName = Replace(sName, \"*\", sChr)\n    sName = Replace(sName, \"/\", sChr)\n    sName = Replace(sName, \"\\\", sChr)\n    sName = Replace(sName, \":\", sChr)\n    sName = Replace(sName, \"?\", sChr)\n    sName = Replace(sName, Chr(34), sChr)\n    sName = Replace(sName, \"&lt;\", sChr)\n    sName = Replace(sName, \"&gt;\", sChr)\n    sName = Replace(sName, \"|\", sChr)\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://stackoverflow.com/questions/31509399/vba-dialog-boxes-automatically-answer-solution\">VBA dialog boxes automatically answer solution</a></p>\n\n<pre><code>Function StripIllegalChar(StrInput)\n    Dim RegX            As Object\n\n    Set RegX = CreateObject(\"vbscript.regexp\")\n\n    RegX.Pattern = \"[\\\" &amp; Chr(34) &amp; \"\\!\\@\\#\\$\\%\\^\\&amp;\\*\\(\\)\\=\\+\\|\\[\\]\\{\\}\\`\\'\\;\\:\\&lt;\\&gt;\\?\\/\\,]\"\n    RegX.IgnoreCase = True\n    RegX.Global = True\n\n    StripIllegalChar = RegX.Replace(StrInput, \"\")\n\nExitFunction:\n    Set RegX = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": -1, "last_activity_date": 1508845771, "creation_date": 1508845771, "answer_id": 46909814, "question_id": 46696397, "link": "https://stackoverflow.com/questions/46696397/download-outlook-attachment-that-is-an-outlook-item/46909814#46909814", "title": "Download Outlook attachment that is an Outlook item", "body": "<p>If you want to download attachment from Outlook, try this.\nPrivate Sub GetAttachments()</p>\n\n<pre><code>Dim ns As Namespace\nDim Inbox As Outlook.MAPIFolder\nDim Item As Object\nDim Atmt As Outlook.Attachment\nDim FileName As String\n\nSet ns = GetNamespace(\"MAPI\")\nSet Inbox = ns.Folders(\"MailboxName\").Folders(\"Inbox\")\n\nIf Inbox.Items.Count = 0 Then\n    MsgBox \"There are no messages in the Inbox.\", vbInformation, _\n            \"Nothing Found\"\n    Exit Sub\nEnd If\n\nFor Each Item In Inbox.Items\n    For Each Atmt In Item.Attachments\n        If Atmt.Type = 1 And InStr(Atmt, \"xlsx\") &gt; 0 Then\n            FileName = \"C:\\attachments\\\" &amp; Atmt.FileName\n            Atmt.SaveAsFile FileName\n        End If\n    Next Atmt\nNext Item\n</code></pre>\n\n<p>End Sub\nSet a reference to MS Outlook and remember, the \"MailboxName\" is your email address.</p>\n"}], "owner": {"reputation": 33, "user_id": 5008704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b1dfd41a641233096e70250484b14e?s=128&d=identicon&r=PG&f=1", "display_name": "Ashish s", "link": "https://stackoverflow.com/users/5008704/ashish-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 798, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528317489, "creation_date": 1507751427, "last_edit_date": 1509207680, "question_id": 46696397, "link": "https://stackoverflow.com/questions/46696397/download-outlook-attachment-that-is-an-outlook-item", "title": "Download Outlook attachment that is an Outlook item", "body": "<p>How to automatically download attachment that is an outlook item?</p>\n\n<p><a href=\"https://i.stack.imgur.com/8waOH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8waOH.png\" alt=\"imag here\"></a></p>\n\n<p>I tried downloading using this vba script but it does not work for outlook item. It works for .txt or any other type of attachment.</p>\n\n<pre><code>Public Sub Savisk(MItem As Outlook.MailItem)\nDim oAttachment As Outlook.Attachment\nDim sSaveFolder As String\nsSaveFolder = \"D:\\userdata\\sanakkay\\Desktop\\\"\nFor Each oAttachment In MItem.Attachments\noAttachment.SaveAsFile sSaveFolder &amp; oAttachment.DisplayName\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "normalize"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1507751710, "post_id": 46696392, "comment_id": 80340719, "body": "Normalization of data can mean several different things, and this just looks like like you want a formula.  Also, because simple <code>MIN</code> and <code>MAX</code> functions don&#39;t calculate as arrays, you can just use a whole column reference to achieve the result you want simply and without VBA: <code>=(J2-MIN($J:$J))&#47;(MAX($J:$J)-MIN($J:$J))</code>  If that doesn&#39;t work for you, we&#39;re really gonna need sample data and expected results."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507751749, "post_id": 46696392, "comment_id": 80340750, "body": "Also, this is tagged as VBA and you clearly mention some VBA specific coding.  Can you please edit your post to include your code so far? It will go a long way to getting help if you show your work."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8761260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f00dbb7e31cc86c78fa222349ac8edc?s=128&d=identicon&r=PG&f=1", "display_name": "Rici", "link": "https://stackoverflow.com/users/8761260/rici"}, "is_accepted": false, "score": 0, "last_activity_date": 1507753479, "creation_date": 1507753479, "answer_id": 46696937, "question_id": 46696392, "link": "https://stackoverflow.com/questions/46696392/excel-macro-to-normalize-data/46696937#46696937", "title": "Excel macro to normalize data", "body": "<p>I just realize now that you are absolutely right, I don't even need VBA. Your line of =(J2-MIN($J:$J))/(MAX($J:$J)-MIN($J:$J)) works fine. I wasn't aware that with $j:$J it realizes to not include empty cells. \nI simply used this code now for cell K2 and then did a VBA autofill function for the rest.\nI think this can be closed.</p>\n\n<p>Thank you @tigeravatar for your super quick help!</p>\n"}], "owner": {"reputation": 1, "user_id": 8761260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f00dbb7e31cc86c78fa222349ac8edc?s=128&d=identicon&r=PG&f=1", "display_name": "Rici", "link": "https://stackoverflow.com/users/8761260/rici"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 720, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507753479, "creation_date": 1507751392, "last_edit_date": 1507752906, "question_id": 46696392, "link": "https://stackoverflow.com/questions/46696392/excel-macro-to-normalize-data", "title": "Excel macro to normalize data", "body": "<p>I am currently trying to create a macro for Excel in which a column containing certain values (numbers basically) will be displayed in a new column in a normalized way (highest number = 1, lowest number = 0).</p>\n\n<p>Usually, I would just use the formula:</p>\n\n<pre><code>=(J2-MIN($J$2:$J$XXX))/(MAX($J$2:$J$XXX)-MIN($J$2:$J$XXX))\n</code></pre>\n\n<p>However, as the length of the column is dynamic and will change for each set of values, I cannot enter a value for XXX.</p>\n\n<p>Now, I found out how to have a dynamic range (e.g.: <code>numRows = Range(Selection, Selection.End(xlDown)).Rows.Count</code>) but I did not manage to merge both functions.</p>\n\n<p>I found a thread already in this site about normalization of data but I think it was a bit of a different story and this one here should be simpler.</p>\n\n<p>I would appreciate any help! As I just started working with macros (2h ago) I would also appreciate if this will be in simple language.</p>\n\n<p>EDIT:\nFirst of all, thanks for the quick reply!</p>\n\n<p>I naively tried making it work with this code:</p>\n\n<pre><code>Sub Normalize_TEST()\n'\n' Normalize_TEST Makro\n'\n\n'\n    Range(\"A1\").Select\n    numRows = Range(Selection, Selection.End(xlDown)).Rows.Count\n    Range(\"K2\").Select\n    ActiveCell.FormulaR1C1 = \"=((\"J2\")-MIN($J$2:$J$numRows$))/((MAX($J$2:$J$numRows$)-MIN($J$2:$J$numRows$))\n    Range(\"K2\").Select\n    Selection.AutoFill Destination:=Range(Cells(2, 11), Cells(numRows, 11))\nEnd Sub\n</code></pre>\n\n<p>But it is not working and I get an error message (\"error of compiling\").</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1507751485, "post_id": 46696375, "comment_id": 80340601, "body": "This seems like an odd request.  A simple table (Insert -&gt; Table) will auto-copy down formulas for each row.  And generally you don&#39;t need the cells to be values instead of formulas unless the formulas&#39; source values will never change and you need to speed up the workbook because it has become huge and sluggish.  What&#39;s the purpose for this?"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1507751529, "post_id": 46696375, "comment_id": 80340630, "body": "Also &quot;I have attempted to write it myself but haven&#39;t been able to get very far.&quot;  Please edit your post to include your code so far, it will go a long way to getting this site to assist you if you show your work."}, {"owner": {"reputation": 27, "user_id": 8190023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1085ff4abc342dc0aa361f60ec009d?s=128&d=identicon&r=PG&f=1", "display_name": "W. Hesler", "link": "https://stackoverflow.com/users/8190023/w-hesler"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507752614, "post_id": 46696375, "comment_id": 80341214, "body": "Yea, many complex formulas and I don&#39;t want to bog down the sheet."}], "answers": [{"tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 0, "last_activity_date": 1507753785, "creation_date": 1507753785, "answer_id": 46696999, "question_id": 46696375, "link": "https://stackoverflow.com/questions/46696375/excel-macro-to-copy-formulas-copy-paste-values/46696999#46696999", "title": "Excel Macro to Copy Formulas &amp; Copy/Paste Values", "body": "<p>To copy the values for a variable number of rows between two locations do the following:</p>\n\n<pre><code>Dim r_src as Range, r_dst as Range\n' Set to the top cell of the source\nSet r_src = Sheet1.Range(\"A2\")\n\nDim n as Long\n' Count the non-empty cells\nn = Sheet1.Range(r_src, r_src.End(xlDown)).Rows.Count\n\n' Set the range to include all 'n' cells using the `.Resize()` command\nSet r_src = r_src.Resize(n,1)\n' Set 'n' values in the destination sheet also\nSet r_dst = Sheet2.Range(\"A2\").Resize(n,1)\n\n'This actually copies the range as values in one swoop\nr_dst.Value = r_src.Value\n</code></pre>\n\n<p>To copy the formulas you can use</p>\n\n<pre><code>r_dst.FormulaR1C1 = r_src.FormulaR1C1\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 8190023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1085ff4abc342dc0aa361f60ec009d?s=128&d=identicon&r=PG&f=1", "display_name": "W. Hesler", "link": "https://stackoverflow.com/users/8190023/w-hesler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2512, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507753785, "creation_date": 1507751317, "last_edit_date": 1507752830, "question_id": 46696375, "link": "https://stackoverflow.com/questions/46696375/excel-macro-to-copy-formulas-copy-paste-values", "title": "Excel Macro to Copy Formulas &amp; Copy/Paste Values", "body": "<p>I am trying to create an Excel Macro to copy formulas along a used range and then copy the form and paste values.</p>\n\n<p>I was thinking that I house the formulas that need to be copied in a template file in row 1. Users can then input data into as many rows as they please, and the macro will copy down all formulas to all used rows, and then copy/paste values of the entire sheet.</p>\n\n<p>Can anyone help with writing this? I have attempted to write it myself but haven't been able to get very far.</p>\n\n<p>Thanks!</p>\n\n<p><strong>EDIT- -</strong> I have gotten the copy part down I believe. Now I just need to copy/paste values on the majority of the sheet, starting from row 4 down.</p>\n\n<pre><code>    Sub Forecast()\n\nApplication.ScreenUpdating = False\n\n\n  ' Get the last row on the sheet - store as variable\n  Dim LastRow As Integer\n  LastRow = Range(\"A1\").End(xlDown).Row\n\n  ' Copy cells K3:AY3  to  cells K4:AY[LastRow]\n  Range(Cells(3, 11), Cells(3, 51)).AutoFill _\n         Destination:=Range(Cells(3, 11), Cells(LastRow, 51))\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 241, "user_id": 7689700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4fe7253d20af9ff337151408f6db368?s=128&d=identicon&r=PG&f=1", "display_name": "M1chael", "link": "https://stackoverflow.com/users/7689700/m1chael"}, "edited": false, "score": 0, "creation_date": 1507750982, "post_id": 46696228, "comment_id": 80340332, "body": "Cross posted here: <a href=\"https://www.mrexcel.com/forum/excel-questions/1026572-application-ontime-specifying-both-workbook-arguments.html\" rel=\"nofollow noreferrer\">mrexcel.com/forum/excel-questions/&hellip;</a>"}, {"owner": {"reputation": 241, "user_id": 7689700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4fe7253d20af9ff337151408f6db368?s=128&d=identicon&r=PG&f=1", "display_name": "M1chael", "link": "https://stackoverflow.com/users/7689700/m1chael"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1507751213, "post_id": 46696228, "comment_id": 80340440, "body": "@cxw, I&#39;m afraid that doesn&#39;t answer my question. The link you provided just explains how to do what I&#39;ve done in my first example, which doesn&#39;t specify the workbook name, which is what I&#39;m trying to do."}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1507751412, "post_id": 46696228, "comment_id": 80340562, "body": "OK, what error message are you getting?  What string are you trying to send?"}, {"owner": {"reputation": 241, "user_id": 7689700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4fe7253d20af9ff337151408f6db368?s=128&d=identicon&r=PG&f=1", "display_name": "M1chael", "link": "https://stackoverflow.com/users/7689700/m1chael"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1507751735, "post_id": 46696228, "comment_id": 80340740, "body": "Even though I spent an hour or so working on this earlier, I&#39;ve managed to answer this myself. I&#39;ll post the answer shortly in case someone else has the same question."}, {"owner": {"reputation": 241, "user_id": 7689700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4fe7253d20af9ff337151408f6db368?s=128&d=identicon&r=PG&f=1", "display_name": "M1chael", "link": "https://stackoverflow.com/users/7689700/m1chael"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1507751795, "post_id": 46696228, "comment_id": 80340777, "body": "The correct format to use is:  Application.OnTime Now(), &quot;&#39;Test File.xlsm&#39;!&#39;MacroToBeCalled &quot;&quot;String To Send&quot;&quot;&#39;&quot; With single quotes both before and after the ! mark, but not including it."}, {"owner": {"reputation": 241, "user_id": 7689700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4fe7253d20af9ff337151408f6db368?s=128&d=identicon&r=PG&f=1", "display_name": "M1chael", "link": "https://stackoverflow.com/users/7689700/m1chael"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1507751866, "post_id": 46696228, "comment_id": 80340825, "body": "Will do, didn&#39;t know I could answer my own question!"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1507752085, "post_id": 46696228, "comment_id": 80340945, "body": "You can also delete comments, which I have just done to mine so that future readers aren&#39;t tempted to wade through discussion that did not ultimately contribute to the answer.  <b>Also,</b> in a few days the system will let you accept the answer you posted.  Would you please, so future readers know it worked for you?  Your solution also worked for me --- I tried it just now."}], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 7689700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4fe7253d20af9ff337151408f6db368?s=128&d=identicon&r=PG&f=1", "display_name": "M1chael", "link": "https://stackoverflow.com/users/7689700/m1chael"}, "is_accepted": false, "score": 1, "last_activity_date": 1507751893, "creation_date": 1507751893, "answer_id": 46696517, "question_id": 46696228, "link": "https://stackoverflow.com/questions/46696228/vba-application-ontime-specify-both-workbook-and-macro-name-and-send-arguments/46696517#46696517", "title": "VBA Application.OnTime Specify both workbook and macro name and send arguments", "body": "<p>The correct format to use is:</p>\n\n<pre><code>Application.OnTime Now(), \"'Test File.xlsm'!'MacroToBeCalled \"\"String To Send\"\"'\"\n</code></pre>\n\n<p>The part before the ! mark, and the part after, should have single quotes.</p>\n"}], "owner": {"reputation": 241, "user_id": 7689700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4fe7253d20af9ff337151408f6db368?s=128&d=identicon&r=PG&f=1", "display_name": "M1chael", "link": "https://stackoverflow.com/users/7689700/m1chael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1507751998, "creation_date": 1507750767, "last_edit_date": 1531164843, "question_id": 46696228, "link": "https://stackoverflow.com/questions/46696228/vba-application-ontime-specify-both-workbook-and-macro-name-and-send-arguments", "title": "VBA Application.OnTime Specify both workbook and macro name and send arguments", "body": "<p>I'm looking to run Application.OnTime and specify both the workbook and some arguments. I can get them to work on their own, but not together.</p>\n\n<p>For example, the following code works if \"MacroToBeCalled\" subroutine is in the same workbook where I set Application.OnTime.  It uses single quotes, as explained <a href=\"http://www.tushar-mehta.com/excel/vba/xl%20objects%20and%20procedures%20with%20arguments.htm\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>Application.OnTime Now(), \"'MacroToBeCalled \"\"String To Send\"\"'\"\n</code></pre>\n\n<p>Also, the following code works if \"MacroToBeCalled\" subroutine is in the workbook called \"Test File.xlsm\", which is different to where I'm running this line of code.</p>\n\n<pre><code>Application.OnTime Now(), \"'Test File.xlsm'!MacroToBeCalled\"\n</code></pre>\n\n<p>However, I can't find a way of sending parameters. I'm looking for something like the following, although this does not work.</p>\n\n<pre><code>Application.OnTime Now(), \"''Test File.xlsm'!MacroToBeCalled \"\"String To Send\"\"'\"\n</code></pre>\n\n<p>What is the format of the string I need to provide for this to work, if it is possible at all?</p>\n\n<p>If you need more detail, I have two workbooks, say one is called A and one is called B. Both A and B contain a subroutine called <code>MacroToBeCalled</code>. I am using a button in workbook A, which uses <code>Application.Run</code> to run a macro in workbook B called <code>SetOnTimeToRunMacro</code>. What I want is for <code>SetOnTimeToRunMacro</code> subroutine in workbook B to call <code>Application.OnTime</code> to run the <code>MacroToBeCalled</code> in workbook B. However, when the <code>OnTime</code> is actually trigged, it's running <code>MacroToBeCalled</code> in workbook A instead of B, even though the <code>OnTime</code> is set in workbook B. If I remove the parameter and specify the workbook, then it works in workbook B.</p>\n"}, {"tags": ["vba", "forms", "ms-access", "combobox", "ms-word"], "comments": [{"owner": {"reputation": 1276, "user_id": 38988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e2d585fabb5cde7a84bafa766ab35b?s=128&d=identicon&r=PG&f=1", "display_name": "John Mo", "link": "https://stackoverflow.com/users/38988/john-mo"}, "edited": false, "score": 1, "creation_date": 1507751923, "post_id": 46696100, "comment_id": 80340852, "body": "Do you know about the mail merge in Word? Getting the data lined up in Access via a combo box is easy and picking it up in Word shouldn&#39;t be a problem. Are you looking to launch Word and execute the merge from Access after the combo box selection is made?"}, {"owner": {"reputation": 173, "user_id": 7308462, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/39456abd68e4734be9caa4b3204a8315?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7308462/john-tipton"}, "reply_to_user": {"reputation": 1276, "user_id": 38988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e2d585fabb5cde7a84bafa766ab35b?s=128&d=identicon&r=PG&f=1", "display_name": "John Mo", "link": "https://stackoverflow.com/users/38988/john-mo"}, "edited": false, "score": 1, "creation_date": 1507753569, "post_id": 46696100, "comment_id": 80341630, "body": "Thank you for reply. yes, mail merge is what my company is using. Yes, sir. You are correct. Any idea to manipulate the pick up data from Access to Word would be appreciated! @JohnMo"}], "owner": {"reputation": 173, "user_id": 7308462, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/39456abd68e4734be9caa4b3204a8315?s=128&d=identicon&r=PG&f=1", "display_name": "John Tipton", "link": "https://stackoverflow.com/users/7308462/john-tipton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507750189, "creation_date": 1507750189, "question_id": 46696100, "link": "https://stackoverflow.com/questions/46696100/filling-fields-on-microsoft-word-based-on-the-value-in-a-combo-box-in-ms-access", "title": "Filling fields on Microsoft Word based on the value in a Combo Box in MS Access 2007?", "body": "<p><strong>Summary</strong>: My company sends out a word document to customers and a very limited amount of the things change between different letters sent out. I want to write a macro or form on MS Access that fill in different text form fields in a word document. </p>\n\n<p><strong>Problem</strong>: Users use a Combo Box in MS Access 2007. I am hoping to get some insight into the best way to populate text boxes and navigate the word document. </p>\n\n<p><strong>Question</strong>: Is it possible to populate text boxes on Word based on the value in a Combo Box in MS Access 2007? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "edited": false, "score": 1, "creation_date": 1507750848, "post_id": 46696016, "comment_id": 80340253, "body": "Did you try PivotTable?"}], "answers": [{"tags": [], "owner": {"reputation": 859, "user_id": 8478939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WkbQc.png?s=128&g=1", "display_name": "barvobot", "link": "https://stackoverflow.com/users/8478939/barvobot"}, "is_accepted": true, "score": 0, "last_activity_date": 1507754323, "creation_date": 1507754323, "answer_id": 46697130, "question_id": 46696016, "link": "https://stackoverflow.com/questions/46696016/how-do-i-only-sum-values-in-a-excel-column-if-names-from-two-arrays-correspond/46697130#46697130", "title": "How do I only sum values in a excel column if names from two arrays correspond?", "body": "<p>I figured the easiest way to do it was to just put the new list on the same worksheet as the old list. This assumes you put the new list in column D (see <code>newCol</code>). </p>\n\n<p>If you wanted to select a new workbook and grab from a specific sheet on it, we'd need to know how the new workbook would be selected (file selector, is it always in a certain file, can multiple files be selected, what would the sheet names be, etc.).</p>\n\n<pre><code>Sub AddAndAppend()\nDim ws As Worksheet\nDim i As Long, j As Long\nDim origCol As Long, newCol As Long, startRow As Long\n\nOn Error GoTo ErrorHandler\n\n'sets to the current worksheet\nSet ws = ActiveSheet\n\n'speeds up macro for longer lists\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\n'assumes a header row so starts on row 2\nstartRow = 2\n\n'origcol is where the names are to start, newcol is where the names are in the new list\norigCol = 1\nnewCol = 4\n\n'loop through all the new names\nFor i = startRow To ws.Cells(ws.Rows.Count, newCol).End(xlUp).Row\n    'if name in new list is found in old list...\n    If WorksheetFunction.CountIf(ws.Range(ws.Cells(startRow, origCol), ws.Cells(ws.Cells(ws.Rows.Count, origCol).End(xlUp).Row, origCol)), ws.Cells(i, newCol).Value) &gt; 0 Then\n        '...find the name in the old list and combine the values\n        For j = startRow To ws.Cells(ws.Rows.Count, origCol).End(xlUp).Row\n            If ws.Cells(j, origCol).Value = ws.Cells(i, newCol).Value Then\n                ws.Cells(j, origCol + 1).Value = ws.Cells(j, origCol + 1).Value + ws.Cells(i, newCol + 1).Value\n                Exit For\n            End If\n        Next j\n    Else\n        '...otherwise, add the new name to the end of the old list\n        ws.Cells(ws.Cells(ws.Rows.Count, origCol).End(xlUp).Row + 1, origCol).Value = ws.Cells(i, newCol).Value\n        ws.Cells(ws.Cells(ws.Rows.Count, origCol).End(xlUp).Row, origCol + 1).Value = ws.Cells(i, newCol + 1).Value\n    End If\nNext i\n\n'turns off speeding up\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nExit Sub\n\nErrorHandler:\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nMsgBox Err.Number &amp; vbCr &amp; Err.Description\nExit Sub\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8761103, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214450214714883/picture?type=large", "display_name": "Mike Coakes", "link": "https://stackoverflow.com/users/8761103/mike-coakes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 46697130, "answer_count": 1, "score": -1, "last_activity_date": 1507754323, "creation_date": 1507749887, "last_edit_date": 1531161705, "question_id": 46696016, "link": "https://stackoverflow.com/questions/46696016/how-do-i-only-sum-values-in-a-excel-column-if-names-from-two-arrays-correspond", "title": "How do I only sum values in a excel column if names from two arrays correspond?", "body": "<p>I'm sure the solution to the following is quite straightforward, but it has me stumped...</p>\n\n<p>I want to perform the following in an excel workbook. Lets say in Column A we have an range of names, and in column B a range of values</p>\n\n<pre><code>A1 - Alan  B1 - 1\nA2 - Bob   B2 - 0\nA3 - Jim   B3 - 1\nA4 - Tom   B4 - 2\n</code></pre>\n\n<p>I then receive a separate workbook with similar data that I need to add to the values in column B, but the new workbook does not contain all of the names in the original workbook, e.g.</p>\n\n<pre><code>A1 - Alan  B1 - 1\nA2 - Jim   B2 - 2\nA3 - Dave  B3 - 1\nA4 - Tom   B4 - 1\n</code></pre>\n\n<p>I want to update the values of the original workbook in column B so that they give the sum of column B from each workbook, and append any new names from column A in the second (new) workbook to the range of names in column A in the original workbook. </p>\n\n<p>Any newly appended names to column A should also display the related value from column B.</p>\n\n<p>I'm currently using filters and updating values manually, the range of names is large, it's time consuming, it's driving me mad...I'm sure there is a more elegant solution to this.</p>\n\n<p>Help?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "ribbon-control", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8761022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e7cadd93441ed97d7120aa4736d8a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lorne", "link": "https://stackoverflow.com/users/8761022/lorne"}, "edited": false, "score": 0, "creation_date": 1507809701, "post_id": 46698518, "comment_id": 80364464, "body": "Thank you so much for rapid response. Used objects in VBA before and thought onLoad was part of the IRibbonUI declaration. Makes perfect sense and now it works I can modify to do what I want"}], "tags": [], "owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "is_accepted": true, "score": 0, "last_activity_date": 1507760844, "creation_date": 1507760844, "answer_id": 46698518, "question_id": 46695803, "link": "https://stackoverflow.com/questions/46695803/cannot-hide-custom-control-on-excel-ribbon/46698518#46698518", "title": "Cannot hide custom control on excel ribbon", "body": "<p>You don't have the callback function in your custom ribbon code:\nExample: <code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\" onLoad=\"RibbonOnLoad\"&gt;</code></p>\n\n<p>So you aren't Running the <code>RibbonOnLoad()</code> procedure. Therefore you are not setting the variable <code>ribControl</code></p>\n"}], "owner": {"reputation": 13, "user_id": 8761022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e7cadd93441ed97d7120aa4736d8a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lorne", "link": "https://stackoverflow.com/users/8761022/lorne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 46698518, "answer_count": 1, "score": 1, "last_activity_date": 1507760844, "creation_date": 1507748927, "last_edit_date": 1531164843, "question_id": 46695803, "link": "https://stackoverflow.com/questions/46695803/cannot-hide-custom-control-on-excel-ribbon", "title": "Cannot hide custom control on excel ribbon", "body": "<p>Been trying to hide a custom control on the excel ribbon and my code keeps showing the message from my RefreshRibbon() sub. The control remains visible no matter what string I pass from the HideImport() sub. I include here the XML for the custom ribbon and the macros that a problem.</p>\n\n<pre><code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\"&gt;\n&lt;ribbon startFromScratch=\"false\"&gt;\n    &lt;tabs&gt;\n        &lt;tab id=\"tabControl1\" label=\"Control\"&gt;\n            &lt;group id=\"grpImport1\" label=\"Import\" getVisible=\"GetVisible\" tag=\"ShowFalse\"&gt;\n                &lt;button id=\"btnDetail\" label=\"Read Detail\" image=\"Ex\" size=\"large\" onAction=\"ReadDetail\" /&gt;\n            &lt;/group&gt;\n            &lt;group id=\"grpJourneys1\" label=\"Journeys\" getVisible=\"GetVisible\" tag=\"ShowTrue\"&gt;\n                &lt;button id=\"btnLegAdd\" label=\"Add\" image=\"AddLeg\" size=\"large\" onAction=\"AddLeg\" /&gt;\n                &lt;button id=\"btnLegRemove\" label=\"Remove\" image=\"RemoveLeg\" size=\"large\" onAction=\"RemoveLeg\" /&gt;\n                &lt;button id=\"btnLegRetime\" label=\"Retime\" image=\"RetimeLeg\" size=\"large\" onAction=\"RetimeLeg\" /&gt;\n            &lt;/group&gt;\n        &lt;/tab&gt;\n    &lt;/tabs&gt;\n&lt;/ribbon&gt;\n</code></pre>\n\n<p></p>\n\n<pre><code>Dim ribControl   As IRibbonUI\nPublic strTag    As String\n\nSub RibbonOnLoad(ribbon As IRibbonUI)\n   Set ribControl = ribbon\nEnd Sub\n\nSub GetVisible(control As IRibbonControl, ByRef visible)\n  If strTag = \"Show\" Then\n    visible = True\n  Else\n    If control.Tag Like strTag Then\n      visible = True\n    Else\n      visible = False\n    End If\n  End If\nEnd Sub\n\nSub RefreshRibbon(Tag As String)\n  strTag = Tag\n  If ribControl Is Nothing Then\n    MsgBox \"Error, Save/Restart your workbook\"\n  Else\n    ribControl.Invalidate\n  End If\nEnd Sub\n\nSub ReadDetail(control As IRibbonControl)\n  MsgBox \"This is Read Detail\"\nEnd Sub\n\nSub AddLeg(control As IRibbonControl)\n  MsgBox \"This is Add Leg\"\nEnd Sub\n\nSub RemoveLeg(control As IRibbonControl)\n  MsgBox \"This is Remove Leg\"\nEnd Sub\n\nSub RetimeLeg(control As IRibbonControl)\n  MsgBox \"This is Retime Leg\"\nEnd Sub\n\nSub HideImport()\n  Call RefreshRibbon(Tag:=\"*True\")\nEnd Sub\n</code></pre>\n\n<p>Don't normally publish on here as always manage to solve it myself after reading your responses to other questions but this is driving me mad.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 2, "creation_date": 1507748841, "post_id": 46695741, "comment_id": 80339292, "body": "A formula will never work as it cannot affect other cells. Do you mean a subroutine? What have you tried so far? Remember that SO is not a code writing service but rather a forum to get targeted help on specific coding errors."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 1, "creation_date": 1507748913, "post_id": 46695741, "comment_id": 80339325, "body": "@nbayly I think OP is wanting the formula(s) to reside in column D and E that read the data from Column A and B, respectively but ignore the blanks."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1507748956, "post_id": 46695741, "comment_id": 80339349, "body": "@JNevill exactly!"}], "answers": [{"comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1507750734, "post_id": 46696180, "comment_id": 80340181, "body": "i cannot have it shift up or right, it has to state static."}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1507751637, "post_id": 46696180, "comment_id": 80340679, "body": "Why don&#39;t you paste the values in another sheet and then copy the cells from there.Added one line the code for same.If required you can delete the values from temporary sheet or delete the sheet itself."}], "tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 0, "last_activity_date": 1507751584, "last_edit_date": 1507751584, "creation_date": 1507750516, "answer_id": 46696180, "question_id": 46695741, "link": "https://stackoverflow.com/questions/46695741/remove-blank-rows-between-data/46696180#46696180", "title": "Remove blank rows between data", "body": "<p>Try this,</p>\n\n<pre><code> Sub test()\n    Sheets(\"Sheet2\").Range(\"D1:E200\").Value = Sheets(\"Sheet1\").Range(\"A1:B200\").Value\n    Sheets(\"Sheet2\").Range(\"D1:E200\").SpecialCells(xlCellTypeBlanks).Delete xlShiftUp\n    Sheets(\"Sheet1\").Range(\"D1:E200\").Value = Sheets(\"Sheet2\").Range(\"D1:E200\").Value  \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1507751247, "post_id": 46696182, "comment_id": 80340461, "body": "it&#39;s not working for me, i should tell you, in those blanks are actually formulas which in terms are blank, not sure if that will effect the formula."}, {"owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1507751616, "post_id": 46696182, "comment_id": 80340670, "body": "I adjusted my answer to include formula values, it should work now."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1516744116, "post_id": 46696182, "comment_id": 83812456, "body": "I have another problem, what if example 1 and example 2 both have the same item such as Dog? Lets say both Example 1 and Example 2 have only one item but have the same thing, How would it distinguish both?"}], "tags": [], "owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1507752438, "last_edit_date": 1507752438, "creation_date": 1507750536, "answer_id": 46696182, "question_id": 46695741, "link": "https://stackoverflow.com/questions/46695741/remove-blank-rows-between-data/46696182#46696182", "title": "Remove blank rows between data", "body": "<p>Formula approach. Enter this formula </p>\n\n<pre><code>=IFERROR(INDEX($B$1:$B$800, SMALL(IF(($B$1:$B$800)=\"\", \"\", ROW($B$1:$B$800)-MIN(ROW($B$1:$B$800))+1), ROW(A1))),\"\")\n</code></pre>\n\n<p>in cell <code>E1</code> and drag it to down. You must enter it using CTRL+SHIFT+ENTER since it is an array formula. </p>\n\n<p>Then enter this formula </p>\n\n<pre><code>=IFERROR(INDIRECT(\"A\"&amp;IFERROR(SMALL(IF(($B$1:$B$800)=\"\",\"\",ROW($B$1:$B$800)-MIN(ROW($B$1:$B$800))+1),ROW(A1)),0)),\"\")\n</code></pre>\n\n<p>in cell <code>D1</code> and also drag it to the bottom. This is also array formula so you need to confirm it with CTRL+SHIFT+ENTER combination.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1HnWb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1HnWb.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1507751058, "post_id": 46696283, "comment_id": 80340366, "body": "cannot delete rows. all rows has to stay."}], "tags": [], "owner": {"reputation": 1, "user_id": 8761312, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/801c19dcdf0bfd89694e07695004d7eb?s=128&d=identicon&r=PG", "display_name": "pmak", "link": "https://stackoverflow.com/users/8761312/pmak"}, "is_accepted": false, "score": 0, "last_activity_date": 1507750950, "creation_date": 1507750950, "answer_id": 46696283, "question_id": 46695741, "link": "https://stackoverflow.com/questions/46695741/remove-blank-rows-between-data/46696283#46696283", "title": "Remove blank rows between data", "body": "<p>I have used this little bit of code a number of times to delete blank lines in reports.  It will find the last row with data in column \"A\" and delete the row if there is nothing in it.  </p>\n\n<pre><code>lastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\nDo While lastRow &gt;= 1\nIf Cells(lastRow, 1).Value = \"\" Then Rows(lastRow).Delete\nlastRow = lastRow - 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "accepted_answer_id": 46696182, "answer_count": 3, "score": 0, "last_activity_date": 1507752438, "creation_date": 1507748639, "last_edit_date": 1507748910, "question_id": 46695741, "link": "https://stackoverflow.com/questions/46695741/remove-blank-rows-between-data", "title": "Remove blank rows between data", "body": "<p>I'm trying to create a formula or vba code that will remove the blank rows in column B between them and joining them on column D. Look at the pic for reference.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q3MZC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q3MZC.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "text-to-column"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 1, "creation_date": 1507748748, "post_id": 46695694, "comment_id": 80339251, "body": "I&#39;m confused as what sheet is the input and what is the output. What have you tried so far? If you are going from ws 1 to ws 2 I suggest you trim each value (not VBA version but rather worksheet function) then you can do SPLIT() on the single space that should be left. Then you can write to your target sheet. Please try to create a solution with this info and if you run into coding errors you can post them here. Regards,"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1507748963, "post_id": 46695694, "comment_id": 80339353, "body": "<i>this has to be done in VBA</i> - without showing your attempts, you&#39;ll get little help. <a href=\"http://stackoverflow.com/help/how-to-ask\">how to ask</a>"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1507748994, "post_id": 46695694, "comment_id": 80339375, "body": "Worksheet 1 is my input and Worksheet 2 is my output"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1507749046, "post_id": 46695694, "comment_id": 80339395, "body": "It&#39;s a little difficult to show my code, as there is quite a bit... and I&#39;d have to modify a lot of it because there&#39;s a lot of confidential information in it"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1507751012, "post_id": 46695694, "comment_id": 80340344, "body": "I changed my question to make it a little easier to work with... my apologies! I also added some code I&#39;m attempting to use"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507752079, "post_id": 46695694, "comment_id": 80340939, "body": "Alternative is to add as step which copy/moves  rngSource values to Sheets(&quot;Consolidated_Data&quot;).Range(&quot;V3&quot;) then perform the text to columns there. See if issue is about the text to columns across different worksheets. In fact after testing myself it always moves to same sheet if you don&#39;t add a copy stage. This is also discussed in a possible duplicate question here: <a href=\"https://stackoverflow.com/questions/21865713/text-to-columns-vba-destination-onto-new-sheet\" title=\"text to columns vba destination onto new sheet\">stackoverflow.com/questions/21865713/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1507752719, "creation_date": 1507752719, "answer_id": 46696750, "question_id": 46695694, "link": "https://stackoverflow.com/questions/46695694/text-to-column-to-different-sheet/46696750#46696750", "title": "Text to Column to Different Sheet", "body": "<p>The text to columns method it appears can't be used from one sheet to another, i.e.the destination has to be on the source data sheet. Though i can't find mention of this in the documentation.</p>\n\n<p>So you would need to add some code which puts your sourceRange values into the target sheet at the top left of the range where you want to split the data out into columns i.e. \"V3\".</p>\n\n<pre><code>Sheets(\"Consolidated_Data\").Range(\"V3\") = sourceRange 'resize the Range V3 to size of sourceRange \nSheets(\"Consolidated_Data\").Range(\"V3\").TextToColumns \n</code></pre>\n"}], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1380, "favorite_count": 0, "closed_date": 1507790229, "accepted_answer_id": 46696750, "answer_count": 1, "score": -1, "last_activity_date": 1529926531, "creation_date": 1507748469, "last_edit_date": 1529926531, "question_id": 46695694, "link": "https://stackoverflow.com/questions/46695694/text-to-column-to-different-sheet", "closed_reason": "Needs more focus", "title": "Text to Column to Different Sheet", "body": "<p>I'm trying to do a text to column from one sheet to another and the below code is not copying the data from the active sheet over to the destination... I am using code generated from the macro</p>\n\n<pre><code>Private Function ConvertText(rngSource As Range)\n\n    rngSource.TextToColumns Destination:=Sheets(\"Consolidated_Data\").Range(\"V3\"), DataType:=xlDelimited, _\n        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=True, Tab:=False, _\n        Semicolon:=False, Comma:=False, Space:=True, Other:=False, FieldInfo _\n        :=Array(Array(1, 1), Array(2, 1)), TrailingMinusNumbers:=True\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 3, "creation_date": 1507748024, "post_id": 46695496, "comment_id": 80338889, "body": "What have you tried so far? Have you tried doing any research? Is the cell storing the date as a serial date? If it is you can just extract the value2 from the cell. It will be a long data type value. The integer part represents the date and the fractions the time. You can research more about this searching for Excel serial date."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1507748110, "creation_date": 1507748110, "answer_id": 46695605, "question_id": 46695496, "link": "https://stackoverflow.com/questions/46695496/extracting-date-and-time-data-from-cell-to-vba/46695605#46695605", "title": "Extracting Date and time data from Cell to VBA", "body": "<p>To get the values as <strong>Strings</strong>:</p>\n\n<pre><code>Sub ytrewq()\n    ary = Split(Range(\"A1\").Text, \" \")\n    DateAsString = ary(0)\n    TimeAsString = ary(1)\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "is_accepted": true, "score": 1, "last_activity_date": 1507748458, "last_edit_date": 1507748458, "creation_date": 1507748117, "answer_id": 46695608, "question_id": 46695496, "link": "https://stackoverflow.com/questions/46695496/extracting-date-and-time-data-from-cell-to-vba/46695608#46695608", "title": "Extracting Date and time data from Cell to VBA", "body": "<p>You can use the <strong>Split</strong> function to extract the date and the time in two differents variables.</p>\n\n<pre><code>Dim aDate() As String\nDim separatedDate As String\nDim separatedTime As String\n\n'Put the value before the \" \" (space character) in the first case of the array \n'and the value after the \" \" (space character) in the second case\naDate = Split(Range(\"Cell where you date is\").Value, \" \", -1)\n\n'You can now access these values and store them in variables\nseparatedDate = aDate(0)\nseparatedTime = aDate(1)  \n</code></pre>\n"}], "owner": {"reputation": 218, "user_id": 8761052, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/9d0d4f61ff8005bbd8654b09d3842385?s=128&d=identicon&r=PG&f=1", "display_name": "sharsart", "link": "https://stackoverflow.com/users/8761052/sharsart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3082, "favorite_count": 0, "accepted_answer_id": 46695608, "answer_count": 2, "score": 0, "last_activity_date": 1507748458, "creation_date": 1507747682, "question_id": 46695496, "link": "https://stackoverflow.com/questions/46695496/extracting-date-and-time-data-from-cell-to-vba", "title": "Extracting Date and time data from Cell to VBA", "body": "<p>I have an excel file with a column which contains date in the following format: yyyy-mm-dd h:mm </p>\n\n<p>I want to store the date and time in two separate VBA string variables.  How would I go about this?</p>\n"}, {"tags": ["vba", "excel", "re-engineering"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1507747745, "post_id": 46695353, "comment_id": 80338768, "body": "Yes, this is possible. You can use DIR() to find the file name using a filter with the file name (sans date). Then you can use DeleteFile method from FileSystemObject library to delete the file."}, {"owner": {"reputation": 1, "user_id": 8760972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f58cf54444661162e3e6f5552951d521?s=128&d=identicon&r=PG&f=1", "display_name": "TheDude", "link": "https://stackoverflow.com/users/8760972/thedude"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1507748183, "post_id": 46695353, "comment_id": 80338978, "body": "Sorry not well versed in VBA, but would you be able to show me in the above code if possible?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1507748381, "post_id": 46695353, "comment_id": 80339077, "body": "If you spend a couple hours a week watching this series <a href=\"https://www.youtube.com/playlist?list=PLNIs-AWhQzckr8Dgmgb3akx_gFMnpxTN5\" rel=\"nofollow noreferrer\">Excel VBA Introduction</a> on Youtube, you quickly be able to do some amazing things."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1507748383, "post_id": 46695353, "comment_id": 80339079, "body": "Not really the intent of this website. SO is a forum to get targeted advice on specific coding errors. It is not a code writing service so you will have to generate your own code. A quick google search gives me this page to understand DIR() <a href=\"https://www.techonthenet.com/excel/formulas/dir.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/dir.php</a> and this one shows how to delete files <a href=\"https://analysistabs.com/excel-vba/delete-files-folder/#bm2a\" rel=\"nofollow noreferrer\">analysistabs.com/excel-vba/delete-files-folder/#bm2a</a>. Once you have created something you can edit your post with your code and someone will gladly help you on any errors you can&#39;t resolve."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1507757071, "last_edit_date": 1507757071, "creation_date": 1507748786, "answer_id": 46695773, "question_id": 46695353, "link": "https://stackoverflow.com/questions/46695353/vba-save-current-dated-file-but-delete-older-files-with-same-name-but-older-date/46695773#46695773", "title": "VBA Save current dated file but delete older files with same name but older date?", "body": "<p>Reference:<a href=\"https://msdn.microsoft.com/en-us/library/dk008ty4(v=vs.90).aspx\" rel=\"nofollow noreferrer\">MSDN Dir() Function</a></p>\n\n<p>Here is a basic Dir() search with pattern matching.  </p>\n\n<pre><code>Const RootDir As String = \"C:\\Reports\\\"\nDim MyFile, MyPath, MyName As String\n\nMyFile = Dir(RootDir &amp; \"*??-??-??.xlsx\")\n\nDo While MyFile &lt;&gt; \"\"\n    ' Insert Code\n    MyFile = Dir()\nLoop\n</code></pre>\n\n<p>Although not a complete answer, it should be enough to get you started.</p>\n"}], "owner": {"reputation": 1, "user_id": 8760972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f58cf54444661162e3e6f5552951d521?s=128&d=identicon&r=PG&f=1", "display_name": "TheDude", "link": "https://stackoverflow.com/users/8760972/thedude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507757071, "creation_date": 1507747158, "last_edit_date": 1507748421, "question_id": 46695353, "link": "https://stackoverflow.com/questions/46695353/vba-save-current-dated-file-but-delete-older-files-with-same-name-but-older-date", "title": "VBA Save current dated file but delete older files with same name but older date?", "body": "<p>Here is my current code:</p>\n\n<pre><code>Dim strDestinationFile As String\nDim The_file As String\nMyOldName = WHAT CAN I PUT HERE &lt;--\nMyNewName = strDestinationFile\n\nSheets(\"NAME OF SHEET\").Select\nRange(\"I2\").Select\n\nThe_file = ActiveCell.Value\n\nstrDestinationFile = \"FILE PATH NAME\"\nSheets(\"NAME OF SHEET\").Select\nActiveWorkbook.SaveAs Filename:=strDestinationFile\nKill MyOldName\n</code></pre>\n\n<p>Will this work if I enter or designate the correct path and what I want deleted in the \"MyOldName = \" Section? Basically I have a VBA that same the sheet with the most current date (ie file name: XXXX-10-11-17.xlsm) but I may have previous files of the same beginning name but different date (ie: XXXX-10-10-17) that I want deleted once this one is saved.</p>\n\n<p>Is this possible? </p>\n\n<p>Thank you for help</p>\n"}, {"tags": ["database", "vba", "ms-access", "records"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8226816, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154657522654268/picture?type=large", "display_name": "Yousuf Ashraf", "link": "https://stackoverflow.com/users/8226816/yousuf-ashraf"}, "edited": false, "score": 0, "creation_date": 1507750632, "post_id": 46696065, "comment_id": 80340130, "body": "The file I wish to rename is in the attachement field in the table for each record, like so <a href=\"https://i.imgur.com/mEgr00y.png\" rel=\"nofollow noreferrer\">i.imgur.com/mEgr00y.png</a>"}, {"owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "reply_to_user": {"reputation": 5, "user_id": 8226816, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154657522654268/picture?type=large", "display_name": "Yousuf Ashraf", "link": "https://stackoverflow.com/users/8226816/yousuf-ashraf"}, "edited": false, "score": 0, "creation_date": 1507752730, "post_id": 46696065, "comment_id": 80341259, "body": "Okay I&#39;ve updated my response to reflect your last comment.  Note that you&#39;ll have to figure out a way to loop through tables if you&#39;re pulling from multiple tables."}, {"owner": {"reputation": 5, "user_id": 8226816, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154657522654268/picture?type=large", "display_name": "Yousuf Ashraf", "link": "https://stackoverflow.com/users/8226816/yousuf-ashraf"}, "edited": false, "score": 0, "creation_date": 1507753444, "post_id": 46696065, "comment_id": 80341568, "body": "I don&#39;t need it to do it for all the records/tables, I&#39;d just like to be able to press the button and rename the attachment for the current record I&#39;m on in the form."}, {"owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "reply_to_user": {"reputation": 5, "user_id": 8226816, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154657522654268/picture?type=large", "display_name": "Yousuf Ashraf", "link": "https://stackoverflow.com/users/8226816/yousuf-ashraf"}, "edited": false, "score": 0, "creation_date": 1507758707, "post_id": 46696065, "comment_id": 80343958, "body": "Updated again.  I thought you were trying to update a file outside of Access."}, {"owner": {"reputation": 5, "user_id": 8226816, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154657522654268/picture?type=large", "display_name": "Yousuf Ashraf", "link": "https://stackoverflow.com/users/8226816/yousuf-ashraf"}, "edited": false, "score": 0, "creation_date": 1507777360, "post_id": 46696065, "comment_id": 80348593, "body": "I changed it a bit because I kept getting a syntax error and it works for when I view the text file through access however the name remains the same when I look at it on my desktop. <a href=\"https://i.imgur.com/1XmgFQI.png\" rel=\"nofollow noreferrer\">i.imgur.com/1XmgFQI.png</a>"}, {"owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "reply_to_user": {"reputation": 5, "user_id": 8226816, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154657522654268/picture?type=large", "display_name": "Yousuf Ashraf", "link": "https://stackoverflow.com/users/8226816/yousuf-ashraf"}, "edited": false, "score": 0, "creation_date": 1507816491, "post_id": 46696065, "comment_id": 80369259, "body": "Haha okay, updated again.... That&#39;s originally what I gave you, code to change the name on the desktop.  I&#39;ve included that and the code for changing the attachment name too.  I would expect some syntax errors since your objects and fields are named differently than mine.  Also for the desktop version, notice that I&#39;m just pulling where TestID = 1.  You&#39;ll have to update that so it&#39;s pulling the correct ID from the form.  I think I&#39;ve given you enough here where you should be able to work it out."}], "tags": [], "owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "is_accepted": true, "score": 1, "last_activity_date": 1507816318, "last_edit_date": 1507816318, "creation_date": 1507750090, "answer_id": 46696065, "question_id": 46695170, "link": "https://stackoverflow.com/questions/46695170/trying-to-rename-an-attachment-in-access-to-a-field-in-the-table/46696065#46696065", "title": "Trying to rename an attachment in Access to a field in the table", "body": "<p>To Change the Name of the Attachment in Access:</p>\n\n<pre><code>Private Sub Command15_Click()\n    Dim NewName As String\n    Dim NewNameWithExt As String\n\n    NewName = Me.TestID.Value\n\n    NewNameWithExt = NewName &amp; \".txt\"\n\n    DoCmd.RunSQL (\"UPDATE TestTable SET TestAttachment.FileName = '\" &amp; \n    NewNameWithExt &amp; \"' WHERE TestID = \" &amp; NewName)\n\nEnd Sub\n</code></pre>\n\n<p>To Change the Name of the File on the Desktop:</p>\n\n<pre><code>Private Sub Command0_Click()\n    Dim NewName As String\n    Dim OldName As String\n    Dim rs As Object\n    Dim strSQL As String\n\n    Set rs = CreateObject(\"ADODB.Recordset\")\n\n    strSQL = \"SELECT TestAttachment.FileName FROM TestTable WHERE TestID = 1\"\n\n    rs.Open strSQL, CurrentProject.Connection, 1, 3\n\n    Do Until rs.EOF\n        OldName = rs.Fields(0)\n        NewName = CurrentDb.TableDefs(\"TestTable\").Fields(0).Name\n\n        Name \"C:\\Users\\TestUser\\desktop\\\" &amp; OldName As \n        \"C:\\Users\\TestUser\\desktop\\\" &amp; NewName &amp; \".TXT\"\n\n        rs.MoveNext\n    Loop\n\n    rs.Close\n    Set rs = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8226816, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154657522654268/picture?type=large", "display_name": "Yousuf Ashraf", "link": "https://stackoverflow.com/users/8226816/yousuf-ashraf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 722, "favorite_count": 0, "accepted_answer_id": 46696065, "answer_count": 1, "score": 0, "last_activity_date": 1507816318, "creation_date": 1507746467, "last_edit_date": 1507754535, "question_id": 46695170, "link": "https://stackoverflow.com/questions/46695170/trying-to-rename-an-attachment-in-access-to-a-field-in-the-table", "title": "Trying to rename an attachment in Access to a field in the table", "body": "<p>Currently I have a table where the 'ID' field is automatically generated through a combination of multiple other fields. Example : ID = '2017_FileName_Chancellor'\nNow I've been trying to figure out a way for me to rename this attachment to that ID (by possibly pressing a button in the form)without manually copy pasting the ID and renaming the attached file as that would be tedious when doing it for thousands of records. Is there anyway for me to do this? I have no knowledge in VBA so I could not tamper with that.</p>\n\n<p>Providing a picture of my table might help <a href=\"https://i.imgur.com/gaTUCtk.png\" rel=\"nofollow noreferrer\">https://i.imgur.com/gaTUCtk.png</a></p>\n"}, {"tags": ["excel", "excel-2016", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1507745920, "post_id": 46694961, "comment_id": 80337771, "body": "Thank you for the help, I will use this method moving forth, however the syntax error remains, cannot find these mythical names, nor allowed to delete them."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1507745653, "creation_date": 1507745653, "answer_id": 46694961, "question_id": 46694772, "link": "https://stackoverflow.com/questions/46694772/vba-named-ranges-counting-higher-than-actual/46694961#46694961", "title": "VBA named ranges counting higher than actual", "body": "<p>Deleting named ranges or anything from a collection is usually done with index and reversed count:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Dim cnt     As Long\n\n    For cnt = ActiveWorkbook.Names.Count To 1 Step -1\n        Debug.Print ActiveWorkbook.Names.Item(cnt).Name\n        ActiveWorkbook.Names.Item(cnt).Delete\n    Next cnt\n\nEnd Sub\n</code></pre>\n\n<p>The reason is that collections are objects like the mafia in a way - everyone knows just the next one, thus if you delete the current one with a for-each loop, you will break the collection. </p>\n"}], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507745653, "creation_date": 1507744971, "last_edit_date": 1531164843, "question_id": 46694772, "link": "https://stackoverflow.com/questions/46694772/vba-named-ranges-counting-higher-than-actual", "title": "VBA named ranges counting higher than actual", "body": "<p>I have a master file that exports various reports, however as I copy entire sheets out (to keep formatting etc) it carries Named Ranges with it.</p>\n\n<p>I need to delete these to break all links, stripped out version like so:</p>\n\n<pre><code>Sub buildreport()\n    ThisWorkbook.Worksheets(\"Report\").Copy\n    With ActiveWorkbook\n    'various things\n        If .Names.Count &gt; 0 Then\n            For Each Name In .Names\n                Name.Delete\n            Next Name\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>If I break on the <code>If .Names.Count &gt; 0 Then</code> then I can see when hovering the count is showing as 6, however the Name Manager for the <code>activesheet</code> only has 2 Names.</p>\n\n<p>Does <code>Names.Count</code> count more than just named ranges?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Out of curiosity I ran the following</p>\n\n<pre><code>With ActiveWorkbook\n    For Each Name In .Names\n        Debug.Print Name\n    Next Name\nEnd With\n</code></pre>\n\n<p>which produced this</p>\n\n<pre><code>='GTM Roles'!$A$2:$BF$1387\n=#NAME?\n=#NAME?\n=#NAME?\n=OFFSET('[GRT MASTER mini.xlsm]All Roles'!$A$2, 0, 0, COUNTA('[GRT MASTER mini.xlsm]All Roles'!$A:$A)-1, COUNTA('[GRT MASTER mini.xlsm]All Roles'!$2:$2))\n='[GRT MASTER mini.xlsm]index'!$I$2:$I$10\n</code></pre>\n\n<p>No idea what these <code>=#NAME?</code> names are, or even where they are, as they are not showing in the name manager, and throws an error that the syntax isn't correct when it tries to delete them.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 894, "user_id": 2662077, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/86c163d97fde1404bb107a9b7e9af307?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/2662077/ryan"}, "edited": false, "score": 0, "creation_date": 1507754337, "post_id": 46694915, "comment_id": 80342033, "body": "That does the trick! Thanks @tim. That is more complicated than I would have expected given how easy it is to change font color... At least it works."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 894, "user_id": 2662077, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/86c163d97fde1404bb107a9b7e9af307?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/2662077/ryan"}, "edited": false, "score": 1, "creation_date": 1507757486, "post_id": 46694915, "comment_id": 80343459, "body": "For some reason font color is one thing which works directly from a function: pretty much everything else requires a work-around."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 11, "last_activity_date": 1507746044, "last_edit_date": 1507746044, "creation_date": 1507745489, "answer_id": 46694915, "question_id": 46694506, "link": "https://stackoverflow.com/questions/46694506/change-calling-cell-interior-color/46694915#46694915", "title": "Change Calling Cell Interior Color", "body": "<p>With both of these in a regular module:</p>\n\n<pre><code>Sub ChangeIt(c1 As Range)\n    c1.Interior.ColorIndex = 3\nEnd Sub\n\nFunction Test()\n\n    With Application.Caller        \n        .Parent.Evaluate \"Changeit(\" &amp; .Address(False, False) &amp; \")\"\n    End With\n    Test = \"Hello\" \n\nEnd Function\n</code></pre>\n\n<p>See: <a href=\"https://stackoverflow.com/questions/23433096/using-a-udf-in-excel-to-update-the-worksheet/23437280#23437280\">Using a UDF in Excel to update the worksheet</a></p>\n"}], "owner": {"reputation": 894, "user_id": 2662077, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/86c163d97fde1404bb107a9b7e9af307?s=128&d=identicon&r=PG", "display_name": "Ryan", "link": "https://stackoverflow.com/users/2662077/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1142, "favorite_count": 2, "accepted_answer_id": 46694915, "answer_count": 1, "score": 6, "last_activity_date": 1507746044, "creation_date": 1507743947, "question_id": 46694506, "link": "https://stackoverflow.com/questions/46694506/change-calling-cell-interior-color", "title": "Change Calling Cell Interior Color", "body": "<p>I'm trying to create a very simple VBA function in Excel that calculates a specific value (based on another cells contents) and sets the calling cells value and interior color. I'm fine with the value calculation, but it's the interior coloring that is throwing me for a loop. </p>\n\n<p>I can do the following to set the text and font color:</p>\n\n<pre><code>Function Test()\n    Application.Caller.Font.ColorIndex = 3\n    Test = \"Hello\"\nEnd Function\n</code></pre>\n\n<p>But I'd rather set the cell interior color. I've tried a couple of different iterations of the code below, but this always gives me a value error in the calling cell.</p>\n\n<pre><code>Function Test()\n    Application.Caller.Interior.ColorIndex = 3\n    Test = \"Hello\"\nEnd Function\n</code></pre>\n\n<p>Anyway, I've seen some other SO posts that talk about similar changes (E.g. <a href=\"https://stackoverflow.com/questions/13360600/excel-setting-the-color-of-a-cell-to-another\">here</a>), but their solutions don't seem to work for me. I would rather not do this with conditional formatting because I want something that I can easily transfer between different Excel files.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 2, "creation_date": 1507744536, "post_id": 46694369, "comment_id": 80337063, "body": "Welcome to the site!  Check out the <a href=\"https://stackoverflow.com/tour\">tour</a> and the <a href=\"https://stackoverflow.com/help/how-to-ask\">how-to-ask page</a> for more about asking questions that will attract quality answers.  You can <a href=\"https://stackoverflow.com/posts/46694369/edit\">edit your question</a> to include more information.  <b>Anyway,</b> in this case, use <code>ActiveWorkbook</code> instead of <code>ThisWorkbook</code> and you should be OK.  <code>ThisWorkbook</code> is the workbook the macro is saved in."}, {"owner": {"reputation": 755, "user_id": 5298189, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/TDtv2.png?s=128&g=1", "display_name": "Robby", "link": "https://stackoverflow.com/users/5298189/robby"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1507744933, "post_id": 46694369, "comment_id": 80337267, "body": "@cxw You could make this an answer to the question instead of just a comment."}, {"owner": {"reputation": 311, "user_id": 7132222, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c276bf6163ccded49895384c2bcbb50?s=128&d=identicon&r=PG&f=1", "display_name": "Maykid", "link": "https://stackoverflow.com/users/7132222/maykid"}, "reply_to_user": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1507748398, "post_id": 46694369, "comment_id": 80339094, "body": "@cxw I changed the ThisWorkbook to ActiveWorkbook and still having the same error pop up when I run the script.    &#39;Loop through each worksheet For Each wks In ThisWorkbook.Worksheets ----&gt; For Each wks In ActiveWorkbook.Worksheets This is what you are referring to correct? If so, I&#39;m still getting the same error message. ActiveWorkbook makes it known for running the script to the active worksheet that you are working with correct?"}, {"owner": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1507748899, "post_id": 46694369, "comment_id": 80339318, "body": "Use <code>For Each wks In Workbooks(&quot;workbookNameHere.xls&quot;).Worksheets</code> if you want to target a specific workbook."}, {"owner": {"reputation": 311, "user_id": 7132222, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c276bf6163ccded49895384c2bcbb50?s=128&d=identicon&r=PG&f=1", "display_name": "Maykid", "link": "https://stackoverflow.com/users/7132222/maykid"}, "edited": false, "score": 0, "creation_date": 1507749095, "post_id": 46694369, "comment_id": 80339416, "body": "I changed this portion in the code,  <code>&#39;Loop through each worksheet     For Each wks In ActiveWorkbook.Worksheets         With wks                      &#39;Create a new worksheet in the output workbook             Set wksOutput = wbkOutput.Sheets.Add             wksOutput.Name = wks.Name</code> This is still giving the same error. Hopefully I&#39;m understanding the context correctly behind <code>ActiveWorkbook</code>"}, {"owner": {"reputation": 311, "user_id": 7132222, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c276bf6163ccded49895384c2bcbb50?s=128&d=identicon&r=PG&f=1", "display_name": "Maykid", "link": "https://stackoverflow.com/users/7132222/maykid"}, "reply_to_user": {"reputation": 16878, "user_id": 4240221, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/5997X.png?s=128&g=1", "display_name": "SierraOscar", "link": "https://stackoverflow.com/users/4240221/sierraoscar"}, "edited": false, "score": 0, "creation_date": 1507749461, "post_id": 46694369, "comment_id": 80339584, "body": "@MacroMan That did it! Thank you so much! And thank you cxw Really appreciate it!!! =D"}], "answers": [{"tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 1, "last_activity_date": 1507749035, "last_edit_date": 1592644375, "creation_date": 1507748470, "answer_id": 46695695, "question_id": 46694369, "link": "https://stackoverflow.com/questions/46694369/duplicate-name-errors-when-moving-macro-from-xls-to-personal-xlsb/46695695#46695695", "title": "&quot;Duplicate name&quot; errors when moving macro from XLS to Personal.xlsb", "body": "<h3>Original</h3>\n<p>Change <code>ThisWorkbook</code> to <code>ActiveWorkbook</code>.  Per <a href=\"https://stackoverflow.com/a/12303098/2877364\">this</a>:</p>\n<blockquote>\n<p><code>ThisWorkbook</code> will always refer to the workbook the code resides in</p>\n<p><code>ActiveWorkbook</code> will refer to the workbook that is active</p>\n</blockquote>\n<p>So when you moved the code to <code>PERSONAL.XLSB</code>, all of your references to <code>ThisWorkbook</code> suddenly pointed to <code>PERSONAL.XLSB</code> instead of the workbook containing your data.  <code>PERSONAL.XLSB</code> certainly doesn't have the input worksheet structure you expect!</p>\n<h3>Edit</h3>\n<p>There's an additional wrinkle!  When you call <code>Workbooks.Add</code>, the new workbook <em>becomes <code>ActiveWorkbook</code></em>.  So what you need is:</p>\n<pre><code>...\nDim wbkInput As Workbook   ' ### New\nDim wbkOutput As Workbook\n... \n'Set references up-front\nlngDateCol = 1 '&lt;~ we know dates are in column A\nset wbkInput = ActiveWorkbook ' ### New - **before** creating the new workbook\nSet wbkOutput = Workbooks.Add\n\nFor Each wks in wbkInput.Worksheets  ' ### Don't use ActiveWorkbook from here on down\n    ...\n</code></pre>\n"}], "owner": {"reputation": 311, "user_id": 7132222, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3c276bf6163ccded49895384c2bcbb50?s=128&d=identicon&r=PG&f=1", "display_name": "Maykid", "link": "https://stackoverflow.com/users/7132222/maykid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "accepted_answer_id": 46695695, "answer_count": 1, "score": 1, "last_activity_date": 1507749335, "creation_date": 1507743411, "last_edit_date": 1531161705, "question_id": 46694369, "link": "https://stackoverflow.com/questions/46694369/duplicate-name-errors-when-moving-macro-from-xls-to-personal-xlsb", "title": "&quot;Duplicate name&quot; errors when moving macro from XLS to Personal.xlsb", "body": "<p>So I've ran this code on a local level with a data sheet that I'm working with that needs to grab the date within a certain range along with all of the rows and put it into a new workbook to be worked on. It works perfectly fine on a local level, I have no problems at all with it, but when I move the module to the <code>PERSONAL.XLSB</code> it gives an error message <strong>(listed inline in the code below)</strong> along with another error message if I fix the issue. My question is how do I create it so I can use this globally throughout each spreadsheet I have without having to copy and paste the code to work properly?</p>\n\n<pre><code>Option Explicit\n\n'This subroutine prompts the user to select dates\nPublic Sub PromptUserForInputDates()\n\nDim strStart As String, strEnd As String, strPromptMessage As String\n\n'Prompt the user to input the start date\nstrStart = InputBox(\"Please enter the start date\")\n\n'Validate the input string\nIf Not IsDate(strStart) Then\n    strPromptMessage = \"Oops! It looks like your entry is not a valid \" &amp; _\n                       \"date. Please retry with a valid date...\"\n    MsgBox strPromptMessage\n    Exit Sub\nEnd If\n\n'Prompt the user to input the end date\nstrEnd = InputBox(\"Please enter the end date\")\n\n'Validate the input string\nIf Not IsDate(strStart) Then\n    strPromptMessage = \"Oops! It looks like your entry is not a valid \" &amp; _\n                       \"date. Please retry with a valid date...\"\n    MsgBox strPromptMessage\n    Exit Sub\nEnd If\n\n'Call the next subroutine, which will do produce the output workbook\nCall CreateSubsetWorkbook(strStart, strEnd)\n\nEnd Sub\n\n'This subroutine creates the new workbook based on input from the prompts\nPublic Sub CreateSubsetWorkbook(StartDate As String, EndDate As String)\n\nDim wbkOutput As Workbook\nDim wksOutput As Worksheet, wks As Worksheet\nDim lngLastRow As Long, lngLastCol As Long, lngDateCol As Long\nDim rngFull As Range, rngResult As Range, rngTarget As Range\n\n'Set references up-front\nlngDateCol = 1 '&lt;~ we know dates are in column A\nSet wbkOutput = Workbooks.Add\n\n'Loop through each worksheet\nFor Each wks In ThisWorkbook.Worksheets\n    With wks\n\n        'Create a new worksheet in the output workbook\n        Set wksOutput = wbkOutput.Sheets.Add\n        wksOutput.Name = wks.Name\n\n       '------&gt; I receive the first error here:\n       'Run-Time error '1004':\n       'That name is already taken. Try a different One\n       'If I change the = wks.Name = \"Sheet1\" it gives another error of:\n       'Run-time erro '91':\n       'Object variable or With block variable not set\n\n        'Create a destination range on the new worksheet that we\n        'will copy our filtered data to\n        Set rngTarget = wksOutput.Cells(1, 1)\n\n        'Identify the data range on this sheet for the autofilter step\n        'by finding the last row and the last column\n        lngLastRow = .Cells.Find(What:=\"*\", LookIn:=xlFormulas, _\n                             SearchOrder:=xlByRows, _\n                             SearchDirection:=xlPrevious).Row\n\n      '----------&gt;Error Message here for the 2nd Error message\n\n        lngLastCol = .Cells.Find(What:=\"*\", LookIn:=xlFormulas, _\n                             SearchOrder:=xlByColumns, _\n                             SearchDirection:=xlPrevious).Column\n        Set rngFull = .Range(.Cells(1, 1), .Cells(lngLastRow, lngLastCol))\n\n        'Apply a filter to the full range to get only rows that\n        'are in between the input dates\n        With rngFull\n            .AutoFilter Field:=lngDateCol, _\n                        Criteria1:=\"&gt;=\" &amp; StartDate, _\n                        Criteria2:=\"&lt;=\" &amp; EndDate\n\n            'Copy only the visible cells and paste to the\n            'new worksheet in our output workbook\n            Set rngResult = rngFull.SpecialCells(xlCellTypeVisible)\n            rngResult.Copy Destination:=rngTarget\n        End With\n\n        'Clear the autofilter safely\n        .AutoFilterMode = False\n        If .FilterMode = True Then\n            .ShowAllData\n        End If\n    End With\nNext wks\n\n'Let the user know our macro has finished!\nMsgBox \"Data transferred!\"\n\nEnd Sub\n</code></pre>\n\n<p>I'm still new to VBA so bear with me, just trying to get a understanding of why it works at a local level perfectly fine but when trying to make the module in <code>PERSONAL.XLSB</code> it starts to give the errors and won't work. Any help would be great!</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 47, "user_id": 7447389, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b3789c10008a717fb2aab68a80de66ae?s=128&d=identicon&r=PG&f=1", "display_name": "Zwick44", "link": "https://stackoverflow.com/users/7447389/zwick44"}, "edited": false, "score": 0, "creation_date": 1507743297, "post_id": 46694177, "comment_id": 80336360, "body": "I am currently using Excel 2016"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7447389, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b3789c10008a717fb2aab68a80de66ae?s=128&d=identicon&r=PG&f=1", "display_name": "Zwick44", "link": "https://stackoverflow.com/users/7447389/zwick44"}, "edited": false, "score": 0, "creation_date": 1507748846, "post_id": 46694610, "comment_id": 80339298, "body": "That worked!!!  Thanks so much!  Would you mind giving me a brief description of issue with the range?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 47, "user_id": 7447389, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b3789c10008a717fb2aab68a80de66ae?s=128&d=identicon&r=PG&f=1", "display_name": "Zwick44", "link": "https://stackoverflow.com/users/7447389/zwick44"}, "edited": false, "score": 0, "creation_date": 1507750289, "post_id": 46694610, "comment_id": 80339962, "body": "Glad it we found the answer! What your macro would have recorded would have been something like &quot;Sheet5!R1C12:R4C5&quot; , note that the entire range reference is inside the &quot;&quot;.  When you created you range using the variable you had Worksheets(sht).Range(&quot;!R1C1:R1048576C11&quot;). This isn&#39;t a valid Range construction as the error indicated. The ! indicated the end of the Worksheet object i.e. Sheet5!"}, {"owner": {"reputation": 47, "user_id": 7447389, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b3789c10008a717fb2aab68a80de66ae?s=128&d=identicon&r=PG&f=1", "display_name": "Zwick44", "link": "https://stackoverflow.com/users/7447389/zwick44"}, "edited": false, "score": 0, "creation_date": 1507750784, "post_id": 46694610, "comment_id": 80340214, "body": "Makes perfect sense.  Thanks again QHarr!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1507744339, "creation_date": 1507744339, "answer_id": 46694610, "question_id": 46694177, "link": "https://stackoverflow.com/questions/46694177/passing-excel-sheet-name-into-macro-vb/46694610#46694610", "title": "Passing Excel Sheet name into macro VB", "body": "<p>Change this </p>\n\n<pre><code>Worksheets(sht).Range(\"!R1C1:R1048576C11\")\n</code></pre>\n\n<p>To this</p>\n\n<pre><code>ActiveWorkbook.Sheets(sht).Range(\"A1:K1048576\")\n</code></pre>\n\n<p>And this</p>\n\n<pre><code> Worksheets(sht).Range(\"!R1C14\")\n</code></pre>\n\n<p>To this</p>\n\n<pre><code> ActiveWorkbook.Sheets(sht).Range(\"N1\")\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 7447389, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b3789c10008a717fb2aab68a80de66ae?s=128&d=identicon&r=PG&f=1", "display_name": "Zwick44", "link": "https://stackoverflow.com/users/7447389/zwick44"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 46694610, "answer_count": 1, "score": 0, "last_activity_date": 1507750718, "creation_date": 1507742639, "last_edit_date": 1507750718, "question_id": 46694177, "link": "https://stackoverflow.com/questions/46694177/passing-excel-sheet-name-into-macro-vb", "title": "Passing Excel Sheet name into macro VB", "body": "<p>I think this should be a simple one considering I have very little VB knowledge :)  I have recorded a macro to create a pivot table for a range on the current sheet.  Of course what this gives me is the code to create a pivot table for that specific sheet.  I am trying to adjust the code to grab the name of the active sheet so I can use this macro across different sheets.  I have tried to search and find exactly how to retrieve the name and then supply that name to the code that will being the process of creating the pivot table.</p>\n\n<p>I am hitting a roadblock at the ActiveWorkbook.PivotCaches.Create section of the code.  I am getting the \"Run-time error '1004': Application-defined or object-defined error\" message.</p>\n\n<p>Any help would be greatly appreciated!</p>\n\n<pre><code>Sub Macro1()\n\nDim sht As String\nsht = ActiveSheet.Name\n\n    Columns(\"A:K\").Select\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:= _\n        Worksheets(sht).Range(\"!R1C1:R1048576C11\"), Version:=6).CreatePivotTable TableDestination:= _\n        Worksheets(sht).Range(\"!R1C14\"), TableName:=\"PivotTable3\", DefaultVersion:=6\n    ActiveSheet.Select\n    Cells(1, 14).Select\n    With ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Department\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable3\").PivotFields( _\n        \"Originating Master Name\")\n        .Orientation = xlRowField\n        .Position = 2\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Net\")\n        .Orientation = xlRowField\n        .Position = 3\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Month\")\n        .Orientation = xlRowField\n        .Position = 4\n    End With\n    ActiveSheet.PivotTables(\"PivotTable3\").AddDataField ActiveSheet.PivotTables( _\n        \"PivotTable3\").PivotFields(\"Net\"), \"Count of Net\", xlCount\n    With ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Month\")\n        .Orientation = xlColumnField\n        .Position = 1\n    End With\n    With ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"Count of Net\")\n        .Caption = \"Sum of Net\"\n        .Function = xlSum\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 8358987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/725f25469668eac1eceba65e33bde1bb?s=128&d=identicon&r=PG&f=1", "display_name": "mpmcderm", "link": "https://stackoverflow.com/users/8358987/mpmcderm"}, "edited": false, "score": 0, "creation_date": 1507758227, "post_id": 46694282, "comment_id": 80343770, "body": "Thanks, but this doesn&#39;t work with the filtered rows"}, {"owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "reply_to_user": {"reputation": 69, "user_id": 8358987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/725f25469668eac1eceba65e33bde1bb?s=128&d=identicon&r=PG&f=1", "display_name": "mpmcderm", "link": "https://stackoverflow.com/users/8358987/mpmcderm"}, "edited": false, "score": 0, "creation_date": 1507759431, "post_id": 46694282, "comment_id": 80344190, "body": "It copies range entirely contain filtered rows. If you need to copy only visible rows, now I have update above answer for this, else please say about your problem in working with filtered rows."}], "tags": [], "owner": {"reputation": 1077, "user_id": 6792573, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/CL1p0.jpg?s=128&g=1", "display_name": "mgae2m", "link": "https://stackoverflow.com/users/6792573/mgae2m"}, "is_accepted": false, "score": 2, "last_activity_date": 1507760503, "last_edit_date": 1507760503, "creation_date": 1507743074, "answer_id": 46694282, "question_id": 46694140, "link": "https://stackoverflow.com/questions/46694140/copy-and-paste-from-tables-with-vba/46694282#46694282", "title": "Copy and Paste from Tables with VBA", "body": "<pre><code>Sub Table_Move()\n\n    Dim N As String\n    Dim O As String\n\n    Call Clear\n\n    N = \"New\"\n    O = \"Old\"\n\n    Range(\"Table1[\" &amp; N &amp; \"]\").Copy\n    Range(\"Table1[\" &amp; O &amp; \"]\").PasteSpecial xlPasteValues\n\n\nEnd Sub\n</code></pre>\n\n<h2>Update</h2>\n\n<p><strong>Handle visible cells only</strong></p>\n\n<pre><code>Sub Table_Move()\n\n    Dim N As String\n    Dim O As String\n    Dim Rng As Range\n    Dim rw As Range\n\n    Call Clear\n\n    N = \"New\"\n    O = \"Old\"\n\n    For Each rw In Range(\"Table1[\" &amp; N &amp; \"]\").Cells\n\n        If rw.EntireRow.Hidden = False Then\n            If Rng Is Nothing Then Set Rng = rw\n            Set Rng = Union(rw, Rng)\n        End If\n\n    Next rw\n\n    Rng.Copy\n\n    Range(\"Table1[\" &amp; O &amp; \"]\").PasteSpecial xlPasteValues    \n\nEnd Sub\n</code></pre>\n\n<h2>Also</h2>\n\n<pre><code>Sub Table_Move()\n\n    Dim N As String\n    Dim O As String\n\n    Call Clear\n\n    N = \"New\"\n    O = \"Old\"\n\n    Range(\"Table1[\" &amp; N &amp; \"]\").SpecialCells (xlCellTypeVisible).Copy\n    Range(\"Table1[\" &amp; O &amp; \"]\").PasteSpecial xlPasteValues\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1373, "user_id": 2524830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8747a131c11d0f535df92a8eaceb4550?s=128&d=identicon&r=PG", "display_name": "Valli", "link": "https://stackoverflow.com/users/2524830/valli"}, "is_accepted": false, "score": 0, "last_activity_date": 1507745221, "creation_date": 1507745221, "answer_id": 46694847, "question_id": 46694140, "link": "https://stackoverflow.com/questions/46694140/copy-and-paste-from-tables-with-vba/46694847#46694847", "title": "Copy and Paste from Tables with VBA", "body": "<p>This piece of code will copy and paste each and every row from a data range, even if filter is on</p>\n\n<pre><code>Sub Move()\nDim rowcount As Integer, currentRow As Integer\nDim sourceCol  As Integer, TargetCol As Integer\n\nsourceCol = 14 ' Its N Column\nTargetCol = 15 ' Its O Column\nrowcount = Cells(Rows.Count, sourceCol).End(xlUp).Row 'counts the rows with data\nFor currentRow = 1 To rowcount\n    Range(\"O\" &amp; currentRow).Value = Range(\"N\" &amp; currentRow).Value 'Copy from N to O\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 8358987, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/725f25469668eac1eceba65e33bde1bb?s=128&d=identicon&r=PG&f=1", "display_name": "mpmcderm", "link": "https://stackoverflow.com/users/8358987/mpmcderm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7564, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1578281660, "creation_date": 1507742482, "last_edit_date": 1578281660, "question_id": 46694140, "link": "https://stackoverflow.com/questions/46694140/copy-and-paste-from-tables-with-vba", "title": "Copy and Paste from Tables with VBA", "body": "<p>MS Excel 2016 VBA:</p>\n\n<p>The following code works well except if the table is filtered. Any ideas on how to get around that without undoing the filtering?</p>\n\n<p>Every day I need to copy the new column and paste it to the old column so we can track our daily progress. </p>\n\n<p>I have additional code to unfilter, but I don't like the idea. </p>\n\n<p>Suggestions?</p>\n\n<pre><code>Sub Table_Move()\n\n    Dim tbl As ListObject\n    Dim N As String\n    Dim O As String\n\n    Call Clear\n\n    N = \"New\"\n    O = \"Old\"\n\n    Set tbl = ActiveSheet.ListObjects(\"Table1\")\n\n    tbl.ListColumns(N).DataBodyRange.Copy\n    tbl.ListColumns(O).DataBodyRange.PasteSpecial xlPasteValues\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "loops", "for-loop", "insert"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1507742363, "post_id": 46693988, "comment_id": 80335869, "body": "Can you try <code>For Each x In wksProd.Range(&quot;A3:A&quot; &amp; iRow)</code> on the first line?"}, {"owner": {"reputation": 9, "user_id": 6805930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb2ba5430892e0ff6ae43994c74dde40?s=128&d=identicon&r=PG&f=1", "display_name": "c3nixon", "link": "https://stackoverflow.com/users/6805930/c3nixon"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1507743923, "post_id": 46693988, "comment_id": 80336675, "body": "Still same result.  When its going back to x it is not taking into consideration that the +5 rows were non-existent when the loop started."}, {"owner": {"reputation": 730, "user_id": 7077298, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1Y0iM.jpg?s=128&g=1", "display_name": "hod", "link": "https://stackoverflow.com/users/7077298/hod"}, "edited": false, "score": 0, "creation_date": 1507745405, "post_id": 46693988, "comment_id": 80337513, "body": "Just to make it clear. You want to add five rows under each of those letters?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6805930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb2ba5430892e0ff6ae43994c74dde40?s=128&d=identicon&r=PG&f=1", "display_name": "c3nixon", "link": "https://stackoverflow.com/users/6805930/c3nixon"}, "edited": false, "score": 0, "creation_date": 1507744045, "post_id": 46694173, "comment_id": 80336755, "body": "I put wksProd in front of each of those that you mentioned.  Still have the same issue.  It goes to cell A3 and inserts 5 rows after A3.  When it hits the loop to x to go to next x it is going to A4 (instead of A3 + 5) how can I increment x in a for each loop?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 9, "user_id": 6805930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb2ba5430892e0ff6ae43994c74dde40?s=128&d=identicon&r=PG&f=1", "display_name": "c3nixon", "link": "https://stackoverflow.com/users/6805930/c3nixon"}, "edited": false, "score": 0, "creation_date": 1507745348, "post_id": 46694173, "comment_id": 80337488, "body": "@c3nixon that&#39;s the &quot;modifying a collection as you&#39;re iterating it&quot; part screwing you over. You can&#39;t change how a <code>For Each</code> loop iterates an object collection, so you need to change your control flow - e.g. using a <code>For</code> loop with <code>Step 5</code> specified, but then know that iterating an object collection with a <code>For</code> loop is going to slow down the code."}, {"owner": {"reputation": 9, "user_id": 6805930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb2ba5430892e0ff6ae43994c74dde40?s=128&d=identicon&r=PG&f=1", "display_name": "c3nixon", "link": "https://stackoverflow.com/users/6805930/c3nixon"}, "edited": false, "score": 0, "creation_date": 1507746402, "post_id": 46694173, "comment_id": 80338020, "body": "Ahh... so I completely misunderstood your statement... Got it working now!   Ill post as answer -- Thanks for the help Mat!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1507742995, "last_edit_date": 1507742995, "creation_date": 1507742622, "answer_id": 46694173, "question_id": 46693988, "link": "https://stackoverflow.com/questions/46693988/vba-for-loop-stuck/46694173#46694173", "title": "VBA For Loop STUCK", "body": "<p>You're looping on worksheet <code>wksProd</code>, but working against whatever worksheet happens to be the <code>ActiveSheet</code>.</p>\n\n<p>I've highlighted the implicit references to the active sheet with <code>*stars*</code>:</p>\n\n<pre><code>For Each x In wksProd.Range(\"A3\", \"A\" &amp; iRow)\nIf x &lt;&gt; \"0\" Then\n    *Rows*(x.Row).EntireRow.Offset(1).Resize(5).Insert\n    With *Range*(x.Address, ConvertToLetter(x.Column) &amp; x.Row + 5)\n        .Merge\n        .VerticalAlignment = xlCenter\n    End With\n    With *Range*(ConvertToLetter(x.Column + 1) &amp; x.Row, ConvertToLetter(x.Column + 1) &amp; x.Row + 5)\n        .Merge\n        .VerticalAlignment = xlCenter\n    End With\n    &lt;-- some other formatting code here --&gt;\nEnd If\nNext x\n</code></pre>\n\n<p>And you probably have more. Make sure you're working with <code>wksProd</code> - it may or may not be the active sheet. If it isn't, then you're inserting rows in the wrong worksheet. If it is, then you're <strong>modifying a collection as you're iterating it</strong> - and that's never a good idea.</p>\n\n<blockquote>\n<pre><code>Rows(x.Row).EntireRow.Offset(1).Resize(5).Insert\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 6805930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb2ba5430892e0ff6ae43994c74dde40?s=128&d=identicon&r=PG&f=1", "display_name": "c3nixon", "link": "https://stackoverflow.com/users/6805930/c3nixon"}, "is_accepted": false, "score": 0, "last_activity_date": 1507746491, "creation_date": 1507746491, "answer_id": 46695180, "question_id": 46693988, "link": "https://stackoverflow.com/questions/46693988/vba-for-loop-stuck/46695180#46695180", "title": "VBA For Loop STUCK", "body": "<p>Thx Mat's Mug -- this resolved it (using For with Step vs For Each.</p>\n\n<pre><code>    For x = 3 To ((iRow + 2) * 5) Step 6\n    wksProd.Rows(x).EntireRow.Offset(1).Resize(5).Insert\n    With wksProd.Range(\"A\" &amp; x, \"A\" &amp; x + 5)\n        .Merge\n        .VerticalAlignment = xlCenter\n    End With\n    With wksProd.Range(\"B\" &amp; x, \"B\" &amp; x + 5)\n        .Merge\n        .VerticalAlignment = xlCenter\n    End With\n    &lt;-- some other formatting code here --&gt;\nNext x\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6805930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/eb2ba5430892e0ff6ae43994c74dde40?s=128&d=identicon&r=PG&f=1", "display_name": "c3nixon", "link": "https://stackoverflow.com/users/6805930/c3nixon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 46694173, "answer_count": 2, "score": 0, "last_activity_date": 1507746491, "creation_date": 1507741869, "last_edit_date": 1507742216, "question_id": 46693988, "link": "https://stackoverflow.com/questions/46693988/vba-for-loop-stuck", "title": "VBA For Loop STUCK", "body": "<p>I have a For loop that is running through all rows (it also merges the inserted rows) ... The road block I am running into is while going through the rows I am inserting rows which is throwing it off.</p>\n\n<p>Example:</p>\n\n<p>Adding 5 rows after A and instead of going to B it goes to one of the added rows under A.</p>\n\n<p>Initial Look</p>\n\n<ul>\n<li>A</li>\n<li>B </li>\n<li>C  </li>\n<li>D</li>\n</ul>\n\n<p>First Pass adds 5 blank rows under A.</p>\n\n<p>Second pass keeps adding more space after A instead of jumping down to B.</p>\n\n<pre><code>For Each x In wksProd.Range(\"A3\", \"A\" &amp; iRow)\nIf x &lt;&gt; \"0\" Then\n    Rows(x.Row).EntireRow.Offset(1).Resize(5).Insert\n    With Range(x.Address, ConvertToLetter(x.Column) &amp; x.Row + 5)\n        .Merge\n        .VerticalAlignment = xlCenter\n    End With\n    With Range(ConvertToLetter(x.Column + 1) &amp; x.Row, ConvertToLetter(x.Column + 1) &amp; x.Row + 5)\n        .Merge\n        .VerticalAlignment = xlCenter\n    End With\n    &lt;-- some other formatting code here --&gt;\nEnd If\nNext x\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1507743899, "post_id": 46693731, "comment_id": 80336658, "body": "VBA could do this. What have you tried? If you&#39;re new to VBA, record a marco and edit it. Just need some conditions."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8760135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802d165610fa9b86238bcc3cf1aec5d6?s=128&d=identicon&r=PG&f=1", "display_name": "J Tolsma", "link": "https://stackoverflow.com/users/8760135/j-tolsma"}, "edited": false, "score": 0, "creation_date": 1507755192, "post_id": 46694523, "comment_id": 80342450, "body": "This code works amazing for adding the blank rows. The values in the blank row are just the number 0.001 and not +0.001/-0.001 the above and below values. Thank you anyways though as the blank rows help me tremendously."}, {"owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "reply_to_user": {"reputation": 3, "user_id": 8760135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802d165610fa9b86238bcc3cf1aec5d6?s=128&d=identicon&r=PG&f=1", "display_name": "J Tolsma", "link": "https://stackoverflow.com/users/8760135/j-tolsma"}, "edited": false, "score": 0, "creation_date": 1507782473, "post_id": 46694523, "comment_id": 80349931, "body": "@JTolsma Sorry I misunderstood what you asked in the first place. I edited the code to do so, now the values are correct. If this code works, please accept my answer by hitting the button below the up/down vote!"}, {"owner": {"reputation": 3, "user_id": 8760135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802d165610fa9b86238bcc3cf1aec5d6?s=128&d=identicon&r=PG&f=1", "display_name": "J Tolsma", "link": "https://stackoverflow.com/users/8760135/j-tolsma"}, "edited": false, "score": 0, "creation_date": 1507818387, "post_id": 46694523, "comment_id": 80370649, "body": "It works!! Thank you so much."}], "tags": [], "owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "is_accepted": true, "score": 0, "last_activity_date": 1507787988, "last_edit_date": 1507787988, "creation_date": 1507743991, "answer_id": 46694523, "question_id": 46693731, "link": "https://stackoverflow.com/questions/46693731/insert-row-between-two-cells-based-on-values/46694523#46694523", "title": "Insert Row between two cells based on values", "body": "<p>The following code will do what you want</p>\n\n<pre><code>Sub InsertBlankRowAndSetValue()\n    Dim yourColumn As String\n    Dim rowToStart As Integer\n    Dim nameOfYourSheet As String\n\n    Dim currentValue As Double\n    Dim previousValue As Double\n\n    'EDIT VALUES HERE\n    yourColumn = \"E\"\n    rowToStart = 1\n    nameOfYourSheet = \"Name of your sheet\"\n\n    With ThisWorkbook.Sheets(nameOfYourSheet)\n        'For each cell in the column from the end\n        For i = .Cells(.Rows.Count, yourColumn).End(xlUp).Row To rowToStart + 1 Step -1\n            currentValue = CDbl(.Range(yourColumn &amp; i).Value)\n            previousValue = CDbl(.Range(yourColumn &amp; i).Offset(-1, 0).Value)\n\n            'If the difference with the previous &gt; 0.002\n            If ((currentValue - previousValue) &gt; 0.002) Then\n                'Add rows and set values\n                .Rows(i).EntireRow.Insert Shift:=xlDown\n                .Range(yourColumn &amp; i).Value = currentValue + 0.001\n                .Rows(i).EntireRow.Insert Shift:=xlDown\n                .Range(yourColumn &amp; i).Value = previousValue + 0.001\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h2>Explanations</h2>\n\n<p>Edit the name of your sheet in <code>nameOfYourSheet = \"Name of your sheet\"</code> to make it work.</p>\n\n<p>I go through every value in your column starting from the bottom (less problems with index when you add a row above) and if the difference is more than 0.002 then I add a row and put +0.001 as it's value.</p>\n"}], "owner": {"reputation": 3, "user_id": 8760135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802d165610fa9b86238bcc3cf1aec5d6?s=128&d=identicon&r=PG&f=1", "display_name": "J Tolsma", "link": "https://stackoverflow.com/users/8760135/j-tolsma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 671, "favorite_count": 0, "closed_date": 1507774978, "accepted_answer_id": 46694523, "answer_count": 1, "score": -1, "last_activity_date": 1507787988, "creation_date": 1507740891, "last_edit_date": 1507740957, "question_id": 46693731, "link": "https://stackoverflow.com/questions/46693731/insert-row-between-two-cells-based-on-values", "closed_reason": "Not suitable for this site", "title": "Insert Row between two cells based on values", "body": "<p>I am looking for a macro that will insert rows based on cell values in column E. If the cells above and below have a difference more than 0.002, I want two rows inserted in between. Below is an example of what I would like to have the data to look like</p>\n\n<p>EX. </p>\n\n<p>Column E</p>\n\n<p>42948.745</p>\n\n<p><strong>(Insert Blank (Row)</strong></p>\n\n<p><strong>(Insert Blank Row)</strong></p>\n\n<p>42948.758</p>\n\n<p><strong>(Insert Blank (Row)</strong></p>\n\n<p><strong>(Insert Blank Row)</strong></p>\n\n<p>42948.898</p>\n\n<p>42948.900</p>\n\n<p>42948.901</p>\n\n<p><strong>(Insert Blank (Row)</strong></p>\n\n<p><strong>(Insert Blank Row)</strong></p>\n\n<p>42948.933</p>\n\n<p>Even better if the code included a way to fill the cells in the blank row with + 0.001 from the above cell and -0.001 from the bottom cell. Ex.</p>\n\n<p>42948.901</p>\n\n<p><strong>Insert 42948.902</strong></p>\n\n<p><strong>Insert 42948.932</strong></p>\n\n<p>42948.933</p>\n\n<p>Thank you so much as I have been trying to figure this out forever. I have many shortcuts but no solutions. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1507740508, "post_id": 46693521, "comment_id": 80334866, "body": "What error are you getting?"}, {"owner": {"reputation": 1, "user_id": 8760127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46916c69edd0169a6f40765006a487a8?s=128&d=identicon&r=PG&f=1", "display_name": "James007", "link": "https://stackoverflow.com/users/8760127/james007"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1507740721, "post_id": 46693521, "comment_id": 80334969, "body": "1004 Application-defined or object defined error"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8760127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46916c69edd0169a6f40765006a487a8?s=128&d=identicon&r=PG&f=1", "display_name": "James007", "link": "https://stackoverflow.com/users/8760127/james007"}, "edited": false, "score": 0, "creation_date": 1507741059, "post_id": 46693668, "comment_id": 80335192, "body": "Thanks JNevill! That was it. One missing &quot;&amp;&quot;. Most appreciated!!"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 1, "last_activity_date": 1507740662, "creation_date": 1507740662, "answer_id": 46693668, "question_id": 46693521, "link": "https://stackoverflow.com/questions/46693521/using-formula-with-variable-in-last-listrows/46693668#46693668", "title": "Using .Formula with variable in last ListRows", "body": "<p>Looks like you are missing an ampersand. Currently if <code>cChr</code> is set to 72 your formula would be:</p>\n\n<pre><code>=IF(COUNTIF(A:A,[@PRODNAME])&lt;=1,\"100-\" &amp; CHAR(72)\"-0\" &amp;COUNTIF(A:A,[@PRODNAME]),)\n</code></pre>\n\n<p>You'll see there is no ampersand after the <code>CHAR(72)</code> to concatenate it with the <code>\"-0\"</code>.  Instead: </p>\n\n<pre><code>oNewRow.Range(0, 2).Formula = \"=IF(COUNTIF(A:A,[@PRODNAME])&lt;=1,\"\"100-\"\" &amp; CHAR(\" &amp; cChr &amp; \") &amp; \"\"-0\"\" &amp;COUNTIF(A:A,[@PRODNAME]),)\"\n</code></pre>\n\n<p>This is easily catchable if you echo out to the immediate pane the results of your concatenation:</p>\n\n<pre><code>debug.print \"=IF(COUNTIF(A:A,[@PRODNAME])&lt;=1,\"\"100-\"\" &amp; CHAR(\" &amp; cChr &amp; \")\"\"-0\"\" &amp;COUNTIF(A:A,[@PRODNAME]),)\"\n</code></pre>\n\n<p>Before slinging it over to the range's <code>.formula</code> and picking up some esoteric excel error.</p>\n"}], "owner": {"reputation": 1, "user_id": 8760127, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46916c69edd0169a6f40765006a487a8?s=128&d=identicon&r=PG&f=1", "display_name": "James007", "link": "https://stackoverflow.com/users/8760127/james007"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507740662, "creation_date": 1507740132, "last_edit_date": 1531164843, "question_id": 46693521, "link": "https://stackoverflow.com/questions/46693521/using-formula-with-variable-in-last-listrows", "title": "Using .Formula with variable in last ListRows", "body": "<p>I am trying to use .Formula to insert formula into newly created last ListRows.\nThis snippet of code works</p>\n\n<pre><code>oNewRow.Range(0, 2).Formula = \"=IF(COUNTIF(A:A,[@PRODNAME])&lt;=1,\"\"100-\"\" &amp; CHAR(72) &amp; \"\"-0\"\"&amp;COUNTIF(A:A,[@PRODNAME]),)\" \n</code></pre>\n\n<p>This formula goes in No Problem, but I need the CHAR() to be represented by a variable.</p>\n\n<p>Thank you.</p>\n\n<pre><code>Dim cChr As Integer\nDim tbl As ListObject\nDim tblRows As Integer\nDim oNewRow As ListRow\n\n\n\nSet tbl = ThisWorkbook.Worksheets(\"100-0-00\").ListObjects(\"TBL_tertiary129\")\n\n\nSet oNewRow = tbl.ListRows.Add(AlwaysInsert:=True)\n\ntblRows = tbl.ListRows.Count\n\n\ncChr = (65 + tblRows - 2) 'Increment alpha value based on position\n\nMsgBox (Chr(cChr))\n\n\noNewRow.Range(0, 2).Formula = \"=IF(COUNTIF(A:A,[@PRODNAME])&lt;=1,\"\"100-\"\" &amp; CHAR(\" &amp; cChr &amp; \")\"\"-0\"\" &amp;COUNTIF(A:A,[@PRODNAME]),)\" 'Problem with Formula within Quotes    \n</code></pre>\n"}, {"tags": ["vba", "excel", "long-integer", "operator-precedence"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1507740554, "post_id": 46693427, "comment_id": 80334880, "body": "The exclamation points are making these literals <i><code>Single</code> literals</i>. Without the exclamation point they would be <i><code>Double</code> literals</i>, which is the default type for any floating-point literal in VBA. IOW you&#39;re <i>reducing</i> the precision with it - just drop &#39;em. Nobody uses type hints anymore anyway. Declare local <code>Const</code> with an explicit type instead of using magic/arbitrary numbers."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507741764, "post_id": 46693427, "comment_id": 80335556, "body": "Thanks, Matt.  I was looking for double literals.  I DO need to get out of the habit of using magic numbers, this was a good reminder."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1507740667, "post_id": 46693641, "comment_id": 80334943, "body": "<code>Long</code> <b><i>is</i></b> an integer type. 32-bit, whereas <code>Integer</code> is 16-bit. &quot;Acts like&quot; doesn&#39;t sound right. And why on Earth would you use a <code>Variant</code> when you already know that the expression resolves to a <code>Double</code>?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507740816, "post_id": 46693641, "comment_id": 80335044, "body": "@Mat&#39;sMug I changed the statement about Long, which stores a whole number.  if you want to store a decimal, I am under the impression that you would use As Variant."}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 4, "creation_date": 1507740982, "post_id": 46693641, "comment_id": 80335158, "body": "Decimals should be <code>Double</code> type variables.  <code>Dim lAdder As Double</code>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1507741282, "post_id": 46693641, "comment_id": 80335316, "body": "@tigeravatar Updated my post to reflect that.  My understanding was flawed, and though As Variant gave me the correct answer, didn&#39;t appear to be appropriate.  I thought Double was specific to an Array type, not that the data could be a decimal."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "edited": false, "score": 0, "creation_date": 1507741433, "post_id": 46693641, "comment_id": 80335391, "body": "Accepted answer after the double.  Thank you!  My initial project did use doubles but I accidentally named the variable lAdder instead of dAdder, making me think it was a long.  Thank you, tigeravatar, for suggesting this and thank you, Cyril, for making the correction!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1507741541, "post_id": 46693641, "comment_id": 80335448, "body": "@user4333011 <code>lAdder</code> vs <code>dAdder</code> ... you need to read <a href=\"https://www.joelonsoftware.com/2005/05/11/making-wrong-code-look-wrong/\" rel=\"nofollow noreferrer\">this</a>, urgently. That&#39;s called <i>Systems Hungarian</i>, and it needs to be killed - with fire."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "edited": false, "score": 0, "creation_date": 1507741731, "post_id": 46693641, "comment_id": 80335537, "body": "Thanks Matt, I will definitely read that.  I felt it was a bit of a strange practice when I started it, but it was definitely helpful in keeping track of types.  I&#39;ll read that article, though, and change my practice if it&#39;s mangaloid."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507743478, "post_id": 46693641, "comment_id": 80336456, "body": "@Mat&#39;sMug - So what would be a better way to name <code>Adder</code> variable to understand both it&#39;s purpose and type? Or, perhaps, I&#39;ll finally download RubberDuck and inspect my own code :)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1507743701, "post_id": 46693641, "comment_id": 80336553, "body": "@ScottHoltzman the type is irrelevant. Context is everything. If this were in a function named <code>CalculateCommissionRate</code> then <code>result</code> would be what I&#39;d go with. Here... It&#39;s hard to tell what the intent is anyway ;-)"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507744276, "post_id": 46693641, "comment_id": 80336907, "body": "Thanks @Mat&#39;sMug. So you are saying type is irrelevant because, for example, <code>result = 0.35 + 0.15</code> tells me automatically that it certainly isn&#39;t a string and most likely not a byte / int / long` and furthermore if <code>Dim result as  Double</code> is written right above or very close to it&#39;s my eyes can check type very easily anyway?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1507744927, "post_id": 46693641, "comment_id": 80337263, "body": "@ScottHoltzman exactly. Declaring variables as close as possible to their usage/assignment puts the context right where it needs to be :)"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 1, "last_activity_date": 1507741157, "last_edit_date": 1507741157, "creation_date": 1507740573, "answer_id": 46693641, "question_id": 46693427, "link": "https://stackoverflow.com/questions/46693427/long-data-type-not-storing-long-value-in-excel-vba/46693641#46693641", "title": "Long Data Type Not Storing Long Value in Excel VBA", "body": "<p>Long is a whole number.</p>\n\n<p>I changed lAdder to Variant to collect a decimal value:</p>\n\n<pre><code>Sub Test()\n    Dim lFileCount As Long\n    Dim lAdder As Variant\n    lFileCount = 1\n    MsgBox 0.35 + (0.15 / lFileCount)\n    lAdder = 0.35 + (0.15 / lFileCount)\n    MsgBox lAdder\n    MsgBox Format(lAdder, \"0.0\")\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Looks like my usage of As Variant was not appropriate, as shown in the comments to this answer.  As Double should be used for decimals: </p>\n\n<pre><code> Sub Test()\n    Dim lFileCount As Long\n    Dim lAdder As Double\n    lFileCount = 1\n    MsgBox 0.35 + (0.15 / lFileCount)\n    lAdder = 0.35 + (0.15 / lFileCount)\n    MsgBox lAdder\n    MsgBox Format(lAdder, \"0.0\")\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1507741623, "post_id": 46693893, "comment_id": 80335499, "body": "Excellent answer, also +1 for calling out the Systems Hungarian notation :D"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "edited": false, "score": 0, "creation_date": 1507741957, "post_id": 46693893, "comment_id": 80335650, "body": "Thanks Matt.  I was using doubles in my initial project and they were overflowing, I read the article <a href=\"https://bytes.com/topic/visual-basic/answers/625485-overflow-long-variable-type\" rel=\"nofollow noreferrer\">here</a> , implemented that solution, and I was no longer overflowing."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "edited": false, "score": 0, "creation_date": 1507742012, "post_id": 46693893, "comment_id": 80335675, "body": "I still need to read the article on the Hungarian notation, but I DID find it useful to track datatypes.  And I had learned that long was an integer and forgot it when working on this :/"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "edited": false, "score": 0, "creation_date": 1507742101, "post_id": 46693893, "comment_id": 80335715, "body": "The Killer42 comment on that thread I linked to was the solution that prevented the overflow."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507742342, "post_id": 46693893, "comment_id": 80335854, "body": "@user4333011 I&#39;d warmly recommend you take a look at <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a>, an open-source VBIDE add-in project I manage - we&#39;re still in pre-release for the v2.1.0 cycle, but getting quite stable, and updates are frequently issued. The tool will help you with refactoring your code and renaming variables, and its static code analysis feature will pick up all these issues - e.g. you can remove all type-hinted literals in the project with a single click."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "edited": false, "score": 0, "creation_date": 1507742536, "post_id": 46693893, "comment_id": 80335959, "body": "That&#39;s right, Mat&#39;s Mug!  We&#39;ve met before here, and I remember Rubberduck.  I will re-check it out.  We only use the excel &quot;IDE&quot; here, is there a way to integrate Rubberduck into excel?  If I recall the IDE may have been the reason I didn&#39;t persue it further."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507742565, "post_id": 46693893, "comment_id": 80335978, "body": "Oh Lordy, I am not a proper programmer, as I&#39;m sure is apparent, and have rather become attached to Hungarian notation. Do I need to wean myself off it."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507742756, "post_id": 46693893, "comment_id": 80336083, "body": "@user4333011 the VBIDE is called &quot;VBE&quot;, short for &quot;Visual Basic Editor&quot; - it&#39;s the window you type the VBA code into, that pops up when you&#39;re in Excel and hit Alt+F11. Rubberduck adds functionality to the VBA Editor, the VBE, which is the <i>Integrated Development Environment</i> (IDE) for the VBA language."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "edited": false, "score": 0, "creation_date": 1507743199, "post_id": 46693893, "comment_id": 80336312, "body": "Okay, definitely worth re-checking out.  As you can tell I&#39;m learning this as I go!  Thanks for all of your help and information, you know a lot about VB!"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 4, "last_activity_date": 1507741704, "last_edit_date": 1507741704, "creation_date": 1507741489, "answer_id": 46693893, "question_id": 46693427, "link": "https://stackoverflow.com/questions/46693427/long-data-type-not-storing-long-value-in-excel-vba/46693893#46693893", "title": "Long Data Type Not Storing Long Value in Excel VBA", "body": "<blockquote>\n  <p><em>The reason for the exclamation points is due to the longs overflowing in the project I extrapolated the code from. If I remove them it doesn't change the result.</em></p>\n</blockquote>\n\n<p>Read what you said. Twice. You don't need these <em>type hints</em>. Any floating-point literal in VBA is implicitly a <code>Double</code> - by type-hinting it with a <code>!</code>, you're making them <code>Single</code>, which reduces the size and precision of the type you would otherwise be using.</p>\n\n<p>With a little bit of research on <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/data-type-summary\" rel=\"nofollow noreferrer\"><strong>VBA data types</strong></a>, you would have found that <code>Long</code> isn't able to hold floating-point values. A <code>Long</code> is a 32-bit integer, is all. So doing this:</p>\n\n<pre><code>Dim lAdder As Long\n</code></pre>\n\n<p>And then doing that:</p>\n\n<pre><code>MsgBox Format(lAdder, \"0.0\")\n</code></pre>\n\n<p>Makes no sense: the decimal portion of any integer value is always going to be 0.</p>\n\n<p>And <code>0.35 + 0.15</code> is always going to be <code>0.5</code>, which converted to a <code>Long</code> is always going to be 0 as well:</p>\n\n<pre><code>Debug.Print CLng(0.5) 'prints 0\n</code></pre>\n\n<p>And this is what you're doing here, implicitly:</p>\n\n<pre><code>lAdder = 0.35! + (0.15! / lFileCount)\n</code></pre>\n\n<p>You're taking a <code>Double</code>, and assigning it to a <code>Long</code>. The result will be a <code>Long</code>.</p>\n\n<p>Declare <code>lAdder As Double</code>, and problem solved.</p>\n\n<p>That said, drop that <code>l</code> prefix. It's useless, confusing, and reeks of <a href=\"https://www.joelonsoftware.com/2005/05/11/making-wrong-code-look-wrong/\" rel=\"nofollow noreferrer\"><strong>Systems Hungarian</strong></a> notation, which serves absolutely no purpose but bloating up your code and making everything harder to read than it should be.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4333011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2060, "favorite_count": 0, "accepted_answer_id": 46693641, "answer_count": 2, "score": 0, "last_activity_date": 1507741704, "creation_date": 1507739820, "question_id": 46693427, "link": "https://stackoverflow.com/questions/46693427/long-data-type-not-storing-long-value-in-excel-vba", "title": "Long Data Type Not Storing Long Value in Excel VBA", "body": "<p>When I execute the code below in excel VBA the first message box returns the long value correctly but when I store that value in a long data type and messagebox the long variable it returns 0 (?!).</p>\n\n<pre><code>Sub Test()\n\nDim lFileCount As Long\nDim lAdder As Long\n\nlFileCount = 1\n\nMsgBox 0.35! + (0.15! / lFileCount)\n\nlAdder = 0.35! + (0.15! / lFileCount)\nMsgBox lAdder\nMsgBox Format(lAdder, \"0.0\")\n\nEnd Sub\n</code></pre>\n\n<p>The reason for the exclamation points is due to the longs overflowing in the project I extrapolated the code from.  If I remove them it doesn't change the result.  I have no idea what could be causing this, my first thought is it has something to do with how the variable stores according to the order of operations, but I have no working solution.</p>\n\n<p>I'm perplexed, any help would be greatly appreciated!</p>\n"}, {"tags": ["excel", "type-conversion", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1507739374, "post_id": 46693239, "comment_id": 80334213, "body": "You need to use <code>.Cells()</code>, note the <code>s</code>."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1507739422, "post_id": 46693239, "comment_id": 80334243, "body": "Wow... not sure how I missed that syntax error! Thank you! :)"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1507739622, "post_id": 46693239, "comment_id": 80334365, "body": "@BruceWayne Do you know if it&#39;s possible to change the column width size with a method like this?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1507740811, "post_id": 46693239, "comment_id": 80335038, "body": "What do you mean - does your code not do it?"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1507743350, "post_id": 46693239, "comment_id": 80336387, "body": "My question is that if I use .Columns(1) would that still work; I tested it myself and it does work :)"}], "answers": [{"tags": [], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "is_accepted": true, "score": 0, "last_activity_date": 1507739463, "creation_date": 1507739463, "answer_id": 46693323, "question_id": 46693239, "link": "https://stackoverflow.com/questions/46693239/excel-cellx-y-conversion/46693323#46693323", "title": "Excel .cell(x,y) Conversion", "body": "<p>As per BruceWayne's comment, the issue was it must be .cells() and not .cell()</p>\n"}], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "closed_date": 1509703750, "accepted_answer_id": 46693323, "answer_count": 1, "score": 0, "last_activity_date": 1507739463, "creation_date": 1507739213, "last_edit_date": 1531161705, "question_id": 46693239, "link": "https://stackoverflow.com/questions/46693239/excel-cellx-y-conversion", "closed_reason": "Not suitable for this site", "title": "Excel .cell(x,y) Conversion", "body": "<p>I'm getting a compile error here saying \"Object doesn't support this property or method\" on line 4</p>\n\n<p>I'm guessing that the X in .cell(x,y) cannot be taken as an integer? What would I need to change this variable type to?</p>\n\n<pre><code>Private Function FinalizeTemplate(col As Integer)\n\n    With Worksheets(1)\n        .cell(col, 2).Value = \"A\"\n        .Columns(\"A\").ColumnWidth = 10.3\n        .cell(col + 1, 2).Value = \"B\"\n        .Columns(\"B\").ColumnWidth = 14\n        .cell(col + 3, 2).Value = \"C\"\n        .Columns(\"C\").ColumnWidth = 12.57\n        .cell(col + 4, 2).Value = \"Type\"\n        .Columns(\"D\").ColumnWidth = 8\n        .cell(col + 5, 2).Value = \"Valid/Invalid\"\n        .Columns(\"E\").ColumnWidth = 11.71\n    End With\n\nEnd Function\n</code></pre>\n"}, {"tags": ["mysql", "vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1507739133, "post_id": 46693158, "comment_id": 80334068, "body": "See <a href=\"https://msdn.microsoft.com/en-us/library/office/aa223845%28v=office.11%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">CopyFromRecordset</a>. There&#39;s two examples of different ways there."}, {"owner": {"reputation": 767, "user_id": 8411349, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/hdm06.jpg?s=128&g=1", "display_name": "PeterH", "link": "https://stackoverflow.com/users/8411349/peterh"}, "edited": false, "score": 0, "creation_date": 1507739136, "post_id": 46693158, "comment_id": 80334071, "body": "check out the solution I have used before it may provide a different approach to what you are trying  <a href=\"https://stackoverflow.com/a/45616221/8411349\">stackoverflow.com/a/45616221/8411349</a>"}, {"owner": {"reputation": 30756, "user_id": 5389997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d227900a17ca5c34bad6d2b27122c7f?s=128&d=identicon&r=PG&f=1", "display_name": "Shadow", "link": "https://stackoverflow.com/users/5389997/shadow"}, "edited": false, "score": 0, "creation_date": 1507739792, "post_id": 46693158, "comment_id": 80334458, "body": "The duplicate topics demonstrate different methods for displaying data in a worksheet from  an ADODB recordset. That the underlying database is not MySQL in those questions is irrelevant from this question&#39;s point of view."}], "owner": {"reputation": 3, "user_id": 8760063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b24e8f695e3d27728e5efe74b8d5effa?s=128&d=identicon&r=PG&f=1", "display_name": "NJQ", "link": "https://stackoverflow.com/users/8760063/njq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "closed_date": 1507739521, "answer_count": 0, "score": 0, "last_activity_date": 1507739713, "creation_date": 1507738963, "question_id": 46693158, "link": "https://stackoverflow.com/questions/46693158/returning-data-into-excel-from-mysql-using-excel-cell-data-as-parameter", "closed_reason": "Duplicate", "title": "Returning data into Excel from MySQL using Excel cell data as parameter", "body": "<p>I'm trying to return a data value from MySQL into a cell in Excel. There will only be a single row returned from SQL as the Where clause if against the Primary Key.</p>\n\n<p>I can get the SQL to execute but don't know how to push the returned value into the Excel cell.</p>\n\n<p>Sheet1 Cell C2 contains a postcode the a user can enter. I want to return a value of ABC from the database based upon the postcode into cell C5. </p>\n\n<p>Here's my code:</p>\n\n<pre><code>Sub GetABCForPostcode()\n\nDim cn As ADODB.Connection\nDim rs As ADODB.Recordset\n\nt = \"table1\"\niParam1 = Sheets(\"Sheet1\").Range(\"$C$2\").Value\n\nstrCon = \"Driver={MySQL ODBC 5.3 ANSI Driver};DATABASE=world;UID=root;PWD=MyPassword\"\nSet cn = CreateObject(\"ADODB.Connection\")\ncn.Open strCon\nSet rs = CreateObject(\"adodb.recordset\")\n\nrs.Open \"SELECT abc FROM \" &amp; t &amp; \" WHERE postcode = '\" &amp; iParam1 &amp; \"'\", cn\n\nEnd Sub\n</code></pre>\n\n<p>The SQL works and doesn't return any errors but I don't know how to get the returned value into cell C5???  Any ideas welcome.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4700216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f3a03a55674c554179df908a8ba2ff4?s=128&d=identicon&r=PG&f=1", "display_name": "SK7324", "link": "https://stackoverflow.com/users/4700216/sk7324"}, "edited": false, "score": 0, "creation_date": 1507740818, "post_id": 46693523, "comment_id": 80335046, "body": "Hi Mat, Thank you for your help. I tried using the code you shared above, still no success. Also, the code did not break. I noticed that when I manually select this column in excel and use &quot;Convert Text to Columns Wizard&quot; i.e. Alt + D + E + N + N + F shortcut, then the cells which are referencing column AQ in their formulas works fine and values gets populated as expected."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 21, "user_id": 4700216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f3a03a55674c554179df908a8ba2ff4?s=128&d=identicon&r=PG&f=1", "display_name": "SK7324", "link": "https://stackoverflow.com/users/4700216/sk7324"}, "edited": false, "score": 1, "creation_date": 1507741029, "post_id": 46693523, "comment_id": 80335177, "body": "I&#39;ve no idea where the &quot;convert text to columns&quot; comes into play here. Your question makes no mention of what the data is looking like, this answer assumes <code>rRange</code> contains one set of values that are usable as numbers. People that aren&#39;t looking at your screen can&#39;t guess what your data looks like."}, {"owner": {"reputation": 21, "user_id": 4700216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f3a03a55674c554179df908a8ba2ff4?s=128&d=identicon&r=PG&f=1", "display_name": "SK7324", "link": "https://stackoverflow.com/users/4700216/sk7324"}, "edited": false, "score": 0, "creation_date": 1507792665, "post_id": 46693523, "comment_id": 80354090, "body": "The format of &#39;rRange&#39; is text and i am trying to convert it to number. Thanks for your help :)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1507740141, "creation_date": 1507740141, "answer_id": 46693523, "question_id": 46693085, "link": "https://stackoverflow.com/questions/46693085/change-data-type-of-a-column-from-text-to-number/46693523#46693523", "title": "Change data type of a column from Text to Number", "body": "<p>Try setting the <code>NumberFormat</code> to a numeric format before running that loop.</p>\n\n<pre><code>Set rRange = ActiveSheet.Range(\"AQ2:AQ\" &amp; Rowcount)\nrRange.NumberFormat = \"#,##0\" ' anything but \"@\" / text\n\nFor Each rCell In rRange.Cells\n    Debug.Assert IsNumeric(rCell.Value) 'will break if not true\n    rCell.Value = rCell.Value * 1\nNext rCell\n</code></pre>\n\n<p>I added that <code>Assert</code> call to break execution if an error is ever encountered; if <code>rRange</code> contains any cell errors, <code>rCell.Value * 1</code> will raise a <em>type mismatch</em> run-time error.</p>\n\n<p>Alternatively you could just skip error cells, if error cells are supposed to be expected:</p>\n\n<pre><code>For Each rCell In rRange.Cells\n    If Not IsError(rCell.Value) Then\n        rCell.Value = rCell.Value * 1\n    End If\nNext rCell\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4700216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f3a03a55674c554179df908a8ba2ff4?s=128&d=identicon&r=PG&f=1", "display_name": "SK7324", "link": "https://stackoverflow.com/users/4700216/sk7324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507740141, "creation_date": 1507738730, "last_edit_date": 1531164843, "question_id": 46693085, "link": "https://stackoverflow.com/questions/46693085/change-data-type-of-a-column-from-text-to-number", "title": "Change data type of a column from Text to Number", "body": "<p>I need to update the data type of a column from Text to Number so that I can use it to perform further calculations. The below code is not working for me. Could you please suggest a workaround to this problem?</p>\n\n<pre><code>Sub ConvertTextToNumber()\n\n    Dim rRange As Range\n    Dim rCell As Range\n    Dim Rowcount As Long\n\n\n    Worksheets(\"Input\").Select\n    Rowcount = Application.CountA(Range(\"C:C\"))\n    Set rRange = ActiveSheet.Range(\"AQ2:AQ\" &amp; Rowcount)\n\n    For Each rCell In rRange.Cells\n\n        rCell.Value = rCell.Value * 1\n\n    Next rCell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "edited": false, "score": 0, "creation_date": 1507739010, "post_id": 46693065, "comment_id": 80334003, "body": "Is there always a blank row between two companies?"}, {"owner": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "reply_to_user": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "edited": false, "score": 0, "creation_date": 1507739109, "post_id": 46693065, "comment_id": 80334053, "body": "Yes there is, the format is the same each time the report is generated.  All the data is in columns A &amp; B and there is a blank row between each company."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1507739278, "post_id": 46693065, "comment_id": 80334159, "body": "Maybe use <code>SUMIF</code> rather than <code>SUM</code> if it&#39;s dependent on the company name."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1507739509, "post_id": 46693225, "comment_id": 80334293, "body": "That worked very well!  thank you.  I am wondering (and I will work on this) how would I incorporate replicating the company name beside the final sum as well as deleting individual amounts that make up the sum?  Lines 3-5 in what I have written.  Thanks again, this gives me a lot to work with."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1507739672, "post_id": 46693225, "comment_id": 80334391, "body": "If I have understood you correctly, the amended code above should do what you want."}, {"owner": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1507739795, "post_id": 46693225, "comment_id": 80334459, "body": "yes, it gets to the issue I have been hung up on, but I&#39;m still trying to achieve the final format of Company A 2053.73 and below that Company B 3571.34 with the numbers that went into those sums deleted.  I&#39;m trying to merge your suggestion with my initial post but I am getting a range error"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1507740005, "post_id": 46693225, "comment_id": 80334575, "body": "I mocked up a small example and that&#39;s what I got. What is not working for you? I&#39;m assuming you want the company name and the sum in different cells."}, {"owner": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1507740274, "post_id": 46693225, "comment_id": 80334731, "body": "Ok, I missed the update you did.  This works perfectly!!  Thank you so much.  It really helps seeing the correct version of what I was trying to do."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1507740712, "post_id": 46693225, "comment_id": 80334965, "body": "OK, so does it work now?  The results I got tallied with your screenshot."}, {"owner": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 1, "creation_date": 1507740793, "post_id": 46693225, "comment_id": 80335024, "body": "Yes, working very well.  Thanks for your help.  You solved in minutes what I&#39;ve been fighting with all morning and into the afternoon."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1507740890, "post_id": 46693225, "comment_id": 80335105, "body": "If you can understand why it works - and I can explain it - then next time you probably won&#39;t need us."}, {"owner": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1507741090, "post_id": 46693225, "comment_id": 80335211, "body": "That would be ideal, but I don&#39;t know if it will be reality.  I suspected I would need a loop, but searching on line (youtube and general searches) my initial bit seemed the way to go.  I&#39;ve not encounter .Areas before, that is completely new to me."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1507741268, "post_id": 46693225, "comment_id": 80335303, "body": "Each area is a contiguous block of data i.e.bounded by a space so that way it picks up the values of each company. It loops through each area and in the cell after the last cell of the area (the blank cell at the end) it puts the sum of the cells in the area, then copies the company name from the cell to the left of the first cell in the area, and finally it deletes each row in the area."}, {"owner": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1507741674, "post_id": 46693225, "comment_id": 80335519, "body": "Ok, thanks again.  I tried the discussion/chat link as I would like to ask more questions but it is not opening?  I don&#39;t want to get banned so I&#39;ll end with this."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 0, "creation_date": 1507741943, "post_id": 46693225, "comment_id": 80335637, "body": "Ha, don&#39;t worry don&#39;t think you&#39;ll be banned. You&#39;re ahead of me anyway, I can&#39;t see the link. Usually a message appears once the discussion reaches a certain length."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1507739656, "last_edit_date": 1507739656, "creation_date": 1507739157, "answer_id": 46693225, "question_id": 46693065, "link": "https://stackoverflow.com/questions/46693065/skip-a-row-start-sum-process-again/46693225#46693225", "title": "Skip a row, start sum process again", "body": "<p>Try this</p>\n\n<pre><code>Sub x()\n\nDim r As Range\n\nFor Each r In Columns(2).SpecialCells(xlCellTypeConstants).Areas\n    r(r.Count + 1).Value = Application.Sum(r)\n    r(r.Count + 1).Offset(, -1).Value = r(1).Offset(, -1).Value\n    r.EntireRow.Delete shift:=xlUp\nNext r\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "edited": false, "score": 1, "creation_date": 1507739612, "post_id": 46693306, "comment_id": 80334359, "body": "Thanks for this, I will consider it.  I am trying to go further with the VBA side of things, but this looks feasible."}], "tags": [], "owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1507739428, "creation_date": 1507739428, "answer_id": 46693306, "question_id": 46693065, "link": "https://stackoverflow.com/questions/46693065/skip-a-row-start-sum-process-again/46693306#46693306", "title": "Skip a row, start sum process again", "body": "<p>You can also try this non VBA approach. Enter this formula <code>=IF(A1&lt;&gt;\"\",SUM(OFFSET(B1,0,0,MIN(IF(B1:B80=\"\",ROW(B1:B80))))),\"\")</code> in cell <code>C1</code> to sum all values before blank row. drag formula to the bottom of your values. Since it is an array formula, you must enter it using CTRL+SHIFT+ENTER. You can then filter out blank values in column <code>A</code> to get your result.</p>\n\n<p><a href=\"https://i.stack.imgur.com/82ID1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/82ID1.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 45, "user_id": 7710797, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d1e9c689311e1325e2c4b7c57139ff7e?s=128&d=identicon&r=PG&f=1", "display_name": "DHPA", "link": "https://stackoverflow.com/users/7710797/dhpa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 46693225, "answer_count": 2, "score": 1, "last_activity_date": 1507740206, "creation_date": 1507738633, "last_edit_date": 1531161705, "question_id": 46693065, "link": "https://stackoverflow.com/questions/46693065/skip-a-row-start-sum-process-again", "title": "Skip a row, start sum process again", "body": "<p>I have a report generated from a program that opens in excel similar to the image below</p>\n\n<p><img src=\"https://i.stack.imgur.com/domzv.jpg\" alt=\"spreadsheet\"></p>\n\n<p>I have been using this code to sum the amounts:</p>\n\n<pre><code>Sub SumTotals()\n\nlastrow = Sheets(\"sheet1\").Cells(Rows.Count, 2).End(xlUp).Row\nRange(\"b\" &amp; lastrow + 1) = WorksheetFunction.Sum(Sheets(\"sheet1\").Range(\"b2:b\" &amp; lastrow))\nRange(\"a\" &amp; lastrow + 1) = Cells(1, 1)\nRange(\"a1:b\" &amp; lastrow).Select\nSelection.Delete Shift:=xlUp\n\nEnd Sub\n</code></pre>\n\n<p>The issue I am running into is that the code sums both company A and company B and the ends up </p>\n\n<blockquote>\n  <p>Company A 5,625.07</p>\n</blockquote>\n\n<p>What I am trying to accomplish is</p>\n\n<blockquote>\n  <p>Company A 2,053.73</p>\n  \n  <p>Company B 3,571.34</p>\n</blockquote>\n\n<p>When I get these reports there is generally 100 + companies so if I can speed up the process it would be very beneficially.  </p>\n\n<p>I suspect the first line of code is the problem</p>\n\n<pre><code>lastrow = Sheets(\"sheet1\").Cells(Rows.Count, 2).End(xlUp).Row\n</code></pre>\n\n<p>As this is placing the end at cell <code>B8</code> instead of <code>B3</code>.  I am trying to figure out how to sum the first column of numbers until the first blank row, and then carry on to the numbers below and carry out the same process.  Any suggestions are appreciated. </p>\n\n<p>ideal end result\n<a href=\"https://i.stack.imgur.com/7DFJS.jpg\" rel=\"nofollow noreferrer\">Ideal result</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1507737510, "post_id": 46692674, "comment_id": 80333137, "body": "Try <code>Path = &quot;%USERPROFILE%\\Documents\\Phase Transfer\\Test\\&quot;</code> but it may depend on your windows version and that has no error control to ensure that the path exists.."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "edited": false, "score": 1, "creation_date": 1507737526, "post_id": 46692674, "comment_id": 80333147, "body": "<code>Set wb = ActiveWorkbook</code> probably"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1507737665, "post_id": 46692674, "comment_id": 80333237, "body": "You would be better off copying the desired worksheet to no location. This creates a new workbook with the copied worksheet. Then use <code>activeworkbook.saveas ....</code>. Easier than deleting all other worksheets."}, {"owner": {"reputation": 1, "user_id": 8760083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3182c28baf6dcff1cc5307b8f2559684?s=128&d=identicon&r=PG&f=1", "display_name": "FuzzyLookup", "link": "https://stackoverflow.com/users/8760083/fuzzylookup"}, "edited": false, "score": 0, "creation_date": 1507799196, "post_id": 46692674, "comment_id": 80357855, "body": "Thanks. I did try that but it caused my data validation to stop working so I found this to be the better solution in this scenario."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507739179, "post_id": 46692807, "comment_id": 80334098, "body": "Upvoted for the nice explanation of the error, but it appears OP wants to work against <code>ThisWorkbook</code>, which isn&#39;t necessarily the <code>ActiveWorkbook</code> - hence <code>wb</code> isn&#39;t even needed."}, {"owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507739553, "post_id": 46692807, "comment_id": 80334321, "body": "@Mat&#39;sMug agreed. <code>wb</code> may just be to save keystrokes or created by habit."}], "tags": [], "owner": {"reputation": 1635, "user_id": 5224021, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/37c6e44eb453915965b37dcc4653c3cf?s=128&d=identicon&r=PG&f=1", "display_name": "interesting-name-here", "link": "https://stackoverflow.com/users/5224021/interesting-name-here"}, "is_accepted": false, "score": 2, "last_activity_date": 1507739568, "last_edit_date": 1507739568, "creation_date": 1507737727, "answer_id": 46692807, "question_id": 46692674, "link": "https://stackoverflow.com/questions/46692674/how-do-i-ensure-the-vba-code-saves-the-workbook-to-the-file-path-declared/46692807#46692807", "title": "How do I ensure the VBA code saves the workbook to the file path declared?", "body": "<p>Look at your error message: <strong>Object variable</strong> or With block variable <strong>not set</strong></p>\n\n<p>It looks like you aren't able to save because you never instantiate your <code>wb</code> variable. Therefore <code>wb = Nothing</code>. You can't perform <code>SaveAs</code> on nothing. Try adding <code>Set wb = ThisWorkbook</code> below your declarations like so:</p>\n\n<pre><code>'other code\nDim ws As Worksheet\nDim wb As Workbook\nDim sheetname As Variant\nDim ddl As Variant\n\nSet wb = ThisWorkbook\nddl = \"PhaseTransferDropDowns\"\n'other code\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": false, "score": 1, "last_activity_date": 1507739250, "last_edit_date": 1507739250, "creation_date": 1507738184, "answer_id": 46692927, "question_id": 46692674, "link": "https://stackoverflow.com/questions/46692674/how-do-i-ensure-the-vba-code-saves-the-workbook-to-the-file-path-declared/46692927#46692927", "title": "How do I ensure the VBA code saves the workbook to the file path declared?", "body": "<p>The <code>wb</code> object variable is never assigned to anything other than <code>Nothing</code>. But anyway you can use <code>ThisWorkook</code>, if you mean to save and close the workbook that contains the running code:</p>\n\n<pre><code>With ThisWorkbook\n     .SaveAs Path &amp; ws.Name &amp; \".xlsx\", Excel.XlFileFormat.xlOpenXMLWorkbook\n     .Close\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8760083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3182c28baf6dcff1cc5307b8f2559684?s=128&d=identicon&r=PG&f=1", "display_name": "FuzzyLookup", "link": "https://stackoverflow.com/users/8760083/fuzzylookup"}, "is_accepted": false, "score": 0, "last_activity_date": 1507797780, "creation_date": 1507797780, "answer_id": 46705107, "question_id": 46692674, "link": "https://stackoverflow.com/questions/46692674/how-do-i-ensure-the-vba-code-saves-the-workbook-to-the-file-path-declared/46705107#46705107", "title": "How do I ensure the VBA code saves the workbook to the file path declared?", "body": "<p>Thanks everyone!</p>\n\n<p>It seems that I needed to set the workbook properly (<code>Set wb = ThisWorkbook</code>).</p>\n\n<p>I also needed to change <code>ws.name</code> into <code>sheetname</code>.</p>\n\n<p>This is the code that worked at the end:</p>\n\n<pre><code>Sub SeperateWB2()\n\nDim ws As Worksheet\nDim wb As Workbook\nDim sheetname As Variant\nDim ddl As Variant\n\nSet wb = ThisWorkbook\n\nddl = \"PhaseTransferDropDowns\"\nsheetname = InputBox(\"Please specify sheet name:\")\nPath = \"C:\\My Documents\\Phase Transfer\\Test\\\"\n\nFor Each ws In ThisWorkbook.Worksheets 'SetVersions\n    If Not ws.Name = sheetname And Not ws.Name = ddl Then\n    Application.DisplayAlerts = False\n        ws.Delete\n    End If\nNext ws\n\nwb.SaveAs Path &amp; sheetname &amp; \".xlsx\", Excel.XlFileFormat.xlOpenXMLWorkbook\n        'wb.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8760083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3182c28baf6dcff1cc5307b8f2559684?s=128&d=identicon&r=PG&f=1", "display_name": "FuzzyLookup", "link": "https://stackoverflow.com/users/8760083/fuzzylookup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1507797780, "creation_date": 1507737248, "question_id": 46692674, "link": "https://stackoverflow.com/questions/46692674/how-do-i-ensure-the-vba-code-saves-the-workbook-to-the-file-path-declared", "title": "How do I ensure the VBA code saves the workbook to the file path declared?", "body": "<p>The following is my code in an attempt to delete a number of sheets in order to save a workbook with specific worksheets only:</p>\n\n<pre><code>Sub SeperateWB2()\n\nDim ws As Worksheet\nDim wb As Workbook\nDim sheetname As Variant\nDim ddl As Variant\n\nddl = \"PhaseTransferDropDowns\"\nsheetname = InputBox(\"Please specify sheet name:\")\nPath = \"C:\\My Documents\\Phase Transfer\\Test\\\"\n\nFor Each ws In ThisWorkbook.Worksheets 'SetVersions\n    If Not ws.Name = sheetname And Not ws.Name = ddl Then\n    Application.DisplayAlerts = False\n        ws.Delete\n    End If\nNext ws\n\nwb.SaveAs Path &amp; ws.Name &amp; \".xlsx\", Excel.XlFileFormat.xlOpenXMLWorkbook\n        wb.Close\n        Set wb = Nothing\nEnd Sub\n</code></pre>\n\n<p>The loop works fine but it refuses to save the workbook on the path I have specified.</p>\n\n<p>I get this message: \"Runtime error 91: Object variable or With block variable not set\"</p>\n\n<p>Can anyone help?</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2377, "user_id": 690141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4839c9cedda452fcd85a78978044b45c?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy Smith", "link": "https://stackoverflow.com/users/690141/jimmy-smith"}, "edited": false, "score": 1, "creation_date": 1507737233, "post_id": 46692563, "comment_id": 80332963, "body": "Could you post the code where the error is occurring?  Also, is the macro security higher on the other machine you&#39;re testing it on?"}, {"owner": {"reputation": 355, "user_id": 994679, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/aa5f395493c1df009c4e05c8b6cbb891?s=128&d=identicon&r=PG", "display_name": "VB Did Nothing Wrong", "link": "https://stackoverflow.com/users/994679/vb-did-nothing-wrong"}, "edited": false, "score": 0, "creation_date": 1507737363, "post_id": 46692563, "comment_id": 80333049, "body": "It might be that the old macros were writing to a location that was unlocked, but the new macro is writing to a location that is locked"}, {"owner": {"reputation": 1, "user_id": 8760035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11697a9f1b6c81f5e1a4f5dfdc59c6e8?s=128&d=identicon&r=PG&f=1", "display_name": "bex172", "link": "https://stackoverflow.com/users/8760035/bex172"}, "edited": false, "score": 0, "creation_date": 1507738795, "post_id": 46692563, "comment_id": 80333876, "body": "Finally got it! I just changed the passwords and any information with names and stuff, but the rest of the code is the original. Thanks!"}, {"owner": {"reputation": 1, "user_id": 8760035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11697a9f1b6c81f5e1a4f5dfdc59c6e8?s=128&d=identicon&r=PG&f=1", "display_name": "bex172", "link": "https://stackoverflow.com/users/8760035/bex172"}, "edited": false, "score": 0, "creation_date": 1507738935, "post_id": 46692563, "comment_id": 80333956, "body": "I&#39;m not sure about the macro security of the other machines. This form is supposed to be shared through our whole office. I know if I say &#39;enable macros&#39; on the other computers it will show it, but I&#39;ll get the error code when I try to run it."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8760035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11697a9f1b6c81f5e1a4f5dfdc59c6e8?s=128&d=identicon&r=PG&f=1", "display_name": "bex172", "link": "https://stackoverflow.com/users/8760035/bex172"}, "edited": false, "score": 0, "creation_date": 1508163218, "post_id": 46706479, "comment_id": 80490417, "body": "Thank you for posting and the code! Sorry if my question wasn&#39;t clear, I&#39;ll try my best to explain. This code (with the exception of the header macros) was not written by me, it was written by someone else. I am trying to tweak the code so the headers will change but on other people&#39;s computers it will not work. I get &#39;the requested member does not exist&#39; message. My question is, what am I doing wrong and how do I change it so it will work on all the computers in the office?"}, {"owner": {"reputation": 1, "user_id": 8760035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11697a9f1b6c81f5e1a4f5dfdc59c6e8?s=128&d=identicon&r=PG&f=1", "display_name": "bex172", "link": "https://stackoverflow.com/users/8760035/bex172"}, "edited": false, "score": 0, "creation_date": 1508164126, "post_id": 46706479, "comment_id": 80491060, "body": "So I tried the code on a blank document, and the drop-down menu works on another computer, but with the header macros I get the &#39;requested member&#39; error. In debug, it points to this:"}, {"owner": {"reputation": 1, "user_id": 8760035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11697a9f1b6c81f5e1a4f5dfdc59c6e8?s=128&d=identicon&r=PG&f=1", "display_name": "bex172", "link": "https://stackoverflow.com/users/8760035/bex172"}, "edited": false, "score": 0, "creation_date": 1508164166, "post_id": 46706479, "comment_id": 80491090, "body": "Application.Templates(BlockFile).BuildingBlockEntries(BlockI&zwnj;&#8203;D).Insert _                 Where:=Selection.Range, _                 RichText:=True"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1507801731, "creation_date": 1507801731, "answer_id": 46706479, "question_id": 46692563, "link": "https://stackoverflow.com/questions/46692563/vba-coding-in-word-2013/46706479#46706479", "title": "VBA coding in Word 2013", "body": "<p>I found your code a little unwieldy and understand that it poses a problem for you. The abbreviated version below should be easier to understand and therefore easier for you to manage once you acquaint yourself with its own peculiarities. Note that I tested everything except the actual extraction and insertion of the building block, since you said it is working.</p>\n\n<pre><code>Option Explicit\n\n    ' declare the name (so as to eliminate typos)\n    Const CmdName As String = \"Select Location\"\n\nSub AutoNew()\n    ' 12 Oct 2017\n    SetCommandBar\nEnd Sub\n\nSub AutoOpen()\n    ' 12 Oct 2017\n    SetCommandBar\nEnd Sub\n\nSub SetCommandBar()\n    ' 12 Oct 2017\n\n    Dim MyBar As CommandBar\n    Dim MyCtl As CommandBarControl\n    Dim MyList() As String\n    Dim Cmd As CommandBar\n    Dim i As Integer\n\n    ' delete the existing (so that you can modify it)\n    For Each Cmd In CommandBars\n        If Cmd.Name = CmdName Then\n            Cmd.Delete\n            Exit For\n        End If\n    Next Cmd\n\n    ' in Word &gt;= 2007 the commandbar will be displayed\n    ' in the ribbon's Add-ins tab\n    Set MyBar = CommandBars.Add(Name:=CmdName, _\n                                Position:=msoBarFloating, _\n                                MenuBar:=True, _\n                                Temporary:=True)\n    Set MyCtl = CommandBars(CmdName).Controls.Add( _\n                                Type:=msoControlDropdown, _\n                                Before:=1)\n\n    ' Names must match Building Block names (without \" Header\")\n    MyList = Split(\" South Portland, Bangor, Presque Isle\", \",\")\n    With MyCtl\n        .Caption = \"Select Office Location\"\n        .Style = msoComboLabel\n        For i = 0 To UBound(MyList)\n            .AddItem MyList(i)\n        Next i\n        .ListIndex = 1\n        .OnAction = \"SetHeader\"\n    End With\n    CommandBars(CmdName).Visible = True\nEnd Sub\n\nSub SetHeader()\n    ' 12 Oct 2017\n\n    Const BlockFile As String = \"C:\\Users\\bex172\\AppData\\Roaming\\Microsoft\\\" &amp; _\n                                \"Document Building Blocks\\1033\\15\\\" &amp; _\n                                \"Building Blocks.dotx\"\n    Dim BlockID As String\n\n    SetFormLock False               ' not needed if the document isn't locked\n    With ActiveWindow\n        If .View.SplitSpecial &lt;&gt; wdPaneNone Then .Panes(2).Close\n        With .ActivePane.View\n            If .Type = wdNormalView Or .Type = wdOutlineView Then\n                .Type = wdPrintView\n            End If\n            .SeekView = wdSeekCurrentPageHeader\n        End With\n    End With\n\n    BlockID = Trim(CommandBars(CmdName).Controls(1).Text) &amp; \" Header\"\n    Templates.LoadBuildingBlocks\n    Application.Templates(BlockFile).BuildingBlockEntries(BlockID).Insert _\n                Where:=Selection.Range, _\n                RichText:=True\n    SetFormLock True                ' not needed if the document isn't to be locked\nEnd Sub\n\nSub SetFormLock(ByVal FormLock As Boolean)\n    ' 12 Oct 2017\n    ' call this procedure with either \"True\" or \"False\" as argument\n    ' to either lock or unlock the form.\n\n    ' The same password is used for unlocking and locking.\n    ' MAKE SURE THE DOCUMENT IS UNLOCKED before changing the password!\n    Const Password As String = \"\"\n\n    Dim Doc As Document\n\n    Set Doc = ActiveDocument\n    With Doc\n        If .ProtectionType = wdNoProtection Then\n            If FormLock Then\n                 ' you can't set the protection while any other part of the document is active\n                ActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument\n\n               ' you may wish to specify another type of protection:\n                ' this code protects all except FormFields\n                .Protect Type:=WdProtectionType.wdAllowOnlyFormFields, _\n                         NoReset:=True, _\n                         Password:=Password, _\n                         UseIRM:=False, _\n                         EnforceStyleLock:=False\n            End If\n        Else\n            If Not FormLock Then .Unprotect Password\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<p>Your question didn't allow full understanding of your problem. It might have to do with the location of the code itself or with the protection. By making the code more transparent I hope that you will either be able to eliminate the problem or find the right question to ask.</p>\n"}], "owner": {"reputation": 1, "user_id": 8760035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11697a9f1b6c81f5e1a4f5dfdc59c6e8?s=128&d=identicon&r=PG&f=1", "display_name": "bex172", "link": "https://stackoverflow.com/users/8760035/bex172"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 393, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507801731, "creation_date": 1507736928, "last_edit_date": 1507747146, "question_id": 46692563, "link": "https://stackoverflow.com/questions/46692563/vba-coding-in-word-2013", "title": "VBA coding in Word 2013", "body": "<p>I am having an issue regarding VBA in Word 2013. I have limited experience with coding, and macros are a bit of new territory for me.</p>\n\n<p>I have a successful VBA code from a worker that no longer works in my office, and this code allows for a drop down menu in the office forms, allowing the user to choose their location and the footer changes the text address of the office in a string.</p>\n\n<p>What I have been trying to do is to tweak this code so that on choosing the location, instead of showing text at the bottom of the page, the header template will change. I have successfully recorded the macros so it will do what I want on my computer, but when I try to share it with others, a few things happen. The drop down menu doesn't appear, then I have to put in the Developer tab. After that I have to unlock the document each time I want to run the macro (the old documents did not require this even though the old documents are also locked), then I get the error code saying the requested member does not exist, pointing to my recorded macro.</p>\n\n<p>I'm sure I am doing something wrong but I'm unsure what that is. Some help would be greatly appreciated.</p>\n\n<pre><code>Option Explicit\nSub AutoNew()\nDim Mybar As CommandBar\nDim myControl As CommandBarComboBox\nDim cmd As CommandBar\nDim cmdyes As Integer\ncmdyes = 0\n\nFor Each cmd In CommandBars\nIf cmd.Name = \"Select Location\" Then\ncmdyes = 1\nExit For\nElse\nEnd If\nNext\n\nIf cmdyes = 1 Then\nCommandBars(\"Select Location\").Visible = True\nElse\nSet Mybar = CommandBars _\n.Add(Name:=\"Select Location\", Position:=msoBarFloating, _\nTemporary:=False)\nSet myControl = CommandBars(\"Select Location\").Controls _\n.Add(Type:=msoControlDropdown, Before:=1)\nWith myControl\n.AddItem \" South Portland\"\n.AddItem \" Bangor\"\n.AddItem \" Presque Isle\"\n.ListIndex = 1\n.Caption = \"Select Office Location\"\n.Style = msoComboLabel\n.BeginGroup = True\n.OnAction = \"processSelection\"\n.Tag = \"AddresSelect\"\n    End With\nEnd If\n\nCommandBars(\"Select Location\").Visible = True\n\nIf ActiveDocument.ProtectionType = wdAllowOnlyFormFields = False Then\nActiveDocument.Protect Type:=wdAllowOnlyFormFields, NoReset:=True, \nPassword:=\"password\"\n' ActiveDocument.Protect Type:=wdAllowOnlyFormFields, NoReset:=True, \nPassword:=\"\"\nEnd If\nEnd Sub\nSub AutoOpen()\nDim Mybar As CommandBar\nDim myControl As CommandBarComboBox\nDim cmd As CommandBar\nDim cmdyes As Integer\ncmdyes = 0\n\nFor Each cmd In CommandBars\nIf cmd.Name = \"Select Location\" Then\ncmdyes = 1\nExit For\nElse\nEnd If\nNext\n\nIf cmdyes = 1 Then\nCommandBars(\"Select Location\").Visible = True\nElse\nSet Mybar = CommandBars _\n.Add(Name:=\"Select Location\", Position:=msoBarFloating, _\nTemporary:=False)\nSet myControl = CommandBars(\"Select Location\").Controls _\n.Add(Type:=msoControlDropdown, Before:=1)\nWith myControl\n.AddItem \" South Portland\"\n.AddItem \" Bangor\"\n.AddItem \" Presque Isle\"\n.ListIndex = 1\n.Caption = \"Select Office Location\"\n.Style = msoComboLabel\n.BeginGroup = True\n.OnAction = \"processSelection\"\n.Tag = \"AddresSelect\"\n    End With\n\nEnd If\n\nCommandBars(\"Select Location\").Visible = True\n\nIf ActiveDocument.ProtectionType = wdAllowOnlyFormFields = False Then\nActiveDocument.Protect Type:=wdAllowOnlyFormFields, NoReset:=True, \nPassword:=\"password\"\n' ActiveDocument.Protect Type:=wdAllowOnlyFormFields, NoReset:=True, \nPassword:=\"\"\nEnd If\nEnd Sub\nSub processSelection()\nDim userChoice As Long\nuserChoice = CommandBars(\"Select Location\").Controls(1).ListIndex\nSelect Case userChoice\n    Case 1\n        Call SoPortlandAddress\n    Case 2\n        Call BangorAddress\n    Case Else\n        Call PresqueIsleAddress\nEnd Select\nEnd Sub\nSub SoPortlandAddress()\n'\n' SoPortlandAddress Macro\n'\n'\nIf ActiveWindow.View.SplitSpecial &lt;&gt; wdPaneNone Then\n    ActiveWindow.Panes(2).Close\nEnd If\nIf ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _\n    ActivePane.View.Type = wdOutlineView Then\n    ActiveWindow.ActivePane.View.Type = wdPrintView\nEnd If\nActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader\nTemplates.LoadBuildingBlocks\nApplication.Templates( _\n    \"C:\\Users\\bex172\\AppData\\Roaming\\Microsoft\\Document Building \nBlocks\\1033\\15\\Building Blocks.dotx\" _\n    ).BuildingBlockEntries(\"South Portland Header\").Insert Where:=Selection. \n_\n    Range, RichText:=True\nActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument\n\n  If ActiveDocument.ProtectionType = wdAllowOnlyFormFields Then\nActiveDocument.Unprotect Password:=\"password\"\nEnd If\nIf ActiveDocument.ProtectionType = wdNoProtection Then\n  FormLock\nEnd If\nEnd Sub\n\nSub BangorAddress()\n'\n' BangorAddress Macro\n'\n'\nIf ActiveWindow.View.SplitSpecial &lt;&gt; wdPaneNone Then\n    ActiveWindow.Panes(2).Close\nEnd If\nIf ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _\n    ActivePane.View.Type = wdOutlineView Then\n    ActiveWindow.ActivePane.View.Type = wdPrintView\nEnd If\nActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader\nTemplates.LoadBuildingBlocks\nApplication.Templates( _\n    \"C:\\Users\\bex172\\AppData\\Roaming\\Microsoft\\Document Building \nBlocks\\1033\\15\\Building Blocks.dotx\" _\n    ).BuildingBlockEntries(\"Bangor Header\").Insert Where:=Selection.Range, _\n    RichText:=True\nActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument\n\nIf ActiveDocument.ProtectionType = wdAllowOnlyFormFields Then\nActiveDocument.Unprotect Password:=\"password\"\nEnd If\nIf ActiveDocument.ProtectionType = wdNoProtection Then\n  FormLock\nEnd If\nEnd Sub\n\nSub PresqueIsleAddress()\n'\n' PresqueIsleAddress Macro\n'\n'\nIf ActiveWindow.View.SplitSpecial &lt;&gt; wdPaneNone Then\n    ActiveWindow.Panes(2).Close\nEnd If\nIf ActiveWindow.ActivePane.View.Type = wdNormalView Or ActiveWindow. _\n    ActivePane.View.Type = wdOutlineView Then\n    ActiveWindow.ActivePane.View.Type = wdPrintView\nEnd If\nActiveWindow.ActivePane.View.SeekView = wdSeekCurrentPageHeader\nTemplates.LoadBuildingBlocks\nApplication.Templates( _\n    \"C:\\Users\\bex172\\AppData\\Roaming\\Microsoft\\Document Building \nBlocks\\1033\\15\\Building Blocks.dotx\" _\n    ).BuildingBlockEntries(\"Presque Isle Header\").Insert Where:=Selection. _\n    Range, RichText:=True\nActiveWindow.ActivePane.View.SeekView = wdSeekMainDocument\n\nIf ActiveDocument.ProtectionType = wdAllowOnlyFormFields Then\nActiveDocument.Unprotect Password:=\"password\"\nEnd If\nIf ActiveDocument.ProtectionType = wdNoProtection Then\n  FormLock\nEnd If\nEnd Sub\nSub FormLock()\n'\n' ToggleFormLock Macro\n' Macro created 1/27/2004 by name removed\n'\nIf ActiveDocument.ProtectionType = wdAllowOnlyFormFields = False Then\nActiveDocument.Protect Type:=wdAllowOnlyFormFields, NoReset:=True, \nPassword:=\"password\"\n 'if a password is used, add the line below after a space above\n 'Password:=\"myPassword\"\nElse\n\n\n 'if a password is used, add a comma after\n 'the last line and include the line below\n 'Password:=\"myPassword\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1507747505, "post_id": 46692351, "comment_id": 80338646, "body": "userResponse = Application.Dialogs(xlDialogSaveAs).Show(52)  will bring up the dialogbox with 52.xlsx as the file name.  The first argument of the dialogbox is file name.  52 as the second argument will force the XLSM file type.  I ran your code and it worked perfectly.  I&#39;m not sure if you need the error lines."}, {"owner": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "reply_to_user": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1507757306, "post_id": 46692351, "comment_id": 80343378, "body": "@mooseman the problem is that the next code starts to run as it exits that specific Sub and moves onto the next code which is &quot;Call Format_MIUL&quot;. How can I make it break from the entire code?"}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1507827508, "post_id": 46692351, "comment_id": 80376383, "body": "You mean you call this sub from another and want all code to stop when cancel is chosen?  That will take an overall design.  Maybe set up a global variable and set it if userResponse = False."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "edited": false, "score": 0, "creation_date": 1507739313, "post_id": 46692569, "comment_id": 80334173, "body": "I am a little bit confused. Are you saying to implement your first piece of code with the second piece of code in my OP?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "edited": false, "score": 0, "creation_date": 1507739680, "post_id": 46692569, "comment_id": 80334394, "body": "@CC268 Sorry about that; I was saying that (From the posted code) the triggered error on anything happening after the userResponse should trigger Exit Sub.  This would mean you don&#39;t need the If-statement after the file dialogue is visible.  As you have written (what I was trying to get to in the first part of my answer) was that the If statement is in sequence with the rest of the code, not happening if an error occurs."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1507747325, "post_id": 46692569, "comment_id": 80338539, "body": "Only problem is that the cancel button on the dialog box is not an error.  If there is any code between the userResponse line and the Cat: line it will process that code."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1507739819, "last_edit_date": 1507739819, "creation_date": 1507736933, "answer_id": 46692569, "question_id": 46692351, "link": "https://stackoverflow.com/questions/46692351/excel-vba-force-user-to-save-as-xlsm/46692569#46692569", "title": "Excel VBA: Force user to save as .xlsm", "body": "<p>You have this: </p>\n\n<pre><code>If FileDialog.Show = False Then\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>Which does not account for an error, simply recognizing a state.  You will want the Exit Sub to happen if there's an error only.</p>\n\n<hr>\n\n<p>This error handling could be implemented by replacing :</p>\n\n<pre><code>On Error Resume Next  \nuserResponse = Application.Dialogs(xlDialogSaveAs).Show(52) \nOn Error GoTo 0 \nIf userResponse = False Then\n    Exit Sub \nElse \nEnd If\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>On Error GoTo Cat  \nuserResponse = Application.Dialogs(xlDialogSaveAs).Show(52) \n\nCat: \n    Exit Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 7476274, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/ee964769913e1665cc9b7e36b81e05ca?s=128&d=identicon&r=PG&f=1", "display_name": "CC268", "link": "https://stackoverflow.com/users/7476274/cc268"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 587, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507747475, "creation_date": 1507736255, "last_edit_date": 1507747475, "question_id": 46692351, "link": "https://stackoverflow.com/questions/46692351/excel-vba-force-user-to-save-as-xlsm", "title": "Excel VBA: Force user to save as .xlsm", "body": "<p>I have a series of macros that automates much of a process. I would like to distribute this to my coworkers via Excel Add-In and I have one piece of code I just can't seem to get right.</p>\n\n<p>Here is the \"master\" code (which works fine):</p>\n\n<pre><code>Option Explicit\n\nSub MIUL_Run_All()\n\nDim StartTime As Double\nDim SecondsElapsed As String\n\n'Remember time when macro starts\nStartTime = Timer\n\nCall OptimizeCode_Begin\n\nCall Save_As\nCall Format_MIUL\nCall Custom_Sort_MIUL\nCall Insert_Process_List\nCall Format_Process_List\n\nCall OptimizeCode_End\n\n'Determine how many seconds code took to run\nSecondsElapsed = Format((Timer - StartTime) / 86400, \"ss\")\n\n'Notify user in seconds\nMsgBox \"This code ran successfully in \" &amp; SecondsElapsed &amp; \" seconds\", \nvbInformation\n\nEnd Sub\n</code></pre>\n\n<p>The code that is giving me trouble is \"Save_As\". First thing I want the user to do is to save the file as a macro enabled file. Ideally, I want the code to do these things for the user:</p>\n\n<ol>\n<li>Force the user to save as .xlsm</li>\n<li>Provide the current file name in the Save As dialog box so they have a file name to already work with.</li>\n<li>If the CANCEL button is pressed it must stop the entire macro! </li>\n</ol>\n\n<p>I thought this would be a fairly trivial thing, but so far it has been the toughest part of my code.</p>\n\n<p>Here is what I have tried for the Save_As code:</p>\n\n<pre><code>Application.Dialogs(xlDialogSaveAs).Show , xlOpenXMLWorkbookMacroEnabled\n</code></pre>\n\n<p>This code is very simple, but it doesn't address the cancel button.</p>\n\n<pre><code>Dim userResponse As Boolean\n\nOn Error Resume Next  \nuserResponse = Application.Dialogs(xlDialogSaveAs).Show(52) \nOn Error GoTo 0 \nIf userResponse = False Then\nExit Sub \nElse \nEnd If\n</code></pre>\n\n<p>Again for some reason this doesn't address the cancel button.</p>\n\n<p>I have tried probably a half a dozen different things, most of which are similar to the above codes.</p>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": [".net", "vba", "excel", "com"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507736452, "post_id": 46692228, "comment_id": 80332427, "body": "Simple: Excel/Word doesn&#39;t even remotely get involved. It&#39;s the VBE&#39;s job, not the host application&#39;s."}, {"owner": {"reputation": 1945, "user_id": 29573, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/280be066f1979e3cdcdf5782d4863850?s=128&d=identicon&r=PG", "display_name": "Konrads", "link": "https://stackoverflow.com/users/29573/konrads"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507736952, "post_id": 46692228, "comment_id": 80332776, "body": "So how would VBE know what is accessible and what is not?"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1507737818, "post_id": 46692228, "comment_id": 80333320, "body": "Only a subset of the .NET classes are [ComVisible(true)].  Mostly the stuff that was in .NET 1.0, back when it was still important to get programmers to move on the .NET bandwagon and not force them to rewrite everything they had.  You&#39;ll have to create your own [ComVisible] wrapper."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1507738437, "post_id": 46692228, "comment_id": 80333679, "body": "@HansPassant I wrote my answer as an educated guess (having been toying with COM interop in Rubberduck for a few years), I&#39;d love it if you&#39;d let me know if I&#39;m guessing it right (heck, and steal that checkmark if you want)!"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1507738678, "post_id": 46692228, "comment_id": 80333800, "body": "It&#39;s fine, forgot to UV it, sorry."}, {"owner": {"reputation": 1945, "user_id": 29573, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/280be066f1979e3cdcdf5782d4863850?s=128&d=identicon&r=PG", "display_name": "Konrads", "link": "https://stackoverflow.com/users/29573/konrads"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1507754962, "post_id": 46692228, "comment_id": 80342348, "body": "@hans-passant that\u2019s very helpful. Is there a list of exposed .net classes? They aren\u2019t registered as progids, for example he System.Text seemingly isn\u2019t."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1507757743, "post_id": 46692228, "comment_id": 80343574, "body": "Just look at the type libraries (*.tlb) in the framework folder with OleView.exe&#39;s File &gt; View Typelib command."}], "answers": [{"comments": [{"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 3, "creation_date": 1507740265, "post_id": 46692642, "comment_id": 80334726, "body": "FWIW - <code>ProgId</code> is not strictly required for a <code>CreateObject</code> - a CLSID can be used in its place which can be helpful in some cases where a COM-compliant object don&#39;t have a <code>ProgID</code>. A good example is the <code>MSForms.DataObject</code> from MS Forms 2.0 Library which lacks a <code>ProgID</code>: <code>Set objData = CreateObject(&quot;New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}&quot;)</code>"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 3, "last_activity_date": 1507737144, "creation_date": 1507737144, "answer_id": 46692642, "question_id": 46692228, "link": "https://stackoverflow.com/questions/46692228/visual-basic-invoking-net-runtime/46692642#46692642", "title": "Visual Basic - invoking .net runtime", "body": "<p>The argument you specify when invoking <code>CreateObject</code> is not a <em>namespace</em>, it's a <code>ProgId</code> - a string COM uses to locate registered classes (and the library they're defined in, and where that library is located), in the Windows Registry.</p>\n\n<p>If there's no registered COM type with a <code>ProgId</code> value of <code>System.Management.Automation.Runspaces.RunspaceFactory</code>, then ActiveX can't create that object.</p>\n\n<p>If there's no COM type library for a namespace (i.e. the assembly isn't registered for COM interop), then you're trying to get COM to understand .NET/managed code, which it can't do.</p>\n\n<blockquote>\n  <p><em>What I don't understand is how Excel/Word determines which classes are exposed and which aren't</em></p>\n</blockquote>\n\n<p>Excel/Word/whatever host application has nothing to do with it, it's VBA's own runtime that loads the COM types, and it's the Windows Registry that contains the <code>ProgId</code> for everything that's registered.</p>\n\n<p>If you search your registry for <code>Scripting.Dictionary</code> under <code>HKEY_LOCAL_MACHINE\\SOFTWARE\\Classes\\CLSID</code>, you'll eventually find a key named <code>{EE09B103-97E0-11CF-978F-00A02463E06F}</code>, with a <code>ProgID</code> subkey having a value of <code>Scripting.Dictionary</code> and an <code>InprocServer32</code> subkey with a value of <code>C:\\Windows\\system32\\scrrun.dll</code>, and if the VBA runtime succeeds at creating an instance of the type with the specified <code>ProgId</code> in that type library, then the <code>CreateObject</code> call succeeds and returns the instance. Otherwise, it throws an error 429 and says \"ActiveX can't create object\".</p>\n"}], "owner": {"reputation": 1945, "user_id": 29573, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/280be066f1979e3cdcdf5782d4863850?s=128&d=identicon&r=PG", "display_name": "Konrads", "link": "https://stackoverflow.com/users/29573/konrads"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 46692642, "answer_count": 1, "score": 0, "last_activity_date": 1507737144, "creation_date": 1507735839, "last_edit_date": 1531164843, "question_id": 46692228, "link": "https://stackoverflow.com/questions/46692228/visual-basic-invoking-net-runtime", "title": "Visual Basic - invoking .net runtime", "body": "<p>I am trying to invoke objects from .net runtime from VBA (Word/Excel).\nThis works:\n<code>\noT = CreateObject(\"System.Text.UTF8Encoding\")\n</code>\nBut not this: \n<code>\nCreateObject(\"System.Management.Automation.Runspaces.RunspaceFactory\")\n</code>\nThe error is:\nRuntime error '429' ; ActiveX component can't create object</p>\n\n<p>What I don't understand is how Excel/Word determines which classes are exposed and which aren't</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1507735071, "post_id": 46691765, "comment_id": 80331468, "body": "Use <code>ROW(&#39;Sales Orders&#39;!R1)</code> not <code>ROW(&#39;Sales Orders&#39;!R[-1])</code>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1507735884, "post_id": 46691765, "comment_id": 80332055, "body": "@Rory , will build on you to be more informative for other readers, the [#] with RC notation indicates &quot;in respect to&quot;.  So If you&#39;re in cell B2 (R2C2), and want to reference cell A2 (R2C1), you would have in cell B2 =RC[-1]."}, {"owner": {"reputation": 1, "user_id": 8720958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bac00de2b1d36ca337ff0b33118d79?s=128&d=identicon&r=PG&f=1", "display_name": "Harwood95", "link": "https://stackoverflow.com/users/8720958/harwood95"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1507798722, "post_id": 46691765, "comment_id": 80357543, "body": "@rory, thanks to both of you so much for your help, what i did in the end was put $1:$1 as cyril advised this would fix the columns, when i copied this through into VBA it showed as R1 like you said Rory so both were valid answers."}, {"owner": {"reputation": 1, "user_id": 8720958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bac00de2b1d36ca337ff0b33118d79?s=128&d=identicon&r=PG&f=1", "display_name": "Harwood95", "link": "https://stackoverflow.com/users/8720958/harwood95"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1507798745, "post_id": 46691765, "comment_id": 80357561, "body": "@cyril - see above, couldn&#39;t add both of you in one comment"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1507813978, "post_id": 46691765, "comment_id": 80367496, "body": "@Harwood95 Copy; glad that worked.  I had deleted my answer after seeing Rory&#39;s comment, as I took an incorrect approach overall.  Luckily you got the information for <i>Ensure you have the correct &quot;fixed&quot; values, such as source ranges where A1 is dynamic row/column and A$1 is dynamic column but fixed row.</i> before I deleted!"}], "owner": {"reputation": 1, "user_id": 8720958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bac00de2b1d36ca337ff0b33118d79?s=128&d=identicon&r=PG&f=1", "display_name": "Harwood95", "link": "https://stackoverflow.com/users/8720958/harwood95"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507738054, "creation_date": 1507734509, "last_edit_date": 1507736116, "question_id": 46691765, "link": "https://stackoverflow.com/questions/46691765/autofill-formula-updating-wrong-value", "title": "Autofill Formula Updating Wrong Value", "body": "<p>I have an excel spreadsheet where i want to copy the following formula to all rows in VBA: </p>\n\n<pre><code>=INDEX('Sales Orders'!A:Z,SMALL(IF('Sales Orders'!A:A='Service Requests'!A2,ROW('Sales Orders'!A:Z)),ROW('Sales Orders'!1:1))*1,21)\n</code></pre>\n\n<p>In VBA it looks like this: </p>\n\n<pre><code>Range(\"BD2\").Select\nSelection.FormulaArray = _\n\"=INDEX('Sales Orders'!C[-55]:C[-30],SMALL(IF('Sales Orders'!C[-55]='Service Requests'!RC[-55],ROW('Sales Orders'!C[-55]:C[-30])),ROW('Sales Orders'!R[-1]))*1,21)\"\n</code></pre>\n\n<p>Then this is what i have to copy it down to the last row:</p>\n\n<pre><code>Selection.AutoFill Destination:=Range(ActiveCell, Cells(Cells(Rows.Count, \"BC\").End(xlUp).Row, \"BD\"))\n</code></pre>\n\n<p>So the row below now looks up <code>A3</code> in 'Service Requests' which is intended, but it also changes the instance it is looking for in 'Sales Orders' to <code>2:2</code> - this is not intended.</p>\n\n<p>How can i get it to change the <code>A</code> value but not the instance value?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1507735811, "post_id": 46691738, "comment_id": 80332006, "body": "<i>That table (&quot;Allratings&quot;) has course names as the field names</i> - if this is true (and you don&#39;t mean you have a column for course name), this is bad design. This should be a junction table (see Wikipedia)."}, {"owner": {"reputation": 5, "user_id": 8727775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6eaa3f2acd147d737bb160c1f68ab8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fiddle_stixx", "link": "https://stackoverflow.com/users/8727775/fiddle-stixx"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1507736122, "post_id": 46691738, "comment_id": 80332203, "body": "I misspoke there, it&#39;s the column names vice the field names. I edited the post to reflect the correction"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8727775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6eaa3f2acd147d737bb160c1f68ab8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fiddle_stixx", "link": "https://stackoverflow.com/users/8727775/fiddle-stixx"}, "edited": false, "score": 0, "creation_date": 1507757102, "post_id": 46693258, "comment_id": 80343274, "body": "I assumed I was making some errors like that. I don&#39;t know when to use quotation marks when referring to an object and when not to. However, after making the corrections you suggested, I&#39;m having the same issue I was before. I&#39;m not getting an error, but nothing is happening. The table where the data is being saved isn&#39;t saving the rating"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 5, "user_id": 8727775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6eaa3f2acd147d737bb160c1f68ab8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fiddle_stixx", "link": "https://stackoverflow.com/users/8727775/fiddle-stixx"}, "edited": false, "score": 0, "creation_date": 1507795930, "post_id": 46693258, "comment_id": 80355928, "body": "Well, that&#39;s probably because <code>Me.OpenArgs</code> is never equal to <code>fld.Name</code>, then. That&#39;s an issue elsewhere in your database."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1507748296, "last_edit_date": 1507748296, "creation_date": 1507739260, "answer_id": 46693258, "question_id": 46691738, "link": "https://stackoverflow.com/questions/46691738/refer-to-openargs-to-identify-field-name/46693258#46693258", "title": "Refer to OpenArgs to identify field name", "body": "<p>You're doing weird things with strings, and you should get a descriptive compile error when you try to save/compile this.</p>\n\n<p><code>varargs</code> refers to the variable <code>varargs</code></p>\n\n<p><code>\"varargs\"</code> is a literal string containing the letters v, a, r, etc.</p>\n\n<p><code>rst!\"varargs\"</code> should be <code>rst.Fields(\"varargs\")</code> to avoid a compile error, but should actually be <code>rst.Fields(varargs)</code></p>\n\n<p>If you correct all incorrectly placed quotes, you get:</p>\n\n<pre><code>Private Sub btnSubmit_Click()\nDim varargs As String\nDim rst As dao.Recordset\nDim db As dao.Database\nDim fld As dao.Field\nvarargs = Me.OpenArgs\nSet db = CurrentDb()\nSet rst = db.OpenRecordset(\"Allratings\")\n\nFor Each fld In rst.Fields\n    If fld.Name = varargs Then\n        rst.AddNew\n        rst.Fields(varargs) = intNumStars\n        rst.Update\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>This seems valid, if <code>Me.OpenArgs</code> contains only a field name</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 8727775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6eaa3f2acd147d737bb160c1f68ab8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fiddle_stixx", "link": "https://stackoverflow.com/users/8727775/fiddle-stixx"}, "edited": false, "score": 0, "creation_date": 1507755844, "post_id": 46695482, "comment_id": 80342764, "body": "Essentially, I was tasked to design a database that would rate our courses and create a catalog that showed the average rating of all the reviews using stars. So the reason I had the table set up that way was to make finding the DAvg using the field name with no criteria a little easier. I don\u2019t know very much VBA. Is it possible to use the Junction table to find the average of all ratings ever submitted?"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 5, "user_id": 8727775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6eaa3f2acd147d737bb160c1f68ab8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fiddle_stixx", "link": "https://stackoverflow.com/users/8727775/fiddle-stixx"}, "edited": false, "score": 0, "creation_date": 1507758428, "post_id": 46695482, "comment_id": 80343851, "body": "Yes, this would be trivial with an aggregate (GROUP BY) query."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1507747635, "creation_date": 1507747635, "answer_id": 46695482, "question_id": 46691738, "link": "https://stackoverflow.com/questions/46691738/refer-to-openargs-to-identify-field-name/46695482#46695482", "title": "Refer to OpenArgs to identify field name", "body": "<p>Eric has shown how to make your code work, but your table design will prove impractical. Adding a new column for each new course is not how you work with databases.</p>\n\n<p>I suggest</p>\n\n<p><strong>tblCourses</strong></p>\n\n<pre><code>+----------+------------+\n| CourseID | CourseName |\n+----------+------------+\n|        1 | foo        |\n|        2 | bar        |\n+----------+------------+\n</code></pre>\n\n<p><strong>tblUsers</strong></p>\n\n<pre><code>+--------+----------+\n| UserID | UserName |\n+--------+----------+\n|      7 | John     |\n|      8 | Kate     |\n+--------+----------+\n</code></pre>\n\n<p><strong>allRatings</strong> (this is a <a href=\"https://en.wikipedia.org/wiki/Associative_entity\" rel=\"nofollow noreferrer\">Junction table</a>)</p>\n\n<pre><code>+----------+--------+----------+\n| CourseID | UserID | NumStars |\n+----------+--------+----------+\n|        1 |      7 |        1 |\n|        1 |      8 |        4 |\n|        2 |      7 |        3 |\n+----------+--------+----------+\n</code></pre>\n\n<p>So a new rating is a new record in <code>allRatings</code>, with fixed column names. You can get the <code>CourseID</code> from the passed Course Name with a <code>DLookup</code> call.</p>\n\n<p>And a view with Courses and their ratings as columns is achieved with a <strong>Crosstab query</strong>.</p>\n"}], "owner": {"reputation": 5, "user_id": 8727775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6eaa3f2acd147d737bb160c1f68ab8b?s=128&d=identicon&r=PG&f=1", "display_name": "Fiddle_stixx", "link": "https://stackoverflow.com/users/8727775/fiddle-stixx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507748296, "creation_date": 1507734426, "last_edit_date": 1507736072, "question_id": 46691738, "link": "https://stackoverflow.com/questions/46691738/refer-to-openargs-to-identify-field-name", "title": "Refer to OpenArgs to identify field name", "body": "<p>I am having some issues trying to use OpenArgs to refer to a field name in a table. I'm fairly new to this so please bear with me. </p>\n\n<p>So I have a Report(CourseCatalog) that has text boxes with course names that it pulls from a table(tblCourses). When you click on a course, it opens a Form which gives you the option to rate the course(frmRate). I use OpenArgs (from the report to the rating form) to make the caption for frmRate. Works fine. </p>\n\n<p>Now i need to take the data (number of stars selected, (intNumStars)), which is defined previously in the code, and put it into a table. That table (\"Allratings\") has course names (the OpenArgs value) as the column names and I want to put the intNumStars(1-5) into the cells in those columns.</p>\n\n<p>I seem to have some problems referring to the VarArgs to accomplish that. My syntax/logic may be (is probably) wrong, and if anyone knows a better way to accomplish this task, please let me know what you think! Thank you!  </p>\n\n<pre><code>Private Sub btnSubmit_Click()\nDim varargs\nDim rst As dao.Recordset\nDim db As dao.Database\nDim fld As dao.Field\nvarargs = Me.OpenArgs\nSet db = CurrentDb()\nSet rst = db.OpenRecordset(\"Allratings\")\n\nFor Each fld In rst.Fields\n    If fld.Name = \"varargs\" Then\n        rst.AddNew\n        rst!\"varargs\" = intNumStars\n        rst.Update\n    End If\nNext\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 62, "user_id": 8734937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fbb6e1d29011f744cd7185337a6a06a?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/8734937/dennis"}, "edited": false, "score": 0, "creation_date": 1507812048, "post_id": 46693148, "comment_id": 80366141, "body": "Thanks a lot. When I change the above code with your comments, it works."}], "tags": [], "owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "is_accepted": true, "score": 1, "last_activity_date": 1507740889, "last_edit_date": 1507740889, "creation_date": 1507738937, "answer_id": 46693148, "question_id": 46691480, "link": "https://stackoverflow.com/questions/46691480/vba-populate-range-from-array/46693148#46693148", "title": "VBA Populate range from array", "body": "<p>Some advice added, not sure if this is what you need.</p>\n\n<pre><code>Sub determineDelta()\n    'Start determination and copy values to Delta sheet\n    Worksheets(\"Source\").Activate\n    Range(\"A2\").Select\n    numberofrecords = Range(Selection, Selection.End(xlDown)).Rows.count + 1\n\n    Dim myArray() As Variant\n    'Unnecessary code\n    'ReDim myArray(1 To 500) As Variant\n    Dim i, j, k As Integer\n    k = 0\n    'ReDim myArray(numberOfRecords, k) As Variant\n    ReDim myArray(numberofrecords, 2 To 6) As Variant\n\n    For i = 2 To numberofrecords\n        '[1]\n        If Not IsError(Application.Match(Cells(i, \"A\").Value, Sheets(\"SE16N\").Range(\"A:A\"), 0)) Then\n            For j = 2 To 6\n                '[2]\n                'myArray(j, k) = Cells(i, j).Value\n                'Debug.Print myArray(j, k)\n                myArray(k, j) = Cells(i, j).Value\n            Next j\n            k = k + 1\n            'Since we already have a large enough array, no need to redim here\n            'ReDim Preserve myArray(numberofrecords, k)\n        End If\n    Next i\n\n    With Worksheets(\"Delta\")\n        .Range(\"I2:I\" &amp; UBound(myArray)) = \"FI\"\n        .Range(\"J2:J\" &amp; UBound(myArray)) = \"A\"\n        '[3]\n        '.Range(\"M2\").Resize(UBound(myArray), 1).Value = Application.Transpose(myArray)\n        .Range(\"M2\").Resize(UBound(myArray), 5).Value = myArray\n    End With\nEnd Sub\n</code></pre>\n\n<p>[1]:\nIsError will return TRUE if there is an error in the following formula. If Cells(i, \"A\") is found in the Sheets(\"SE16N\"), it won't go into the for loop. So myArray will always catch values that are not in Sheets(\"SE16N\"). After adding a NOT operator, only items could be found are able to load into myArray. However, if you need to catch the values that are not shown in Sheets(\"SE16N\"), the origin is right.</p>\n\n<p>[2]:\nIt's a waste that you claimed an array about hundred rows but you access only row #2 to #6. I changed (j, k) into (k, j), so hopefully most of the array can be used.</p>\n\n<p>[3]:\nSince I exchanged the row and column, the array no longer needs to be transposed. In your original code, resize the range will get you a range with several rows and only one column. So only the first column of the array can be copied into the worksheet, feel free to change 5 back to 1 if I'm wrong.</p>\n\n<p>If you need to paste the data into separated columns, two methods come up in my mind. 1. You can store the data into different arrays at the beginning. 2. Loop through the array several times such as:</p>\n\n<pre><code>Set OriginCell = Range(\"M2\")\nSet OriginCell2 = Range(\"Q2\")\nFor i = 0 to UBound(myArray)\n    OriginCell.Offset(i).Value = myArray(i, 2)\n    OriginCell2.Offset(i).Value = myArray(i, 3)\nNext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62, "user_id": 8734937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fbb6e1d29011f744cd7185337a6a06a?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/8734937/dennis"}, "is_accepted": false, "score": 1, "last_activity_date": 1507812805, "creation_date": 1507812805, "answer_id": 46710145, "question_id": 46691480, "link": "https://stackoverflow.com/questions/46691480/vba-populate-range-from-array/46710145#46710145", "title": "VBA Populate range from array", "body": "<p>Thanks a lot. When I change the above code with your comments, it works.\n[1] Yes, if the value doesn't exist it needs to do something. So I didn't change that part.\n[2] I guess I still need to read more about arrays, because this is not 100% clear to me.\n[3] Awesome. Didn't know it was possible.</p>\n\n<p>Yes, the columns in the array need to go to individual columns.\nI tried it with your code, but it didn't do the trick. I get the point what you're trying to do. However, if I insert it like this, it will use the current sheet, i.e. Source, while the data needs to be in sheet Delta.</p>\n\n<p>When setting the ranges I included the Worksheets function as well  and it works like charm:</p>\n\n<pre><code>Set OriginCell = Worksheets(\"Delta).Range(\"M2\")\nSet OriginCell2 = Worksheets(\"Delta).Range(\"Q2\")\nFor i = 0 to UBound(myArray)\n    OriginCell.Offset(i).Value = myArray(i, 2)\n    OriginCell2.Offset(i).Value = myArray(i, 3)\nNext i\n</code></pre>\n\n<p>There are only some empty rows in the array, but I will be able to manage that myself. :) Thanks!</p>\n"}], "owner": {"reputation": 62, "user_id": 8734937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fbb6e1d29011f744cd7185337a6a06a?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/8734937/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5722, "favorite_count": 0, "accepted_answer_id": 46693148, "answer_count": 2, "score": 0, "last_activity_date": 1507812805, "creation_date": 1507733784, "last_edit_date": 1525816189, "question_id": 46691480, "link": "https://stackoverflow.com/questions/46691480/vba-populate-range-from-array", "title": "VBA Populate range from array", "body": "<p>I created an array which is populated if a condition is met - so far so good.\nNow the values which met the condition need to be copied to a different sheet.</p>\n\n<p>Actually I have to questions:\n1. I can't get the values in the range in the first place.;\n2. The array stores 4 columns (range) for each row if the criteria is met. Would it be possible if I can determine each array column and paste it in a specific column (in the array the columns are next to each other, but in the destination sheet they are not).</p>\n\n<p>This the code I have so far:</p>\n\n<pre><code>Sub determineDelta()\n'Start determination and copy values to Delta sheet\nWorksheets(\"Source\").Activate\nRange(\"A2\").Select\nnumberOfRecords = Range(Selection, Selection.End(xlDown)).Rows.Count + 1\n\nDim myArray() As Variant\nReDim myArray(1 To 500) As Variant\nDim i, j, k As Integer\nk = 0\nReDim myArray(numberOfRecords, k) As Variant\n\n    For i = 2 To numberOfRecords\n        If IsError(Application.Match(Cells(i, \"A\").Value, Sheets(\"SE16N\").Range(\"A:A\"), 0)) Then\n            For j = 2 To 6\n                myArray(j, k) = Cells(i, j).Value\n                Debug.Print myArray(j, k)\n            Next j\n            k = k + 1\n            ReDim Preserve myArray(numberOfRecords, k)\n        End If\n    Next i\n\nWorksheets(\"Delta\").Activate\nRange(\"I2:I\" &amp; UBound(myArray)) = \"FI\"\nRange(\"J2:J\" &amp; UBound(myArray)) = \"A\"\nRange(\"M2\").Resize(UBound(myArray), 1).Value = Application.Transpose(myArray)\nEnd Sub\n</code></pre>\n\n<p>I've been looking on the internet for 2 days, including cpearson. In this article about <a href=\"http://www.cpearson.com/excel/ArraysAndRanges.aspx\" rel=\"nofollow noreferrer\">array sizing</a> (on the bottom) it states #N/A. This is what I do have! But don't want. :-)</p>\n\n<p>I have the feeling I'm not that far off and wouldn't be surprised if it is just something relatively small.</p>\n\n<p>I hope someone can help me.</p>\n"}, {"tags": ["vba", "excel", "templates"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507733887, "post_id": 46691342, "comment_id": 80330640, "body": "Sounds great! Show us what you&#39;ve tried and tell us how it&#39;s failing, and you&#39;ll have an answerable question =)"}, {"owner": {"reputation": 3, "user_id": 3933198, "user_type": "registered", "profile_image": "https://graph.facebook.com/1228114626/picture?type=large", "display_name": "Gavin Oxley-Bryan", "link": "https://stackoverflow.com/users/3933198/gavin-oxley-bryan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507733992, "post_id": 46691342, "comment_id": 80330726, "body": "Private Sub Workbook_NewSheet(ByVal Sh As Object) Worksheets(&quot;Template&quot;).Cells.Copy ActiveSheet.Range(&quot;A1&quot;) End Sub"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507734283, "post_id": 46691342, "comment_id": 80330929, "body": "You need to <a href=\"https://stackoverflow.com/posts/46691342/edit\">edit</a> your question with all the relevant information..."}, {"owner": {"reputation": 3, "user_id": 3933198, "user_type": "registered", "profile_image": "https://graph.facebook.com/1228114626/picture?type=large", "display_name": "Gavin Oxley-Bryan", "link": "https://stackoverflow.com/users/3933198/gavin-oxley-bryan"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507734486, "post_id": 46691342, "comment_id": 80331060, "body": "Thanks Mat I have pasted the current code to the original question."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507745951, "post_id": 46691342, "comment_id": 80337787, "body": "how are you calling this sub and also where are your references to the source and destination workbooks as well as any possibly required opening of source workbook so you can copy data across?"}], "owner": {"reputation": 3, "user_id": 3933198, "user_type": "registered", "profile_image": "https://graph.facebook.com/1228114626/picture?type=large", "display_name": "Gavin Oxley-Bryan", "link": "https://stackoverflow.com/users/3933198/gavin-oxley-bryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507749411, "creation_date": 1507733411, "last_edit_date": 1507748454, "question_id": 46691342, "link": "https://stackoverflow.com/questions/46691342/create-new-sheet-in-excel-using-template", "title": "Create new sheet in Excel using template", "body": "<p>I use two workbooks for my business. I have saved both as templates, with one named <strong>sales invoices</strong> and the other named <strong>monies collected</strong>.</p>\n\n<p>What I would like to do is when I click the new sheet button, a new sheet will be created within the workbook and the data and formulas from the required template are imported to the new sheet.</p>\n\n<p>Any help would be appreciated.</p>\n\n<p>This is what I have so far</p>\n\n<pre><code>Private Sub Workbook_NewSheet(ByVal Sh As Object)\n    Worksheets(\"Template\").Cells.Copy ActiveSheet.Range(\"A1\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "vbscript", "activex", "wsh"], "comments": [{"owner": {"reputation": 11, "user_id": 7204135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209431656641341/picture?type=large", "display_name": "Cicca", "link": "https://stackoverflow.com/users/7204135/cicca"}, "edited": false, "score": 0, "creation_date": 1507732238, "post_id": 46690828, "comment_id": 80329514, "body": "SO is W7 Professional 64bit genuinely activated"}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1507732923, "post_id": 46690828, "comment_id": 80329964, "body": "Did you try adding the reference in the VBA IDE under Tools? The DLL is here usually <code>\\Windows\\System32\\scrrun.dll</code>. Once added, you do early binding."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1507732979, "post_id": 46690828, "comment_id": 80330024, "body": "This also might be helpful: <a href=\"https://stackoverflow.com/questions/9879825/how-to-add-a-reference-programmatically\" title=\"how to add a reference programmatically\">stackoverflow.com/questions/9879825/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507733036, "post_id": 46690828, "comment_id": 80330065, "body": "<i>Microsoft Scripting Runtime</i> is standard issue on every Windows box. What did you do with the type library and why are you trying to re-register it?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507733144, "post_id": 46690828, "comment_id": 80330129, "body": "Wait, no error at all with <code>CreateObject(progId)</code>, so all is good then - what&#39;s the problem? Your question is quite unclear... can you show us the code that <i>doesn&#39;t</i> work? See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1507734093, "post_id": 46690828, "comment_id": 80330800, "body": "Please show the code that raises the error instead of code that does not raise an error."}, {"owner": {"reputation": 11, "user_id": 7204135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209431656641341/picture?type=large", "display_name": "Cicca", "link": "https://stackoverflow.com/users/7204135/cicca"}, "edited": false, "score": 0, "creation_date": 1507736291, "post_id": 46690828, "comment_id": 80332321, "body": "The code giving error is:  Set id3 = CreateObject(&quot;CDDBControl.CddbID3Tag&quot;)   As already stated above, the cddbcontrol.dll has been successfully registered via regsvr32 and it appears in the VBA references."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1507739992, "post_id": 46690828, "comment_id": 80334566, "body": "<a href=\"https://social.msdn.microsoft.com/Forums/en-US/4f2b43f4-1a06-45e5-b05f-e1a2040feb32/cddbcontrolcddbid3tag-runtime-error-429-activex-component-cant-create-object?forum=isvvba\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/en-US/&hellip;</a>"}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1507767885, "post_id": 46690828, "comment_id": 80346381, "body": "<a href=\"https://stackoverflow.com/a/35985827/692942\">Worth reviewing</a> in detail <i>(it applies to situation where you are registering COM for use with VBScript, JScript or VBA)</i>."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 7204135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209431656641341/picture?type=large", "display_name": "Cicca", "link": "https://stackoverflow.com/users/7204135/cicca"}, "is_accepted": false, "score": 0, "last_activity_date": 1507798560, "creation_date": 1507798560, "answer_id": 46705368, "question_id": 46690828, "link": "https://stackoverflow.com/questions/46690828/run-time-error-429-activex-component-cant-create-object-in-vba-vbs-wsh/46705368#46705368", "title": "Run-time error &#39;429&#39;: ActiveX component can&#39;t create object in VBA/VBS/WSH", "body": "<p>I just found the solution....hope this could help someone else....\nThe only way I made it work is to follow the instructions given in the page:\n<a href=\"http://reidablog.blogspot.com/2006/07/setting-mp3-id-tags-with.html\" rel=\"nofollow noreferrer\">Setting MP3 ID Tags with CDDBControl.dll</a></p>\n\n<p>Cheers.</p>\n"}], "owner": {"reputation": 11, "user_id": 7204135, "user_type": "registered", "profile_image": "https://graph.facebook.com/10209431656641341/picture?type=large", "display_name": "Cicca", "link": "https://stackoverflow.com/users/7204135/cicca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1548, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1507798560, "creation_date": 1507732018, "last_edit_date": 1507795453, "question_id": 46690828, "link": "https://stackoverflow.com/questions/46690828/run-time-error-429-activex-component-cant-create-object-in-vba-vbs-wsh", "title": "Run-time error &#39;429&#39;: ActiveX component can&#39;t create object in VBA/VBS/WSH", "body": "<p>I know it has been asked so many times, but I've gone through dozens of pages, with no luck, since mine seems to be a OS/machine related problem rather then of a specific library.</p>\n\n<p>Trying to manage ID3Tags, or in general, files extended properties, it's clear that with a Shell object you can only retrieve them, but can't edit, therefore the only way to do that is using an external DLL (es. CDDBControl, or DSOfile), I can't get them to work, although I apparently successfully installed them with regsvr32 (references are available i.e. in Excel macro dev env.</p>\n\n<p>I tried many ways....using regsvr32 either under System32 or SysWOW64, trying to put the DLLs in different location....but nothing.</p>\n\n<p>Statement raising the error:</p>\n\n<pre><code>Set id3 = CreateObject(\"CDDBControl.CddbID3Tag\")\n</code></pre>\n\n<p>Please note that a call like</p>\n\n<pre><code>Set FSO = CreateObject(\"Scripting.FileSystemObject\")\n</code></pre>\n\n<p>instead, gives no error at all.</p>\n"}, {"tags": ["excel", "excel-formula", "spreadsheet", "excel-2013", "vba"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507731494, "post_id": 46690284, "comment_id": 80328943, "body": "Is it the min value <code>&lt;=</code> Rating or <code>&gt;=</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 804, "user_id": 457534, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/19c54d3867e104f68f034beb4b4d0016?s=128&d=identicon&r=PG", "display_name": "Matt M", "link": "https://stackoverflow.com/users/457534/matt-m"}, "edited": false, "score": 0, "creation_date": 1507732068, "post_id": 46690584, "comment_id": 80329381, "body": "Thank you very much for simply answering my question!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 4, "last_activity_date": 1507731420, "creation_date": 1507731420, "answer_id": 46690584, "question_id": 46690284, "link": "https://stackoverflow.com/questions/46690284/excel-selecting-cell-based-on-other-column-values/46690584#46690584", "title": "Excel - Selecting cell based on other column values", "body": "<p>Use this formula in C2 and copy down:</p>\n\n<pre><code>=INDEX(Sheet2!A:A,MATCH(AGGREGATE(15,6,Sheet2!$C$2:$C$14/(Sheet2!$D$2:$D$14&gt;=B2),1),Sheet2!C:C,0))\n</code></pre>\n\n<hr>\n\n<p>If you get Office 365 Excel then this would be better:</p>\n\n<pre><code>=INDEX(Sheet2!A:A,MATCH(MINIFS(Sheet2!$C:$C,Sheet2!$D:$D,\"&gt;=\" &amp;B2),Sheet2!C:C,0))\n</code></pre>\n"}], "owner": {"reputation": 804, "user_id": 457534, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/19c54d3867e104f68f034beb4b4d0016?s=128&d=identicon&r=PG", "display_name": "Matt M", "link": "https://stackoverflow.com/users/457534/matt-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6901, "favorite_count": 0, "accepted_answer_id": 46690584, "answer_count": 1, "score": -1, "last_activity_date": 1507731420, "creation_date": 1507730647, "last_edit_date": 1531161705, "question_id": 46690284, "link": "https://stackoverflow.com/questions/46690284/excel-selecting-cell-based-on-other-column-values", "title": "Excel - Selecting cell based on other column values", "body": "<p>I am trying to select the correct cell based on the values of adjacent columns. For example -</p>\n\n<p>Sheet 2 - This acts as a database of sorts holding all data/values<br>\n<a href=\"https://i.stack.imgur.com/qheXz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qheXz.png\" alt=\"Sheet 2\"></a></p>\n\n<p>Sheet 1 - The \"Result\" should populate with the \"Item\" from Sheet 2. The filter criteria is \"Value\" needs to be less than or equal to (&lt;=) \"Rating\" and for multiple matches select the lowest \"Sell\" item. So, Item 3 has a value of 650 which means the applicable Items from Sheet 2 are G,H,J,K,L,M however the \"Result\" is populated with \"G\" because that has the cheapest \"Sell\" value.<br>\n<a href=\"https://i.stack.imgur.com/r6H2H.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/r6H2H.png\" alt=\"Sheet 1\"></a></p>\n\n<p>How can I write this for all \"Result\" cells? I am not well versed in Excel but I do know how to query a database such as MySQL, if that helps.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1507733929, "post_id": 46690276, "comment_id": 80330676, "body": "What is the source of the sheets intended to be Hidden?  Are they created in the new workbook?"}, {"owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1507753721, "post_id": 46690276, "comment_id": 80341696, "body": "the hidden sheets are in the active excel file, I don&#39;t want to create them, I just want to copy them to each new created workbook"}], "answers": [{"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1507734276, "post_id": 46690745, "comment_id": 80330925, "body": "I believe you can use an array to add the 4 desired sheet names."}, {"owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "edited": false, "score": 0, "creation_date": 1507753910, "post_id": 46690745, "comment_id": 80341801, "body": "so the thig is that I always want to copy the visible sheet which are called sheet1, sheet1(1), sheet1(2), sheet1(3) etc. and hidden sheets which are called always the same (Lookups, Copy Data, Export Data, Preview)."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 0, "last_activity_date": 1507734193, "last_edit_date": 1507734193, "creation_date": 1507731790, "answer_id": 46690745, "question_id": 46690276, "link": "https://stackoverflow.com/questions/46690276/saving-several-hidden-worksheets/46690745#46690745", "title": "Saving several hidden worksheets", "body": "<p>In general, you can use the simple Sheets(\"NAME\").Move to put a sheet to a new workbook.</p>\n\n<pre><code>Dim i As Long, j As String, k As Workbook, xPath As String\nxPath = Application.ActiveWorkbook.path\nSet k = ThisWorkbook\nIf k.Sheets.Count &gt; 1 Then 'Check\n    For i = k.Sheets.Count To 2 Step -1\n        j = k.Sheets(i).Name\n        k.Sheets(i).Move\n        'ActiveWorkbook.Sheets.Add.Name = \"Test\" 'Lookups, Copy Data, Export Data, Preview\n        'ActiveWorkbook.Sheets(\"Test\").Visible = xlSheetHidden\n        ActiveWorkbook.SaveAs FileName:=xPath &amp; \"\\\" &amp; j &amp; \".xlsm\", FileFormat:=52\n        ActiveWorkbook.Close\n    Next i\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 8318946, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/7bcac8e3fc0233eca8cef0ea4ffd9fdc?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian", "link": "https://stackoverflow.com/users/8318946/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508768409, "creation_date": 1507730631, "last_edit_date": 1508768409, "question_id": 46690276, "link": "https://stackoverflow.com/questions/46690276/saving-several-hidden-worksheets", "title": "Saving several hidden worksheets", "body": "<p>I found and adjusted code that saves all worksheets (in 1 Excel file) to separate workbooks in a specific folder and then deletes the worksheet from existing workbook so in the end instead of 12 worksheets in 1 workbook I have 12 workbooks with 1 worksheet in 1 folder.</p>\n\n<p>I would like to save 4 hidden worksheets and macros so in the end I would like to have 12 workbooks that contains of 1 visible sheet (called Sheet1), 4 hidden sheets (called: Lookups, Copy Data, Export Data, Preview) and macro so in the end I would have 12 workbooks (.xlsm) with 5 worksheets and with macro enabled. The number of visible worksheets varies but the hidden worksheets are always the same.</p>\n\n<p>My code:</p>\n\n<pre><code>Sub sheets_to_files(Optional byDummy As Byte)\n\nDim xPath As String\nDim ws As Worksheet\nxPath = Application.ActiveWorkbook.path\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nFor Each xWs In ThisWorkbook.Sheets\n  xWs.Copy\n  Application.ActiveWorkbook.SaveAs FileName:=xPath &amp; \"\\\" &amp; xWs.Name &amp; \n  \".xlsm\", FileFormat:=52\nApplication.ActiveWorkbook.Close False\nNext\n\nFor Each ws In Worksheets\n    Select Case ws.Name\n        Case \"Sheet1\"\n        Case Else\n            ws.Delete\n    End Select\nNext ws\nApplication.DisplayAlerts = True\nEnd Sub\n</code></pre>\n\n<p>I believe that I would need to create an array and change these lines</p>\n\n<pre><code>For Each xWs In ThisWorkbook.Sheets\n    xWs.Copy\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1507730754, "post_id": 46690188, "comment_id": 80328406, "body": "My money is on <code>Select</code>, <code>Activate</code> and implicit references to the active worksheet and to the active workbook (heck, explicit ones as well). Qualify all those, remove all <code>Select</code> and <code>Activate</code>. Your code will be easier to follow, and overall more robust."}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "edited": false, "score": 0, "creation_date": 1507732937, "post_id": 46690803, "comment_id": 80329977, "body": "Thanks for the info. I was not aware of the limitation. I checked further &amp; you are correct."}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 0, "last_activity_date": 1507731958, "creation_date": 1507731958, "answer_id": 46690803, "question_id": 46690188, "link": "https://stackoverflow.com/questions/46690188/why-is-vba-code-for-calling-multi-worksheet-not-working-as-expected-after-7-work/46690803#46690803", "title": "Why is vba code for calling multi worksheet not working as expected after 7 worksheets?", "body": "<p>I think the problem is that  InputBox prompt can't accept more than 254 characters. This worked for me</p>\n\n<pre><code> MyValue = Application.InputBox(\"Only Click Ok or Cancel after your Selection!!!!!!!\" &amp; vbCrLf &amp; _\n                           \"Enter 1 for October\" &amp; vbCrLf &amp; _\n                           \"Enter 2 for November\" &amp; vbCrLf &amp; _\n                           \"Enter 3 for December\" &amp; vbCrLf &amp; _\n                           \"Enter 4 for January\" &amp; vbCrLf &amp; _\n                           \"Enter 5 for February\" &amp; vbCrLf &amp; _\n                           \"Enter 6 for March\" &amp; vbCrLf &amp; _\n                           \"Enter 7 for 1st Quarter\" &amp; vbCrLf &amp; _\n                           \"Enter 8 for 1st 6 Month\", \"Walk In Training Data Entry\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 1, "last_activity_date": 1507731987, "creation_date": 1507731987, "answer_id": 46690817, "question_id": 46690188, "link": "https://stackoverflow.com/questions/46690188/why-is-vba-code-for-calling-multi-worksheet-not-working-as-expected-after-7-work/46690817#46690817", "title": "Why is vba code for calling multi worksheet not working as expected after 7 worksheets?", "body": "<p>Your inputbox prompt text is too long. I believe it has a limit of 255 characters (current prompt is 277 characters), otherwise you will get an error. Additionally, you should be declaring the <code>MyValue</code> variable with the data it's going to hold, it looks like a <code>Byte</code> should do.</p>\n\n<p>If you want to retain the exact formatting, I'd recommend changing this InputBox into a UserForm.</p>\n\n<p>Here is working code just for the beginning portion.</p>\n\n<pre><code>Sub SOExample()\n    Dim MyValue       As Byte\n    Const InputBoxTxt As String = \"Only Click Ok or Cancel after your Selection!\" &amp; vbCrLf &amp; _\n                                  \"Enter 1 for Oct Report\" &amp; vbCrLf &amp; _\n                                  \"Enter 2 for Nov Report\" &amp; vbCrLf &amp; _\n                                  \"Enter 3 for Dec Report\" &amp; vbCrLf &amp; _\n                                  \"Enter 4 for Jan Report\" &amp; vbCrLf &amp; _\n                                  \"Enter 5 for Feb Report\" &amp; vbCrLf &amp; _\n                                  \"Enter 6 for March Report\" &amp; vbCrLf &amp; _\n                                  \"Enter 7 for 1st Quarter\" &amp; vbCrLf &amp; _\n                                  \"Enter 8 for 1st 6 Month Report\"\n\n    MyValue = Application.InputBox(InputBoxTxt, \"Walk In Training Data Entry\")\n\n    If MyValue = 0 Then\n        Exit Sub\n    ElseIf MyValue &gt;= 1 Or MyValue &lt;= 8 Then\n        'Exit Do\n    Else\n        MsgBox \"You have not made a valid entry.  Please try again.\", _\n                vbInformation, _\n                \"Referral Workbook - Data Entry\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5791797, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f1838b38cef5d17d9e1c5f02fbc0e04?s=128&d=identicon&r=PG&f=1", "display_name": "Frank M", "link": "https://stackoverflow.com/users/5791797/frank-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 46690803, "answer_count": 2, "score": 0, "last_activity_date": 1507731987, "creation_date": 1507730429, "last_edit_date": 1531164843, "question_id": 46690188, "link": "https://stackoverflow.com/questions/46690188/why-is-vba-code-for-calling-multi-worksheet-not-working-as-expected-after-7-work", "title": "Why is vba code for calling multi worksheet not working as expected after 7 worksheets?", "body": "<p>I have code that gives the user an option of calling 1 of 7 worksheets in a workbook. The code does work as expected up to sheet number 7. When I add an additional sheet I, receive a Run time error code #13 type mismatch.  It hangs on <code>If MyValue = False Then</code>. I have checked the sheet numbers &amp; the sheet names. Both are correct, &amp; have also tried copy/past of the names. I am wondering if 7 worksheets is the maximum number of sheets allowed. I need to go to 9 worksheets if Possible. Here is the code with the additional sheet:</p>\n\n<pre><code>Sub First_Half_Reports()\n   Dim MyValue\n     Dim i As String\n\n    'MsgBox prompt:=\"1st 6 Months of Reports?\", Title:=\"Referral Workbook - Data Entry\"\n    i = MsgBox(\"Continue to 1st 6 Months of Reports?\", vbYesNo, \" Referral Workbook - Data Entry\")\n\n    If Not i = vbYes Then Exit Sub\n\n    'First message shows in the body of the box, message 2 shows at the top of the box.\n    Do\n        MyValue = Application.InputBox(\"Only Click Ok or Cancel after your Selection!!!!!!!\" &amp; vbCrLf &amp; _\n                               \"Enter 1 for October Report\" &amp; vbCrLf &amp; _\n                               \"Enter 2 for November Report\" &amp; vbCrLf &amp; _\n                               \"Enter 3 for December Report\" &amp; vbCrLf &amp; _\n                               \"Enter 4 for January Report\" &amp; vbCrLf &amp; _\n                               \"Enter 5 for February Report\" &amp; vbCrLf &amp; _\n                               \"Enter 6 for March Report\" &amp; vbCrLf &amp; _\n                               \"Enter 7 for 1st Quarter\" &amp; vbCrLf &amp; _\n                               \"Enter 8 for 1st 6 Month Report\", \"Walk In Training Data Entry\")\n        ' Sub messaage box exit.\n        If MyValue = False Then\n            Exit Sub\n        ElseIf (MyValue = 1) Or (MyValue = 2) Or (MyValue = 3) Or (MyValue = 4) Or (MyValue = 5) Or (MyValue = 6) Or (MyValue = 7) Or (MyValue = 8) Then\n            Exit Do\n        Else\n            MsgBox \"You have not made a valid entry.  Please try again.\", vbInformation, \"Referral Workbook - Data Entry\"\n        End If\n    Loop    'Code to Execute When Condition = value_1\n    Select Case MyValue\n        Case 1\n                     If ActiveSheet.CodeName = \"Sheet45\" Then\n               ' The message below only shows when you are on the active sheet.\n                        MsgBox \"You are already on October Report!\", vbInformation, \"Referral Workbook - Data Entry\"\n                    Else\n                        Sheets(\"October_Report\").Activate\n                        Range(\"A1\").Select\n                    End If\n        'Code to Execute When Condition = value_2\n        Case 2\n                     If ActiveSheet.CodeName = \"Sheet46\" Then\n               ' The message below only shows when you are on the active sheet.\n                        MsgBox \"You are already on November Report!\", vbInformation, \"Referral Workbook - Data Entry\"\n                    Else\n                        Sheets(\"November_Report\").Activate\n                        Range(\"A1\").Select\n                    End If\n\n        'Code to Execute When Condition = value_3\n        Case 3\n                     If ActiveSheet.CodeName = \"Sheet54\" Then\n               ' The message below only shows when you are on the active sheet.\n                        MsgBox \"You are already on December Report!\", vbInformation, \"Referral Workbook - Data Entry\"\n                    Else\n                        Sheets(\"WI_DT_1ST\").Activate\n                        Range(\"A1\").Select\n                End If\n                'Code to Execute When Condition = value_4\n       Case 4\n                     If ActiveSheet.CodeName = \"Sheet48\" Then\n               ' The message below only shows when you are on the active sheet.\n                        MsgBox \"You are already on January Report!\", vbInformation, \"Referral Workbook - Data Entry\"\n                    Else\n                        Sheets(\"January_Report\").Activate\n                        Range(\"A1\").Select\n                End If\n      'Code to Execute When Condition = value_5\n       Case 5\n                     If ActiveSheet.CodeName = \"Sheet49\" Then\n               ' The message below only shows when you are on the active sheet.\n                        MsgBox \"You are already on February Report!\", vbInformation, \"Referral Workbook - Data Entry\"\n                    Else\n                        Sheets(\"February_Report\").Activate\n                        Range(\"A1\").Select\n                End If\n       'Code to Execute When Condition = value_6\n       Case 6\n                     If ActiveSheet.CodeName = \"Sheet50\" Then\n               ' The message below only shows when you are on the active sheet.\n                        MsgBox \"You are already on March Report!\", vbInformation, \"Referral Workbook - Data Entry\"\n                    Else\n                        Sheets(\"March_Report\").Activate\n                        Range(\"A1\").Select\n                End If\n                'Code to Execute When Condition = value_7\n       Case 7\n                     If ActiveSheet.CodeName = \"Sheet11\" Then\n               ' The message below only shows when you are on the active sheet.\n                        MsgBox \"You are already on 1st Quarter Report!\", vbInformation, \"Referral Workbook - Data Entry\"\n                    Else\n                        Sheets(\"1St_Qtr\").Activate\n                        Range(\"A1\").Select\n                End If\n       'Code to Execute When Condition = value_8\n       Case 8\n                     If ActiveSheet.CodeName = \"Sheet43\" Then\n               ' The message below only shows when you are on the active sheet.\n                        MsgBox \"You are already on 1st 6 Month Report!\", vbInformation, \"Referral Workbook - Data Entry\"\n                    Else\n                        Sheets(\"1st_6_Month_Report\").Activate\n                        Range(\"A1\").Select\n                End If\n\n    End Select \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "email", "outlook"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1507729746, "post_id": 46689853, "comment_id": 80327606, "body": "can you just expand the range to one row below (and / or above) the data. you&#39;ll get extra white space but may get your data table"}, {"owner": {"reputation": 29, "user_id": 2554910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e7697e0d0472273ebe01fe04182b54?s=128&d=identicon&r=PG", "display_name": "skyfx", "link": "https://stackoverflow.com/users/2554910/skyfx"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1507730167, "post_id": 46689853, "comment_id": 80327949, "body": "Solid idea! When I increased the range to include an additional column on the right and three additional rows at the bottom, it pasted properly (i.e., Set r = Range(&quot;B2:F17&quot;)). This is still so weird to me though, since that extra column and those extra rows are all blank. Any idea why this is happening?"}], "owner": {"reputation": 29, "user_id": 2554910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85e7697e0d0472273ebe01fe04182b54?s=128&d=identicon&r=PG", "display_name": "skyfx", "link": "https://stackoverflow.com/users/2554910/skyfx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1087, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1507752820, "creation_date": 1507729493, "last_edit_date": 1507752820, "question_id": 46689853, "link": "https://stackoverflow.com/questions/46689853/copy-and-paste-range-from-excel-2016-into-outlook-2016-as-picture", "title": "Copy-and-Paste Range from Excel 2016 into Outlook 2016 as Picture", "body": "<p>I am trying to paste an Excel range into the body of an Outlook e-mail as a picture using VBA. However, whenever I do so, the range gets cut off in the paste operation. The original range looks as follows:</p>\n\n<p><img src=\"https://i.stack.imgur.com/pLZIf.png\" alt=\"Original Range\"></p>\n\n<p>While the paste appears as follows:</p>\n\n<p><img src=\"https://i.stack.imgur.com/B3Uxm.png\" alt=\"Pasted Image\"></p>\n\n<p>I basically used <a href=\"https://stackoverflow.com/users/119775/jean-fran%C3%A7ois-corbett\">Jean-Fran\u00e7ois Corbett</a>'s VBA code shown at <a href=\"https://stackoverflow.com/questions/29092999/pasting-an-excel-range-into-an-email-as-a-picture\">Pasting an Excel range into an email as a picture</a>. Namely:</p>\n\n<pre><code>Dim objOutlook As Object\nDim objMail As Object\n\nSet objOutlook = CreateObject(Class:=\"Outlook.Application\")\nSet objMail = objOutlook.CreateItem(0)\n\n'Copy range of interest\nDim r As Range\nSet r = Range(\"B2:E14\")\nr.Copy\n\n'Paste as picture in sheet and cut immediately\nDim p As Picture\nSet p = ActiveSheet.Pictures.Paste\np.Cut\n\n'Get its Word editor\nobjMail.Display\nDim wordDoc As Word.Document\nSet wordDoc = objMail.GetInspector.WordEditor\n\n'Paste picture\nwordDoc.Range.Paste\n</code></pre>\n\n<p>I know there are other code samples out there that do the paste as HTML (e.g., <a href=\"http://www.rondebruin.nl/win/s1/outlook/bmail2.htm\" rel=\"nofollow noreferrer\">by Ron de Bruin</a>), but that ends up pasting as a table for me (as opposed to as a picture). I've also seen examples where people paste into a chart, save the chart as a JPG, and insert that JPG into the HTMLBody of the e-mail (e.g., <a href=\"https://stackoverflow.com/questions/27042842/excel-2010-paste-range-and-picture-into-outlook\">by Mike Marshall</a>), but that too gets cut off for me.</p>\n\n<p>Appreciate any insights people can share!</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 7429790, "user_type": "registered", "profile_image": "https://graph.facebook.com/659852265/picture?type=large", "display_name": "Alex C.", "link": "https://stackoverflow.com/users/7429790/alex-c"}, "edited": false, "score": 0, "creation_date": 1507746436, "post_id": 46693917, "comment_id": 80338040, "body": "VBA code is accepted but still have an error message : &quot;The value entered isn&#39;t valid for this field.&quot; MS Access valid the type of insertion. The field is numeric and any insert with a &quot;,&quot; can&#39;t be a number! So, the replace in VBA code must be before the validation. How?"}, {"owner": {"reputation": 77, "user_id": 7429790, "user_type": "registered", "profile_image": "https://graph.facebook.com/659852265/picture?type=large", "display_name": "Alex C.", "link": "https://stackoverflow.com/users/7429790/alex-c"}, "edited": false, "score": 0, "creation_date": 1507746485, "post_id": 46693917, "comment_id": 80338070, "body": "Error like that : <a href=\"https://s3.amazonaws.com/ssi-article-images/office2010/access2010/input-mask-5.jpg\" rel=\"nofollow noreferrer\">s3.amazonaws.com/ssi-article-images/office2010/access2010/&hellip;</a>"}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 77, "user_id": 7429790, "user_type": "registered", "profile_image": "https://graph.facebook.com/659852265/picture?type=large", "display_name": "Alex C.", "link": "https://stackoverflow.com/users/7429790/alex-c"}, "edited": false, "score": 0, "creation_date": 1507746889, "post_id": 46693917, "comment_id": 80338293, "body": "Try moving the code from the <code>AfterUpdate</code> event to the <code>OnDirty</code> event."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 77, "user_id": 7429790, "user_type": "registered", "profile_image": "https://graph.facebook.com/659852265/picture?type=large", "display_name": "Alex C.", "link": "https://stackoverflow.com/users/7429790/alex-c"}, "edited": false, "score": 0, "creation_date": 1507748392, "post_id": 46693917, "comment_id": 80339088, "body": "Hm, do these fields have validation rules in the table or on the form controls? Also, are the textbox&#39;s control source property blank or not blank?"}, {"owner": {"reputation": 77, "user_id": 7429790, "user_type": "registered", "profile_image": "https://graph.facebook.com/659852265/picture?type=large", "display_name": "Alex C.", "link": "https://stackoverflow.com/users/7429790/alex-c"}, "edited": false, "score": 0, "creation_date": 1507752040, "post_id": 46693917, "comment_id": 80340923, "body": "There are no fields validation rules. I did not add any form controls. So, I suppose there are none."}, {"owner": {"reputation": 77, "user_id": 7429790, "user_type": "registered", "profile_image": "https://graph.facebook.com/659852265/picture?type=large", "display_name": "Alex C.", "link": "https://stackoverflow.com/users/7429790/alex-c"}, "edited": false, "score": 0, "creation_date": 1507752272, "post_id": 46693917, "comment_id": 80341041, "body": "Latitude and longitude are never empty. So, I always update the value with a copy-paste to replace the old one."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 77, "user_id": 7429790, "user_type": "registered", "profile_image": "https://graph.facebook.com/659852265/picture?type=large", "display_name": "Alex C.", "link": "https://stackoverflow.com/users/7429790/alex-c"}, "edited": false, "score": 0, "creation_date": 1507752529, "post_id": 46693917, "comment_id": 80341168, "body": "Ok I don&#39;t think what you are trying to do is possible, but maybe another user can help. The issue is because it is a numeric field, anything with a &quot;,&quot; will be disallowed as soon as you enter the value. There are no events that can be utilized to adjust this entry without throwing an error because BeforeUpdate will cause a runtime error if you affect the field that initially triggered an event (maybe causing an infinite loop?)."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "reply_to_user": {"reputation": 77, "user_id": 7429790, "user_type": "registered", "profile_image": "https://graph.facebook.com/659852265/picture?type=large", "display_name": "Alex C.", "link": "https://stackoverflow.com/users/7429790/alex-c"}, "edited": false, "score": 0, "creation_date": 1507752777, "post_id": 46693917, "comment_id": 80341284, "body": "You will probably need separate textboxes to copy/paste the dirty data into, sanitize it, then paste it into old textboxes. The code above will error out if there is no comma in the input, so I will update my answer to help."}], "tags": [], "owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1507753536, "last_edit_date": 1507753536, "creation_date": 1507741607, "answer_id": 46693917, "question_id": 46689808, "link": "https://stackoverflow.com/questions/46689808/access-vba-event-code-which-modifying-copy-paste-automaticly/46693917#46693917", "title": "Access VBA event code which modifying copy-paste automaticly", "body": "<p>In your Longitude and Latitude fields, go to the event properties and select the \"...\" on the far-right of the <code>AfterUpdate</code> event.</p>\n\n<p>A window will pop-up asking what type of Builder you want to use. Choose \"Code Builder.\"</p>\n\n<p>The VBE window will pop up and place your cursor below something like <code>Private Sub latitude_AfterUpdate()</code> where <code>latitude</code> will be the name of the textbox on your form. Underneath that line, paste the following code:</p>\n\n<p><code>Me!Latitude = Replace(Me!Latitude, \",\", \".\")</code></p>\n\n<p>Do the same thing for Longitude, but make sure to update the <code>Me!Latitude</code> part with the actual name of the textbox.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Due to the fact that your form controls seem to be bound, I don't think you will be able to dodge the errors thrown when a comma exists in the copy/pasted data. Here is what you can do instead:</p>\n\n<p>Create two new textboxes. I'll call them <code>LonEdit</code> and <code>LatEdit</code>. When you create them, drag them from the ribbon, do not use the \"Use Existing Fields.\" This should make the \"Control Source\" properties empty, and should display the word \"Unbound\" in the textbox when the form is in design view.</p>\n\n<p>Next, go to <code>LonEdit</code>'s event properties and use the code builder for the <code>AfterUpdate</code> event.</p>\n\n<p>Here is the code you should insert in the <code>LonEdit_AfterUpdate</code> event:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Test for comma\nIf InStr(1, Me!LonEdit, \",\")&gt;0 Then\n    'Replace comma with period and copy to old textbox\n    Me!Longitude = Replace(Me!LonEdit, \",\", \".\")\nElse\n    'No comma, just copy to old textbox\n    Me!Longitude = Me!LonEdit\nEnd If\n'Clear the new textbox\nMe!LonEdit = \"\"\n</code></pre>\n\n<p>Do a similar thing for the new Latitude box:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Test for comma\nIf InStr(1, Me!LatEdit, \",\")&gt;0 Then\n    'Replace comma with period and copy to old textbox\n    Me!Latitude = Replace(Me!LatEdit, \",\", \".\")\nElse\n    'No comma, just copy to old textbox\n    Me!Latitude = Me!LatEdit\nEnd If\n'Clear the new textbox\nMe!LatEdit = \"\"\n</code></pre>\n\n<p>Once complete, try copy/pasting into the new textboxes, and then tab out of them when finished. This should replace the comma and copy to the old textbox without throwing an error. Not as nice of a solution, but it's the best I can come up with at the moment. Good Luck!</p>\n"}], "owner": {"reputation": 77, "user_id": 7429790, "user_type": "registered", "profile_image": "https://graph.facebook.com/659852265/picture?type=large", "display_name": "Alex C.", "link": "https://stackoverflow.com/users/7429790/alex-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 46693917, "answer_count": 1, "score": 0, "last_activity_date": 1507753536, "creation_date": 1507729390, "last_edit_date": 1507751714, "question_id": 46689808, "link": "https://stackoverflow.com/questions/46689808/access-vba-event-code-which-modifying-copy-paste-automaticly", "title": "Access VBA event code which modifying copy-paste automaticly", "body": "<p>Situation : I have an Access form with two coordinate fields to be filled. These numerical fields are called \"latitude\" and \"longitude.\" A lot of coordinates are being copy-pasted into these fields. Those coordinates contain \",\" for the decimal which should be \".\". An error will occur if not.</p>\n\n<p>Objective : Be able to update my form with copy-pasting without modifying the pasted string manually (\",\" --> \".\").</p>\n\n<p>I looked for a VBA event code for the fields latitude and longitude. I tried <code>=Replace([latitude];\",\";\".\")</code> which does not work.</p>\n\n<p>Here is the first try :</p>\n\n<pre><code>Private Sub latitude_OnDirty()\nMe!latitude = Replace(Me!latitude, \",\", \".\")\nEnd Sub\n\nPrivate Sub longitude_OnDirty()\nMe!longitude = Replace(Me!longitude, \",\", \".\")\nEnd Sub\n</code></pre>\n\n<p>VBA code is accepted but still have an error message : \"The value entered isn't valid for this field.\" MS Access valid the type of insertion. The field is numeric and any insertion with a \",\" can't be a number. So, the replace command in VBA code must be before the validation. How to do?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507729629, "post_id": 46689745, "comment_id": 80327507, "body": "For the problem 2 try to read <a href=\"https://stackoverflow.com/a/2814014/7690982\">this</a>. And are the files located locally or on the network?"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1507730077, "post_id": 46689745, "comment_id": 80327877, "body": "For problem 2 @danieltakeshi already provided a good link. Concerning the code optimization: Please read <a href=\"https://meta.stackoverflow.com/questions/261841/can-i-post-questions-about-optimizing-code-on-stack-overflow\">this on meta</a> - It&#39;s better to go to Code Review with problem 1, since the actual problem is already solved."}, {"owner": {"reputation": 21, "user_id": 3122351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PpODj.jpg?s=128&g=1", "display_name": "dFialok", "link": "https://stackoverflow.com/users/3122351/dfialok"}, "edited": false, "score": 0, "creation_date": 1507730110, "post_id": 46689745, "comment_id": 80327899, "body": "Files are placed locally."}, {"owner": {"reputation": 21, "user_id": 3122351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PpODj.jpg?s=128&g=1", "display_name": "dFialok", "link": "https://stackoverflow.com/users/3122351/dfialok"}, "edited": false, "score": 0, "creation_date": 1507730174, "post_id": 46689745, "comment_id": 80327958, "body": "I have found a temp work around for this FPath = &#39;ActiveWorkbook.Path &amp; &quot;\\&quot; and is working fine."}, {"owner": {"reputation": 21, "user_id": 3122351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PpODj.jpg?s=128&g=1", "display_name": "dFialok", "link": "https://stackoverflow.com/users/3122351/dfialok"}, "edited": false, "score": 0, "creation_date": 1507730228, "post_id": 46689745, "comment_id": 80328006, "body": "Can i use some conditional statement to check FileExt as &quot;.xlsx or .tsv&quot; rather than running loop for both formats"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507730581, "post_id": 46689745, "comment_id": 80328271, "body": "But before posting on Code Review, please read <a href=\"https://codereview.meta.stackexchange.com/questions/5777/a-guide-to-code-review-for-stack-overflow-users\">this</a>"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507730769, "post_id": 46689745, "comment_id": 80328415, "body": "@dFialok You can use <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/like-operator\" rel=\"nofollow noreferrer\">Like operator</a> with wildcard, e.g.: <code>If FileExt Like &quot;*.xlsx&quot; Then &#39;do something&#39;</code>"}, {"owner": {"reputation": 21, "user_id": 3122351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PpODj.jpg?s=128&g=1", "display_name": "dFialok", "link": "https://stackoverflow.com/users/3122351/dfialok"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507731385, "post_id": 46689745, "comment_id": 80328855, "body": "thanks @danieltakeshi. will look forward to code review and will try Like Operator. will update you soon"}], "owner": {"reputation": 21, "user_id": 3122351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PpODj.jpg?s=128&g=1", "display_name": "dFialok", "link": "https://stackoverflow.com/users/3122351/dfialok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1507730315, "creation_date": 1507729235, "last_edit_date": 1507730315, "question_id": 46689745, "link": "https://stackoverflow.com/questions/46689745/copy-paste-excel-supported-files-from-same-folder-into-single-excel", "title": "Copy paste Excel Supported files from same folder into single excel", "body": "<p>I have 2 different type of files. 1 is \".tsv\" 2 is \".xlsx\". </p>\n\n<p>I want my macro (.xlsm) file to be in same folder where 2 different files (.tsv and .xlsx) are placed. I usually download them from some tools and normally they are placed in my default \"Download\" folder. </p>\n\n<p>Problem 1: I want my macro file to read both format and copy paste data into single excel file. I am done with this problem. Code optimization is required.</p>\n\n<p>Problem 2: I am currently assigning manual path to that folder and want macro to pick that folder path so that it can copy 2 extension files and proceed. \n(Tried : <code>ActiveWorkbook.Path</code>, didn't work). </p>\n\n<pre><code>Dim FPath As String, filename As String, FileExt1 As String, FileExt2 As \nString\n\nSub GetSheets()\nFPath = \"C:\\Users\\dinekuma\\Desktop\\Dinesh KT\\Macro New UI\\\"\nFileExt1 = \"*.tsv\"\nFileExt2 = \"*.xlsx\"\n\n'ActiveWorkbook.Path\n'\"C:\\Users\\dinekuma\\Desktop\\Dinesh KT\\Macro New UI\\\"\n\nfilename = Dir(FPath &amp; FileExt1)\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n  Do While filename &lt;&gt; \"\"\n  Workbooks.Open filename:=FPath &amp; filename, ReadOnly:=True\n     For Each sheet In ActiveWorkbook.Sheets\n     sheet.Copy After:=ThisWorkbook.Sheets(1)\n    ActiveSheet.Name = Split(filename, \".\")(0)\n       Next sheet\n     Workbooks(filename).Close\n     filename = Dir()\n\n  Loop\n\n  filename = Dir(FPath &amp; FileExt2)\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n  Do While filename &lt;&gt; \"\"\n  Workbooks.Open filename:=FPath &amp; filename, ReadOnly:=True\n     For Each sheet In ActiveWorkbook.Sheets\n sheet.Copy After:=ThisWorkbook.Sheets(1)\nActiveSheet.Name = Split(filename, \".\")(0)\n   Next sheet\n Workbooks(filename).Close\n filename = Dir()\n\n  Loop\n  MsgBox (\"Import Successful!\")\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Help in code optimization and automatic path pick by active macro file.</p>\n"}, {"tags": ["vba", "excel", "worksheet-function", "worksheet"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1507729025, "post_id": 46689650, "comment_id": 80327041, "body": "If you need help with your code, please include it in your question."}, {"owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1507729516, "post_id": 46689650, "comment_id": 80327414, "body": "You need <code>SumIf</code>, but please, a @braX mentioned, post your code or what you have tried until now."}, {"owner": {"reputation": 3, "user_id": 8617285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09a8e2848166ea3176a363f466259613?s=128&d=identicon&r=PG&f=1", "display_name": "Rusbravah", "link": "https://stackoverflow.com/users/8617285/rusbravah"}, "reply_to_user": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "edited": false, "score": 0, "creation_date": 1507732830, "post_id": 46689650, "comment_id": 80329898, "body": "You&#39;re correct @Moacir, I&#39;ve edited my question, I just thought it is too simple to even include it, but I was wrong."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507734099, "post_id": 46689650, "comment_id": 80330806, "body": "Now you just need to make it loop through all unique code values, to make it you can use <code>x = Application.WorksheetFunction.CountIf(rng, c)</code> and the condition can be <code>If x = 1 Then &#39;do the sumif&#39;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "edited": false, "score": 0, "creation_date": 1507734603, "post_id": 46691764, "comment_id": 80331135, "body": "It looks like your activities start on row 5. If not you would change the initial cell selected :)"}, {"owner": {"reputation": 3, "user_id": 8617285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09a8e2848166ea3176a363f466259613?s=128&d=identicon&r=PG&f=1", "display_name": "Rusbravah", "link": "https://stackoverflow.com/users/8617285/rusbravah"}, "edited": false, "score": 0, "creation_date": 1507739012, "post_id": 46691764, "comment_id": 80334004, "body": "Thank you, @Leroy, that is exactly what I needed! Thanks to all the other as well, off course."}], "tags": [], "owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "is_accepted": true, "score": 0, "last_activity_date": 1507735661, "last_edit_date": 1507735661, "creation_date": 1507734506, "answer_id": 46691764, "question_id": 46689650, "link": "https://stackoverflow.com/questions/46689650/time-count-based-on-condition/46691764#46691764", "title": "Time count based on condition", "body": "<p>How about storing your activity types in an array? You can loop through each activity and then loop through each row to check the activity type, adding the time between that and the next row if it's a match</p>\n\n<pre><code>Sub sumHours()\nDim activityList As Variant\nDim activity As Variant\nDim rowCount As Integer\nDim countHours As Date\n\nactivityList = Array(\"M\", \"R\", \"Dv\")\n\nRange(\"U5\").Select\nRange(Selection, Selection.End(xlDown)).Select\nrowCount = Selection.Rows.Count\n\nFor Each activity In activityList\ncountHours = 0\n    For i = 5 To rowCount + 5\n        If Range(\"U\" &amp; i) = activity Then\n            countHours = countHours + Range(\"S\" &amp; i + 1) - Range(\"S\" &amp; i)\n        End If\n    Next i\n\n    Select Case activity\n        Case Is = \"M\"\n        Range(\"E35\") = countHours\n\n        Case Is = \"R\"\n        Range(\"E36\") = countHours\n\n        Case Is = \"Dv\"\n        Range(\"E37\") = countHours\n    End Select\nNext activity\nEnd Sub\n</code></pre>\n\n<p>(Make sure the cells that will hold the timevalues are formatted with the \"Time\" data type.</p>\n"}], "owner": {"reputation": 3, "user_id": 8617285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09a8e2848166ea3176a363f466259613?s=128&d=identicon&r=PG&f=1", "display_name": "Rusbravah", "link": "https://stackoverflow.com/users/8617285/rusbravah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 46691764, "answer_count": 1, "score": 0, "last_activity_date": 1507735661, "creation_date": 1507728980, "last_edit_date": 1531164843, "question_id": 46689650, "link": "https://stackoverflow.com/questions/46689650/time-count-based-on-condition", "title": "Time count based on condition", "body": "<p>I've been trying hard to figure this one out, see if anyone could give me some directions, please.</p>\n\n<p>I have a worksheet in which I put the activities performed through the day (column W), so I have a report for every day. Each activity has a type defined by a letter listed in a drop down menu (column U), for example: 'R' for <em>'Reporting'</em>, 'M' for <em>'Meeting'</em> etc, and a duration in hours (HH:mm) (column S).</p>\n\n<p>What I want my worksheet to do is to sum all the durations of the activities based on their type and store the results in a diferent cell. In the image example attached, I'd have to have 3:30 h for <em>Meeting</em>, 4:30 for <em>Reporting</em> and 2 h for <em>Drawing</em>.</p>\n\n<p>What the following SumIf code does is to sum all the hours, but it is not acounting for the duration, once the duration is the difference between the time in the next row and the time of the row in which the conditional argument is. </p>\n\n<pre><code>Sub test_count_hours()\n\nRange(\"E35\").Value = WorksheetFunction.SumIf(Range(\"U8:U37\"), \"R\", Range(\"S8:S37\"))\n\nEnd Sub\n</code></pre>\n\n<p>So my struggle is to make the code acounting for the duration of the events.</p>\n\n<p>Example of a filled Worksheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/6of23.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6of23.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507728828, "post_id": 46689398, "comment_id": 80326900, "body": "The entire row where a value is found or up to and including the last column in the row where values are present? Can there be blanks within the range to be copied?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507728948, "post_id": 46689398, "comment_id": 80326973, "body": "If you have a set number of columns to copy next to found cell you could use resize method to capture adjacent cell values."}, {"owner": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507729096, "post_id": 46689398, "comment_id": 80327090, "body": "The entire row there a value is found, say, columns A:Z, (even though the value found was on column E), All columns in both sheets match (A:Z)."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1507729145, "post_id": 46689398, "comment_id": 80327125, "body": "<code>sh2.Rows(Lastrow).Value = Sh1.Rows(iRow1).Value</code>"}, {"owner": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "edited": false, "score": 0, "creation_date": 1507729525, "post_id": 46689398, "comment_id": 80327429, "body": "Scott Craner again got it just perfectly! He is really one of the best here! Thanks once again Scott!!"}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "edited": false, "score": 0, "creation_date": 1507729565, "post_id": 46689753, "comment_id": 80327447, "body": "Perfect! Same as Scott&#180;s answer. Worked like a charm!"}, {"owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "reply_to_user": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "edited": false, "score": 0, "creation_date": 1507729730, "post_id": 46689753, "comment_id": 80327594, "body": "@Roca Yeah didn&#39;t see his reply. I edited my post to give him some credit too."}], "tags": [], "owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "is_accepted": true, "score": 0, "last_activity_date": 1507729646, "last_edit_date": 1507729646, "creation_date": 1507729267, "answer_id": 46689753, "question_id": 46689398, "link": "https://stackoverflow.com/questions/46689398/copy-entire-row-to-another-worksheet/46689753#46689753", "title": "Copy entire row to another worksheet", "body": "<p>You need to change the following line.</p>\n\n<pre><code>Sh2.Cells(Lastrow, \"E\") = Sh1.Cells(iRow1, \"E\")\n</code></pre>\n\n<p>To</p>\n\n<pre><code>Sh2.Rows(Lastrow).Value = Sh1.Rows(iRow1).Value\n</code></pre>\n\n<p><strong>EDIT</strong>: Didn't see @Scott Craner reply since I do not read answers. Guess we can give him some credits for this answer :)</p>\n"}], "owner": {"reputation": 69, "user_id": 8610459, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/eb95bd8ea7e1fdd9f2e75ce267c1121e?s=128&d=identicon&r=PG&f=1", "display_name": "Roca", "link": "https://stackoverflow.com/users/8610459/roca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 46689753, "answer_count": 1, "score": 0, "last_activity_date": 1507729646, "creation_date": 1507728259, "last_edit_date": 1507729371, "question_id": 46689398, "link": "https://stackoverflow.com/questions/46689398/copy-entire-row-to-another-worksheet", "title": "Copy entire row to another worksheet", "body": "<p>I have a code that looks for new values in another worksheet and copies the new values to 1 row down my original worksheet, works perfectly, however, now, I need to change the code to copy not only the new found value (1 cell), but the entire row, I tried changing the code but I cannot get it to work, here is the code that copies only one cell:</p>\n\n<pre><code> Dim Lastrow       As Long  'the last row in Sheet2 col E\n   Dim iRow1         As Long  'the row number on Sheet1\n   Dim Sh1           As Worksheet\n   Dim Sh2           As Worksheet\n\n   Set Sh2 = ThisWorkbook.Worksheets(\"originalwkb\")\n Set Sh1 = Workbooks(\"383839.xlsb\").Sheets(3)\n\nThisWorkbook.Activate\n   Lastrow = Sh2.Range(\"e65536\").End(xlUp).Row\n\n   iRow1 = 2\n\n  ' Loop through values in column E of Sheet1\n\n\n   Do\n      Set FindCell = Sh2.Range(\"E2\", Sh2.Cells(Lastrow, \"E\")).Find(What:=Sh1.Cells(iRow1, \"E\"), _\n             After:=Sh2.Range(\"E2\"), LookIn:=xlValues, LookAt:=xlWhole)\n      If FindCell Is Nothing Then\n         'add to bottom of list\n         Lastrow = Lastrow + 1\n         Sh2.Cells(Lastrow, \"E\") = Sh1.Cells(iRow1, \"E\")\n      End If\n      iRow1 = iRow1 + 1\n   Loop Until IsEmpty(Sh1.Cells(iRow1, \"E\"))\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "edited": false, "score": 0, "creation_date": 1507798546, "post_id": 46689632, "comment_id": 80357434, "body": "Where Can I find a tutorial on how to do this?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "edited": false, "score": 0, "creation_date": 1507812328, "post_id": 46689632, "comment_id": 80366344, "body": "<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-find-method-excel\" rel=\"nofollow noreferrer\">Using Range.Find Method</a>."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "edited": false, "score": 0, "creation_date": 1507812819, "post_id": 46689632, "comment_id": 80366638, "body": "Using <a href=\"https://msdn.microsoft.com/en-us/library/w4t2e92e(v=vs.90).aspx\" rel=\"nofollow noreferrer\">Err.Raise Method</a> in VBA"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1507813152, "last_edit_date": 1507813152, "creation_date": 1507728916, "answer_id": 46689632, "question_id": 46689394, "link": "https://stackoverflow.com/questions/46689394/vba-user-form-gives-warning-if-duplicate-is-found/46689632#46689632", "title": "VBA User form gives warning if duplicate is found", "body": "<p>You can add the following code to search for your policy number, and if nothing found then <code>PolLookup = Nothing</code>.</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    On Error GoTo ErrHandler\n\n    Dim ws As Worksheet, PolLookup As Range, LookupRng As Range\n    Set ws = ThisWorkbook.Worksheets(1)\n\n    'This is the range you want to search, it can be a long range\n    'or it can be a single cell.\n    Set LookupRng = ws.Range(\"A:A\")\n\n    'Range.Find is looking for your value in the range you specified above\n    Set PolLookup = LookupRng.Find(\"YourLookupValue\")\n\n    'PolLookup = Nothing if it didn't find a match, so we want to use\n    'If &lt;NOT&gt; Nothing, because this suggests .Find found your value\n    If Not PolLookup Is Nothing Then\n        Err.Raise vbObjectError + 0 'Whatever error you want to throw for finding a match\n    End If\n\n    'Exit before you reach the ErrHandler\n    Exit Sub\nErrHandler:\n    If Err.Number = vbObjectError + 0 Then\n        'Handle your error. Do you want to stop completely? Or have the\n        'User enter a new value?\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Basically, after your user enters their value in your UserForm, just make a call to this Sub to do a quick lookup.</p>\n"}, {"tags": [], "owner": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "is_accepted": true, "score": 0, "last_activity_date": 1508139010, "creation_date": 1508139010, "answer_id": 46765055, "question_id": 46689394, "link": "https://stackoverflow.com/questions/46689394/vba-user-form-gives-warning-if-duplicate-is-found/46765055#46765055", "title": "VBA User form gives warning if duplicate is found", "body": "<p>Playing around I discovered a Much easier way! I included a Button with he following code attached</p>\n\n<pre><code>Private Sub CommandButton8_Click()\nSearch = PolBX.Text\nSet FoundCell = Worksheets(\"sheet1\").Columns(7).Find(Search,LookIn:=xlValues, lookat:=xlWhole)\nIf FoundCell Is Nothing Then\nMsgBox \"No duplicates found\"\nElse\nMsgBox \"This policy has already been Assessed\" &amp; \"Please assess a different case\"\nPolBX.Value = \"\"\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1434, "favorite_count": 0, "accepted_answer_id": 46765055, "answer_count": 2, "score": -2, "last_activity_date": 1508139010, "creation_date": 1507728233, "last_edit_date": 1507803363, "question_id": 46689394, "link": "https://stackoverflow.com/questions/46689394/vba-user-form-gives-warning-if-duplicate-is-found", "title": "VBA User form gives warning if duplicate is found", "body": "<p>I think I need to try and make this question easier. So here goes;</p>\n\n<p>I am creating a User form in Excel that will act as a data capture form. </p>\n\n<p>In this form I have a Textbox called <code>PolBX</code> In this a is placed and at submission data in  <code>PolBX</code> is copied into the \"G\" column using this code </p>\n\n<p><code>Cells(emptyRow, 7).Value = PolBX.Value</code>. This works great.</p>\n\n<p>I discovered that there may be instances where the User may accidently use the same Unique Id number twice. so I am trying to find out how to code it that after the User has entered the Unique Id number it would check for that string (Consists of letters and numbers). if it finds the string already in the 7th column(G) it must say something like </p>\n\n<p><code>\"Policy number already Used, please try again\"</code> </p>\n\n<p>I am thinking I will need to use the following subroutine</p>\n\n<pre><code>Private Sub PolBX_AfterUpdate()\n\nEnd Sub\n</code></pre>\n\n<p>Can some please assist with creating this code... \nAlso can you please explain what you are doing as I started VBA about a week ago</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 1843, "user_id": 5793786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77c8c934fd9b5dcd38885b22e9bdeff7?s=128&d=identicon&r=PG", "display_name": "Maarten van Stam", "link": "https://stackoverflow.com/users/5793786/maarten-van-stam"}, "is_accepted": false, "score": 2, "last_activity_date": 1507733418, "creation_date": 1507733418, "answer_id": 46691346, "question_id": 46689382, "link": "https://stackoverflow.com/questions/46689382/change-method-of-save-in-word/46691346#46691346", "title": "Change method of save in Word", "body": "<p>What you need to do is 'catch' the Save event by adding an event handler before save happens.</p>\n\n<p>Look at this post where they ask for something similar:\n<a href=\"https://stackoverflow.com/questions/24702493/how-to-run-a-macro-in-word-before-save\">How to run a macro in Word before save?</a></p>\n\n<p>It depends on you environment (Add-in, VBA, other) what exactly the eventhandler looks like but if you Google for DocumentBeforeSave you should be able to find enough examples.</p>\n"}], "owner": {"reputation": 1499, "user_id": 1620690, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/3dfb968524717a6acfec9d3bef01da53?s=128&d=identicon&r=PG", "display_name": "AJF", "link": "https://stackoverflow.com/users/1620690/ajf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593902733, "creation_date": 1507728211, "last_edit_date": 1593902733, "question_id": 46689382, "link": "https://stackoverflow.com/questions/46689382/change-method-of-save-in-word", "title": "Change method of save in Word", "body": "<p>I would like to know if it is possible to change the way of saving a Word document.  What I want to do is have a button to save the word document which I have done successfully but if the Save button on the Ribbon or the Save\\Save As option is selected a message is displayed instructing the user to save using the button on the document.  How can this be done please? </p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "edited": false, "score": 0, "creation_date": 1507728404, "post_id": 46689359, "comment_id": 80326549, "body": "Welcome to the site!  Check out the <a href=\"https://stackoverflow.com/help/how-to-ask\">how-to-ask page</a> for more about asking questions that will attract quality answers.  You can <a href=\"https://stackoverflow.com/posts/46689359/edit\">edit your question</a> to include more information.  As braX noted, what have you tried?  Did your &quot;research so far&quot; include Google and MSDN?  And have you consided manual page breaks? ;)"}, {"owner": {"reputation": 72, "user_id": 8752768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf62c1c58450e679aa6f052dd9459ff?s=128&d=identicon&r=PG&f=1", "display_name": "CrystalRain", "link": "https://stackoverflow.com/users/8752768/crystalrain"}, "edited": false, "score": 0, "creation_date": 1507728683, "post_id": 46689359, "comment_id": 80326791, "body": "Added the code so far. Yea Manual page breaks would&#39;ve been my Workaround, but there has to be an easier solution."}], "answers": [{"comments": [{"owner": {"reputation": 72, "user_id": 8752768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf62c1c58450e679aa6f052dd9459ff?s=128&d=identicon&r=PG&f=1", "display_name": "CrystalRain", "link": "https://stackoverflow.com/users/8752768/crystalrain"}, "edited": false, "score": 0, "creation_date": 1507728860, "post_id": 46689457, "comment_id": 80326919, "body": "What does the Parameter 12 stand for?"}, {"owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "reply_to_user": {"reputation": 72, "user_id": 8752768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf62c1c58450e679aa6f052dd9459ff?s=128&d=identicon&r=PG&f=1", "display_name": "CrystalRain", "link": "https://stackoverflow.com/users/8752768/crystalrain"}, "edited": false, "score": 0, "creation_date": 1507728978, "post_id": 46689457, "comment_id": 80326999, "body": "A manual page break.  Word uses some of the non-ASCII characters for special codes, e.g., 5 for a comment mark and 12 for a page break.  <a href=\"https://support.office.microsoft.com/en-US/article/Find-and-replace-text-and-other-data-in-a-Word-document-c6728c16-469e-43cd-afe4-7708c6c779b7\" rel=\"nofollow noreferrer\">Find-dialog codes</a> like <code>^12</code> also use those numbers."}], "tags": [], "owner": {"reputation": 15409, "user_id": 2877364, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0a101160e41fd7fd75f5fc701f8acb1c?s=128&d=identicon&r=PG", "display_name": "cxw", "link": "https://stackoverflow.com/users/2877364/cxw"}, "is_accepted": true, "score": 1, "last_activity_date": 1507728908, "last_edit_date": 1507728908, "creation_date": 1507728453, "answer_id": 46689457, "question_id": 46689359, "link": "https://stackoverflow.com/questions/46689359/word-vba-jump-to-next-page/46689457#46689457", "title": "Word vba jump to next page", "body": "<pre><code>ActiveDocument.StoryRanges(wdMainTextStory).InsertAfter ChrW(12)\n</code></pre>\n\n<p>will insert a hard page break at the end of your text.  (Or, in general, <code>r.InsertAfter ChrW(12)</code> for a <code>Range</code> variable <code>r</code>.  Then you can carry on from there!  </p>\n\n<h3>Edit</h3>\n\n<p>Now that you've added code, I can show you more.  However, since you didn't include all the code, I can't provide something that will run as is.   Also, I think you can replace <code>CurrentDate</code> with <code>i</code> (or vice versa).</p>\n\n<pre><code>For i = InitDate To endDate\njump:\n  If CurrentDate = endDate Then GoTo EndSub\n    x = x + 1\n    strWeekday = weekday(CurrentDate, vbUseSystemDayOfWeek)\n    txtStr = Format(CurrentDate, \"dddddd\")\n    With Selection\n         .Font.Bold = True\n         .Font.Underline = True\n         .TypeText Text:=txtStr\n         .TypeParagraph\n    End With\n\n     ' ** By the way, I would suggest you not GoTo out of a With block - that strikes me as likely to cause confusion later on.\n     If x = 4 Then GoTo Donnerstag  \n     If x = 5 Then GoTo Freitag\n     'If x = 6 Then GoTo NewSheet\n     If x = 6 Then       ' ** Try this\n         Selection.InsertAfter ChrW(12)\n         Selection.Collapse wdCollapseEnd\n     End If\n     If x = 6 Then x = 0\n\n     Selection.TypeParagraph\n     CurrentDate = CurrentDate + 1\nNext i\n</code></pre>\n"}], "owner": {"reputation": 72, "user_id": 8752768, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/faf62c1c58450e679aa6f052dd9459ff?s=128&d=identicon&r=PG&f=1", "display_name": "CrystalRain", "link": "https://stackoverflow.com/users/8752768/crystalrain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 754, "favorite_count": 0, "accepted_answer_id": 46689457, "answer_count": 1, "score": 2, "last_activity_date": 1507728908, "creation_date": 1507728129, "last_edit_date": 1507728607, "question_id": 46689359, "link": "https://stackoverflow.com/questions/46689359/word-vba-jump-to-next-page", "title": "Word vba jump to next page", "body": "<p>Okay,</p>\n\n<p>so for my apprenticeship I need to keep record of what I do everyday. Since this is going to be a long doc, I wrote a VBA script which already writes stuff that stays the same, like the date, in there. </p>\n\n<p>Problem is, the format is supposed to be one week per page. Means, when I arrive at saturday, the script would have to jump to the beginning of the next page(and probably fill the resulting space with paragraphs). And I have absolutely no clue if there is any function that could help me with that. I think there should be one tho, this doesn't Sound like a too exotic Problem.</p>\n\n<p>Now this is no crucial problem, but it's annoying nonetheless and I'd like to know if there is any solution for this. Research so far didn't do the trick either.</p>\n\n<p>Have some code if that helps understanding. Ist basically about the commented part:</p>\n\n<pre><code>For i = InitDate To endDate\njump:\n  If CurrentDate = endDate Then GoTo EndSub\n    x = x + 1\n    strWeekday = weekday(CurrentDate, vbUseSystemDayOfWeek)\n    txtStr = Format(CurrentDate, \"dddddd\")\n     With Selection\n     .Font.Bold = True\n     .Font.Underline = True\n     .TypeText Text:=txtStr\n     .TypeParagraph\n    If x = 4 Then GoTo Thursday\n    If x = 5 Then GoTo Friday\n   'If x = 6 Then GoTo NewSheet\n    If x = 6 Then x = 0\n\n    .TypeParagraph\n    End With\nCurrentDate = CurrentDate + 1\n\nNext i\n</code></pre>\n"}, {"tags": ["excel", "if-statement", "vba"], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "edited": false, "score": 0, "creation_date": 1507819145, "post_id": 46689239, "comment_id": 80371238, "body": "and u8it codes work like a charm, thank you. I just found out that in some cases I might have another row with  cell containing &quot;Current Status:&quot; value...Is there a way to modify that code to force it to ignore first found row and retrieve second occurrence if I need it? or maybe it is easier if the second value is found to put it cell in the next column    { ws.Range(&quot;A19&quot;) }"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "edited": false, "score": 0, "creation_date": 1507819334, "post_id": 46689239, "comment_id": 80371368, "body": "There are many ways, try some research and come back with a new question showing what you have tried."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1507727809, "creation_date": 1507727809, "answer_id": 46689239, "question_id": 46689164, "link": "https://stackoverflow.com/questions/46689164/vba-if-conditions/46689239#46689239", "title": "VBA if conditions", "body": "<p>Use Vlookup:</p>\n\n<pre><code>.Range(\"V\" &amp; NewRow) = \"0\"\nOn Error Resume Next\n.Range(\"V\" &amp; NewRow) = Application.WorksheetFunction.VLookup(\"Current Status:\", ws.Range(\"A:B\"), 2, False)\nOn Error GoTo 0\n</code></pre>\n\n<p>This will put 0 in the cell then try to replace it with the value returned from the vlookup.  If <code>\"Current Status:\"</code> is not found in column A on <code>ws</code> then it will throw an error and be ignored leaving <code>0</code> in the cell.</p>\n\n<p>If the value is found it will return the value in Column B and put that in place of the <code>0</code></p>\n"}, {"comments": [{"owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "edited": false, "score": 0, "creation_date": 1507819648, "post_id": 46689383, "comment_id": 80371616, "body": "Thank you very much, it shows how much is there to learn yet... :)"}], "tags": [], "owner": {"reputation": 3044, "user_id": 3546415, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2LyTD.png?s=128&g=1", "display_name": "u8it", "link": "https://stackoverflow.com/users/3546415/u8it"}, "is_accepted": true, "score": 2, "last_activity_date": 1507733004, "last_edit_date": 1507733004, "creation_date": 1507728212, "answer_id": 46689383, "question_id": 46689164, "link": "https://stackoverflow.com/questions/46689164/vba-if-conditions/46689383#46689383", "title": "VBA if conditions", "body": "<p>Just put your code in a <code>For</code> loop... or use <code>VLookup</code> like Scotty suggested. It's basically the same thing. A <code>For</code> loop is more flexible but less optimized (<code>VLookup</code> is faster). They both run on the order of fractions of a \u03bcs/cell.</p>\n\n<pre><code>For Each c In Range(\"A16:A20\")\n    If c.Value2 = \"Current Status:\" Then\n        .Range(\"V\" &amp; NewRow) = c.Offset(0, 1)\n        Exit For\n    Else\n        .Range(\"V\" &amp; NewRow) = \"0\"\n    End If\nNext\n</code></pre>\n\n<p>If using a <code>For</code> loop, this is a little bit more code than what's above but a better structure...</p>\n\n<pre><code>'Define a value holder variable where it's scope makes sense\nDim NewValue As String\n\n'... other code here ...\n\n'Default: NewValue = \"\"\nNewValue = \"\"\nFor Each c In Range(\"A16:A20\")\n    If c.Value2 = \"Current Status:\" Then\n        NewValue = c.Offset(0, 1)\n        'Exit For is optional in this case. It matters if\n        'there are multiple matches... do you want first or last result?\n        Exit For\n    End If\nNext\n'Assign NewValue to cell\n.Range(\"V\" &amp; NewRow) = NewValue\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 6556121, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vHvv3.jpg?s=128&g=1", "display_name": "FotoDJ", "link": "https://stackoverflow.com/users/6556121/fotodj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 46689383, "answer_count": 2, "score": 0, "last_activity_date": 1507733004, "creation_date": 1507727602, "last_edit_date": 1531164843, "question_id": 46689164, "link": "https://stackoverflow.com/questions/46689164/vba-if-conditions", "title": "VBA if conditions", "body": "<p>I wrote if condition which is shown below, it looks for value \"Current Status:\" in row A  and copy B value from that row to other sheet, if not not found \"0\" is placed in a cell, it works fine. Sometimes value \"Current Status:\" might be in a different cell than A18, it might show up in the range from A16 to A20, how can I modify that code to find it within the range and copy corresponding value?</p>\n\n<pre><code>If ws.Range(\"A18\") = \"Current Status:\" Then\n    .Range(\"V\" &amp; NewRow) = ws.Range(\"B18\")\n     Else\n        .Range(\"V\" &amp; NewRow) = \"0\"\n      End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507727950, "post_id": 46689163, "comment_id": 80326217, "body": "Is this all the code? As you have written it or with chr(38) will show &quot;&amp;&quot; in the msgbox"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1507727964, "post_id": 46689163, "comment_id": 80326227, "body": "Your code works just fine for me. It displays the &amp; just as you want."}, {"owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "edited": false, "score": 0, "creation_date": 1507728905, "post_id": 46689163, "comment_id": 80326949, "body": "Sorry I updated above"}], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 8661377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uyj1M.jpg?s=128&g=1", "display_name": "JonRo", "link": "https://stackoverflow.com/users/8661377/jonro"}, "is_accepted": true, "score": 1, "last_activity_date": 1507735179, "creation_date": 1507735179, "answer_id": 46691990, "question_id": 46689163, "link": "https://stackoverflow.com/questions/46689163/how-to-print-to-excel-from-vba/46691990#46691990", "title": "How to print &amp; to Excel from VBA", "body": "<p>Indeed normal behaviour, one time <code>Chr(38)</code> underlies the next character when busy in the <code>menuitems</code>. A <code>msgbox</code> will display a normal ampersand. If you want to use the ampersand as a character in a menuitem, use it twice as in <code>\"Exclude P\" &amp; Chr(38) &amp; Chr(38)  &amp; \"S\"</code>, or <code>\"Exclude P&amp;&amp;S\"</code>.</p>\n"}], "owner": {"reputation": 873, "user_id": 5103224, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/d7d1ca72bbff93c0a014b5b770482a53?s=128&d=identicon&r=PG&f=1", "display_name": "Lowpar", "link": "https://stackoverflow.com/users/5103224/lowpar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 46691990, "answer_count": 1, "score": -1, "last_activity_date": 1507735179, "creation_date": 1507727600, "last_edit_date": 1531164843, "question_id": 46689163, "link": "https://stackoverflow.com/questions/46689163/how-to-print-to-excel-from-vba", "title": "How to print &amp; to Excel from VBA", "body": "<p>I have been trying to code &amp;, as in the character &amp; chr(38), but it keeps underlying the word. any solution for this?</p>\n\n<pre><code>Private Sub createMenu()\n'define the variables\n    Dim mnuDownload1 As Menu\n\n    'create the menue bar\n    With MenuBars(xlWorksheet)\n        .Reset\n        .Menus.Add \"Import\", 1\n\n        'define the menue bar\n        Set mnuDownload1 = MenuBars(xlWorksheet).Menus(\"Import\")\n\n        'for each defined menu bar at the sub item , the first \"\" is the name of the item. The second \"\" is the macro name\n        With mnuDownload1.MenuItems\n         .AddMenu Caption:=\"P&amp;S\"\n         .Item(\"P&amp;S\").MenuItems.Add \"Exclude P\" &amp; Chr(38) &amp; \"S\", \"changes\"\n        End With\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1507727506, "post_id": 46689059, "comment_id": 80325835, "body": "You do not <code>Set</code> an Integer.  Remove the words <code>Set</code> from each line."}, {"owner": {"reputation": 1, "user_id": 8759106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed49e12a62ee7befb6019a99409103?s=128&d=identicon&r=PG&f=1", "display_name": "cfl", "link": "https://stackoverflow.com/users/8759106/cfl"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1507731704, "post_id": 46689059, "comment_id": 80329100, "body": "Thanks Scott - I tried this but then I get the error message saying &quot;compile error: object required&quot;..."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1507731869, "post_id": 46689059, "comment_id": 80329228, "body": "Then the values are not being found in the ranges.  You will need to change the code and test for that before trying to assign the row to the variable.  There is no row for a range that is nothing."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507731998, "post_id": 46689059, "comment_id": 80329326, "body": "I&#39;d suggest specifying the rest of the Find parameters in case they are not what you think they are. If the value is definitely physically there, think that must be the problem."}, {"owner": {"reputation": 1, "user_id": 8759106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed49e12a62ee7befb6019a99409103?s=128&d=identicon&r=PG&f=1", "display_name": "cfl", "link": "https://stackoverflow.com/users/8759106/cfl"}, "edited": false, "score": 0, "creation_date": 1507732538, "post_id": 46689059, "comment_id": 80329713, "body": "Ah - thanks Scott."}, {"owner": {"reputation": 1, "user_id": 8759106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed49e12a62ee7befb6019a99409103?s=128&d=identicon&r=PG&f=1", "display_name": "cfl", "link": "https://stackoverflow.com/users/8759106/cfl"}, "edited": false, "score": 0, "creation_date": 1507732613, "post_id": 46689059, "comment_id": 80329769, "body": "I&#39;ve deleted the set and unhidden the columns that the code is looking at to help see whether the item is in the range etc. Turns out the code works fine without the Set when the columns are visible but has the Compile error when the columns are hidden."}], "owner": {"reputation": 1, "user_id": 8759106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88ed49e12a62ee7befb6019a99409103?s=128&d=identicon&r=PG&f=1", "display_name": "cfl", "link": "https://stackoverflow.com/users/8759106/cfl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507727317, "creation_date": 1507727317, "last_edit_date": 1531164843, "question_id": 46689059, "link": "https://stackoverflow.com/questions/46689059/excel-vba-error-in-setting-value-using-find-function", "title": "Excel VBA: error in setting value using find function", "body": "<p>I'm a fairly inexperienced coder and have a small piece of code that is just falling over each time I run it (although I would swear it worked once and has since stopped!)</p>\n\n<p>I am trying to find a value from a cell (which has a formulas to determine which value I need to find) in a range of cells elsewhere in the spreadsheet.</p>\n\n<p>Originally my code was set as follows (when I think it worked) and I am getting an error message saying \"Compile error: object required\"</p>\n\n<p>I tried to add the word Set in the appropriate place to stop that but then I get a runtime error 91 message saying object variable or with block variable not set.</p>\n\n<p>My sub is in a class module set as option explicit and the code is as follows;</p>\n\n<pre><code>Dim StartRow As Integer\nDim EndRow As Integer\n\nSet StartRow = Sheets(\"CHARTS\").Range(\"T2:T9\").Find(What:=Sheets(\"CHARTS\").Range(\"O14\").Value, LookIn:=xlValues, Lookat:=xlWhole).row\nSet EndRow = Sheets(\"CHARTS\").Range(\"T2:T9\").Find(What:=Sheets(\"CHARTS\").Range(\"O13\").Value, LookIn:=xlValues, Lookat:=xlWhole).row\n</code></pre>\n\n<p>Any help gratefully received, I just can't see where I've gone wrong...!!</p>\n"}, {"tags": ["excel", "autohotkey", "vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1507727983, "post_id": 46688901, "comment_id": 80326241, "body": "You can use Win APIs for this. See: <a href=\"https://support.microsoft.com/en-us/help/183009/how-to-enumerate-windows-using-the-win32-api\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/183009/&hellip;</a>. It might be easier using a wrapper language like Autohotkey or AutoIT to do this."}, {"owner": {"reputation": 28153, "user_id": 2521004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/U6sn4.png?s=128&g=1", "display_name": "Automate This", "link": "https://stackoverflow.com/users/2521004/automate-this"}, "edited": false, "score": 1, "creation_date": 1507741713, "post_id": 46688901, "comment_id": 80335534, "body": "@Siddharth Rout has a solution on <a href=\"https://www.experts-exchange.com/questions/26817662/VBA-or-VBS-enumerate-all-open-Acrobat-Reader-documents.html\" rel=\"nofollow noreferrer\">this other forum</a>"}, {"owner": {"reputation": 47, "user_id": 3581687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3MnLW.png?s=128&g=1", "display_name": "mik_ste", "link": "https://stackoverflow.com/users/3581687/mik-ste"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1507746364, "post_id": 46688901, "comment_id": 80337998, "body": "@Ryan Wildry Thank you! I always forget I can use AHK to get around Excel VBA lack of functionality in some areas."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 1, "creation_date": 1507746507, "post_id": 46688901, "comment_id": 80338085, "body": "You are definitely better off using a language like that to reduce the complexity of looping through active windows. You can do it in VBA, but it gets messy."}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 3581687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3MnLW.png?s=128&g=1", "display_name": "mik_ste", "link": "https://stackoverflow.com/users/3581687/mik-ste"}, "is_accepted": true, "score": 0, "last_activity_date": 1507747281, "creation_date": 1507747281, "answer_id": 46695392, "question_id": 46688901, "link": "https://stackoverflow.com/questions/46688901/detect-and-list-all-open-pdf-files-from-excel-vba/46695392#46695392", "title": "Detect and list all open PDF files from excel VBA", "body": "<p>I was reminded in the comment by Ryan Wildry that I can use AHK for things like this. Here is the code I ended up using:</p>\n\n<p>First I set up a regex pattern in VBA so for how the PDF windows titles appear. Used a couple functions I pulled from the web for previous applications.</p>\n\n<p>Main VBA:</p>\n\n<pre><code>Private Sub Get_PDFs()\n\n    Dim pattern As String\n    Dim ahkParamColl As Collection\n    Dim windowArr() As String\n\n    'regex pattern to match with open Adobe PDF Files\n    pattern = \"^(.+)\\.pdf - Adobe Reader$\"\n\n    'add pattern to AHK parameter collection\n    Set ahkParamColl = Nothing\n    Set ahkParamColl = New Collection\n    ahkParamColl.Add (pattern)\n\n    'run window detection AHK Script\n    Call Functions.Run_AHK(\"Detect All Open Windows.ahk\", ahkParamColl)\n\n    'send list to array\n    windowArr = Split(GetClipBoardText, Chr(10))\n\nEnd Sub\n</code></pre>\n\n<p>Function to call AHK:</p>\n\n<pre><code>'these are for AHK scripts to run from Excel\nPublic Const ahk_ScriptsLoc = \"\"\"C:\\Location of Scripts\\\" 'starts w/a quote\nPublic Const ahk_PgmLoc = \"C:\\Location of AHK Pogram\\AHK.exe\"\n\n\nFunction Run_AHK(AHK_Script_Name As String, Optional Parameters As Collection)\n\n'Call AHK script from VBA\nDim i As Integer\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim windowStyle As Integer: windowStyle = 1\nDim AHKscript As String\nDim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\n\n    'set the ahk script string to call\n    AHKscript = ahk_PgmLoc &amp; \" \" &amp; ahk_ScriptsLoc &amp; AHK_Script_Name &amp; \"\"\" \"\"\"\n\n    'add parameters to script string\n    If Not Parameters Is Nothing Then\n        For Each s In Parameters\n            AHKscript = AHKscript &amp; s &amp; \"\"\" \"\"\"\n        Next s\n    End If\n\n    'run ahk script\n    wsh.Run AHKscript, windowStyle, waitOnReturn\n\nEnd Function\n</code></pre>\n\n<p>Function to get clipboard text:</p>\n\n<pre><code>Public Function GetClipBoardText()\n   Dim DataObj As MsForms.DataObject\n   Set DataObj = New MsForms.DataObject\n\n   On Error GoTo Whoa\n\n   '~~&gt; Get data from the clipboard.\n   DataObj.GetFromClipboard\n\n   '~~&gt; Get clipboard contents\n   myString = DataObj.GetText(1)\n   GetClipBoardText = myString\n\n   Exit Function\nWhoa:\n   If Err &lt;&gt; 0 Then MsgBox \"Data on clipboard is not text or is empty\"\nEnd Function\n</code></pre>\n\n<p>Main AHK (snagged from <a href=\"https://autohotkey.com/board/topic/15652-list-all-open-windows/\" rel=\"nofollow noreferrer\">Here</a>): </p>\n\n<pre><code>;regex pattern sent from calling application\npattern = %1%\n\n;get all window names and loop through\nWinGet windows, List\nLoop %windows%\n{\n    id := windows%A_Index%\n    WinGetTitle wt, ahk_id %id%\n    ;if window matches pattern, add to list\n    IF (RegexMatch(wt,pattern)&gt;0) then\n    {\n        s .= wt . \"`n\"\n    }\n}\n;send list to clipboard\nClipboard := s\n</code></pre>\n\n<p>So the VBA macro will set up the regex pattern to be sent to the AHK script. I can use this for other document types or naming patterns later if need be. AHK will then be called which loops through each open window, checks if it matches the defined pattern, then appends it to a string. This string is sent to the clipboard, which VBA then reads and splits into an Array for me to use.</p>\n\n<p>I'm sure there is probably a more efficient way out there, but this was a fun way and the only way I could put together.</p>\n"}], "owner": {"reputation": 47, "user_id": 3581687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3MnLW.png?s=128&g=1", "display_name": "mik_ste", "link": "https://stackoverflow.com/users/3581687/mik-ste"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1121, "favorite_count": 0, "accepted_answer_id": 46695392, "answer_count": 1, "score": 0, "last_activity_date": 1507747320, "creation_date": 1507726915, "last_edit_date": 1531164843, "question_id": 46688901, "link": "https://stackoverflow.com/questions/46688901/detect-and-list-all-open-pdf-files-from-excel-vba", "title": "Detect and list all open PDF files from excel VBA", "body": "<p>Is it possible to detect and list all open PDF files from excel Vba? I know I can check for a specific known PDF file and path, however in this case the file name and path will not be known.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507727309, "post_id": 46688807, "comment_id": 80325651, "body": "Where is the code you have tried so far and what error messages you are getting?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507727730, "post_id": 46688807, "comment_id": 80326010, "body": "Maybe this might help <a href=\"https://danny.fyi/embedding-and-accessing-a-file-in-excel-with-vba-and-ole-objects-4d4e7863cfff\" rel=\"nofollow noreferrer\">danny.fyi/&hellip;</a>"}], "owner": {"reputation": 1, "user_id": 8759081, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-svLCsK3HOLk/AAAAAAAAAAI/AAAAAAAAFQk/-NfKdzfoHkY/photo.jpg?sz=128", "display_name": "vinod krishnadas", "link": "https://stackoverflow.com/users/8759081/vinod-krishnadas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507726744, "creation_date": 1507726693, "last_edit_date": 1507726744, "question_id": 46688807, "link": "https://stackoverflow.com/questions/46688807/excel-vba-opening-embedded-picture-either-to-a-forms-picture-control-or-exter", "title": "Excel VBA: Opening embedded picture (Either to a form&#39;s picture control or external application)", "body": "<p>I have an excel sheet with a bunch of embedded images. How do I open one of the embedded images either in the default image viewer (for the system) or in a VBA Form's picture control?</p>\n\n<p>I tried the .Verb for OLEObjects, but that doesn't seem to work with pictures.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 4, "creation_date": 1507725924, "post_id": 46688516, "comment_id": 80324582, "body": "Have you tried <code>For X = WSLR To 2 Step -1</code>?"}, {"owner": {"reputation": 79, "user_id": 8066319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9w52.jpg?s=128&g=1", "display_name": "mystic_muffin", "link": "https://stackoverflow.com/users/8066319/mystic-muffin"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1507726167, "post_id": 46688516, "comment_id": 80324762, "body": "That worked! So close yet oh so far :(  I really appreciate it!"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1507726194, "post_id": 46688516, "comment_id": 80324783, "body": "Should I add it as an answer? :P"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507726241, "post_id": 46688516, "comment_id": 80324823, "body": "Or you could use the <code>Find</code> method."}, {"owner": {"reputation": 79, "user_id": 8066319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9w52.jpg?s=128&g=1", "display_name": "mystic_muffin", "link": "https://stackoverflow.com/users/8066319/mystic-muffin"}, "edited": false, "score": 1, "creation_date": 1507726297, "post_id": 46688516, "comment_id": 80324857, "body": "May as well. I spent an embarrassingly long time looking for someone asking a similar question... maybe we can help another nooblet too!"}, {"owner": {"reputation": 10287, "user_id": 2545784, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4zVa6.png?s=128&g=1", "display_name": "LS_\u1d05\u1d07\u1d20", "link": "https://stackoverflow.com/users/2545784/ls-%e1%b4%85%e1%b4%87%e1%b4%a0"}, "edited": false, "score": 1, "creation_date": 1507726314, "post_id": 46688516, "comment_id": 80324867, "body": "Many alternatives could be used, braX answer address OP issue."}], "answers": [{"tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": true, "score": 1, "last_activity_date": 1507726211, "creation_date": 1507726211, "answer_id": 46688630, "question_id": 46688516, "link": "https://stackoverflow.com/questions/46688516/find-the-last-occurrence-of-a-value-and-display-in-textbox/46688630#46688630", "title": "Find the last occurrence of a value and display in textbox", "body": "<p>Have you tried <code>For X = WSLR To 2 Step -1</code>? </p>\n"}], "owner": {"reputation": 79, "user_id": 8066319, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Y9w52.jpg?s=128&g=1", "display_name": "mystic_muffin", "link": "https://stackoverflow.com/users/8066319/mystic-muffin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 46688630, "answer_count": 1, "score": 0, "last_activity_date": 1507726211, "creation_date": 1507725843, "question_id": 46688516, "link": "https://stackoverflow.com/questions/46688516/find-the-last-occurrence-of-a-value-and-display-in-textbox", "title": "Find the last occurrence of a value and display in textbox", "body": "<p>I have a simple userform that has 2 textboxes. 1 for a job entry, 1 for a location display.</p>\n\n<p>I want to track the location of parts by scanning a barcode every time they get to a new location in our facility. This means that I may have the same barcode # like 4 or 5 times.</p>\n\n<p>In my userform, when the user either types in a job number, or scans a barcode into that first textbox, the second textbox is going to show the last recorded location of the part.</p>\n\n<p>The code I've written seems to only find the first time the job number is recorded though... I'm unsure how to get it to search from the bottom up, rather than the top down.</p>\n\n<p>Can anyone advise? I'm having a lot of trouble figuring out how to populate userforms with data already written on a sheet. Any advice or direction to reading materials specifically regarding this would be much appreciated!</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Private Sub txtSCAN_BARCODE_FIND_Change()\n 'LOOP THROUGH DATABASE AND FIND THE PART LOCATION\n Dim WS As Worksheet\n Set WS = ThisWorkbook.Sheets(\"DATABASE\")\n WSLR = WS.Cells(Rows.Count, 1).End(xlUp).Row\n\n For X = 2 To WSLR\n     'This is the job number we're looking for\n     If WS.Cells(X, 1) = Me.txtSCAN_BARCODE_FIND Then\n         'This is where the last recorded position is going to display\n         Me.txtLOCATION_FIND = WS.Cells(X, \"F\")\n         Exit Sub\n     End If\n Next X\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "if-statement", "excel-formula", "vlookup", "vba"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 4, "creation_date": 1507724652, "post_id": 46688133, "comment_id": 80323716, "body": "1. Your title should describe your problem, not be a general plea. 2. Format your code by highlighting it and press ctrl+k while editing."}, {"owner": {"reputation": 326, "user_id": 5586958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfb8771459ceed79fa8502fbf9ce02c?s=128&d=identicon&r=PG&f=1", "display_name": "Lexi", "link": "https://stackoverflow.com/users/5586958/lexi"}, "edited": false, "score": 3, "creation_date": 1507724685, "post_id": 46688133, "comment_id": 80323748, "body": "Also this site is run by volunteers answering questions so requesting &quot;urgent help&quot; will not actually help you."}, {"owner": {"reputation": 326, "user_id": 5586958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bfb8771459ceed79fa8502fbf9ce02c?s=128&d=identicon&r=PG&f=1", "display_name": "Lexi", "link": "https://stackoverflow.com/users/5586958/lexi"}, "edited": false, "score": 3, "creation_date": 1507724885, "post_id": 46688133, "comment_id": 80323867, "body": "Also someone beat me to editing it but please don&#39;t write run-on sentences and use proper punctuation. Your question was really hard to read"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 1, "creation_date": 1507726506, "post_id": 46688133, "comment_id": 80325015, "body": "Please take the <a href=\"https://stackoverflow.com/tour\">tour</a>, read <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>. Please verify <a href=\"http://meta.stackoverflow.com/q/284236\">Why is \u201cCan someone help me?\u201d not an actual question?</a> and then please edit your question."}, {"owner": {"reputation": 18763, "user_id": 472495, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/4rtxd.png?s=128&g=1", "display_name": "halfer", "link": "https://stackoverflow.com/users/472495/halfer"}, "edited": false, "score": 2, "creation_date": 1507727011, "post_id": 46688133, "comment_id": 80325434, "body": "Please read <a href=\"//meta.stackoverflow.com/q/326569\">Under what circumstances may I add \u201curgent\u201d or other similar phrases to my question, in order to obtain faster answers?</a> - the summary is that this is not an ideal way to address volunteers, and is probably counterproductive to obtaining answers. Please refrain from adding this to your questions."}, {"owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "edited": false, "score": 0, "creation_date": 1507735277, "post_id": 46688133, "comment_id": 80331602, "body": "What version of Excel do you have?  If you have version &gt;= 2010, you can use <code>Conditional Formatting</code> to do the comparison.  Here is something for your reference (<a href=\"http://blog.contextures.com/archives/2010/09/03/conditional-formatting-from-different-sheet/\" rel=\"nofollow noreferrer\">blog.contextures.com/archives/2010/09/03/&hellip;</a>)."}], "answers": [{"tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 0, "last_activity_date": 1507735515, "creation_date": 1507735515, "answer_id": 46692107, "question_id": 46688133, "link": "https://stackoverflow.com/questions/46688133/how-to-do-this-lookup-operation-in-excel/46692107#46692107", "title": "How to do this lookup operation in Excel", "body": "<p>Try this array formula in cell A1 of sheet3 and drag across and down.</p>\n\n<blockquote>\n  <p>=IF(AND(EXACT(Sheet1!1:1,Sheet2!1:1)),\"\",Sheet1!A1)</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "edited": false, "score": 0, "creation_date": 1543587162, "post_id": 46692290, "comment_id": 93983782, "body": "I believe <code>VLOOKUP()</code> is equal to <code>RECHERCHEV()</code>."}], "tags": [], "owner": {"reputation": 9, "user_id": 8184556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b934c3a115321e555686c168be7a4913?s=128&d=identicon&r=PG&f=1", "display_name": "JBond", "link": "https://stackoverflow.com/users/8184556/jbond"}, "is_accepted": false, "score": 0, "last_activity_date": 1507736066, "creation_date": 1507736066, "answer_id": 46692290, "question_id": 46688133, "link": "https://stackoverflow.com/questions/46688133/how-to-do-this-lookup-operation-in-excel/46692290#46692290", "title": "How to do this lookup operation in Excel", "body": "<p>Not really sure what you're looking to do here, and I don't speak french, but it looks like you have an extra parenthesis before your 2nd RECHERCHEV function.</p>\n\n<p>Try this :</p>\n\n<pre><code>=If(RECHERCHEV(A2,sheet1!A8:FM264,1,FAUX)=RECHERCHEV(A2,sheet2!A8:FM257,1,FAUX);\"\";RECHERCHEV(A2,sheet1!A8:FM264,1,FAUX))\n</code></pre>\n\n<p>Though I'm not sure why the IF function uses semi-colons, but the RECHERCHEV uses commas, so maybe this:</p>\n\n<pre><code>=If(RECHERCHEV(A2,sheet1!A8:FM264,1,FAUX)=RECHERCHEV(A2,sheet2!A8:FM257,1,FAUX),\"\",RECHERCHEV(A2,sheet1!A8:FM264,1,FAUX))\n</code></pre>\n\n<p>Also it seems you want the entire row to update, so I am not sure how this vlookup would work since the arrays start in different rows than the lookup value.</p>\n"}], "owner": {"reputation": 9, "user_id": 8758830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-nGE9OG2PxNk/AAAAAAAAAAI/AAAAAAAAA38/UcvDR89FM8k/photo.jpg?sz=128", "display_name": "nyfin paul", "link": "https://stackoverflow.com/users/8758830/nyfin-paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 2, "score": -11, "last_activity_date": 1507736066, "creation_date": 1507724575, "last_edit_date": 1531161705, "question_id": 46688133, "link": "https://stackoverflow.com/questions/46688133/how-to-do-this-lookup-operation-in-excel", "title": "How to do this lookup operation in Excel", "body": "<p>There are two sheets (sheet1 &amp; sheet2) in my Excel file, it's like daily work routine (entry date, pickup date, dispatch date). Some details will change as per the work flow and even new entries will appear.</p>\n\n<p>I just need to compare both files if a change occurred in one cell it must have to show entire row of sheet1 (I can't specify exact headline for that all details are too precious and it has more than 100 headlines).</p>\n\n<p>So if there is any formula for that please let me know like</p>\n\n<pre><code>IF+VLOOKUP\n</code></pre>\n\n<p>please correct below given formula</p>\n\n<pre><code>=If(RECHERCHEV(A2,sheet1!A8:FM264,1,FAUX)=(RECHERCHEV(A2,sheet2!A8:FM257,1,FAUX);\"\";RECHERCHEV(A2,sheet1!A8:FM264,1,FAUX))\n</code></pre>\n\n<p>It's the French version.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507724868, "post_id": 46688046, "comment_id": 80323856, "body": "Why not just copy the active sheet rather than add a new sheet and copy to it? I guess your code doesn&#39;t work because the active sheet is the new sheet added (<code>wsNew</code>). Use the variables you have sensibly set up. Also, don&#39;t use <code>Value</code> in your copy line."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1507725152, "post_id": 46688046, "comment_id": 80324060, "body": "To elaborate, eg in this line <code>wsNew.Range(&quot;A7&quot;).Value = ActiveSheet.Range(&quot;A37&quot;).Value + 1</code>, <code>wsNew</code> and <code>ActiveSheet</code> are the same."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1507727661, "post_id": 46688046, "comment_id": 80325968, "body": "Firstly, you already set your two sheet objects. Why are you still using <code>ActiveSheet</code> in your code? Replace <code>ActiveSheet</code> with whatever sheet you are wanting it to represent, whether it be <code>wsToCopy</code> or <code>wsNew</code>."}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 0, "last_activity_date": 1507727832, "creation_date": 1507727832, "answer_id": 46689246, "question_id": 46688046, "link": "https://stackoverflow.com/questions/46688046/copying-timesheet-vba/46689246#46689246", "title": "Copying Timesheet VBA", "body": "<p>As I stated in my comment, since you already set your two sheets with <code>wsToCopy</code> and <code>wsNew</code>, why would you still need to use <code>ActiveSheet</code>?</p>\n\n<p>Nevertheless, this appears to work for me.</p>\n\n<pre><code>Sub NewTimesheet()\n    Dim wsToCopy As Worksheet, wsNew As Worksheet\n\n    On Error GoTo Whoa:\n\n    Set wsToCopy = ThisWorkbook.ActiveSheet\n    Set wsNew = ThisWorkbook.Sheets.Add\n\n    wsToCopy.Cells.Copy wsNew.Cells\n\n    With wsNew\n        .Range(\"C7:H13\").ClearContents\n        .Range(\"C15:H21\").ClearContents\n        .Range(\"C23:H29\").ClearContents\n        .Range(\"C31:H37\").ClearContents\n        .Range(\"K7:M13\").ClearContents\n        .Range(\"K15:M21\").ClearContents\n        .Range(\"K23:M29\").ClearContents\n        .Range(\"K31:M37\").ClearContents\n        .Range(\"J42\").ClearContents\n        .Range(\"A7\").Value = wsToCopy.Range(\"A37\").Value + 1\n        .Range(\"I39\").ClearContents\n        .Range(\"J39\").ClearContents\n        .Name = .Range(\"A7\").Text\n        wsToCopy.Range(\"I43\").Copy .Range(\"I39\")\n    End With\n\n\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1507730464, "creation_date": 1507730464, "answer_id": 46690208, "question_id": 46688046, "link": "https://stackoverflow.com/questions/46688046/copying-timesheet-vba/46690208#46690208", "title": "Copying Timesheet VBA", "body": "<p>Think you can shorten your code a little. By the way, I don't think it's a very good idea to base your code on the active sheet in case it's run when a different sheet is unintentionally active.</p>\n\n<pre><code>Sub NewTimesheet()\n\n    Dim wsToCopy As Worksheet, wsNew As Worksheet\n\n    On Error GoTo Whoa:\n\n    Set wsToCopy = ThisWorkbook.ActiveSheet\n    wsToCopy.Copy after:=Sheets(Sheets.Count)\n    Set wsNew = ActiveSheet\n\n    With wsNew\n        .Range(\"C7:H13,C15:H21,C23:H29,C31:H37,K7:M13,K15:M21,K23:M29,K31:M37,J42\").ClearContents\n        .Range(\"A7\").Value = wsToCopy.Range(\"A37\").Value + 1\n        .Range(\"I39:J39\").ClearContents\n        .Name = wsToCopy.Range(\"A7\").Text 'not sure which sheet this should be\n        .Range(\"I39\").Value = wsToCopy.Range(\"I43\").Value\n    End With\n\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8758846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbdc683578a09fe6c84785ebdcb45699?s=128&d=identicon&r=PG&f=1", "display_name": "DominicPAH", "link": "https://stackoverflow.com/users/8758846/dominicpah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1507730464, "creation_date": 1507724330, "last_edit_date": 1531164843, "question_id": 46688046, "link": "https://stackoverflow.com/questions/46688046/copying-timesheet-vba", "title": "Copying Timesheet VBA", "body": "<p>I am using the following VBA for a button to create a new 4 weekly timesheet, clearing the appropriate data and changing the new. </p>\n\n<p>I am struggling to get the carry over of leave from the current sheet, Cell I42 to the new sheet I39. Can anyone let me know where I am going wrong. </p>\n\n<p>Thanks</p>\n\n<pre><code>Sub NewTimesheet()\n    Dim wsToCopy As Worksheet, wsNew As Worksheet\n\n    On Error GoTo Whoa:\n\n    Set wsToCopy = ThisWorkbook.ActiveSheet\n    Set wsNew = ThisWorkbook.Sheets.Add\n\n    wsToCopy.Cells.Copy wsNew.Cells\n\n    wsNew.Range(\"C7:H13\").ClearContents\n    wsNew.Range(\"C15:H21\").ClearContents\n    wsNew.Range(\"C23:H29\").ClearContents\n    wsNew.Range(\"C31:H37\").ClearContents\n    wsNew.Range(\"K7:M13\").ClearContents\n    wsNew.Range(\"K15:M21\").ClearContents\n    wsNew.Range(\"K23:M29\").ClearContents\n    wsNew.Range(\"K31:M37\").ClearContents\n    wsNew.Range(\"J42\").ClearContents\n    wsNew.Range(\"A7\").Value = ActiveSheet.Range(\"A37\").Value + 1\n    wsNew.Range(\"I39\").ClearContents\n    wsNew.Range(\"J39\").ClearContents\n    ActiveSheet.Name = Range(\"A7\").Text\n    ActiveSheet.Range(\"I43\").Copy wsNew.Range(\"I39\").Value\n\n\n    Exit Sub\nWhoa:\n    MsgBox Err.Description\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "wildcard", "vba"], "comments": [{"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1507723749, "post_id": 46687479, "comment_id": 80323122, "body": "What do you want to do with it further  ? Are you trying to remove special characters or replace them ?"}], "answers": [{"comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507725668, "post_id": 46688134, "comment_id": 80324392, "body": "It is missing the character <code>_</code> underline on the Regex pattern"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507751798, "post_id": 46688134, "comment_id": 80340782, "body": "Linked a great answer which should help OP to figure the pattern of his choice."}], "tags": [], "owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "is_accepted": false, "score": 0, "last_activity_date": 1507745996, "last_edit_date": 1507745996, "creation_date": 1507724578, "answer_id": 46688134, "question_id": 46687479, "link": "https://stackoverflow.com/questions/46687479/check-excel-file-for-special-character-and-letter-with-like-operator-on-entire/46688134#46688134", "title": "Check excel file for special character _ and letter with Like Operator on entire Sheet", "body": "<p>Effective way of matching patterns is to use regex , consider the general code below</p>\n\n<p>Check this <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">answer</a> for more information and tweaks.</p>\n\n<pre><code>Sub test()\n\n    Dim regex As Object\n    Dim pattern As String\n\n    Set regex = CreateObject(\"VBScript.RegExp\")\n\n    regex.Global = True\n    regex.IgnoreCase = True\n    regex.pattern = pattern\n\n    'define your regex pattern here\n    pattern = \"[0-9a-zA-Z]\"\n\n    'check each cell in range\n    For Each cell In ActiveSheet.Range(\"A1:A10\")\n        If pattern &lt;&gt; \"\" Then\n            If regex.test(cell.Value) Then\n                'if the pattern matches do some operation\n                Debug.Print cell.Address\n            End If\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1507725919, "last_edit_date": 1507725919, "creation_date": 1507725605, "answer_id": 46688445, "question_id": 46687479, "link": "https://stackoverflow.com/questions/46687479/check-excel-file-for-special-character-and-letter-with-like-operator-on-entire/46688445#46688445", "title": "Check excel file for special character _ and letter with Like Operator on entire Sheet", "body": "<p>As @ImranMalek said, Regex would do it better, because it is taking too much time to loop on each cell and each letter of your code.\nHowever, if you still want to use in your entire sheet, use this:</p>\n\n<pre><code>Dim L As Long, LL As Long\nDim sCh As String, s As String\nDim IsSpecial As Boolean\n\nFor Each cell In ActiveSheet.UsedRange.Cells\n    IsSpecial = False\n    If IsEmpty(cell) = False Then\n        s = CStr(cell)\n        For L = 1 To Len(s)\n            sCh = Mid(s, L, 1)\n            If sCh Like \"[0-9a-zA-Z]\" Or sCh = \"_\" Then\n            Else\n                IsSpecial = True\n                Exit For\n            End If\n        Next L\n        If IsSpecial = True Then\n            cell.Interior.ColorIndex = 3\n        Else\n            cell.Interior.ColorIndex = 4\n        End If\n    End If\nNext\n</code></pre>\n\n<p>The code will color in green if the name is ok and red if nok.</p>\n\n<p>And the result is:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2279a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2279a.png\" alt=\"![result\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 8758696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ea596721f96f01dc2d2d39db709a99f?s=128&d=identicon&r=PG&f=1", "display_name": "sumit sharma", "link": "https://stackoverflow.com/users/8758696/sumit-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507745996, "creation_date": 1507722518, "last_edit_date": 1531164843, "question_id": 46687479, "link": "https://stackoverflow.com/questions/46687479/check-excel-file-for-special-character-and-letter-with-like-operator-on-entire", "title": "Check excel file for special character _ and letter with Like Operator on entire Sheet", "body": "<p>Below is the macro code but it is working for a single cell.I want it for entire sheet.</p>\n\n<pre><code>Public Function IsSpecial(s As String) As Long\n Dim L As Long, LL As Long\n Dim sCh As String\n IsSpecial = 0\n For L = 1 To Len(s)\n     sCh = Mid(s, L, 1)\n     If sCh Like \"[0-9a-zA-Z]\" Or sCh = \"_\" Then\n     Else\n         IsSpecial = 1\n         Exit Function\n     End If\n Next L\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-access", "adodb"], "answers": [{"comments": [{"owner": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507739231, "post_id": 46687619, "comment_id": 80334124, "body": "i did this, removing the <code>Set rs = cmd_apoio.Execute()</code>  I get the error: Runtime error &#39;3707&#39; Cannot change the ActiveConnection property of a Recordset Object wich has a command object as its source"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507741093, "post_id": 46687619, "comment_id": 80335214, "body": "Remove <code>.ActiveConnection = cnn</code> and try again"}, {"owner": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507798738, "post_id": 46687619, "comment_id": 80357555, "body": "still got the same error doing that, I the removed the cnn from the open statement like <code>rs.Open cmd_apoio, , adOpenStatic, adLockOptimistic</code> and kept the <code>.ActiveConnection = cnn</code>. This works, as in it runs, but doesn&#39;t solve the multiuser problem"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1507723025, "creation_date": 1507723025, "answer_id": 46687619, "question_id": 46687397, "link": "https://stackoverflow.com/questions/46687397/multiple-simultaneous-connections-from-excel-vba-to-access-db/46687619#46687619", "title": "Multiple simultaneous connections from excel vba to Access DB", "body": "<p>Try using <code>rs.Open</code> instead of <code>cmd.Execute</code>, and specify the lock type:</p>\n\n<p>After your <code>End With</code>:</p>\n\n<pre><code>Set rs = New ADODB.Recordset\nrs.CursorLocation = adUseClient\nrs.Open cmd_apoio, cnn, adOpenStatic, adLockOptimistic\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507742617, "post_id": 46689024, "comment_id": 80336009, "body": "Do you get the same error?  If so, then it implies that someone/something else (or other code within the same app) has it open exclusively."}, {"owner": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507798589, "post_id": 46689024, "comment_id": 80357453, "body": "I still get the same error, the only objects that can create this error are adodb.Connection right? I use four of these on different macros, I always close them and all of them have this code implemented."}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507815253, "post_id": 46689024, "comment_id": 80368359, "body": "@JoelAlmeida Then something else must have the file open exclusively.  Do you have it open in the Access IDE?"}, {"owner": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507821911, "post_id": 46689024, "comment_id": 80373149, "body": "No, the database file was closed when testing this. The file is shared on a private network (of a bank), the PV.path is the path to the network folder/file of the access db. Could there be any limitations/security preventions from the network side preventing this?  The only connections I use have that setting <code>cnn.Mode = 16 + 3</code>"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 1, "creation_date": 1507822263, "post_id": 46689024, "comment_id": 80373374, "body": "Make a local copy of the Access MDB that only you have/can access, then change your program to access that copy instead and see if it works then.  This should tell you if the problem is in your code or with the network/security.  (NOTE: do not open this copy with anything else before testing it with your program.  If you do, then restart your box before testing to insure that there is nothing in the background of your box locking it)"}, {"owner": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507883621, "post_id": 46689024, "comment_id": 80397522, "body": "Can it be because I use linked tables to txt files?"}, {"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "reply_to_user": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507911015, "post_id": 46689024, "comment_id": 80414477, "body": "@JoelAlmeida That&#39;s possible. If you suspect that, then you should debug the code and establish on exactly what line (and what file) the error is being thrown."}], "tags": [], "owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "is_accepted": false, "score": 1, "last_activity_date": 1507727196, "creation_date": 1507727196, "answer_id": 46689024, "question_id": 46687397, "link": "https://stackoverflow.com/questions/46687397/multiple-simultaneous-connections-from-excel-vba-to-access-db/46689024#46689024", "title": "Multiple simultaneous connections from excel vba to Access DB", "body": "<p>You need to set your connection mode explicitly:</p>\n\n<pre><code>Set cnn = New ADODB.Connection\ncnn.Mode = 16 + 3    'adModeShareDenyNone + adModeShareReadWrite   '\ncnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source = \" &amp; PV.dbpath\n</code></pre>\n\n<p>See here: <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/connectmodeenum\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/connectmodeenum</a></p>\n"}, {"comments": [{"owner": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507806123, "post_id": 46696271, "comment_id": 80362262, "body": "I think I fully understood your comment.  Although I&#39;m using excel as front end to access it&#39;s mostly to read only info, as the users never update the data from the queried tables, they only input some new values that get stored in different tables. The data I show is only an accessory to the decision making process. The only time I need it to be multiuser is when its loading the information (establishing the connection to present the data in Excel) For the table inserts, I can simply check if the connection is clear and wait till it is, as this operation occurs less frequently."}, {"owner": {"reputation": 573, "user_id": 8497252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67538554b474d977f956003e2febeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Cahaba Data", "link": "https://stackoverflow.com/users/8497252/cahaba-data"}, "reply_to_user": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507810347, "post_id": 46696271, "comment_id": 80364912, "body": "So I may be out of date.  I did not think one could have multiple people working in the same excel workbook/file at the same time.  Especially in terms of entering/editing data."}, {"owner": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507815068, "post_id": 46696271, "comment_id": 80368216, "body": "that&#39;s just it, it&#39;s not the same file, it&#39;s copies of the same file stored locally on each individual computer, different workbooks connecting to the same db"}, {"owner": {"reputation": 573, "user_id": 8497252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67538554b474d977f956003e2febeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Cahaba Data", "link": "https://stackoverflow.com/users/8497252/cahaba-data"}, "reply_to_user": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "edited": false, "score": 0, "creation_date": 1507840972, "post_id": 46696271, "comment_id": 80383466, "body": "ah ok.  So in a split multi user Access installation we can have multiple front end files connecting to the same single back end file, that just holds tables.  My only guess is that the back end thinks all your connections are from the same front end.  I don&#39;t have the experience to say as to whether your connection string can be crafted differently."}], "tags": [], "owner": {"reputation": 573, "user_id": 8497252, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d67538554b474d977f956003e2febeaf?s=128&d=identicon&r=PG&f=1", "display_name": "Cahaba Data", "link": "https://stackoverflow.com/users/8497252/cahaba-data"}, "is_accepted": false, "score": 1, "last_activity_date": 1507750913, "creation_date": 1507750913, "answer_id": 46696271, "question_id": 46687397, "link": "https://stackoverflow.com/questions/46687397/multiple-simultaneous-connections-from-excel-vba-to-access-db/46696271#46696271", "title": "Multiple simultaneous connections from excel vba to Access DB", "body": "<p>I can only contribute the comments that I've always considered excel not to be multi user.  </p>\n\n<p>And in linking Excel to Access - which I've done a lot - the excel must always be closed when working from the Access side.  There cannot be a user directly in the Excel - it's role to Access is to behave like a table.</p>\n\n<p>You are in the other direction in using Excel as the front end with Access tables linked - - but in terms of multi user I wonder if the situation is the same.</p>\n"}], "owner": {"reputation": 42, "user_id": 7962544, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-iJzr6vGI77s/AAAAAAAAAAI/AAAAAAAAHIA/a0m_tyz2gqE/photo.jpg?sz=128", "display_name": "Joel Almeida", "link": "https://stackoverflow.com/users/7962544/joel-almeida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4274, "favorite_count": 1, "answer_count": 3, "score": 1, "last_activity_date": 1507905916, "creation_date": 1507722251, "last_edit_date": 1507905916, "question_id": 46687397, "link": "https://stackoverflow.com/questions/46687397/multiple-simultaneous-connections-from-excel-vba-to-access-db", "title": "Multiple simultaneous connections from excel vba to Access DB", "body": "<p>I am building a somewhat complex Excel sheet for a bank, that uses an Access Database.</p>\n\n<p>This sheet loads a ton of data to prebuilt sheets.\nAfter that, they can run a few macros and add some inputs\nIn the end, I open a new connection to insert these inputs in different tables from the ones that where queried in the beginning</p>\n\n<p>My problem is that when loading the information to the workbook, this action can only be performed by one user at a time.</p>\n\n<p>When this process is running in one user computer other users get the error</p>\n\n<blockquote>\n  <p>The Microsoft Office Access database engine cannot open or write to\n  the file ''. It is already opened exclusively by another user, or you\n  need permission to view and write its data.</p>\n</blockquote>\n\n<p>I know the users have permission because once the process is done on user 1, user 2 has no problem.</p>\n\n<p>I am using ADODB (connection, recordset and command) and this is the code I use about four different times for four different stored queries in access:</p>\n\n<pre><code>Dim cnn As ADODB.Connection \nDim rs As ADODB.Recordset \nDim cmd_apoio As New ADODB.Command\n\nSet cnn = New ADODB.Connection\ncnn.Open \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source = \" &amp; PV.dbpath\n\nWith cmd_apoio\n    .ActiveConnection = cnn\n    .CommandType = adCmdStoredProc\n    .CommandText = \"tabela_apoio_entidades\"\n    .Parameters.Append .CreateParameter(\"nip\", adNumeric, adParamInput, 20)\n    .Parameters.Append .CreateParameter(\"anomes\", adNumeric, adParamInput, 20)\n    .Parameters(0) = PV.nip_grupo\n    .Parameters(1) = PV.ano_mes\nEnd With\n\nSet rs = cmd_apoio.Execute()\n</code></pre>\n\n<p>(the PV. variables are public variables declared in another module(PV))\nUsing this method is there a way to allow multiple connections at once?\nEspecially as this is only to retrieve information (read-only) and not to update any records in tables.</p>\n\n<p>I am using Excel 2013 and Access 2013, the database is .accdb</p>\n\n<p><strong>EDIT: The tables are linked tables to txt files (i think this might be important)</strong></p>\n"}, {"tags": ["vba", "list", "excel", "printing"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1507724749, "post_id": 46687302, "comment_id": 80323781, "body": "You need to ask a specific question - what are you actually stuck on?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8758585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Ex7EXDrfgc/AAAAAAAAAAI/AAAAAAAAACc/JYWNShtHMyM/photo.jpg?sz=128", "display_name": "Ram\u016bnas Kri\u0161\u010di\u016bnas", "link": "https://stackoverflow.com/users/8758585/ram%c5%abnas-kri%c5%a1%c4%8di%c5%abnas"}, "is_accepted": false, "score": 0, "last_activity_date": 1507879013, "last_edit_date": 1507879013, "creation_date": 1507876200, "answer_id": 46723771, "question_id": 46687302, "link": "https://stackoverflow.com/questions/46687302/print-excel-sheets-with-interchangeable-cell-value-from-list-and-sheet-number-by/46723771#46723771", "title": "Print Excel sheets with interchangeable cell value from list and sheet number by copy number", "body": "<p>I have found a solution. My macro was creating dublicates. though it wasn't what i need. </p>\n\n<pre><code>Sub Macro()\n\n    Dim i As Long, LastRow As Long\n\n    LastRow = Worksheets(\"Sheet2\").Range(\"C65536\").End(xlUp).Row\n\n    For i = 8 To LastRow\n\n        Worksheets(\"Sheet1\").Range(\"G6\").Value = Worksheets(\"Sheet2\").Range(\"C\" &amp; i).Value\n        Worksheets(\"Sheet1\").Range(\"J7\").Value = Worksheets(\"Sheet2\").Range(\"D\" &amp; i).Value\n\n        Dim CopiesCount As Long\n        Dim copynumber As Long\n\n        CopiesCount = Worksheets(\"Sheet2\").Range(\"E\" &amp; i).Value\n\n        If Not Worksheets(\"Sheet2\").Range(\"B\" &amp; i).Value = 1 Then\n            For copynumber = 1 To CopiesCount\n                With Worksheets(\"Sheet1\")\n                    .Range(\"L7\").Value = copynumber\n                    .PrintOut\n                End With\n            Next copynumber\n        End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8758585, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Ex7EXDrfgc/AAAAAAAAAAI/AAAAAAAAACc/JYWNShtHMyM/photo.jpg?sz=128", "display_name": "Ram\u016bnas Kri\u0161\u010di\u016bnas", "link": "https://stackoverflow.com/users/8758585/ram%c5%abnas-kri%c5%a1%c4%8di%c5%abnas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507879013, "creation_date": 1507721913, "last_edit_date": 1531164843, "question_id": 46687302, "link": "https://stackoverflow.com/questions/46687302/print-excel-sheets-with-interchangeable-cell-value-from-list-and-sheet-number-by", "title": "Print Excel sheets with interchangeable cell value from list and sheet number by copy number", "body": "<p>I am trying to optimize paperwork and I can't figure out how to compile two separate macros to work as I need.</p>\n\n<p>On Excel workbook, I have two sheets:</p>\n\n<ul>\n<li>Sheet1 contains order form (invoice, etc.).</li>\n<li>Sheet2 contains list of product names and quantities.</li>\n</ul>\n\n<p>I need to create a macro so it would take the \"Product name\" from list (eg. <code>Sheet2!A1</code> to <code>Sheet1!N10</code>) and change number interchangeable from 1 to \"Quantity\" (eg. <code>Sheet2!B1</code> to <code>Sheet1!R10</code>) and print all generated copies through all the list.</p>\n\n<p>For example: <code>Sheet2!A1</code> cell contains the product \"ALFA\" and the corresponding quantity is \"3\" (cell B1). Next row - A2 contains \"BETA\" and B2 contains 2 (as quantity)</p>\n\n<p>So the printout will be 5 pages \"ALFA - 1\", \"ALFA - 2\", 'ALFA - 3\", \"BETA - 1\", \"BETA - 2\", and then follow to the next value in the list.</p>\n\n<p>I have found a code (somewhere on internet) to print number of copies with interchangeable number using this code below:</p>\n\n<pre><code>Sub Technologiniu_korteliu_kiekis()\n\n    Dim CopiesCount As Long\n    Dim copynumber As Long\n\n    CopiesCount = Application.InputBox(\"How many copies do you want?\", Type:=1)\n    'Now the program wants you to input how many pages you like to print.\n    'You can input 100 here.\n\n    For copynumber = 1 To CopiesCount\n        With ActiveSheet\n            .Range(\"L7\").Value = copynumber 'I assume your invoice number is in cell E1.\n            .PrintOut 'Print the sheet\n        End With\n    Next copynumber\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1507723064, "post_id": 46687287, "comment_id": 80322671, "body": "If you use a Form button, you can just assign the same macro to all of them. They are also a lot more stable than ActiveX buttons."}, {"owner": {"reputation": 3, "user_id": 8758328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76f74bd9345ce3394ea4abe8da2098de?s=128&d=identicon&r=PG&f=1", "display_name": "Stef", "link": "https://stackoverflow.com/users/8758328/stef"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1507724661, "post_id": 46687287, "comment_id": 80323724, "body": "Hi Rory, thanks for getting back to me. This is an old spreadsheet with lots of buttons and code. I know to avoid ActiveX controls now but when this was developed they were all created as ActiveX. Also there is a lot of interaction between buttons being enabled and disabled. The code I want to run is actually a piece of code that deals with the button resizing issue. Rather than put a call to the procedure at the beginning of every button click event I want a universal event that will catch a button click, run that extra code and then continue with the button&#39;s own click event as usual."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8758328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76f74bd9345ce3394ea4abe8da2098de?s=128&d=identicon&r=PG&f=1", "display_name": "Stef", "link": "https://stackoverflow.com/users/8758328/stef"}, "edited": false, "score": 0, "creation_date": 1507726268, "post_id": 46688400, "comment_id": 80324842, "body": "That&#39;s brilliant. Works great, except the m_ctlButton_Click() event isn&#39;t firing. The collection is created and the buttons are in it but when they are clicked they just run their own code and not the class event. Any ideas why?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 3, "user_id": 8758328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76f74bd9345ce3394ea4abe8da2098de?s=128&d=identicon&r=PG&f=1", "display_name": "Stef", "link": "https://stackoverflow.com/users/8758328/stef"}, "edited": false, "score": 0, "creation_date": 1507729058, "post_id": 46688400, "comment_id": 80327061, "body": "I&#39;m afraid not. I tested the code and it works here, so I&#39;d have to guess that maybe something the buttons are doing is interfering. If you can post a link to a workbook that shows it not working, I&#39;ll have a look when I have a minute."}, {"owner": {"reputation": 3, "user_id": 8758328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76f74bd9345ce3394ea4abe8da2098de?s=128&d=identicon&r=PG&f=1", "display_name": "Stef", "link": "https://stackoverflow.com/users/8758328/stef"}, "edited": false, "score": 0, "creation_date": 1507797397, "post_id": 46688400, "comment_id": 80356753, "body": "Hi Rory, I&#39;ve found the issue. The class event fires after the button&#39;s own event. As the button code activates another sheet, the worksheet activate event kills the class button that&#39;s been created and therefore its event. I guess there is no way of getting the class event to fire before the button event is there?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 3, "user_id": 8758328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76f74bd9345ce3394ea4abe8da2098de?s=128&d=identicon&r=PG&f=1", "display_name": "Stef", "link": "https://stackoverflow.com/users/8758328/stef"}, "edited": false, "score": 0, "creation_date": 1507798228, "post_id": 46688400, "comment_id": 80357236, "body": "No, but you could amend the code to simply populate the collection on workbook open for all the sheets, rather than just doing the active one on each sheet&#39;s activation."}, {"owner": {"reputation": 3, "user_id": 8758328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76f74bd9345ce3394ea4abe8da2098de?s=128&d=identicon&r=PG&f=1", "display_name": "Stef", "link": "https://stackoverflow.com/users/8758328/stef"}, "edited": false, "score": 0, "creation_date": 1507798931, "post_id": 46688400, "comment_id": 80357704, "body": "ok, i&#39;ll make that change. Also, is there a way of finding out which sheet a button is on? When the class event fires it needs to know the sheet the button that called it is on, but as the button code has changed sheet it isn&#39;t the activesheet anymore."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 3, "user_id": 8758328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76f74bd9345ce3394ea4abe8da2098de?s=128&d=identicon&r=PG&f=1", "display_name": "Stef", "link": "https://stackoverflow.com/users/8758328/stef"}, "edited": false, "score": 0, "creation_date": 1507800875, "post_id": 46688400, "comment_id": 80358958, "body": "You could add that as another property of the class or, if it&#39;s only needed by the class, use a private variable."}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 2, "last_activity_date": 1507725449, "creation_date": 1507725449, "answer_id": 46688400, "question_id": 46687287, "link": "https://stackoverflow.com/questions/46687287/excel-vba-capture-all-worksheet-commandbutton-click-events-to-run-universal-code/46688400#46688400", "title": "Excel-VBA Capture all worksheet CommandButton click events to run universal code", "body": "<p>I'd amend your class like this:</p>\n\n<pre><code>Private WithEvents m_ctlButton As MSForms.CommandButton\n\nPrivate Sub Class_Terminate()\n\n    Set m_ctlButton = Nothing\n\nEnd Sub\n\n\nPrivate Sub m_ctlButton_Click()\n'code i want to run\nEnd Sub\n\nPublic Property Set Button(ctlButton As MSForms.CommandButton)\n\n    Set m_ctlButton = ctlButton\n\nEnd Property\n</code></pre>\n\n<p>Let's assume this is Class1 as I'm lazy.</p>\n\n<p>Now in a new module add this:</p>\n\n<pre><code>Option Explicit\nDim colButtons As Collection\nSub hookButtons(ws As Object)\n    Dim oBtn As Class1\n    Dim obj As OLEObject\n    Set colButtons = New Collection\n    For Each obj In ws.OLEObjects\n        If TypeOf obj.Object Is MSForms.CommandButton Then\n            Set oBtn = New Class1\n            Set oBtn.Button = obj.Object\n            colButtons.Add oBtn\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>and finally, in the ThisWorkbook module, add this:</p>\n\n<pre><code>Private Sub Workbook_Open()\n    hookButtons ActiveSheet\nEnd Sub\n\nPrivate Sub Workbook_SheetActivate(ByVal Sh As Object)\n    hookButtons Sh\nEnd Sub\n</code></pre>\n\n<p>Since you can't click a button without its sheet being active, it seems easier to only hook the active sheet's buttons at any given time. Using the sheetActivate event should also mean that it gets reset more often in case of unhandled errors in other code in the workbook.</p>\n"}], "owner": {"reputation": 3, "user_id": 8758328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76f74bd9345ce3394ea4abe8da2098de?s=128&d=identicon&r=PG&f=1", "display_name": "Stef", "link": "https://stackoverflow.com/users/8758328/stef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1249, "favorite_count": 0, "accepted_answer_id": 46688400, "answer_count": 1, "score": 0, "last_activity_date": 1581232663, "creation_date": 1507721859, "question_id": 46687287, "link": "https://stackoverflow.com/questions/46687287/excel-vba-capture-all-worksheet-commandbutton-click-events-to-run-universal-code", "title": "Excel-VBA Capture all worksheet CommandButton click events to run universal code", "body": "<p>I would like to have a piece of code that runs when any worksheet commandbutton is pressed. I have seen similar things for userforms but can't find something that works across (and limited to) worksheet buttons.</p>\n\n<p>I have got as far as creating a class module called clsCmdButton with the following code:</p>\n\n<pre><code>Private WithEvents cmdButton As MSForms.CommandButton\n\nPrivate Sub cmdButton_Click()\n'code i want to run\nEnd Sub\n</code></pre>\n\n<p>I then think I need to loop through all worksheets, find the commandbuttons on it and intialise each as a new insance of the class. This could be done in the Workbook_Open event, however I am not sure how to code it. Could anyone help?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1507722052, "post_id": 46687238, "comment_id": 80322005, "body": "Do you have a question?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1507726311, "post_id": 46687238, "comment_id": 80324864, "body": "There is no question, and absence of context makes this hard to reply"}, {"owner": {"reputation": 98, "user_id": 7670573, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0b342de5d7b65177799d008516f89d48?s=128&d=identicon&r=PG&f=1", "display_name": "Sonu Kumar", "link": "https://stackoverflow.com/users/7670573/sonu-kumar"}, "edited": false, "score": 0, "creation_date": 1507727871, "post_id": 46687238, "comment_id": 80326145, "body": "Sorry for the confusion. The question is, why the Recordset is returning empty field values for all records if a single cell in the source location has a text value with length greater than 255 char and how can I resolve the problem?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507747090, "post_id": 46687238, "comment_id": 80338410, "body": "Are you retrieving the records from an MS Access database? (If so, please correct the tag - [access] is nothing to do with MS Access - use the [ms-access] tag.)  Or are you retrieving the data from another Excel spreadsheet?  (Which is what I usually think of when I see a table name ending with a <code>$</code>.)"}], "answers": [{"comments": [{"owner": {"reputation": 98, "user_id": 7670573, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0b342de5d7b65177799d008516f89d48?s=128&d=identicon&r=PG&f=1", "display_name": "Sonu Kumar", "link": "https://stackoverflow.com/users/7670573/sonu-kumar"}, "edited": false, "score": 0, "creation_date": 1507725748, "post_id": 46688229, "comment_id": 80324456, "body": "The data is stored in Excel and I am fetching records to send each cells value in some predefined PowerPoint shapes."}, {"owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "reply_to_user": {"reputation": 98, "user_id": 7670573, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0b342de5d7b65177799d008516f89d48?s=128&d=identicon&r=PG&f=1", "display_name": "Sonu Kumar", "link": "https://stackoverflow.com/users/7670573/sonu-kumar"}, "edited": false, "score": 0, "creation_date": 1507726620, "post_id": 46688229, "comment_id": 80325107, "body": "It may be due to the data type of the column in Excel, I have updated my answer. I agree with other comments that it may be worth wording your question more clearly"}], "tags": [], "owner": {"reputation": 604, "user_id": 3683930, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/DPmwN.png?s=128&g=1", "display_name": "Leroy", "link": "https://stackoverflow.com/users/3683930/leroy"}, "is_accepted": false, "score": 1, "last_activity_date": 1507729982, "last_edit_date": 1507729982, "creation_date": 1507724842, "answer_id": 46688229, "question_id": 46687238, "link": "https://stackoverflow.com/questions/46687238/excel-vbas-sql/46688229#46688229", "title": "Excel VBA&#39;s SQL", "body": "<p>What are you doing with the results of your query? </p>\n\n<p>If you are trying to insert them into an Access table, check the data type of that table to ensure it is not a <code>Text</code> field. This has a limit of 255 characters. \nFor larger text fields use <code>Memo</code> (or <code>Long Text</code>)</p>\n\n<p>Other than this your data may be truncated to 255 characters if the first 8 records contain 255 or fewer characters. The Microsoft Excel ODBC driver will, by default, scan the first 8 rows of your data to determine the type of data in each column. Try converting the data type of the column to text (or even move the row with more than 255 characters to the first row)</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1508808102, "creation_date": 1508808102, "answer_id": 46900779, "question_id": 46687238, "link": "https://stackoverflow.com/questions/46687238/excel-vbas-sql/46900779#46900779", "title": "Excel VBA&#39;s SQL", "body": "<p>Here is a great way to convert a SQL string to VBA code.</p>\n\n<p>Creating the form</p>\n\n<p>The form just needs two text boxes, and a command button. SQL statements can be quite long, so you put the text boxes on different pages of a tab control.</p>\n\n<pre><code>    Create a new form (in design view.)\n    Add a tab control.\n    In the first page of the tab control, add a unbound text box.\n    Set its Name property to txtSql.\n    Increase its Height and Width so you can see many long lines at once.\n    In the second page of the tab control, add another unbound text box.\n    Name it txtVBA, and increase its height and width.\n    Above the tab control, add a command button.\n    Name it cmdSql2Vba.\n    Set its On Click property to [Event Procedure].\n    Click the Build button (...) beside this property.\n    When Access opens the code window, set up the code like this:\n\nPrivate Sub cmdSql2Vba_Click()\n    Dim strSql As String\n    'Purpose:   Convert a SQL statement into a string to paste into VBA code.\n    Const strcLineEnd = \" \"\" &amp; vbCrLf &amp; _\" &amp; vbCrLf &amp; \"\"\"\"\n\n    If IsNull(Me.txtSQL) Then\n        Beep\n    Else\n        strSql = Me.txtSQL\n        strSql = Replace(strSql, \"\"\"\", \"\"\"\"\"\")  'Double up any quotes.\n        strSql = Replace(strSql, vbCrLf, strcLineEnd)\n        strSql = \"strSql = \"\"\" &amp; strSql &amp; \"\"\"\"\n        Me.txtVBA = strSql\n        Me.txtVBA.SetFocus\n        RunCommand acCmdCopy\n    End If\nEnd Sub\n\n\nhttp://allenbrowne.com/ser-71.html\n</code></pre>\n"}], "owner": {"reputation": 98, "user_id": 7670573, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/0b342de5d7b65177799d008516f89d48?s=128&d=identicon&r=PG&f=1", "display_name": "Sonu Kumar", "link": "https://stackoverflow.com/users/7670573/sonu-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1512995001, "creation_date": 1507721701, "last_edit_date": 1512995001, "question_id": 46687238, "link": "https://stackoverflow.com/questions/46687238/excel-vbas-sql", "title": "Excel VBA&#39;s SQL", "body": "<p>In my excel VBA function, 'strSQL' helps me to get perfect result in case text length of all records in all Data Fields (below) 255 char otherwise the function return empty value for all records if any cell in that particular field holds more than 255 characters. </p>\n\n<pre><code>strSQL = \"SELECT [Company Name], [ProfileType], [DataField0],[DataField1],\n           [DataField2],[DataField3],[DataField4],[DataField5],[DataField6],[DataField7] \n           FROM [Data$] WHERE [Company Name] = 'XYZ' ORDER BY [Heading_Order];\"\n</code></pre>\n\n<p>I am using ADODB for establish the connectivity.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1507730250, "post_id": 46687098, "comment_id": 80328030, "body": "What did you code so far? You can see in the linked examples that the &quot;Name&quot; (initial user) is already there. Also you have an example of how to get the manager. In other words: You found your answers, so where are you stuck on your implementation?"}], "answers": [{"tags": [], "owner": {"reputation": 3493, "user_id": 6591278, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/AwoCq.jpg?s=128&g=1", "display_name": "dv3", "link": "https://stackoverflow.com/users/6591278/dv3"}, "is_accepted": false, "score": 0, "last_activity_date": 1507787904, "creation_date": 1507787904, "answer_id": 46702403, "question_id": 46687098, "link": "https://stackoverflow.com/questions/46687098/outlook-vba-get-the-manager-of-user-who-runs-script/46702403#46702403", "title": "outlook vba: get the manager of user who runs script", "body": "<p>This was easier than I thought.<br>\nOf course you should add checks for <code>Null</code>, but the functionality is:  </p>\n\n<pre><code>Set appOL = New Outlook.Application\nMsgBox appOL.Session.CurrentUser.AddressEntry.GetExchangeUser.Manager\n</code></pre>\n"}], "owner": {"reputation": 3493, "user_id": 6591278, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/AwoCq.jpg?s=128&g=1", "display_name": "dv3", "link": "https://stackoverflow.com/users/6591278/dv3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 326, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507787904, "creation_date": 1507721285, "last_edit_date": 1531164843, "question_id": 46687098, "link": "https://stackoverflow.com/questions/46687098/outlook-vba-get-the-manager-of-user-who-runs-script", "title": "outlook vba: get the manager of user who runs script", "body": "<p><a href=\"https://stackoverflow.com/questions/20519230/get-manager-from-outlook-contacts-using-vba\">Here</a> and <a href=\"https://stackoverflow.com/questions/15532871/get-manager-info-from-outlook-address-list-vba\">also here</a> is described how to get the Manager from an Outlook contact. However: I would like to get the Name and the Manager of the user that runs the script. How could I do this?<br>\nthx</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1507721177, "post_id": 46686777, "comment_id": 80321430, "body": "The image link doesn&#39;t work (I&#39;m using Google Chrome). Since the image doesn&#39;t work I can&#39;t really help you. So I will give you an answer that can guide you along the way. It sounds like the survey could be done with formulas only. Your survey-questions seems to be True or False which makes it a whole lot easier. You seem to be interested in VBA, so my suggestion would be to take a look at creating forms. A better solution would be to work in Access, if you have access to it (No pun intended). Here is a <a href=\"http://www.contextures.com/xlUserForm01.html\" rel=\"nofollow noreferrer\">Link</a> on how you create forms in Excel."}, {"owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "edited": false, "score": 0, "creation_date": 1507721409, "post_id": 46686777, "comment_id": 80321594, "body": "Can you please show us what the question and it&#39;s answer look like in your sheet so we can understand where to check ?"}, {"owner": {"reputation": 3, "user_id": 8758505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f8fc5dc975775a9e7fd603e30acea5?s=128&d=identicon&r=PG&f=1", "display_name": "Robs237", "link": "https://stackoverflow.com/users/8758505/robs237"}, "reply_to_user": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1507721681, "post_id": 46686777, "comment_id": 80321780, "body": "Sorry - the image link is working for me.  How strange.  I&#39;ll try to explain it. Thank you for trying to help.   In Column A I have the questions, Column B - F are the categories.  Against each question (in the same row), there are -1 or +1 against a few of the categories (e.g. Question 1 might have a +1 in Column B and a -1 in Column D).  I want to find a way so that when I get their survey results that are agree/disagree, when they have selected &quot;Agree&quot;, return (and sum) the column value for each category (column).  Does that make sense? @EliasWick"}, {"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1507721761, "post_id": 46686777, "comment_id": 80321838, "body": "@Robs237 The link works now! See my answer and write back if you are looking for another solution."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507729118, "post_id": 46686777, "comment_id": 80327107, "body": "You would need to specify a lookup table i.e. which categories go with which question."}, {"owner": {"reputation": 9315, "user_id": 3627756, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/JxLDj.png?s=128&g=1", "display_name": "Ankit Bajpai", "link": "https://stackoverflow.com/users/3627756/ankit-bajpai"}, "edited": false, "score": 0, "creation_date": 1507729209, "post_id": 46686777, "comment_id": 80327188, "body": "What is your expected result."}, {"owner": {"reputation": 3, "user_id": 8758505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f8fc5dc975775a9e7fd603e30acea5?s=128&d=identicon&r=PG&f=1", "display_name": "Robs237", "link": "https://stackoverflow.com/users/8758505/robs237"}, "edited": false, "score": 0, "creation_date": 1507752660, "post_id": 46686777, "comment_id": 80341234, "body": "Ideally I would like a table with every persons name down column A, the categories along Row 1, with their individual score per category."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8758505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f8fc5dc975775a9e7fd603e30acea5?s=128&d=identicon&r=PG&f=1", "display_name": "Robs237", "link": "https://stackoverflow.com/users/8758505/robs237"}, "edited": false, "score": 0, "creation_date": 1507752618, "post_id": 46690144, "comment_id": 80341217, "body": "Ideally I would like a table with every persons name down column A, the categories along Row 1, with their individual score per category."}, {"owner": {"reputation": 3, "user_id": 8758505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f8fc5dc975775a9e7fd603e30acea5?s=128&d=identicon&r=PG&f=1", "display_name": "Robs237", "link": "https://stackoverflow.com/users/8758505/robs237"}, "edited": false, "score": 0, "creation_date": 1507764172, "post_id": 46690144, "comment_id": 80345522, "body": "yes, that last table is what we are looking for.  Any assistance would be greatly appreciated"}], "tags": [], "owner": {"reputation": 146, "user_id": 8661377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uyj1M.jpg?s=128&g=1", "display_name": "JonRo", "link": "https://stackoverflow.com/users/8661377/jonro"}, "is_accepted": false, "score": 0, "last_activity_date": 1507754852, "last_edit_date": 1507754852, "creation_date": 1507730319, "answer_id": 46690144, "question_id": 46686777, "link": "https://stackoverflow.com/questions/46686777/survey-data-sum-of-column-based-on-criteria-of-multiple-columns-and-rows/46690144#46690144", "title": "Survey data - sum of column based on criteria of multiple columns and rows", "body": "<p>Could this be an example of your desired data ?</p>\n\n<p>Table 'F8Uo4' with the statements : {table1}</p>\n\n<pre><code>Statement /.../ CAT4 / CAT5 /.../ CAT8\n...\nQ3        /.../      /   1  /.../  \nQ4\nQ5        /.../  -1  /      /.../   1\nQ6\nQ7        /.../      /      /.../   1\n</code></pre>\n\n<p>Answers to the survey given by the people : {table2}</p>\n\n<pre><code>Name / Q3 / Q5 / ... / Q7\n\nJake / A  / D  / ... / D\nJeff / A  / D  / ... / A\nJoe  / A  / A  / ... / A\nJohn / D  / A  / ... / A\n</code></pre>\n\n<p>Table with the desired results ? {table3} (reading your comment, I think I should delete this one)</p>\n\n<pre><code>Result /.../ CAT4 / CAT5 /.../ CAT8\n\nQ3                    3  \nQ4\nQ5            -2                 2\nQ6\nQ7                               3\n\nTotal  /.../  -2  /  +3  /.../  +5\n</code></pre>\n\n<p>Is this more like it ? {table4} by reading {table1} and {table2}</p>\n\n<pre><code>Name /.../ CAT4 / CAT5 /.../ CAT8\n\nJake /.../   0  /   1  /.../   0 ' approves Q3, so CAT5+1\nJeff /.../   0  /   1  /.../   1 ' approves Q3+Q7, so CAT5+1 and CAT8+1\nJoe  /.../  -1  /   1  /.../   2 ' approves Q3+Q5+Q7, so CAT5+1, CAT4-1, CAT8+1+1\nJohn /.../  -1  /   0  /.../   2 ' approves Q5+Q7, so CAT4-1 and CAT8+1+1 \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8758505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f8fc5dc975775a9e7fd603e30acea5?s=128&d=identicon&r=PG&f=1", "display_name": "Robs237", "link": "https://stackoverflow.com/users/8758505/robs237"}, "edited": false, "score": 0, "creation_date": 1507875729, "post_id": 46712354, "comment_id": 80393549, "body": "It works! This is perfect!!! Thank you so much! You have no idea how appreciative I am! Thank you!"}], "tags": [], "owner": {"reputation": 3725, "user_id": 4388883, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c3cf69657df9c46dd460e73760894308?s=128&d=identicon&r=PG&f=1", "display_name": "ian0411", "link": "https://stackoverflow.com/users/4388883/ian0411"}, "is_accepted": true, "score": 0, "last_activity_date": 1507818956, "creation_date": 1507818956, "answer_id": 46712354, "question_id": 46686777, "link": "https://stackoverflow.com/questions/46686777/survey-data-sum-of-column-based-on-criteria-of-multiple-columns-and-rows/46712354#46712354", "title": "Survey data - sum of column based on criteria of multiple columns and rows", "body": "<p><img src=\"https://i.stack.imgur.com/hZn2X.png\" alt=\"\"></p>\n\n<p>This will utilize matrix function <code>MMULT</code> with <code>OFFSET</code> and <code>MATCH</code> and here is the <strong>array formula</strong> (click <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>Enter</kbd> together) for you to try:</p>\n\n<pre><code>=MMULT(OFFSET($K$2,MATCH($A16,$K$3:$K$7,0),1,,COUNTA($L$2:$U$2)),IF(B$3:B$12&lt;&gt;\"\",OFFSET($A$2,1,MATCH(B$15,$B$2:$I$2,0),COUNTA($A$3:$A$12)),0))\n</code></pre>\n\n<p>What this does is use matrix function <code>MMULT</code>to multiple table 1 and table 2.  The <code>OFFSET</code> is to find the correct column and row to do the math.  Just think this is the simplified array formula to find <code>person V</code> with the corresponding <code>CAT1</code>.</p>\n\n<pre><code>=MMULT($L3:$U3,IF(B$3:B$12&lt;&gt;\"\",B$3:B$12,0))\n</code></pre>\n\n<p>Hope this helps.  Please remember you will need to adjust your range to fit your setup.</p>\n"}], "owner": {"reputation": 3, "user_id": 8758505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29f8fc5dc975775a9e7fd603e30acea5?s=128&d=identicon&r=PG&f=1", "display_name": "Robs237", "link": "https://stackoverflow.com/users/8758505/robs237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 46712354, "answer_count": 2, "score": 0, "last_activity_date": 1507818956, "creation_date": 1507720382, "last_edit_date": 1507728881, "question_id": 46686777, "link": "https://stackoverflow.com/questions/46686777/survey-data-sum-of-column-based-on-criteria-of-multiple-columns-and-rows", "title": "Survey data - sum of column based on criteria of multiple columns and rows", "body": "<p>I have an extremely complex (well it is to me) question that I am hoping someone can assist me with. I'll go through the scenario. \nI am trying to gather data by surveying some people.  Each question links to a particular category (where I've allocated it either <code>a +1</code> or <code>a -1</code> score to determine characteristics depending on whether the person agrees or disagrees with the statement). </p>\n\n<p>e.g referring to the Sample Table below if they select \"agree\" to Question 1 they will get <code>a +1</code> score for <code>CAT7 (Category 7)</code>.  If they Agree with Question 5, they get <code>a -1</code> for <code>CAT4</code> and <code>a +1</code> for <code>CAT8</code>.  </p>\n\n<p>I have tried <code>SUMPRODUCTS, INDEX, MATCH, VLOOKUPS, COUNTIFS</code> - I could be missing something. Might have to go some VBA code? If anyone can help.  </p>\n\n<p>I basically want scores for each category </p>\n\n<p>Please help! It's much appreciated! </p>\n\n<p><img src=\"https://i.stack.imgur.com/F8Uo4.jpg\" alt=\"Sample Table\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1507720811, "post_id": 46686763, "comment_id": 80321189, "body": "Avoid using <code>.Select</code> and <code>.Activate</code> as they both cause things to run very slowly, and there is always a better way to write the code."}, {"owner": {"reputation": 83, "user_id": 6155114, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5a67d81f1f58e709c593b216d516de63?s=128&d=identicon&r=PG&f=1", "display_name": "KhawarAmeerMalik", "link": "https://stackoverflow.com/users/6155114/khawarameermalik"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1507721401, "post_id": 46686763, "comment_id": 80321583, "body": "@braX can you please suggest the alternatives."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1507721780, "post_id": 46686763, "comment_id": 80321852, "body": "Anytime you have a line of code that ends with <code>.Select</code> and the next line is <code>Selection</code> you just combine them... <code>Columns(&quot;A:A&quot;).UnMerge</code> does the same thing."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1507721979, "post_id": 46686763, "comment_id": 80321962, "body": "Also, you will want to learn how to fully qualify your Ranges instead of relying on whatever is active."}, {"owner": {"reputation": 83, "user_id": 6155114, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5a67d81f1f58e709c593b216d516de63?s=128&d=identicon&r=PG&f=1", "display_name": "KhawarAmeerMalik", "link": "https://stackoverflow.com/users/6155114/khawarameermalik"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1507723759, "post_id": 46686763, "comment_id": 80323129, "body": "<i><b>Thanks</b></i> @BraX"}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507724394, "post_id": 46686763, "comment_id": 80323544, "body": "<b>1)</b> The Copy/Select is the code that is taking more time. <b>1.1)</b> You should use autofilter to filter for the desired value on the rows between your range and copy/paste them all at once. <b>1.2)</b> Or (a bit slower) select a non contiguous range and copy it and paste all at once. <b>2)</b> Copy/paste is slow, you could use just write the cell value."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1507731884, "post_id": 46686763, "comment_id": 80329242, "body": "Change <code>NumRows</code> to a long rather than an integer.  An integer can only hold values up to 32767 so will throw an error if you go too far over your 30000 rows."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1507735311, "post_id": 46686763, "comment_id": 80331624, "body": "60% of our your questions are not marked as closed. Bad answers or bad user ?"}, {"owner": {"reputation": 83, "user_id": 6155114, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5a67d81f1f58e709c593b216d516de63?s=128&d=identicon&r=PG&f=1", "display_name": "KhawarAmeerMalik", "link": "https://stackoverflow.com/users/6155114/khawarameermalik"}, "reply_to_user": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1507744971, "post_id": 46686763, "comment_id": 80337287, "body": "My dear @Patrick I appreciate all the kind support everyone has given to me. The reason I did not reply all of them was because I left office and had no internet in transit. But that doesn&#39;t mean I don&#39;t appreciate all the kind help everyone has given here."}, {"owner": {"reputation": 83, "user_id": 6155114, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5a67d81f1f58e709c593b216d516de63?s=128&d=identicon&r=PG&f=1", "display_name": "KhawarAmeerMalik", "link": "https://stackoverflow.com/users/6155114/khawarameermalik"}, "edited": false, "score": 0, "creation_date": 1507745052, "post_id": 46686763, "comment_id": 80337324, "body": "Please wait till tomorrow and I will reply to everyone after testing each solution. Thanks and regards"}], "answers": [{"tags": [], "owner": {"reputation": 146, "user_id": 8661377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uyj1M.jpg?s=128&g=1", "display_name": "JonRo", "link": "https://stackoverflow.com/users/8661377/jonro"}, "is_accepted": false, "score": 0, "last_activity_date": 1507730978, "creation_date": 1507730978, "answer_id": 46690408, "question_id": 46686763, "link": "https://stackoverflow.com/questions/46686763/unmerge-and-fill-gaps-vba-running-slow/46690408#46690408", "title": "unMerge and fill gaps VBA Running Slow", "body": "<p>I tried to simplyfy your code.  I haven't tested it in Excel ;-/</p>\n\n<pre><code>Sub Unmerge_Cell()\n\nDim NumRows As Integer\nDim i as Long\n\n    NumRows = Range(\"B2\", Range(\"B2\").End(xlDown)).Rows.Count\n    For i = 1 To NumRows - 1  \n        If IsEmpty(Range(\"A2\").Offset(i,0).Value) Then\n            Range(\"A2\").Offset(i,0).Value = Range(\"A2\").Offset(i-1,0).Value\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34, "user_id": 8121313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/65bfdaf9a21cd7955b918613bd4f28d9?s=128&d=identicon&r=PG&f=1", "display_name": "KarmaWin", "link": "https://stackoverflow.com/users/8121313/karmawin"}, "is_accepted": false, "score": 0, "last_activity_date": 1507732050, "creation_date": 1507732050, "answer_id": 46690838, "question_id": 46686763, "link": "https://stackoverflow.com/questions/46686763/unmerge-and-fill-gaps-vba-running-slow/46690838#46690838", "title": "unMerge and fill gaps VBA Running Slow", "body": "<p>You can also turn off and turn on the screen updating when you macro is running</p>\n\n<p>At the beginning on your code insert</p>\n\n<pre><code>application.screenupdating = false\n</code></pre>\n\n<p>And turn it on at the end</p>\n\n<pre><code>application.screenupdating = true\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 1, "last_activity_date": 1507732891, "last_edit_date": 1507732891, "creation_date": 1507732581, "answer_id": 46691034, "question_id": 46686763, "link": "https://stackoverflow.com/questions/46686763/unmerge-and-fill-gaps-vba-running-slow/46691034#46691034", "title": "unMerge and fill gaps VBA Running Slow", "body": "<p>This should be the fastest solution, no loop, simple.</p>\n\n<pre><code>Sub unMerge()\n    Dim lastRow As Long\n    lastRow = Range(\"B2\").End(xlDown).Row\n    Range(\"A:A\").unMerge\n    Range(\"A2:A\" &amp; lastRow).SpecialCells(xlCellTypeBlanks).FormulaR1C1 = \"=r[-1]c\"\n    With Range(\"A2:A\" &amp; lastRow)\n        .Value = .Value  'convert formula to constant\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 6155114, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5a67d81f1f58e709c593b216d516de63?s=128&d=identicon&r=PG&f=1", "display_name": "KhawarAmeerMalik", "link": "https://stackoverflow.com/users/6155114/khawarameermalik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "accepted_answer_id": 46691034, "answer_count": 3, "score": 0, "last_activity_date": 1507796333, "creation_date": 1507720313, "last_edit_date": 1531164843, "question_id": 46686763, "link": "https://stackoverflow.com/questions/46686763/unmerge-and-fill-gaps-vba-running-slow", "title": "unMerge and fill gaps VBA Running Slow", "body": "<p>I have an Excel Sheet wherein column \"A\" contains Serial numbers. One serial number may repeat to several rows. The cells in column \"A\" are merged [if more than one rows are appearing for One serial number]. I have made following macro to UN-merge these cells and repeat the serial number in subsequent blank rows until next serial number appears. The problem I am facing is that this macro is running very slow e.g. for a sheet containing 30,000 rows it may take a very long time. Is there a neat and less slower way to do it?</p>\n\n<p>Here is the code I am using. Please guide.</p>\n\n<pre><code>Sub Unmerge_Cell()\n\nDim NumRows As Integer\nRange(\"B2\").Select\n\nNumRows = Range(\"B2\", Range(\"B2\").End(xlDown)).Rows.Count\n    Columns(\"A:A\").Select\n    Selection.UnMerge\n    Range(\"A2\").Select\n    Range(\"A2\").Activate\n    For i = 1 To NumRows - 1           \n        If IsEmpty(ActiveCell.Offset(1, 0).Value) = True Then\n            ActiveCell.Select\n     Selection.Copy\n            ActiveCell.Offset(1, 0).Select\n            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n                :=False, Transpose:=False\n        Else\n         ActiveCell.Offset(1, 0).Select\n         ActiveCell.Offset(0, 0).Activate\n        End If    \n    Next\nRange(\"A1\").Select\nEnd Sub\n</code></pre>\n\n<p>Regards</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507719624, "post_id": 46686482, "comment_id": 80320518, "body": "Please indent your code properly."}, {"owner": {"reputation": 1340, "user_id": 5836929, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F5w3L.jpg?s=128&g=1", "display_name": "Teasel", "link": "https://stackoverflow.com/users/5836929/teasel"}, "edited": false, "score": 0, "creation_date": 1507721717, "post_id": 46686482, "comment_id": 80321811, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/46548910/vba-hide-column-if\">VBA hide column if</a>"}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1507720846, "creation_date": 1507720846, "answer_id": 46686953, "question_id": 46686482, "link": "https://stackoverflow.com/questions/46686482/hide-rows-based-on-cells-contaning-all-zeroes-or-no-values/46686953#46686953", "title": "Hide rows based on cells contaning all zeroes or no values", "body": "<p>You have to check every row completely before deciding if to hide it or not. Currently, the last cell of every row decided if a row is hidden. </p>\n\n<p>Give the following code a try. It sets a range to all cells of a row and uses the function <code>CountA</code> to count number of cells that are not empty.</p>\n\n<pre><code>Sub hide()\n\n    Dim ws As Worksheet, row As Long\n    Set ws = ActiveSheet\n    With ws\n        For row = 1 To 6\n            Dim myRange As Range\n            Set myRange = .Range(.Cells(row, 1), .Cells(row, 6))\n            .Rows(row).EntireRow.Hidden = (Application.WorksheetFunction.CountA(myRange) = 0)\n        Next row\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1507735955, "post_id": 46687333, "comment_id": 80332099, "body": "Thanks a lot QHarr, I tried your code and it almost works, however once there is a combination in GL of &quot;No value&quot; and a &quot;zero&quot; the formula doesn&#39;t hide that GL row. Do you have any idea how I can resolve this?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1507736298, "post_id": 46687333, "comment_id": 80332329, "body": "you mean a row with only blanks and zeros?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1507740357, "post_id": 46687333, "comment_id": 80334781, "body": "I have amended the test conditions in my answer. Please let me know if works."}, {"owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1507740827, "post_id": 46687333, "comment_id": 80335056, "body": "The new line of code doesn&#39;t work as good as the previous one :) Now more lines than just the zero&#39;s and blanks disappear.   My prior question was indeed about a GL line item with only blanks and one zero. That should also be hidden, however it remains visible"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1507740879, "post_id": 46687333, "comment_id": 80335093, "body": "What was the condition the original was failing on ? The new code will hide a row if it is all zeros, all blanks, or a mixture of blanks and zeros. It will hide rows if they have either text in and/or number &gt;0. Can you update post with image of data particularly showing row where failing?"}, {"owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1507741257, "post_id": 46687333, "comment_id": 80335292, "body": "when I try it out it just hides all the rows that I submit in the range. So not only the ones that fulfill the requirements.  So if I set the range at A1:F6, it hides row 1 till 6 no matter which amounts I have in these rows"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1507741383, "post_id": 46687333, "comment_id": 80335372, "body": "Can you post an image of the data please? Also, have you checked that the blank cells are indeed empty with an isempty() test against each cell in the range?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1507741569, "post_id": 46687333, "comment_id": 80335467, "body": "Failing that just add to the original two conditions the following line as an additional OR test   WorksheetFunction.CountA(c) - WorksheetFunction.Count(c) = 0"}, {"owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1507741666, "post_id": 46687333, "comment_id": 80335517, "body": "I&#39;ve added a print screen to the top of my original post. This data set hides all rows 1-6"}, {"owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "edited": false, "score": 0, "creation_date": 1507742738, "post_id": 46687333, "comment_id": 80336069, "body": "Thank you very very much QHarr! It works like a charm! :) This really helps me a lot!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1507742283, "last_edit_date": 1507742283, "creation_date": 1507722048, "answer_id": 46687333, "question_id": 46686482, "link": "https://stackoverflow.com/questions/46686482/hide-rows-based-on-cells-contaning-all-zeroes-or-no-values/46687333#46687333", "title": "Hide rows based on cells contaning all zeroes or no values", "body": "<p>See code below if you want to test for both all blanks or all zeros and hide row if either present. Starts with an unhide of all rows.</p>\n\n<pre><code> Sub hide()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim c As Range\n    Dim targetRange As Range\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Sheets(\"Sheet5\")\n    Set targetRange = ws.Range(\"A1:F6\")\n\n    targetRange.EntireRow.Hidden = False\n\n    For Each c In targetRange.Rows\n       If (WorksheetFunction.CountIf(c,\"&lt;&gt;0\") - WorksheetFunction.CountIf(c,\"\") = 0) And (WorksheetFunction.CountA(c) - WorksheetFunction.Count(c) = 0) Then\n           c.EntireRow.Hidden = True\n       End If\n    Next c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 8516539, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/255e89e71b61ea8e26061ef0911f9d92?s=128&d=identicon&r=PG&f=1", "display_name": "ErikSlui", "link": "https://stackoverflow.com/users/8516539/erikslui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4087, "favorite_count": 0, "accepted_answer_id": 46687333, "answer_count": 2, "score": 2, "last_activity_date": 1556594329, "creation_date": 1507719448, "last_edit_date": 1556594329, "question_id": 46686482, "link": "https://stackoverflow.com/questions/46686482/hide-rows-based-on-cells-contaning-all-zeroes-or-no-values", "title": "Hide rows based on cells contaning all zeroes or no values", "body": "<p>I have a dataset where every row is a General Ledger (GL) account and in each column there is the value for the relevant period.</p>\n\n<p><a href=\"https://i.stack.imgur.com/kw4qJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kw4qJ.png\" alt=\"Print screen of Data Set\"></a></p>\n\n<p>I would like to hide all GL accounts (rows) where no values (or zero values) are included for all periods (columns). </p>\n\n<p>The code below seems to work for the \"No values\".</p>\n\n<p>How do I hide all the rows with only zeroes (or all rows with zeroes or \"no values\"? </p>\n\n<p>If one period has an amount, the row shouldn't be hidden.</p>\n\n<pre><code>Sub hide()\n\nDim c As Range\nFor Each c In Range(\"A1:F6\")\n\nIf c.Value = \"\" Then\n   c.EntireRow.Hidden = True\nElse\n   c.EntireRow.Hidden = False\n\nEnd If\nNext c\n\nEnd Sub\n</code></pre>\n\n<p>Furthermore once any amounts change in a row this code should also make the unhidden rows reappear. At this moment it hides a row that has no value, but once this changes, the hidden row doesn't reappear anymore.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 3, "creation_date": 1507719327, "post_id": 46686362, "comment_id": 80320306, "body": "Which statement causes the error?"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1507719375, "post_id": 46686362, "comment_id": 80320334, "body": "What&#39;s <code>nextrow</code> it doesn&#39;t seem to be declared anywhere"}, {"owner": {"reputation": 15, "user_id": 8757955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bf0aa117a97da1e8de80792624e3a55?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Schmid", "link": "https://stackoverflow.com/users/8757955/thomas-schmid"}, "edited": false, "score": 0, "creation_date": 1507719473, "post_id": 46686362, "comment_id": 80320413, "body": "If ActiveCell.Range(n, 1) = ActiveCell.Range(nextRow, 1) Then"}, {"owner": {"reputation": 15, "user_id": 8757955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bf0aa117a97da1e8de80792624e3a55?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Schmid", "link": "https://stackoverflow.com/users/8757955/thomas-schmid"}, "edited": false, "score": 0, "creation_date": 1507719506, "post_id": 46686362, "comment_id": 80320431, "body": "i though nextRow simply refers to the next row seen from the currently active one"}, {"owner": {"reputation": 1474, "user_id": 1969198, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a681568cf3b33612532e90e1cd0e1d3e?s=128&d=identicon&r=PG", "display_name": "AesSedai101", "link": "https://stackoverflow.com/users/1969198/aessedai101"}, "edited": false, "score": 0, "creation_date": 1507719527, "post_id": 46686362, "comment_id": 80320452, "body": "Welcome to StackOverflow! Please have a look at the guides on <a href=\"https://stackoverflow.com/help/asking\">how to ask questions</a>, specifically <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>"}, {"owner": {"reputation": 15, "user_id": 8757955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bf0aa117a97da1e8de80792624e3a55?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Schmid", "link": "https://stackoverflow.com/users/8757955/thomas-schmid"}, "edited": false, "score": 0, "creation_date": 1507719645, "post_id": 46686362, "comment_id": 80320535, "body": "If it helps: the makro is supposed to go though a list of numbers in column A, then check if all of the data in column B is the same. if not it should fill the cells red."}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1507719653, "post_id": 46686362, "comment_id": 80320538, "body": "no <code>nextRow</code> is not vba syntax. I&#39;m guessing you&#39;d want something like <code>If ActiveCell.Range(n, 1) = ActiveCell.Range(n+1, 1) Then</code> instead. Also this line will fall over when <code>n=0</code> (i.e. the first loop) as there is no row 0"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1507720857, "post_id": 46686362, "comment_id": 80321217, "body": "Before you do anything else: Declare all your variables and put <a href=\"https://msdn.microsoft.com/en-us/library/bw9t3484%28v=vs.84%29.aspx\" rel=\"nofollow noreferrer\"><code>Option Explicit</code></a> at the top of each module.   It enforces variable declaration and reports undeclared or misspelled variables/constants at compile time.  To have this automatically in new modules, set the <a href=\"http://www.fmsinc.com/microsoftaccess/modules/options/index.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a> option in the VBA Editor."}], "answers": [{"tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": true, "score": 0, "last_activity_date": 1507720800, "creation_date": 1507720800, "answer_id": 46686936, "question_id": 46686362, "link": "https://stackoverflow.com/questions/46686362/i-am-getting-an-error-message-with-my-vba-macro/46686936#46686936", "title": "I am getting an error message with my vba macro", "body": "<p>Why do you need VBA for this? </p>\n\n<p>This can easily be achieved with the help of Conditional Formatting using the rule =$A2&lt;>$B2 considering you are applying this rule after selecting the range A2:B2 and set the format as per your choice.</p>\n\n<p>But if for some reason, you want to achieve this with the help of VBA, try it like this...</p>\n\n<pre><code>Sub CompareCells()\n    Dim LastRow As Long\n    Dim Rng As Range, Cell As Range\n\n    Application.ScreenUpdating = False\n\n    'find last row used in column A\n    LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    'setting the range in column A, assuming data starts from row2\n    Set Rng = Range(\"A2:A\" &amp; LastRow)\n    'looping through cells in column A\n    For Each Cell In Rng\n        If Cell &lt;&gt; Cell.Offset(0, 1) Then\n            Cell.Resize(1, 2).Interior.Color = vbRed    'this will apply the color to column A and B\n            'Cell.Interior.Color = vbRed     'this will apply color only to column A\n        End If\n    Next Cell\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 8757955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bf0aa117a97da1e8de80792624e3a55?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Schmid", "link": "https://stackoverflow.com/users/8757955/thomas-schmid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 46686936, "answer_count": 1, "score": 0, "last_activity_date": 1507720800, "creation_date": 1507719064, "last_edit_date": 1507720095, "question_id": 46686362, "link": "https://stackoverflow.com/questions/46686362/i-am-getting-an-error-message-with-my-vba-macro", "title": "I am getting an error message with my vba macro", "body": "<p>I am getting an error message with my VBA macro(error 1004 application or object defined error).\ni am using windows 10 and Excel 2016. \nhere is my code:</p>\n\n<pre><code>Sub Fehlercheck()\n    n = 0\n    i = 0\n\n    Do\n        If ActiveCell.Range(n, 1) = ActiveCell.Range(nextRow, 1) Then\n            ActiveCell.Offset(nextRow, 0).Select\n            n = n + 1\n        Else\n            ActiveCell.Offset(-n, 1).Select\n            Do While i &lt;= n\n                If ActiveCell = ActiveCell.Offset(nextRow, 0) Then\n                    ActiveCell.Offset(nextRow, 0).Select\n                    i = i + 1\n                Else\n                    ActiveSheet.Range(ActiveCell.Offset(-i, -1), Cells(n - i, 0)).Select\n                    Selection.Interior.Color = RGB(255, 0, 0)\n                    ActiveSheet.Cells(n + 1, 1).Select\n                End If\n            Loop\n        End If\n    Loop While ActiveCell.Offset(nextRow, 0).Value &lt;&gt; 0\nEnd Sub\n</code></pre>\n\n<p>Thx in advance for your help\nPs: first time asking here, the question might not be in the perfect format.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8758285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1259e66fc297d4edc7a2c5329b7ae1?s=128&d=identicon&r=PG&f=1", "display_name": "LinkToThis", "link": "https://stackoverflow.com/users/8758285/linktothis"}, "edited": false, "score": 0, "creation_date": 1507730354, "post_id": 46689431, "comment_id": 80328100, "body": "Thanks for the reply!   I get the error - Run-Time error &#39;5096&#39;:  (test_o.doc)    The o being the little black circle   Debug highlights the following line   ActiveDocument.SaveAs FileName:=&quot;test_&quot; &amp; FileName &amp; &quot;.doc&quot;  D"}, {"owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "reply_to_user": {"reputation": 21, "user_id": 8758285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1259e66fc297d4edc7a2c5329b7ae1?s=128&d=identicon&r=PG&f=1", "display_name": "LinkToThis", "link": "https://stackoverflow.com/users/8758285/linktothis"}, "edited": false, "score": 0, "creation_date": 1507748004, "post_id": 46689431, "comment_id": 80338879, "body": "Can you share the document on which you get the error. I suppose you are mentioning about the bullet list."}, {"owner": {"reputation": 21, "user_id": 8758285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1259e66fc297d4edc7a2c5329b7ae1?s=128&d=identicon&r=PG&f=1", "display_name": "LinkToThis", "link": "https://stackoverflow.com/users/8758285/linktothis"}, "edited": false, "score": 0, "creation_date": 1507750414, "post_id": 46689431, "comment_id": 80340010, "body": "I can&#39;t im afraid, i&#39;m a teacher and it contains a lot of student data.   It doesn&#39;t show a list, it shows \t\u25cf in the name ."}, {"owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "reply_to_user": {"reputation": 21, "user_id": 8758285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1259e66fc297d4edc7a2c5329b7ae1?s=128&d=identicon&r=PG&f=1", "display_name": "LinkToThis", "link": "https://stackoverflow.com/users/8758285/linktothis"}, "edited": false, "score": 0, "creation_date": 1507785662, "post_id": 46689431, "comment_id": 80350942, "body": "Okay. I understand. I have updated the answer and it will now replace any illegal characters like \u25cf to an underscore &quot;_&quot;. Check if it is okay with you."}, {"owner": {"reputation": 21, "user_id": 8758285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1259e66fc297d4edc7a2c5329b7ae1?s=128&d=identicon&r=PG&f=1", "display_name": "LinkToThis", "link": "https://stackoverflow.com/users/8758285/linktothis"}, "edited": false, "score": 0, "creation_date": 1507791647, "post_id": 46689431, "comment_id": 80353551, "body": "You absolute beauty.   Thank you."}], "tags": [], "owner": {"reputation": 824, "user_id": 6722034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70472b94b95a084f55551520030f88fb?s=128&d=identicon&r=PG&f=1", "display_name": "Arul", "link": "https://stackoverflow.com/users/6722034/arul"}, "is_accepted": false, "score": 0, "last_activity_date": 1507785597, "last_edit_date": 1507785597, "creation_date": 1507728365, "answer_id": 46689431, "question_id": 46686003, "link": "https://stackoverflow.com/questions/46686003/how-to-select-the-first-word-of-a-document/46689431#46689431", "title": "How to select the first word of a document", "body": "<p>Can you try this code:</p>\n\n<pre><code>Sub BreakOnSection()\n   'Used to set criteria for moving through the document by section.\n   Application.Browser.Target = wdBrowseSection\n\n   'A mailmerge document ends with a section break next page.\n   'Subtracting one from the section count stop error message.\n   For i = 1 To ((ActiveDocument.Sections.Count) - 1)\n\n      'Select and copy the section text to the clipboard\n      ActiveDocument.Bookmarks(\"\\Section\").Range.Copy\n\n      'Create a new document to paste text from clipboard.\n      Documents.Add\n      'To save your document with the original formatting'\n      Selection.PasteAndFormat (wdFormatOriginalFormatting)\n\n      'Removes the break that is copied at the end of the section, if any.\n      Selection.MoveUp Unit:=wdLine, Count:=1, Extend:=wdExtend\n      Selection.Delete Unit:=wdCharacter, Count:=1\n\n      'Newly Added\n      'GoTo Starting of the Document\n      Selection.HomeKey Unit:=wdStory\n      Selection.MoveRight Unit:=wdWord, Count:=1, Extend:=True\n      Dim FileName As String\n      FileName = ReplaceIllegalChar(Trim(Selection.Text))\n      'End\n\n      ChangeFileOpenDirectory \"H:\\Output\"\n      DocNum = DocNum + 1\n      ActiveDocument.SaveAs FileName:=\"test_\" &amp; FileName &amp; \".doc\"\n      ActiveDocument.Close\n      'Move the selection to the next section in the document\n      Application.Browser.Next\n   Next i\n   ActiveDocument.Close savechanges:=wdDoNotSaveChanges\nEnd Sub\n\nFunction ReplaceIllegalChar(strIn As String) As String\n\nDim j As Integer\nDim varStr As String, xStr As String\nvarStr = strIn\nFor j = 1 To Len(varStr)\n   Select Case Asc(Mid(varStr, j, 1))\n        Case 48 To 57, 65 To 90, 97 To 122\n        xStr = xStr &amp; Mid(varStr, j, 1)\n   Case Else\n        xStr = xStr &amp; \"_\"\n\n   End Select\nNext\nReplaceIllegalChar = xStr\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8758285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b1259e66fc297d4edc7a2c5329b7ae1?s=128&d=identicon&r=PG&f=1", "display_name": "LinkToThis", "link": "https://stackoverflow.com/users/8758285/linktothis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 941, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1507785597, "creation_date": 1507718025, "last_edit_date": 1507725613, "question_id": 46686003, "link": "https://stackoverflow.com/questions/46686003/how-to-select-the-first-word-of-a-document", "title": "How to select the first word of a document", "body": "<p>I'm trying to write a quick macro, to save my mail merged documents as separate documents, then save each individual document as the first word in each. </p>\n\n<p>Here is what I have so far, to cut the document up, and save it as \"Test_1\" and so on, but I'm having trouble adding the code to select the first word.</p>\n\n<pre><code>    Sub BreakOnSection()\n   'Used to set criteria for moving through the document by section.\n   Application.Browser.Target = wdBrowseSection\n\n   'A mailmerge document ends with a section break next page.\n   'Subtracting one from the section count stop error message.\n   For i = 1 To ((ActiveDocument.Sections.Count) - 1)\n\n      'Select and copy the section text to the clipboard\n      ActiveDocument.Bookmarks(\"\\Section\").Range.Copy\n\n      'Create a new document to paste text from clipboard.\n      Documents.Add\n      'To save your document with the original formatting'\n      Selection.PasteAndFormat (wdFormatOriginalFormatting)\n\n      'Removes the break that is copied at the end of the section, if any.\n      Selection.MoveUp Unit:=wdLine, Count:=1, Extend:=wdExtend\n      Selection.Delete Unit:=wdCharacter, Count:=1\n\n\n\n      ChangeFileOpenDirectory \"H:\\Output\"\n      DocNum = DocNum + 1\n      ActiveDocument.SaveAs FileName:=\"test_\" &amp; DocNum &amp; \".doc\"\n      ActiveDocument.Close\n      'Move the selection to the next section in the document\n      Application.Browser.Next\n   Next i\n   ActiveDocument.Close savechanges:=wdDoNotSaveChanges\nEnd Sub\n</code></pre>\n\n<p>Any help would be much appreciated. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1507717687, "post_id": 46685803, "comment_id": 80319254, "body": "The links you have provided are not working. (Using Google Chrome)"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1507717742, "post_id": 46685803, "comment_id": 80319291, "body": "Same in case of Firefox."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1507721994, "post_id": 46685803, "comment_id": 80321970, "body": "@sktneer i will try to upload them again"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1507722292, "post_id": 46685803, "comment_id": 80322170, "body": "@EliasWick i have uploaded again , could you let me know if you can access ?"}, {"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 1, "creation_date": 1507722677, "post_id": 46685803, "comment_id": 80322395, "body": "It looks good now!"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "reply_to_user": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1507723290, "post_id": 46685803, "comment_id": 80322824, "body": "@EliasWick Is it possible i can do it this way ?"}], "answers": [{"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1507724760, "post_id": 46687935, "comment_id": 80323788, "body": "Thank you for  your suggestion. That is really useful with screenshots."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1507724987, "post_id": 46687935, "comment_id": 80323944, "body": "but i would like to have in code. Because i am trying to generate a report out of it."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1507725087, "post_id": 46687935, "comment_id": 80324010, "body": "Could you help me how i can code with vba ? Because for deriving from one sheet, already  i have a code , I am struck how i can consider two sheets and put them in one table"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 1, "creation_date": 1507725450, "post_id": 46687935, "comment_id": 80324271, "body": "Hi, you can record a macro and it provides you a code whilst doing this. You end up with key code lines being such as   ActiveWorkbook.PivotCaches.Create(SourceType:=xlConsolidatio&zwnj;&#8203;n, SourceData:= _         Array(Array(&quot;Table3[#All]&quot;, &quot;Item1&quot;), Array(&quot;Table4[#All]&quot;, &quot;Item2&quot;)), Version:= _         6).CreatePivotTable TableDestination:=&quot;[Book1]Sheet7!R15C8&quot;, TableName:= _         &quot;PivotTable7&quot;, DefaultVersion:=6"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 1, "creation_date": 1507726413, "post_id": 46687935, "comment_id": 80324950, "body": "I have updated my answer with some more detail to help you."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1510634204, "post_id": 46687935, "comment_id": 81506425, "body": "It refers to the consolidated ranges e.g. item 1 is table 1, item2 is table 2 etc"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1507726391, "last_edit_date": 1507726391, "creation_date": 1507723981, "answer_id": 46687935, "question_id": 46685803, "link": "https://stackoverflow.com/questions/46685803/combining-data-from-two-sheets-and-generating-pivot-table-in-another-sheet/46687935#46687935", "title": "combining data from two sheets and generating pivot table in another sheet", "body": "<p>You don't need VBA. If you set both the source ranges up as tables and note their names e.g. Table3 and Table4 then </p>\n\n<p>1) Set source ranges up as tables</p>\n\n<p>2) Press Alt, D, P to open the pivottable wizard and select Multiple consolidation ranges and create pivotable report<a href=\"https://i.stack.imgur.com/ToE7x.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ToE7x.png\" alt=\"Wizard\"></a></p>\n\n<p>3) Select create a single page for me:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KBnOD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KBnOD.png\" alt=\"single page option\"></a></p>\n\n<p>4) Add your table names as shown</p>\n\n<p><a href=\"https://i.stack.imgur.com/kX2ST.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kX2ST.png\" alt=\"Table name entry\"></a></p>\n\n<p>5) Arrange fields as required\n<a href=\"https://i.stack.imgur.com/roG3G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/roG3G.png\" alt=\"Field arrangement\"></a></p>\n\n<p>6) Uncheck the blank column that appears using dropdown\n<a href=\"https://i.stack.imgur.com/uAry5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uAry5.png\" alt=\"Remove blank column\"></a></p>\n\n<p>You can give some of the items more meaningful names than shown here.</p>\n\n<p>With VBA you can record a macro whilst performing the above steps to get an idea of the code steps and syntax.</p>\n\n<p>An example, would be tailored to your environment looks like as follows:</p>\n\n<pre><code>   Sub CreatePivotMultiRange1()\n'\n' CreatePivotMultiRange1 Macro\n'\n\n'\n    ActiveWorkbook.PivotCaches.Create(SourceType:=xlConsolidation, SourceData:= _\n        Array(Array(\"Table3[#All]\", \"Item1\"), Array(\"Table4[#All]\", \"Item2\")), Version:= _\n        6).CreatePivotTable TableDestination:=\"[Book1]Sheet7!R15C8\", TableName:= _\n        \"PivotTable7\", DefaultVersion:=6\n    ActiveSheet.PivotTables(\"PivotTable7\").DataPivotField.PivotItems( _\n        \"Count of Value\").Position = 1\n    With ActiveSheet.PivotTables(\"PivotTable7\").PivotFields(\"Value\")\n        .Orientation = xlColumnField\n        .Position = 2\n    End With\n    ActiveWorkbook.ShowPivotTableFieldList = False\n    Range(\"L18\").Select\n    With ActiveSheet.PivotTables(\"PivotTable7\").PivotFields(\"Row\")\n        .PivotItems(\"(blank)\").Visible = False\n    End With\n    Range(\"K16\").Select\n    ActiveSheet.PivotTables(\"PivotTable7\").PivotFields(\"Column\").Subtotals = Array( _\n        False, False, False, False, False, False, False, False, False, False, False, False)\n    ActiveSheet.PivotTables(\"PivotTable7\").PivotSelect \"'Column Grand Total'\", _\n        xlDataAndLabel + xlFirstRow, True\n    ActiveSheet.PivotTables(\"PivotTable7\").ColumnGrand = False\nEnd Sub\n</code></pre>\n\n<p>Your lines:</p>\n\n<pre><code>Set pcache = ActiveWorkbook.PivotCaches.Create(xlDatabase, \"'Data'!R4C1:R1048576C16\")\n'set the pivot tbale in sheet\nSet ptable = pcache.CreatePivotTable(sp1.Range(\"A3\"), TableName:=\"PivotTable1\")\n</code></pre>\n\n<p>Becomes something like:</p>\n\n<pre><code> ActiveWorkbook.PivotCaches.Create(SourceType:=xlConsolidation, SourceData:= _\n    Array(Array(\"Table3[#All]\", \"Item1\"), Array(\"Table4[#All]\", \"Item2\")), Version:= _\n    6).CreatePivotTable TableDestination:=sp1.Range(\"A3\"), TableName:= _\n    \"PivotTable1\", DefaultVersion:=6\n\nSet pt = sp1.PivotTables(\"PivotTable1\")\n</code></pre>\n\n<p>And you add the following line at the top with the declarations:</p>\n\n<pre><code> Dim pt As PivotTable\n</code></pre>\n\n<p>You will need to do some code updating potentially as you have done a ptable field addition.</p>\n\n<p>The rest of the code recorded by the macro gives you the layout. </p>\n"}, {"comments": [{"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1507732402, "post_id": 46690451, "comment_id": 80329632, "body": "it works ; but i am confused how i can mention the row field and column field ?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1507732497, "post_id": 46690451, "comment_id": 80329687, "body": "because the row field i need for pivot  is in column M of both the sheet. But in data sheet it starts with row 5 and in missing sheet it starts with row 2. and the column which i need  for pivot is in Column L and i would like to have their count values"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1507733531, "post_id": 46690451, "comment_id": 80330399, "body": "could you tell me how i can ? I tried your code like below . you can see them in edit"}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "reply_to_user": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 1, "creation_date": 1507733585, "post_id": 46690451, "comment_id": 80330429, "body": "It would be better to combine the data from the two sheets into a separate sheet and insert a normal pivot table based on that data set so that you can pick any field from the data set and set it&#39;s orientation."}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1507733711, "post_id": 46690451, "comment_id": 80330513, "body": "But I cant combine them, even though the headers are same, the content inside them are differrent. just the column L and M are same that i can put them under"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1507733732, "post_id": 46690451, "comment_id": 80330525, "body": "Cant I do it with my requirement ?"}, {"owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "edited": false, "score": 0, "creation_date": 1507733810, "post_id": 46690451, "comment_id": 80330583, "body": "because I can work with your code, its just the fact that, I want the row field of my pivot with column L and column field of my pivot as colours and the count values of the colours from both the sheet."}], "tags": [], "owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "is_accepted": false, "score": 1, "last_activity_date": 1507731072, "creation_date": 1507731072, "answer_id": 46690451, "question_id": 46685803, "link": "https://stackoverflow.com/questions/46685803/combining-data-from-two-sheets-and-generating-pivot-table-in-another-sheet/46690451#46690451", "title": "combining data from two sheets and generating pivot table in another sheet", "body": "<p>Please give this a try...</p>\n\n<p><strong>Important things to know before you implement this code:</strong></p>\n\n<ol>\n<li>The code assumes that you have three sheets in the workbook called \"Data\", \"Missing\" and \"Dev\".</li>\n<li>On Data Sheet, convert your data into an Excel Table and name it \"Data\".</li>\n<li>Similarly, on Missing Sheet, convert your data into an Excel Table and name it \"Missing\".</li>\n</ol>\n\n<p>That's all you need to implement this code to your workbook. The code will create a Pivot Table on Dev Sheet in your desired format.</p>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Sub CreatePivotTable()\nDim wsData As Worksheet, wsMissing As Worksheet, wsPivot As Worksheet\nDim tbl1 As ListObject, tbl2 As ListObject\nDim pc As PivotCache, pt As PivotTable, pf As PivotField\n\nApplication.ScreenUpdating = False\n\nSet wsData = Sheets(\"Data\")\nSet wsMissing = Sheets(\"Missing\")\nSet wsPivot = Sheets(\"Dev\")\nwsPivot.Cells.Clear\n\nSet tbl1 = wsData.ListObjects(\"Data\")\nSet tbl2 = wsMissing.ListObjects(\"Missing\")\n\nSet pc = ThisWorkbook.PivotCaches.Create( _\n        SourceType:=xlConsolidation, _\n        SourceData:=Array( _\n        Array(\"'\" &amp; wsData.Name &amp; \"'!\" &amp; tbl1.Range.Address(ReferenceStyle:=xlR1C1), wsData.Name), _\n        Array(\"'\" &amp; wsMissing.Name &amp; \"'!\" &amp; tbl2.Range.Address(ReferenceStyle:=xlR1C1), wsMissing.Name)))\n\nSet pt = pc.CreatePivotTable( _\n            TableDestination:=wsPivot.Range(\"A3\"), _\n            TableName:=\"PivotTable1\")\n\nSet pf = pt.PivotFields(\"Value\")\npf.Orientation = xlColumnField\nSet pf = pt.PivotFields(\"Column\")\npf.Orientation = xlHidden\npt.ColumnGrand = False\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 511, "user_id": 8155124, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/29cda1f21ec8087d25577110f21a888b?s=128&d=identicon&r=PG&f=1", "display_name": "Mikz", "link": "https://stackoverflow.com/users/8155124/mikz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2166, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1507733645, "creation_date": 1507717452, "last_edit_date": 1507733645, "question_id": 46685803, "link": "https://stackoverflow.com/questions/46685803/combining-data-from-two-sheets-and-generating-pivot-table-in-another-sheet", "title": "combining data from two sheets and generating pivot table in another sheet", "body": "<p>I have a sheet called Data and Missing. both the sheets contains the same number of columns. The Data sheet has data starting from row 5 and missing sheet has the data starting from row 2. </p>\n\n<p>I would like to generate a pivot table in my sheet \"Dev\", where i will have one pivot table that shows the data. </p>\n\n<p>I have provided an example image below for the same.</p>\n\n<p>I have the below code running for one sheet and produces pivot table. Could some one suggest, how I can do it with this requirement.</p>\n\n<pre><code>Sub pivotAPQP()\nDim sp1 As Worksheet\nDim pcache As PivotCache\nDim ptable As PivotTable\nDim ct As Integer\nSet sp1 = Sheets(\"Dev\")\n'Se the pivot cache for pivot table\nSet pcache = ActiveWorkbook.PivotCaches.Create(xlDatabase, \"'Data'!R4C1:R1048576C16\")\n'set the pivot tbale in sheet\nSet ptable = pcache.CreatePivotTable(sp1.Range(\"A3\"), TableName:=\"PivotTable1\")\n'Decalre the parameter needed to be counted\nptable.AddDataField ptable.PivotFields(\"COlour\"), \"Count of colour\", xlCount\n'Declare the parameter for the row field adn arrange the values in descending order\nWith ptable\nWith .PivotFields(\"Loc\")\n.Orientation = xlRowField\n.Position = 1\n.PivotItems(\"(blank)\").Visible = False\n.AutoSort xlDescending, \"Count of colour\"\nEnd With\n'Declare the parameters for column field and alighn the values to center\nWith .PivotFields(\"Colour\")\n.Orientation = xlColumnField\n.Position = 1\n.PivotItems(\"(blank)\").Visible = False\nptable.TableRange2.Offset(0, 1).HorizontalAlignment = xlCenter\nEnd With\nEnd With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/oA5Kg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oA5Kg.png\" alt=\"this is my sheet1 structure. in original sheet i have 21 columns.\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/PSa0U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PSa0U.png\" alt=\"this is my sheet2, it is the same as sheet1, that i have 21 columns\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/XT4Zw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XT4Zw.png\" alt=\"this is my result sheet with pivot and would like to have a similar kind.\"></a></p>\n\n<p>EDIT: Trying to implement the code provided by the expert for my requirement</p>\n\n<pre><code>Sub pivotAPQP1()\nDim wsData As Worksheet, wsMissing As Worksheet, wsPivot As Worksheet\nDim tbl1 As ListObject, tbl2 As ListObject\nDim pc As PivotCache, pt As PivotTable, pf As PivotField\n\nApplication.ScreenUpdating = False\n\nSet wsData = Sheets(\"Data\")\nSet wsMissing = Sheets(\"Missing\")\nSet wsPivot = Sheets(\"Dev\")\nwsPivot.Cells.Clear\n\nSet tbl1 = wsData.ListObjects(\"Table10\")\nSet tbl2 = wsMissing.ListObjects(\"Table19\")\n\nSet pc = ThisWorkbook.PivotCaches.Create( _\n        SourceType:=xlConsolidation, _\n        SourceData:=Array( _\n        Array(\"'\" &amp; wsData.Name &amp; \"'!\" &amp; tbl1.Range.Address(ReferenceStyle:=xlR1C1), wsData.Name), _\n        Array(\"'\" &amp; wsMissing.Name &amp; \"'!\" &amp; tbl2.Range.Address(ReferenceStyle:=xlR1C1), wsMissing.Name)))\n\nSet pt = pc.CreatePivotTable( _\n            TableDestination:=wsPivot.Range(\"A3\"), _\n            TableName:=\"PivotTable1\")\npt.AddDataField pt.PivotFields(\"Colour\"), \"Count of colour\", xlCount\n\nWith pt\nWith .PivotFields(\"Loc\")\n.Orientation = xlRowField\n.Position = 1\n.PivotItems(\"(blank)\").Visible = False\n.AutoSort xlDescending, \"Count of colour\"\nEnd With\n'Declare the parameters for column field and alighn the values to center\nWith .PivotFields(\"Colour\")\n.Orientation = xlColumnField\n.Position = 1\n.PivotItems(\"(blank)\").Visible = False\npt.TableRange2.Offset(0, 1).HorizontalAlignment = xlCenter\nEnd With\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "internet-explorer"], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 7250895, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1298335610198240/picture?type=large", "display_name": "KamilG", "link": "https://stackoverflow.com/users/7250895/kamilg"}, "is_accepted": false, "score": 0, "last_activity_date": 1507719522, "creation_date": 1507719522, "answer_id": 46686513, "question_id": 46685514, "link": "https://stackoverflow.com/questions/46685514/how-to-change-drop-down-value-permanently/46686513#46686513", "title": "How to change drop down value permanently", "body": "<p>I found a solution.\nIt is not the most elegant one but it works and is correct enough for my needs.</p>\n\n<p>I have added </p>\n\n<pre><code>  CreateObject(\"WScript.Shell\").Popup \"Just Wait\", 1, \"Waiting\"\n</code></pre>\n\n<p>after value change and it did the trick. I would love to know why does it happen, and why does this \"trick\" solves the issue.</p>\n"}], "owner": {"reputation": 61, "user_id": 7250895, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/1298335610198240/picture?type=large", "display_name": "KamilG", "link": "https://stackoverflow.com/users/7250895/kamilg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507719522, "creation_date": 1507716668, "last_edit_date": 1507718852, "question_id": 46685514, "link": "https://stackoverflow.com/questions/46685514/how-to-change-drop-down-value-permanently", "title": "How to change drop down value permanently", "body": "<p>As I tried to create a automation for my company I stumbled across difficulty I cannot surpass. I have read many articles on this and other sites however I did not found answer.</p>\n\n<p>So basically I have a dropdown list triggered by click on internet application my company uses. User has to change value from \"Read\" to \"All\" for 10 positions. And then application acknowledges the change and allows for form to be saved.</p>\n\n<p>As I managed to write a code which clicks on specific field to activate a dropdown, and choose correct option from this dropdown. However when I loop it through all of those 10 dropdowns, not effect is visible.</p>\n\n<p>There is a funny part. Whenever I put a breakpoint on \"debug.print objinputs.outerHTML\" and then allow for macro to continue the changes takes places and everything is allright. But without breakpoint something is wrong and all the values goes back to \"Read\". Have anyone knows what might be the issue here? </p>\n\n<p>If you need any more informations please let me know.</p>\n\n<pre><code>    Set ifrm = Nothing\n    Do Until ifrm.Length &gt; 0\n        Set ifrm = IE.Document.getElementsByTagName(\"iframe\")(0).contentDocument.getElementsByTagName(\"iframe\")(1).contentDocument.getElementsByTagName(\"iframe\")(0).contentDocument.getElementsByTagName(\"iframe\")(0).contentDocument.getElementsByTagName(\"tbody\")(znacznik - 1).Document.getElementsByTagName(\"td\")\n    Loop\n    Counter = 1\n    For Each ele In ifrm\n        Worksheets(\"Test\").Cells(Counter, 1) = ele.outerHTML\n        Counter = Counter + 1\n        If InStr(ele.outerHTML, \"&lt;td title=\" &amp; Chr(34) &amp; \"Read\") Then\n            ele.Click\n            Do Until Not ele.Busy And ele.readyState = READYSTATE_COMPLETE: Loop\n\n            Set objInputs = Nothing\n            Set objInputs = IE.Document.getElementsByTagName(\"iframe\")(0).contentDocument.getElementsByTagName(\"iframe\")(1).contentDocument.getElementsByTagName(\"iframe\")(0).contentDocument.getElementsByTagName(\"iframe\")(0).contentDocument.getElementsByTagName(\"tbody\")(znacznik - 1).Document.getElementsByTagName(\"select\")(3)\n\n            objInputs.Value = \"All\"\n            Debug.Print objInputs.Value\n\n            Do Until Not IE.Busy And IE.readyState = READYSTATE_COMPLETE: Loop\n\n        End If\n    Next\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1507718019, "post_id": 46685503, "comment_id": 80319453, "body": "When it errors hover over <code>Left(accdate, 4)</code> and <code>Right(accdate, 2)</code>. What values does it display?"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1507718797, "post_id": 46685503, "comment_id": 80319950, "body": "I assume you are reading a cell that is empty for <code>accdate</code>. This will bring the <code>DateSerial</code> to fail. Btw: Is it on purpose that you set the day-part of the <code>DateSerial</code>  to <code>0</code>?"}, {"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1507765453, "post_id": 46685503, "comment_id": 80345798, "body": "@FunThomas Yes. The date is captured from a sheet that has year and month format only &#39;201710&#39;. And the program will give me the last day of the month by default. I actually made that change long ago based on this question I asked. [link&#39;(<a href=\"https://stackoverflow.com/questions/45073672/how-to-convert-yyyymm-number-string-into-end-month-date-using-vba\" title=\"how to convert yyyymm number string into end month date using vba\">stackoverflow.com/questions/45073672/&hellip;</a>)"}, {"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "reply_to_user": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "edited": false, "score": 0, "creation_date": 1507767372, "post_id": 46685503, "comment_id": 80346258, "body": "@Zerk When I get the error, I checked the value the sheet captured. Surprisingly, the correct date can display. for example if the reference sheet&#39;s value is 201710, the selected cell in my main sheet shows 20171031. Just that I keep getting the mismatch error every time."}], "answers": [{"comments": [{"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "edited": false, "score": 0, "creation_date": 1507769288, "post_id": 46692822, "comment_id": 80346729, "body": "I probably should have added in the question that the date format from source sheet is actually 201710 (year &amp; month) only. When the date copies into this sheet, it will automatically generates the last day for the month becoming 20171031. Also &#39;DateSerial(Left(accdate, 4), Right(accdate, 2) + 1, 0) &#39; worked out just fine. Someone on this site recommended the code for me in the past, and he gave me a decent explanation on how it works. You can check it out here: <a href=\"https://stackoverflow.com/questions/45073672/how-to-convert-yyyymm-number-string-into-end-month-date-using-vba\">link</a>"}, {"owner": {"reputation": 146, "user_id": 8661377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uyj1M.jpg?s=128&g=1", "display_name": "JonRo", "link": "https://stackoverflow.com/users/8661377/jonro"}, "reply_to_user": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "edited": false, "score": 0, "creation_date": 1507794111, "post_id": 46692822, "comment_id": 80354890, "body": "Nice solution! I will elaborate the fail."}], "tags": [], "owner": {"reputation": 146, "user_id": 8661377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uyj1M.jpg?s=128&g=1", "display_name": "JonRo", "link": "https://stackoverflow.com/users/8661377/jonro"}, "is_accepted": false, "score": 0, "last_activity_date": 1507794184, "last_edit_date": 1507794184, "creation_date": 1507737781, "answer_id": 46692822, "question_id": 46685503, "link": "https://stackoverflow.com/questions/46685503/excel-macro-issue-1-type-mismatch-on-date-2-setting-complex-condition/46692822#46692822", "title": "Excel Macro issue: 1) Type mismatch on date 2) Setting complex condition", "body": "<p>For the example with <code>Date=20171031</code>, <code>DateSerial(Left(accdate, 4), Right(accdate, 2) + 1, 0)</code> is gonna fail in giving the next day as a result. Maybe these changes ?</p>\n\n<pre><code>Dim D as Date\n...\nIf IsDate(accdate) Then\n    D = DateSerial(Left(accdate, 4), Mid(accdate, 5, 2), Right(accdate, 2))\n    D = D + 1\nElse\n    D = DateSerial(1983, 1, 19) ' launch date of Apple Lisa\nEnd If\nActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 2) = Format(D, \"yyyymmdd\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "edited": false, "score": 0, "creation_date": 1507803526, "post_id": 46706974, "comment_id": 80360667, "body": "well the on error resume next technically works. but I can imagine that&#39;s not gonna work for my boss. I&#39;ll use it for now, just to get this issue off my back temporarily. Thanks."}], "tags": [], "owner": {"reputation": 146, "user_id": 8661377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uyj1M.jpg?s=128&g=1", "display_name": "JonRo", "link": "https://stackoverflow.com/users/8661377/jonro"}, "is_accepted": false, "score": 0, "last_activity_date": 1507803594, "last_edit_date": 1507803594, "creation_date": 1507803117, "answer_id": 46706974, "question_id": 46685503, "link": "https://stackoverflow.com/questions/46685503/excel-macro-issue-1-type-mismatch-on-date-2-setting-complex-condition/46706974#46706974", "title": "Excel Macro issue: 1) Type mismatch on date 2) Setting complex condition", "body": "<p>I added some error-trapping-code which displays some info about the troubling row in the immediate window. As example for creating this output, I entered <code>17/11</code> in cell <code>B11</code> in sheet <code>ACCT_LINE</code>, pretending I lost the preceding <code>20</code> for the year.</p>\n\n<pre><code>    ...\n    accdate = ActiveWorkbook.Sheets(\"ACCT_LINE\").Cells(runv + 2, 2)  ' or Cells(5, 2)//B5\n    On Error Resume Next\n    accdate1 = DateSerial(Left(accdate, 4), Right(accdate, 2) + 1, 0)\n    If Err.Number > 0 Then\n        Debug.Print \"'Err \" & Err.Number & \" for accdate := \" & accdate & _\n            \" // CID := \" & CID & _\n            \" // runv := \" & runv & _\n            \" // value2 := \" & ActiveWorkbook.Sheets(\"ACCT_LINE\").Cells(runv + 2, 2).Value2\n        Debug.Print \"'Err \" & Err.Description\n        Stop\n    End If\n    On Error GoTo 0\n</code></pre>\n\n<p>In the immediate-window, I receive :</p>\n\n<pre><code>Err 13 for accdate := 17/11/2017 // CID := 12 // runv := 9 // value2 := 43056\nErr Type mismatch\n</code></pre>\n"}], "owner": {"reputation": 522, "user_id": 8000620, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/d578915145c003524d71e5b2df6e6088?s=128&d=identicon&r=PG&f=1", "display_name": "hjh93", "link": "https://stackoverflow.com/users/8000620/hjh93"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1507803594, "creation_date": 1507716639, "last_edit_date": 1507769652, "question_id": 46685503, "link": "https://stackoverflow.com/questions/46685503/excel-macro-issue-1-type-mismatch-on-date-2-setting-complex-condition", "title": "Excel Macro issue: 1) Type mismatch on date 2) Setting complex condition", "body": "<p>Sorry for the confusing title. But I can't think of a better way of describing my problem.</p>\n\n<p>I have a sheet of data in Excel that merges data from 2 separate sheets, places them in an allocation sheet and finally put them in another worksheet for display. Currently the display is like so:</p>\n\n<pre><code>+----+-----------+---------+-----------+---------+--------+\n| NO |   Date    | Header  | Line Item | GL Acc  | Amount |\n+----+-----------+---------+-----------+---------+--------+\n|  1 | 20171031  | Header1 |     1     | 1000001 | 9.50   |  \n|  1 |           |         |     2     | 1000001 | -9.50  | \n                              .\n                              .\n                              . \n|  1 |           |         |    901    | 1000002 | 6.80   |\n|  1 |           |         |    902    | 1000002 | -6.80  |\n+----+-----------+---------+-----------+---------+--------+\n</code></pre>\n\n<p>Note that this is a simplified table. When this table is running there can be up to thousands of rows of data. Now I would like to make it so that the table will create a new Date and Header date and restart the Line Item to 1 again when it reaches 900 count. However there is also the condition that the GL Acc cannot have any balance when it is separating.</p>\n\n<p>For Example:</p>\n\n<pre><code>+----+-----------+---------+-----------+---------+--------+\n| NO |   Date    | Header  | Line Item | GL Acc  | Amount |\n+----+-----------+---------+-----------+---------+--------+\n| 1  | 20171031  | Header1 |    1      | 1000001 | 9.50   |\n| 1  |           |         |    2      | 1000001 | -9.50  |\n                              .\n                              .\n                              . \n|  2 |           |         |    1      | 1000002 | 6.80   |\n|  2 |           |         |    2      | 1000002 | -6.80  |\n+----+-----------+---------+-----------+---------+--------+\n</code></pre>\n\n<p>This is the original code snippet for the module:</p>\n\n<pre><code>Sub upload_Entry()\nDim NextID\nDim CID\nDim Header\nDim accdate, accdate1\nHeader = 1\nNextID = 0\nrunv = 3\nSQID = 0\nLastRow = ActiveWorkbook.Sheets(\"ALLOCATION\").Cells(7, 10) * 2\n\nFor C = 3 To ((LastRow + 2))\n\n    SQID = SQID + 1\n    If Header = 1 Then\n        accdate = ActiveWorkbook.Sheets(\"ACCT_LINE\").Cells(runv + 2, 2)\n        accdate1 = DateSerial(Left(accdate, 4), Right(accdate, 2) + 1, 0)\n        ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 2) = accdate1       ' DOC_DATE\n        ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 3) = \"Header1\"\n        Header = 0\n    End If\n\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 4) = SQID 'Line Item\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 5) = ActiveWorkbook.Sheets(\"ALLOCATION\").Cells(runv + 6, 8) 'GL ACC\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 6) = ActiveWorkbook.Sheets(\"ALLOCATION\").Cells(runv + 6, 13) * -1    'Amount\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 1) = 1  'NO\n\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C + 1, 1) = 1 ' NO\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C + 1, 4) = SQID + 1\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C + 1, 5) = ActiveWorkbook.Sheets(\"ALLOCATION\").Cells(runv + 6, 8) 'GL ACC\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C + 1, 6) = ActiveWorkbook.Sheets(\"ALLOCATION\").Cells(runv + 6, 13)\n</code></pre>\n\n<p>Sorry for the messy code. The original was much worse. </p>\n\n<p>My 1st agenda was to make it so that the date and header can create in different rows since the code only shows it placing those values on the 1st row only.</p>\n\n<p>Thus I came up with this code:</p>\n\n<pre><code>Sub upload_Entry()\n    Dim NextID\n    Dim CID\n    Dim Header\n    Dim accdate\n    Header = 1\n    NextID = 0\n    runv = 3\n    SQID = 0\n    LastRow = ActiveWorkbook.Sheets(\"ALLOCATION\").Cells(7, 10) * 2 'dictaces how many rows created     \n\n     For C = 3 To ((LastRow + 2))\n\n    CID = ActiveWorkbook.Sheets(\"ALLOCATION\").Cells(runv + 6, 2) 'B9\n\n    If NextID &lt;&gt; CID Then\n    'If Header = 1 Then\n        SQID = 0\n        SQID = SQID + 1\n\n        accdate = ActiveWorkbook.Sheets(\"ACCT_LINE\").Cells(runv + 2, 2)  ' or Cells(5, 2)//B5\n        accdate1 = DateSerial(Left(accdate, 4), Right(accdate, 2) + 1, 0) \n        ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 2) = accdate1\n        ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 3) = \"Header1\"\n    Else\n        SQID = SQID + 1\n    End If\n\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 4) = SQID\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 5) = ActiveWorkbook.Sheets(\"ALLOCATION\").Cells(runv + 6, 8) 'GL ACC\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 6) = ActiveWorkbook.Sheets(\"ALLOCATION\").Cells(runv + 6, 13) * -1 'Amount\n\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C, 1) = CID ' id\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C + 1, 1) = CID ' id\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C + 1, 4) = SQID + 1\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C + 1, 5) = ActiveWorkbook.Sheets(\"ALLOCATION\").Cells(runv + 6, 8) 'GL ACCT\n    ActiveWorkbook.Sheets(\"UPLOAD_ENTRY\").Cells(C + 1, 17) = ActiveWorkbook.Sheets(\"ALLOCATION\").Cells(runv + 6, 13)   'Amount\n\n    NextID = ActiveWorkbook.Sheets(\"ALLOCATION\").Cells(runv + 6, 2)\n    C = C + 1\n    runv = runv + 1\n    SQID = SQID + 1\n\n      Next C\nEnd Sub\n</code></pre>\n\n<p>The good news is I managed to get the Header to duplicate. But the Date shows Type Mismatch on code:</p>\n\n<pre><code>accdate1 = DateSerial(Left(accdate, 4), Right(accdate, 2) + 1, 0)\n</code></pre>\n\n<p><strong><em>Edit Start</em></strong></p>\n\n<p>The date comes from a sheet where its format is only year and month (201710), when using the original code, the accdate1 code help me get the default last day of the month and fills the complete date in the sheet (20171031).</p>\n\n<p><strong><em>Edit End</em></strong></p>\n\n<p>Thus that is one problem I have. Another major problem is I'm not sure how to set such a complex condition on separating line into new NO when rows reaches 900 and also keep track the balance at the same time.</p>\n\n<p>Is there anyone out there that can help? The more I try and solve this the more cross-eyed I become. Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 4, "creation_date": 1507716073, "post_id": 46685227, "comment_id": 80318179, "body": "You&#39;re missing an End With after .Position = 5"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1507716080, "post_id": 46685227, "comment_id": 80318185, "body": "How many <code>Withs</code> and how many <code>End Withs</code> do you have?"}, {"owner": {"reputation": 878, "user_id": 1509300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MiEeo.png?s=128&g=1", "display_name": "SBF", "link": "https://stackoverflow.com/users/1509300/sbf"}, "edited": false, "score": 1, "creation_date": 1507716466, "post_id": 46685227, "comment_id": 80318451, "body": "First line should be <code>Sub test()</code> or whatever name you want for your sub-routine to match the <code>End Sub</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507718322, "post_id": 46685227, "comment_id": 80319640, "body": "Also consider for the  xlPageField you could loop an array so you don&#39;t need all the With statements. Just one for the xlPage field setting and one for the row. I have pasted an example here: <a href=\"https://pastebin.com/NqXPeazL\" rel=\"nofollow noreferrer\">pastebin.com/NqXPeazL</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1507719594, "post_id": 46685227, "comment_id": 80320498, "body": "<code>Active.Sheet.PivotTables</code> should be <code>ActiveSheet.PivotTables</code>"}, {"owner": {"reputation": 101, "user_id": 8705221, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YrKVaimSmgk/AAAAAAAAAAI/AAAAAAAABGA/2kcuTvtuwVM/photo.jpg?sz=128", "display_name": "Brooks Johnson", "link": "https://stackoverflow.com/users/8705221/brooks-johnson"}, "edited": false, "score": 0, "creation_date": 1507719829, "post_id": 46685227, "comment_id": 80320630, "body": "Thank you for all your help."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1507720648, "creation_date": 1507720648, "answer_id": 46686869, "question_id": 46685227, "link": "https://stackoverflow.com/questions/46685227/next-without-for-vba-excel/46686869#46686869", "title": "Next without For VBA Excel", "body": "<p>You should consider creating a helper function when repeating code.  This will reduce input error, code clutter, and make the code easier to read and debug.</p>\n\n<p><a href=\"https://i.stack.imgur.com/AYEB2.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AYEB2.jpg\" alt=\"Object Browser Demo\"></a></p>\n\n<p>Using the Object Browser, I will copy the Function or Objects' parameters and data types that I want to pass to the helper function.  In this way, I will be able to use Intellisense when calling it.</p>\n\n<p><a href=\"https://i.stack.imgur.com/28laL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/28laL.png\" alt=\"Intellisense Demo\"></a></p>\n\n<hr>\n\n<pre><code>Sub Test()\n    Dim pt As PivotTable\n    Application.ScreenUpdating = False\n    For Each pt In ActiveSheet.PivotTables\n        setPivotFields pt, \"Parent Company\", xlPageField, 1\n        setPivotFields pt, \"Milestone\", xlPageField, 1\n        setPivotFields pt, \"Lead Status\", xlPageField, 2\n        setPivotFields pt, \"Lead Source\", xlPageField, 3\n        setPivotFields pt, \"Contact Owner:Full Name\", xlPageField, 4\n        setPivotFields pt, \"Contact Owner:Full Name\", xlPageField, 5\n        setPivotFields pt, \"Company: Company\", xlPageField, 1\n    Next pt\nEnd Sub\n\nSub setPivotFields(pt As PivotTable, FieldName As String, Orientation As XlPivotFieldOrientation, Position As Variant)\n    With pt.PivotFields(\"Company: Company\")\n        .Orientation = Orientation\n        .Position = Position\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 8705221, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YrKVaimSmgk/AAAAAAAAAAI/AAAAAAAABGA/2kcuTvtuwVM/photo.jpg?sz=128", "display_name": "Brooks Johnson", "link": "https://stackoverflow.com/users/8705221/brooks-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1507720648, "creation_date": 1507715908, "question_id": 46685227, "link": "https://stackoverflow.com/questions/46685227/next-without-for-vba-excel", "title": "Next without For VBA Excel", "body": "<p>I seem to be stuck on what should be a basic issue. I am trying to code all my filters together with VBA. I am new to the language and I think I copied this exactly from a file on Lynda.com but I am stuck. Any help would be great. When I try to run a macro I get a next with out for error.</p>\n\n<pre><code>  Dim pt As PivotTable\n   Application.ScreenUpdating = False\n   For Each pt In Active.Sheet.PivotTables\n    With pt.PivotFields(\"Parent Company\")\n        .Orientation = xlPageField\n        .Position = 1\n    End With\n    With pt.PivotFields(\"Milestone\")\n        .Orientation = xlPageField\n        .Position = 2\n    End With\n    With pt.PivotFields(\"Lead Status\")\n        .Orientation = xlPageField\n        .Position = 3\n    End With\n    With pt.PivotFields(\"Lead Source\")\n        .Orientation = xlPageField\n        .Position = 4\n    End With\n    With pt.PivotFields(\"Contact Owner:Full Name\")\n        .Orientation = xlPageField\n        .Position = 5\n    With pt.PivotFields(\"Company: Company\")\n        .Orientation = xlRowField\n        .Position = 1\n    End With\n    Next pt\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1507715939, "post_id": 46684736, "comment_id": 80318084, "body": "I imagine you meant to use <code>-</code> rather than <code>+</code> in all the parts of the <code>b = </code> statement."}, {"owner": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1507719396, "post_id": 46684736, "comment_id": 80320357, "body": "Thank you... lol. I saw that just as the notification came through"}], "owner": {"reputation": 53, "user_id": 3643482, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/a6dfec29d7341df83bad0eec5b137449?s=128&d=identicon&r=PG&f=1", "display_name": "Flaniganga", "link": "https://stackoverflow.com/users/3643482/flaniganga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507714423, "creation_date": 1507714423, "question_id": 46684736, "link": "https://stackoverflow.com/questions/46684736/vba-userform-iif-calculation-not-calculating-correctly", "title": "VBA Userform Iif Calculation not calculating correctly", "body": "<p>Hi there I have a userform with 8 combobxes that I have coded as such</p>\n\n<pre><code>With Cbx1_1\n.AddItem \"N/A\"\n.AddItem \"Yes\"\n.AddItem \"No\"\nEnd With\n\nWith Cbx1_2\n.AddItem \"N/A\"\n.AddItem \"Yes\"\n.AddItem \"No\"\nEnd With , etc,etc,etc\n</code></pre>\n\n<p>now I am trying to get a percentage in OUTBX5(TextBox) that will give me the number of \"Yes\" over the number on applicable Questions. \nThis has brought me to the code :</p>\n\n<pre><code> Private Sub CommandButton6_Click()\n a = IIf(Cbx1_1.Value = \"Yes\", 1, 0) + IIf(Cbx1_2.Value = \"Yes\", 1, 0)_\n + IIf(Cbx1_3.Value = \"Yes\", 1, 0) + IIf(Cbx1_4.Value = \"Yes\", 1, 0)_\n + IIf(Cbx1_5.Value = \"Yes\", 1, 0) + IIf(Cbx1_6.Value = \"Yes\", 1, 0)_\n + IIf (Cbx1_7.Value = \"Yes\", 1, 0) + IIf(Cbx1_8.Value = \"Yes\", 1, 0)_\n\n b = 8 - IIf(Cbx1_1.Value = \"N/A\", 1, 0) + IIf(Cbx1_2.Value = \"N/A\", 1, 0)_\n + IIf(Cbx1_3.Value = \"N/A\", 1, 0) + IIf(Cbx1_4.Value = \"N/A\", 1, 0)_\n + IIf(Cbx1_5.Value = \"N/A\", 1, 0) + IIf(Cbx1_6.Value = \"N/A\", 1, 0)_\n + IIf(Cbx1_7.Value = \"N/A\", 1, 0) + IIf(Cbx1_8.Value = \"N/A\", 1, 0)_\n\n OUTBX5.Text = Format(a / b, \"00%\")\n</code></pre>\n\n<p>Now when I select Yes or No in all the boxes I get the correct Answer.\nHowever when I leave some of the combo boxes as N/A the calculation goes pear-shaped, for example if all the boxes are checked as yes I get 100% as a result, by changing 1 of the combo boxes to N/A the result should be 100% but the result I get is 78%.</p>\n\n<p>Can someone tell me where I went wrong?</p>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507715600, "post_id": 46684575, "comment_id": 80317874, "body": "What determines if Col1 is an increase versus Col2? The difference between the numbers on the inside, the outside or something else?  For part 1 you could use logic such as in cell A1 (assuming data is in A2:B3)  =LEFT(A2,LEN(A2)-FIND(&quot;(&quot;,A2,1))+SUBSTITUTE(LEFT(A3,LEN(A3)-&zwnj;&#8203;FIND(&quot;(&quot;,A3,1)),&quot;(&quot;,&zwnj;&#8203;&quot;&quot;)&amp;&quot;(&quot;&amp;SUBSTITUTE(R&zwnj;&#8203;IGHT(A2,LEN(A2)-FIND&zwnj;&#8203;(&quot;(&quot;,A2,1)),&quot;)&quot;,&quot;&quot;)+&zwnj;&#8203;SUBSTITUTE(RIGHT(A3,&zwnj;&#8203;LEN(A3)-FIND(&quot;(&quot;,A3,&zwnj;&#8203;1)),&quot;)&quot;,&quot;&quot;)&amp;&quot;)&quot;"}, {"owner": {"reputation": 417, "user_id": 8339775, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6a08abff0c099c41d55af98fca0650d9?s=128&d=identicon&r=PG&f=1", "display_name": "Fiona", "link": "https://stackoverflow.com/users/8339775/fiona"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507715878, "post_id": 46684575, "comment_id": 80318038, "body": "An increase arrow would be when the outside number in Col1 is bigger than the outside number in Col2. Sorry, I should have made that more clear. I&#39;ll give that Excel formula a try now for part 1. Thanks"}, {"owner": {"reputation": 417, "user_id": 8339775, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6a08abff0c099c41d55af98fca0650d9?s=128&d=identicon&r=PG&f=1", "display_name": "Fiona", "link": "https://stackoverflow.com/users/8339775/fiona"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507716545, "post_id": 46684575, "comment_id": 80318521, "body": "@QHarr when using the above formua I get an error at the second &quot;FIND&quot; function. In my code I am using data between C24:C25 and inputting in C23"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507716718, "post_id": 46684575, "comment_id": 80318633, "body": "Is your data as posted above and with formulas in A1:B1 and values in A2:B3?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507716829, "post_id": 46684575, "comment_id": 80318708, "body": "You have two columns in your posting. Can you post an image of your data?"}, {"owner": {"reputation": 417, "user_id": 8339775, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6a08abff0c099c41d55af98fca0650d9?s=128&d=identicon&r=PG&f=1", "display_name": "Fiona", "link": "https://stackoverflow.com/users/8339775/fiona"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507716886, "post_id": 46684575, "comment_id": 80318742, "body": "Oh don&#39;t worry! I must have copied it in wrong. You answer below is perfect! Thank you :)"}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1507716625, "creation_date": 1507716625, "answer_id": 46685497, "question_id": 46684575, "link": "https://stackoverflow.com/questions/46684575/sum-numbers-inside-and-outside-brackets-and-create-arrow-based-on-values-in-vba/46685497#46685497", "title": "Sum Numbers inside and outside brackets and create arrow based on values in VBA or Excel", "body": "<p>Ok.</p>\n\n<p>Assuming data is in A2:B3.</p>\n\n<p>Part 1:</p>\n\n<p>In Cell A1 </p>\n\n<pre><code>=LEFT(A2,LEN(A2)-FIND(\"(\",A2,1))+SUBSTITUTE(LEFT(A3,LEN(A3)-FIND(\"(\",A3,1)),\"(\",\"\")&amp;\"(\"&amp;SUBSTITUTE(RIGHT(A2,LEN(A2)-FIND(\"(\",A2,1)),\")\",\"\")+SUBSTITUTE(RIGHT(A3,LEN(A3)-FIND(\"(\",A3,1)),\")\",\"\")&amp;\")\"\n</code></pre>\n\n<p>In Cell B1</p>\n\n<pre><code>=SUBSTITUTE(LEFT(B2,LEN(B2)-FIND(\"(\",B3,1)),\"(\",\"\")+SUBSTITUTE(LEFT(B3,LEN(B3)-FIND(\"(\",B3,1)),\"(\",\"\")&amp;\"(\"&amp;SUBSTITUTE(RIGHT(B2,LEN(B2)-FIND(\"(\",B2,1)),\")\",\"\")+SUBSTITUTE(RIGHT(B3,LEN(B3)-FIND(\"(\",B3,1)),\")\",\"\")&amp;\")\"\n</code></pre>\n\n<p>Part 2:</p>\n\n<p>Cell C2 enter </p>\n\n<pre><code>=LEFT(A2,LEN(A2)-FIND(\"(\",A2,1))+SUBSTITUTE(LEFT(A3,LEN(A3)-FIND(\"(\",A3,1)),\"(\",\"\")-(SUBSTITUTE(LEFT(B2,LEN(B2)-FIND(\"(\",B3,1)),\"(\",\"\")+SUBSTITUTE(LEFT(B3,LEN(B3)-FIND(\"(\",B3,1)),\"(\",\"\"))\n</code></pre>\n\n<p>Then in home tab set Font to white so value is not visible\nThen in home apply formatting to the cell -> conditional formatting use icon sets -> directional</p>\n\n<p>Repeat these steps for additional cells as required.</p>\n"}], "owner": {"reputation": 417, "user_id": 8339775, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6a08abff0c099c41d55af98fca0650d9?s=128&d=identicon&r=PG&f=1", "display_name": "Fiona", "link": "https://stackoverflow.com/users/8339775/fiona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "accepted_answer_id": 46685497, "answer_count": 1, "score": 0, "last_activity_date": 1507716625, "creation_date": 1507713997, "question_id": 46684575, "link": "https://stackoverflow.com/questions/46684575/sum-numbers-inside-and-outside-brackets-and-create-arrow-based-on-values-in-vba", "title": "Sum Numbers inside and outside brackets and create arrow based on values in VBA or Excel", "body": "<p>The question I have has two parts and I don't mind using \"simple\" Excel or VBA.</p>\n\n<p>I basically have two columns as follows</p>\n\n<pre><code>    Col1     Col2\nA                  \nB  20(7)     4(4)\nC   4(3)     9(3)\n</code></pre>\n\n<p>I want row A to sum the numbers outside the brackets with each other and the numbers within the brackets with each other. The result would be as follows.</p>\n\n<pre><code>    Col1     Col2\nA  24(10)   13(7)          \nB  20(7)     4(4)\nC   4(3)     9(3)\n</code></pre>\n\n<p>So that's the first part of the question and I don't mind if this is done in Excel or VBA.</p>\n\n<p>Part two of the question is creating arrows based on whether Col1 is an increase or decrease from Col2. For instance I would want an arrow pointing upward for Col1 Row A printed next to Col2 as the number has increased. I would then want another arrow pointing upward for row B and an arrow pointing downard for C to indicate a decrease. Once again Excel or VBA is fine however I would have thought this would be easier to achieve in VBA as I don't want to have to manually do this every time but instead click a command button for an arrow to appear.</p>\n\n<p>Thanks in advance for any help. </p>\n"}, {"tags": ["vba", "excel", "range"], "comments": [{"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1507715742, "post_id": 46684558, "comment_id": 80317950, "body": "I have never created anything like you are asking, but it seems that what you are asking will require a bit of coding and if you are new, it&#39;s going to be a bit more tricky. I found this <a href=\"https://support.office.com/en-us/article/Find-named-ranges-14513df5-0d79-4cd5-9a03-968905b244e6\" rel=\"nofollow noreferrer\">Link</a> on how you can manually search and find a named Range."}, {"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1507727296, "post_id": 46684558, "comment_id": 80325644, "body": "Please take the <a href=\"https://stackoverflow.com/tour\">tour</a>, read <a href=\"https://stackoverflow.com/help/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>. Please verify <a href=\"http://meta.stackoverflow.com/q/284236\">Why is \u201cCan someone help me?\u201d not an actual question?</a> and post what was tried."}], "owner": {"reputation": 13, "user_id": 3168114, "user_type": "registered", "profile_image": "https://graph.facebook.com/699894380/picture?type=large", "display_name": "Tommy", "link": "https://stackoverflow.com/users/3168114/tommy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507713910, "creation_date": 1507713910, "question_id": 46684558, "link": "https://stackoverflow.com/questions/46684558/copying-named-ranges-that-contain-a-certain-value-to-another-worksheet-with-vba", "title": "Copying named ranges that contain a certain value to another worksheet with VBA", "body": "<p>I have a worksheet with 100 to 200 named ranges.  I would like to search each of the named ranges en when they contain a certain value in any of the cells in the range, the range should be copied to another worksheet.</p>\n\n<p>I am new to VBA.  So any help is useful.  Always nice to learn a thing or two :)</p>\n"}, {"tags": ["vba", "excel", "validation", "conditional-formatting"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7630058"}, "edited": false, "score": 0, "creation_date": 1507714669, "post_id": 46684758, "comment_id": 80317253, "body": "No, actually, the whole range duplicates are not needed to be highlighted. Whole range will have duplicates as each column will have same data set.  Color highlight is needed only when the data repeats across one row or one column."}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1507715398, "post_id": 46684758, "comment_id": 80317746, "body": "So you need conditional formatting for each column and for each row separately.. If there is large number of rows, you could use macro to format them one by one."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7630058"}, "edited": false, "score": 0, "creation_date": 1507715982, "post_id": 46684758, "comment_id": 80318111, "body": "No. I already have conditional formatting for each row and each column separately. Now what I need is to highlight those cells in the range which have same value as is marked duplicate by the conditional formatting, other than those marked as duplicate."}, {"owner": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "edited": false, "score": 0, "creation_date": 1507716041, "post_id": 46684758, "comment_id": 80318152, "body": "So you need just one of the two (or more) duplicated values to be highlighted, not all of them - is this correct?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7630058"}, "edited": false, "score": 0, "creation_date": 1507716415, "post_id": 46684758, "comment_id": 80318412, "body": "No. Say column one has duplicate values in row 3 and 8. So cells (3,1) and (8,1) will be highlighted using conditional formatting rule. Now, the duplicate value be (say) &quot;X&quot;. X is also observed in cells (4,2) and (7,3). I need to highlight these cells also.  But similarly, in the whole range, value &quot;Z&quot; is present in cells (1,1), (5,2) and (10,3). So that is not duplicate in any row or any column. So these should not be colored, although they are duplicate across the whole range."}, {"owner": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "edited": false, "score": 0, "creation_date": 1507717181, "post_id": 46684758, "comment_id": 80318941, "body": "Does this pseudocode illustrate your goal: <code>For Each cell In conditionalFormattingHighlightedCells For Each otherCell In allCells If cell = otherCell Then otherCell.Style = &quot;Highlighted&quot; Next otherCell Next cell</code> ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7630058"}, "edited": false, "score": 0, "creation_date": 1507726712, "post_id": 46684758, "comment_id": 80325171, "body": "@MarcinSzaleniec Hey thanks! But I need your help in following things: 1. How to input my own colors in this code? 2. I want this to work as soon as someone enters values in the range. How to call the sub real time as someone changes a value in the range? 3. As soon as the user changes the duplicate value to non-duplicate, the colors should again be removed. Your solution is not handling this right now. How to do that?  I think this is why I need duplicate check instead of count check. That as soon as duplicates are removed, the color highlights are removed."}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1507728345, "post_id": 46684758, "comment_id": 80326510, "body": "come on, you can easily google it. Add 2&amp;3: use events for this worksheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7630058"}, "edited": false, "score": 0, "creation_date": 1507809798, "post_id": 46684758, "comment_id": 80364528, "body": "@MarcinSzaleniec I am not able to remove the highiighted color when the duplicates are removed. How to do that?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7630058"}, "reply_to_user": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "edited": false, "score": 0, "creation_date": 1507809890, "post_id": 46684758, "comment_id": 80364598, "body": "@MaciejLipinski Yes that illustrates my goal. Just that once the conditional formatting highlight is removed (say duplicate value is deleted), then the other cell highlight should be automatically removed."}, {"owner": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "edited": false, "score": 0, "creation_date": 1507812386, "post_id": 46684758, "comment_id": 80366388, "body": "That&#39;s not possible without 1. removing the macro-induced formatting and 2. running the entire macro again. This could be resource-intensive and annoying, if every cell edit by the user is followed by several seconds (optimistically) of macro busytime. You could have the macro run on the BeforeSave event, thus validating the formatting."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7630058"}, "reply_to_user": {"reputation": 187, "user_id": 7240351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08f022d85c0352244628cabc55dcb16a?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej Lipinski", "link": "https://stackoverflow.com/users/7240351/maciej-lipinski"}, "edited": false, "score": 0, "creation_date": 1508310808, "post_id": 46684758, "comment_id": 80556088, "body": "@MaciejLipinski To clarify, forget about my problem and see it as a Sudoku game. In standard Sudoku games, the cells with duplicate value in box, row or column are highlighted and as soon as the duplicate are removed the color is removed. Similarly all other cells with value that is selected are highlighted with a color. That&#39;s exactly what I need in my excel, just that here it is not a game."}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 1, "last_activity_date": 1507718408, "last_edit_date": 1507718408, "creation_date": 1507714482, "answer_id": 46684758, "question_id": 46684469, "link": "https://stackoverflow.com/questions/46684469/excel-how-to-color-cells-based-on-color-of-other-cells-having-same-value-in-a-r/46684758#46684758", "title": "Excel: How to color cells based on color of other cells having same value in a range?", "body": "<p>You could use conditional formatting->Duplicate Values for the whole range, with different color and set up sequence in Conditional Formatting->Manage Rules. No need of VBA in my opinion. </p>\n\n<p>EDIT:\nOk, I think I know what are you asking for. Try this little subroutine:</p>\n\n<pre><code>Sub PaintDuplis()\nDim rng As Range\nDim col As Range\nDim row As Range\nDim cl As Range, cl2 As Range\n\nSet rng = Range(\"B4:D11\") 'or whatever your range is.\n'Columns\nFor Each col In rng.Columns\n  For Each cl In col.Cells\n    If WorksheetFunction.CountIf(col, cl.Value) &gt; 1 Then cl.Interior.Color =    vbYellow\n  Next cl\nNext col\n\n'Rows\nFor Each row In rng.rows\n  For Each cl In row.Cells\n    If WorksheetFunction.CountIf(row, cl.Value) &gt; 1 Then cl.Interior.Color = vbYellow\n  Next cl\nNext row\n\n'Paint whole range\nFor Each cl In rng\n  If cl.Interior.Color = vbYellow Then\n    For Each cl2 In rng\n        If cl2.Value = cl.Value And cl2.Interior.Color &lt;&gt; vbYellow Then cl2.Interior.Color = vbRed\n    Next cl2\n  End If\nNext cl\n</code></pre>\n\n<p>I have given up conditional formatting, instead I have used VBA to paint duplicates in columns/rows and then painted all still white cells with red if it equals to one already in yellow. Hope it helped. </p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7630058"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 724, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507718408, "creation_date": 1507713637, "last_edit_date": 1507714565, "question_id": 46684469, "link": "https://stackoverflow.com/questions/46684469/excel-how-to-color-cells-based-on-color-of-other-cells-having-same-value-in-a-r", "title": "Excel: How to color cells based on color of other cells having same value in a range?", "body": "<p>I have a range / table of say 10 rows to 3 columns.</p>\n\n<p>Any particular cell can have any particular value from the list created using Data validation. All the cells in this range have the same data validation list.</p>\n\n<p>If a value repeats across any row or across any column, not diagonally or otherwise, then those values are highlighted using conditional formatting.</p>\n\n<p>Now I want that if the same value is present elsewhere in non-duplicate row or column, then those cells should be colored too. (Preferably a different color than one used for conditional formatting to know the difference between both).</p>\n\n<p>The purpose is to know which values are repeated and how, and where in the range those values are used but are not repeated as per the criteria.</p>\n\n<p>P.s.: Please tell if additional information or some clarification is required.</p>\n\n<p>Refer the attached image to understand my query better.\nThe blue ones are colored through conditional formatting and the green ones are needed to be colored through your help.</p>\n\n<p><a href=\"https://i.stack.imgur.com/6Wpll.jpg\" rel=\"nofollow noreferrer\">Image for understanding</a></p>\n"}, {"tags": ["excel", "powerpivot", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1507715205, "post_id": 46684337, "comment_id": 80317633, "body": "And? What happens with a PowerPivot table? What is in the cell? You need to give a bit more detail I think."}, {"owner": {"reputation": 1, "user_id": 8757688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270e07d935d506661987dfe62ce29685?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/8757688/sai"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1507725768, "post_id": 46684337, "comment_id": 80324468, "body": "cell contains the value which needs to be passed to the power pivot report fields.     The same code was woked fine for normal pivot tables ,but it is throwing run time error for power pivot."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8757688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270e07d935d506661987dfe62ce29685?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/8757688/sai"}, "edited": false, "score": 0, "creation_date": 1507800075, "post_id": 46696146, "comment_id": 80358421, "body": "@Marcus-Actually i need to pass that cell reference to report filters of pivot with different columns in the data .if all the columns are same then i can use slicer.but my requirement is different"}], "tags": [], "owner": {"reputation": 471, "user_id": 4771616, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd2270fa2cfe6204e1042fe1cc9fa6f6?s=128&d=identicon&r=PG&f=1", "display_name": "Marcus", "link": "https://stackoverflow.com/users/4771616/marcus"}, "is_accepted": false, "score": 0, "last_activity_date": 1507750394, "creation_date": 1507750394, "answer_id": 46696146, "question_id": 46684337, "link": "https://stackoverflow.com/questions/46684337/controlling-report-filters-of-powerpivot-using-excel-vba/46696146#46696146", "title": "controlling report filters of powerpivot using excel VBA", "body": "<p>Assuming that the main idea is having all 10 pivots in sync, the non VBA way to this would be to add a slicer to one of the pivot tables for filtering.  Then go to each of the other pivots and set the filter connection to your slicer.</p>\n"}], "owner": {"reputation": 1, "user_id": 8757688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270e07d935d506661987dfe62ce29685?s=128&d=identicon&r=PG&f=1", "display_name": "Sai", "link": "https://stackoverflow.com/users/8757688/sai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 278, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507750394, "creation_date": 1507713274, "last_edit_date": 1531164843, "question_id": 46684337, "link": "https://stackoverflow.com/questions/46684337/controlling-report-filters-of-powerpivot-using-excel-vba", "title": "controlling report filters of powerpivot using excel VBA", "body": "<p>I had 10 power pivot tables which report filters needs to be controlled by a cell reference using excel VBA in Excel-2010</p>\n\n<p>The same thing works for normal pivot table .</p>\n\n<pre><code>NewCat = Worksheets(6).Range(\"G12\").Value\n\n\nSet pt1 = Worksheets(5).PivotTables(\"PivotTable3\")\nSet Field1 = pt1.PivotFields(\"[Lead_f].[Lead_Generation_Month].\n[Lead_Generation_Month]\")\n\nWith pt1\nField1.CurrentPage = NewCat\npt1.RefreshTable\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "macos", "mkdir"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507713425, "post_id": 46684259, "comment_id": 80316341, "body": "Does this help? <a href=\"https://www.rondebruin.nl/mac/mac017.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/mac/mac017.htm</a>     Seems to imply there might be more to the filepath before the /Desktop"}, {"owner": {"reputation": 373, "user_id": 3830066, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6aMRf.jpg?s=128&g=1", "display_name": "Krithi07", "link": "https://stackoverflow.com/users/3830066/krithi07"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507713473, "post_id": 46684259, "comment_id": 80316387, "body": "Read through all of these"}, {"owner": {"reputation": 373, "user_id": 3830066, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6aMRf.jpg?s=128&g=1", "display_name": "Krithi07", "link": "https://stackoverflow.com/users/3830066/krithi07"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507713900, "post_id": 46684259, "comment_id": 80316721, "body": "You mean &quot;/Users/admin/Desktop/test/2017&quot; ?I tried that too. I also tried using : instead of /"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507714076, "post_id": 46684259, "comment_id": 80316857, "body": "Did you try running the code at the link to verify your desktop path?"}, {"owner": {"reputation": 373, "user_id": 3830066, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6aMRf.jpg?s=128&g=1", "display_name": "Krithi07", "link": "https://stackoverflow.com/users/3830066/krithi07"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507714998, "post_id": 46684259, "comment_id": 80317488, "body": "I just refreshed everything, deleted the test folder and now it works. Phew!"}], "owner": {"reputation": 373, "user_id": 3830066, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/6aMRf.jpg?s=128&g=1", "display_name": "Krithi07", "link": "https://stackoverflow.com/users/3830066/krithi07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 896, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507713046, "creation_date": 1507713046, "question_id": 46684259, "link": "https://stackoverflow.com/questions/46684259/try-creating-folder-using-mac-vba", "title": "Try creating folder using Mac VBA", "body": "<p>I'm working on Excel 11 Mac OS and below is the <a href=\"https://www.rondebruin.nl/mac/mac010.htm\" rel=\"nofollow noreferrer\">code</a> I'm using for creating a folder </p>\n\n<pre><code>Function MakeFolderIfNotExist(Folderstring As String)\nDim ScriptToMakeFolder As String\nDim str As String\nIf Val(Application.Version) &lt; 15 Then\n    ScriptToMakeFolder = \"tell application \" &amp; Chr(34) &amp; _\n                         \"Finder\" &amp; Chr(34) &amp; Chr(13)\n    ScriptToMakeFolder = ScriptToMakeFolder &amp; _\n            \"do shell script \"\"mkdir -p \"\" &amp; quoted form of posix path of (\" &amp; _\n                    Chr(34) &amp; Folderstring &amp; Chr(34) &amp; \")\" &amp; Chr(13)\n    ScriptToMakeFolder = ScriptToMakeFolder &amp; \"end tell\"\n    On Error Resume Next\n    MacScript (ScriptToMakeFolder)\n    On Error GoTo 0\n\nElse\n    str = MacScript(\"return POSIX path of (\" &amp; _\n                    Chr(34) &amp; Folderstring &amp; Chr(34) &amp; \")\")\n    MkDir str\nEnd If\nEnd Function\n</code></pre>\n\n<p>After I call the function using </p>\n\n<pre><code>MakeFolderIfNotExist(\"/Desktop/test/2017\") \n</code></pre>\n\n<p>I'm getting the error saying path not found. I've been searching the internet for good 2 hours now with no luck. can somebody please help?</p>\n"}, {"tags": ["vba", "excel", "filter"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507713134, "post_id": 46683856, "comment_id": 80316137, "body": "Also, is it always the last 5 sheets? What happens if a user re-arranges the sheets or adds/deletes sheets?"}, {"owner": {"reputation": 47, "user_id": 8152609, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10212582009602150/picture?type=large", "display_name": "Dilpreet Singh \u0a74", "link": "https://stackoverflow.com/users/8152609/dilpreet-singh-%e0%a9%b4"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507876314, "post_id": 46683856, "comment_id": 80393830, "body": "It is always the last 5 sheets @QHarr"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507715899, "post_id": 46685062, "comment_id": 80318055, "body": "OP has just added a sheet so last 5 would include the sheet they are trying to paste to wouldn&#39;t it? Maybe specify in the Add sheet part a before condition?"}, {"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1507716247, "post_id": 46685062, "comment_id": 80318296, "body": "That&#39;s a good point, but it doesn&#39;t seem to work this way. <code>Worksheets.Add</code> adds the sheet on the most left side of the workbook. So it shouldn&#39;t affect the rest of the code. To secure this, we could use <code>Before:=Worksheets(1)</code>."}, {"owner": {"reputation": 47, "user_id": 8152609, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10212582009602150/picture?type=large", "display_name": "Dilpreet Singh \u0a74", "link": "https://stackoverflow.com/users/8152609/dilpreet-singh-%e0%a9%b4"}, "edited": false, "score": 0, "creation_date": 1507795145, "post_id": 46685062, "comment_id": 80355454, "body": "Hello @EliasWick I would like to thank you for the answer. It is very well explained. First of all i want to take the values from the last 5 sheets i.e. the sheets placed at the right most only.  When i try to run your code, i reach the Do while loop and it skips the condition and goes to the next sheet directly. Can you please simulate once and correct it if necessary."}, {"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 1, "creation_date": 1507795250, "post_id": 46685062, "comment_id": 80355524, "body": "Could you update your post with the code you have written, so that I can see where it fails? :)"}, {"owner": {"reputation": 47, "user_id": 8152609, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10212582009602150/picture?type=large", "display_name": "Dilpreet Singh \u0a74", "link": "https://stackoverflow.com/users/8152609/dilpreet-singh-%e0%a9%b4"}, "edited": false, "score": 0, "creation_date": 1507795400, "post_id": 46685062, "comment_id": 80355612, "body": "Dim X As Integer Dim XLrow As Integer  Worksheets.Add ActiveSheet.Name = &quot;Pending week&quot;  For X = (Worksheets.Count - 4) To Worksheets.Count  XLrow = 1  Do Until Worksheets(1).Cells(XLrow, &quot;J&quot;) = &quot;&quot;      If Worksheets(1).Cells(XLrow, &quot;J&quot;) = &quot;Pending&quot; Then         Worksheets(1).Range(XLrow &amp; &quot;:&quot; &amp; XLrow) = Worksheets(&quot;Pending week&quot;).Cells(XLrow, &quot;J&quot;).Value     End If  XLrow = XLrow + 1 Loop  Next"}, {"owner": {"reputation": 47, "user_id": 8152609, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10212582009602150/picture?type=large", "display_name": "Dilpreet Singh \u0a74", "link": "https://stackoverflow.com/users/8152609/dilpreet-singh-%e0%a9%b4"}, "edited": false, "score": 0, "creation_date": 1507795413, "post_id": 46685062, "comment_id": 80355622, "body": "@EliasWick Please refer to the comment above"}, {"owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "edited": false, "score": 0, "creation_date": 1507795512, "post_id": 46685062, "comment_id": 80355682, "body": "Could you add it into your original post and type it like this: <code>code</code>? It&#39;s very hard to read it like you have posted it."}], "tags": [], "owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "is_accepted": false, "score": 1, "last_activity_date": 1507715344, "creation_date": 1507715344, "answer_id": 46685062, "question_id": 46683856, "link": "https://stackoverflow.com/questions/46683856/filter-and-copy-certain-rows-from-multiple-excel-sheets-to-another/46685062#46685062", "title": "Filter and copy certain rows from multiple excel sheets to another", "body": "<p>You can create this yourself very easily if you just break it down:</p>\n\n<ul>\n<li>Add a new Sheet</li>\n<li>Name the sheet to Pending Week</li>\n<li>Find the five latest sheets.</li>\n<li>Create some kind of loop that copy paste row if cells in column J contains the value \"Pending\"</li>\n</ul>\n\n<p>You have not provided any code, so I'll give you a base to work from:</p>\n\n<p><strong>You add a new sheet &amp; name it using:</strong></p>\n\n<pre><code>Worksheets.Add\nActiveSheet.Name = \"Pending week\"\n</code></pre>\n\n<p><strong>Find the five latest sheets</strong></p>\n\n<p>To my knowledge, you can't find the latest sheets. Sheets doesn't contain the date and time of when they were created. But if we ignore that and expect the five latest sheets to be placed in the workbook to the far most right (Default position for newly created sheets). Then you need to figure out how many sheets you have and count backwards.</p>\n\n<p>You can use: <code>Worksheets.Count</code> to count all the sheets. Use this number and count it backwards. My first thought would be to use a <code>For Loop</code></p>\n\n<pre><code>Dim X As Integer\nFor X = (Worksheets.Count - 4) To Worksheets.Count\n\nNext\n</code></pre>\n\n<p><code>X</code> would be the identifier to find our latest sheets. So you should incorporate that into our loop below. You want to place the loop within this For Block.</p>\n\n<p><strong>Loop</strong></p>\n\n<p>There are many ways to find a value in a sheet, but you need to figure out what the last row of your sheets are. Without it we don't know when the code should stop.</p>\n\n<p>You can use a <code>Do Until</code> Loop if there is a value in all J cells. Then you can simply insert the entire row into <em>Pending week</em></p>\n\n<p>It would look something like:</p>\n\n<pre><code>Dim XLrow As Integer\nXLrow = 1\n\nDo Until Worksheets(1).Cells(XLrow, \"J\") = \"\"\n\n    If Worksheets(1).Cells(XLrow, \"J\") = \"Pending\" Then\n        Worksheets(1).Range(XLrow &amp; \":\" &amp; XLrow) = Worksheets(\"Pending week\").Cells(XLrow, \"J\").Value\n    End If\n\nXLrow = XLrow + 1\nLoop\n</code></pre>\n\n<p>You will need to change the Range to the length of the range you want to copy. <em>Note: the value Pending is case sensitive, so keep that in mind.</em></p>\n\n<p>Alright, this is what you need to create your code. Of course you need to change values to fit your own workbook, but this is the base.</p>\n"}], "owner": {"reputation": 47, "user_id": 8152609, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/10212582009602150/picture?type=large", "display_name": "Dilpreet Singh \u0a74", "link": "https://stackoverflow.com/users/8152609/dilpreet-singh-%e0%a9%b4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1507715344, "creation_date": 1507711841, "question_id": 46683856, "link": "https://stackoverflow.com/questions/46683856/filter-and-copy-certain-rows-from-multiple-excel-sheets-to-another", "title": "Filter and copy certain rows from multiple excel sheets to another", "body": "<p>I am using a workbook that has various sheets. I want to copy all the rows from the last 5 sheets that have the value \"Pending\" in their column \"J\". I want to create a new tab named \"Pending week\" and paste all these rows there. Any help would be really appreciated. \nThanks </p>\n"}, {"tags": ["arrays", "excel", "multidimensional-array", "vba"], "answers": [{"comments": [{"owner": {"reputation": 599, "user_id": 4200062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-OrT8iRWUMig/AAAAAAAAAAI/AAAAAAAAABQ/LOBsBlB8m_M/photo.jpg?sz=128", "display_name": "Sabha", "link": "https://stackoverflow.com/users/4200062/sabha"}, "edited": false, "score": 0, "creation_date": 1507713393, "post_id": 46683987, "comment_id": 80316322, "body": "instead of having two for loops rounds, is there a way to check the sum of the array in one command? I was trying <code>application.worksheetfuntions.sum</code> but unable to get the sum of all values <code>of v(v1())</code>"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 599, "user_id": 4200062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-OrT8iRWUMig/AAAAAAAAAAI/AAAAAAAAABQ/LOBsBlB8m_M/photo.jpg?sz=128", "display_name": "Sabha", "link": "https://stackoverflow.com/users/4200062/sabha"}, "edited": false, "score": 1, "creation_date": 1507713703, "post_id": 46683987, "comment_id": 80316575, "body": "No. You need to loop through all values to get their total. And you can&#39;t start writing the first value before you have calculated the total. The <code>Split</code> function returns an array of strings which isn&#39;t optimal for processing numbers, but I think you are stuck with strings because of the origin of the data in a CSV file."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 599, "user_id": 4200062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-OrT8iRWUMig/AAAAAAAAAAI/AAAAAAAAABQ/LOBsBlB8m_M/photo.jpg?sz=128", "display_name": "Sabha", "link": "https://stackoverflow.com/users/4200062/sabha"}, "edited": false, "score": 1, "creation_date": 1507713869, "post_id": 46683987, "comment_id": 80316690, "body": "If you could make v1 into a Variant you might be able to write it to the sheet with one command avoiding the second loop but not the first."}, {"owner": {"reputation": 599, "user_id": 4200062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-OrT8iRWUMig/AAAAAAAAAAI/AAAAAAAAABQ/LOBsBlB8m_M/photo.jpg?sz=128", "display_name": "Sabha", "link": "https://stackoverflow.com/users/4200062/sabha"}, "edited": false, "score": 0, "creation_date": 1507714565, "post_id": 46683987, "comment_id": 80317190, "body": "well.. unfortunately I cannot edit the code and cannot change the type of v1. May be I need to review the structure of my rawdata. Thanks for your help"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": true, "score": 1, "last_activity_date": 1507712223, "creation_date": 1507712223, "answer_id": 46683987, "question_id": 46683512, "link": "https://stackoverflow.com/questions/46683512/calculating-sum-of-array-contents-and-list-it-based-on-condition-met/46683987#46683987", "title": "Calculating sum of array contents and list it based on condition met", "body": "<p>This should do what you want.</p>\n\n<pre><code>v1 = Split(Replace(Trim(s), \"'\", \"\"), \" \")\nFor i = LBound(v1) To UBound(v1)\n    t = t + Val(v1(i))\nNext i\nIf t &gt;= 5 And t &lt;= 10 Then\n    For i = LBound(v1) To UBound(v1)\n        ActiveCell.Offset(0, i) = v(v1(i))\n    Next i\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 599, "user_id": 4200062, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-OrT8iRWUMig/AAAAAAAAAAI/AAAAAAAAABQ/LOBsBlB8m_M/photo.jpg?sz=128", "display_name": "Sabha", "link": "https://stackoverflow.com/users/4200062/sabha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 46683987, "answer_count": 1, "score": 0, "last_activity_date": 1507712223, "creation_date": 1507710839, "last_edit_date": 1531161705, "question_id": 46683512, "link": "https://stackoverflow.com/questions/46683512/calculating-sum-of-array-contents-and-list-it-based-on-condition-met", "title": "Calculating sum of array contents and list it based on condition met", "body": "<p>The following code lists array contents of <code>v(v1(i))</code> in the active cell and its offsets. I want to put a condition before listing. I want to check sum of all the values in the <code>v1</code> array before listing and if the sum is <code>&gt;=5</code> and <code>&lt;=10</code> then only list it. How can I achieve this?</p>\n\n<pre><code>v1 = Split(Replace(Trim(s), \"'\", \"\"), \" \")\nFor i = LBound(v1) To UBound(v1)\n  ActiveCell.Offset(0, i) = v(v1(i))\nNext\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1507710333, "post_id": 46683123, "comment_id": 80314357, "body": "Image of your data would help. Also, why are you looping all the sheets if you are only copying from one (to one other sheet)? You could simply test if that sheet to copy from is present and then run your code against that named sheet."}, {"owner": {"reputation": 33, "user_id": 8736126, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1fec2aae04c1a4c4ff613ccc5a0c013b?s=128&d=identicon&r=PG&f=1", "display_name": "J Ding", "link": "https://stackoverflow.com/users/8736126/j-ding"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507714398, "post_id": 46683123, "comment_id": 80317091, "body": "I was doing one click and adding all products with quantity over zero to a list, but I was told it was not good enough. I tried to remove the loop and it stops working. That is why I am thinking maybe someone here can give me some help. Many thanks"}], "owner": {"reputation": 33, "user_id": 8736126, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1fec2aae04c1a4c4ff613ccc5a0c013b?s=128&d=identicon&r=PG&f=1", "display_name": "J Ding", "link": "https://stackoverflow.com/users/8736126/j-ding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1507709633, "creation_date": 1507709633, "question_id": 46683123, "link": "https://stackoverflow.com/questions/46683123/add-buttons-at-the-end-of-each-line-if-quantity-is-more-than-zero-copy-and-pas", "title": "Add Buttons at the end of each line, if quantity is more than zero, copy and paste to another worksheet", "body": "<p>I tried to add buttons at the end of each line for products in Product List 1. The purpose to do so is when the quantity for the product is higher than zero, click the button, it will copy the Column B, E, F, G in Product List to the Order List worksheet. As there are lots product lines, when I click the button for another products, I tried to add 2nd one after 1st one rather than replace the 1st one in Order List, which I couldn't let it work. Here is the code below I did for first product on line 28, could you please take a look for me? Many thanks</p>\n\n<pre><code>Option Explicit\n\nSub copy_info()\nDim i As Long, j As Long, lastRow As Long\nDim sh As Worksheet\nWith Sheets(\"Order List\")\n.Cells.Clear\n.Range(\"A1\") = \"PART CODE\"\n.Range(\"B1\") = \"DESCRIPTION\"\n.Range(\"C1\") = \"PRICE\"\n.Range(\"D1\") = \"QUANTITY\"\n.Range(\"E1\") = \"SHEET NAME\"\n.Range(\"A1:E1\").Font.Bold = True\nEnd With\n\nj = 2\n\nFor Each sh In ActiveWorkbook.Sheets\n     If sh.Name = \"Product List 1\" Then\n        lastRow = sh.Cells(sh.Rows.Count, \"A\").End(xlUp).Row\n        For i = 28 To lastRow\n            If sh.Range(\"G\" &amp; i) &gt; 0 Then\n               sh.Range(\"b\" &amp; i).Copy Destination:=Worksheets(\"Order List\").Range(\"A\" &amp; j)\n               sh.Range(\"e\" &amp; i &amp; \":g\" &amp; i).Copy Destination:=Worksheets(\"Order List\").Range(\"B\" &amp; j)\n                Sheets(\"Order List\").Range(\"E\" &amp; j) = sh.Name\n                j = j + 1\n            End If\n        End If\nSheets(\"Order List\").Columns(\"A:E\").AutoFit\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "ms-word", "vba"], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1507714686, "post_id": 46684288, "comment_id": 80317266, "body": "If you use late binding (i.e. you have no reference set to the Word object model), this applies to all Word constants. -- Be sure to have <a href=\"https://msdn.microsoft.com/en-us/library/bw9t3484%28v=vs.84%29.aspx\" rel=\"nofollow noreferrer\"><code>Option Explicit</code></a> at the top of each module.   It enforces variable declaration and reports undeclared or misspelled variables/constants at compile time, so it doesn&#39;t bite you at runtime.  To have this automatically in new modules, set the <a href=\"http://www.fmsinc.com/microsoftaccess/modules/options/index.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a> option in the VBA Editor."}, {"owner": {"reputation": 409, "user_id": 5547193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2e95bf44a17202162e6e52f6c15372?s=128&d=identicon&r=PG&f=1", "display_name": "James Lingham", "link": "https://stackoverflow.com/users/5547193/james-lingham"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1507715105, "post_id": 46684288, "comment_id": 80317567, "body": "Yeah i ran into a similar problem a while ago and forgot about this. I had an error handler I hadn&#39;t properly defined for this module just yet and it wasn&#39;t coming up with the error messages just skipping past it (as i had told it to do at the time) sleep moment from me but all sorted now! Thanks."}], "tags": [], "owner": {"reputation": 409, "user_id": 5547193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2e95bf44a17202162e6e52f6c15372?s=128&d=identicon&r=PG&f=1", "display_name": "James Lingham", "link": "https://stackoverflow.com/users/5547193/james-lingham"}, "is_accepted": false, "score": 0, "last_activity_date": 1507713129, "creation_date": 1507713129, "answer_id": 46684288, "question_id": 46683062, "link": "https://stackoverflow.com/questions/46683062/how-do-i-add-a-new-fieldcode-in-ms-word-when-running-vba-from-access/46684288#46684288", "title": "How do I add a new Fieldcode in MS Word when running VBA From Access", "body": "<p>FYI, the fix appears to be the following</p>\n\n<pre><code>Type:=wdFieldEmpty\n</code></pre>\n\n<p>Does not get recognised in access when moving over to word it seems, using the constant value of this is the correc thing to do, the following line works instead</p>\n\n<pre><code>.activedocument.Fields.Add Range:=MyRange, Type:=-1, Text:=\"LISTNUM  LegalDefault \"\n</code></pre>\n\n<p>I found the constant number by using the object explorer in word.</p>\n"}], "owner": {"reputation": 409, "user_id": 5547193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b2e95bf44a17202162e6e52f6c15372?s=128&d=identicon&r=PG&f=1", "display_name": "James Lingham", "link": "https://stackoverflow.com/users/5547193/james-lingham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594638964, "creation_date": 1507709415, "last_edit_date": 1594638964, "question_id": 46683062, "link": "https://stackoverflow.com/questions/46683062/how-do-i-add-a-new-fieldcode-in-ms-word-when-running-vba-from-access", "title": "How do I add a new Fieldcode in MS Word when running VBA From Access", "body": "<p>I'll be generating a document from access and want the field code \"ListNum\" to be used in the document. I have the following macro which when ran from MS word correctly adds the fieldcode in to the document.</p>\n\n<pre><code>Selection.Fields.Add Range:=Selection.Range, Type:=wdFieldEmpty, Text:= _\n    \"LISTNUM  LegalDefault \", PreserveFormatting:=False\n</code></pre>\n\n<p>However when I run this from VBA in access through a word object it doesn't appear to work. The code in access is as follows.</p>\n\n<pre><code>Dim objApp As Object\nSet objApp = GetObject(\"Word.Application\")\n\n    Set objApp = CreateObject(\"Word.Application\")\n    objApp.Visible = True\n    Set Word = objApp\n\n    With Word\n        .Documents.Add\n        .activedocument.Fields.Add Range:=.Selection.Range, Type:=wdFieldEmpty, Text:=\"LISTNUM  LegalDefault \", PreserveFormatting:=False\n    End With\n</code></pre>\n\n<p>If i use the \"run\" function</p>\n\n<pre><code>Word.Run \"ListNum\"\n</code></pre>\n\n<p>From access to call the macro in word it works too, while I can use this, it's not ideal as it relies on the user having this macro in their template</p>\n\n<p>Thanks for any tips.</p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1507899425, "post_id": 46682869, "comment_id": 80406979, "body": "You should not  be able to close the workbook with Cancel = True in Workbook_BeforeClose. Maybe you have something like EnableEvents = False in soubroutine improperRowNumber?"}, {"owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "reply_to_user": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1507900655, "post_id": 46682869, "comment_id": 80407774, "body": "No, the EnableEvents statement is not present in the improperRowNumber sub. Is there any other possibelities?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 0, "creation_date": 1507922262, "post_id": 46682869, "comment_id": 80420118, "body": "@MarcinSzaleniec with application events disabled, the msgbox wouldn&#39;t be showing up... But OP&#39;s handler is clearly running."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1507925061, "post_id": 46682869, "comment_id": 80421359, "body": "FWIW I can&#39;t seem to be able to cancel the close either. Thank you, now I&#39;ll be spending hours researching wtf is going on lol"}, {"owner": {"reputation": 591, "user_id": 3743418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9429d53bb5b80110f18a72b27f0decf5?s=128&d=identicon&r=PG", "display_name": "AjimOthy", "link": "https://stackoverflow.com/users/3743418/ajimothy"}, "edited": false, "score": 0, "creation_date": 1508040271, "post_id": 46682869, "comment_id": 80449002, "body": "Your process is not very clear. What do you do with the CSV file when the user selects it? (Open it like a workbook? Import its data to ABC.xls? Something else?) In which file did you put your <code>Workbook_BeforeClose</code> code? Which file are trying to prevent from closing? -- I&#39;m not trying to be pedantic, but those are important details that will help people provide useful answers and address any incorrect assumptions you&#39;ve made."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 1, "creation_date": 1508079328, "post_id": 46682869, "comment_id": 80458036, "body": "Correct me if I&#39;m wrong here but since you succesfully can detect a line without a proper ending (&#39;@/#&#39;), why cannot your code add that by itself to that very line?"}, {"owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "edited": false, "score": 0, "creation_date": 1508143984, "post_id": 46682869, "comment_id": 80477971, "body": "@peakpeak: Ha ha ha, sometimes I will be over smart and waste too much amount of time and you see points as well."}], "answers": [{"comments": [{"owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "edited": false, "score": 0, "creation_date": 1507714193, "post_id": 46684372, "comment_id": 80316945, "body": "Top right corner, I meant closing the workbook, i am not closing the excel. I will edit the post. Thanks."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "edited": false, "score": 0, "creation_date": 1507719258, "post_id": 46684372, "comment_id": 80320262, "body": "Frankly, I doubt that the workbook is being closed with File -&gt; Close, the MsgBox comes up, and the workbook is still closed. If it really is closed under such circumstances the action should originate from some other code running unexpectedly. However, if you are truly faced with a malfunction of the Excel application, or if you can&#39;t control how people close the workbook, the next thing to try is to utilise an application event (now you are using a Workbook event) to carry out the same test you already have. Therefore I believe my answer is still valid."}, {"owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "edited": false, "score": 1, "creation_date": 1507719270, "post_id": 46684372, "comment_id": 80320268, "body": "I think it should not matter if you are closing the workbook or closing the excel. Both the ways the Workbook_BeforeClose gets called."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "edited": false, "score": 0, "creation_date": 1507719725, "post_id": 46684372, "comment_id": 80320575, "body": "It&#39;s a matter of sequence. When you quit Excel (1) open workbooks are closed, (2) Closing of your workbook is prevented successfully, (3) Excel can&#39;t quit without closing that workbook, (4) Excel decides that it doesn&#39;t want to get hung up on the discrepancy between code and user instructions, (5) Excel forces the workbook to close, (6) Excel is unloaded. Moral of the story: don&#39;t give conflicting instructions. Learn about programming for application events here:- <a href=\"http://www.cpearson.com/excel/appevent.aspx\" rel=\"nofollow noreferrer\">cpearson.com/excel/appevent.aspx</a>"}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1507713349, "creation_date": 1507713349, "answer_id": 46684372, "question_id": 46682869, "link": "https://stackoverflow.com/questions/46682869/prevent-closing-of-workbook/46684372#46684372", "title": "Prevent closing of workbook", "body": "<p>Pressing the X-button in the top right quits the Excel application. You shouldn't expect the workbook to remain open when the application is closed. You could write an application-event procedure preventing Excel from quitting, but the better way might be to simply get rid of the bad habit of using that button. Find another way to close the workbook.</p>\n"}, {"tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": true, "score": 6, "last_activity_date": 1508432361, "last_edit_date": 1525816189, "creation_date": 1507916969, "answer_id": 46735454, "question_id": 46682869, "link": "https://stackoverflow.com/questions/46682869/prevent-closing-of-workbook/46735454#46735454", "title": "Prevent closing of workbook", "body": "<p>If you must monitor the closing of workbooks other than the one containing the macros, you can intercept application-level events from your macro-enabled workbook as follows:</p>\n\n<p>Add (or adapt) this code behind ThisWorkbook:</p>\n\n<pre><code>Option Explicit\n\nPrivate m_CloseHelper As CloseHelper\n\nPrivate Sub Workbook_Open()\n    Set m_CloseHelper = New CloseHelper\nEnd Sub\n</code></pre>\n\n<p>Add a new Class Module named CloseHelper:</p>\n\n<pre><code>Option Explicit\n\nPrivate WithEvents m_App As Excel.Application\n\nPrivate Sub Class_Initialize()\n    Set m_App = Excel.Application\nEnd Sub\n\nPrivate Sub Class_Terminate()\n    Set m_App = Nothing\nEnd Sub\n\nPrivate Sub m_App_WorkbookBeforeClose(ByVal Wb As Workbook, Cancel As Boolean)\n    'Logic goes here, e.g. the code below will prevent the user from closing\n    'any workbook other than this one, for as long as this workbook is open.\n    If Not Wb Is ThisWorkbook Then\n        Cancel = True\n        MsgBox \"Hello from m_App_WorkbookBeforeClose\"\n    End If\nEnd Sub\n</code></pre>\n\n<p>The important keyword is WithEvents, and the principle is that events raised by the Excel application can now be coded against within the CloseHelper class.</p>\n\n<p>You'll find a more in-depth article here: <a href=\"http://www.cpearson.com/excel/appevent.aspx\" rel=\"nofollow noreferrer\">Application Events</a></p>\n"}, {"tags": [], "owner": {"reputation": 4058, "user_id": 7444507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e538cc60b5829d23dd6601a5807e9e9e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/7444507/michael"}, "is_accepted": false, "score": 0, "last_activity_date": 1507942770, "last_edit_date": 1525816189, "creation_date": 1507942770, "answer_id": 46739807, "question_id": 46682869, "link": "https://stackoverflow.com/questions/46682869/prevent-closing-of-workbook/46739807#46739807", "title": "Prevent closing of workbook", "body": "<p>The Workbook_BeforeClose event only applies to the workbook in which the code is located. It runs when you try to close the macro workbook and setting its parameter Cancel to TRUE only cancels the closure of the macro workbook when you close Excel. The csv file that is open is a separate workbook and Excel tries to close that separately, generating a separate message about saving the csv file.</p>\n\n<p>To automatically prevent the csv file from being closed, you need to use extensibility programming to add a Workbook_BeforeClose event to the csv file while it is open in Excel. Obviously you can't save the file with the event in place, but you don't need to. The code sitting in the module will run while the workbook is still open preventing closure when your conditions are not met; and a successful save allowed after conditions <em>are</em> met will be in the .csv format which will wipe the temporarily added code.</p>\n\n<p><a href=\"http://www.cpearson.com/excel/vbe.aspx\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/vbe.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 591, "user_id": 3743418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9429d53bb5b80110f18a72b27f0decf5?s=128&d=identicon&r=PG", "display_name": "AjimOthy", "link": "https://stackoverflow.com/users/3743418/ajimothy"}, "edited": false, "score": 0, "creation_date": 1508039539, "post_id": 46751481, "comment_id": 80448890, "body": "If events were disabled, the <code>Workbook_BeforeClose</code> event would not run at all."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 591, "user_id": 3743418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9429d53bb5b80110f18a72b27f0decf5?s=128&d=identicon&r=PG", "display_name": "AjimOthy", "link": "https://stackoverflow.com/users/3743418/ajimothy"}, "edited": false, "score": 0, "creation_date": 1508040405, "post_id": 46751481, "comment_id": 80449019, "body": "The Application Level Event runs <b>after</b> the Workbook Level Event, so the Workbook Level Event will always run even if the one at the application level disables events."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 591, "user_id": 3743418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9429d53bb5b80110f18a72b27f0decf5?s=128&d=identicon&r=PG", "display_name": "AjimOthy", "link": "https://stackoverflow.com/users/3743418/ajimothy"}, "edited": false, "score": 0, "creation_date": 1508041005, "post_id": 46751481, "comment_id": 80449099, "body": "(As long as events were enabled before the X button was pressed of course.)"}, {"owner": {"reputation": 591, "user_id": 3743418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9429d53bb5b80110f18a72b27f0decf5?s=128&d=identicon&r=PG", "display_name": "AjimOthy", "link": "https://stackoverflow.com/users/3743418/ajimothy"}, "edited": false, "score": 1, "creation_date": 1508041388, "post_id": 46751481, "comment_id": 80449160, "body": "Sorry, I just meant that since OP indicated some code within the workbook event is running, <code>Application.EnableEvents = False</code> can&#39;t be the source of the trouble - it would stop everything. It would be weird, but in theory an add-in could be setting <code>Cancel = False</code>."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "reply_to_user": {"reputation": 591, "user_id": 3743418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9429d53bb5b80110f18a72b27f0decf5?s=128&d=identicon&r=PG", "display_name": "AjimOthy", "link": "https://stackoverflow.com/users/3743418/ajimothy"}, "edited": false, "score": 0, "creation_date": 1508042027, "post_id": 46751481, "comment_id": 80449259, "body": "You could also have this: <code>Application.EnableEvents = False</code> <code>Wb.Close SaveChanges:=False</code> <code>Application.EnableEvents = True</code> Which would stop Workbook_BeforeClose from running the <i>second</i> time."}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": false, "score": 0, "last_activity_date": 1508041975, "last_edit_date": 1508041975, "creation_date": 1508039345, "answer_id": 46751481, "question_id": 46682869, "link": "https://stackoverflow.com/questions/46682869/prevent-closing-of-workbook/46751481#46751481", "title": "Prevent closing of workbook", "body": "<p>Have you tried closing all your <strong>add-ins</strong> (or run Excel in Safe Mode)?</p>\n\n<p>I'm asking because this problem could be due to the fact that one of your add-ins contains an <strong>Application Level Event</strong> like the one described in Excelosaurus' answer. And it could contain <code>Application.EnableEvents = False</code> or even <code>Cancel = False</code> and interfere with your code. </p>\n\n<p>EDIT: This would be especially hard to detect with an add-in that is protected since the code would run <em>after</em> Workbook_BeforeClose and you won't be able to know what it's doing even if you were debugging line by line using F8.</p>\n"}, {"tags": [], "owner": {"reputation": 946, "user_id": 8772299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fe96a4303027bf79cfc951a6705d47d?s=128&d=identicon&r=PG&f=1", "display_name": "amitklein", "link": "https://stackoverflow.com/users/8772299/amitklein"}, "is_accepted": false, "score": 0, "last_activity_date": 1508486824, "creation_date": 1508486824, "answer_id": 46844825, "question_id": 46682869, "link": "https://stackoverflow.com/questions/46682869/prevent-closing-of-workbook/46844825#46844825", "title": "Prevent closing of workbook", "body": "<p>You can use this code in the workbook macro </p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\nActiveWorkbook.Save\nWorkbooks.Open Application.ActiveWorkbook.FullName\nEnd Sub\n</code></pre>\n\n<p>As you can see it basically saves and open the workbook when it close</p>\n"}], "owner": {"reputation": 1702, "user_id": 3747770, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cbc0310d87016a34afa034e5e0661fba?s=128&d=identicon&r=PG&f=1", "display_name": "NJMR", "link": "https://stackoverflow.com/users/3747770/njmr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4313, "favorite_count": 1, "accepted_answer_id": 46735454, "answer_count": 5, "score": 6, "last_activity_date": 1508486824, "creation_date": 1507708766, "last_edit_date": 1507804170, "question_id": 46682869, "link": "https://stackoverflow.com/questions/46682869/prevent-closing-of-workbook", "title": "Prevent closing of workbook", "body": "<p>There is <code>ABC.xls</code> file which has the macro. Now, the macro has a sub which is getting called when I press <code>Ctrl + M</code>. \nThis sub will open a Open File Dialog where the user can choose a <code>CSV</code> file. So basically, this macro is used for processing and saving <code>CSV</code> file.\nBelow is the code which gets called on pressing <code>Ctrl + M</code>. </p>\n\n<pre><code>Sub runProperChangeSubroutine()             ' Assigned to shortcut key CTRL + M.\n    file_name = ActiveWorkbook.Name         ' Gets the file name.\n    Application.Run file_name &amp; \"!ChangeSub\"\nEnd Sub\n</code></pre>\n\n<p>When the user closes the workbook, I have to test for a condition like each row in the <code>CSV</code> has a termination string. If that termination string is not\npresent, I should popup a message box to the user and prevent the closing of workbook.\nSo I did the following...</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n    Dim improperRowNumber As Integer\n    Dim BlnEventState As Boolean\n    improperRowNumber = returnImproperRow()\n\n    BlnEventState = Application.EnableEvents\n    Application.EnableEvents = True\n\n    If improperRowNumber &lt;&gt; -1 Then\n        Cancel = True\n        MsgBox \"The row number \" &amp; improperRowNumber &amp; \" is not ending with '@/#'. Please correct the row before closing.\"\n    Else\n        Call saveCSV\n    End If\n    Application.EnableEvents = BlnEventState\nEnd Sub\n</code></pre>\n\n<p>On clicking of the close (X mark on top right corner, closing of workboox. I am not closing the excel.) button, I am able to see the message box but the workboox closes. I want user to make some edit if the row is not properly ended.\nPlease suggest.</p>\n\n<p>Edited:\nAs the above code is not working, I used <code>ThisWorkbook.Saved = False</code> after the message box as shown below...</p>\n\n<pre><code>If improperRowNumber &lt;&gt; -1 Then\n    MsgBox \"The row number \" &amp; improperRowNumber &amp; \" is not ending with '@/#'. Please correct the row before closing.\"\n    Application.DisplayAlerts = False\n    ThisWorkbook.Saved = False\n    Cancel = False\nElse\n</code></pre>\n\n<p>Now it displays the \"<code>Do you want to save the changes....</code>\" message box. If I click on <code>Cancel</code> button on message box, the workbook is not closed.</p>\n\n<p>Is there a way to customize the message box text or buttons or hide this <code>Save</code> message box? </p>\n"}, {"tags": ["xml", "vba", "excel"], "comments": [{"owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 3, "creation_date": 1507708738, "post_id": 46682798, "comment_id": 80313369, "body": "Without code this is impossible to troubleshoot."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1507711961, "post_id": 46682798, "comment_id": 80315308, "body": "Remove all references to XML, declare your object(s) as Object and use late binding <code>CreateObject(&quot;ClassName&quot;)</code>."}, {"owner": {"reputation": 557, "user_id": 5831745, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/9pXXZ.gif?s=128&g=1", "display_name": "Zarif", "link": "https://stackoverflow.com/users/5831745/zarif"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1507725101, "post_id": 46682798, "comment_id": 80324020, "body": "@KostasK. Thanks. I think this is the solution. However I have a function that takes DOMDocument as parameter. Because of this I don&#39;t know how to implement late binding in this function. I cannot create an object because it is already being passed to this function. Function is as follows: <code>Public Function GetValFromXML(ByVal XML As String, XMLDoc As DOMDocument) As String</code>"}, {"owner": {"reputation": 557, "user_id": 5831745, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/9pXXZ.gif?s=128&g=1", "display_name": "Zarif", "link": "https://stackoverflow.com/users/5831745/zarif"}, "reply_to_user": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "edited": false, "score": 0, "creation_date": 1507725273, "post_id": 46682798, "comment_id": 80324144, "body": "@jkpieterse  Thanks for your comment. I added a part of the code. Is this enough?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 2, "creation_date": 1507729259, "post_id": 46682798, "comment_id": 80327227, "body": "To create the object use <code>CreateObject(&quot;Microsoft.XMLDOM&quot; )</code> and then just pass it as object e.g. <code>GetValFromXML(ByVal XML As String, XMLDoc As Object)</code>"}, {"owner": {"reputation": 557, "user_id": 5831745, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/9pXXZ.gif?s=128&g=1", "display_name": "Zarif", "link": "https://stackoverflow.com/users/5831745/zarif"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1507734233, "post_id": 46682798, "comment_id": 80330888, "body": "@KostasK. Thank you so much! Problem fixed! The file works even though the references are both unchecked."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8952876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07524583b0d2c96f8a8858af3d3d2d67?s=128&d=identicon&r=PG&f=1", "display_name": "T21", "link": "https://stackoverflow.com/users/8952876/t21"}, "is_accepted": false, "score": 1, "last_activity_date": 1530864584, "creation_date": 1530864584, "answer_id": 51205780, "question_id": 46682798, "link": "https://stackoverflow.com/questions/46682798/error-when-using-microsoft-xml-v3-0-or-v6-0/51205780#51205780", "title": "Error when using Microsoft XML v3.0 or v6.0", "body": "<p>Changing VBA plugin version works for me:</p>\n\n<ul>\n<li>Windows 7 and before -> Microsoft XML v6.0, </li>\n<li>Windows 8, 10 -> Microsoft XML v3.0</li>\n</ul>\n"}], "owner": {"reputation": 557, "user_id": 5831745, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/9pXXZ.gif?s=128&g=1", "display_name": "Zarif", "link": "https://stackoverflow.com/users/5831745/zarif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1631, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1530864584, "creation_date": 1507708532, "last_edit_date": 1507725208, "question_id": 46682798, "link": "https://stackoverflow.com/questions/46682798/error-when-using-microsoft-xml-v3-0-or-v6-0", "title": "Error when using Microsoft XML v3.0 or v6.0", "body": "<p>I use Microsoft XML v3.0 reference in VBA to retrieve information from an XML file (API). But sometimes I get the following error: 'user defined type not defined'. When I change the reference to Microsoft XML v6.0, the problem is fixed. But, sometimes, I also get the same error using 6.0. If I switch back to 3.0, the problem is fixed again. So I have to keep changing references in order to avoid the error. Since this file is being used by multiple people, it is impractical to keep switching references. Excel 2013 and 2016 are used to open this file. Once again, I don't always get the error, but sometimes. I really don't know what to do.</p>\n\n<p>Can someone help me out?</p>\n\n<p>Part of code:</p>\n\n<pre><code>Public Function Search(sSearchID As String)\n\nDim sURL As String\nDim sEnv As String\nDim xmlhtp As New MSXML2.ServerXMLHTTP\nDim XMLDoc As New DOMDocument\nDim xmlDocSend As New DOMDocument\nDim xmlDocResponse As DOMDocument\nDim xmlCompanies As IXMLDOMNodeList\nDim xmlCompany As IXMLDOMNode\nDim xmlDataItem As IXMLDOMNode\nDim xmlDataItems As IXMLDOMNodeList\nDim xmlAddressItems As IXMLDOMNodeList\n\n[...]\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "answers": [{"comments": [{"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1507708644, "post_id": 46682634, "comment_id": 80313313, "body": "Ha, thanks this is so much simpler than my code. I never used loops with Next and &quot;X&quot; as a variable before. Just curious by the way why is it advised not to use select statement? All beginner guides are all over it. Either way thanks for the help, I altered the code to match the report I am working on and it works wonders."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507708816, "post_id": 46682634, "comment_id": 80313419, "body": "You want to avoid &#39;visiting&#39; the sheet where ever possible as this slows your code. You want to work in memory where possible. <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Avoid select</a>"}, {"owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "edited": false, "score": 1, "creation_date": 1507708847, "post_id": 46682634, "comment_id": 80313444, "body": "When used in large loops, select statement makes code much slower, and in general select is more error prone....please mark as answered."}, {"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1507709655, "post_id": 46682634, "comment_id": 80313951, "body": "Ah okay I see. I have another (working) macro that I uses .Select and it is indeed a bit slower to run through 1000s of rows (like 7-8 seconds). I&#39;ll optimize the code according to this then. Thank you guys, marked as answered. I guess I got accustomed to .Select because of starting out with recorded macros and then working with that, macro recording uses .Select all the time."}], "tags": [], "owner": {"reputation": 2173, "user_id": 8259647, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YMyr5.jpg?s=128&g=1", "display_name": "Kresimir L.", "link": "https://stackoverflow.com/users/8259647/kresimir-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1507708034, "creation_date": 1507708034, "answer_id": 46682634, "question_id": 46682433, "link": "https://stackoverflow.com/questions/46682433/wrote-a-vba-script-that-makes-sense-but-still-doesnt-work/46682634#46682634", "title": "Wrote a VBA script that makes sense but still doesn&#39;t work", "body": "<p>Try this. Whenever possible, avoid using select statement in your code.</p>\n\n<pre><code>Sub NA()\nlastrow = Cells(Rows.Count, \"E\").End(xlUp).Row\nFor X = 1 To lastrow\n    If Range(\"E\" &amp; X).Value = \"password_update\" And Range(\"G\" &amp; X) = Range(\"J\" &amp; X) Then Range(\"B\" &amp; X) = \"N/A\"\nNext X\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1507709776, "post_id": 46682955, "comment_id": 80314038, "body": "Thank you, this one works too. I usually work on just generic &quot;Sheet1&quot;, but I know that it is better to be explicit about which Sheet/Workbook I am working on. Should be less lazy I guess haha. Thanks for the suggestion!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "edited": false, "score": 0, "creation_date": 1507709920, "post_id": 46682955, "comment_id": 80314118, "body": "Your current activeworkbook may not be the one your code, as written, is expecting, so the reason for being explicit was to ensure you targeted the right range, in the right sheet, in the right workbook."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1507709074, "creation_date": 1507709074, "answer_id": 46682955, "question_id": 46682433, "link": "https://stackoverflow.com/questions/46682433/wrote-a-vba-script-that-makes-sense-but-still-doesnt-work/46682955#46682955", "title": "Wrote a VBA script that makes sense but still doesn&#39;t work", "body": "<p>Similar to code above but if you want to be more explicit about what is happening and the sheets you are using (in case you run when in the wrong sheet for example consider putting something similar to below). This uses the same logic as you used</p>\n\n<pre><code>Sub UpdateColBwithNA() 'Place in a standard module\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim LastRow As Long\n    Dim currentRow As Long\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Sheets(\"Sheet1\") 'Change to name of sheet you are running code against\n\n    With ws\n\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        .Range(\"E1\").Activate\n\n        For currentRow = 1 To LastRow\n            If .Cells(currentRow, \"E\") = \"password_update\" And _\n               (.Cells(currentRow, \"G\") = .Cells(currentRow, \"J\")) Then\n                    .Cells(currentRow, \"B\") = \"N/A\"\n            End If\n        Next currentRow\n        End With\nEnd Sub\n</code></pre>\n\n<p>The With statement means you don't have to go to the sheet.</p>\n"}], "owner": {"reputation": 259, "user_id": 8603393, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06fc7ed368b60fe81ada9332e0f733b6?s=128&d=identicon&r=PG&f=1", "display_name": "Rhyfelwr", "link": "https://stackoverflow.com/users/8603393/rhyfelwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 46682634, "answer_count": 2, "score": 1, "last_activity_date": 1507709074, "creation_date": 1507707386, "last_edit_date": 1507707897, "question_id": 46682433, "link": "https://stackoverflow.com/questions/46682433/wrote-a-vba-script-that-makes-sense-but-still-doesnt-work", "title": "Wrote a VBA script that makes sense but still doesn&#39;t work", "body": "<p>Hi so I am trying to run the following script but all it does is put \"N/A\" in a column and just loop through all the other cells below without doing anything.</p>\n\n<pre><code>Sub NA()\n    Range(\"E1\").Select\n    Do Until IsEmpty(ActiveCell)\n        If Range(\"E1\") = \"password_update\" Then If Range(\"G1\") = Range(\"J1\") Then Range(\"B1\") = \"N/A\"\n        ActiveCell.Offset(1, 0).Select\n    Loop\nEnd Sub\n</code></pre>\n\n<p>What I'm trying to do is check if the cell <code>\"E1\"</code> has the value \n\"password_update\" in it and if yes then also check if cell <code>\"G1\"</code> and cell <code>\"J1\"</code> has matching content, and if all these criteria matches then type \"N/A\" to cell <code>\"B1\"</code>. </p>\n\n<p>I also wanted to have this script loop through all subsequent rows (<code>E1</code> then <code>E2</code> then <code>E3</code> and so on you get the idea). Now I am no VBA expert, but I wrote this script and no matter how many times I look it makes sense to me logically but it still doesn't work. Any ideas? Help would be appreciated. </p>\n"}, {"tags": ["html", "vba", "excel", "replace", "href"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1507707358, "post_id": 46682356, "comment_id": 80312498, "body": "In the statement <code>Loop While Not r Is Nothing And r.Address &lt;&gt; firstAddress And iLoop &lt; 19</code>, if <code>r</code> is <code>Nothing</code> the code will crash trying to obtain its <code>.Address</code> property.  (But luckily it should never be <code>Nothing</code> in that line.)"}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1507708122, "post_id": 46682511, "comment_id": 80312945, "body": "I was thinking that <code>r</code> could never be <code>Nothing</code> at that point, because it can only enter the loop if the original <code>Find</code> found something, and therefore the <code>FindNext</code> would also find something (even if that was the original value).  But I guess if the cells being searched through contain formulas, and those formulas are being recalculated based on changes to the sheets, then it is possible that the <code>&quot;1&quot;</code> being searched for is no longer being calculated.  So that probably <b>is</b> the problem."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1507708284, "post_id": 46682511, "comment_id": 80313065, "body": "P.S.  I think you need to change the logic flow slightly so that it exits if <code>r.Address</code> <b>equals</b> <code>firstAddress</code> (i.e. if the <code>FindNext</code> returns to the original find)."}, {"owner": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "edited": false, "score": 0, "creation_date": 1507717393, "post_id": 46682511, "comment_id": 80319082, "body": "@Vityata , I made changes in the code ,and the program does not do anything  , and why then before I inserted the line  (oRange.Replace What:=&quot;about:&quot;, Replacement:=<a href=\"http://allscores.ru/soccer/\" rel=\"nofollow noreferrer\">allscores.ru/soccer</a>) everything worked ?"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1507708343, "last_edit_date": 1507708343, "creation_date": 1507707643, "answer_id": 46682511, "question_id": 46682356, "link": "https://stackoverflow.com/questions/46682356/replace-text-replace-href-by-a-hyperlink/46682511#46682511", "title": "Replace text (Replace href by a hyperlink)", "body": "<p>As mentioned in the comments by @YowE3K, if <code>r is Nothing</code>, the VBA engine would continue evaluating the IF statement and would fail on <code>r.Address</code>. </p>\n\n<p>Other languages behave differently, and would escape the check as soon as they find a false condition, but VBA does not do it this way - This is called <em>Short-circuit evaluation</em> - <a href=\"https://stackoverflow.com/questions/7015471/does-the-vba-and-operator-evaluate-the-second-argument-when-the-first-is-false\">Does the VBA &quot;And&quot; operator evaluate the second argument when the first is false?</a></p>\n\n<p>This is a way around:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim iloop           As Long\n    Dim r               As Range\n    Dim firstAddress    As String\n\n    Do While True\n\n        If r Is Nothing Then Exit Do\n        If r.Address = firstAddress Then Exit Do\n        If iloop &lt; 10 Then Exit Do\n\n        'Do the action\n\n    Loop\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 6708114, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2c64a0d2a3bb47eb608cde86fe5d2791?s=128&d=identicon&r=PG&f=1", "display_name": "maxim465", "link": "https://stackoverflow.com/users/6708114/maxim465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 46682511, "answer_count": 1, "score": 1, "last_activity_date": 1519503967, "creation_date": 1507707122, "last_edit_date": 1519503967, "question_id": 46682356, "link": "https://stackoverflow.com/questions/46682356/replace-text-replace-href-by-a-hyperlink", "title": "Replace text (Replace href by a hyperlink)", "body": "<p>There is a program that works fine . The result of her work is the output in Excel of the table of elements (href) (every element look like :  about:new_ftour.php?champ=2604&amp;f_team=412&amp;tour=110). I want to replace href by a hyperlink (replace the text  \u201cabout:\u201d by  \u201c<a href=\"http://allscores.ru/soccer/\" rel=\"nofollow noreferrer\">http://allscores.ru/soccer/</a>\u201d ). After a line (oRange.Value=data)  I added a line (oRange.Replace What:=\"about:\", Replacement:=\"http://allscores.ru/soccer/\"). But for mysterious reasons the program gives an error (Run-time error \u201891\u2019) . In the line (Loop While Not r Is Nothing And r.Address &lt;> firstAddress And iLoop &lt; 19).</p>\n\n<pre><code>    Sub Soft\u0433\u0438\u043f\u0435\u0440\u0441\u0441\u044b\u043b\u043a\u0438()\n      Application.DisplayAlerts = False\n\n\n     Call main\u043c\u0430\u0441\u0441\u0438\u0432\u044b\n\n      Application.DisplayAlerts = True\n    End Sub\n\n\n    Sub main\u043c\u0430\u0441\u0441\u0438\u0432\u044b()\n    Dim r As Range\n     Dim firstAddress As String\n    Dim iLoop As Long\n    Dim book1 As Workbook\n    Dim sheetNames(1 To 19) As String\n    Dim Ssilka As String\n\n\n    sheetNames(1) = \"\u041b\u0438\u0441\u04421\"\n    sheetNames(2) = \"\u041b\u0438\u0441\u04422\"\n    sheetNames(3) = \"\u041b\u0438\u0441\u04423\"\n    sheetNames(4) = \"\u041b\u0438\u0441\u04424\"\n    sheetNames(5) = \"\u041b\u0438\u0441\u04425\"\n    sheetNames(6) = \"\u041b\u0438\u0441\u04426\"\n    sheetNames(7) = \"\u041b\u0438\u0441\u04427\"\n    sheetNames(8) = \"\u041b\u0438\u0441\u04428\"\n    sheetNames(9) = \"\u041b\u0438\u0441\u04429\"\n    sheetNames(10) = \"\u041b\u0438\u0441\u044210\"\n    sheetNames(11) = \"\u041b\u0438\u0441\u044211\"\n    sheetNames(12) = \"\u041b\u0438\u0441\u044212\"\n    sheetNames(13) = \"\u041b\u0438\u0441\u044213\"\n    sheetNames(14) = \"\u041b\u0438\u0441\u044214\"\n    sheetNames(15) = \"\u041b\u0438\u0441\u044215\"\n    sheetNames(16) = \"\u041b\u0438\u0441\u044216\"\n    sheetNames(17) = \"\u041b\u0438\u0441\u044217\"\n    sheetNames(18) = \"\u041b\u0438\u0441\u044218\"\n    sheetNames(19) = \"\u041b\u0438\u0441\u044219\"\n\n   '\u043f\u0440\u043e\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u043e\u0448\u0438\u0431\u043a\u0443\n\n    Set book1 = Workbooks.Open(\"E:\\Super M\\\u041f\u0440\u043e\u0435\u043a\u0442 \u0441\u0442\u0430\u0432\u043a\u0438\\\u041f\u043e\u0438\u0441\u043a \u0440\u0435\u0448\u0435\u043d\u0438\u044f\\\u0423\u0441\u043e\u0432 7\\\u0423\u0441\u043b\u043e\u0432\u0438\u044f \u0434\u043b\u044f \u0430\u043d\u0434\u0435\u0440\u0434\u043e\u0433\u043e\u0432\\\u043f\u0440\u043e\u0431\u043d\u0430\u044f.xlsm\")\n\n\n   iLoop = 0\n\n   With book1.Worksheets(\"\u041b\u0438\u0441\u04421\").Range(\"S34:S99\") '&lt;--| open wanted workbook and refer to cells \"U33:U99\" in its worksheet \"7\"\n\n    Set r = .Find(What:=\"1\", LookIn:=xlValues) '&lt;--| the Find() method is called on the range referred to in the preceding With statement\n    If Not r Is Nothing Then\n        firstAddress = r.Address\n        Do\n            iLoop = iLoop + 1\n            Ssilka = r.Offset(, -14).Hyperlinks.Item(1).Address\n            .Parent.Parent.Worksheets(sheetNames(1)).Activate\n            .Parent.Parent.Save\n            extractTable Ssilka, book1, iLoop\n\n            Set r = .FindNext(r) '&lt;--| the FindNext() method is still called on the same range as in the preceding  .Find() statement\n        Loop While Not r Is Nothing And r.Address &lt;&gt; firstAddress And iLoop &lt; 19 '&lt;--| exit loop if either you hit the first link or completed three loops\n    End If\n    End With\n    book1.Save\n    book1.Close\n\n\n\n    Exit Sub\n\n\n    End Sub\n\n\n    Function extractTable(Ssilka As String, book1 As Workbook, iLoop As Long)\n    Dim oDom As Object, oTable As Object, oRow As Object\n    Dim iRows As Integer, iCols As Integer\n    Dim x As Integer, y As Integer\n    Dim data()\n    Dim oHttp As Object\n    Dim oRegEx As Object\n    Dim sResponse As String\n    Dim oRange As Range\n\n\n\n   ' get page\n    Set oHttp = CreateObject(\"MSXML2.XMLHTTP\")\n   oHttp.Open \"GET\", Ssilka, False\n    oHttp.Send\n\n   ' cleanup response\n    sResponse = StrConv(oHttp.responseBody, vbUnicode)\n    Set oHttp = Nothing\n\n    sResponse = Mid$(sResponse, InStr(1, sResponse, \"&lt;!DOCTYPE \"))\n\n    Set oRegEx = CreateObject(\"vbscript.regexp\")\n    With oRegEx\n    .MultiLine = True\n    .Global = True\n    .IgnoreCase = False\n    .Pattern = \"&lt;(script|SCRIPT)[\\w\\W]+?&lt;/\\1&gt;\"\n    sResponse = .Replace(sResponse, \"\")\n    End With\n     Set oRegEx = Nothing\n\n    ' create Document from response\n     Set oDom = CreateObject(\"htmlFile\")\n     oDom.Write sResponse\n    DoEvents\n\n    ' table with results, indexes starts with zero\n   Set oTable = oDom.getelementsbytagname(\"table\")(3)\n\n   DoEvents\n\n   iRows = oTable.Rows.Length\n   iCols = oTable.Rows(1).Cells.Length\n\n     ' first row and first column contain no intresting data\n    ReDim data(1 To iRows - 1, 1 To iCols - 1)\n\n   ' fill in data array\n   For x = 1 To iRows - 1\n    Set oRow = oTable.Rows(x)\n\n    For y = 1 To iCols - 1\n         If oRow.Cells(y).Children.Length &gt; 0 Then\n            data(x, y) = oRow.Cells(y).getelementsbytagname(\"a\")(0).getattribute(\"href\")\n\n          '.Replace(data(x, y), \"about:\", \"http://allscores.ru/soccer/\")\n\n        End If\n\n       Next y\n     Next x\n\n     Set oRow = Nothing\n     Set oTable = Nothing\n     Set oDom = Nothing\n\n\n    ' put data array on worksheet\n\n     Set oRange = book1.ActiveSheet.Cells(34, iLoop * 25).Resize(iRows - 1, iCols - 1)\n     oRange.NumberFormat = \"@\"\n     oRange.Value = data\n\n    oRange.Replace What:=\"about:\", Replacement:=\"http://allscores.ru/soccer/\"\n\n\n     Set oRange = Nothing\n\n     'Selection.Replace What:=\".\", Replacement:=\",\", LookAt:=xlPart, _\n     SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n       ReplaceFormat:=False, MatchByte:=False\n\n\n    '&lt;DEBUG&gt;\n   '    For x = LBound(data) To UBound(data)\n  '        Debug.Print x &amp; \":[ \";\n  '        For y = LBound(data, 2) To UBound(data, 2)\n  '            Debug.Print y &amp; \":[\" &amp; data(x, y) &amp; \"] \";\n  '        Next y\n  '        Debug.Print \"]\"\n  '    Next x\n   '&lt;/DEBUG&gt;\n\n\n\n   End Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1507706757, "post_id": 46681781, "comment_id": 80312140, "body": "Can you start will all columns in range being unhidden at start of sub ( Sheets(&quot;Sheet1&quot;).Columns(&quot;B:AB&quot;).EntireColumn.Hidden = False) and then add in only the if  (not the else) parts of your code afterwards? This will mean that only the specified columns against the test condition will be hidden."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8756933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54811a668b311c3b11e7269114351bf8?s=128&d=identicon&r=PG&f=1", "display_name": "Bonnie", "link": "https://stackoverflow.com/users/8756933/bonnie"}, "edited": false, "score": 0, "creation_date": 1507784032, "post_id": 46682512, "comment_id": 80350351, "body": "Thankyou so much QHarr! I ended up using the logic of your code. I set each Sheet as a separate ws1, ws2 etc then defined the range for each one. Thanks for the help!! :)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1507707658, "creation_date": 1507707658, "answer_id": 46682512, "question_id": 46681781, "link": "https://stackoverflow.com/questions/46681781/excel-vba-hide-different-columns-depending-on-different-cell-values-in-another-s/46682512#46682512", "title": "Excel VBA Hide different columns depending on different cell values in another sheet, in real time", "body": "<p>Following on from my comment. You can define the entire range of columns as a variable e.g. entireRange and set this to unhidden at the start of each worksheet change.</p>\n\n<p>Add fully qualified references to the ranges i.e. ThisWorkbook.Sheets(\"Sheet1\") or ws (as a variable shown below).</p>\n\n<p>As everything is unhidden at start Else is not needed for each If statement. This is probably where confusion arises.</p>\n\n<p>Change to a Select case statement as you are testing the value of a single cell against different expected values.</p>\n\n<p>Combine your separate line column ranges that you are hiding into one line statements e.g. </p>\n\n<pre><code> Sheets(\"Sheet1\").Columns(\"G:L\").EntireColumn.Hidden = True\n Sheets(\"Sheet1\").Columns(\"N:T\").EntireColumn.Hidden = True\n</code></pre>\n\n<p>Becomes:</p>\n\n<pre><code> ws.Range(\"G:L,N:T\").EntireColumn.Hidden = True\n</code></pre>\n\n<p>You code would then look like the following:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim entireRange As Range\n    Set wb = ThisWorkbook\n    Set ws = wb.Sheets(\"Sheet1\")\n    Set entireRange = ws.Columns(\"B:AB\")\n\n    entireRange.EntireColumn.Hidden = False\n\n    Select Case ws.Range(\"C3\") 'Test the value of C3\n\n      Case \"Opt1\"\n          ws.Range(\"G:L,N:T\").EntireColumn.Hidden = True\n\n      Case \"Opt2\"\n          ws.Range(\"B:F,N:T\").EntireColumn.Hidden = True\n\n      Case \"Opt3\"\n          ws.Range(\"B:M\").EntireColumn.Hidden = True\n\n      Case \"Opt4\"\n          entireRange.Hidden = True\n\n    End Select\nEnd Sub\n</code></pre>\n\n<p>This will be easier to debug in terms of where things are being hidden or unhidden.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8756933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54811a668b311c3b11e7269114351bf8?s=128&d=identicon&r=PG&f=1", "display_name": "Bonnie", "link": "https://stackoverflow.com/users/8756933/bonnie"}, "edited": false, "score": 0, "creation_date": 1507784073, "post_id": 46683055, "comment_id": 80350368, "body": "Thanks for the help EliasWick!"}], "tags": [], "owner": {"reputation": 461, "user_id": 7556093, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/73973676af10e6cf61f8af76df4953da?s=128&d=identicon&r=PG", "display_name": "Elias Wick", "link": "https://stackoverflow.com/users/7556093/elias-wick"}, "is_accepted": true, "score": 0, "last_activity_date": 1507711572, "last_edit_date": 1507711572, "creation_date": 1507709404, "answer_id": 46683055, "question_id": 46681781, "link": "https://stackoverflow.com/questions/46681781/excel-vba-hide-different-columns-depending-on-different-cell-values-in-another-s/46683055#46683055", "title": "Excel VBA Hide different columns depending on different cell values in another sheet, in real time", "body": "<p>I have rewritten your code to make it easy to read and edit. My goal was to make the code as short as possible. I changed your if statement into a Select Case. It's more elegant and I think it's faster, but don't take my word for it.</p>\n\n<p><strong>The problem</strong> that had to be tackled was that if I select <em>Opt1</em> and then select <em>Opt2</em>, the columns from <em>Opt1</em> would still be hidden. So before the code hides anything, it automatically unhides all the columns in the range B:AB.</p>\n\n<p>I added the <code>Case Else</code> to unhide all columns if you entered anything but Opt1, Opt2, Opt3 or Opt4. This could easily be changed into a MsgBox that warns the user that the entered value is incorrect. <em>You can remove this line if you have limited the choice for the users already.</em></p>\n\n<p><strong>The Code:</strong></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    ' Unhide Columns\n    Worksheets(\"Sheet1\").Range(\"B:AB\").EntireColumn.Hidden = False\n\n    Select Case Worksheets(\"Sheet1\").Range(\"C3\").Value\n\n        Case \"Opt1\"\n        Worksheets(\"Sheet1\").Range(\"G:L,N:T\").EntireColumn.Hidden = True\n\n        Case \"Opt2\"\n        Worksheets(\"Sheet1\").Range(\"B:F,N:T\").EntireColumn.Hidden = True\n\n        Case \"Opt3\"\n        Worksheets(\"Sheet1\").Range(\"B:M\").EntireColumn.Hidden = True\n\n        Case \"Opt4\"\n        Worksheets(\"Sheet1\").Range(\"B:AB\").EntireColumn.Hidden = True\n\n        ' If anything else is entered, the columns will be unhidden.\n        Case Else\n        Worksheets(\"Sheet1\").Range(\"B:AB\").EntireColumn.Hidden = False\n\n    End Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8756933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54811a668b311c3b11e7269114351bf8?s=128&d=identicon&r=PG&f=1", "display_name": "Bonnie", "link": "https://stackoverflow.com/users/8756933/bonnie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1412, "favorite_count": 0, "accepted_answer_id": 46683055, "answer_count": 2, "score": 1, "last_activity_date": 1507711992, "creation_date": 1507705293, "last_edit_date": 1531164843, "question_id": 46681781, "link": "https://stackoverflow.com/questions/46681781/excel-vba-hide-different-columns-depending-on-different-cell-values-in-another-s", "title": "Excel VBA Hide different columns depending on different cell values in another sheet, in real time", "body": "<p>I've got a workbook with 5 sheets: Sheet1, Sheet2, Sheet3, Sheet4, Sheet5. The first sheet: \"Sheet\" has a cell: \"C3\" with a drop down menu with 4 different options: Opt1, Opt2, Opt3, Opt4. \nDepending on what is selected in this drop down menu, I'd like different columns to be hidden in the various sheets - in real time. And if nothing is entered, I'd like no columns hidden.</p>\n\n<p>I've entered the below code which partly works but I think there's an issue because I've selected overlapping columns to hide - not completely sure.</p>\n\n<p>Additionally, I'd like to work in hiding particular rows as well as the column below, depending on what different option you select in the drop down menu.</p>\n\n<p>Also, I'll replicate hiding the same columns across all Sheets1-5. </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Range(\"C3\").Value = \"Opt1\" Then\n        Sheets(\"Sheet1\").Columns(\"G:L\").EntireColumn.Hidden = True\n        Sheets(\"Sheet1\").Columns(\"N:T\").EntireColumn.Hidden = True\n    Else\n        Sheets(\"Sheet1\").Columns(\"G:L\").EntireColumn.Hidden = False\n        Sheets(\"Sheet1\").Columns(\"N:T\").EntireColumn.Hidden = False\n    End If  \n\n    If Range(\"C3\").Value = \"Opt2\" Then\n        Sheets(\"Sheet1\").Columns(\"B:F\").EntireColumn.Hidden = True\n        Sheets(\"Sheet1\").Columns(\"N:T\").EntireColumn.Hidden = True\n    Else\n        Sheets(\"Sheet1\").Columns(\"B:F\").EntireColumn.Hidden = False\n        Sheets(\"Sheet1\").Columns(\"N:T\").EntireColumn.Hidden = False\n    End If\n\n    If Range(\"C3\").Value = \"Opt3\" Then\n        Sheets(\"Sheet1\").Columns(\"B:M\").EntireColumn.Hidden = True\n    Else\n        Sheets(\"Sheet1\").Columns(\"B:M\").EntireColumn.Hidden = False\n    End If\n\n    If Range(\"C3\").Value = \"Opt4\" Then\n        Sheets(\"Sheet1\").Columns(\"B:AB\").EntireColumn.Hidden = True\n    Else\n        Sheets(\"Sheet1\").Columns(\"B:AB\").EntireColumn.Hidden = False\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 7481838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06e654b906c382c6fde71d60cea856c?s=128&d=identicon&r=PG&f=1", "display_name": "Huzaifa Ezzi", "link": "https://stackoverflow.com/users/7481838/huzaifa-ezzi"}, "edited": false, "score": 0, "creation_date": 1507901864, "post_id": 46699102, "comment_id": 80408596, "body": "Hi. Thanks, but I&#39;m a little new to this code thing. Could you please explain in a little more detail on how and where to enter it?"}, {"owner": {"reputation": 7, "user_id": 7481838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06e654b906c382c6fde71d60cea856c?s=128&d=identicon&r=PG&f=1", "display_name": "Huzaifa Ezzi", "link": "https://stackoverflow.com/users/7481838/huzaifa-ezzi"}, "edited": false, "score": 0, "creation_date": 1507902971, "post_id": 46699102, "comment_id": 80409321, "body": "Ok, I tried to see it I could make it work so I created a new workbook and copied the data as you have shown then right clicked on the sheet and selected &quot;view code&quot; and in the open window, I just pasted what you shared. Then I clicked on &quot;save&quot; and then the small &quot;play&quot; button. Now my screen is showing me an error saying, &quot;Compile error: Sub or function not defined.&quot; Nothing has happened.  Please explain what has to be done next and also explain what should happen. I&#39;m blank when it comes to coding.  Thanks."}, {"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "reply_to_user": {"reputation": 7, "user_id": 7481838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06e654b906c382c6fde71d60cea856c?s=128&d=identicon&r=PG&f=1", "display_name": "Huzaifa Ezzi", "link": "https://stackoverflow.com/users/7481838/huzaifa-ezzi"}, "edited": false, "score": 0, "creation_date": 1507931088, "post_id": 46699102, "comment_id": 80423762, "body": "Im on my phone so i xant see it but try this: alt-f11 to open the VBA window. Insert a module (not a class module). Copy and past both of the procedures above into the module. Then click anywhere inside of the Public procedure and click the Play arrow"}, {"owner": {"reputation": 7, "user_id": 7481838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06e654b906c382c6fde71d60cea856c?s=128&d=identicon&r=PG&f=1", "display_name": "Huzaifa Ezzi", "link": "https://stackoverflow.com/users/7481838/huzaifa-ezzi"}, "edited": false, "score": 0, "creation_date": 1507995476, "post_id": 46699102, "comment_id": 80438610, "body": "Ok, I got it. Its pretty neat. However, its incomplete. In order for me to start using it on a daily basis, its needs to match my requirement completely.  I need to printout 3 copies of a single lot number and give it to the manager. 2 copies shall go with the bag and one would be passed on to accounts. I need 3 fields where I could select the center, the number of copies to be printed and the date. After which, the spreadsheet should populate the range in a predefined label sheet which shall be printed, cut and distributed to the centers.  Can this be worked out?"}, {"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "reply_to_user": {"reputation": 7, "user_id": 7481838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06e654b906c382c6fde71d60cea856c?s=128&d=identicon&r=PG&f=1", "display_name": "Huzaifa Ezzi", "link": "https://stackoverflow.com/users/7481838/huzaifa-ezzi"}, "edited": false, "score": 0, "creation_date": 1508273772, "post_id": 46699102, "comment_id": 80545064, "body": "I could work all of that out for you, but you should be able to build on what I provided to complete your task."}, {"owner": {"reputation": 7, "user_id": 7481838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06e654b906c382c6fde71d60cea856c?s=128&d=identicon&r=PG&f=1", "display_name": "Huzaifa Ezzi", "link": "https://stackoverflow.com/users/7481838/huzaifa-ezzi"}, "edited": false, "score": 0, "creation_date": 1508309190, "post_id": 46699102, "comment_id": 80555249, "body": "Ok, so now the requirements have changed slightly. We have decided to move to Google Sheets so that we can manage everything in one place and also be able to modify it offline. Would you be having any expertise in that? If you do, I have a complete workflow ready so that you can give a all-in-one solution."}, {"owner": {"reputation": 7, "user_id": 7481838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06e654b906c382c6fde71d60cea856c?s=128&d=identicon&r=PG&f=1", "display_name": "Huzaifa Ezzi", "link": "https://stackoverflow.com/users/7481838/huzaifa-ezzi"}, "edited": false, "score": 0, "creation_date": 1508309284, "post_id": 46699102, "comment_id": 80555291, "body": "Please check out my post on this google product forms <a href=\"https://productforums.google.com/forum/#!topic/docs/7RWMR1H0jEE;context-place=mydiscussions\" rel=\"nofollow noreferrer\">productforums.google.com/forum/#!topic/docs/&hellip;</a>"}], "tags": [], "owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "is_accepted": false, "score": 0, "last_activity_date": 1507764840, "creation_date": 1507764840, "answer_id": 46699102, "question_id": 46681747, "link": "https://stackoverflow.com/questions/46681747/generate-serial-numbers-and-barcodes-as-per-logic-defined-based-on-the-count-men/46699102#46699102", "title": "Generate serial numbers and barcodes as per logic defined based on the count mention in certain cell", "body": "<p><a href=\"https://i.stack.imgur.com/2DcQx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2DcQx.png\" alt=\"enter image description here\"></a>\nEnter your data in columns A - C, run the bit of sample code below, result is in column D. You can modify the code to suit your needs but here is a start for you:</p>\n\n<pre><code>Public Sub RunTags()\n\nDim oWS             As Worksheet\nDim lRow            As Long\nDim lNextTagRow     As Long\n\n    Set oWS = Worksheets(\"Sheet1\")\n    lRow = 2\n    lNextTagRow = 2\n    Do Until oWS.Range(\"A\" &amp; lRow) = \"\"\n        Select Case oWS.Range(\"A\" &amp; lRow)\n            Case \"MBR\"\n                PrintTags oWS, lNextTagRow, \"MB:\", oWS.Range(\"B\" &amp; lRow), oWS.Range(\"C\" &amp; lRow)\n            Case \"MAY\"\n                PrintTags oWS, lNextTagRow, \"MA:\", oWS.Range(\"B\" &amp; lRow), oWS.Range(\"C\" &amp; lRow)\n            Case \"MZM\"\n                PrintTags oWS, lNextTagRow, \"MZ:\", oWS.Range(\"B\" &amp; lRow), oWS.Range(\"C\" &amp; lRow)\n        End Select\n        lRow = lRow + 1\n    Loop\nEnd Sub\n</code></pre>\n\n<p>.</p>\n\n<pre><code>Private Sub PrintTags(ByRef oWS As Worksheet, ByRef lTagRowStart As Long, sPrefix As String, lQty As Long, lStart As Long)\n    Dim x           As Long\n    Dim dtNow       As Date\n\n    dtNow = Now()\n    For x = lStart To lStart + lQty - 1\n        oWS.Range(\"D\" &amp; lTagRowStart) = sPrefix &amp; Format(dtNow, \"YYYYMMDD\") &amp; \"-\" &amp; Format(x, \"000\")\n        lTagRowStart = lTagRowStart + 1\n    Next x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 7481838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a06e654b906c382c6fde71d60cea856c?s=128&d=identicon&r=PG&f=1", "display_name": "Huzaifa Ezzi", "link": "https://stackoverflow.com/users/7481838/huzaifa-ezzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 310, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1507764840, "creation_date": 1507705171, "last_edit_date": 1531161705, "question_id": 46681747, "link": "https://stackoverflow.com/questions/46681747/generate-serial-numbers-and-barcodes-as-per-logic-defined-based-on-the-count-men", "title": "Generate serial numbers and barcodes as per logic defined based on the count mention in certain cell", "body": "<p>I need to generate lot numbers for my products and since my software doesn't auto generate them, I have defined a logic in Excel for the same. It is quite basic and combines data in 2 or more cells to create a unique code.</p>\n\n<p>To be more specific, I shall introduce our operations to you. We have a few collection centers for our products and we require them to apply lot number labels onto their bags of coffee before transferring it to our main warehouse. I have created an excel sheet in which I enter the current date in one cell and select the name of the center in another which then generates a lot number for the same. For example, cell A1 has today's date and A2 has center 'MBR' selected. The formula in cell C2 <code>=IF(A2=\"MBR\",\"MB:\"&amp;TEXT(A1,\"YYYYMMDD\")&amp;\"-001\",IF(A2=\"MAY\",\"AY:\"&amp;TEXT(A1,\"YYYYMMDD\")&amp;\"-001\",IF(A2=\"MZM\",\"MM:\"&amp;TEXT(A1,\"YYYYMMDD\")&amp;\"-001\",\"\")))</code> shall give me a result as <strong>MB:20171010-001</strong></p>\n\n<p>Now comes the tricky part. I want to mention in cell A3 the number of lots to be generated. For example, if I say I want 10 labels, then the formula should give me 10 labels from \"-001\" to \"-010.\" If possible, it could start with the number which I would define in possibly cell A4 and then give me the sequence as required.</p>\n\n<p>Lastly, I use this info to generate barcodes using an add-on in excel which I downloaded from the internet which converts the text into barcodes and then I can print them. I have tried barcode fonts but they don't work at all. If you have another alternative to this where I could generate sequential lot numbers based on the logic defined and create barcodes for the same, please share it with me. If not, please give me a formula which will work with excel.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 8805997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/359f8462200465dc558951783146e876?s=128&d=identicon&r=PG&f=1", "display_name": "Oscar Martinez Gonzalez", "link": "https://stackoverflow.com/users/8805997/oscar-martinez-gonzalez"}, "is_accepted": true, "score": 1, "last_activity_date": 1508503413, "creation_date": 1508503413, "answer_id": 46849345, "question_id": 46681728, "link": "https://stackoverflow.com/questions/46681728/options-for-running-data-extraction-on-a-daily-basis/46849345#46849345", "title": "Options for running data extraction on a daily basis", "body": "<p>if you are going to work with increasing data, and you are going to dedicate a exclusive laptot for the process, i will think about install a database in the laptot (MySQL per example), you can use Access too... but Access file corruptions are a risk.\nDownload to this db all data you need for your report, based on incremental downloads (only new, modified and deleted info).</p>\n\n<p>then run the Excel report extracting from this database in the same computer.</p>\n\n<p>this should increase your solution performance. </p>\n\n<p>probably your bigger problem can be that you query ALL data on each report generation.</p>\n"}], "owner": {"reputation": 89, "user_id": 7694824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2afa8c8753c02daac0f9262ef1fb9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/7694824/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 46849345, "answer_count": 1, "score": 2, "last_activity_date": 1508503413, "creation_date": 1507705097, "last_edit_date": 1531161705, "question_id": 46681728, "link": "https://stackoverflow.com/questions/46681728/options-for-running-data-extraction-on-a-daily-basis", "title": "Options for running data extraction on a daily basis", "body": "<p>I currently have an excel based data extraction method using power query and vba (for docs with passwords). Ideally this would be programmed to run once or twice a day. </p>\n\n<p>My current solution involves setting up a spare laptop on the network that will run the extraction twice a day on its own. This works but I am keen to understand the other options. The task itself seems to be quite a struggle for our standard hardware. It is 6 network locations across 2 servers with around 30,000 rows and increasing. </p>\n\n<p>Any suggestions would be greatly appreciated</p>\n\n<p>Thanks </p>\n"}]