[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562195864, "post_id": 56878950, "comment_id": 100306413, "body": "Filter and then copy visible cells perhaps instead of going line by line."}, {"owner": {"reputation": 3479, "user_id": 392233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d1e07f7aad2dd526e9e90eeb71262809?s=128&d=identicon&r=PG&f=1", "display_name": "misguided", "link": "https://stackoverflow.com/users/392233/misguided"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562196417, "post_id": 56878950, "comment_id": 100306531, "body": "i need all the data though i.e. all rows not filtered rows."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562196698, "post_id": 56878950, "comment_id": 100306587, "body": "Your <code>If</code> statement should theoretically exclude rows, depending on your data, so I&#39;m not sure what you mean by that. You could also read the data into a variant array and manipulate it there, then write to the other worksheet in one step. Repeatedly reading from/writing to a sheet is slow."}, {"owner": {"reputation": 3479, "user_id": 392233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d1e07f7aad2dd526e9e90eeb71262809?s=128&d=identicon&r=PG&f=1", "display_name": "misguided", "link": "https://stackoverflow.com/users/392233/misguided"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562196893, "post_id": 56878950, "comment_id": 100306621, "body": "Yep agree, I am looking to see if the first column of each row has data , if yes , then proceeding with the copying"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1562196913, "post_id": 56878950, "comment_id": 100306626, "body": "You can filter out blanks..."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562213170, "post_id": 56878950, "comment_id": 100309150, "body": "@BigBen while trying simple lines like <code>Rng.SpecialCells(xlCellTypeVisible).Copy WAPatch.Range(&quot;A3&quot;)</code> with a filtered range of 150 K rows. it gives 1004 error &quot;Ms excel cannot create or use data range reference because too complex. Obviously it is working with small data range. May please direct too some enlightenment."}], "answers": [{"comments": [{"owner": {"reputation": 3479, "user_id": 392233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d1e07f7aad2dd526e9e90eeb71262809?s=128&d=identicon&r=PG&f=1", "display_name": "misguided", "link": "https://stackoverflow.com/users/392233/misguided"}, "edited": false, "score": 0, "creation_date": 1562197121, "post_id": 56879022, "comment_id": 100306663, "body": "I tried the code above, this seems to be executing slower than the initial code."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 3479, "user_id": 392233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d1e07f7aad2dd526e9e90eeb71262809?s=128&d=identicon&r=PG&f=1", "display_name": "misguided", "link": "https://stackoverflow.com/users/392233/misguided"}, "edited": false, "score": 0, "creation_date": 1562197170, "post_id": 56879022, "comment_id": 100306672, "body": "Did you turn calculations off?"}, {"owner": {"reputation": 3479, "user_id": 392233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d1e07f7aad2dd526e9e90eeb71262809?s=128&d=identicon&r=PG&f=1", "display_name": "misguided", "link": "https://stackoverflow.com/users/392233/misguided"}, "edited": false, "score": 0, "creation_date": 1562204150, "post_id": 56879022, "comment_id": 100307735, "body": "the sheet doesn&#39;t have any formulas currently"}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": false, "score": 0, "last_activity_date": 1562196715, "last_edit_date": 1562196715, "creation_date": 1562196398, "answer_id": 56879022, "question_id": 56878950, "link": "https://stackoverflow.com/questions/56878950/most-efficient-vba-method-to-copy-data-from-one-sheet-to-another/56879022#56879022", "title": "most efficient vba method to copy data from one sheet to another", "body": "<pre><code>n = WorksheetFunction.CountA(WAEnv.Range(\"a4:a\" &amp; WAEnv.Rows.Count))\nro = 3\n\nFor i = 4 To n + 4\n    If Len(Trim(WAEnv.Cells(i, 1).Value)) &gt; 0 Then\n        ro = ro + 1\n        WAEnv.range(\"A\" &amp; i &amp; \":E\" &amp; i).copy\n        WAPatch.range(\"A\" &amp; ro &amp; \":E\" &amp; ro).pastespecial xlpastevalues\n        With WAPatch.range(\"A\" &amp; ro &amp; \":E\" &amp; ro)\n            .Value = Evaluate(\"IF(ROW(\" &amp; .Address &amp; \"),CLEAN(TRIM(\" &amp; .Address &amp; \")))\")\n        End With\n    End if\nNext\n</code></pre>\n\n<p>Copy and past the row of data in one go then trim the resulting data.</p>\n\n<p>Also if you have a large number of formulas in the sheet it will slow down as it recalculates, if this is the case you can try setting calcs to manual at the start of your code and back to auto at the end.</p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 7988962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9db15cd1790c889705ad258dfa2d9c87?s=128&d=identicon&r=PG&f=1", "display_name": "SamP", "link": "https://stackoverflow.com/users/7988962/samp"}, "is_accepted": false, "score": 0, "last_activity_date": 1562207146, "creation_date": 1562207146, "answer_id": 56879904, "question_id": 56878950, "link": "https://stackoverflow.com/questions/56878950/most-efficient-vba-method-to-copy-data-from-one-sheet-to-another/56879904#56879904", "title": "most efficient vba method to copy data from one sheet to another", "body": "<p>I'd experiment with the times achieved without looping at all. Copy the entire sheet across, and then on the new sheet sort by one column descending to put your blanks to the bottom. If you care about the sort order then shrink your range and sort them again.</p>\n\n<p>Admittedly that might not be quicker, but if you don't need the rows sorted as they originally were then you'll only need the one sort.</p>\n\n<p>Finally, if you have a high proportion of blanks, and you're not coming back to the original sheet, do the sorting there before copying. Or apply a filter and delete the offending rows, though I find this a little more finicky.</p>\n"}, {"comments": [{"owner": {"reputation": 3479, "user_id": 392233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d1e07f7aad2dd526e9e90eeb71262809?s=128&d=identicon&r=PG&f=1", "display_name": "misguided", "link": "https://stackoverflow.com/users/392233/misguided"}, "edited": false, "score": 0, "creation_date": 1562213023, "post_id": 56880288, "comment_id": 100309132, "body": "Is there a way we can copy over formatting with the above code as well? This works heaps faster than the previous code. Almost instantaneously copying rows."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 3479, "user_id": 392233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d1e07f7aad2dd526e9e90eeb71262809?s=128&d=identicon&r=PG&f=1", "display_name": "misguided", "link": "https://stackoverflow.com/users/392233/misguided"}, "edited": false, "score": 0, "creation_date": 1562213366, "post_id": 56880288, "comment_id": 100309174, "body": "before posting I tried with 150 K rows and Row height setting. and it worked at around 10 minutes. but when tried with 300 k it is becoming  unstable. If your requirement is below 150 K row I would be happy to share that code."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 3479, "user_id": 392233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d1e07f7aad2dd526e9e90eeb71262809?s=128&d=identicon&r=PG&f=1", "display_name": "misguided", "link": "https://stackoverflow.com/users/392233/misguided"}, "edited": false, "score": 0, "creation_date": 1562213591, "post_id": 56880288, "comment_id": 100309207, "body": "Sorry i skipped trimming in your code. May use <code>DstArr(Xcol, Xrow) = Trim(SrcArr(Rw, Xcol))</code>"}, {"owner": {"reputation": 3479, "user_id": 392233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d1e07f7aad2dd526e9e90eeb71262809?s=128&d=identicon&r=PG&f=1", "display_name": "misguided", "link": "https://stackoverflow.com/users/392233/misguided"}, "edited": false, "score": 0, "creation_date": 1562213714, "post_id": 56880288, "comment_id": 100309225, "body": "requirement is much less than that . Max 10k rows."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "reply_to_user": {"reputation": 3479, "user_id": 392233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d1e07f7aad2dd526e9e90eeb71262809?s=128&d=identicon&r=PG&f=1", "display_name": "misguided", "link": "https://stackoverflow.com/users/392233/misguided"}, "edited": false, "score": 0, "creation_date": 1562214195, "post_id": 56880288, "comment_id": 100309306, "body": "Edit Code with 2nd option, May pl  feedback"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 2, "last_activity_date": 1562214067, "last_edit_date": 1562214067, "creation_date": 1562211016, "answer_id": 56880288, "question_id": 56878950, "link": "https://stackoverflow.com/questions/56878950/most-efficient-vba-method-to-copy-data-from-one-sheet-to-another/56880288#56880288", "title": "most efficient vba method to copy data from one sheet to another", "body": "<p>If objective to set <code>RowHeight</code> could be sacrificed, then may try the following code (obviously after modifying sheets, ranges particulars to your requirement)</p>\n\n<pre><code>Sub test()\nDim WAEnv As Worksheet, WAPatch As Worksheet, Rng As Range\nDim SrcArr As Variant, DstArr() As Variant\nDim Rw As Long, cl As Range\nDim Xrow As Long, Xcol As Long, Lastrow As Long\nDim Chunk60K As Long\nDim tm As Double\ntm = Timer\n\nSet WAEnv = ThisWorkbook.Sheets(\"Sheet3\")\nSet WAPatch = ThisWorkbook.Sheets(\"Sheet4\")\n\nSet Rng = WAEnv.Range(\"A4:E\" &amp; WAEnv.Cells(Rows.Count, 1).End(xlUp).Row)\nSrcArr = Rng.Value\nXrow = 1\nChunk60K = 0\n\n    For Rw = 1 To UBound(SrcArr, 1)\n        If SrcArr(Rw, 1) &gt; 0 Then\n        ReDim Preserve DstArr(1 To 5, 1 To Xrow)\n            For Xcol = 1 To 5\n            DstArr(Xcol, Xrow) = SrcArr(Rw, Xcol)\n            Next Xcol\n\n            If Xrow = 60000 Then  ' To Overcome 65K limit of Application.Transpose\n            WAPatch.Range(\"A\" &amp; Chunk60K * 60000 + 3).Resize(UBound(DstArr, 2), UBound(DstArr, 1)).Formula = Application.Transpose(DstArr)\n            Chunk60K = Chunk60K + 1\n            Xrow = 1\n            ReDim DstArr(1 To 5, 1 To 1)\n            Debug.Print \"Chunk: \" &amp; Chunk60K &amp; \" Seconds Taken: \" &amp; Timer - tm\n            Else\n            Xrow = Xrow + 1\n            End If\n\n        End If\n    Next Rw\n\n\nWAPatch.Range(\"A\" &amp; Chunk60K * 60000 + 3).Resize(UBound(DstArr, 2), UBound(DstArr, 1)).Formula = Application.Transpose(DstArr)\nDebug.Print \"Completed at Chunk: \" &amp; Chunk60K &amp; \" Total Seconds Taken: \" &amp; Timer - tm\n\nEnd Sub\n</code></pre>\n\n<p>Code takes around 7-8 seconds to process around 300 K rows (around 1/2 of it filtered out)</p>\n\n<p>Since I personally don't prefer to keep calculations, event processing and screen updating off (in normal cases) i haven't added that standard lines. However you may use these standard techniques, depending on the working file condition. </p>\n\n<p>Edit: adding code including Row height setting  (unstable after 150 K)</p>\n\n<pre><code>Sub test4()\nDim WAEnv As Worksheet, WAPatch As Worksheet, Rng As Range\nDim SrcArr As Variant, DstArr() As Variant\nDim Rw As Long, cl As Range\nDim Xrow As Long, Xcol As Long, Lastrow As Long\nDim Chunk60K As Long\nDim tm As Double\ntm = Timer\n\n\nSet WAEnv = ThisWorkbook.Sheets(\"Sheet3\")\nSet WAPatch = ThisWorkbook.Sheets(\"Sheet4\")\n'n = WorksheetFunction.CountA(WAEnv.Range(\"a4:a\" &amp; WAEnv.Rows.Count))\n\nLastrow = WAEnv.Cells(Rows.Count, 1).End(xlUp).Row\nDebug.Print Lastrow\nXrow = 1\nChunk60K = 0\n\n        For Rw = 4 To Lastrow\n        Set Rng = WAEnv.Range(\"A\" &amp; Rw &amp; \":E\" &amp; Rw)\n        If Rng(1, 1).Value &gt; 0 Then\n        ReDim Preserve DstArr(1 To 5, 1 To Xrow)\n        Xcol = 1\n            For Each cl In Rng.Columns.Cells\n            DstArr(Xcol, Xrow) = cl.Value\n            Xcol = Xcol + 1\n            Next cl\n        WAPatch.Cells(Xrow, 1).RowHeight = Rng(1, 1).RowHeight\n\n            If Xrow = 60000 Then  ' To Overcome 65K limit of Application.Transpose\n            WAPatch.Range(\"A\" &amp; Chunk60K * 60000 + 3).Resize(UBound(DstArr, 2), UBound(DstArr, 1)).Formula = Application.Transpose(DstArr)\n            Chunk60K = Chunk60K + 1\n            Xrow = 1\n            ReDim DstArr(1 To 5, 1 To 1)\n            Debug.Print \"Chunk: \" &amp; Chunk60K &amp; \" Seconds Taken: \" &amp; Timer - tm\n            Else\n            Xrow = Xrow + 1\n            End If\n      End If\n      Next Rw\n\n\nWAPatch.Range(\"A\" &amp; Chunk60K * 60000 + 3).Resize(UBound(DstArr, 2), UBound(DstArr, 1)).Formula = Application.Transpose(DstArr)\nDebug.Print \"Completed at Chunk: \" &amp; Chunk60K &amp; \" Total Seconds Taken: \" &amp; Timer - tm\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3479, "user_id": 392233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d1e07f7aad2dd526e9e90eeb71262809?s=128&d=identicon&r=PG&f=1", "display_name": "misguided", "link": "https://stackoverflow.com/users/392233/misguided"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 56880288, "answer_count": 3, "score": 1, "last_activity_date": 1562214067, "creation_date": 1562195679, "last_edit_date": 1562213648, "question_id": 56878950, "link": "https://stackoverflow.com/questions/56878950/most-efficient-vba-method-to-copy-data-from-one-sheet-to-another", "title": "most efficient vba method to copy data from one sheet to another", "body": "<p>I am just trying a simple copy from one Excel sheet to another but the program seems to be taking forever. </p>\n\n<pre><code>n = WorksheetFunction.CountA(WAEnv.Range(\"a4:a\" &amp; WAEnv.Rows.Count))\nro = 3\n\nFor i = 4 To n + 4\n    If Len(Trim(WAEnv.Cells(i, 1).Value)) &gt; 0 Then\n       ro = ro + 1\n       WAPatch.Cells(ro, 1).RowHeight = WAEnv.Cells(i, 1).RowHeight\n       WAPatch.Cells(ro, 1).Value = Trim(WAEnv.Cells(i, 1).Value)\n       WAPatch.Cells(ro, 2).Value = Trim(WAEnv.Cells(i, 2).Value)\n       WAPatch.Cells(ro, 3).Value = Trim(WAEnv.Cells(i, 3).Value)\n       WAPatch.Cells(ro, 4).Value = Trim(WAEnv.Cells(i, 4).Value)\n       WAPatch.Cells(ro, 5).Value = Trim(WAEnv.Cells(i, 5).Value)\n    End If\nNext i\n</code></pre>\n\n<p>Is there a faster or more efficient way to do this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1562191191, "post_id": 56878281, "comment_id": 100305421, "body": "Why <code>.Activate</code>? That is extremely slow and unnecessary. You should also qualify your <code>Range(&quot;S26:S1500&quot;)</code> with your worksheet."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1562191398, "post_id": 56878281, "comment_id": 100305484, "body": "<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this</a> should provide more details on avoiding activate and select in your code"}], "answers": [{"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 1, "last_activity_date": 1562194938, "last_edit_date": 1562194938, "creation_date": 1562193446, "answer_id": 56878719, "question_id": 56878281, "link": "https://stackoverflow.com/questions/56878281/how-to-count-cells-based-off-of-left-value-of-cell-being-between-two-values/56878719#56878719", "title": "How to count cells based off of LEFT value of cell being between two values", "body": "<p><strong>Updated</strong> First function had a couple type-o's. I tested and this one works.</p>\n\n<p>This would probably be better as a custom function. Here's the syntax I think you're looking for.</p>\n\n<pre><code>Function MisProd (srchRNG As Range) As Long\nDim cell As Range\n\n    For Each cell In Intersect(srchRNG, srchRNG.Worksheet.UsedRange).Cells\n        'I use the intersection function so users can selet a whole column)\n\n    If IsEmpty(cell) Then\n        'probably do nothing if it's empty?\n        'might also be better to use Isnumeric(Left(cell.value,3)) to avoid errors.\n\n    ElseIf Left(cell.Value, 3) &gt;= 100 And Left(cell.Value, 3) &lt;= 150 Then\n        'this is a range of 101 to 149...\n\n        If cell.Offset(0, -17) &lt; 1 Then\n            'if column b for this row is less than 1\n             MisProd = MisProd + 1\n        End If\n\n    End If\n\n    Next Cell\n\nEnd Function\n</code></pre>\n\n<p>You could use this in combination with a macro as shown here.</p>\n\n<pre><code>Sub nowAmacro()\n\n    MsgBox \"Your results are \" &amp; MisProd (Range(\"S26:S1500\"))\n    'better to specify the sheet such as Sheet1.Range(\"S26:S15000\")\n\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 11736556, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1gfCYQULyGE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcoAXznDpWWmR9E2CMjzbgDloVnqw/photo.jpg?sz=128", "display_name": "Eric Gilbey", "link": "https://stackoverflow.com/users/11736556/eric-gilbey"}, "edited": false, "score": 0, "creation_date": 1562261762, "post_id": 56880081, "comment_id": 100331301, "body": "Sadly, I don&#39;t think adding a column to the spreadsheet is possible. The reason that I wanted to use VBA for this is that there is actually 11 different number ranges for values to fall into, so I need to be able to sum the number of overdue items in each of those different areas. Thank you very much for the advice on debugging though."}], "tags": [], "owner": {"reputation": 121, "user_id": 7988962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9db15cd1790c889705ad258dfa2d9c87?s=128&d=identicon&r=PG&f=1", "display_name": "SamP", "link": "https://stackoverflow.com/users/7988962/samp"}, "is_accepted": false, "score": 0, "last_activity_date": 1562208785, "creation_date": 1562208785, "answer_id": 56880081, "question_id": 56878281, "link": "https://stackoverflow.com/questions/56878281/how-to-count-cells-based-off-of-left-value-of-cell-being-between-two-values/56880081#56880081", "title": "How to count cells based off of LEFT value of cell being between two values", "body": "<p>Firstly, the previous comments and answers are all good and will fix your VBA. Though if you're just trying to learn VBA then working out what your error is would be ideal. Put a break in your code and see if you can run through until your error occurs. It is probably something to do with an unusual row of data. </p>\n\n<p>If it is definitely getting through your first half dozen rows, put a <code>Debug.Print cell.row</code> in and after it has errored, check your output window for the offending row number.</p>\n\n<p>These methods will teach you to debug VBA code. And yours is mostly fine. Stop activating that cell as mentioned, and use \"&lt;= 0\" not \"&lt; 1\" for column A. Although that might be the same thing if they're all integers.</p>\n\n<p>But finally, consider not using VBA for a logical task like this if you can. IF you have the ability to add columns to your sheet, add one to get the <code>NUMBERVALUE</code> of column S and then another to show a 1 or 0 if your conditions are met. Then sum the cells in your second column.</p>\n"}], "owner": {"reputation": 13, "user_id": 11736556, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-1gfCYQULyGE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcoAXznDpWWmR9E2CMjzbgDloVnqw/photo.jpg?sz=128", "display_name": "Eric Gilbey", "link": "https://stackoverflow.com/users/11736556/eric-gilbey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 56878719, "answer_count": 2, "score": 1, "last_activity_date": 1562208785, "creation_date": 1562190179, "question_id": 56878281, "link": "https://stackoverflow.com/questions/56878281/how-to-count-cells-based-off-of-left-value-of-cell-being-between-two-values", "title": "How to count cells based off of LEFT value of cell being between two values", "body": "<p>I have a spreadsheet with roughly 1500 lines, and I am trying to count the number of lines which have one cell value at 0 or lower, and then group them based off of the first 3 characters in another cell in that line.</p>\n\n<p>This is my first attempt trying VBA, and I have done research on each section of this code but I've seen a fair number of contradicting answers for how to do each part of it. I based the code off of one I found to count the number of cells with a certain word in them, so it may be very far off from what I want.</p>\n\n<pre><code>For Each Cell in Range(\"S26:S1500\")\nCell.Activate\nIf IsEmpty(Cell) Then Exit For\nIf Left(Cell.Value,3) &gt;= 100 And Left(Cell.Value,3) &lt;=150 And\nIf ActiveCell.Offset(0,-17) &lt; 1 Then\nMisProd = MisProd + 1\n</code></pre>\n\n<p>The result should be the total number of cells that start with 100 to 150 and have a cell 17 cells left as less than 1.</p>\n\n<p>I instead receive a compile error: Expected: expression.</p>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11736438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6143c64d6a0084a9563e391a3cfb0108?s=128&d=identicon&r=PG&f=1", "display_name": "puggle76", "link": "https://stackoverflow.com/users/11736438/puggle76"}, "edited": false, "score": 0, "creation_date": 1562196169, "post_id": 56878363, "comment_id": 100306489, "body": "New to VBA do you have any tips to properly indent code?"}, {"owner": {"reputation": 1, "user_id": 11736438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6143c64d6a0084a9563e391a3cfb0108?s=128&d=identicon&r=PG&f=1", "display_name": "puggle76", "link": "https://stackoverflow.com/users/11736438/puggle76"}, "edited": false, "score": 0, "creation_date": 1562197433, "post_id": 56878363, "comment_id": 100306715, "body": "is the option Explicit added the private sub line?  As such: Option Explicit Command Button_83 ()"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 1, "user_id": 11736438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6143c64d6a0084a9563e391a3cfb0108?s=128&d=identicon&r=PG&f=1", "display_name": "puggle76", "link": "https://stackoverflow.com/users/11736438/puggle76"}, "edited": false, "score": 0, "creation_date": 1562197832, "post_id": 56878363, "comment_id": 100306781, "body": "<code>Option Explicit</code> is added as the first line at the top of any module."}, {"owner": {"reputation": 1, "user_id": 11736438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6143c64d6a0084a9563e391a3cfb0108?s=128&d=identicon&r=PG&f=1", "display_name": "puggle76", "link": "https://stackoverflow.com/users/11736438/puggle76"}, "edited": false, "score": 0, "creation_date": 1562381425, "post_id": 56878363, "comment_id": 100365928, "body": "Thank you for your help.  It took me a bit to figure out how to accomplish a refined code.  Its not perfect but it works a lot better,  the code has one flash before the done message box.  I tried adding the option explicit but it gets pushed to the previous code.  Below is the code I came up with."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 1, "user_id": 11736438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6143c64d6a0084a9563e391a3cfb0108?s=128&d=identicon&r=PG&f=1", "display_name": "puggle76", "link": "https://stackoverflow.com/users/11736438/puggle76"}, "edited": false, "score": 0, "creation_date": 1562448952, "post_id": 56878363, "comment_id": 100378353, "body": "The &#39;one flash&#39; will be the screen updating as you turn screen updating back on - so to be expected. worth opening another question (perhaps in Code Review if your code works as expected - but read the help and guidance on how to ask carefully) as there is still room for improvement in your code."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 1, "user_id": 11736438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6143c64d6a0084a9563e391a3cfb0108?s=128&d=identicon&r=PG&f=1", "display_name": "puggle76", "link": "https://stackoverflow.com/users/11736438/puggle76"}, "edited": false, "score": 0, "creation_date": 1562448995, "post_id": 56878363, "comment_id": 100378358, "body": "Yes, <code>Option Explicit</code> will get pushed to the top of the module, that is where it belongs. Moving to the front of other code is perfectly fine."}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 0, "last_activity_date": 1562190746, "creation_date": 1562190746, "answer_id": 56878363, "question_id": 56878110, "link": "https://stackoverflow.com/questions/56878110/refine-copy-paste-to-another-workbook-for-multple-criteria-in-the-same-column/56878363#56878363", "title": "Refine Copy/Paste to another Workbook for Multple Criteria in the same Column", "body": "<blockquote>\n  <p>The VBA as seems to be glitchy (screen view jumps back and forth)</p>\n</blockquote>\n\n<p>The immediate answer to removing the 'glitchy' behaviour is to avoid using Select and Activate. For example:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></li>\n<li><a href=\"https://stackoverflow.com/questions/38859482/excel-2013-vba-alternative-to-using-activate-and-select\">Excel 2013 VBA alternative to using Activate and Select</a></li>\n</ul>\n\n<p>Also - indenting the code properly helps with readability, maintenance and bug finding. </p>\n\n<p>Finally. Add <code>Option Explicit</code> to the top of the module containing code. <strong>Always</strong>.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11736438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6143c64d6a0084a9563e391a3cfb0108?s=128&d=identicon&r=PG&f=1", "display_name": "puggle76", "link": "https://stackoverflow.com/users/11736438/puggle76"}, "is_accepted": false, "score": 0, "last_activity_date": 1562382353, "creation_date": 1562382353, "answer_id": 56910930, "question_id": 56878110, "link": "https://stackoverflow.com/questions/56878110/refine-copy-paste-to-another-workbook-for-multple-criteria-in-the-same-column/56910930#56910930", "title": "Refine Copy/Paste to another Workbook for Multple Criteria in the same Column", "body": "<pre><code>Private Sub CommandButton83_Click()\nDim c As Range\nDim d As Range, u As Range, o As Range, p As Range, q As Range, r As Range, _\n s As Range\nDim j As Integer\nDim Source As Worksheet\nDim Target As Worksheet\nDim Outcome As Worksheet\n\n\nApplication.Workbooks.Open Filename:=\"C:\\Users\\Desktop\\Workbook1.xml\"\n\nApplication.ScreenUpdating = False\nSet Source = Application.Workbooks(\"WorkBook1\").Worksheets(\"Sheet1\")\nSet Target = ThisWorkbook.Worksheets(\"DataSheet\")\nSet Outcome = ThisWorkbook.Worksheets(\"Data\")\n\n    For Each c In Source.Range(\"A3:A\" &amp; Source.Cells(Rows.Count, \"A\").End(xlUp).Row)\n        j = Outcome.Cells(Rows.Count, 3).End(xlUp).Row + 1\n        If c = TextBox192.Value Then Outcome.Rows(j).Value = Source.Rows(c.Row).Value\n    Next c\n\n    For Each d In Source.Range(\"A1:A\" &amp; Source.Cells(Rows.Count, \"A\").End(xlUp).Row)\n        j = Outcome.Cells(Rows.Count, 3).End(xlUp).Row + 1\n        If d = TextBox193.Value Then Outcome.Rows(j).Value = Source.Rows(d.Row).Value\n    Next d\n\n    For Each n In Source.Range(\"A1:A\" &amp; Source.Cells(Rows.Count, \"A\").End(xlUp).Row)\n        j = Outcome.Cells(Rows.Count, 3).End(xlUp).Row + 1\n        If n = TextBox194.Value Then Outcome.Rows(j).Value = Source.Rows(n.Row).Value\n    Next n\n\n    For Each o In Source.Range(\"A1:A\" &amp; Source.Cells(Rows.Count, \"A\").End(xlUp).Row)\n         j = Outcome.Cells(Rows.Count, 3).End(xlUp).Row + 1\n         If o = TextBox195.Value Then Outcome.Rows(j).Value = Source.Rows _  \n         (o.Row).Value\n    Next o\n\n    For Each p In Source.Range(\"A1:A\" &amp; Source.Cells(Rows.Count, \"A\").End(xlUp).Row)\n         j = Outcome.Cells(Rows.Count, 3).End(xlUp).Row + 1\n         If p = TextBox196.Value Then Outcome.Rows(j).Value = Source.Rows _   \n         (p.Row).Value\n     Next p\n\n    For Each q In Source.Range(\"A1:A\" &amp; Source.Cells(Rows.Count, \"A\").End(xlUp).Row)\n          j = Outcome.Cells(Rows.Count, 3).End(xlUp).Row + 1\n         If q = TextBox197.Value Then Outcome.Rows(j).Value = Source.Rows _\n         (q.Row).Value\n    Next q\n\n     For Each r In Source.Range(\"A1:A\" &amp; Source.Cells(Rows.Count, \"A\").End(xlUp).Row)\n         j = Outcome.Cells(Rows.Count, 3).End(xlUp).Row + 1\n         If r = TextBox198.Value Then Outcome.Rows(j).Value = Source.Rows _\n         (r.Row).Value\n     Next r\n\n     For Each s In Source.Range(\"A1:A\" &amp; Source.Cells(Rows.Count, \"A\").End(xlUp).Row)\n          j = Outcome.Cells(Rows.Count, 3).End(xlUp).Row + 1\n         If s = TextBox199.Value Then Outcome.Rows(j).Value = Source.Rows _  \n         (s.Row).Value\n     Next s\n\n    Application.ScreenUpdating = True\n\n    Workbooks(\"WorkBook1\").Close\n\n    MsgBox \"done!\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11736438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6143c64d6a0084a9563e391a3cfb0108?s=128&d=identicon&r=PG&f=1", "display_name": "puggle76", "link": "https://stackoverflow.com/users/11736438/puggle76"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562382353, "creation_date": 1562188998, "question_id": 56878110, "link": "https://stackoverflow.com/questions/56878110/refine-copy-paste-to-another-workbook-for-multple-criteria-in-the-same-column", "title": "Refine Copy/Paste to another Workbook for Multple Criteria in the same Column", "body": "<p>The VBA as seems to be glitchy (screen view jumps back and forth) and does not end back on the userform.  Is there a way to refine the VBA to work better? and is there another way to place the row in a specific row on a worksheet? </p>\n\n<p>Excel VBA - using userform and datasheet (workbook A).  After inputting a number in up to 8 different textboxes on a userform.  The textbox is linked to a datasheet.  the vba gets the number from the datasheet and searches another workbook (Workbook B) for the number in Column A.  After found it will copy and paste to a row on the sheet on (workbook a).  the sequence will continue for the next textbox and the next etc.</p>\n\n<pre><code>Private Sub CommandButton83_Click()\nDim LastRow As Integer, i As Integer, erow As Integer\n\nLastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To LastRow\n\nIf Cells(i, 1).Value = TextBox192.Value Then\nRange(Cells(i, 1), Cells(i, 25)).Select\nSelection.Copy\nWorkbooks.Open Filename:=\"C:location\"\n\nWorkbooks(\"MainWorkBook\").Worksheets(\"PatientData\").Activate\nWorksheets(\"PatientData\").Select\n\nActiveSheet.Cells(3, 1).Select\nActiveSheet.Paste\nActiveWorkbook.Save\nActiveWorkbook.Close\nApplication.CutCopyMode = False\nEnd If\nNext i\n\nWorkbooks(\"Workbook2\").Worksheets(\"Roll Call\").Activate\n\nLastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To LastRow\nIf Cells(i, 1).Value = TextBox193.Value Then\nRange(Cells(i, 1), Cells(i, 25)).Select\nSelection.Copy\nWorkbooks.Open Filename:=\"C:location\"\n\nWorkbooks(\"MainWorkBook\").Worksheets(\"PatientData\").Activate\nWorksheets(\"PatientData\").Select\nActiveSheet.Cells(5, 1).Select\nActiveSheet.Paste\nActiveWorkbook.Save\nApplication.CutCopyMode = False\nEnd If\nNext i\n\n\nWorkbooks(\"Workbook2\").Worksheets(\"Roll Call\").Activate\n\nLastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To LastRow\nIf Cells(i, 1).Value = TextBox194.Value Then\n Range(Cells(i, 1), Cells(i, 25)).Select\n Selection.Copy\n Workbooks.Open Filename:=\"C:location\"\n\nWorkbooks(\"MainWorkBook\").Worksheets(\"PatientData\").Activate\n Worksheets(\"PatientData\").Select\n ActiveSheet.Cells(7, 1).Select\n ActiveSheet.Paste\n ActiveWorkbook.Save\n Application.CutCopyMode = False\n End If\n Next i\n\n Workbooks(\"Workbook2\").Worksheets(\"Roll Call\").Activate\n\nLastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To LastRow\nIf Cells(i, 1).Value = TextBox195.Value Then\nRange(Cells(i, 1), Cells(i, 25)).Select\nSelection.Copy\nWorkbooks.Open Filename:=\"C:\\location\"\n\nWorkbooks(\"MainWorkBook\").Worksheets(\"PatientData\").Activate\nWorksheets(\"PatientData\").Select\nActiveSheet.Cells(9, 1).Select\nActiveSheet.Paste\nActiveWorkbook.Save\nApplication.CutCopyMode = False\nEnd If\nNext i\n\nLastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To LastRow\nIf Cells(i, 1).Value = TextBox196.Value Then\n\nRange(Cells(i, 1), Cells(i, 25)).Select\nSelection.Copy\nWorkbooks.Open Filename:=\"C:Location of file\"\n\nWorkbooks(\"MainWorkBook\").Worksheets(\"PatientData\").Activate\nWorksheets(\"PatientData\").Select\n\nActiveSheet.Cells(11, 1).Select\nActiveSheet.Paste\nActiveWorkbook.Save\nApplication.CutCopyMode = False\nEnd If\nNext i\n\nLastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To LastRow\nIf Cells(i, 1).Value = TextBox197.Value Then\nRange(Cells(i, 1), Cells(i, 25)).Select\nSelection.Copy\nWorkbooks.Open Filename:=\"C:Location\"\n\nWorkbooks(\"MainWorkBook\").Worksheets(\"PatientData\").Activate\nWorksheets(\"PatientData\").Select\n\nActiveSheet.Cells(13, 1).Select\nActiveSheet.Paste\n ActiveWorkbook.Save\nActiveWorkbook.Close\nApplication.CutCopyMode = False\nEnd If\nNext i\n\nLastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To LastRow\nIf Cells(i, 1).Value = TextBox198.Value Then\nRange(Cells(i, 1), Cells(i, 25)).Select\nSelection.Copy\nWorkbooks.Open Filename:=\"C:location\"\n\nWorkbooks(\"MainWorkBook\").Worksheets(\"PatientData\").Activate\nWorksheets(\"PatientData\").Select\n\nActiveSheet.Cells(15, 1).Select\nActiveSheet.Paste\nActiveWorkbook.Save\nApplication.CutCopyMode = False\nEnd If\nNext i\n\n\nIf OptionButton65.Value = True Then\nWorkbooks(\"Workbook2\").Worksheets(\"Roll Call\").Activate\n\nLastRow = ActiveSheet.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To LastRow\nIf Cells(i, 1).Value = TextBox199.Value Then\nRange(Cells(i, 1), Cells(i, 25)).Select\nSelection.Copy\nWorkbooks.Open Filename:=\"C:location\"\n\nWorkbooks(\"MainWorkBook\").Worksheets(\"PatientData\").Activate\nWorksheets(\"PatientData\").Select\n\nActiveSheet.Cells(17, 1).Select\nActiveSheet.Paste\nActiveWorkbook.Save\nApplication.CutCopyMode = False\nEnd If\nNext i\n\n\nEnd Sub\n</code></pre>\n\n<p>'Being able to refine the VBA to single function of looking for number provided in a textbox (which will change on every use) on a closed/open workbook and copy the row that matches the number onto the userform workbook in a specific row.  Only as many as eight rows will be copied per use but mor than likely three will be used.  So not all textboxes will have data entered every time.</p>\n"}, {"tags": ["excel", "vba", "directory"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1562189318, "post_id": 56878040, "comment_id": 100304877, "body": "<code>Dim Source2, StrFile2 As String</code> will <code>Dim</code> <code>Source2</code> as a variant. Try <code>Dim</code>ming as a <code>String</code>. Also, in line two, you are using <code>Source</code> instead of <code>Source2</code> and in line 3 <code>StrFile</code> instead of <code>StrFile2</code>"}, {"owner": {"reputation": 25, "user_id": 11583740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9503629c5cb827ba07a8b6c875e59b?s=128&d=identicon&r=PG&f=1", "display_name": "D__", "link": "https://stackoverflow.com/users/11583740/d"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1562259564, "post_id": 56878040, "comment_id": 100330680, "body": "Ah yea that was my issue actually. Thanks for the help!"}], "answers": [{"tags": [], "owner": {"reputation": 62, "user_id": 11673304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368dcb9a50d5cfc7e27d6fc730d77684?s=128&d=identicon&r=PG&f=1", "display_name": "tmsdajpa", "link": "https://stackoverflow.com/users/11673304/tmsdajpa"}, "is_accepted": false, "score": 0, "last_activity_date": 1562220667, "last_edit_date": 1562220667, "creation_date": 1562193315, "answer_id": 56878701, "question_id": 56878040, "link": "https://stackoverflow.com/questions/56878040/saving-new-excel-file-in-file-directory-specified-in-a-cell/56878701#56878701", "title": "Saving new excel file in file directory specified in a cell", "body": "<p>It wouldn't let me ask a clarifying question. If you're just trying to copy the workbook to the location that you have in cell <code>A11</code>, this works for me. Be sure to change the extension in cell <code>A11</code> to <code>xlsm</code></p>\n\n<pre><code>Sub fff()\n    Dim Source2, StrFile2 As String\n    Source2 = Range(\"A11\").Value\n    ActiveWorkbook.SaveAs Filename:=Source2\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11583740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf9503629c5cb827ba07a8b6c875e59b?s=128&d=identicon&r=PG&f=1", "display_name": "D__", "link": "https://stackoverflow.com/users/11583740/d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562220667, "creation_date": 1562188603, "last_edit_date": 1562189194, "question_id": 56878040, "link": "https://stackoverflow.com/questions/56878040/saving-new-excel-file-in-file-directory-specified-in-a-cell", "title": "Saving new excel file in file directory specified in a cell", "body": "<p>I have some code that copies data from one main workbook and pastes it into a new worksheet. I want to have the code save this new excel file in a specific directory, specified in a cell within a page. I run into the \"Run-time error '1004'\" and not sure of a work around. I have some code below that shows what I have currently. The data in the cell <code>A11</code> is <code>C:\\Users\\MY.NAME\\Desktop\\Data.xls</code></p>\n\n<pre><code> Dim Source2, StrFile2 As String\n\n    Source = Workbooks(\"Main Workbook\").Sheets(\"Directory Location\").Range(\"A11\").Value2\n    StrFile = Dir(Source)\n\nActiveWorkbook.SaveAs Filename:=Source2 &amp; StrFile2\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1562188477, "post_id": 56877914, "comment_id": 100304564, "body": "Shouldn&#39;t you qualify your references? Example: <code>Set pge_minscore = Range(...)</code> should be <code>Set pge_minscore = pge_ws.Range(...)</code> You were working fine until you added another sheet, this is your clue that your references are not qualified. Your <i>implicit</i> <code>ActiveSheet</code> works just fine with one sheet, but it&#39;s not working now."}, {"owner": {"reputation": 13, "user_id": 8946988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fce853be88c899ae6429c409104c54fd?s=128&d=identicon&r=PG&f=1", "display_name": "Narpity", "link": "https://stackoverflow.com/users/8946988/narpity"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1562193173, "post_id": 56877914, "comment_id": 100305850, "body": "Even with that qualified I&#39;m still receiving the error."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1562193292, "post_id": 56877914, "comment_id": 100305877, "body": "I wasn&#39;t implying it was the answer to your question, which is why I left it as a comment and not an answer. But it <i>can lead to issues and unexpected results</i> when you don&#39;t qualify, and therefore it&#39;s good programming practice to <b>always</b> qualify your objects, preferably all the way up to the workbook, but <i>no less than</i> the worksheet."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1562193341, "post_id": 56877914, "comment_id": 100305890, "body": "You should look at AJD&#39;s answer and the usage of <code>Option Explicit</code>."}, {"owner": {"reputation": 3359, "user_id": 4604845, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/88d81c9b06f65d860bb60c31ab062e7e?s=128&d=identicon&r=PG&f=1", "display_name": "Vegard", "link": "https://stackoverflow.com/users/4604845/vegard"}, "edited": false, "score": 0, "creation_date": 1562198954, "post_id": 56877914, "comment_id": 100306937, "body": "The <code>Range</code> object refers to a place on a worksheet, and has a lot of properties - background color, font, content, size, address, and many others - often, but not necessarily, including value. So saying that ranges are collections of values can be a contextually accurate description... but technically they are (a lot) more than that."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8946988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fce853be88c899ae6429c409104c54fd?s=128&d=identicon&r=PG&f=1", "display_name": "Narpity", "link": "https://stackoverflow.com/users/8946988/narpity"}, "edited": false, "score": 0, "creation_date": 1562193133, "post_id": 56878029, "comment_id": 100305837, "body": "There is something else going on other than my typo; when it is correct I still receive the error."}], "tags": [], "owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "is_accepted": false, "score": 0, "last_activity_date": 1562188556, "creation_date": 1562188556, "answer_id": 56878029, "question_id": 56877914, "link": "https://stackoverflow.com/questions/56877914/vba-code-no-longer-recognizing-worksheet-after-adding-a-second-sheet/56878029#56878029", "title": "VBA Code no longer recognizing worksheet after adding a second sheet", "body": "<p>You've got </p>\n\n<p><code>Dim sge_ws As Worksheet</code></p>\n\n<p>But here you're trying to set this variable to worksheet:</p>\n\n<p><code>Set sce_ws = Worksheets(\"SCE\")</code></p>\n\n<p>Hence why you are getting <code>Run-time error '1004': Method 'Range' of object '_Worksheet' failed</code></p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 8946988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fce853be88c899ae6429c409104c54fd?s=128&d=identicon&r=PG&f=1", "display_name": "Narpity", "link": "https://stackoverflow.com/users/8946988/narpity"}, "edited": false, "score": 0, "creation_date": 1562193071, "post_id": 56878385, "comment_id": 100305822, "body": "Apologies; that error was from me trying to figure it out and try different things. I was receiving the first error before I even dimmed any of that. When it is correctly sce_ws I&#39;m still receiving the 1004 error for whichever sheet I&#39;m not on. But my understanding is that is the entire point of the Worksheets object, I don&#39;t understand why that is not enough to qualify a reference."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 13, "user_id": 8946988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fce853be88c899ae6429c409104c54fd?s=128&d=identicon&r=PG&f=1", "display_name": "Narpity", "link": "https://stackoverflow.com/users/8946988/narpity"}, "edited": false, "score": 0, "creation_date": 1562194303, "post_id": 56878385, "comment_id": 100306103, "body": "Check my edits. But using <code>Option Explicit</code> should provide a more meaningful error message and it should highlight the line of code that is causing the [first] error."}, {"owner": {"reputation": 13, "user_id": 8946988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fce853be88c899ae6429c409104c54fd?s=128&d=identicon&r=PG&f=1", "display_name": "Narpity", "link": "https://stackoverflow.com/users/8946988/narpity"}, "edited": false, "score": 0, "creation_date": 1562196222, "post_id": 56878385, "comment_id": 100306501, "body": "Thanks for your help on this I really appreciate you taking the time. I&#39;ll update my answer."}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": true, "score": 1, "last_activity_date": 1562194253, "last_edit_date": 1562194253, "creation_date": 1562190931, "answer_id": 56878385, "question_id": 56877914, "link": "https://stackoverflow.com/questions/56877914/vba-code-no-longer-recognizing-worksheet-after-adding-a-second-sheet/56878385#56878385", "title": "VBA Code no longer recognizing worksheet after adding a second sheet", "body": "<p>Always add <code>Option Explicit</code> to the top of any module. <strong>Always</strong>. </p>\n\n<p>In this case, it would have alerted you to the undeclared variable <code>sce_ws</code> to which you would have responded by changing <code>Dim sge_ws As Worksheet</code> tp <code>Dim sce_ws As Worksheet</code>.</p>\n\n<p>In addition, the following construct may have issues - what if you do not find a result? In addition, because you are using shorthand notation (<code>[H2]</code>) are you sure that the value in the parameters is a Range and not a Value? Or perhaps the range you think it is, as these are not fully qualified, and could refer to a different sheet.</p>\n\n<pre><code>pge_ws.Range([H2], [H:H].Find(\"*\", [H1], , , xlByRows, xlPrevious))\n</code></pre>\n\n<p>To test this theory, try:</p>\n\n<pre><code>set startRange = pge_ws.Range(\"H2\")\nSet endRange = pge_ws.Range(\"H:H\").Find(\"*\", [H1], , , xlByRows, xlPrevious)\npge_ws.Range(startRange, endRange).Resize ' etc\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8946988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fce853be88c899ae6429c409104c54fd?s=128&d=identicon&r=PG&f=1", "display_name": "Narpity", "link": "https://stackoverflow.com/users/8946988/narpity"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 56878385, "answer_count": 2, "score": 0, "last_activity_date": 1562197182, "creation_date": 1562187946, "last_edit_date": 1562197182, "question_id": 56877914, "link": "https://stackoverflow.com/questions/56877914/vba-code-no-longer-recognizing-worksheet-after-adding-a-second-sheet", "title": "VBA Code no longer recognizing worksheet after adding a second sheet", "body": "<p>I'm setting up an excel spreadsheet to track when weather stations are reporting for use in Tableau to create a dashboard so we can track the communication health of the network.</p>\n\n<p>This is being done through an API get that pulls the data every 10 minutes and then gets the difference between the timestamp on the data and a Now() function. If it is over 10 minutes it gets a 0 or if it is under it gets a 1 in Column H. My code is used to move those values from Column H to the right column associated with the right time period. And then on the top of the hour move what im calling the \"HourScore\" to the correct hour column which is then used to calculate the \"DayScore\" which is simply the percentage of times it accurately communicated in the entire day.</p>\n\n<p>It was all working great when I only was tracking one organization; now I'm tracking two and it stopped functioning after I added a second sheet for the other utility. </p>\n\n<p>I've tried a handful of different ways to get the object reference to work, but don't have a ton of experience with VBA so I'm unable to really pinpoint the exact problem.</p>\n\n<p>I've also tried separating them into different workbooks but they are both constantly running on a virtual server and I kept getting errors. That code looked very similar to what is below but each If function was split up.</p>\n\n<pre><code>Sub Minute_Save()\n' Refresh Queries\nActiveWorkbook.RefreshAll\n\n' Creates a variable array from the pge_minscore Column\nDim pge_ws As Worksheet\nDim pge_minscore As Range\nDim pge_hourscore As Range\n\nDim sge_ws As Worksheet\nDim sce_minscore As Range\nDim sce_hourscore As Range\n\nSet pge_ws = Worksheets(\"PGE\")\nSet pge_minscore = Range([E2], [E:E].Find(\"*\", [E1], , , xlByRows, xlPrevious))\n\nSet sce_ws = Worksheets(\"SCE\")\nSet sce_minscore = Range([E2], [E:E].Find(\"*\", [E1], , , xlByRows, xlPrevious))\n\n' Copy Data Refresh into MinuteTable for MinuteScore\nIf Minute(Now()) &lt; 10 Then\n    pge_ws.Range([H2], [H:H].Find(\"*\", [H1], , , xlByRows, xlPrevious)).Resize(pge_minscore.Rows.Count, pge_minscore.Columns.Count).Cells.Value = pge_minscore.Cells.Value\n    sce_ws.Range([H2], [H:H].Find(\"*\", [H1], , , xlByRows, xlPrevious)).Resize(pge_minscore.Rows.Count, pge_minscore.Columns.Count).Cells.Value = pge_minscore.Cells.Value\n\nElseIf Minute(Now()) &gt;= 10 And Minute(Now()) &lt; 20 Then\n    pge_ws.Range([I2], [I:I].Find(\"*\", [I1], , , xlByRows, xlPrevious)).Resize(pge_minscore.Rows.Count, pge_minscore.Columns.Count).Cells.Value = pge_minscore.Cells.Value\n    sce_ws.Range([I2], [I:I].Find(\"*\", [I1], , , xlByRows, xlPrevious)).Resize(pge_minscore.Rows.Count, pge_minscore.Columns.Count).Cells.Value = pge_minscore.Cells.Value\n\nElseIf Minute(Now()) &gt;= 20 And Minute(Now()) &lt; 30 Then\n    pge_ws.Range([J2], [J:J].Find(\"*\", [J1], , , xlByRows, xlPrevious)).Resize(pge_minscore.Rows.Count, pge_minscore.Columns.Count).Cells.Value = pge_minscore.Cells.Value\n    sce_ws.Range([J2], [J:J].Find(\"*\", [J1], , , xlByRows, xlPrevious)).Resize(pge_minscore.Rows.Count, pge_minscore.Columns.Count).Cells.Value = pge_minscore.Cells.Value\n\nElseIf Minute(Now()) &gt;= 30 And Minute(Now()) &lt; 40 Then\n    pge_ws.Range([K2], [K:K].Find(\"*\", [K1], , , xlByRows, xlPrevious)).Resize(pge_minscore.Rows.Count, pge_minscore.Columns.Count).Cells.Value = pge_minscore.Cells.Value\n    sce_ws.Range([K2], [K:K].Find(\"*\", [K1], , , xlByRows, xlPrevious)).Cells.Value = sce_minscore.Cells.Value\n\nElseIf Minute(Now()) &gt;= 40 And Minute(Now()) &lt; 50 Then\n    pge_ws.Range([L2], [L:L].Find(\"*\", [L1], , , xlByRows, xlPrevious)).Resize(pge_minscore.Rows.Count, pge_minscore.Columns.Count).Cells.Value = pge_minscore.Cells.Value\n    sce_ws.Range([L2], [L:L].Find(\"*\", [L1], , , xlByRows, xlPrevious)).Resize(sce_minscore.Rows.Count, sce_minscore.Columns.Count).Cells.Value = sce_minscore.Cells.Value\n\nElseIf Minute(Now()) &gt;= 50 Then\n    pge_ws.Range([M2], [M:M].Find(\"*\", [AC1], , , xlByRows, xlPrevious)).Resize(pge_minscore.Rows.Count, pge_minscore.Columns.Count).Cells.Value = pge_minscore.Cells.Value\n    sce_ws.Range([M2], [M:M].Find(\"*\", [M2], , , xlByRows, xlPrevious)).Resize(sce_minscore.Rows.Count, sce_minscore.Columns.Count).Cells.Value = sce_minscore.Cells.Value\n\n    Set sce_hourscore = sce_ws.Range([N2], [N:N].Find(\"*\", [N1], , , xlByRows, xlPrevious))\n    Set pge_hourscore = pge_ws.Range([N2], [N:N].Find(\"*\", [N1], , , xlByRows, xlPrevious))\n\n        ' Copy MinuteScore to pge_hourscore\n        If Hour(Now()) = 0 Then\n            sce_ws.Range([O4], [O:O].Find(\"*\", [O1], , , xlByRows, xlPrevious)).Resize(sce_hourscore.Rows.Count, sce_hourscore.Columns.Count).Cells.Value = sce_hourscore.Cells.Value\n            pge_ws.Range([O4], [O:O].Find(\"*\", [O1], , , xlByRows, xlPrevious)).Resize(sce_hourscore.Rows.Count, sce_hourscore.Columns.Count).Cells.Value = sce_hourscore.Cells.Value\n      -some more code that is the same as above for more hours-  \n       End If\n    End If\nApplication.OnTime Now + TimeValue(\"00:10:00\"), \"Minute_Save\"\nEnd Sub\n</code></pre>\n\n<p>I receive:</p>\n\n<p>Run-time error '1004':\nMethod 'Range' of object '_Worksheet' failed</p>\n\n<p>Following AJD's instructions I changed the above to the following code:</p>\n\n<pre><code>Set pge_ws = Worksheets(\"PGE\")\nSet pge_minscore = pge_ws.Range(\"H2:H500\")\n\nSet sce_ws = Worksheets(\"SCE\")\nSet sce_minscore = sce_ws.Range([E2], [E:E].Find(\"*\", [E1], , , xlByRows, xlPrevious))\n\n' Copy Data Refresh into MinuteTable for MinuteScore\nIf Minute(Now()) &lt; 10 Then\n    'pge_ws.Range([H2], [H:H].Find(\"*\", [H1], , , xlByRows, xlPrevious)).Resize(pge_minscore.Rows.Count, pge_minscore.Columns.Count).Cells.Value = pge_minscore.Cells.Value\n    'sce_ws.Range([H2], [H:H].Find(\"*\", [H1], , , xlByRows, xlPrevious)).Resize(pge_minscore.Rows.Count, pge_minscore.Columns.Count).Cells.Value = pge_minscore.Cells.Value\n\n    Set startRange = pge_ws.Range(\"H2\")\n    Set endRange = pge_ws.Range(\"H:H\").Find(\"*\", [H1], , , xlByRows, xlPrevious)\n    pge_ws.Range(startRange, endRange) = pge_minscore.Cells.Value\n</code></pre>\n\n<p>This worked; but I'm not entirely sure why. I should be able to adapt what ADJ gave me to the rest of it for my purposes. I think it is because I don't really fully understand the difference between values and ranges. Obviously I know ranges are a collection of cells but wouldn't that mean that ranges are just a collection of values? Either way it is beyond the scope of this post so thanks to the folks that helped out I appreciate you taking the time.</p>\n"}, {"tags": ["sql-server", "excel", "vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1562187057, "post_id": 56877732, "comment_id": 100304059, "body": "Did you change <code>xxx\\\\xxx</code> to your sql server and <code>DATAWAREHOUSE</code> to your database in that server and <code>xxx</code> to your password for your <code>sa</code> user? This is trying to connect with that <code>cn.Open</code> line to that SQL Server and it either can&#39;t find it (because you gave it a bad network path or IP or because you don&#39;t have access with your <code>sa</code>/password."}, {"owner": {"reputation": 87, "user_id": 11673018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097fd259703e1fa26ea7624761270bf?s=128&d=identicon&r=PG&f=1", "display_name": "nimavancouver", "link": "https://stackoverflow.com/users/11673018/nimavancouver"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1562188789, "post_id": 56877732, "comment_id": 100304702, "body": "Thanks for replying. Yes I added the xxx when I posted here.  The servername and the password are also used from R to SQL (and it works), so I believe the issue comes from somewhere else(?)  Except if the access are different between R/Excel to SQL"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1562234770, "post_id": 56877732, "comment_id": 100318313, "body": "You code looks ok.  Hit F8 over and over.  Which line of code does it error out on?"}, {"owner": {"reputation": 87, "user_id": 11673018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097fd259703e1fa26ea7624761270bf?s=128&d=identicon&r=PG&f=1", "display_name": "nimavancouver", "link": "https://stackoverflow.com/users/11673018/nimavancouver"}, "reply_to_user": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1562271876, "post_id": 56877732, "comment_id": 100334061, "body": "@asher Thanks! it&#39;s that lines   cn.Open &quot;Driver={SQL Server};Server=&quot; &amp; ServerName &amp; &quot;;Database=&quot; &amp; DatabaseName &amp; _     &quot;;Uid=&quot; &amp; UserID &amp; &quot;;Pwd=&quot; &amp; Password &amp; &quot;;&quot;"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "edited": false, "score": 0, "creation_date": 1562275915, "post_id": 56877732, "comment_id": 100335025, "body": "Ok, good to know.  So, one of those variables is incorrect and thus you don&#39;t have the correct rights to access that machine.  Make sure you have the correct spelling of the ServerName, UserID, and Password.  Double-check and triple check those variables, and try, try again."}], "owner": {"reputation": 87, "user_id": 11673018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097fd259703e1fa26ea7624761270bf?s=128&d=identicon&r=PG&f=1", "display_name": "nimavancouver", "link": "https://stackoverflow.com/users/11673018/nimavancouver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562278186, "creation_date": 1562186903, "last_edit_date": 1562278186, "question_id": 56877732, "link": "https://stackoverflow.com/questions/56877732/vba-date-export-from-excel-to-sql-server-sql-server-does-not-exist-or-access", "title": "VBA: Date Export from Excel to SQL Server : SQL Server does not exist or access denied", "body": "<p>I am trying to export data from Excel to SQL Server and I found this code online (I have very limited knowledge of VBA). I am having the following code issue:</p>\n\n<blockquote>\n  <p>Run time error *-2147467259 (80004005)':</p>\n  \n  <p>[Microsoft][ODBC SQL SERVER DRIVER][DBMSLPCN] SQL Server does not exist or access denied.</p>\n</blockquote>\n\n<p>Code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub testexportsql()\n    Dim cn As ADODB.Connection\n    Dim ServerName As String\n    Dim DatabaseName As String\n    Dim TableName As String\n    Dim UserID As String\n    Dim Password As String\n    Dim rs As ADODB.Recordset\n    Dim RowCounter As Long\n    Dim NoOfFields As Integer\n    Dim StartRow As Long\n    Dim EndRow As Long\n    Dim ColCounter As Integer\n\n    Set rs = New ADODB.Recordset\n\n    ServerName = \"xxx\\\\xxx\" ' Enter your server name here\n    DatabaseName = \"DATAWAREHOUSE\" ' Enter your  database name here\n    TableName = \"dbo.AlbertaFire_import\" ' Enter your Table name here\n    UserID = \"sa\" ' Enter your user ID here\n    ' (Leave ID and Password blank if using windows Authentification\")\n    Password = \"xxx\" ' Enter your password here\n    NoOfFields = 331 ' Enter number of fields to update (eg. columns in your worksheet)\n    StartRow = 2 ' Enter row in sheet to start reading  records\n    EndRow = 200 ' Enter row of last record in sheet\n\n     '  CHANGES\n    Dim shtSheetToWork As Worksheet\n    Set shtSheetToWork = ActiveWorkbook.Worksheets(\"Sheet2\")\n     '********\n\n    Set cn = New ADODB.Connection\n\n    cn.Open \"Driver={SQL Server};Server=\" &amp; ServerName &amp; \";Database=\" &amp; DatabaseName &amp; _\n            \";Uid=\" &amp; UserID &amp; \";Pwd=\" &amp; Password &amp; \";\"\n\n    rs.Open TableName, cn, adOpenKeyset, adLockOptimistic\n\n     'EndRow = shtSheetToWork.Cells(Rows.Count, 1).End(xlUp).Row\n    For RowCounter = StartRow To EndRow\n        rs.AddNew\n        For ColCounter = 1 To NoOfFields\n        'On Error Resume Next\n            rs(ColCounter - 1) = shtSheetToWork.Cells(RowCounter, ColCounter)\n        Next ColCounter\n        Debug.Print RowCounter\n    Next RowCounter\n    rs.UpdateBatch\n\n     ' Tidy up\n    rs.Close\n    Set rs = Nothing\n    cn.Close\n    Set cn = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 3, "creation_date": 1562186776, "post_id": 56877668, "comment_id": 100303952, "body": "There are many ways to find the location of a string in a range.  The <code>Range.Find</code> method is one of them."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11735756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KqIji6YuIUw/AAAAAAAAAAI/AAAAAAAALKE/3-TOVoOjZlI/photo.jpg?sz=128", "display_name": "Adolfo Rangel", "link": "https://stackoverflow.com/users/11735756/adolfo-rangel"}, "edited": false, "score": 0, "creation_date": 1562253949, "post_id": 56878817, "comment_id": 100328598, "body": "Thanks tmsdajpa, I&#39;ll try it but the thing is, that LOC isn&#39;t always on the same column. Let me explain the situation: I receive the file from one person. What this person does, is attaching all the different sheets he receives in one file. So sheet 1 won&#39;t have the same order always. That&#39;s the reason for searching for the column header instead of the column position. Thank again."}, {"owner": {"reputation": 62, "user_id": 11673304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368dcb9a50d5cfc7e27d6fc730d77684?s=128&d=identicon&r=PG&f=1", "display_name": "tmsdajpa", "link": "https://stackoverflow.com/users/11673304/tmsdajpa"}, "reply_to_user": {"reputation": 15, "user_id": 11735756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KqIji6YuIUw/AAAAAAAAAAI/AAAAAAAALKE/3-TOVoOjZlI/photo.jpg?sz=128", "display_name": "Adolfo Rangel", "link": "https://stackoverflow.com/users/11735756/adolfo-rangel"}, "edited": false, "score": 0, "creation_date": 1562261147, "post_id": 56878817, "comment_id": 100331125, "body": "I just edited my post with a partial solution. See if that&#39;ll work."}], "tags": [], "owner": {"reputation": 62, "user_id": 11673304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368dcb9a50d5cfc7e27d6fc730d77684?s=128&d=identicon&r=PG&f=1", "display_name": "tmsdajpa", "link": "https://stackoverflow.com/users/11673304/tmsdajpa"}, "is_accepted": false, "score": 0, "last_activity_date": 1562261082, "last_edit_date": 1562261082, "creation_date": 1562194447, "answer_id": 56878817, "question_id": 56877668, "link": "https://stackoverflow.com/questions/56877668/search-a-column-header-and-then-filter-all-sheets-using-macro/56878817#56878817", "title": "Search a column header and then filter all sheets using macro", "body": "<p>I've done something similar for work. All that I did was record a macro of me filtering LOC in each tab. </p>\n\n<p>If you need to use this just once, then you won't find this useful. </p>\n\n<p>If you're going to use it multiple times and on each tab, the LOC is always in the same position (it can be different on other tabs), you may find it useful.  Regarding the LOC location, what I mean is, for tab 1, if LOC is always in column 2, and for tab 2, LOC is always in column 4, you can use this. </p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Here are a few other hacks that you may want to try. Will it be okay for you to cut the LOC column and place it in column A? If so, this will be a good start. I've tested it for one sheet. You just need to add some type of code that runs it for each sheet in the workbook. If this is a suitable solution for you, I can find that code for you.</p>\n\n<pre><code>Sub Macro7()\nCells.Find(What:=\"LOC\", After:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\n    xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n    , SearchFormat:=False).Activate\nRange(Selection, Selection.End(xlDown)).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Cut\nRange(\"A1\").Select\nSelection.Insert Shift:=xlToRight\nEnd Sub\n</code></pre>\n\n<p>I started another possible solution that you can try completing. Record a macro of you doing the following: Search for LOC. Filter LOC. Use the Relative Reference when recording your macro. </p>\n"}], "owner": {"reputation": 15, "user_id": 11735756, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-KqIji6YuIUw/AAAAAAAAAAI/AAAAAAAALKE/3-TOVoOjZlI/photo.jpg?sz=128", "display_name": "Adolfo Rangel", "link": "https://stackoverflow.com/users/11735756/adolfo-rangel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562261082, "creation_date": 1562186573, "last_edit_date": 1562217915, "question_id": 56877668, "link": "https://stackoverflow.com/questions/56877668/search-a-column-header-and-then-filter-all-sheets-using-macro", "title": "Search a column header and then filter all sheets using macro", "body": "<p>I'm trying to filter all sheets based on a certain column header named \"LOC code\". This header doesn't not appear on the same column number across the sheets.\nHow do I locate the desired column and then filter by an array of criteria?\nThanks!</p>\n\n<p>I've used the following code to filter, but it's only based on the position of the field (\"10\") and no the column header.</p>\n\n<pre><code>Sub AllSheetsAutofilter()\n\n    Dim p As Integer, q As Integer\n    p = Worksheets.Count\n    For q = 1 To p\n        With Worksheets(q)\n            .Range(\"A1\").AutoFilter Field:=10, _\n                Criteria1:=Array(\"ABM\", \"AC8\"), Operator:=xlFilterValues\n        End With\n    Next q\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 2, "creation_date": 1562185930, "post_id": 56877437, "comment_id": 100303604, "body": "This doesn&#39;t seem to make sense. What&#39;s the purpose of this? Why do you not remove either Row 1 or Row 4 since &quot;2&quot; appears in both? What are you trying to achieve?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1562185998, "post_id": 56877437, "comment_id": 100303634, "body": "Which row would you want to move, for sure? You say remove <i>either</i> 1 or 3. ...which would it be?"}, {"owner": {"reputation": 19, "user_id": 8593454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdc9de6aebb5504adca6c7bf8a7c1053?s=128&d=identicon&r=PG&f=1", "display_name": "Helber Santiago Padilla Rocha", "link": "https://stackoverflow.com/users/8593454/helber-santiago-padilla-rocha"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562186546, "post_id": 56877437, "comment_id": 100303858, "body": "@AAA you&#39;re right. I made a mistake. I have edited to make it more clear. I&#39;m tidying up a database where both A and B are columns of cellphone numbers, and I need to keep just one row associated with each phone number."}, {"owner": {"reputation": 19, "user_id": 8593454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdc9de6aebb5504adca6c7bf8a7c1053?s=128&d=identicon&r=PG&f=1", "display_name": "Helber Santiago Padilla Rocha", "link": "https://stackoverflow.com/users/8593454/helber-santiago-padilla-rocha"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1562186610, "post_id": 56877437, "comment_id": 100303886, "body": "@BruceWayne I doesn&#39;t matter which one. I just need to remove one of them."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1562187386, "post_id": 56877437, "comment_id": 100304187, "body": "Honestly, I would put this in the database as-is then clean it up in there. You can do, in your database, <code>SELECT * FROM yourtable WHERE columnA IN (SELECT columnB from yourTable);</code> and identify your duplicates pretty darned quick. An RDBMS is made for this kind of stuff. If you are stuck with excel though, then just do a <code>=countif(A:A, B1)</code> and copy down. Delete any row that isn&#39;t 0. Much easier then coding this out in a language you don&#39;t write in."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1562192434, "post_id": 56877437, "comment_id": 100305695, "body": "@JNevill, neither of those wouldn&#39;t work because then the last row in the OP&#39;s example would be deleted and shouldn&#39;t be."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1563750715, "post_id": 56877437, "comment_id": 100790867, "body": "@HelberSantiagoPadillaRocha, try the answer below? If it worked, you should say so."}], "answers": [{"tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": false, "score": 0, "last_activity_date": 1562197498, "creation_date": 1562197498, "answer_id": 56879120, "question_id": 56877437, "link": "https://stackoverflow.com/questions/56877437/removing-rows-with-value-repeated-anywhere-in-a-spreadsheet-excel/56879120#56879120", "title": "Removing rows with value repeated anywhere in a spreadsheet Excel", "body": "<pre><code>Sub Macro1()\n\nDim rngA As Range, rngB As Range, LastRow As Long, i As Long, x As Variant\n\nWith ThisWorkbook.Worksheets(1)\n    LastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    Set rngA = .Range(\"A1:A\" &amp; LastRow)\n    Set rngB = .Range(\"B1:B\" &amp; LastRow) 'assuming both columns have same number of rows\nEnd With\n\nFor i = LastRow To 1 Step -1\n    x = Application.Match(rngA(i), rngB, 0)\n    If Not IsError(x) Then\n        If x &lt;&gt; i Then rngA(i).EntireRow.Delete\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562198305, "post_id": 56879134, "comment_id": 100306839, "body": "Can you please explain <code>=SUMPRODUCT(--(A10=Sheet1!$B$10:$B$14))=0</code>? Never used this before."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 1, "creation_date": 1562199091, "post_id": 56879134, "comment_id": 100306961, "body": "@AAA  <code>A10=Sheet1!$B$10:$B$14</code> returns an array of <code>{True,False}</code> depending on if the value in <code>A10</code> is found in <code>B10:B14</code>.  The double unary converts that to <code>{1,0}</code> and <code>SUMPRODUCT</code> adds them up.  To not filter the result, we want that value to be zero.  Also check Excel HELP for the Advanced Filter as regard using formulas for a criteria; and also using <code>Multiple criteria, one column, any criteria true</code>"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1562199693, "last_edit_date": 1562199693, "creation_date": 1562197695, "answer_id": 56879134, "question_id": 56877437, "link": "https://stackoverflow.com/questions/56877437/removing-rows-with-value-repeated-anywhere-in-a-spreadsheet-excel/56879134#56879134", "title": "Removing rows with value repeated anywhere in a spreadsheet Excel", "body": "<p>You don't really need VBA.  You can do this with the <code>Advanced Filter</code> using Formula Criteria.</p>\n\n<p>The data table needs a header row</p>\n\n<p>The formula criteria are:</p>\n\n<pre><code>A2:  =SUMPRODUCT(--(A10=Sheet1!$B$10:$B$14))=0\nA3:  =A10=B10\n</code></pre>\n\n<p><strong>Before</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/vslnE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vslnE.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Dialog</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/4x0R8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4x0R8.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>After</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/cH1fS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cH1fS.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you don't want to filter in place, there is an option to have the output in a separate range in the Dialog.</p>\n\n<p>IF I were going to use a VBA solution, I'd probably use a Dictionary to collect the rows of interest, and then spit them on a results range/sheet</p>\n\n<p>This is one way of doing it.</p>\n\n<p>For the price of more complex coding, this algorithm can be sped up considerably, by using VBA arrays in the code.  But I chose the simpler path to demonstrate.  I'd use the more complex method only if this method proves too slow.</p>\n\n<p>This algorithm assumes the source table starts in A9, but you can change that easily.</p>\n\n<p>It also retains the first that doesn't meet the exclusion criteria, whereas the advanced filter method retains the last row.  Either can be modified to work the opposite way.</p>\n\n<pre><code>Option Explicit\nSub filterMatchesAB()\n    Dim rSrc As Range, C As Range, rRes As Range\n    Dim wsSrc As Worksheet, wsRes As Worksheet\n    Dim myDict As Object, myKey As Variant\n    Dim I As Long\n\nSet wsSrc = Worksheets(\"sheet1\")\nSet wsRes = Worksheets(\"sheet2\")\n    Set rRes = wsRes.Cells(1, 1)\n\nWith wsSrc\n    Set rSrc = .Range(.Cells(9, 1), .Cells(.Rows.Count, 1).End(xlUp)).Resize(columnsize:=5)\nEnd With\n\nSet myDict = CreateObject(\"Scripting.Dictionary\")\nFor Each C In rSrc.Rows\n    myKey = C.Cells(1, 1)\n    If Not myDict.exists(C.Cells(1, 2).Value) Then\n        myDict.Add Key:=myKey, Item:=C\n    End If\nNext C\n\nApplication.ScreenUpdating = False\nI = 0\nFor Each myKey In myDict.keys\n    I = I + 1\n    myDict(myKey).Copy rRes(I, 1)\nNext myKey\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8593454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdc9de6aebb5504adca6c7bf8a7c1053?s=128&d=identicon&r=PG&f=1", "display_name": "Helber Santiago Padilla Rocha", "link": "https://stackoverflow.com/users/8593454/helber-santiago-padilla-rocha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562199693, "creation_date": 1562185336, "last_edit_date": 1562186209, "question_id": 56877437, "link": "https://stackoverflow.com/questions/56877437/removing-rows-with-value-repeated-anywhere-in-a-spreadsheet-excel", "title": "Removing rows with value repeated anywhere in a spreadsheet Excel", "body": "<p>I've been trying to delete rows that have repeated values in different rows and in different columns (defined by the user). I just started learning VBA so I haven't been able do to anything.</p>\n\n<p>For example, if the criteria was finding repeated values in either columns A or B</p>\n\n<pre><code>A   B   C   D   E\n1   2   7   8   U\n3   4   7   8   U\n8   1   8   7   W\n6   3   8   7   U\n5   5   7   8   W\n</code></pre>\n\n<p>It should remove either row 1 or 3 because \"1\" appears in A or B, and remove either row 2 or 4 because \"3\" appears in A or B. Row 5 shouldn't be removed because \"5\" appears both in A and B. I expect it to look like this:</p>\n\n<pre><code>A   B   C   D   E\n1   2   7   8   U\n6   3   8   7   U\n5   5   7   8   W\n</code></pre>\n\n<p>I would appreciate any help. Thank you very much</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1562185420, "post_id": 56877428, "comment_id": 100303400, "body": "<code>Year(2020)</code> = <code>1905</code> not <code>2020</code>  you want: <code>If IsEmpty(cel) And Year(cel.Offset(0, -1)) = 2020 Then</code>"}, {"owner": {"reputation": 11, "user_id": 11348523, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MM7fjBo5JBc/AAAAAAAAAAI/AAAAAAAAAaY/N4-1Sba8KxY/photo.jpg?sz=128", "display_name": "eikoonote", "link": "https://stackoverflow.com/users/11348523/eikoonote"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1562188742, "post_id": 56877428, "comment_id": 100304677, "body": "I tried &quot;If IsEmpty(cel) And Year(cel.Offset(0, -1)) = 2020 Then&quot; and I got a Run-Time Error &#39;13&#39; of Type Mismatch."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1562188805, "post_id": 56877428, "comment_id": 100304709, "body": "Are any of the values in <code>cel.Offset(0, -1)</code> errors or text?"}, {"owner": {"reputation": 11, "user_id": 11348523, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MM7fjBo5JBc/AAAAAAAAAAI/AAAAAAAAAaY/N4-1Sba8KxY/photo.jpg?sz=128", "display_name": "eikoonote", "link": "https://stackoverflow.com/users/11348523/eikoonote"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1562190843, "post_id": 56877428, "comment_id": 100305328, "body": "the date is in cel.Offset(0, -1), format is MM/DD/YYYY"}], "answers": [{"tags": [], "owner": {"reputation": 459, "user_id": 10547271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/59Gqb.png?s=128&g=1", "display_name": "AsUsual", "link": "https://stackoverflow.com/users/10547271/asusual"}, "is_accepted": false, "score": 0, "last_activity_date": 1562226403, "creation_date": 1562226403, "answer_id": 56883031, "question_id": 56877428, "link": "https://stackoverflow.com/questions/56877428/using-the-year-in-one-cell-to-determine-the-contents-for-another-cell/56883031#56883031", "title": "Using the Year in one cell to determine the contents for another cell", "body": "<p><code>Year(2020)</code> as mentioned returns 1905 this is because it works with the raw number/serial number not formatted in any way. A date written in a cell as a date will be recognized as a date and the value will change but it will look the same through formatting. For example today's date is 43650 without formatting and <code>Year(43650)</code> returns 2019</p>\n\n<p>Just write <code>2020</code> like beneath if you want to compare each <code>Year(date)</code> to that number </p>\n\n<pre><code>Sub yearTest()\n    Dim SrchRng As Range, cel As Range\n    Set SrchRng = Range(\"D1:D9\")\n\n    For Each cel In SrchRng\n        If IsEmpty(cel) And Year(cel.Offset(0, -1)) = 2020 Then\n            cel.Offset(0, -2).Value = \"Test\"\n        End If\n    Next cel\nEnd Sub\n</code></pre>\n\n<p>Also you can try out the formula in your sheet like =Year(C1) in cell D1 and then change the formatting of the date in C1 to see the non-existent effects.</p>\n"}], "owner": {"reputation": 11, "user_id": 11348523, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MM7fjBo5JBc/AAAAAAAAAAI/AAAAAAAAAaY/N4-1Sba8KxY/photo.jpg?sz=128", "display_name": "eikoonote", "link": "https://stackoverflow.com/users/11348523/eikoonote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562226403, "creation_date": 1562185284, "last_edit_date": 1562218610, "question_id": 56877428, "link": "https://stackoverflow.com/questions/56877428/using-the-year-in-one-cell-to-determine-the-contents-for-another-cell", "title": "Using the Year in one cell to determine the contents for another cell", "body": "<p>What I want to do is have a value put into a column based on the year in the other column. The year column is in MM/DD/YYYY format. I am not a very experienced VBA programmer, but I am trying to learn it as fast as I can.</p>\n\n<p>I've already tried using the Year() function in an IF statement to see if it will show the text I want it to, but it shows nothing in the cell. </p>\n\n<pre><code>Dim SrchRng As Range, cel As Range\n\nSet SrchRng = Range(\"D1:D9\")\n\nFor Each cel In SrchRng\n    If IsEmpty(cel) And Year(cel.Offset(0, -1)) = Year(2020) Then\n        cel.Offset(0, -2).Value = \"Test\"\n    End If\nNext cel\n</code></pre>\n\n<p>Nothing shows up in the cel -2 cell and I am unsure what to try next. Any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 5, "creation_date": 1562184362, "post_id": 56877208, "comment_id": 100303025, "body": "You want <code>&gt;= 1</code> not <code>= 1</code> on the InStr which returns the relative position of what is being searched."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1562184474, "post_id": 56877208, "comment_id": 100303061, "body": "And you do not want quotes around the variables <code>If InStr(UCase(searchString), UCase(searchField)) &gt;= 1 Then</code>"}], "answers": [{"comments": [{"owner": {"reputation": 70, "user_id": 10925930, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214069692758242/picture?type=large", "display_name": "Tyler Edwards", "link": "https://stackoverflow.com/users/10925930/tyler-edwards"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1562186315, "post_id": 56877523, "comment_id": 100303767, "body": "Oh I didn&#39;t even notice that you had already answered this, I&#39;m sorry! But yes, you are correct, I completely missed that!"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1562186356, "post_id": 56877523, "comment_id": 100303789, "body": "I did not answer I left comments, you answered.  I was just trying to help"}, {"owner": {"reputation": 19, "user_id": 11736271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7adec25035a9bd21211bf318a3218edf?s=128&d=identicon&r=PG&f=1", "display_name": "rluth", "link": "https://stackoverflow.com/users/11736271/rluth"}, "edited": false, "score": 0, "creation_date": 1562299398, "post_id": 56877523, "comment_id": 100338547, "body": "Thanks so much guys! I&#39;ll try it out and let you know if it works"}, {"owner": {"reputation": 70, "user_id": 10925930, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214069692758242/picture?type=large", "display_name": "Tyler Edwards", "link": "https://stackoverflow.com/users/10925930/tyler-edwards"}, "edited": false, "score": 0, "creation_date": 1562608792, "post_id": 56877523, "comment_id": 100420698, "body": "Have you tried stepping into the code while it&#39;s running to see exactly where it&#39;s going wrong?"}], "tags": [], "owner": {"reputation": 70, "user_id": 10925930, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214069692758242/picture?type=large", "display_name": "Tyler Edwards", "link": "https://stackoverflow.com/users/10925930/tyler-edwards"}, "is_accepted": false, "score": 1, "last_activity_date": 1562186331, "last_edit_date": 1562186331, "creation_date": 1562185710, "answer_id": 56877523, "question_id": 56877208, "link": "https://stackoverflow.com/questions/56877208/search-program-in-vba/56877523#56877523", "title": "Search program in VBA", "body": "<p>Remove the quotes from <code>If InStr(UCase(\"searchString\"), UCase(\"searchField\")) = 1 Then</code>, currently it is using those values as strings, or text literals, but you want them to reference the actual variables:</p>\n\n<p><code>If InStr(UCase(searchString), UCase(searchField)) &gt;= 1 Then</code></p>\n"}], "owner": {"reputation": 19, "user_id": 11736271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7adec25035a9bd21211bf318a3218edf?s=128&d=identicon&r=PG&f=1", "display_name": "rluth", "link": "https://stackoverflow.com/users/11736271/rluth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562186331, "creation_date": 1562184227, "last_edit_date": 1562184268, "question_id": 56877208, "link": "https://stackoverflow.com/questions/56877208/search-program-in-vba", "title": "Search program in VBA", "body": "<p>I am coding a search that traverses a dataset on an excel worksheet. Currently the code runs for an exact match, matching the search field with the cell. However, I want my program to be able to search and give results even with instances of the search in the cell (string within the cell). For example, search for the word \"dog\" in the cell which has \"this dog is brown\" should return the entire cell. </p>\n\n<p>Ive already tried the following incorporating the following piece, but it doesnt work</p>\n\n<pre><code>searchString = dataArray(i, searchField)\nIf InStr(UCase(\"searchString\"), UCase(\"searchField\")) = 1 Then\n</code></pre>\n\n<p><strong>The following is the actual code:</strong> </p>\n\n<pre><code>'Get the range values into a variable that can be looped through.\n\n'Example usage: dataArray(1,1) [row,column]\n\n'Simple version: ws.Range(Cells(1,1),Cells(2,2)).Value\n\ndataArray = ws.Range(ws.Cells(dataRowStart, dataColumnStart), ws.Cells(ws.Cells(Rows.Count, dataColumnStart).End(xlUp).Row, dataColumnEnd)).Value\n\n        'Increase size of array that will hold the data to display to its max possible size for the current worksheet.\n        ReDim datatoShowArray(1 To UBound(dataArray, 1), 1 To UBound(dataArray, 2))\n\n        'Row increment for the final data array (datatoShowArray).\n        j = 1\n\n        'Loop through the rows in the data range.\n        For i = 1 To UBound(dataArray, 1)\n\n            'Check if the value in the row equals our search value\n            If (dataArray(i, searchField) = searchValue) Then\n\n\n                'MATCH FOUND! Now do something!\n\n                'Loop through the columns in the data range so can get their values.\n                For k = 1 To UBound(dataArray, 2)\n\n                    'Add values to the array that will be used to put data into the Dashboard.\n                    datatoShowArray(j, k) = dataArray(i, k)\n\n                Next k\n\n                'Increment the counter for the datatoShowArray\n                j = j + 1\n\n\n            End If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562187255, "post_id": 56876818, "comment_id": 100304133, "body": "It&#39;s not a bug. That&#39;s how it works. Do you really need to use <code>Selection</code> though? Normally you don&#39;t."}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 6362653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2797c883be869241a7681c0084f0feae?s=128&d=identicon&r=PG&f=1", "display_name": "SmIqbal", "link": "https://stackoverflow.com/users/6362653/smiqbal"}, "edited": false, "score": 0, "creation_date": 1594630468, "post_id": 56878501, "comment_id": 111181515, "body": "Is there any way of using the same technique on a normal filtered range instead of a table?"}, {"owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "reply_to_user": {"reputation": 89, "user_id": 6362653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2797c883be869241a7681c0084f0feae?s=128&d=identicon&r=PG&f=1", "display_name": "SmIqbal", "link": "https://stackoverflow.com/users/6362653/smiqbal"}, "edited": false, "score": 0, "creation_date": 1594631554, "post_id": 56878501, "comment_id": 111182043, "body": "@SmIqbal yes, simply use this if cell <code>A1</code> is a part of the data: <code>Set Rng = Worksheets(&quot;Sheet1&quot;).Range(&quot;A1&quot;).CurrentRegion.SpecialCells(&zwnj;&#8203;xlCellTypeVisible)</code>"}], "tags": [], "owner": {"reputation": 3311, "user_id": 6147374, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d05b5955de351d18e1c8d715f97f0be2?s=128&d=identicon&r=PG&f=1", "display_name": "Ibo", "link": "https://stackoverflow.com/users/6147374/ibo"}, "is_accepted": true, "score": 1, "last_activity_date": 1562191763, "creation_date": 1562191763, "answer_id": 56878501, "question_id": 56876818, "link": "https://stackoverflow.com/questions/56876818/excel-vba-set-range-filtered-table-visible-cells/56878501#56878501", "title": "Excel VBA - Set Range Filtered table Visible Cells", "body": "<p>Usually using \"Selection\" is not a good practice; I am guessing you just need to get the range of the visible cells for that you can easily use this:</p>\n\n<pre><code>Sub GetVisibleRangeOnly()\n    Dim tbl As ListObject\n    Dim rng As Range\n\n    'change the name of the table and worksheet as you need\n    Set tbl = Worksheets(\"Sheet1\").ListObjects(\"Table1\")\n\n    'Note: if there is no visible cell after filtraton rng IS NOTHING will be TRUE\n    Set rng = tbl.DataBodyRange.SpecialCells(xlCellTypeVisible)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "accepted_answer_id": 56878501, "answer_count": 1, "score": 0, "last_activity_date": 1562191763, "creation_date": 1562182223, "question_id": 56876818, "link": "https://stackoverflow.com/questions/56876818/excel-vba-set-range-filtered-table-visible-cells", "title": "Excel VBA - Set Range Filtered table Visible Cells", "body": "<p>I am using this code to set a range of filtered table to visible cells only.</p>\n\n<pre><code>Set rngMyRange = Selection.SpecialCells(xlCellTypeVisible)\n</code></pre>\n\n<p>However, there is a strange bug if only one cell is selected, that is, the code selects all used range in the filtered table. </p>\n\n<p>If the selection is greater than one cell, then the code works as expected. Is there a way around this? </p>\n"}, {"tags": ["html", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": true, "score": 0, "last_activity_date": 1562188616, "last_edit_date": 1562188616, "creation_date": 1562188052, "answer_id": 56877941, "question_id": 56876811, "link": "https://stackoverflow.com/questions/56876811/how-to-get-results-for-web-scraping-for-different-cells-with-a-different-url/56877941#56877941", "title": "How to get results for web scraping for different cells with a different url?", "body": "<p>Assuming that Column A contains the index fund of interest, and that the data starts at Row 2, your code can be re-written as follows...</p>\n\n<pre><code>Sub GetCurrentPrices()\n\n    Dim ws As Worksheet\n    Dim text As String\n    Dim lastRow As Long\n    Dim i As Long\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n    With ws\n        lastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n    With CreateObject(\"InternetExplorer.Application\")\n        For i = 2 To lastRow\n            .navigate \"https://www.blackrock.com/uk/individual/products/\" &amp; ws.Cells(i, 1).Value &amp; \"/\"\n            Do While .Busy And .readyState &lt;&gt; 4: DoEvents: Loop\n            text = .document.getElementsByClassName(\"header-nav-data\")(0).innerText\n            ws.Cells(i, 2).Value = text\n        Next i\n        .Quit\n    End With\n\n    Set ws = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 11736118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d3d2632f8f96163624ed2262f0e6f5?s=128&d=identicon&r=PG&f=1", "display_name": "c_dogg", "link": "https://stackoverflow.com/users/11736118/c-dogg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56877941, "answer_count": 1, "score": 0, "last_activity_date": 1562221805, "creation_date": 1562182161, "last_edit_date": 1562221805, "question_id": 56876811, "link": "https://stackoverflow.com/questions/56876811/how-to-get-results-for-web-scraping-for-different-cells-with-a-different-url", "title": "How to get results for web scraping for different cells with a different url?", "body": "<p>I am setting up a spreadsheet that will get the NAV for specific index funds every day from the blackrock website. There are a number of these index funds however and the URL changes for each cell. I am unsure how to make my way down the spreadsheet table I have made and place the target value in another cell.</p>\n\n<p>I have tried listing every possible URL one after another and it seems to work, however, I keep receiving a run-time error so I must assume there is a more efficient way of doing this.</p>\n\n<pre><code>Sub GetCurrentPrices()\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Dim text As String\n\n    With CreateObject(\"internetexplorer.application\")\n        .navigate \"https://www.blackrock.com/uk/individual/products/xxxxxx/\"\n        Do While .Busy And .readyState &lt;&gt; 4: DoEvents: Loop\n        text = .document.getElementsByClassName(\"header-nav-data\")(0).innerText\n        .Quit\n    End With\n\n    ws.Cells(32, 1).Value = text\n\n    With CreateObject(\"internetexplorer.application\")\n        .navigate \"https://www.blackrock.com/uk/individual/products/yyyyyy/\"\n        Do While .Busy And .readyState &lt;&gt; 4: DoEvents: Loop\n        text = .document.getElementsByClassName(\"header-nav-data\")(0).innerText\n        .Quit\n    End With\n\n    ws.Cells(33, 1).Value = text\n\nEnd Sub\n</code></pre>\n\n<p>Currently, this code is copied about 22 times for each different URL. I have also tried something like this:</p>\n\n<pre><code>Sub GetCurrentPrices2()\n    Dim ws As Worksheet: Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Dim text As String\n    Dim i As Integer\n    i=32\n\n    With CreateObject(\"internetexplorer.application\")\n        .navigate \"https://www.blackrock.com/uk/individual/products/\" &amp; (ws.Range(\"H2:H24\").Value) &amp; \"/\"\n        Do While .Busy And .readyState &lt;&gt; 4: DoEvents: Loop\n        text = .document.getElementsByClassName(\"header-nav-data\")(0).innerText\n        .Quit\n    End With\n\n    Do Until i &gt; 46\n        ws.Cells(i,1).Value = text\n    Loop\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1562183228, "post_id": 56876655, "comment_id": 100302581, "body": "Shorter doesn&#39;t always equate better. What&#39;s wrong with the statement you&#39;ve got there, and how do you &quot;feel&quot; it&#39;s inefficient? IMO what you&#39;ve got is in the upper bracket of the level of complexity one wants to see in a readable statement that&#39;s easily modified/debugged. One improvement would be to factor out the magic <code>3</code> and make that a parameter to some <code>PadLeftInMultiplesOf</code> function (or any better name than that), e.g. <code>Debug.Print PadLeftInMultiplesOf(3, &quot;1234&quot;)</code>"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1562183382, "post_id": 56876655, "comment_id": 100302635, "body": "As I agree with the above statment, another method: <code>format(MyString, string((INT((len(MyString)-1)&#47;3)+1)*3,&quot;0&quot;))</code>  But this will only work for numbers."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1562183791, "post_id": 56876655, "comment_id": 100302794, "body": "Or this that also works for other text strings: <code>Right(string(99,&quot;0&quot;)&amp;MyString,(INT((len(MyString)-1)&#47;3)+1)*3&zwnj;&#8203;)</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1562185912, "post_id": 56876655, "comment_id": 100303596, "body": "@ScottCraner I think <code>Int(...&#47;3)</code> could be replaced by <code>...\\3</code> (integer division) for fewer brackets and operations :)  (the <code>Format</code> method seems to fall apart with longer strings eg. <code>&quot;1234567891234567812345678912345678&quot;</code> though)"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562186127, "post_id": 56876655, "comment_id": 100303693, "body": "@MathieuGuindon did not know that, thanks."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562186996, "post_id": 56876655, "comment_id": 100304036, "body": "@MathieuGuindon yup, apparently the limit is 29 digits."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1562187409, "post_id": 56876655, "comment_id": 100304201, "body": "OP: This looks very much like a <a href=\"https://codereview.stackexchange.com\">Code Review</a> post, down to even the title describing the purpose of the code (kudos!) -- here on Stack Overflow, it&#39;s arguably opinion-based; enhancements of <i>working code</i> are best made on CR, where reviewers will provide feedback on <i>every</i> aspect of the code, so you&#39;ll want to present that code in its surrounding context &quot;natural habitat&quot; for best results."}, {"owner": {"reputation": 2422, "user_id": 11606728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eLJAF.jpg?s=128&g=1", "display_name": "Mohsen Alyafei", "link": "https://stackoverflow.com/users/11606728/mohsen-alyafei"}, "edited": false, "score": 1, "creation_date": 1562213764, "post_id": 56876655, "comment_id": 100309234, "body": "Thank you all for the ideas. I have come up with one more possibility with one less bracket, but still uses a <b>double Mod</b> function. Still uses a double Mod Function: <code>MyString = String(2 * (Len(MyString) Mod 3) Mod 3, &quot;0&quot;) + MyString </code>"}], "answers": [{"comments": [{"owner": {"reputation": 2422, "user_id": 11606728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eLJAF.jpg?s=128&g=1", "display_name": "Mohsen Alyafei", "link": "https://stackoverflow.com/users/11606728/mohsen-alyafei"}, "edited": false, "score": 1, "creation_date": 1563112328, "post_id": 56880737, "comment_id": 100585201, "body": "examples of the use of the formula can be found here: <a href=\"https://codereview.stackexchange.com/questions/224027/simple-number-to-words-using-a-single-loop-string-triplets-in-vba\" title=\"simple number to words using a single loop string triplets in vba\">codereview.stackexchange.com/questions/224027/&hellip;</a> and here: <a href=\"https://codereview.stackexchange.com/questions/223936/simple-number-to-words-using-a-single-loop-string-triplets-in-javascript?noredirect=1&amp;lq=1\" title=\"simple number to words using a single loop string triplets in javascript\">codereview.stackexchange.com/questions/223936/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2422, "user_id": 11606728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eLJAF.jpg?s=128&g=1", "display_name": "Mohsen Alyafei", "link": "https://stackoverflow.com/users/11606728/mohsen-alyafei"}, "is_accepted": true, "score": 0, "last_activity_date": 1562217032, "last_edit_date": 1562217032, "creation_date": 1562215253, "answer_id": 56880737, "question_id": 56876655, "link": "https://stackoverflow.com/questions/56876655/padding-a-number-string-with-zeros-to-remain-as-a-multiple-of-3s-in-length/56880737#56880737", "title": "Padding a Number String with Zeros to remain as a Multiple of 3&#39;s in length", "body": "<p>After several attempts and your ideas, I have come up with the following using a single Mod Function:</p>\n\n<pre><code>MyString = String((Len(MyString) * 2) Mod 3, \"0\") &amp; MyString\n</code></pre>\n\n<p>In general, a general formula would be:</p>\n\n<pre><code>MyString = String((Len(MyString) * (Multiples-1) ) Mod Multiples, \"0\") &amp; MyString\n</code></pre>\n"}], "owner": {"reputation": 2422, "user_id": 11606728, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eLJAF.jpg?s=128&g=1", "display_name": "Mohsen Alyafei", "link": "https://stackoverflow.com/users/11606728/mohsen-alyafei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 56880737, "answer_count": 1, "score": 0, "last_activity_date": 1562217032, "creation_date": 1562181286, "question_id": 56876655, "link": "https://stackoverflow.com/questions/56876655/padding-a-number-string-with-zeros-to-remain-as-a-multiple-of-3s-in-length", "title": "Padding a Number String with Zeros to remain as a Multiple of 3&#39;s in length", "body": "<p>I would like to have a quick single line VBA code to pad a number in string form to always have a length of a multiples of 3's.\nFor example:</p>\n\n<p>\"12\" becomes \"012\"</p>\n\n<p>\"1234\" becomes \"001234\"</p>\n\n<p>\"1234567\" becomes \"001234567\"</p>\n\n<p>\"12345678912345678\" becomes \"012345678912345678\"</p>\n\n<p>and so on.</p>\n\n<p>The number string will not have any fraction or decimal points, so not to worry about that.</p>\n\n<p>The length of the resulting string should be a multiple of 3 by adding 0's to the Left.</p>\n\n<p>The number string should remain a string throughout the coding and should not be converted into a number using a numeric function such as Val, as the original string could be very long over 150 digits and using a numeric function could truncate or round the number and give undesirable results.</p>\n\n<p>I had come up with the following as a possible solution by checking the string length but feel there is a better more efficient way of doing it in one (1) coding statement.</p>\n\n<pre><code>Result = String((3 - (Len(MyString) Mod 3)) Mod 3, \"0\") &amp; MyString\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-2007"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1562181615, "post_id": 56876617, "comment_id": 100301980, "body": "You might be better off assigning the text to a string and then using: <code>myRange.AddComment.Text myString</code>. Wihtout sample data, and expected output, it is difficult to guess how you will get the value of the string."}, {"owner": {"reputation": 1, "user_id": 11732508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67af062994df02d27b94503008bd149c?s=128&d=identicon&r=PG&f=1", "display_name": "seowji", "link": "https://stackoverflow.com/users/11732508/seowji"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1563329774, "post_id": 56876617, "comment_id": 100659786, "body": "@cybernetic.nomad I do need the contents of comment in the cells to contain arrays of formula result from other cells. Is that possible?  Say for example: I want cell E16 to have a comment which contains the result of formulas of cell Q10 and cell S14  Q10 has formula of =SUM(3+4) and  S14 has formula of =SUM(5+7)  So I need the comment in cell E16 to write 7, 12  Is that possible to do with Excel VBA 2007?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1563373424, "post_id": 56876617, "comment_id": 100679517, "body": "Assign the <code>Value</code> of the cell to the string"}, {"owner": {"reputation": 1, "user_id": 11732508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67af062994df02d27b94503008bd149c?s=128&d=identicon&r=PG&f=1", "display_name": "seowji", "link": "https://stackoverflow.com/users/11732508/seowji"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1563433971, "post_id": 56876617, "comment_id": 100700099, "body": "@cybernetic.nomad thanks for your response. What if the contents of the cell comment, example, cell A1 to contain formulas that have {=index(....)}  Is it possible for VBA to output more than 1 results from array formula directly straight into the comment of cell A1?"}], "owner": {"reputation": 1, "user_id": 11732508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67af062994df02d27b94503008bd149c?s=128&d=identicon&r=PG&f=1", "display_name": "seowji", "link": "https://stackoverflow.com/users/11732508/seowji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562181453, "creation_date": 1562181134, "last_edit_date": 1562181453, "question_id": 56876617, "link": "https://stackoverflow.com/questions/56876617/add-comment-in-an-array-of-cells-with-the-contents-of-the-comment-of-each-of-the", "title": "Add comment in an array of cells with the contents of the comment of each of the cells taken from another array of cells in another worksheet", "body": "<p>I'm trying to use VBA to make a code that can add comments on cells from D8:F38 in Sheet1 with the contents of comments in each of the cells (D8:F38 cells in Sheet1) are referred from another worksheet in the same workbook. </p>\n\n<p>The contents of reference for the comment of each cells from <code>D8:F38</code> in <code>Sheet1</code> has to be from the <code>=COUNTIFS</code> formula that those cells (<code>D8:F38</code> cells in <code>Sheet1</code>) initially ran. Is it possible? Or is the criteria too complex for the coding to run on?</p>\n\n<p>As for cells that have <code>0</code> values no comments are needed.</p>\n\n<p>I've tried using <code>Range D8:F38</code> but it doesn't work, and instead returns the error </p>\n\n<blockquote>\n  <p>Run-time error '5': Invalid procedure call or argument.</p>\n</blockquote>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\nWorksheets(1).Range(\"D8:F38\").AddComment \"This part needs to get reference from cells in other worksheet in same workbook\"\n\nEnd Sub\n</code></pre>\n\n<p>The expected result is that all the cells in <code>D8:F38</code> of <code>Sheet1</code> that are not valued <code>0</code> in its <code>=COUNTIFS</code> formula get comments (with the mini red triangle on top of it), with the contents of comments of each of the cells in <code>D8:F38</code> of <code>Sheet1</code> is referenced based on the text in cells <code>Sheet2</code> <code>=COUNTIFS</code> of cells <code>D8:F38</code>.</p>\n\n<p>Example: The cell in <code>D9</code> has value of <code>2</code>, which is the result of a <code>=COUNTIFS</code> of cells in <code>Sheet2!C:C,fruits</code>, and the comment of the cell in <code>D9</code> has to be \"apple oranges\"</p>\n\n<p><code>fruits</code>         is just the second criteria in the <code>=COUNTIFS</code> formula of the cell <code>D9</code></p>\n\n<p>and </p>\n\n<p><code>apple</code>            is the word in the cell that <code>D9</code> <code>=COUNTIF</code> counted from <code>Sheet2</code><br>\n<code>oranges</code>        is the word in the second cell that <code>D9</code> <code>=COUNTIF</code> counted from <code>Sheet2</code></p>\n"}, {"tags": ["vba", "forms", "ms-access-2016"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 1, "creation_date": 1562179241, "post_id": 56876177, "comment_id": 100300937, "body": "Are you getting any error codes? Are you getting ANY results?  Is your combo-box multi-column or single column?"}, {"owner": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1562179497, "post_id": 56876177, "comment_id": 100301049, "body": "My combo-box is single column. When I am using the query : &quot;SELECT InputSHEETER1.[Pallet1] FROM InputSHEETER1;&quot; my dropdown in empty."}, {"owner": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "reply_to_user": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1562179735, "post_id": 56876177, "comment_id": 100301147, "body": "does it have something to do with Primary key column? Job is primary key column in InputSheeter1"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1562179912, "post_id": 56876177, "comment_id": 100301253, "body": "Check your RowSourceType property is set to Table/Query"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 3, "creation_date": 1562180449, "post_id": 56876177, "comment_id": 100301498, "body": "As it fails when selecting only one field, I guess your box is dual column, but first column-width is set to 0 and you see only second column. By selecting only one column, second one is empty and first ine not visible. Can you select an empty entry?"}, {"owner": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "edited": false, "score": 0, "creation_date": 1562180460, "post_id": 56876177, "comment_id": 100301505, "body": "it is set to Table/Query"}, {"owner": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1562180710, "post_id": 56876177, "comment_id": 100301605, "body": "@ComputerVersteher You are right, changed it to 1 and it worked."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1562181207, "post_id": 56876177, "comment_id": 100301818, "body": "Yes count to 1 and set column-width &gt; 0 of first column. If ComboBox is bound you may have to change bound column. Read <a href=\"https://support.office.com/en-us/article/add-a-list-box-or-combo-box-70abf4a9-0439-4885-9099-b9fa83517603\" rel=\"nofollow noreferrer\">Add a list box or combo box</a> to see most settings."}], "owner": {"reputation": 25, "user_id": 11232616, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Re1MXVlAwHk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdvF53CseM4HwleD50Cc8uCP4vGUQ/mo/photo.jpg?sz=128", "display_name": "NewAtSQL", "link": "https://stackoverflow.com/users/11232616/newatsql"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562179824, "creation_date": 1562179099, "last_edit_date": 1562179824, "question_id": 56876177, "link": "https://stackoverflow.com/questions/56876177/unable-to-fetch-data-in-form-from-different-tables-in-access-form", "title": "Unable to fetch data in form from different tables in Access Form", "body": "<p>I am trying to fetch some data in a combobox from table2 in form1, the record source for the form1 is table1. </p>\n\n<p>table1 - GetInputtbl\nform1  - GetInputfrm\ntable2 - InputSheeter1</p>\n\n<p>I am interested in the values in column Pallet1 in table InputSheeter1 </p>\n\n<p>I am able to do that but by using the the row source of the combobox as the following code only </p>\n\n<pre><code>SELECT [InputSHEETER1].[JOB], [InputSHEETER1].[Pallet1] FROM InputSHEETER1 ORDER \nBY [Pallet1];\n</code></pre>\n\n<p>When I try to use the query below, it doesn't work:</p>\n\n<pre><code>SELECT InputSHEETER1.[Pallet1] FROM InputSHEETER1;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1562178009, "creation_date": 1562178009, "answer_id": 56875951, "question_id": 56875890, "link": "https://stackoverflow.com/questions/56875890/excel-vba-intersect-only-specific-column/56875951#56875951", "title": "Excel VBA - Intersect only specific column", "body": "<p>Here is a general pointer. Count the number of cells selected and the number in the intersection with M.</p>\n\n<pre><code>Sub x()\n\nIf Intersect(Selection, Range(\"M:M\")).Count &lt; Selection.Count Then\n    MsgBox \"outside col M selected\"\nElse\n    MsgBox \"only col M selected\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1372, "user_id": 2092236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f31bef5ce787bafd90b708edb563cf67?s=128&d=identicon&r=PG", "display_name": "JoaMika", "link": "https://stackoverflow.com/users/2092236/joamika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 56875951, "answer_count": 1, "score": 0, "last_activity_date": 1562178009, "creation_date": 1562177737, "question_id": 56875890, "link": "https://stackoverflow.com/questions/56875890/excel-vba-intersect-only-specific-column", "title": "Excel VBA - Intersect only specific column", "body": "<p>I am using this macro to check if a user selects a range within column \"M\". However, if the user selects a range in columns \"M:N\" for example, this bypasses the check. I would like to prevent that, so that users only select a range within column M (and not any other columns), before proceeding.</p>\n\n<pre><code>Set rngMyRange = Selection.SpecialCells(xlCellTypeVisible)\nSet srng = x_bf.Range(table[ColumnM])\n\nIf Intersect(rngMyRange, srng) Is Nothing Then\nerrline = \"Please select a range in Column M only.\"\nGoTo errhandler\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1562179479, "post_id": 56875887, "comment_id": 100301036, "body": "Use your first set of code and pull your time-advancement code out of the while loop and only loop the time to quit portion of your code.  The values you&#39;re setting for Advancement aren&#39;t triggering the advancement, just setting the time allotted BEFORE advancement.  The second example fails because the If statement is triggered right after those settings are checked/set for each slide. Its not a continuous thing.  It only happens the once(and for each slide) at that sub activation."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11735820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d565875039363eb578fbad96fd9e623b?s=128&d=identicon&r=PG&f=1", "display_name": "rox601", "link": "https://stackoverflow.com/users/11735820/rox601"}, "edited": false, "score": 0, "creation_date": 1562190066, "post_id": 56876301, "comment_id": 100305106, "body": "Ah I see why my initial if statement doesn&#39;t work. Using a while loop will let it be checked continuously instead of once. I tried running your code and what happens is a blank white screen shows up and then closes when reaching the time range. I assume the white screen must be the slideshow, but I don&#39;t understand why it shows up like that."}], "tags": [], "owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "is_accepted": true, "score": 1, "last_activity_date": 1562179606, "creation_date": 1562179606, "answer_id": 56876301, "question_id": 56875887, "link": "https://stackoverflow.com/questions/56875887/how-to-close-out-of-slideshow-view-at-a-given-time-time-interval-in-powerpoint-v/56876301#56876301", "title": "How to close out of slideshow view at a given time/time interval in powerpoint VBA?", "body": "<p>Try this</p>\n\n<pre><code>Sub OpenFile()\nSet pptApp = CreateObject(\"PowerPoint.Application\")\npptApp.Visible = True\nSet pptPres = pptApp.Presentations.Open(\"Compute_Dashboard.pptx\")\nActivePresentation.SlideShowSettings.Run\nFor Each s In ActivePresentation.Slides\n     With s.SlideShowTransition\n          .AdvanceOnTime = msoTrue\n          .AdvanceTime = 3\n     End With\nNext s\n\nDim b As Boolean\nb = True\n    While b = True\n    If Time() &gt; TimeValue(\"10:10:00\") And Time() &lt; TimeValue(\"10:10:10\") Then\n            b = False\n            ActivePresentation.SlideShowWindow.view.Exit\n            Application.Quit\n    End If\n    Wend\n</code></pre>\n\n<p>I'm not 100% sure of your intent here - guessing you just want to set slide advancement time to 3 seconds for each slide and exit at a certain time.</p>\n\n<p>Setting slide <em>advancement time</em> is not <em>triggering the slide to advance</em>. Its just setting that property for that slide - advance after 3 seconds.</p>\n\n<p>Since it sets those properties for ALL slides in the blink of an eye at the time the program runs, it checks the QUIT requirements effectively the moment the program runs, thus never quitting.</p>\n"}], "owner": {"reputation": 1, "user_id": 11735820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d565875039363eb578fbad96fd9e623b?s=128&d=identicon&r=PG&f=1", "display_name": "rox601", "link": "https://stackoverflow.com/users/11735820/rox601"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 56876301, "answer_count": 1, "score": 0, "last_activity_date": 1562179606, "creation_date": 1562177722, "question_id": 56875887, "link": "https://stackoverflow.com/questions/56875887/how-to-close-out-of-slideshow-view-at-a-given-time-time-interval-in-powerpoint-v", "title": "How to close out of slideshow view at a given time/time interval in powerpoint VBA?", "body": "<p>I started VBA recently and am trying to make a project that will open up a powerpoint file(compute_dashboard.pptx) and put it up in slideshow view. It will go through the slides and loop until it reaches a specific time range; in this code below it should exit out at 10:10:00 AM - 10:10:10 AM and quit powerpoint. I have two different implementations each with their own problems, if you could find a way to correct either of them that would be great.</p>\n\n<p>With my first implementation, it will open the file, then powerpoint doesn't respond until the clock reaches that time range, which then quits the application like it should. So the main problem is that I can't see the slideshow run at all.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Sub OpenFile()\n    Set pptApp = CreateObject(\"PowerPoint.Application\")\n    pptApp.Visible = True\n    Set pptPres = pptApp.Presentations.Open(\"Compute_Dashboard.pptx\")\n    ActivePresentation.SlideShowSettings.Run\n\n    Dim b As Boolean\n    b = True\n        While b = True\n        If Time() &gt; TimeValue(\"10:10:00\") And Time() &lt; TimeValue(\"10:10:10\") Then\n                b = False\n                ActivePresentation.SlideShowWindow.view.Exit\n                Application.Quit\n        End If\n            With ActivePresentation.Slides(1).SlideShowTransition\n                    .AdvanceOnTime = msoTrue\n                     .AdvanceTime = 3         \n            End With \n        Wend\n</code></pre>\n\n<p>With the 2nd implementation, it opens the file and the slideshow loops correctly but then I can't get the slideshow and powerpoint to quit at my time range.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\n     Sub OpenFile()\n     Set pptApp = CreateObject(\"PowerPoint.Application\")\n     pptApp.Visible = True\n     Set pptPres = pptApp.Presentations.Open(\"Compute_Dashboard.pptx\")\n     ActivePresentation.SlideShowSettings.Run\n     For Each s In ActivePresentation.Slides\n         With s.SlideShowTransition\n              .AdvanceOnTime = msoTrue\n              .AdvanceTime = 3\n\n      If Time() &gt; TimeValue(\"10:10:00\") And Time() &lt; TimeValue(\"10:10:10\") Then\n                ActivePresentation.SlideShowWindow.view.Exit\n                Application.Quit\n      End If\n      End With\n     Next\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter", "copy", "range"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562177155, "post_id": 56875643, "comment_id": 100300034, "body": "Is <code>D.Range(&quot;A1:C&quot; &amp; Range(&quot;A1&quot;).End(xlDown).Row)</code> Supposed to be <code>D.Range(&quot;A1:C&quot; &amp; Range(&quot;C1&quot;).End(xlDown).Row)</code>? because how you have it now you are grabbing the last row of column A not column C."}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 8628075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a28853c2c3614991fa15b37383330b8f?s=128&d=identicon&r=PG&f=1", "display_name": "beantownbuzz", "link": "https://stackoverflow.com/users/8628075/beantownbuzz"}, "is_accepted": true, "score": 0, "last_activity_date": 1562182800, "last_edit_date": 1562182800, "creation_date": 1562181917, "answer_id": 56876770, "question_id": 56875643, "link": "https://stackoverflow.com/questions/56875643/how-can-i-copy-and-paste-filtered-range-in-another-workbook/56876770#56876770", "title": "How can i copy and paste filtered range in another workbook?", "body": "<p>You'll need to add in variables to reference the two workbooks, but hopefully this example will work.</p>\n\n<pre><code>Sub CopyPasteFilteredRange()\n\nDim D As Worksheet\nDim Log As Worksheet\nDim PasteHere As Worksheet\nDim Rangedata As range, U As range\nDim Lastrow As Long 'Get Last Row\nSet D = Worksheets(\"D\")\nSet Log = Worksheets(\"Log\")\nSet PasteHere = Worksheets(\"PasteHere\") 'Added Sheet PasteHere as Example\n\n    'Remove Filtered Criteria Before Filtering\n    If ActiveSheet.FilterMode Then\n        ActiveSheet.ShowAllData\n    End If\n\n    'Table Range\n    Set Rangedata = D.range(\"A1:C\" &amp; range(\"A1\").End(xlDown).Row)\n    Rangedata.AutoFilter Field:=2, Criteria1:=Log.Cells(8, 3)\n    'Amount which i want to copy without Header\n\n    'If you have filtered above on Column B, but if there are blank cells in Col C .End(XlDown will stop at first blank value, so add lastRow to capture all used rows\n    Lastrow = D.UsedRange.Rows(D.UsedRange.Rows.Count).Row\n    Set U = D.range(\"C1:C\" &amp; Lastrow)\n\n    'Set U to Visable Cells otherwise what you are .copying is still = D.range(\"C1:C\" &amp; range(\"C1\").End(xlDown).Row)\n    Set U = U.Offset(1, 0).SpecialCells(xlCellTypeVisible)\n\n    U.Copy 'Don't have to Select U\n\n    PasteHere.range(\"A1\").PasteSpecial\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10432763, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8af9ccf2f388fab74e3ac4b500e3a71f?s=128&d=identicon&r=PG&f=1", "display_name": "Anas Being", "link": "https://stackoverflow.com/users/10432763/anas-being"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 56876770, "answer_count": 1, "score": 0, "last_activity_date": 1562182800, "creation_date": 1562176634, "question_id": 56875643, "link": "https://stackoverflow.com/questions/56875643/how-can-i-copy-and-paste-filtered-range-in-another-workbook", "title": "How can i copy and paste filtered range in another workbook?", "body": "<p>When i am pasting Amount data which i copied from filtered range through VBA code, I do not get the correct result. \nHow can i copy and paste the correct filtered range in VBA?</p>\n\n<p>I have tried in so many ways like visible cells and resize.</p>\n\n<pre><code>Dim Rangedata as Range, U as Range\n'Table Range\nSet Rangedata = D.Range(\"A1:C\" &amp; Range(\"A1\").End(xlDown).Row)\nRangedata.AutoFilter Field:=2, Criteria1:=Log.Cells(8, 3) \n'Amount which i want to copy without Header\nSet U = D.Range(\"C1:C\" &amp; Range(\"C1\").End(xlDown).Row)\nU.Offset(1, 0).SpecialCells(xlCellTypeVisible).Select\nU.copy\n</code></pre>\n\n<p>There are almost 22 Amounts but i am only getting 10 Amounts.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1562177295, "creation_date": 1562177295, "answer_id": 56875791, "question_id": 56875599, "link": "https://stackoverflow.com/questions/56875599/add-cell-reference-based-on-end-of-dynamic-column/56875791#56875791", "title": "Add cell reference based on end of dynamic column", "body": "<p>I think you just need this:</p>\n\n<pre><code>Range(\"M16\").Formula = \"=F\" &amp; PSTtotal.row\n</code></pre>\n\n<p>or perhaps just</p>\n\n<pre><code>Range(\"M16\").Formula = \"=\" &amp; PSTtotal.address\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 11555787, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fSOgY.jpg?s=128&g=1", "display_name": "eyeScream", "link": "https://stackoverflow.com/users/11555787/eyescream"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 56875791, "answer_count": 1, "score": 0, "last_activity_date": 1562177295, "creation_date": 1562176399, "question_id": 56875599, "link": "https://stackoverflow.com/questions/56875599/add-cell-reference-based-on-end-of-dynamic-column", "title": "Add cell reference based on end of dynamic column", "body": "<p>I want to add a cell reference to another cell. The cell reference is at the end of a dynamic column. The code I have at the moment copies the value and places it in my target cell. However, I need the reference. What do I have to change?</p>\n\n<p>The code I have right now is;</p>\n\n<pre><code>Dim PSTtotal As Range\nSet PSTtotal = Range(\"F8\").End(xlDown)\n\nRange(\"M16\").Formula = ActiveCell\n</code></pre>\n\n<p>I want M16 to be \"=F##\" (what ever the last row is represented by ##).</p>\n\n<p>How can I do this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 4, "creation_date": 1562175183, "post_id": 56875195, "comment_id": 100299178, "body": "Is the <code>SelectedFiles</code> a typo?"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562176787, "post_id": 56875195, "comment_id": 100299868, "body": "As pointed out by @BigBen you are declaring Files, assigning to SelectedFiles, and then checking the value of Files. Use Option Explicit to avoid these issues before they begin."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 1, "creation_date": 1562177742, "post_id": 56875195, "comment_id": 100300270, "body": "@Warcupine Alas, by default in fresh Office installation the <code>Option Explicit</code> is turned off... That is how people get bad habits \ud83d\ude10"}, {"owner": {"reputation": 574, "user_id": 10776519, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af66cb6f734bfbc5b7771b2f915a2ee9?s=128&d=identicon&r=PG&f=1", "display_name": "Mike ", "link": "https://stackoverflow.com/users/10776519/mike"}, "edited": false, "score": 0, "creation_date": 1562181274, "post_id": 56875195, "comment_id": 100301849, "body": "Disregarding the clear typo-the reason this is happening is your <code>Range(&quot;O&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0) = Files</code>. Basically saying, go to the end of &quot;O&quot;, then down 1 and with this range (its only 1 cell at this point) insert my array of files.  It can only HOLD one value from the array since there is only 1 cell.  Change it to <code>Range(Range(&quot;O&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0), Range(&quot;O&quot; &amp; Rows.Count).End(xlUp).Offset(UBound(Files) - LBound(Files) + 1, 0)) = Files</code>. This will get the last cell in &quot;O&quot;, move down 1 and then get the range based on how many items are in the file array."}], "owner": {"reputation": 29, "user_id": 11714000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e1a6412b059c04be08e1397f656eb7a?s=128&d=identicon&r=PG&f=1", "display_name": "thevancanfan", "link": "https://stackoverflow.com/users/11714000/thevancanfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562218517, "creation_date": 1562174391, "last_edit_date": 1562218517, "question_id": 56875195, "link": "https://stackoverflow.com/questions/56875195/macro-to-read-and-list-file-locations-input-by-user-and-exit-if-error", "title": "Macro to read and list file locations input by user and exit if error", "body": "<p>I currently have a macro that reads certain files input by a user and part of the code below collects filenames. However, when the user enters multiple file locations, only one file location is entered.</p>\n\n<p>In column C, I would like an input of all the file locations in order such that they are listed as: filelocation1, filelocaction2...and so on.</p>\n\n<p>This is my current code:</p>\n\n<pre><code>Sub openfiles()\n\n    Dim Files As Variant\n\n    'open directory, filter by excel files, select files and place in array\n    SelectedFiles = Application.GetOpenFilename( _\n        FileFilter:=\"Excel Filter (*.xlsx), *.xlsx\", _\n        MultiSelect:=True)\n\n    Application.ScreenUpdating = False 'update in background\n\n    If not IsArray(Files) Then\n        MsgBox \"No files selected. Cannot continue.\"\n        Range(\"O\" &amp; Rows.Count).End(xlUp).Offset(1, 0) = \"no files selected\"\n        Exit Sub\n    Else\n        Range(\"O\" &amp; Rows.Count).End(xlUp).Offset(1, 0) = Files\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 0, "last_activity_date": 1562175110, "last_edit_date": 1562175110, "creation_date": 1562174497, "answer_id": 56875221, "question_id": 56874964, "link": "https://stackoverflow.com/questions/56874964/extracting-data-from-new-report-and-compiling-specific-data-to-one-excel-sheet/56875221#56875221", "title": "Extracting data from new report and compiling specific data to one excel sheet", "body": "<p>I think you have an extra \")\" after *.xlsx, you also need to put a colon after multiselect so alltogether </p>\n\n<pre><code>FileNames = Application.GetOpenFilename(\"top 20(*.xlsx),*.xlsx\", , \"Insert Latest Top 20 Report\", \"Import\", MultiSelect:= True) \n</code></pre>\n\n<p>It is interpreting the multiselect as an undefined variable not a parameter accepting an argument. </p>\n\n<p>Edit: You also had an argument as a string \".xlsx\" that needs to be an integer or empty. </p>\n"}], "owner": {"reputation": 43, "user_id": 11735662, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11300b0fded39534a472333c68d5e9d0?s=128&d=identicon&r=PG&f=1", "display_name": "learningguy", "link": "https://stackoverflow.com/users/11735662/learningguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 56875221, "answer_count": 1, "score": 0, "last_activity_date": 1562175110, "creation_date": 1562173346, "question_id": 56874964, "link": "https://stackoverflow.com/questions/56874964/extracting-data-from-new-report-and-compiling-specific-data-to-one-excel-sheet", "title": "Extracting data from new report and compiling specific data to one excel sheet", "body": "<p>Hello I am trying to create a VBA code where I could automate extracting specific data from new reports and placing them into a home excel sheet. I am using Application.getopenfilename to locate the file but am having issues with errors when i run my code. I get a mismatch error when I try to use For i = 1 To UBound(FileNames)</p>\n\n<p>I have already tried changing the dim i to integer but it didn't work</p>\n\n<pre><code>Sub AutomateReport()\nDim FileNames As Variant\nApplication.ScreenUpdating = False\nRange(\"A1\").Select\nFileNames = Application.GetOpenFilename(\"top 20(*.xlsx)),*.xlsx\", \".xlsx\", \"Insert Latest Top 20 Report\", \"Import\", MultiSelect = True)\nDim i As Integer\nFor i = 1 To UBound(FileNames)\n    Workbooks.Open FileNames(i)\n    Range(\"A1\").Select\n    Selection.Copy\n    Windows(\"Book1.xlsm\").Activate\n    Selection.PasteSpecial Paste:=xlPasteAll, Transpose:=True\n    Wokbooks.Open FileNames(i)\n    ActiveWorkbook.Close Savechanges:=False\n    ActiveCells.Offset(1, 0).Activate\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>I keep recieving the error 13 for mismatched data.</p>\n"}, {"tags": ["excel", "vba", "excel-2010"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 5, "creation_date": 1562173378, "post_id": 56874885, "comment_id": 100298381, "body": "<code>Minute(A3 - A2)</code>... <code>A3</code> and <code>A2</code> are not valid references to those cells. Perhaps <code>Range(&quot;A3&quot;)</code>... or <code>[A3]</code>."}, {"owner": {"reputation": 25, "user_id": 11735137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ln8ncAoeKVI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfqx-aPNs_SrcDqyPDuky1RdrMB6A/photo.jpg?sz=128", "display_name": "Brendan", "link": "https://stackoverflow.com/users/11735137/brendan"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562175890, "post_id": 56874885, "comment_id": 100299476, "body": "@BigBen Thank you that was the issue!"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 11735137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ln8ncAoeKVI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfqx-aPNs_SrcDqyPDuky1RdrMB6A/photo.jpg?sz=128", "display_name": "Brendan", "link": "https://stackoverflow.com/users/11735137/brendan"}, "edited": false, "score": 1, "creation_date": 1562177011, "post_id": 56875489, "comment_id": 100299980, "body": "Thank you for your help!"}], "tags": [], "owner": {"reputation": 70, "user_id": 10925930, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214069692758242/picture?type=large", "display_name": "Tyler Edwards", "link": "https://stackoverflow.com/users/10925930/tyler-edwards"}, "is_accepted": true, "score": 0, "last_activity_date": 1562175896, "creation_date": 1562175896, "answer_id": 56875489, "question_id": 56874885, "link": "https://stackoverflow.com/questions/56874885/how-to-use-if-then-statements-for-minute-of-cell-minus-cell-is-equal-to/56875489#56875489", "title": "How to use IF Then statements for minute of cell minus cell is equal to?", "body": "<p>Perhaps this will help, I'm assuming that you are wanting to reference the values inside of cells A2 and A3, in which case you would need to also include the <code>Range()</code> and <code>.Value</code> tags.</p>\n\n<pre><code>If (Minute(Range(\"A2\").Value) - Minute(Range(\"A3\").Value) = 1) Then\n\n'Do something\n\nElse If (Minute(Range(\"A2\").Value) - Minute(Range(\"A3\").Value) = 5) Then\n\n'Do something else\n\nElse If (Minute(Range(\"A2\").Value) - Minute(Range(\"A3\").Value) = 15) Then\n\n'Do something else\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 11735137, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ln8ncAoeKVI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfqx-aPNs_SrcDqyPDuky1RdrMB6A/photo.jpg?sz=128", "display_name": "Brendan", "link": "https://stackoverflow.com/users/11735137/brendan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 56875489, "answer_count": 1, "score": 1, "last_activity_date": 1562218445, "creation_date": 1562173004, "last_edit_date": 1562218445, "question_id": 56874885, "link": "https://stackoverflow.com/questions/56874885/how-to-use-if-then-statements-for-minute-of-cell-minus-cell-is-equal-to", "title": "How to use IF Then statements for minute of cell minus cell is equal to?", "body": "<p>I wish to make an IF Then statement. Both cell A2 and A3 have dates in them. I want my IF Then statement to be if the minute of A3 minus the minute of A2 is equal to 1 then it performs my command. I also want to do an ElseIf Then statement for if the minute difference is 5 minute and if the minute difference is 15 minutes.</p>\n\n<p>I tried finding the syntax online and have code copied below but it does not work. The code reads that if the minute value of cell A3 minus the minute value of cell A2 is equal to 1 then perform the function. It does not work though.</p>\n\n<pre><code>Sub ExportAverageData()\n\nIf (Minute(A3 - A2) = 1) Then\nSheets(2).Select\nRange(\"E2\").Select\nActiveCell.FormulaR1C1 = \"=AVERAGE(OFFSET(R2C2,(ROW()-ROW(R2C5))*15,,15,))\"\nSelection.AutoFill Destination:=Range(\"E2:E9999\")\nRange(\"F2\").Select\nActiveCell.FormulaR1C1 = \"=AVERAGE(OFFSET(R2C3,(ROW()-ROW(R2C6))*15,,15,))\"\nSelection.AutoFill Destination:=Range(\"F2:F9999\")\nActiveSheet.UsedRange.SpecialCells(xlCellTypeFormulas, 16).ClearContents\n\nElseIf (Minute(A3 - A2) = 5) Then\nSheets(2).Select\nRange(\"E2\").Select\nActiveCell.FormulaR1C1 = \"=AVERAGE(OFFSET(R2C2,(ROW()-ROW(R2C5))*3,,3,))\"\nSelection.AutoFill Destination:=Range(\"E2:E9999\")\nRange(\"F2\").Select\nActiveCell.FormulaR1C1 = \"=AVERAGE(OFFSET(R2C3,(ROW()-ROW(R2C6))*15,,15,))\"\nSelection.AutoFill Destination:=Range(\"F2:F9999\")\nActiveSheet.UsedRange.SpecialCells(xlCellTypeFormulas, 16).ClearContents\n\nElseIf (Minute(A3 - A2) = 15) Then\nSheets(2).Select\nRange(\"E2\").Select\nActiveCell.FormulaR1C1 = \"=AVERAGE(OFFSET(R2C2,(ROW()-ROW(R2C5))*15,,15,))\"\nSelection.AutoFill Destination:=Range(\"E2:E9999\")\nRange(\"F2\").Select\nActiveCell.FormulaR1C1 = \"=AVERAGE(OFFSET(R2C3,(ROW()-ROW(R2C6))*15,,15,))\"\nSelection.AutoFill Destination:=Range(\"F2:F9999\")\nActiveSheet.UsedRange.SpecialCells(xlCellTypeFormulas, 16).ClearContents\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 4, "creation_date": 1562173131, "post_id": 56874836, "comment_id": 100298258, "body": "Actually any macro that writes to cells resets the undo list, including event handlers. Can you show your <code>worksheet_change</code> handler that doesn&#39;t do it?"}], "owner": {"reputation": 13, "user_id": 9182464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b306fb18df8ca818bf2ec94316f2aca?s=128&d=identicon&r=PG&f=1", "display_name": "ahmad", "link": "https://stackoverflow.com/users/9182464/ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562173341, "creation_date": 1562172729, "last_edit_date": 1562173152, "question_id": 56874836, "link": "https://stackoverflow.com/questions/56874836/why-is-the-undo-function-disabled-with-worksheet-change-event", "title": "Why is the undo function disabled with Worksheet_Change event?", "body": "<p>I use a macro to print the timestamp in column AJ when anything in the range A:AH is changed, but it disables the undo function in Excel. I am also using another worksheet_change event that auto capitalizes text, but it doesn't disable the undo functionality. Why does this code disable undo and is there any way around it? Thanks for any help</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n' Code to print timestamp in Column AJ following a change in a corresponding row\n    Dim WorkRng As Range, row As Long\n    Dim rng As Range\n    Set WorkRng = Intersect(Range(\"A:AH\"), Target)\n    If Not WorkRng Is Nothing Then\n        Application.EnableEvents = False\n            For Each rng In WorkRng\n                row = rng.row\n                If Not rng.Value = \"\" Then\n                    Cells(row, \"AJ\").Value = Now\n                    Cells(row, \"AJ\").NumberFormat = \"mm/dd/yyyy hh:mm:ss\"\n                Else\n                    Cells(row, \"AJ\").Value = Now\n                    Cells(row, \"AJ\").NumberFormat = \"mm/dd/yyyy hh:mm:ss\"\n                End If\n            Next\n        Application.EnableEvents = True\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11735404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08980c21e589d12790023a58d89dbc8d?s=128&d=identicon&r=PG&f=1", "display_name": "HailMegs", "link": "https://stackoverflow.com/users/11735404/hailmegs"}, "edited": false, "score": 0, "creation_date": 1562181059, "post_id": 56875816, "comment_id": 100301753, "body": "Thanks for the cleanup tips JohnyL. Sorry since I&#39;m trying to grasp how to apply this to my worksheets, but can the &quot;Field&quot; section contain multiple values? Also, I would need to compare results from one column first, delete the rows, clear the search filters, then repeat. Similar to what I did in my not-so-clean script above to make sure its not filtering by all values at once if that makes sense."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "reply_to_user": {"reputation": 1, "user_id": 11735404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08980c21e589d12790023a58d89dbc8d?s=128&d=identicon&r=PG&f=1", "display_name": "HailMegs", "link": "https://stackoverflow.com/users/11735404/hailmegs"}, "edited": false, "score": 0, "creation_date": 1562181496, "post_id": 56875816, "comment_id": 100301936, "body": "<i>can the &quot;Field&quot; section contain multiple values</i> If you need several fields, then add such filter for every field."}], "tags": [], "owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "is_accepted": false, "score": 0, "last_activity_date": 1562177400, "creation_date": 1562177400, "answer_id": 56875816, "question_id": 56874811, "link": "https://stackoverflow.com/questions/56874811/delete-rows-from-one-workbook-based-on-data-in-another-workbook/56875816#56875816", "title": "Delete rows from one workbook based on data in another workbook", "body": "<p>You can use several values at once in the filter. To use several values in the filter, you need to use 1) 1-D array for criteria and 2) <code>xlFilterValues</code> enumeration value for <code>Operator</code> parameter. In the example below I filter first column of range A1 with two values.\n<img src=\"https://i.imgur.com/u9zlPaI.png\" alt=\"IMG1\"></p>\n\n<pre><code>Sub Z()\n\n    Dim rngA As Range\n    Dim arrValuesToFilter As Variant\n\n    arrValuesToFilter = [{\"Fanta\", \"Pepsi\"}]\n    Set rngA = Range(\"A1\").CurrentRegion\n    rngA.AutoFilter Field:=1, Criteria1:=arrValuesToFilter, Operator:=xlFilterValues\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11735404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08980c21e589d12790023a58d89dbc8d?s=128&d=identicon&r=PG&f=1", "display_name": "HailMegs", "link": "https://stackoverflow.com/users/11735404/hailmegs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562177400, "creation_date": 1562172628, "last_edit_date": 1562174717, "question_id": 56874811, "link": "https://stackoverflow.com/questions/56874811/delete-rows-from-one-workbook-based-on-data-in-another-workbook", "title": "Delete rows from one workbook based on data in another workbook", "body": "<p>I extract 2 database reports that export in Excel tables. I have to remove rows from reportA based on data that already exists in reportA. </p>\n\n<p>(Example: If Column 5 contains the word \"<em>Pepsi</em>\" in any cell of that column, delete the entire row in reportA)</p>\n\n<p>I have to also remove rows from reportA based on data that exists in a specific column in reportB. So if any cell in a specific column of reportA contains the exact cell value from a specific column in reportB based on key words, delete that row in reportA.</p>\n\n<p>(Example: Filter any cell in Column 4 of reportB containing the word \"<em>Coke</em>\" or \"<em>Sprite</em>\", reportB has matches of \"Coke Zero\" and \"Sprite Shipment\" in 2 cells in Column 4. Delete EVERY row from reportA that contains \"Coke Zero\" or \"Sprite Shipment\" in Column 5 of reportA)</p>\n\n<p>Did a bit of research and came up with the below script to at least remove rows from reportA.</p>\n\n<pre><code>Sub Clean_Up_Food_Items()\n\n  Application.Calculation = xlCalculationManual\n  Application.ScreenUpdating = False\n\n   Dim lo As ListObject\n\n   Set lo = Sheet2.ListObjects(1)\n   lo.Parent.Activate 'Activate sheet that table is on.\n\n   lo.AutoFilter.ShowAllData\n\n   lo.Range.AutoFilter Field:=5, Criteria1:=\"Coke*\"\n\n   Application.DisplayAlerts = False       \n     lo.DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n   Application.DisplayAlerts = True\n\n   lo.AutoFilter.ShowAllData\n\n   lo.Range.AutoFilter Field:=4, Criteria1:=\"Fanta*\"\n\n   Application.DisplayAlerts = False\n     lo.DataBodyRange.SpecialCells(xlCellTypeVisible).Delete\n   Application.DisplayAlerts = True\n\n   lo.AutoFilter.ShowAllData\n\n  Application.Calculation = xlCalculationAutomatic\n  Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>The above works to at least remove rows based on data that exists in reportA, but I can't figure out how to filter out the data based on reportB to remove rows in reportA.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1562175111, "post_id": 56874583, "comment_id": 100299148, "body": "show table VehicleInfo structure(fields). Do you try updating more than one row? Add a link to yesterdays question. <a href=\"https://stackoverflow.com/a/1099570/9439330\">Debug</a> your query."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1562186613, "post_id": 56874583, "comment_id": 100303887, "body": "Number counting in column names (Vic<b>1</b>License,  ..., Vic<b>6</b>License) is an indicator for wrong table design. You can store information for up to 6 vehicles per owner in your table? That has some disadvantages (empty fields, count vehicles, &gt; 6 vehicles, ...). if you have a field for a number (vehicleId), you can store as many vehicles per owner as needed. The number 1 to 6 can be computed by counting the vehicles per owner with id is same or lower. Bad design like that causes lots of trouble later on and is hard to fix, when db grows. Thats why database normalization should be first step."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11688898, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ImvRQivwOCc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRuzQ_Vt8bIzr2jIJappTT3Qj2vg/mo/photo.jpg?sz=128", "display_name": "Bryan Clinkenbeard", "link": "https://stackoverflow.com/users/11688898/bryan-clinkenbeard"}, "edited": false, "score": 0, "creation_date": 1562174677, "post_id": 56875127, "comment_id": 100298936, "body": "All my fields are string. Thank you for catching the comma. I removed the comma but I still get the same error message."}, {"owner": {"reputation": 116, "user_id": 10135418, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0xr57rQEME4/AAAAAAAAAAI/AAAAAAAADH4/Jk1mcFVNMoM/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/10135418/jon"}, "edited": false, "score": 1, "creation_date": 1562175671, "post_id": 56875127, "comment_id": 100299390, "body": "Are you able to see what strUpdate contains right before the RunSQL statement?  Can you set a breakpoint and view the contents of strUpdate to see how it looks?  Maybe your data is the problem.."}, {"owner": {"reputation": 23, "user_id": 11688898, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ImvRQivwOCc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRuzQ_Vt8bIzr2jIJappTT3Qj2vg/mo/photo.jpg?sz=128", "display_name": "Bryan Clinkenbeard", "link": "https://stackoverflow.com/users/11688898/bryan-clinkenbeard"}, "edited": false, "score": 0, "creation_date": 1562175786, "post_id": 56875127, "comment_id": 100299432, "body": "yes, I use a msgbox to review the command.  All variables are being populated correctly"}, {"owner": {"reputation": 116, "user_id": 10135418, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-0xr57rQEME4/AAAAAAAAAAI/AAAAAAAADH4/Jk1mcFVNMoM/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/10135418/jon"}, "reply_to_user": {"reputation": 23, "user_id": 11688898, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ImvRQivwOCc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRuzQ_Vt8bIzr2jIJappTT3Qj2vg/mo/photo.jpg?sz=128", "display_name": "Bryan Clinkenbeard", "link": "https://stackoverflow.com/users/11688898/bryan-clinkenbeard"}, "edited": false, "score": 1, "creation_date": 1562182356, "post_id": 56875127, "comment_id": 100302262, "body": "@BryanClinkenbeard Can you screenshot or show what the actual SQL statement is?  Did you check for extra apostrophes?"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 2, "last_activity_date": 1562188832, "last_edit_date": 1562188832, "creation_date": 1562174076, "answer_id": 56875127, "question_id": 56874583, "link": "https://stackoverflow.com/questions/56874583/vba-code-generates-syntax-error-in-update-statement/56875127#56875127", "title": "vba code generates syntax error in UPDATE statement", "body": "<p>There shouldn't be a comma in the <code>where</code> clause:</p>\n\n<pre><code>\" WHERE LastName= '\" &amp; strLast &amp; \"', AND FirstName= '\" &amp; strFirst &amp; \"'\"\n                                   ^--------------------------------------- Remove this\n</code></pre>\n\n<p>Nor following the last field updated:</p>\n\n<pre><code>Vic6Color = '\" &amp; strColor6 &amp; \"',\" &amp; \n                               ^------------------------------------------- Remove this\n</code></pre>\n\n<hr>\n\n<p>Also, are all of your fields (<code>Vic#License</code>,  <code>Vic#Make</code>, <code>Vic#Model</code>, <code>Vic#Year</code>  etc.) all string-valued fields? If not, you should also remove the single-quotes surrounding the values populating those fields which are not string-valued, e.g.:</p>\n\n<pre><code>Vic1Year ='\" &amp; strYear1 &amp; \"',\n</code></pre>\n\n<p>Becomes:</p>\n\n<pre><code>Vic1Year =\" &amp; strYear1 &amp; \",\n</code></pre>\n\n<hr>\n\n<p>However, whilst the above addresses the syntax issues with your code, in general, I would strongly suggest avoiding building SQL queries using concatenated variable values for two reasons:</p>\n\n<ul>\n<li><p>The values must be converted to strings representing the true field value.</p></li>\n<li><p>If the user is supplying the variable values, you have no control over the content of the resulting SQL query, which may be subject to SQL injection. </p></li>\n</ul>\n\n<p>Instead, I would suggest <a href=\"https://stackoverflow.com/q/49509615/7531598\">parameterising your query</a> which avoids both of the above.</p>\n\n<hr>\n\n<p>I also completely agree with the comments made by <em>@ComputerVersteher</em>: incrementally named fields are a clear indication of poor database design and lack of <a href=\"https://support.microsoft.com/en-gb/help/283878/description-of-the-database-normalization-basics\" rel=\"nofollow noreferrer\">database normalisation</a>.</p>\n\n<p>Assuming that your database descibes vehicle ownership, I would personally suggest three tables:</p>\n\n<h3>Owners</h3>\n\n<pre><code>+--------------+\n| OwnerID (PK) |\n| FirstName    |\n| LastName     |\n+--------------+\n</code></pre>\n\n<h3>Vehicles</h3>\n\n<pre><code>+----------------+\n| VehicleID (PK) |\n| Make           |\n| Model          |\n| Plate          |\n| Year           |\n| Color          |\n+----------------+\n</code></pre>\n\n<h3>Vehicle-Owners (Junction Table)</h3>\n\n<pre><code>+----------------+\n| ID (PK)        |\n| OwnerID (FK)   |\n| VehicleID (FK) |\n+----------------+\n</code></pre>\n\n<p>Here, I have assigned a separate primary key field in the Vehicle-Owners junction table which allows for a vehicle to be owned by multiple owners simultaneously (if you want to permit such a scenario); otherwise, you could form the primary key from the combination of the <code>OwnerID</code> &amp; <code>VehicleID</code> to enforce a single ownership of a vehicle.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 11688898, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ImvRQivwOCc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRuzQ_Vt8bIzr2jIJappTT3Qj2vg/mo/photo.jpg?sz=128", "display_name": "Bryan Clinkenbeard", "link": "https://stackoverflow.com/users/11688898/bryan-clinkenbeard"}, "is_accepted": true, "score": -1, "last_activity_date": 1562182785, "creation_date": 1562182785, "answer_id": 56876933, "question_id": 56874583, "link": "https://stackoverflow.com/questions/56874583/vba-code-generates-syntax-error-in-update-statement/56876933#56876933", "title": "vba code generates syntax error in UPDATE statement", "body": "<p>I found my error.  There is a comma after the last record <code>strColor6 &amp; \"',\"</code>Once I removed it, the error went away.</p>\n"}], "owner": {"reputation": 23, "user_id": 11688898, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ImvRQivwOCc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reRuzQ_Vt8bIzr2jIJappTT3Qj2vg/mo/photo.jpg?sz=128", "display_name": "Bryan Clinkenbeard", "link": "https://stackoverflow.com/users/11688898/bryan-clinkenbeard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 56876933, "answer_count": 2, "score": 0, "last_activity_date": 1594639782, "creation_date": 1562171567, "last_edit_date": 1594639782, "question_id": 56874583, "link": "https://stackoverflow.com/questions/56874583/vba-code-generates-syntax-error-in-update-statement", "title": "vba code generates syntax error in UPDATE statement", "body": "<p>I have the following code on a button click and it generates the 3144 Syntax Error in UPDATE statement.  I can't seem to find the error causing factor.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>strUpdate = \"Update VehicleInfo SET \" &amp; _\n\"Vic1License ='\" &amp; strPlate1 &amp; \"', Vic1Make ='\" &amp; strMake1 &amp; \"', Vic1Model ='\" &amp; strModel1 &amp; \"', Vic1Year ='\" &amp; strYear1 &amp; \"', Vic1Color = '\" &amp; strColor1 &amp; \"',\" &amp; _\n\"Vic2License ='\" &amp; strPlate2 &amp; \"', Vic2Make ='\" &amp; strMake2 &amp; \"', Vic2Model ='\" &amp; strModel2 &amp; \"', Vic2Year ='\" &amp; strYear2 &amp; \"', Vic2Color = '\" &amp; strColor2 &amp; \"',\" &amp; _\n\"Vic3License ='\" &amp; strPlate3 &amp; \"', Vic3Make ='\" &amp; strMake3 &amp; \"', Vic3Model ='\" &amp; strModel3 &amp; \"', Vic3Year ='\" &amp; strYear3 &amp; \"', Vic3Color = '\" &amp; strColor3 &amp; \"',\" &amp; _\n\"Vic4License ='\" &amp; strPlate4 &amp; \"', Vic4Make ='\" &amp; strMake4 &amp; \"', Vic4Model ='\" &amp; strModel4 &amp; \"', Vic4Year ='\" &amp; strYear4 &amp; \"', Vic4Color = '\" &amp; strColor4 &amp; \"',\" &amp; _\n\"Vic5License ='\" &amp; strPlate5 &amp; \"', Vic5Make ='\" &amp; strMake5 &amp; \"', Vic5Model ='\" &amp; strModel5 &amp; \"', Vic5Year ='\" &amp; strYear5 &amp; \"', Vic5Color = '\" &amp; strColor5 &amp; \"',\" &amp; _\n\"Vic6License ='\" &amp; strPlate6 &amp; \"', Vic6Make ='\" &amp; strMake6 &amp; \"', Vic6Model ='\" &amp; strModel6 &amp; \"', Vic6Year ='\" &amp; strYear6 &amp; \"', Vic6Color = '\" &amp; strColor6 &amp; \"',\" &amp; _\n\" WHERE LastName= '\" &amp; strLast &amp; \"', AND FirstName= '\" &amp; strFirst &amp; \"'\"\n\nDoCmd.RunSQL strUpdate\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "internet-explorer"], "comments": [{"owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "reply_to_user": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "edited": false, "score": 0, "creation_date": 1562172953, "post_id": 56874516, "comment_id": 100298160, "body": "I already inserted element.Click @arunv. Sorry i did not really understand what do you mean"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "edited": false, "score": 0, "creation_date": 1562174526, "post_id": 56875110, "comment_id": 100298873, "body": "I cannot use the javascript javascript:openExcelFile(&#39;t83_Kerrfinancialadvisorsinc/455X3&zwnj;&#8203;/ExportActivity_6626&zwnj;&#8203;02308201907031220021&zwnj;&#8203;39.xlsx  because it is not statc. Everyday a new file is generated so a new &quot;Completed&quot; button will appear on that page, with another ajavascript sentence @arunv"}, {"owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "edited": false, "score": 0, "creation_date": 1562174638, "post_id": 56875110, "comment_id": 100298921, "body": "I think i am not correctly accessing the wanted elements using  getElementsByTagName(&quot;main_table_data_right_border main_table_data_bottom_border&quot;)(5) Do you know how to fix this ? Or expose another piece of code that would click on the first &quot;Completed&quot; word in this page?"}, {"owner": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "reply_to_user": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "edited": false, "score": 0, "creation_date": 1562174894, "post_id": 56875110, "comment_id": 100299047, "body": "then you can first extract the script name from webpage table using  &#39; .Innertext &#39; and then navigate that script or try using fire event method, if possible please share the url of webpage its hard to suggest without seeing that"}, {"owner": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "reply_to_user": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "edited": false, "score": 0, "creation_date": 1562175336, "post_id": 56875110, "comment_id": 100299249, "body": "Try using <code>debug.print  ie3.getelementbyId(&quot;idname&quot;).getElementsByTagName(&quot;tr&quot;)(inde&zwnj;&#8203;x count).getElementsByTagName(&quot;td&quot;)(index).innertext</code>  or with different combinations to get &quot;completed&quot; text in immediate window you can self explore by trial and error"}, {"owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "edited": false, "score": 0, "creation_date": 1562176386, "post_id": 56875110, "comment_id": 100299690, "body": "I really appreciate your efforts but i am very new to VBA and i know nothing about javasript so i will not be able to figure this out by my own... I hope you understand. Can you give me more details about doing that or just type ou tthe sentence that has to be added to my code? I would be very thankfull"}], "tags": [], "owner": {"reputation": 854, "user_id": 8627190, "user_type": "registered", "accept_rate": 20, "profile_image": "https://lh4.googleusercontent.com/-hd407nZxwg8/AAAAAAAAAAI/AAAAAAAAAH0/lNmbHUGy5to/photo.jpg?sz=128", "display_name": "arun v", "link": "https://stackoverflow.com/users/8627190/arun-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1562174015, "creation_date": 1562174015, "answer_id": 56875110, "question_id": 56874516, "link": "https://stackoverflow.com/questions/56874516/how-to-click-on-a-button-on-a-webpage-using-td-and-tr/56875110#56875110", "title": "How to click on a button on a webpage using &lt;td&gt; and &lt;tr&gt;?", "body": "<p>Here, once you click on completed hyperlink java script gets executed and it opens a excel file, here you can use <code>ie3.Navigate \"javascript:openExcelFile('t83_Kerrfinancialadvisorsinc/455X3/ExportActivity_66260230820190703122002139.xlsx)\"</code></p>\n\n<p>since its tied with hyperlink you can also try using</p>\n\n<pre><code>element.Click\nelement.FireEvent (\"onclick\") \n</code></pre>\n\n<p>or you can use execscript</p>\n\n<pre><code>Call ie3.document.parentWindow.execScript(\"your script in webpage\", \"JavaScript\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10390, "user_id": 7062291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17ca0ff9016cfdb9352adaf4435737d6?s=128&d=identicon&r=PG&f=1", "display_name": "Zhi Lv", "link": "https://stackoverflow.com/users/7062291/zhi-lv"}, "is_accepted": false, "score": 1, "last_activity_date": 1562232521, "creation_date": 1562232521, "answer_id": 56884816, "question_id": 56874516, "link": "https://stackoverflow.com/questions/56874516/how-to-click-on-a-button-on-a-webpage-using-td-and-tr/56884816#56884816", "title": "How to click on a button on a webpage using &lt;td&gt; and &lt;tr&gt;?", "body": "<p>You could use the getElementsByTagName method to find the hyperlink. Please refer to the following sample:</p>\n\n<p>VBA code to find the hyperlink and click the button (in this sample, I just find the special cell in the first row, if you want to loop through the hyperlink, you need to use For Each statement to loop through the array).</p>\n\n<pre><code>Sub Test()\n    Dim ie As Object\n    Dim Rank As Object\n    Set ie = CreateObject(\"InternetExplorer.application\")\n    ie.Visible = True\n    ie.Navigate (\"http://localhost:54382/HtmlPage47.html\")\n    Do\n        If ie.ReadyState = 4 Then\n            Exit Do\n        Else\n        End If\n    Loop\n\n    Set doc = ie.document\n\n    doc.getElementsByTagName(\"tr\")(1).getElementsByTagName(\"td\")(5).getElementsByTagName(\"a\")(0).Click\n\nEnd Sub\n</code></pre>\n\n<p>Code in the web page:</p>\n\n<pre><code>&lt;div&gt;\n    &lt;table class=\"main_table\" style=\"text-align:center;\"&gt;\n        &lt;tr class=\"main_table_header\"&gt;\n            &lt;td&gt;&lt;/td&gt;\n            &lt;td&gt;Export Type&lt;/td&gt;\n            &lt;td&gt;Criteria&lt;/td&gt;\n            &lt;td&gt;Rep./List&lt;/td&gt;\n            &lt;td&gt;Creation Date&lt;/td&gt;\n            &lt;td&gt;Status&lt;/td&gt;\n            &lt;td&gt;Reference&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr class=\"main_table_data\"&gt;\n            &lt;td&gt;\n                &lt;input id=\"Checkbox1\" type=\"checkbox\" /&gt;\n            &lt;/td&gt;\n            &lt;td&gt;Activites&lt;/td&gt;\n            &lt;td&gt;Process Date from 2019/07/02 to 2019/07/02&lt;/td&gt;\n            &lt;td&gt;For an advanced search&lt;/td&gt;\n            &lt;td&gt;2019/07/03&lt;/td&gt;\n            &lt;td&gt;&lt;a onclick=\"javascript:alert('hello AA')\" id=\"link1\" href=\"#\"&gt;Conpleted&lt;/a&gt; (601 lines)&lt;/td&gt;\n            &lt;td&gt;662602308&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr class=\"main_table_data\"&gt;\n            &lt;td&gt;\n                &lt;input id=\"Checkbox1\" type=\"checkbox\" /&gt;\n            &lt;/td&gt;\n            &lt;td&gt;Activites&lt;/td&gt;\n            &lt;td&gt;Process Date from 2019/07/02 to 2019/07/02&lt;/td&gt;\n            &lt;td&gt;For an advanced search&lt;/td&gt;\n            &lt;td&gt;2019/07/03&lt;/td&gt;\n            &lt;td&gt;&lt;a onclick=\"javascript:alert('hello BB')\" href=\"#\"&gt;Conpleted&lt;/a&gt; (601 lines)&lt;/td&gt;\n            &lt;td&gt;662602308&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr class=\"main_table_data\"&gt;\n            &lt;td&gt;\n                &lt;input id=\"Checkbox1\" type=\"checkbox\" /&gt;\n            &lt;/td&gt;\n            &lt;td&gt;Activites&lt;/td&gt;\n            &lt;td&gt;Process Date from 2019/07/02 to 2019/07/02&lt;/td&gt;\n            &lt;td&gt;For an advanced search&lt;/td&gt;\n            &lt;td&gt;2019/07/03&lt;/td&gt;\n            &lt;td&gt;&lt;a onclick=\"javascript:alert('hello CC')\" href=\"#\"&gt;Conpleted&lt;/a&gt; (601 lines)&lt;/td&gt;\n            &lt;td&gt;662602308&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr class=\"main_table_data\"&gt;\n            &lt;td&gt;\n                &lt;input id=\"Checkbox1\" type=\"checkbox\" /&gt;\n            &lt;/td&gt;\n            &lt;td&gt;Activites&lt;/td&gt;\n            &lt;td&gt;Process Date from 2019/07/02 to 2019/07/02&lt;/td&gt;\n            &lt;td&gt;For an advanced search&lt;/td&gt;\n            &lt;td&gt;2019/07/03&lt;/td&gt;\n            &lt;td&gt;&lt;a onclick=\"javascript:alert('hello DD')\" href=\"#\"&gt;Conpleted&lt;/a&gt; (601 lines)&lt;/td&gt;\n            &lt;td&gt;662602308&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>The result like this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SN77H.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SN77H.gif\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1562849502, "creation_date": 1562849502, "answer_id": 56989677, "question_id": 56874516, "link": "https://stackoverflow.com/questions/56874516/how-to-click-on-a-button-on-a-webpage-using-td-and-tr/56989677#56989677", "title": "How to click on a button on a webpage using &lt;td&gt; and &lt;tr&gt;?", "body": "<p>I see you are a bit confused as to how to access HTML elements, so I'll take this opportunity to demonstrate the logic of doing so in a very detailed manner, which I also believe to be very intuitive. There are other ways to do it, but I believe the following one is the most comprehensive and intuitive one and ideal for a beginner.</p>\n\n<p>Firstly, I will go ahead and assume that <code>ie3</code> is an <code>InternetExplorer</code> object. </p>\n\n<p>When you use this object to navigate to a page, you can access the html of that page by using the <code>ie3.document</code>, which holds an <code>HTML document</code> object.</p>\n\n<p>To take full advantage of the <code>HTML document</code> object you should add a reference to the <code>Microsoft HTML Object Library</code>. This Library will allow you to use a number of HTML elements which make your life easier. </p>\n\n<p>In your case, the elements you want to be able to access are </p>\n\n<ol>\n<li>HTML tables and their rows and cells</li>\n<li>HTML anchor elements ()</li>\n</ol>\n\n<p>So my declarations would be the following:</p>\n\n<pre><code>Dim ie3 As New InternetExplorer 'To be used to navigate to the page of interest\nDim doc As HTMLDocument 'this will hold the HTML document corresponding to the page\nDim toBeClicked As HTMLAnchorElement 'To be used to store the &lt;a&gt;&lt;/a&gt; element\nDim table As HTMLTable 'To be used to store the table element\nDim tableRow As HTMLTableRow 'To be used to store a row of the table element\nDim tableCell As HTMLTableCell 'To be used to store a cellof the table element\n</code></pre>\n\n<p>Assuming that you have already used the <code>ie3</code> to navigate to the website of interest, you can store it's HTML document in <code>doc</code> like so:</p>\n\n<pre><code>Set doc = ie3.document\n</code></pre>\n\n<p>Once you have access to the HTML document of the webpage, you can also get access to its elements in a number of ways, some more targeted than others. Below I am demonstrating the most common methods to do that, using the table element as an example.</p>\n\n<ol>\n<li><p>If the table has a unique ID, you can get access to it by using the <code>.getElementById()</code> method. This method returns a single element. In your case, the table you're after, doesn't have an ID.</p></li>\n<li><p>If the table belongs to a class, you can get access to it by using the <code>.getElementsByClassName()</code> method. This method returns a <strong>collection</strong> of elements, all of which belong to the same class. To get access to a member of this collection you can use a <code>(item index)</code> kind of notation. The first member has an index of <code>0</code>. In your case the table belongs to class <code>\"advancedSearch_table\"</code>, which happens to only have one member.</p></li>\n<li>If there's no class or ID you can use the <code>.getElementsByTagName</code> method. This method returns a <strong>collection</strong> of all the elements who have the same tag. In your case you would need all the tables in the document. To get access to a member of this collection you can use a <code>(item index)</code> kind of notation. The first member has an index of <code>0</code>. Tags in HTML look like so <code>&lt;tagName attribute=\"something\"&gt;Something&lt;/tagName&gt;</code>. </li>\n</ol>\n\n<p>Below I demonstrate all three methods. You can use either one of the first two:</p>\n\n<pre><code>Set table = doc.getElementsByClassName(\"advancedSearch_table\")(0)\nSet table = doc.getElementsByTagName(\"table\")(0)\nSet table = doc.getElementById(\"ID of the table\") 'only for demostration purposes, it doesn't apply to your case, as the table has no ID.\n</code></pre>\n\n<p>Keep in mind that in your case, there is only one table in the document and there's only one element that belongs to the class <code>\"advancedSearch_table\"</code>. This means that you need the first element of the corresponding collections. That's why I use <code>0</code> as index.</p>\n\n<p>By the same logic as above, now that the table has been stored, you can get access to its rows and cells. More specifically, you need the 5th cell of the 4th row. That's where the link that you want to click is:</p>\n\n<pre><code>Set tableRow = table.getElementsByTagName(\"tr\")(3)\nSet tableCell = tableRow.getElementsByTagName(\"td\")(4)\n</code></pre>\n\n<p>Finally, now that the cell of interest has been stored, you can access the anchor element and click it. Again, there's only one anchor element in the cell, so it's going to be the first one in the corresponding collection:</p>\n\n<pre><code>Set toBeClicked = tableCell.getElementsByTagName(\"a\")(0)\ntoBeClicked.Click\n</code></pre>\n\n<p><strong>BONUS</strong></p>\n\n<p>If you want to click on all the \"Completed\" links, one by one, you need to loop through the corresponding elements. Here'w two ways to do it:</p>\n\n<p>Click on the anchor in the 5th cell of each row: </p>\n\n<pre><code>For Each tableRow In table.Rows\n    Set toBeClicked = tableRow.getElementsByTagName(\"td\")(4).getElementsByTagName(\"a\")(0)\n    toBeClicked.Click\nNext tableRow\n</code></pre>\n\n<p>Loop through all rows and though all cells of the table, find the inner text that you're looking for and click the corresponding anchor:</p>\n\n<pre><code>For Each tableRow In table.Rows\n    For Each tableCell In tableRow.Cells\n        If tableCell.innerText = \"Something\" Then\n            Set toBeClicked = tableCell.getElementsByTagName(\"a\")(0)\n            toBeClicked.Click\n    Next tableCell\nNext tableRow\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 11563365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b2a6fa7d4d493cf720f17567c3b9eaa2?s=128&d=identicon&r=PG&f=1", "display_name": "Celine N", "link": "https://stackoverflow.com/users/11563365/celine-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1562849502, "creation_date": 1562171293, "question_id": 56874516, "link": "https://stackoverflow.com/questions/56874516/how-to-click-on-a-button-on-a-webpage-using-td-and-tr", "title": "How to click on a button on a webpage using &lt;td&gt; and &lt;tr&gt;?", "body": "<p>I am trying to click o the first \"Completed\" button in the highlighted part of the webpage below.\n<a href=\"https://i.stack.imgur.com/o4LAL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o4LAL.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is a piece of the vba code of the website page: \n<a href=\"https://i.stack.imgur.com/dYSRy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dYSRy.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried to click on the <strong>FIRST</strong> completed button in many different ways such as : </p>\n\n<pre><code>    For Each element In ie3.getElementsByTagName(\"main_table_data_right_border main_table_data_bottom_border\")(5)\n  If element.innerText = \"Completed\" Then\n  ' Application.Wait (Now + TimeValue(\"0:03:00\"))\n    element.Click\n     Application.Wait (Now + TimeValue(\"0:00:20\"))\n      Exit For\n        Else\n    End If\nNext\n</code></pre>\n\n<p>Or </p>\n\n<pre><code>doc.querySelector(\"#divPage &gt; table.advancedSearch_table &gt; tbody\"). _ getElementsByTagName(\"tr\")(3).getElementsByTagName(\"td\")(5).Children(0).Click\n</code></pre>\n\n<p>But none of them seem to work. When i debug the code and i go through this part and this particular line, nothing really happens. So the button is not being clicked. </p>\n\n<p>Can anyone help me with that? </p>\n\n<p>Thanks a lot! :) </p>\n"}, {"tags": ["excel", "vba", "shell"], "answers": [{"comments": [{"owner": {"reputation": 430, "user_id": 8322075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1525dfaae144b4cdc881a33c52e30abd?s=128&d=identicon&r=PG&f=1", "display_name": "taurus", "link": "https://stackoverflow.com/users/8322075/taurus"}, "edited": false, "score": 0, "creation_date": 1562266065, "post_id": 56876587, "comment_id": 100332573, "body": "Is this code for a .command or .bat file or VBA? When I enter it into VBA, I get an error."}, {"owner": {"reputation": 866, "user_id": 2369578, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/04d155541a5894443dc2a57d9c8ecc23?s=128&d=identicon&r=PG", "display_name": "Yogamurthy", "link": "https://stackoverflow.com/users/2369578/yogamurthy"}, "edited": false, "score": 0, "creation_date": 1562355363, "post_id": 56876587, "comment_id": 100361400, "body": "This is for shell as you asked."}], "tags": [], "owner": {"reputation": 470, "user_id": 11460314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6acd5a9514a859bf89474e8ca9392b3?s=128&d=identicon&r=PG&f=1", "display_name": "yoga", "link": "https://stackoverflow.com/users/11460314/yoga"}, "is_accepted": false, "score": 0, "last_activity_date": 1562181035, "creation_date": 1562181035, "answer_id": 56876587, "question_id": 56874500, "link": "https://stackoverflow.com/questions/56874500/feasibility-of-running-jar-with-vba-and-excel/56876587#56876587", "title": "Feasibility of Running .jar with VBA and Excel", "body": "<p>is this what you are looking for :</p>\n\n<pre><code>#!/bin/bash\n\"$JAVA_HOME\"/bin/java -jar /root/jeevee/bin/deploy.jar\n</code></pre>\n"}], "owner": {"reputation": 430, "user_id": 8322075, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1525dfaae144b4cdc881a33c52e30abd?s=128&d=identicon&r=PG&f=1", "display_name": "taurus", "link": "https://stackoverflow.com/users/8322075/taurus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562181035, "creation_date": 1562171212, "question_id": 56874500, "link": "https://stackoverflow.com/questions/56874500/feasibility-of-running-jar-with-vba-and-excel", "title": "Feasibility of Running .jar with VBA and Excel", "body": "<p>I have a .jar file which I want to run from an Excel sheet using VBA. Ideally, this could be done on both Windows and Mac with only one set of code. </p>\n\n<p>To run the .jar file, I call it from the command line/terminal with <code>java -cp somejar.jar outputResults/something</code>. Then, I enter a String through the command line to specify the starting user in my simulation. Finally, I enter either 0 or 1 to specify the type of function used. After this a results file is generated. </p>\n\n<p>It seems this <a href=\"https://stackoverflow.com/questions/17956651/execute-a-command-in-command-prompt-using-excel-vba\">may be possible</a> with Shell, but the linked example only provides an example for a single line entered, not multiple. Is this feasible and, if so, can someone point me towards an example?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1562179753, "post_id": 56874351, "comment_id": 100301158, "body": "Why not just use a pivot table?"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562218412, "post_id": 56876967, "comment_id": 100310333, "body": "You should declare row counting variables as <code>Long</code>. Excel has more rows than fit into <code>Integer</code>. Also there is no benefit in using <code>Integer</code> in VBA at all so you can always use <code>Long</code> instead."}, {"owner": {"reputation": 5, "user_id": 11735192, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hLhtwqj9NKs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3req9kofTTfvLLUdnBXtD8_X-fD0Hg/photo.jpg?sz=128", "display_name": "Viktor Rst", "link": "https://stackoverflow.com/users/11735192/viktor-rst"}, "edited": false, "score": 0, "creation_date": 1562243459, "post_id": 56876967, "comment_id": 100322961, "body": "Ok thank you very much! I managed to adapt the code to my needs."}, {"owner": {"reputation": 14, "user_id": 10664732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/brcCh.jpg?s=128&g=1", "display_name": "bejo", "link": "https://stackoverflow.com/users/10664732/bejo"}, "edited": false, "score": 0, "creation_date": 1562307693, "post_id": 56876967, "comment_id": 100340676, "body": "Since the maximum rows in this case are supposed to be 3000, the integer type should be sufficient. I did not know, that there is no benefit to using integers instead of longs. I would assume, that the macro uses less memory when using integers. This would be a tiny benefit. Or is the memory usage the same and the performance less?"}], "tags": [], "owner": {"reputation": 14, "user_id": 10664732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/brcCh.jpg?s=128&g=1", "display_name": "bejo", "link": "https://stackoverflow.com/users/10664732/bejo"}, "is_accepted": true, "score": 0, "last_activity_date": 1562307324, "last_edit_date": 1562307324, "creation_date": 1562182935, "answer_id": 56876967, "question_id": 56874351, "link": "https://stackoverflow.com/questions/56874351/combine-rows-with-duplicates-and-then-remove-row/56876967#56876967", "title": "Combine rows with duplicates and then remove row", "body": "<p>Stackoverflow is not supposed to be a platform where people solve your problems. You should try it by yourself and ask for help, if things do not work out. You can use a macro and loop over all of your entries. It is hard to explain what you would have to do, other then in code. </p>\n\n<p>Try to understand this piece of code and adopt it to your needs: </p>\n\n<pre><code>Option Explicit\n\nSub cleanDuplicateIDs()\n\nDim startrow As Integer\nDim IDcolumn As Integer\n\nstartrow = 2\nIDcolumn = 3\n\nDim i As Integer\nDim j As Integer\n\nDim amount As Integer\nDim aktID As String\n\ni = startrow\nWhile Cells(i, IDcolumn) &lt;&gt; \"\"\n    aktID = Cells(i, IDcolumn)\n    amount = Cells(i, IDcolumn + 1)\n    j = i + 1\n    While Cells(j, IDcolumn) &lt;&gt; \"\"\n        If Cells(j, IDcolumn) = aktID Then\n            amount = amount + Cells(j, IDcolumn + 1)\n            Rows(j).Delete\n        Else\n            j = j + 1\n        End If\n    Wend\n    Cells(i, IDcolumn + 1) = amount\n    i = i + 1\nWend\n\nEnd Sub\n</code></pre>\n\n<p>I am sure, you can solve your problem with something like this. </p>\n"}], "owner": {"reputation": 5, "user_id": 11735192, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-hLhtwqj9NKs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3req9kofTTfvLLUdnBXtD8_X-fD0Hg/photo.jpg?sz=128", "display_name": "Viktor Rst", "link": "https://stackoverflow.com/users/11735192/viktor-rst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1562186959, "accepted_answer_id": 56876967, "answer_count": 1, "score": -1, "last_activity_date": 1562307324, "creation_date": 1562170612, "last_edit_date": 1562218306, "question_id": 56874351, "link": "https://stackoverflow.com/questions/56874351/combine-rows-with-duplicates-and-then-remove-row", "closed_reason": "Needs more focus", "title": "Combine rows with duplicates and then remove row", "body": "<p>I've created an excel file that creates an order list for furniture. The list can be anywhere from 100 rows to 3000 rows long depending on the size of the order.</p>\n\n<p>My problem is that the data that creates the order list includes alot of duplicates as shown in the picture.</p>\n\n<p>What I would need help with is to create a macro that takes all matching id numbers and combine it into one row where the quantity is combined. The list price will be the same and the total price is a function taken from quantity*listprice.</p>\n\n<p><a href=\"https://i.stack.imgur.com/w6XOE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w6XOE.png\" alt=\"img1\"></a></p>\n\n<p>I'm aware that there is several posts regarding problems like mine but i have not managed to find a sulution. I'm not that experienced with coding so would appreciate all help I can get!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562170089, "post_id": 56874162, "comment_id": 100296785, "body": "Is this a different question from your <a href=\"https://stackoverflow.com/q/56871546/9245853\">previous one</a>?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1562172960, "post_id": 56874162, "comment_id": 100298164, "body": "You need to modify this line <code>For Each cell In Sheet2.Range(&quot;O&quot; &amp; ActiveCell.Row)</code> to the full range you want to loop through"}, {"owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1562173102, "post_id": 56874162, "comment_id": 100298235, "body": "@GMalc doing so creates an individual email for EACH of the cells. Like I said, I need them all to be sent one email..."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1562173826, "post_id": 56874162, "comment_id": 100298581, "body": "There are multiple ways to accomplish this. You can loop through each cell in the first column, then use an IF/OR statement to test all three cells in the current row for an email address."}, {"owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1562175353, "post_id": 56874162, "comment_id": 100299262, "body": "@GMalc not sure what you mean but lets say I change it to:   <code>For Each cell In Sheet2.Range(&quot;O&quot; &amp; ActiveCell, &quot;S&quot; &amp; ActiveCell.Row) If cell.Value Like &quot;?*@?*.?*&quot; Then</code>  this gives me an email for each value"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1562184246, "post_id": 56874162, "comment_id": 100302983, "body": "Is saw you add a question to my answer concerning an error, it is gone, do you need any more help."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "edited": false, "score": 0, "creation_date": 1562184569, "post_id": 56876670, "comment_id": 100303090, "body": "I tried adding the code and after running the userform that triggers the email code and nothing seems to happen"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1562184049, "last_edit_date": 1562184049, "creation_date": 1562181353, "answer_id": 56876670, "question_id": 56874162, "link": "https://stackoverflow.com/questions/56874162/send-email-to-email-address-in-cell-if-any/56876670#56876670", "title": "Send email to email address in cell, if any", "body": "<p>Loop through each cell in <code>column O</code>, and test all three cells for an email, when it encounters an email it will execute the rest of the code, and exit the inner loop.</p>\n\n<pre><code>Dim cel As Range, lRow As Long, x As Long\nlRow = ActiveSheet.Cells(Rows.Count, 15).End(xlUp).Row\n\n    For Each cel In Range(\"O2:O\" &amp; lRow)\n        For x = 15 To 19 Step 2 'loop through each cell in the active row\n\n            If Cells(cel.Row, x).Value Like \"?*@?*.?*\" Then\n                'email .To = Cells(cel.Row, x).Value\n                Exit For 'exits the inner loop when the condition is met\n            End If\n\n        Next x\n\n    Next cel\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1609189146, "creation_date": 1562169906, "last_edit_date": 1609189146, "question_id": 56874162, "link": "https://stackoverflow.com/questions/56874162/send-email-to-email-address-in-cell-if-any", "title": "Send email to email address in cell, if any", "body": "<p>I have three columns(&quot;O&quot;, &quot;Q&quot;, &quot;S&quot;) that use VLOOKUP to get the email address from people's names input. I want these people to all be emailed one email with some details.</p>\n<p>I don't want this code to run if there are no email values in any of the three columns. I'd like the code to run if any of the three columns has an email address.</p>\n<p>This code checks if a cell contains an email address and then sends that email address an email. I need this for all three of the cells &amp; I need them to all be emailed together.</p>\n<pre><code>If emailbox.Value = True Then\n\n    On Error Resume Next\n    i = ActiveCell.Row                  'VLOOKUP\n    Sheet2.Cells(i, 15).Value = Application.WorksheetFunction.VLookup(Sheet2.Cells(i, 14).Value, Sheet3.Range(&quot;AMS&quot;), 2, 0)\n\n    On Error Resume Next\n    i = ActiveCell.Row                  'VLOOKUP\n    Sheet2.Cells(i, 17).Value = Application.WorksheetFunction.VLookup(Sheet2.Cells(i, 16).Value, Sheet3.Range(&quot;AQE&quot;), 2, 0)\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim cell As Range\n\n    Application.ScreenUpdating = False\n    Set OutApp = CreateObject(&quot;Outlook.Application&quot;)\n\n    On Error GoTo cleanup\n\n    For Each cell In Sheet2.Range(&quot;O&quot; &amp; ActiveCell.Row)\n        If cell.Value Like &quot;?*@?*.?*&quot; Then 'Check cell for email address\n\n            Set OutMail = OutApp.CreateItem(0)\n\n            With OutMail\n                .To = cell.Value\n                .Subject = &quot;SUBJECT&quot;\n                .Body = &quot;Dear....&quot;\n                .Display\n            End With\n            On Error GoTo 0\n            Set OutMail = Nothing\n\n            sent.Visible = True\n            Else\n        End If\n    Next cell\n\ncleanup:\n    Set OutApp = Nothing\n    Application.ScreenUpdating = True\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "outlook", "outlook-filter"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1562186481, "post_id": 56873607, "comment_id": 100303828, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/30464271/11683\">Find an email starting with specific subject using VBA</a>"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1562189661, "post_id": 56873607, "comment_id": 100305007, "body": "You are missing &quot;@SQL=&quot; prefix"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11735295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vwrTMPfL-88/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfChpXRIqu9asGG2dEbupDZ3dvKMQ/photo.jpg?sz=128", "display_name": "Matthew Dallow", "link": "https://stackoverflow.com/users/11735295/matthew-dallow"}, "edited": false, "score": 0, "creation_date": 1562231934, "post_id": 56877866, "comment_id": 100316564, "body": "Thank you! I&#39;m not really familiar with SQL. Sorry to be a pain but If I also wanted to filter by the systems current date so that it only takes today&#39;s emails, how would I go about doing that / learning to do that"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 13, "user_id": 11735295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vwrTMPfL-88/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfChpXRIqu9asGG2dEbupDZ3dvKMQ/photo.jpg?sz=128", "display_name": "Matthew Dallow", "link": "https://stackoverflow.com/users/11735295/matthew-dallow"}, "edited": false, "score": 0, "creation_date": 1562232458, "post_id": 56877866, "comment_id": 100316895, "body": "See <a href=\"https://docs.microsoft.com/en-us/office/vba/outlook/how-to/search-and-filter/filtering\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/outlook/how-to/&hellip;</a>"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": true, "score": 0, "last_activity_date": 1562187678, "creation_date": 1562187678, "answer_id": 56877866, "question_id": 56873607, "link": "https://stackoverflow.com/questions/56873607/item-restrict-function-doesnt-work-when-using-like-instead-of/56877866#56877866", "title": "Item.Restrict Function doesn&#39;t work when using like instead of =", "body": "<p>Try to use the following code instead:</p>\n\n<pre><code>criteria = \"@SQL=\" &amp; Chr(34) &amp; \"urn:schemas:httpmail:subject\" &amp; Chr(34) &amp; \" like '\" &amp; PrefixName &amp; \"%'\" \nSet oOlInbFiltered = oOlInb.Items.Restrict(criteria)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11735295, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-vwrTMPfL-88/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfChpXRIqu9asGG2dEbupDZ3dvKMQ/photo.jpg?sz=128", "display_name": "Matthew Dallow", "link": "https://stackoverflow.com/users/11735295/matthew-dallow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 56877866, "answer_count": 1, "score": 1, "last_activity_date": 1591162898, "creation_date": 1562168030, "last_edit_date": 1591162898, "question_id": 56873607, "link": "https://stackoverflow.com/questions/56873607/item-restrict-function-doesnt-work-when-using-like-instead-of", "title": "Item.Restrict Function doesn&#39;t work when using like instead of =", "body": "<p>I'm creating a macro that pulls e-mail attachments into a folder to be opened and copied, which works 100% perfect when the subject name is predefined, i.e. never changes.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' this works\nSet oOlInbFiltered = oOlInb.Items.Restrict(\"[Subject] = \" &amp; SubjectName)\n</code></pre>\n\n<p>However, when I try to instead restrict for a preset beginning, say every email begins with 'aaaaa', it causes an automation error with the code below:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>' this doesnt\nSet oOlInbFiltered = oOlInb.Items.Restrict(\"[Subject] like '\" &amp; PrefixName &amp; \"%'\")\n</code></pre>\n\n<p>Any help?</p>\n\n<p>Expected results: No error message, files in folder. Instead I receive</p>\n\n<blockquote>\n  <p>Run-time error '-2147352567 (800200009)': Automation error Exception Occurred.</p>\n</blockquote>\n"}, {"tags": ["sql", "vba", "optional-parameters"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1562167855, "post_id": 56873418, "comment_id": 100295624, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28770412/vba-function-optional-parameters\">VBA Function Optional parameters</a>"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1562168014, "post_id": 56873418, "comment_id": 100295718, "body": "Really, just using google would have been faster: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/understanding-named-arguments-and-optional-arguments\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/concepts/&hellip;</a>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1562168818, "post_id": 56873418, "comment_id": 100296135, "body": "You need to make both parameters optional, because <code>Optional</code> parameters must appear <i>at the end of the paremeter list</i>. That said, asking about a procedure&#39;s signature without even sharing what your procedure&#39;s signature is, is a little short."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562168944, "post_id": 56873418, "comment_id": 100296194, "body": "Wait is this about VBA optional parameters, or query/SQL parameters? If this has nothing to do with SQL, please remove the tag, it makes the post confusing."}, {"owner": {"reputation": 2468, "user_id": 1011722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182b622b9ff2901ba98e3c6af8bc3672?s=128&d=identicon&r=PG", "display_name": "Trevor Reid", "link": "https://stackoverflow.com/users/1011722/trevor-reid"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562169301, "post_id": 56873418, "comment_id": 100296363, "body": "@Mathieu Guindon it seems to be about <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.parameters\" rel=\"nofollow noreferrer\">Parameters for QueryTables in Excel</a> which routinely involve SQL.  Of course, I defer to OP."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2468, "user_id": 1011722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182b622b9ff2901ba98e3c6af8bc3672?s=128&d=identicon&r=PG", "display_name": "Trevor Reid", "link": "https://stackoverflow.com/users/1011722/trevor-reid"}, "edited": false, "score": 0, "creation_date": 1562169474, "post_id": 56873418, "comment_id": 100296447, "body": "@TrevorReid I know it looks like it, but it <i>reads</i> like OP merely used the <code>Parameters.Add</code> method as an example of a function with multiple optional parameters... I initially understood the question exactly as in the below answer, but now I&#39;m not sure any more."}, {"owner": {"reputation": 2468, "user_id": 1011722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/182b622b9ff2901ba98e3c6af8bc3672?s=128&d=identicon&r=PG", "display_name": "Trevor Reid", "link": "https://stackoverflow.com/users/1011722/trevor-reid"}, "edited": false, "score": 0, "creation_date": 1562170827, "post_id": 56873418, "comment_id": 100297126, "body": "I agree it&#39;s confusing.  That wasn&#39;t my reading at first glance, but hopefully we&#39;ll get some help from OP giving OP help :-)"}], "answers": [{"comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1562168214, "post_id": 56873565, "comment_id": 100295828, "body": "You can also leave the &#180;= something&#180; and use &#180;IsMissing()&#180; to check if a value was passed."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1562169448, "post_id": 56873565, "comment_id": 100296433, "body": "@L8n <code>IsMissing</code> will only work with a <code>Variant</code> though"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562170071, "post_id": 56873565, "comment_id": 100296774, "body": "@MathieuGuindon Thanks, good to know, somehow missed that since I usually use it with a variant and &#180;select case&#180; for fake overloading."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1562170138, "post_id": 56873565, "comment_id": 100296811, "body": "@L8n <a href=\"http://rubberduckvba.com/Inspections/Details/IsMissingOnInappropriateArgument\" rel=\"nofollow noreferrer\">Rubberduck</a> would have caught it ;-)"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 1, "creation_date": 1562170161, "post_id": 56873565, "comment_id": 100296823, "body": "Anyway, in this specific case the &#180;= &quot;&quot;&#180; should not be necessary as the default value is &#180;&quot;&quot;&#180; anyway."}], "tags": [], "owner": {"reputation": 111, "user_id": 11682371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6aef3eb1f706c18fff41556dcdbbc31?s=128&d=identicon&r=PG&f=1", "display_name": "dasche", "link": "https://stackoverflow.com/users/11682371/dasche"}, "is_accepted": false, "score": 1, "last_activity_date": 1562167884, "creation_date": 1562167884, "answer_id": 56873565, "question_id": 56873418, "link": "https://stackoverflow.com/questions/56873418/multiple-parameters-not-obligatory/56873565#56873565", "title": "multiple parameters not obligatory", "body": "<p>Optional parameters are defined with the term <code>Optional</code></p>\n\n<p>Example:</p>\n\n<pre><code>Sub DoStuff(requiredParam as String, Optional optParam as String = \"\")\n</code></pre>\n\n<p>Adding in the <code>= \"\"</code> is helpful so you can write out the logic depending on whether a value has been passed in. <code>\"\"</code> is just an example and you should choose a value that isn't liekly to be passed in.</p>\n"}], "owner": {"reputation": 19, "user_id": 11735266, "user_type": "registered", "profile_image": "https://graph.facebook.com/2331378776946261/picture?type=large", "display_name": "Tanya  Kravets", "link": "https://stackoverflow.com/users/11735266/tanya-kravets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562168902, "creation_date": 1562167466, "last_edit_date": 1562168902, "question_id": 56873418, "link": "https://stackoverflow.com/questions/56873418/multiple-parameters-not-obligatory", "title": "multiple parameters not obligatory", "body": "<p>I want to write a code with multiple parameters like this :</p>\n\n<pre><code>Set param1 = qt.Parameters.Add(\"City Parameter\", xlParamTypeVarChar)\n</code></pre>\n\n<p>and be able to use either one parameter or the second. VBA obliged me to have values for both parameters, but I want to have one obligatory parameter and others optional. What should I add to the code?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1562166705, "post_id": 56873171, "comment_id": 100295011, "body": "Try <code>For Each r In Range(&quot;$A$1:$C$10&quot;)</code> or use the intersection between <code>Range(&quot;$A$1:$C$10&quot;)</code> and <code>Target</code> (not sure which one you want)"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562167034, "post_id": 56873171, "comment_id": 100295173, "body": "you want to use <code>For Each r in Intersect([A1:C10], Target)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 188, "user_id": 11704579, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Vn_cqZjZALg/AAAAAAAAAAI/AAAAAAAAAMo/vbdnejNIDM8/photo.jpg?sz=128", "display_name": "Roman Voronov", "link": "https://stackoverflow.com/users/11704579/roman-voronov"}, "is_accepted": true, "score": 2, "last_activity_date": 1562167179, "creation_date": 1562167179, "answer_id": 56873341, "question_id": 56873171, "link": "https://stackoverflow.com/questions/56873171/macro-to-force-uppercase-not-working-on-specified-range/56873341#56873341", "title": "Macro to force uppercase not working on specified range", "body": "<p>You just need to properly combine techniques of two code samples. Second code lacks intersection feature, while the first one lacks iteration among a range of inserted cells. Try this one:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim Magic_Range As Range, Iterator_Range As Range\n    Set Magic_Range = Range(\"$A$1:$C$10\")\n    Application.EnableEvents = False\n    If Not Application.Intersect(Target, Magic_Range) Is Nothing Then\n        For Each Iterator_Range In Application.Intersect(Target, Magic_Range)\n            If Not Iterator_Range.HasFormula And Iterator_Range.Value &lt;&gt; \"\" Then\n                Iterator_Range.Value = UCase(Iterator_Range.Value)\n            End If\n        Next Iterator_Range\n    End If\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9182464, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b306fb18df8ca818bf2ec94316f2aca?s=128&d=identicon&r=PG&f=1", "display_name": "ahmad", "link": "https://stackoverflow.com/users/9182464/ahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56873341, "answer_count": 1, "score": 0, "last_activity_date": 1562167179, "creation_date": 1562166574, "last_edit_date": 1562166693, "question_id": 56873171, "link": "https://stackoverflow.com/questions/56873171/macro-to-force-uppercase-not-working-on-specified-range", "title": "Macro to force uppercase not working on specified range", "body": "<p>I need a macro in Excel to automatically capitalize text entered in a range of cells. </p>\n\n<p>I found code online that works:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not (Application.Intersect(Target, Range(\"A1:C10\")) _\nIs Nothing) Then\n        With Target\n            If Not .HasFormula Then\n                Application.EnableEvents = False\n                .Value = UCase(.Value)\n                Application.EnableEvents = True\n            End If\n        End With\n    End If\n</code></pre>\n\n<p>It functions fine, but I get a value mismatch error when I copy or paste multiple cells into the specified range. So I tried using this code instead:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim r As Range\n    Set r = Range(\"$A$1:$C$10\")\n    Application.EnableEvents = False\n    For Each r In Target\n        If Not r.HasFormula And r.Value &lt;&gt; \"\" Then\n            r.Value = UCase(r.Value)\n        End If\n    Next\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>This code works perfectly even when copying and pasting, but it applies to the entire spreadsheet, even though the <code>r</code> variable has a range set on it. Why? Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1562167364, "post_id": 56873017, "comment_id": 100295358, "body": "AFAIK you cannot edit the column headers, the value displayed will be chosen according to the way you fill the combobox. And if you add items manually, it will always be blank. (You have to use ListFillRange, and the header will be the cell just above)"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1562167446, "post_id": 56873017, "comment_id": 100295405, "body": "Of course you can fill a range on some hidden sheet with your sql result, and then use this range as source to get the headers"}, {"owner": {"reputation": 65, "user_id": 11573583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TEQu3.png?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/11573583/nicholas"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1562168352, "post_id": 56873017, "comment_id": 100295897, "body": "Could &quot;ListFillRange&quot; work for an array? Maybe if I use the bounds of the array as the range? Or does it only add values from a range of cells within an excel sheet?"}], "owner": {"reputation": 65, "user_id": 11573583, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TEQu3.png?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/11573583/nicholas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562166085, "creation_date": 1562166085, "question_id": 56873017, "link": "https://stackoverflow.com/questions/56873017/how-do-i-add-headers-to-the-columns-of-a-drop-down-list-of-a-combo-box-not-a-u", "title": "How do I add headers to the columns of a drop down list of a combo-box? (NOT a userform)", "body": "<p>Right now I have a combo-box that has two columns in the drop down list. The left column displays a type of a material. The right column is a description of that material. What I would like to do is add headers when I open the drop down list from the combo-box. </p>\n\n<p>I'm pretty sure this is possible because within the properties of the combo-box in the data category there is a property called \"columnHeads\" which either has a value of \"yes\" or \"no\". I toggled this to say \"yes\" however I don't see any way of changing or adding values to these headers. I assume this must be done from vba, but I was curious if there is a solution to this.</p>\n\n<p>(I am not using a user form by the way which seems to be where the majority of questions about this are being asked)</p>\n\n<p>I have tried specifying where I would like to place my header by providing a position, but this only added the header to the first position in the drop down list not the actual header.</p>\n\n<p><strong>SUB THAT POPULATES THE COMBO-BOX</strong></p>\n\n<p><em>Here my code is just showing how I populate the array from the SQL database which I use to then populate the combo-Box in excel</em></p>\n\n<pre><code>Public Sub AFCD_Column_Data(ByVal sql_col As String, _\n                            ByVal sql_table As String)\n\n' ... CODE...\n' ... CODE...\n' ... MORE CODE!\n\nsqlrs.Open sqlcmd\n\n    If Not sqlrs.EOF Then\n\n        arr() = sqlrs.GetRows()\n\n    End If\n\n    Dim i As Integer\n\n    Sheet1.ComboBox3.Clear\n    Sheet1.ComboBox3.ListWidth = 400\n    Sheet1.ComboBox3.ColumnHeads = True\n    ' Sheet1.ComboBox3.Column(0,0) = \"HEADER 1\"\n\n    For i = 0 To UBound(arr(), 2) ' the 2 refers to the 2nd dimension\n\n        With Sheet1.ComboBox3\n            .AddItem arr(0, i) ' adds the item / value to the first column\n            .List(i, 1) = arr(0, i) + \"(DESCRIPTION)\" ' adds the description to the second column\n\n        End With\n\n    Next i\n\n    sqlrs.Close\n    sqlconxn.Close\n    Exit Sub\n\n</code></pre>\n\n<p>Sorry I don't have an image of my combo-box and the drop down list. I couldn't figure out how to add the image, but all I am looking for is a combo-box where the drop down list displays two headers; followed by the rest of the data which I already have displayed. </p>\n\n<p>Ex:</p>\n\n<pre><code>| \"MATERIAL\"  |  \"DESCRIPTION\" |\n--------------------------------\n| Titanium    |  \"Description\" |\n| ...         |  ...           |\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1562167730, "post_id": 56872703, "comment_id": 100295540, "body": "For the future: Don&#39;t just assume something has a property, there are docs that describe the language quite well. ( See @bm13563s Answer). Another way is to set a Watch on a variable or an object and then explore it, this is a very easy way to get a view &quot;inside&quot; an object."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11735020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RS29ojJ4ieM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfTkLjWvzeeEqeibybz1HsqoD_P8g/photo.jpg?sz=128", "display_name": "Nicolas Bulgarides", "link": "https://stackoverflow.com/users/11735020/nicolas-bulgarides"}, "edited": false, "score": 0, "creation_date": 1562168392, "post_id": 56873295, "comment_id": 100295922, "body": "Thanks for the help. I&#39;ve been looking through the docs and also StackExchange and still it hasn&#39;t been super easy (I way prefer Java...but I have to use PPT)"}], "tags": [], "owner": {"reputation": 649, "user_id": 8456608, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jDMgZ.jpg?s=128&g=1", "display_name": "bm13563", "link": "https://stackoverflow.com/users/8456608/bm13563"}, "is_accepted": true, "score": 0, "last_activity_date": 1562167027, "creation_date": 1562167027, "answer_id": 56873295, "question_id": 56872703, "link": "https://stackoverflow.com/questions/56872703/code-to-change-cell-value-in-powerpointoffice-365-vba/56873295#56873295", "title": "Code to Change Cell Value in PowerPoint(Office 365) VBA", "body": "<pre><code>ActivePresentation.Slides(3).Shapes(\"testtable\").Table.Cell(2, 1).Shape.TextFrame.TextRange.Text = randomInt\n</code></pre>\n\n<p>See the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/powerpoint.table\" rel=\"nofollow noreferrer\">docs</a>.</p>\n"}], "owner": {"reputation": 17, "user_id": 11735020, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-RS29ojJ4ieM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfTkLjWvzeeEqeibybz1HsqoD_P8g/photo.jpg?sz=128", "display_name": "Nicolas Bulgarides", "link": "https://stackoverflow.com/users/11735020/nicolas-bulgarides"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 56873295, "answer_count": 1, "score": 1, "last_activity_date": 1562167027, "creation_date": 1562165187, "last_edit_date": 1562165582, "question_id": 56872703, "link": "https://stackoverflow.com/questions/56872703/code-to-change-cell-value-in-powerpointoffice-365-vba", "title": "Code to Change Cell Value in PowerPoint(Office 365) VBA", "body": "<p>I'm making a game inside PPT for cybersecurity awareness month for my company. I'm using VBA to make a couple of extra features that make it slightly nicer than just a jeopardy style quiz. I've already gotten buttons to work (action buttons) that can hide pictures / make them visible, as well as a button that can change the text on another slide (E.g button on slide 2 sets global variable to \"boop\" and then changes textbox on slide 1).</p>\n\n<p>Right now i'm trying to figure out the code to do the same thing with a table made inside the slide. The table is already made (and renamed \"testtable\"). </p>\n\n<p>I want to select for example A2, and then make A2 = boop. I've tried a bunch of different code but can't figure out how to change the cell value.</p>\n\n<p>Thanks for help</p>\n\n<p>This code has worked perfectly to change text on a different slide</p>\n\n<pre><code>ActivePresentation.Slides(1).Shapes(\"textbox\").TextFrame.TextRange.Text = randomInt\n</code></pre>\n\n<p>I've tried things like</p>\n\n<pre><code>ActivePresentation.Slides(3).Shapes(\"testtable\").table.TextFrame.TextRange.Text = randomInt\n</code></pre>\n\n<p>I've tried changing the <code>.text</code> to <code>.value</code>. i've tried a bunch of other things but how card can it be to change a single cell?!</p>\n"}, {"tags": ["excel", "vba", "if-statement", "range"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1562167047, "post_id": 56872682, "comment_id": 100295181, "body": "Does &quot;J2&quot; range also change for each loop?"}], "answers": [{"comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1562167902, "post_id": 56873133, "comment_id": 100295658, "body": "SJR, if <code>&quot;J2&quot;</code> and <code>&quot;I2&quot;</code> in the first lines of the <code>IF</code> and <code>ELSEIF</code> statements are static then they are OK. But the ranges in each second line are not static and must increment for each loop,"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1562168278, "post_id": 56873133, "comment_id": 100295862, "body": "@GMalc - I&#39;ve just amended my code to remove all static references, but it may not be correct as the question is not clear in this regard. Not entirely sure what you mean by &quot;must increment for each loop&quot;?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1562169572, "post_id": 56873133, "comment_id": 100296513, "body": "SJR, just pointing out that you missed the Offset in  `WorksheetFunction.MRound(Worksheets(&quot;Result&quot;).Range(&quot;C1&quot;)&#39;"}, {"owner": {"reputation": 49, "user_id": 4299209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911a39c8f807a4a7c0a30eb36c0edea8?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4299209/robert"}, "edited": false, "score": 1, "creation_date": 1562175001, "post_id": 56873133, "comment_id": 100299092, "body": "@ SJR - Thanks, worked when once I added Offset(i) too at the right handside of the equal sign."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1562167752, "last_edit_date": 1562167752, "creation_date": 1562166441, "answer_id": 56873133, "question_id": 56872682, "link": "https://stackoverflow.com/questions/56872682/how-to-loop-through-one-range-in-vba-excel-and-update-another/56873133#56873133", "title": "How to Loop Through one Range in VBA Excel and Update Another", "body": "<p>The easiest way might be to use offset and a counter which goes up by 1 each iteration of your loop.</p>\n\n<p>If you want the offset to increase whether or not either condition is met then increment <code>i</code> outside the If.</p>\n\n<pre><code>Sub AutoTrack()\n\nDim rng As Range\nDim cell As Range\nDim i As Long\n\nSet rng = Workbooks(\"Test\").Worksheets(\"Track\").Range(\"I2:I10\")\n\nFor Each cell In rng\n    If cell.DisplayFormat.Interior.Color = RGB(146, 208, 80) Or cell.Offset(0, 1).DisplayFormat.Interior.Color = RGB(146, 208, 80) Then\n        Worksheets(\"Result\").Range(\"D1\").Offset(i) = WorksheetFunction.MRound(cell.Offset(, 1).Value + 0.125, 0.125)\n        Worksheets(\"Result\").Range(\"C1\").Offset(i) = WorksheetFunction.MRound(Worksheets(\"Result\").Range(\"D1\").Offset(i) - 0.75, 0.125)\n        i = i + 1\n    ElseIf cell.Offset(, 1).DisplayFormat.Interior.Color = RGB(255, 0, 0) Or cell.DisplayFormat.Interior.Color = RGB(255, 0, 0) Then\n        Worksheets(\"Result\").Range(\"C1\").Offset(i) = WorksheetFunction.MRound(cell - 0.125, 0.125)\n        Worksheets(\"Result\").Range(\"D1\").Offset(i) = WorksheetFunction.MRound(Worksheets(\"Result\").Range(\"C1\").Offset(i) + 0.75, 0.125)\n        i = i + 1\n    End If\nNext cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 3972840, "user_type": "registered", "profile_image": "https://graph.facebook.com/1833327160/picture?type=large", "display_name": "Alex", "link": "https://stackoverflow.com/users/3972840/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1562166823, "creation_date": 1562166823, "answer_id": 56873249, "question_id": 56872682, "link": "https://stackoverflow.com/questions/56872682/how-to-loop-through-one-range-in-vba-excel-and-update-another/56873249#56873249", "title": "How to Loop Through one Range in VBA Excel and Update Another", "body": "<p>try using a counter like this:</p>\n\n<pre><code>Dim rng As Range\nDim cell As Range\nDim i As Integer\n\ni = 2\n\nSet rng = ActiveSheet.Range(\"A1:A10\")\n\nFor Each cell In rng\n\nIf cell.Value = \"A\" Then\n\nWorksheets(\"WS1\").Range(\"B\" &amp; i) = \"OK\"\n\nEnd If\n\ni = i + 1\n\nNext cell\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1562169253, "creation_date": 1562169253, "answer_id": 56873960, "question_id": 56872682, "link": "https://stackoverflow.com/questions/56872682/how-to-loop-through-one-range-in-vba-excel-and-update-another/56873960#56873960", "title": "How to Loop Through one Range in VBA Excel and Update Another", "body": "<p>Assuming that \"J2\" and \"I2\" are static. Since your range is a simple range you can use the row number for each loop, w/ -1, to set the row number on your destination sheet.</p>\n\n<pre><code>Sub AutoTrack()\nDim scrws As Worksheet, trgtws As Worksheet, rng As Range, cel As Range\n\nSet scrws = ThisWorkbook.Worksheets(\"Track\")\nSet trgtws = ThisWorkbook.Worksheets(\"Result\")\n\nSet rng = scrws.Range(\"I2:I10\")\n\n    For Each cel In rng\n        If cel.DisplayFormat.Interior.Color = RGB(146, 208, 80) Or cel.Offset(, 1).DisplayFormat.Interior.Color = RGB(146, 208, 80) Then\n\n            trgtws.Cells(cel.Row - 1, \"D\") = WorksheetFunction.MRound(scrws.Range(\"J2\").Value + 0.125, 0.125)\n            trgtws.Cells(cel.Row - 1, \"C\") = WorksheetFunction.MRound(trgtws.Cells(cel.Row - 1, \"D\") - 0.75, 0.125)\n\n        ElseIf scrws.Range(\"J2\").DisplayFormat.Interior.Color = RGB(255, 0, 0) Or scrws.Range(\"I2\").DisplayFormat.Interior.Color = RGB(255, 0, 0) Then\n\n            trgtws.Cells(cel.Row - 1, \"C\") = WorksheetFunction.MRound(scrws.Range(\"I2\") - 0.125, 0.125)\n            trgtws.Cells(cel.Row - 1, \"D\") = WorksheetFunction.MRound(trgtws.Cells(cel.Row - 1, \"C\") + 0.75, 0.125)\n\n        End If\n    Next cel\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 4299209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/911a39c8f807a4a7c0a30eb36c0edea8?s=128&d=identicon&r=PG&f=1", "display_name": "Robert", "link": "https://stackoverflow.com/users/4299209/robert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 569, "favorite_count": 0, "accepted_answer_id": 56873133, "answer_count": 3, "score": 0, "last_activity_date": 1562169253, "creation_date": 1562165125, "last_edit_date": 1562165979, "question_id": 56872682, "link": "https://stackoverflow.com/questions/56872682/how-to-loop-through-one-range-in-vba-excel-and-update-another", "title": "How to Loop Through one Range in VBA Excel and Update Another", "body": "<p>I have a macro that screens cells in a range and when the cell or it's adjacent cell is red or green, it assigns a value to another cell and it's adjacent cell in another worksheet. I have come this far that the first part works, however the second \"looping\" I can't figure it out myself. In other words, in the code below I want Range (\"C1\") and Range (\"D1\") to update to Range (\"C2\") and Range (\"D2\") and so on.</p>\n\n<pre><code>Sub AutoTrack()\n\n   Dim rng As Range\n\n   Dim cell As Range\n\n   Set rng = Workbooks(\"Test\").Worksheets(\"Track\").Range(\"I2:I10\")\n\n   For Each cell In rng\n   If cell.DisplayFormat.Interior.Color = RGB(146, 208, 80) Or cell.Offset(0, \n    1).DisplayFormat.Interior.Color = RGB(146, 208, 80) Then\n\nWorksheets(\"Result\").Range(\"D1\") = \n    WorksheetFunction.MRound(Worksheets(\"Track\").Range(\"J2\").Value + 0.125, \n     0.125)\n    Worksheets(\"Result\").Range(\"C1\") = \n    WorksheetFunction.MRound(Worksheets(\"Result\").Range(\"D1\") - 0.75, 0.125)\n\nElseIf \n\n   Worksheets(\"Track\").Range(\"J2\").DisplayFormat.Interior.Color = RGB(255, 0, 0) \n   Or Worksheets(\"Track\").Range(\"I2\").DisplayFormat.Interior.Color = RGB(255, 0, \n   0) Then\n    Worksheets(\"Result\").Range(\"C1\") = WorksheetFunction.MRound(Worksheets(\"Track\").Range(\"I2\") - 0.125, 0.125)\n    Worksheets(\"Result\").Range(\"D1\") = \n    WorksheetFunction.MRound(Worksheets(\"Result\").Range(\"C1\") + 0.75, 0.125)\n    End If\n    Next cell\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11697656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921a5e8b50b9bf74b43167fc25992904?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/11697656/christina"}, "edited": false, "score": 0, "creation_date": 1562225312, "post_id": 56872599, "comment_id": 100313042, "body": "Thank you! It&#39;s working now :) However I think my loop is wrong. It keeps writing only &quot;58&quot; as i for my formula. Do you know why? I want it to count from 11 to 58, so the formula loops through every row from 11 to 58"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 15, "user_id": 11697656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921a5e8b50b9bf74b43167fc25992904?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/11697656/christina"}, "edited": false, "score": 0, "creation_date": 1562327976, "post_id": 56872599, "comment_id": 100349947, "body": "I think because you have two loops that look to be doing the same thing, It is iterating the outer loop getting you the row you want then looping i 11 to 58 for each outer loop iteration. That means you are always left with 58 as that is the last one it deals with."}], "tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 1, "last_activity_date": 1562164923, "creation_date": 1562164923, "answer_id": 56872599, "question_id": 56872483, "link": "https://stackoverflow.com/questions/56872483/how-do-i-write-an-with-statement-that-loops-through-rows-within-the-with-formula/56872599#56872599", "title": "How do I write an WITH statement that loops through rows within the WITH-formula?", "body": "<p>This line: <code>.Add(Type:=xlExpression, Formula1:=\"=OG((\"C\" &amp; i)&lt;=H8;(\"D\" &amp; i)&gt;=H8)\")</code></p>\n\n<p>Has improper quotes you took the C out of the quotes so it thinks its a variable and the ampersand is within the quotes so is being interpreted as a string character and not as the concatenation character.</p>\n\n<p>You want something like: <code>.Add(Type:=xlExpression, Formula1:=\"=OG((C\" &amp; i &amp; \")&lt;=H8;(D\" &amp; \n i &amp; \")&gt;=H8)\")</code></p>\n"}], "owner": {"reputation": 15, "user_id": 11697656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/921a5e8b50b9bf74b43167fc25992904?s=128&d=identicon&r=PG&f=1", "display_name": "Christina", "link": "https://stackoverflow.com/users/11697656/christina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 56872599, "answer_count": 1, "score": 1, "last_activity_date": 1562164923, "creation_date": 1562164527, "last_edit_date": 1562164624, "question_id": 56872483, "link": "https://stackoverflow.com/questions/56872483/how-do-i-write-an-with-statement-that-loops-through-rows-within-the-with-formula", "title": "How do I write an WITH statement that loops through rows within the WITH-formula?", "body": "<p>I'm building an interactive Gantt chart with many rows (which is why I use VBA) and I'm having trouble with formatting my cells. Basically I just want the cells to have color based on an AND-formula. The formula is referring to other cells, so the formatting is not based on the cells own value. \nThe tricky part is that my formula needs to change according to the specific row that it's looping through. I managed to build a code that correctly loops through each row, but I can't get the formula to change as well. Right now my code gives me an syntax error in the formula-part of my with-expression. \nI hope you guys can help! </p>\n\n<p>I figured that the problem might be that the concatenate-trick might not work with with-statements. But I don't know how I can do the formatting in any other way. </p>\n\n<pre><code>Public Sub FormatTest()\nDim Sheet As Object\nDim Area As Range, r As Range\nDim i As Integer\n\nSet Area = Sheets(\"Styregruppe - Tester\").Range(\"H11:BK58\")\nFor Each r In Area.Rows\n    For i = 11 To 58\n    With r.FormatConditions\n    .Delete\n        With .Add(Type:=xlExpression, Formula1:=\"=OG((\"C\" &amp; i)&lt;=H8;(\"D\" &amp; i)&gt;=H8)\")\n            .Interior.Color = RGB(0, 176, 240)\n            .StopIfTrue = False\n        End With\n    End With\n Next i\n Next r\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "project"], "comments": [{"owner": {"reputation": 290, "user_id": 6387947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68bd3078f0f802c7e8769ecfd63878d8?s=128&d=identicon&r=PG&f=1", "display_name": "scenography", "link": "https://stackoverflow.com/users/6387947/scenography"}, "edited": false, "score": 0, "creation_date": 1562179227, "post_id": 56872480, "comment_id": 100300934, "body": "It sounds like you want a single row on one sheet (account number) to become multiple rows on another sheet (list of tasks). It can be done, but first consider columns. Could the tasks be columns instead of rows? You could type OK in a column to mean a task was completed. Alternatively you can make a single row look like multiple rows, if the list is only for reading or printing. To insert line breaks, type Alt+Enter. In a cell, type the first task, Alt+Enter, second task, Alt+Enter, and so on. If these workaround won&#39;t work, let me know."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 11734896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f11e546ffbf16b74d92834812dc2de?s=128&d=identicon&r=PG&f=1", "display_name": "ak40837", "link": "https://stackoverflow.com/users/11734896/ak40837"}, "is_accepted": true, "score": 0, "last_activity_date": 1562947453, "creation_date": 1562947453, "answer_id": 57010498, "question_id": 56872480, "link": "https://stackoverflow.com/questions/56872480/how-to-paste-static-data-in-a-new-column-on-one-worksheet-for-every-new-row-adde/57010498#57010498", "title": "How to paste static data in a new column on one worksheet for every new row added to a table on another worksheet", "body": "<p>This was the answer that I was looking for:</p>\n\n<pre><code>Sub Adding_New_SKAs()\n\nDim New_Markets As Range\nSet New_Markets = ThisWorkbook.Worksheets(\"List of Markets\").Range(\"A1:B104\")\n\nDim LastRow As Integer\nLastRow = ThisWorkbook.Worksheets(\"SKAs\").Range(\"A1\").CurrentRegion.Rows.Count\n\nDim i As Integer, Index As Integer\n\nIndex = 0\n\nFor i = 2 To LastRow\n   New_Markets.Copy Sheet2.Range(\"A1\").Offset(0, Index)\n   Index = Index + 3\nNext i\n\nColumns.AutoFit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11734896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f11e546ffbf16b74d92834812dc2de?s=128&d=identicon&r=PG&f=1", "display_name": "ak40837", "link": "https://stackoverflow.com/users/11734896/ak40837"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 57010498, "answer_count": 1, "score": -1, "last_activity_date": 1562947453, "creation_date": 1562164521, "last_edit_date": 1562218300, "question_id": 56872480, "link": "https://stackoverflow.com/questions/56872480/how-to-paste-static-data-in-a-new-column-on-one-worksheet-for-every-new-row-adde", "title": "How to paste static data in a new column on one worksheet for every new row added to a table on another worksheet", "body": "<p>I am a novice in VBA and coding in general and am in the beginning stages of creating a project management tool. The process of using this tool begins with an employee entering a list of accounts that need to be opened. For each account there is a standardized list of tasks that need to be completed for that account to be officially be opened.</p>\n\n<p>What I want is that for each new account that is added, the standardized list of tasks appear together on a separate sheet than where the accounts that need to be opened are.</p>\n\n<p>What I am thinking of is using a loop such that for each new row that is added to the table of accounts that need to be opened, the standardized list of tasks is copied from a worksheet in the workbook to the worksheet containing all the standardized lists for all the accounts. This is code I have in the works. However, I could use help and direction.</p>\n\n<pre><code>Dim New_Markets As Range\nSet New_Markets = ThisWorkbook.Worksheets(\"List of Markets\").Range(\"A1:B104\")\n\nDim LastRow As Long\nLastRow = ThisWorkbook.Worksheets(\"SKAs\").ListObjects(\"Table1\").Range.Rows.Count\n\nDim SKAs As Range\nSet SKAs = ThisWorkbook.Worksheets(\"SKAs\").Range(\"A1:E\" &amp; LastRow)\n\nFor Each Rows In SKAs\n'I want to add a column of New_Markets to the sheet \"Market to Open\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 2, "creation_date": 1562164590, "post_id": 56872463, "comment_id": 100293678, "body": "<code>If Location &gt; 0 Then</code>..."}, {"owner": {"reputation": 27, "user_id": 9370235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226ab172fc75d3f7782fbf9258d2af7b?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan-John Martin", "link": "https://stackoverflow.com/users/9370235/brendan-john-martin"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1562168541, "post_id": 56872463, "comment_id": 100296005, "body": "Thanks, works just like a charm.  The solution is always simple haha"}], "answers": [{"comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1562165382, "post_id": 56872510, "comment_id": 100294216, "body": "@asger Good point, a with statement would be a nice addition."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1562165729, "post_id": 56872510, "comment_id": 100294420, "body": "Jeez, yeah I&#39;m doing my own work at the same time... My bad."}], "tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 2, "last_activity_date": 1562165529, "last_edit_date": 1562165529, "creation_date": 1562164620, "answer_id": 56872510, "question_id": 56872463, "link": "https://stackoverflow.com/questions/56872463/extract-text-from-the-left-of-but-ignore-cells-that-do-not-contain/56872510#56872510", "title": "Extract text from the left of &quot;-&quot; but ignore cells that do not contain &quot;-&quot;", "body": "<pre><code>        Set ws = Worksheets(\"Sheet1\")\n        with ws\n             m = .Cells(.Rows.Count, \"F\").End(xlUp).Row\n             For r = 2 To m\n                 if InStr(1, .Cells(r, 1), \"-\") &gt; 0 then\n                     .Cells(r, 2).Value = split(.Cells(r, 1).value)(0)\n                 end if\n             Next\n        end with\n</code></pre>\n\n<p>You set ws to a sheet, then immediately change it, you should remove the first set if you aren't using it.</p>\n\n<p>You can still use left() and location if you would like, this is just another way of doing it. The important part is the if statement using instr()</p>\n"}], "owner": {"reputation": 27, "user_id": 9370235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/226ab172fc75d3f7782fbf9258d2af7b?s=128&d=identicon&r=PG&f=1", "display_name": "Brendan-John Martin", "link": "https://stackoverflow.com/users/9370235/brendan-john-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 56872510, "answer_count": 1, "score": 1, "last_activity_date": 1562165529, "creation_date": 1562164478, "last_edit_date": 1562164832, "question_id": 56872463, "link": "https://stackoverflow.com/questions/56872463/extract-text-from-the-left-of-but-ignore-cells-that-do-not-contain", "title": "Extract text from the left of &quot;-&quot; but ignore cells that do not contain &quot;-&quot;", "body": "<p>I am trying to extract some values from a cell.</p>\n\n<p>I have figured out how to extract the value of a cell to the left of \"-\" but I come across an error when the cell does not have a \"-\" at all.\nHow do I ignore these cells / error?.</p>\n\n<p>Any help would be much appreciated or ways to improve what I have made.</p>\n\n<p>Also if it helps there are roughly 20000 rows on average.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>    Dim r As Long\n    Dim Location As Long\n    Dim m As Long\n    Dim ws As Worksheet\n\n    Set ws = Worksheets(\"NHBRSummary\")\n\n        Set ws = Worksheets(\"Sheet1\")\n        m = ws.Cells(ws.Rows.Count, \"F\").End(xlUp).Row\n        For r = 2 To m\n            Location = InStr(1, Cells(r, 1), \"-\")\n            Cells(r, 2).Value = Left(Cells(r, 1), Location - 1)\n        Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 1, "creation_date": 1562164718, "post_id": 56872404, "comment_id": 100293765, "body": "<code>ReDim vData(0 To MyFiles.Count - 1, 0 To 0)</code> why 0 to 0?"}, {"owner": {"reputation": 131, "user_id": 11725140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7515ca6774d9b06ccbdd0bcfe7147c02?s=128&d=identicon&r=PG&f=1", "display_name": "mongoose00318", "link": "https://stackoverflow.com/users/11725140/mongoose00318"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562166895, "post_id": 56872404, "comment_id": 100295107, "body": "Not sure why, it was something that was suggested by someone else on here. I just removed it but I am still getting the same problem."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 11725140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7515ca6774d9b06ccbdd0bcfe7147c02?s=128&d=identicon&r=PG&f=1", "display_name": "mongoose00318", "link": "https://stackoverflow.com/users/11725140/mongoose00318"}, "edited": false, "score": 0, "creation_date": 1562170596, "post_id": 56873593, "comment_id": 100297010, "body": "Yes, I had my file like that originally. Someone suggested that a With/End statement would be faster than a For Each. What are your thoughts?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 131, "user_id": 11725140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7515ca6774d9b06ccbdd0bcfe7147c02?s=128&d=identicon&r=PG&f=1", "display_name": "mongoose00318", "link": "https://stackoverflow.com/users/11725140/mongoose00318"}, "edited": false, "score": 0, "creation_date": 1562171181, "post_id": 56873593, "comment_id": 100297303, "body": "<code>With...End With</code> is not a loop. <code>While...Wend</code> is more or less deprecated. This is a simple case for <code>For...Each</code> loop. If you&#39;re concerned about speed, perhaps read <a href=\"https://analystcave.com/vba-for-loop-vs-for-each-loop/\" rel=\"nofollow noreferrer\">analystcave.com/vba-for-loop-vs-for-each-loop</a>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 131, "user_id": 11725140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7515ca6774d9b06ccbdd0bcfe7147c02?s=128&d=identicon&r=PG&f=1", "display_name": "mongoose00318", "link": "https://stackoverflow.com/users/11725140/mongoose00318"}, "edited": false, "score": 0, "creation_date": 1562171582, "post_id": 56873593, "comment_id": 100297511, "body": "As another point - even if <code>MyFiles(x)</code> were valid syntax, you currently have an infinite loop..."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1562172399, "last_edit_date": 1562172399, "creation_date": 1562167986, "answer_id": 56873593, "question_id": 56872404, "link": "https://stackoverflow.com/questions/56872404/invalid-procedure-call-or-argument-on-debug-print/56873593#56873593", "title": "Invalid Procedure call or argument on Debug.Print", "body": "<p><code>MyFiles</code> is a collection and should be iterated over with a <code>For Each...Next</code> loop.</p>\n\n<pre><code>Set MyFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet MyFolder = MyFSO.GetFolder(FolderPath)\nSet MyFiles = MyFolder.Files\n\nFor Each MyFile In MyFiles\n    Debug.Print MyFile.Name ' no parentheses\nNext\n</code></pre>\n\n<p>You can't index into the <code>MyFiles</code> collection. Use a <code>For Each...Next</code> loop, as the <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/files-collection\" rel=\"nofollow noreferrer\"><code>Files</code> documentation</a> explains.</p>\n"}], "owner": {"reputation": 131, "user_id": 11725140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7515ca6774d9b06ccbdd0bcfe7147c02?s=128&d=identicon&r=PG&f=1", "display_name": "mongoose00318", "link": "https://stackoverflow.com/users/11725140/mongoose00318"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 56873593, "answer_count": 1, "score": 1, "last_activity_date": 1562172399, "creation_date": 1562164268, "last_edit_date": 1562164499, "question_id": 56872404, "link": "https://stackoverflow.com/questions/56872404/invalid-procedure-call-or-argument-on-debug-print", "title": "Invalid Procedure call or argument on Debug.Print", "body": "<p>Trying to redo a function I made a few days ago using some advice I received on here...I get an Invalid Procedure call or argument on the line with Debug.Print.</p>\n\n<p>Very new to VBA and Excel. Thanks for your help and patience.</p>\n\n<pre><code>Public Sub GetSOPFiles()\n    ' Set folder path\n    Const FolderPath As String = \"C:\\Users\\test\\Desktop\\SOP Excel Prototype\"\n\n    Const FileExt As String = \"docx\"\n\n    Dim Result As Variant\n    Dim i As Integer\n    Dim MyFile As Object\n    Dim MyFSO As Object\n    Dim MyFolder As Object\n    Dim MyFiles As Object\n    Dim dept As Variant\n    Dim deptCodes As Variant\n\n    Set MyFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set MyFolder = MyFSO.GetFolder(FolderPath)\n    Set MyFiles = MyFolder.Files\n\n    Dim vData As Variant\n    Dim sTemp As Variant\n\n    ReDim vData(0 To MyFiles.Count - 1, 0 To 0)\n\n    x = 1\n\n    With MyFiles\n        While x &lt;= UBound(vData, 1)\n            Debug.Print (MyFiles(x).Name)\n        Wend\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1562164342, "post_id": 56872326, "comment_id": 100293523, "body": "Why even make the <code>LR</code> string? <code>Range(&quot;D2:D&quot; &amp; lRow).value</code> should work.  Also, <code>Week</code> and <code>Day</code> should likely be declared as a <code>String</code>.  Edit: Actually, I bet <code>Week</code> and <code>Day</code> are causing issues since these are reserved terms in VBA and could be confusing things.  I&#39;d change to like, <code>userWeek</code> and <code>userDay</code> just to be sure."}, {"owner": {"reputation": 3, "user_id": 11725691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f617eba53aca46a949a9dc4ad6ef1b61?s=128&d=identicon&r=PG&f=1", "display_name": "calayton3", "link": "https://stackoverflow.com/users/11725691/calayton3"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1562166111, "post_id": 56872326, "comment_id": 100294647, "body": "Thank you for the help, and I tried that! For some reason I keep getting the error: Method &quot;Value&quot; of Object &quot;Range&quot; failed, when using it. I&#39;m going to try it with a different method, but is there anything else?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11725691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f617eba53aca46a949a9dc4ad6ef1b61?s=128&d=identicon&r=PG&f=1", "display_name": "calayton3", "link": "https://stackoverflow.com/users/11725691/calayton3"}, "edited": false, "score": 0, "creation_date": 1562166193, "post_id": 56872916, "comment_id": 100294699, "body": "Just saw this after I posted my comment! I will try this out."}, {"owner": {"reputation": 3, "user_id": 11725691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f617eba53aca46a949a9dc4ad6ef1b61?s=128&d=identicon&r=PG&f=1", "display_name": "calayton3", "link": "https://stackoverflow.com/users/11725691/calayton3"}, "edited": false, "score": 0, "creation_date": 1562169231, "post_id": 56872916, "comment_id": 100296321, "body": "So I keep getting an Application-defined or Object-defined error when using the ActiveWorkbook option. When using ThisWorkbook, the error becomes Method &quot;Value&quot; for Object &quot;Range&quot; failed. Is there anything else it could be?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 11725691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f617eba53aca46a949a9dc4ad6ef1b61?s=128&d=identicon&r=PG&f=1", "display_name": "calayton3", "link": "https://stackoverflow.com/users/11725691/calayton3"}, "edited": false, "score": 0, "creation_date": 1562169307, "post_id": 56872916, "comment_id": 100296366, "body": "@calayton3 - Where are you putting the code?  What line throws the error, the <code>Set ws ...</code>  line?  Try <code>Set ws = Activeworkbook.Worksheets(1)</code>?  What is the worksheet name of the sheet you want this to run on? &quot;Sheet1&quot;, &quot;Sheet2&quot;, &quot;MyData&quot;, etc.?"}, {"owner": {"reputation": 3, "user_id": 11725691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f617eba53aca46a949a9dc4ad6ef1b61?s=128&d=identicon&r=PG&f=1", "display_name": "calayton3", "link": "https://stackoverflow.com/users/11725691/calayton3"}, "edited": false, "score": 0, "creation_date": 1562187148, "post_id": 56872916, "comment_id": 100304085, "body": "No, the Set ws = Activeworkbook.Worksheets(1) statement is perfectly fine! The line that throws the error is ws.Range(&quot;C2:C&quot; &amp; lRow).Value = userWeek. I spoke to a coworker as well, and we couldn&#39;t figure it out. Every time it doesn&#39;t throw an error, my Excel either doesn&#39;t respond or it does and returns no value in the desired cells. The Sheet name is All Open Orders. I will respond to my question with the code I&#39;m using so you can see."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 11725691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f617eba53aca46a949a9dc4ad6ef1b61?s=128&d=identicon&r=PG&f=1", "display_name": "calayton3", "link": "https://stackoverflow.com/users/11725691/calayton3"}, "edited": false, "score": 0, "creation_date": 1562187575, "post_id": 56872916, "comment_id": 100304267, "body": "@calayton3 - Change to this line then <code>Set ws = ThisWorkbook.Worksheets(&quot;All Open Orders&quot;)</code>. And again, this the macro should be in the Workbook your &quot;All Open Orders&quot; sheet is in, in a <a href=\"https://www.excelcampus.com/vba/code-modules-event-procedures/\" rel=\"nofollow noreferrer\">Code Module</a>."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1562166271, "last_edit_date": 1562166271, "creation_date": 1562165740, "answer_id": 56872916, "question_id": 56872326, "link": "https://stackoverflow.com/questions/56872326/how-to-use-my-defined-last-row-as-part-of-my-range/56872916#56872916", "title": "How to use my defined last row as part of my range?", "body": "<p>Per my comment, try this (added comments to help show what I changed, but you can remove them in your actual code):</p>\n\n<pre><code>Sub FillWeeknDay()\nDim ws as Worksheet\n' Change the worksheet name below if needed. It should be the name of the sheet\n' you want the code to run on/with\nSet ws = ThisWorkbook.Worksheets(\"Sheet1\")\n\n' Good job using `Long`, because the number of rows can exceed \n' what an `Integer` can hold.  Note how I added `ws` before the Range object\n' which makes sure that we're counting the `Cells()...` info on the correct page.\nDim lRow As Long \nlRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\n' Change variable name, and make a String\nDim userWeek as String\nuserWeek = InputBox(\"What week is this OOR being made in?\")\nws.Range(\"C2:C\" &amp; lRow).Value = userWeek \n\nDim userDay As String\nuserDay = InputBox(\"Are you creating this report on Monday, Wednesday, or Friday?\")\nws.Range(\"D2:D\" &amp; lRow).Value = userDay \n\nEnd Sub\n</code></pre>\n\n<p>I changed <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/day-function\" rel=\"nofollow noreferrer\"><code>Day</code></a> because it's a reserved term in VBA.  Changed <code>Week</code> just to match the <code>userDay</code> \"style\"...but could likely have kept <code>Week</code>.</p>\n\n<p>Edit: I also assume this code is in a workbook that is NOT the Personal.xlsb. If you're putting this in the <code>Personal.xlsb</code>, change <code>ThisWorkbook</code> above to <code>ActiveWorkbook</code>.</p>\n"}], "owner": {"reputation": 3, "user_id": 11725691, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f617eba53aca46a949a9dc4ad6ef1b61?s=128&d=identicon&r=PG&f=1", "display_name": "calayton3", "link": "https://stackoverflow.com/users/11725691/calayton3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 56872916, "answer_count": 1, "score": 0, "last_activity_date": 1562166271, "creation_date": 1562164040, "question_id": 56872326, "link": "https://stackoverflow.com/questions/56872326/how-to-use-my-defined-last-row-as-part-of-my-range", "title": "How to use my defined last row as part of my range?", "body": "<p>I am currently an intern for the summer, brand-new to VBA (just picked it up on 6/29/19), and I am attempting to create an Order Aging Report for visibility at my company. The problem in question is that no matter how many variations on the code I try (I will attach a few examples), I either encounter a type mismatch error, or the code runs without problems but does not enter the calculated values into the cells in that range. I wouldn't ask if the resources I've already tried had solved the problem, and I'm prepared to recognize that its most likely a pretty foundational error. I haven't found any posts on StackOverflow that solve my particular problem. I am simply very new to this and coding in general (I just picked up Python a few months ago for Data Science). Would someone be willing to help me with direction (not a solution) toward the proper solution? It feels like a very simple solution and I'm kicking myself because I still can't figure it out.</p>\n\n<ul>\n<li><p>I've tried converting last row value to a string in order for it to be compatible with the range that I'm trying to concatenate it with, this only produces a type mismatch error.</p></li>\n<li><p>I've tried the concatenate method with this format: Range(\"C2\" &amp; LR), and this is where the problem of the code running but returning no values comes in.</p></li>\n<li><p>I've tried defining a counter for the rows and then printing the value of that to a cell outside my table and using that as part of the calculation.</p></li>\n<li><p>I've tried a For Each loop in each column and used the values entered into the Input Boxes as the values entered for each cell. This worked, but it just froze my Excel every time it ran.</p></li>\n<li><p>I've tried using an arbitrarily chosen number that is larger than the table, and this worked. But for obvious reasons this isn't the solution I want. It's just lazy and provides no learning value haha.</p></li>\n</ul>\n\n<p>I hope this background isn't too limiting, and I want to thank everyone in advance for the advice!</p>\n\n<p>Here's the current code I'm running:</p>\n\n<pre><code>    Sub FillWeeknDay()\n\n    Dim lRow As Long\n    Dim LR As String\n    lRow = Cells(Rows.Count, 1).End(xlUp).Row\n    LR = lRow\n\n    Dim Week As Variant\n    Week = InputBox(\"What week is this OOR being made in?\")\n    Range(\"C2:C\" &amp; LR).value = Week\n\n    Dim Day As Variant\n    Day = InputBox(\"Are you creating this report on Monday, Wednesday, or Friday?\")\n    Range(\"D2:D\" &amp; LR).value = Day\n\n    End Sub\n</code></pre>\n\n<p>The expected result is that the values entered into the input boxes would be entered into the cells in the Range up until the last row in that column. The actual result is either nothing at all or the type mismatch error that I mentioned.</p>\n"}, {"tags": ["excel", "vba", "ms-access", "process"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11734634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55b0a624bd8a1734eec019bd6fadcf72?s=128&d=identicon&r=PG&f=1", "display_name": "AMDRDB", "link": "https://stackoverflow.com/users/11734634/amdrdb"}, "edited": false, "score": 0, "creation_date": 1562231988, "post_id": 56883498, "comment_id": 100316595, "body": "Thank you @Andre for your answer! I had tried all thoose things too but it hadn&#39;t worked. Sorry for being not accurate enough. I eventually found the reason why I had this process. I think it was created by an add-ins : &quot;eformity Document Builder Microsoft Office Add-in&quot; which I disabled manually. I was Lucky to find an other post about that this Morning."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 11, "user_id": 11734634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55b0a624bd8a1734eec019bd6fadcf72?s=128&d=identicon&r=PG&f=1", "display_name": "AMDRDB", "link": "https://stackoverflow.com/users/11734634/amdrdb"}, "edited": false, "score": 0, "creation_date": 1562233872, "post_id": 56883498, "comment_id": 100317795, "body": "Still make sure to use Option Explicit. :) @AMDRDB"}, {"owner": {"reputation": 11, "user_id": 11734634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55b0a624bd8a1734eec019bd6fadcf72?s=128&d=identicon&r=PG&f=1", "display_name": "AMDRDB", "link": "https://stackoverflow.com/users/11734634/amdrdb"}, "edited": false, "score": 0, "creation_date": 1562339882, "post_id": 56883498, "comment_id": 100355987, "body": "Thanks again @Andre! I hadn&#39;t written it in this module actually. I did it yersterday and it prooved to be helpful."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": false, "score": 0, "last_activity_date": 1562228163, "creation_date": 1562228163, "answer_id": 56883498, "question_id": 56872158, "link": "https://stackoverflow.com/questions/56872158/why-does-excel-application-inputbox-leaves-an-hidden-excel-process/56883498#56883498", "title": "Why does Excel.Application.InputBox leaves an hidden Excel process?", "body": "<p>You should declare <code>cellule</code> inside your function.</p>\n\n<p>Make sure to have <a href=\"https://msdn.microsoft.com/en-us/library/bw9t3484%28v=vs.84%29.aspx\" rel=\"nofollow noreferrer\"><code>Option Explicit</code></a> at the top of each module.<br>\nIt enforces variable declaration and reports undeclared or misspelled variables/constants at compile time.<br>\nTo have this automatically in new modules, set the <a href=\"http://www.fmsinc.com/microsoftaccess/modules/options/index.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a> option in the VBA Editor. </p>\n\n<p>The Excel process <em>probably</em> stays running because of a wrong order of cleanup calls. When you quit Excel, the reference to <code>xlBook</code> is still active and prevents the process from closing.</p>\n\n<pre><code>xlBook.Close False\nXLApp.Quit\nSet xlBook = Nothing\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>xlBook.Close False\nSet xlBook = Nothing\nXLApp.Quit\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11734634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55b0a624bd8a1734eec019bd6fadcf72?s=128&d=identicon&r=PG&f=1", "display_name": "AMDRDB", "link": "https://stackoverflow.com/users/11734634/amdrdb"}, "is_accepted": false, "score": 0, "last_activity_date": 1562340009, "last_edit_date": 1562340009, "creation_date": 1562232860, "answer_id": 56884928, "question_id": 56872158, "link": "https://stackoverflow.com/questions/56872158/why-does-excel-application-inputbox-leaves-an-hidden-excel-process/56884928#56884928", "title": "Why does Excel.Application.InputBox leaves an hidden Excel process?", "body": "<p>I eventually found the reason why I had this hidden Excel process. I think it was created by an add-in : \"eformity Document Builder Microsoft Office Add-in\" which I disabled manually. I was Lucky to find another post about that this morning. I have executed my code about 20 times and I don't have any hidden Excel process anymore. </p>\n\n<p>In case it could help someone, here is the way I disabled the add-ins. I went into Excel (not into Access), then in file, Options, Add-ins, I clicked on Go after having selected COM Add-ins. And I unticked \"eformity Document Builder Microsoft Office Add-in\".\nI think we can do it with a vba code from access :</p>\n\n<pre><code>Sub UntickAddIns()\nFor i = 1 To Excel.Application.COMAddIns.Count\nIf Excel.Application.COMAddIns.Item(i).Description = \"eformity Document Builder Microsoft Office Add-in\" Then\nExcel.Application.COMAddIns.Item(i).Connect = False\nEnd If\nNext\nEnd Sub\n</code></pre>\n\n<p>I tried it and the only problem I had was that I didn't have the permission to change <code>Excel.Application.COMAddIns.Item(i).Connect</code> into <code>False</code>. I Don't know the solution yet but I don't think that's difficult.</p>\n"}], "owner": {"reputation": 11, "user_id": 11734634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55b0a624bd8a1734eec019bd6fadcf72?s=128&d=identicon&r=PG&f=1", "display_name": "AMDRDB", "link": "https://stackoverflow.com/users/11734634/amdrdb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562340009, "creation_date": 1562163499, "last_edit_date": 1562228245, "question_id": 56872158, "link": "https://stackoverflow.com/questions/56872158/why-does-excel-application-inputbox-leaves-an-hidden-excel-process", "title": "Why does Excel.Application.InputBox leaves an hidden Excel process?", "body": "<p>I am working on an Access database and I write a macro for it.\nI try to obtain cell references using an Excel.InputBox.Application, but sometimes, when I execute the following code, it leaves an hidden running Excel process.\nHow can I avoid this? Does anyone have an idea? Thank you in advance.</p>\n\n<p>I have already tried to write XLApp.Visible = False before XLApp.Quit.</p>\n\n<pre><code>Function TakesCellReference(Nom As String)\n    Dim XLApp As Object\n    Dim xlBook As Excel.Workbook\n    Set XLApp = CreateObject(\"Excel.Application\")\n    Set xlBook = XLApp.Workbooks.Open(FileName:=Nom, UpdateLinks:=3, ReadOnly:=False)\n    XLApp.Visible = True\n    Set cellule = XLApp.InputBox(Prompt:=\"S\u00e9lectionnez une cellule de la feuille et cliquez sur Ok pour continuer\", Type:=8)\n    TakesCellReference = cellule.Address\n    Set cellule = Nothing\n    xlBook.Close False\n    XLApp.Quit\n    Set xlBook = Nothing\n    Set XLApp = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "checkbox"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562165081, "post_id": 56871991, "comment_id": 100294007, "body": "Add a <code>Debug.Print backupfilename</code> instead of saving for the time being. Is the result a valid filename? I think you&#39;ll have to <code>Format</code> the <code>Date</code>. That said, I assume the current error has to do with the check box."}, {"owner": {"reputation": 31, "user_id": 11163322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb3dbdb8d5cb38b4c4be5527e3dc8bc?s=128&d=identicon&r=PG&f=1", "display_name": "HarrisonO", "link": "https://stackoverflow.com/users/11163322/harrisono"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562202590, "post_id": 56871991, "comment_id": 100307498, "body": "@BigBen After running the debugger, VBA is complaining about the &#39;SaveAs&#39; line. I&#39;ve done as you&#39;ve said and the filename is almost correct. It has an unnecessary &#39;.xlsm&#39; in it, which I&#39;ve fixed (see updated post)."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562203264, "post_id": 56871991, "comment_id": 100307583, "body": "Does the <code>Date</code> have slashes in it?"}, {"owner": {"reputation": 31, "user_id": 11163322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb3dbdb8d5cb38b4c4be5527e3dc8bc?s=128&d=identicon&r=PG&f=1", "display_name": "HarrisonO", "link": "https://stackoverflow.com/users/11163322/harrisono"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562206145, "post_id": 56871991, "comment_id": 100308033, "body": "@BigBen Good spot! Only problem is now I&#39;ve got another error. See UPDATE 3."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1562207255, "post_id": 56871991, "comment_id": 100308195, "body": "Why are you using <code>DateTime</code>? I see you have <code>formattedDateTime</code>. You can&#39;t have a colon <code>:</code> in the filename either. Get <code>backupfilename</code> to something that you&#39;re <i>sure</i> you can use, by manually trying to save a copy of that file with the new file name."}, {"owner": {"reputation": 31, "user_id": 11163322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb3dbdb8d5cb38b4c4be5527e3dc8bc?s=128&d=identicon&r=PG&f=1", "display_name": "HarrisonO", "link": "https://stackoverflow.com/users/11163322/harrisono"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1562214158, "post_id": 56871991, "comment_id": 100309299, "body": "@BigBen I can&#39;t believe I forgot that. Now I feel like an idiot."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 11163322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb3dbdb8d5cb38b4c4be5527e3dc8bc?s=128&d=identicon&r=PG&f=1", "display_name": "HarrisonO", "link": "https://stackoverflow.com/users/11163322/harrisono"}, "is_accepted": true, "score": 0, "last_activity_date": 1562214106, "creation_date": 1562214106, "answer_id": 56880604, "question_id": 56871991, "link": "https://stackoverflow.com/questions/56871991/vba-savecopyas-method-outputting-cannot-find-file-error/56880604#56880604", "title": "VBA: SaveCopyAs Method Outputting Cannot Find File Error", "body": "<p>The argument for the SaveCopyAs call is missing the path of the file.</p>\n\n<p>Replace code with</p>\n\n<pre><code>Private Sub Workbook_open()\n    Dim backupFilename As String\n    Dim formattedDate As String\n    Dim tempFilename As String\n    Dim workingPath As String\n    Dim i As Integer\n    i = 1\n\n    If Sheets(\"Config\").OLEObjects(\"AutoBackupCheckbox\").Object.Value = True Then\n        formattedDate = Format(Date, \"d-MMMM-yyyy, ver \" &amp; i)\n        workingPath = Application.ActiveWorkbook.FullName\n        backupFilename = Replace(workingPath, \".xlsm\", \" - backup \" &amp; formattedDate &amp; \".xlsm\")\n        tempFilename = Dir(backupFilename)\n\n        While tempFilename &lt;&gt; \"\" ' if file already exists\n            i = i + 1\n            formattedDate = Format(Date, \"d-MMMM-yyyy, ver \" &amp; i)\n            backupFilename = Replace(workingPath, \".xlsm\", \" - backup \" &amp; formattedDate &amp; \".xlsm\")\n            tempFilename = Dir(backupFilename)\n        Wend\n\n        ActiveWorkbook.SaveCopyAs (backupFilename)\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 11163322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bb3dbdb8d5cb38b4c4be5527e3dc8bc?s=128&d=identicon&r=PG&f=1", "display_name": "HarrisonO", "link": "https://stackoverflow.com/users/11163322/harrisono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "accepted_answer_id": 56880604, "answer_count": 1, "score": 0, "last_activity_date": 1562214106, "creation_date": 1562162915, "last_edit_date": 1562206605, "question_id": 56871991, "link": "https://stackoverflow.com/questions/56871991/vba-savecopyas-method-outputting-cannot-find-file-error", "title": "VBA: SaveCopyAs Method Outputting Cannot Find File Error", "body": "<p>I'm modifying a Gantt chart excel template I found online by Vertex42 for added functionality.</p>\n\n<p>One of these modifications is a checkbox inside a sheet called \"Config\" that, when ticked, creates a backup of the Gantt chart whenever the document is opened.</p>\n\n<p>For some reason, I cannot get this simple task to work.</p>\n\n<p>I've tried using both the Form control and ActiveX control check boxes, with different error messages. As far as I can tell, the Form controls are unrecommended, so I'm using the code below in the ThisWorkbook excel object, based on what I've seen online.</p>\n\n<pre><code>Private Sub Workbook_open()\n    Dim backupFilename As String\n    Dim formattedDateTime As String\n\n    If Sheets(\"Config\").OLEObjects(\"AutoBackupCheckbox\").Object.Value = True Then\n        formattedDateTime = Format(Now, \"d-MMMM-yyyy, h:mm:ss\")\n        backupfilename = Replace(ActiveWorkbook.Name, \".xlsm\", \" - backup \" &amp; DateTime &amp; \".xlsm\")\n        ActiveWorkbook.SaveCopyAs (backupfilename)\n    End If\nEnd Sub\n</code></pre>\n\n<p>This code is getting me the error message whenever I open the document or run the debugger,</p>\n\n<pre><code>Run-time error '1004':\n\nSorry, we couldn't find the &lt;filename&gt; - backup &lt;day&gt;-&lt;month&gt;-&lt;year&gt;, &lt;hour&gt;:&lt;minute&gt;:&lt;seconds&gt;.xlsm. Is it possible it was moved, renamed or deleted?\n</code></pre>\n\n<p>Any ideas?</p>\n\n<p>UPDATE: After running the debugger, it's complaining on the <code>ActiveWorkbook.SaveAs</code> line.</p>\n\n<p>UPDATE 2: Changed format of 'backupFilename' to remove the '.xlsm' in the middle.</p>\n\n<p>UPDATE 3: Replaced Date with date/time without slashes, and replaced SaveAs with SaveCopyAs. Updated error message.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 1, "last_activity_date": 1562164316, "creation_date": 1562164316, "answer_id": 56872415, "question_id": 56871986, "link": "https://stackoverflow.com/questions/56871986/concatenate-combine-columns-with-time-format-and-general-format/56872415#56872415", "title": "Concatenate / Combine Columns with time format and general format", "body": "<p>Make this line: \n<code>Range(\"B\" &amp; i).Value = Range(\"B\" &amp; i).Value &amp; \" \" &amp; Range(\"A\" &amp; i).Value</code></p>\n\n<p>Into:\n<code>Range(\"B\" &amp; i).Value = format(Range(\"B\" &amp; i).Value, \"hh:mm\") &amp; \" \" &amp; Range(\"A\" &amp; i).Value</code></p>\n\n<p>This link has the different format strings: <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/format-function-visual-basic-for-applications</a></p>\n"}], "owner": {"reputation": 77, "user_id": 10979177, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216617496977177/picture?type=large", "display_name": "Andreas Hild", "link": "https://stackoverflow.com/users/10979177/andreas-hild"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 56872415, "answer_count": 1, "score": 0, "last_activity_date": 1562164316, "creation_date": 1562162904, "question_id": 56871986, "link": "https://stackoverflow.com/questions/56871986/concatenate-combine-columns-with-time-format-and-general-format", "title": "Concatenate / Combine Columns with time format and general format", "body": "<p>I'm stuck with a problem and can't find a solution. I want to concatenate cells with two different formats. One cells has the format \"tt:mm\" and the other cell has format \"general\" how would I concatenate the cells? I have seen online that this can be done in Exel with something like </p>\n\n<pre><code>=A1 &amp; TEXT(B1,\"tt:mm\")\n</code></pre>\n\n<p>or \n    =CONCATENATE(TEXT(A1;\"tt:mm\"); \" \";B1)</p>\n\n<p>But how is this done in VBA via a loop?</p>\n\n<p>I have tried to just add the cells together but I the date is not returned in the format that I want. </p>\n\n<pre><code>Sub  Merge()\nDim i As Long\nDim time As String\nLastRow = Range(\"A\" &amp; StartRow).End(xlDown).Row\n\nFor i = StartRow To LastRow\nRange(\"B\" &amp; i).Value = Range(\"B\" &amp; i).Value &amp; \" \" &amp; Range(\"A\" &amp; i).Value\nRange(\"B\" &amp; i).NumberFormat = \"tt:mm General\" \nEnd Sub    \n</code></pre>\n\n<p>So if I run this code for xyz and 02:30 then I get 0,15625 xyz but I want to get 02:30 xyz. </p>\n\n<p>Many thanks for any help.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 11458676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01b877870f662c6decefe582c9d6124?s=128&d=identicon&r=PG&f=1", "display_name": "Hamtash", "link": "https://stackoverflow.com/users/11458676/hamtash"}, "edited": false, "score": 0, "creation_date": 1562163233, "post_id": 56871974, "comment_id": 100292833, "body": "It does not work. I plot the new built up range in a chart. But it shows that the data order does not change. <code>chrt.SetSourceData Source:=rng</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 107, "user_id": 11458676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01b877870f662c6decefe582c9d6124?s=128&d=identicon&r=PG&f=1", "display_name": "Hamtash", "link": "https://stackoverflow.com/users/11458676/hamtash"}, "edited": false, "score": 1, "creation_date": 1562163890, "post_id": 56871974, "comment_id": 100293236, "body": "@Hamtash I told you if you want to change the order you will need to change the order in the worksheet itself. Ranges in VBA are just virtual pointers to the range of the worksheet. You cannot re-order it without moving the ranges in the sheet."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1562162862, "creation_date": 1562162862, "answer_id": 56871974, "question_id": 56871955, "link": "https://stackoverflow.com/questions/56871955/how-to-build-a-new-range-using-multiple-ranges-in-a-specific-order/56871974#56871974", "title": "How to build a new range using multiple ranges in a specific order?", "body": "<p>Use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.union\" rel=\"nofollow noreferrer\">Application.Union method</a> to combine 2 ranges:</p>\n\n<pre><code>Set rng = Application.Union(rng1, rng2)\n</code></pre>\n\n<p>A combination of ranges does not have any order. If you want to re-arrange the ranges you will need to do that on the worksheet itself or read the data into an array (in the order you want to have them).</p>\n"}], "owner": {"reputation": 107, "user_id": 11458676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d01b877870f662c6decefe582c9d6124?s=128&d=identicon&r=PG&f=1", "display_name": "Hamtash", "link": "https://stackoverflow.com/users/11458676/hamtash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562163861, "creation_date": 1562162806, "last_edit_date": 1562163861, "question_id": 56871955, "link": "https://stackoverflow.com/questions/56871955/how-to-build-a-new-range-using-multiple-ranges-in-a-specific-order", "title": "How to build a new range using multiple ranges in a specific order?", "body": "<p>I have an excel table ranged from A to E columns with 50 rows. Row 1 is the header of table. I want to define a Range object that contains C2:C50 and B2:B50 with this order. It means that final object needs to be a matrix of 2x49 that first column is made from  data in C and second column from B. I used the following commands, but it still returns the data in the same order as it is in the reference table. (first B, second C). Anyone has any idea?</p>\n\n<pre><code>Set rng1 = Sheets(\"Sheets1\").Range(\"C2:C50\") \nSet rng2 = Sheets(\"Sheets1\").Range(\"B2:B50\") \n\nSet rng = Range(rng1.Address &amp; \",\" &amp; rng2.Address)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562164122, "post_id": 56871652, "comment_id": 100293369, "body": "If your ActiveChart is an embedded chart and not a chart sheet, you will experience an error."}, {"owner": {"reputation": 1, "user_id": 7344271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b98d65ce8157d53bf46e1318f646da?s=128&d=identicon&r=PG&f=1", "display_name": "Boris", "link": "https://stackoverflow.com/users/7344271/boris"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562340496, "post_id": 56871652, "comment_id": 100356260, "body": "Thank you. I figured out myself that something is wrong in my code. It doesn&#39;t work for both embedded and chart sheet. I&#39;m gently asking how to make it working? - Thank you."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562340643, "post_id": 56871652, "comment_id": 100356331, "body": "is this your full code?"}], "answers": [{"comments": [{"owner": {"reputation": 193, "user_id": 3217145, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/RF5Vp.jpg?s=128&g=1", "display_name": "Phoenix14830", "link": "https://stackoverflow.com/users/3217145/phoenix14830"}, "edited": false, "score": 0, "creation_date": 1573070450, "post_id": 58236234, "comment_id": 103765301, "body": "I did this and got a count of zero in chart that had 19 series items in it."}], "tags": [], "owner": {"reputation": 1, "user_id": 7401818, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aac1b7768e4ac5b00ad05212e94dfdb6?s=128&d=identicon&r=PG&f=1", "display_name": "Merijn van den Berg", "link": "https://stackoverflow.com/users/7401818/merijn-van-den-berg"}, "is_accepted": false, "score": 0, "last_activity_date": 1570191301, "creation_date": 1570191301, "answer_id": 58236234, "question_id": 56871652, "link": "https://stackoverflow.com/questions/56871652/how-to-count-the-series-in-a-scatter-chart/58236234#58236234", "title": "How to count the series in a scatter chart", "body": "<p>Simply use ActiveChart.SeriesCollection.Count instead.</p>\n"}], "owner": {"reputation": 1, "user_id": 7344271, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91b98d65ce8157d53bf46e1318f646da?s=128&d=identicon&r=PG&f=1", "display_name": "Boris", "link": "https://stackoverflow.com/users/7344271/boris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570191301, "creation_date": 1562161748, "last_edit_date": 1562166600, "question_id": 56871652, "link": "https://stackoverflow.com/questions/56871652/how-to-count-the-series-in-a-scatter-chart", "title": "How to count the series in a scatter chart", "body": "<p>Excel 2016 (O365?) makes all markers in a chart as circles. I want to make them different. The idea is to determine the number of series in a chart and make the changes within a <code>For ...To (number of series) Next</code> loop. I have no idea how to find the <em>number of series</em>.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub aCountLines()\n\n    With ActiveChart\n        Dim lngSeriesCount As Long\n        lngSeriesCount = .ChartObjects(1).Chart.SeriesCollection.Count\n        MsgBox (lngSeriesCount)\n    End With\nEnd Sub\n</code></pre>\n\n<p>Error Message: the item with the specified name wasn't found</p>\n"}, {"tags": ["vba", "database", "ms-access", "jet"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1562161222, "post_id": 56871464, "comment_id": 100291735, "body": "As long as you don&#39;t know which data format the <code>.dat</code> file is you cannot read it. A <code>.dat</code> file can be anything you cannot tell the data format from the file extension. You will probably need to read that file with the original program that created the file."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 3, "creation_date": 1562162574, "post_id": 56871464, "comment_id": 100292480, "body": "Have you just tried changing the extension to .mdb? <i>Standard Jet DB</i> hints at a plain old mdb file, but Access might complain if the extension is wrong. The presence of an ldb file hints that it got closed incorrectly and might suffer from corruption."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1562162660, "post_id": 56871464, "comment_id": 100292524, "body": "Don&#39;t forget to backup your files before!"}, {"owner": {"reputation": 1, "user_id": 8333050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336ad9398a30c9d20856b9d07f089113?s=128&d=identicon&r=PG&f=1", "display_name": "Lediana", "link": "https://stackoverflow.com/users/8333050/lediana"}, "edited": false, "score": 0, "creation_date": 1562170609, "post_id": 56871464, "comment_id": 100297016, "body": "I tried to change the extension to .mdb it seems to open it but shows only one table not the rest of the data, btw the db is created in 2005"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562218166, "post_id": 56871464, "comment_id": 100310247, "body": "Actually this is not a question about programming and therefore <a href=\"https://stackoverflow.com/help/on-topic\">off-topic</a>: <i>&quot;Questions about general computing hardware and software are off-topic for Stack Overflow unless they directly involve tools used primarily for programming.&quot;</i>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4230992, "user_type": "registered", "profile_image": "https://graph.facebook.com/1385717532/picture?type=large", "display_name": "user270062", "link": "https://stackoverflow.com/users/4230992/user270062"}, "is_accepted": false, "score": 0, "last_activity_date": 1562163073, "creation_date": 1562163073, "answer_id": 56872039, "question_id": 56871464, "link": "https://stackoverflow.com/questions/56871464/how-to-extract-or-view-data-from-a-dat-file/56872039#56872039", "title": "How to extract or view data from a .dat file?", "body": "<p>If you just want to view any readable content from the file without any structure, a *nix environment includes a program called 'strings' which will output the printable character strings from a file and filter out the rest.</p>\n\n<p>I you're running Windows, sysinternals provides the same utility:</p>\n\n<p><a href=\"https://docs.microsoft.com/en-gb/sysinternals/downloads/strings\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-gb/sysinternals/downloads/strings</a></p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 11603090, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-yf6-zUcsK2Y/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfATCT2HJpdl24Qzeya_bMaEgseZw/mo/photo.jpg?sz=128", "display_name": "Marc Andrew", "link": "https://stackoverflow.com/users/11603090/marc-andrew"}, "is_accepted": false, "score": 1, "last_activity_date": 1562163348, "creation_date": 1562163348, "answer_id": 56872117, "question_id": 56871464, "link": "https://stackoverflow.com/questions/56871464/how-to-extract-or-view-data-from-a-dat-file/56872117#56872117", "title": "How to extract or view data from a .dat file?", "body": "<p>I looked around a bit and stumbled across this Visual Basic code here.</p>\n\n<pre><code>Set cat = CreateObject(\"ADOX.Catalog\")\nSet cn = CreateObject(\"ADODB.Connection\")\n\ncn.Open \"Provider=Microsoft.Jet.OLEDB.4.0;\" &amp; _\n              \"Data Source=C:\\Docs\\db1.dat;\"\n\nSet cat.ActiveConnection = cn\n\nFor Each t In cat.Tables\n    strList=t.Name &amp; vbcrlf &amp; strList\nNext \n\nMsgBox strList\n</code></pre>\n\n<p>Here's the <a href=\"https://www.tek-tips.com/viewthread.cfm?qid=1544710\" rel=\"nofollow noreferrer\">Forum Link</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8333050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336ad9398a30c9d20856b9d07f089113?s=128&d=identicon&r=PG&f=1", "display_name": "Lediana", "link": "https://stackoverflow.com/users/8333050/lediana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6340, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1594540702, "creation_date": 1562161058, "last_edit_date": 1594540702, "question_id": 56871464, "link": "https://stackoverflow.com/questions/56871464/how-to-extract-or-view-data-from-a-dat-file", "title": "How to extract or view data from a .dat file?", "body": "<p>I have a directory with the following files: \n<code>Data.dat</code>\n<code>Data.ldb</code>\n<code>Program.exe</code>\n<code>prog.UDL</code></p>\n\n<p>I want to access the data in Data.dat which is 82mb large\nAny solution?</p>\n\n<p>I tried to run the program but it throws an error that it cannot connect to database. I was wondering if there is a way to access the data.dat file and view the data. When I try to open it with a text editor it looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2oz48.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2oz48.png\" alt=\"enter image description here\"></a>\nI managed to view the file with MDB Viewer Plus and this is what I'm getting; a list of tables with this sort of encrypted data: </p>\n\n<p><a href=\"https://i.stack.imgur.com/HX58T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HX58T.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562161269, "post_id": 56871346, "comment_id": 100291770, "body": "try <code>Debug.Print cell.Value</code> just before the problematic line and see what you get"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11692076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb29ca7c7eaf2dfd76ab488bc26d5b1c?s=128&d=identicon&r=PG", "display_name": "DXR", "link": "https://stackoverflow.com/users/11692076/dxr"}, "edited": false, "score": 0, "creation_date": 1562664298, "post_id": 56872136, "comment_id": 100437745, "body": "Thank you @tigeravatar  ! Generating the Listboxes works now properly, I am now having problems with reading values. It seems I cannot read out the items from those generated ListBoxes which I named lb.name = &quot;ListBox&quot; &amp; i.  <code>If ListBox1.SelectedItems.Count = 0 Then     MsgBox &quot;No Item Selected&quot; End If</code>  - Throws the error &quot;Object not found&quot;"}], "tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1562163413, "creation_date": 1562163413, "answer_id": 56872136, "question_id": 56871346, "link": "https://stackoverflow.com/questions/56871346/how-to-address-generated-listboxes-and-add-items-dynamically-in-vba/56872136#56872136", "title": "How to address generated ListBoxes and add Items dynamically in VBA?", "body": "<p>Use the .ControlFormat.ListFillRange instead, and set MultiSelect to 3.  Something like this should work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim FS As Worksheet\n    Dim lb As Shape\n    Dim i As Long\n\n    Set FS = ActiveWorkbook.Worksheets(\"FS\")\n    For i = FS.Columns(\"A\").Column To FS.Cells(1, FS.Columns.Count).End(xlToLeft).Column\n        Set lb = FS.Shapes.AddFormControl(xlListBox, (i - 1) * 100 + 10, 10, 100, 100)\n        With lb\n            .ControlFormat.MultiSelect = 3\n            .ControlFormat.ListFillRange = FS.Range(FS.Cells(1, i), FS.Cells(FS.Rows.Count, i).End(xlUp)).Address(External:=True)\n        End With\n    Next i\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 11692076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb29ca7c7eaf2dfd76ab488bc26d5b1c?s=128&d=identicon&r=PG", "display_name": "DXR", "link": "https://stackoverflow.com/users/11692076/dxr"}, "edited": false, "score": 0, "creation_date": 1562664174, "post_id": 56872159, "comment_id": 100437669, "body": "Thank you @Stavros ! Generating the Listboxes works now properly, I am now having problems with reading values. It seems I cannot read out the items from those generated ListBoxes which I named lb.name = &quot;ListBox&quot; &amp; i.  <code>If ListBox1.SelectedItems.Count = 0 Then     MsgBox &quot;No Item Selected&quot; End If</code>  - Throws the error &quot;Object not found&quot;"}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 17, "user_id": 11692076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb29ca7c7eaf2dfd76ab488bc26d5b1c?s=128&d=identicon&r=PG", "display_name": "DXR", "link": "https://stackoverflow.com/users/11692076/dxr"}, "edited": false, "score": 0, "creation_date": 1562667474, "post_id": 56872159, "comment_id": 100439367, "body": "@DXR I have updated my post to answer to your comment. If this has solved your issues please consider accepting it as an answer."}, {"owner": {"reputation": 17, "user_id": 11692076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb29ca7c7eaf2dfd76ab488bc26d5b1c?s=128&d=identicon&r=PG", "display_name": "DXR", "link": "https://stackoverflow.com/users/11692076/dxr"}, "edited": false, "score": 0, "creation_date": 1562677560, "post_id": 56872159, "comment_id": 100444954, "body": "Hi thank you so much for your help @stavros ! I have two concerns: 1) Why do you need to define the variable &quot;i&quot; as &quot;long&quot;. Wouldnt &quot;integer&quot; be enough? 2) Is it possible to programm a &quot;OnClick&quot; event on Form Listboxes? e.g.: Selecting an item in Listbox1 automatically generates a second Listbox with further items."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "reply_to_user": {"reputation": 17, "user_id": 11692076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb29ca7c7eaf2dfd76ab488bc26d5b1c?s=128&d=identicon&r=PG", "display_name": "DXR", "link": "https://stackoverflow.com/users/11692076/dxr"}, "edited": false, "score": 0, "creation_date": 1562681239, "post_id": 56872159, "comment_id": 100447183, "body": "@DXR you could for example build a <code>Sub</code> in <code>Module1</code> and use the <code>.OnAction</code> property of the list box. When the listbox is created you can set this property like <code>lb.OnAction = &quot;Module1.runThis&quot;</code>, where <code>runThis</code> is the <code>sub</code> you want to run whenever the listbox is clicked. For more info I suggest you post a new question"}], "tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": true, "score": 0, "last_activity_date": 1562667390, "last_edit_date": 1562667390, "creation_date": 1562163500, "answer_id": 56872159, "question_id": 56871346, "link": "https://stackoverflow.com/questions/56871346/how-to-address-generated-listboxes-and-add-items-dynamically-in-vba/56872159#56872159", "title": "How to address generated ListBoxes and add Items dynamically in VBA?", "body": "<p>I suggest you do it like so:</p>\n\n<pre><code>Sub test()\n''''Declarations'''''''''''''''''''''''''''\nDim lb As ListBox                           '\nDim sht As Worksheet                        '\nDim rng As Range                            '\nDim cell As Range                           '\nDim i As Long                               '\n'''''''''''''''''''''''''''''''''''''''''''''\nSet sht = ThisWorkbook.Worksheets(\"Name of your worksheet\")\nFor i = 1 To 10\n    With sht\n        Set rng = .Range(.Cells(1, i), .Cells(.Rows.Count, i).End(xlUp))\n        Set lb = sht.ListBoxes.Add(100 * i, 10, 100, 100) 'just an indicative way to create the List boxes without them overlapping\n    End With\n    lb.Name = \"ListBox\" &amp; i\n    lb.MultiSelect = 2\n    For Each cell In rng\n        lb.AddItem cell.Value\n    Next cell\nNext i\nEnd Sub\n</code></pre>\n\n<p><strong>UPDATE</strong> (to cover the comment made)</p>\n\n<p>I updated the code above to name the list boxes as \"ListBox1\" , \"ListBox2\" etc instead of \"List Box 1\"etc.</p>\n\n<p>To refer to one of the list boxes you need to use a reference to the collection of <code>ListBoxes</code>. This collection belongs to the sheet where the listboxes are located. For example, to refer to \"ListBoxi\", where i=1,2...n you need to do it like so:</p>\n\n<pre><code>sht.ListBoxes(\"ListBox\" &amp; i)\n</code></pre>\n\n<p>Unfortunately there is no <code>.SelectedItems.Count</code> or similar method, that I know of, which you can use with a form control List Box.</p>\n\n<p>Having that in mind, you can find the number of selected items of \"ListBox1\" for example, like so:</p>\n\n<pre><code>Dim selectedItems As Long\nselectedItems = 0\nSet lb = sht.ListBoxes(\"ListBox\" &amp; 1)\nFor i = 1 To lb.ListCount Step 1\n    If lb.Selected(i) Then\n        selectedItems = selectedItems + 1\n    End If\nNext i\nIf selectedItems = 0 Then\n    MsgBox \"No user selected\"\nEnd If\n</code></pre>\n\n<p>A few things to keep in mind:</p>\n\n<ol>\n<li>The index of the first item varies from <code>0</code> to <code>1</code> depending on whether the list box is on a userform or not</li>\n<li>To refer to a listbox using it's name like <code>Listbox1.DoSomething</code>, it needs to be an <code>ActiveX</code> control and not a Form control.</li>\n</ol>\n"}], "owner": {"reputation": 17, "user_id": 11692076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb29ca7c7eaf2dfd76ab488bc26d5b1c?s=128&d=identicon&r=PG", "display_name": "DXR", "link": "https://stackoverflow.com/users/11692076/dxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 602, "favorite_count": 0, "accepted_answer_id": 56872159, "answer_count": 2, "score": 1, "last_activity_date": 1562667390, "creation_date": 1562160688, "question_id": 56871346, "link": "https://stackoverflow.com/questions/56871346/how-to-address-generated-listboxes-and-add-items-dynamically-in-vba", "title": "How to address generated ListBoxes and add Items dynamically in VBA?", "body": "<p>I successfully managed to generate ListBoxes dynamically. But I am now struggling with addressing and populating those generated ListBoxes. Additionally, I can't figure out how to activate the MultiSelect Property of those ListBoxes. Is that only possible with ActiveX?</p>\n\n<p>I first tried ActiveX - ListBoxes on userForm. Now I switched back to \"normal\" ListBoxes on the WorkSheet. \"FS\" is the name of my Worksheet which I am working on. For understanding: I am looping through the columns on worksheet FS and creating one ListBox per Column. In each ListBox the entries of the according column will be added.</p>\n\n<pre><code>For i = 1 To 10\n    LastRow = FS.Cells(Rows.Count, i).End(xlUp).Row\n        With FS\n            Set lb = FS.Shapes.AddFormControl(xlListBox, 100, 10, 100, 100)\n            lb.ControlFormat.MultiSelect = 2\n            For Each cell In FS.Range(Cells(1, i), Cells(LastRow,i)).Cells\n                    lb.ControlFormat.AddItem cell.Value 'This is the problematic line\n            Next cell\n        End With\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "csv", "vbscript"], "comments": [{"owner": {"reputation": 10618, "user_id": 2018133, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3fd4734236360fc59fa597dc8f9ffa7?s=128&d=identicon&r=PG", "display_name": "Geert Bellekens", "link": "https://stackoverflow.com/users/2018133/geert-bellekens"}, "edited": false, "score": 0, "creation_date": 1562168134, "post_id": 56871202, "comment_id": 100295780, "body": "That is because Excel exports according to the standard csv format. It only adds double quotes if needed. What you want is not standard csv."}], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 11504559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vDlIqKMXg-M/AAAAAAAAAAI/AAAAAAAFNW8/9WyK9eeHe9k/photo.jpg?sz=128", "display_name": "Toby", "link": "https://stackoverflow.com/users/11504559/toby"}, "is_accepted": false, "score": 0, "last_activity_date": 1562164963, "creation_date": 1562164963, "answer_id": 56872620, "question_id": 56871202, "link": "https://stackoverflow.com/questions/56871202/how-can-i-export-my-csv-from-excel-with-quotes/56872620#56872620", "title": "How can I export my csv from Excel with quotes?", "body": "<p>I've just had a thought, I could run another script on the output file CSV that contains the three quotes and replace it with one.</p>\n\n<pre><code>Const ForReading = 1\nConst ForWriting = 2\n\nSet objFSO = CreateObject(\"Scripting.FileSystemObject\")\nSet objFile = objFSO.OpenTextFile(\"test.csv\", ForReading)\n\nstrText = objFile.ReadAll\nobjFile.Close\nstrNewText = Replace(strText, CHR(34) &amp; CHR(34) &amp; CHR(34), CHR(34))\n\nSet objFile = objFSO.OpenTextFile(\"test.csv\", ForWriting)\nobjFile.WriteLine strNewText\n\nobjFile.Close\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1562167535, "last_edit_date": 1562167535, "creation_date": 1562167184, "answer_id": 56873344, "question_id": 56871202, "link": "https://stackoverflow.com/questions/56871202/how-can-i-export-my-csv-from-excel-with-quotes/56873344#56873344", "title": "How can I export my csv from Excel with quotes?", "body": "<p>You could write each line, formatted the way you want.</p>\n\n<p>Not sure about speed issues, however.</p>\n\n<pre><code>Option Explicit\nSub due()\n    Dim FSO As FileSystemObject\n    Dim TS As TextStream\n    Dim WS As Worksheet\n    Dim WB As Workbook\n    Dim myData As Variant\n    Dim I As Long\n\nSet WB = ThisWorkbook\nSet WS = WB.Worksheets(\"sheet2\")\n\nWith WS\n    myData = .Range(.Cells(1, 1), .Cells(.Rows.Count, 1).End(xlUp)).Resize(columnsize:=3)\nEnd With\n\nSet FSO = New FileSystemObject\nSet TS = FSO.CreateTextFile(\"C:\\Users\\Ron\\tester.csv\", True, False)\n\n'Don't put header row in quotes\n'  as spec said **Data in Quotes**\n\nWith TS\n    .WriteLine Join(WorksheetFunction.Index(myData, 1, 0), Chr(44))\n    For I = 2 To UBound(myData, 1)\n        TS.WriteLine Chr(34) &amp; Join(WorksheetFunction.Index(myData, I, 0), Chr(34) &amp; Chr(44) &amp; Chr(34)) &amp; Chr(34)\n    Next I\n    TS.Close\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Original Data on Worksheet</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/EO1UY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EO1UY.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Result in Notepad++</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/3PMBI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3PMBI.png\" alt=\"enter image description here\"></a></p>\n\n<p>If the date column needs to be in a specific format, you can preprocess that column with something like, for example:</p>\n\n<pre><code>For I = 2 To UBound(myData, 1)\n    myData(I, 3) = Format(myData(I, 3), \"dd/mm/yyyy\")\nNext I\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 11504559, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-vDlIqKMXg-M/AAAAAAAAAAI/AAAAAAAFNW8/9WyK9eeHe9k/photo.jpg?sz=128", "display_name": "Toby", "link": "https://stackoverflow.com/users/11504559/toby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562167535, "creation_date": 1562160182, "last_edit_date": 1562162476, "question_id": 56871202, "link": "https://stackoverflow.com/questions/56871202/how-can-i-export-my-csv-from-excel-with-quotes", "title": "How can I export my csv from Excel with quotes?", "body": "<p>I need to export from Excel as CSV using VBScript. The database I'm importing the CSV into wants the data to be in quotes.</p>\n\n<pre><code>' Set output type constant\nConst xlCSV = 23\nConst xlYes = 1\nConst xlAscending = 1\nConst xlDescending = 2\n\n' Open Excel in background\nSet objExcel = CreateObject(\"Excel.Application\")\nobjExcel.DisplayAlerts = FALSE\n\n' Make Excel object visible\nobjExcel.visible = TRUE\n\n' Open source file   \nSet obj2 = objExcel.Workbooks.open(\"\\\\ntptc\\Public\\test\\bins\\DomesticCollectionItemsV2.csv\")\n\n' Set data format\nobj2.Worksheets(\"DomesticCollectionItemsV2\").range(\"D:E\").NumberFormat = \"0\"\nobj2.Worksheets(\"DomesticCollectionItemsV2\").range(\"Q:R\").NumberFormat = \"dd/mm/yyyy\"\nobj2.Worksheets(\"DomesticCollectionItemsV2\").range(\"X:Y\").NumberFormat = \"dd/mm/yyyy\"\n\n'Sort data\nSet objWorksheet = obj2.Worksheets(1)\nSet objRange = objWorksheet.UsedRange\nSet objRange1 = objExcel.Range(\"N1\")\nSet objRange2 = objExcel.Range(\"O1\")\nobjRange.Sort objRange1,xlYes\n\n' Remove duplicates\nobj2.Worksheets(\"DomesticCollectionItemsV2\").range(\"A:EE\").RemoveDuplicates Array(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15), xlYes\nobj2.Worksheets(\"DomesticCollectionItemsV2\").range(\"A:EE\").RemoveDuplicates Array(12,13,14,15,16,17,18,19,20,21,22,23,24,25), xlYes\n\n' Remove Expired and erroneous data \nDim myRow\n    For myRow = 5000 To 1 Step -1\n        If (obj2.Worksheets(\"DomesticCollectionItemsV2\").Cells(myRow, 14).Value = \"Expired\") Then\n            obj2.Worksheets(\"DomesticCollectionItemsV2\").Rows(myRow).EntireRow.Delete\n        End If\n\n        If (obj2.Worksheets(\"DomesticCollectionItemsV2\").Cells(myRow, 14).Value = \"Quotation\") Then\n            obj2.Worksheets(\"DomesticCollectionItemsV2\").Rows(myRow).EntireRow.Delete\n        End If\n    Next\n\n'Sort data\nobjRange.Sort objRange1, xlAscending, objRange2, , xlAscending, , , xlYes\n\n' Remove Expired and erroneous data \nDim myRow1\n    For myRow1 = 10000 To 1 Step -1\n\n        If (obj2.Worksheets(\"DomesticCollectionItemsV2\").Cells(myRow1, 15).Value = \"Assisted Collection Contract\") Then\n            obj2.Worksheets(\"DomesticCollectionItemsV2\").Rows(myRow1).EntireRow.Delete\n        End If\n\n        If (obj2.Worksheets(\"DomesticCollectionItemsV2\").Cells(myRow1, 15).Value = \"Clinical Waste Collection Service Contract\") Then\n            obj2.Worksheets(\"DomesticCollectionItemsV2\").Rows(myRow1).EntireRow.Delete\n        End If\n\n        If (obj2.Worksheets(\"DomesticCollectionItemsV2\").Cells(myRow1, 15).Value = \"NULL\") Then  \n            obj2.Worksheets(\"DomesticCollectionItemsV2\").Rows(myRow1).EntireRow.Delete\n        End If\n    Next\n\n' Open template   \nSet obj1 = objExcel.Workbooks.open(\"\\\\ntptc\\Public\\test\\bins\\toby\\When-is-my-bin-day(new3).xlsx\")\n\n' Copy from source file to template\nobj2.Worksheets(\"DomesticCollectionItemsV2\").range(\"A1:AE110000\").copy\nobj1.Worksheets(\"DataTransform\").range(\"A:AE\").pastespecial\nobj1.Worksheets(\"DataTransform\").range(\"D:E\").NumberFormat = \"0\"\nobj1.Worksheets(\"DataTransform\").range(\"Q:R\").NumberFormat = \"dd/mm/yyyy\"\nobj1.Worksheets(\"DataTransform\").range(\"X:Y\").NumberFormat = \"dd/mm/yyyy\"\n\n' Close Source file\nobj2.Close False\n\n' Copy within template\nobj1.Worksheets(\"DataTransform\").range(\"AN:AP\").copy\nobj1.Worksheets(\"Export File\").range(\"A:C\").PasteSpecial -4163\n'obj1.Worksheets(\"Export File\").range(\"A:A\").NumberFormat = \"0\"\nobj1.Worksheets(\"Export File\").range(\"C:C\").NumberFormat = \"dd/mm/yyyy\"\nobj1.Worksheets(\"DataTransform\").range(\"AR:BB\").copy\nobj1.Worksheets(\"Export File\").range(\"D:N\").PasteSpecial -4163\n\n' Remove duplicates\nobj1.Worksheets(\"Export File\").range(\"A:N\").RemoveDuplicates Array(1,2,3,4,5,6,7,8,9,10,11,12,13,14), xlYes\n\n' Set worksheet to be exported\nSet obj3 = obj1.Worksheets(\"Export File\")\n\n' Save output as CSV\nobj3.SaveAs \"\\\\ntptc\\Public\\test\\bins\\KESCollections.csv\", xlCSV\n\n' Close Template\nobj1.Close False\n\n' Close Excel                                             \nobjExcel.Quit\n</code></pre>\n\n<p>If I add the quotes or format the cell in Excel to add the quotes, it outputs with three lots of quotes each side of the cell data.</p>\n\n<p>I've tried formatting the columns as custom using <code>\"\\0\\\"</code> or <code>\"\\@\\\"</code>. I've tried adding the quotes in VBS but whatever I do I still get too many quotes in the CSV</p>\n\n<p>Original output</p>\n\n<pre><code>100060018803,Garden Waste Collection Service,09/07/2019\n</code></pre>\n\n<p>Actual output</p>\n\n<pre><code>\"\"\"100060018803\"\"\",\"\"\"Garden Waste Collection Service\"\"\",\"\"\"09/07/2019\"\"\"\n</code></pre>\n\n<p>Desired output</p>\n\n<pre><code>\"100060018803\",\"Garden Waste Collection Service\",\"09/07/2019\"\n</code></pre>\n\n<p>Is there anyway to get it to output the CSV with just one set of quotes?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1562160662, "post_id": 56871008, "comment_id": 100291367, "body": "You can work with the <code>Selection</code> directly, e.g., <code>Selection.Cut</code> But this is generally frowned upon, as a rule <code>Selection</code> should really only be used as initial user input, you shouldn&#39;t be writing code that simulates mouse-clicks, keystrokes, etc., because there are vastly more efficient ways to do this using the API/object model."}], "owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562160658, "creation_date": 1562159627, "last_edit_date": 1562160658, "question_id": 56871008, "link": "https://stackoverflow.com/questions/56871008/cut-and-paste-without-range", "title": "Cut and paste without range", "body": "<p>So i need to cut and replace some specific cells, but i cant cut the second part because i dont want to specify the range cells since im going to repeat this a couple of times.</p>\n\n<p>This is for a VBA in excell</p>\n\n<pre><code>Sub Recc()\nActiveWindow.Activate\n\n    'This is the only one i want to specify\n    ActiveSheet.Range(\"A175:C203\").Select\n    Range(\"A175:C203\").Cut\n    Range(\"A175:C203\").Offset(-34, 9).Select\n    ActiveSheet.paste\n    'I dont want to specify range here since the selection is already made\n    ActiveCell.Offset(34, -6).Select\n    ActiveCell.Resize(29, 8).Select\n\n    'i cant cut :(\n    ActiveSheet.Cut\n\nEnd Sub\n</code></pre>\n\n<p>I want the selection cut.</p>\n"}, {"tags": ["excel", "vba", "batch-file", "cmd"], "comments": [{"owner": {"reputation": 15376, "user_id": 588916, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9737fb0439f70903f8948ad3963d9cc?s=128&d=identicon&r=PG", "display_name": "collapsar", "link": "https://stackoverflow.com/users/588916/collapsar"}, "edited": false, "score": 0, "creation_date": 1562159861, "post_id": 56870889, "comment_id": 100290835, "body": "What is your driving application - batch file or excel/vba ? Which db do you query with SQL? Which is your query processor ? Do you use it to query/update an excel file? A general idea would be to loop over zip files and to compose a sequence of commands for each file, along the lines of  <code>for i=&lt;zip names&gt; do &lt;unzip&gt; &amp;&amp; &lt;query&gt;</code>. Otoh it might be a better idea to unzip concurrently, keeping several cores of your cpu busy (check with the process explorer whether the unzipping runs on 1 or more cores), and leaving the rest of your workflow as-is."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1562161308, "post_id": 56870889, "comment_id": 100291788, "body": "Hard to give advice without knowing more.  If the zips are large files on a network they will be slow.  You could try copying them to a local file to unzip and process?  It <i>might</i> speed things up."}, {"owner": {"reputation": 47, "user_id": 2963349, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e997f02026859b9145b6eec15ced3491?s=128&d=identicon&r=PG&f=1", "display_name": "SyteCyer", "link": "https://stackoverflow.com/users/2963349/sytecyer"}, "edited": false, "score": 0, "creation_date": 1562312216, "post_id": 56870889, "comment_id": 100342470, "body": "@Gareth - You&#39;re right, extracting from the local drive will be faster.  I did that back in the day when the logs were large originally, then they were updated to be smaller, so I went back to doing it directly over the network.  Now the files are large again.  Thanks for reminding me."}, {"owner": {"reputation": 47, "user_id": 2963349, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e997f02026859b9145b6eec15ced3491?s=128&d=identicon&r=PG&f=1", "display_name": "SyteCyer", "link": "https://stackoverflow.com/users/2963349/sytecyer"}, "edited": false, "score": 0, "creation_date": 1562313042, "post_id": 56870889, "comment_id": 100342891, "body": "Still hopeful these processes can run in parallel, though."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1563180518, "post_id": 56870889, "comment_id": 100600647, "body": "Note that VBA is single threaded only by design. That means all commands are run sequentially, parallel run of commands is not possible. Please also include your code (or a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>) into the question in order to help you."}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1563187864, "post_id": 56870889, "comment_id": 100604268, "body": "It might be possible to do what you need inside SQL and save a lot of these steps"}], "owner": {"reputation": 47, "user_id": 2963349, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e997f02026859b9145b6eec15ced3491?s=128&d=identicon&r=PG&f=1", "display_name": "SyteCyer", "link": "https://stackoverflow.com/users/2963349/sytecyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1565615672, "creation_date": 1562159328, "last_edit_date": 1565615672, "question_id": 56870889, "link": "https://stackoverflow.com/questions/56870889/can-i-call-a-command-window-to-run-while-also-calling-sql", "title": "Can I call a command window to run while also calling SQL?", "body": "<p>I have a Batch file.  I have a SQL query.  Each works fine the way it is. \n Currently I call the batch file, wait for it to finish.  Then I call the query.  Then I process all the data from each.</p>\n\n<p>The problem is, the batch file now takes about 13 minutes to extract zip files, <code>findstr</code> within those files, etc, due to the size the files have grown to due to code changes in the application that creates them.</p>\n\n<p>I want to save time by calling the batch file to start the process, then simultaneously call the SQL query which runs for 1-3 minutes before returning the results.  I can process the SQL results before the batch is finished spitting out its results.  But beyond that, I need the batch to finish before proceeding further.</p>\n\n<p>Through a series of Calls and Waits, can I make this happen?  16 minutes total is a LONG time.</p>\n\n<p>Alternatively, does anyone know of a faster way to <code>findstr</code> within ZIP files?  Each ZIP only has one file in it.</p>\n\n<p><strong>UPDATE:</strong>\nThe query is in no way related to the zip files, but i need data from both sources in order to process all data relevant to my work.<br>\nThe query pulls data from SQL Server and drops it into a sheet.  Excel takes data compiled by the <code>findstr</code> conducted in the batch files and creates more sheets.<br>\nThe zipped files are on a network and range from 1.5 - 5.5 MB, the extracted files are 18 - 62 MB roughly.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562159730, "post_id": 56870634, "comment_id": 100290741, "body": "Do you get an error or nothing is being copied?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1562160199, "post_id": 56870634, "comment_id": 100291063, "body": "If the data is stored in a table, In my opinion you will want to use the <code>ListObject</code> instead looping through a range."}, {"owner": {"reputation": 1, "user_id": 11734227, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2xQRkCzchAg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcDC9zkhqYc2Kdkc1zgOaPBHBsQTg/photo.jpg?sz=128", "display_name": "Enio Belo", "link": "https://stackoverflow.com/users/11734227/enio-belo"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562160303, "post_id": 56870634, "comment_id": 100291139, "body": "No error. Just don&#39;t do anything. - @Warcupine"}, {"owner": {"reputation": 1, "user_id": 11734227, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2xQRkCzchAg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcDC9zkhqYc2Kdkc1zgOaPBHBsQTg/photo.jpg?sz=128", "display_name": "Enio Belo", "link": "https://stackoverflow.com/users/11734227/enio-belo"}, "reply_to_user": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1562160404, "post_id": 56870634, "comment_id": 100291200, "body": "How can I do that? @ZackE"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1562160578, "post_id": 56870634, "comment_id": 100291305, "body": "Take a look at the second answer <a href=\"https://stackoverflow.com/questions/56469221/copy-a-filtered-table\">Here</a>"}, {"owner": {"reputation": 1, "user_id": 11734227, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2xQRkCzchAg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcDC9zkhqYc2Kdkc1zgOaPBHBsQTg/photo.jpg?sz=128", "display_name": "Enio Belo", "link": "https://stackoverflow.com/users/11734227/enio-belo"}, "edited": false, "score": 0, "creation_date": 1562161666, "post_id": 56870634, "comment_id": 100291989, "body": "sorry. I can&#39;t see how it works. I suck. can you help me do it?"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1562162858, "post_id": 56870634, "comment_id": 100292632, "body": "is <code>legid = ThisWorkbook.Worksheets(&quot;setup&quot;).Range(&quot;SelReq&quot;).Value</code> a single cell or is it a range of cells with names?"}, {"owner": {"reputation": 1, "user_id": 11734227, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2xQRkCzchAg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcDC9zkhqYc2Kdkc1zgOaPBHBsQTg/photo.jpg?sz=128", "display_name": "Enio Belo", "link": "https://stackoverflow.com/users/11734227/enio-belo"}, "edited": false, "score": 0, "creation_date": 1562163569, "post_id": 56870634, "comment_id": 100293023, "body": "it&#39;s a cell. the refect a value like this: <a href=\"https://ibb.co/wwH1XRZ\" rel=\"nofollow noreferrer\">ibb.co/wwH1XRZ</a>"}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "edited": false, "score": 0, "creation_date": 1562165732, "post_id": 56870634, "comment_id": 100294422, "body": "Take a look at the answer below."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11734227, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2xQRkCzchAg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcDC9zkhqYc2Kdkc1zgOaPBHBsQTg/photo.jpg?sz=128", "display_name": "Enio Belo", "link": "https://stackoverflow.com/users/11734227/enio-belo"}, "edited": false, "score": 0, "creation_date": 1562221656, "post_id": 56872878, "comment_id": 100311448, "body": "Thanks @zack e. Your code wasn&#39;t working on my excel. so i try to copy a portion of the tablees to a new excel and my code and your code is working. so my question is. the code doesn&#39;t work on query tables?"}], "tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": false, "score": 0, "last_activity_date": 1562165639, "creation_date": 1562165639, "answer_id": 56872878, "question_id": 56870634, "link": "https://stackoverflow.com/questions/56870634/vba-copy-mutlipe-rows-that-meet-criteria-to-another-sheet/56872878#56872878", "title": "VBA copy mutlipe rows that meet criteria to another sheet", "body": "<p>If you are looking to just get the names copied over.  You can use this; however you will need to update your sheet names and ranges if they are named ranges.  This code looks at a specific cell for a value on Sheet3 then if that value matches a value from a range on Sheet1 it will place the values from Column B on Sheet1 into Sheet2</p>\n\n<pre><code>Sub Test()\n    Dim cell As Range\n    Dim LastRow As Long, i As Long, j As Long\n    Dim legid As String\n\n\n    With Sheet1\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    End With\n\n    With Sheet2\n        j = .Cells(.Rows.Count, \"A\").End(xlUp).Row + 1\n    End With\n\n    legid = Sheet3.Range(\"A1\")\n\n    For i = 2 To LastRow\n        For Each cell In Sheet1.Range(\"A\" &amp; i)\n            If cell.Value = legid Then\n                Sheet2.Range(\"A\" &amp; j) = cell.Offset(0, 1).Value\n                j = j + 1\n            End If\n        Next cell\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11734227, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2xQRkCzchAg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcDC9zkhqYc2Kdkc1zgOaPBHBsQTg/photo.jpg?sz=128", "display_name": "Enio Belo", "link": "https://stackoverflow.com/users/11734227/enio-belo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562165639, "creation_date": 1562158413, "last_edit_date": 1562158732, "question_id": 56870634, "link": "https://stackoverflow.com/questions/56870634/vba-copy-mutlipe-rows-that-meet-criteria-to-another-sheet", "title": "VBA copy mutlipe rows that meet criteria to another sheet", "body": "<p>I really don't understand much VBA, so be patient with me. </p>\n\n<p>I have a list of people assigned to a specific flight (LEGID) and I want to copy those people (Worksheet pax)  to a specific cell in another worksheet (temp - cell b15), but it doesn't work.</p>\n\n<p>This data table is a query report from salesforce. </p>\n\n<pre><code>Sub pax()\n\n   Dim LastRow As Long\n   Dim i As Long, j As Long\n   Dim legid As String\n\nApplication.ScreenUpdating = False\n\nlegid = ThisWorkbook.Worksheets(\"setup\").Range(\"SelReq\").Value\n\nDebug.Print legid\n\n\n   'Find the last used row in a Column: column A in this example\n   With Worksheets(\"pax\")\n      LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n   End With\n\n'   MsgBox (LastRow)\n   'first row number where you need to paste values in temp'\n   With Worksheets(\"temp\")\n      j = .Cells(.Rows.Count, \"a\").End(xlUp).Row + 1\n   End With\n\n   For i = 1 To LastRow\n       With Worksheets(\"pax\")\n           If .Cells(i, 1).Value = legid Then\n               .Rows(i).Copy Destination:=Worksheets(\"temp\").Range(\"a\" &amp; j)\n               j = j + 1\n           End If\n       End With\n   Next i\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 1, "creation_date": 1562156231, "post_id": 56869936, "comment_id": 100288508, "body": "You would have better luck on codereview for optimization questions. However, If you get rid of the copy and paste and just dump the values directly it will significantly reduce the runtime."}, {"owner": {"reputation": 31833, "user_id": 23574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff71c4381eaf3816bffda6c6fe53d33e?s=128&d=identicon&r=PG", "display_name": "shahkalpesh", "link": "https://stackoverflow.com/users/23574/shahkalpesh"}, "edited": false, "score": 0, "creation_date": 1562156452, "post_id": 56869936, "comment_id": 100288640, "body": "To begin with, do <code>application.ScreenUpdating = False </code> before the loop and <code>application.ScreenUpdating = True</code> after the loop ends."}, {"owner": {"reputation": 15, "user_id": 9529483, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MULaker", "link": "https://stackoverflow.com/users/9529483/mulaker"}, "edited": false, "score": 0, "creation_date": 1562156636, "post_id": 56869936, "comment_id": 100288744, "body": "I forgot to add that into the code, it is there. That saved about 5 min."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562157517, "post_id": 56869936, "comment_id": 100289264, "body": "Also read this <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a> And you can do the pasting in one go without a loop or better still follow @Warcupine&#39;s suggestion."}], "answers": [{"tags": [], "owner": {"reputation": 894, "user_id": 10644878, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "D&#225;vid Laczk&#243;", "link": "https://stackoverflow.com/users/10644878/d%c3%a1vid-laczk%c3%b3"}, "is_accepted": false, "score": 0, "last_activity_date": 1562158256, "last_edit_date": 1562158256, "creation_date": 1562157860, "answer_id": 56870467, "question_id": 56869936, "link": "https://stackoverflow.com/questions/56869936/how-can-i-improve-the-efficiency-of-my-loop-for-a-large-application/56870467#56870467", "title": "How Can I Improve The Efficiency of my Loop For a Large Application", "body": "<p>Please remove the last <code>Sheets(\"Input Data\").Select</code> - that is unnecessary, as the loop begins with that.<br>\nSecondly, the internal for loop can be replaced with this operation that fills a range in batch:  </p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>LastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nRange(\"A\" &amp; LastRow &amp; \":A\" &amp; LastRow + 68).PasteSpecial\n</code></pre>\n\n<p>I think it should be faster, but further adjustments might be necessary.</p>\n"}, {"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1562157933, "creation_date": 1562157933, "answer_id": 56870490, "question_id": 56869936, "link": "https://stackoverflow.com/questions/56869936/how-can-i-improve-the-efficiency-of-my-loop-for-a-large-application/56870490#56870490", "title": "How Can I Improve The Efficiency of my Loop For a Large Application", "body": "<p>Instead of copying and pasting cells, read them once into memory into a 2-dimensional array and write the array into the destination. That speeds up the process dramatically.   </p>\n\n<p>Drawback (or advantage, depending on your needs): Only the values are copied.</p>\n\n<pre><code>Sub CopyRange(sourceRange As Range, destRange As Range, Optional howOften As Long = 1)\n\n    Dim arr As Variant\n    ' Fill arr with all values of sourceRange\n    arr = sourceRange.Value2\n    ' Adjust size of destination range\n    Set destRange = destRange.Resize(sourceRange.Rows.count, sourceRange.Columns.count)\n    Dim i As Long\n    For i = 1 To howOften\n        ' Copy the values to the destination\n        destRange.Value2 = arr\n        ' Move to the next place \n        Set destRange = destRange.Offset(sourceRange.Rows.count)\n    Next\nEnd Sub\n</code></pre>\n\n<p>Assuming that <code>rng</code> is set to the range you want to copy, the call to the routine can look like</p>\n\n<pre><code>call CopyRangeSheets(rng, ThisWorkbook.Sheets(\"TrialSheet\").Range(\"A1\"), 68)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1562201880, "last_edit_date": 1592644375, "creation_date": 1562201880, "answer_id": 56879484, "question_id": 56869936, "link": "https://stackoverflow.com/questions/56869936/how-can-i-improve-the-efficiency-of-my-loop-for-a-large-application/56879484#56879484", "title": "How Can I Improve The Efficiency of my Loop For a Large Application", "body": "<p>Since no information was available about the size of source range being copied</p>\n<p>Following grey areas of the question is assumed as follows</p>\n<ol>\n<li><p>Since 191 Rows X 68 copy X 3 columns take around 10 minutes only (with you code), the range is about 191 Rows X 15 Columns in size</p>\n</li>\n<li><p>since it has been claimed that code is working Correctly. The Cells of the range (irrespective of their row or column positions) is being copied in column A only (below one and another). Though it contradicts the statement &quot;automate creation of a data table&quot;</p>\n</li>\n<li><p>Since the cells of the ranges are being copied and pasted. In test case formulas are copied only.</p>\n<p>So the code below will just replicate what your code is doing with some increased efficiency. As I personally don't prefer to keep calculations, event processing and screen updating off (in normal cases) i haven't added that standard lines. However you may use these standard techniques, depending on the working file condition. Make necessary changes regarding Range etc</p>\n</li>\n</ol>\n<p>Code takes only 2-3 seconds to complete with  191 Rows X 15 columns X 68 Copies:</p>\n<pre><code>Sub test()\nDim SrcWs As Worksheet, DstWs As Worksheet, SrcArr As Variant\nDim Rng As Range, cell As Range, DstArr() As Variant\nDim X As Long, Y As Long, Z As Long, i As Long, LastRow As Long\nDim Chunk60K As Long\nDim tm As Double\ntm = Timer\nSet SrcWs = ThisWorkbook.Sheets(&quot;Input Data&quot;)\nSet DstWs = ThisWorkbook.Sheets(&quot;TrialSheet&quot;)\n\nSet Rng = SrcWs.Range(&quot;A1:O191&quot;)\nSrcArr = Rng.Formula\n    \nLastRow = DstWs.Cells(Rows.Count, &quot;A&quot;).End(xlUp).Row + 1\nChunk60K = 0\nZ = 1\n    For X = 1 To UBound(SrcArr, 1)\n    For Y = 1 To UBound(SrcArr, 2)\n    For i = 1 To 68\n        ReDim Preserve DstArr(1 To Z)\n        DstArr(Z) = SrcArr(X, Y)\n    \n        If Z = 60000 Then  ' To Overcome 65K limit of Application.Transpose\n        DstWs.Range(&quot;A&quot; &amp; Chunk60K * 60000 + LastRow).Resize(UBound(DstArr, 1), 1).Formula = Application.Transpose(DstArr)\n        Chunk60K = Chunk60K + 1\n        Z = 1\n        ReDim DstArr(1 To 1)\n        Debug.Print &quot;Chunk: &quot; &amp; Chunk60K &amp; &quot; Seconds Taken: &quot; &amp; Timer - tm\n        Else\n        Z = Z + 1\n        End If\n    \n    Next i\n    Next Y\n    Next X\n\nIf Z &gt; 1 Then DstWs.Range(&quot;A&quot; &amp; Chunk60K * 60000 + LastRow).Resize(UBound(DstArr, 1), 1).Formula = Application.Transpose(DstArr)\n\nDebug.Print &quot;Seconds Taken: &quot; &amp; Timer - tm\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 9529483, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "MULaker", "link": "https://stackoverflow.com/users/9529483/mulaker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1562201880, "creation_date": 1562156076, "last_edit_date": 1562156150, "question_id": 56869936, "link": "https://stackoverflow.com/questions/56869936/how-can-i-improve-the-efficiency-of-my-loop-for-a-large-application", "title": "How Can I Improve The Efficiency of my Loop For a Large Application", "body": "<p>I have created a large VBA program to automate creation of a data table that is needed to run slicers in an Excel file. While the loop works well in creating what I need. The main loop take an hour to create the list of company names that I need. I was wondering if there is a way to improve the time it takes for the loop to complete. I have 191 rows that need to be copied and then pasted 68 times each into the new sheet. I have tried a few different approaches to improve the time and have only reduced the time required to about 50 minutes. Any help would be much appreciated. I know that using select is horrible for time efficiency but all the other options I have tried have not worked well.   </p>\n\n<pre><code>Dim rng As Range, cell As Range\nFor Each cell In rng\n\n    Sheets(\"Input Data\").Select\n    cell.Select\n    cell.Copy\n    Sheets(\"TrialSheet\").Select\n    For i = 1 To 68\n        LastRow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row + 1\n        Range(\"A\" &amp; LastRow).Select\n        ActiveSheet.Paste\n    Next i\n\n    Sheets(\"Input Data\").Select\n\nNext cell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 4, "creation_date": 1562155986, "post_id": 56869838, "comment_id": 100288342, "body": "Do you have a Worksheet named &quot;Macros&quot;?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562157834, "post_id": 56869838, "comment_id": 100289466, "body": "Perhaps you have more than one workbook open."}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1562157884, "post_id": 56869838, "comment_id": 100289498, "body": "If you don&#39;t have &quot;Macros&quot; sheet, then macros will fail. If you need just first sheet (no matter what name it has), then use just <code>Sheets(1)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "is_accepted": false, "score": 0, "last_activity_date": 1562156950, "creation_date": 1562156950, "answer_id": 56870191, "question_id": 56869838, "link": "https://stackoverflow.com/questions/56869838/run-time-error-9-subscript-out-of-range/56870191#56870191", "title": "Run Time Error 9 - Subscript out of range", "body": "<p>Rather than calling it by name, since you want teh first one you can call it by it's index:</p>\n\n<pre><code>Sub OpenMenu()\n   ' Keyboard Shortcut: Ctrl+m\n\n   ActiveWorkbook.Worksheets(1).Activate\n   ActiveWorkbook.Worksheets(1).Cells(1, 1).Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11670451, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Va8xMP1WuEI/AAAAAAAAAAI/AAAAAAAAAFM/2xM-xQQyzYo/photo.jpg?sz=128", "display_name": "Jasjot Kaur", "link": "https://stackoverflow.com/users/11670451/jasjot-kaur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562156950, "creation_date": 1562155723, "last_edit_date": 1562156109, "question_id": 56869838, "link": "https://stackoverflow.com/questions/56869838/run-time-error-9-subscript-out-of-range", "title": "Run Time Error 9 - Subscript out of range", "body": "<p>I am using the following code to return to the first page in the workbook.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub OpenMenu()\n   ' Keyboard Shortcut: Ctrl+m\n\n   ActiveWorkbook.Worksheets(\"Macros\").Activate\n   ActiveWorkbook.Worksheets(\"Macros\").Cells(1, 1).Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4632, "user_id": 674906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Qo3i.jpg?s=128&g=1", "display_name": "scgough", "link": "https://stackoverflow.com/users/674906/scgough"}, "edited": false, "score": 1, "creation_date": 1562155292, "post_id": 56869660, "comment_id": 100287884, "body": "You should post the code you have tried or have in progress so we can assist better."}, {"owner": {"reputation": 3, "user_id": 11664493, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J3xOaHLONmo/AAAAAAAAAAI/AAAAAAAAAC8/DPVVFhs2hjw/photo.jpg?sz=128", "display_name": "user11664493", "link": "https://stackoverflow.com/users/11664493/user11664493"}, "reply_to_user": {"reputation": 4632, "user_id": 674906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1Qo3i.jpg?s=128&g=1", "display_name": "scgough", "link": "https://stackoverflow.com/users/674906/scgough"}, "edited": false, "score": 0, "creation_date": 1562155571, "post_id": 56869660, "comment_id": 100288061, "body": "There is no code. I am trying to freeze specific column in excel sheet itself. I had tried Excel Freeze Panes option but it freeze only first column. couldn&#39;t find any other option."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562155878, "post_id": 56869660, "comment_id": 100288266, "body": "<a href=\"https://www.laptopmag.com/articles/freeze-rows-excel-2016\" rel=\"nofollow noreferrer\">laptopmag.com/articles/freeze-rows-excel-2016</a>"}], "answers": [{"tags": [], "owner": {"reputation": 136, "user_id": 3543239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3897acf89102562103c50506daaef51?s=128&d=identicon&r=PG&f=1", "display_name": "DeBugOfen", "link": "https://stackoverflow.com/users/3543239/debugofen"}, "is_accepted": false, "score": 0, "last_activity_date": 1562155994, "last_edit_date": 1562155994, "creation_date": 1562155693, "answer_id": 56869828, "question_id": 56869660, "link": "https://stackoverflow.com/questions/56869660/how-to-freeze-particular-column-in-excel-sheet/56869828#56869828", "title": "How to freeze particular column in Excel sheet?", "body": "<p>Try selecting J,1 then View->Freeze Panes->Freeze Panes</p>\n\n<p>The Freeze Panes option always freezes the top left corner of a selected cell</p>\n"}], "owner": {"reputation": 3, "user_id": 11664493, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-J3xOaHLONmo/AAAAAAAAAAI/AAAAAAAAAC8/DPVVFhs2hjw/photo.jpg?sz=128", "display_name": "user11664493", "link": "https://stackoverflow.com/users/11664493/user11664493"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1562155994, "creation_date": 1562155108, "question_id": 56869660, "link": "https://stackoverflow.com/questions/56869660/how-to-freeze-particular-column-in-excel-sheet", "title": "How to freeze particular column in Excel sheet?", "body": "<p>How do I freeze particular column in excel sheet ?\nExample : I want to freeze column J for entire worksheet.</p>\n\n<p>I have gone through many solutions but they only talks about column A. but I want to freeze other columns except Column A.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 1, "creation_date": 1562154802, "post_id": 56869343, "comment_id": 100287600, "body": "A few questions: 1. How do you call your Function? Give an example. 2. Why do you have IndexColumn seeing as you don&#39;t use it?"}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562156383, "post_id": 56869693, "comment_id": 100288606, "body": "Guess it doesn&#39;t matter much but won&#39;t MATCH return a Long (or an error)?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1562156577, "post_id": 56869693, "comment_id": 100288707, "body": "@SJR  I assumed a <code>Long</code> too but according to the documentation (I linked in my answer) <code>WorksheetFunction.Match</code> returns a <code>Double</code> or throws an exeption (it does not return an error value). \u2022 Actually I have no idea why it returns a <code>Double</code> because for row or column number a <code>Long</code> should be sufficient."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562157444, "post_id": 56869693, "comment_id": 100289221, "body": "So it does. Does seem a bit strange, but I suppose Long is a subset of Double."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562160007, "post_id": 56869693, "comment_id": 100290942, "body": "@SJR Yep, really strange. I never found a use case where this result should be <code>Double</code>  or why it has any advantage over beeing <code>Long</code>. Actually <code>Long</code> uses 4 bytes while <code>Double</code> uses 8 bytes which should be a reason for <code>Long</code>, also a row/column number cannot be a floating point number."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562160380, "post_id": 56869693, "comment_id": 100291190, "body": "Perhaps not the sort of thing MS would bother to change after all this time, or perhaps you&#39;re the only person to have noticed!"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1562156151, "last_edit_date": 1562156151, "creation_date": 1562155225, "answer_id": 56869693, "question_id": 56869343, "link": "https://stackoverflow.com/questions/56869343/cannot-match-a-date-in-a-range-using-match-function-and-vba/56869693#56869693", "title": "Cannot match a date in a range using MATCH function and VBA", "body": "<ol>\n<li>You need to convert your date into double to match it <code>CDbl(StartDate)</code></li>\n<li><p>The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.match\" rel=\"nofollow noreferrer\">WorksheetFunction.Match method</a> returns a <code>Double</code> therefore </p>\n\n<pre><code>Dim IndexRow As Double, IndexColumn As Double\n</code></pre>\n\n<p>you need to specify the type for <strong>both</strong> variables otherwise the first is automatically <code>Variant</code>.</p></li>\n<li>Use a test procedure to feed your UDF (user defined function) if you want to debug it.</li>\n</ol>\n\n<p>You end up with \u2026</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test_getParam()\n    Debug.Print getParam(\"B\", DateSerial(2019, 7, 5), Range(\"A1:E13\"))\nEnd Sub\n\nPublic Function getParam(Series As String, StartDate As Date, Parameters As Range) As Variant\n    Dim IndexRow As Double, IndexColumn As Double\n\n    IndexRow = Application.WorksheetFunction.Match(CDbl(StartDate), Parameters.Columns(1), 0)\n    IndexColumn = Application.WorksheetFunction.Match(Series, Parameters.Rows(1), 0)\n\n    getParam = Parameters.Cells(IndexRow, IndexColumn)\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>In your formula you need to submit a real date <code>DATE(2019,7,5)</code></p>\n\n<pre><code>=getParam(\"B\",DATE(2019,7,5),A1:E13) 'returns 10 with the data below\n</code></pre>\n\n<p>because if you submit <code>=getParam(\"B\",1/07/2005,Parameters)</code> your \"date\" is <code>1/07/2005</code> which actually means <code>1</code> devided by <code>7</code> devided by <code>2005</code> with the result of <code>0.0000712504453153\u2026</code> so this is the value you actually tried to match. You must use <code>DATE(2005,7,1)</code> to get a real date.</p>\n\n<p><a href=\"https://i.stack.imgur.com/itPrj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/itPrj.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>As a final improvement I recommend to include an error handling, to return an error if either date or series didn't match.</p>\n\n<p>This will return error <code>#NA</code> if one of these didn't match.</p>\n\n<pre><code>Public Function getParam(Series As String, StartDate As Date, Parameters As Range) As Variant\n    Dim IndexRow As Double, IndexColumn As Double\n\n    On Error Resume Next\n    IndexRow = Application.WorksheetFunction.Match(CDbl(StartDate), Parameters.Columns(1), 0)\n    IndexColumn = Application.WorksheetFunction.Match(Series, Parameters.Rows(1), 0)\n    On Error GoTo 0\n\n    If IndexRow &gt; 0 And IndexColumn &gt; 0 Then\n        getParam = Parameters.Cells(IndexRow, IndexColumn)\n    Else\n        getParam = CVErr(xlErrNA)\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 656, "user_id": 7149485, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/zvytA.png?s=128&g=1", "display_name": "brb", "link": "https://stackoverflow.com/users/7149485/brb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 56869693, "answer_count": 1, "score": 1, "last_activity_date": 1562156309, "creation_date": 1562154164, "last_edit_date": 1562156309, "question_id": 56869343, "link": "https://stackoverflow.com/questions/56869343/cannot-match-a-date-in-a-range-using-match-function-and-vba", "title": "Cannot match a date in a range using MATCH function and VBA", "body": "<p>I would like to write a user defined function that returns the value in a range given a series ID and a date.</p>\n\n<p>The range looks something like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/JrkVF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JrkVF.png\" alt=\"enter image description here\"></a></p>\n\n<p>I would like the function call <code>=getParam(\"B\",1/07/2005,Parameters)</code> to return <code>22</code>.</p>\n\n<p>To do this, I am using a couple of <code>=MATCH</code> functions to find the correct row and column and then will use an <code>=INDEX</code> function to return the correct value.  My function (not complete) is below.</p>\n\n<p>The problem:</p>\n\n<p>When I specify <code>=MATCH(1/07/2005,A1:A11,0)</code> in a normal Excel cell I get the correct row index of <code>6</code>, but when I incorporate this inside my VBA function as per below, I get a <code>#VALUE!</code> error.</p>\n\n<p>Any ideas?</p>\n\n<pre><code>Function getParam(Series As String, StartDate As Date, Parameters As Range)\n\n    Dim IndexRow, IndexColumn As Integer\n\n    IndexRow = Application.WorksheetFunction.Match(StartDate, Parameters.Columns(1), 0)\n    IndexColumn = Application.WorksheetFunction.Match(Series, Parameters.Rows(1), 0)\n\n    getParam = IndexRow\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops", "if-statement"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 3, "creation_date": 1562153531, "post_id": 56869113, "comment_id": 100286849, "body": "<code>a</code> starts with 0 and row numbers start with 1. Also calling a variable <code>name</code> is not he best idea."}, {"owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "edited": false, "score": 0, "creation_date": 1562153964, "post_id": 56869113, "comment_id": 100287117, "body": "Where exactly does the error occur? have you tried stepping through the code?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11733234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565d7b78062e810caece03e39a5d4b2?s=128&d=identicon&r=PG&f=1", "display_name": "Hugix", "link": "https://stackoverflow.com/users/11733234/hugix"}, "edited": false, "score": 0, "creation_date": 1562167995, "post_id": 56869227, "comment_id": 100295711, "body": "I changed it so precautionroww value is either 1 either emptyrow - 50 and it works :) Thanks a lot, beginner&#39;s mistake I suppose."}], "tags": [], "owner": {"reputation": 136, "user_id": 3543239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3897acf89102562103c50506daaef51?s=128&d=identicon&r=PG&f=1", "display_name": "DeBugOfen", "link": "https://stackoverflow.com/users/3543239/debugofen"}, "is_accepted": true, "score": 0, "last_activity_date": 1562153752, "creation_date": 1562153752, "answer_id": 56869227, "question_id": 56869113, "link": "https://stackoverflow.com/questions/56869113/how-to-make-an-if-statement-into-a-for-loop-in-vba/56869227#56869227", "title": "How to make an If Statement into a For Loop in VBA", "body": "<p>If your precautionroww is 0 because your emptyrow is below 50 you try to insert your data in row 0 which is causing the error</p>\n\n<p>Thats a problem within VBA if you have a for loop and start with the same value as your \"end\" value than i still runs 1 time.</p>\n"}], "owner": {"reputation": 3, "user_id": 11733234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e565d7b78062e810caece03e39a5d4b2?s=128&d=identicon&r=PG&f=1", "display_name": "Hugix", "link": "https://stackoverflow.com/users/11733234/hugix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 56869227, "answer_count": 1, "score": 0, "last_activity_date": 1562153752, "creation_date": 1562153321, "last_edit_date": 1562153495, "question_id": 56869113, "link": "https://stackoverflow.com/questions/56869113/how-to-make-an-if-statement-into-a-for-loop-in-vba", "title": "How to make an If Statement into a For Loop in VBA", "body": "<p>I am making a project in VBA and I face a problem with the following code...</p>\n\n<p>It says there is a object or an undefined function, but I don't understand why... Any Idea of what the problem is?</p>\n\n<p>(All the variables are declared and i checked the name of the sheets)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Set FinalRange = ActiveWorkbook.Worksheets(\"Fiche Horaire\").Range(\"A:A\")\nemptyroww = WorksheetFunction.CountA(FinalRange)\n\nprecautionroww = 0\nIf emptyroww &gt; 50 Then precautionroww = emptyroww - 50\n\nFor a = precautionroww To emptyroww\n    If ActiveWorkbook.Worksheets(\"Fiche Horaire\").Cells(a, 1).Value = name Then ActiveWorkbook.Worksheets(\"Fiche Horaire\").Cells(a, 4).Value = \"it works\"\nNext\n</code></pre>\n\n<p>The message it gives is \"Application-defined or object-defined error\"</p>\n"}, {"tags": ["excel", "vba", "string", "manipulate"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562155126, "post_id": 56869071, "comment_id": 100287779, "body": "If you remove duplicates, won&#39;t you just be left with rows 1, 4 and 6?"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 10979177, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216617496977177/picture?type=large", "display_name": "Andreas Hild", "link": "https://stackoverflow.com/users/10979177/andreas-hild"}, "edited": false, "score": 0, "creation_date": 1562163044, "post_id": 56869807, "comment_id": 100292749, "body": "One further quenstion. How would you add another format to the country rows. Let&#39;s say that I&#39;d like to make every country row in bold font. Thanks"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 77, "user_id": 10979177, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216617496977177/picture?type=large", "display_name": "Andreas Hild", "link": "https://stackoverflow.com/users/10979177/andreas-hild"}, "edited": false, "score": 0, "creation_date": 1562163470, "post_id": 56869807, "comment_id": 100292963, "body": "Added in bold and a red font color. if you want to change the cell color use: <code>.cells(iter, 1).interior.colorindex</code>"}, {"owner": {"reputation": 77, "user_id": 10979177, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216617496977177/picture?type=large", "display_name": "Andreas Hild", "link": "https://stackoverflow.com/users/10979177/andreas-hild"}, "edited": false, "score": 0, "creation_date": 1562245433, "post_id": 56869807, "comment_id": 100324121, "body": "Another questions, let&#39;s say that I have a third column with a variable like time, how would I add that one data cell. Let&#39;s say that the lines look like"}, {"owner": {"reputation": 77, "user_id": 10979177, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216617496977177/picture?type=large", "display_name": "Andreas Hild", "link": "https://stackoverflow.com/users/10979177/andreas-hild"}, "edited": false, "score": 0, "creation_date": 1562245499, "post_id": 56869807, "comment_id": 100324151, "body": "Country Data Time"}, {"owner": {"reputation": 77, "user_id": 10979177, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216617496977177/picture?type=large", "display_name": "Andreas Hild", "link": "https://stackoverflow.com/users/10979177/andreas-hild"}, "edited": false, "score": 0, "creation_date": 1562245510, "post_id": 56869807, "comment_id": 100324157, "body": "And I want it to be"}, {"owner": {"reputation": 77, "user_id": 10979177, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216617496977177/picture?type=large", "display_name": "Andreas Hild", "link": "https://stackoverflow.com/users/10979177/andreas-hild"}, "edited": false, "score": 0, "creation_date": 1562245537, "post_id": 56869807, "comment_id": 100324173, "body": "Country and then Data Time under"}, {"owner": {"reputation": 77, "user_id": 10979177, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216617496977177/picture?type=large", "display_name": "Andreas Hild", "link": "https://stackoverflow.com/users/10979177/andreas-hild"}, "edited": false, "score": 0, "creation_date": 1562245658, "post_id": 56869807, "comment_id": 100324256, "body": "I entered it in the post"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "reply_to_user": {"reputation": 77, "user_id": 10979177, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216617496977177/picture?type=large", "display_name": "Andreas Hild", "link": "https://stackoverflow.com/users/10979177/andreas-hild"}, "edited": false, "score": 0, "creation_date": 1562328144, "post_id": 56869807, "comment_id": 100350029, "body": "You&#39;ll either need a second dictionary with the same setup: key-country, item-datetime.  You could create an array to hold two strings for each data type or you can write a simple class that just stores data to make a clearer data structure."}], "tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 0, "last_activity_date": 1562163448, "last_edit_date": 1562163448, "creation_date": 1562155626, "answer_id": 56869807, "question_id": 56869071, "link": "https://stackoverflow.com/questions/56869071/manipulate-excel-table-macro-to-another-format-remove-duplicates-and-reformat/56869807#56869807", "title": "Manipulate Excel table macro to another format. Remove duplicates and reformat", "body": "<p>Save a copy before you run this it will overwrite your data.</p>\n\n<pre><code>Dim lastrow As Long\n    Dim iter As Long\n    Dim diter As Long\n    Dim countrydict As Object\n    Dim country As String\n    Dim data As String\n    Dim key As Variant\n\n    Set countrydict = CreateObject(\"Scripting.Dictionary\")\n\n    With ActiveSheet\n        lastrow = .Cells(.Rows.Count, \"A\").End(xlUp).row\n\n        For iter = 1 To lastrow\n            country = Trim(.Cells(iter, 1).value)\n            data = Trim(.Cells(iter, 2).value)\n            If countrydict.Exists(country) Then\n                If Not InStr(1, countrydict(country), data) &gt; 0 Then ' Remove Dupes\n                    countrydict(country) = countrydict(country) &amp; \"|\" &amp; data ' an array would work but we can instr a string\n                End If\n            Else\n                countrydict.Add country, data\n            End If\n        Next\n        iter = 1\n        For Each key In countrydict\n            .Cells(iter, 1).value = key &amp; \":\"\n            .cells(iter, 1).font.bold = True\n            .cells(iter, 1).font.colorindex = 30\n            iter = iter + 1\n            For diter = 0 To UBound(Split(countrydict(key), \"|\"))\n                .Cells(iter, 1).value = Split(countrydict(key), \"|\")(diter)\n                iter = iter + 1\n            Next\n        Next\n        .Columns(\"B\").Clear\n    End With\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 10979177, "user_type": "registered", "profile_image": "https://graph.facebook.com/10216617496977177/picture?type=large", "display_name": "Andreas Hild", "link": "https://stackoverflow.com/users/10979177/andreas-hild"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 56869807, "answer_count": 1, "score": 0, "last_activity_date": 1562245610, "creation_date": 1562153180, "last_edit_date": 1562245610, "question_id": 56869071, "link": "https://stackoverflow.com/questions/56869071/manipulate-excel-table-macro-to-another-format-remove-duplicates-and-reformat", "title": "Manipulate Excel table macro to another format. Remove duplicates and reformat", "body": "<p>I'm around 2 months in my VBA journey and I have encountered a problem which I can't find a solution to online. I'm having problems manipulating an Excel table to another format which has been created by another macro that I have programmed. I have a table with country and name of a figure on different rows, listed on a couple of rows. I want it to be dynamic since this table will be updated everyday </p>\n\n<p>I have written below on how I want it to look. My idea is to code the country as a digit and then remove duplicats in the country region.</p>\n\n<p>I have tried to create a loop and I'm thinking that I might have to create a range for each country. </p>\n\n<pre><code>Sub ManipulateTable()\nDim Country as String\nDim USA as Range\nDim EU as Range\nDim India as Range\n\nConst StartRow As Byte = 7\nDim LastRow as Long\nLastRow = Range(\"A\" &amp; StartRow.(End(xlDown).Row\n\nFor i StartRow to LastRow \nCountry = Range(\"A\" &amp; i).Value\n\nIf Country = \"USA\" Then Range(\"C\" &amp; i).value = 1\nIf Country = \"EU\" Then Range(\"C\" &amp; i).value = 2\nIf Country = \"India\" Then Range(\"C\" &amp; i).value = 3\nNext i\n' This to remove duplicates from column a\nRange(\"A7:A30\").RemoveDuplicates Columns:=Array(1). Header:= xlYes\n' I thinking that I need to create a loop here \n' But I dont know where to start\nFor i StartRow to LastRow\nCountryindex =  Range(\"C\").Value\nIf Countryindex = 1 Then put under USA\nIf Countryindex = 2 Then put under EU\n</code></pre>\n\n<p>My Table looks like this with separate columns</p>\n\n<pre><code>    \"A\" \"B\"\n     Data\n1    USA Sales\n2    USA Employment Figures\n3    USA Tax\n4    EU Sales\n5    EU Employment Figures\n6    India Sales\n7    India Expenses \n8    India Employment Figures\n</code></pre>\n\n<p>I want a table which looks like this</p>\n\n<pre><code> \"A\" \n Data\n1    USA: (With some color)\n2    Sales\n3    Employment\n4    Tax\n5    EU: (With some color)  \n6    Sales\n7    Employment\n8    India: (With some color)\n9    Sales\n10   Expenses\n11   Employment\n</code></pre>\n\n<p>All help is highly appriciated.</p>\n\n<pre><code>Country Data Time\n\nCountry:\nData Time\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "edited": false, "score": 0, "creation_date": 1562153701, "post_id": 56868930, "comment_id": 100286957, "body": "on what line do you get the error? have you tried stepping through the code?"}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "reply_to_user": {"reputation": 2465, "user_id": 2570277, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0483cce5f2ea53671a36477fed79898b?s=128&d=identicon&r=PG", "display_name": "Nick", "link": "https://stackoverflow.com/users/2570277/nick"}, "edited": false, "score": 0, "creation_date": 1562158499, "post_id": 56868930, "comment_id": 100289893, "body": "Apologies, it&#39;s the last line that causes the error"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1562160408, "post_id": 56868930, "comment_id": 100291205, "body": "The last line is incomplete <code>ActiveChart.FullSeriesCollection(1).XValues.AutoSort _</code> or as an additional underscore. Remove the underscore <code>_</code> in the end. This is used to concatenate the current code line with the next line (just like both would have been written in one line only)."}, {"owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "edited": false, "score": 0, "creation_date": 1562161447, "post_id": 56868930, "comment_id": 100291865, "body": "Thanks, I am still getting the same error message though?"}], "answers": [{"tags": [], "owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "is_accepted": false, "score": 0, "last_activity_date": 1562249314, "creation_date": 1562249314, "answer_id": 56889731, "question_id": 56868930, "link": "https://stackoverflow.com/questions/56868930/sorting-a-graph-using-vba/56889731#56889731", "title": "Sorting A Graph Using VBA", "body": "<p>I ended up copying my data to another tab, reordering the date here (this updated on the graph instantly) and then hiding the graph.\nI did this as part of a larger RPA process but this could be done in an excel macro also.</p>\n"}], "owner": {"reputation": 769, "user_id": 3456245, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/59425ad52625b1d455b2a59282a97020?s=128&d=identicon&r=PG&f=1", "display_name": "Eoin2211", "link": "https://stackoverflow.com/users/3456245/eoin2211"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562249314, "creation_date": 1562152673, "last_edit_date": 1562153311, "question_id": 56868930, "link": "https://stackoverflow.com/questions/56868930/sorting-a-graph-using-vba", "title": "Sorting A Graph Using VBA", "body": "<p>I have an excel macro which updates a graph to represent data on another tab. I also want to sort the graph. I can't seem to manually do this and just record the macro.</p>\n\n<p>I have tried the below code, but get a run time error 424 saying Object Required</p>\n\n<pre><code>Sub Productivity_Report_Graph()\n\nActiveSheet.ChartObjects(\"Chart 1\").Activate\n\nActiveChart.FullSeriesCollection(1).Values = _\n    \"='Customer Service Report'!$D$2:$D$100\"\n\nActiveChart.FullSeriesCollection(2).Values = _\n    \"='Customer Service Report'!$P$2:$P$100\"\n\nActiveChart.FullSeriesCollection(3).Values = _\n    \"='Customer Service Report'!$Q$2:$Q$100\"\n\nActiveChart.FullSeriesCollection(1).XValues = _\n    \"='Customer Service Report'!$B$2:$B$100\"\n\nActiveChart.FullSeriesCollection(1).XValues.AutoSort _\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 19, "user_id": 5053637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dba295a5d734ef2e87c7d46e1bdd35d?s=128&d=identicon&r=PG&f=1", "display_name": "Skelty", "link": "https://stackoverflow.com/users/5053637/skelty"}, "edited": false, "score": 0, "creation_date": 1562154410, "post_id": 56868851, "comment_id": 100287370, "body": "Thanks for the corrections Eugene. Can you help?"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1562154530, "post_id": 56868851, "comment_id": 100287438, "body": "Did you try to debug the code? Which line of code gives the error?"}, {"owner": {"reputation": 19, "user_id": 5053637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dba295a5d734ef2e87c7d46e1bdd35d?s=128&d=identicon&r=PG&f=1", "display_name": "Skelty", "link": "https://stackoverflow.com/users/5053637/skelty"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1562154813, "post_id": 56868851, "comment_id": 100287608, "body": "This one gets yellow when I debug: If insp.IsWordMail Then  -   I&#39;m a total beginner actually."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1562155500, "post_id": 56868851, "comment_id": 100288012, "body": "I think you can omit this line of code. The <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.inspector.iswordmail\" rel=\"nofollow noreferrer\">IsWordMail</a> method determines whether the mail message associated with an inspector is displayed in an Outlook Inspector or in Microsoft Word. But now Outlook uses Word as an email editor everywhere."}, {"owner": {"reputation": 19, "user_id": 5053637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dba295a5d734ef2e87c7d46e1bdd35d?s=128&d=identicon&r=PG&f=1", "display_name": "Skelty", "link": "https://stackoverflow.com/users/5053637/skelty"}, "reply_to_user": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1562159089, "post_id": 56868851, "comment_id": 100290325, "body": "Than you, Eugene for your time helping me on this."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5053637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dba295a5d734ef2e87c7d46e1bdd35d?s=128&d=identicon&r=PG&f=1", "display_name": "Skelty", "link": "https://stackoverflow.com/users/5053637/skelty"}, "edited": false, "score": 0, "creation_date": 1562154615, "post_id": 56869447, "comment_id": 100287487, "body": "Sounds very complicated. But how come it had worked a month ago? Are you sure there isn&#39;t anything wrong with the path? Thanks so much for having popped in to my issue!"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1562155559, "last_edit_date": 1562155559, "creation_date": 1562154505, "answer_id": 56869447, "question_id": 56868851, "link": "https://stackoverflow.com/questions/56868851/what-to-do-when-i-get-run-time-error-91-object-variable-or-with-block-variable-n/56869447#56869447", "title": "What to do when I get run time error 91 Object variable or With block variable not set", "body": "<p>Most probably a new email is opened in the <code>Explorer</code> window. The code listed on the page uses the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.application.activeinspector\" rel=\"nofollow noreferrer\">ActiveInspector</a> property which returns the topmost Inspector object on the desktop. If there is no inspector window shown you may get the error described in your post.</p>\n\n<p>Anyway, I'd suggest setting a breakpoint in VBA editor and run the code under the debugger attached.</p>\n\n<p>Try to remove the condition from the code:</p>\n\n<pre><code>Dim insp As Inspector\nDim wordDoc As Word.Document\n\nSet insp = ActiveInspector\nSet wordDoc = insp.WordEditor\nwordDoc.Application.Selection.InsertFile \"e:\\test.html\", , False, False, False\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 5053637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dba295a5d734ef2e87c7d46e1bdd35d?s=128&d=identicon&r=PG&f=1", "display_name": "Skelty", "link": "https://stackoverflow.com/users/5053637/skelty"}, "is_accepted": true, "score": 0, "last_activity_date": 1562159054, "creation_date": 1562159054, "answer_id": 56870806, "question_id": 56868851, "link": "https://stackoverflow.com/questions/56868851/what-to-do-when-i-get-run-time-error-91-object-variable-or-with-block-variable-n/56870806#56870806", "title": "What to do when I get run time error 91 Object variable or With block variable not set", "body": "<p>Problem solved. I was foolish enough to not having first opened a new Outlook email and only than go to Developer tab -> Macros to select my template.</p>\n\n<p>That is probably why I had this error with the email being opened in Explorer window, like Eugene has suggested.</p>\n"}], "owner": {"reputation": 19, "user_id": 5053637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3dba295a5d734ef2e87c7d46e1bdd35d?s=128&d=identicon&r=PG&f=1", "display_name": "Skelty", "link": "https://stackoverflow.com/users/5053637/skelty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 56870806, "answer_count": 2, "score": -1, "last_activity_date": 1591162886, "creation_date": 1562152312, "last_edit_date": 1591162886, "question_id": 56868851, "link": "https://stackoverflow.com/questions/56868851/what-to-do-when-i-get-run-time-error-91-object-variable-or-with-block-variable-n", "title": "What to do when I get run time error 91 Object variable or With block variable not set", "body": "<p>I'm installing HTML e-mail template in Outlook.\nI'm following these guidelines: <a href=\"https://www.outlook-apps.com/insert-html-to-outlook-emails/\" rel=\"nofollow noreferrer\">https://www.outlook-apps.com/insert-html-to-outlook-emails/</a> (section How to insert clean HTML code to Outlook that has 8 steps).\nI did it about a month ago with a success. The html template was able to be nicely opened in Outlook (like it is described in step 8).</p>\n\n<p>Today I've deleted the one that worked and tried to installed a new one. I have no idea what I've done differently but it does not work anymore.</p>\n\n<p>I get the error: run time error 91 Object variable or With block variable not set</p>\n\n<p>The only code that I actually write in is the one that I copy paste from step 5 and then I write the following path:</p>\n\n<p>C:\\Users\\Maja\\Documents\\news.html - Because this is where my html template is placed.</p>\n\n<p>What I expect is that when I do step 8, a new e-mail with my html template (news.html) would open.</p>\n"}, {"tags": ["excel", "vba", "if-statement", "with-statement"], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 11733410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588573f572160db22e6c6fd6f1304790?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/11733410/jesse"}, "edited": false, "score": 0, "creation_date": 1562154506, "post_id": 56868763, "comment_id": 100287426, "body": "Thank you for the help. It helped with the first part."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1562152045, "creation_date": 1562152045, "answer_id": 56868763, "question_id": 56868576, "link": "https://stackoverflow.com/questions/56868576/how-to-incorporate-a-with-statement-with-an-if-statement/56868763#56868763", "title": "How to incorporate a with statement with an if statement?", "body": "<p>Reverse the order of:</p>\n\n<pre><code>Set xSht = Sheets(xName)\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>xName = InputBox(\"Enter Sheet Name\")\n</code></pre>\n\n<p><em>(there may be other problems)</em></p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 11733410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588573f572160db22e6c6fd6f1304790?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/11733410/jesse"}, "edited": false, "score": 1, "creation_date": 1562154537, "post_id": 56868781, "comment_id": 100287442, "body": "Thank you so much!! I had been trying to solve this for so long and now it finally works!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1562152094, "creation_date": 1562152094, "answer_id": 56868781, "question_id": 56868576, "link": "https://stackoverflow.com/questions/56868576/how-to-incorporate-a-with-statement-with-an-if-statement/56868781#56868781", "title": "How to incorporate a with statement with an if statement?", "body": "<p>Try this. You can turn off errors while you check if the sheet exists. Define the variable after the name has been entered otherwise you will get another error.</p>\n\n<pre><code>Sub x()\n\nDim ws As Worksheet\nDim xName As String\nDim xSht As worksheet\n\nxName = InputBox(\"Enter Sheet Name\")\nIf xName = \"\" Then Exit Sub\n\nOn Error Resume Next 'avoids error if sheet doesn't exist\nSet xSht = Sheets(xName)\nOn Error GoTo 0      'turn off error avoidance\n\nIf Not xSht Is Nothing Then\n    MsgBox \"Name already exists\"\n    Exit Sub\nEnd If\n\nWith ThisWorkbook\n    Set ws = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n    ws.Name = xName\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11733410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/588573f572160db22e6c6fd6f1304790?s=128&d=identicon&r=PG&f=1", "display_name": "Jesse", "link": "https://stackoverflow.com/users/11733410/jesse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 56868781, "answer_count": 2, "score": 0, "last_activity_date": 1562173215, "creation_date": 1562151458, "last_edit_date": 1562173215, "question_id": 56868576, "link": "https://stackoverflow.com/questions/56868576/how-to-incorporate-a-with-statement-with-an-if-statement", "title": "How to incorporate a with statement with an if statement?", "body": "<p>I've been working on a code to have a message box pop up that you can type in the name of a sheet and then it will create a new sheet at the end of all the other ones with that name. </p>\n\n<p>With the help of googling, I was able to make a code that pops up an <code>inputbox</code> where I write a name that I want for the new sheet and with a with-statement, it creates it at the end of all my other sheets. </p>\n\n<p>What I am having problems with is the if-statement, which should say that if this name does not exist continue running the code and if the name does exist exit sub (don't continue processing the codes beneath). I got the <code>If Not xSht Is Nothing Then</code> to work by writing it as <code>If xSht Is Nothing Then</code>, but that creates two if statements, so the first part gets completely nullified. I also tried writing it as an else statement, but then it jumps over the <code>msgbox</code> and still creates a new sheet because of the with statement below.</p>\n\n<pre><code>Dim ws As Worksheet\nDim xName As String\nDim xSht As Object\n\nSet xSht = Sheets(xName)\nxName = InputBox(\"Enter Sheet Name\")\n\nIf xName = \"\" Then Exit Sub\n\nIf Not xSht Is Nothing Then\n    MsgBox (\"Name already exists\")\n    Exit Sub\nEnd If\n\nWith ThisWorkbook   'Adds new sheet with the name it has been given\n    Set ws = .Sheets.Add(After:=.Sheets(.Sheets.Count))\n    ws.Name = xName\nEnd With\n\n&lt;More code&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1562149543, "post_id": 56867989, "comment_id": 100284731, "body": "You are missing an <code>End If</code> somewhere"}], "owner": {"reputation": 11, "user_id": 11733814, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a04ac22f534f3d81e01ade9485bfa888?s=128&d=identicon&r=PG&f=1", "display_name": "sdajdsfa", "link": "https://stackoverflow.com/users/11733814/sdajdsfa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562149469, "creation_date": 1562149469, "question_id": 56867989, "link": "https://stackoverflow.com/questions/56867989/why-does-it-say-that-there-is-no-for-loop", "title": "why does it say that there is no for loop?", "body": "<p>i am unsure on why this says that there is no for loop when i try to input next row2</p>\n\n<pre><code>Sub test4()\n    For row2 = 2 To 174\n        If IsEmpty(\"I\" &amp; row2) Then\n            Worksheets(\"Sheet1\").Range(\"I\" &amp; row2).Copy _\n            Destination:=Worksheets(\"Sheet2\").Range(\"R5\")\n    If IsEmpty(\"I\" &amp; row2) Then Exit For\n    Next row2\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "hyperlink", "cell"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1562149666, "post_id": 56867976, "comment_id": 100284793, "body": "<code>p = Range(t1.ListColumns(&quot;UnLockedField&quot;).DataBodyRange(i)).Addr&zwnj;&#8203;ess</code>?"}, {"owner": {"reputation": 101, "user_id": 8490765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fdcfa0b3de9e6b40afd5959fa7a4ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Hall", "link": "https://stackoverflow.com/users/8490765/robert-hall"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1562150229, "post_id": 56867976, "comment_id": 100285088, "body": "Hi, just tried and doesn&#39;t work."}], "answers": [{"tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 0, "last_activity_date": 1562153271, "creation_date": 1562153271, "answer_id": 56869102, "question_id": 56867976, "link": "https://stackoverflow.com/questions/56867976/how-to-get-cell-location-of-h-and-add-to-hyperlink/56869102#56869102", "title": "How to get cell location of H and add to hyperlink", "body": "<p>You do not need the Range object and cannot use it (as you are doing) to achieve what you want. It should be:<br>\n<code>p = t1.ListColumns(\"UnLockedField\").DataBodyRange.Cells(i).Address</code></p>\n"}], "owner": {"reputation": 101, "user_id": 8490765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fdcfa0b3de9e6b40afd5959fa7a4ce9?s=128&d=identicon&r=PG&f=1", "display_name": "Robert Hall", "link": "https://stackoverflow.com/users/8490765/robert-hall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56869102, "answer_count": 1, "score": 0, "last_activity_date": 1562153271, "creation_date": 1562149413, "question_id": 56867976, "link": "https://stackoverflow.com/questions/56867976/how-to-get-cell-location-of-h-and-add-to-hyperlink", "title": "How to get cell location of H and add to hyperlink", "body": "<p>I am setting up hyperlinks in a range to go to cells in a table</p>\n\n<p>Everything works apart from p. It is supposed to get the cell location and then insert it in the address.</p>\n\n<pre><code>Dim t1 As ListObject\n    Set t1 = Range(\"Testtbl\").ListObject\n    Dim i As Integer\n    Dim j As Integer\n    Dim p As String\n\n    For Each cell In rng\n    For i = 1 To t1.ListRows.Count\n        If t1.ListColumns(\"UnLockedField\").DataBodyRange(i) = \"H\" Then\n\n        p = Range(t1.ListColumns(\"UnLockedField\").DataBodyRange(i))\n\n\n        With cell\n         .Hyperlinks.Add Anchor:=cell, _\n         Address:=p\n        End With\n\n\n        GoTo NEXTONE\n\n    End If\n\n    Next i\n\nNEXTONE:\nNext cell\nEnd If\n</code></pre>\n\n<p>I am hoping that p would get the cell loaction and then insert that cell into the address.</p>\n"}, {"tags": ["excel", "vba", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1562172671, "last_edit_date": 1562172671, "creation_date": 1562165805, "answer_id": 56872936, "question_id": 56867924, "link": "https://stackoverflow.com/questions/56867924/scrape-google-maps-destinations/56872936#56872936", "title": "Scrape Google Maps destinations", "body": "<p>Your class selector is incorrect for selecting the child. I guess, without looking, you have missed 1 or more of the compound classes. In this case it is sufficient to use a single class (if you choose the right one) from the compound class, in combination with parent: </p>\n\n<pre><code>.widget-directions-travel-mode-switcher-container .directions-drive-icon\n</code></pre>\n\n<p>You could also use an attribute = value selector</p>\n\n<pre><code>ie.document.querySelector(\"[aria-label=Driving]\").click\n</code></pre>\n\n<p>The ids may be dynamic which is why I have used the placeholder attributes in example below. Tested on UK set-up.</p>\n\n<pre><code>Option Explicit\nPublic Sub ClickButton()\n    Dim ie As New InternetExplorer\n    With ie\n        .Visible = True\n        .Navigate2 \"https://www.google.com/maps/dir//\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n            .querySelector(\"[placeholder='Choose starting point, or click on the map...']\").Value = \"Aylesbury\"\n            .querySelector(\"[placeholder='Choose destination...']\").Value = \"Brentford\"\n            .querySelector(\"[aria-label=Driving]\").Click\n        End With\n\n        Stop '&lt;delete me later\n\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1600, "user_id": 7202022, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lShiC.png?s=128&g=1", "display_name": "hatman", "link": "https://stackoverflow.com/users/7202022/hatman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 56872936, "answer_count": 1, "score": 0, "last_activity_date": 1562172671, "creation_date": 1562149201, "last_edit_date": 1562155045, "question_id": 56867924, "link": "https://stackoverflow.com/questions/56867924/scrape-google-maps-destinations", "title": "Scrape Google Maps destinations", "body": "<p>I would like to make a code for scraping Google Maps destinations. I can access destinations by using <code>https://www.google.com/maps/dir///</code>. </p>\n\n<p>Then I need to input information to FROM and TO fields, select TRAVEL MODE and click SEARCH. <code>WebBrowser1</code> is embedded to Userform <code>DistanceSite</code>. Can't figure out how to click Driving button on Google Maps.</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>Private Sub CommandButton4_Click()\n\n'On Error Resume Next\n\n   With DistanceSite.WebBrowser1\n\n        While .ReadyState &lt;&gt; 4\n          DoEvents\n        Wend\n\n        With .Document\n\n            .querySelector(\"div.gstl_50 .sbib_b [class=tactile-searchbox-input]\").Value = ThisWorkbook.Sheets(\"Other Data\").Range(\"BY17\").Value\n\n            .querySelector(\"div.gstl_51 .sbib_b [class=tactile-searchbox-input]\").Value = ThisWorkbook.Sheets(\"Other Data\").Range(\"BY18\").Value\n\n            .querySelector(\"div.widget-directions-travel-mode-switcher-container [class=directions-travel-mode-icon directions-drive-icon]\").Click\n\n        End With\n\n        End With\n\n    'If Err &lt;&gt; 0 Then\n\n       'MsgBox \"There was an error running the code. Check your Internet connection. Please try one more time!\"\n       'Else\n\n    'End If\n\n    'On Error GoTo 0\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1562153798, "post_id": 56867679, "comment_id": 100287034, "body": "That code <i>as is</i> will not lock anything. What could lock something is the report. So, check that out. As a start, replace it with a simple report that runs zero code."}, {"owner": {"reputation": 1, "user_id": 11733686, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_H1H6t35aeg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcr4AdtHl1B4XuM3UOcKHahRM5Eaw/photo.jpg?sz=128", "display_name": "Chris Oram", "link": "https://stackoverflow.com/users/11733686/chris-oram"}, "reply_to_user": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 1, "creation_date": 1562603893, "post_id": 56867679, "comment_id": 100418655, "body": "Thanks Gustav, you gave me an idea! I didn&#39;t think the code was causing it either. I had the report open when sending to pdf etc. I simply added  DoCmd.Close before the docmd.SendObject line and it solved it. Cheers."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11733686, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_H1H6t35aeg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcr4AdtHl1B4XuM3UOcKHahRM5Eaw/photo.jpg?sz=128", "display_name": "Chris Oram", "link": "https://stackoverflow.com/users/11733686/chris-oram"}, "edited": false, "score": 0, "creation_date": 1562158103, "post_id": 56867799, "comment_id": 100289642, "body": "Thanks for responding, unfortunately I don&#39;t quite follow. How do you go about these things please?"}, {"owner": {"reputation": 481, "user_id": 1320104, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/1e58461c0faccf8f99c721b5773e2af8?s=128&d=identicon&r=PG", "display_name": "kris123456", "link": "https://stackoverflow.com/users/1320104/kris123456"}, "reply_to_user": {"reputation": 1, "user_id": 11733686, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_H1H6t35aeg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcr4AdtHl1B4XuM3UOcKHahRM5Eaw/photo.jpg?sz=128", "display_name": "Chris Oram", "link": "https://stackoverflow.com/users/11733686/chris-oram"}, "edited": false, "score": 0, "creation_date": 1562232221, "post_id": 56867799, "comment_id": 100316730, "body": "Did you try to search on how locks could be removed on table? just search in google. you will find everything."}], "tags": [], "owner": {"reputation": 481, "user_id": 1320104, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/1e58461c0faccf8f99c721b5773e2af8?s=128&d=identicon&r=PG", "display_name": "kris123456", "link": "https://stackoverflow.com/users/1320104/kris123456"}, "is_accepted": false, "score": 0, "last_activity_date": 1562148791, "creation_date": 1562148791, "answer_id": 56867799, "question_id": 56867679, "link": "https://stackoverflow.com/questions/56867679/an-error-occurs-could-not-lock-table-after-running-vba-in-access/56867799#56867799", "title": "AN error occurs &#39;could not lock table&#39; after running VBA in Access", "body": "<p>Two ways to approach this problem. </p>\n\n<p>First check DB master tables to know which process/user is locking the table. \nIdentify the location which is causing this lock and try to perform commit to release all locks on that table. </p>\n\n<p>Second, you need not close DB. you could check and release locks on the table, if you have adequate permissions. try to go this route. </p>\n"}], "owner": {"reputation": 1, "user_id": 11733686, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_H1H6t35aeg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcr4AdtHl1B4XuM3UOcKHahRM5Eaw/photo.jpg?sz=128", "display_name": "Chris Oram", "link": "https://stackoverflow.com/users/11733686/chris-oram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594639802, "creation_date": 1562148446, "last_edit_date": 1594639802, "question_id": 56867679, "link": "https://stackoverflow.com/questions/56867679/an-error-occurs-could-not-lock-table-after-running-vba-in-access", "title": "AN error occurs &#39;could not lock table&#39; after running VBA in Access", "body": "<p>In Access I have created a button to email a report as a pdf. It works fine the first time I use then if I try and using it again it gives the error 'could not lock table'. I used the following code:</p>\n\n<pre><code>Private Sub Btn_TNA_Report_Click()\nDim MyDate As Date\nDim x2 As String\nMyDate = Date    \nx2 = Me.Email_Of_Contact_Person\nDoCmd.SendObject acSendReport, \"Rpt_TNA_Email\", acFormatPDF, x2, , , \"NMUH Request for Staff Education Places \" &amp; Date, \"Dear Colleague,\" &amp; vbCrLf &amp; vbCrLf &amp; \"Please find PDF of request attached.\" &amp; vbCrLf &amp; \"\" &amp; vbCrLf &amp; vbCrLf &amp; \"Thank you\", True\nEnd Sub\n</code></pre>\n\n<p>I have to close the database and reopen it every time to unlock the table. I tried to add a line before opening report to delete the offending table but that didnt work either. </p>\n\n<p>Any thoughts, guys?</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1562149005, "post_id": 56867507, "comment_id": 100284454, "body": "<code>Set pvtfil = pvtfld.PivotFilters.Add(xlDateBetween, Date, O2, O3, xlDescending)</code>as<code>pvtfils</code>is not set to anything (or<code>Set pvtfils = pvtfld.PivotFilters</code>in front of<code>Set pvtfil</code>)."}, {"owner": {"reputation": 21, "user_id": 11733691, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sJAsV3Dkduk/AAAAAAAAAAI/AAAAAAAAACo/AaXWRhXqTQA/photo.jpg?sz=128", "display_name": "Emma Powderly", "link": "https://stackoverflow.com/users/11733691/emma-powderly"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1562152455, "post_id": 56867507, "comment_id": 100286243, "body": "The same error appeared thank you for the help thought :)"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 11733691, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sJAsV3Dkduk/AAAAAAAAAAI/AAAAAAAAACo/AaXWRhXqTQA/photo.jpg?sz=128", "display_name": "Emma Powderly", "link": "https://stackoverflow.com/users/11733691/emma-powderly"}, "edited": false, "score": 0, "creation_date": 1562225257, "post_id": 56872339, "comment_id": 100313014, "body": "Thank you but i&#39;m afraid I have a new error message now. Run-time Error 1004: Application-defined or object-defined error on the set pvtfil line."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 21, "user_id": 11733691, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sJAsV3Dkduk/AAAAAAAAAAI/AAAAAAAAACo/AaXWRhXqTQA/photo.jpg?sz=128", "display_name": "Emma Powderly", "link": "https://stackoverflow.com/users/11733691/emma-powderly"}, "edited": false, "score": 0, "creation_date": 1562225832, "post_id": 56872339, "comment_id": 100313315, "body": "Did you copy and use exactly and only my code or do you have more code lines in your Sub?"}, {"owner": {"reputation": 21, "user_id": 11733691, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sJAsV3Dkduk/AAAAAAAAAAI/AAAAAAAAACo/AaXWRhXqTQA/photo.jpg?sz=128", "display_name": "Emma Powderly", "link": "https://stackoverflow.com/users/11733691/emma-powderly"}, "edited": false, "score": 0, "creation_date": 1562228389, "post_id": 56872339, "comment_id": 100314594, "body": "Yes and I made sure to save before running the code"}, {"owner": {"reputation": 21, "user_id": 11733691, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sJAsV3Dkduk/AAAAAAAAAAI/AAAAAAAAACo/AaXWRhXqTQA/photo.jpg?sz=128", "display_name": "Emma Powderly", "link": "https://stackoverflow.com/users/11733691/emma-powderly"}, "edited": false, "score": 0, "creation_date": 1562234406, "post_id": 56872339, "comment_id": 100318101, "body": "The dates in O2 and O3 appear and my pivot tables source data is based on a query could this be causing an issue?"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 21, "user_id": 11733691, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sJAsV3Dkduk/AAAAAAAAAAI/AAAAAAAAACo/AaXWRhXqTQA/photo.jpg?sz=128", "display_name": "Emma Powderly", "link": "https://stackoverflow.com/users/11733691/emma-powderly"}, "edited": false, "score": 0, "creation_date": 1562263176, "post_id": 56872339, "comment_id": 100331724, "body": "(I tested it with pivottables with different sources: Range, ListObject and OLAP - all of them work and filter correctly). Please try to record a macro while you manually add a filter &quot;between&quot; some dates. If you can, the recorded macro will help. If you can&#39;t add a &quot;between two dates dates&quot; filter manually, then your pivotfield &quot;Date&quot; is based on strings and you can&#39;t do it via VBA either."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "reply_to_user": {"reputation": 21, "user_id": 11733691, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sJAsV3Dkduk/AAAAAAAAAAI/AAAAAAAAACo/AaXWRhXqTQA/photo.jpg?sz=128", "display_name": "Emma Powderly", "link": "https://stackoverflow.com/users/11733691/emma-powderly"}, "edited": false, "score": 0, "creation_date": 1563260053, "post_id": 56872339, "comment_id": 100629617, "body": "How is it? Could you filter manually between two dates and record a macro doing that?"}], "tags": [], "owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "is_accepted": false, "score": 0, "last_activity_date": 1562230985, "last_edit_date": 1562230985, "creation_date": 1562164069, "answer_id": 56872339, "question_id": 56867507, "link": "https://stackoverflow.com/questions/56867507/run-time-error-424-object-required-filter-pivot-tables/56872339#56872339", "title": "Run- Time Error &quot;424&quot; Object Required Filter Pivot Tables", "body": "<p>The date filter for a pivotfield needs two <code>String</code>, which Excel can interprete as date values (neither <code>Date</code> values nor <code>Range</code> objects can be assigned directly in my German Excel version!).</p>\n\n<p>Therefore I use two date variables \"o2\" and \"o3\" which are</p>\n\n<ul>\n<li>read from a <code>Range.Value</code></li>\n<li>converted to dates by <code>CDate</code> (not necessary, if you already used date values in your cells)</li>\n<li>converted to strings by <code>CStr</code></li>\n</ul>\n\n<hr>\n\n<pre><code>Sub MyFilter()\n    Dim pvtfld As PivotField\n    Dim pvtfil As PivotFilter\n\n    Dim o2 As Date\n    Dim o3 As Date\n\n    With ThisWorkbook.Sheets(\"Sheet1\")\n        Set pvtfld = .PivotTables(\"PivotTable1\").PivotFields(\"Date\")\n        o2 = CDate(.Range(\"O2\").Value) ' just to ensure, they are dates\n        o3 = CDate(.Range(\"O3\").Value)\n        Debug.Print CStr(o2), CStr(o3)\n        pvtfld.ClearAllFilters\n        Set pvtfil = pvtfld.PivotFilters.Add2(Type:=xlDateBetween, Value1:=CStr(o2), Value2:=CStr(o3), Order:=xlDescending)\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11733691, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sJAsV3Dkduk/AAAAAAAAAAI/AAAAAAAAACo/AaXWRhXqTQA/photo.jpg?sz=128", "display_name": "Emma Powderly", "link": "https://stackoverflow.com/users/11733691/emma-powderly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1562230985, "creation_date": 1562147897, "last_edit_date": 1562164115, "question_id": 56867507, "link": "https://stackoverflow.com/questions/56867507/run-time-error-424-object-required-filter-pivot-tables", "title": "Run- Time Error &quot;424&quot; Object Required Filter Pivot Tables", "body": "<p>I'm looking to filter a pivot table between 2 dates stated in O2 and O3 and can't seem to get rid of this error. Any help would be appreciated.</p>\n\n<pre><code>Sub MyFilter()\n\nDim pvtfld As PivotField\nDim pvtfil As PivotFilter\nDim pvtfils As PivotFilters\n\nSet pvtfld = ThisWorkbook.Sheets(\"Sheet1\").PivotTables(\"PivotTable1\").PivotFields(\"Date\")\n\nFor Each pvtfil In pvtfld.PivotFilters\n\nNext pvtfil\n\nSet pvtfil = pvtfils.Add(xlDateBetween, Date, O2, O3, xlDescending)\n\nEnd Sub\n</code></pre>\n\n<p>Error as below.</p>\n\n<blockquote>\n  <p>Error 424 Object required appears at set pvtfil line.</p>\n</blockquote>\n"}, {"tags": ["excel", "vba", "ms-access", "debugging", "devops"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1562147998, "post_id": 56867458, "comment_id": 100283851, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/19726791/11683\">How to programmatically change conditional compilation properties of a VBA project</a>"}, {"owner": {"reputation": 293, "user_id": 9271992, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a08ed11ad90a790d7cb41d7d1804818?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/9271992/alexander"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1562148652, "post_id": 56867458, "comment_id": 100284277, "body": "Hi @GSerg, thanks for the link. It&#39;s quite an interesting idea... but a bit of an overkill :) Again, I might just use a simple Const called isDebug... but, as experience has proved, it&#39;s too unreliable and error-prone."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1562149988, "post_id": 56867458, "comment_id": 100284959, "body": "This question is opinion-based imo. There are many options, a simple one is <code>GetOption</code>/<code>SetOption</code> to set a debug option on a specific computer, but then you can&#39;t have conditional compilation.  You can, however, debug on a specific workstation without needing to recompile."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1562176671, "post_id": 56867458, "comment_id": 100299822, "body": "What about using a text file as condtion, if missing no debug, if present, read setting debug on/off. When deploying without the file debug is off standard and if someone else needs debug on, share the file."}, {"owner": {"reputation": 293, "user_id": 9271992, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a08ed11ad90a790d7cb41d7d1804818?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/9271992/alexander"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1562589049, "post_id": 56867458, "comment_id": 100410166, "body": "@ComputerVersteher, honestly, this is the best suggestion :) Sort of UNIX-way: touch .debug :) If you write this in an answer, I&#39;ll accept is as a solution! Simple and sweet. When I copy (automatically) my macro, the users won&#39;t have that .debug file! Totally what I wanted!"}], "answers": [{"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 2, "creation_date": 1562149329, "post_id": 56867812, "comment_id": 100284622, "body": "How is that easier/better than a <code>#const</code>? Seems just as easy, or even more easy to forget."}, {"owner": {"reputation": 293, "user_id": 9271992, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a08ed11ad90a790d7cb41d7d1804818?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/9271992/alexander"}, "edited": false, "score": 0, "creation_date": 1562149755, "post_id": 56867812, "comment_id": 100284840, "body": "Thanks @P\u1d07\u029c, I didn&#39;t know about those &quot;Argumente fuer bedingte Kompielierung&quot; :) Might be useful. However, that doesn&#39;t really solve the issue - just like Erik A noticed, it might be even easier to forget than flipping a constant..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562151933, "post_id": 56867812, "comment_id": 100285995, "body": "Well it is practically the same as a <code>#Const</code> but better than using a <code>Const</code>. \u2022 Of course you can forget to change this exactly like any other workaround you do ;) \u2022 Put a big fat warning into your workbook open event that pops up in dev mode, and you should have a SOP (standard operating procedure) to publish something which includes testing if dev mode is off (so you cannot forget it)."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1562153024, "post_id": 56867812, "comment_id": 100286560, "body": "Another pro for this is that everyone knows where to look for that switch. If it is hidden in one of the numerous modules you need to search for it."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1562148834, "creation_date": 1562148834, "answer_id": 56867812, "question_id": 56867458, "link": "https://stackoverflow.com/questions/56867458/quick-switch-between-prod-and-dev-modes/56867812#56867812", "title": "Quick switch between &quot;PROD&quot; and &quot;DEV&quot; modes", "body": "<p>In VBE goto <em>Extras</em> -> <em>Properties of VBAProject</em> and enter an argument for compiling eg: </p>\n\n<pre><code>DEV_MODE = -1\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/cFYT6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cFYT6.png\" alt=\"enter image description here\"></a><br>\n<sup><em>Sorry for the German screenshot.</em></sup></p>\n\n<p>Then use the following code</p>\n\n<pre><code>Option Explicit\n\nSub test()\n    'the following #If is a compile condition\n    #If DEV_MODE Then\n        'this is only compiled in dev mode\n        Debug.Print \"debug mode is on\"\n    #Else\n        'this is only compiled in production mode\n        Debug.Print \"debug mode is off\"\n    #End If\nEnd Sub\n</code></pre>\n\n<p>Note that in VBA <code>-1</code> is <code>True</code> and <code>0</code> is <code>False</code>. Switching the compile argument <code>DEV_MODE = -1</code> will switch the dev mode in the whole VBA project.</p>\n"}, {"comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 3, "creation_date": 1562151165, "post_id": 56868243, "comment_id": 100285568, "body": "That seems like exactly what the OP declares to be a &quot;dirty hack&quot; they are currently using."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1562155017, "post_id": 56868243, "comment_id": 100287707, "body": "At the end everything is a hack. Const, Compile Switch, Ini-File, Registry... I just wanted to point out that you should have a single place to check it so it&#39;s easy to change the logic. And don&#39;t you think that the accepted answer of the duplicate link isn&#39;t a much bigger hack?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1562155095, "post_id": 56868243, "comment_id": 100287758, "body": "It is also a hack, but it is not a hack the OP <i>is already using</i>."}], "tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1562150341, "creation_date": 1562150341, "answer_id": 56868243, "question_id": 56867458, "link": "https://stackoverflow.com/questions/56867458/quick-switch-between-prod-and-dev-modes/56868243#56868243", "title": "Quick switch between &quot;PROD&quot; and &quot;DEV&quot; modes", "body": "<p>I don't like the attempt of having the switch as Compiler-Setting - forgetting to change it is even more likely than changing a Const definition.</p>\n\n<p>I find your attempt checking username, devicename, path of the file or stuff like that not too bad. Just put the logic into a small function <code>isTestMode()</code> (even if it is a one-liner) which returns a <code>boolean</code>. Within this function, it is easy to change to logic if another person will take over the work. Use this function (and nothing else!) to check if or if not to execute your <em>debugging</em> statements.</p>\n\n<pre><code>Public Function isTestMode() as boolean\n    ' Checking current user\n    isTestMode = (environ(\"Username\") = \"FunThomas\")\n    ' Checking device name\n    isTestMode = (environ(\"ComputerName\") = \"MySuperPC\")\n    ' Checking if a specific file is present\n    isTestMode = Dir(thisworkbook.Path &amp; \"\\IsTestMode\") &lt;&gt; \"\")\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1562657709, "post_id": 56945680, "comment_id": 100434258, "body": "Just a little note. Be aware that this is not Mac safe. So if you have potential Mac users but develop only in Windows you can just set it always to production mode in Macs. Therefore use conditional compilation <code>#If Mac Then</code> \u2026 <code>&#39;production</code> \u2026 <code>#Else</code> \u2026 <code>&#39;your code</code> \u2026 <code>#End If</code>. \u2022 If you want to develop on Mac too then you will need a Mac way to test for the file, because <code>Scripting.Filesystemobject</code> is not available on Mac."}, {"owner": {"reputation": 293, "user_id": 9271992, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a08ed11ad90a790d7cb41d7d1804818?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/9271992/alexander"}, "edited": false, "score": 0, "creation_date": 1563183361, "post_id": 56945680, "comment_id": 100602029, "body": "This is the best solution. Totally automatic and hassle-free (when you copy an Office file to users, they won&#39;t have the .debug file)! If you forgot to add the .debug file, you&#39;d notice it very quickly during the DEV stage (when some tools would stop working) :)"}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": true, "score": 1, "last_activity_date": 1562649888, "last_edit_date": 1562649888, "creation_date": 1562648818, "answer_id": 56945680, "question_id": 56867458, "link": "https://stackoverflow.com/questions/56867458/quick-switch-between-prod-and-dev-modes/56945680#56945680", "title": "Quick switch between &quot;PROD&quot; and &quot;DEV&quot; modes", "body": "<p>You can use a textfile in workbooks path as condition.</p>\n\n<p>If the file is missing ('DebugMode.txt' in example) or the debug option ('DebugMode:On' in textfile) is not set, turn off debug mode, else turn it on.</p>\n\n<p>If you deploy the workbook without the textfile, debug mode is off.</p>\n\n<p>If some else needs debug mode on, share/create the file.</p>\n\n<p>Example code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function IsDebugMode() As Boolean\n\nConst DebugOptionFileName As String = \"DebugMode.txt\" \nConst DebugIsOnString As String = \"DebugMode:On\"\nConst ForReading as Long = 1\n\nDim txtStream As Object\nDim DebugOptionFilePath As String\n\nIsDebugMode = False\nDebugOptionFilePath = ThisWorkbook.Path &amp; \"\\\" &amp; DebugOptionFileName\n\nWith CreateObject(\"Scripting.Filesystemobject\")\n    If .FileExists(DebugOptionFilePath) Then\n        Set txtStream = .OpenTextFile(DebugOptionFilePath, ForReading, False)\n        Do Until txtStream.AtEndOfStream\n            If txtStream.ReadLine = DebugIsOnString Then\n                IsDebugMode = True\n                Exit Do\n            End If\n        Loop\n    End If\nEnd With\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 9271992, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8a08ed11ad90a790d7cb41d7d1804818?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/9271992/alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 56945680, "answer_count": 3, "score": 0, "last_activity_date": 1594569673, "creation_date": 1562147711, "last_edit_date": 1594569673, "question_id": 56867458, "link": "https://stackoverflow.com/questions/56867458/quick-switch-between-prod-and-dev-modes", "title": "Quick switch between &quot;PROD&quot; and &quot;DEV&quot; modes", "body": "<p>I develop VBA code using some advanced automated macros that do \"plumbing\" and extra debugging during DEV phase.\nHowever, when I ship the files to users (PROD phase), I want all of this to be turned off.</p>\n\n<p>Those switches between DEV and PROD happen quite a lot (git + devops methodology).</p>\n\n<p>What would be the best / most elegant way to implement a quick \"switch\" between DEV and PROD?\nYes, I could just use a global Const isDebug (and I did it for some projects), but it's burdensome, inelegant and error-prone (more than once I forgot to \"flip\" the switch - as I said earlier, quick and agile \"almost\" CI/CD pipeline).</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Right now I'm using a quick dirty hack (I don't like dirty hacks) that checks whether the Excel file is being ran from a location with my login name in the path. If yes - that means I'm working on the file. If no - someone else is using it and we don't need any debugging modes. But it's ugly and I can foresee a lot of problems (for one, tomorrow someone else might be developing those VBAs... so the debug code would have to be rewritten).</p>\n"}, {"tags": ["excel", "vba", "loops", "range", "cell"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1562147956, "post_id": 56867327, "comment_id": 100283821, "body": "Can you rework your question so it&#39;s readable?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 1, "creation_date": 1562148104, "post_id": 56867327, "comment_id": 100283919, "body": "I don&#39;t understand your question.  I suggest you edit your question after reading through the HELP topics for <a href=\"http://stackoverflow.com/help/how-to-ask\">How do I Ask a Good Question</a>, and also <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>, so we can better assist you."}], "owner": {"reputation": 1, "user_id": 11449509, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Matt L", "link": "https://stackoverflow.com/users/11449509/matt-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562182317, "creation_date": 1562147256, "last_edit_date": 1562182317, "question_id": 56867327, "link": "https://stackoverflow.com/questions/56867327/loop-n-x-scan-if-col-f-exists-write-col-a-always-application-or-object-error", "title": "Loop n-&gt;x, scan if col f exists, write col a. Always application or object error", "body": "<p>My problem is so simple I may be confusing with my rank ignorance. My apologies. I specify as args column to read, row to start, row to stop, pad length, output data per line, column to check if empty. I wish to iterate thru rowstart to row stop and build string from values read... Furthermore it appends quotes to text leaving ints alone. It's an error code table for ESP32 projects.</p>\n\n<pre><code>Cells(intRow, col); \nWorksheets(Application.activesheet.name).range(cells(introw,col),cells(introw,col); \nWorksheets(\"errorCodes\").Cells(introw,col);\nrange(cells(introw,col),cells(introw,col)).value; \nrange(introw, col).value.... more..\ngetcarray(12,400,800,40,6,12) in immediate window:\n\nPublic Function getCArray(col, row, rowend, pad, maxPerRow, checkCol)\n...Do... \n\ncheckCell = Worksheets(\"errorCodes\").Cells(intRow, col).Value\ncccheck = Worksheets(\"errorCodes\").Cells(intRow, checkCol).Value   \n If (Len(cccheck) &gt; 2) \n</code></pre>\n\n<p>...</p>\n\n<p>I want a return of cells col from row to rowend where checkcol cell len > 2 \nreturned between \",\" and a padding of spaces of pad long.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1562149093, "post_id": 56867265, "comment_id": 100284500, "body": "Use <code>&quot;=DropDown!$C$2:$C$&quot; &amp; LastRowS</code> as formula"}, {"owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1562213059, "post_id": 56867265, "comment_id": 100309137, "body": "@Vincent G Thanks for the help :)"}], "owner": {"reputation": 51, "user_id": 9864567, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rithwik Sarma", "link": "https://stackoverflow.com/users/9864567/rithwik-sarma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 14, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562149040, "creation_date": 1562147038, "last_edit_date": 1562149040, "question_id": 56867265, "link": "https://stackoverflow.com/questions/56867265/how-to-remove-dynamic-data-validation-error", "title": "How to remove Dynamic data validation error", "body": "<p>My code dynamically assigns validations from a list to a particular range of data. But an error is occurring in the same. All elements of the list are assigned to row1 but all elements minus the top element of the list are assigned to row2 and similarly, for row3 all elements minus the top two elements of the list are assigned and so on. Please see the images for a better understanding of my problem</p>\n\n<pre><code>With sht.Range(\"C2:C\" &amp; LastRow1).Validation 'LastRow1 is the last row till which validations have to be assigned\n    .delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n    Operator:=xlBetween, Formula1:=\"=DropDown!C2:C\" &amp; LastRowS 'LastRowS is the last row of the list from which validations will be assigned\n    .IgnoreBlank = True\n    .InCellDropdown = True\n    .InputTitle = \"\"\n    .ErrorTitle = \"\"\n    .InputMessage = \"\"\n    .ErrorMessage = \"Value not present in drop down.\"\n    .ShowInput = True\n    .ShowError = True\nEnd With\n\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/zUAnf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zUAnf.png\" alt=\"LIST\"></a>\n<a href=\"https://i.stack.imgur.com/rdZDo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rdZDo.png\" alt=\"ROW1\"></a>\n<a href=\"https://i.stack.imgur.com/cvBpk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cvBpk.png\" alt=\"ROW2\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1562148250, "post_id": 56867069, "comment_id": 100284020, "body": "Can you edit your question to include an example of what you have and what you want?  <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a> might be userful to you in adding the information to let us better assist you."}, {"owner": {"reputation": 33, "user_id": 10632015, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PS5vqhhsPAQ/AAAAAAAAAAI/AAAAAAAAAAc/UfBgHtQIwqY/photo.jpg?sz=128", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/10632015/amit-sharma"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1562582605, "post_id": 56867069, "comment_id": 100406967, "body": "Hi Ron, Thanks for the response, I resolved this."}], "owner": {"reputation": 33, "user_id": 10632015, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PS5vqhhsPAQ/AAAAAAAAAAI/AAAAAAAAAAc/UfBgHtQIwqY/photo.jpg?sz=128", "display_name": "Amit Sharma", "link": "https://stackoverflow.com/users/10632015/amit-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562147558, "creation_date": 1562146338, "last_edit_date": 1562147558, "question_id": 56867069, "link": "https://stackoverflow.com/questions/56867069/how-can-we-transfer-data-from-one-sheet-to-another-by-skipping-rows-in-next-shee", "title": "How can we transfer data from one sheet to another by skipping rows in next sheet.?", "body": "<p>Need to copy paste the data from one worksheet to second basis column headers matching in both worksheets and skipping one row in second worksheet where the data is getting pasted.</p>\n\n<p>I am able to successfully transfer the data by matching the column headers but unable to perform the action on skipping one row on second worksheet. </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>\nOption explicit\n\nPublic ws1 As Worksheet\nPublic ws2 As Worksheet\nPublic b As Long\nPublic c As Long\nPublic i As Long\n\nSub pMain()\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\n  Dim j As Long\n  Dim k As Long\n  Dim m As Long\n  Dim lMatch As Long\n\nThisWorkbook.Activate\n\nSet ws1 = Sheets(\"Completed or resolved\") '*** Worksheet- Completed or resolved-****\n    Set ws2 = Worksheets(\"Enter Detailed Updates Here\")\n\n  m = 1\n  j = ws1.Cells.Find(\"*\", ws1.Cells(1), xlValues, xlPart, xlByRows, xlPrevious).Row ' finding last row of worksheet-Completed or Resolved\n  k = ws1.Cells.Find(\"*\", ws1.Cells(1), xlValues, xlPart, xlByColumns, xlPrevious).Column ' finding last columns of worksheet-Completed or Resolved\n\n  For i = 1 To k\n\n    lMatch = pMatch(ws2.Cells(1, i), ws1.Rows(1))\n\n    If lMatch &lt;&gt; 0 Then\n        ws1.Activate\n        'ws1.Cells(i, lMatch).Copy\n            ws1.Range(Cells(2, lMatch), Cells(j, lMatch)).Copy\n                ws2.Activate\n                Call fnRMatch\n            'ws2.Cells(2, i).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n            ws2.Cells(2, i).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n        ElseIf lMatch = 0 Then\n    End If\n\n  Next i\n\n  Application.CutCopyMode = False\n\n  MsgBox \"Database Saved\", vbOKCancel\n\n  Application.ScreenUpdating = True\n  Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Function pMatch(vValue As Variant, _\n                        vArray As Variant) As Long\n  Dim ret As Long\n\n  On Error Resume Next\n  ret = WorksheetFunction.Match(CDbl(vValue), vArray, 0)\n  If ret = 0 Then ret = WorksheetFunction.Match(CStr(vValue), vArray, 0)\n\n  pMatch = ret\nEnd Function\n\nFunction fnRMatch()\n'finding last row of worksheet - Enter detailed updates here\n        b = ws2.Cells.Find(\"*\", ws2.Cells(1), xlValues, xlPart, xlByRows, xlPrevious).Row\nEnd Function\n\nFunction fnCMatch()\n'finding last column of worksheet - Enter detailed updates here\n        c = ws2.Cells.Find(\"*\", ws2.Cells(1), xlValues, xlPart, xlByColumns, xlPrevious).Column\n\nEnd Function\n</code></pre>\n\n<p>Currently the data is getting pasted for entire range but unable to skip blank rows in second worksheet.</p>\n"}, {"tags": ["arrays", "excel", "vba", "copy", "paste"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562152344, "post_id": 56866826, "comment_id": 100286195, "body": "So if you find &quot;Claims&quot; you want to go one cell to the right and then copy every third cell? Until when - you run out of data or column L?"}, {"owner": {"reputation": 3, "user_id": 8772552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4f9ff0ba1d08459a91b4b37e575be1a?s=128&d=identicon&r=PG&f=1", "display_name": "Nidal", "link": "https://stackoverflow.com/users/8772552/nidal"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562177233, "post_id": 56866826, "comment_id": 100300068, "body": "Yes, I wanna it untile colum 156, but I try to find code to select and copy this specific cells"}], "owner": {"reputation": 3, "user_id": 8772552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4f9ff0ba1d08459a91b4b37e575be1a?s=128&d=identicon&r=PG&f=1", "display_name": "Nidal", "link": "https://stackoverflow.com/users/8772552/nidal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562148838, "creation_date": 1562145533, "last_edit_date": 1562148838, "question_id": 56866826, "link": "https://stackoverflow.com/questions/56866826/find-value-in-another-workbook-and-copy-specifiec-cells-from-one-row-to-many-col", "title": "Find value in another workbook and copy specifiec cells from one row to many column", "body": "<p>I try to creat a Macro where select one value from the actieve workbook and search about it in another workbook then when find the value select the cells like array (after actieve cell move one cell to the right and select the cell then select another cell after 2 column and select Like: \n( C2,F2,I2,L2 ....).copy\nand past it transpose in first workbook</p>\n\n<p>maybe it's a little hard to explain but I think the code would be better:</p>\n\n<pre><code>Sub Find_copy_paste()\n\n    Dim FindString As String\n    Dim Rng As Range\n    Dim y As Workbook\n    Dim x as Workbook\n\n    Set y = Workbooks(\"H\\Data1.xlsm\")\n    Set x = Workbooks.Open(\"G\\info.xlsx\")\n\n    FindString = y.Sheets(\"Teams\").Range(\"A121\").Value\n\n    If Trim(FindString) &lt;&gt; \"\" Then\n        With x.Sheets(\"Claims\").Range(\"B:B\")\n            Set Rng = .find(What:=FindString, _\n                            After:=.Cells(.Cells.Count), _\n                            LookIn:=xlValues, _\n                            LookAt:=xlWhole, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlNext, _\n                            MatchCase:=False)\n            If Not Rng Is Nothing Then\n            Application.Goto Rng, True\n            **'' I want hier to select actieve cell then one step to the right and start to copy array  ( C2,F2,I2,L2 ....) then paste it transpose in y workbook**\n\n            Else\n                MsgBox \"Nothing found\"\n            End If\n        End With\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Any body can help?? </p>\n\n<p>Thanks :)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1562146377, "post_id": 56866604, "comment_id": 100282980, "body": "When you get the error, where does the code stop?"}, {"owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1562146577, "post_id": 56866604, "comment_id": 100283091, "body": "Hello. Thenks for your quick answerIn me. Repaint"}, {"owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "reply_to_user": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1562146601, "post_id": 56866604, "comment_id": 100283105, "body": "Sorry: the code stop in me. Repaint"}, {"owner": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 1, "creation_date": 1562146632, "post_id": 56866604, "comment_id": 100283121, "body": "instead of <code>Me</code> use the name of the Userform, e.g. <code>Userform1.Repaint</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562147189, "post_id": 56866604, "comment_id": 100283410, "body": "Run this <code>RedibujaFormProgressBar</code> step by step using F8 and see in which line the error occurs then. Actually it is very unlikely that the  <code>Me.Repaint</code> can throw a &quot;Type Mismatch&quot; error itself."}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 2182, "user_id": 4721281, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9ca3ef336c479bc32997b548b75e7c24?s=128&d=identicon&r=PG&f=1", "display_name": "MGP", "link": "https://stackoverflow.com/users/4721281/mgp"}, "edited": false, "score": 0, "creation_date": 1562149870, "post_id": 56866604, "comment_id": 100284896, "body": "<code>Me</code> can be used only inside <code>Forms</code> or <code>Objects</code> (sheets, user forms) assigned to events (change, initialize, activate etc.), so use direct name of userform, e.g. <code>Userform1.Repaint</code> as specified by @MarcoGetrost"}], "owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562147020, "creation_date": 1562144838, "last_edit_date": 1562147020, "question_id": 56866604, "link": "https://stackoverflow.com/questions/56866604/programmatically-repaint-form", "title": "Programmatically repaint form", "body": "<p>I have an programmatically created a userform with code</p>\n\n<pre><code>Sub RedibujaFormProgressBar()\n    debug.print \"Here\" 'Only For control\n    Me.Repaint\nEnd Sub\n</code></pre>\n\n<p>From a code module, I try to call it with</p>\n\n<pre><code>Call m_FormProgressBar.RedibujaFormProgressBar\n</code></pre>\n\n<p>As result, inmediate window shows \"Here\", but when trying to repaint, i receive error 13 (Type MisMatch)</p>\n\n<p>I need to repaint the form in order to show progress. Any idea?</p>\n"}, {"tags": ["vba", "vbscript"], "comments": [{"owner": {"reputation": 1197, "user_id": 11657446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3q1Tr.png?s=128&g=1", "display_name": "arnonuem", "link": "https://stackoverflow.com/users/11657446/arnonuem"}, "edited": false, "score": 0, "creation_date": 1562144027, "post_id": 56866307, "comment_id": 100281593, "body": "Hi, would be helpful if you could share the relevant part of the script."}, {"owner": {"reputation": 9, "user_id": 9379983, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7kfkehKKdU/AAAAAAAAAAI/AAAAAAAAABs/IZ8CBdYdd58/photo.jpg?sz=128", "display_name": "Vikit Shetty", "link": "https://stackoverflow.com/users/9379983/vikit-shetty"}, "reply_to_user": {"reputation": 1197, "user_id": 11657446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3q1Tr.png?s=128&g=1", "display_name": "arnonuem", "link": "https://stackoverflow.com/users/11657446/arnonuem"}, "edited": false, "score": 0, "creation_date": 1562144466, "post_id": 56866307, "comment_id": 100281849, "body": "Hello @arnonuem, I have added the code. You can see that the variable vCcEmailAddress is my variable to fetch the cc. Let me know if some more detail is required. Thank you for your response."}, {"owner": {"reputation": 1197, "user_id": 11657446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3q1Tr.png?s=128&g=1", "display_name": "arnonuem", "link": "https://stackoverflow.com/users/11657446/arnonuem"}, "edited": false, "score": 0, "creation_date": 1562144975, "post_id": 56866307, "comment_id": 100282130, "body": "I am not an expert on this but i just found this solution: See the Recipients collection, and check the type property of each recipient object. Please try if this helps. I found that here: <a href=\"https://forums.slipstick.com/threads/29621-extracting-cc-email-address-using-vba/\" rel=\"nofollow noreferrer\">forums.slipstick.com/threads/&hellip;</a>"}, {"owner": {"reputation": 9, "user_id": 9379983, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7kfkehKKdU/AAAAAAAAAAI/AAAAAAAAABs/IZ8CBdYdd58/photo.jpg?sz=128", "display_name": "Vikit Shetty", "link": "https://stackoverflow.com/users/9379983/vikit-shetty"}, "reply_to_user": {"reputation": 1197, "user_id": 11657446, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3q1Tr.png?s=128&g=1", "display_name": "arnonuem", "link": "https://stackoverflow.com/users/11657446/arnonuem"}, "edited": false, "score": 0, "creation_date": 1562145141, "post_id": 56866307, "comment_id": 100282238, "body": "Thanks @arnonuem. I already saw that like I mentioned earlier. I am not able to understand how to use that."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 1, "creation_date": 1562146490, "post_id": 56866307, "comment_id": 100283039, "body": "Please reduce that wall of code to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 9, "user_id": 9379983, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7kfkehKKdU/AAAAAAAAAAI/AAAAAAAAABs/IZ8CBdYdd58/photo.jpg?sz=128", "display_name": "Vikit Shetty", "link": "https://stackoverflow.com/users/9379983/vikit-shetty"}, "reply_to_user": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1562147197, "post_id": 56866307, "comment_id": 100283418, "body": "Hello @AnsgarWiechers. I have reduced the code. Now you will see that I am trying to get the cc email address(variable vCcEmailAddress) and sender email in message box (variable vSenderEmailAddress ). Thanks for the feedback. Let me know if anymore details is required."}, {"owner": {"reputation": 9, "user_id": 9379983, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7kfkehKKdU/AAAAAAAAAAI/AAAAAAAAABs/IZ8CBdYdd58/photo.jpg?sz=128", "display_name": "Vikit Shetty", "link": "https://stackoverflow.com/users/9379983/vikit-shetty"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562148112, "post_id": 56866307, "comment_id": 100283928, "body": "@AAA Currently I have coded it just for one cc"}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562149007, "post_id": 56866307, "comment_id": 100284455, "body": "I assume you have no problem getting SenderEmailAddress. The answer below helps you get CC email address"}, {"owner": {"reputation": 9, "user_id": 9379983, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7kfkehKKdU/AAAAAAAAAAI/AAAAAAAAABs/IZ8CBdYdd58/photo.jpg?sz=128", "display_name": "Vikit Shetty", "link": "https://stackoverflow.com/users/9379983/vikit-shetty"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562150735, "post_id": 56866307, "comment_id": 100285328, "body": "@AAA i did something similar to your answer and was able to solve it. Thanks a lot for your help buddy. Attached is my answer"}, {"owner": {"reputation": 14608, "user_id": 692942, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c2e501358dbf183e074c2f9a7896fbff?s=128&d=identicon&r=PG&f=1", "display_name": "user692942", "link": "https://stackoverflow.com/users/692942/user692942"}, "edited": false, "score": 0, "creation_date": 1562223910, "post_id": 56866307, "comment_id": 100312341, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/28986306/get-item-recipient-with-outlook-vba\">Get item.recipient with Outlook VBA</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 1, "last_activity_date": 1562148959, "creation_date": 1562148959, "answer_id": 56867849, "question_id": 56866307, "link": "https://stackoverflow.com/questions/56866307/extract-email-address-instead-of-email-name-of-the-cc-using-vbscript/56867849#56867849", "title": "Extract email address instead of email name of the CC using vbscript?", "body": "<pre class=\"lang-vb prettyprint-override\"><code>With item1.Recipients\n    For i = 1 To .Count\n        If .Item(i).Type = OlMailRecipientType.olCC Then\n            vCcEmailAddress = .Item(i).Address\n            Exit For\n        End If\n    Next i\nEnd With\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 9, "user_id": 9379983, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7kfkehKKdU/AAAAAAAAAAI/AAAAAAAAABs/IZ8CBdYdd58/photo.jpg?sz=128", "display_name": "Vikit Shetty", "link": "https://stackoverflow.com/users/9379983/vikit-shetty"}, "edited": false, "score": 0, "creation_date": 1562154041, "post_id": 56868388, "comment_id": 100287160, "body": "Above is the solution that is used to get the cc address"}], "tags": [], "owner": {"reputation": 9, "user_id": 9379983, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7kfkehKKdU/AAAAAAAAAAI/AAAAAAAAABs/IZ8CBdYdd58/photo.jpg?sz=128", "display_name": "Vikit Shetty", "link": "https://stackoverflow.com/users/9379983/vikit-shetty"}, "is_accepted": false, "score": -1, "last_activity_date": 1562935915, "last_edit_date": 1562935915, "creation_date": 1562150824, "answer_id": 56868388, "question_id": 56866307, "link": "https://stackoverflow.com/questions/56866307/extract-email-address-instead-of-email-name-of-the-cc-using-vbscript/56868388#56868388", "title": "Extract email address instead of email name of the CC using vbscript?", "body": "<pre><code>Set objFolder = olns.GetDefaultFolder(6)\nFor each item1 in objFolder.Items      \n   For Each RecipientObject In item1.Recipients\n      If RecipientObject.Type = 2 Then\n      msgbox RecipientObject.Address\n      End if\n   Next\nNext\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 9379983, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-O7kfkehKKdU/AAAAAAAAAAI/AAAAAAAAABs/IZ8CBdYdd58/photo.jpg?sz=128", "display_name": "Vikit Shetty", "link": "https://stackoverflow.com/users/9379983/vikit-shetty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 663, "favorite_count": 0, "accepted_answer_id": 56867849, "answer_count": 2, "score": 0, "last_activity_date": 1589662005, "creation_date": 1562143781, "last_edit_date": 1562147099, "question_id": 56866307, "link": "https://stackoverflow.com/questions/56866307/extract-email-address-instead-of-email-name-of-the-cc-using-vbscript", "title": "Extract email address instead of email name of the CC using vbscript?", "body": "<p>I am writing a VBScript to extract CC from the email. When I extract the cc, instead of an email address, it shows the email name of the person. I had same issue while I was extracting the \"from\" address. I checked whether the email address type of the from the person (.SenderEmailType) is SMTP or EX and was able to fetch the email address instead of email name. I don't know how to do the same for CC. I  have checked online, it is written to loop through \"Mailitems.Recipent\". I am new to vbscript to I am not sure how to do this. Currently I am using .CC object to get the cc detail.</p>\n\n<pre><code>Set Arg = WScript.Arguments\ndim item1\ndim objsubject \ndim intcount\nDim i \ndim savename \ndim vTextFile\ndim filename \ndim extension\nDim t\nDim Itimestamp \ndim savefolder \nDim vSenderEmailAddress\nDim vCcEmailAddress\nDim vFlagTextFileCreate\n\n\nvFlagTextFileCreate = True\nsavefolder = \"C:\\Users\\tgssupport\\Documents\\Automation Anywhere Files\\Automation Anywhere\\My Scripts\\Retro Pricing\\junk\"\nvTextFile = savefolder &amp; \"\\File Report.txt\"\nvFlagExcelAttachmentFound = False\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nOn Error Resume Next\nSet olApp = GetObject(, \"Outlook.Application\")\nIf Err.Number &lt;&gt; 0 Then    'Could not get instance of Outlook, so create a new one\n   Err.Clear\n   Set olApp = CreateObject(\"Outlook.Application\")\nEnd If\non error goto 0\nSet olns = olApp.GetNameSpace(\"MAPI\")\nolns.logon \"Outlook\",,False,True\n'6 is for Inbox\nSet objFolder = olns.GetDefaultFolder(6)\nFor each item1 in objFolder.Items\n\n  if item1.Unread=true then\n    objsubject = item1.subject\n      vCcEmailAddress = item1.CC\n      If item1.SenderEmailType = \"SMTP\" Then\n               vSenderEmailAddress = item1.SenderEmailAddress\n      ElseIf item1.SenderEmailType = \"EX\" Then\n               vSenderEmailAddress = item1.Sender.GetExchangeUser.PrimarySmtpAddress\n      End If 'If item1.SenderEmailType\n      msgbox vCcEmailAddress.\n      msgbox vSenderEmailAddress.\n  end if 'if item1.Unread=true\nNext\nolns.logoff\nSet olns  = Nothing\nSet olApp = Nothing\nWScript.Quit\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1562143556, "post_id": 56866165, "comment_id": 100281339, "body": "`Worksheets(strName).Range(&quot;I5&quot;).Copy ..."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562147362, "post_id": 56866165, "comment_id": 100283503, "body": "And add error handling (<a href=\"https://excelmacromastery.com/vba-error-handling\" rel=\"nofollow noreferrer\">VBA Error Handling \u2013 A Complete Guide</a>) otherwise the user will end up in debug mode if he enters a sheet name that does not exist."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1562148200, "creation_date": 1562148200, "answer_id": 56867608, "question_id": 56866165, "link": "https://stackoverflow.com/questions/56866165/object-required-in-excel-vba/56867608#56867608", "title": "Object Required in Excel VBA", "body": "<p>You need to test if the worksheet name exists that the user entered otherwise the copy will fail. Also if the user presses the <kbd>Cancel</kbd> button the <code>InputBox</code> will return a boolean <code>False</code>. You need to check for that and eg exit, or your code fails too.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n    Dim wsSummary As Worksheet\n    Set wsSummary = ThisWorkbook.Worksheets(\"Summary\")\n\n    Dim NextCellInColumn As Range\n    Set NextCellInColumn = wsSummary.Cells(wsSummary.Rows.Count, 4).End(xlUp).Offset(1, 0)\n\n    Dim strName As Variant 'if user presses cancel it will return a boolean false\n    strName = Application.InputBox(\"Please enter\")\n\n    If VarType(strName) = vbBoolean And strName = False Then Exit Sub 'user pressed cancel so exit\n\n    If WorksheetExists(strName) Then\n        NextCellInColumn.Value = ThisWorkbook.Worksheets(strName).Range(\"I5\").Value\n        ThisWorkbook.Worksheets(strName).Range(\"I5\").Copy wsSummary.Range(\"D6\")\n    Else\n        MsgBox \"Worksheet '\" &amp; strName &amp; \"' not found.\", vbCritical\n    End If\nEnd Sub\n\n'check if a worksheet exists\nPublic Function WorksheetExists(ByVal WorksheetName As String, Optional ByVal wb As Workbook) As Boolean\n    If wb Is Nothing Then Set wb = ThisWorkbook 'default to thisworkbook\n\n    Dim ws As Worksheet\n    On Error Resume Next\n    Set ws = wb.Worksheets(WorksheetName)\n    On Error GoTo 0\n\n    WorksheetExists = Not ws Is Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11733332, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-gBteGsENvkI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfzCI1HssIRWjMnKLbI8DonVanqKw/photo.jpg?sz=128", "display_name": "shajiv ram", "link": "https://stackoverflow.com/users/11733332/shajiv-ram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562148200, "creation_date": 1562143350, "last_edit_date": 1562147261, "question_id": 56866165, "link": "https://stackoverflow.com/questions/56866165/object-required-in-excel-vba", "title": "Object Required in Excel VBA", "body": "<p>I am trying to get the user to enter sheet name and based on the input I want selected cell value to be copied from one sheet to another sheet to a new row.</p>\n\n<p>This is for a basic excel functioning system</p>\n\n<pre><code>Set nextCellInColumn = Worksheets(\"Summary\").Cells(Rows.Count, 4).End(xlUp).Offset(1, 0)\nstrName = Application.InputBox(\"Please enter\")\nnextCellInColumn.Value = Worksheets.Application.InputBox(\"Please enter\").Range(\"I5\").Value\nWorksheets.Application.InputBox(\"Please enter\").Range(\"I5\").Copy Worksheets(\"Summary\").Range(\"D6\")\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1562145745, "post_id": 56866149, "comment_id": 100282611, "body": "Field names are equal? If not update Control.ControSource to new name."}, {"owner": {"reputation": 97, "user_id": 11316927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e6878c9f608b76b3cd4a37d918b47d?s=128&d=identicon&r=PG&f=1", "display_name": "veryBadProgrammer", "link": "https://stackoverflow.com/users/11316927/verybadprogrammer"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1562146670, "post_id": 56866149, "comment_id": 100283134, "body": "@ComputerVersteher No, they aren&#39;t! Except for the one field where I have a value. So I can&#39;t give the fields unique names, correct? Or can I change them after filling the ADO? If I got you right, I need to change the names in the <code>vba .Fields.Append &quot;NAME&quot;, TYPE </code>statements."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1562146972, "post_id": 56866149, "comment_id": 100283287, "body": ".ControlSource is a Control property (like a textbox) not a recordset field property. If you name the adodb recordset fields like the dao fields on append. no changes needed in Controlsource or use<code>Me.Controls(&quot;MyTextbox&quot;).ControlSource = &quot;valX&quot;</code> Shouldn&#39;t matter where in code."}, {"owner": {"reputation": 97, "user_id": 11316927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e6878c9f608b76b3cd4a37d918b47d?s=128&d=identicon&r=PG&f=1", "display_name": "veryBadProgrammer", "link": "https://stackoverflow.com/users/11316927/verybadprogrammer"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1562147110, "post_id": 56866149, "comment_id": 100283367, "body": "@ComputerVersteher I can&#39;t mark your answer as correct, but it worked. Thanks a lot. I didn&#39;t even need to change the names back because as you said the ControlSource still has the name I assigned it with."}], "answers": [{"tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": true, "score": 1, "last_activity_date": 1562147618, "creation_date": 1562147618, "answer_id": 56867434, "question_id": 56866149, "link": "https://stackoverflow.com/questions/56866149/how-do-you-fill-a-recordsource-with-values-from-an-ado-recordset/56867434#56867434", "title": "How do you fill a Recordsource with values from an ADO Recordset?", "body": "<p><code>.ControlSource</code> is a control-property (like a textbox) not a recordset field-property.</p>\n\n<p>It binds the recordset-field to the form/report-control.</p>\n\n<p>If you name the adodb recordset-fields same as  the dao fields on append. no changes needed in Controlsource:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>.Fields.Append \"NameOfDaoField0\", adInteger\n</code></pre>\n\n<p>or use</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.Controls(\"MyTextbox\").ControlSource = \"valX\"\n</code></pre>\n\n<p>where valX is the appended new name of the field (val0, val1, ... in your case).</p>\n\n<p>Shouldn't matter where in code.</p>\n"}], "owner": {"reputation": 97, "user_id": 11316927, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44e6878c9f608b76b3cd4a37d918b47d?s=128&d=identicon&r=PG&f=1", "display_name": "veryBadProgrammer", "link": "https://stackoverflow.com/users/11316927/verybadprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "accepted_answer_id": 56867434, "answer_count": 1, "score": 1, "last_activity_date": 1594639819, "creation_date": 1562143286, "last_edit_date": 1594639819, "question_id": 56866149, "link": "https://stackoverflow.com/questions/56866149/how-do-you-fill-a-recordsource-with-values-from-an-ado-recordset", "title": "How do you fill a Recordsource with values from an ADO Recordset?", "body": "<p>I am trying to have a Recordset that holds data copied from another Recordset plus two additional columns. I have mentioned this before in <a href=\"https://stackoverflow.com/questions/56579800/is-there-a-way-to-write-to-edit-a-otherwise-read-only-recordset-for-the-context\">another question</a>. Now there's a problem somewhere in the following code which I can't identify. </p>\n\n<p>If you read the post I've linked, you have already seen this code. I've only changed the part where I append fields to the Recordset as I think there's an error there somewhere. It now looks exactly like my code except the names have been changed.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim cpRS As New ADODB.Recordset, RS As DAO.Recordset, cb As checkBox, addr As String\n'Creating copy of previously displayed result table\nSet cpRS = New ADODB.Recordset\nWith cpRS\n'\n    .Fields.Append \"val0\", adInteger\n    .Fields.Append \"val1\", adInteger\n    .Fields.Append \"val2\", adVarChar, 80\n    .Fields.Append \"val3\", adVarChar, 80\n    .Fields.Append \"val4\", adVarChar, 30\n    .Fields.Append \"val5\", adVarChar, 30\n    .Fields.Append \"val6\", adVarChar, 10\n    .Fields.Append \"val7\", adVarChar, 10\n    .Fields.Append \"val8\", adVarChar, 50, adFldIsNullable\n    .Fields.Append \"val9\", adDBTimeStamp\n    .Fields.Append \"val10\", adVarChar, 50\n    .Fields.Append \"val11\", adSmallInt\n    .Fields.Append \"val12\", adVarChar, 100\n    .Fields.Append \"val13\", adVarChar, 255, adFldIsNullable\n    .Fields.Append \"val14\", adVarChar, 255, adFldIsNullable\n    .Fields.Append \"val15\", adInteger\n    .Fields.Append \"val16\", adInteger\n    .Fields.Append \"val17\", adSmallInt\n    .Fields.Append \"val18\", adSmallInt\n\n    'new Fields for temporary purposes\n    .Fields.Append \"val19\", adBoolean\n    .Fields.Append \"val20\", adVarChar, 50\n\n    .CursorLocation = adUseClient\n    .Open , , adOpenDynamic, adLockOptimistic, 8\nEnd With\n\n'get result set of previous window by applying filter to the same query used before\nDim argv() As String\nDim argRest As String\nDim qdef As DAO.QueryDef\nDim restrictedQuery As String\n\n'When opening this form I hand over OpenArgs which i restore here\n'took the code out but \"argv\" and \"argRest\" will be used later    \n\n'this is the query that is used in the previous form. i need an extra where clause though so i had to rewrite it.\nrestrictedQuery = \"some very long SQL statement I feel I don't need to put here because it doesn't contribute to the problem.\" &amp; _\n    \"If I'm incorrect, please let me know and I will rewrite it to protect the data in it\"\n\nSet qdef = CurrentDb.CreateQueryDef(\"\")\nqdef.SQL = restrictedQuery\nSet RS = qdef.OpenRecordset\nSet RS = CurrentDb.OpenRecordset(restrictedQuery, dbOpenSnapshot)\nRS.MoveLast\nRS.MoveFirst\nIf RS.RecordCount = 0 Then\n    MsgBox \"some error text\", vbOKOnly, \"error title\"\n    DoCmd.Close acForm, Me.Name\n    Exit Sub\nEnd If\n\n'populate new recordset with data from table in previous form\nDo Until RS.EOF\n'putting the data from the \"old\" recordset into the new one, shortened again, you get the idea\n    cpRS.AddNew\n    cpRS.Fields(\"val1\") = RS(\"some_value\")\n    cpRS.Fields(\"val2\") = RS(\"some_value2\")\n    '...\n    'fill the two columns that don't come from the query with default values\n    cpRS.Fields(\"val19\") = False\n    cpRS.Fields(\"val20\") = \"\"\n    cpRS.Update\n    RS.MoveNext\nLoop\n\nSet Me.Recordset = cpRS\n\nRS.Close\nSet RS = Nothing\n'cpRS.Close  - I removed this\nSet cpRS = Nothing\n</code></pre>\n\n<p>Now there's some strange behaviour (to me at least). When I debug I can see the ADO Recordset being filled with the data from the DAO Recordset. There's no error and all the values are correct. When the Form opens, however, only some cells are filled. The rest of the cells contains \"#Name?\" which makes me think that a) the datatype I set for the fields is wrong or b) the form doesn't know which values to put into the fields as there are multiple sources that try to fill it (I think I've read about this #Name? error being associated with that kind of error some time ago, but am not sure about it and I wouldn't know where the double assignment occurs).</p>\n\n<p>The structure is roughly the following:\nForm contains subform. Subform holds several textboxes that have the name of the values I add to the ADO Recordset as Control Source.(This is how my predecessor handled filling forms, i don't know if that is the common way to do this task.) The Subform's Recordsource is not set because I set the ADO Recordset as Recordsource in the Form_Load event (which is where the code is from).</p>\n\n<p>I hope this is enough information to locate the problem, otherwise let me know and I will try to provide more info.</p>\n\n<p>EDIT: I think I should add that there is exactly one column that makes it to the subform which is of the type adVarChar (val4 from the code)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562143289, "post_id": 56866093, "comment_id": 100281191, "body": "you have previously asked this question in a different format. Why not add a picture to illustrate what you are saying and want?"}, {"owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562143445, "post_id": 56866093, "comment_id": 100281284, "body": "unfortunately, I cannot take a screenshot of the file because it is confidential information. I can however explain in detail what I need the code to do."}, {"owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562144317, "post_id": 56866093, "comment_id": 100281758, "body": "The idea is that I have a sub that copy the data for each workbook linked in column B. I want to automatically fill column I using this function"}, {"owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562144365, "post_id": 56866093, "comment_id": 100281786, "body": "I added a link to the photo"}, {"owner": {"reputation": 1162, "user_id": 6893386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d02aee16378d73f403c3d0ab868a4f4e?s=128&d=identicon&r=PG&f=1", "display_name": "bobajob", "link": "https://stackoverflow.com/users/6893386/bobajob"}, "edited": false, "score": 2, "creation_date": 1562146578, "post_id": 56866093, "comment_id": 100283092, "body": "Two observations: 1) you use ActiveSheet rather than worksheet1 throughout - is that correct? 2) You&#39;re not returning anything - you&#39;ll need to have <code>Loss = min</code> at the end or similar."}, {"owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "edited": false, "score": 0, "creation_date": 1562148860, "post_id": 56866093, "comment_id": 100284383, "body": "thanks, but it&#39;s still returning a value of zero"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1562151426, "post_id": 56866093, "comment_id": 100285704, "body": "The <code>Exit For</code> statement means that the <code>For</code> loop will only run once and then exit. Try removing that"}, {"owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "edited": false, "score": 0, "creation_date": 1562159687, "post_id": 56866093, "comment_id": 100290714, "body": "Thanks, now it is only returning a value of 100"}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "edited": false, "score": 1, "creation_date": 1562331873, "post_id": 56879148, "comment_id": 100351974, "body": "Thank you so much for the help ! it&#39;s much appreciated. however this function is giving me a mismatch error on the following line:  `  If (.Cells(11, Colcount).Value &lt; min) And (Abs(.Cells(11, Colcount).Value) &lt;= 100) Then`  any idea on how to solve this?"}, {"owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "edited": false, "score": 0, "creation_date": 1562333656, "post_id": 56879148, "comment_id": 100352906, "body": "is it possible that this is due to the fact that you set the function to be a double instead of a long ?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "reply_to_user": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "edited": false, "score": 0, "creation_date": 1562366408, "post_id": 56879148, "comment_id": 100364118, "body": "It&#39;s likely that one of the values you are looking at cannot be converted to a number. I&#39;ve updated my code with some error handling to locate both the source and the reason for a type mismatch. The variable <code>min</code> was already a Double so changing the function return type wouldn&#39;t affect that line"}, {"owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "edited": false, "score": 0, "creation_date": 1562592620, "post_id": 56879148, "comment_id": 100412283, "body": "Hi, I no longer have the mismatch error however the function is only returning a value of 100. I cant seem to understand why it isn&#39;t returning the minimum"}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": true, "score": 0, "last_activity_date": 1562366465, "last_edit_date": 1562366465, "creation_date": 1562197816, "answer_id": 56879148, "question_id": 56866093, "link": "https://stackoverflow.com/questions/56866093/function-isnt-returning-desired-value/56879148#56879148", "title": "Function isn&#39;t returning desired value", "body": "<p>The combination of:</p>\n\n<pre><code>min = 0\n</code></pre>\n\n<p>and:</p>\n\n<pre><code>If (ActiveSheet.Cells(11, Colcount) &gt; min) And Abs(ActiveSheet.Cells(11, Colcount) &lt;= 100) Then\n</code></pre>\n\n<p>looks like it would find the <strong>maximum</strong> value of the data between 0 and 100. If the maximum data value is less than 0 then it looks like 0 would be returned.</p>\n\n<p>There is a more subtle error in the right-hand part of the comparison:</p>\n\n<pre><code>Abs(ActiveSheet.Cells(11, Colcount) &lt;= 100)\n</code></pre>\n\n<p>We know from the question narrative that you want this clause to return True for cell values from -100 to 100 inclusive and False otherwise. It actually returns True for cell values less than or equal to 100 and False otherwise - so, for example, a cell value of -198 would make this clause return True.</p>\n\n<p>What this clause should say is:</p>\n\n<pre><code>Abs(ActiveSheet.Cells(11, Colcount)) &lt;= 100\n</code></pre>\n\n<p>We need to take the absolute value of the cell and then compare that to 100. Previously, we were comparing the original value of the cell to 100 (which would result in True or False) and then taking the absolute value of True or False (which doesn't change anything - True stays True and False stays False).</p>\n\n<p>To find the minimum value of the data then <code>min</code> needs to start at 100 and the comparison needs to be <code>.Cells(11, Colcount) &lt; min</code>.</p>\n\n<p>Putting all of this together with suggestions in the comments from bobajob and me gives us:</p>\n\n<pre><code>Option Explicit\n\nFunction Loss(worksheet1 As Worksheet) As Double\n\nDim min As Double\nDim i As Integer\nDim myRight As Long, Colcount As Long\n\nmin = 100\n\nWith worksheet1\n    myRight = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n    On Error GoTo err_handler\n\n    For Colcount = 1 To myRight\n        If (.Cells(11, Colcount).Value &lt; min) And (Abs(.Cells(11, Colcount).Value) &lt;= 100) Then\n            min = .Cells(11, Colcount).Value\n        End If\n    Next Colcount\n\n    On Error GoTo 0\nEnd With\n\nLoss = min\n\nExit Function\n\nerr_handler:\n\nSelect Case Err.Number\n' Type mismatch\nCase 13:\n    With worksheet1.Cells(11, Colcount)\n        MsgBox \"Error in column \" &amp; Colcount &amp; \"; with value \" &amp; .Value &amp; \"; of type \" &amp; TypeName(.Value)\n    End With\n\n    ' Stop running the macro\n    Stop\n' For all other errors, just stop\nCase Else:\n    ' Stop running the macro\n    Stop\nEnd Select\n\nEnd Function\n</code></pre>\n\n<p>Additional notes:</p>\n\n<ul>\n<li>I've added <a href=\"https://docs.microsoft.com/en-gb/office/vba/Language/Reference/user-interface-help/option-explicit-statement\" rel=\"nofollow noreferrer\">Option\nExplicit</a>\nas the first line to require variables to be declared. This needs to\ngo at the top of the module before any Subs or Functions</li>\n<li>I've specified the <code>Value</code> property each time we look at a cell value.\nWhilst <code>Value</code> is the default property of a Range object, I prefer to\nspecify which property is being accessed explicitly</li>\n<li>If row 1 of the worksheet being checked doesn't have the same number of columns\nas row 11 of that worksheet then you may get incorrect results. This is\nbecause we are calculating <code>myRight</code> on row 1 but then reading data\nfrom row 11</li>\n<li>I changed the return type of the function from <code>Long</code> to <code>Double</code> to\nmatch the data type of <code>min</code></li>\n</ul>\n"}], "owner": {"reputation": 47, "user_id": 11669731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fda1ade6332a0e11d7b63e96f11ee4e7?s=128&d=identicon&r=PG&f=1", "display_name": "YaraK", "link": "https://stackoverflow.com/users/11669731/yarak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 56879148, "answer_count": 1, "score": 0, "last_activity_date": 1562366465, "creation_date": 1562143083, "last_edit_date": 1562151558, "question_id": 56866093, "link": "https://stackoverflow.com/questions/56866093/function-isnt-returning-desired-value", "title": "Function isn&#39;t returning desired value", "body": "<p>I am working on a VBA function that reads the 11th row of another worksheet and finds the minimum value on the row.</p>\n\n<p>However, the minimum's absolute value must be less than 100. (The row displays both percentages and regular values and I only need the minimum percentage.)</p>\n\n<p>Here is what I have so far:  (it has only returned a value of zero)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Function Loss(worksheet1 As Worksheet) As Long\n    Dim min As Double\n    Dim i As Integer\n    Dim myRight As Long, Colcount As Long\n\n    min = 0\n\n    myRight = ActiveSheet.Cells(1, ActiveSheet.Columns.Count).End(xlToLeft).Column\n\n    For Colcount = 1 To myRight\n        If (ActiveSheet.Cells(11, Colcount) &gt; min) And Abs(ActiveSheet.Cells(11, Colcount) &lt;= 100) Then\n            min = ActiveSheet.Cells(11, Colcount)\n        End If\n        Exit For\n    Next Colcount\nEnd Function\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/QjNYk.png\" rel=\"nofollow noreferrer\">sample data</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "edited": false, "score": 1, "creation_date": 1562141387, "post_id": 56865493, "comment_id": 100280219, "body": "<code>&quot;B15:B&quot;</code> is not a valid range address."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1562141419, "post_id": 56865544, "comment_id": 100280237, "body": "Thank You, but now I get Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1562141580, "post_id": 56865544, "comment_id": 100280305, "body": "On which line ?"}, {"owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1562141717, "post_id": 56865544, "comment_id": 100280384, "body": "Same one.  &quot;This issue may occur if one or more of the cells in an array (range of cells) contain a character string that is set to contain more than 911 characters.&quot; it may be the case I think"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1562141790, "post_id": 56865544, "comment_id": 100280430, "body": "Try the Edited ans"}, {"owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1562142734, "post_id": 56865544, "comment_id": 100280901, "body": "Now it works, but I need to define kind of dynamic range. I will count the rows and then use variable.  Second thing is that my vlookup doesnt work It searches only for the first line. Do You think I should use some kind of loop?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1562143077, "post_id": 56865544, "comment_id": 100281063, "body": "Maybe try posting Another question once your this code is working."}, {"owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1562163530, "post_id": 56865544, "comment_id": 100292995, "body": "I wish I could, but Im not allowed to post more posts :("}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1562141781, "last_edit_date": 1562141781, "creation_date": 1562140934, "answer_id": 56865544, "question_id": 56865493, "link": "https://stackoverflow.com/questions/56865493/subscript-out-of-range-while-setting-the-range/56865544#56865544", "title": "Subscript out of range while setting the range", "body": "<p>Try this:</p>\n\n<pre><code>With Application.FileDialog(msoFileDialogFilePicker)\n        'Makes sure the user can select only one file\n        .AllowMultiSelect = False\n        .Title = \"Select WIP Report\"\n        .ButtonName = \"OK\"\n        'Filter to just the following types of files to narrow down selection options\n        .Filters.Add \"Excel Files\", \"*.xlsx; *.xlsm; *.xls; *.xlsb\", 1\n        'Show the dialog box\n        .Show\n\n        'Store in fullpath variable\n        wipreport = .SelectedItems.Item(1)\n    End With\n\nDim wb As Workbook\nSet wb = Workbooks.Open(wipreport)\n\n\nDim lookFor As Range\nDim srchrange As Range\n\nSet lookFor = Workbooks(\"BPM-Tool.xlsm\").Worksheets(\"BPM-Report\").Cells(10, 2)\n\nSet srchrange = wb.Worksheets(\"1. WIP report\").Range(\"B15:B1000\")\n\n    lookFor.Offset(0, 317).Value = Application.VLookup(lookFor, srchrange, 18, False)\n</code></pre>\n\n<p><code>wipreport</code> is a String not a Workbook object, that's why you are getting an error.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "edited": false, "score": 0, "creation_date": 1562141805, "post_id": 56865686, "comment_id": 100280438, "body": "Thank You but now  I get Runtime Error 1004 \u201cApplication-defined or Object-defined error\u201d.   &quot;This issue may occur if one or more of the cells in an array (range of cells) contain a character string that is set to contain more than 911 characters.&quot; It may be this case. Mine has 2500 rows"}], "tags": [], "owner": {"reputation": 740, "user_id": 4474195, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eca9d93c58a3d513fa6426826978f4d?s=128&d=identicon&r=PG", "display_name": "Paul Kelly", "link": "https://stackoverflow.com/users/4474195/paul-kelly"}, "is_accepted": false, "score": 0, "last_activity_date": 1562141525, "creation_date": 1562141525, "answer_id": 56865686, "question_id": 56865493, "link": "https://stackoverflow.com/questions/56865493/subscript-out-of-range-while-setting-the-range/56865686#56865686", "title": "Subscript out of range while setting the range", "body": "<p><strong>Workbooks.Open</strong> takes the full file name e.g. <em>C:\\temp\\myfile.xlsx</em></p>\n\n<p><strong>Workbooks()</strong> takes file name only e.g. <em>myfile.xlsx</em></p>\n\n<p>You can use this code to get the workbook object and then use it:</p>\n\n<pre><code>' Get the workbook object\nDim wk As Workbook\nSet wk = Workbooks.Open(wipreport)\n\n' Use the workbook object\nwk.Worksheets(\"1. WIP report\").Range (\"B15:B\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10896304, "user_type": "registered", "profile_image": "https://graph.facebook.com/2246498138728066/picture?type=large", "display_name": "Marc", "link": "https://stackoverflow.com/users/10896304/marc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562143239, "creation_date": 1562140657, "last_edit_date": 1562143239, "question_id": 56865493, "link": "https://stackoverflow.com/questions/56865493/subscript-out-of-range-while-setting-the-range", "title": "Subscript out of range while setting the range", "body": "<p>By the line \nSet srchrange = Workbooks(wipreport).Worksheets(\"1. WIP report\").Range(\"B15:B\")</p>\n\n<p>I got the error Subscript out of range. wipreport is chosen above from the file. The workbook for sure has the Sheet \"1. WIP report\". I copied it. Workbooks BPM-Tool is already opened but I have no error by this line of code. \nI can not even try if vlookup works.</p>\n\n<pre><code>With Application.FileDialog(msoFileDialogFilePicker)\n        'Makes sure the user can select only one file\n        .AllowMultiSelect = False\n        .Title = \"Select WIP Report\"\n        .ButtonName = \"OK\"\n        'Filter to just the following types of files to narrow down selection options\n        .Filters.Add \"Excel Files\", \"*.xlsx; *.xlsm; *.xls; *.xlsb\", 1\n        'Show the dialog box\n        .Show\n\n        'Store in fullpath variable\n        wipreport = .SelectedItems.Item(1)\n    End With\n\n\nWorkbooks.Open wipreport\n\n\nDim lookFor As Range\nDim srchrange As Range\n\nSet lookFor = Workbooks(\"BPM-Tool.xlsm\").Worksheets(\"BPM-Report\").Cells(10, 2)\n\nSet srchrange = Workbooks(wipreport).Worksheets(\"1. WIP report\").Range(\"B15:B\")\n\n    lookFor.Offset(0, 317).Value = Application.VLookup(lookFor, srchrange, 18, False)\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-access", "worksheet"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562142491, "post_id": 56865675, "comment_id": 100280788, "body": "Note that this is only hiding the sheet which is <b>not secure at all</b>. Anyone can easily unhide the sheet to view the data. If this sheet conains sensible data that has to be protected from users view this is not sufficient."}, {"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 0, "creation_date": 1562142713, "post_id": 56865675, "comment_id": 100280897, "body": "If you click on the <code>Admin1</code> tab and keep pressing on the mouse button without releasing it, you can still see the contents of the sheet ;)"}], "tags": [], "owner": {"reputation": 11192, "user_id": 5514747, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db1a440aac7d279213c66bcdb1c1984a?s=128&d=identicon&r=PG", "display_name": "Harun24HR", "link": "https://stackoverflow.com/users/5514747/harun24hr"}, "is_accepted": false, "score": 0, "last_activity_date": 1562141484, "creation_date": 1562141484, "answer_id": 56865675, "question_id": 56865464, "link": "https://stackoverflow.com/questions/56865464/access-to-excel-worksheet-with-a-password/56865675#56865675", "title": "Access to Excel worksheet with a password", "body": "<p>Try following codes.</p>\n\n<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\nDim MySheetName As String\nMySheetName = \"Admin1\" 'The sheed name which you want to hide.\n    If Application.ActiveSheet.Name = MySheetName Then\n    Application.EnableEvents = False\n    Application.ActiveSheet.Visible = False\n    response = Application.InputBox(\"Password\", \"Enter Password\", , Type:=2)\n        If response = \"rainy2019\" Then 'Unhide Password.\n            Application.Sheets(MySheetName).Visible = True\n            Application.Sheets(MySheetName).Select\n        End If\n    End If\nApplication.Sheets(MySheetName).Visible = True\nApplication.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>VBA Window:</p>\n\n<p><a href=\"https://i.stack.imgur.com/foUNw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/foUNw.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1562217719, "last_edit_date": 1562217719, "creation_date": 1562142626, "answer_id": 56865976, "question_id": 56865464, "link": "https://stackoverflow.com/questions/56865464/access-to-excel-worksheet-with-a-password/56865976#56865976", "title": "Access to Excel worksheet with a password", "body": "<p>There is no possibility to securely protect one sheet only from viewing. You can only protect a whole workbook from viewing (with password).</p>\n\n<p>Any workaround you try to securely hide/protect a sheet with password can easily be tricked out by any user.</p>\n\n<p>The only way to securely hide data from users is not to hand out this data at all. The only really secure way is to have something like a client server process where the server has the raw data, the client sends a request to that server, and the server only sends the data the user is allowed to see.</p>\n"}, {"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562219017, "post_id": 56878383, "comment_id": 100310504, "body": "Note that the word &quot;Access&quot; (and the tag) is realated to <i>accessing</i> data not to the program <i>&quot;Microsoft Access&quot;</i>. The question is a pure Excel question actually."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1562190922, "creation_date": 1562190922, "answer_id": 56878383, "question_id": 56865464, "link": "https://stackoverflow.com/questions/56865464/access-to-excel-worksheet-with-a-password/56878383#56878383", "title": "Access to Excel worksheet with a password", "body": "<p>How about this ADO solution?!</p>\n\n<p>Add Reference: Microsoft ActiveX Data Objects 2.8 Library</p>\n\n<pre><code>Sub test()\n\n    Dim Conn As New ADODB.Connection\n    Dim rs As New ADODB.Recordset\n    Dim dbPath As String\n    Dim aQuery As String\n    Dim pword As String\n    Dim strcon As String\n\n\n    dbPath = ThisWorkbook.Path &amp; \"\\Database.mdb\"\n    pword = \"abcd\"\n    aQuery = \"SELECT * FROM myTable\"\n\n    strcon = \"Provider=Microsoft.Jet.OLEDB.4.0;\" _\n            &amp; \"Data Source=\" &amp; dbPath &amp; \";\" _\n            &amp; \"Jet OLEDB:Database Password=\" &amp; pword &amp; \";\"\n\n    Conn.Open strcon\n    rs.Open aQuery, Conn\n\n    If Not (rs.EOF And rs.BOF) Then\n        MsgBox rs.Fields(0)\n    End If\n\n    rs.Close\n    Set rs = Nothing\n    Set Conn = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Or, use a DAO solution.</p>\n\n<p>Add Reference: Microsoft DAO 3.6 Object Library </p>\n\n<pre><code>Sub test()\n\n    Dim Conn As New ADODB.Connection\n    Dim rs As New ADODB.Recordset\n    Dim dbPath As String\n    Dim aQuery As String\n    Dim pword As String\n    Dim strcon As String\n\n\n    dbPath = ThisWorkbook.Path &amp; \"\\Database.mdb\"\n    pword = \"abcd\"\n    aQuery = \"SELECT * FROM myTable\"\n\n    strcon = \"Provider=Microsoft.Jet.OLEDB.4.0;\" _\n            &amp; \"Data Source=\" &amp; dbPath &amp; \";\" _\n            &amp; \"Jet OLEDB:Database Password=\" &amp; pword &amp; \";\"\n\n    Conn.Open strcon\n    rs.Open aQuery, Conn\n\n    If Not (rs.EOF And rs.BOF) Then\n        MsgBox rs.Fields(0)\n    End If\n\n    rs.Close\n    Set rs = Nothing\n    Set Conn = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3632179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dded3603266586d480e89a0afb618bad?s=128&d=identicon&r=PG&f=1", "display_name": "user3632179", "link": "https://stackoverflow.com/users/3632179/user3632179"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1562755085, "creation_date": 1562140523, "last_edit_date": 1562755085, "question_id": 56865464, "link": "https://stackoverflow.com/questions/56865464/access-to-excel-worksheet-with-a-password", "title": "Access to Excel worksheet with a password", "body": "<p>I created an Excel file with 3 worksheets like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oXDAD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oXDAD.png\" alt=\"enter image description here\"></a></p>\n\n<p>My goal is: making the worksheets accessible only with a password. That means you can see the content of the worksheet only with a password.\nFor Example: When the \"User\" clicks on \"Admin\", the content of the worksheet is only visible after entering the right password.</p>\n\n<p>Worksheet protect is useless.</p>\n\n<p>Is it possible ?</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1562155246, "post_id": 56865226, "comment_id": 100287851, "body": "Try to <a href=\"https://stackoverflow.com/a/3268188/3820271\">Decompile</a> and recompile your code. Make sure there is <code>Option Explicit</code> at the top of all modules."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1562162234, "post_id": 56865226, "comment_id": 100292292, "body": "AT what line does the error pop?"}, {"owner": {"reputation": 19, "user_id": 11094416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7546bc1bb8e340ffd182cb3c6fb29316?s=128&d=identicon&r=PG&f=1", "display_name": "LMORSE", "link": "https://stackoverflow.com/users/11094416/lmorse"}, "edited": false, "score": 0, "creation_date": 1562182174, "post_id": 56865226, "comment_id": 100302185, "body": "&quot;AT what line does the error pop?&quot; - that&#39;s the tricky part, I can&#39;t step through to find the error because as soon as I open Visual Basic the error does not happen. Interestingly, I just made a copy of the database to decompile and recompile; before doing anything I ran the database copy to check and the error did not happen, but it still happens in the original...???"}], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1595340930, "post_id": 63014460, "comment_id": 111436817, "body": "Better link for *the steps required for a decompile to be worth doing&quot;: <a href=\"https://stackoverflow.com/a/3268188/3820271\">Decompile</a>"}], "tags": [], "owner": {"reputation": 817, "user_id": 10753968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/epgIK.jpg?s=128&g=1", "display_name": "half of a glazier", "link": "https://stackoverflow.com/users/10753968/half-of-a-glazier"}, "is_accepted": false, "score": 0, "last_activity_date": 1595334123, "creation_date": 1595334123, "answer_id": 63014460, "question_id": 56865226, "link": "https://stackoverflow.com/questions/56865226/error-message-after-office-update-object-or-class-does-not-support-the-set-of-e/63014460#63014460", "title": "Error message after Office update &quot;Object or class does not support the set of events&quot;", "body": "<p>Apparently this error is common in databases that use foreign characters. From personal experience it picks events at random to error on, irrespective of the code inside the event.</p>\n<p>Anyway, the solution that saved my database (and sanity) is decompiling, as explained on <a href=\"https://sourcedaddy.com/ms-access/using-the-decompile-option.html\" rel=\"nofollow noreferrer\">sourcedaddy</a>, but I'll list the instructions here to save you having to follow yet <em>another</em> link.</p>\n<ul>\n<li>Press <strong>Win + R</strong> to open the Run window, enter <strong>msaccess /decompile</strong>, and press <strong>Run</strong></li>\n<li>When Access opens, hold down <strong>shift</strong> and open your database</li>\n<li>Once the database is open, exit Access fully</li>\n<li>Restart Access and open your database again</li>\n<li>Open the code editor, click <strong>Debug &gt;&gt; Compile</strong></li>\n<li>After the db compiles, close the code editor and click <strong>Compact and Repair Database</strong> in <strong>Database Tools</strong></li>\n</ul>\n<p>And magic!</p>\n<p>Hope this saves someone else the hours I expended trying to fix this bug...</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 11385533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YUN1L.jpg?s=128&g=1", "display_name": "ChufferMcDonald", "link": "https://stackoverflow.com/users/11385533/chuffermcdonald"}, "is_accepted": false, "score": 0, "last_activity_date": 1603713323, "creation_date": 1603713323, "answer_id": 64536653, "question_id": 56865226, "link": "https://stackoverflow.com/questions/56865226/error-message-after-office-update-object-or-class-does-not-support-the-set-of-e/64536653#64536653", "title": "Error message after Office update &quot;Object or class does not support the set of events&quot;", "body": "<p>I have also encountered this error before and it drove me insane. The issue seemed to be that we had two versions of Access installed on one computer.</p>\n<p>Uninstalling all versions of office on our computers and then reinstalling them resolved this issue.</p>\n"}], "owner": {"reputation": 19, "user_id": 11094416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7546bc1bb8e340ffd182cb3c6fb29316?s=128&d=identicon&r=PG&f=1", "display_name": "LMORSE", "link": "https://stackoverflow.com/users/11094416/lmorse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 942, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1611218531, "creation_date": 1562139611, "last_edit_date": 1611218531, "question_id": 56865226, "link": "https://stackoverflow.com/questions/56865226/error-message-after-office-update-object-or-class-does-not-support-the-set-of-e", "title": "Error message after Office update &quot;Object or class does not support the set of events&quot;", "body": "<p>I believe that an Office update was installed on my work computer this week. Since then I am seeing an error message in a database I built.</p>\n<p>PC = Windows 10 Enterprise OS Build 17763.557<br />\nOffice = 365 ProPlus Version 1808 Build 10730.20348</p>\n<p>I have a button on a form that runs a SQL search for a record and populates the form. This code has worked for over a year.</p>\n<p>When clicking the button the code fails with the error message</p>\n<blockquote>\n<p>&quot;The expression On Click you entered as the event property setting produced the following error: Object or class does not support the set of events.&quot;</p>\n</blockquote>\n<p>If I open Visual Basic alongside the form, the query runs without error.</p>\n<p>I am not sure if the Office update and the error message are related. I do not believe any changes have been made to the code or database structure. No other error messages have been reported from other users.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Command360_Click()\n    If IsNull(Me.SEARCH_TEXT.Value) Or Me.SEARCH_TEXT.Value = &quot;&quot; Then\n        MsgBox &quot;Please type in your search keyword.&quot;, vbOKOnly, &quot;Keyword Needed&quot;\n        Me.SEARCH_TEXT.BackColor = vbYellow\n        Me.SEARCH_TEXT.SetFocus\n    Else\n        strsearch = Me.SEARCH_TEXT.Value\n        Me.SEARCH_TEXT.BackColor = vbWhite\n        SearchTask = &quot;SELECT * FROM [tMASTER_BOREHOLE_LIST] WHERE ( ([HOLEID] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([TYPE] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([ALTERNATE_NAME1] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([ALTERNATE_NAME2] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([ALTERNATE_NAME3] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([Hole_Location] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([ALTERNATE_NAME4] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([Collar_Site_No] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([Site_ID] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([HOLE_NAME] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([Hole_Number] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([Design_Point_Number] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([STAKED_Point_Number] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([As_Drilled_Point_Number] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([COLLAR_LOCATION1] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([COLLAR_LOCATION] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;) OR ([LW_FOR_SEALUP] Like &quot;&quot;*&quot; &amp; strsearch &amp; &quot;*&quot;&quot;))&quot;\n        Me.RecordSource = SearchTask\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1562157795, "post_id": 56864966, "comment_id": 100289434, "body": "I guess, you found a rounding bug. Hint: <code>Application.Width</code> and <code>ActiveWindow.Width</code> are larger than a slide. You should use <code>ActivePresentation.SlideMaster.Width</code> or <code>ActivePresentation.PageSetup.SlideWidth</code> for the first comparison."}, {"owner": {"reputation": 11, "user_id": 11732862, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w_xm_8wrcCg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfjdXPzNjp6-1S4Zi8OTkDVLNxKGw/photo.jpg?sz=128", "display_name": "David_M", "link": "https://stackoverflow.com/users/11732862/david-m"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1562159019, "post_id": 56864966, "comment_id": 100290273, "body": "Is there any work-around for this bug? I tried <code>CDbl(gd.Position)</code> but it still returns a rounded number without decimal places. Setting the position of a guide works precisely though. For example, adding two guides at e.g. 25.1 and 25.3 clearly works with double-level precision as they are placed visibly apart."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1562159232, "post_id": 56864966, "comment_id": 100290436, "body": "The only workaround springing to mind is to move all their positions to a rounded value first, e. g. <code>gd.position = gd.position</code>."}, {"owner": {"reputation": 11, "user_id": 11732862, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w_xm_8wrcCg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfjdXPzNjp6-1S4Zi8OTkDVLNxKGw/photo.jpg?sz=128", "display_name": "David_M", "link": "https://stackoverflow.com/users/11732862/david-m"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1562159484, "post_id": 56864966, "comment_id": 100290591, "body": "Too bad - that pretty much kills the use case for me. Thanks for your help, though! I can&#39;t think of a different way to move all selected shapes to the left-most guide of the corporate design-compliant slidemaster."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1562166115, "post_id": 56864966, "comment_id": 100294652, "body": "Completely different workaround: If just <i>one</i> other shape is already at the correct position (and can be identified by its size, color, tags, alternativetext, whatever), how about using its <code>Left</code> coordinate for positioning all your desired shapes?"}, {"owner": {"reputation": 11, "user_id": 11732862, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w_xm_8wrcCg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfjdXPzNjp6-1S4Zi8OTkDVLNxKGw/photo.jpg?sz=128", "display_name": "David_M", "link": "https://stackoverflow.com/users/11732862/david-m"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1562322095, "post_id": 56864966, "comment_id": 100347381, "body": "That would work indeed. However, the macro should work explicitly in cases, where there&#39;s no such shape present. Guess I&#39;ll just have to live with the fact that this macro is not possible as of now. Thank you anyhow, Asger."}], "owner": {"reputation": 11, "user_id": 11732862, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-w_xm_8wrcCg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfjdXPzNjp6-1S4Zi8OTkDVLNxKGw/photo.jpg?sz=128", "display_name": "David_M", "link": "https://stackoverflow.com/users/11732862/david-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1562156631, "creation_date": 1562138624, "last_edit_date": 1562156631, "question_id": 56864966, "link": "https://stackoverflow.com/questions/56864966/get-the-precise-x-y-position-of-guides-for-precisely-aligning-shapes-to-them-usi", "title": "Get the precise x/y position of guides for precisely aligning shapes to them using VBA", "body": "<p>Is there any way to get the precise - as in including decimal places -  x/y position of a guideline using VBA?</p>\n\n<p>When getting the position of a guides in PPT via VBA, the result is not as precise as required. Decimal places are omitted. This is confusing me, since the variable type is \"Single\" which should incorporate decimal places.</p>\n\n<p>The overarching goal is to \"snap\" shapes of all kinds to guides using VBA. Use case: User selects one or multiple shapes and wants to align them all to the leftmost guide in the presentation by just clicking a button.</p>\n\n<p>My code works fine thus far, the only issue being that the shapes don't get precisely aligned with the guides.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub align_left()\n    Dim shp As Shape\n    Dim gd As Guide\n    With ActiveWindow.Selection\n        On Error Resume Next\n        x_gd = ActiveWindow.Width\n\n        MsgBox x_gd\n\n        For Each gd In ActivePresentation.SlideMaster.Guides\n            If gd.Orientation = ppVerticalGuide And gd.Position &lt; x_gd Then\n                x_gd = gd.Position\n            End If\n        Next\n\n        MsgBox x_gd\n\n        For Each shp In .ShapeRange\n            shp.Left = x_gd\n        Next\n\n    End With\nEnd Sub\n</code></pre>\n\n<p>Expected: Shapes \"snap\" to guides.\nActual: Shapes are moved CLOSE to the guides but depending on guide position, there's still a gap between guides and shapes.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1562139360, "post_id": 56864897, "comment_id": 100279197, "body": "Your approach is ok, but you can&#39;t use union on an entire row or column, because it would create a range that is greater than the max. It can be done if you go cell by cell and get the values."}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1562139569, "post_id": 56864897, "comment_id": 100279301, "body": "You would need to loop through all sheets, and copy the usedrange to your first sheet."}, {"owner": {"reputation": 52, "user_id": 11493815, "user_type": "registered", "profile_image": "https://graph.facebook.com/893731690958613/picture?type=large", "display_name": "Juras Sulcas", "link": "https://stackoverflow.com/users/11493815/juras-sulcas"}, "reply_to_user": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1562139835, "post_id": 56864897, "comment_id": 100279454, "body": "@rohrl77 I used union on the whole rows before, I think the problem here might be that union doesn&#39;t work with multiple sheets."}, {"owner": {"reputation": 52, "user_id": 11493815, "user_type": "registered", "profile_image": "https://graph.facebook.com/893731690958613/picture?type=large", "display_name": "Juras Sulcas", "link": "https://stackoverflow.com/users/11493815/juras-sulcas"}, "reply_to_user": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1562139873, "post_id": 56864897, "comment_id": 100279476, "body": "@Luuklag I think that&#39;s kind of what I did, isn&#39;t it?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1562140216, "post_id": 56864897, "comment_id": 100279623, "body": "See for example this: <a href=\"https://stackoverflow.com/questions/19182360/merge-more-than-3-excel-worksheets-into-one-workbook-with-macro\" title=\"merge more than 3 excel worksheets into one workbook with macro\">stackoverflow.com/questions/19182360/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "is_accepted": false, "score": 0, "last_activity_date": 1562140511, "creation_date": 1562140511, "answer_id": 56865463, "question_id": 56864897, "link": "https://stackoverflow.com/questions/56864897/method-union-of-object-global-failed/56865463#56865463", "title": "Method &#39;Union&#39; of object &#39;_Global failed", "body": "<p>Indeed <code>.Union</code> method doesn't work across worksheets.</p>\n\n<p>Instead, you could try looping through all your worksheets, copying the corresponding range and pasting it to the destination worksheet.</p>\n\n<p>Something like the following would achieve this:</p>\n\n<pre><code>Sub test()\nDim destinationSheet As Worksheet\nDim sht As Worksheet\nDim destinationRng As Range\nDim rng As Range\nSet destinationSheet = ThisWorkbook.Worksheets(\"Name of your worksheet\")\n\nFor Each sht In ThisWorkbook.Worksheets\n\n    If sht.Name &lt;&gt; destinationSheet.Name Then\n\n        With sht\n            Set rng = .Range(.Range(\"A1\"), .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n            rng.Copy\n        End With\n\n        With destinationSheet\n            Set destinationRng = .Range(\"A\" &amp; .Rows.Count).End(xlUp)\n            If destinationRng.Address = .Range(\"A1\").Address Then\n                destinationRng.PasteSpecial xlPasteValues\n            Else\n                destinationRng.Offset(1, 0).PasteSpecial xlPasteValues\n            End If\n        End With\n    End If\nNext sht\n\nEnd Sub\n</code></pre>\n\n<p>The code above pastes the ranges one by one, in the same column. It can be easily modified to paste the ranges in different columns, one next to the other.</p>\n"}], "owner": {"reputation": 52, "user_id": 11493815, "user_type": "registered", "profile_image": "https://graph.facebook.com/893731690958613/picture?type=large", "display_name": "Juras Sulcas", "link": "https://stackoverflow.com/users/11493815/juras-sulcas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 228, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562141101, "creation_date": 1562138303, "last_edit_date": 1562141101, "question_id": 56864897, "link": "https://stackoverflow.com/questions/56864897/method-union-of-object-global-failed", "title": "Method &#39;Union&#39; of object &#39;_Global failed", "body": "<p><strong>Update:</strong> I realized that I can't use union on multiple sheets.\nWhat's the best choice that I have then?</p>\n\n<p>I simply want to combine all sheets in the workbook into the first worksheet.</p>\n\n<p>After I went through the existing questions, I've tried adding Set rng = nothing to clear my range, but it didn't help.</p>\n\n<pre><code>Sub Combine()\n\n     Dim J As Long\n     Dim Combine As Range\n     Dim rng As Range\n\n\n      'I want to start from the second sheet and go through all of them\n      For J = 2 To Sheets.Count    \n\n      With Sheets(J)\n      Set rng = .Range(\"A1\", .Range(\"A\" &amp; .Rows.Count).End(xlUp))\n      End With\n\n      For Each Cell In rng\n                If Combine Is Nothing Then\n                Set Combine = Cell.EntireRow\n            Else\n                Set Combine = Union(Combine, Cell.EntireRow)\n            End If\n\n      Next Cell\n      Set rng = Nothing\n      Next J\n\n    'Paste the whole union into the 1st sheet\n    Combine.Copy Destination:=Sheets(1).Range(\"A1\")\n\nEnd Sub\n</code></pre>\n\n<p>All this code gets me an error <strong>Method 'Union' of object '_Global failed</strong></p>\n\n<p><strong>Update 2</strong></p>\n\n<pre><code>Sub Combine2()\n\n Dim rowcount As Long\n\n\n  For Each Sheet In Sheets\n\n  If Sheet.Index &lt;&gt; 1 Then\n  rowcount = Sheet.UsedRange.Rows.Count\n\n  Sheet.UsedRange.Copy Destination:=Sheets(1).Cells(Lastrow + 1, 1)\n  Lastrow = Lastrow + rowcount\n\n  End If\n  Next Sheet\n\n\nEnd Sub\n</code></pre>\n\n<p>Really simple code, worked perfectly, thanks to @luuklag for leading me on this.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562136926, "post_id": 56864476, "comment_id": 100277919, "body": "Note that <code>Dim i, j As Long</code> only declares <code>j As Long</code> but <code>i As Variant</code> you need to specify a type for  <b>every</b> variable in VBA. <code>Dim i As Long, j As Long</code>. Same for <code>Dim rng1, rng2 As Range</code>. \u2022 Please tell what is in sheet 2 cell B2 (Formula) and what your actual goal is. I ask this because I think you are up the wrong tree with this approach."}, {"owner": {"reputation": 33, "user_id": 11194568, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CjW5qARGgOQ/AAAAAAAAAAI/AAAAAAAA6-M/j7A53l3XRZA/photo.jpg?sz=128", "display_name": "Bardia Alavi", "link": "https://stackoverflow.com/users/11194568/bardia-alavi"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562137191, "post_id": 56864476, "comment_id": 100278063, "body": "@Peh Formula is A1*B1*3"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562137431, "post_id": 56864476, "comment_id": 100278197, "body": "So why don&#39;t you just fill a formula in your Sheet1? That would be the correct way to go."}, {"owner": {"reputation": 33, "user_id": 11194568, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CjW5qARGgOQ/AAAAAAAAAAI/AAAAAAAA6-M/j7A53l3XRZA/photo.jpg?sz=128", "display_name": "Bardia Alavi", "link": "https://stackoverflow.com/users/11194568/bardia-alavi"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562137574, "post_id": 56864476, "comment_id": 100278283, "body": "Thanks for your reply. I am doing this as a basis for another exercise that would have a similar scenario. Its so important for me to get this Macro right."}], "owner": {"reputation": 33, "user_id": 11194568, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CjW5qARGgOQ/AAAAAAAAAAI/AAAAAAAA6-M/j7A53l3XRZA/photo.jpg?sz=128", "display_name": "Bardia Alavi", "link": "https://stackoverflow.com/users/11194568/bardia-alavi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562136871, "creation_date": 1562136762, "last_edit_date": 1562136871, "question_id": 56864476, "link": "https://stackoverflow.com/questions/56864476/loop-through-first-row-and-column-and-paste-values-to-another-sheet-with-vba", "title": "Loop Through First Row and Column and paste values to another Sheet with VBA", "body": "<p>I want to copy each cell in the first Row and paste it cell A1 in sheet number 2. And then paste the number back in sheet1 cell B2. I want to repeat this for all values in first column and first row. I have attached a sample excel file showing what results i should get. </p>\n\n<p>I have written a code which does not work. </p>\n\n<pre><code>Sub check()\n    Dim i, j As Long\n    Dim rng1, rng2 As Range\n\n    For i = 1 To 3\n        For j = 1 To 3        \n            Set rng1 = Sheets(\"Sheet1\").Range(\"A1:K1\")\n            Set rng2 = Sheets(\"Sheet1\").Range(\"A1:A10\")\n\n            For Each Cell In rng1      \n                Cell.Value.Copy\n                Sheets(\"2\").Range(\"A1\").PasteSpecial Paste:=xlPasteValues    \n                Sheets(\"2\").Range(\"A3\").Copy\n                Sheets(\"Sheet1\").Cells(i + 1, j + 1).PasteSpecial Paste:=xlPasteValues\n            Next Cell\n        Next j\n    Next i\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/5UKDJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5UKDJ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1562136730, "creation_date": 1562136730, "answer_id": 56864467, "question_id": 56864231, "link": "https://stackoverflow.com/questions/56864231/looking-for-exact-match-with-2-excel-sheets-and-return-the-data/56864467#56864467", "title": "looking for exact match with 2 excel sheets and return the data", "body": "<p>Where is the issue using <code>VLOOKUP</code>?</p>\n\n<pre><code>=VLOOKUP(A2,SheetB!A:B,2,FALSE)\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8745044, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CPaJcekgvBY/AAAAAAAAAAI/AAAAAAAAAAk/N_JSrYmsnAM/photo.jpg?sz=128", "display_name": "suresh narasimman", "link": "https://stackoverflow.com/users/8745044/suresh-narasimman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 56864467, "answer_count": 1, "score": 0, "last_activity_date": 1562137631, "creation_date": 1562135750, "last_edit_date": 1562136473, "question_id": 56864231, "link": "https://stackoverflow.com/questions/56864231/looking-for-exact-match-with-2-excel-sheets-and-return-the-data", "title": "looking for exact match with 2 excel sheets and return the data", "body": "<p>In excel sheets there are two sub-sheets A and B contains name and id were named to compare with sheetB if it exact match retrieve the data and filled up with sheet.<a href=\"https://i.stack.imgur.com/rSDe3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rSDe3.png\" alt=\"sample picture \"></a></p>\n\n<p>ran up with vlookup and I cant help me out</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562136378, "post_id": 56863935, "comment_id": 100277654, "body": "Please include which error you get and in which line you get it. Therefore <a href=\"https://stackoverflow.com/posts/56863935/edit\">edit</a> your question. Additionally you might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1562136994, "post_id": 56863935, "comment_id": 100277956, "body": "<code>Range(&quot;C2&quot;).End(xlDown).End(xlToRight)</code> -&gt; Range from active sheet of active book. Maybe not the one you think about."}], "answers": [{"tags": [], "owner": {"reputation": 2671, "user_id": 6306782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/MetvO.png?s=128&g=1", "display_name": "z32a7ul", "link": "https://stackoverflow.com/users/6306782/z32a7ul"}, "is_accepted": false, "score": 0, "last_activity_date": 1565394061, "creation_date": 1565394061, "answer_id": 57438223, "question_id": 56863935, "link": "https://stackoverflow.com/questions/56863935/create-a-new-workbook-and-copy-filtered-data-into-it/57438223#57438223", "title": "Create a new workbook and copy filtered data into it", "body": "<p>This may serve as a starting point:</p>\n\n<p>Option Explicit</p>\n\n<pre><code>Public Sub Createnewbook()\n    Dim wb As Workbook: Set wb = Workbooks.Add\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        .Range(\"C2\", .Range(\"C2\").End(xlDown).End(xlToRight)).Copy\n    End With\n    wb.Worksheets(\"Sheet1\").Cells(1, 1).PasteSpecial xlPasteAll\n    wb.Worksheets(\"Sheet1\").Cells(1, 1).PasteSpecial xlPasteColumnWidths\nEnd Sub\n</code></pre>\n\n<p>Replace Sheet1 with the actual name of your worksheet (in ThisWorkbook: look at the original workbook and see what the name of the sheet is, in the new workbook: determine what the default name for the first sheet of a new workbook is).</p>\n"}], "owner": {"reputation": 1, "user_id": 11732501, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pBfmN4tKYJQ/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3regp4ArO5ivk_i5w5TNMqRKM7Yw5w/photo.jpg?sz=128", "display_name": "ClementY", "link": "https://stackoverflow.com/users/11732501/clementy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1565394061, "creation_date": 1562134275, "last_edit_date": 1565393526, "question_id": 56863935, "link": "https://stackoverflow.com/questions/56863935/create-a-new-workbook-and-copy-filtered-data-into-it", "title": "Create a new workbook and copy filtered data into it", "body": "<p>I have an Excel file, Competition database v1.0. From time to time the data will be updated.</p>\n\n<p>I would like to filter each category and create a new workbook and paste the filtered data into it.</p>\n\n<p>I managed to create a new workbook but it didn't copy the data.</p>\n\n<p>I tried this.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Createnewbook()\n\n    Dim wb As Workbook\n    Set wb = Workbooks.Add\n\n    Range(\"C2\", Range(\"C2\").End(xlDown).End(xlToRight)).Copy\n    wdApp.Selection.PasteExcelTable True, False, False\n\nEnd Sub\n</code></pre>\n\n<p>Then I tried this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Createnewbook()\n\n    Dim wb As Workbook\n    Set wb = Workbooks.Add      \n\n    ' I got error from this line\n    Workbooks(\"Competition Database V1.0.xlsm\").Worksheets(\"Competitor Info\").Select\n\n    Worksheets(\"Competitor Info\").Range(\"C2\", Range(\"C2\").End(xlDown).End(xlToRight)).Copy\n    wb.Worksheets(\"Sheet1\").Range(\"A1\").PasteExcelTable True, False, False                 \n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1562156927, "post_id": 56863886, "comment_id": 100288919, "body": "Try to something like <code>LinkedCell = &quot;&#39;Sheet2&#39;!&quot; &amp; c.Address</code>. Also may change  <code>Name = &quot;cbx_&#39; &amp; c.Address(0,0)&quot;  to  </code>Name = &quot;cbx_&quot; &amp; c.Address`"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 11433056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/471276ee275acc604a8a91ae6116e59f?s=128&d=identicon&r=PG&f=1", "display_name": "Brett Shinn", "link": "https://stackoverflow.com/users/11433056/brett-shinn"}, "is_accepted": true, "score": 0, "last_activity_date": 1562157043, "creation_date": 1562157043, "answer_id": 56870226, "question_id": 56863886, "link": "https://stackoverflow.com/questions/56863886/excel-vba-inserting-check-boxes-okay-linking-them-to-cells-in-a-separate-s/56870226#56870226", "title": "(Excel VBA) Inserting Check Boxes (OKAY) &amp; Linking Them To Cells In A Separate Sheet (Not OKAY)", "body": "<p>I've found the answer to my own question, and thought I'd share it.  </p>\n\n<p>I found this separate function online and ran it after I ran the original one, which successfully placed 1200 or so check boxes.  However, the boxes slowed down excel so much that I changed it to an array of 1's and 0's which then linked to the True/False table in the range tab, so that everything else still functioned.</p>\n\n<pre><code>Sub ALinkCheckBoxes()\n   Dim chk As CheckBox\n\n   For Each chk In ActiveSheet.CheckBoxes\n    'There is a random amount experimental of offsetting which visually aligned it within the center of the cell.\n      chk.LinkedCell = \"Range!\" &amp; chk.TopLeftCell.Offset(-9, 6).Address\n   Next chk\n\nEnd Sub\n\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11433056, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/471276ee275acc604a8a91ae6116e59f?s=128&d=identicon&r=PG&f=1", "display_name": "Brett Shinn", "link": "https://stackoverflow.com/users/11433056/brett-shinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56870226, "answer_count": 1, "score": 0, "last_activity_date": 1562157043, "creation_date": 1562134045, "last_edit_date": 1562136047, "question_id": 56863886, "link": "https://stackoverflow.com/questions/56863886/excel-vba-inserting-check-boxes-okay-linking-them-to-cells-in-a-separate-s", "title": "(Excel VBA) Inserting Check Boxes (OKAY) &amp; Linking Them To Cells In A Separate Sheet (Not OKAY)", "body": "<p>I have a short macro to insert check boxes into cells in a sheet called \"Dashboard\" and which works fine, but I need to link them to cells in a different sheet (in the same workbook), which I call \"Range\" and has all sorts of True/False and list populations.</p>\n\n<p>There will be something like 1000 checkboxes when this is all over.  I am aware of how cumbersome they are.  The linked cells should be in the exact same location, but in the \"Range\" sheet.</p>\n\n<p>Currently, it will link to cells in the same sheet using offset, but I'm unsure how to interpret the .LinkedCell property to link instead to another sheet.</p>\n\n<p>I've fumbled a bit with assigning them to the \"range\" sheet, with no success because of the .Name property.</p>\n\n<p>My expected results are to create a mirror image of \"Dashboard\" within \"Range\" that represents the linked cells.</p>\n\n<pre><code>Dim c As Range\nDim myCBX As CheckBox\nDim wks As Worksheet\nDim rngCB As Range\nDim strCAP As String\n\nSet wks = ActiveSheet\nSet rngCB = wks.Range(\"C2:D4\") 'This range will be 130 rows and 10 or more columns when I'm finished.\n\nstrCAP = \"\"\n\nFor Each c In rngCB\n    With c\n        Set myCBX = wks.CheckBoxes.Add(Top:=c.Top - 2, Width:=3, Height:=c.Height, Left:=c.Left + c.Width * 0.425)\n        'Set myCBX = wks.CheckBoxes.Add(Top:=.Top, Width:=.Width, Height:=.Height, Left:=.Left)\n    End With\n\n    With myCBX\n\n        'This is where it links the checkbox to a cell in the same sheet.\n        'I'm unsure how to interpret .Name and LinkedCell to assign them to a sheet called \"Range\"\n        .Name = \"cbx_' &amp; c.Address(0,0)\"\n\n        .LinkedCell = c.Offset(0, 2).Address(external:=True) 'This offset is specific to the amount of intended end-use columns.\n\n        .Caption = strCAP\n\n\n        End With\n    Next c\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1562131486, "post_id": 56863304, "comment_id": 100275843, "body": "Ain&#39;t your 1st 2 cases conflict with the Third one ? If 1st case is true then 3rd is also true, if 2nd is true then 3rd is also true."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1562131536, "post_id": 56863304, "comment_id": 100275852, "body": "Your Example doesn&#39;t even have any <code>AB</code>"}, {"owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1562131571, "post_id": 56863304, "comment_id": 100275862, "body": "yes, currently it is not working as intended. I want it to search for both \u201cA\u201d and \u201cB\u201d concurrently"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1562131623, "post_id": 56863304, "comment_id": 100275870, "body": "Can you share the Screenshot of data and what you would like to see as result ?"}, {"owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1562131850, "post_id": 56863304, "comment_id": 100275919, "body": "I have edited the question with the data set"}, {"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 0, "creation_date": 1562136663, "post_id": 56863304, "comment_id": 100277796, "body": "You could create helper column with concatenated &quot;case 1&quot; and &quot;case 2&quot; columns and search in there"}], "answers": [{"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1562135272, "last_edit_date": 1562135272, "creation_date": 1562134181, "answer_id": 56863911, "question_id": 56863304, "link": "https://stackoverflow.com/questions/56863304/if-statement-finding-more-than-1-strings-in-a-range/56863911#56863911", "title": "IF statement - finding more than 1 strings in a range", "body": "<p>Try this:</p>\n\n<pre><code>Sub Test()\n\nDim A As Long, B As Long\nWith ThisWorkbook.Sheets(\"Master\")\n    A = Application.WorksheetFunction.CountIf(.Range(\"V13:V18\"), \"A\")\n    B = Application.WorksheetFunction.CountIf(.Range(\"V13:V18\"), \"B\")\n    If A = .Range(\"V13:V18\").Cells.Count Then\n        MsgBox \"All A\"\n    ElseIf B = .Range(\"V13:V18\").Cells.Count Then\n        MsgBox \"All B\"\n    ElseIf A + B = .Range(\"V13:V18\").Cells.Count Then\n        MsgBox \"Both A and B\"\n    Else\n        MsgBox \"Other values too\"\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9422609, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "chan hong chon", "link": "https://stackoverflow.com/users/9422609/chan-hong-chon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1562135272, "creation_date": 1562130885, "last_edit_date": 1562131832, "question_id": 56863304, "link": "https://stackoverflow.com/questions/56863304/if-statement-finding-more-than-1-strings-in-a-range", "title": "IF statement - finding more than 1 strings in a range", "body": "<p>I'm trying to write a if statement to do some action for 3 scenarios if the .text is \"A\", \"B\" and Or(\"A\",\"B\"). \nI am facing problem when the range have both \"A\" and \"B\" and I just wanna know what is the best way to find both strings in the range I am looking.</p>\n\n<p><code>ElseIf Master.Range(\"V13:V18\").Text Like \"A\" Or Master.Range(\"V13:V18\").Text Like \"B\" Then</code></p>\n\n<p>*edited the data set for clarity on the 3 scenario</p>\n\n<pre><code>case 1    case 2    case 3\n1 A        1 B       1 A\n2 A        2 B       2 A\n3 A        3 B       3 A\n4 A        4 B       4 B\n5 A        5 B       5 A\n6 A        6 B       6 B\n</code></pre>\n\n<p>This is part of the code which I have written.</p>\n\n<pre><code>If Master.Range(\"V13:V18\").Text Like \"A\" Then\ndo something..\nElseIf Master.Range(\"V13:V18\").Text Like \"B\" Then\ndo something..\nElseIf Master.Range(\"V13:V18\").Text Like \"A\" Or Master.Range(\"V13:V18\").Text Like \"B\" Then\ndo something..\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1562130686, "post_id": 56863183, "comment_id": 100275636, "body": "<code>S</code> represents a Column ?"}], "answers": [{"comments": [{"owner": {"reputation": 7, "user_id": 11646056, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D4kLICpby-I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfGAL9RGMBJi3PfUCdMAb8v8SF-Dg/mo/photo.jpg?sz=128", "display_name": "Jude", "link": "https://stackoverflow.com/users/11646056/jude"}, "edited": false, "score": 0, "creation_date": 1562134749, "post_id": 56863369, "comment_id": 100276955, "body": "it did followed the criteria but it stops at cell value (&quot;s&quot;,87). I&#39;m trying to get all 79 rows that match with the criteria not until it reached a cell count of 79 from 9-87."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 7, "user_id": 11646056, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D4kLICpby-I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfGAL9RGMBJi3PfUCdMAb8v8SF-Dg/mo/photo.jpg?sz=128", "display_name": "Jude", "link": "https://stackoverflow.com/users/11646056/jude"}, "edited": false, "score": 0, "creation_date": 1562134932, "post_id": 56863369, "comment_id": 100277017, "body": "<code>Cells(&quot;S&quot;,87)</code>  is wrong Method, either pass on <code>Range(&quot;S&quot; , 87)</code> or <code>Cells(19,87)</code>"}, {"owner": {"reputation": 7, "user_id": 11646056, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D4kLICpby-I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfGAL9RGMBJi3PfUCdMAb8v8SF-Dg/mo/photo.jpg?sz=128", "display_name": "Jude", "link": "https://stackoverflow.com/users/11646056/jude"}, "edited": false, "score": 0, "creation_date": 1562135532, "post_id": 56863369, "comment_id": 100277281, "body": "i used <code>ActiveSheet.Range(Cells(9, &quot;S&quot;), Cells(332, &quot;S&quot;)).FormulaR1C1 = &quot;=RC[-6]-RC[-11]&quot;</code> and I got the desired result. I will optimize this code again after a finished all other requirement thanks man :) +1"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1562131311, "creation_date": 1562131311, "answer_id": 56863369, "question_id": 56863183, "link": "https://stackoverflow.com/questions/56863183/how-to-assign-cell-value-from-a-filtered-search/56863369#56863369", "title": "How to assign cell value from a filtered search?", "body": "<p><strong>Try This:</strong></p>\n\n<pre><code>Dim i As Integer\n\ni = 0\nk = 8\n\nDim holder As Long\n\nActiveSheet.Range(\"$A$9:$S$332\").AutoFilter Field:=7, Criteria1:=\"AP\"\nActiveSheet.Range(\"$A$9:$S$332\").AutoFilter Field:=15, Criteria1:=\"Released\"\n\nDo While 79 &gt; i\n\n\n    i = i + 1\n    k = k + 1\n\n    If Not Intersect(ActiveSheet.Range(\"S\" &amp; k), ActiveSheet.Range(\"$A$9:$S$332\").SpecialCells(xlCellTypeVisible)) Is Nothing Then\n\n    ActiveSheet.Range(\"S\" &amp; k).FormulaR1C1 = \"=RC[-6]-RC[-11]\"\n\n    End If\n\nLoop\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11646056, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-D4kLICpby-I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfGAL9RGMBJi3PfUCdMAb8v8SF-Dg/mo/photo.jpg?sz=128", "display_name": "Jude", "link": "https://stackoverflow.com/users/11646056/jude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12, "favorite_count": 0, "accepted_answer_id": 56863369, "answer_count": 1, "score": 0, "last_activity_date": 1562131311, "creation_date": 1562130213, "question_id": 56863183, "link": "https://stackoverflow.com/questions/56863183/how-to-assign-cell-value-from-a-filtered-search", "title": "How to assign cell value from a filtered search?", "body": "<p>I'm trying to subtract dates using do while loop within the filtered criteria but I do not know how to get the cell of the filtered rows.</p>\n\n<p>I tried using .SpecialCells(xlCellTypeVisible)</p>\n\n<pre><code>Dim i As Integer\n    i = 0\n    k = 8\n    Dim holder As Long\n    ActiveSheet.Range(\"$G$9:$G$332\").AutoFilter Field:=7, Criteria1:= _\n        \"AP\"\n    ActiveSheet.Range(\"$O$9:$O$332\").AutoFilter Field:=15, Criteria1:= _\n        \"Released\"\n\n    Do While 79 &gt; i\n\n\n        i = i + 1\n        k = k + 1\n        ' ** Cells(k,\"S\") ** Is the problem\n        holder = Cells(k, \"S\").SpecialCells(xlCellTypeVisible).Select\n\n        Application.CutCopyMode = False\n        ActiveCell.FormulaR1C1 = \"=RC[-6]-RC[-11]\"\n\n\n    Loop\n</code></pre>\n\n<p>I expect the output would subtract only within the filtered criteria.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1562122810, "post_id": 56862333, "comment_id": 100273930, "body": "Why SendKeys? You can use <code>Application.Workbooks.Open</code> if I\u2019m not mistaken."}, {"owner": {"reputation": 49, "user_id": 11706005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037b1dd2cbc5989f8f1b25943defdcd3?s=128&d=identicon&r=PG&f=1", "display_name": "kdbl11", "link": "https://stackoverflow.com/users/11706005/kdbl11"}, "reply_to_user": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1562122975, "post_id": 56862333, "comment_id": 100273972, "body": "Im opening the file from the website. I open it from a given web path and there is a prompt asking if I want to open/save/save as. I sendkeys to open. Do you know of another way to get around this?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562123133, "post_id": 56862333, "comment_id": 100273999, "body": "This seems like a nearly exact duplicate of <a href=\"https://stackoverflow.com/questions/56737827/set-downloaded-workbook-as-active-workbook-which-has-no-fixed-name/56738048?noredirect=1#comment100266529_56738048\">this question</a> which I went round and round on the past few days. If you can&#39;t provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, I&#39;m sorry it&#39;s not going to be easy to offer much more assistance than what&#39;s there already."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562123245, "post_id": 56862333, "comment_id": 100274018, "body": "The general idea is to first get a count of how many workbooks are open, and then use a loop until Workbooks.Count = that number + 1 (reflecting the newly opened workbook). From there, I&#39;m not sure if the new book will be Active. if it is, then <code>ActiveWorkbook</code> will suffice (though you should assign to a variable if you need to refer to this more than once. If not, then <code>Workbooks(Workbooks.Count)</code> should do it, with the same caveat that you really ought assign this to a workbook variable."}, {"owner": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 1, "creation_date": 1562123427, "post_id": 56862333, "comment_id": 100274054, "body": "Does Workbooks.Open not support a web address? Maybe you could download the file and then open it directly."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562123594, "post_id": 56862333, "comment_id": 100274083, "body": "<code>Application.Wait</code> is almost surely the wrong approach, though. <code>Wait</code> basically puts the entire Excel Application to sleep. Either a <code>While</code> loop with <code>DoEvents</code> or calling the WinAPI <code>Sleep</code> function would be preferable."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 43407, "user_id": 2791540, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/bbd133916bdbabcde7c31ab28f4b4e6b?s=128&d=identicon&r=PG&f=1", "display_name": "John Wu", "link": "https://stackoverflow.com/users/2791540/john-wu"}, "edited": false, "score": 0, "creation_date": 1562123643, "post_id": 56862333, "comment_id": 100274098, "body": "@JohnWu assuming (like the other question) the <i>user</i> is not actually doing this, but rather automating a browser and clicking some link or button that launches the &quot;Save or Download&quot; dialog, which requires <code>SendKeys</code> to intercept it."}, {"owner": {"reputation": 49, "user_id": 11706005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037b1dd2cbc5989f8f1b25943defdcd3?s=128&d=identicon&r=PG&f=1", "display_name": "kdbl11", "link": "https://stackoverflow.com/users/11706005/kdbl11"}, "edited": false, "score": 0, "creation_date": 1562128347, "post_id": 56862333, "comment_id": 100275029, "body": "Sorry for the confusion. I don&#39;t have the path to the file. I have the path to the webpage that downloads it. The path automatically start the export and I am given a prompt. Thanks for the note about the Application.Wait. I have tried the loop with DoEvents but it&#39;s still not opening until the loop is done."}, {"owner": {"reputation": 49, "user_id": 11706005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037b1dd2cbc5989f8f1b25943defdcd3?s=128&d=identicon&r=PG&f=1", "display_name": "kdbl11", "link": "https://stackoverflow.com/users/11706005/kdbl11"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562128391, "post_id": 56862333, "comment_id": 100275037, "body": "@DavidZemens This is exactly what im doing thank you."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1562158029, "post_id": 56862333, "comment_id": 100289593, "body": "<i>it&#39;s still not opening until the loop is done</i> well of course not. It won&#39;t open until the workbook has finished downloading &amp; is open. that&#39;s the point of looping until w+1. I&#39;m glad you found a solution, but it would be helpful if you show how you&#39;re implementing that in your code. Is it a loop, or just a hard sleep for an arbitrary amount of time?"}], "answers": [{"tags": [], "owner": {"reputation": 49, "user_id": 11706005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037b1dd2cbc5989f8f1b25943defdcd3?s=128&d=identicon&r=PG&f=1", "display_name": "kdbl11", "link": "https://stackoverflow.com/users/11706005/kdbl11"}, "is_accepted": false, "score": 0, "last_activity_date": 1562136090, "last_edit_date": 1562136090, "creation_date": 1562128995, "answer_id": 56863019, "question_id": 56862333, "link": "https://stackoverflow.com/questions/56862333/how-to-check-if-file-is-already-open-before-proceeding-after-opening-with-send-k/56863019#56863019", "title": "How to check if file is already open before proceeding after opening with send keys in excel VBA?", "body": "<p>This is working now using Sleep:</p>\n\n<pre><code>#If VBA7 Then\n    Public Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr) 'For 64 Bit Systems\n#Else\n    Public Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long) 'For 32 Bit Systems\n#End If\n</code></pre>\n\n<p>Then call:</p>\n\n<pre><code>Sleep 20000\n</code></pre>\n\n<p>Thanks @DavidZemens for the suggestion</p>\n"}], "owner": {"reputation": 49, "user_id": 11706005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/037b1dd2cbc5989f8f1b25943defdcd3?s=128&d=identicon&r=PG&f=1", "display_name": "kdbl11", "link": "https://stackoverflow.com/users/11706005/kdbl11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562136090, "creation_date": 1562122585, "last_edit_date": 1562136038, "question_id": 56862333, "link": "https://stackoverflow.com/questions/56862333/how-to-check-if-file-is-already-open-before-proceeding-after-opening-with-send-k", "title": "How to check if file is already open before proceeding after opening with send keys in excel VBA?", "body": "<p>I am opening a file from a website. After I send sendkeys \"%{O}\", I need the file to be opened first before proceeding. If I add wait times or loops after the sendkeys, the file wont open until after those loops. Kindly note that I don't know the name or location of the file, I just opened it from a path given to me.</p>\n\n<p>I have already tried putting Application.Wait, creating a sub that just counts and using this between opening and writing to the worksheet.</p>\n\n<pre><code>Application.SendKeys \"%{O}\" 'opens the workbook from IE\nSet wb2 = ActiveWorkbook.Worksheets(\"Needed_Worksheet\")\nwb2.Cells(1,1) = \"HELLO\"\n</code></pre>\n\n<p>I expect to write on the first cell of the newly opened workbook.</p>\n"}, {"tags": ["excel", "vba", "email", "outlook"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1562115750, "post_id": 56861636, "comment_id": 100272865, "body": "<code>.Attachments.Add</code>. Here&#39;s the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.attachments.add\" rel=\"nofollow noreferrer\">documentation</a>."}, {"owner": {"reputation": 1, "user_id": 11731767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LLttpLhDyNM/AAAAAAAAAAI/AAAAAAAAV2Q/ic6dN4RQhvI/photo.jpg?sz=128", "display_name": "Shaun Santos", "link": "https://stackoverflow.com/users/11731767/shaun-santos"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562116731, "post_id": 56861636, "comment_id": 100273015, "body": "By the way, I inherited the file that I am currently using and made some improvements from the initial file that I got. Will it be possible to get the file from a certain folder in my pc or get the file from the excel file?"}, {"owner": {"reputation": 1, "user_id": 11731767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LLttpLhDyNM/AAAAAAAAAAI/AAAAAAAAV2Q/ic6dN4RQhvI/photo.jpg?sz=128", "display_name": "Shaun Santos", "link": "https://stackoverflow.com/users/11731767/shaun-santos"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562123538, "post_id": 56861636, "comment_id": 100274070, "body": "@BigBen, Thanks. Now just get it to send using different files from a folder in my desktop. Is there a way to send a specific file to one person thru vba and the next email will contain a different recipient with a different attachment?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562123675, "post_id": 56861636, "comment_id": 100274100, "body": "Sure. How are you distinguishing the different attachments? Is there a file path in your file?"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1562125480, "post_id": 56861636, "comment_id": 100274446, "body": "@ShaunSantos Big Ben knows his stuff. Just do what he says."}, {"owner": {"reputation": 1, "user_id": 11731767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LLttpLhDyNM/AAAAAAAAAAI/AAAAAAAAV2Q/ic6dN4RQhvI/photo.jpg?sz=128", "display_name": "Shaun Santos", "link": "https://stackoverflow.com/users/11731767/shaun-santos"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562172985, "post_id": 56861636, "comment_id": 100298175, "body": "@BigBen, I have them in a folder in my desktop. I have renamed each file to the name of the employee so I can distinguish them. The ideal set up is a macro that can send email to multiple employees with a personalized attachment that he/she should receive. Each employee should receive a different file. At the moment, I can only do multiple emails with the same file (Thanks to BigBen). By the way, I just started learning macro in VBA as this was handed over to me a few weeks ago. Still learning the tricks."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562173101, "post_id": 56861636, "comment_id": 100298234, "body": "Ok. So you probably want to use the <code>Dir</code> function and the employee name to identify which file should be attached to the email."}, {"owner": {"reputation": 1, "user_id": 11731767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LLttpLhDyNM/AAAAAAAAAAI/AAAAAAAAV2Q/ic6dN4RQhvI/photo.jpg?sz=128", "display_name": "Shaun Santos", "link": "https://stackoverflow.com/users/11731767/shaun-santos"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562176068, "post_id": 56861636, "comment_id": 100299549, "body": "Thanks @BigBen! I&#39;ll do some tests using the Dir function. I&#39;ll let you if it works. Have a nice day ahead!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11731767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LLttpLhDyNM/AAAAAAAAAAI/AAAAAAAAV2Q/ic6dN4RQhvI/photo.jpg?sz=128", "display_name": "Shaun Santos", "link": "https://stackoverflow.com/users/11731767/shaun-santos"}, "edited": false, "score": 0, "creation_date": 1563307673, "post_id": 57028387, "comment_id": 100654528, "body": "still having problems trying to send multiple emails with a different attachments. Cannot figure out how to do it."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1563115277, "creation_date": 1563115277, "answer_id": 57028387, "question_id": 56861636, "link": "https://stackoverflow.com/questions/56861636/adding-pdf-or-word-attachments-to-outlook-mail-using-excel-vba/57028387#57028387", "title": "Adding pdf or Word attachments to Outlook mail using Excel VBA", "body": "<p>It seems you are interested in the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.attachments.add\" rel=\"nofollow noreferrer\">Add</a> method of the <code>Attachments</code> class which creates a new attachment in the <code>Attachments</code> collection. The source of the attachment can be a file (represented by the full file system path with a file name) or an Outlook item that constitutes the attachment. For example:</p>\n\n<pre><code>Sub AddAttachment() \n Dim myItem As Outlook.MailItem \n Dim myAttachments As Outlook.Attachments  \n Set myItem = Application.CreateItem(olMailItem) \n\n Set myAttachments = myItem.Attachments \n myAttachments.Add \"C:\\Test.doc\", olByValue, 1, \"Test\" \n\n myItem.Display \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11731767, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-LLttpLhDyNM/AAAAAAAAAAI/AAAAAAAAV2Q/ic6dN4RQhvI/photo.jpg?sz=128", "display_name": "Shaun Santos", "link": "https://stackoverflow.com/users/11731767/shaun-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 628, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1563149681, "creation_date": 1562115505, "last_edit_date": 1563149681, "question_id": 56861636, "link": "https://stackoverflow.com/questions/56861636/adding-pdf-or-word-attachments-to-outlook-mail-using-excel-vba", "title": "Adding pdf or Word attachments to Outlook mail using Excel VBA", "body": "<p>I have a working macro to send communications to hundreds of employees.</p>\n\n<p>I personalize the contents using HTML in Excel. The cells contain the messages.</p>\n\n<p>Now, I need to send email with multiple attachments.</p>\n\n<p>Here's the code without the attachments.</p>\n\n<pre><code>Sub SendMail()\n\nDim olApp As Outlook.Application\nDim olMail As Outlook.MailItem\n\nFor i = 2 To Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\n\n    Set olApp = New Outlook.Application\n    Set olMail = olApp.CreateItem(olMailItem)\n\n    With olMail\n        .SentOnBehalfOfName = \"HC-Communications@company.com\"\n        .To = Cells(i, 1).Value\n        .CC = Cells(i, 2).Value\n        .BCC = Cells(i, 3).Value\n        .Subject = Cells(i, 4).Value\n        .BodyFormat = olFormatHTML\n        .HTMLBody = Cells(i, 5).Value\n        .Display\n        .ReadReceiptRequested = True\n        .Send\n    End With\n\n    Set olMail = Nothing    \n    Set olApp = Nothing\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "windows", "runtime-error"], "comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1562124656, "post_id": 56861179, "comment_id": 100274260, "body": "What line is the error happening on? Also, you shouldn&#39;t be using select statements. see... <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1562173506, "post_id": 56861179, "comment_id": 100298438, "body": "I&#39;m sorry, it&#39;s on the first line, where I array the worksheets and tell to copy them. It doesn&#39;t create any workbook and it alwasy says &quot;Permission denied: \\name.temp&quot; where name it&#39;s always some numbers and letters starting with &#39;VB&#39;"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1562173904, "post_id": 56861179, "comment_id": 100298615, "body": "So you&#39;ve lost write permissions to a folder, and now Excel cannot create a temp file for the new workbook. Does it give you full path to that folder? If it does not, grab <a href=\"https://docs.microsoft.com/en-us/sysinternals/downloads/procmon\" rel=\"nofollow noreferrer\">procmon</a> and find out yourself."}, {"owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1562175852, "post_id": 56861179, "comment_id": 100299459, "body": "It doesn&#39;t give me any full paths. I have not used process monitor so far, so I will download it and try this solution. Is it possible for this to happen even though no changes were made from one day to another? @GSerg"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1562180233, "post_id": 56861179, "comment_id": 100301399, "body": "@CarlosCasio It&#39;s about changes to your file system and/or Excel default folders paths, not the macro."}, {"owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1562182864, "post_id": 56861179, "comment_id": 100302446, "body": "@GSerg precisely, I meant there were no changes on aything, not in Windows nor in Excel. Actually it only fails when I use .xlsm files, and it doesn&#39;t matter if I try to copy the sheets with or without a macro, it will show the same error. It seems really weird to me, I will chec the prcomon tho."}], "owner": {"reputation": 69, "user_id": 11500291, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643d60c9b32975e8235a0ffd9bf996c3?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Casio", "link": "https://stackoverflow.com/users/11500291/carlos-casio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562173641, "creation_date": 1562110264, "last_edit_date": 1562173641, "question_id": 56861179, "link": "https://stackoverflow.com/questions/56861179/vba-code-fails-to-copy-some-worksheets-message-permission-denied-appears", "title": "VBA Code fails to copy some worksheets, message &quot;Permission denied&quot; appears", "body": "<p>I have run this macro since I remember and it never failed before, today it failed to copy 4 worksheets into a new file, returning a \"Permission denied\" error\n<a href=\"https://i.stack.imgur.com/oSMXS.png\" rel=\"nofollow noreferrer\"></a></p>\n\n<p>There's no many information about this issue, so what I've tried is pretty much to check that I am running everything on admin user, to run Excel as administrator. However, it only fails with .xlsm files, the others work fine</p>\n\n<p>The code fails on the first line, when the <code>Copy</code> command is used. It is supposed to create a new workbook with those sheets copied. Instead, the \"Permission denied\" error shows, and at the end it shows \": \\name.temp\" where name starts with 'VB' and some numbers after that, the numbers always change whenever I try it again.</p>\n\n<pre><code>Worksheets(Array(\"POS\", \"VAL\", \"COL2(USD)\", \"COL2(PS)\")).Copy \nSheets(\"POS\").Select\nCells.Copy\nCells.PasteSpecial xlPasteValues\nSheets(\"VAL\").Select\nCells.Copy\nCells.PasteSpecial xlPasteValues\nSheets(\"COL2(USD)\").Select\nCells.Copy\nCells.PasteSpecial xlPasteValues\nSheets(\"COL2(USD)\").Select\nCells.Copy\nCells.PasteSpecial xlPasteValues\n</code></pre>\n\n<p>Does anyone know how to fix this?</p>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1562111677, "post_id": 56861132, "comment_id": 100272279, "body": "What&#39;s the url ?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 11731299, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lCa7VB937rg/AAAAAAAAAAI/AAAAAAAACAM/hndibvfQjvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11731299/patrick"}, "edited": false, "score": 0, "creation_date": 1562187816, "post_id": 56861330, "comment_id": 100304338, "body": "<code>ie.Document.querySelector(&quot;[title=queue]&quot;).contentDocument.q&zwnj;&#8203;uerySelector(&quot;#oTabl&zwnj;&#8203;e&quot;)</code> does not produce an error when I set Document Type to 11. I commented out <code>myHTMLFrame2 = result</code> and it runs until <code>.Resize(UBound(myarray), UBound(myarray, 2)).Value = myarray</code> before giving the Run-time error &#39;1004&#39;, though it skips the whole For loop."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 27, "user_id": 11731299, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lCa7VB937rg/AAAAAAAAAAI/AAAAAAAACAM/hndibvfQjvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11731299/patrick"}, "edited": false, "score": 0, "creation_date": 1562187891, "post_id": 56861330, "comment_id": 100304364, "body": "My code has selected your table. Did you see the other part of my answer? The link?"}, {"owner": {"reputation": 27, "user_id": 11731299, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lCa7VB937rg/AAAAAAAAAAI/AAAAAAAACAM/hndibvfQjvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11731299/patrick"}, "edited": false, "score": 0, "creation_date": 1562188145, "post_id": 56861330, "comment_id": 100304447, "body": "I did, and as it\u2019s bedtime now I\u2019ll try that tomorrow. Thank you so much for helping me out and being so prompt :)"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 27, "user_id": 11731299, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lCa7VB937rg/AAAAAAAAAAI/AAAAAAAACAM/hndibvfQjvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11731299/patrick"}, "edited": false, "score": 0, "creation_date": 1562188190, "post_id": 56861330, "comment_id": 100304457, "body": "No worries. Let me know if further questions. But yes, bedtime for today."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1562111881, "creation_date": 1562111881, "answer_id": 56861330, "question_id": 56861132, "link": "https://stackoverflow.com/questions/56861132/excel-vba-web-scraping-table-elements-from-a-frameset-and-a-frame/56861330#56861330", "title": "Excel VBA Web Scraping Table Elements from a &lt;frameset&gt; and a &lt;frame&gt;", "body": "<p>You could try isolating the frame by its title attribute, then go via contentDocument and get the table by id</p>\n\n<pre><code>ie.document.querySelector(\"[title=queue]\").contentDocument.querySelector(\"#oTable\")\n</code></pre>\n\n<p>Then end <code>.querySelector(\"#oTable\")</code> can be interchanged with <code>.getElementById(\"oTable\")</code></p>\n\n<p>I would then dump the <code>.outerHTML</code> of the table <a href=\"https://stackoverflow.com/a/56674826/6241235\">via clipboard</a> so as to paste table direct into sheet.</p>\n"}], "owner": {"reputation": 27, "user_id": 11731299, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lCa7VB937rg/AAAAAAAAAAI/AAAAAAAACAM/hndibvfQjvY/photo.jpg?sz=128", "display_name": "Patrick", "link": "https://stackoverflow.com/users/11731299/patrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 409, "favorite_count": 1, "accepted_answer_id": 56861330, "answer_count": 1, "score": 0, "last_activity_date": 1562181491, "creation_date": 1562109830, "last_edit_date": 1562181491, "question_id": 56861132, "link": "https://stackoverflow.com/questions/56861132/excel-vba-web-scraping-table-elements-from-a-frameset-and-a-frame", "title": "Excel VBA Web Scraping Table Elements from a &lt;frameset&gt; and a &lt;frame&gt;", "body": "<p>I am trying to scrape some table-looking items from a website into Excel.</p>\n\n<p>I'm no stranger to coding in general, though I'm pretty new to VBA in an Excel sense :)</p>\n\n<p>I have tried using Excel's Data>From Web interface, it's not recognizing the table. I'm guessing it's because it's built using  (or at least that's what my Google-Fu has lead me to understand).</p>\n\n<p><a href=\"https://i.stack.imgur.com/9mtV8.png\" rel=\"nofollow noreferrer\">Snipping of what the second table looks like</a></p>\n\n<pre><code>&lt;html&gt;\n\n&lt;frame title=\"links\" ...&gt;...&lt;/frame&gt;\n\n&lt;frame title=\"queue\"&gt;\n#document\n\n&lt;head&gt;...&lt;/head&gt;\n&lt;body&gt;\n&lt;div id=\"container&gt;\n&lt;script&gt;...&lt;/script&gt;\n&lt;div&gt;\n\n&lt;table id=\"oTable\"&gt;\n\n&lt;colgroup&gt;...&lt;/colgroup&gt;\n\n&lt;thead&gt;...&lt;/thead&gt;\n\n\n&lt;tbody&gt;\n  &lt;tr onclick=\"changeHighlight( 'eid0' )\" id=\"eid0\" class=\"queryshaded\"&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a onclick=\"javascript:window.open('IWViewer.jsp?id=3.5599976.5599976');\" title=\"Open Image\" href=\"javascript:doNothing();\"&gt;&lt;img title=\"Open Image\" border=\"0\" alt=\"Open Image\" src=\"URL.gif\"&gt;&lt;/a&gt;&amp;nbsp;&lt;a onclick=\"javascript:window.open('URL','_newtab');\" title=\"Open Workitem\" href=\"javascript:doNothing();\"&gt;&lt;img title=\"Open Workitem\" border=\"0\" alt=\"Open Workitem\" src=\"URL.gif\"&gt;&lt;/a&gt;\n    &lt;/td&gt;&lt;td scope=\"row\" nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;12345&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"`\" target=\"_Blank\"&gt;28/08/2018 17:00:49&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;11/09/2018 16:28:39&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;5,599,976&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;dijm&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\n  &lt;tr onclick=\"changeHighlight( 'eid1' )\" id=\"eid1\" class=\"queryunshaded\"&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a onclick=\"javascript:window.open('IWViewer.jsp?id=3.6443276.6443276');\" title=\"Open Image\" href=\"javascript:doNothing();\"&gt;&lt;img title=\"Open Image\" border=\"0\" alt=\"Open Image\" src=\"URL.gif\"&gt;&lt;/a&gt;&amp;nbsp;&lt;a onclick=\"javascript:window.open('URL;id=3.6443276.6443276','_newtab');\" title=\"Open Workitem\" href=\"javascript:doNothing();\"&gt;&lt;img title=\"Open Workitem\" border=\"0\" alt=\"Open Workitem\" src=\"URL.gif\"&gt;&lt;/a&gt;\n    &lt;/td&gt;&lt;td scope=\"row\" nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;67890&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;25/06/2019 11:01:01&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;09/07/2019 10:32:32&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;6,443,276&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\n  &lt;tr onclick=\"changeHighlight( 'eid2' )\" id=\"eid2\" class=\"queryshaded\"&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a onclick=\"javascript:window.open('IWViewer.jsp?id=3.6443287.6443287');\" title=\"Open Image\" href=\"javascript:doNothing();\"&gt;&lt;img title=\"Open Image\" border=\"0\" alt=\"Open Image\" src=\"URL.gif\"&gt;&lt;/a&gt;&amp;nbsp;&lt;a onclick=\"javascript:window.open('URL;id=3.6443287.6443287','_newtab');\" title=\"Open Workitem\" href=\"javascript:doNothing();\"&gt;&lt;img title=\"Open Workitem\" border=\"0\" alt=\"Open Workitem\" src=\"URL.gif\"&gt;&lt;/a&gt;\n    &lt;/td&gt;&lt;td scope=\"row\" nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;23456&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;25/06/2019 11:01:24&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;09/07/2019 10:35:30&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;6,443,287&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\n  &lt;tr onclick=\"changeHighlight( 'eid3' )\" id=\"eid3\" class=\"queryunshaded\"&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a onclick=\"javascript:window.open('IWViewer.jsp?id=3.6443339.6443339');\" title=\"Open Image\" href=\"javascript:doNothing();\"&gt;&lt;img title=\"Open Image\" border=\"0\" alt=\"Open Image\" src=\"URL.gif\"&gt;&lt;/a&gt;&amp;nbsp;&lt;a onclick=\"javascript:window.open('URL;id=3.6443339.6443339','_newtab');\" title=\"Open Workitem\" href=\"javascript:doNothing();\"&gt;&lt;img title=\"Open Workitem\" border=\"0\" alt=\"Open Workitem\" src=\"URL.gif\"&gt;&lt;/a&gt;\n    &lt;/td&gt;&lt;td scope=\"row\" nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;78901&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;25/06/2019 11:06:02&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;09/07/2019 10:40:39&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;6,443,339&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\n  &lt;tr onclick=\"changeHighlight( 'eid4' )\" id=\"eid4\" class=\"queryshaded\"&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a onclick=\"javascript:window.open('IWViewer.jsp?id=3.6443344.6443344');\" title=\"Open Image\" href=\"javascript:doNothing();\"&gt;&lt;img title=\"Open Image\" border=\"0\" alt=\"Open Image\" src=\"URL.gif\"&gt;&lt;/a&gt;&amp;nbsp;&lt;a onclick=\"javascript:window.open('URL;id=3.6443344.6443344','_newtab');\" title=\"Open Workitem\" href=\"javascript:doNothing();\"&gt;&lt;img title=\"Open Workitem\" border=\"0\" alt=\"Open Workitem\" src=\"URL.gif\"&gt;&lt;/a&gt;\n    &lt;/td&gt;&lt;td scope=\"row\" nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;34567&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;25/06/2019 11:06:17&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;09/07/2019 10:40:43&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;6,443,344&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;\n</code></pre>\n\n<p>I have tried various solutions that look somewhat like this:\n<a href=\"https://www.ozgrid.com/forum/forum/other-software-applications/excel-and-web-browsers-help/131683-extracting-data-from-a-grid-on-webpage\" rel=\"nofollow noreferrer\">https://www.ozgrid.com/forum/forum/other-software-applications/excel-and-web-browsers-help/131683-extracting-data-from-a-grid-on-webpage</a>\nand\n<a href=\"https://stackoverflow.com/questions/27066963/scraping-data-from-website-using-vba\">Scraping data from website using vba</a></p>\n\n<p>and trying to define the frames themselves to try and get the info from there?\n(again: new to Excel VBA)</p>\n\n<pre><code>    'set myHTMLDoc to the main pages IE document\n    Dim myHTMLDoc As HTMLDocument\n    Set myHTMLDoc = ie.Document\n\n    'set myHTMLFrame2 as the 2nd frame of the main page (index starts at 0)\n    Dim myHTMLFrame2 As HTMLDocument\n    Set myHTMLFrame2 = myHTMLDoc.Frames(1).Document\n</code></pre>\n\n<p>With the above block of code I'm getting a \"Run-time error '438'\nWithout the above block I'm getting a \"Run-time error '1004'</p>\n\n<p>The info I eventually want is in each row:</p>\n\n<pre><code>    &lt;/td&gt;&lt;td scope=\"row\" nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;67890&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;25/06/2019 11:01:01&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;09/07/2019 10:32:32&lt;/a&gt;&lt;/td&gt;\n    &lt;td nowrap=\"\"&gt;&lt;a href=\"URL\" target=\"_Blank\"&gt;6,443,276&lt;/a&gt;&lt;/td&gt;\n</code></pre>\n\n<p>Ideally I'd like to dump each element into a cell</p>\n\n<p>67890 | 25/06/2019 11:01:01 | 09/07/2019 10:32:32 | 6,443,276</p>\n\n<p>There's 20 of these rows on each page (there's a button to press to get to the next page which I'll figure out later...hopefully haha)</p>\n\n<p>Massive premptive Thank You to anyone who can help :)</p>\n\n<p>-EDIT-\nThis is the code that I'm currently working with (not precious about it :P )</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n\n    Dim ie     As Object\n    Dim html   As Object\n    Dim objElementTR As Object\n    Dim objTR  As Object\n    Dim objElementsTD As Object\n    Dim objTD  As Object\n    Dim result As String\n    Dim intRow As Long\n    Dim intCol As Long\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n    ie.Navigate \"URL\"\n    ie.Visible = True     ' loop until page is loaded\n    Do Until (ie.ReadyState = 4 And Not ie.Busy)\n        DoEvents\n    Loop\n\n    'set myHTMLDoc to the main pages IE document\n    Dim myHTMLDoc As HTMLDocument\n    Set myHTMLDoc = ie.Document\n\n    'set myHTMLFrame2 as the 2nd frame of the main page (index starts at 0)\n    Dim myHTMLFrame2 As HTMLDocument\n    Set myHTMLFrame2 = ie.Document.querySelector(\"[title=queue]\").contentDocument.getElementById(\"oTable\")\n\n    result = myHTMLFrame2\n    Set html = CreateObject(\"htmlfile\")\n    myHTMLFrame2 = result\n    Set objElementTR = html.getElementsByTagName(\"tr\")\n    ReDim myarray(0 To objElementTR.Length, 0 To 10)\n    For Each objTR In objElementTR\n        intRow = intRow + 1\n        Set objElementsTD = objTR.getElementsByTagName(\"td\")\n        For Each objTD In objElementsTD\n            myarray(intRow, intCol) = objTD.innerText\n            intCol = intCol + 1\n        Next objTD\n        intCol = 0\n    Next objTR\n    With Sheets(1).Cells(1, 1).Cells(Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n        .Resize(UBound(myarray), UBound(myarray, 2)).Value = myarray\n    End With\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562110567, "post_id": 56861071, "comment_id": 100272087, "body": "What issues are you encountering with your present code?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11731589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f94d5f982a0ce785aaadaa8bed8837c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Mac Mill", "link": "https://stackoverflow.com/users/11731589/jay-mac-mill"}, "edited": false, "score": 0, "creation_date": 1562130841, "post_id": 56861417, "comment_id": 100275688, "body": "Thank you so much! I&#39;m doing this same function for 2 sheets though, so I&#39;ve copied the code twice in different areas of the code, and changed the sheet names or the raw data and the Copy Destination for each. The Second code works fine, however the first code fails to collect all columns, stopping after the first and not continueing along."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "reply_to_user": {"reputation": 3, "user_id": 11731589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f94d5f982a0ce785aaadaa8bed8837c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Mac Mill", "link": "https://stackoverflow.com/users/11731589/jay-mac-mill"}, "edited": false, "score": 0, "creation_date": 1562141977, "post_id": 56861417, "comment_id": 100280528, "body": "probably the arrangement of columns in the other sheet is different. Is it on the first row? Are the values like &quot;Sum_Pop*&quot;? You can edit all that too. If the answer works for you on one sheet, then it works. You should mark it as answer and adapt for the other sheet."}, {"owner": {"reputation": 3, "user_id": 11731589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f94d5f982a0ce785aaadaa8bed8837c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Mac Mill", "link": "https://stackoverflow.com/users/11731589/jay-mac-mill"}, "edited": false, "score": 0, "creation_date": 1562196571, "post_id": 56861417, "comment_id": 100306567, "body": "Thank you for the help, apologies for my lack of knowledge surrounding this! I got it working with your advice! :)"}], "tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 0, "last_activity_date": 1562112763, "creation_date": 1562112763, "answer_id": 56861417, "question_id": 56861071, "link": "https://stackoverflow.com/questions/56861071/insert-all-cells-in-a-row-that-begin-with-into-a-different-row-but-compacted/56861417#56861417", "title": "Insert all cells in a row that begin with, into a different row but compacted", "body": "<pre class=\"lang-vb prettyprint-override\"><code>Sub Macro1()\nDim ws as Worksheet, LastCol as Long, i as Long, MySel as Range\n\nSet ws = ThisWorkbook.Sheets(\"raw\")\n\nWith ws\n    LastCol= .Cells(1, .Columns.Count).End(xlToLeft).Column\n    For i = 1 to LastCol\n        If .Cells(1, i) Like \"Sum_Pop*\" Then\n            If MySel Is Nothing Then\n                Set MySel = .Cells(1, i)\n            Else\n                Set MySel = Union(MySel, .Cells(1, i))\n            End If\n        End If\n    Next i\nEnd With\n\nIf Not MySel Is Nothing Then MySel.Copy _\n        Destination:=ThisWorkbook.Sheets.Add.Range(\"E4\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 11731589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f94d5f982a0ce785aaadaa8bed8837c?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Mac Mill", "link": "https://stackoverflow.com/users/11731589/jay-mac-mill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 56861417, "answer_count": 1, "score": 0, "last_activity_date": 1562135920, "creation_date": 1562109290, "last_edit_date": 1562135920, "question_id": 56861071, "link": "https://stackoverflow.com/questions/56861071/insert-all-cells-in-a-row-that-begin-with-into-a-different-row-but-compacted", "title": "Insert all cells in a row that begin with, into a different row but compacted", "body": "<p>I have raw data which has a large number of columns. I want to extract cells in the first row which begin with <code>Sum_Pop</code>, for example <code>Sum_Pop2_3,N,</code>. I then want to input these strings into a summary sheet in row 4, starting at column 5. Can anybody help me with some VBA code for this problem?</p>\n\n<p>The raw data has roughly 160 columns, and I only want to extract about 10-20 cells. I then want them to input onto the analysis sheet in order, so there are not any gaps between the cells, so it will create headers for yearly increase of population for each row.</p>\n\n<p>I've attempted to use this code:</p>\n\n<pre><code>Private Sub ()\n    Dim qq As Integer\n    Dim I As Integer\n\n    For qq = 5 To 25\n        For I = 1 To 200\n            If Sheets(\"raw\").Range(\"A\" &amp; I) Like \"Sum_Pop*\" Then\n                Sheets(\"raw\").Range(\"A\" &amp; I) = Sheets(\"analysis\").Range(\"R4C\" &amp; qq).Value\n            Else:\n                Next I\n            End If\n        Next qq\n    Next I\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 1, "creation_date": 1562110198, "post_id": 56860994, "comment_id": 100272011, "body": "on which line are you having the error? Where does it show the variable being empty?"}, {"owner": {"reputation": 11, "user_id": 11529670, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156195449196027/picture?type=large", "display_name": "Bakagami", "link": "https://stackoverflow.com/users/11529670/bakagami"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562167140, "post_id": 56860994, "comment_id": 100295233, "body": "the line &quot;InvCheck = .cells(l,2).value&quot; is not passing a value to the variable InvCheck. As a result, the check &quot; If Invoices(j) = InvCheck And InvCheck &lt;&gt; &quot;&quot; Then&quot; always returns a false value."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11529670, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156195449196027/picture?type=large", "display_name": "Bakagami", "link": "https://stackoverflow.com/users/11529670/bakagami"}, "edited": false, "score": 1, "creation_date": 1562167202, "post_id": 56861520, "comment_id": 100295263, "body": "Thank you. I feel dumb for not catching that simple mistake. That fixed an issue for which ranges the cells were looking at, but not the issue of no value being passed to the variable."}], "tags": [], "owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "is_accepted": false, "score": 0, "last_activity_date": 1562114184, "creation_date": 1562114184, "answer_id": 56861520, "question_id": 56860994, "link": "https://stackoverflow.com/questions/56860994/cell-value-will-not-compare-to-a-variant-array-value/56861520#56861520", "title": "Cell value will not compare to a Variant array value", "body": "<p>There seems to be a dot missing:</p>\n\n<pre><code>With wb.Sheets(k)\n    LInv = Cells(Rows.Count, 2).End(xlUp).Row + 1\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>With wb.Sheets(k)\n    LInv = .Cells(Rows.Count, 2).End(xlUp).Row + 1\n</code></pre>\n\n<p>to ensure that <code>LInv</code> is read from sheet number k.</p>\n\n<p>As it is, the code is equivalent to:</p>\n\n<pre><code>With wb.Sheets(k)\n    LInv = ActiveSheet.Cells(Rows.Count, 2).End(xlUp).Row + 1\n</code></pre>\n\n<p>and, if the active sheet doesn't have any values in the cells you are looking at, the comparison will fail.</p>\n\n<p>There's a similar issue with this line later on in the code:</p>\n\n<pre><code>NewBlank = Cells(Rows.Count, 1).End(xlUp).Row + 1\n</code></pre>\n\n<p>should be:</p>\n\n<pre><code>NewBlank = .Cells(Rows.Count, 1).End(xlUp).Row + 1\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11529670, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156195449196027/picture?type=large", "display_name": "Bakagami", "link": "https://stackoverflow.com/users/11529670/bakagami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562172856, "creation_date": 1562108479, "last_edit_date": 1562172856, "question_id": 56860994, "link": "https://stackoverflow.com/questions/56860994/cell-value-will-not-compare-to-a-variant-array-value", "title": "Cell value will not compare to a Variant array value", "body": "<p>I am having an issue getting array values to compare to values stored in cells on the spreadsheet. </p>\n\n<p>I have tried having the cell value compare directly to the array value, but the check fails every time.</p>\n\n<p>To attempt to correct this issue I have tried assigning the cell value on each iteration to a variable dimmed as varient (Just as the array is dimmed a varient)</p>\n\n<p>Values are added to the array successfully and the varient type is used as some invoices are numbers only while others include letters.</p>\n\n<p>When I walk through my code the variable is not being assigned/accepting a value. Every time the comparison statement is reached the variable shows that it is empty.</p>\n\n<pre><code>Dim Paidlrow As Long\nDim lrow As Long\n\nDim wb As Workbook\nDim Consolid As Worksheet\nDim PaidInv As Worksheet\nDim Summary As Worksheet\n\nDim Invoices() As Variant\nDim InvCheck As Variant\nDim txt As String\nDim Formula As String\n\nDim i As Long\nDim j As Long\nDim k As Long\nDim l As Long\nDim Cleared As Long\nDim LInv As Long\nDim NewBlank As Long\n\nDim MaxSheets As Integer\n\nSet wb = Workbooks(\"Wire Payments projections for Euro's\")\nSet Consolid = wb.Sheets(\"Consolidation\")\nSet Summary = wb.Sheets(\"Pay Summary\")\nSet PaidInv = wb.Sheets(\"Paid Invoices\")\n\n'define define and define\n\nMaxSheets = wb.Sheets.Count\nlrow = Consolid.Cells(Rows.Count, 1).End(xlUp).Row + 1\n\nCleared = 1\n\nReDim Preserve Invoices(1 To Cleared)\n\ni = 2\nWith wb\n\n    'begin inv extraction loop\n    For i = 2 To lrow\n        ReDim Preserve Invoices(1 To Cleared)\n\n        'if inv is marked for payment, add to array and move details to paid inv tab\n        With PaidInv\n            Paidlrow = .Cells(Rows.Count, 1).End(xlUp).Row + 1\n        End With\n\n        With Consolid\n            If .Cells(i, 10) = \"X\" Or .Cells(i, 10) = \"x\" Then\n                Invoices(Cleared) = .Cells(i, 1)\n                Consolid.Rows(i).Copy Destination:=PaidInv.Cells(Paidlrow, 1)\n                Consolid.Rows(i).Clear\n                Cleared = Cleared + 1\n            End If\n        End With\n\n    Next i\nEnd With\n    'loop through each sheet to remove paid invoices identifie in previous loop\n    For k = 1 To MaxSheets\n        If wb.Sheets(k).Name &lt;&gt; Summary.Name And wb.Sheets(k).Name &lt;&gt; PaidInv.Name And wb.Sheets(k).Name &lt;&gt; Consolid.Name Then\n            With wb.Sheets(k)\n                LInv = Cells(Rows.Count, 2).End(xlUp).Row + 1\n                For j = LBound(Invoices) To UBound(Invoices)\n                    For l = 7 To LInv\n                        InvCheck = .Cells(l, 2).Value\n\n                        If Invoices(j) = InvCheck And InvCheck &lt;&gt; \"\" Then\n\n                            '.Rows(l).Delete\n\n                            NewBlank = Cells(Rows.Count, 1).End(xlUp).Row + 1\n                            .Range(\"A7:K7\").Copy\n                            .Range(.Cells(NewBlank, 1), .Cells(NewBlank, 11)).PasteSpecial Paste:=xlPasteFormats\n\n                            '.Cells(NewBlank, 1) = Right(.Cells(1, 9), 6)\n\n                            'Formula = \"=$B$3*I\"\n                            'Formula = Formula &amp; NewBlank\n                            '.Cells(NewBlank, 10).Formula = Formula\n\n\n\n                        End If\n                    Next l\n                Next j\n            End With\n        End If\n    Next k\n</code></pre>\n\n<p>I have commented out code for the ease of testing. With the way it is now it should format some additional cells to match the formatting above it.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>For kicks and giggles, I changed the Array and associated variable check to String type rather than variant. For some reason, this fixed the issue I was having. I am so confused...</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1562106378, "post_id": 56860702, "comment_id": 100271254, "body": "You do not need to Dim the same variable twice.  once it is declared it will be that type.  You can replace the value or re set the object at anytime.  remove the extra Dim line."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1562106471, "post_id": 56860702, "comment_id": 100271274, "body": "Now that being said see this question/answers about not using <code>.Select</code> and <code>.Activate</code>: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>  And remove all the <code>ActiveWindow.ScrollRow</code> lines, they are not needed and are only remnants of the macro recorder."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1562106625, "post_id": 56860702, "comment_id": 100271303, "body": "Welcome to SO! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>!"}], "answers": [{"tags": [], "owner": {"reputation": 1259, "user_id": 3179957, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/E4LGF.jpg?s=128&g=1", "display_name": "Programnik", "link": "https://stackoverflow.com/users/3179957/programnik"}, "is_accepted": false, "score": 0, "last_activity_date": 1562135423, "creation_date": 1562135423, "answer_id": 56864165, "question_id": 56860702, "link": "https://stackoverflow.com/questions/56860702/how-do-i-avoid-duplicate-dims-in-one-sub/56864165#56864165", "title": "How do I avoid duplicate dims in one sub?", "body": "<p>Just remove the second </p>\n\n<p>dim ws as Worksheet </p>\n\n<p>statement.  For a loop control variable in vba, you only need to dim it once within a sub or function.</p>\n"}], "owner": {"reputation": 1, "user_id": 11731488, "user_type": "registered", "profile_image": "https://graph.facebook.com/2605502172793221/picture?type=large", "display_name": "Amy White", "link": "https://stackoverflow.com/users/11731488/amy-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562135423, "creation_date": 1562106027, "last_edit_date": 1562134909, "question_id": 56860702, "link": "https://stackoverflow.com/questions/56860702/how-do-i-avoid-duplicate-dims-in-one-sub", "title": "How do I avoid duplicate dims in one sub?", "body": "<p>So I basically have this report A. I want to copy all of report B and paste it at the end of report A but it gave me this duplicate dim error and I dont know how to differentiate it. I realize the duplicates but I want the vba program to read my report A excel file ( If ws.Name Like \"A*\" Then ws.Activate) and activate it but ignore the numbers after A because the file name keeps changing. If theres another way to do that. That would be amazing help I've been trying to figure out all day.</p>\n\n<pre><code>Sub CopyBdata_into_Adata()\nDim ws As Worksheet\nFor Each ws In Worksheets\nIf ws.Name Like \"B*\" Then\nws.Activate   \nExit Sub    \nEnd If\n\nNext ws\nRows(\"1:1\").Select    \nSelection.Delete Shift:=xlUp    \nRange(\"A2:BG3\").Select    \nRange(Selection, Selection.End(xlDown)).Select    \nSelection.Copy \n\nDim ws As Worksheet    \nFor Each ws In Worksheets    \nIf ws.Name Like \"A*\" Then    \nws.Activate    \nExit Sub    \nEnd If    \nNext ws\n\nActiveWindow.ScrollRow = 20    \nActiveWindow.ScrollRow = 120    \nActiveWindow.ScrollRow = 259    \nActiveWindow.ScrollRow = 318    \nActiveWindow.ScrollRow = 1251    \nActiveWindow.ScrollRow = 1867    \nActiveWindow.ScrollRow = 2462    \nActiveWindow.ScrollRow = 4348    \nActiveWindow.ScrollRow = 5162    \nActiveWindow.ScrollRow = 6571    \nActiveWindow.ScrollRow = 6948    \nActiveWindow.ScrollRow = 7604    \nActiveWindow.ScrollRow = 7921    \nActiveWindow.ScrollRow = 8080    \nActiveWindow.ScrollRow = 8437    \nActiveWindow.ScrollRow = 8576    \nActiveWindow.ScrollRow = 9092    \nActiveWindow.ScrollRow = 9211    \nActiveWindow.ScrollRow = 9648    \nActiveWindow.ScrollRow = 9886    \nActiveWindow.ScrollRow = 10244    \nActiveWindow.ScrollRow = 10561    \nActiveWindow.ScrollRow = 11177    \nActiveWindow.ScrollRow = 11514    \nActiveWindow.ScrollRow = 12090    \nActiveWindow.ScrollRow = 12308    \nActiveWindow.ScrollRow = 12487    \nActiveWindow.ScrollRow = 13122    \nActiveWindow.ScrollRow = 13241    \nActiveWindow.ScrollRow = 13579    \nActiveWindow.ScrollRow = 13599    \nActiveWindow.ScrollRow = 13757    \nActiveWindow.ScrollRow = 13797    \nActiveWindow.ScrollRow = 13817    \nActiveWindow.ScrollRow = 13936    \nActiveWindow.ScrollRow = 13996    \nActiveWindow.ScrollRow = 14015    \nActiveWindow.ScrollRow = 14174    \nActiveWindow.ScrollRow = 14194    \nActiveWindow.ScrollRow = 14274    \nActiveWindow.ScrollRow = 14393    \nActiveWindow.ScrollRow = 14512    \nActiveWindow.ScrollRow = 14532    \nActiveWindow.ScrollRow = 14690    \nActiveWindow.ScrollRow = 14710    \nActiveWindow.ScrollRow = 14750    \nActiveWindow.ScrollRow = 14810    \nActiveWindow.ScrollRow = 14829    \nActiveWindow.ScrollRow = 14849    \nActiveWindow.ScrollRow = 14869    \nActiveWindow.ScrollRow = 14909    \nActiveWindow.ScrollRow = 14929    \nActiveWindow.ScrollRow = 14949    \nActiveWindow.SmallScroll Down:=3\n\nRange(\"A14988\").Select    \nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _    \n:=False, Transpose:=False\n\nWindows(\"Report_Instructions_and_macros_Test1.xlsm\").Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1562105481, "post_id": 56860600, "comment_id": 100271047, "body": "On which line does the error occur?"}], "answers": [{"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": false, "score": 0, "last_activity_date": 1562120385, "last_edit_date": 1562120385, "creation_date": 1562119210, "answer_id": 56861955, "question_id": 56860600, "link": "https://stackoverflow.com/questions/56860600/how-to-wait-until-a-userform-is-created/56861955#56861955", "title": "How to wait until a userform is created", "body": "<p>After creating a new userform and setting its properties, I'm assuming you're showing the userform, and then removing it when finished.  If so, when you remove a newly created userform, it still remains in memory until the workbook is saved.  Hence, you'll get that error when you run the code a second time and give it the same name.  So either add <code>ThisWorkbook.Save</code> before the end of your procedure or simply don't name the userform and accept its default name.</p>\n"}], "owner": {"reputation": 189, "user_id": 3057893, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nvJwi.jpg?s=128&g=1", "display_name": "Javier", "link": "https://stackoverflow.com/users/3057893/javier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562135761, "creation_date": 1562105240, "last_edit_date": 1562135761, "question_id": 56860600, "link": "https://stackoverflow.com/questions/56860600/how-to-wait-until-a-userform-is-created", "title": "How to wait until a userform is created", "body": "<p>At first, apologize for my english.</p>\n\n<p>I have programmatically created a userform, but when I try to change properties (when \"With m_FormProgressBar\"),  an error occurs (Error 75). It seems the object hasn't been created yet.</p>\n\n<p>Any idea?</p>\n\n<pre><code>'Creo el UserForm\n    Set m_FormProgressBar = ThisWorkbook.VBProject _\n        .VBComponents.Add(vbext_ct_MSForm)\n\n        'Agrego FormGraficos\n        With m_FormProgressBar\n            .Name = \"FrmProgress\"\n            .Properties(\"Name\") = \"FrmProgress\"\n            .Properties(\"width\") = 240\n            .Properties(\"height\") = 80\n            .Properties(\"Caption\") = \"Construyendo auditor\u00eda...\"\n            .Properties(\"ShowModal\") = False\n        End With\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1562104948, "post_id": 56860425, "comment_id": 100270933, "body": "What is in <code>Cells(1, 53)</code> and <code>Cells(2,3)</code>? You might need to convert whatever is in those first before multiplying."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1562105094, "post_id": 56860425, "comment_id": 100270961, "body": "If the product of those two values is greater than the allowable limit in <code>Integer</code>, you need to declare <code>busum As Long</code> (or <code>As Double</code>)."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1562105149, "post_id": 56860425, "comment_id": 100270976, "body": "You want to assign<code>busum</code>to wssum.Cell.Value, but reversed it! <code>wssum.Cells(4 + i, 3 + j).Value = busum</code>in second last line of code."}, {"owner": {"reputation": 11, "user_id": 11731396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02d39728eeee7f2d113f7652a698747?s=128&d=identicon&r=PG&f=1", "display_name": "VBAlearner1234", "link": "https://stackoverflow.com/users/11731396/vbalearner1234"}, "edited": false, "score": 0, "creation_date": 1562105345, "post_id": 56860425, "comment_id": 100271019, "body": "The values stored in each of the cells is a larger currency value but even converting the variables to currency gives me this error"}, {"owner": {"reputation": 11, "user_id": 11731396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02d39728eeee7f2d113f7652a698747?s=128&d=identicon&r=PG&f=1", "display_name": "VBAlearner1234", "link": "https://stackoverflow.com/users/11731396/vbalearner1234"}, "edited": false, "score": 0, "creation_date": 1562105394, "post_id": 56860425, "comment_id": 100271028, "body": "Thanks for catching that buy I am running into the type mismatch at line    bumonth = CInt(ws.Cells(1, 53 + j).Value * ws.Cells(2 + i, 3 + j).Value)"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1562105833, "post_id": 56860425, "comment_id": 100271130, "body": "Check the Cells.Values to be numbers(e.g:<code>CCur(&quot;a&quot; * &quot;b&quot;)</code>raises &quot;Type Missmatch&quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11731396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02d39728eeee7f2d113f7652a698747?s=128&d=identicon&r=PG&f=1", "display_name": "VBAlearner1234", "link": "https://stackoverflow.com/users/11731396/vbalearner1234"}, "edited": false, "score": 1, "creation_date": 1562163772, "post_id": 56860790, "comment_id": 100293160, "body": "Thank you for this. It turns out I made the mistake of mixing up my rows and column in the Cell recall. A simple mistake but one I would have completely overlooked if not for this."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 11, "user_id": 11731396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02d39728eeee7f2d113f7652a698747?s=128&d=identicon&r=PG&f=1", "display_name": "VBAlearner1234", "link": "https://stackoverflow.com/users/11731396/vbalearner1234"}, "edited": false, "score": 0, "creation_date": 1562166359, "post_id": 56860790, "comment_id": 100294808, "body": "@VBAlearner1234 - You are welcome. Debugging and seeing what causes the mistake is also programming."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1562106708, "creation_date": 1562106708, "answer_id": 56860790, "question_id": 56860425, "link": "https://stackoverflow.com/questions/56860425/vba-how-to-fix-type-mismatch/56860790#56860790", "title": "VBA: How to fix &quot;type mismatch&quot;", "body": "<p>Most probably the values you are multiplying are not numeric, thus these have to be checked. A possible way to do so is like this:</p>\n\n<pre><code>For j = 0 To 43\n    If Not IsNumeric(ws.Cells(1, 53 + j).Value) Then\n        Err.Raise 999, Description:=\"Value on  \" &amp; ws.Cells(1, 53 + j).Address &amp; \" is not numeric!\"\n    End If\n    If Not IsNumeric(ws.Cells(2 + i, 3 + j).Value) Then\n        Err.Raise 999, Description:=\"Value on  \" &amp; ws.Cells(2 + i, 3 + j).Address &amp; \" not numeric!\"\n    End If\n\n    bumonth = 0\n    bumonth = CCur(ws.Cells(1, 53 + j).Value * ws.Cells(2 + i, 3 + j).Value)\n    busum = busum + bumonth\nNext j\n</code></pre>\n\n<p>Furthermore, as mentioned in the comments, it is not a good idea to use <code>Integer</code> in VBA, as you can easily get an overflow error - <a href=\"https://stackoverflow.com/questions/26409117/why-use-integer-instead-of-long\">Why Use Integer Instead of Long?</a></p>\n"}], "owner": {"reputation": 11, "user_id": 11731396, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c02d39728eeee7f2d113f7652a698747?s=128&d=identicon&r=PG&f=1", "display_name": "VBAlearner1234", "link": "https://stackoverflow.com/users/11731396/vbalearner1234"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562135755, "creation_date": 1562104088, "last_edit_date": 1562135755, "question_id": 56860425, "link": "https://stackoverflow.com/questions/56860425/vba-how-to-fix-type-mismatch", "title": "VBA: How to fix &quot;type mismatch&quot;", "body": "<p>I have been working on a simple macro that runs a for loop that takes a cell multiples it by the column and sums it before repeating the again for the next cell in the column. The for loops looks fine but when trying to convert a worksheet cell value to an integer it runs into a type mismatch</p>\n\n<pre><code>Dim ws As Worksheet\nDim wssum As Worksheet\n\n'set worksheets to copy values\nSet ws = Sheets(\"sheet1\")\nSet wssum = Sheets(\"sheet2\")\n\nDim i As Integer\nDim j As Integer\nDim bumonth As Currency\nDim busum As Currency\nDim bux As Currency\n\n\n\n'sort through months\nFor i = 0 To 11\n    'sort through rows the number or rows is hardcoded to the number of apps in sheet\n    For j = 0 To 43\n        bumonth = 0\n        bumonth = CCur(ws.Cells(1, 53 + j).Value * ws.Cells(2 + i, 3 + j).Value)\n        busum = busum + bumonth\n    Next j\n       wssum.Cells(4 + i, 3 + j).Value=  busum\n    Next i\n</code></pre>\n\n<p>The error is happening at line </p>\n\n<pre><code>bumonth = CInt(ws.Cells(1, 53 + j).Value * ws.Cells(2 + i, 3 + j).Value)\n</code></pre>\n\n<p>what I was hoping this code would do is grab the values from the form in sheet 1 and export the values onto sheet 2.</p>\n"}, {"tags": ["excel", "vba", "formula"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562105335, "post_id": 56860417, "comment_id": 100271016, "body": "Don&#39;t be discouraged. At what line does the problem occur in the debugger?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562107752, "post_id": 56860417, "comment_id": 100271534, "body": "You can write a formula to a range with one line, without needing to loop. That said, step through with <code>F8</code> - does that loop execute?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 0, "creation_date": 1562114830, "post_id": 56860417, "comment_id": 100272730, "body": "<code>Set wbReference = Workbooks.Open(FileToOpen)</code> will open the workbook. You don&#39;t need the other <code>Workbooks.Open (FileToOpen)</code> line as well"}, {"owner": {"reputation": 85, "user_id": 11724743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f91af7b9394a867f4d4b6062459596fa?s=128&d=identicon&r=PG&f=1", "display_name": "Stephanie ", "link": "https://stackoverflow.com/users/11724743/stephanie"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562164695, "post_id": 56860417, "comment_id": 100293749, "body": "@AAA That&#39;s what I&#39;m so confused about. Nothing comes up in the debugger. It runs, just doesn&#39;t work."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562165468, "post_id": 56860417, "comment_id": 100294273, "body": "@Stephanie I think it has to do with your formula. Why not input this Formula in a cell, and check that it works?"}], "owner": {"reputation": 85, "user_id": 11724743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f91af7b9394a867f4d4b6062459596fa?s=128&d=identicon&r=PG&f=1", "display_name": "Stephanie ", "link": "https://stackoverflow.com/users/11724743/stephanie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1562284597, "answer_count": 0, "score": 0, "last_activity_date": 1562104051, "creation_date": 1562104051, "question_id": 56860417, "link": "https://stackoverflow.com/questions/56860417/hitting-a-wall-how-to-find-problems-in-formulas-vba", "closed_reason": "Duplicate", "title": "Hitting a wall. How to find problems in formulas VBA", "body": "<p>This is my first attempt at coding and I have hit a point where is just can't figure it out and am very discouraged. I am trying to get the formula to check in wsReference and if there is a line where three cell match on both sheets it will place string into \"fillinCell\" (column c) granted my quantity condition is satisfied. I have seemed to iron out a lot of errors but now when I run the code it just opens wsReference and nothing else happens. </p>\n\n<p>I just started learning VBA a few days ago, so I don't exactly understand how to fix this. I have never run into a problem that wasn't identified by the debugger.</p>\n\n<pre><code>Sub Openfile()\n\n    Dim wbOracle As Workbook\n    Set wbOracle = ThisWorkbook\n\n    Dim FileToOpen As Variant\n\n    FileToOpen = Application.GetOpenFilename(FileFilter:=\"Excel Workbooks (*.xls*),*.xls*\", Title:=\"Open Database File\")\n    If FileToOpen = False Then\n    MsgBox \"No file selected, cannot continue.\" 'If the user does not open a file this message is displayed\n    Exit Sub 'If no file is selected the program stops running\n    End If\n\n    Dim wbReference As Workbook\n    Set wbReference = Workbooks.Open(FileToOpen)\n    Workbooks.Open (FileToOpen) 'If a file is selected it opens that file.\n\n    LoopTest1 wbOracle, wbReference\n\nEnd Sub\n\nSub LoopTest1(ByRef wbOracle As Workbook, ByRef wbReference As Workbook)\n\n    Dim wsOracle As Worksheet\n    Set wsOracle = wbOracle.Worksheets(1)\n\n    Dim wsReference As Worksheet\n    Dim referenceCell As Range\n    Set wsReference = wbReference.Worksheets(1)\n    Set referenceCell = wsOracle.Range(\"E16\")\n\n    Set fillinCell = wsOracle.Range(\"C16\")\n\n Dim formulaText As String\n    Do While Not IsEmpty(referenceCell)\n        formulaText = \"=IF(INDEX('[\" &amp; wbReference.Name &amp; \"]Worksheets(1)'!$A$2000:$M$2000,MATCH(1,(['\" &amp; wbReference.FullName &amp; \"]Worksheets(1)'!D:D=['\" &amp; wbOracle.FullName &amp; \"]\" &amp; wsOracle.Name &amp; \"'!E16)*('[\" &amp; wbReference.FullName &amp; \"]Worksheets(1)!E:E=[\" &amp; wbOracle.FullName &amp; \"]\" &amp; wsOracle.Name &amp; \"'!'I16')*([\" &amp; wbReference.FullName &amp; \"]Worksheets(1)!F:F=[\" &amp; wbOracle.FullName &amp; \"]\" &amp; wsOracle.Name &amp; \"'!'J16'),0),9)&gt;=[\" &amp; wbOracle.FullName &amp; \"]\" &amp; wsOracle.Name &amp; \"'!M:M, \"\"materials supplied\"\",\"\"\"\")\"\n        fillinCell.Formula = formulaText\n        Set referenceCell = referenceCell.Offset(1, 0)\n        Set fillinCell = fillinCell.Offset(1, 0)\n    Loop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1562135666, "post_id": 56860594, "comment_id": 100277337, "body": "How did you get this URL in your code? The URL in the main post is different from yours. Can you explain this point for us please?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1562135865, "post_id": 56860594, "comment_id": 100277417, "body": "@YasserKhalil Open Chrome /FF - enter the original url and load the page. Then press F12 and goto the network tab &gt; press F5 to refresh page. Filter on XHR in the network tab. You will see it there. See <a href=\"https://stackoverflow.com/a/56279841/6241235\">this</a>"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1562137119, "post_id": 56860594, "comment_id": 100278024, "body": "Thanks a lot. Another point: the UDF Epoch2DateS I got it to convert the unix timestamp (1561791600000) .. But what about the first UDF &#39;Epoch2Date&#39;. Is this UDF related to the topic? Can you give me example of how to use this Epoch2Date UDF?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1562137229, "post_id": 56860594, "comment_id": 100278081, "body": "Both functions do the same thing i.e. you pass them the unix timestamp and a datetime is returned. It was just to show a couple of different ways."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1562132557, "last_edit_date": 1562132557, "creation_date": 1562105212, "answer_id": 56860594, "question_id": 56860363, "link": "https://stackoverflow.com/questions/56860363/vba-scrape-html-from-url-with-javascript-elements/56860594#56860594", "title": "VBA scrape HTML from URL with JavaScript elements", "body": "<p>It is dynamically added  via another xhr call which you can find in the network tab of browser. So change your url to that and then use a json parser to parse the response. </p>\n\n<p>Use a json parser, such as <a href=\"https://github.com/VBA-tools/VBA-JSON/blob/master/JsonConverter.bas\" rel=\"nofollow noreferrer\">jsonconverter.bas</a> to handle the response. After installing the code from that link in a standard module called JsonConverter, go to VBE > Tools > References > Add a reference to Microsoft Scripting Runtime.</p>\n\n<p>You extract your value from the json which is returned as unix timestamp.</p>\n\n<pre><code>1561791600000  &gt;  2019-06-29T07:00:00.000Z\n</code></pre>\n\n<p>The json response actually has all the info regarding the tracking. You can explore it <a href=\"https://jsoneditoronline.org/?id=52c6b3d761164dd9b5376d4f207cb102\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub Test()\n    Dim json As Object\n\n    With CreateObject(\"WINHTTP.WinHTTPRequest.5.1\")\n        .Open \"GET\", \"https://www.afklcargo.com/resources/tnt/singleAwbDetails?awbId=074-26126063\", False\n        .send\n        Set json = JsonConverter.ParseJson(.responseText)\n        Debug.Print json(\"booking\")(1)(\"arrivalDateLong\")(\"local\")\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Two functions, by Schmidt and Navion for doing the conversion to datetime from stamp copied directly from <a href=\"http://www.vbforums.com/showthread.php?805245-EPOCH-to-Date-and-vice-versa\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<pre><code>Function Epoch2Date(ByVal E As Currency, Optional msFrac) As Date\n    Const Estart As Double = #1/1/1970#\n    msFrac = 0\n    If E &gt; 10000000000@ Then E = E * 0.001: msFrac = E - Int(E)\n    Epoch2Date = Estart + (E - msFrac) / 86400\nEnd Function\n\nFunction Epoch2DateS(ByVal epochstamp$) As Date\n    Epoch2DateS = CVDate(CDbl(DateSerial(1970, 1, 1)) + Int(Val(epochstamp$) / 1000#) / 86400)\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>N.B.</strong></p>\n\n<p>Using json parser is the reliable and recommended way, but you can also regex or <code>split</code> function to get the value.</p>\n"}], "owner": {"reputation": 625, "user_id": 959815, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/39a908512abfc4a3f024979c7af4511c?s=128&d=identicon&r=PG", "display_name": "tutu", "link": "https://stackoverflow.com/users/959815/tutu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 56860594, "answer_count": 1, "score": 2, "last_activity_date": 1562135704, "creation_date": 1562103727, "last_edit_date": 1562135704, "question_id": 56860363, "link": "https://stackoverflow.com/questions/56860363/vba-scrape-html-from-url-with-javascript-elements", "title": "VBA scrape HTML from URL with JavaScript elements", "body": "<p>Using the following code</p>\n\n<pre><code>Sub Test()\n'Must have the Microsoft HTML Object Library reference enabled\nDim oHtml As HTMLDocument\nDim oElement As Object\nDim link As String\n\nSet oHtml = New HTMLDocument\n\nWith CreateObject(\"WINHTTP.WinHTTPRequest.5.1\")\n    .Open \"GET\", \"https://www.afklcargo.com/WW/en/local/app/index.jsp#/tntdetails/074-26126063\", False\n    .Send\n    oHtml.Body.innerHTML = .responseText\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I am unable to get the actual HTML, I believe it's because the website is using Javascript? How can I circumvent this so I can get my value?</p>\n\n<p><a href=\"https://i.stack.imgur.com/AY9y0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AY9y0.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1562100344, "post_id": 56859743, "comment_id": 100269603, "body": "Is your userform&#39;s <code>StartUpPosition</code> property set to 0? By default, the userform will open on whichever monitor you last had the editor open on. In my experience, positioning userforms where you want them is a complete and total pain."}, {"owner": {"reputation": 41, "user_id": 11610445, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vUJmVcS5LCI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfAxtg5oWr3CaoSIeR-yFVHfiNwcQ/mo/photo.jpg?sz=128", "display_name": "Thiago Andrade", "link": "https://stackoverflow.com/users/11610445/thiago-andrade"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1562100686, "post_id": 56859743, "comment_id": 100269721, "body": "Yes, I tried with 0, 1, 2 and 3... Always the same result. Yest it&#39;s a total pain!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562100906, "post_id": 56859743, "comment_id": 100269795, "body": "What monitor is Excel on if I stretch its border across 2 monitors?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562345085, "post_id": 56859743, "comment_id": 100358055, "body": "@MathieuGuindon Whichever side has more of the window visible I guess :)"}], "owner": {"reputation": 41, "user_id": 11610445, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-vUJmVcS5LCI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfAxtg5oWr3CaoSIeR-yFVHfiNwcQ/mo/photo.jpg?sz=128", "display_name": "Thiago Andrade", "link": "https://stackoverflow.com/users/11610445/thiago-andrade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 109, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1562100862, "creation_date": 1562099889, "last_edit_date": 1562100862, "question_id": 56859743, "link": "https://stackoverflow.com/questions/56859743/positioning-userform-on-the-same-monitor-where-excel-is", "title": "Positioning userform on the same monitor where excel is", "body": "<p>Good afternoon,</p>\n\n<p>I'm creating a Dashboard in which when running Excel a userform is opened, maximized and Excel is hidden. My code works perfectly for a PC with just one monitor.</p>\n\n<p>When using a dual-monitor PC VBA opens the userform on the main monitor, but to maximize it it takes the information from the monitor on which Excel was open.</p>\n\n<p>Does anyone know how to make VBA identify on which monitor Excel is open and open the userform on that monitor?</p>\n\n<pre><code>'Set the Windows style so that the userform has a minimise and maximise button\nlngCurrentStyle = GetWindowLong(lngHWnd, GWL_STYLE)\nlngNewStyle = lngCurrentStyle Or WS_MINIMIZEBOX 'Or WS_MAXIMIZEBOX\nlngNewStyle = lngNewStyle And Not WS_VISIBLE And Not WS_POPUP 'And WS_MINIMIZEBOX\nSetWindowLong lngHWnd, GWL_STYLE, lngNewStyle\n\n'Set the extended style to provide a taskbar icon\nlngCurrentStyle = GetWindowLong(lngHWnd, GWL_EXSTYLE)\nlngNewStyle = lngCurrentStyle Or WS_EX_APPWINDOW\nSetWindowLong lngHWnd, GWL_EXSTYLE, lngNewStyle\nShowWindow lngHWnd, SW_SHOW\n\n'Remove the top bar\nHideTitleBar Me\n\n'Maximize form\nWith Me\n    .StartUpPosition = 1\n    .Width = Application.Width\n    .Height = Application.Height\n    .Left = 0\n    .Top = 0\nEnd With\n</code></pre>\n\n<p>NOTE: I will not post the complete code here because it is not a very complex code, but long.</p>\n\n<p>Thank you all.</p>\n"}, {"tags": ["excel", "vba", "loops", "web-scraping", "automation"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1562099832, "post_id": 56859325, "comment_id": 100269419, "body": "<i>&quot;However, my code should be moving onto the next number in the column, but it is not.&quot;</i> - what do you mean it&#39;s not? Something that immediately stands out to me is that you&#39;re using <code>i</code> in <code>For i = 3 to lastrow</code>, but <i>within</i> that loop you&#39;re incrementing it as well (<code>i = i + 1</code>). I would expect that to skip every other row."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1562103628, "post_id": 56859325, "comment_id": 100270576, "body": "Indenting your code properly will go a long way to helping spot what is going on. Rather than posting a code review as an answer, here is a pastebin of some simple changes to consider (not all encompassing but just a quick few thoughts) - <a href=\"https://pastebin.com/V3Rm8vDq\" rel=\"nofollow noreferrer\">pastebin.com/V3Rm8vDq</a>  The point about incrementing <i>i</i> , which is already incremented by virtue of being the loop variable, is covered above. Notes on avoiding select <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">here</a>"}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1562169624, "post_id": 56859325, "comment_id": 100296539, "body": "@dwirony, It doesnt even skip rows or anything, it just doesn&#39;t enter any of the values into the webpage other than the first."}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1562169664, "post_id": 56859325, "comment_id": 100296564, "body": "@QHarr thanks this definitely does help. i think when i copy it from VBA into this website i get it messed up sometimes..."}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1562169689, "post_id": 56859325, "comment_id": 100296578, "body": "it should be somewhat properly indented.... i think..."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1562169953, "post_id": 56859325, "comment_id": 100296715, "body": "@vba_user111 At the end of your last loop you <code>Exit For</code>, which leads you right to <code>End Sub</code> - where are you expecting this to go?"}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1562170749, "post_id": 56859325, "comment_id": 100297099, "body": "I was expecting it to navigate back to the webpage, then bascially go back to the top of the code. Ie;  go to the web page, click the buttons again, go back to my list of numbers and enter the 2nd one and do this for the whole list of the numbers. I just now changed the &#39;exit for&#39; and &#39;next i&#39; to be before the navigate part, but still nothing happens."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1562173967, "post_id": 56859325, "comment_id": 100298634, "body": "@vba_user111 Move <code>Next i</code> between the <code>End With</code>s"}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1562174347, "post_id": 56859325, "comment_id": 100298793, "body": "@dwirony when I do that it says &quot;compile error: end with without with&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1562176090, "post_id": 56875349, "comment_id": 100299553, "body": "This looks good! I just updated my code. So right now it works, but it doesnt click through the buttons again. It just navigates to that page (possibly &quot;enters&quot; the account number- but theres no spot on this page to enter anytinhg so it looks like nothing happens), and high lights the page and tries to copy it into sheet4. Is there anyway to get it to click through the buttons again?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1562179396, "post_id": 56875349, "comment_id": 100301003, "body": "@vba_user111 Do you have to sign in again each time?"}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1562589034, "post_id": 56875349, "comment_id": 100410160, "body": "nope, the user is still logged in, but the buttons have to be click through again(  to initiate it )"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1562597995, "post_id": 56875349, "comment_id": 100415579, "body": "@vba_user111 Since I don&#39;t have a visual I&#39;m trying to figure out where you&#39;re going back to when you hit the line <code>IE.Navigate (&quot;https:&#47;&#47;mywebsite.com&#47;Default&quot;)</code> near the end - I thought going back to the top of the loop would suffice."}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1562598737, "post_id": 56875349, "comment_id": 100416058, "body": "so the web-page starts with having to log in, then once u enter username/password and submit it brings you to the &quot;default&quot; page, where you need to click the initiate button. once you click the initiate, the checkbox button pops up, once you click that, the review button pops up and it loads. Then it goes to the page where you can click the historical button and input the number. So essentially, I have my code doing all this and entering the first number (copy/pasting etc.) but as it stands right now, it just does it for the first number, then goes back to that site."}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1562598786, "post_id": 56875349, "comment_id": 100416082, "body": "however, now with your improvements, it goes back to that page and copys and pastes it again, but doesn&#39;t click the buttons (so the 2nd number is never entered)"}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1562850494, "post_id": 56875349, "comment_id": 100514562, "body": "any ideas? Thanks again for all your current help."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1562862969, "post_id": 56875349, "comment_id": 100521770, "body": "@vba_user111 My guess is you need to add some wait time after the <code>IE.Navigate (&quot;https:&#47;&#47;mywebsite.com&#47;Default&quot;)</code> line, it&#39;s probably navigating to the page and loading while the code is still running. Try adding an <code>Application.Wait(Now + TimeValue(0:00:05))</code> after that line or something."}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1562874547, "post_id": 56875349, "comment_id": 100526763, "body": "hmm i tried this and it still just goes and tries to copy the second page (wherethe buttons are)"}, {"owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1562888083, "post_id": 56875349, "comment_id": 100530641, "body": "To check static HTML readiness, you can use the following one-liner: <code>Do While (IE.readystate &lt;&gt; 4 or IE.busy &lt;&gt; False): DoEvents: Loop</code>. Adding 10 seconds timer after every button click or page load is highly recommended for troubleshooting because of possible JavaScript-generated HTML elements. Even better is to open your code editor on one half of the screen, run it step by step and on the other half observe IE with <code>.Visible</code> to narrow down the problematic lines of the code."}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "reply_to_user": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "edited": false, "score": 0, "creation_date": 1562940020, "post_id": 56875349, "comment_id": 100549679, "body": "@RyszardJ\u0119draszyk yes, i added these one-liners all over now. And I have tried to troubleshoot and go step by step but about three  quarters of the way through the code a pop up comes and says it cannot enter break mode. even with these one liners it still doesnt go through the buttons again"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1562945029, "post_id": 56875349, "comment_id": 100552598, "body": "@vba_user111 Unfortunately I can only do so much without knowing the actual website URL and layout, you&#39;ll have to step line by line through this code to see why it&#39;s skipping the clicking of these buttons."}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1563195691, "post_id": 56875349, "comment_id": 100608351, "body": "@dwirony with this current code, is the program supposed to loop back to the beginning of the code and click through them again?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1563201729, "post_id": 56875349, "comment_id": 100611913, "body": "@vba_user111 It&#39;s looping through all your rows, anything before that I assumed was logging into the website."}, {"owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1563202543, "post_id": 56875349, "comment_id": 100612342, "body": "@dwirony so I have it logging in, clicking the buttons and taking the first cell from excel and entering it. It then copys the data from this page back into excel. What I need help fixing is having it do this entire thing again and again(minus entering user/password). So going to first page (still logged in) and clicking the buttons, entering the next row # and copying back to excel. And I have already tried to go line by line but by the line in my  code where I copy it back to excel a pop up on VBA occurs that says I cannot go into break mode, hence why by line by line wasn&#39;t working."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "edited": false, "score": 0, "creation_date": 1563206124, "post_id": 56875349, "comment_id": 100614417, "body": "@vba_user111 What is this &quot;initiate new request&quot; bit - is that something you have to do each time as well? This line:  <code>Set elems = .document.queryselectorall(&quot;input[value=Initiate]&quot;)</code>"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 2, "last_activity_date": 1562175135, "creation_date": 1562175135, "answer_id": 56875349, "question_id": 56859325, "link": "https://stackoverflow.com/questions/56859325/vba-to-automate-web-scrape-entering-cells/56875349#56875349", "title": "VBA to automate web-scrape entering cells", "body": "<p>I took a shot at cleaning this up - try the below code.</p>\n\n<p>Your question is hard to answer because your code is not only hard to follow, but indented very poorly, and your variables are ambiguous. You also declare variables that never appear to be used.</p>\n\n<pre><code>Option Explicit\nPublic Const UBlim As Long = 6\nSub Login()\n\n    Dim IE As Object\n    Dim eInput As Object\n    Dim ws As Worksheet: Set ws = Sheets(\"VALUES\")\n    Dim i As Long\n    Dim j As Long\n    Dim lastrow As Long\n    Dim svalue1 As Object\n    Dim results As Variant\n    Dim wkscnt As Long\n    Dim wks As Excel.Worksheet\n    Dim wkshtnames()\n    Dim a As Object\n    Dim b As Object\n    Dim t As Date\n    Dim elems As Object\n    Const MAXWAIT_sec As Long = 10\n\n    Set IE = CreateObject(\"InternetExplorer.application\")\n    IE.Visible = True\n    IE.Navigate (\"http://mywebsite.com/\")\n\n    With IE\n\n        Do\n            If IE.readystate = 4 Then\n                Exit Do\n            Else\n                DoEvents\n            End If\n        Loop\n\n        'Enters username and password\n\n        With .document\n            .forms(\"signingin\").UserName.Value = \"userr\"\n            .forms(\"signingin\").Password.Value = \"password\"\n            .forms(\"signingin\").document.forms(0).submit\n\n            'this clicks a button after logging in that says initiate new request\n            t = Timer\n\n            Do\n                On Error Resume Next\n                Set elems = .document.queryselectorall(\"input[value=Initiate]\")\n                On Error GoTo 0\n\n                If Timer - t &gt; MAXWAIT_sec Then\n                    Exit Do\n                End If\n\n            Loop While elems Is Nothing\n\n            If Not elems Is Nothing Then\n                elems.Item.Click\n            End If\n\n            Application.Calculation = xlCalculationManual\n            Application.CutCopyMode = False\n            wkscnt = ThisWorkbook.Sheets.Count\n            j = 0\n\n            For Each wks In ActiveWorkbook.Worksheets\n\n                j = j + 1\n\n                If j &gt; UBlim Then\n                    ReDim Preserve wkshtnames(7 To wkscnt)\n                    wkshtnames(j) = wks.Name\n                End If\n\n            Next wks\n\n            If wkscnt &gt; UBlim Then\n                Application.DisplayAlerts = False\n                Sheets(wkshtnames).Delete\n                Application.DisplayAlerts = True\n            End If\n\n            lastrow = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row\n\n            For i = 3 To lastrow\n                Set svalue1 = .getElementbyID(\"Number\")\n                svalue1.Value = ws.Cells(i, 1).Value\n                i = i + 1\n\n                For Each eInput In .getElementsbyTagName(\"input\")\n                    If eInput.getAttribute(\"value\") = \"Submit Request\" Then\n                        eInput.Click\n                        Exit For\n                    End If\n                Next eInput\n\n                IE.Visible = True\n\n                'copy and pasting the info from the web page to a new excel sheet\n                Sheets(\"Sheet4\").Range(\"A1:Z100\").ClearContents\n                IE.ExecWB 17, 0 '//select\n                IE.ExecWB 12, 2 '//Copy Selection\n                ActiveSheet.Paste\n\n                Sheets(\"Sheet4\").Range(\"A3:Q32\").Copy\n\n                'Creates a new sheet after &amp; pastes content into it, formats\n                Sheets.Add After:=ActiveSheet\n                ActiveSheet.Paste\n                Selection.Columns.AutoFit\n                Selection.Rows.AutoFit\n\n                ActiveSheet.Protect\n                'this navigates back to the page where I need to enter the value in the excel column again\n\n                IE.Navigate (\"https://mywebsite.com/Default\")\n            Next i\n\n        End With\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1563549894, "post_id": 57082533, "comment_id": 100749622, "body": "Aha, I knew you needed to move the initiate inside your loop :). Sorry I couldn&#39;t have been more help, webscraping without access to the URL is like coding in the dark."}], "tags": [], "owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "is_accepted": true, "score": 1, "last_activity_date": 1563454558, "last_edit_date": 1563454558, "creation_date": 1563389786, "answer_id": 57082533, "question_id": 56859325, "link": "https://stackoverflow.com/questions/56859325/vba-to-automate-web-scrape-entering-cells/57082533#57082533", "title": "VBA to automate web-scrape entering cells", "body": "<p>Ok, after asking this question a few times and trying to find different ways to solve this issue, I have  <strong>FOUND</strong> ( <em>/ written</em> ) my answer! </p>\n\n<p>Here it is:</p>\n\n<pre><code>Option Explicit\n\nSub NewScrape()\n\nDim IE As Object\nDim IeDoc As Object\nDim aInput As Object\nDim eInput As Object\nDim svalue1 As Object\nDim a As Object\nDim b As Object\nDim elems As Object\nDim t As Date\nDim i As Long, lastrow As Long\nDim results As Variant, wkshtnames()\nDim ws As Worksheet, wks As Excel.Worksheet\nDim NewName As String\nDim sheet As Worksheet\nDim duplicate As Boolean\n\nConst MAXWAIT_sec As Long = 10\n\nSet ws = Sheets(\"VALUE\")\n\nSet IE = CreateObject(\"InternetExplorer.application\")\nIE.Visible = True\nIE.Navigate (\"http://mywebsite.com/\")\n\n    Do While IE.busy: DoEvents: Loop\n\nSet IeDoc = IE.document\n\n'Enters username and password\n    With IeDoc\n        .forms(\"signingin\").UserName.Value = \"userr\"\n        .forms(\"signingin\").Password.Value = \"password\"\n        .forms(\"signingin\").document.forms(0).submit\n    End With\n\n\nApplication.Wait (Now + TimeValue(\"0:00:03\"))\n\n    lastrow = ws.Cells(ws.rows.Count, \"A\").End(xlDown).Row\n    IE.Visible = True\n\n    For i = 3 To lastrow\n\nSet IeDoc = IE.document ' set new page source\n\n    t = Timer\n\n    Do\n        On Error Resume Next\n        Set elems = IeDoc.queryselector(\"input[value=Initiate]\")\n        On Error GoTo 0\n        If Timer - t &gt; MAXWAIT_sec Then\n            Exit Do\n        End If\n    Loop While elems Is Nothing\n\n    If Not elems Is Nothing Then\n        elems.Item.Click\n    End If\n\n    Application.Wait (Now + TimeValue(\"0:00:03\"))\n\n\n    IeDoc.getElementByID(\"checkConf\").Click\n\n\n    For Each aInput In IeDoc.getElementsbyTagName(\"input\")\n         If aInput.getAttribute(\"value\") = \"Request\" Then\n            aInput.Click\n            Exit For\n        End If\n    Next aInput\n\n\n    Do While IE.busy: DoEvents: Loop\n\n    'Selects history\n    For Each aInput In IeDoc.getElementsbyTagName(\"input\")\n        If aInput.getAttribute(\"value\") = \"History\" Then\n            aInput.Click\n            Exit For\n        End If\n    Next aInput\n\n\n        Set svalue1 = IeDoc.getElementByID(\"accountNumber\")\n        svalue1.Value = ws.Cells(i, 1).Value 'takes the  number out and enters\n            'presses submit once acct numb is entered\n            For Each aInput In IeDoc.getElementsbyTagName(\"input\")\n                If aInput.getAttribute(\"value\") = \"Submit Request\" Then\n                    aInput.Click\n                    Exit For\n                 End If\n            Next aInput\n\n\n    Do While (IE.READYSTATE &lt;&gt; 4 Or IE.busy &lt;&gt; False): DoEvents: Loop\n    IE.Visible = True\n\n\n\n    'Webpage sometimes takes time to load.\n    Application.Wait DateAdd(\"s\", 10, Now)\n\n\n    'Selects and clears sheet 4\n    Sheets(\"Sheet4\").Select\n    Range(\"A1:Z100\").Select\n    Selection.ClearContents\n\n    Do While (IE.READYSTATE &lt;&gt; 4 Or IE.busy &lt;&gt; False): DoEvents: Loop\n\n\n    IE.ExecWB 17, 0 '//select all from webpage\n    IE.ExecWB 12, 2 '//Copy Selection\n\n    Do While (IE.READYSTATE &lt;&gt; 4 Or IE.busy &lt;&gt; False): DoEvents: Loop\n\n    Application.Wait DateAdd(\"s\", 2, Now)\n\n    Application.DisplayAlerts = False  '//Doesnt display alerts\n    ActiveSheet.Paste\n\n    Do While (IE.READYSTATE &lt;&gt; 4 Or IE.busy &lt;&gt; False): DoEvents: Loop\n\n\n    Sheets(\"Sheet4\").Select '//Selects sheet 4 again\n    Range(\"A3:Q32\").Select\n    Selection.Copy\n\n    Do While (IE.READYSTATE &lt;&gt; 4 Or IE.busy &lt;&gt; False): DoEvents: Loop\n\n    Application.Wait DateAdd(\"s\", 2, Now)\n\n    'Creates a new sheet after &amp; pastes content into it, formats\n    Sheets.Add After:=ActiveSheet\n    ActiveSheet.Paste\n    Selection.Columns.AutoFit\n    Selection.rows.AutoFit\n\n    Do While (IE.READYSTATE &lt;&gt; 4 Or IE.busy &lt;&gt; False): DoEvents: Loop\n\n\n    'If the worksheet already has been made:\n    duplicate = False\n    For Each sheet In ThisWorkbook.Sheets\n        If sheet.Name = Range(\"D10\") Then\n            MsgBox (\"ERROR: This Numb has already been formulated\")\n            NewName = InputBox(\"Please Rename:\")\n            ActiveSheet.Name = NewName\n            duplicate = True\n                Exit For\n        End If\n    Next sheet\n\n    If duplicate = False Then\n        ActiveSheet.Name = Range(\"d10\")\n        Range(\"A6\").Clear\n        ActiveSheet.Protect\n       ' MsgBox (\"DONE, next...\")\n    End If\n\n\n            'this navigates back to the page where I need to enter the value in the excel column again\n\n\n        IE.Navigate (\"https://mywebsite.com/Default\")\n        Do While (IE.READYSTATE &lt;&gt; 4 Or IE.busy &lt;&gt; False): DoEvents: Loop\n        IE.Visible = True\n\n\nNext i\n        Do While (IE.READYSTATE &lt;&gt; 4 Or IE.busy &lt;&gt; False): DoEvents: Loop\n        IE.Visible = True\n\n        On Error GoTo 0\n        MsgBox (\"All Accounts Have Been Formulated, Check it out!\")\n\n\n\n\n  End Sub\n</code></pre>\n\n<p>So <em>basically</em> I think my issue lies with where I put the <code>lastrow=</code>\n line and the <code>i=3</code> etc line as well as having the <code>Set IeDoc = IE.document</code> line after that too. :) </p>\n"}], "owner": {"reputation": 205, "user_id": 11615632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5573f08106738c9185073bed79e2cf5d?s=128&d=identicon&r=PG&f=1", "display_name": "vba_user111", "link": "https://stackoverflow.com/users/11615632/vba-user111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 57082533, "answer_count": 2, "score": 2, "last_activity_date": 1564490189, "creation_date": 1562097733, "last_edit_date": 1564490189, "question_id": 56859325, "link": "https://stackoverflow.com/questions/56859325/vba-to-automate-web-scrape-entering-cells", "title": "VBA to automate web-scrape entering cells", "body": "<p>I have a list of numbers in excel, and I want to automate the process of entering them into a web-page one by one.</p>\n\n<p>The code I currently have logs onto this website, enters username info and password. Presses enter. Then goes to the next screen, where I have it clicking initiate.</p>\n\n<p>Next, it goes to the next screen, where the program clicks the history button. \nIt then goes back to excel (to column A) and takes the first number out and enters it where it says \"Number Here\", and clicks enter. This brings me to a page with a ton of info that I then, copy and paste back into excel. </p>\n\n<p>Again, I have the program running for these factors. </p>\n\n<p><em>However</em>, I believe my code <em>should</em> be moving onto the next number in the column (ie, doing the above steps first for cell A3, then for cell A4 etc), but it is <strong><em>not</em></strong>. </p>\n\n<p>Below is my code: </p>\n\n<pre><code>Option Explicit\n\nSub _NumberFix()\n\nDim IE As Object\nDim IeDoc As Object\nDim aInput As Object\nDim eInput As Object\nDim svalue1 As Object\nDim elems As Object\nDim t As Date\nDim i As Long, lastrow As Long\nDim ws As Worksheet, wks As Excel.Worksheet\nDim NewName As String\nDim sheet As Worksheet\nDim duplicate As Boolean\n\nConst MAXWAIT_sec As Long = 10\n\nSet ws = Sheets(\"VALUES\")\n\nSet IE = CreateObject(\"InternetExplorer.application\")\nIE.Visible = True\nIE.Navigate (\"http://mywebsite.com/\")\n\n    Do While IE.busy: DoEvents: Loop\n\nSet IeDoc = IE.document\n\n'Enters username and password\n    With IeDoc.all\n        .UserName.Value = \"userr\"\n        .Password.Value = \"password\"\n    End With\n\n    With IE.document.forms(\"signingin\")\n        .document.forms(0).submit\n    End With\n\n\nSet IeDoc = IE.document ' set new page source\n\n    t = Timer\n\n    Do\n        On Error Resume Next\n        Set elems = IeDoc.queryselector(\"input[value=Initiate]\")\n        On Error GoTo 0\n        If Timer - t &gt; MAXWAIT_sec Then\n            Exit Do\n        End If\n    Loop While elems Is Nothing\n\n    If Not elems Is Nothing Then\n        elems.Item.Click\n    End If\n\n\n\n    IeDoc.getElementByID(\"checkConf\").Click\n\n\n    For Each aInput In IeDoc.getElementsbyTagName(\"input\")\n        If aInput.getAttribute(\"value\") = \"Request\" Then\n            aInput.Click\n            Exit For\n        End If\n    Next aInput\n\n\n    Do While IE.busy: DoEvents: Loop\n\n    'Selects historical\n    For Each aInput In IeDoc.getElementsbyTagName(\"input\")\n        If aInput.getAttribute(\"value\") = \"History\" Then\n            aInput.Click\n            Exit For\n        End If\n    Next aInput\n\n\n    lastrow = ws.Cells(ws.rows.Count, \"A\").End(xlUp).Row\n    IE.Visible = True\n\n    For i = 3 To lastrow\n\n    Set IeDoc = IE.document ' set new page source\n\n        Set svalue1 = IeDoc.getElementByID(\"Number\")\n        svalue1.Value = ws.Cells(i, 1).Value 'takes the  number out and enters\n            'presses submit once numb is entered\n            For Each aInput In IeDoc.getElementsbyTagName(\"input\")\n                If aInput.getAttribute(\"value\") = \"Submit\" Then\n                    aInput.Click\n                    Exit For\n                End If\n            Next aInput\n\n        IE.Navigate (\"https://mywebsite.com/\")\n        Do While (IE.READYSTATE &lt;&gt; 4 Or IE.busy &lt;&gt; False): DoEvents: Loop\n        IE.Visible = True\n        Exit For\n\n\nNext i\n        Do While (IE.READYSTATE &lt;&gt; 4 Or IE.busy &lt;&gt; False): DoEvents: Loop\n        IE.Visible = True\n\n\nEnd Sub                \n</code></pre>\n"}, {"tags": ["vba", "combobox", "dropdown"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562099392, "post_id": 56859174, "comment_id": 100269250, "body": "<code>Empty</code> is a <code>Variant</code> subtype, only equates to a <code>&quot;&quot;</code> empty string out of sheer luck and implicit type conversions. <code>IsEmpty(&quot;&quot;)</code> returns <code>False</code>, but <code>&quot;&quot; = Empty</code> evaluates to <code>True</code>. This isn&#39;t how <code>Empty</code> is intended to be used, it may very well turn against you at one point or another."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11731040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1d3e44dff236f09837289fb42bab76?s=128&d=identicon&r=PG&f=1", "display_name": "maglaud", "link": "https://stackoverflow.com/users/11731040/maglaud"}, "edited": false, "score": 0, "creation_date": 1562615456, "post_id": 56859549, "comment_id": 100423440, "body": "Thanks for the help this is a good start to the problem I need to solve!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 1, "last_activity_date": 1562105161, "last_edit_date": 1562105161, "creation_date": 1562098854, "answer_id": 56859549, "question_id": 56859174, "link": "https://stackoverflow.com/questions/56859174/is-there-a-way-to-identify-which-dropdown-boxes-arent-empty-when-hitting-searc/56859549#56859549", "title": "Is there a way to identify which dropdown boxes aren&#39;t empty when hitting &#39;search&#39; on a VBA GUI?", "body": "<p>If you can work with a <code>Collection</code> of ComboBox controls, then whip up a custom function like and call it like:</p>\n\n<pre><code>Dim populatedBoxes as New Collection\nSet populatedBoxes = GetPopulatedThings(Multipage1, \"ComboBox\")\nDim cb as MSForms.ComboBox\nFor Each cb in populatedBoxes\n    MsgBox cb.Value\nNext\n</code></pre>\n\n<p>In your code, you could replace:</p>\n\n<pre><code>If year = Empty And location = Empty And snap = Empty And city = Empty And group = Empty And endyear = Empty Then\n</code></pre>\n\n<p>With this:</p>\n\n<pre><code>Set populatedBoxes = GetPopulatedThings(Multipage1, \"ComboBox\")\nIf populatedBoxes.Count = 0 Then Exit Sub\n</code></pre>\n\n<p>Here's the function:</p>\n\n<pre><code>Private Function GetPopulatedThings(container As Object, Optional ctrlType As String = \"ComboBox\") As Collection\nDim c As New Collection\nDim ctrl As MSForms.Control\n\nFor Each ctrl In container.Controls\n    If TypeName(ctrl) = ctrlType Then\n        Select Case ctrlType\n            Case \"ComboBox\"\n                If ctrl.ListIndex &gt; -1 Then\n                    c.Add ctrl\n                End If\n            Case Else\n            ' TBD\n            ' Additional cases will require separate logic...\n        End Select\n    End If\nNext\nSet GetPopulatedThings = c\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11731040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1d3e44dff236f09837289fb42bab76?s=128&d=identicon&r=PG&f=1", "display_name": "maglaud", "link": "https://stackoverflow.com/users/11731040/maglaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 56859549, "answer_count": 1, "score": 1, "last_activity_date": 1562105161, "creation_date": 1562097017, "question_id": 56859174, "link": "https://stackoverflow.com/questions/56859174/is-there-a-way-to-identify-which-dropdown-boxes-arent-empty-when-hitting-searc", "title": "Is there a way to identify which dropdown boxes aren&#39;t empty when hitting &#39;search&#39; on a VBA GUI?", "body": "<p>I'm working on an application in VBA that takes in information from an excel sheet, populates a dropdown combobox, then based on the selected information from the dropbox, retrieves the full information for matching values.  There are 6 dropboxes and I'm looking for a way to find out which dropboxes have a value (not empty) without rewriting dozens of if statements with the same code but different conditions (i.e combo 1 and 3 have values, so the program will only look for the records based on those two selected fields)</p>\n\n<p>I know this can be achieved with re-writing if statements, but I'm hoping there's an easier way that doesn't take hours?</p>\n\n<pre><code>Private Sub Search_Page1_Click()\n\nDim year As String\nDim location As String\nDim snap As String\nDim city As String\nDim group As String\nDim endyear As String\n\nyear = Multipage1.Cmb_Year.Value\nlocation = Multipage1.Cmb_Location.Value\nsnap = Multipage1.Cmb_Snapshot.Value\ncity = Multipage1.Cmb_City.Value\ngroup = Multipage1.Cmb_Group.Value\nendyear = Multipage1.Cmb_LeaseEnd.Value\n\nIf year = Empty And location = Empty And snap = Empty And city = Empty \nAnd group = Empty And endyear = Empty Then\n\n\nMsgBox (\"Please fill in at least one field\")\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}]