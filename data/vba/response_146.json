[{"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 667, "user_id": 4097470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e18a78f4c5f640539775e532d78313?s=128&d=identicon&r=PG&f=1", "display_name": "VirtualMichael", "link": "https://stackoverflow.com/users/4097470/virtualmichael"}, "reply_to_user": {"reputation": 13, "user_id": 8834513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bc9139f33645d0388176030b05f1bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/8834513/ryan"}, "edited": false, "score": 0, "creation_date": 1509053032, "post_id": 46944101, "comment_id": 80875874, "body": "Great. Glad it was useful. Please mark it as the accepted answer to close the question out."}], "tags": [], "owner": {"reputation": 667, "user_id": 4097470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e0e18a78f4c5f640539775e532d78313?s=128&d=identicon&r=PG&f=1", "display_name": "VirtualMichael", "link": "https://stackoverflow.com/users/4097470/virtualmichael"}, "is_accepted": true, "score": 1, "last_activity_date": 1508978600, "creation_date": 1508978600, "answer_id": 46944101, "question_id": 46943588, "link": "https://stackoverflow.com/questions/46943588/in-excel-how-can-i-separate-duplicate-values-to-display-in-a-cleaner-format/46944101#46944101", "title": "In Excel, how can I separate duplicate values to display in a cleaner format?", "body": "<p>With a macro enabled workbook (.xlsm), you can cycle through each row, detect changes in a given column, then insert a blank line above when a change is detected. See the following code:</p>\n\n<pre><code>Sub SeparateGroups()\n    Dim lastRowIdx As Integer\n    lastRowIdx = Range(\"A1\").End(xlDown).Row()\n    Dim testRowIdx As Integer\n    Dim previousData As String\n    Dim testData As String\n    previousData = Range(\"A1\").Value\n    For testRowIdx = 2 To lastRowIdx\n        testData = Range(\"A\" &amp; testRowIdx).Value\n        If (testData &lt;&gt; previousData) Then\n            Rows(testRowIdx).Insert shift:=xlShiftDown\n            lastRowIdx = lastRow + 1\n        End If\n        previousData = testData\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8834513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bc9139f33645d0388176030b05f1bfd?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan", "link": "https://stackoverflow.com/users/8834513/ryan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 46944101, "answer_count": 1, "score": 0, "last_activity_date": 1508978600, "creation_date": 1508974386, "last_edit_date": 1531161705, "question_id": 46943588, "link": "https://stackoverflow.com/questions/46943588/in-excel-how-can-i-separate-duplicate-values-to-display-in-a-cleaner-format", "title": "In Excel, how can I separate duplicate values to display in a cleaner format?", "body": "<p>I might be asking this incorrectly, but I'm definitely no excel expert. Is there a faster way to separate duplicate values in excel post sorting? See attached images of what I need. Image 1 shows raw data while Image 2 shows how I'd like the data to be formatted, but without doing it manually.</p>\n\n<p><img src=\"https://i.stack.imgur.com/M3iql.gif\" alt=\"Pre\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/bybO4.gif\" alt=\"Post\"></p>\n"}, {"tags": ["vba", "excel", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 539, "user_id": 5692465, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/205519d92de8094ef8f12f4e66150aa2?s=128&d=identicon&r=PG&f=1", "display_name": "PKatona", "link": "https://stackoverflow.com/users/5692465/pkatona"}, "is_accepted": true, "score": 0, "last_activity_date": 1508974825, "creation_date": 1508974825, "answer_id": 46943646, "question_id": 46943463, "link": "https://stackoverflow.com/questions/46943463/excel-macro-for-counting-items-in-outlook-shared-inbox-by-date/46943646#46943646", "title": "Excel Macro for Counting Items in Outlook Shared inbox by Date", "body": "<p>Do the following:</p>\n\n<pre><code>Dim inItem As Outlook.MailItem\niCount = 0\nFor Each inItem In olFldr.Items\n    iCount = iCount + 1\n    With inItem\n        ReDim Preserve arrEmailDates(iCount - 1)\n        arrEmailDates(iCount - 1) = DateSerial(Year(.ReceivedTime), Month(.ReceivedTime), Day(.ReceivedTime))\n    End With\nNext inItem\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8834457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0012ba271aeed8d17d63b50b37f90bb4?s=128&d=identicon&r=PG&f=1", "display_name": "Cgitlin", "link": "https://stackoverflow.com/users/8834457/cgitlin"}, "edited": false, "score": 0, "creation_date": 1509035891, "post_id": 46944239, "comment_id": 80866453, "body": "This is all great information!  I&#39;ll use the new methods to rewrite this later to be more efficient. Thank you."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1508979760, "creation_date": 1508979760, "answer_id": 46944239, "question_id": 46943463, "link": "https://stackoverflow.com/questions/46943463/excel-macro-for-counting-items-in-outlook-shared-inbox-by-date/46944239#46944239", "title": "Excel Macro for Counting Items in Outlook Shared inbox by Date", "body": "<p>In general, I'd recommend using the <a href=\"http://msdn.microsoft.com/en-us/library/ff869662.aspx\" rel=\"nofollow noreferrer\">Find</a>/<a href=\"http://msdn.microsoft.com/en-us/library/ff862482.aspx\" rel=\"nofollow noreferrer\">FindNext</a> or <a href=\"http://msdn.microsoft.com/en-us/library/ff869597.aspx\" rel=\"nofollow noreferrer\">Restrict</a> methods instead of iterating over all items in the folder. Read more about these methods in the following articles:</p>\n\n<ul>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/20/outlook-find-findnext-retrieve-mail/\" rel=\"nofollow noreferrer\">How To: Use Find and FindNext methods to retrieve Outlook mail items from a folder (C#, VB.NET)</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/23/outlook-restrict-method-retrieve-mail/\" rel=\"nofollow noreferrer\">How To: Use Restrict method to retrieve Outlook mail items from a folder</a></li>\n<li><a href=\"https://www.add-in-express.com/creating-addins-blog/2011/09/27/outlook-get-unread-items/\" rel=\"nofollow noreferrer\">How To: Get unread Outlook e-mail items from the Inbox folder</a></li>\n</ul>\n\n<blockquote>\n  <p>Now my problem is I get Run-time error '438': Object doesn't support this property or method.</p>\n</blockquote>\n\n<p>The fact is that Outlook folder may contain different item types - mails, notes, calendar items and etc. So, most probably you are dealing with an item type which doesn't have properties specified in the code. In the loop I'd suggest the item type first and then deal with its properties. See <a href=\"https://stackoverflow.com/questions/78924/when-is-a-mailitem-not-a-mailitem\">When is a MailItem not a MailItem?</a> fore more information. </p>\n"}], "owner": {"reputation": 3, "user_id": 8834457, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0012ba271aeed8d17d63b50b37f90bb4?s=128&d=identicon&r=PG&f=1", "display_name": "Cgitlin", "link": "https://stackoverflow.com/users/8834457/cgitlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1919, "favorite_count": 0, "accepted_answer_id": 46943646, "answer_count": 2, "score": 0, "last_activity_date": 1509557477, "creation_date": 1508973455, "last_edit_date": 1509557477, "question_id": 46943463, "link": "https://stackoverflow.com/questions/46943463/excel-macro-for-counting-items-in-outlook-shared-inbox-by-date", "title": "Excel Macro for Counting Items in Outlook Shared inbox by Date", "body": "<p>I'm trying to write a Macro in Excel for one of our teams to count the number of items in specific shared Outlook mail folders by date and present the counts in Excel. </p>\n\n<p>So far, I've been able to get a count to work on my personal inbox (different code for retrieving the mailbox) and I've been able access the shared mailbox folders to get a total count of items available (retrieving mailboxes using the code below). </p>\n\n<p>Now my problem is I get Run-time error '438': Object doesn't support this property or method. </p>\n\n<p>I've tracked it down to the array section of the code that uses iCount.  </p>\n\n<p>Any direction on where to look for a reference or help with the code would be greatly appreciated. </p>\n\n<pre><code>Sub HowManyDatedEmails()\n\n' Set Variables\nDim EmailCount As Integer, DateCount As Integer, iCount As Integer\nDim myDate As Date\nDim arrEmailDates()\n\nDim olApp As Outlook.Application\nDim olNS As Outlook.NameSpace\nDim olFldr As Outlook.MAPIFolder\nDim olItem As Object\nDim olMailItem As Outlook.MailItem\n\n'Call Folder\nSet olApp = New Outlook.Application\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet olFldr = olNS.Folders(\"delivery quality team\")\nSet olFldr = olFldr.Folders(\"Inbox\")\n\n\n' Put ReceivedTimes in array\nEmailCount = olFldr.Items.Count\nFor iCount = 1 To EmailCount\n    With olFldr.Items(iCount)\n        ReDim Preserve arrEmailDates(iCount - 1)\n        arrEmailDates(iCount - 1) = DateSerial(Year(.ReceivedTime), Month(.ReceivedTime), Day(.ReceivedTime))\n    End With\nNext iCount\n\n' Clear Outlook objects\nSet olFldr = Nothing\nSet olNS = Nothing\nSet olApp = Nothing\n\n' Count the emails dates equal to active cell\nSheets(\"Count_Data\").Range(\"A2\").Select\nDo Until IsEmpty(ActiveCell)\n\n    DateCount = 0\n    myDate = ActiveCell.Value\n\n    For i = 0 To UBound(arrEmailDates) - 1\n        If arrEmailDates(i) = myDate Then DateCount = DateCount + 1\n    Next i\n\n    Selection.Offset(0, 1).Activate\n    ActiveCell.Value = DateCount\n    Selection.Offset(1, -1).Activate\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1508971957, "post_id": 46943020, "comment_id": 80833893, "body": "How do you get to that line? It looks like you&#39;re in a loop in the first 5 lines of DeleteESDChildren. No?"}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "reply_to_user": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1508972712, "post_id": 46943020, "comment_id": 80834131, "body": "I edited it so that all irrelevant code to the error is not in the function including that loop. Should be more clear to follow now."}, {"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1508975266, "post_id": 46943020, "comment_id": 80834845, "body": "Fwiw, i might start with <code>If rst_Del.EOF Then Exit Sub</code> then MoveLast and get the recordcount to make sure you have some rows."}, {"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "edited": false, "score": 0, "creation_date": 1508975534, "post_id": 46943020, "comment_id": 80834912, "body": "A few more good ideas to follow here: <a href=\"http://allenbrowne.com/ser-29.html\" rel=\"nofollow noreferrer\">allenbrowne.com/ser-29.html</a>."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 1, "creation_date": 1508981434, "post_id": 46943020, "comment_id": 80836292, "body": "is there any reason why you do not use a SQL <code>delete</code> query instead of the <code>select</code> query to delete the related ESDnodes ?   .... then run another delete query to remove the scenario record."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1508985298, "post_id": 46943020, "comment_id": 80837224, "body": "Please post screenshot of your relationships diagram (Ribbon &gt; Database Tools &gt; Relationships), focused on <i>ESDnodes</i>."}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1509389848, "post_id": 46943020, "comment_id": 80991744, "body": "@Parfait I am sorry it took a while but I have now posted a screenshot of my relationships diagram."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1509391587, "post_id": 46943020, "comment_id": 80992612, "body": "Interesting, you have quite a bit of links to <i>ESINodes</i> and what looks to be the same table referential integrity. It looks like <i>FTNodes</i> is a child table, so you have to delete all corresponding rows there first before deleting from <i>ESINodes</i>. But <i>ESINode_1</i> may also be a problem."}, {"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1509391804, "post_id": 46943020, "comment_id": 80992719, "body": "if you&#39;re enforcing cascade delete between <code>scenarios</code> and <code>esdNodes</code>, all you should have to do is delete the parent row from the <code>scenarios</code> table."}, {"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 1, "creation_date": 1509391889, "post_id": 46943020, "comment_id": 80992764, "body": "also, fyi, it&#39;s easier to read relationship diagrams if the &#39;1&#39; tables are to the left, &#39;many&#39; tables to the right, so you see parents on the left and related children to the parent&#39;s right."}, {"owner": {"reputation": 9337, "user_id": 137508, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2901ad5dee18873961c18562be3b3a72?s=128&d=identicon&r=PG", "display_name": "Beth", "link": "https://stackoverflow.com/users/137508/beth"}, "edited": false, "score": 0, "creation_date": 1509392088, "post_id": 46943020, "comment_id": 80992867, "body": "when you delete an <code>esdNodeID</code>, you&#39;ll also need to delete related IDs from <code>ftNodes</code>."}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "edited": false, "score": 0, "creation_date": 1509392993, "post_id": 46943020, "comment_id": 80993242, "body": "I am already deleting all related FTNodes and ESDNodes. I did not demonstrate this in the code I have posted here so as not to add clutter but that part is well tested and am confident that it is working. Furthermore, I am getting this error in the simplest case in which a Scenario refers to a singular ESDNode which has no other ESDNodes children or FTNodes."}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "edited": false, "score": 0, "creation_date": 1509395056, "post_id": 46943020, "comment_id": 80994209, "body": "My issue was that loadESDTreeView was recreating the record that was just deleted."}], "answers": [{"comments": [{"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "edited": false, "score": 0, "creation_date": 1508972414, "post_id": 46943275, "comment_id": 80834051, "body": "That line is for deleting the children of that ESDNode. In other words there is a 1 to many relationship for ESDNodes to other ESDNodes. But I am testing the code with the simplest test case where it is just one ESDNode with no children so that recordset will be empty and that loop will not enter."}, {"owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "edited": false, "score": 0, "creation_date": 1508972463, "post_id": 46943275, "comment_id": 80834067, "body": "I suppose I can comment that code out so as not to confuse anybody"}, {"owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "reply_to_user": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "edited": false, "score": 0, "creation_date": 1508975109, "post_id": 46943275, "comment_id": 80834805, "body": "ah i see what u did there."}], "tags": [], "owner": {"reputation": 3895, "user_id": 1171702, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/41d229f0cb9239e712ce687707b4c7f7?s=128&d=identicon&r=PG", "display_name": "wazz", "link": "https://stackoverflow.com/users/1171702/wazz"}, "is_accepted": false, "score": 0, "last_activity_date": 1508972200, "creation_date": 1508972200, "answer_id": 46943275, "question_id": 46943020, "link": "https://stackoverflow.com/questions/46943020/deleting-record-from-table-is-not-actually-deleting-vba-access/46943275#46943275", "title": "Deleting record from table is not actually deleting VBA Access", "body": "<p>Looks like you're in a loop.</p>\n\n<pre><code>Public Function DeleteESDChildren(lngID As Long)\n    Dim rst As Recordset\n    'find the children of the node\n    Set rst = CurrentDb.OpenRecordset(\"SELECT * FROM ESDNodes WHERE ParentID = \" &amp; lngID)\n\n    'call deletechildren on each child in turn\n    While Not rst.EOF\n        DeleteESDChildren (rst!ESDNodeID) '&lt;-- goes back to the beginning.\n        rst.MoveNext\n    Wend\n    etc.\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1509403492, "last_edit_date": 1509403492, "creation_date": 1508982442, "answer_id": 46944595, "question_id": 46943020, "link": "https://stackoverflow.com/questions/46943020/deleting-record-from-table-is-not-actually-deleting-vba-access/46944595#46944595", "title": "Deleting record from table is not actually deleting VBA Access", "body": "<p>This can be achieved using SQL</p>\n\n<pre><code>CurrentDb.Execute \"DELETE * FROM ESDNodes WHERE ESDNodeID = \" &amp; lngID\n</code></pre>\n"}], "owner": {"reputation": 653, "user_id": 7254514, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/713bdcd9918ad0f7168a58281fe85046?s=128&d=identicon&r=PG&f=1", "display_name": "Luca Guarro", "link": "https://stackoverflow.com/users/7254514/luca-guarro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1509403492, "creation_date": 1508970592, "last_edit_date": 1509389818, "question_id": 46943020, "link": "https://stackoverflow.com/questions/46943020/deleting-record-from-table-is-not-actually-deleting-vba-access", "title": "Deleting record from table is not actually deleting VBA Access", "body": "<p>I have a table called Scenarios that has a 1 to many relationship with ESDNodes. There can be multiple ESDNodes that reference a single Scenario.</p>\n\n<p>For every Scenario there must be at least one ESDNode which means that when a scenario is to be deleted, all of its related ESDNodes must then be deleted.</p>\n\n<p>So when the user selects a scenario and attempts to delete it, this function is called:</p>\n\n<pre><code>Private Sub Form_Delete(Cancel As Integer)\n  Dim scenID As Long\n  Dim ESDHeadNodeID As Long\n  Dim response As Long\n  Dim style As Long\n\n  scenID = Forms!Main!Scenarios!ScenarioID\n  ESDHeadNodeID = DLookup(\"ESDNodeID\", \"ESDNodes\", \"((ESDNodes.ESDNodeType)=1) AND ((ESDNodes.ScenarioID) = \" &amp; scenID &amp; \")\")\n\n  style = vbYesNoCancel + vbQuestion\n  response = MsgBox(\"Are you sure you wish to delete all selected nodes and their children?\", style)\n  If response = vbYes Then\n     DeleteESDChildren (ESDHeadNodeID)\n     loadESDTreeView\n  End If\nEnd Sub\n</code></pre>\n\n<p>In DeleteESDChildren is where I handle deleting all relevant ESDNodes. I removed all code that is irrelevant to the error in this function. \nHere is that function:</p>\n\n<pre><code>Public Function DeleteESDChildren(lngID As Long)\n  Dim rst_Del As Recordset\n  Set rst_Del = CurrentDb.OpenRecordset(\"SELECT * FROM ESDNodes WHERE ESDNodeID = \" &amp; lngID)\n\n  rst_Del.MoveFirst\n\n  'Delete the head node\n  If Not rst_Del.EOF Then\n     rst_Del.Delete \n  End If\nEnd Function\n</code></pre>\n\n<p>I tested this code with the simplest case where there is only one ESDNode for a scenario and the ESDNode has no children. The line that calls rst_Del.Delete, I expect to delete this singular ESDNode. But instead I get an error when the Form_Delete attempts to End Sub claiming \"The record cannot be deleted or changed because table 'ESDNodes' includes related records.\" So this singular ESDNode is not getting deleted.</p>\n\n<p>Screenshot showing the relationships between my tables\n<a href=\"https://i.stack.imgur.com/oijyj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oijyj.png\" alt=\"Screenshot showing the relationships between my tables\"></a></p>\n"}, {"tags": ["vba", "excel", "filter"], "comments": [{"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1508971483, "post_id": 46942951, "comment_id": 80833754, "body": "I&#39;m not really sure what you&#39;re asking here... Please refer to <a href=\"https://stackoverflow.com/help/how-to-ask\">how-to-ask</a>. If you&#39;d like help with your code, we&#39;re more than willing to help you out, we do not however provide code"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1508975069, "post_id": 46942951, "comment_id": 80834797, "body": "Line <code>If Len(Trim(.Range(&quot;A&quot; &amp; x).Value)) 1&lt;3 Then</code> contains a syntax error. Are you looking for rows with text lengths smaller than 3? If so, try <code>If Len(Trim(.Range(&quot;A&quot; &amp; x).Value)) &lt; 3 Then</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8780811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5310d35d02ba2b81bb246ccbe6e562b9?s=128&d=identicon&r=PG&f=1", "display_name": "Learner", "link": "https://stackoverflow.com/users/8780811/learner"}, "is_accepted": false, "score": 0, "last_activity_date": 1509032365, "creation_date": 1509032365, "answer_id": 46958466, "question_id": 46942951, "link": "https://stackoverflow.com/questions/46942951/filter-table-by-column-filter-filter-between-number-range-output-n/46958466#46958466", "title": "Filter Table by Column. (Filter --&gt; Filter Between--&gt; Number Range) --&gt; Output New Table", "body": "<p>Figured it out. This is for a model with numbers, not text values. I think there is some inefficiency in the code, but it does work. Main issue is just it uses two sheets instead of creating a new table on same sheet. \nD2/D3 are cell reference numbers, and G is the column. </p>\n\n<p>Sub MaturityRange()</p>\n\n<p>Dim ws As Worksheet\nDim Model As Worksheet</p>\n\n<p>Set ws = ThisWorkbook.Sheets(\"Output\")\nSet One = ThisWorkbook.Sheets(\"Model\")</p>\n\n<p>If Not IsEmpty(One.Range(\"D2\")) And Not IsEmpty(One.Range(\"D3\")) Then\n    With ws\n        .Range(\"$G$7:$G$\" &amp; .Range(\"G\" &amp; Rows.Count).End(xlUp).Row).AutoFilter Field:=1, _\n            Criteria1:=\">\" &amp; One.Range(\"D2\").Value, _\n            Operator:=xlAnd, _\n            Criteria2:=\"&lt;\" &amp; One.Range(\"D3\").Value\n    End With\nEnd If</p>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 8780811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5310d35d02ba2b81bb246ccbe6e562b9?s=128&d=identicon&r=PG&f=1", "display_name": "Learner", "link": "https://stackoverflow.com/users/8780811/learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1509061127, "creation_date": 1508970121, "last_edit_date": 1509061127, "question_id": 46942951, "link": "https://stackoverflow.com/questions/46942951/filter-table-by-column-filter-filter-between-number-range-output-n", "title": "Filter Table by Column. (Filter --&gt; Filter Between--&gt; Number Range) --&gt; Output New Table", "body": "<p>I am trying to use VBA to filter a table by  column's values, and then have a new table (filtered) be output on worksheet, but a new area .Note I want to cell reference the range numbers. </p>\n\n<p>On the fake excel table below. I want to filter for range for column 'age'. I.e. filter --> age --> between 1-3 (cell reference). First table is raw data. Second is what I would like as output using VBA. </p>\n\n<p>I tried fitting the code below to my desired output. It is missing data not relevant to the column itself (taking full columns) </p>\n\n<p>Image of raw data and desired output below\n<a href=\"https://i.stack.imgur.com/XI0xR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XI0xR.png\" alt=\"Image\"></a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/9790924/excel-vba-how-to-select-rows-based-on-data-in-a-column\">Excel VBA, How to select rows based on data in a column?</a></p>\n\n<pre><code>Option Explicit\nSub tablefilter()\n    Dim lastRow As Long, x As Long\n    Dim lasColumn As Long, i = 4 \n    Dim CopyRange As Range\n\n    With Sheets(\"Sheet1\")\n        lastRow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n\n        For x = 1 To lastRow\n            If Len(Trim(.Range(\"A\" &amp; x).Value)) 1&lt;3 Then\n                If CopyRange Is Nothing Then\n                    Set CopyRange = .Rows(i)\n                Else\n                    Set CopyRange = Union(CopyRange, .Rows(x))\n                End If\n            End If\n        Next\n        If Not CopyRange Is Nothing Then\n            CopyRange.Copy Sheets(\"Sheet2\").Rows(1)\n        End If\n    End With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508970157, "post_id": 46942926, "comment_id": 80833306, "body": "Sorry should have probably said, what am I doing incorrectly?"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508970269, "post_id": 46942958, "comment_id": 80833343, "body": "See thats what I thought too but then I got an error message about it being a merged cell. Maybe I mistyped something. Let me try that quick,"}, {"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508971171, "post_id": 46942958, "comment_id": 80833652, "body": "So the good news is no merged cell error, the bad news the text was still there when we printed. So im going to try other code snipped and see what happens."}, {"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "reply_to_user": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508972196, "post_id": 46942958, "comment_id": 80833975, "body": "I think you&#39;ve already spotted it, but yes you need to move the code up in the macro to execute before the Print :)"}, {"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508972547, "post_id": 46942958, "comment_id": 80834083, "body": "I also figured out that text in the cell was in quotations. Literally in quotations and so the code was trying to find the text without quotations so i removed them from the cell and it worked perfectly."}, {"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "reply_to_user": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508973892, "post_id": 46942958, "comment_id": 80834478, "body": "Nice! Glad you got it sorted!"}], "tags": [], "owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "is_accepted": true, "score": 2, "last_activity_date": 1508970175, "creation_date": 1508970175, "answer_id": 46942958, "question_id": 46942926, "link": "https://stackoverflow.com/questions/46942926/quick-and-easy-macro-to-delete-a-single-cell-based-on-text-criteria/46942958#46942958", "title": "Quick and easy macro to delete a single cell based on text criteria.", "body": "<p>You could do the following. Just reference the top left of the merged range and set the value to \"\"</p>\n\n<pre><code>    If Range(\"B15\").Value = \"Enter and special posting instruction here.\" Then\n          Range(\"B15\").Value = \"\"\n    End If\n</code></pre>\n\n<p>Hope that helps</p>\n\n<p>Caleeco</p>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508970624, "post_id": 46943016, "comment_id": 80833468, "body": "We&#39;re testing Calicos snippet right now on multiple computers. Looks like its working but I want to make sure first."}, {"owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "reply_to_user": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508971435, "post_id": 46943016, "comment_id": 80833742, "body": "Yes, his will work just fine also - I didn&#39;t see it when I posted mine. Your only problem was the first B15:E19, you only need B15 and you do not need to select the cell first as your code did. Also, it looks like you should add this before the print command."}, {"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508971532, "post_id": 46943016, "comment_id": 80833768, "body": "OMG I feel like such an idiot. Thats why its not working. Im executing it after the print command."}], "tags": [], "owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "is_accepted": false, "score": 2, "last_activity_date": 1508970561, "creation_date": 1508970561, "answer_id": 46943016, "question_id": 46942926, "link": "https://stackoverflow.com/questions/46942926/quick-and-easy-macro-to-delete-a-single-cell-based-on-text-criteria/46943016#46943016", "title": "Quick and easy macro to delete a single cell based on text criteria.", "body": "<p>How About:</p>\n\n<pre><code>    If Range(\"B15\") = \"Enter and special posting instruction here.\" Then\n        Range(\"B15:E19\").ClearContents\n    End If\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 46942958, "answer_count": 2, "score": 2, "last_activity_date": 1508970561, "creation_date": 1508969917, "last_edit_date": 1531161705, "question_id": 46942926, "link": "https://stackoverflow.com/questions/46942926/quick-and-easy-macro-to-delete-a-single-cell-based-on-text-criteria", "title": "Quick and easy macro to delete a single cell based on text criteria.", "body": "<p>i just need to delete a single cell using a button.</p>\n\n<p>So I am working on a project where by the user just hits a button and the spreadsheet prints based on the amount of data they put in. However we have one merged cell where they can put data in but if they dont enter any data, we need the cell to be empty. The snipped of code im using is below. The entire project is below that snippet for reference.</p>\n\n<pre><code>Range(\"B15:E19\").Select\n        If Range(\"B15:E19\") = \"Enter and special posting instruction here.\" Then\n        Range(\"B15:E19\").ClearContents\n        End If\n</code></pre>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub LastRowInOneColumn()\n\n    Dim MySheet As Worksheet\n    Set MySheet = Worksheets(\"SIF Sheet\")\n\n    With MySheet\n\n        Dim xLastRow As Long\n        xLastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n        Select Case True\n\n            Case xLastRow &gt; 21 And xLastRow &lt; 46\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=1\n\n            Case xLastRow &gt; 46 And xLastRow &lt; 97\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=2\n\n            Case xLastRow &gt; 98 And xLastRow &lt; 149\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=3\n\n            Case xLastRow &gt; 150 And xLastRow &lt; 201\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=4\n\n            Case xLastRow &gt; 202 And xLastRow &lt; 253\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=5\n\n            Case xLastRow &gt; 254 And xLastRow &lt; 305\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=6\n\n            Case xLastRow &gt; 306 And xLastRow &lt; 357\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=7\n\n            Case xLastRow &gt; 358 And xLastRow &lt; 409\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=8\n\n            Case xLastRow &gt; 410 And xLastRow &lt; 461\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=9\n\n            Case xLastRow &gt; 462 And xLastRow &lt; 513\n\n                'Application.Dialogs(xlDialogPrinterSetup).Show\n                Worksheets(\"SIF Sheet\").PrintOut From:=1, To:=10\n\n        End Select\n\n\n\n\n    End With\n\n        Range(\"B15:E19\").Select\n        If Range(\"B15:E19\") = \"Enter and special posting instruction here.\" Then\n        Range(\"B15:E19\").ClearContents\n        End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "date", "datetime"], "answers": [{"comments": [{"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508970644, "post_id": 46942973, "comment_id": 80833477, "body": "Patrick that worked great!! However, I wanted to ask you one question... The dates in E column are in text format but the NOW dates are in number format. When I run the macro the result is printed correctly... Do you thinnk that in the future it will have bugs or there will be no problem since I use numberformat after the difference?"}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1508971315, "post_id": 46942973, "comment_id": 80833710, "body": "If the answer is correct, please mark it as &quot;Answered&quot; by clicking the great check mark under the voting option"}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": true, "score": 2, "last_activity_date": 1508971256, "last_edit_date": 1508971256, "creation_date": 1508970293, "answer_id": 46942973, "question_id": 46942907, "link": "https://stackoverflow.com/questions/46942907/find-the-difference-in-hours-and-minutes-of-two-dates-with-format-dd-mm-yyyy-hh/46942973#46942973", "title": "Find the difference in hours and minutes of two dates with format dd/mm/yyyy hh:mm", "body": "<p>You can use the square brackets to force the overflowed values back to it.</p>\n\n<pre><code>.NumberFormat = \"[h]:mm:ss\"\n</code></pre>\n\n<p><strong>EDIT</strong> (for the question in comment):<br>\nExcel is smart enough that when a formula is using cell references, it will attempt to convert accordingly.</p>\n\n<p>Alternatively, you can try:</p>\n\n<pre><code>With ws1.Range(\"N2:N\" &amp; lastrow1)\n    .Formula = \"=NOW()-(DateValue(E2)+TimeValue(E2))\"\n    .NumberFormat = \"[h]:mm:ss\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "accepted_answer_id": 46942973, "answer_count": 1, "score": 2, "last_activity_date": 1508971256, "creation_date": 1508969817, "question_id": 46942907, "link": "https://stackoverflow.com/questions/46942907/find-the-difference-in-hours-and-minutes-of-two-dates-with-format-dd-mm-yyyy-hh", "title": "Find the difference in hours and minutes of two dates with format dd/mm/yyyy hh:mm", "body": "<p>I have been trying to find the difference in hours and minutes between 2 dates with format dd/mm/yyyy hh:mm. The code I am using works (kind of) fine but it does not take into consideration the difference in days. So, if the first date 28/09/2017 11:35 and the second one is 30/09/2017 13:45 then, it will say that the difference is 02:10 . But, the correct answer is 50:10 (50 hours and 10 minutes). I am providing the code below.</p>\n\n<pre><code>With ws1.Range(\"N2:N\" &amp; lastrow1)\n  .Formula = \"=NOW()-E2\"\n  .NumberFormat = \"h:mm:ss\"\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8834200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GZbTH.jpg?s=128&g=1", "display_name": "TrCCper", "link": "https://stackoverflow.com/users/8834200/trccper"}, "edited": false, "score": 0, "creation_date": 1509034495, "post_id": 46946005, "comment_id": 80865616, "body": "This worked perfect! I am running in to another issue now though where the object isn&#39;t found unless the slide is preexisting. If I create the slide first it works great but if I try to do it from VBA from the same click event I get the error &quot;Run-time error &#39;1004&#39;: Unable to get the Object property of the OLEObject class.&quot; I believe the code is running all at once and not finding the new slide yet. Is there a way to have the slide copied first, then input the values from a single button click?"}, {"owner": {"reputation": 23, "user_id": 8834200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GZbTH.jpg?s=128&g=1", "display_name": "TrCCper", "link": "https://stackoverflow.com/users/8834200/trccper"}, "edited": false, "score": 0, "creation_date": 1509068703, "post_id": 46946005, "comment_id": 80880094, "body": "I&#39;m sorry, I don&#39;t think I explained myself well enough. I can write code to insert a slide. That isn&#39;t the issue. I have code that copies an existing worksheet with a PowerPoint slide already embedded. I just need to add text to existing text boxes within the slide. I did it this way because the template I am copying has formatting already. i.e: font, size, header and footer, date box, 4 separate informational boxes and their placement location on the slide. I&#39;m thinking that the error results from trying to copy the slide, rename it AND input text from a single &quot;cmdOK&quot; button click."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "reply_to_user": {"reputation": 23, "user_id": 8834200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GZbTH.jpg?s=128&g=1", "display_name": "TrCCper", "link": "https://stackoverflow.com/users/8834200/trccper"}, "edited": false, "score": 0, "creation_date": 1509074201, "post_id": 46946005, "comment_id": 80881293, "body": "just to confirm, it is a slide, not a presentation. is that correct? ....  why are you copying the slide? that part is not clear to me because you said that the worksheet has an embedded powerpoint (slide/presentation)"}, {"owner": {"reputation": 23, "user_id": 8834200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GZbTH.jpg?s=128&g=1", "display_name": "TrCCper", "link": "https://stackoverflow.com/users/8834200/trccper"}, "edited": false, "score": 0, "creation_date": 1509114730, "post_id": 46946005, "comment_id": 80902432, "body": "Yes, it is in fact a slide, and not a presentation. Within the excel workbook there are two worksheets. One is named &quot;Directory&quot; and the other is &quot;Slide Template&quot;. &quot;Slide Template&quot; has a PPslide embedded. This slide is formatted to my liking. When the command button &quot;Add Slide&quot; is clicked on the userform I created, the text boxes input into the &quot;Directory&quot; so it&#39;s content is searchable. This command button also creates a copy of the sheet &quot;Slide Template&quot; and renames it. I&#39;d also like the same command button to take text box input from the userform and edit the new sheet that was just created."}], "tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": true, "score": 0, "last_activity_date": 1509065343, "last_edit_date": 1509065343, "creation_date": 1508993044, "answer_id": 46946005, "question_id": 46942902, "link": "https://stackoverflow.com/questions/46942902/how-can-i-edit-a-powerpoint-presentation-embedded-in-excel-using-excel-vba-and-u/46946005#46946005", "title": "How can I edit a PowerPoint presentation embedded in Excel using Excel VBA and userform", "body": "<p>here is some code that inserts a powerpoint slide, adds text to it and also reads the text back</p>\n\n<p>if you only need one slide, then this is for you</p>\n\n<pre><code>Option Explicit\n\nSub testPPslide()\n\n    ' NOTE: this adds a slide everytime the code is run\n    ' it will be the standard \"click here to add title\" slide\n\n    Worksheets(\"Sheet1\").Range(\"c1:d1\") = \"\"\n\n    Dim pps As OLEObject\n\n    Set pps = Worksheets(\"Sheet1\").OLEObjects.Add( _\n            ClassType:=\"PowerPoint.Slide.12\", _\n            Link:=False, _\n            DisplayAsIcon:=False)\n\n'   pps.Verb Verb:=xlOpen                     ' this edits slide in standalone PP app\n'   pps.Verb Verb:=xlPrimary                  ' this one opens PP in excel\n    pps.Top = 40\n    pps.Left = 60\n\n    Dim ps As powerpoint.Slide\n    Set ps = pps.Object\n\n    ps.Shapes(1).TextFrame.TextRange.Text = \"cccccccccc\"\n    ps.Shapes(2).TextFrame.TextRange.Text = \"this works\"\n\n    Worksheets(\"Sheet1\").Range(\"c1\") = ps.Shapes(1).TextFrame.TextRange.Text\n    Worksheets(\"Sheet1\").Range(\"d1\") = ps.Shapes(2).TextFrame.TextRange.Text\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1509064818, "last_edit_date": 1509064818, "creation_date": 1508994799, "answer_id": 46946271, "question_id": 46942902, "link": "https://stackoverflow.com/questions/46942902/how-can-i-edit-a-powerpoint-presentation-embedded-in-excel-using-excel-vba-and-u/46946271#46946271", "title": "How can I edit a PowerPoint presentation embedded in Excel using Excel VBA and userform", "body": "<p>this one works on presentations</p>\n\n<p>example code</p>\n\n<pre><code>Option Explicit\n\n\nSub testPPpresentation()\n\n    ' NOTE: adds a PP presentation to the worksheet each time it is run\n\n    Worksheets(\"Sheet1\").Range(\"c1:d1\") = \"\"\n\n    Dim aaa As OLEObject\n    Set aaa = Worksheets(\"Sheet1\").OLEObjects.Add( _\n                ClassType:=\"PowerPoint.Show.12\", _\n                Link:=False, _\n                DisplayAsIcon:=False)\n\n'   aaa.Verb Verb:=xlOpen       ' this edits the presentation in standalone PP app\n'   aaa.Verb Verb:=xlPrimary    ' this one edits the presentation in excel\n\n    aaa.Top = 90\n    aaa.Left = 60\n\n    Dim ppp As PowerPoint.Presentation\n    Set ppp = aaa.Object\n\n    ppp.Slides(1).Shapes(1).TextFrame.TextRange.Text = \"cccccccccc\"\n    ppp.Slides(1).Shapes(2).TextFrame.TextRange.Text = \"this works\"\n\n    Worksheets(\"Sheet1\").Range(\"c1\") = ppp.Slides(1).Shapes(1).TextFrame.TextRange.Text\n    Worksheets(\"Sheet1\").Range(\"d1\") = ppp.Slides(1).Shapes(2).TextFrame.TextRange.Text\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8834200, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GZbTH.jpg?s=128&g=1", "display_name": "TrCCper", "link": "https://stackoverflow.com/users/8834200/trccper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1171, "favorite_count": 0, "accepted_answer_id": 46946005, "answer_count": 2, "score": 2, "last_activity_date": 1509065343, "creation_date": 1508969798, "last_edit_date": 1509011428, "question_id": 46942902, "link": "https://stackoverflow.com/questions/46942902/how-can-i-edit-a-powerpoint-presentation-embedded-in-excel-using-excel-vba-and-u", "title": "How can I edit a PowerPoint presentation embedded in Excel using Excel VBA and userform", "body": "<p>I am building a database with information on a large collection of product designs. I chose to use an Excel file with userform input for the design details so as to easily filter by detail, then select a link to the corresponding page that contains an embedded PowerPoint with photos and design notes. At the moment I have a template that copies into a new tab, renames and creates a link to the tab in a directory based on text box input of part number. I might be asking too much but I'd also like the userform to add text to preexisting text boxes within the PowerPoint presentation. Everything up to this point works rather well.</p>\n\n<p>I found a similar question and tried my hand at coding several times.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/124375/editing-embedded-powerpoint-from-excel-vba\">Editing Embedded PowerPoint from Excel VBA</a></p>\n\n<p>It was helpful in understanding but it didn't work for me in this context:</p>\n\n<pre><code>Private Sub cmdAddSlide_Click()\n\n    template = \"Slide Template\"\n\n    'Hide the sheet\n    ufrmAddSlide.Hide\n\n    'Copy the template to create a new sheet.\n    Sheets(template).Select\n    Sheets(template).Copy After:=Sheets(Sheets.Count)\n\n    'Make the sheet visible in case the template is hidden.\n    ActiveSheet.Visible = xlSheetVisible\n\n    'Rename the sheet.\n    ActiveSheet.Name = txtPartNumber\n\n    'Add data to powerpoint object.\n    Worksheets(Me.txtPartNumber.Value).Shapes(\"Object 1\").Select \n    Selection.Verb Verb:=xlOpen\n    Dim p As PowerPoint.Presentation\n    Set p = Selection.Object\n    ActivePresentation.Slides(1).Shapes(\"operationaltext1\").TextFrame.TextRange.Text = Me.txtPartNumber.Value\n    [a1].Select\n\n    'Bring main sheet back to front if necessary.\n    If chkBringToFront = False Then\n        Sheets(\"Directory\").Select\n    End If\n\n    'Copy input values to sheet.\n    Dim lRow As Long\n    Dim ws As Worksheet\n    Set ws = Worksheets(\"Directory\")\n    lRow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n    With ws    \n        'Create a link to the part design page with the part number text.\n        ActiveSheet.Hyperlinks.Add Anchor:=.Cells(lRow, 1), Address:=\"\", \n        SubAddress:=Me.txtPartNumber.Value &amp; \"!A1\", \n        TextToDisplay:=Me.txtPartNumber.Value\n        .Cells(lRow, 1).Value = Me.txtPartNumber.Value\n        .Cells(lRow, 2).Value = Me.txtCustomer.Value\n        .Cells(lRow, 3).Value = Me.cboSkydrol.Value\n        .Cells(lRow, 4).Value = Me.cboPneumatic.Value\n        .Cells(lRow, 5).Value = Me.cboFuel.Value\n        .Cells(lRow, 6).Value = Me.cboRedOil.Value\n        .Cells(lRow, 7).Value = Me.cboSpace.Value\n        .Cells(lRow, 8).Value = Me.cboStyle.Value\n        .Cells(lRow, 9).Value = Me.txtWeight.Value\n        .Cells(lRow, 10).Value = Me.txtMaxPressure.Value\n        .Cells(lRow, 11).Value = Me.txtOperatingPressure.Value\n        .Cells(lRow, 12).Value = Me.txtProofPressure.Value\n        .Cells(lRow, 13).Value = Me.txtBurstPressure.Value\n        .Cells(lRow, 14).Value = Me.txtAmbientTemperature.Value\n        .Cells(lRow, 15).Value = Me.txtFluidTemperature.Value\n        .Cells(lRow, 16).Value = Me.txtPullIn.Value\n        .Cells(lRow, 17).Value = Me.txtDropOut.Value\n        .Cells(lRow, 18).Value = Me.txtCoilResistance.Value\n        .Cells(lRow, 19).Value = Me.txtLeakage.Value\n        .Cells(lRow, 20).Value = Me.txtFlow.Value\n        .Cells(lRow, 21).Value = Me.txtNotes.Value\n    End With\n\n    'Clear all inputs.\n    Me.cboSkydrol.Value = \"\"\n    Me.cboPneumatic.Value = \"\"\n    Me.cboFuel.Value = \"\"\n    Me.cboRedOil.Value = \"\"\n    Me.cboSpace.Value = \"\"\n    Me.cboStyle.Value = \"\"\n    Me.txtAmbientTemperature.Value = \"\"\n    Me.txtBurstPressure.Value = \"\"\n    Me.txtCoilResistance.Value = \"\"\n    Me.txtDropOut.Value = \"\"\n    Me.txtFlow.Value = \"\"\n    Me.txtFluidTemperature.Value = \"\"\n    Me.txtLeakage.Value = \"\"\n    Me.txtMaxPressure.Value = \"\"\n    Me.txtNotes.Value = \"\"\n    Me.txtOperatingPressure.Value = \"\"\n    Me.txtPartNumber.Value = \"\"\n    Me.txtProofPressure.Value = \"\"\n    Me.txtPullIn.Value = \"\"\n    Me.txtWeight.Value = \"\"\n    Me.txtCustomer.Value = \"\"\nEnd Sub\n</code></pre>\n\n<p>The PowerPoint Presentation opened in a separate window but nothing was changed. Also, the rest of my VBA code didn't execute. Though I'm only a week into my understanding of ExcelVBA coding. So far has been just trying Frankenstein code from several sites. </p>\n\n<p>Can I do this without opening the slide in a separate window? </p>\n\n<p>I'd appreciate some input. :)</p>\n\n<p>The workbook contains worksheets \"Slide Template\" and \"Directory\".</p>\n\n<p>The PowerPoint slide is named \"Object 1\".</p>\n\n<p>The destination texbox within the slide is named \"operationaltext1\".</p>\n"}, {"tags": ["html", "vba", "forms", "excel"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1508972972, "post_id": 46942899, "comment_id": 80834218, "body": "Missing <b>Birth Date</b> id: <code>dateOfBirthInput</code> element?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1508975237, "post_id": 46942899, "comment_id": 80834838, "body": "It&#39;s not required when SSN is entered."}, {"owner": {"reputation": 387, "user_id": 7630262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a74551d0063aa3c06837041235d7d571?s=128&d=identicon&r=PG&f=1", "display_name": "T. Nesset", "link": "https://stackoverflow.com/users/7630262/t-nesset"}, "edited": false, "score": 0, "creation_date": 1508997611, "post_id": 46942899, "comment_id": 80840716, "body": "I coiped your code and only deleted <code>#If VBA7 Then</code> and <code>PtrSafe</code> since im running on VBA6.5, and it works fine for me. Submit button was grayed out until I typed into the captcha into the prompted inputbox and as soon as i pressed ok, then it submits the form."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1509001933, "post_id": 46942899, "comment_id": 80842943, "body": "Thanks for looking at it. But try removing the line <code>SubmitBtn.disabled = False</code>. I just tried this at home PC and I get slightly different results (status bar that acts like it&#39;s loading - it&#39;s not). After you enter the Captcha with that line removed the submit button would likely still be greyed out. Whatever is causing it is my issue. That line of code is really meant for debugging purposes, I am needing to still find the underlying cause that&#39;s preventing the button from being enabled - it&#39;s only enabled upon manual entry."}], "answers": [{"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 0, "last_activity_date": 1509459647, "creation_date": 1509459647, "answer_id": 47037670, "question_id": 46942899, "link": "https://stackoverflow.com/questions/46942899/html-form-will-not-submit-likely-form-validation-issues/47037670#47037670", "title": "HTML Form Will Not Submit, Likely Form Validation Issues", "body": "<p>Thanks to <a href=\"https://www.excelforum.com/excel-programming-vba-macros/1206749-html-form-will-not-submit-likely-form-validation-issues.html\" rel=\"nofollow noreferrer\">some assistance</a>, it appears that on this particular form prior to setting the text for each input object that I am required to use <code>object.setActive</code>.</p>\n\n<p>So the code would end as follows:</p>\n\n<pre><code>oSSN.setActive\noSSN.InnerText = sSSN\noSSN2.setActive\noSSN2.InnerText = sSSN\noLastName.setActive\noLastName.InnerText = sLastName\noFirstName.setActive\noFirstName.InnerText = sFirstName\nIE.document.ParentWindow.Scroll 0&amp;, 710&amp;\noCaptcha.setActive\noCaptcha.InnerText = InputBox(\"Security answer (Captcha)\")\n</code></pre>\n"}], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 47037670, "answer_count": 1, "score": 3, "last_activity_date": 1509459647, "creation_date": 1508969779, "last_edit_date": 1531164843, "question_id": 46942899, "link": "https://stackoverflow.com/questions/46942899/html-form-will-not-submit-likely-form-validation-issues", "title": "HTML Form Will Not Submit, Likely Form Validation Issues", "body": "<p>The following code works just fine when it comes to <em>completing</em> the form located on the webpage. The issue arises when it comes time to submit the form.</p>\n\n<p>This appears to be some an issue with validation, as when the form is completed systematically, the submit button is disabled. However, when I go back over the text boxes and manually type in the exact same information, the submit button then becomes available. I believe the form thinks it is incomplete, thus disabling the submit button. I even systematically reenabled this button using <code>SubmitBtn.disabled = False</code> (which allows it to be manually or systematically clicked), and it still will not submit.</p>\n\n<p>I have never encountered this type of form validation when filling in webpages.</p>\n\n<p><strong>I am currently on Internet Explorer 11</strong></p>\n\n<p><em>The following code is complete and can be tested without needing modification. This is a website that is made available to the public</em></p>\n\n<pre><code>Option Explicit\n\n#If VBA7 Then\n    Declare PtrSafe Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As LongPtr)\n#Else\n    Declare Sub Sleep Lib \"kernel32\" (ByVal dwMilliseconds As Long)\n#End If\n\nSub SCRA_Scrub()\n\n    ' #################################################\n    ' #### LATE BINDING IS REQUIRED ON ALL OBJECTS ####\n    ' #################################################\n\n    Dim IE As Object\n\n    Dim sSSN As String, sLastName As String, sFirstName As String\n    sSSN = \"123456789\"\n    sLastName = \"DOE\"\n    sFirstName = \"JOHN\"\n\n    Set IE = GetIE(\"scra.dmdc.osd.mil\") 'Already Open\n    If IE Is Nothing Then\n        Set IE = CreateObject(\"InternetExplorer.Application\")   'Not open\n        With IE\n            .Visible = True\n            .Navigate (\"https://scra.dmdc.osd.mil/scra/#/single-record\")\n        End With\n    Else    'Reset form\n        Dim ClearBtn As Object\n        Set ClearBtn = IE.document.getElementsByClassName(\"btn btn-primary\")(0)\n    End If\n    Sleep 400\n    Dim oSSN As Object, oSSN2 As Object, oLastName As Object, oFirstName As Object, SubmitBtn As Object\n    Dim oCaptcha As Object\n    Do While IE.Busy Or IE.ReadyState &lt;&gt; 4\n        DoEvents\n    Loop\n\n    'For some reason, page shows loaded when it's not. Will loop until obj\n    'becomes available\n    On Error Resume Next\n    Do Until Not oSSN Is Nothing And Not oCaptcha Is Nothing\n        Set oSSN = IE.document.getElementByID(\"ssnInput\")\n        Set oCaptcha = IE.document.getElementByID(\"recaptcha_response_field\")\n        DoEvents\n    Loop\n    On Error GoTo 0\n    Set oSSN2 = IE.document.getElementByID(\"ssnConfirmationInput\")\n    Set oLastName = IE.document.getElementByID(\"lastNameInput\")\n    Set oFirstName = IE.document.getElementByID(\"firstNameInput\")\n\n    oSSN.InnerText = sSSN\n    oSSN2.InnerText = sSSN\n    oLastName.InnerText = sLastName\n    oFirstName.InnerText = sFirstName\n    IE.document.ParentWindow.Scroll 0&amp;, 710&amp;\n    oCaptcha.InnerText = InputBox(\"Security answer (Captcha)\")\n    'IE.Document.Forms(0).submit\n    Set SubmitBtn = IE.document.getElementsByClassName(\"btn btn-primary\")(1)\n    SubmitBtn.disabled = False '&lt; The button was disabled, but still doesn't submit\n    SubmitBtn.Click\n\nEnd Sub\n\nFunction GetIE(sLocation As String) As Object\n\n    Dim objShell As Object, objShellWindows As Object, o As Object\n    Dim sURL As String\n    Dim RetVal As Object\n\n    Set RetVal = Nothing\n    Set objShell = CreateObject(\"shell.application\")\n    Set objShellWindows = objShell.Windows\n\n    For Each o In objShellWindows\n        sURL = \"\"\n        On Error Resume Next\n        sURL = o.document.Location\n        On Error GoTo 0\n        If sURL Like \"*\" &amp; sLocation &amp; \"*\" Then\n            Set RetVal = o\n            Exit For\n        End If\n    Next o\n\n    Set GetIE = RetVal\n\nEnd Function\n</code></pre>\n"}, {"tags": ["c#", "vba", "visio"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 2, "creation_date": 1508969648, "post_id": 46942757, "comment_id": 80833133, "body": "You can never beat code that runs <i>inside</i> the Visio process.  A Winforms project will always get hammered by the fundamental cost of having to cross the process boundary and requiring two thread-context switches.  A very simple property getter runs roughly 10,000x slower due to this overhead.  It hurts a lot less when the interop member is beefy.  You&#39;ll have to create an add-in to create comparable code."}, {"owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "edited": false, "score": 0, "creation_date": 1508978661, "post_id": 46942757, "comment_id": 80835653, "body": "this is not a VBA question then. please delete the VBA tag."}, {"owner": {"reputation": 4089, "user_id": 5106, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/482709c8157cf3e9dd67555a06b09370?s=128&d=identicon&r=PG", "display_name": "Jon Fournier", "link": "https://stackoverflow.com/users/5106/jon-fournier"}, "edited": false, "score": 2, "creation_date": 1508983022, "post_id": 46942757, "comment_id": 80836645, "body": "If you drop masters programmatically you can use the dropmany command and that can save a lot of time. You may have to get creative to use a master if you\u2019re currently just drawing geometry though."}], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 3417711, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9c911566df25175612f5428eaace038?s=128&d=identicon&r=PG&f=1", "display_name": "jediderek", "link": "https://stackoverflow.com/users/3417711/jediderek"}, "edited": false, "score": 0, "creation_date": 1509029347, "post_id": 46955261, "comment_id": 80862217, "body": "Thank you for your explanation. That makes sense. Yea I thought about the xml but that would be a nightmare. The performance bothers me more than my manager, he actually enjoys watching it build itself. If it becomes a big problem I will just use the functions in c# to call vba methods. Reason for c# is to make more readable and easier to use with our company software. Thanks for the link as well!"}], "tags": [], "owner": {"reputation": 7447, "user_id": 929187, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/F5QPL.png?s=128&g=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/929187/nikolay"}, "is_accepted": true, "score": 1, "last_activity_date": 1509024350, "last_edit_date": 1509024350, "creation_date": 1509023487, "answer_id": 46955261, "question_id": 46942757, "link": "https://stackoverflow.com/questions/46942757/vba-vs-c-speed-test-in-visio/46955261#46955261", "title": "VBA vs C# Speed Test in Visio", "body": "<p>First, you  cannot beat VBA at what it's the best... Like Hans Passant wrote, you loose a lot on interop. Especially if it is out-of-process call, this will be many times slower than in-process VBA call.\nAddin will help (the code will run in-process), but VBA  will still be faster, as still you have interop (assuming a dotnet add-in - Visio is a native app, so you will have COM interop  under the hood anyways)</p>\n\n<p>Option one is to do it in vba. Most people choose it. Means you forget about c# and your windows forms application.</p>\n\n<p>Option two is to minimize  interop (minimize number of Visio calls).\nAlso, Here are some hints\n<a href=\"https://blogs.msdn.microsoft.com/mailant/2004/09/22/dev-luv-visio-development-top-five-performance-tips/\" rel=\"nofollow noreferrer\">https://blogs.msdn.microsoft.com/mailant/2004/09/22/dev-luv-visio-development-top-five-performance-tips/</a></p>\n\n<p>Most of them apply to both vba and c# though. And you will not beat vba anyways, even if you follow all of them. Note that you can make VBA code much faster, if you follow them.</p>\n\n<p>One more option is to generate Visio file without Visio (as open xml). With that, you can beat VBA performance. But the amount of code you will need to write will be probably 20 times more than that of VBA, and you n\u00e8ed to know some visio intervals. </p>\n"}], "owner": {"reputation": 309, "user_id": 3417711, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9c911566df25175612f5428eaace038?s=128&d=identicon&r=PG&f=1", "display_name": "jediderek", "link": "https://stackoverflow.com/users/3417711/jediderek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 46955261, "answer_count": 1, "score": 0, "last_activity_date": 1509024350, "creation_date": 1508968998, "question_id": 46942757, "link": "https://stackoverflow.com/questions/46942757/vba-vs-c-speed-test-in-visio", "title": "VBA vs C# Speed Test in Visio", "body": "<p>I was wondering if anyone has any tips on how to speed up automation in a Visio project in C#. The automation I have is building toilet stalls. I end up choosing to make 10 stalls, VBA takes about 3 seconds to make all the shapes. </p>\n\n<p>I just finish coverting the VBA into a c# Form Application using the Microsoft.Office.Interop.Visio library. To do the same test, it takes 14 seconds. </p>\n\n<p>I've been able to take off 3 seconds by making the visio application invisible and then making it visible after its done, but that is still not even close to what VBA does. </p>\n\n<p>I've noticed with C# I can see the visio drawing building itself with each shape while in VBA it does not. So I also tried using: \"Application.ScreenUpdating\". In c# it takes a short data type so to make it false I tried making it 0, and it did nothing. Also I tried turning it on in VBA using \"True\" but that didn't turn it on.</p>\n\n<p>So anymore more tips on making it faster? I'm surprised that VBA is faster than C#(maybe because its built into the Office Suite).</p>\n"}, {"tags": ["vba", "excel", "hide", "worksheet"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 1, "creation_date": 1508968838, "post_id": 46942603, "comment_id": 80832858, "body": "Unless you want to manually put all 178 worksheet names in array: <code>ThisWorkbook.Worksheets(Array(&quot;Sheet1&quot;,&quot;Sheet2&quot;,etc)).Visibl&zwnj;&#8203;e = xlSheetHidden</code>. You may want to disable screenupdate, pause calculation , disable events before setting it to hidden."}, {"owner": {"reputation": 77, "user_id": 7776500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0039f052e5446b8e1701090777a3af?s=128&d=identicon&r=PG&f=1", "display_name": "mattbierwirth", "link": "https://stackoverflow.com/users/7776500/mattbierwirth"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1509026040, "post_id": 46942603, "comment_id": 80859663, "body": "Thank you very much to everyone who answered, especially to Excelosaurus and paul bica! The two genius revelations were that you can instantly hide many sheets by adding them to an array, and to use custom views to set worksheet visibility. Thank you very much for your hard work and help! You guys rock!"}, {"owner": {"reputation": 77, "user_id": 7776500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0039f052e5446b8e1701090777a3af?s=128&d=identicon&r=PG&f=1", "display_name": "mattbierwirth", "link": "https://stackoverflow.com/users/7776500/mattbierwirth"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1509026264, "post_id": 46942603, "comment_id": 80859842, "body": "I also wanted to mention that I came up with an alternate solution to my problem last night (as one does) that does not include hiding or unhiding all of the worksheets in a workbook. I realized that if I could start the process with a workbook with only 1 of the 179 sheets visible, then I could unhide by name the worksheet(s) that I wished to show and then hide by name the original sheet if it wasn&#39;t currently applicable to the user&#39;s aim. This way there is no looping. I do still very much appreciate all of the answers, though!"}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": false, "score": 0, "last_activity_date": 1508968842, "creation_date": 1508968842, "answer_id": 46942738, "question_id": 46942603, "link": "https://stackoverflow.com/questions/46942603/hide-or-unhide-all-excel-sheets-without-looping/46942738#46942738", "title": "Hide or Unhide all Excel Sheets Without Looping", "body": "<p>Maybe try this:</p>\n\n<pre><code>Application.ScreenUpdating = False\n\nFor Each Sht in Wb.Worksheets\n    If Sht.Visible = xlSheetHidden Then\n        Sht.Visible = xlSheetVisible\n    End If\nNext Sht\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "is_accepted": false, "score": 0, "last_activity_date": 1508972236, "last_edit_date": 1508972236, "creation_date": 1508969512, "answer_id": 46942852, "question_id": 46942603, "link": "https://stackoverflow.com/questions/46942603/hide-or-unhide-all-excel-sheets-without-looping/46942852#46942852", "title": "Hide or Unhide all Excel Sheets Without Looping", "body": "<p>As suggested you could turn off screen updating. Add the IF statement below to omit the sheet you want (it's called 'Main' in mine, change this to what you want)</p>\n\n<pre><code>Sub HideSheets()\n\n    Dim sht As Worksheet\n\n    Application.ScreenUpdating = False\n\n    For Each sht In ActiveWorkbook.Worksheets\n        If sht.Name &lt;&gt; \"Main\" Then sht.Visible = False\n    Next sht\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Caleeco</p>\n"}, {"tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": false, "score": 2, "last_activity_date": 1509025904, "last_edit_date": 1509025904, "creation_date": 1508972316, "answer_id": 46943296, "question_id": 46942603, "link": "https://stackoverflow.com/questions/46942603/hide-or-unhide-all-excel-sheets-without-looping/46943296#46943296", "title": "Hide or Unhide all Excel Sheets Without Looping", "body": "<p>Assuming your workbook isn't protected, here's a sub that will do what's possible without systematically looping. Chart-type sheets are supported.</p>\n\n<p>I've just learned that referring to sheets through an array only works if they are all visible, hence a loop is necessary when making sheets visible.</p>\n\n<pre><code>'Hides all sheets in the workbook containing pExceptThisSheet, except pExceptThisSheet.\n'Note: pExceptThisSheet is declared as an Object so as to support both the Worksheet and Chart types.\nPublic Sub HideAllSheetsBut(ByVal pExceptThisSheet As Object)\n    On Error GoTo errHandler\n\n    Dim vntAllSheetsBut() As Variant\n    Dim oSht As Object\n    Dim lIndex As Long\n    Dim bScreenUpdating As Boolean\n\n    bScreenUpdating = Application.ScreenUpdating\n    Application.ScreenUpdating = False\n\n    'Show all sheets.\n    'Note: for some reason, an array can't be used here; must loop.\n    For Each oSht In pExceptThisSheet.Parent.Sheets\n        If oSht.Visible &lt;&gt; xlSheetVisible Then\n            oSht.Visible = xlSheetVisible\n        End If\n    Next\n\n    If Not pExceptThisSheet Is Nothing Then\n        If pExceptThisSheet.Parent.Sheets.Count &gt; 1 Then        \n            'Hide all sheets but the specified one.        \n            ReDim vntAllSheetsBut(0 To pExceptThisSheet.Parent.Sheets.Count - 2) As Variant\n\n            lIndex = 0\n            For Each oSht In pExceptThisSheet.Parent.Sheets\n                If Not oSht Is pExceptThisSheet Then\n                    vntAllSheetsBut(lIndex) = oSht.Name\n                    lIndex = lIndex + 1\n                End If\n            Next\n            'Note: for some reason, this only works for hiding, and if all sheets in vntAllSheetsBut are visible.\n            'A possible explanation would be that, behind the scene, Excel attempts to select the sheets, and fails when it encounters hidden ones.\n            pExceptThisSheet.Parent.Sheets(vntAllSheetsBut).Visible = xlSheetHidden\n        End If\n    End If\n\nCleanup:\n    On Error Resume Next\n    Set oSht = Nothing\n    Application.ScreenUpdating = bScreenUpdating\n    Exit Sub\n\nerrHandler:\n    MsgBox Err.Description, vbExclamation + vbOKOnly, \"Error\"\n    Resume Cleanup\nEnd Sub\n</code></pre>\n\n<p>You can call the sub like this:</p>\n\n<pre><code>HideAllSheetsBut Sheet1\n</code></pre>\n\n<p>or</p>\n\n<pre><code>HideAllSheetsBut Application.Workbooks(\"MyWorkbook.xlsx\").Worksheets(\"MyWorksheet\")\n</code></pre>\n\n<p>to hide all but one worksheet, and like this:</p>\n\n<pre><code>HideAllSheetsBut Nothing\n</code></pre>\n\n<p>to show all sheets.</p>\n\n<p><strong>EDIT</strong>\nAs mentioned in paul bica's answer, a custom View is a great way to quickly flip the visibility of several worksheets. In my answer, it would be used to show all worksheets without having to loop over them.</p>\n"}, {"tags": [], "owner": {"reputation": 2141, "user_id": 6901081, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb1b29a4b3f8fc693f0858f56d6ec0de?s=128&d=identicon&r=PG&f=1", "display_name": "jsotola", "link": "https://stackoverflow.com/users/6901081/jsotola"}, "is_accepted": false, "score": 0, "last_activity_date": 1508978530, "creation_date": 1508978530, "answer_id": 46944089, "question_id": 46942603, "link": "https://stackoverflow.com/questions/46942603/hide-or-unhide-all-excel-sheets-without-looping/46944089#46944089", "title": "Hide or Unhide all Excel Sheets Without Looping", "body": "<p>try this ... from a recorded macro</p>\n\n<pre><code>Option Explicit\n\nSub HideSheets()\n\n    Worksheets.Select\n    Sheets(\"Main\").Activate\n    ActiveWindow.SelectedSheets.Visible = False\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 1, "creation_date": 1508992116, "post_id": 46945574, "comment_id": 80838851, "body": "Great idea! It&#39;d be cool to be able to designate the sole worksheet that&#39;ll remain visible if the argument is False."}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": true, "score": 3, "last_activity_date": 1509020883, "last_edit_date": 1509020883, "creation_date": 1508989783, "answer_id": 46945574, "question_id": 46942603, "link": "https://stackoverflow.com/questions/46942603/hide-or-unhide-all-excel-sheets-without-looping/46945574#46945574", "title": "Hide or Unhide all Excel Sheets Without Looping", "body": "<p>As mentioned, you can only <strong>Hide</strong> multiple sheets without a loop, like in this statement:</p>\n\n<pre><code>Worksheets(Array(1,2,3,4,5,6,7,8,9,10,11,...,200)).Visible = True\n</code></pre>\n\n<p>but Unhiding multiple sheets requires the loop</p>\n\n<p><strong>However</strong>, there is a much faster method available for this, using Custom Views (in View Tab)</p>\n\n<hr>\n\n<p>The code bellow generates 2 views 1. \"ShowAllWs\", and 2. \"HideAllWs\"</p>\n\n<p>Performance wise:</p>\n\n<pre><code>For 201 Worksheets\n\nLoop HideAll - Time: 0.039 sec (initial setup - sets array, except one Ws in one operation)\nLoop ShowAll - Time: 0.648 sec (initial setup - unhides all using a loop)\n\nView ShowAll - Time: 0.023 sec (consecutive runs - no loop)\nView HideAll - Time: 0.023 sec (consecutive runs - no loop)\n</code></pre>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub SetWsVisibility(Optional ByVal vis As Boolean = False, _\n                           Optional ByVal visibleWs As Long = 0)\n\n    Static vSet As Boolean, hSet As Boolean, wsCount As Long, lastV As Long, i As Long\n\n    With ThisWorkbook\n\n        wsCount = .Worksheets.Count - 1\n\n        'if visibleWs is 0 last ws is visible, or use any other valid sheet index\n        visibleWs = IIf(visibleWs &lt; 1 Or visibleWs &gt; wsCount, wsCount + 1, visibleWs)\n\n        If wsCount &lt;&gt; .Worksheets.Count - 1 Or visibleWs &lt;&gt; lastV Then\n            vSet = False\n            hSet = False\n        Else\n            If vSet And vis Then .CustomViews(\"ShowAllWs\").Show:        Exit Sub\n            If hSet And Not vis Then .CustomViews(\"HideAllWs\").Show:    Exit Sub\n        End If\n\n        Application.ScreenUpdating = False\n        If vis Then\n            For i = 1 To wsCount + 1\n                With .Worksheets(i)\n                    If Not .Visible Then .Visible = vis\n                End With\n            Next\n            .Worksheets(1).Activate\n            .CustomViews.Add ViewName:=\"ShowAllWs\"  'Save View (one-time operation)\n            vSet = True\n        Else\n            If visibleWs &lt;&gt; lastV Then\n                For i = 1 To wsCount + 1\n                    With .Worksheets(i)\n                        If Not .Visible Then .Visible = 1\n                    End With\n                Next\n            End If\n\n            Dim arr() As Variant, j As Long\n            ReDim arr(1 To wsCount)\n            j = 1\n            For i = 1 To wsCount + 1\n                If i &lt;&gt; visibleWs Then arr(j) = i Else j = j - 1\n                j = j + 1\n            Next\n            .Worksheets(arr).Visible = vis\n            .CustomViews.Add ViewName:=\"HideAllWs\"  'Save View (one-time operation)\n            hSet = True\n            lastV = visibleWs\n        End If\n        Application.ScreenUpdating = True\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>To call it use this:</p>\n\n<pre><code>Public Sub UpdateWsVisibility()\n\n    SetWsVisibility 0, 5    'or 0 to hide them (or True / False respectively)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 7776500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0039f052e5446b8e1701090777a3af?s=128&d=identicon&r=PG&f=1", "display_name": "mattbierwirth", "link": "https://stackoverflow.com/users/7776500/mattbierwirth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3946, "favorite_count": 0, "accepted_answer_id": 46945574, "answer_count": 5, "score": 2, "last_activity_date": 1509025904, "creation_date": 1508968186, "question_id": 46942603, "link": "https://stackoverflow.com/questions/46942603/hide-or-unhide-all-excel-sheets-without-looping", "title": "Hide or Unhide all Excel Sheets Without Looping", "body": "<p>I have a workbook with 179 worksheets. I would like to either hide all worksheets (leaving one unhidden per the rules of Excel), or unhide all worksheets.</p>\n\n<p>Currently I have code that looks something like this (with the appropriate modifications depending on whether we are hiding/unhiding sheets):</p>\n\n<pre><code>For Each Sht in Wb.Worksheets\n    Sht.Visible = xlSheetVisible\nNext Sht\n</code></pre>\n\n<p>With 179 worksheets, this takes 4-5 seconds to run, and I would prefer it ran much faster.</p>\n\n<p>I know that if I go into a workbook, manually select all sheets (except for one), then right-click and select <code>\"Hide\"</code>, all of the sheets will be instantly hidden. I have been unable to reproduce this in VBA code.</p>\n\n<p>As mentioned above, I need to somehow quickly hide all (but one) worksheets in a workbook and unhide all worksheets in a workbook <strong>without looping</strong>. Any help is much appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 402, "user_id": 5373329, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153280169888425/picture?type=large", "display_name": "Bharat Anand", "link": "https://stackoverflow.com/users/5373329/bharat-anand"}, "edited": false, "score": 0, "creation_date": 1508983403, "post_id": 46942537, "comment_id": 80836753, "body": "That&#39;s correct, the limit for filter criteria is 2. I ran into this frustrating limit once and did not find any easy alternatives. You will need to be creative with what you are trying to achieve to workaround this limitation"}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1508988064, "post_id": 46942801, "comment_id": 80837858, "body": "Aha - I knew there had to be a better way. Thanks"}], "tags": [], "owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "is_accepted": true, "score": 1, "last_activity_date": 1508969221, "creation_date": 1508969221, "answer_id": 46942801, "question_id": 46942537, "link": "https://stackoverflow.com/questions/46942537/trying-to-use-a-3rd-criteria-for-autofilter-getting-compile-error/46942801#46942801", "title": "Trying to use a 3rd criteria for autofilter, getting compile error?", "body": "<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-autofilter-method-excel\" rel=\"nofollow noreferrer\"><code>Criteria3</code></a> is not a valid parameter., but to get around this, you can use an array:</p>\n\n<p>(Filtering on multiple states)  </p>\n\n<pre><code>Criteria1:=Array(\"IL\", \"IN\", \"MI\", \"OH\", \"WV\"), Operator:=xlFilterValues\n</code></pre>\n"}], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1312, "favorite_count": 0, "accepted_answer_id": 46942801, "answer_count": 1, "score": 0, "last_activity_date": 1508969221, "creation_date": 1508967896, "question_id": 46942537, "link": "https://stackoverflow.com/questions/46942537/trying-to-use-a-3rd-criteria-for-autofilter-getting-compile-error", "title": "Trying to use a 3rd criteria for autofilter, getting compile error?", "body": "<p>Is the syntax limit really just two? So I have to either use an array or just repeat the block of code? The error is at <code>Criteria3:=</code> in my <code>.AutoFilter Field</code> - <code>Compile error: Named argument not found</code>. I'm just surprised that it's limited to two. What is the reason behind this?</p>\n\n<pre><code>Sub CleanData()\n    'B b b b boilerplate!\n\n    Dim sht As Worksheet, lastrow As Long, myrange As Range\n\n        'Set references up-front\n        Set sht = ThisWorkbook.Worksheets(\"MySheet\")\n\n        'Identify the last row and use that info to set up the Range\n        With sht\n            lastrow = .Cells(sht.Rows.Count, \"A\").End(xlUp).Row\n            Set myrange = .Range(\"A2:AS\" &amp; lastrow)\n        End With\n\n        Application.DisplayAlerts = False\n            With myrange\n\n                'Apply the Autofilter method to the first column of\n                .AutoFilter Field:=26, _\n                            Criteria1:=\"Operator Error\", _\n                            Operator:=xlOr, _\n                            Criteria2:=\"Duplicate\", _\n                            Operator:=xlOr, _\n                            Criteria3:=\"Training/Test\"\n                            'ERROR HERE \n\n                'Delete the visible rows while keeping the header\n                On Error Resume Next\n                .Offset(1, 0).Resize(.Rows.Count - 1).SpecialCells(xlCellTypeVisible).Rows.Delete\n                On Error GoTo 0\n            End With\n        Application.DisplayAlerts = True\n\n        'Turn off the AutoFilter\n        With sht\n            .AutoFilterMode = False\n            If .FilterMode = True Then\n                .ShowAllData\n            End If\n        End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1508967372, "post_id": 46942406, "comment_id": 80832281, "body": "Is <code>D48</code> literal or does it mean the text or number (or error) value in row 48, column 4?"}, {"owner": {"reputation": 21, "user_id": 8695781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e633eb99dd6e2a73dc186079d23650b?s=128&d=identicon&r=PG&f=1", "display_name": "Mcodewick", "link": "https://stackoverflow.com/users/8695781/mcodewick"}, "edited": false, "score": 0, "creation_date": 1509025278, "post_id": 46942406, "comment_id": 80859060, "body": "@Jeeped D48 is the content within a cell that I&#39;d like to search for in a different excel tab."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8695781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e633eb99dd6e2a73dc186079d23650b?s=128&d=identicon&r=PG&f=1", "display_name": "Mcodewick", "link": "https://stackoverflow.com/users/8695781/mcodewick"}, "edited": false, "score": 0, "creation_date": 1509025090, "post_id": 46942497, "comment_id": 80858922, "body": "Thanks  I&#39;m getting a Next without For error for this"}, {"owner": {"reputation": 21, "user_id": 8695781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e633eb99dd6e2a73dc186079d23650b?s=128&d=identicon&r=PG&f=1", "display_name": "Mcodewick", "link": "https://stackoverflow.com/users/8695781/mcodewick"}, "edited": false, "score": 0, "creation_date": 1509025485, "post_id": 46942497, "comment_id": 80859227, "body": "I&#39;m assuming it&#39;s the next cel inside the if statement"}, {"owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "reply_to_user": {"reputation": 21, "user_id": 8695781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e633eb99dd6e2a73dc186079d23650b?s=128&d=identicon&r=PG&f=1", "display_name": "Mcodewick", "link": "https://stackoverflow.com/users/8695781/mcodewick"}, "edited": false, "score": 0, "creation_date": 1509037282, "post_id": 46942497, "comment_id": 80867241, "body": "Great.  Did you have to edit the example for it to work?"}, {"owner": {"reputation": 21, "user_id": 8695781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e633eb99dd6e2a73dc186079d23650b?s=128&d=identicon&r=PG&f=1", "display_name": "Mcodewick", "link": "https://stackoverflow.com/users/8695781/mcodewick"}, "edited": false, "score": 0, "creation_date": 1509037938, "post_id": 46942497, "comment_id": 80867614, "body": "Yes, I had to edit the example slightly, you can see it in my edited original post. My only issue is that this makes my worksheet operate very, very slowly! Do you have any idea how to make this more efficient/ run quicker?"}, {"owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "reply_to_user": {"reputation": 21, "user_id": 8695781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e633eb99dd6e2a73dc186079d23650b?s=128&d=identicon&r=PG&f=1", "display_name": "Mcodewick", "link": "https://stackoverflow.com/users/8695781/mcodewick"}, "edited": false, "score": 0, "creation_date": 1509039303, "post_id": 46942497, "comment_id": 80868352, "body": "I doubt that the &quot;If&quot; is the culprit in slowing your code down.  I edited the answer to provide another way to do the same thing."}, {"owner": {"reputation": 21, "user_id": 8695781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e633eb99dd6e2a73dc186079d23650b?s=128&d=identicon&r=PG&f=1", "display_name": "Mcodewick", "link": "https://stackoverflow.com/users/8695781/mcodewick"}, "edited": false, "score": 0, "creation_date": 1509045775, "post_id": 46942497, "comment_id": 80872030, "body": "To clarify, I have this formula working in about 300+ cells. If I only have the formula working in one cell, it is pretty quick. But if I make a change to any of the cells that this formula looks at (they all look at the column F:F on a different sheet) then it has to calculate for 3 minutes, and I can&#39;t do anything until it finishes. I tried the new code you recommended and it is not a marked improvement in speed"}, {"owner": {"reputation": 21, "user_id": 8695781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e633eb99dd6e2a73dc186079d23650b?s=128&d=identicon&r=PG&f=1", "display_name": "Mcodewick", "link": "https://stackoverflow.com/users/8695781/mcodewick"}, "edited": false, "score": 0, "creation_date": 1509046838, "post_id": 46942497, "comment_id": 80872709, "body": "Actually, I got it to work. I just restricted it from F:F to F5:F1502. It was just looking through way too many cells."}], "tags": [], "owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "is_accepted": false, "score": 0, "last_activity_date": 1509039154, "last_edit_date": 1509039154, "creation_date": 1508967656, "answer_id": 46942497, "question_id": 46942406, "link": "https://stackoverflow.com/questions/46942406/count-multiple-values-in-same-cell-within-whole-row-in-excel/46942497#46942497", "title": "Count multiple values in Same Cell, within whole Row in Excel", "body": "<p>How about:</p>\n\n<pre><code>For Each cel In rSearchRange\n    if cel = \"\" then\n        next cel\n    else\n        CountText = CountText + UBound(Split(cel.Value, sLookFor))\n    end if\nNext cel\n</code></pre>\n\n<p>or </p>\n\n<pre><code>For Each cel In rSearchRange\n    if cel &lt;&gt; \"\" then\n        CountText = CountText + UBound(Split(cel.Value, sLookFor))\n    end if\nNext cel\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 8695781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e633eb99dd6e2a73dc186079d23650b?s=128&d=identicon&r=PG&f=1", "display_name": "Mcodewick", "link": "https://stackoverflow.com/users/8695781/mcodewick"}, "edited": false, "score": 0, "creation_date": 1509024874, "post_id": 46942652, "comment_id": 80858761, "body": "Thanks for the response- I&#39;m not sure exactly what is going on with this one, but I&#39;m getting a &quot;0&quot; result for all of the search results, no matter how many there actually are."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1508969315, "last_edit_date": 1508969315, "creation_date": 1508968413, "answer_id": 46942652, "question_id": 46942406, "link": "https://stackoverflow.com/questions/46942406/count-multiple-values-in-same-cell-within-whole-row-in-excel/46942652#46942652", "title": "Count multiple values in Same Cell, within whole Row in Excel", "body": "<p>Track the number of instances of your 'delimiter' by retrieving the length of the string minus the retrieving the length of the string without the delimiliter divided by the length of the delimiter. </p>\n\n<pre><code>Function CountText(sLookFor As String, rSearchRange As Range) As Long\n    Dim cel As Range\n    For Each cel In rSearchRange\n        CountText = (Len(cel.Value) - Len(Replace(cel.Value, sLookFor, vbNullString))) / Len(sLookFor)\n    Next cel\nEnd Function\n</code></pre>\n\n<p>The replace function is currently case-sensitive but can be altered to case-insensitive.</p>\n"}], "owner": {"reputation": 21, "user_id": 8695781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e633eb99dd6e2a73dc186079d23650b?s=128&d=identicon&r=PG&f=1", "display_name": "Mcodewick", "link": "https://stackoverflow.com/users/8695781/mcodewick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1509039154, "creation_date": 1508967219, "last_edit_date": 1509036849, "question_id": 46942406, "link": "https://stackoverflow.com/questions/46942406/count-multiple-values-in-same-cell-within-whole-row-in-excel", "title": "Count multiple values in Same Cell, within whole Row in Excel", "body": "<p>I'd like to create a formula to look at a column in excel and count if there is an entry, such as D48 for example. So it will go through and count all the \"D48\" entries throughout the column, even if it is separated by commas. So a cell containing \"D48, D48\" or \"D48, D48, D48\" will all be counted. </p>\n\n<p>I have a working formula right now, but it takes blank cells and assigns a value of -1. How can I avoid this? Is there a more efficient way to write this formula?</p>\n\n<pre><code>Function CountText(sLookFor As String, rSearchRange As Range) As Long\n\nDim cel As Range\n\nFor Each cel In rSearchRange\n    CountText = CountText + UBound(Split(cel.Value, sLookFor))\nNext cel\n\nEnd Function\n</code></pre>\n\n<p>but here's the code that worked based on responses below (problem solved!!!)</p>\n\n<pre><code>Function CountText(sLookFor As String, rSearchRange As Range) As Long\n    Dim cel As Range\n\n    For Each cel In rSearchRange\n\n    If cel = \"\" Then\n\n    Else\n        CountText = CountText + UBound(Split(cel.Value, sLookFor))\n    End If\nNext cel\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1508968425, "post_id": 46942592, "comment_id": 80832725, "body": "Unfortunately this isn&#39;t giving the output I was hoping for... Does my question make sense though? Maybe I need to rephrase it?"}, {"owner": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1508969129, "post_id": 46942592, "comment_id": 80832964, "body": "Ah, I see now that the logic you had was, effectively, a CASE statement with fall through rather than the VB/VBA Select Case which treats each case discretely. I think you will end up with some variation of your original IF..END IF structure since it sounds like you want multiple actions based on various checkbox values."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1508970383, "post_id": 46942592, "comment_id": 80833389, "body": "Yes, that&#39;s exactly what I&#39;m looking for! Is that possible?"}, {"owner": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1508971701, "post_id": 46942592, "comment_id": 80833809, "body": "I fear not because of the lack of fall-through. Unless you wanted to create Case statements that took into consideration EVERY possible checkbox/radio button combination. But that would create considerable amounts of repeated code not to mention the sheer volume of code would be untenable."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1508971780, "post_id": 46942592, "comment_id": 80833829, "body": "Alright, I didn&#39;t think so... Well thanks a lot for trying, I will leave this up here in-case some one else knows of a better way of attempting to optimize this."}, {"owner": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1508972503, "post_id": 46942592, "comment_id": 80834077, "body": "While it doesn&#39;t incorporate the CASE statement, I have offered an alternative solution which makes things a bit cleaner and should make future enhancements (i.e. more checkboxes) easier to implement."}, {"owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1509030852, "post_id": 46942592, "comment_id": 80863323, "body": "Tested and working for the second part of your answer! I love this method a lot more, really appreciate it :)"}, {"owner": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "reply_to_user": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "edited": false, "score": 0, "creation_date": 1509032879, "post_id": 46942592, "comment_id": 80864591, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/157587/discussion-between-forty3-and-maldred\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "is_accepted": true, "score": 1, "last_activity_date": 1508972386, "last_edit_date": 1508972386, "creation_date": 1508968127, "answer_id": 46942592, "question_id": 46942319, "link": "https://stackoverflow.com/questions/46942319/can-this-be-turned-into-a-case-switch/46942592#46942592", "title": "Can this be turned into a Case Switch?", "body": "<p>Sure:</p>\n\n<pre><code>Select Case True\n    Case optDelete.Value And chkbxValid.Value\n        Range(\"H4:I1000\").ClearContents\n\n    Case optDelete.Value And chkbxValidDuplicate.Value\n        Range(\"K4:L1000\").ClearContents\n\n    Case optDelete.Value And chkbxInvalid.Value\n        Range(\"N4:O1000\").ClearContents\n\n    Case optDelete.Value And chkbxInvalidDuplicate.Value\n        Range(\"Q4:R1000\").ClearContents\n\n    Case chkbxValid.Value\n        Call SortData(Range(\"I4:I1000\"), Range(\"H4:I1000\"))\n\n    Case chkbxValidDuplicate.Value\n        Call SortData(Range(\"L4:L1000\"), Range(\"K4:L1000\"))\n\n    Case chkbxInvalid.Value\n        Call SortData(Range(\"O4:O1000\"), Range(\"N4:O1000\"))\n\n    Case chkbxInvalidDuplicate.Value\n        Call SortData(Range(\"R4:R1000\"), Range(\"Q4:R1000\"))\n\nEnd Select\n</code></pre>\n\n<p>Based on your need, however, consider the cleanliness of:</p>\n\n<p>Inside your main routine:</p>\n\n<pre><code>Call DeleteOrSortRoutine(optDelete.Value, chkbxValid.Value, Range(\"H4:I1000\"), Range(\"I4:I1000\"))\nCall DeleteOrSortRoutine(optDelete.Value, chkbxValidDuplicate.Value, Range(\"K4:L1000\"), Range(\"L4:L1000\"))\nCall DeleteOrSortRoutine(optDelete.Value, chkbxInvalid.Value, Range(\"N4:O1000\"), Range(\"O4:O1000\"))\nCall DeleteOrSortRoutine(optDelete.Value, chkbxInvalidDuplicate.Value, Range(\"Q4:R1000\"), Range(\"R4:R1000\"))\n</code></pre>\n\n<p>And then, defined later in the module:</p>\n\n<pre><code>Private Sub DeleteOrSortRoutine(ByVal deleteCheck As Boolean, ByVal secondaryCheck As Boolean, ByVal range1 As Range, ByVal range2 As Range)\n    If deleteCheck And secondaryCheck Then\n        range1.ClearContents\n    ElseIf secondaryCheck Then\n        Call SortRange(range2, range1)\n    End If\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2144, "user_id": 3485669, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8zfUU.jpg?s=128&g=1", "display_name": "Forty3", "link": "https://stackoverflow.com/users/3485669/forty3"}, "edited": false, "score": 0, "creation_date": 1509032775, "post_id": 46943542, "comment_id": 80864526, "body": "Dani - that will compare the values in each Case statement against the <code>optDelete.Value</code> and if the two match, then it will execute the code. Therefore, if the <code>optDelete.Value</code> is <code>FALSE</code> and <code>chkbxValid.Value</code> is <code>FALSE</code> then it will run the <code>Range(&quot;H4:I1000&quot;).ClearContents</code> which, I suspect, is not what OP would want."}], "tags": [], "owner": {"reputation": 135, "user_id": 5687983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-J7_GMysD_YQ/AAAAAAAAAAI/AAAAAAAAHho/Ai0eLHKKHk4/photo.jpg?sz=128", "display_name": "Dani Aya", "link": "https://stackoverflow.com/users/5687983/dani-aya"}, "is_accepted": false, "score": 0, "last_activity_date": 1508974040, "creation_date": 1508974040, "answer_id": 46943542, "question_id": 46942319, "link": "https://stackoverflow.com/questions/46942319/can-this-be-turned-into-a-case-switch/46943542#46943542", "title": "Can this be turned into a Case Switch?", "body": "<p>Can you try this chunk of code?</p>\n\n<pre><code>Select Case optDelete.Value\n    Case chkbxValid.Value: Range(\"H4:I1000\").ClearContents\n    Case chkbxValidDuplicate.Value: Range(\"K4:L1000\").ClearContents\n    Case chkbxInvalid.Value: Range(\"N4:O1000\").ClearContents\n    Case chkbxInvalidDuplicate.Value: Range(\"Q4:R1000\").ClearContents\nEnd Select\nSelect Case optSort.Value\n    Case chkbxValid.Value: Call SortData(Range(\"I4:I1000\"), Range(\"H4:I1000\"))\n    Case chkbxValidDuplicate.Value: Call SortData(Range(\"L4:L1000\"), Range(\"K4:L1000\"))\n    Case chkbxInvalid.Value: Call SortData(Range(\"O4:O1000\"), Range(\"N4:O1000\"))\n    Case chkbxInvalidDuplicate.Value: Call SortData(Range(\"R4:R1000\"), Range(\"Q4:R1000\"))\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 46942592, "answer_count": 2, "score": 0, "last_activity_date": 1508974040, "creation_date": 1508966830, "last_edit_date": 1531164843, "question_id": 46942319, "link": "https://stackoverflow.com/questions/46942319/can-this-be-turned-into-a-case-switch", "title": "Can this be turned into a Case Switch?", "body": "<p>I'm trying to optimize my code and find any and all replications of code to minimize it and make it understandable to read... I'm still fairly new to <code>Case Switch</code> with VBA and I'm having a hard time trying to visualize this. Is the below code able to be turned into a <code>Case Switch</code> scenario?</p>\n\n<pre><code>If (optDelete.value) Then\n    If (chkbxValid.value) Then\n        Range(\"H4:I1000\").ClearContents\n    End If\n    If (chkbxValidDuplicate.value) Then\n        Range(\"K4:L1000\").ClearContents\n    End If\n    If (chkbxInvalid.value) Then\n        Range(\"N4:O1000\").ClearContents\n    End If\n    If (chkbxInvalidDuplicate.value) Then\n        Range(\"Q4:R1000\").ClearContents\n    End If\nElse\n    If (chkbxValid.value) Then\n        Call SortData(Range(\"I4:I1000\"), Range(\"H4:I1000\"))\n    End If\n    If (chkbxValidDuplicate.value) Then\n        Call SortData(Range(\"L4:L1000\"), Range(\"K4:L1000\"))\n    End If\n    If (chkbxInvalid.value) Then\n        Call SortData(Range(\"O4:O1000\"), Range(\"N4:O1000\"))\n    End If\n    If (chkbxInvalidDuplicate.value) Then\n        Call SortData(Range(\"R4:R1000\"), Range(\"Q4:R1000\"))\n    End If\nEnd If\n</code></pre>\n\n<p>This code uses check boxes with the following form, please see image below\n<a href=\"https://i.stack.imgur.com/6aFoH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6aFoH.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "match", "multiple-columns"], "comments": [{"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1508967779, "post_id": 46942271, "comment_id": 80832459, "body": "Sorry, but this makes no sense to me. You want the 3rd &#39;Castro&#39; row (which I assume has a &#39;4&#39; in column c), so how do you get down to the &#39;19&#39;? I assume the last <i>row</i> in your table is 13 (col c = 23)?"}, {"owner": {"reputation": 19, "user_id": 8701550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1277917848981073/picture?type=large", "display_name": "Bruno Pimenta", "link": "https://stackoverflow.com/users/8701550/bruno-pimenta"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1508968721, "post_id": 46942271, "comment_id": 80832824, "body": "I want the 3rd &quot;castro&quot; row but in the same row it has the value &quot;a2&quot;"}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1508970158, "post_id": 46942271, "comment_id": 80833308, "body": "And is &#39;a2&#39; some value that will: (a) never change; will always search for &#39;a2&#39;; or (b) can be &#39;a3&#39; or &#39;a4&#39;, etc.?  In other words, you should describe the rules associated with your search... It makes a big difference in how you solve the code problem."}, {"owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1508970919, "post_id": 46942271, "comment_id": 80833569, "body": "Also, the range you pass does NOT include column A -- which is where &#39;a2&#39; can be found. Is there a reason for that?"}, {"owner": {"reputation": 19, "user_id": 8701550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1277917848981073/picture?type=large", "display_name": "Bruno Pimenta", "link": "https://stackoverflow.com/users/8701550/bruno-pimenta"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1508971303, "post_id": 46942271, "comment_id": 80833704, "body": "the range I passed represent the code that I applied by using only column B and C....  The rules for this code is:"}, {"owner": {"reputation": 19, "user_id": 8701550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1277917848981073/picture?type=large", "display_name": "Bruno Pimenta", "link": "https://stackoverflow.com/users/8701550/bruno-pimenta"}, "reply_to_user": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "edited": false, "score": 0, "creation_date": 1508971819, "post_id": 46942271, "comment_id": 80833845, "body": "the range I passed represent the code that I applied by using only column B and C....  The rules for this code is: I would like to use vlookup and use two columns as criterias  the first column has to search &quot;a2&quot; value and the other column would use the 3rd &quot;castro&quot; row that has already &quot;a2&quot; value, is like index + match code"}], "answers": [{"tags": [], "owner": {"reputation": 4173, "user_id": 2895550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1184544414/picture?type=large", "display_name": "Wayne G. Dunn", "link": "https://stackoverflow.com/users/2895550/wayne-g-dunn"}, "is_accepted": false, "score": 0, "last_activity_date": 1508972067, "creation_date": 1508972067, "answer_id": 46943252, "question_id": 46942271, "link": "https://stackoverflow.com/questions/46942271/vba-second-match-with-two-column-criteria/46943252#46943252", "title": "VBA second match with two column criteria", "body": "<p>I modified your code so that it will check two columns.</p>\n\n<pre><code>1. Changed the range to include column A\n2. Changed the column offsets to allow for the added column.\n\n\n\n\n\nOption Explicit\n\nSub test1()\n  Dim teste     As String\n  teste = VLOOKUPNTH(\"castro\", Range(\"A1:C22\"), 3, 3)\n  Debug.Print \"Result: \" &amp; teste\nEnd Sub\n\nFunction VLOOKUPNTH(lookup_value, table_array As Range, col_index_num As Integer, nth_value As Integer) As String\n\nDim nRow As Long\nDim nVal As Integer\nDim bFound As Boolean\n\n    VLOOKUPNTH = \"No Match\"\n\n    With table_array\n        For nRow = 1 To .Rows.Count\n            ' Must match both columns to be counted.\n            If .Cells(nRow, 2).Value = lookup_value And .Cells(nRow, 1).Value = \"a2\" Then\n                nVal = nVal + 1\n            End If\n            If nVal = nth_value Then\n                ' Now we have found the nth occurence of the lookup value.\n                VLOOKUPNTH = .Cells(nRow, col_index_num).Text\n                Exit Function\n            End If\n        Next nRow\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 8701550, "user_type": "registered", "profile_image": "https://graph.facebook.com/1277917848981073/picture?type=large", "display_name": "Bruno Pimenta", "link": "https://stackoverflow.com/users/8701550/bruno-pimenta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508972067, "creation_date": 1508966594, "question_id": 46942271, "link": "https://stackoverflow.com/questions/46942271/vba-second-match-with-two-column-criteria", "title": "VBA second match with two column criteria", "body": "<p>I'm trying to develop a code that brings the nth matching which is selected by the user, I already found a code that execute this but only with only one column</p>\n\n<p>I want to get the third occurence of string \"castro\" but with the row value a2 which is \"19\". any suggestions?</p>\n\n<p>below is the code I used to get the second ocurrence but only using one column.</p>\n\n<pre><code>      Sub test1()\n      Dim teste As String\n      teste = VLOOKUPNTH(\"prysmian\", Range(\"B1:C22\"), 2, 2)\n      End Sub\n\n      Function VLOOKUPNTH(lookup_value, table_array As Range, col_index_num \n      As Integer, nth_value)\n\n      Dim nRow As Long\n      Dim nVal As Integer\n      Dim bFound As Boolean\n\n      VLOOKUPNTH = \"No Match\"\n\n      With table_array\n      For nRow = 1 To .Rows.Count\n      If .Cells(nRow, 1).Value = lookup_value Then\n        nVal = nVal + 1\n      End If\n        If nVal = nth_value Then\n            VLOOKUPNTH = .Cells(nRow, col_index_num).Text\n            Exit Function\n        End If\n      Next nRow\n      End With\n      End Function\n\n\n     the table \n     A       B      C\n     a1    castro   1\n     a1    castro   3\n     a1    castro   4\n     a1    castro   5\n     a1    castro   6\n     a1    castro   7\n     a2    castro   17\n     a2    castro   18\n     a2    castro   19\n     a2    castro   20\n     a2    castro   21\n     a2    castro   22\n     a2    castro   23\n</code></pre>\n"}, {"tags": ["excel", "concatenation", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1508966322, "creation_date": 1508966322, "answer_id": 46942223, "question_id": 46942183, "link": "https://stackoverflow.com/questions/46942183/vba-to-concatenate-cells-and-keep-bold-formatting/46942223#46942223", "title": "vba to concatenate cells and keep bold formatting", "body": "<p>I know this is not an exact answer but maybe can provide you ideas:</p>\n\n<pre><code>With ActiveCell.Characters(Start:=13, Length:=6).Font\n        .FontStyle = \"Bold\"\nEnd With\n</code></pre>\n\n<p>You need to find how to set your Start and Length values using the functions that fit your needs.</p>\n\n<p>The usage of <code>Length + 1</code> makes that select all the text in your cell before Start. </p>\n"}], "owner": {"reputation": 11, "user_id": 2763573, "user_type": "registered", "profile_image": "https://graph.facebook.com/100005103306011/picture?type=large", "display_name": "Jan Woellhaf", "link": "https://stackoverflow.com/users/2763573/jan-woellhaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1432, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524134334, "creation_date": 1508966108, "last_edit_date": 1531164843, "question_id": 46942183, "link": "https://stackoverflow.com/questions/46942183/vba-to-concatenate-cells-and-keep-bold-formatting", "title": "vba to concatenate cells and keep bold formatting", "body": "<p>I looked for several hours for a satisfactory answer to this question and couldn't find one, so I rolled my own.</p>\n\n<p>For example, suppose cell A1 = \"word1\", A2 = \"<strong>word2</strong>\", A3 = \"word3\", and A4 = \"word4.\"</p>\n\n<p>I want B1 to be \"word1 <strong>word2</strong> word3 word4 \"</p>\n\n<p>If none, any, or all the words in column A are bold, I want that reflected in B1. Like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Px5fL.png\" rel=\"nofollow noreferrer\">partial sheet image</a></p>\n\n<pre><code>Sub test1()\n\nDim Row As Integer\nDim Start As Integer\nDim Length As Integer\n\n        ' concatenate the words with a space between each\n    Range(\"B1\").Value = \"\"\n    For Row = 1 To 4\n        Range(\"B1\").Value = Range(\"B1\").Value &amp; \" \" &amp; Cells(Row, \"A\").Value\n    Next Row\n\n        ' match bold formatting\n    Start = 1\n    For Row = 1 To 4\n        Length = Len(Cells(Row, \"A\").Value)\n        Range(\"B1\").Characters(Start, Length + 1).Font.Bold = Cells(Row, \"A\").Font.Bold\n        Start = Start + Length + 1\n    Next Row\n\nEnd Sub\n</code></pre>\n\n<p>I found I needed two separate loops to make this work. With one loop, Excel made bold all the words following the first bold one, except the last word if it was not bold.</p>\n\n<p>Why did I need (Start, Length + 1) in the code above?</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1508964900, "post_id": 46941828, "comment_id": 80831077, "body": "Can&#39;t speak 100% to excel, but in SQL returns and line feeds are not valid characters at all for columns. This applies to a datagrid and related objects in .NET too. I can assume it applies to excel as well. The design decision seems to have painted you into a corner. Perhaps you can store the index and reference it by that value?"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 1, "creation_date": 1508965562, "post_id": 46941828, "comment_id": 80831446, "body": "Your formula is OK but typically, the newline character will be vbLf if the title was set from the keyboard. I suspect there&#39;s a trailing space after &quot;Total&quot; and/or &quot;List&quot;. (Select your title and, from the Immediate Window, type <code>Debug.Print Selection.Value</code>, then check where each printed line ends."}, {"owner": {"reputation": 448, "user_id": 4292939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c603ee08f703ee120ae1cd27d4351766?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Schumacher", "link": "https://stackoverflow.com/users/4292939/michael-schumacher"}, "reply_to_user": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1509001200, "post_id": 46941828, "comment_id": 80842566, "body": "@Excelosaurus can you turn this into an answer? vbLf works, and there were no spaces. Seems to be one of these errors where you open Excel the next day and the unchanged code suddenly starts to work."}], "answers": [{"comments": [{"owner": {"reputation": 448, "user_id": 4292939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c603ee08f703ee120ae1cd27d4351766?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Schumacher", "link": "https://stackoverflow.com/users/4292939/michael-schumacher"}, "edited": false, "score": 0, "creation_date": 1509032144, "post_id": 46955533, "comment_id": 80864162, "body": "Yes, Option Explicit is set."}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": true, "score": 1, "last_activity_date": 1509024148, "creation_date": 1509024148, "answer_id": 46955533, "question_id": 46941828, "link": "https://stackoverflow.com/questions/46941828/how-do-i-reference-an-excel-listobject-table-column-if-the-column-name-has-line/46955533#46955533", "title": "How do I reference an Excel ListObject table column if the column name has line breaks?", "body": "<p>Your formula is OK but typically, the newline character will be vbLf if the title was set from the keyboard. I also suspect there might be leading and/or trailing space characters anywhere in the title. Select your title cell and, from the VBE's Immediate Window (Ctrl+G), type Debug.Print ActiveCell.Value, then check where each printed line ends.</p>\n\n<p>Are you using Option Explicit? In your question, you mention you've tried vb_Lf but this constant doesn't exist and, without Option Explicit, would have been interpreted as an empty string.</p>\n"}], "owner": {"reputation": 448, "user_id": 4292939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c603ee08f703ee120ae1cd27d4351766?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Schumacher", "link": "https://stackoverflow.com/users/4292939/michael-schumacher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 946, "favorite_count": 0, "accepted_answer_id": 46955533, "answer_count": 1, "score": 0, "last_activity_date": 1509024148, "creation_date": 1508964644, "last_edit_date": 1531161705, "question_id": 46941828, "link": "https://stackoverflow.com/questions/46941828/how-do-i-reference-an-excel-listobject-table-column-if-the-column-name-has-line", "title": "How do I reference an Excel ListObject table column if the column name has line breaks?", "body": "<p>I'm tasked with the following:</p>\n\n<ul>\n<li>several sheets from different workbooks have to be copied to a new workbook</li>\n<li>each of those sheets contains an Excel table (a ListObject), named like the sheet with a postfixed T (sheet Foo, table: FooT)</li>\n<li>the new workbook has to contain a summary sheet where each table name is listed, and various values of the respective tables are presented by referencing them with suitable formulas</li>\n</ul>\n\n<p>This has to be done frequently for different workbooks, so the idea was to do this in VBA.</p>\n\n<p>Copying the sheets is easy, listing the table names in a new sheet is easy, but referencing the values runs into problems.</p>\n\n<p>The general idea is to do the following</p>\n\n<pre><code>ActiveSheet.Range(\"A1\").Value = \"FooT\"\nActiveSheet.Range(\"B1\").Formula = \"=FooT[[#Totals],[Quantity]]\"\nActiveSheet.Range(\"C1\").Formula = \"=FooT[[#Totals],[Total List Price]]\"\n</code></pre>\n\n<p>and iterate over all sheets.</p>\n\n<p>Setting the value for A and the formula for B works as expected and gets the expected results.</p>\n\n<p>The issue with C is that instead of \"Total List Price\", the column header is actually formatted as</p>\n\n<p>\"Total<br>\nList<br>\nPrice\"</p>\n\n<p>I can't change that, this has been a design decision.</p>\n\n<p>This is also how the column name shows up in the formula if I add the formula to the cell manually.</p>\n\n<p>So there's some sort of line break happening here, and I've tried cater to this in VBA with </p>\n\n<pre><code>ActiveSheet.Range(\"C1\").Formula = \"=FooT[[#Totals],[Total\" &amp; vbCrLf &amp; _\n                                                   \"List\" &amp; vbCrLf &amp; _\n                                                   \"Price]]\"\n</code></pre>\n\n<p>and vb_Cr and vb_Lf and vb_Newline instead of the vbCrLf. Trying to set C's formula to any of these variations yields the infamous Error 1004.</p>\n\n<p>Getting the value of the column header from one of the sheets and using it in the formula works. This could be a potential workaround, but I'd really like to know what I'm missing or how I can figure out how to build this formula string correctly.</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1508964632, "post_id": 46941367, "comment_id": 80830908, "body": "If you can do steps 1 and 2, what is your step 3 question?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1508964774, "post_id": 46941367, "comment_id": 80831000, "body": "Many will be learning now that files can be manually dragged from a Windows folder into an Outlook folder. I believe there is nothing in Outlook VBA to save attachments directly to an Outlook folder."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1508975479, "post_id": 46941367, "comment_id": 80834900, "body": "For the sceptics - Storing files directly in Outlook folders <a href=\"https://www.msoutlook.info/question/575\" rel=\"nofollow noreferrer\">msoutlook.info/question/575</a>"}, {"owner": {"reputation": 11, "user_id": 8833793, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bR-ucTMJo_g/AAAAAAAAAAI/AAAAAAAAAH8/OzpRNZQICgU/photo.jpg?sz=128", "display_name": "d-user", "link": "https://stackoverflow.com/users/8833793/d-user"}, "edited": false, "score": 0, "creation_date": 1509691588, "post_id": 46941367, "comment_id": 81129051, "body": "well, thanks everyone for your help anyway!"}], "answers": [{"comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1508965596, "post_id": 46941823, "comment_id": 80831463, "body": "The OP has already found how to do this. &quot;I do not want to save the attachment to hard drive folder.&quot;"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1508964608, "creation_date": 1508964608, "answer_id": 46941823, "question_id": 46941367, "link": "https://stackoverflow.com/questions/46941367/vba-move-attachment-to-inbox-subfolder/46941823#46941823", "title": "VBA - Move attachment to inbox subfolder", "body": "<blockquote>\n  <p>I found this example at\n  <a href=\"https://www.extendoffice.com/documents/outlook/3747-outlook-auto-download-save-attachments-to-folder.html\" rel=\"nofollow noreferrer\">https://www.extendoffice.com/documents/outlook/3747-outlook-auto-download-save-attachments-to-folder.html</a></p>\n</blockquote>\n\n<pre><code>Public Sub SaveAttachmentsToDisk(MItem As Outlook.MailItem)\n  Dim oAttachment As Outlook.Attachment\n  Dim sSaveFolder As String\n\n  sSaveFolder = \"C:\\Users\\DT168\\Documents\\outlook-attachments\\\"\n  For Each oAttachment In MItem.Attachments\n    oAttachment.SaveAsFile sSaveFolder &amp; oAttachment.DisplayName\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>Also you can add a Rule (step by step example is shown in the page).</p>\n"}, {"comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1508975263, "post_id": 46943546, "comment_id": 80834844, "body": "Storing files directly in Outlook folders <a href=\"https://www.msoutlook.info/question/575\" rel=\"nofollow noreferrer\">msoutlook.info/question/575</a>"}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1508975658, "post_id": 46943546, "comment_id": 80834948, "body": "If you take a look a bit closer, you can see a document item (the message class starts with IPM.Document) with a corresponding file attached."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1508977129, "post_id": 46943546, "comment_id": 80835311, "body": "I have dragged a Word document directly into an Outlook folder."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1508979409, "post_id": 46943546, "comment_id": 80835800, "body": "Yes, you can drag a file. But the file is stored in the Outlook folder as an attachment to the document item."}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1508974051, "creation_date": 1508974051, "answer_id": 46943546, "question_id": 46941367, "link": "https://stackoverflow.com/questions/46941367/vba-move-attachment-to-inbox-subfolder/46943546#46943546", "title": "VBA - Move attachment to inbox subfolder", "body": "<p>An Outlook folder can't contain files. You need to created a document item if it is an Office document (like Word or Excel). Or you will have to create an Outlook item and add the attached file to it. </p>\n\n<p>You may find the <a href=\"https://msdn.microsoft.com/en-us/library/office/ee814736%28v=office.14%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Getting Started with VBA in Outlook 2010</a> article helpful. </p>\n"}], "owner": {"reputation": 11, "user_id": 8833793, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bR-ucTMJo_g/AAAAAAAAAAI/AAAAAAAAAH8/OzpRNZQICgU/photo.jpg?sz=128", "display_name": "d-user", "link": "https://stackoverflow.com/users/8833793/d-user"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 308, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1592984278, "creation_date": 1508962739, "last_edit_date": 1592984278, "question_id": 46941367, "link": "https://stackoverflow.com/questions/46941367/vba-move-attachment-to-inbox-subfolder", "title": "VBA - Move attachment to inbox subfolder", "body": "<p>I would like to create the following rule in Outlook:</p>\n\n<p>whenever comes an email from (1) specific address and (2) with specific subject I want to run a script that moves the email's attachment into the inbox subfolder (let's call it MyFolder). </p>\n\n<p>So just to make it clear: I do not want to save the attachment to hard drive folder.</p>\n\n<p>I can do steps 1 and 2, but I have problems with the code for step 3. Most related questions are dealing with saving attachments to hard drive folders.</p>\n\n<p>I would really appreciate your help!</p>\n\n<p>Dmitri</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 3, "creation_date": 1508960100, "post_id": 46940708, "comment_id": 80828604, "body": "For example: <code>Cells(1, 26).Value = &quot;&#39;&quot; &amp; Cells(1, 24).Value &amp; Cells(1, 25).Value</code> Note, that MS Excel treats <code>01</code> as number. You have to add <code>&#39;</code> on the beginning of statement to change it to string."}, {"owner": {"reputation": 1024, "user_id": 4232530, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1387106745/picture?type=large", "display_name": "rakamakafo", "link": "https://stackoverflow.com/users/4232530/rakamakafo"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1508960318, "post_id": 46940708, "comment_id": 80828723, "body": "@MaciejLos, Thanks, That worked"}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1508960358, "post_id": 46940708, "comment_id": 80828742, "body": "You&#39;re very welcome."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1508960753, "post_id": 46940708, "comment_id": 80828963, "body": "Although I originally suggested prepending the <code>&#39;</code> (@MaciejLos beat me by a few seconds :D), another possibility would be formatting the cell using a format of <code>&quot;00&quot;</code>.  It depends on whether you just want the cell to <b>look</b> like it is a two-digit number, or whether you really want the two-character string in the cell."}, {"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1508961209, "post_id": 46940708, "comment_id": 80829221, "body": "@YowE3K, That&#39;s solution is better than mine."}], "answers": [{"comments": [{"owner": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 0, "creation_date": 1508960567, "post_id": 46940839, "comment_id": 80828876, "body": "Why to use <code>CStr()</code> function if you say to Excel treat this content as string?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1508960576, "post_id": 46940839, "comment_id": 80828880, "body": "This is the the best approach. Format property should be used for formatting.Don&#39;t force literals to format the data.."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 1, "creation_date": 1508960646, "post_id": 46940839, "comment_id": 80828919, "body": "@MaciejLos, as I understand, need to change 0 to String because if you concatenate 2 integers (0 &amp; 1) your result will be 1 (0 will be lost)."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 7770, "user_id": 2142028, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ltfco.jpg?s=128&g=1", "display_name": "Maciej Los", "link": "https://stackoverflow.com/users/2142028/maciej-los"}, "edited": false, "score": 3, "creation_date": 1508960828, "post_id": 46940839, "comment_id": 80829007, "body": "@MaciejLos without <code>CStr</code> the type conversion still occurs, only implicitly. Prefer explicit type conversions and member calls (write code that says what it does <i>and does what it says</i>) - it works without <code>.Value</code> too, but omitting it would be an implicit member call; also <code>Cells</code> is implicitly referring to the <code>ActiveSheet</code> if this is in anywhere other than a workshet&#39;s code-behind, in which case proper qualification would be <code>Me.Cells</code>. FWIW this blows up with a <i>type mismatch</i> if any of the cells involved contains an error value."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1508961011, "post_id": 46940839, "comment_id": 80829123, "body": "If using VBA wouldn&#39;t it be better to just set <code>Cells(1, 26).NumberFormat = &quot;00&quot;</code> then transfer the true number value?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1508961133, "post_id": 46940839, "comment_id": 80829186, "body": "@Jeeped good point - depends if OP means to treat <code>04</code> as a string or as a number. IMO if the data isn&#39;t meant to be used for any arithmetics or as a numeric function parameter, then treating it as a string is semantically correct."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": true, "score": 5, "last_activity_date": 1508960570, "last_edit_date": 1508960570, "creation_date": 1508960530, "answer_id": 46940839, "question_id": 46940708, "link": "https://stackoverflow.com/questions/46940708/concatenating-0s-in-vba/46940839#46940839", "title": "Concatenating 0&#39;s in VBA", "body": "<p>When you put an integer value in a cell, the format is set to number.\nYou can use:</p>\n\n<pre><code>Cells(1, 26).NumberFormat = \"@\" 'This set cell format to Text\nCells(1, 26).Value = CStr(Cells(1, 24).Value) &amp; CStr(Cells(1, 25).Value)\n</code></pre>\n"}], "owner": {"reputation": 1024, "user_id": 4232530, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1387106745/picture?type=large", "display_name": "rakamakafo", "link": "https://stackoverflow.com/users/4232530/rakamakafo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 46940839, "answer_count": 1, "score": 1, "last_activity_date": 1508960570, "creation_date": 1508959982, "last_edit_date": 1508960555, "question_id": 46940708, "link": "https://stackoverflow.com/questions/46940708/concatenating-0s-in-vba", "title": "Concatenating 0&#39;s in VBA", "body": "<p>I have two columns (first contains the value <code>0</code>, second contains the value <code>1</code>).</p>\n\n<p>This statement returns <code>1</code>, and not <code>01</code></p>\n\n<pre><code>Cells(1, 26).Value = CStr(Cells(1, 24).Value) &amp; CStr(Cells(1, 25).Value)\n</code></pre>\n\n<p>I want to concatenate them in 3rd column to <code>01</code>. How do I do this?</p>\n"}, {"tags": ["vba", "excel", "keyboard-shortcuts", "excel-addins"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1508959211, "post_id": 46940098, "comment_id": 80828143, "body": "How you are planning that users can &quot;assign a shortcut to these addin methods&quot;? Where the shortcuts will be located?"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 0, "creation_date": 1508959292, "post_id": 46940098, "comment_id": 80828186, "body": "You mean keyboard shortcuts?"}, {"owner": {"reputation": 55, "user_id": 7957626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b62e9021c3b440f2c148a365a840bff0?s=128&d=identicon&r=PG&f=1", "display_name": "siz", "link": "https://stackoverflow.com/users/7957626/siz"}, "edited": false, "score": 0, "creation_date": 1508960046, "post_id": 46940098, "comment_id": 80828580, "body": "yes, keyboard shortcuts."}], "answers": [{"tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": true, "score": 0, "last_activity_date": 1508960815, "creation_date": 1508960815, "answer_id": 46940920, "question_id": 46940098, "link": "https://stackoverflow.com/questions/46940098/keyboard-shortcut-to-call-a-function-in-an-excel-addin/46940920#46940920", "title": "Keyboard shortcut to call a function in an Excel addin", "body": "<p>Your add-in could, in its Workbook_Open event, use <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-onkey-method-excel\" rel=\"nofollow noreferrer\">Application.OnKey</a> so as to associate some of its methods to certain key combinations. Make sure not to intercept key combinations that Excel has a use for already.</p>\n"}], "owner": {"reputation": 55, "user_id": 7957626, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b62e9021c3b440f2c148a365a840bff0?s=128&d=identicon&r=PG&f=1", "display_name": "siz", "link": "https://stackoverflow.com/users/7957626/siz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 929, "favorite_count": 0, "accepted_answer_id": 46940920, "answer_count": 1, "score": 1, "last_activity_date": 1508963209, "creation_date": 1508957840, "last_edit_date": 1508963209, "question_id": 46940098, "link": "https://stackoverflow.com/questions/46940098/keyboard-shortcut-to-call-a-function-in-an-excel-addin", "title": "Keyboard shortcut to call a function in an Excel addin", "body": "<p>We have an excel addin with functions and sub routines. The addin is copied to </p>\n\n<p>C:\\Users\\&lt;>\\AppData\\Roaming\\Microsoft\\AddIns folder. </p>\n\n<p>We are able to assign excel ribbon items to these functions and they work well. </p>\n\n<p>Users would love ability to assign a shortcut to these addin methods. Can this be done?</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 2, "creation_date": 1508958054, "post_id": 46940068, "comment_id": 80827453, "body": "<code>AFirstBlankRow = CLastFundRow + 1</code>: AFirstBlankRow will always = 1. Need to change that to <code>AFirstBlankRow = ALastFundRow + 1</code>"}, {"owner": {"reputation": 17, "user_id": 8462899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f1c2cafbf19ce1c8e3f2fa1c6a9f29?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Duran", "link": "https://stackoverflow.com/users/8462899/christian-duran"}, "reply_to_user": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1508958402, "post_id": 46940068, "comment_id": 80827680, "body": "Thanks but that&#39;s just a nuance in the spreadsheet. Column C will always contain the last row with a cell that contains data. I tried it anyways but nothing changed. Still having the issue with rows 7 and 8 swapping."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1508958573, "post_id": 46940068, "comment_id": 80827779, "body": "I can&#39;t find what is your question..."}, {"owner": {"reputation": 17, "user_id": 8462899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f1c2cafbf19ce1c8e3f2fa1c6a9f29?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Duran", "link": "https://stackoverflow.com/users/8462899/christian-duran"}, "edited": false, "score": 0, "creation_date": 1508959188, "post_id": 46940068, "comment_id": 80828134, "body": "@DavidG. essentially when the last group of code is executed, rows 7 and 8 swap places even though I used the clearcontents function which should shift any of the cells."}], "owner": {"reputation": 17, "user_id": 8462899, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78f1c2cafbf19ce1c8e3f2fa1c6a9f29?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Duran", "link": "https://stackoverflow.com/users/8462899/christian-duran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508959120, "creation_date": 1508957724, "last_edit_date": 1508959120, "question_id": 46940068, "link": "https://stackoverflow.com/questions/46940068/cells-shift-when-clearing", "title": "cells shift when clearing", "body": "<p>I'm having an issue with some code that I've written for a worksheet that copies data from another sheet. Simply put, cells A8 through I1000 or so are filled with formulas and the like. Essentially these are filled with data from another sheet automatically through this code.</p>\n\n<pre><code>Sub CopyPasteC()\n\nDim ALastFundRow As Integer\nDim AFirstBlankRow As Integer\nDim wksSource As Worksheet, wksDest As Worksheet\nDim rngStart As Range, rngSource As Range, rngDest As Range\n\nSet wksSource = ActiveWorkbook.Sheets(\"dt\")\nSet wksDest = ActiveWorkbook.Sheets(\"Wr\")\n\nOn Error Resume Next\n\n'Finds last row of content\nALastFundRow = wksSource.Range(\"A2\").End(xlDown).Row\n\n 'Finds first row without content\nAFirstBlankRow = CLastFundRow + 1\n\n'Copy Data\nSet rngSource = wksSource.Range(\"A2:A\" &amp; ALastFundRow)\n\n'Paste Data Values\nSet rngDest = wksDest.Range(\"C8:C\" &amp; ALastFundRow + 7)\n\nrngSource.Copy\n\nrngDest.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n\n'Bring back to top of sheet for consistancy\nwksDest.Range(\"C8\").Select\n\nEnd Sub\n</code></pre>\n\n<p>However, when the dt sheet is blank, the wr sheet tries to pull all of this unsuccessfully since there is nothing there and is left with the old data. </p>\n\n<p>Instead I'd like it to appear blank with the formulas intact. So I used this code:</p>\n\n<pre><code>Sub Deleteallbutformulas()\n\nOn Error Resume Next\n\nRange(\"A8:M500\").Select\nSelection.SpecialCells(xlCellTypeConstants).ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>However, for whatever reason even though I'm using clearcontents, the cells in row 7, which are filled with label headers, shift down one cell to row 8 and switch places so that row 7 is now filled with the formulas that belong in row 8. I've checked for merged cells and all and can't find the issue that's making the cells move.</p>\n\n<p>Any help would be appreciated. Thanks!</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1508960775, "post_id": 46939774, "comment_id": 80828982, "body": "You should place your code in an optAnswer_AfterUpdate sub.  That way it will run after the user has made their selection from the option group."}, {"owner": {"reputation": 5, "user_id": 8833375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c934e1c5bebe9959a078302ee35d2553?s=128&d=identicon&r=PG&f=1", "display_name": "Wingrider", "link": "https://stackoverflow.com/users/8833375/wingrider"}, "reply_to_user": {"reputation": 834, "user_id": 7254350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d50e0010acd2ec89f9242bfa8ea48e9?s=128&d=identicon&r=PG&f=1", "display_name": "tlemaster", "link": "https://stackoverflow.com/users/7254350/tlemaster"}, "edited": false, "score": 0, "creation_date": 1508961738, "post_id": 46939774, "comment_id": 80829490, "body": "I appreciate the input.  Can you provide an example.  I have edited my original question to show I have tried both sub routines and functions to no avail."}, {"owner": {"reputation": 1684, "user_id": 5936117, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/KO8Gd.jpg?s=128&g=1", "display_name": "MoondogsMaDawg", "link": "https://stackoverflow.com/users/5936117/moondogsmadawg"}, "edited": false, "score": 0, "creation_date": 1508963661, "post_id": 46939774, "comment_id": 80830427, "body": "That won&#39;t solve the problem. AfterUpdate will properly trigger an event, but your given code will loop through every test question before the user can do anything. You need to get rid of the loop. Frankly, I&#39;d get rid of the recordset altogether. Why not bind the form to the course table and apply filters to show each question, one at a time and use a submit button or AfterUpdate event to process the answer and move to the next question?"}, {"owner": {"reputation": 5, "user_id": 8833375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c934e1c5bebe9959a078302ee35d2553?s=128&d=identicon&r=PG&f=1", "display_name": "Wingrider", "link": "https://stackoverflow.com/users/8833375/wingrider"}, "edited": false, "score": 0, "creation_date": 1508964897, "post_id": 46939774, "comment_id": 80831074, "body": "Yes, that is the problem I have been having, the code keeps looping and will not wait for user input.  As far as the recordset, this identifies which test bank to open (it is a query).  I am not sure how I would bind the form to this variable otherwise.  If I do this, I assume a &quot;Next Record&quot; button would move to the next question in this query, am I correct?  Then I would need to somehow capture the response to the optiongroup."}, {"owner": {"reputation": 152, "user_id": 6443666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GMeVw.jpg?s=128&g=1", "display_name": "xpofer", "link": "https://stackoverflow.com/users/6443666/xpofer"}, "edited": false, "score": 0, "creation_date": 1508973532, "post_id": 46939774, "comment_id": 80834367, "body": "Several ways to attack... Question: Do you want the person to select an answer and then click a &#39;Submit&#39; button, or just select an answer and the rest happens automatically? (makes a difference where you put the code...)"}, {"owner": {"reputation": 5, "user_id": 8833375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c934e1c5bebe9959a078302ee35d2553?s=128&d=identicon&r=PG&f=1", "display_name": "Wingrider", "link": "https://stackoverflow.com/users/8833375/wingrider"}, "reply_to_user": {"reputation": 152, "user_id": 6443666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GMeVw.jpg?s=128&g=1", "display_name": "xpofer", "link": "https://stackoverflow.com/users/6443666/xpofer"}, "edited": false, "score": 0, "creation_date": 1509023312, "post_id": 46939774, "comment_id": 80857496, "body": "@xpofer, I would prefer a &#39;Submit&#39; button, although it would be interesting to see how many wrong answers they get if selecting the first answer they think is correct.  No, I&#39;m not a sadist, so yes, a &#39;Submit&#39; button would most likely be best."}, {"owner": {"reputation": 152, "user_id": 6443666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GMeVw.jpg?s=128&g=1", "display_name": "xpofer", "link": "https://stackoverflow.com/users/6443666/xpofer"}, "edited": false, "score": 0, "creation_date": 1509084420, "post_id": 46939774, "comment_id": 80884305, "body": "@Wingrider, I&#39;m going to start an answer, basically because it&#39;s easier to read.  I&#39;ll type up some code then you can leave comments on the answer and we&#39;ll keep refining the answer together until it&#39;s something useful for you."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8833375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c934e1c5bebe9959a078302ee35d2553?s=128&d=identicon&r=PG&f=1", "display_name": "Wingrider", "link": "https://stackoverflow.com/users/8833375/wingrider"}, "edited": false, "score": 0, "creation_date": 1509114001, "post_id": 46969629, "comment_id": 80901935, "body": "OMG, you&#39;re the man!  I had to tweak a couple of variables in the code but it works exactly as I need.  Now I just have to extract the number of questions answered incorrectly and the trainee&#39;s name, and append this to a table for future use.  I have been searching dozens of VBA sites looking for answers to my problems.  I figured the solution wouldn&#39;t be extremely difficult, but this appears to be a very simple process, if you know what you are doing.  Thank you very much, it is deeply appreciated."}], "tags": [], "owner": {"reputation": 152, "user_id": 6443666, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GMeVw.jpg?s=128&g=1", "display_name": "xpofer", "link": "https://stackoverflow.com/users/6443666/xpofer"}, "is_accepted": true, "score": 0, "last_activity_date": 1509089012, "creation_date": 1509089012, "answer_id": 46969629, "question_id": 46939774, "link": "https://stackoverflow.com/questions/46939774/get-user-input-from-optiongroup-before-proceeding/46969629#46969629", "title": "Get user input from optiongroup before proceeding", "body": "<p>This is just one of a million different ways of doing this.  My feelings aren't hurt if other people chime in with other ways.  But this solution may be most in-line with the road you're already headed down:</p>\n\n<p>You need a way to pass your strCourse to the form.<br>\n-One way would be to declare a <code>String</code> variable <code>strCourse</code> in the frmAnswers class module and set it from the frmIntroduction_VBA after you open frmAnswers.<br>\n-Another way would be to create an invisible field on frmAsnwers called <code>strCourse</code> and set it after you open the form with <code>form!frmAnswers!strCourse=strCourse</code>.<br>\n-The easiest way I think for you would just be to refer to the frmIntroduction_VBA form <em>from</em> the frmAnswers form.  That's what we'll do here.</p>\n\n<p>First things first:  Open frmAnswers.</p>\n\n<pre><code>DoCmd.OpenForm(\"frmAnswers\")\n</code></pre>\n\n<p>Now let's move all the rest of your code into the frmAnswers form itself.  Here's the frmAnswers class module:</p>\n\n<pre><code>Option Explicit\n\n'The following will be variables that will persist as long as the form is open\n\ndim rsCourse as Recordset\ndim strCourse as String\ndim rcdCnt as Long\ndim strCorrectAnswer as String\n\nPrivate Sub Form_Load()    'This basically initializes the variables and loads the first question\n\n    If IsNull(Forms!frmIntroduction_VBA!cboCourse) Then\n        strCourse = Forms!frmIntroduction_VBA!cboVol\n    Else\n        strCourse = Forms!frmIntroduction_VBA!cboCourse\n        End If\n\n    Set rsCourse = CurrentDb.OpenRecordset(strCourse)\n\n    rcdCnt = 0\n\n    LoadNextQuestion\n\n    End Sub\n\n\n\nPrivate Sub LoadNextQuestion()   'reusable code to load questions\n\n    rcdCnt=rcdCnt+1\n    If (rcdCnt&gt;100) OR rsCourse.EOF Then\n        rs.Close\n        DoCmd.Close acForm, \"frmAnswers\"\n        Exit Sub\n        End If\n\n    With rsCourse\n        ctlQ_No = rcdCnt\n        ctlQuestion = !Question\n        ctlAns_A = ![Ans A]\n        ctlAns_B = ![Ans B]\n        ctlAns_C = ![Ans C]\n        ctlAns_D = ![Ans D]\n        strCorrectAnswer = ![Correct Answer]\n        optAnswer = Null   'clears previous answer\n        optAnswer.SetFocus\n\n        .MoveNext\n\n        End With\n    End Sub\n\n\n\n\nPrivate Sub btnSubmit_Click()\n    Dim strAnswer As String\n\n    strAnswer = \"Nothing\"\n    Select Case optAnswer\n        Case 1:\n            strAnswer = \"A\"\n        Case 2:\n            strAnswer = \"B\"\n        Case 3:\n            strAnswer = \"C\"\n        Case 4:\n            strAnswer = \"D\"\n        End Select\n\n    If strAns = strCorrectAnswer Then\n        MsgBox \"Correct!\"\n    Else\n        MsgBox \"The correct answer is \" &amp; strCorrectAnswer &amp; \".\" _\n            &amp; Chr(13) &amp; Chr(10) &amp; \"You answered \" &amp; strAns &amp;\".\"\n        End If\n\n    LoadNextQuestion\n\n    End Sub\n</code></pre>\n\n<p>Start with that and play around with it.  If you're not sure why I did something a certain or if I missed some fundamental aspect of what you're doing, leave it in a comment and we'll keep refining it.</p>\n"}], "owner": {"reputation": 5, "user_id": 8833375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c934e1c5bebe9959a078302ee35d2553?s=128&d=identicon&r=PG&f=1", "display_name": "Wingrider", "link": "https://stackoverflow.com/users/8833375/wingrider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 46969629, "answer_count": 1, "score": 0, "last_activity_date": 1509089012, "creation_date": 1508956586, "last_edit_date": 1508966068, "question_id": 46939774, "link": "https://stackoverflow.com/questions/46939774/get-user-input-from-optiongroup-before-proceeding", "title": "Get user input from optiongroup before proceeding", "body": "<p>I have a database that generates test questions in a random order.  When I get the answer form (frmAnswers) to open, all I can do is have it scroll through all the questions using either the Enter or esc keys.  I have a MsgBox that pops up just to let me know some of the variables are set properly, but the code will not pause to accept input from the OptionGroup in the form.</p>\n\n<p>Here is what I assume is the relevant code:</p>\n\n<pre><code>    Set rsCourse = CurrentDb.OpenRecordset(strCourse)\n\n    DoCmd.OpenForm (\"frmAnswers\")\n\nrcdCnt = 1\n\nWhile Not rsCourse.EOF\n    With rsCourse\n\n        Screen.ActiveForm.ctlQ_No = rcdCnt\n        Screen.ActiveForm.ctlQuestion = .Fields(\"Question\")\n        Screen.ActiveForm.ctlAns_A = .Fields(\"Ans A\")\n        Screen.ActiveForm.ctlAns_B = .Fields(\"Ans B\")\n        Screen.ActiveForm.ctlAns_C = .Fields(\"Ans C\")\n        Screen.ActiveForm.ctlAns_D = .Fields(\"Ans D\")\n\n        Forms!frmAnswers!optAnswer.SetFocus\n\n        Select Case Forms.frmAnswers.optAnswer\n            Case Is = 1:  strAns = \"A\"\n            Case Is = 2:  strAns = \"B\"\n            Case Is = 3:  strAns = \"C\"\n            Case Is = 4:  strAns = \"D\"\n            Case Is = Null:  srtAns = \"Nothing\"\n        End Select\n\n        If strAns = .Fields(\"Correct Answer\") Then\n        Exit Sub\n\n        Else\n\n        MsgBox \"The correct answer is \" &amp; .Fields(\"Correct Answer\") _\n        &amp; Chr(13) &amp; Chr(10) &amp; \"You answered \" &amp; strAns\n\n        End If\n\n    End With\n\n    rcdCnt = rcdCnt + 1\n\n    If rcdCnt &gt; 100 Then\n    Exit Sub\n    End If\n\n    rsCourse.MoveNext\n\nWend\n</code></pre>\n\n<p>I have searched many sites, to include Microsoft, pcreview, accessmvp, etc., and have yet to find anything that helps.  I have tried;</p>\n\n<pre><code>    Select Case \n        Case 1\n        Case 2\n        Etc.\n    End Select\n</code></pre>\n\n<p>as well as the code in my example.  Nothing seems to pause the code except the MsgBox.</p>\n\n<p>I have also tried putting this code as a Function:</p>\n\n<pre><code>    Call TestClick(strCourse)\n</code></pre>\n\n<p>With the function:</p>\n\n<pre><code>    Function TestClick(strCourse)\n</code></pre>\n\n<p>with the above code in the function.  It returns a compile error: \"Object required\" at the Set rsCourse line.</p>\n\n<p>I have also tried this as a subroutine with the same error.</p>\n\n<p>For clairification, here is the code I have for the form that calls the frmAnswers Form:</p>\n\n<pre><code>    DoCmd.OpenForm (\"frmIntroduction_VBA\")\n\n    If IsNull(Me.cboTrainee_Name) Then                                    ' No Name\n        MsgBox \"You must enter your name to continue!\", vbOKOnly          ' Tell user\n        Me.cboTrainee_Name.SetFocus                                       ' Focus the control\n        Exit Sub                                                          ' Exit the method\n    End If                                                                ' End the IsNull test\n\n    Trainee_Name = Forms!frmIntroduction_VBA!cboTrainee_Name\n\n    If IsNull(Me.cboCourse) Then                                          ' Check if a course is selected\n        If IsNull(Me.cboVol) Then\n            MsgBox \"You must select either a Course or Volume Review to continue!\"         ' Tell user\n            Me.cboCourse.SetFocus\n        Exit Sub\n        End If\n    End If\n\n    If IsNull(Me.cboCourse) Then\n        strCourse = Me.cboVol.Value\n    Else\n        strCourse = Me.cboCourse.Value\n    End If\n</code></pre>\n\n<p>I would like this to actually call another Sub for the frmAnswers form, but do not know how to pass the rsCourse variable to the Sub.</p>\n\n<p>I am sure this is a fairly easy issue to resolve, but I am no expert by any means.  Once I get this problem solved, I will continue on and try to have VBA create a recordset with test results to be appended to an existing table.</p>\n\n<p>Thank you all for any assistance you can provide.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508957347, "post_id": 46939615, "comment_id": 80827054, "body": "Are you giving the filename an extension? There&#39;s a lot of missing information about the value of your variables making it difficult for us to troubleshoot."}, {"owner": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508962543, "post_id": 46939615, "comment_id": 80829898, "body": "This is all the code that I have. All that I&#39;ve removed is the destination folder name because it has full name and details. My code currently successfully creates a folder in the right location with the right name, creates a file with the right name and saves it. All I need to add is a line of code to Save it IN the folder I&#39;ve created, which I can&#39;t figure out how to do."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 0, "creation_date": 1508956756, "post_id": 46939725, "comment_id": 80826705, "body": "Sorry that hasn&#39;t been the issue as it creates the folder fine. I changed the path because it had personal details lol. An example for POname would be &quot;PO 123456-789 Example&quot;. The folder and new excel file would have this same name."}, {"owner": {"reputation": 1, "user_id": 3750437, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002890493600/picture?type=large", "display_name": "leonardoAK", "link": "https://stackoverflow.com/users/3750437/leonardoak"}, "reply_to_user": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 0, "creation_date": 1508957357, "post_id": 46939725, "comment_id": 80827059, "body": "Ah, i see, hahaah. The problem is in the save part of the script, then? Try this: <code>ActiveWorkbook.SaveAs NewfolderPath &amp; &quot;\\&quot; &amp; POname</code>"}, {"owner": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 0, "creation_date": 1508958681, "post_id": 46939725, "comment_id": 80827850, "body": "So just to clarify, this currently creates the folder properly, creates and saves the workbook properly... all I want to change is save the file inside the new folder I&#39;ve created. I don&#39;t have any code for that right now and can&#39;t figure it out"}, {"owner": {"reputation": 1, "user_id": 3750437, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002890493600/picture?type=large", "display_name": "leonardoAK", "link": "https://stackoverflow.com/users/3750437/leonardoak"}, "reply_to_user": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 2, "creation_date": 1508958987, "post_id": 46939725, "comment_id": 80828020, "body": "This saves the file in the newfolderPath that you just created <code>ActiveWorkbook.SaveAs NewfolderPath &amp; &quot;\\&quot; &amp; POname</code>"}], "tags": [], "owner": {"reputation": 1, "user_id": 3750437, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002890493600/picture?type=large", "display_name": "leonardoAK", "link": "https://stackoverflow.com/users/3750437/leonardoak"}, "is_accepted": false, "score": 0, "last_activity_date": 1508991942, "last_edit_date": 1508991942, "creation_date": 1508956376, "answer_id": 46939725, "question_id": 46939615, "link": "https://stackoverflow.com/questions/46939615/how-to-create-folder-file-and-save-file-in-folder/46939725#46939725", "title": "How to Create Folder, File, and Save File in Folder", "body": "<p>Can you provide a string example of POname that you are using?\nI think you missed a '\\' in NewfolderPath:</p>\n\n<p>Try: </p>\n\n<pre><code>Sub NewWB2()\n    Dim wb As Workbook\n    Dim POname As String\n    Dim lrow As Long\n    Dim NewfolderPath As String\n\n    lrow = Cells(Rows.Count, 3).End(xlUp).Row 'finds the last row\n    POname = Worksheets(\"Sheet1\").Cells(lrow, 10).Value 'name of Folder and File\n    NewfolderPath = \"C:\\destinationfoldername\\\" &amp; POname\n\n    MkDir NewfolderPath 'creates the new folder with the name defined above\n    Set wb = Workbooks.Add(\"C:\\folderwithtemplate\\Template.xltm\") 'creates new wb from template\n\n    ActiveWorkbook.SaveAs NewfolderPath &amp; \"\\\" &amp; POname\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 0, "creation_date": 1508959584, "post_id": 46940451, "comment_id": 80828355, "body": "I currently have &quot;ActiveWorkbook.SaveAs Filename:=POname&quot;. All this does is save the file with the variable name that I would like. What do I add so that it saves in the new folder I&#39;ve created and named."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 0, "creation_date": 1508960904, "post_id": 46940451, "comment_id": 80829056, "body": "Please see my new Line, I&#39;m adding the NewfolderPath variable."}, {"owner": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 0, "creation_date": 1508963969, "post_id": 46940451, "comment_id": 80830560, "body": "Check out my edited post... I couldn&#39;t get that to work"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 0, "creation_date": 1508964115, "post_id": 46940451, "comment_id": 80830623, "body": "Please use <code>Debug.Print NewfolderPath &amp; &quot;\\&quot; &amp; POname</code> and let me know what value is printed in the immediate window."}, {"owner": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 0, "creation_date": 1508964700, "post_id": 46940451, "comment_id": 80830951, "body": "I&#39;m not sure exactly how to do that. I&#39;m now getting &quot;Run-time error &#39;76&#39;: Path not Found.&quot; and it highlights this line: <code>MkDir &quot;C:\\Users\\First.Last\\Desktop&quot; &amp; &quot;\\&quot; &amp; POname</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 0, "creation_date": 1508964935, "post_id": 46940451, "comment_id": 80831094, "body": "Do you have a C:\\Users*<i>First.Last*</i> folder already created? To use <code>Debug.Print</code> just copy and paste the code line in your code, this will show the value of those variables in the immediate Window. You can activate using <b>Ctrl+G</b> in your MS VBA window."}, {"owner": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 0, "creation_date": 1508965312, "post_id": 46940451, "comment_id": 80831318, "body": "C:\\Users\\First.Last\\Desktop is all created. the folder I create is titled with the variable POName. The Debug.Print value for what you asked is C:\\Users\\Devyn.Plett\\Desktop\\POname\\POName (actually shows the value of the variable - POName)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 0, "creation_date": 1508965568, "post_id": 46940451, "comment_id": 80831450, "body": "Updated my answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "edited": false, "score": 0, "creation_date": 1509019615, "post_id": 46940451, "comment_id": 80854715, "body": "So good to know!!! Can you please mark my answer as resolve your problem an advice the other guys your question was answered?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 0, "last_activity_date": 1508965552, "last_edit_date": 1508965552, "creation_date": 1508959048, "answer_id": 46940451, "question_id": 46939615, "link": "https://stackoverflow.com/questions/46939615/how-to-create-folder-file-and-save-file-in-folder/46940451#46940451", "title": "How to Create Folder, File, and Save File in Folder", "body": "<p>Try with this, guess you are missing your Filename:</p>\n\n<pre><code>ActiveWorkbook.SaveAS Filename:=NewfolderPath &amp; \"\\\" &amp; POname &amp; \"\\Filename\" \n</code></pre>\n\n<p>if you are using a Variable for your filename try:</p>\n\n<pre><code>ActiveWorkbook.SaveAS Filename:=NewfolderPath &amp; \"\\\" &amp; POname &amp; \"\\\" &amp; Filename \n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 8116404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80283dbb167c26992745c4f7f1c9e364?s=128&d=identicon&r=PG&f=1", "display_name": "Dev", "link": "https://stackoverflow.com/users/8116404/dev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1508991942, "creation_date": 1508956005, "last_edit_date": 1508963950, "question_id": 46939615, "link": "https://stackoverflow.com/questions/46939615/how-to-create-folder-file-and-save-file-in-folder", "title": "How to Create Folder, File, and Save File in Folder", "body": "<p>EDIT: Wasn't clear enough with my question</p>\n\n<pre><code>Sub NewWB2()\nDim wb As Workbook\nDim POname As String\nDim lrow As Long\nDim NewfolderPath As String\n\nlrow = Cells(Rows.Count, 3).End(xlUp).Row\nPOname = Worksheets(\"Sheet1\").Cells(lrow, 10).Value 'name I want for both the folder and the document\n\nMkDir \"C:\\Users\\First.Last\\Desktop\" &amp; \"\\\" &amp; POname 'creates the folder in the path I want\nNewfolderPath = \"C:\\Users\\First.Last\\Desktop\\\" &amp; POname ' variable to define that path\n\nSet wb = Workbooks.Add(\"C:\\Users\\First.Last\\Documents\\Custom Office Templates\\PO Template.xltm\") ' creates from template\nActiveWorkbook.SaveAs Filename:=POName 'Saves file as variable \"POname\"\n\nEnd Sub\n</code></pre>\n\n<p>Everything here works. All I need to do is to add a line of code that will save the new workbook in the folder I've created. I can't find how to do this and don't know how to add this in.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 1, "last_activity_date": 1508955643, "creation_date": 1508955643, "answer_id": 46939513, "question_id": 46939255, "link": "https://stackoverflow.com/questions/46939255/how-to-delete-multiple-checkbox-in-excel-by-vba/46939513#46939513", "title": "How to delete multiple checkbox in Excel by VBA?", "body": "<p>Use the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-intersect-method-excel\" rel=\"nofollow noreferrer\">Application.Intersect Method (Excel)</a> to tests if multiple ranges intersect, share cells with, each other.</p>\n\n<pre><code>Dim cb As CheckBox\nWith Sheets(\"Job_Card_Update\")\n    For Each cb In .CheckBoxes\n        If Not Intersect(cb.TopLeftCell, .Range(\"M13:M20\")) Is Nothing Then cb.Delete\n    Next\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8833354, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QFdvfr7FNO8/AAAAAAAAAAI/AAAAAAAAAHU/FEySuq0M7Yw/photo.jpg?sz=128", "display_name": "sumendu kumar", "link": "https://stackoverflow.com/users/8833354/sumendu-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508956718, "creation_date": 1508954740, "last_edit_date": 1508956718, "question_id": 46939255, "link": "https://stackoverflow.com/questions/46939255/how-to-delete-multiple-checkbox-in-excel-by-vba", "title": "How to delete multiple checkbox in Excel by VBA?", "body": "<p>I am trying to delete multiple checkoxes using VBA.</p>\n\n<p>The code i have so far is as as follows:</p>\n\n<pre><code>Sub DeleteCheckbox()\n    Dim cb As CheckBox\n\n    For Each cb In Sheets(\"Job_Card_Update\").CheckBoxes\n        If cb.TopLeftCell.Address = Sheets(\"Job_Card_Update\").Range(\"M13:M20\").Address Then cb.Delete\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 1, "creation_date": 1508954411, "post_id": 46939098, "comment_id": 80825390, "body": "add 4 <code>blank</code> in front of each line of your code"}, {"owner": {"reputation": 1, "user_id": 8816476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb05b6329d170a4995e3e4319afffeb8?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/8816476/bruce"}, "reply_to_user": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "edited": false, "score": 0, "creation_date": 1508955568, "post_id": 46939098, "comment_id": 80826040, "body": "Thank you. I tried the edit which suggested 2 blanks and that did nothing"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1508958979, "post_id": 46939098, "comment_id": 80828014, "body": "Is this an activeX control or a forms control?"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8816476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb05b6329d170a4995e3e4319afffeb8?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/8816476/bruce"}, "is_accepted": false, "score": 0, "last_activity_date": 1509039647, "creation_date": 1509039647, "answer_id": 46960603, "question_id": 46939098, "link": "https://stackoverflow.com/questions/46939098/enabled-textboxs-not-responding-in-change-or-ddbclick-events/46960603#46960603", "title": "enabled Textboxs not responding in change or ddbclick events", "body": "<p>I am unable to find a cure other than cutting and replacing all 16 textboxes. That solved the problem but did not find a reason for then to have quit working.</p>\n"}], "owner": {"reputation": 1, "user_id": 8816476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb05b6329d170a4995e3e4319afffeb8?s=128&d=identicon&r=PG&f=1", "display_name": "Bruce", "link": "https://stackoverflow.com/users/8816476/bruce"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1509039647, "creation_date": 1508954245, "last_edit_date": 1508958641, "question_id": 46939098, "link": "https://stackoverflow.com/questions/46939098/enabled-textboxs-not-responding-in-change-or-ddbclick-events", "title": "enabled Textboxs not responding in change or ddbclick events", "body": "<pre><code>    Sub LMtgAmt_DblClick(ByVal Cancel As MSForms.ReturnBoolean)\n    Dim ProgError\n    Dim TxtBox As MSForms.TextBox\n    Set TxtBox = LMtgAmt\n    MsgBox \"in click\"\n    ' first variable is the control - textbox\n    'the second variable is the topic:Mortgage =1, PSE = 2, Tacom Ut = 3...\n    'The third variable is 1 for Todd and 2 for Linell\n    ProgError = Processpayment(TxtBox, \"1\", \"2\")\n    Exit Sub\nEnd Sub\nSub LMtgAmt_Change()\n    Dim ProgError\n    Dim TxtBox As MSForms.TextBox\n    Set TxtBox = LMtgAmt\n    MsgBox \"in Change\"\n    ' first variable is the control - textbox\n    'the second variable is the topic:Mortgage =1, PSE = 2, Tacom Ut = 3...\n    'The third variable is 1 for Todd and 2 for Linell\n    ProgError = Processpayment(TxtBox, \"1\", \"2\")\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "internet-explorer", "slp"], "comments": [{"owner": {"reputation": 8346, "user_id": 534943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f83f0fde2b9129daa3b0f01769055d6d?s=128&d=identicon&r=PG", "display_name": "Styx", "link": "https://stackoverflow.com/users/534943/styx"}, "edited": false, "score": 1, "creation_date": 1508955042, "post_id": 46939000, "comment_id": 80825745, "body": "Is this missing <code>&quot;</code> after <code>div</code> your typo or the original script error?"}, {"owner": {"reputation": 1, "user_id": 8833111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pa8aa.jpg?s=128&g=1", "display_name": "NathanPalme", "link": "https://stackoverflow.com/users/8833111/nathanpalme"}, "reply_to_user": {"reputation": 8346, "user_id": 534943, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f83f0fde2b9129daa3b0f01769055d6d?s=128&d=identicon&r=PG", "display_name": "Styx", "link": "https://stackoverflow.com/users/534943/styx"}, "edited": false, "score": 0, "creation_date": 1508955431, "post_id": 46939000, "comment_id": 80825981, "body": "just a typo. i get no compiler errors :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1508955985, "post_id": 46939000, "comment_id": 80826261, "body": "Why are you search the collection and not using <code>Dim div As HTMLDivElement</code> and  <code>Set div = IE.document.getElementById(&quot;SampleID&quot;)</code>.  Are there multiple elements withthe same ID?"}, {"owner": {"reputation": 1, "user_id": 8833111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pa8aa.jpg?s=128&g=1", "display_name": "NathanPalme", "link": "https://stackoverflow.com/users/8833111/nathanpalme"}, "edited": false, "score": 0, "creation_date": 1508956197, "post_id": 46939000, "comment_id": 80826398, "body": "You are right, that would be more  reasonable. But it should work like this too"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1508956792, "post_id": 46939000, "comment_id": 80826731, "body": "You cannot exit from a While ... Wend loop unless you use a GoTo. Maybe switch to a For ... Next so you can Exit For after the click."}, {"owner": {"reputation": 1, "user_id": 8833111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pa8aa.jpg?s=128&g=1", "display_name": "NathanPalme", "link": "https://stackoverflow.com/users/8833111/nathanpalme"}, "edited": false, "score": 0, "creation_date": 1508956939, "post_id": 46939000, "comment_id": 80826814, "body": "Yeah but it doesn&#39;t even search the right source code, so it wont work with a For...Next either. But thanks for the tip!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1508956987, "post_id": 46939000, "comment_id": 80826836, "body": "Then maybe <a href=\"https://stackoverflow.com/search?q=%5Bvba%5Diframe+div\">search this site</a> for <i>vba iframe div</i> and come up with something like <a href=\"https://stackoverflow.com/questions/44902558/accessing-object-in-iframe-using-vba\">this</a>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1508958480, "post_id": 46939000, "comment_id": 80827724, "body": "Don&#39;t use &quot;view source&quot; for this - open up your browser&#39;s Developer tools (F12) and use the tools there to view the as-rendered HTML. Or in IE just right-click the element you want to work with and select &quot;inspect element&quot;"}, {"owner": {"reputation": 387, "user_id": 7630262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a74551d0063aa3c06837041235d7d571?s=128&d=identicon&r=PG&f=1", "display_name": "T. Nesset", "link": "https://stackoverflow.com/users/7630262/t-nesset"}, "edited": false, "score": 0, "creation_date": 1508998445, "post_id": 46939000, "comment_id": 80841108, "body": "Well I dont have the source code for the page you trying to work with, but i normally would something like this: <code>Set objCollection = ie.Document.getElementsByTagName(&quot;input&quot;) While i &lt; objCollection.Length   If objCollection(i).Name = &quot;ctl00$MainContent$txtUsername&quot; Then    objCollection(i).Value = &quot;MyUsername&quot;    End If i = i + 1 Wend</code>"}, {"owner": {"reputation": 387, "user_id": 7630262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a74551d0063aa3c06837041235d7d571?s=128&d=identicon&r=PG&f=1", "display_name": "T. Nesset", "link": "https://stackoverflow.com/users/7630262/t-nesset"}, "edited": false, "score": 0, "creation_date": 1508998993, "post_id": 46939000, "comment_id": 80841352, "body": "Its more or less the same as you do, but I run into problems when I use &quot;div&quot;. I would also normally wait for the while..wend to be complete before I <code>.click</code>. you could store the SampleID in a new object <code>Set objElement = objCollection(i)</code> and when your while..wend is done I would <code>objElement.Click</code>"}], "owner": {"reputation": 1, "user_id": 8833111, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pa8aa.jpg?s=128&g=1", "display_name": "NathanPalme", "link": "https://stackoverflow.com/users/8833111/nathanpalme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1508955446, "creation_date": 1508953898, "last_edit_date": 1508955446, "question_id": 46939000, "link": "https://stackoverflow.com/questions/46939000/vba-with-excel-and-ie-cant-get-the-source-right-source-code", "title": "VBA with Excel and IE: Can&#39;t get the source right source code?", "body": "<p>I'm currently tyring to automate my IE at work with VBA and Excel, because we have some repetetive tasks to complete in an SAP System wich is called within the Internet Explorer.<br>\nSo far i am able to start IE and navigate to the starting page of our System. </p>\n\n<p>I looked on the source code from the Sap System to search for an id from a div (lets say its 'SampleID'). But if i try to click it via vba i only get returned 'nothing'. So i tried to print out the source code via vba Debug.Print to look at the problem. And here's the thing: </p>\n\n<p>The source code that gets printed is completely different from the Website's Source Code. In the printed code for example is a iframe that i cant find in the website source code. So thats the reason i cant find my div and any other objects, because they are not in the code that vba is searching through.\nCan anyone tell me whats going wrong? Why are the source codes completely different? I would be grateful for some tips!</p>\n\n<pre><code>Sub stgGo(){\n Dim i As Long\n Dim IE As InternetExplorerMedium\n Dim objElement As Object\n Dim objCollection As Object  \n\n Set IE = New InternetExplorer\n IE.Visible = True\n IE.Navigate (\"URL\")\n\n'waiting 10 seconds to be really sure javascript is ready\n Application.Wait (Now + TimeValue(\"0:00:10\")) \n\n'printing out the false source code\n Debug.Print strHTML = myIE.Document.body.innerHTML \n\n Set objCollection = IE.document.getElementsByTagName(\"div\")\n i = 0\n While i &lt; objCollection.Length\n  If objCollection(i).ID = \"SampleID\" Then\n   objCollection(i).Click\n  End If\n  i = i + 1\n Wend\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "methods", "find"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1508953387, "post_id": 46938775, "comment_id": 80824812, "body": "Remove your variable declaration <code>Dim result As Range</code> and <code>Option Explicit</code> if exists in your module. This way the variable type will be assigned automatically. Run your code step by step and see in your <b>Locals</b> window the type of variable assigned."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 1, "creation_date": 1508953790, "post_id": 46938775, "comment_id": 80825038, "body": "Microsoft Developers states that the Range.Find method returns a Range object that represents the first cell where that information is found."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508956139, "post_id": 46938775, "comment_id": 80826357, "body": "@DavidG. People usually tell askers to <i>add</i> <code>Option Explicit</code>, not to remove it! The type will be <code>Variant&#47;Range</code>; <code>Variant</code> because it&#39;s going to be implicitly declared on-the-fly thanks to the omission of <code>Option Explicit</code> (<b>VERY BAD IDEA</b>), and <code>&#47;Range</code> because at the end of the day the function <i>is</i> returning a <code>Range</code> object. Actually it could also be <code>Variant&#47;Error</code> given a worksheet error cell and a missing <code>Set</code> keyword in front of <code>result =</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1508958663, "post_id": 46938775, "comment_id": 80827843, "body": "@Mat&#39;sMug I ask to do it just for testing purposes. <b>Not to remove it definitely.</b>"}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 8568421, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/634630a7a72cf4f09110d2506bb2a440?s=128&d=identicon&r=PG&f=1", "display_name": "D.Yvel", "link": "https://stackoverflow.com/users/8568421/d-yvel"}, "edited": false, "score": 0, "creation_date": 1509005714, "post_id": 46939735, "comment_id": 80845273, "body": "Thanks for the answer, I thought I understood the basic principles of object orientated programming... At one point I was trying Boolean data type and that did work when the result was True- but failed when nothing."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 29, "user_id": 8568421, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/634630a7a72cf4f09110d2506bb2a440?s=128&d=identicon&r=PG&f=1", "display_name": "D.Yvel", "link": "https://stackoverflow.com/users/8568421/d-yvel"}, "edited": false, "score": 0, "creation_date": 1509017418, "post_id": 46939735, "comment_id": 80853239, "body": "@D.Yvel if you want to learn more about OOP in VBA, I invite you to read my <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">RD News</a> blog, where I&#39;m slowly recreating content that was lost when Documentation.SO went offline (and more); you&#39;ll end up with fully decoupled code that can be unit-tested. The blog also updates on the state of Rubberduck, an open-source VBIDE add-in project I manage."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1508956415, "creation_date": 1508956415, "answer_id": 46939735, "question_id": 46938775, "link": "https://stackoverflow.com/questions/46938775/what-data-type-does-find-method-return/46939735#46939735", "title": "What data type does find method return?", "body": "<p><code>Range.Find</code> returns a <code>Range</code> object reference, initialized or not, period. If <code>Range.Find</code> found anything, you get a <code>Range</code> object reference, otherwise you get <code>Nothing</code>, which is an uninitialized object reference that will make your code throw run-time error 91 \"object reference not set\" if you try to make member calls against it.</p>\n\n<blockquote>\n  <p>I have tried defining result as Range, Object, Variant, String and all give mismatch error.</p>\n</blockquote>\n\n<p>You want a <code>Range</code>. <code>Object</code> would work, however it would make all member calls made against it late-bound, i.e. resolved at run-time - you'd get no IntelliSense or auto-completion, and VBA would happily compile a typo <strong>regardless of whether</strong> <code>Option Explicit</code> <strong>is specified</strong>.</p>\n\n<p><code>Variant</code> would work as well, but again you'd lose IntelliSense, and you'd be wrapping the object reference into a <code>Variant/Object</code>, which incurs overhead you don't need.</p>\n\n<p><code>String</code> is dangerous. First, for it to even have any chance to work you need to drop the <code>Set</code> keyword. And then this is what you're <em>really</em> doing, with both the implicit default member access and implicit type conversion made explicit:</p>\n\n<pre><code>Dim result As String\nresult = CStr(Range(...).Find(...).Value)\n</code></pre>\n\n<p>The implicit default member call <code>.Value</code> is illegal against <code>Nothing</code> in the first place, and then there's no guarantee that the <code>CStr</code> string conversion will succeed: if the cell contains an error value (e.g. <code>#N/A</code>), then this is where you're getting a <em>type mismatch</em> run-time error, because an <code>Error</code> value can't be implicitly (or explicitly) converted to a <code>String</code> (or anything, actually).</p>\n\n<p>If you're getting a <em>type mismatch</em> with <code>result As Range</code>, then you're doing something with the returned <code>Range</code> object's <code>Value</code> (implicitly or explicitly) and that value is an <code>Error</code> - you can't compare an error value against any type. You need to wrap whatever it is you're doing with it, with <code>If IsError(result) Then</code> - but it looks like none of the code you posted would cause a <em>type mismatch</em> error with <code>Dim result As Range</code>, assuming <code>.Offset(0,2)</code> isn't an error value either.</p>\n"}, {"comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508960390, "post_id": 46940499, "comment_id": 80828765, "body": "I ran this code because I haven&#39;t seen the table reference in the range before (I just don&#39;t use tables very much) and wanted to test it and see how it worked.  It was a good learning exercise."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508960671, "post_id": 46940499, "comment_id": 80828931, "body": "Oh, you&#39;re going to LOVE tables! They&#39;re the single best Excel feature since ....forever!"}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": true, "score": 1, "last_activity_date": 1508959233, "creation_date": 1508959233, "answer_id": 46940499, "question_id": 46938775, "link": "https://stackoverflow.com/questions/46938775/what-data-type-does-find-method-return/46940499#46940499", "title": "What data type does find method return?", "body": "<p>In your find you have </p>\n\n<pre><code>After:=ActiveCell,\n</code></pre>\n\n<p>This throws a mismatch error if your active cell is not in the table you reference, \"DailyTable\".</p>\n\n<p>Also, your logic will have the message box appear if the offset is empty or not.  So if Result is nothing, then nothing, but if the offset is empty or not, you get the message.  As long as that's what you want, then why are you checking the offset to be empty?</p>\n"}], "owner": {"reputation": 29, "user_id": 8568421, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/634630a7a72cf4f09110d2506bb2a440?s=128&d=identicon&r=PG&f=1", "display_name": "D.Yvel", "link": "https://stackoverflow.com/users/8568421/d-yvel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1633, "favorite_count": 0, "accepted_answer_id": 46940499, "answer_count": 2, "score": 0, "last_activity_date": 1508959233, "creation_date": 1508953145, "question_id": 46938775, "link": "https://stackoverflow.com/questions/46938775/what-data-type-does-find-method-return", "title": "What data type does find method return?", "body": "<p>I am trying to search 3 columns contained in the range specified below. I have spent a long time looking online and I have found similar questions but when I apply it to mine I am not getting the correct answer. So far (from another questions answer) I have:</p>\n\n<pre><code>Dim result As Range \nSet result = range(\"DailyTable[[AmtNumberOut]:[AMTOutstanding]]\").find(What:=\"#N/A Requesting Data...\", After:=ActiveCell, LookIn:= _\n    xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n    xlNext, MatchCase:=False, SearchFormat:=False)\nIf result Is Nothing Then\n\nElseIf IsEmpty(result.Offset(0, 2)) Then\n    MsgBox (\"Please wait for information to finish downloading. Import cancelled.\")\n    Exit Sub\nElse\n    MsgBox (\"Please wait for information to finish downloading. Import cancelled.\")\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>I understand that find returns nothing if no value is found which can cause issues with data types but I have tried defining result as Range, Object, Variant, String and all give mismatch error. I also read somewhere that it can return Boolean outputs (which did not work either). I have spent a long time stuck on a simple problem and I would be very grateful for any answers!</p>\n\n<p>Thanks. </p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 95, "user_id": 3752718, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/978588b1dec1dc472cce2f912825f4f6?s=128&d=identicon&r=PG&f=1", "display_name": "user3752718", "link": "https://stackoverflow.com/users/3752718/user3752718"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1508951615, "post_id": 46938196, "comment_id": 80823785, "body": "@ErikvonAsmuth I did also tried simply doing &#39;me.subformName.Form.RecordSource= sQueryCurrencyRate&#39; and &#39;me.subformName.RecordSource= sQueryCurrencyRate&#39; without any success , It&#39;s weird"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1508951649, "post_id": 46938196, "comment_id": 80823802, "body": "Where are you calling this code? On the main form?"}, {"owner": {"reputation": 95, "user_id": 3752718, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/978588b1dec1dc472cce2f912825f4f6?s=128&d=identicon&r=PG&f=1", "display_name": "user3752718", "link": "https://stackoverflow.com/users/3752718/user3752718"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1508951799, "post_id": 46938196, "comment_id": 80823882, "body": "@ErikvonAsmuth I have declared a function called Execute Query and inside of it , I&#39;m calling the code"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1508951926, "post_id": 46938196, "comment_id": 80823955, "body": "How exactly are you calling this? If you call it, is the form open or closed?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1508952092, "post_id": 46938196, "comment_id": 80824053, "body": "Please provide the <b>full</b> code block (event trigger) that runs the process, not line snippets."}, {"owner": {"reputation": 95, "user_id": 3752718, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/978588b1dec1dc472cce2f912825f4f6?s=128&d=identicon&r=PG&f=1", "display_name": "user3752718", "link": "https://stackoverflow.com/users/3752718/user3752718"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1508952193, "post_id": 46938196, "comment_id": 80824123, "body": "@ErikvonAsmuth see my edited question"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508952849, "post_id": 46938196, "comment_id": 80824502, "body": "Not familiar with Access, but shouldn&#39;t <code>RecordSourceObject</code> be a <code>Recordset</code> instance and therefore be <code>Set</code>?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1508953682, "post_id": 46938196, "comment_id": 80824979, "body": "@Mat&#39;sMug the whole <code>RecordSetObject</code> part is wrong, he intends to set <code>RecordSource</code>, which is a string SQL statement that the form uses (there also is a <code>RecordSet</code> property, but that shouldn&#39;t be changed unless you want to use an ADO recordset as recordsource)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1508953906, "post_id": 46938196, "comment_id": 80825102, "body": "@ErikvonAsmuth I&#39;d trade four fingers and a leg for a properly parameterized ADODB recordset/query over a string-concatenated, begging-for-SQL-injection <code>WHERE</code> clause like this. Sure it makes it &quot;easy&quot; to <i>get something that works</i>, but it&#39;s just plain wrong on so many levels. Same holds true for <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">UserForms and their default instance</a>, for example. Too many things are dumbed-down in VBA, it&#39;s just crazy."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508954362, "post_id": 46938196, "comment_id": 80825373, "body": "@Mat&#39;sMug I get your point. When using Access as a backend too, security is usually a moot point since users need to have write access on the database file, but when using a proper backend, an ADODB recordset is certainly preferred"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1508954862, "post_id": 46938196, "comment_id": 80825650, "body": "@ErikvonAsmuth it&#39;s not <i>just</i> about security, it&#39;s also about correctness. You want <code>Kenneth O&#39;Connor</code> to be able to fill up that <code>LastName</code> field without wrecking the front-end. Let alone <code>Robert &#39;); DROP TABLE Students;--</code> ;-)"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508955316, "post_id": 46938196, "comment_id": 80825914, "body": "@Mat&#39;sMug I fully agree, I was working on an own answer in the meantime. Unfortunately, the proper way to do it is not as concise as the easy way."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508954164, "post_id": 46938579, "comment_id": 80825257, "body": "Kudos for proper <i>date literal</i> delimiters... is there not a way to avoid string-concatenation though?"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1509004073, "last_edit_date": 1509004073, "creation_date": 1508952503, "answer_id": 46938579, "question_id": 46938196, "link": "https://stackoverflow.com/questions/46938196/error-when-trying-to-set-the-subform-recordsource-to-an-sql-query/46938579#46938579", "title": "Error when trying to set the subform recordsource to an sql query", "body": "<p>Use this:</p>\n\n<pre><code>sQueryCurrencyRate = \"SELECT * FROM Mytable WHERE As_Of_Date = #\" &amp; Format(dateField.value, \"yyyy\\/mm\\/dd\") &amp; \"#\"\n</code></pre>\n\n<p>To avoid concatenating, you could use TempVars or create a small helper function:</p>\n\n<pre><code>' Public variable:\nDim FilterDate As Date\n\nPublic Function GetFilterDate() As Date\n    GetFilterDate = FilterDate\nEnd Function\n</code></pre>\n\n<p>and then an extra line of code:</p>\n\n<pre><code>FilterDate = Me!dateField.Value\nsQueryCurrencyRate = \"SELECT * FROM Mytable WHERE As_Of_Date = GetFilterDate()\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508955515, "post_id": 46939397, "comment_id": 80826015, "body": "I think the <code>cmd.Parameters(&quot;@MyDate&quot;)</code> assignment should be <code>Set</code>, since <code>CreateParameter</code> returns an <code>ADODB.Parameter</code> object reference. Might work regardless if the property mutator&#39;s value receives a <code>Variant</code>, which would hold the pointer to the object reference. Also I think you can drop the <code>rs</code> local variable and <code>Set Me.Recordset = cmd.Execute</code>"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508958043, "post_id": 46939397, "comment_id": 80827446, "body": "@Mat&#39;sMug You&#39;re right about that second one, but the first one (changing the <code>cmd.Parameters</code> assignment to a <code>Set</code> results in a compile error (invalid use of property) for me. Don&#39;t know why, but it works without and doesn&#39;t work with the <code>Set</code>"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1508958305, "post_id": 46939397, "comment_id": 80827622, "body": "Interesting. I usually do <code>cmd.Parameters.Append cmd.CreateParameter(...)</code>"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1508958104, "last_edit_date": 1508958104, "creation_date": 1508955248, "answer_id": 46939397, "question_id": 46938196, "link": "https://stackoverflow.com/questions/46938196/error-when-trying-to-set-the-subform-recordsource-to-an-sql-query/46939397#46939397", "title": "Error when trying to set the subform recordsource to an sql query", "body": "<p>If you want to do this properly (without any risk of SQL injection), you can use an ADODB recordset:</p>\n\n<pre><code>Dim cmd As New ADODB.Command\ncmd.CommandText = \"SELECT * FROM Mytable WHERE As_Of_Date = @MyDate\"\ncmd.ActiveConnection = CurrentProject.Connection\ncmd.ActiveConnection.CursorLocation = adUseClient\ncmd.Parameters(\"@MyDate\") = cmd.CreateParameter(\"MyDate\", adDate)\ncmd.Parameters(\"@MyDate\").Value = datefield.Value\nSet Me.Recordset = cmd.Execute\n</code></pre>\n\n<p>Note that this requires a reference to the ActiveX Data Objects library</p>\n"}, {"comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1509005378, "post_id": 46947320, "comment_id": 80845073, "body": "That&#39;s a valid alternative. I&#39;ve never set <code>Me.RecordSet</code> to a DAO recordset before, since I&#39;ve always just used filters for this behavior (I&#39;ve used ADO recordsets for external databases, so had some experience with that. You might want to replace <code>.QueryDefs(&quot;qryName&quot;)</code> with <code>.CreateQueryDef(&quot;&quot;, &quot;SELECT * FROM Table.Mytable WHERE  As_Of_Date = [@MyDate]&quot;)</code> to be more applicable to the question, though, to account for the query not being stored."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1509006240, "post_id": 46947320, "comment_id": 80845659, "body": "Usually, the parameter definition can be omitted, but inserting it certainly is a good practice, especially if you rely on typecasting"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1509006123, "last_edit_date": 1509006123, "creation_date": 1508999635, "answer_id": 46947320, "question_id": 46938196, "link": "https://stackoverflow.com/questions/46938196/error-when-trying-to-set-the-subform-recordsource-to-an-sql-query/46947320#46947320", "title": "Error when trying to set the subform recordsource to an sql query", "body": "<p>Since this is in Access, why not use the default DAO interface with a parameter query instead of ADODB? No need for an ActiveX Data Objects reference.</p>\n\n<pre><code>Dim qdf As DAO.QueryDef\n\n'For an existing query\nSet qdf = CurrentDb().QueryDefs(\"qryName\")\n\n'To create query (Credit to @Erik von Asmuth for pointing this out)\nSet qdf = CurrentDb().CreateQueryDef(\"\", \"PARAMETERS [@MyDate] DateTime; SELECT * FROM Mytable WHERE As_Of_Date = [@MyDate];\")\n    qdf.Parameters(\"[@MyDate]\").Value = Date()\n\nSet Me.Recordset = qdf.OpenRecordset()\n</code></pre>\n"}], "owner": {"reputation": 95, "user_id": 3752718, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/978588b1dec1dc472cce2f912825f4f6?s=128&d=identicon&r=PG&f=1", "display_name": "user3752718", "link": "https://stackoverflow.com/users/3752718/user3752718"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 444, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1509006123, "creation_date": 1508951069, "last_edit_date": 1508952155, "question_id": 46938196, "link": "https://stackoverflow.com/questions/46938196/error-when-trying-to-set-the-subform-recordsource-to-an-sql-query", "title": "Error when trying to set the subform recordsource to an sql query", "body": "<p>I'm trying to change the recordset of a subform to display the query result </p>\n\n<p>So I have a string query : </p>\n\n<pre><code>sQueryCurrencyRate = \"SELECT * FROM Table.Mytable WHERE  As_Of_Date =\" &amp; Format(dateField.value, \"M/d/yyyy\")\n\n\n sQueryCurrencyUsDollar = \"SELECT * FROM Table.Mytable WHERE  As_Of_Date =\" &amp; Format(dateField.value, \"M/d/yyyy\")\n</code></pre>\n\n<p>So when I write this , the subform display a result without error : </p>\n\n<pre><code> Me.subformName.Form.RecordsourceSourceObject = \"Table.tableName\"\n</code></pre>\n\n<p>but When I try all of the below I always receive an error : </p>\n\n<pre><code>Forms!formName.subformName.Form.RecordSource= sQueryCurrencyRate \n</code></pre>\n\n<p>I have also tried : </p>\n\n<pre><code>Me.subFormName.Form.RecordsourceSourceObject= sQueryCurrencyRate\n</code></pre>\n\n<p>Also , </p>\n\n<pre><code> Me.subFormName.RecordsourceSourceObject= sQueryCurrencyRate\n</code></pre>\n\n<p>No matter what I do , I always end up having this error message :</p>\n\n<blockquote>\n  <p>the expression you have entered refers to an object that is closed or\n  doesn't exist</p>\n</blockquote>\n\n<p>What I'm doing wrong? and how to properly display the query result in the subform recordsource ?</p>\n\n<p>P.S: the sql queries syntax are fine because I have previously tested them with :</p>\n\n<pre><code>Set db = CurrentDb\nSet rs = db.OpenRecordset(sQueryCurrencyRate) \n</code></pre>\n\n<p>and I received no error , so the problem is how to bind the subform result to the query </p>\n\n<p>EDIT: </p>\n\n<p>The way I'm calling the code is like below : </p>\n\n<pre><code>Function detectSelectedQuery(sTypeDonnee As String)\n\nsQueryCurrencyRate = \"SELECT * FROM Table.Mytable WHERE  As_Of_Date = ' \" &amp; Format(dateField.value, \"M/d/yyyy\") &amp;\"'\"\n\n Me![Child8].Form.RecordSource = sQueryCurrencyRate\nend function \n</code></pre>\n\n<p>then when the combobox is changed I call the function : </p>\n\n<pre><code>Private Sub Combo_descriptionQueries_Change()\ndetectSelectedQuery (Combo_descriptionQueries.Value)\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "filter", "vba"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1508956481, "post_id": 46938236, "comment_id": 80826540, "body": "Thanks Erik, I tried to use your code, but I&#39;m getting a syntax error on the first line when I try to compile. It doesn&#39;t seem to like something around the word &#39;Between&#39;. I tried adding parentheses around (TimeValue......PM#) but that isn&#39;t it. I&#39;m unfortunately not versed well enough in VBA to figure it out."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1508962054, "post_id": 46938236, "comment_id": 80829654, "body": "Oh, sorry, forgot the quotes, fixed in current edit. Note that (at least for me), after learning just the basics VBA often is way easier to use than macros."}, {"owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "edited": false, "score": 0, "creation_date": 1509025129, "post_id": 46938236, "comment_id": 80858944, "body": "I appreciate your help Erik. I added your code and something is not working correctly. It could be other elements in the form for all I know. I have  a button set to clear all filters (a macro that runs the &#39;ApplyFilterSort&#39; command). When that macro runs, the filters are removed, which is confirmed by the record count and the form showing that it is unfiltered. If I run the code though, it seems to be picking up on old filters that should have been &quot;cleared&quot; by the macro. Am I using the wrong command for the &#39;Clear&#39; button possibly?"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1508962001, "last_edit_date": 1508962001, "creation_date": 1508951229, "answer_id": 46938236, "question_id": 46938158, "link": "https://stackoverflow.com/questions/46938158/access-is-there-a-way-to-apply-a-filter-via-macro-or-vba-that-does-not-overwri/46938236#46938236", "title": "Access - Is there a way to apply a filter via macro or VBA that does not overwrite existing filters?", "body": "<p>Yes, you can just append a filter to the existing one in VBA. You need to check if the filter is set, though.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.Filter = IIF(Nz(Me.Filter, \"\") = \"\", \"\", Me.Filter &amp; \" AND \") &amp; \"TimeValue([qryDiversion_Review].[Transaction_Time]) Between #7:00:00 AM# And #6:59:59 PM#\"\nMe.FilterOn = True\n</code></pre>\n\n<p>Note that this doesn't take existing filters into account, so you might get conflicting filters (e.g. if a filter selecting all times between 6 and 7 AM was already set)</p>\n"}], "owner": {"reputation": 51, "user_id": 6257067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/21ca35949d737a5fce818a41c3d8b392?s=128&d=identicon&r=PG&f=1", "display_name": "CasWalker", "link": "https://stackoverflow.com/users/6257067/caswalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 678, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508962001, "creation_date": 1508950931, "last_edit_date": 1508950995, "question_id": 46938158, "link": "https://stackoverflow.com/questions/46938158/access-is-there-a-way-to-apply-a-filter-via-macro-or-vba-that-does-not-overwri", "title": "Access - Is there a way to apply a filter via macro or VBA that does not overwrite existing filters?", "body": "<p>I have a form built that has a SQL builder \"search box\" in the header. This allows the user to select a location and/or a date range to filter the records by if they wish. </p>\n\n<p>I want to provide the user with options to further filter the records by the time that the record was recorded (in this situation by a standard work shift). For example I want to retrieve all records that have a time between 7 am and 7 pm. I can do this manually on the form, but I would rather have a button that runs a macro or VBA code that performs this without having to manually enter the values. </p>\n\n<p>I have a macro set up that is:</p>\n\n<pre><code>RunMenuCommand\n      Command ApplyFilterSort\nApplyFilter\n      Where Condition = ((TimeValue([qryDiversion_Review].[Transaction_Time]) Between #7:00:00 AM# And #6:59:59 PM#))\n</code></pre>\n\n<p>This works, but it clears out any other filters that may be in place, for example if the user used any of the options on the header to filter by facility or date range.</p>\n\n<p>Is there a way I can add this filter without removing any existing ones? I'm sure this is a simple solution, but I can't seem to figure it out yet.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1508949369, "post_id": 46937618, "comment_id": 80822550, "body": "@Ans unrelated to the splitting, but notice the lack of parentheses around the <code>Message</code> argument passed to the <code>MsgBox</code> function; whenever you invoke a procedure without capturing its return value into a local variable, you should not have parentheses around the arguments. This <b>will</b> cause you problems one day or another."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 7, "last_activity_date": 1508948982, "creation_date": 1508948982, "answer_id": 46937618, "question_id": 46937547, "link": "https://stackoverflow.com/questions/46937547/excel-vba-split-function-not-working/46937618#46937618", "title": "Excel vba split function not working", "body": "<p><code>Split</code> does not have a <code>.Length</code> property. Use <code>UBound</code> for a zero-based count of the elements in the array.</p>\n\n<pre><code>Function countLetter(letter As String, secretWord As String)\n    MsgBox UBound(Split(secretWord, letter)) + 1\n    countLetter = UBound(Split(secretWord, letter))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "accepted_answer_id": 46937618, "answer_count": 1, "score": 3, "last_activity_date": 1508948982, "creation_date": 1508948716, "question_id": 46937547, "link": "https://stackoverflow.com/questions/46937547/excel-vba-split-function-not-working", "title": "Excel vba split function not working", "body": "<p>I'm trying to get a number of character occurence in a string. It should work, but it doesn't.</p>\n\n<pre><code>Function countLetter(letter As String, secretWord As String)\n    MsgBox (Split(secretWord, letter).Length)\n    countLetter = Split(secretWord, letter).Length - 1\nEnd Function\n</code></pre>\n\n<p>What is wrong here?</p>\n"}, {"tags": ["excel", "printing", "vba"], "comments": [{"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508948003, "post_id": 46937305, "comment_id": 80821795, "body": "I am aware that my print command is in comments, i put that in there temporarily while i was working on something else."}, {"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508948098, "post_id": 46937305, "comment_id": 80821864, "body": "I may have just figured it out, the sheet number is incorrectly labeled."}, {"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508948147, "post_id": 46937305, "comment_id": 80821899, "body": "Nope, that wasnt the issue either."}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508948327, "post_id": 46937332, "comment_id": 80821995, "body": "I think thats perfect, then for pages 2,3 etc i would just use else if statements correct."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508948463, "post_id": 46937332, "comment_id": 80822070, "body": "Are you saying that you want to split this into pages of up to 23 lines?"}, {"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508948659, "post_id": 46937332, "comment_id": 80822182, "body": "No the first page has other stuff on it where the user doesnt input any data."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508948894, "post_id": 46937332, "comment_id": 80822305, "body": "What I mean is, might you have enough lines to print e.g. four pages and you want the code to cover any number of rows?"}, {"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508950133, "post_id": 46937332, "comment_id": 80822973, "body": "No the general idea is for the user to be able to just press a button and it will print the correct number of pages depending on where they last input the data. Later on, im going to improve it so it only prints up to where they last put data and ignore anything after but one step at a time."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1508948057, "creation_date": 1508948057, "answer_id": 46937332, "question_id": 46937305, "link": "https://stackoverflow.com/questions/46937305/excel-vba-code-to-print/46937332#46937332", "title": "Excel vba code to print", "body": "<p>If I understand you correctly, try this</p>\n\n<pre><code>Sub LastRowInOneColumn()\n'Updateby20150305\nDim xLastRow As Long\n\nWith Application.ActiveSheet\n    xLastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\nEnd With\n\nMsgBox xLastRow\n\nIf xLastRow &gt;= 22 And xLastRow &lt;= 45 Then\n    Application.Dialogs(xlDialogPrinterSetup).Show\n    'Worksheets(\"Sheet1\").PrintOut From:=1, To:=1, Preview:=True\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508949585, "post_id": 46937458, "comment_id": 80822660, "body": "Just out of curiosity, what is the benefit of using Case statements over If Then Else statements? I do think it has a look of cleaner code but are there are other benefits?"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "reply_to_user": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "edited": false, "score": 0, "creation_date": 1508958948, "post_id": 46937458, "comment_id": 80827989, "body": "@Gehn47 - Benefit is ease of readability in a lot of cases because adding additional criteria and is very easy. However, there are cases where <code>If Then ElseIf</code> may be cleaner. Good thing is both options are there for you to use as needed."}], "tags": [], "owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1508948444, "creation_date": 1508948444, "answer_id": 46937458, "question_id": 46937305, "link": "https://stackoverflow.com/questions/46937305/excel-vba-code-to-print/46937458#46937458", "title": "Excel vba code to print", "body": "<p>I prefer <code>Select Case</code> with this types of scenarios. I also suggest explicitly stating which worksheet to consider, instead of <code>ActiveSheet</code>. If you have multiple sheets, you can pass the sheet into this sub in an argument and call from another sub.</p>\n\n<pre><code>Option Explicit\n\nSub LastRowInOneColumn()\n\n    Dim MySheet As Worksheet\n    Set MySheet = Worksheets(\"Sheet1\")\n\n    With MySheet\n\n        Dim LastRow As Long\n        LastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n\n        Select Case True\n\n            Case LastRow &gt; 21 And LastRow &lt; 46\n\n                Application.Dialogs(xlDialogPrinterSetup).Show\n                'Worksheets(\"Sheet1\").PrintOut From:=1, To:=1, Preview:=True\n\n        End Select\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 7846487, "user_type": "registered", "accept_rate": 83, "profile_image": "https://graph.facebook.com/10213060670620223/picture?type=large", "display_name": "Gehn47", "link": "https://stackoverflow.com/users/7846487/gehn47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3467, "favorite_count": 0, "accepted_answer_id": 46937458, "answer_count": 2, "score": 0, "last_activity_date": 1508948444, "creation_date": 1508947973, "last_edit_date": 1531161705, "question_id": 46937305, "link": "https://stackoverflow.com/questions/46937305/excel-vba-code-to-print", "title": "Excel vba code to print", "body": "<p>So with your guys help I made a macro that would read down a singular column and find the last cell that has data entered into it. I then wanted to add nested if then elseif statements that would tell it to print x number of pages based on when the last cell is listed. This is the code im using. What am I doing wrong?</p>\n\n<pre><code>    Sub LastRowInOneColumn()\n    'Updateby20150305\n    Dim xLastRow As Long\n    With Application.ActiveSheet\n        xLastRow = .Cells(.Rows.Count, \"B\").End(xlUp).Row\n    End With\n    MsgBox xLastRow\n\n    If xLastRow = \"22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,30,40,41,42,43,44,45\" Then\n\n    Application.Dialogs(xlDialogPrinterSetup).Show\n    'Worksheets(\"Sheet1\").PrintOut From:=1, To:=1, Preview:=True\n\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "edited": false, "score": 0, "creation_date": 1508957611, "post_id": 46938343, "comment_id": 80827178, "body": "Thanks so much.  That is exactly what I was looking for and just couldn&#39;t figure out :)"}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": true, "score": 1, "last_activity_date": 1508953957, "last_edit_date": 1508953957, "creation_date": 1508951577, "answer_id": 46938343, "question_id": 46937299, "link": "https://stackoverflow.com/questions/46937299/pivot-chart-title-to-display-multiple-selected-items/46938343#46938343", "title": "Pivot Chart Title to Display Multiple Selected Items", "body": "<p>Here's your adapted sub. Notice that its parameter has changed.</p>\n\n<pre><code>Public Sub gPTWCChange(ByVal pfWC As Excel.PivotField)\n    Const sSEPARATOR As String = \", \"\n\n    Dim sChartTitle As String\n    Dim oPivotItem As Excel.PivotItem\n    Dim lVisibleCount As Long\n\n    '... Your original code ...\n    Dim wb1 As Workbook\n    Dim CPWB1 As Workbook\n    For Each wb1 In Workbooks\n        If InStr(1, wb1.Name, \"Capacity Planning Rep\", vbTextCompare) &gt; 0 Then\n            Set CPWB1 = Workbooks(wb1.Name)\n            Exit For\n        End If\n    Next wb1\n\n    '... New code to compute the chart title ...        \n    If pfWC.EnableMultiplePageItems Then\n        'Build the chart title from the visible items in the PivotField.\n        lVisibleCount = 0\n        For Each oPivotItem In pfWC.PivotItems\n            If oPivotItem.Visible Then\n                lVisibleCount = lVisibleCount + 1\n                sChartTitle = sChartTitle &amp; sSEPARATOR &amp; oPivotItem.Caption\n            End If\n        Next\n\n        'Drop the leading separator.\n        sChartTitle = Mid$(sChartTitle, Len(sSEPARATOR) + 1)\n\n        'Manage plural.\n        sChartTitle = \"Work Center\" &amp; IIf(lVisibleCount &gt; 1, \"s\", \"\") &amp; \": \" &amp; sChartTitle\n    Else\n        sChartTitle = \"Work Center: \" &amp; pfWC.CurrentPage\n    End If\n\n    '... Your original code ...\n    On Error Resume Next        \n    CPWB1.Charts(\"Workcenter By Week\").ChartTitle.Text = sChartTitle\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>And call your sub as follows:</p>\n\n<pre><code>Application.Run \"'Prod_Tools.xlam'!gPTWCChange\", Target.PivotFields(\"WorkCenter\")\n</code></pre>\n\n<p>The principle is to send your sub a reference to the PivotField object, and from there, check its <code>EnableMultiplePageItems</code> property.</p>\n"}], "owner": {"reputation": 517, "user_id": 8099673, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a45bb1bd39c6698a527b945ee6427de1?s=128&d=identicon&r=PG&f=1", "display_name": "Glenn G", "link": "https://stackoverflow.com/users/8099673/glenn-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 46938343, "answer_count": 1, "score": 0, "last_activity_date": 1508953957, "creation_date": 1508947942, "last_edit_date": 1531164843, "question_id": 46937299, "link": "https://stackoverflow.com/questions/46937299/pivot-chart-title-to-display-multiple-selected-items", "title": "Pivot Chart Title to Display Multiple Selected Items", "body": "<p>I have a pivotchart that when the selected filter (work center) is changed, it updates the chart title to display that work center name.  However, if I check the box to allow multiple selections, the chart title simply shows \"All\" instead of showing each of the actual selected items.  I haven't found a way to get it to show what I'm looking for.  Below is the code that I'm using to update the chart title as well as the code for the filter change event that fires it off</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_PivotTableUpdate(ByVal Target As PivotTable)\n    On Error Resume Next\n    Application.Run \"'Prod_Tools.xlam'!gPTWCChange\", Target.PivotFields(\"WorkCenter\").CurrentPage\n    On Error GoTo 0\nEnd Sub\n\n\nSub gPTWCChange(ByVal WC As String)\n    Dim wb1 As Workbook\n    Dim CPWB1 As Workbook\n    For Each wb1 In Workbooks\n        If InStr(1, wb1.Name, \"Capacity Planning Rep\", vbTextCompare) &gt; 0 Then\n            Set CPWB1 = Workbooks(wb1.Name)\n            Exit For\n        End If\n    Next wb1\n    On Error Resume Next\n    CPWB1.Charts(\"Workcenter By Week\").ChartTitle.Text = \"Work Center: \" &amp; WC\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>What I would like is when multiple items are selected, have the chart title look like \"Data for: Workcenter_A, Workcenter_B, Workcenter_F\"</p>\n"}, {"tags": ["vba", "excel", "ado"], "comments": [{"owner": {"reputation": 135, "user_id": 5687983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-J7_GMysD_YQ/AAAAAAAAAAI/AAAAAAAAHho/Ai0eLHKKHk4/photo.jpg?sz=128", "display_name": "Dani Aya", "link": "https://stackoverflow.com/users/5687983/dani-aya"}, "edited": false, "score": 0, "creation_date": 1508948214, "post_id": 46937221, "comment_id": 80821937, "body": "This is not the answer you are looking for, but I would accomplish this automation with Selenium Web Driver."}, {"owner": {"reputation": 31, "user_id": 8685105, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CUtE9Nw7UFY/AAAAAAAAAAI/AAAAAAAAATY/c-p8NEfx5gc/photo.jpg?sz=128", "display_name": "Prem Prakash", "link": "https://stackoverflow.com/users/8685105/prem-prakash"}, "reply_to_user": {"reputation": 135, "user_id": 5687983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-J7_GMysD_YQ/AAAAAAAAAAI/AAAAAAAAHho/Ai0eLHKKHk4/photo.jpg?sz=128", "display_name": "Dani Aya", "link": "https://stackoverflow.com/users/5687983/dani-aya"}, "edited": false, "score": 0, "creation_date": 1508948698, "post_id": 46937221, "comment_id": 80822206, "body": "Thanks Dani Aya but this is not my requirement at this point of time."}], "owner": {"reputation": 31, "user_id": 8685105, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CUtE9Nw7UFY/AAAAAAAAAAI/AAAAAAAAATY/c-p8NEfx5gc/photo.jpg?sz=128", "display_name": "Prem Prakash", "link": "https://stackoverflow.com/users/8685105/prem-prakash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508947697, "creation_date": 1508947697, "question_id": 46937221, "link": "https://stackoverflow.com/questions/46937221/adodb-not-able-to-save-file-after-dowload", "title": "ADODB : Not able to save file after dowload", "body": "<p>I am using the code below to download PDF files from a website and then I want to save them in local drive.</p>\n\n<p>I am trying to save files using <strong><em>oStream.SaveToFile</em></strong> method but files are being downloaded in corrupted format error. Or when I'm using <strong><em>oStream.Save</em></strong> method, files are not being downloaded at all. Please help.</p>\n\n<pre><code>Sub login()\n    Dim objIE As InternetExplorer\n    Dim uid As String\n    Dim pwd As String\n    Dim rng As Range\n    Dim sh As Worksheet\n    Dim objCollection As Object\n    Dim buttonCollection As Object\n    Dim ieElement As Object\n    Dim ieButton As Object\n    Dim WinHttpReq As Object\n    Dim oStream As Object\n    Dim MyURL As String\n\n    Application.ScreenUpdating = False\n\n    Set WinHttpReq = CreateObject(\"Microsoft.XMLHTTP\")\n    Set sh = Sheets(\"Indeed Resume Download\")\n    Set rng = sh.Range(\"A2\")\n\n    If Trim(rng.Value) = \"\" Or Trim(rng.Offset(0, 1).Value) = \"\" Then\n        MsgBox \"User ID And Password are mandatory.\"\n        Exit Sub\n    End If\n\n    On Error Resume Next\n    objIE.Quit\n    Set objIE = Nothing\n    On Error GoTo 0\n\n    uid = rng.Value\n    pwd = rng.Offset(0, 1).Value\n\n    Dim j As Long\n\n    Set objIE = New InternetExplorer 'Initialize internet object\n    objIE.Navigate \"https://secure.indeed.com/account/login?service=my&amp;hl=en_IN&amp;co=IN&amp;continue=https%3A%2F%2Fwww.indeed.co.in%2F\"\n    objIE.Visible = True\n\n    With objIE\n        Do While .Busy: Loop\n        Do While .ReadyState &lt;&gt; READYSTATE_COMPLETE: Loop\n        Do While .Busy: Loop\n    End With\n\n    objIE.Document.all.signin_email.Value = uid\n    objIE.Document.all.signin_password.Value = pwd\n\n    Set ieElement = objIE.Document.getElementsByClassName(\"sg-btn sg-btn-primary btn-signin\")(0)\n\n    ieElement.Click\n\n    For j = 2 To sh.Cells(Rows.Count, 27).End(xlUp).Row\n\n        Set objIE = New InternetExplorer\n        objIE.Visible = True\n\n        Dim Sender As String\n        MyURL = sh.Range(\"XDA\" &amp; j).Value\n        Sender = sh.Range(\"XDB\" &amp; j).Value\n\n        objIE.Navigate MyURL\n\n        Do While objIE.Busy = True\n            DoEvents\n        Loop\n\n        Do While objIE.Busy: Loop\n        Do While objIE.ReadyState &lt;&gt; READYSTATE_COMPLETE: Loop\n        Do While objIE.Busy: Loop\n\n        On Error Resume Next\n        Set ieButton = objIE.Document.getElementsByClassName(\"button download_button\")(0)\n\n        ieButton.Click\n\n        WinHttpReq.Open \"GET\", MyURL, False\n        WinHttpReq.Send\n\n        MyURL = WinHttpReq.responseBody\n        Set oStream = CreateObject(\"ADODB.Stream\")\n        oStream.Open\n        oStream.Type = 1\n        oStream.Write WinHttpReq.responseBody\n        oStream.Save (\"D:\\Downloaded Indeed Resume - Store\")\n        'oStream.SaveToFile (\"D:\\Downloaded Indeed Resume - Store\\\" &amp; Sender &amp; \".pdf\"), adSaveCreateOverWrite\n        oStream.Close\n\n    Next j    \n    Set objIE = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1508947056, "post_id": 46936945, "comment_id": 80821198, "body": "You could also return the name in your loop and then you would know."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508949642, "post_id": 46936945, "comment_id": 80822692, "body": "Are they ActiveX or Excel Form controls? Yes, it matters."}], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": true, "score": 3, "last_activity_date": 1508948273, "last_edit_date": 1508948273, "creation_date": 1508947147, "answer_id": 46937050, "question_id": 46936945, "link": "https://stackoverflow.com/questions/46936945/excel-vba-shapes-inner-names-types/46937050#46937050", "title": "Excel vba shapes inner names/types", "body": "<p>A list of types is here: <a href=\"https://msdn.microsoft.com/en-us/VBA/Office-Shared-VBA/articles/msoshapetype-enumeration-office\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/VBA/Office-Shared-VBA/articles/msoshapetype-enumeration-office</a>\nAll values are defined as constants in VBA, so you can write</p>\n\n<pre><code>if not shp.Type = msoOLEControlObject then\n    shp.Delete\nend if\n</code></pre>\n\n<p>To get more infos about what kind of control you have:</p>\n\n<pre><code>Dim sh As Shape\nFor Each sh In Activesheet.Shapes\n    Debug.Print sh.Name, sh.Type\n\n    If sh.Type = msoFormControl Then\n        Debug.Print \"  msoFormControl:\" &amp; sh.FormControlType\n    End If\n\n    If sh.Type = msoOLEControlObject Then\n        Debug.Print \"  msoOLEControlObject: \" &amp; TypeName(sh.OLEFormat.Object.Object)\n    End If\nNext sh\n</code></pre>\n\n<p>The FormControlType are shows here: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/xlformcontrol-enumeration-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/xlformcontrol-enumeration-excel</a> - all are also defined as VBA constants</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1508947563, "creation_date": 1508947563, "answer_id": 46937186, "question_id": 46936945, "link": "https://stackoverflow.com/questions/46936945/excel-vba-shapes-inner-names-types/46937186#46937186", "title": "Excel vba shapes inner names/types", "body": "<p>If you are using the default Names for the Shapes, then for Forms buttons:</p>\n\n<pre><code>Sub poiuyt()\n    Dim shp As Shape\n\n    For Each shp In ActiveSheet.Shapes\n        If Left(shp.Name, 6) = \"Button\" Then\n        Else\n            shp.Delete\n        End If\n    Next shp\nEnd Sub\n</code></pre>\n\n<p>and if the button are activex then:</p>\n\n<pre><code>Sub trewq()\n    Dim shp As Shape\n\n    For Each shp In ActiveSheet.Shapes\n        If Left(shp.Name, 13) = \"CommandButton\" Then\n        Else\n            shp.Delete\n        End If\n    Next shp\n\nEnd Sub\n</code></pre>\n\n<p>This approach is valid only if the Names are of the default type.</p>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2133, "favorite_count": 0, "accepted_answer_id": 46937050, "answer_count": 2, "score": 0, "last_activity_date": 1508948273, "creation_date": 1508946845, "question_id": 46936945, "link": "https://stackoverflow.com/questions/46936945/excel-vba-shapes-inner-names-types", "title": "Excel vba shapes inner names/types", "body": "<p>I need to delete all shapes except command buttons. Or to delete just ovals, straight lines and drawn lines.</p>\n\n<pre><code>Sub deleteShapes()\n\nDim shp As Shape\nFor Each shp In ActiveSheet.Shapes\n\n  shp.Delete\nNext shp\n\nEnd Sub\n</code></pre>\n\n<p>In <a href=\"https://stackoverflow.com/a/12789905/8052882\">this answer</a> Jamie Bull deletes the shapes:</p>\n\n<p><code>If Not (Shp.Type = msoOLEControlObject Or Shp.Type = msoFormControl) Then Shp.Delete</code></p>\n\n<p>But how can I get my command buttons types? Or other objects types? I tried </p>\n\n<pre><code>Sub testShapes()\n    Dim shp As Shape\n\nFor Each shp In ActiveSheet.Shapes\n    MsgBox (shp.Type)\nNext shp\n\nEnd Sub\n</code></pre>\n\n<p>but it gives only numbers: 9, 5, 1, 12. I don't know which number is which shape. Is there any way to get an inner name like <code>msoOLEControlObject</code> or at least to make sure number 1 is really Command button?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 3, "creation_date": 1508946805, "post_id": 46936900, "comment_id": 80821033, "body": "You can&#39;t access <code>DisplayFormat</code> in a UDF called from a cell."}, {"owner": {"reputation": 135, "user_id": 5687983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-J7_GMysD_YQ/AAAAAAAAAAI/AAAAAAAAHho/Ai0eLHKKHk4/photo.jpg?sz=128", "display_name": "Dani Aya", "link": "https://stackoverflow.com/users/5687983/dani-aya"}, "edited": false, "score": 0, "creation_date": 1508947171, "post_id": 46936900, "comment_id": 80821273, "body": "Try with <code>Public Function</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1508947451, "post_id": 46936900, "comment_id": 80821457, "body": "<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-displayformat-property-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1508947913, "post_id": 46936900, "comment_id": 80821745, "body": "@Jeeped - I don&#39;t think this is a duplicate: the OP already knows about DisplayFormat.  This is a question specifically about using DisplayFormat in a UDF"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1508948123, "post_id": 46936900, "comment_id": 80821885, "body": "Yeah, my note on that in my referenced answer is only a footnote but it is there and was the first one I found although I know I&#39;ve stated the same thing several times. I&#39;ll reopen."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1508948534, "post_id": 46936900, "comment_id": 80822116, "body": "@Jeeped - yes I missed your note (and I see similar notes from you on related questions)  Might be worth its own topic though."}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 3, "last_activity_date": 1508947840, "creation_date": 1508947840, "answer_id": 46937270, "question_id": 46936900, "link": "https://stackoverflow.com/questions/46936900/vba-function-returns-value-in-worksheet-works-as-sub/46937270#46937270", "title": "VBA function returns #VALUE! in worksheet, works as sub", "body": "<p>Here's a basic example of a work-around:</p>\n\n<pre><code>Function GetDFColor(shtName, cellAddress)\n    GetDFColor = ThisWorkbook.Sheets(shtName).Range(cellAddress). _\n                                          DisplayFormat.Interior.Color\nEnd Function\n\n\n'works when called as a UDF\nFunction DisplayFormatColor(rng As Range)\n    DisplayFormatColor = Application.Evaluate(\"GetDFColor(\"\"\" &amp; _\n                         rng.Parent.Name &amp; \"\"\",\"\"\" &amp; rng.Address() &amp; \"\"\")\")\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 8832544, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0aBnmRLs7Hg/AAAAAAAAAAI/AAAAAAAAAGU/00O4FdlAumA/photo.jpg?sz=128", "display_name": "Gregg Jossie", "link": "https://stackoverflow.com/users/8832544/gregg-jossie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508948194, "creation_date": 1508946714, "question_id": 46936900, "link": "https://stackoverflow.com/questions/46936900/vba-function-returns-value-in-worksheet-works-as-sub", "title": "VBA function returns #VALUE! in worksheet, works as sub", "body": "<p>I've written a function that essentially returns a weighted score by assigning values of 1 and 2 to different conditionally formatted cells. When I call this function in the worksheet, it returns the #VALUE! error.</p>\n\n<pre><code>Function ColorWeight(Factors As Range) As Integer\nDim x As Range\nDim score As Integer\n\nscore = 0\nFor Each x In Factors\n    If x.DisplayFormat.Interior.color = Range(\"C5\").Interior.color Then\n        score = score + Cells(14, x.Column).Value * 2\n    ElseIf x.DisplayFormat.Interior.color = Range(\"C9\").Interior.color Then\n        score = score + Cells(14, x.Column).Value * 1\n    End If\nNext\nColorWeight = score\n\nEnd Function\n</code></pre>\n\n<p>However, when I run this code as a sub and set the range to a specific range, as below, it works fine.</p>\n\n<pre><code>Sub ColorWeight()\nDim Factors As Range\nDim x As Range\nDim score As Integer\n\nSet Factors = Range(\"G17:Q17\")\nscore = 0\nFor Each x In Factors\n    If x.DisplayFormat.Interior.color = Range(\"C5\").Interior.color Then\n        score = score + Cells(14, x.Column).Value * 2\n    ElseIf x.DisplayFormat.Interior.color = Range(\"C9\").Interior.color Then\n        score = score + Cells(14, x.Column).Value * 1\n    End If\nNext\nDebug.Print score\nEnd Sub\n</code></pre>\n\n<p>What is the difference that I'm missing that makes the function not work?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1508946098, "post_id": 46936607, "comment_id": 80820544, "body": "Some of those are true numbers and are not being treated as text with commas that can be split. Look in the formula bar or just widen the column to show left alignment (text) and right alignment (numbers)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1508946484, "post_id": 46936607, "comment_id": 80820798, "body": "Suggest you change to <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbooks-opentext-method-excel\" rel=\"nofollow noreferrer\">workbooks.opentext</a> and skip the TextToColumns."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "edited": false, "score": 1, "creation_date": 1509009577, "post_id": 46936962, "comment_id": 80847937, "body": "Brilliant! thanks very much. It didnt work just with <code>WorkBooks.OpenText</code> (all data was in column A with some as numbers and some as text) so from the link you provided i added <code>DataType:=xlDelimited, comma:=True</code> after the filename and it seems to have worked perfectly, and loads quicker than using text to columns."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1508946882, "creation_date": 1508946882, "answer_id": 46936962, "question_id": 46936607, "link": "https://stackoverflow.com/questions/46936607/vba-text-to-columns-isnt-working-on-every-row-of-a-text-file/46936962#46936962", "title": "VBA text to columns isnt working on every row of a text file", "body": "<p>Suggest you change to <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbooks-opentext-method-excel\" rel=\"nofollow noreferrer\">workbooks.opentext</a> and skip the TextToColumns.</p>\n\n<pre><code>Workbooks.OpenText Filename:=\"c:\\test\\numbertext.csv\"\n</code></pre>\n\n<p>I thought I would have to fill in a lot of customized parameters but the defaults seem to work for the small portion I retyped from your sample data.</p>\n\n<pre><code>259,1198,114.2290\n259,1199,114.2290\n259,1200,114.2290\n251,1,27.0960\n251,2,27.0960\n251,3,27.0960\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/zvvu0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zvvu0.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 123, "user_id": 5138733, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9b3e30885837d89d525cf68f2bfcf393?s=128&d=identicon&r=PG&f=1", "display_name": "Rich Prag", "link": "https://stackoverflow.com/users/5138733/rich-prag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 46936962, "answer_count": 1, "score": 1, "last_activity_date": 1508946882, "creation_date": 1508945882, "question_id": 46936607, "link": "https://stackoverflow.com/questions/46936607/vba-text-to-columns-isnt-working-on-every-row-of-a-text-file", "title": "VBA text to columns isnt working on every row of a text file", "body": "<p>I have a module in ThisWorkbook that is supposed to open .txt files from a location (it does so in another workbook), then do text to columns, then copy the individual columns and paste into ThisWorkbook. The .txt files have data in the format 23,100,100.65 on each row: three numbers separated by commas. </p>\n\n<p>Something strange is happening though, as the text to columns function works on data in some cells, but not others. Furthermore, it seems that when the .txt file opens in a workbook, some of the commas separating the data are in the wrong place, or an extra comma has been added. The picture below shows the text file on the left and the commensurate Excel and resultant data on the right. Row 300,000 is a good example of the weird problem.</p>\n\n<p><a href=\"https://i.stack.imgur.com/IPtct.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IPtct.png\" alt=\"Text file on left, Excel workbook on right\"></a></p>\n\n<p>Here's my code, is there anything in the way i've written it that is leading to these problems? If not, any ideas whats going on?</p>\n\n<pre><code>Sub OpenTxtFiles()\n\nDim ws As Worksheet\nDim rng As Range\nDim cell As Range\nDim xFolder As String\nDim txtFname As String\nDim cellAddr As String\nDim lastRow As Long\nDim rngTtC As Range\n\nxFolder = Application.ThisWorkbook.Path\nSet rng = Range(\"E1:I1\") 'the range contains the text filenames\n\nApplication.ScreenUpdating = False\n\n\n            For Each cell In rng\n                txtFname = cell.Value   'sets the cell value as txtFname variable\n                    'MsgBox txtFname\n                cellAddr = cell.Address    'sets the cell address as cellAddr variable\n                    'MsgBox cellAddr\n                    Workbooks.Open Filename:=xFolder &amp; \"\\\" &amp; txtFname    'opens the text file relating to the cell value\n                        Set rngTtC = ActiveSheet.[A:A]    'this bit does text to columns on the csv for ease of copying the columns in next bit\n                        rngTtC.TextToColumns Destination:=rngTtC, DataType:=xlDelimited, _\n                        textqualifier:=xlDoubleQuote, consecutivedelimiter:=False, Tab:=False, _\n                        semicolon:=False, comma:=True, Space:=False\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "edited": false, "score": 0, "creation_date": 1508951498, "post_id": 46936575, "comment_id": 80823720, "body": "You can send the row number in a hidden text field on the user form.  For example, create a textbox, lets say TextBox1, on the userform and set it&#39;s property to visible = false.  Before you open the userform, set the value of that textbox to the target.row.  Like this:  (Lets say the userform name is UserForm1.)  The code is:  UserForm1.TextBox1.caption = Target.Row: UserForm1.Show.  That way the procedures in your userform can utilize the row number simply by using clng(TextBox1.Value)."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8474296, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9c6596f024c89c7cd21e28bdf6c9e4ab?s=128&d=identicon&r=PG&f=1", "display_name": "bbshim", "link": "https://stackoverflow.com/users/8474296/bbshim"}, "edited": false, "score": 0, "creation_date": 1508955613, "post_id": 46938615, "comment_id": 80826071, "body": "Threw an error, the debugger says that &quot;DesiredRange = Nothing&quot;. Again insinuating that &#39;Renter&#39; is not a column on my table."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 25, "user_id": 8474296, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9c6596f024c89c7cd21e28bdf6c9e4ab?s=128&d=identicon&r=PG&f=1", "display_name": "bbshim", "link": "https://stackoverflow.com/users/8474296/bbshim"}, "edited": false, "score": 0, "creation_date": 1509022881, "post_id": 46938615, "comment_id": 80857145, "body": "Yes, that&#39;s what I meant when I said you&#39;ll have to change the range name to the name on your table.  You also need to add the invisible textbox to your form, which may have a different name then TextBox1.  That&#39;s another name you may have to change.  We can only provide the logic.  You have to change the names to suit your own app."}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 25, "user_id": 8474296, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9c6596f024c89c7cd21e28bdf6c9e4ab?s=128&d=identicon&r=PG&f=1", "display_name": "bbshim", "link": "https://stackoverflow.com/users/8474296/bbshim"}, "edited": false, "score": 0, "creation_date": 1509030028, "post_id": 46938615, "comment_id": 80862740, "body": "FYI - I changed the Answer above to reflect your specific table and header name.  So it should work now."}, {"owner": {"reputation": 25, "user_id": 8474296, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9c6596f024c89c7cd21e28bdf6c9e4ab?s=128&d=identicon&r=PG&f=1", "display_name": "bbshim", "link": "https://stackoverflow.com/users/8474296/bbshim"}, "edited": false, "score": 0, "creation_date": 1509378574, "post_id": 46938615, "comment_id": 80985245, "body": "Thanks for your help so far! I changed the names (Textbox1.value -&gt; itemid_dynamiclabel.caption) and the tablename[rowname] but it still doesn&#39;t read the table: &quot;DesiredRange = nothing&quot;. How do I name/specify the table[row]?"}, {"owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "reply_to_user": {"reputation": 25, "user_id": 8474296, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9c6596f024c89c7cd21e28bdf6c9e4ab?s=128&d=identicon&r=PG&f=1", "display_name": "bbshim", "link": "https://stackoverflow.com/users/8474296/bbshim"}, "edited": false, "score": 0, "creation_date": 1509395491, "post_id": 46938615, "comment_id": 80994420, "body": "Target.row will give you the row number selected as a long type."}, {"owner": {"reputation": 25, "user_id": 8474296, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9c6596f024c89c7cd21e28bdf6c9e4ab?s=128&d=identicon&r=PG&f=1", "display_name": "bbshim", "link": "https://stackoverflow.com/users/8474296/bbshim"}, "edited": false, "score": 0, "creation_date": 1509552111, "post_id": 46938615, "comment_id": 81065186, "body": "Error: &quot;Target = Empty&quot;?"}], "tags": [], "owner": {"reputation": 1148, "user_id": 7231593, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kvB-QD-A2Xs/AAAAAAAAAAI/AAAAAAAAAE4/LRTmHQQqx44/photo.jpg?sz=128", "display_name": "John Muggins", "link": "https://stackoverflow.com/users/7231593/john-muggins"}, "is_accepted": true, "score": 0, "last_activity_date": 1509029948, "last_edit_date": 1509029948, "creation_date": 1508952642, "answer_id": 46938615, "question_id": 46936575, "link": "https://stackoverflow.com/questions/46936575/open-userform-when-click-in-speficic-column-in-table-and-read-row-values/46938615#46938615", "title": "Open userform when click in speficic column in table and read row values", "body": "<p>I got an error when I tried to name a range \"MasterInventory[Renter]\".  So in my test I used a range named \"Renter.\"  Try the following code in your sheet module and the bottom code in your userform module to see how to transfer a row number to your userform.  You'll have to change the range name.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim DesiredRange As Range\n    Set DesiredRange = Worksheets(\"Sheet1\").Range(\"MasterInventory[Renter]\")\n    If Not Intersect(Target, DesiredRange) Is Nothing Then\n        Checkout_Form.TextBox1.value = Target.Row\n        Checkout_Form.Show\n    End If\nEnd Sub\n</code></pre>\n\n<p>And put the following your form module:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    MsgBox \"Row: \" &amp; Me.TextBox1.value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 8474296, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/9c6596f024c89c7cd21e28bdf6c9e4ab?s=128&d=identicon&r=PG&f=1", "display_name": "bbshim", "link": "https://stackoverflow.com/users/8474296/bbshim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 565, "favorite_count": 0, "accepted_answer_id": 46938615, "answer_count": 1, "score": 0, "last_activity_date": 1509029948, "creation_date": 1508945783, "last_edit_date": 1531164843, "question_id": 46936575, "link": "https://stackoverflow.com/questions/46936575/open-userform-when-click-in-speficic-column-in-table-and-read-row-values", "title": "Open userform when click in speficic column in table and read row values", "body": "<p><strong>System Description:</strong> I have created an inventory manager in Excel that tracks the quantity, location, and who is renting any given asset. In the master table of inventory <em>MasterInventory</em> on Sheet 1 (named <em>Inventory</em>), it shows all information including a column <em>Renter</em>- the person who is renting the asset, blank if no one is renting it.\n<br>I have already created the userform <em>Checkout_Form</em> and it works as intended but it needs to know which row was clicked in the <em>Renter</em> column to capture the asset's ID number to log the renting process.</p>\n\n<p><strong>Problem:</strong> When I click in the <em>Renter</em> column, I want <em>Checkout_Form</em> to open to allow the user to fill input based on the asset (which is reliant which row of the column was selected). </p>\n\n<p><strong>My Question</strong>: How do I create a link of some kind in <em>Renter</em> column that, when clicked, will open <em>Checkout_Form</em> and pass the asset ID (based on the row it's in) to it.</p>\n\n<p><strong>My Attempt:</strong> I have tried to use a macro for <em>Worksheet_SelectionChange</em> and check if the <em>Target</em> variable falls in the <em>Renter</em> column but I can't get it to work; it seems to be a problem with the column range I give and then I still don't know how to read the row's values.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n    Dim DesiredRange As Range\n    Set DesiredRange = Worksheets(\"Sheet1\").Range(\"MasterInventory[Renter]\")\n    If Intersect(Target, DesiredRange) Is Nothing Then Checkout_Form.Show\n\nEnd Sub\n</code></pre>\n\n<p>A button at the top of the sheet has not worked for me because there's no way to know which asset I'm currently working with.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4066647"}, "edited": false, "score": 0, "creation_date": 1508944902, "post_id": 46936237, "comment_id": 80819644, "body": "It&#39;ll work even without the <code>.Value</code> attribute, right?"}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1508945094, "post_id": 46936237, "comment_id": 80819807, "body": "indeed. But I would remove the <code>.value</code>"}, {"owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "edited": false, "score": 2, "creation_date": 1508945144, "post_id": 46936237, "comment_id": 80819837, "body": "It&#39;s better practice to explicitly put <code>.Value</code> because IsEmpty doesn&#39;t expect a Range object. Without <code>.Value</code>, you are relying on VBA to pass the default property of the Range class to IsEmpty."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4066647"}, "edited": false, "score": 0, "creation_date": 1508945506, "post_id": 46936237, "comment_id": 80820101, "body": "Wow, didn&#39;t know that"}, {"owner": {"reputation": 649, "user_id": 6068036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4fd50bb5fbc12d1bb7ead7e318f5e1b?s=128&d=identicon&r=PG", "display_name": "AlexM", "link": "https://stackoverflow.com/users/6068036/alexm"}, "edited": false, "score": 0, "creation_date": 1508958171, "post_id": 46936237, "comment_id": 80827537, "body": "@Excelosaurus: .Value2 is preferred over .Value, as it is a bit faster"}], "tags": [], "owner": {"reputation": 2654, "user_id": 2754509, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Jt1G.jpg?s=128&g=1", "display_name": "Excelosaurus", "link": "https://stackoverflow.com/users/2754509/excelosaurus"}, "is_accepted": true, "score": 3, "last_activity_date": 1508945415, "last_edit_date": 1508945415, "creation_date": 1508944821, "answer_id": 46936237, "question_id": 46935963, "link": "https://stackoverflow.com/questions/46935963/check-if-cell-next-to-found-value-is-empty-vba/46936237#46936237", "title": "Check if cell next to found value is empty VBA", "body": "<p>Your cl variable is already a range.</p>\n\n<p>Change</p>\n\n<pre><code>If IsEmpty(Range(cl).Offset(0, 1).Value) = True Then\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If IsEmpty(cl.Offset(0, 1).Value) Then\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4045302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae377f6399ab0ef825809b1cd0a0c26d?s=128&d=identicon&r=PG&f=1", "display_name": "Zeno", "link": "https://stackoverflow.com/users/4045302/zeno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 399, "favorite_count": 0, "accepted_answer_id": 46936237, "answer_count": 1, "score": 1, "last_activity_date": 1508945415, "creation_date": 1508944073, "last_edit_date": 1508944273, "question_id": 46935963, "link": "https://stackoverflow.com/questions/46935963/check-if-cell-next-to-found-value-is-empty-vba", "title": "Check if cell next to found value is empty VBA", "body": "<p>I am totally new to VBA. I use it maybe once a year and when I do I search this and other forums for code. For my humble needs, that usually works perfectly. Unfortunately due to my lack of real understanding of the code, in this case I am unable to see what I`m doing wrong. So hopefully somebody can help.</p>\n\n<p>I have a timesheet where I want to copy the values to a datasheet. I have that working. But it is important that the users fill-out the right weeknumber in the form. In order to check if they have done that, I have written a piece of code that should return a messagebox when the weeknumber is not filled. When I simply use a reference to a single cell the code works. But as the weeknumber is not filled in in the same cell on all forms I want the macro to search for the text \"Weeknumber: \" and then check if the cell next to it is empty or not.</p>\n\n<pre><code>Sub Weeknumber()\ndim cl as Range\nWorksheets(\"Invul_Tabel\").Activate\nWith Worksheets(\"Invul_Tabel\").Cells\nSet cl = .Find(\"Weeknummer:\", After:=.Range(\"A1\"), LookIn:=xlValues)\nIf IsEmpty(Range(cl).Offset(0, 1).Value) = True Then\n  MsgBox \"Geen weeknummer ingevuld\"\n  Exit Sub\n     End If\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>The code gives an error on the \"If IsEmpty\" line\" (error 1004).\nIs probably simple, but i can`t seem to figure it out!</p>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 8825977, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/710282385848383/picture?type=large", "display_name": "Sunil Patra", "link": "https://stackoverflow.com/users/8825977/sunil-patra"}, "edited": false, "score": 0, "creation_date": 1508994327, "post_id": 46938256, "comment_id": 80839564, "body": "1.I am getting run time error 438 as Object does not support this property or method in        myArray = ssheeet.Columns(X + 1).Values . 2. About the range thing , I have number of rows in &quot;X+1 &quot; column , say cell(2,2) gives me the number of rows in X+1 column . Please Help"}], "tags": [], "owner": {"reputation": 1385, "user_id": 8555648, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-CK4leGQFE84/AAAAAAAAAAI/AAAAAAAAAgY/HrlhEh-LPIQ/photo.jpg?sz=128", "display_name": "newacc2240", "link": "https://stackoverflow.com/users/8555648/newacc2240"}, "is_accepted": true, "score": 0, "last_activity_date": 1508952830, "last_edit_date": 1508952830, "creation_date": 1508951293, "answer_id": 46938256, "question_id": 46935929, "link": "https://stackoverflow.com/questions/46935929/how-to-have-list-box-contents-dynamically-depending-on-another-list-box-selectio/46938256#46938256", "title": "How to have List Box contents dynamically depending on another List Box Selection in Excel - VBA user forms?", "body": "<p>This shall work:</p>\n\n<pre><code>Private Sub ListBox1_Click()\n    Dim X As Integer\n    Dim vCol As Variant\n    Dim srange As Range\n    Dim ssheeet As Worksheet\n    Set ssheeet = ThisWorkbook.Sheets(\"Sheet2\")\n    X = ListBox1.ListIndex\n    Me.ListBox2.RowSource = ssheeet.Columns(X + 1).Address\nEnd Sub\n</code></pre>\n\n<p>You can only push an array into List property, so it comes to</p>\n\n<pre><code>Private Sub ListBox1_Click()\n    Dim X As Integer\n    Dim vCol As Variant\n    Dim srange As Range\n    Dim ssheeet As Worksheet\n    Set ssheeet = ThisWorkbook.Sheets(\"Sheet2\")\n    X = ListBox1.ListIndex\n\n    Dim myArray() as variant\n    myArray = ssheeet.Columns(X + 1).Values\n    Me.ListBox2.List = myArray\nEnd Sub\n</code></pre>\n\n<p>I've tested this method and it push all values including <code>Blank</code> into ListBox2. Not a good one, unless we determine the data range first.</p>\n"}], "owner": {"reputation": 27, "user_id": 8825977, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/710282385848383/picture?type=large", "display_name": "Sunil Patra", "link": "https://stackoverflow.com/users/8825977/sunil-patra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 1, "accepted_answer_id": 46938256, "answer_count": 1, "score": 0, "last_activity_date": 1508952830, "creation_date": 1508944006, "last_edit_date": 1508944072, "question_id": 46935929, "link": "https://stackoverflow.com/questions/46935929/how-to-have-list-box-contents-dynamically-depending-on-another-list-box-selectio", "title": "How to have List Box contents dynamically depending on another List Box Selection in Excel - VBA user forms?", "body": "<p>I have primary data ( not static may change during other run time modules )\nin one column and then I have columns for every element of primary column .</p>\n\n<p>Say primary as A then if A has 3 elements then columns B , C and D will be the secondary columns having various rows of data. </p>\n\n<p>In user form I have two List Box 1 &amp; 2 .If user selects 2nd element in ListBox1 the ListBox2 displays contents of \"C\" column . </p>\n\n<pre><code>Private Sub ListBox1_Click()\nDim X As Integer\nDim vCol As Variant\nDim srange As Range\nDim ssheeet As Worksheet\nSet ssheeet = ThisWorkbook.Sheets(\"Sheet2\")\nX = ListBox1.ListIndex\nMe.ListBox1.List = ssheeet.Columns(X + 1).Values* \n             '2nd selection i.e., 2+1 gives 3rd -&gt; \"C\" column \nEnd Sub\n\nPrivate Sub UserForm_Initialize()\nDim ssheeet As Worksheet\nSet ssheeet = ThisWorkbook.Sheets(\"Sheet1\")\nMe.ListBox1.RowSource = \"Sheet1!A:A\"\nEnd Sub\n</code></pre>\n\n<p><strong>Query ?</strong></p>\n\n<p><code>Me.ListBox1.List = ssheeet.Columns(X + 1).Values</code>  is not working where i have to give dynamic range to the 2nd list box .\nThanks!</p>\n"}, {"tags": ["vba", "excel", "extract"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1508949838, "post_id": 46935892, "comment_id": 80822794, "body": "See the answer in this post: <a href=\"https://stackoverflow.com/questions/44955755/extracting-the-inner-text-from-span-using-vba/44956013#44956013\" title=\"extracting the inner text from span using vba\">stackoverflow.com/questions/44955755/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8831267, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155784940095912/picture?type=large", "display_name": "Merlyn Koh", "link": "https://stackoverflow.com/users/8831267/merlyn-koh"}, "edited": false, "score": 0, "creation_date": 1508953879, "post_id": 46937034, "comment_id": 80825086, "body": "ah yes now it returns multiple values! Thank you. But the values returned seem to be skipping rows... It would be blank from cell A1-7 and somewhere in the middle as well"}], "tags": [], "owner": {"reputation": 91, "user_id": 8831958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78c9ae89be550b744c0d12f87659907e?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Martin", "link": "https://stackoverflow.com/users/8831958/matthew-martin"}, "is_accepted": false, "score": 1, "last_activity_date": 1508947564, "last_edit_date": 1508947564, "creation_date": 1508947094, "answer_id": 46937034, "question_id": 46935892, "link": "https://stackoverflow.com/questions/46935892/how-to-scrape-data-from-website-using-vba/46937034#46937034", "title": "How to scrape data from website using VBA?", "body": "<p>Your issue lies here I think:</p>\n\n<pre><code>Dim i As Integer \n    For i = 0 To 200 \n    Range(\"A1\").Value = ie.document.getElementById(\"flight-listing-container\").getElementsByClassName(\"dollars price-emphasis\")(i).innerText \nNext i \n</code></pre>\n\n<p>You're looping an arbitrary 200 times and then repeatedly updating cell A1 with the price. This means you'll always be left with the inner text of the last element that matched in A1</p>\n\n<p>Try</p>\n\n<pre><code>Range(\"A1\").Offset(i,0).Value = ie.document.getElementById(\"flight-listing-container\").getElementsByClassName(\"dollars price-emphasis\")(i).innerText\n</code></pre>\n\n<p>That'll give you a list of all inner text it finds on that elment down the A column until your loop terminates.</p>\n\n<p>Really, I think you should be determining how many iterations you'll need to loop before diving into the loop, unless you've got a good reason to loop 200 times each time.</p>\n"}], "owner": {"reputation": 11, "user_id": 8831267, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155784940095912/picture?type=large", "display_name": "Merlyn Koh", "link": "https://stackoverflow.com/users/8831267/merlyn-koh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1436, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508947564, "creation_date": 1508943909, "last_edit_date": 1531164843, "question_id": 46935892, "link": "https://stackoverflow.com/questions/46935892/how-to-scrape-data-from-website-using-vba", "title": "How to scrape data from website using VBA?", "body": "<p>I'm a newbie at VBA and was trying to extract flight prices from Expedia (SG to Bangkok) for some practice. My code is not working out too well, unfortunately. It only returned one price (which I have no idea where it came from). Would really appreciate it if anyone could help me out. Thank you! </p>\n\n<pre><code>Sub ExtractRaw() \nDim wb As Workbook \nDim ws As Worksheet \nSet wb = ThisWorkbook \nSet ws = wb.Sheets(\"Sheet1\") \n\nDim ie As Object \nSet ie = CreateObject(\"InternetExplorer.Application\") \nWith ie \n.Visible = True .navigate \"https://www.expedia.com.sg/Flights-Search?rfrr=TG.LP.SrchWzd.Flight&amp;langid=2057&amp;trip=OneWay&amp;leg1=from:Singapore,%20Singapore%20(SIN-Changi),to:Bangkok,%20Thailand%20(BKK-Suvarnabhumi%20Intl.),departure:\" &amp; DateAdd(\"d\", 1, Date) &amp; \"TANYT&amp;passengers=children:0,adults:1,seniors:0,infantinlap:Y&amp;options=cabinclass:economy,sortby:price,carrier:&amp;mode=search&amp;paandi=true\" \n\nDo While ie.Busy \nDoEvents \nLoop \n\nDim doc As HTMLDocument \nSet doc = ie.document \nWhile ie.readyState &lt;&gt; 4 \nWend \nOn Error Resume Next \n\nDim i As Integer For i = 0 To 200 \nRange(\"A1\").Value = ie.document.getElementById(\"flight-listing-container\").getElementsByClassName(\"dollars price-emphasis\")(i).innerText \n\nNext i \nie.Quit \nApplication.EnableEvents = True \nEnd With \nEnd Sub\ufeff\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1508945224, "post_id": 46935849, "comment_id": 80819895, "body": "Get rid of the .Select/Selection. first and foremost.  It detracts from the goal and readability."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8393865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32a2557d43604544b8605fb5f84a6db3?s=128&d=identicon&r=PG&f=1", "display_name": "arehman_91", "link": "https://stackoverflow.com/users/8393865/arehman-91"}, "edited": false, "score": 0, "creation_date": 1508947465, "post_id": 46936507, "comment_id": 80821469, "body": "Thanks for the asnwer but I cant split the range it is one table linked with drop down list. So,  I have 50 table in column I would like to split in two columns with the same drop down order"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 3, "user_id": 8393865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32a2557d43604544b8605fb5f84a6db3?s=128&d=identicon&r=PG&f=1", "display_name": "arehman_91", "link": "https://stackoverflow.com/users/8393865/arehman-91"}, "edited": false, "score": 0, "creation_date": 1508949060, "post_id": 46936507, "comment_id": 80822380, "body": "@arehman_91 Can you elaborate on &quot;linked wiht a drop-down list&quot;?  I&#39;ll be honest that I&#39;m a bit confused without seeing the data; can you upload a SS (regarding the 50 tables)?"}, {"owner": {"reputation": 3, "user_id": 8393865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32a2557d43604544b8605fb5f84a6db3?s=128&d=identicon&r=PG&f=1", "display_name": "arehman_91", "link": "https://stackoverflow.com/users/8393865/arehman-91"}, "edited": false, "score": 0, "creation_date": 1509031986, "post_id": 46936507, "comment_id": 80864051, "body": "From data validation I have used drop down list which is working as a variable, on the basis of the this list I have table if any variable changes through drop down list values in the table changes due to sumifs and other formula linked with drop down."}, {"owner": {"reputation": 3, "user_id": 8393865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32a2557d43604544b8605fb5f84a6db3?s=128&d=identicon&r=PG&f=1", "display_name": "arehman_91", "link": "https://stackoverflow.com/users/8393865/arehman-91"}, "edited": false, "score": 0, "creation_date": 1509031996, "post_id": 46936507, "comment_id": 80864060, "body": "So, I wanted to paste this whole table with the same order defined in drop down list, equally in two columns. My current VBA only paste in one column, I would wanted that to paste like first table in first column, second table to be pasted in second column, third table right beneath the first table which is first column but after some rows to make sure it would not paste over first table, fourth right beneath the second table and so on ....."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 3, "user_id": 8393865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32a2557d43604544b8605fb5f84a6db3?s=128&d=identicon&r=PG&f=1", "display_name": "arehman_91", "link": "https://stackoverflow.com/users/8393865/arehman-91"}, "edited": false, "score": 0, "creation_date": 1509032180, "post_id": 46936507, "comment_id": 80864182, "body": "@arehman_91 I think i&#39;m following now... give me a sec to mock-up."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 3, "user_id": 8393865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32a2557d43604544b8605fb5f84a6db3?s=128&d=identicon&r=PG&f=1", "display_name": "arehman_91", "link": "https://stackoverflow.com/users/8393865/arehman-91"}, "edited": false, "score": 0, "creation_date": 1509033050, "post_id": 46936507, "comment_id": 80864707, "body": "@arehman_91 Look now; gave you another variable for your column and it determins if i is divisible by 2."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1509033013, "last_edit_date": 1509033013, "creation_date": 1508945569, "answer_id": 46936507, "question_id": 46935849, "link": "https://stackoverflow.com/questions/46935849/vba-copy-paste-equally-in-two-columns/46936507#46936507", "title": "VBA copy paste equally in two columns", "body": "<p>You can try : </p>\n\n<pre><code>Sub Cha()\n    Dim dvCell As Range\n    Dim inputRange As Range\n    Dim c As Range\n    Dim i As Long\n    Set dvCell = Worksheets(\"Summary-Chentir\").Range(\"Q4\")\n    Set inputRange = Worksheets(\"Names\").Range(\"I3:I20\")\n    i = 1\n    inc = 0\n    For Each c In inputRange\n        dvCell = c.Value \n        Sheets(\"Summary-Chentir\").Range(\"L2:R21\").Copy\n        Sheets(\"Paste\").Cells(i + 1 + inc, 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n        i = i + 1\n        inc = inc + 22\n    Next c\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Will use a For loop, rather than For Each loop because of how I will recommend to do this.</p>\n\n<pre><code>Dim i as Long, j as Long, dvCell As Range\nSet dvCell = Worksheets(\"Summary-Chentir\").Range(\"Q4\")\nFor i = 3 to 20\n    dvCell = Sheets(\"Names\").Cells(i,\"I\").Value\n    If i Mod 2 = 0 Then\n        j = 2\n    Else\n        j = 1\n    End If\n    Sheets(\"Summary-Chentir\").Range(\"L2:R21\").Copy\n    Sheets(\"Paste\").Cells(i + 1 + inc, j).PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n    If i Mod 2 = 0 Then inc = inc + 22\nNext i\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 8393865, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32a2557d43604544b8605fb5f84a6db3?s=128&d=identicon&r=PG&f=1", "display_name": "arehman_91", "link": "https://stackoverflow.com/users/8393865/arehman-91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 46936507, "answer_count": 1, "score": 0, "last_activity_date": 1509033013, "creation_date": 1508943778, "last_edit_date": 1531164843, "question_id": 46935849, "link": "https://stackoverflow.com/questions/46935849/vba-copy-paste-equally-in-two-columns", "title": "VBA copy paste equally in two columns", "body": "<p>I am using below code to copy-paste from drop down list, but it is pasting all tables in column. I would like to paste in two columns equally spaced to print easily. </p>\n\n<pre><code>Sub Cha()\n\nDim dvCell As Range\nDim inputRange As Range\nDim c As Range\nDim i As Long\n\nSet dvCell = Worksheets(\"Summary-Chentir\").Range(\"Q4\")\nSet inputRange = Worksheets(\"Names\").Range(\"I3:I20\")\n\ni = 1\ninc = 0\n\nFor Each c In inputRange\n    dvCell = c.Value \n    Sheets(\"Summary-Chentir\").Select\n    Range(\"L2:R21\").Select\n    Selection.Copy\n    Sheets(\"Paste\").Select\n    Cells(i + 1 + inc, 1).Select\n    Selection.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, \n    Operation:=xlNone, \n    SkipBlanks:=False, Transpose:=False\n    i = i + 1\n    inc = inc + 22\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["python", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8696481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ac759f87c4bdfdabc7c532a647d003?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/8696481/joe"}, "edited": false, "score": 0, "creation_date": 1508946677, "post_id": 46936215, "comment_id": 80820933, "body": "@ R Hamilton   What is Password for?"}, {"owner": {"reputation": 243, "user_id": 8776669, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2qOYI.jpg?s=128&g=1", "display_name": "R Hamilton", "link": "https://stackoverflow.com/users/8776669/r-hamilton"}, "reply_to_user": {"reputation": 53, "user_id": 8696481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ac759f87c4bdfdabc7c532a647d003?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/8696481/joe"}, "edited": false, "score": 0, "creation_date": 1508954069, "post_id": 46936215, "comment_id": 80825197, "body": "it just states there is no password, not strictly needed."}], "tags": [], "owner": {"reputation": 243, "user_id": 8776669, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/2qOYI.jpg?s=128&g=1", "display_name": "R Hamilton", "link": "https://stackoverflow.com/users/8776669/r-hamilton"}, "is_accepted": false, "score": 0, "last_activity_date": 1508944769, "creation_date": 1508944769, "answer_id": 46936215, "question_id": 46935719, "link": "https://stackoverflow.com/questions/46935719/excel-file-is-read-only-file-how-to-change-it-so-edits-can-be-made-to-the-exc/46936215#46936215", "title": "Excel File is [Read Only] file: How to change it so edits can be made to the excel file?", "body": "<p>Try specifiying \"ReadOnlyRecommended:=False\" when saving the workbook. Such as...</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:= _ \n\"F:\\Ten Year Load Forecasts 2017-2026.xlsm\", FileFormat:=xlOpenXMLWorkbookMacroEnabled _ \n, Password:=\"\", WriteResPassword:=\"\", ReadOnlyRecommended:=False, _ \nCreateBackup:=False \n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8696481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1ac759f87c4bdfdabc7c532a647d003?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/8696481/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 625, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508944769, "creation_date": 1508943412, "last_edit_date": 1508944101, "question_id": 46935719, "link": "https://stackoverflow.com/questions/46935719/excel-file-is-read-only-file-how-to-change-it-so-edits-can-be-made-to-the-exc", "title": "Excel File is [Read Only] file: How to change it so edits can be made to the excel file?", "body": "<p>I am running a code where an excel will be saved into another directory and it works. My problem is it changes to a read only file and if I want to make a change to the file, I have to resave it with a new name. Is there a way to make it so edits can be made to the excel file that is being saved into the F drive? Because the rest of my code is dependent on the file in the PATH. So if I change data in excel file, I have to change name of excel file and the rest of my code will just read the data from the original file.</p>\n\n<pre><code>PATH='F:\\Ten Year Load Forecasts.xlsm'\nMaster_Copy='I:\\Ten Year Load Forecasts.xlsm'\n\nif os.path.isfile(PATH) and os.access(PATH, os.R_OK):\n    #print ('File exists and is readable')\n    xlApp = win32com.client.DispatchEx('Excel.Application') # Running Excel\n    xlsPath = os.path.expanduser(PATH)# Reading xlsm file\n    wb = xlApp.Workbooks.Open(Filename=xlsPath) # Opening file\n    xlApp.Run('csvfile3')# Running macro---- csvfile3 is the macro name. It is under the \"csv\" module in the VBA editor\n    #wb.Save()\n    #wb.close()\n\n    xlApp.Quit()\n\nelse:\n    #copyfile(Master_Copy, PATH)\n\n    \"Save Master_Copy to Path\"\n    \"Repeat Function From above with running macro\"                         \n    xlApp = win32com.client.DispatchEx('Excel.Application') # Running Excel\n    xlsPath = os.path.expanduser(Master_Copy)# Reading xlsm file\n    wb = xlApp.Workbooks.Open(Filename=xlsPath) # Opening file\n    xlApp.Run('csvfile4')# Running macro---- csvfile3 is the macro name. It is under the \"csv\" module in the VBA editor\n    #wb.Save()\n    xlApp.Quit()\n    #wb.close()\n</code></pre>\n\n<p>-\nThis is the csv file 4 VBA code</p>\n\n<pre><code>Sub csvfile4()\n\nApplication.DisplayAlerts = False\n\nApplication.DisplayAlerts = False\n\nActiveWorkbook.SaveAs Filename:= _\n        \"F:\\Ten Year Load Forecasts 2017-2026.xlsm\", _\n        FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False\n\nThisWorkbook.Worksheets(\"PSSE_Export_Data\").Copy\nActiveWorkbook.SaveAs Filename:=\"F:\\Load_Forecasts.csv\", FileFormat:=xlCSV\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", "vba", "visio"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508946673, "post_id": 46935818, "comment_id": 80820929, "body": "And what member do you think your C# indexer is invoking? That&#39;s right, some <code>get_Item</code> method. Also if <code>Shapes</code> is a collection class, by convention its <code>Item</code> property should be its <i>default member</i>, meaning <code>Set test = GroupStall.Shapes(&quot;name&quot;)</code> should work. Note the <code>Set</code> keyword required in VBA to assign any object reference."}], "tags": [], "owner": {"reputation": 309, "user_id": 3417711, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9c911566df25175612f5428eaace038?s=128&d=identicon&r=PG&f=1", "display_name": "jediderek", "link": "https://stackoverflow.com/users/3417711/jediderek"}, "is_accepted": true, "score": 1, "last_activity_date": 1508943695, "creation_date": 1508943695, "answer_id": 46935818, "question_id": 46935654, "link": "https://stackoverflow.com/questions/46935654/visio-cannot-find-shape-in-a-group-shape/46935818#46935818", "title": "Visio: Cannot find shape in a group shape", "body": "<p>Already found the answer to my own question. In C# if you want to assign a shape object using a shape's name you use:</p>\n\n<pre><code>IVisio.Shape test = GroupStall.Shapes[\"name\"]\n</code></pre>\n\n<p>I found this weird because I could not do this in VBA, VBA you had to use the item method to find a shape by name:</p>\n\n<pre><code>test = GroupStall.Shapes.Item(\"name\")\n</code></pre>\n\n<p>Hope this helps anyone else developing in visio using C#.</p>\n"}], "owner": {"reputation": 309, "user_id": 3417711, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b9c911566df25175612f5428eaace038?s=128&d=identicon&r=PG&f=1", "display_name": "jediderek", "link": "https://stackoverflow.com/users/3417711/jediderek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 46935818, "answer_count": 1, "score": 0, "last_activity_date": 1508943695, "creation_date": 1508943231, "question_id": 46935654, "link": "https://stackoverflow.com/questions/46935654/visio-cannot-find-shape-in-a-group-shape", "title": "Visio: Cannot find shape in a group shape", "body": "<p>I am transfering vba code over to c# using the Microsoft.Office.Interop.Visio library. I am having a hard time figuring out why I'm getting an \"Object name not found\" exception. Code below:</p>\n\n<pre><code>foreach (IVisio.Shape t in GroupStall.Shapes)\n                    {\n                        Console.WriteLine(t.Name);\n                    }\n                    var aa = \"door\" + index;\n                    IVisio.Shape test = GroupStall.Shapes.ItemU[aa];\n</code></pre>\n\n<p>I'm using the for each loop for debugging purposes. In the output of foreach is:</p>\n\n<pre><code>headrail2\nheadrail1\ntoilet1\ntoprail1\nsiderail1A\ndoor1\nstallwidth1\n</code></pre>\n\n<p>I already know that \"door1\" exist in there so I shouldn't need to always go through a foreach loop just to assign it to a shape object. But when I get to assigning \"door1\" shape to \"test, I get the exception, \"Object name not found.\" Any help on why?</p>\n"}, {"tags": ["excel", "ms-office", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1508943188, "post_id": 46935569, "comment_id": 80818425, "body": "Please explain how do you expect your code works."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1508943334, "post_id": 46935569, "comment_id": 80818518, "body": "What does the pricing have to do with the code you posted? How would we/you know what the updated pricing should be?"}, {"owner": {"reputation": 11, "user_id": 4906157, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207263155526785/picture?type=large", "display_name": "Sean Watkins", "link": "https://stackoverflow.com/users/4906157/sean-watkins"}, "edited": false, "score": 0, "creation_date": 1508943539, "post_id": 46935569, "comment_id": 80818654, "body": "I want to change the 2 ft PVC price of 390 to 290 across all 2 ft PVC products.  Does that make sense?"}, {"owner": {"reputation": 11, "user_id": 4906157, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207263155526785/picture?type=large", "display_name": "Sean Watkins", "link": "https://stackoverflow.com/users/4906157/sean-watkins"}, "edited": false, "score": 0, "creation_date": 1508943624, "post_id": 46935569, "comment_id": 80818695, "body": "It&#39;s a shopify exported product CSV document."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1508943631, "post_id": 46935569, "comment_id": 80818703, "body": "That makes sense - what it looks like you&#39;re currently doing is replace &quot;2 ft&quot; with &quot;2 ft&quot;, &quot;PVC&quot; with &quot;PVC&quot; and &quot;390&quot; with &quot;290&quot; - so the only change you&#39;re seeing is that <b>all</b> &quot;390&quot; values change to &quot;290&quot;."}, {"owner": {"reputation": 11, "user_id": 4906157, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207263155526785/picture?type=large", "display_name": "Sean Watkins", "link": "https://stackoverflow.com/users/4906157/sean-watkins"}, "edited": false, "score": 0, "creation_date": 1508943694, "post_id": 46935569, "comment_id": 80818743, "body": "Document screenshot: <a href=\"http://prntscr.com/h1votx\" rel=\"nofollow noreferrer\">prntscr.com/h1votx</a>"}, {"owner": {"reputation": 11, "user_id": 4906157, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207263155526785/picture?type=large", "display_name": "Sean Watkins", "link": "https://stackoverflow.com/users/4906157/sean-watkins"}, "edited": false, "score": 0, "creation_date": 1508943792, "post_id": 46935569, "comment_id": 80818821, "body": "Yes, Darren - I need it to only replace the &quot;pvc&quot; product 2 ft pricing, and so on for the various sizes without having to edit each of these rows if possible."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1508943794, "post_id": 46935569, "comment_id": 80818823, "body": "prntscr.com..... Access denied for me, but so are the SO images.  Update your original question with the image and someone should be able to help you (I can&#39;t as I can&#39;t see the image)."}, {"owner": {"reputation": 11, "user_id": 4906157, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207263155526785/picture?type=large", "display_name": "Sean Watkins", "link": "https://stackoverflow.com/users/4906157/sean-watkins"}, "edited": false, "score": 0, "creation_date": 1508944855, "post_id": 46935569, "comment_id": 80819607, "body": "So I basically need to to be strict when I want to change the price of each product size line item.  How can I do this?  I feel like I am really close."}], "answers": [{"comments": [{"owner": {"reputation": 56, "user_id": 4645510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7525d0b2a9e7dd94482bd621f55aa2d8?s=128&d=identicon&r=PG", "display_name": "Kudu2", "link": "https://stackoverflow.com/users/4645510/kudu2"}, "edited": false, "score": 0, "creation_date": 1508946529, "post_id": 46936489, "comment_id": 80820824, "body": "of course the easier way would be to add a filter to the columns, and then filter by option1 and option2 and then you can just edit all the rows at the same time"}, {"owner": {"reputation": 11, "user_id": 4906157, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207263155526785/picture?type=large", "display_name": "Sean Watkins", "link": "https://stackoverflow.com/users/4906157/sean-watkins"}, "edited": false, "score": 0, "creation_date": 1508947310, "post_id": 46936489, "comment_id": 80821354, "body": "Hi Kudu2 - I tried that code and for some reason I couldn&#39;t get it to replace the PVC price from 390 to 290 in the 2 ft line."}, {"owner": {"reputation": 56, "user_id": 4645510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7525d0b2a9e7dd94482bd621f55aa2d8?s=128&d=identicon&r=PG", "display_name": "Kudu2", "link": "https://stackoverflow.com/users/4645510/kudu2"}, "reply_to_user": {"reputation": 11, "user_id": 4906157, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207263155526785/picture?type=large", "display_name": "Sean Watkins", "link": "https://stackoverflow.com/users/4906157/sean-watkins"}, "edited": false, "score": 0, "creation_date": 1508950353, "post_id": 46936489, "comment_id": 80823100, "body": "Oh sorry, I thought your option1 and option2 were in columns b and d. I&#39;ve updated the code for the proper columns. But like i said, if you add a filter to your column names, it&#39;s a lot easier to deal with large amounts of data. see <a href=\"https://www.gcflearnfree.org/excel2013/filtering-data/1/\" rel=\"nofollow noreferrer\">gcflearnfree.org/excel2013/filtering-data/1</a>"}], "tags": [], "owner": {"reputation": 56, "user_id": 4645510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7525d0b2a9e7dd94482bd621f55aa2d8?s=128&d=identicon&r=PG", "display_name": "Kudu2", "link": "https://stackoverflow.com/users/4645510/kudu2"}, "is_accepted": false, "score": 0, "last_activity_date": 1508950209, "last_edit_date": 1508950209, "creation_date": 1508945518, "answer_id": 46936489, "question_id": 46935569, "link": "https://stackoverflow.com/questions/46935569/find-and-replace-multiple-lines-in-excel/46936489#46936489", "title": "Find and Replace Multiple Lines in Excel", "body": "<p>Do you only have 1 sheet? This code will work with the sheet in the print screen, however it is hard coded to the current columns that the values fall into. It can be relaxed a bit if you need it to work for different values or different columns.</p>\n\n<pre><code>Sub Multi_FindReplaceALL_pvc_replace_new()\n'PURPOSE: Find &amp; Replace a list of text/values throughout entire workbook\n'SOURCE: www.TheSpreadsheetGuru.com/the-code-vault\n\nDim sht As Worksheet\nDim i As Integer\n\nDim lastRow As Integer\n\n'get the last row in the sheet\nWith ActiveSheet\n  lastRow = .Cells(.Rows.Count, \"I\").End(xlUp).Row\nEnd With\n\n'Loop through each row in the sheet\n For i = 1 To lastRow\n'Loop through each worksheet in ActiveWorkbook\n    If Cells(i, 9).Value = \"2 ft\" And Cells(i, 11).Value = \"PVC\" Then\n        Cells(i, 20).Value = \"290\"\n    End If\n  Next i\n\nEnd Sub\n</code></pre>\n\n<p>Basically your code before was just running through the entire sheet and changing all the values if they were in that array. This function goes row by row and specifically compares the columns that contain your values</p>\n"}], "owner": {"reputation": 11, "user_id": 4906157, "user_type": "registered", "profile_image": "https://graph.facebook.com/10207263155526785/picture?type=large", "display_name": "Sean Watkins", "link": "https://stackoverflow.com/users/4906157/sean-watkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1004, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508950209, "creation_date": 1508942992, "last_edit_date": 1531161705, "question_id": 46935569, "link": "https://stackoverflow.com/questions/46935569/find-and-replace-multiple-lines-in-excel", "title": "Find and Replace Multiple Lines in Excel", "body": "<p>I have a document that has a product length | product name | and product price</p>\n\n<p>I have used this code I found online to replace the product price: </p>\n\n<pre><code>Sub Multi_FindReplaceALL_pvc_replace_new()\n'PURPOSE: Find &amp; Replace a list of text/values throughout entire workbook\n'SOURCE: www.TheSpreadsheetGuru.com/the-code-vault\n\nDim sht As Worksheet\nDim fndList As Variant\nDim rplcList As Variant\nDim x As Long\n\nfndList = Array(\"2 ft\", \"PVC\", \"390\")\nrplcList = Array(\"2 ft\", \"PVC\", \"290\")\n\n'Loop through each item in Array lists\n For x = LBound(fndList) To UBound(fndList)\n'Loop through each worksheet in ActiveWorkbook\n  For Each sht In ActiveWorkbook.Worksheets\n    sht.Cells.Replace What:=fndList(x), Replacement:=rplcList(x), _\n      LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _\n      SearchFormat:=False, ReplaceFormat:=False\n  Next sht\n\n  Next x\n\nEnd Sub\n</code></pre>\n\n<p>The issue I am having is this VB script is replacing the product name Acrylic's pricing as well.</p>\n\n<p>Any help would be greatly appreciated.  I can also supply any additional information if needed.</p>\n\n<p>Image Link of Doc: <a href=\"http://prntscr.com/h1votx\" rel=\"nofollow noreferrer\">http://prntscr.com/h1votx</a></p>\n"}, {"tags": ["excel", "vba", "ado"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1508942472, "post_id": 46935290, "comment_id": 80817884, "body": "Is your table-name really <code>Table</code>?"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1508942652, "post_id": 46935290, "comment_id": 80818009, "body": "How do you determine if the query is not empty? What would <code>?rs.RecordCount</code> return? Also might be worth checking if <code>Sheet1</code> belongs to where you think belongs."}, {"owner": {"reputation": 1024, "user_id": 4232530, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1387106745/picture?type=large", "display_name": "rakamakafo", "link": "https://stackoverflow.com/users/4232530/rakamakafo"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1508942978, "post_id": 46935290, "comment_id": 80818261, "body": "@FunThomas, does that matter what table name is?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508943048, "post_id": 46935290, "comment_id": 80818319, "body": "Where are you declaring <code>Sheet1</code>?"}, {"owner": {"reputation": 1024, "user_id": 4232530, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1387106745/picture?type=large", "display_name": "rakamakafo", "link": "https://stackoverflow.com/users/4232530/rakamakafo"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1508943093, "post_id": 46935290, "comment_id": 80818354, "body": "@VictorK, record count returns -1"}, {"owner": {"reputation": 1024, "user_id": 4232530, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1387106745/picture?type=large", "display_name": "rakamakafo", "link": "https://stackoverflow.com/users/4232530/rakamakafo"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508943151, "post_id": 46935290, "comment_id": 80818398, "body": "@braX, I&#39;m not declaring Sheet1 anywhere, it&#39;s just Sheet1 of excel. It&#39;s there"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1508943236, "post_id": 46935290, "comment_id": 80818452, "body": "@Sher: No, as long as the name is correct - but I think the name <code>table</code> is a reserved word and cannot be used as table name. So I assume that your SQL statement is wrong. However, that should lead to a runtime error."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508943312, "post_id": 46935290, "comment_id": 80818503, "body": "that&#39;s not how it works."}, {"owner": {"reputation": 1024, "user_id": 4232530, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1387106745/picture?type=large", "display_name": "rakamakafo", "link": "https://stackoverflow.com/users/4232530/rakamakafo"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1508943319, "post_id": 46935290, "comment_id": 80818508, "body": "@FunThomas, I just coded that name as Table, so that things are clear. Actually its name is other. And query returns 22 rows when I run it in SSMS"}, {"owner": {"reputation": 1024, "user_id": 4232530, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1387106745/picture?type=large", "display_name": "rakamakafo", "link": "https://stackoverflow.com/users/4232530/rakamakafo"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508943344, "post_id": 46935290, "comment_id": 80818528, "body": "@braX, Can you please help me review it?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508943456, "post_id": 46935290, "comment_id": 80818609, "body": "Not if you dont declare Sheet1."}, {"owner": {"reputation": 1024, "user_id": 4232530, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1387106745/picture?type=large", "display_name": "rakamakafo", "link": "https://stackoverflow.com/users/4232530/rakamakafo"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508943531, "post_id": 46935290, "comment_id": 80818649, "body": "@braX, how I should declare it? It&#39;s like there. Are they declared at all?"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1508943608, "post_id": 46935290, "comment_id": 80818686, "body": "@Sher I believe that the issue might be with the <code>RecordSet</code> itself if it returns you a negative <code>RecordCount</code>. Possibly you should look into <code>CursorType</code> property (I would use <code>adOpenStatic</code>if you are just reading the values to spreadhseet)"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508943649, "post_id": 46935290, "comment_id": 80818711, "body": "@brax: No, it&#39;s allowed to access a sheet by it&#39;s <code>CodeName</code>."}, {"owner": {"reputation": 1024, "user_id": 4232530, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1387106745/picture?type=large", "display_name": "rakamakafo", "link": "https://stackoverflow.com/users/4232530/rakamakafo"}, "reply_to_user": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1508944037, "post_id": 46935290, "comment_id": 80819000, "body": "@VictorK, That helped. Thanks. adOpenStatic issue. Would you mind post your solution?"}, {"owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "edited": false, "score": 0, "creation_date": 1508944067, "post_id": 46935290, "comment_id": 80819015, "body": "@Sher I am glad it helped, I will post it in a moment"}], "answers": [{"tags": [], "owner": {"reputation": 1009, "user_id": 8597922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e69b6bfa755158be2eb8f3d288ccf7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Victor K", "link": "https://stackoverflow.com/users/8597922/victor-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1508944321, "creation_date": 1508944321, "answer_id": 46936039, "question_id": 46935290, "link": "https://stackoverflow.com/questions/46935290/importing-values-from-sql-server-to-excel/46936039#46936039", "title": "Importing values from SQL Server to Excel", "body": "<p>In cases where you would like to just read a set of records from the database, such as writing current state of the records to the worksheet you should specify <code>CursorType</code> property of the <code>ADODB.RecordSet</code> as <code>adOpenStatic</code>\nHere is the link to Microsoft documention of it: <a href=\"https://docs.microsoft.com/en-us/sql/ado/guide/data/types-of-cursors-ado\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/sql/ado/guide/data/types-of-cursors-ado</a></p>\n"}], "owner": {"reputation": 1024, "user_id": 4232530, "user_type": "registered", "accept_rate": 72, "profile_image": "https://graph.facebook.com/1387106745/picture?type=large", "display_name": "rakamakafo", "link": "https://stackoverflow.com/users/4232530/rakamakafo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 46936039, "answer_count": 1, "score": 1, "last_activity_date": 1508944321, "creation_date": 1508942289, "question_id": 46935290, "link": "https://stackoverflow.com/questions/46935290/importing-values-from-sql-server-to-excel", "title": "Importing values from SQL Server to Excel", "body": "<p>I can't import values values from SQL Server to Excel. Can someone please help:</p>\n\n<pre><code>Dim oConn As ADODB.Connection\nPrivate Sub ConnectDB()\n\n    Set oConn = New ADODB.Connection\n    oConn.Open \"Provider=SQLOLEDB; \" &amp; _\n            \"Data Source=ServerName; \" &amp; _\n            \"Initial Catalog=MyDB;\" &amp; _\n            \"Trusted_Connection=yes;\"\nEnd Sub\nPublic Sub ExportDataToDB()\n    Dim rs As ADODB.Recordset\n    ConnectDB\n    Set rs = New ADODB.Recordset\n    Dim strSql As String\n\n    strSql = \"select t.col1, t.col2 from Table t\"\n\n    rs.Open strSql, oConn\n\n    Sheet1.Range(\"A2\").CopyFromRecordset rs\n\n    CloseDBConn\nEnd Sub\n\nPrivate Sub CloseDBConn()\n    oConn.Close\nEnd Sub\n</code></pre>\n\n<p>Connection is successful. No errors. Query is not empty, but nothing is returned into sheet.</p>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1508942660, "post_id": 46935270, "comment_id": 80818021, "body": "<code>If c.Interior.PATTERN &lt;&gt; xlNone Then</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1508942703, "post_id": 46935270, "comment_id": 80818048, "body": "<code>With C.Validation</code>"}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1508942778, "post_id": 46935270, "comment_id": 80818108, "body": "Hi Jeeped! That fixed it!! Thanks so much :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1508942865, "post_id": 46935270, "comment_id": 80818179, "body": "Can we just chalk this up to a typo or would you rather a formal response below?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1508942898, "post_id": 46935270, "comment_id": 80818201, "body": "@mitchmitch24 You can also get rid of that <code>Else</code> and just make your <code>If</code> line <code>If Not c.Interior.ColorIndex &lt;&gt; xl None Then</code>"}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1508942957, "post_id": 46935270, "comment_id": 80818245, "body": "Hi Jeeped, I was not familiar with .interior code until today, so this is all pretty new. I summed up your comments in an answer though! Thanks again!"}, {"owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "edited": false, "score": 0, "creation_date": 1508943017, "post_id": 46935270, "comment_id": 80818296, "body": "Hi dwirony, I&#39;ve been seeing the if not none then statements lately, but I am still struggling to understand- is it simply a way to shorten if then else statements? Thanks for your feedback!"}], "answers": [{"tags": [], "owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "is_accepted": false, "score": 1, "last_activity_date": 1508942880, "creation_date": 1508942880, "answer_id": 46935528, "question_id": 46935270, "link": "https://stackoverflow.com/questions/46935270/excel-vba-place-data-validation-in-a-cell-if-it-is-not-filled-with-color/46935528#46935528", "title": "Excel VBA - Place Data Validation in a cell if it is not filled with color", "body": "<p>As per Jeeped's comments:</p>\n\n<p>Changing the <code>c.interior.colorindex</code> to <code>c.interior.pattern</code> and changing the <code>Range.Validation</code> to <code>c.validation</code></p>\n\n<p>got it working. Thanks again to Jeeped!</p>\n"}], "owner": {"reputation": 325, "user_id": 8641187, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/370e6be57dbbeb429d985d38534eb02d?s=128&d=identicon&r=PG&f=1", "display_name": "mitchmitch24", "link": "https://stackoverflow.com/users/8641187/mitchmitch24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508942880, "creation_date": 1508942250, "question_id": 46935270, "link": "https://stackoverflow.com/questions/46935270/excel-vba-place-data-validation-in-a-cell-if-it-is-not-filled-with-color", "title": "Excel VBA - Place Data Validation in a cell if it is not filled with color", "body": "<p>I am trying to add a Data Validation to cells that are <em>not</em> filled with color. With the code I've tried (see below), for some reason it still adds the Data Validation to every cell in the range, even if they are filled with a color.</p>\n\n<p>Any help is appreciated!</p>\n\n<pre><code>Sub Data_Validation()\n\nDim WS As Worksheet\nDim WS2 As Worksheet\nDim Range1 As Range, Range2 As Range\nDim c As Range\n\nSet WS = ThisWorkbook.Worksheets(\"Report\")\nSet WS2 = ThisWorkbook.Worksheets(\"List\")\n\n'these are two cells in column A, but they may change position if rows are added, so I named them. \nSet Range1 = WS.Range(\"DV_Start:DV_End\") \n\n'This is the named range for cells on the List worksheet:\nSet Range2 = WS2.Range(\"ListCells\")\n\nFor Each c In Range1\n\n    If c.Interior.ColorIndex &lt;&gt; xlNone Then\n\n    Else\n\n        With Range1.Validation\n            .Delete\n            .Add Type:=xlValidateList, _\n                Formula1:=\"='\" &amp; WS2.Name &amp; \"'!\" &amp; Range2.Address\n            .IgnoreBlank = True\n            .InCellDropdown = True\n            .InputTitle = \"Name\"\n            .ErrorTitle = \"ERROR: Invalid\"\n            .InputMessage = \"Please enter or select something...\"\n            .ErrorMessage = \"What you have entered is invalid. Please try again.\"\n            .ShowInput = True\n            .ShowError = True\n        End With\n\n    End If\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "class", "object"], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 4, "last_activity_date": 1508942338, "creation_date": 1508942338, "answer_id": 46935314, "question_id": 46935206, "link": "https://stackoverflow.com/questions/46935206/vba-class-module-get-property-from-an-object-using-another-property/46935314#46935314", "title": "VBA class module: get property from an object using another property", "body": "<p>Use a <code>dictionary</code> of <code>Milestone</code> classes in the <code>plan class</code> and set the <code>key</code> to be the \"Milestone_x\" and the <code>item</code> to be a <code>milestone class</code></p>\n\n<p>Then you can say <code>Plan.Milestones(\"Milestone99\")</code></p>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 1035461, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9c05385f3666aff783aa5ba1b17f94f4?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/1035461/hans"}, "edited": false, "score": 0, "creation_date": 1508943858, "post_id": 46935403, "comment_id": 80818876, "body": "I suppose this would mean I still need to loop through all milestones to find the corresponding item, right?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 131, "user_id": 1035461, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9c05385f3666aff783aa5ba1b17f94f4?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/1035461/hans"}, "edited": false, "score": 1, "creation_date": 1508946403, "post_id": 46935403, "comment_id": 80820745, "body": "@Hans if you&#39;re <b>specifying a key when you add the items</b> to the collection, you don&#39;t need to iterate anything or to use a dictionary. But <b>you&#39;re not showing us</b> your <code>Add</code> method, so we all have to make assumptions."}], "tags": [], "owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "is_accepted": false, "score": 0, "last_activity_date": 1508942568, "creation_date": 1508942568, "answer_id": 46935403, "question_id": 46935206, "link": "https://stackoverflow.com/questions/46935206/vba-class-module-get-property-from-an-object-using-another-property/46935403#46935403", "title": "VBA class module: get property from an object using another property", "body": "<p>Add a property to the Milestones class that returns the milestone based on the name:</p>\n\n<pre><code>Property Get SelectByName(strMilestoneName as string) as clsMilestone\n     Dim vIndex\n     'Add code here to find the index of the milestone in question\n     vIndex = ????????\n\n     Set SelectByName = prvt_Milestones(Index)\nEnd Property\n</code></pre>\n\n<p>OR</p>\n\n<p>Edit the Item Property to Allow selection by either Index or Name:</p>\n\n<pre><code>Property Get Item(Index As Variant) As clsMilestone\n    If isNumeric(Index) then\n       Set Item = prvt_Milestones(Index)\n    Else\n       'Find Item based on Name\n        Dim vIndex\n        vIndex = ?????\n       Set Item = prvt_Milestones(vIndex)\n     End If\nEnd Property\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508944462, "post_id": 46936029, "comment_id": 80819315, "body": "Note that I dropped the <code>cls</code> prefix on the class name. I&#39;ve never seen any class in any object model with a <code>cls</code> prefix, for one, and it reeks of <i>Systems Hungarian</i> notation, <a href=\"https://www.joelonsoftware.com/2005/05/11/making-wrong-code-look-wrong/\" rel=\"nofollow noreferrer\">which was nothing more than an unfortunate misunderstanding</a> and should never have come to be."}, {"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1508944995, "post_id": 46936029, "comment_id": 80819730, "body": "+1 Very nicely done. I would sure be interested (as I&#39;m sure a lot of people would) in a little more detail on the NewEnum property you added."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 1, "creation_date": 1508945244, "post_id": 46936029, "comment_id": 80819910, "body": "@KacireeSoftware it taps into how VBA&#39;s <code>For Each</code> loop works, and essentially does nothing more than exposing the encapsulated collection&#39;s own enumerator, which you can reveal by ticking the &quot;show hidden members&quot; in the <i>Object Browser</i> (F2). I held myself back from mentioning an upcoming Rubberduck feature that allows you to skip the whole export-edit-import part, using simple <code>&#39;@DefaultMember</code> and <code>&#39;@Description(&quot;does something&quot;)</code> or <code>&#39;@Enumerator</code> <i>annotations</i> / magic comments to tell Rubberduck there should be an attribute there (the feature is still WIP right now)."}, {"owner": {"reputation": 778, "user_id": 2167723, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhuk5.png?s=128&g=1", "display_name": "KacireeSoftware", "link": "https://stackoverflow.com/users/2167723/kacireesoftware"}, "edited": false, "score": 0, "creation_date": 1508948027, "post_id": 46936029, "comment_id": 80821813, "body": "Ok I just tested it and it&#39;s beautiful. Thanks Mat&#39;s Mug"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 7, "last_activity_date": 1508950007, "last_edit_date": 1508950007, "creation_date": 1508944281, "answer_id": 46936029, "question_id": 46935206, "link": "https://stackoverflow.com/questions/46935206/vba-class-module-get-property-from-an-object-using-another-property/46936029#46936029", "title": "VBA class module: get property from an object using another property", "body": "<p>Your <code>Milestones</code> class is a <em>collection class</em>. By convention, collection classes have an <code>Item</code> property that is the class' <em>default member</em>. You can't easily specify a class' default member in VBA, but it's not impossible.</p>\n\n<p>Export the code file, open it in Notepad. Locate your <code>Public Property Get Item</code> member and add a <code>VB_UserMemId</code> attribute - while you're there you can add a <code>VB_Description</code> attribute, too:</p>\n\n<pre><code>Public Property Get Item(ByVal Index As Variant) As Milestone\nAttribute Item.VB_UserMemId = 0\nAttribute Item.VB_Description = \"Gets the item at the specified index, or with the specified name.\"\n    Set Item = prvt_Milestones(Index)\nEnd Property\n</code></pre>\n\n<p>The <code>UserMemId = 0</code> is what makes the property the class' <em>default member</em> - note that only one member in the class can have that value.</p>\n\n<p>Don't save and close just yet.</p>\n\n<p>You'll want to make your collection class work with a <code>For Each</code> loop too, and for that to work you'll need a <code>NewEnum</code> property that returns an <code>IUnknown</code>, with a number of attributes and flags:</p>\n\n<pre><code>Public Property Get NewEnum() As IUnknown\nAttribute NewEnum.VB_Description = \"Gets an enumerator that iterates through the collection.\"\nAttribute NewEnum.VB_UserMemId = -4\nAttribute NewEnum.VB_MemberFlags = \"40\"    \n    Set NewEnum = prvt_Milestones.[_NewEnum]\nEnd Property\n</code></pre>\n\n<p>Note that your internal encapsulated <code>Collection</code> has a hidden member with a name that begins with an underscore - that's illegal in VBA, so to invoke it you need to surround it with square brackets.</p>\n\n<p>Now this code is legal:</p>\n\n<pre><code>Dim ms As Milestone\nFor Each ms In Plan.Milestones\n    Debug.Print ms.Name, ms.Value ', ms.DateDue, ...\nNext\n</code></pre>\n\n<p>Save the file, close it, and re-import it into your project.</p>\n\n<p>Since you're populating the collection using a string key (at least that's what your <code>Add</code> method seems to be doing), then the client code can use either the index or the key to retrieve an item.</p>\n\n<p>And now that <code>Item</code> is the class' <em>default member</em>, this is now legal:</p>\n\n<pre><code>Set milestoneA = Plan.Milestones(\"Milestone A\").Value\n</code></pre>\n\n<p>Note that your <code>Add</code> method needs to specify a value for the <code>Key</code> argument when adding to the internal collection - if you want the items keyed by <code>Name</code>, use the <code>Name</code> as a key:</p>\n\n<pre><code>Public Sub Add(ByVal Name As String, ByVal Value As Variant)\n    Dim new_milestone As Milestone\n    Set new_milestone = New Milestone\n\n    new_milestone.Name = Name\n    new_milestone.Value = Value\n\n    prvt_Milestones.Add new_milestone, Name\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 1035461, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9c05385f3666aff783aa5ba1b17f94f4?s=128&d=identicon&r=PG", "display_name": "Hans", "link": "https://stackoverflow.com/users/1035461/hans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1379, "favorite_count": 0, "accepted_answer_id": 46935314, "answer_count": 3, "score": 7, "last_activity_date": 1508950007, "creation_date": 1508942051, "last_edit_date": 1508949930, "question_id": 46935206, "link": "https://stackoverflow.com/questions/46935206/vba-class-module-get-property-from-an-object-using-another-property", "title": "VBA class module: get property from an object using another property", "body": "<p>All,\nI am setting-up a class module structure in VBA to add plans that have multiple milestones, but I'm quite new to it. I did the following:</p>\n\n<ul>\n<li>A class module called 'Plan' that contains a 'name' property (string) and a 'Milestones' property (class Milestones). </li>\n<li>This milestones class module is a collection of objects of a class module called 'Milestone'.</li>\n<li>The 'Milestone' class has a 'name' property and a 'value' property. </li>\n</ul>\n\n<p>So in my module I am now specifying the milestones for a specific plan:</p>\n\n<pre><code>Plan.Milestones.Add \"MilestoneA\", Cells(i, 5)\nPlan.Milestones.Add \"MilestoneB\", Cells(i, 7)\n...\n</code></pre>\n\n<p>Until now everything is fine. Now for MilestoneC I would like to know the value of MilestoneA. How do I get the value for the Milestone with name 'MilestoneA'.</p>\n\n<p>I know the below code would give me the answer, but I don't want to hardcode 'item(1)' (I want to use the name):</p>\n\n<pre><code>Plan.Milestones.Item(1).Value\n</code></pre>\n\n<p>In the clsMilestones class:</p>\n\n<pre><code>Private prvt_Milestones As New Collection\n\nProperty Get Item(Index As Variant) As clsMilestone\n    Set Item = prvt_Milestones(Index)\nEnd Property\n\nSub Add(param_Name As String, param_Value As String)\n\n    Dim new_milestone As clsMilestone\n    Set new_milestone = New clsMilestone\n\n    new_milestone.Name = param_Name\n    new_milestone.Value = param_Value\n\n    prvt_Milestones.Add new_milestone\nEnd Sub\n</code></pre>\n"}, {"tags": ["vb.net", "vba", "outlook", "vsto", "outlook-addin"], "answers": [{"tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 1, "last_activity_date": 1508973617, "creation_date": 1508973617, "answer_id": 46943481, "question_id": 46935171, "link": "https://stackoverflow.com/questions/46935171/outlook-vsto-add-in-custom-rule-script/46943481#46943481", "title": "Outlook VSTO Add-in Custom rule/script", "body": "<p>Outlook doesn't provide any way for assigning COM add-ins to rules. So, you need to handle corresponding events that OOM provides. In that case you need to handle the <code>NewMailEx</code> event of the Application class which is fired when a new item is received in the Inbox. The <code>NewMailEx</code> event fires when a new message arrives in the Inbox and before client rule processing occurs. You can use the Entry ID returned in the <code>EntryIDCollection</code> array to call the <a href=\"https://msdn.microsoft.com/en-us/library/microsoft.office.interop.outlook._namespace.getitemfromid.aspx\" rel=\"nofollow noreferrer\">GetItemFromID</a> method and process the item. Then you can call the <code>DruckeAnhaenge</code> method and pass the item there.</p>\n"}], "owner": {"reputation": 231, "user_id": 2543819, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/100001192981604/picture?type=large", "display_name": "Philip Scheer", "link": "https://stackoverflow.com/users/2543819/philip-scheer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508973617, "creation_date": 1508941950, "last_edit_date": 1508942549, "question_id": 46935171, "link": "https://stackoverflow.com/questions/46935171/outlook-vsto-add-in-custom-rule-script", "title": "Outlook VSTO Add-in Custom rule/script", "body": "<p>I have a VBA Script which I want to turn into a VSTO add-in for Outlook.</p>\n\n<p>In VBA I have a method called</p>\n\n<pre><code>Public Sub DruckeAnhaenge(oMail As Outlook.MailItem)\n</code></pre>\n\n<p>which pops up when I create a rule with \"Run a script\" then I can select this method. Which is there called \"ThisOutlookSession.DruckeAnhaenge\".</p>\n\n<p>Now I created in Visual Studio a VSTO add-in which has exactly the same method, but it doesn't show up anymore.</p>\n\n<p>The startup method is called from this add-in (checked it with a MsgBox). So my question is how I can get this method as rule/script as it is in the VBA Editor?</p>\n\n<p>Here is my whole code from the Add-In.</p>\n\n<pre><code>Public Class ThisAddIn\n\n    Private Sub ThisAddIn_Startup() Handles Me.Startup\n        MsgBox(\"Add In wird erfolgreich ausgef\u00fchrt\")\n    End Sub\n\n    Private Sub ThisAddIn_Shutdown() Handles Me.Shutdown\n\n    End Sub\n\n    Private Declare Function ShellExecute Lib \"shell32.dll\" Alias _\n        \"ShellExecuteA\" (ByVal hwnd As Long, ByVal lpOperation As String,\n        ByVal lpFile As String, ByVal lpParameters As String,\n        ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long\n\n    Private WithEvents Items As Outlook.Items\n\n    Public Sub DruckeAnhaenge(oMail As Outlook.MailItem)\n        On Error Resume Next\n        Dim colAtts As Outlook.Attachments\n        Dim oAtt As Outlook.Attachment\n        Dim sFile As String\n        Dim sDirectory As String\n        Dim sFileType As String\n\n        sDirectory = \"C:\\Attachments\\\"\n\n        'Set colAtts = oMail.Attachments\n\n        If oMail.Attachments.Count Then\n            For Each oAtt In oMail.Attachments\n\n                ' This code looks at the last 4 characters in a filename\n                sFileType = LCase$(Right$(oAtt.FileName, 4))\n\n                Select Case sFileType\n\n                ' Add additional file types below\n                    Case \".xls\", \".doc\", \".pdf\"\n                        sFile = sDirectory &amp; oAtt.FileName\n                        oAtt.SaveAsFile(sFile)\n                        ShellExecute(0, \"print\", sFile, vbNullString, vbNullString, 0)\n                End Select\n            Next\n        End If\n    End Sub\nEnd Class\n</code></pre>\n"}, {"tags": ["vba", "outlook", "exchange-server"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508942994, "post_id": 46934875, "comment_id": 80818273, "body": "<i>You</i> will have to tell the dev team how Microsoft&#39;s internal implementation of some API feature is done? They&#39;re the engineers, they&#39;re the ones that should be doing the reverse-engineering IMO."}], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1508945635, "creation_date": 1508945635, "answer_id": 46936537, "question_id": 46934875, "link": "https://stackoverflow.com/questions/46934875/how-do-i-generate-the-10-digit-hex-timestamp-for-the-conversationindex-mailitem/46936537#46936537", "title": "How do I generate the 10-digit hex timestamp for the ConversationIndex MailItem property?", "body": "<p>The format of the conversation index is documented:\n<a href=\"https://msdn.microsoft.com/en-us/library/office/cc765583.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/cc765583.aspx?f=255&amp;MSPPError=-2147217396</a></p>\n\n<p>If you want to look at existing conversation indices, you can use <a href=\"http://www.dimastr.com/outspy\" rel=\"nofollow noreferrer\">OutlookSpy</a> - click IMessage button, select the <code>PR_CONVERSATION_INDEX</code> property, look at the \"Symbol.\" edit box, e.g. </p>\n\n<pre><code>UnnamedByte: 1\nCurrent FILETIME: 6/20/1789 6:37 PM (-1615069184 (0x9FBC0000), 13847596 (0x00D34C2C))\nGUID: {516D9479-70ED-6C4F-9D7B-AC62F6808A54}\n\nResponseLevel[0] = {\n  DeltaCode = False\n  TimeDelta = 0x0000D8B4\n  Random = 7\n  ResponseLevel = 0\n}\n\nResponseLevel[1] = {\n  DeltaCode = False\n  TimeDelta = 0x000AD6AB\n  Random = 14\n  ResponseLevel = 0\n}\n</code></pre>\n"}], "owner": {"reputation": 108, "user_id": 3438194, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2e23c82bd095e743f6b1eac496fbaa28?s=128&d=identicon&r=PG&f=1", "display_name": "Dimas", "link": "https://stackoverflow.com/users/3438194/dimas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 46936537, "answer_count": 1, "score": 0, "last_activity_date": 1593071997, "creation_date": 1508941134, "last_edit_date": 1593071997, "question_id": 46934875, "link": "https://stackoverflow.com/questions/46934875/how-do-i-generate-the-10-digit-hex-timestamp-for-the-conversationindex-mailitem", "title": "How do I generate the 10-digit hex timestamp for the ConversationIndex MailItem property?", "body": "<p>I know that Outlook conversations are organized using the ConversationID and ConversationIndex properties. ID is fine, but I need to know how to construct the 10-digit hexadecimal timestamp that's added for conversations.</p>\n\n<p>For instance,</p>\n\n<pre><code>Subject:           Testing\nConversationID:    955534474030B94C8E127B286C2D43DC\nConversationIndex: 0101D34CE912955534474030B94C8E127B286C2D43DC\n\nSubject:           RE: Testing\nConversationID:    955534474030B94C8E127B286C2D43DC\nConversationIndex: 0101D34CE912955534474030B94C8E127B286C2D43DCA2F33AE240\n</code></pre>\n\n<p>As you can see, the reply added the timestamp <strong>A2F33AE240</strong> to the ConversationIndex. I know this is a timestamp because I read this</p>\n\n<blockquote>\n  <p>This convention uses concatenated time stamp values, with each new message in >the conversation adding a new time stamp to the end of the ConversationIndex >string. You can see time relationships among the messages when you sort them by >ConversationIndex values.</p>\n</blockquote>\n\n<p>here: <a href=\"https://msdn.microsoft.com/en-us/library/ms528174(v=exchg.10).aspx\" rel=\"nofollow noreferrer\" title=\"MSDN\">MSDN</a></p>\n\n<p>I haven't found any info on how to construct it myself, and I'll need to tell a dev team how it's to be created.</p>\n\n<p>A little background: a ticketing tool currently used to send emails does not respect the ConversationID and ConversationIndex properties, so any replies sent from that tool are considered by the Outlook client as new conversations when they should be part of the same conversation.</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1508941327, "post_id": 46934865, "comment_id": 80817065, "body": "Set the sub forms recordsource to be strSQL.  Your function <code>Function executeQuery(strSQL As String)</code> doesn&#39;t return anything."}, {"owner": {"reputation": 95, "user_id": 3752718, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/978588b1dec1dc472cce2f912825f4f6?s=128&d=identicon&r=PG&f=1", "display_name": "user3752718", "link": "https://stackoverflow.com/users/3752718/user3752718"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1508941440, "post_id": 46934865, "comment_id": 80817147, "body": "@Nathan_Sav That is what I&#39;m trying to achieve ,making the function <code>executeQuery</code> in a way where It could return a result and after that set the result in the subform"}, {"owner": {"reputation": 95, "user_id": 3752718, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/978588b1dec1dc472cce2f912825f4f6?s=128&d=identicon&r=PG&f=1", "display_name": "user3752718", "link": "https://stackoverflow.com/users/3752718/user3752718"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1508941477, "post_id": 46934865, "comment_id": 80817175, "body": "@Nathan_Sav Oh I think I know what you mean , I will try it thank you"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1508941541, "post_id": 46934865, "comment_id": 80817228, "body": "Read about functions then.  <code>Function executeQuery(strSQL As String) as Recordset</code> then you can do <code>set executeQuery=rst</code>  but you can just modify the subforms source query."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1508941915, "post_id": 46934865, "comment_id": 80817476, "body": "See <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/bind-a-form-to-an-ado-recordset?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">this MSDN page</a> for how to bind a form to an ADO recordset. You&#39;re using a DAO one, but you could just as easily use an ADO one"}, {"owner": {"reputation": 718, "user_id": 7623920, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c53616884833316e7363ab6d90c3a56c?s=128&d=identicon&r=PG&f=1", "display_name": "O. Gungor", "link": "https://stackoverflow.com/users/7623920/o-gungor"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1508946552, "post_id": 46934865, "comment_id": 80820846, "body": "not sure what you are trying to achieve here.. this method will perform poorly for larger data sets. Like @Nathan_Sav says, why don&#39;t you just set the sql to the form&#39;s recordsource directly? ie: me.RecordSource = strSQL"}], "owner": {"reputation": 95, "user_id": 3752718, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/978588b1dec1dc472cce2f912825f4f6?s=128&d=identicon&r=PG&f=1", "display_name": "user3752718", "link": "https://stackoverflow.com/users/3752718/user3752718"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508941116, "creation_date": 1508941116, "question_id": 46934865, "link": "https://stackoverflow.com/questions/46934865/how-to-bind-the-result-of-a-recordset-of-a-subform-after-executing-the-query", "title": "How to bind the result of a recordset of a subform after executing the query", "body": "<p>I have hard coded multiple sqlQueries:</p>\n\n<pre><code>sQueryCurrencyRate = \"SELECT * FROM Table.Mytable WHERE  As_Of_Date =\" &amp; Format(dateField.value, \"M/d/yyyy\")\n\n\n sQueryCurrencyUsDollar = \"SELECT * FROM Table.Mytable WHERE  As_Of_Date =\" &amp; Format(dateField.value, \"M/d/yyyy\")\n</code></pre>\n\n<p>Now I have made a function that will execute the query (I think it's not the optimal way) but this is what I'm trying : </p>\n\n<pre><code>Function executeQuery(strSQL As String)\n\nDim dbs As DAO.Database\n\nSet dbs = CurrentDb\nDim rst As Recordset, db As DAO.Database, fld As Field\n'Open a snapshot-type Recordset based on an SQL statement\nSet rst = dbs.OpenRecordset(strSQL, dbOpenSnapshot)\nDo Until rst.EOF\n   For Each fld In rst.Fields: MsgBox fld\n  rst.MoveNext\nLoop\nEnd Function\n</code></pre>\n\n<p><strong>What I need :</strong></p>\n\n<p>Fill the subform by the result of the executeQuery function </p>\n\n<pre><code> Me.subForm_displayQueries.SourceObject = executeQuery(sQueryCurrencyRate).result \n</code></pre>\n\n<p>How to do that?</p>\n\n<p>Thank you </p>\n"}, {"tags": ["excel", "excel-formula", "finance", "yahoo-finance", "vba"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1508942849, "post_id": 46934800, "comment_id": 80818167, "body": "Yes, there are easy ways to do that. What have you tried so far to achieve that goal? Your code is just something that runs every ten seconds and refreshes the data table..."}, {"owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1508944072, "post_id": 46934800, "comment_id": 80819020, "body": "@RikSportel haven&#39;t really tried anything to any degree of success so far, I&#39;ve never done something like this so am not sure where I&#39;d start!"}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1509024786, "post_id": 46934800, "comment_id": 80858695, "body": "Start by breaking the problem down into little steps. You already have the data, so what you want to do is: 1. Get the range with data. 2. Copy-paste it into another sheet in the range that your chart will use (or just assign the values to that range) 3. Make sure the chart takes the new column/row into account in the series (so either include a big enough range, or change the chart range in the script).  Thing is: Start coding. When you get stuck, let us know what the exact problem is. StackOverflow is not a free coding service. &quot;Can someone help me&quot; is not considered a question here."}], "owner": {"reputation": 55, "user_id": 7229848, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bf0740775ef2058d5fcaf755e4797f9?s=128&d=identicon&r=PG&f=1", "display_name": "FrasercT", "link": "https://stackoverflow.com/users/7229848/fraserct"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508940926, "creation_date": 1508940926, "last_edit_date": 1531161705, "question_id": 46934800, "link": "https://stackoverflow.com/questions/46934800/creating-an-updating-time-series-using-a-live-download-into-excel", "title": "Creating an updating time series using a live download into excel", "body": "<pre><code>Sub GetData()\n\nDim QuerySheet As Worksheet\nDim DataSheet As Worksheet\nDim qurl As String\nDim i As Integer\nDim j As Integer\nDim k As Integer\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\nApplication.Calculation = xlCalculationManual\n\nSet DataSheet = ActiveSheet\n\nRange(\"C7\").CurrentRegion.ClearContents\ni = 7\nqurl = \"http://download.finance.yahoo.com/d/quotes.csv?s=\" + Cells(i, 1)\ni = i + 1\nWhile Cells(i, 1) &lt;&gt; \"\"\n    qurl = qurl + \"+\" + Cells(i, 1)\n    i = i + 1\nWend\nqurl = qurl + \"&amp;f=\" + Range(\"C2\")\nRange(\"c1\") = qurl\nQueryQuote:\n             With ActiveSheet.QueryTables.Add(Connection:=\"URL;\" &amp; qurl, \nDestination:=DataSheet.Range(\"C7\"))\n                .BackgroundQuery = True\n                .TablesOnlyFromHTML = False\n                .Refresh BackgroundQuery:=False\n                .SaveData = True\n            End With\n\nj = Range(\"A7\").End(xlDown).Row\n\nFor k = 7 To j\n\nCells(k, \"C\").Value = Replace(Cells(k, \"C\").Value, \", Inc. Common Stoc\", \"\")\nCells(k, \"C\").Value = Replace(Cells(k, \"C\").Value, \", Inc. Common St\", \"\")\nCells(k, \"C\").Value = Replace(Cells(k, \"C\").Value, \", Inc. Co St\", \"\")\nCells(k, \"C\").Value = Replace(Cells(k, \"C\").Value, \", Inc. Co\", \"\")\nCells(k, \"C\").Value = Replace(Cells(k, \"C\").Value, \", Inc. (The)\", \"\")\nCells(k, \"C\").Value = Replace(Cells(k, \"C\").Value, \", Inc. Com\", \"\")\nCells(k, \"C\").Value = Replace(Cells(k, \"C\").Value, \", Inc.\", \"\")\nCells(k, \"C\").Value = Replace(Cells(k, \"C\").Value, \", Incorporated C\", \"\")\nCells(k, \"C\").Value = Replace(Cells(k, \"C\").Value, \", Incorporated\", \"\")\n\nNext\n\n            Range(\"C7\").CurrentRegion.TextToColumns Destination:=Range(\"C7\"), DataType:=xlDelimited, _\n            TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _\n            Semicolon:=False, Comma:=True, Space:=False, other:=False\n\n\n'turn calculation back on\n    Application.Calculation = xlCalculationAutomatic\n    Application.DisplayAlerts = True\n    'Range(\"C7:H2000\").Select\n    'Selection.Sort Key1:=Range(\"C8\"), Order1:=xlAscending, Header:=xlGuess,     _\n    '    OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom\n    Columns(\"C:C\").ColumnWidth = 25\n    Rows(\"7:2000\").RowHeight = 16\n    Columns(\"J:J\").ColumnWidth = 8.5\n\nCall test\n\nEnd Sub\n\nSub test()\n    Application.OnTime Now + TimeValue(\"00:00:10\"), \"GetData\"\nEnd Sub\n</code></pre>\n\n<p>I have this adapted code to download stock prices from Yahoo finance. What I'd like to do is add values to a graph every time the data refreshes in order to build a time series. Is there an easy way to copy each price value (20 stocks) into a separate sheet each time the cell refreshes with a new price and then plot them onto a graph?</p>\n"}, {"tags": ["excel", "excel-formula", "fuzzy-search", "vba"], "answers": [{"comments": [{"owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "edited": false, "score": 0, "creation_date": 1508944840, "post_id": 46935036, "comment_id": 80819589, "body": "that is actually a great idea :)"}], "tags": [], "owner": {"reputation": 1031, "user_id": 8571268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-B380v2cHrks/AAAAAAAAAAI/AAAAAAAADCg/RffXj5HwFJw/photo.jpg?sz=128", "display_name": "Maldred", "link": "https://stackoverflow.com/users/8571268/maldred"}, "is_accepted": false, "score": 1, "last_activity_date": 1508941580, "creation_date": 1508941580, "answer_id": 46935036, "question_id": 46934752, "link": "https://stackoverflow.com/questions/46934752/how-can-i-do-a-keyword-match-from-the-content-i-am-searching-in-excel/46935036#46935036", "title": "How can I do a keyword match from the content I am searching in Excel?", "body": "<p><code>Fuzzy Lookup</code> is intended to return a percentile to reference how close of a match it is. Please <a href=\"https://www.microsoft.com/en-ca/download/details.aspx?id=15011\" rel=\"nofollow noreferrer\">refer here</a></p>\n\n<p>One option you could do is us the <code>=IF()</code> and have it display a 1 or 0 depending on how close of a match up it is.</p>\n\n<p>ie. <code>=IF( D1 &gt;= .50 , 1 , 0)</code> or <code>=IF( D1 &lt;= .50 , 0 , 1)</code></p>\n"}, {"comments": [{"owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "edited": false, "score": 0, "creation_date": 1508944829, "post_id": 46935420, "comment_id": 80819577, "body": "Thank you, i will take a look and try to understand how this works."}], "tags": [], "owner": {"reputation": 237, "user_id": 8829910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4ef2ebd1ecc006741c6fa9c6bf5bb98?s=128&d=identicon&r=PG&f=1", "display_name": "stefan", "link": "https://stackoverflow.com/users/8829910/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1508943452, "last_edit_date": 1508943452, "creation_date": 1508942602, "answer_id": 46935420, "question_id": 46934752, "link": "https://stackoverflow.com/questions/46934752/how-can-i-do-a-keyword-match-from-the-content-i-am-searching-in-excel/46935420#46935420", "title": "How can I do a keyword match from the content I am searching in Excel?", "body": "<p>Try to use this code in a module... Use the variables to change the Worksheet name, the scanning location, the starting row and so on.</p>\n\n<p>I tried to set most of them as you need it.</p>\n\n<p>It just splits every string at their spaces maybe that can help you.</p>\n\n<pre><code>Option Explicit\nDim ws As Worksheet\nDim col1 As Integer\nDim col2 As Integer\nDim colFlag As Integer\nDim rowStart As Integer\nDim urWs1 As Long\nDim scanArr As Variant\nDim actScan As Variant\nDim i As Long\n\nSub test()\n    'Worksheet\n    Set ws = ThisWorkbook.Worksheets(\"Tabelle1\")\n    'Column D = 4\n    colFlag = 4\n    'Column H=8\n    col1 = 8\n    'Column I=9\n    col2 = 9\n    'Start scanning\n    rowStart = 2\n    'Count Rows\n    urWs1 = ws.UsedRange.Rows.Count\n\n    For i = rowStart To urWs1\n        ws.Cells(i, colFlag).Value = 0\n        'Split at spaces\n        scanArr = Split(ws.Cells(i, col1).Value, \" \")\n        For Each actScan In scanArr\n            If InStr(1, UCase(ws.Cells(i, col2).Value), UCase(actScan)) &lt;&gt; 0 Then\n                ws.Cells(i, colFlag).Value = 1\n            End If\n        Next actScan\n        'Opposite direction\n        scanArr = Split(ws.Cells(i, col2).Value, \" \")\n        For Each actScan In scanArr\n            If InStr(1, UCase(ws.Cells(i, col1).Value), UCase(actScan)) &lt;&gt; 0 Then\n                ws.Cells(i, colFlag).Value = 1\n            End If\n        Next actScan\n        scanArr = \"\"\n    Next i\n\n\nEnd Sub\n</code></pre>\n\n<p>/edit: uppercase comparison</p>\n"}], "owner": {"reputation": 398, "user_id": 1568996, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/e626621d7b6054a4f491fc974063d8ae?s=128&d=identicon&r=PG", "display_name": "DeerSpotter", "link": "https://stackoverflow.com/users/1568996/deerspotter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1509112784, "creation_date": 1508940767, "last_edit_date": 1531164843, "question_id": 46934752, "link": "https://stackoverflow.com/questions/46934752/how-can-i-do-a-keyword-match-from-the-content-i-am-searching-in-excel", "title": "How can I do a keyword match from the content I am searching in Excel?", "body": "<p>Here is the Data that i am trying to analyze:</p>\n\n<p><a href=\"https://i.stack.imgur.com/5ylJ4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5ylJ4.png\" alt=\"enter image description here\"></a></p>\n\n<p>As Shown in the picture, <strong>i am trying to match Column H with Column I</strong>. Any keyword match from <strong>Column H</strong> that matches in <strong>Column I</strong> would return a <strong>\"1\"</strong> and if no keyword matches it would return a <strong>\"0\"</strong>.</p>\n\n<p>I tried using Fuzzy Lookup, but am getting frustrated that it keeps giving me percentages and not a single 1 and 0. (true or false).</p>\n\n<p>Is there anyway to do this with either a macro or equation or if someone could help me with Fuzzy Lookup too if that is a good solution as well.</p>\n\n<p>Any help that could guide me in the right direction will help a lot.\nThanks!</p>\n\n<p>Edit: (10/27/17)</p>\n\n<p>UPDATE:</p>\n\n<p>I have used this users answer here: <a href=\"https://superuser.com/a/984389/464791\">https://superuser.com/a/984389/464791</a> </p>\n\n<p>It is really useful. But it still lacks what i believe every single excel user/dev needs, which is a string comparison in the way i describe above. I am still looking for a solution mainly so i can learn and that others in the future could have one. As of right now i don't need this solution anymore. But it is still something i would like to work on.</p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1508941126, "post_id": 46934848, "comment_id": 80816907, "body": "Should that be <code>Range(nm.name).ClearContents</code>?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1508942743, "post_id": 46934848, "comment_id": 80818077, "body": "@Jeeped - It works for me as-is, but works just as well with <code>Range(nm.Name)...</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1508942790, "post_id": 46934848, "comment_id": 80818120, "body": "Oh-key-doh-key then. I thought you might have missed converting the name object to a string."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1508941077, "creation_date": 1508941077, "answer_id": 46934848, "question_id": 46934748, "link": "https://stackoverflow.com/questions/46934748/clearing-content-of-an-excel-cell-based-on-name/46934848#46934848", "title": "Clearing content of an excel cell based on name", "body": "<p>This should point you in the right direction.  Change the <code>If</code> statement to match what you need (not sure if you're looking for <code>Sheet1</code>, or the sheet name in the workbook.)  Are you looping through your workbook?</p>\n\n<pre><code>Sub RemNamedRanges()\nDim nm      As Name\nOn Error Resume Next\nFor Each nm In ActiveWorkbook.Names\n    If nm.Name = ActiveSheet.Name Then\n        Range(nm).ClearContents\n    End If\nNext\nOn Error GoTo 0\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1508941087, "creation_date": 1508941087, "answer_id": 46934854, "question_id": 46934748, "link": "https://stackoverflow.com/questions/46934748/clearing-content-of-an-excel-cell-based-on-name/46934854#46934854", "title": "Clearing content of an excel cell based on name", "body": "<p><code>InStr</code> should be able to determine whether there is a substring within a string.</p>\n\n<pre><code>For Each nm In ActiveWorkbook.Names \n    if cbool(instr(1, nm.name, \"name\", vbtextcompare)) then _\n        nm.Delete \nNext \n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 7468987, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e631c71d841a754cac8af47e0ff55b65?s=128&d=identicon&r=PG&f=1", "display_name": "mabanger", "link": "https://stackoverflow.com/users/7468987/mabanger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 46934854, "answer_count": 2, "score": 2, "last_activity_date": 1508941087, "creation_date": 1508940750, "last_edit_date": 1531161705, "question_id": 46934748, "link": "https://stackoverflow.com/questions/46934748/clearing-content-of-an-excel-cell-based-on-name", "title": "Clearing content of an excel cell based on name", "body": "<p>I would like to make a macro where I can delete the content of multiple cells based on names. For example I have a sheet where I have sheet1name1 and sheet2name2 and on another sheet I have where I used names sheet2name1 and sheet2name2. Is it possible to write a macro what will delete the content of these cells if the cells are named \"sheet<em>name</em>\"? The stars should point to numbers.</p>\n\n<pre><code>Sub RemNamedRanges() \n    Dim nm              As Name \n    On Error Resume Next \n    For Each nm In ActiveWorkbook.Names \n        nm.Delete \n    Next \n    On Error Goto 0 \nEnd Sub \n</code></pre>\n\n<p>This is to delete all, but I need only for some particular as I mentioned before.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1508940463, "post_id": 46934592, "comment_id": 80816381, "body": "You could add code to loop all the worksheets in the each book and if .Name not like &quot;Summary&quot; then do .......... If you pulled out the code that actually does stuff in the worksheet into its own subroutine you could then have a loop each worksheet in current workbook and if name not like &quot;Summary&quot; call your subroutine."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1508940495, "post_id": 46934592, "comment_id": 80816413, "body": "Can you use the worksheet index (order) or the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-codename-property-excel\" rel=\"nofollow noreferrer\">codename</a>?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1508940800, "post_id": 46934592, "comment_id": 80816645, "body": "1) <a href=\"https://stackoverflow.com/questions/10714251/\">Avoid using <code>.Select</code>/<code>.Activate</code></a>, 2) You have a few <code>With</code> statements but don&#39;t actually use them. I.e. <code>With BaseWks &#47;&#47; Sheets(1).Select &#47;&#47; Cells(1,1.Select)</code>.  There&#39;s no need to select a worksheet when using that <code>With BaseWsk</code>, just do <code>.Cells(1,1)</code>.  ..but you then don&#39;t <i>use</i> that <code>.Select</code>, so why need it?"}, {"owner": {"reputation": 1, "user_id": 8831901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0ba15f3000e88033d9a8249aa6bd69?s=128&d=identicon&r=PG&f=1", "display_name": "LTav", "link": "https://stackoverflow.com/users/8831901/ltav"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1509011044, "post_id": 46934592, "comment_id": 80848957, "body": "@qharr - I tried this just in case (though I think it is essentially the same process as my code above?), and the same thing happens"}, {"owner": {"reputation": 1, "user_id": 8831901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0ba15f3000e88033d9a8249aa6bd69?s=128&d=identicon&r=PG&f=1", "display_name": "LTav", "link": "https://stackoverflow.com/users/8831901/ltav"}, "edited": false, "score": 0, "creation_date": 1509011107, "post_id": 46934592, "comment_id": 80849012, "body": "@jeeped I may be wrong but don&#39;t think I can do this as the number of sheets varies in each book?"}, {"owner": {"reputation": 1, "user_id": 8831901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0ba15f3000e88033d9a8249aa6bd69?s=128&d=identicon&r=PG&f=1", "display_name": "LTav", "link": "https://stackoverflow.com/users/8831901/ltav"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1509011465, "post_id": 46934592, "comment_id": 80849290, "body": "@brucewayne thanks - this was left over from a previous project."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1509023074, "post_id": 46934592, "comment_id": 80857308, "body": "Add the solution as an answer rather than editing it into the question."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 8831901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0ba15f3000e88033d9a8249aa6bd69?s=128&d=identicon&r=PG&f=1", "display_name": "LTav", "link": "https://stackoverflow.com/users/8831901/ltav"}, "is_accepted": true, "score": 0, "last_activity_date": 1509025997, "creation_date": 1509025997, "answer_id": 46956237, "question_id": 46934592, "link": "https://stackoverflow.com/questions/46934592/vba-nested-loop-not-working/46956237#46956237", "title": "VBA nested loop not working", "body": "<p>SOLUTION:</p>\n\n<p>Found the solution to my problem...</p>\n\n<p>Replacing the filename in my consolidator sheet before replacing the sheetname works for the first iteration but not thereafter, because as excel replaces the filename in each individual cell, it then looks for the sheetname that is already in the cell (and sometimes this address doesn't exist).</p>\n\n<p>I therefore changed my code to replace both the filename and sheetname at the same time, and this fixed the issue. Thanks everyone :) </p>\n\n<pre><code>Sub FileExtractor()\n'SET KEY VARIABLES\n\nDim MyPath As String, FilesInPath As String\nDim MyFiles() As String\nDim SourceRcount As Long, FNum As Long\nDim mybook As Workbook, BaseWks As Worksheet\nDim sourceRange As Range, destrange As Range\nDim rnum As Long, CalcMode As Long\nDim MyPathOutput As String\nDim StrLen1 As Integer\nDim StrLen2 As Integer\nDim ws As Worksheet\nDim bookname As String\nDim BaseName As String\n\n\n\ncalcsetting = Application.Calculation\nApplication.AskToUpdateLinks = False\n\n\n'DEFINE FILE LOCATIONS\nMyPath = ThisWorkbook.Path\nIf Right(MyPath, 1) &lt;&gt; \"\\\" Then\n    MyPath = MyPath &amp; \"\\Inputs\\\"\n    Else\n    MyPath = MyPath &amp; \"Inputs\\\"\nEnd If\n\n' Change this to the path\\folder location of your output file.\nMyPathOutput = ThisWorkbook.Path\nIf Right(MyPathOutput, 1) &lt;&gt; \"\\\" Then\n    MyPathOutput = MyPathOutput &amp; \"\\Outputs\\\"\n    Else\n    MyPath = MyPathOutput &amp; \"Outputs\\\"\nEnd If\n\n\n ' If there are Excel files in the outputs folder, exit.\nFilesInPath = Dir(MyPathOutput &amp; \"*.xl*\")\nIf FilesInPath &lt;&gt; \"\" Then\n    MsgBox \"There are already files in the output folder.\"\n    Exit Sub\nEnd If\n\n    ' If there are no Excel files in the responses folder, exit.\nFilesInPath = Dir(MyPath &amp; \"*.xl*\")\nIf FilesInPath = \"\" Then\n    MsgBox \"No files found in inputs folder.\"\n    Exit Sub\nEnd If\n\n' Fill the myFiles array with the list of Excel files\n' in the search folder.\nFNum = 0\nDo While FilesInPath &lt;&gt; \"\"\n    FNum = FNum + 1\n    ReDim Preserve MyFiles(1 To FNum)\n    MyFiles(FNum) = FilesInPath\n    FilesInPath = Dir()\nLoop\n\n' This sets various application properties. NB. Calculation mode is set to off, so all calculations must be forced\nWith Application\n    CalcMode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    .EnableEvents = False\n    .DisplayAlerts = False\nEnd With\n\n'define the name of the workbook that is running the macro\nSet masterwks = ThisWorkbook\n\n\n\n'BEGIN WORKING THROUGH FILES TO CONSOLIDATE INFO\n\n'set row number where data will start to be pasted\ncnum = 1\nrnum = 1\n\n' Loop through all files in the myFiles array.\nIf FNum &gt; 0 Then\n    For FNum = LBound(MyFiles) To UBound(MyFiles)\n        Set mybook = Nothing\n        On Error Resume Next\n        Set mybook = Workbooks.Open(MyPath &amp; MyFiles(FNum))\n            If Not mybook Is Nothing Then\n              On Error Resume Next\n\n              masterwks.Worksheets(\"Consolidator\").Activate\n\n                For Each ws In mybook.Worksheets\n\n                    If ws.Name &lt;&gt; \"Summary\" Then\n\n                        ws.Select\n\n                        'update consolidator with new input file name\n                        newname = \"[\" &amp; mybook.Name &amp; \"]\" &amp; ws.Name\n\n                        With masterwks.Worksheets(\"Consolidator\")\n                        Currentname = .Range(\"filename\")\n                        .Cells.Replace What:=Currentname, Replacement:= _\n                        newname, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n                        MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n                        End With\n\n                        Set sourceRange = masterwks.Sheets(\"consolidator\").Range(\"outputrange\")\n                        Calculate\n\n\n                        'CREATE OUTPUT FILE\n                        ' Add a new workbook with one sheet.\n                        Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n\n                        'PASTE FILE DATA\n                        ' Set the destination range to A\n                        Set destrange = BaseWks.Range(\"A\" &amp; rnum)\n                        sourceRange.Copy\n                        destrange.PasteSpecial Paste:=xlPasteValues, Transpose:=False\n                        destrange.PasteSpecial Paste:=xlPasteFormats, Transpose:=False\n                        BaseWks.Columns.AutoFit\n                        bookname = mybook.Name\n                        StrLen1 = Len(bookname)\n                        StrLen2 = StrLen1 - 5\n                        BaseName = Trim(Left(bookname, StrLen2))\n                        BaseWks.SaveAs Filename:=MyPathOutput &amp; \"\\\" &amp; BaseName &amp; \" - \" &amp; masterwks.Sheets(\"consolidator\").Range(\"sheetname\") &amp; \".xlsx\"\n                        ActiveWorkbook.Close\n\n                    End If\n\n                Next ws\n\n            End If\n\n        mybook.Close savechanges:=False\n\n    Next FNum\n\nEnd If\n\nApplication.Calculation = calcsetting\n\nExitTheSub:\n    ' Restore the application properties.\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n        .Calculation = CalcMode\n    End With\n\n    MsgBox \"Ta da!!\"\n\n\nApplication.Calculation = calcsetting\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8831901, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0ba15f3000e88033d9a8249aa6bd69?s=128&d=identicon&r=PG&f=1", "display_name": "LTav", "link": "https://stackoverflow.com/users/8831901/ltav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 46956237, "answer_count": 1, "score": 0, "last_activity_date": 1509025997, "creation_date": 1508940312, "last_edit_date": 1509025970, "question_id": 46934592, "link": "https://stackoverflow.com/questions/46934592/vba-nested-loop-not-working", "title": "VBA nested loop not working", "body": "<p>I have a group of files in a folder called 'inputs'. Each file contains several sheets laid out in exactly the same way, but containing different values. Each of these files also has a summary sheet listing all the sheet names in column A.</p>\n\n<p>I need to</p>\n\n<p>-open each file in turn\n-pull the values from each sheet into another book I have named 'consolidator' &amp; calculate the consolidator sheet based on these values.\n-then copy and paste the result into an output file and save it.\n-I need to do this for every sheet in the book, and then for every file in the folder.</p>\n\n<p>My code therefore contains a loop (to go through each sheet), within another loop (to go through each file).</p>\n\n<p>THE PROBLEM is that my code runs and generates the correct output, if the sheet names in the files are the same (even if the file names are different).</p>\n\n<p>However, if the sheet names in each file are different, on the second iteration of my 'file' loop, the code is interrupted with 'cannot find sheet name x in file name y (file name y in this instance has not changed from the first iteration).</p>\n\n<p>Thanks in advance if you are able to help! :)</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub FileExtractor()\n'SET KEY VARIABLES\n\nDim MyPath As String, FilesInPath As String\nDim MyFiles() As String\nDim SourceRcount As Long, FNum As Long\nDim mybook As Workbook, BaseWks As Worksheet\nDim sourceRange As Range, destrange As Range\nDim rnum As Long, CalcMode As Long\nDim MyPathOutput As String\nDim i As Long\nDim LastRow As Long\nDim rngi As Range\nDim strx As String\nDim StrLen1 As Integer\nDim StrLen2 As Integer\n\n\ncalcsetting = Application.Calculation\n\n\n'DEFINE FILE LOCATIONS\nMyPath = ThisWorkbook.Path\nIf Right(MyPath, 1) &lt;&gt; \"\\\" Then\n    MyPath = MyPath &amp; \"\\Inputs\\\"\n    Else\n    MyPath = MyPath &amp; \"Inputs\\\"\nEnd If\n\n' Change this to the path\\folder location of your output file.\nMyPathOutput = ThisWorkbook.Path\n\n' If there are no Excel files in the responses folder, exit.\nFilesInPath = Dir(MyPath &amp; \"*.xl*\")\nIf FilesInPath = \"\" Then\n    MsgBox \"No files found\"\n    Exit Sub\nEnd If\n\n' Fill the myFiles array with the list of Excel files\n' in the search folder.\nFNum = 0\nDo While FilesInPath &lt;&gt; \"\"\n    FNum = FNum + 1\n    ReDim Preserve MyFiles(1 To FNum)\n    MyFiles(FNum) = FilesInPath\n    FilesInPath = Dir()\nLoop\n\n' This sets various application properties. NB. Calculation mode is set to off, so all calculations must be forced\nWith Application\n    CalcMode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    .EnableEvents = False\n    .DisplayAlerts = False\nEnd With\n\n'define the name of the workbook that is running the macro\nSet masterwks = ThisWorkbook\n\n\n\n'BEGIN WORKING THROUGH FILES TO CONSOLIDATE INFO\n\n'set row number where data will start to be pasted\ncnum = 1\nrnum = 1\n\n' Loop through all files in the myFiles array.\nIf FNum &gt; 0 Then\n    For FNum = LBound(MyFiles) To UBound(MyFiles)\n        Set mybook = Nothing\n        On Error Resume Next\n        Set mybook = Workbooks.Open(MyPath &amp; MyFiles(FNum))\n\n        If Not mybook Is Nothing Then\n            On Error Resume Next\n\n            masterwks.Worksheets(\"Consolidator\").Activate\n\n            'update consolidator with new input file name\n            newname = \"[\" &amp; mybook.Name &amp; \"]\"\n\n            With masterwks.Worksheets(\"Consolidator\")\n            Currentname = .Range(\"filename\")\n            .Cells.Replace What:=Currentname, Replacement:= _\n            newname, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n            MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n            End With\n\n            LastRow = mybook.Sheets(\"summary\").Range(\"A:A\").Find(\"*\", searchdirection:=xlPrevious).Row\n\n\n            For i = 4 To LastRow\n\n\n                Set rngi = mybook.Sheets(\"summary\").Range(\"A\" &amp; i)\n\n                StrLen1 = Len(rngi.Value)\n                StrLen2 = StrLen1 - 1\n\n                strx = Trim(Left(rngi.Value, StrLen2))\n\n\n                newname2 = strx\n\n                With masterwks.Worksheets(\"Consolidator\")\n                Currentname2 = .Range(\"sheetname\")\n                .Cells.Replace What:=Currentname2, Replacement:= _\n                newname2, LookAt:=xlPart, SearchOrder:=xlByColumns, _\n                MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n                End With\n\n\n                Set sourceRange = masterwks.Sheets(\"consolidator\").Range(\"outputrange\")\n                Calculate\n\n\n                'CREATE OUTPUT FILE\n                ' Add a new workbook with one sheet.\n                Set BaseWks = Workbooks.Add(xlWBATWorksheet).Worksheets(1)\n                With BaseWks\n                    Sheets(1).Select\n                    Cells(1, 1).Select\n                End With\n\n\n                'PASTE FILE DATA\n                ' Set the destination range to A\n                Set destrange = BaseWks.Range(\"A\" &amp; rnum)\n                sourceRange.Copy\n                destrange.PasteSpecial Paste:=xlPasteValues, Transpose:=False\n                destrange.PasteSpecial Paste:=xlPasteFormats, Transpose:=False\n                BaseWks.Columns.AutoFit\n                BaseWks.SaveAs Filename:=MyPathOutput &amp; \"\\\" &amp; masterwks.Sheets(\"consolidator\").Range(\"sheetname\") &amp; \" - \" &amp; mybook.Name\n\n            Next i\n\n        End If\n\n        mybook.Close savechanges:=False\n\n    Next FNum\nEnd If\nApplication.Calculation = calcsetting\n\nExitTheSub:\n' Restore the application properties.\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n    .Calculation = CalcMode\nEnd With\n\n    MsgBox \"Ta da!!\"\n\n\nApplication.Calculation = calcsetting\nEnd Sub    \n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 755, "user_id": 2853225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/efa1441adac16a918aa918daa2847577?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/2853225/jake"}, "edited": false, "score": 0, "creation_date": 1508946775, "post_id": 46934397, "comment_id": 80821016, "body": "That didn&#39;t quite do it. Now ALL of the text is highlighted except for the @ signs. I&#39;m looking for:  dog = highlighted @dog = not highlighted everything else = not highlighted  Thank you!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "reply_to_user": {"reputation": 755, "user_id": 2853225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/efa1441adac16a918aa918daa2847577?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/2853225/jake"}, "edited": false, "score": 0, "creation_date": 1509010629, "post_id": 46934397, "comment_id": 80848654, "body": "<code>[!\\@]dog</code> highlights ` dog&#39; but not ` @dog` for me."}, {"owner": {"reputation": 755, "user_id": 2853225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/efa1441adac16a918aa918daa2847577?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/2853225/jake"}, "edited": false, "score": 1, "creation_date": 1509049831, "post_id": 46934397, "comment_id": 80874274, "body": "My method of generating the search string (not shown here) was adding either a NULL or a zero length string to the search, causing my issue. Your answer solved what I asked - thanks for the push to take another look!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1641172"}, "is_accepted": true, "score": 1, "last_activity_date": 1508943512, "last_edit_date": 1508943512, "creation_date": 1508939831, "answer_id": 46934397, "question_id": 46934295, "link": "https://stackoverflow.com/questions/46934295/word-vba-to-highlight-specific-text-but-not-similar/46934397#46934397", "title": "Word VBA to Highlight Specific Text (But Not Similar)", "body": "<p>You need to escape the <code>@</code> symbol, it's a special character. <code>[!\\@]</code> should do the job.</p>\n"}, {"tags": [], "owner": {"reputation": 755, "user_id": 2853225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/efa1441adac16a918aa918daa2847577?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/2853225/jake"}, "is_accepted": false, "score": 1, "last_activity_date": 1508948643, "creation_date": 1508948643, "answer_id": 46937517, "question_id": 46934295, "link": "https://stackoverflow.com/questions/46934295/word-vba-to-highlight-specific-text-but-not-similar/46937517#46937517", "title": "Word VBA to Highlight Specific Text (But Not Similar)", "body": "<p>After some trial and error, this got me what I needed:</p>\n\n<pre><code>.Text = \"[,. ]{1,}\" &amp; VBA.Split(strSearchTerms, strDelim)(dblLCV) &amp; \"&gt;\"\n</code></pre>\n\n<p>I replaced the @ criteria with what knew would be there, as I couldn't ever get the \"not @\" logic to work. Hope this helps someone else! </p>\n"}], "owner": {"reputation": 755, "user_id": 2853225, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/efa1441adac16a918aa918daa2847577?s=128&d=identicon&r=PG&f=1", "display_name": "Jake", "link": "https://stackoverflow.com/users/2853225/jake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 46934397, "answer_count": 2, "score": 2, "last_activity_date": 1508948643, "creation_date": 1508939587, "question_id": 46934295, "link": "https://stackoverflow.com/questions/46934295/word-vba-to-highlight-specific-text-but-not-similar", "title": "Word VBA to Highlight Specific Text (But Not Similar)", "body": "<p>First off, yes, I've seen the other posts regarding highlighting text in a Word document. This question is different because I'm looking to exclude a very similar text string from the results.</p>\n\n<p>So I have the script below that will highlight certain strings. The problem is that I'm searching code, and the convention that was used in creating variables was to use the string I'm searching for and prepend the @ sign to create the variable name. I only want instances that DO NOT have the @ sign at the beginning. For example, if I'm searching for dog, I want to highlight dog, or ,dog, but specifically exclude @dog. I've tried modifying the .Text criteria, but can't seem to get it quite right. Hopefully this is an easy answer for someone. Pertinent code is below; thanks in advance.</p>\n\n<pre><code>  Set rng = doc.Range\n  With rng.Find\n    .ClearFormatting\n    .Text = VBA.Split(strSearchTerms, strDelim)(dblLCV)\n    .Replacement.ClearFormatting\n    .Replacement.Highlight = True\n    .Replacement.Text = \"^&amp;\"\n    .Forward = True\n    .Wrap = wdFindContinue\n    .Format = True\n    .MatchCase = False\n    .MatchWholeWord = True\n    .MatchWildcards = True\n    .MatchSoundsLike = False\n    .MatchAllWordForms = False\n    .Execute Replace:=wdReplaceAll\n  End With\n</code></pre>\n\n<p>So far the closest result has been using </p>\n\n<pre><code>.Text = \"[!@]\" &amp; VBA.Split(strSearchTerms, strDelim)(dblLCV)\n</code></pre>\n\n<p>But that just highlighted everything except the @String.</p>\n"}, {"tags": ["string", "vba"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "edited": false, "score": 0, "creation_date": 1508943425, "post_id": 46935021, "comment_id": 80818584, "body": "i will give this a shot. so I would paste this code into its own module, and my existing could would call the public function LEVEN? is that how this works?"}, {"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "reply_to_user": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "edited": false, "score": 0, "creation_date": 1508943575, "post_id": 46935021, "comment_id": 80818670, "body": "exactly. This is not ready to use solution, but you should be able modify your code with this."}, {"owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "edited": false, "score": 0, "creation_date": 1508947703, "post_id": 46935021, "comment_id": 80821617, "body": "if I understand this correctly, the LEVEN function returns the number of character edits to make the 2 strings match. the 2 strings being the user input and the potential similar match on the data table. I could then set parameters to still return results if LEVEN is say &lt; 3. which means the strings are similar but you&#39;ll need to edit 3 characters to get the exact...also, thank you for your input. this is very helpful"}], "tags": [], "owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "is_accepted": false, "score": 0, "last_activity_date": 1508941544, "creation_date": 1508941544, "answer_id": 46935021, "question_id": 46934208, "link": "https://stackoverflow.com/questions/46934208/for-loop-to-return-exact-match-but-need-to-update-to-return-similar-match/46935021#46935021", "title": "for loop to return exact match but need to update to return similar match", "body": "<p>well, in my special Excel addin I have some special functions.</p>\n\n<pre><code>Public Function LEVEN(s1 As String, s2 As String) As Integer\n    If Len(s1) &gt; Len(s2) Then\n        LEVEN = Levenshtein(s1, s2)\n    Else\n        LEVEN = Levenshtein(s2, s1)\n    End If\n\nEnd Function\n\nPrivate Function Levenshtein(s1 As String, s2 As String) As Integer\n\nDim i As Integer\nDim j As Integer\nDim l1 As Integer\nDim l2 As Integer\nDim d() As Integer\nDim min1 As Integer\nDim min2 As Integer\n\nl1 = Len(s1)\nl2 = Len(s2)\nReDim d(l1, l2)\nFor i = 0 To l1\n    d(i, 0) = i\nNext\nFor j = 0 To l2\n    d(0, j) = j\nNext\nFor i = 1 To l1\n    For j = 1 To l2\n        If Mid(s1, i, 1) = Mid(s2, j, 1) Then\n            d(i, j) = d(i - 1, j - 1)\n        Else\n            min1 = d(i - 1, j) + 1\n            min2 = d(i, j - 1) + 1\n            If min2 &lt; min1 Then\n                min1 = min2\n            End If\n            min2 = d(i - 1, j - 1) + 1\n            If min2 &lt; min1 Then\n                min1 = min2\n            End If\n            d(i, j) = min1\n        End If\n    Next\nNext\nLevenshtein = d(l1, l2)\nEnd Function\n</code></pre>\n\n<p>The LEVEN is based on Levenshtein's algorythm that measure one many changes (deletions, replacement) must be done to convert one text to another. This function measures distance between two strings. So, you could add boolean variable like boolExact that would have turn TRUE if </p>\n\n<pre><code> If Worksheets(\"DashboardMain\").Cells(199 + i, 3).Value = Trimkey Then\n</code></pre>\n\n<p>is fulfilled. And then, set conditional instruction checking if not boolExact, if so, run subroutine that would check </p>\n\n<pre><code>if LEVEN( Worksheets(\"DashboardMain\").Cells(199 + i, 3).Value, TrimKey)&gt;3\n</code></pre>\n\n<p>this is straightforward solution. Note, that two letter words are maximally two steps from each other, so LEVEN will return 2. You could possibly find useful compare LEVEN(x,y)/max(LEN(x), LEN(y)) to measure relative distance. </p>\n"}], "owner": {"reputation": 51, "user_id": 8671544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/806c9327b94a8c442bed3251d2a87070?s=128&d=identicon&r=PG&f=1", "display_name": "dusty_j", "link": "https://stackoverflow.com/users/8671544/dusty-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521618521, "creation_date": 1508939315, "last_edit_date": 1521618521, "question_id": 46934208, "link": "https://stackoverflow.com/questions/46934208/for-loop-to-return-exact-match-but-need-to-update-to-return-similar-match", "title": "for loop to return exact match but need to update to return similar match", "body": "<p>i have existing code that works perfectly when taking user input in cell C3, searches the data table below it and displays all matching results for product codes neatly in the top few rows. I need to update this code to have some logic in the event it cannot find an exact match, but may have found a similar match. here is the existing code:</p>\n\n<pre><code>    Option Compare Text\n    Sub MultipleLkp()\n\n    Dim numRows As Integer, numCols As Integer, i As Integer, j As Integer, k As Integer, PrimKey, lastColumn As Long\n    Dim Trimkey As String\n\n\n    Application.ScreenUpdating = False\n    Worksheets(\"DashboardMain\").Range(\"D3:R8\").ClearContents\n    Worksheets(\"DashboardMain\").Range(\"C200\").CurrentRegion.Select\n    PrimKey = Worksheets(\"DashboardMain\").Range(\"C3\").Value\n    numRows = Selection.Rows.Count\n    numCols = Selection.Columns.Count\n    j = 2\n    lastColumn = Cells.Find(What:=\"*\", After:=Range(\"A1\"), Lookat:=xlPart, LookIn:=xlFormulas, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False).Column\n\n    'TrimKey is the variable replacing PrimKey but without spaces or hyphens.\n    'allows user to input a model with or without \" \" or \"-\" in cell C3\n    'can be modified to include more invalid characters\n    Trimkey = Replace(Replace(PrimKey, \" \", \"\"), \"-\", \"\")\n    If Trimkey = \"\" Then\n    Exit Sub\n    End If\n    'runs the loop and returns all matches; displays matches in rows 3 down until all matches found\n    'does not have any logic if no match is found. need to add the \"like\" function?\n    For i = 2 To numRows\n        If Worksheets(\"DashboardMain\").Cells(199 + i, 3).Value = Trimkey Then\n            j = j + 1\n            For k = 1 To lastColumn\n                Worksheets(\"DashboardMain\").Cells(j, 3 + k).Value = Worksheets(\"DashboardMain\").Cells(199 + i, 3 + k).Value\n            Next k\n        End If\n    Next I\nend sub\n</code></pre>\n\n<p>ideally, if no exact match is found, a message box would display that would show possible matches and then the user could select potential match, which would then display according in the same area as if it were an exact match. any help is appreciated</p>\n"}, {"tags": ["vba", "performance", "excel"], "comments": [{"owner": {"reputation": 11, "user_id": 8786599, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214469862598939/picture?type=large", "display_name": "Andrew Calton", "link": "https://stackoverflow.com/users/8786599/andrew-calton"}, "edited": false, "score": 0, "creation_date": 1508939740, "post_id": 46934151, "comment_id": 80815710, "body": "After opening the file fresh and new today it ran in about 45s without clicking the first time and the second time it took about 150s like I said previously."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1508940316, "post_id": 46934151, "comment_id": 80816245, "body": "Which worksheet&#39;s codesheet is this in?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1508940470, "post_id": 46934151, "comment_id": 80816391, "body": "I would recommend trying <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a> for code that does work, but needs optimized."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1508941810, "post_id": 46934151, "comment_id": 80817396, "body": "FYI I&#39;ve removed some illegal line breaks and pasted your code <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\"><b>here</b></a> (note, I own that website, and the open-source project it&#39;s for) to fix the indentation. Consider running static code analysis on it to reveal more issues before putting up the code for review."}], "answers": [{"comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1508942250, "post_id": 46934689, "comment_id": 80817721, "body": "Great answer, have an upvote. The only two things to add:  1. Working against in memory objects is a lot faster then working against the sheet or workbook (so asker should research that I guess.) and 2. Placing <code>DoEvents</code> and allow for &quot;more responsiveness&quot; will increase the risk of unexpected output from your macro - fine to do it, but apply defensive coding principles in that scenario."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1508942555, "post_id": 46934689, "comment_id": 80817943, "body": "@RikSportel Thanks! Given OP&#39;s code contains a ton of implicit <code>ActiveSheet</code> references and repeatedly dereferences the same worksheet over and over every time that worksheet is needed, ..I intentionally left out the more advanced concepts for CR answerers, assuming OP would put up their code on CR if they wanted to make their code efficient in any way. <code>DoEvents</code> is only dangerous with OP&#39;s code because of implicit <code>ActiveSheet</code> and <code>ActiveWorkbook</code> references sprinkled everywhere, but that&#39;s already explained in the answer."}, {"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1508950694, "post_id": 46934689, "comment_id": 80823270, "body": "@Mat&#39;sMug +1 for a detailed answer. Nice. :)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1508940605, "creation_date": 1508940605, "answer_id": 46934689, "question_id": 46934151, "link": "https://stackoverflow.com/questions/46934151/excel-goes-into-a-not-responding-mode-when-i-run-my-vba-code-is-this-ok-is-t/46934689#46934689", "title": "Excel goes into a &quot;not responding&quot; mode when i run my vba code. Is this ok? is there a way to eliminate this?", "body": "<p>Yes, this is normal.</p>\n\n<p>Excel and VBA are single-threaded, meaning only one instruction can ever be executed at any given time. This means when Excel is busy executing inefficient VBA code, it can't respond to application events such as the user clicking somewhere or activating another worksheet.</p>\n\n<p>You can add <code>DoEvents</code> calls in strategic places in your code to give Excel a chance do execute handlers for other events; your code will resume at the next instruction and Excel will appear more responsive.</p>\n\n<p><strong>However</strong> it will also make your code execute slower, since <code>DoEvents</code> essentially allows <em>other code</em> to run - and while that other code is running, <em>your</em> code is essentially put on hold.</p>\n\n<p><strong>Moreover</strong>, allowing Excel to respond to user actions can have disastrous consequences on code that's written against <code>ActiveSheet</code> (implicitly or explicitly) - because you don't <em>know</em> whether the <code>ActiveSheet</code> will be the same before vs. after <code>DoEvents</code> returns.</p>\n\n<p>Toggling <code>Application.ScreenUpdating</code>, <code>Application.EnableEvents</code> and <code>Application.Calculation</code> off, contrary to the popular belief, <strong>does not speed up <em>your</em> code</strong>. It merely cuts whatever <em>other code</em> can execute in response to your actions.</p>\n\n<p>For example whenever you write into a cell, Excel evaluates whether that cell had dependant cells, and then recalculates these cells: turning off automatic calculation prevents that. Excel also fires a <code>Worksheet.Change</code> event on that modified worksheet, and a <code>Workbook.WorksheetChange</code> event on that workbook - if there's VBA code handling these events, it will be invoked. Turning off <code>EnableEvents</code> prevents that. Excel also repaints its UI every time: turning off <code>ScreenUpdating</code> prevents that. The net result is that your code indeed completes faster, but it's not any more efficient than it was before.</p>\n\n<p>Changing your code to be more efficient would be <em>too broad</em> for this site. Present your code to reviewers on <a href=\"https://codereview.stackexchange.com\">Code Review Stack Exchange</a> for that.</p>\n"}], "owner": {"reputation": 11, "user_id": 8786599, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214469862598939/picture?type=large", "display_name": "Andrew Calton", "link": "https://stackoverflow.com/users/8786599/andrew-calton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6902, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1508941718, "creation_date": 1508939177, "last_edit_date": 1508941718, "question_id": 46934151, "link": "https://stackoverflow.com/questions/46934151/excel-goes-into-a-not-responding-mode-when-i-run-my-vba-code-is-this-ok-is-t", "title": "Excel goes into a &quot;not responding&quot; mode when i run my vba code. Is this ok? is there a way to eliminate this?", "body": "<p>When I click the button to run my code I get the blue loading circle and if I wait about 150s my code will run, sometimes going into \"not responding\" mode, and everything is outputted correctly. But if I click the button to start my code and wait 10s and then click the window and force it into \"not responding\" mode my code will finish with all the correct output in about 30s.</p>\n\n<pre><code>Option Explicit\nOption Base 1\nPrivate Sub CommandButton1_Click()\n    Dim loadtypemax As Single, column As Single, row As Single\n    Dim loadtype As String, number As String\n    Dim loadcombosmax As Single\n\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    loadtypemax = ((Cells(Rows.count, \"L\").End(xlUp).row))\n    loadcombosmax = ((Cells(Rows.count, \"E\").End(xlUp).row))\n\n    column = 6\n    For row = 2 To loadcombosmax\n        If Cells(row, column) &gt; 0 Then\n            number = Cells(row, column)\n            loadtype = Cells(row, (column - 2))\n\n            If number = \"\" Then\n            ElseIf number &gt; 0 Then\n                ActiveWorkbook.Worksheets(\"STAADloadtypes\").Cells(number, 1) = \"Load\"\n                ActiveWorkbook.Worksheets(\"STAADloadtypes\").Cells(number, 2) =\n                ActiveWorkbook.Worksheets(\"Load Cases\").Cells(row, column).Value\n                ActiveWorkbook.Worksheets(\"STAADloadtypes\").Cells(number, 4) = \"Title\"\n                ActiveWorkbook.Worksheets(\"STAADloadtypes\").Cells(number, 5) =\n                ActiveWorkbook.Worksheets(\"Load Cases\").Cells(row, column - 4).Value\n            End If\n\n        ElseIf Cells(row, column) = \"\" Then\n        End If\n\n        If Cells(row, column) &gt; 0 Then\n            Call LRFD(loadtype, number, loadcombosmax)\n        End If\n\n    Next row\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n\nSub LRFD(loadtype As String, number As String, loadcombosmax As Single)\n    Dim countrow As Single, countcolumn As Single, row As Single, column As Single\n\n\n    Application.Calculation = xlCalculationManual\n    Worksheets(\"STAADloadcombos\").Activate\n\n    countrow = ActiveWorkbook.Worksheets(\"LRFD\").Cells(Rows.count,\n    \"A\").End(xlUp).row\n    countcolumn = (loadcombosmax - 1) * 2\n\n    For row = 1 To countrow\n        For column = 4 To countcolumn Step 2\n            If loadtype = ActiveWorkbook.Worksheets(\"LRFD\").Cells(row, column).Value\n            Then\n            Call STAADloadcombos(column, number, countrow, countcolumn, row)\n        End If\n    Next column\nNext row\n\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n\nSub STAADloadcombos(column As Single, number As String, countrow As Single, countcolumn As Single, row As Single)\n    Dim r As Integer, rowrow As Single, c As Integer\n    Dim rr As Single\n\n    Application.Calculation = xlCalculationManual\n\n    r = row * 2\n    rowrow = r - 1\n\n    ActiveWorkbook.Worksheets(\"STAADloadcombos\").Cells(rowrow, 3) =\n    ActiveWorkbook.Worksheets(\"LRFD\").Cells(row, 1).Value\n    ActiveWorkbook.Worksheets(\"STAADloadcombos\").Cells(rowrow, 2) =\n    ActiveWorkbook.Worksheets(\"LRFD\").Cells(row, 2).Value\n    ActiveWorkbook.Worksheets(\"STAADloadcombos\").Cells(rowrow, 1) = \"Load Comb\"\n\n    For c = 1 To countcolumn Step 2\n        If ActiveWorkbook.Worksheets(\"STAADloadcombos\").Cells(r, c) = \"\" Then\n            ActiveWorkbook.Worksheets(\"STAADloadcombos\").Cells(r, c) = number\n            c = countcolumn\n        End If\n    Next c\n\n    For c = 2 To countcolumn Step 2\n        If ActiveWorkbook.Worksheets(\"STAADloadcombos\").Cells(r, c) = \"\" Then\n            ActiveWorkbook.Worksheets(\"STAADloadcombos\").Cells(r, c) =\n            ActiveWorkbook.Worksheets(\"LRFD\").Cells(row, column - 1).Value\n            c = countcolumn\n        End If\n    Next c\n\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n\nPrivate Sub CommandButton2_Click()\n\n    Worksheets(\"STAADloadcombos\").Range(\"A1:BA500\").ClearContents\n    Worksheets(\"STAADloadtypes\").Range(\"A1:BA500\").ClearContents\n\nEnd Sub\n</code></pre>\n\n<p>Are there any ways I can clean up my code to make it run faster? I read about the screenupdating and calculation application commands and put them in but they didn't seem to spend anything up. Did I put them in correctly?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 7375720, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/38b255508c386fa074ce6afc0c660e82?s=128&d=identicon&r=PG&f=1", "display_name": "Grampiano", "link": "https://stackoverflow.com/users/7375720/grampiano"}, "edited": false, "score": 0, "creation_date": 1508940490, "post_id": 46934235, "comment_id": 80816409, "body": "Thanks Erik i didnt put it on the Form_Open i put the code in the Form_Load event. Thanks so much really appreciate it"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 0, "last_activity_date": 1508939400, "creation_date": 1508939400, "answer_id": 46934235, "question_id": 46934016, "link": "https://stackoverflow.com/questions/46934016/how-to-select-a-subform-record-and-display-in-a-popup-mainform/46934235#46934235", "title": "How to select a subform record and display in a popup mainform", "body": "<p>This section of code: </p>\n\n<pre><code> Dim rst As DAO.Recordset\n\n  If Len(Me.OpenArgs &amp; \"\") &gt; 0 Then\n  Set rst = Me.RecordsetClone\n\n  With rst\n  .FindFirst \"ID = \" &amp; Me.OpenArgs\n  If Not .EOF Then Me.Bookmark = .Bookmark\n\n  End With\n  End If\n</code></pre>\n\n<p>Should all be in the <code>Form_Open</code> event of the <code>Inventory Details</code> form. Change that to make it work.</p>\n"}], "owner": {"reputation": 45, "user_id": 7375720, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/38b255508c386fa074ce6afc0c660e82?s=128&d=identicon&r=PG&f=1", "display_name": "Grampiano", "link": "https://stackoverflow.com/users/7375720/grampiano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 46934235, "answer_count": 1, "score": 0, "last_activity_date": 1508939400, "creation_date": 1508938854, "last_edit_date": 1508939240, "question_id": 46934016, "link": "https://stackoverflow.com/questions/46934016/how-to-select-a-subform-record-and-display-in-a-popup-mainform", "title": "How to select a subform record and display in a popup mainform", "body": "<p>When you select a ID field then the subform record must display in a mainform like when you select the subform record you must be able to edit that specific record in a popup mainform. This is a project and im been struggling it to get it to work</p>\n\n<p>My popup mainform is Inventory Details and primary is ID\nMy subform name is Customerssubform and foreign key is ID</p>\n\n<p>I was able to open the form but it goes to a new record it must go to a specific record according your selection</p>\n\n<p>My Code</p>\n\n<pre><code>Private Sub ID_DblClick(Cancel As Integer)\n\n DoCmd.OpenForm FormName:=\"Inventory Details\", OpenArgs:=Me.ID\n Dim rst As DAO.Recordset\n\n  If Len(Me.OpenArgs &amp; \"\") &gt; 0 Then\n  Set rst = Me.RecordsetClone\n\n  With rst\n  .FindFirst \"ID = \" &amp; Me.OpenArgs\n  If Not .EOF Then Me.Bookmark = .Bookmark\n\n  End With\n  End If\n  End Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 4816757, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ab5dca59532a451aca3bae0ee684187?s=128&d=identicon&r=PG&f=1", "display_name": "ac1243", "link": "https://stackoverflow.com/users/4816757/ac1243"}, "edited": false, "score": 0, "creation_date": 1508952571, "post_id": 46934201, "comment_id": 80824351, "body": "I am getting a syntax error on the second line. When I try to add the code it says: &quot;Expected list separator or )&quot; and highlights the colon after the &quot;what&quot;"}, {"owner": {"reputation": 21, "user_id": 8729285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/156d4664a8af0bd2761f079fe9e810f4?s=128&d=identicon&r=PG&f=1", "display_name": "alphatrader", "link": "https://stackoverflow.com/users/8729285/alphatrader"}, "reply_to_user": {"reputation": 27, "user_id": 4816757, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ab5dca59532a451aca3bae0ee684187?s=128&d=identicon&r=PG&f=1", "display_name": "ac1243", "link": "https://stackoverflow.com/users/4816757/ac1243"}, "edited": false, "score": 0, "creation_date": 1508954569, "post_id": 46934201, "comment_id": 80825478, "body": "There should have been an = after the :  My bad"}], "tags": [], "owner": {"reputation": 21, "user_id": 8729285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/156d4664a8af0bd2761f079fe9e810f4?s=128&d=identicon&r=PG&f=1", "display_name": "alphatrader", "link": "https://stackoverflow.com/users/8729285/alphatrader"}, "is_accepted": false, "score": 0, "last_activity_date": 1508954548, "last_edit_date": 1508954548, "creation_date": 1508939288, "answer_id": 46934201, "question_id": 46934008, "link": "https://stackoverflow.com/questions/46934008/vba-sort-rows-into-different-worksheets-based-on-array-of-strings/46934201#46934201", "title": "VBA Sort Rows into Different Worksheets Based on Array of Strings", "body": "<pre><code>Dim strsearchlocation as integer    \nstrSearchLocation = Sheet1.Cells.Find(what:= strSearch, After:=[A1], SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).row    \nSheet1.Rows(strSearchLocation).Copy\n</code></pre>\n\n<p>Finds and copies the row of strSearch</p>\n"}, {"comments": [{"owner": {"reputation": 237, "user_id": 8829910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4ef2ebd1ecc006741c6fa9c6bf5bb98?s=128&d=identicon&r=PG&f=1", "display_name": "stefan", "link": "https://stackoverflow.com/users/8829910/stefan"}, "edited": false, "score": 0, "creation_date": 1508940410, "post_id": 46934565, "comment_id": 80816335, "body": "Hint: I set the (Name) - Property of the tables to &quot;ws1&quot; and &quot;ws2&quot;"}, {"owner": {"reputation": 27, "user_id": 4816757, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ab5dca59532a451aca3bae0ee684187?s=128&d=identicon&r=PG&f=1", "display_name": "ac1243", "link": "https://stackoverflow.com/users/4816757/ac1243"}, "edited": false, "score": 0, "creation_date": 1509376890, "post_id": 46934565, "comment_id": 80984102, "body": "Is it possible to copy the row to start at column C instead of column A on ws2?"}, {"owner": {"reputation": 237, "user_id": 8829910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4ef2ebd1ecc006741c6fa9c6bf5bb98?s=128&d=identicon&r=PG&f=1", "display_name": "stefan", "link": "https://stackoverflow.com/users/8829910/stefan"}, "reply_to_user": {"reputation": 27, "user_id": 4816757, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ab5dca59532a451aca3bae0ee684187?s=128&d=identicon&r=PG&f=1", "display_name": "ac1243", "link": "https://stackoverflow.com/users/4816757/ac1243"}, "edited": false, "score": 0, "creation_date": 1509449323, "post_id": 46934565, "comment_id": 81014674, "body": "As far is I know not. To accomplish that you have to work with ranges. Define the first and the last column of the range in that row where you copy from. Define it also where you want to copy to. If the range is the same size than you can copy it."}], "tags": [], "owner": {"reputation": 237, "user_id": 8829910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4ef2ebd1ecc006741c6fa9c6bf5bb98?s=128&d=identicon&r=PG&f=1", "display_name": "stefan", "link": "https://stackoverflow.com/users/8829910/stefan"}, "is_accepted": true, "score": 0, "last_activity_date": 1508940248, "creation_date": 1508940248, "answer_id": 46934565, "question_id": 46934008, "link": "https://stackoverflow.com/questions/46934008/vba-sort-rows-into-different-worksheets-based-on-array-of-strings/46934565#46934565", "title": "VBA Sort Rows into Different Worksheets Based on Array of Strings", "body": "<p>You could iterate through the lines and the array:</p>\n\n<pre><code>Option Explicit\n\nDim firstRowWs1 As Long\nDim lastRowWs1 As Long\nDim lastRowWs2 As Long\nDim searchColumnWs1 As Integer\nDim i As Integer\nDim check As Variant\nDim strSearch As Variant\n\nSub test()\n    lastRowWs1 = ws1.UsedRange.Rows.Count\n    lastRowWs2 = ws2.UsedRange.Rows.Count\n    firstRowWs1 = 2\n    searchColumnWs1 = 1\n    strSearch = Array(\"John\", \"Jim\")\n\n    For i = firstRowWs1 To lastRowWs1\n        For Each check In strSearch\n            If check = ws1.Cells(i, searchColumnWs1).Value Then\n                ws1.Rows(i).Copy (ws2.Rows(lastRowWs2 + 1))\n                lastRowWs2 = lastRowWs2 + 1\n                ws1.Rows(i).Delete shift:=xlUp\n                i = i - 1\n                Exit For\n            End If\n        Next check\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 4816757, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ab5dca59532a451aca3bae0ee684187?s=128&d=identicon&r=PG&f=1", "display_name": "ac1243", "link": "https://stackoverflow.com/users/4816757/ac1243"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 46934565, "answer_count": 2, "score": 0, "last_activity_date": 1508954548, "creation_date": 1508938840, "last_edit_date": 1531164843, "question_id": 46934008, "link": "https://stackoverflow.com/questions/46934008/vba-sort-rows-into-different-worksheets-based-on-array-of-strings", "title": "VBA Sort Rows into Different Worksheets Based on Array of Strings", "body": "<p>Beginner VBA scripter here. How can I fix my code so that it will search thru Sheet1 for the string array in strSearch and copy those rows into Sheet2? </p>\n\n<p>Also, how can I extend the code to be able to search for a different string array and copy it into another worksheet?</p>\n\n<pre><code>    Dim ws1 As Worksheet, ws2 As Worksheet\n    Dim copyFrom As Range\n    Dim lRow As Long\n    Dim lastRow As Long\n    Dim strSearch As Variant\n    Dim i As Integer\n\n    Set ws1 = Worksheets(\"Sheet1\")\n\n    With ws1\n      .AutoFilterMode = False\n      lRow = .Range(\"J\" &amp; .Rows.Count).End(xlUp).Row\n      With .Range(\"J1:J\" &amp; lRow)\n      On Error Resume Next\n      strSearch = Array(\"John\",\"Jim\")\n      .AutoFilter Field:=1, Criteria1:=strSearch\n      Set copyFrom = .Offset(0).SpecialCells(xlCellTypeVisible).EntireRow\n      On Error GoTo 0\n   End With\n\n   Set ws2 = Worksheets(\"Sheet2\")\n   With ws2\n      On Error Resume Next\n      lastRow = ws2.Cells.Find(\"*\", SearchOrder:=xlByRows, LookIn:=xlValues, SearchDirection:=xlPrevious).Row\n      Set Rng = copyFrom.SpecialCells(xlCellTypeConstants)\n      Rng.Copy .Cells(lastRow + 1, \"C\")\n      copyFrom.Delete\n      On Error GoTo 0\n   End With\n   .AutoFilterMode = False\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1508944685, "post_id": 46933839, "comment_id": 80819480, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/46931687/retrieving-min-value-from-website-via-vba\">Retrieving min. value from website via VBA</a>"}], "owner": {"reputation": 11, "user_id": 8831267, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155784940095912/picture?type=large", "display_name": "Merlyn Koh", "link": "https://stackoverflow.com/users/8831267/merlyn-koh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1508938355, "creation_date": 1508938355, "question_id": 46933839, "link": "https://stackoverflow.com/questions/46933839/how-to-extract-min-value-from-source-code-using-vba", "title": "How to extract min. value from source code using VBA?", "body": "<p>I very recently started learning VBA and is facing some difficulties in scraping data. I would like to retrieve the daily minimum flight price from Singapore to Bangkok via Expedia.</p>\n\n<p>My current code is only able to retrieve the first line of code referencing to \"formattedTotalPrice\" in the website source code, which might not be the minimum price, and all words flanking prices are identical. Would be really grateful if someone could help a newbie out!</p>\n\n<pre><code>Sub GetPrices()\n\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"Sheet1\")\n\nDim pth As String\npth = \"https://www.expedia.com.sg/Flights-Search?rfrr=TG.LP.SrchWzd.Flight&amp;langid=2057&amp;trip=OneWay&amp;leg1=from:Singapore,%20Singapore%20(SIN-Changi),to:Bangkok,%20Thailand%20(BKK-Suvarnabhumi%20Intl.),departure:\" &amp; DateAdd(\"d\", 1, Date) &amp; \"TANYT&amp;passengers=children:0,adults:1,seniors:0,infantinlap:Y&amp;options=cabinclass:economy,sortby:price,carrier:&amp;mode=search&amp;paandi=true\"\n\n\nDim lastRow As Integer\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nSet XMLHTTP = CreateObject(\"MSXML2.serverXMLHTTP\")\nXMLHTTP.Open \"GET\", pth, False\nXMLHTTP.setRequestHeader \"Content-Type\", \"text/xml\"\nXMLHTTP.send\nbuf = XMLHTTP.ResponseText\n\nLocn_price = InStr(1, buf, \"formattedTotalPrice\\\")\nLocn_end = InStr(Locn_price, buf, \"totalPriceAsDecimal\\\")\ntrim_price = Mid(buf, Locn_price + 27, Locn_end - 32 - Locn_price)\n\nws.Cells(lastRow + 1, 1).Value = Date\nws.Cells(lastRow + 1, 2).Value = trim_price\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "combobox", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8831563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f843061144511a199fe14bf59b4913c?s=128&d=identicon&r=PG&f=1", "display_name": "Gehrkmania", "link": "https://stackoverflow.com/users/8831563/gehrkmania"}, "edited": false, "score": 0, "creation_date": 1509370061, "post_id": 46944789, "comment_id": 80979104, "body": "Hi Variatus!  Thank you very much for this.  I&#39;m a newbie at best with VBA, so please forgive any weird coding and dumb questions.  These are actually in a Word document rather than a userform.  What would need to be changed to make this work in a Word doc?"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 1, "user_id": 8831563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f843061144511a199fe14bf59b4913c?s=128&d=identicon&r=PG&f=1", "display_name": "Gehrkmania", "link": "https://stackoverflow.com/users/8831563/gehrkmania"}, "edited": false, "score": 0, "creation_date": 1509418892, "post_id": 46944789, "comment_id": 81001525, "body": "What happens when you try to run my code? Please quote error message and the line of code which gets highlighted when you press Debug on the error message dialog box?"}, {"owner": {"reputation": 1, "user_id": 8831563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f843061144511a199fe14bf59b4913c?s=128&d=identicon&r=PG&f=1", "display_name": "Gehrkmania", "link": "https://stackoverflow.com/users/8831563/gehrkmania"}, "edited": false, "score": 0, "creation_date": 1509539905, "post_id": 46944789, "comment_id": 81056892, "body": "When I try to step through that code, I get:  &quot;Compile error: Sub or Function not defined.&quot;  The line of code highlighted is:  &quot; Set Ctl = Controls(Cn)&quot;"}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 1, "user_id": 8831563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f843061144511a199fe14bf59b4913c?s=128&d=identicon&r=PG&f=1", "display_name": "Gehrkmania", "link": "https://stackoverflow.com/users/8831563/gehrkmania"}, "edited": false, "score": 0, "creation_date": 1509674985, "post_id": 46944789, "comment_id": 81124535, "body": "Try <code>Dim Ctl As Shape</code> and <code>Set Ctl = ActiveDocument.Shapes(Cn)</code>. Can you tell me how you create the ComboBoxes. I&#39;m groping in the dark because I can&#39;t reconstruct your ComboBoxes in a document I create here."}, {"owner": {"reputation": 1, "user_id": 8831563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f843061144511a199fe14bf59b4913c?s=128&d=identicon&r=PG&f=1", "display_name": "Gehrkmania", "link": "https://stackoverflow.com/users/8831563/gehrkmania"}, "edited": false, "score": 0, "creation_date": 1510241664, "post_id": 46944789, "comment_id": 81360221, "body": "OK - those new lines of code seem to help a little.  When i step through, it is identifying &quot;Cn&quot; as &quot;ComboBox1&quot; - but when i get to the &quot;Set Ctl&quot; piece, it&#39;s saying that &quot;Ctl = Nothing&quot;, so doesn&#39;t &quot;see&quot; that ComboBox1 is really there.  If it helps, I&#39;m using the Office 365 version of Word.  To create the ComboBoxes, i just used the Developer tab in Design mode and inserted ActiveX Combo Boxes."}, {"owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "reply_to_user": {"reputation": 1, "user_id": 8831563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f843061144511a199fe14bf59b4913c?s=128&d=identicon&r=PG&f=1", "display_name": "Gehrkmania", "link": "https://stackoverflow.com/users/8831563/gehrkmania"}, "edited": false, "score": 0, "creation_date": 1510286859, "post_id": 46944789, "comment_id": 81380431, "body": "I was able to recreate your environment and replaced the code in my answer with a version that should work for you without much modification."}, {"owner": {"reputation": 1, "user_id": 8831563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f843061144511a199fe14bf59b4913c?s=128&d=identicon&r=PG&f=1", "display_name": "Gehrkmania", "link": "https://stackoverflow.com/users/8831563/gehrkmania"}, "edited": false, "score": 0, "creation_date": 1510602723, "post_id": 46944789, "comment_id": 81495762, "body": "Hi Variatus - ok, using the new code, here&#39;s what happens when I step through it:  When I get to the &quot;If Not ShapeExists(Cn) Then&quot; line, it goes straight to the Private Function section.  When it gets to the &quot;If StrComp(Shp.OLEFormat.Object.Name, CN, vbTextCompare) = 0 Then&quot; line, I get an error (Run-time error &#39;01&#39;: Object variable or With block variable not set)."}], "tags": [], "owner": {"reputation": 12986, "user_id": 7675437, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0f05857cc0c275e98e0a460a454b5dfc?s=128&d=identicon&r=PG&f=1", "display_name": "Variatus", "link": "https://stackoverflow.com/users/7675437/variatus"}, "is_accepted": false, "score": 0, "last_activity_date": 1510286774, "last_edit_date": 1510286774, "creation_date": 1508983866, "answer_id": 46944789, "question_id": 46933760, "link": "https://stackoverflow.com/questions/46933760/vba-if-combobox-exists-then/46944789#46944789", "title": "VBA if combobox exists then", "body": "<p>The code below was written in Word 2010. I believe, however, that it will run smoothly on Word 365 as well. It should be pasted into the <code>ThisDocument</code> module of your VBA project.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Document_Open()\n    ' 10 Nov 2017\n\n    Dim Cn As String                            ' control name\n    Dim i As Integer\n    Dim MissingControl As Boolean\n    Dim Msg As String\n\n    For i = 1 To 2\n        Cn = \"ComboBox\" &amp; i\n        If Not ShapeExists(Cn) Then\n            MissingControl = True\n            Exit For\n        End If\n    Next i\n\n    If MissingControl Then\n        MsgBox Cn &amp; \" doesn't exist\", _\n               vbInformation, \"Corrupted document\"\n        Exit Sub\n    Else\n        With ActiveDocument\n            With .ComboBox2\n                .List = Array(\"Choose One\", \"SSN\", \"Employee ID\")\n                If .ListIndex &lt; 0 Then .ListIndex = 0\n            End With\n        End With\n    End If\nEnd Sub\n\nPrivate Sub ComboBox2_Change()\n    ' 10 Nov 2017\n\n    Dim Msg As String\n\n    Msg = IIf(ComboBox2.ListIndex = 2, _\n              \"Employee ID must be unique by employee and \" &amp; _\n              \"all numeric with a max of 9 digits.\", \"\")\n    TextBox3.Value = Msg\nEnd Sub\n\nPrivate Function ShapeExists(Cn As String) As Boolean\n    ' 10 Nov 2017\n\n    Dim Shp As InlineShape\n    Dim i As Integer\n\n    For Each Shp In ActiveDocument.InlineShapes\n        If StrComp(Shp.OLEFormat.Object.Name, Cn, vbTextCompare) = 0 Then\n            ShapeExists = True\n            Exit For\n        End If\n    Next Shp\nEnd Function\n</code></pre>\n\n<p>Observe that the <code>ComboBox2_Change</code> event will occur when the list for ComboBox2 is set. However, the ListIndex will be 0, and this will cause TextBox3 to be cleaned. The message text will appear when you change the value of ComboBox2.</p>\n"}], "owner": {"reputation": 1, "user_id": 8831563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f843061144511a199fe14bf59b4913c?s=128&d=identicon&r=PG&f=1", "display_name": "Gehrkmania", "link": "https://stackoverflow.com/users/8831563/gehrkmania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1534, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1510286774, "creation_date": 1508938108, "last_edit_date": 1508956884, "question_id": 46933760, "link": "https://stackoverflow.com/questions/46933760/vba-if-combobox-exists-then", "title": "VBA if combobox exists then", "body": "<p>I modified a Word document, adding 4 ComboBoxes, each with some dropdown choices.  It works fine, except when a user deletes a section of the document that contains one of the ComboBoxes.  If they do that, when they re-open the doc, they get \"Compile error: Method or data member not found\"</p>\n\n<p>Is there a way I can add code that will check to see if the ComboBox exists on opening the document and either perform the code or ignore it?  I've tried using \"On Error Resume Next\" to no avail.</p>\n\n<p>Here is a snippet of the code:</p>\n\n<pre><code>Private Sub Document_Open()\nOn Error Resume Next\n\n    ComboBox2.List = Array(\"Choose One\", \"SSN\", \"Employee ID\")\n        If Me.ComboBox2.Value &lt;&gt; \"SSN\" And Me.ComboBox2.Value &lt;&gt; \"Employee ID\" Then\n            Me.ComboBox2.Text = Me.ComboBox2.List(0)\n        End If\n        If ComboBox2.Value = \"Choose One\" Then\n            TextBox3.Value = \"\"\n        ElseIf ComboBox2.Value = \"SSN\" Then\n            TextBox3.Value = \"\"\n        ElseIf ComboBox2.Value = \"Employee ID\" Then\n            TextBox3.Value = \"Employee ID must be unique by employee and \" &amp; _\n                             \"all numeric with a max of 9 digits.\"\n        End If\nError = 0\n\nEnd Sub\n</code></pre>\n\n<p>If the user removes ComboBox2, then re-opens the doc - it bombs out and gets that error.  </p>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 8831663, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tya4HAyE8d4/AAAAAAAAAAI/AAAAAAAAAI0/olZGIuFPGMM/photo.jpg?sz=128", "display_name": "Khasrul Chowdhury", "link": "https://stackoverflow.com/users/8831663/khasrul-chowdhury"}, "edited": false, "score": 0, "creation_date": 1509009898, "post_id": 46933633, "comment_id": 80848175, "body": "Edited to include full code for the project. If anyone has some spare time, please feel free to test it. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8831663, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tya4HAyE8d4/AAAAAAAAAAI/AAAAAAAAAI0/olZGIuFPGMM/photo.jpg?sz=128", "display_name": "Khasrul Chowdhury", "link": "https://stackoverflow.com/users/8831663/khasrul-chowdhury"}, "edited": false, "score": 0, "creation_date": 1508998798, "post_id": 46936270, "comment_id": 80841269, "body": "Hello itsLex! Thank you for your quick response. It seems you are right about modules and class modules being compiled first and because of it when I tried your suggestion to put the public object declaration on a worksheet, it just proceeded on to marking the first line of the sub declaration in the class module with the same error. Any other suggestions?"}, {"owner": {"reputation": 766, "user_id": 8803849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/919f7018350489feffd3d0766f6ebbbb?s=128&d=identicon&r=PG&f=1", "display_name": "itsLex", "link": "https://stackoverflow.com/users/8803849/itslex"}, "reply_to_user": {"reputation": 13, "user_id": 8831663, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tya4HAyE8d4/AAAAAAAAAAI/AAAAAAAAAI0/olZGIuFPGMM/photo.jpg?sz=128", "display_name": "Khasrul Chowdhury", "link": "https://stackoverflow.com/users/8831663/khasrul-chowdhury"}, "edited": false, "score": 0, "creation_date": 1509011909, "post_id": 46936270, "comment_id": 80849582, "body": "If you insist on using the Word / Outlook items in a class, maybe you can define the entire class within one dedicated (very hidden) worksheet, for this purpose? Might work if you use only one instance."}, {"owner": {"reputation": 13, "user_id": 8831663, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tya4HAyE8d4/AAAAAAAAAAI/AAAAAAAAAI0/olZGIuFPGMM/photo.jpg?sz=128", "display_name": "Khasrul Chowdhury", "link": "https://stackoverflow.com/users/8831663/khasrul-chowdhury"}, "edited": false, "score": 0, "creation_date": 1509017397, "post_id": 46936270, "comment_id": 80853222, "body": "Do you mean get rid of the wdappclass module completely? I apologise, I am afraid I am still getting my head around the handling of Classes and Class Modules. Would you mind elaborating a little bit more, maybe with an example or pseudo code etc. please?  Thank you!"}, {"owner": {"reputation": 766, "user_id": 8803849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/919f7018350489feffd3d0766f6ebbbb?s=128&d=identicon&r=PG&f=1", "display_name": "itsLex", "link": "https://stackoverflow.com/users/8803849/itslex"}, "reply_to_user": {"reputation": 13, "user_id": 8831663, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tya4HAyE8d4/AAAAAAAAAAI/AAAAAAAAAI0/olZGIuFPGMM/photo.jpg?sz=128", "display_name": "Khasrul Chowdhury", "link": "https://stackoverflow.com/users/8831663/khasrul-chowdhury"}, "edited": false, "score": 0, "creation_date": 1509096635, "post_id": 46936270, "comment_id": 80890981, "body": "Yes, get rid of both Module and Classmodule. But most of all, get rid of <code>Sub AutoOpen()</code>. That would require rewriting how your application works, I know. By keeping your code in a Worksheet, you can make calls like <code>Set Sheet9.wdApp = Word.Application</code>. Good luck."}, {"owner": {"reputation": 13, "user_id": 8831663, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tya4HAyE8d4/AAAAAAAAAAI/AAAAAAAAAI0/olZGIuFPGMM/photo.jpg?sz=128", "display_name": "Khasrul Chowdhury", "link": "https://stackoverflow.com/users/8831663/khasrul-chowdhury"}, "edited": false, "score": 0, "creation_date": 1509381958, "post_id": 46936270, "comment_id": 80987265, "body": "itsLex thank you so much for your solution. Your ingenious idea of hiding the classmodule code in a worksheet worked a charm! Although I did remove both the module and classmodule, I had to reinstate the module as I needed some public variables and subs for it to work properly. I also learned from this exercise that worksheets and even the workbook itself cannot &#39;see&#39; each others code even when public declarations are made. Thank you again!"}], "tags": [], "owner": {"reputation": 766, "user_id": 8803849, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/919f7018350489feffd3d0766f6ebbbb?s=128&d=identicon&r=PG&f=1", "display_name": "itsLex", "link": "https://stackoverflow.com/users/8803849/itslex"}, "is_accepted": true, "score": 0, "last_activity_date": 1508944908, "creation_date": 1508944908, "answer_id": 46936270, "question_id": 46933633, "link": "https://stackoverflow.com/questions/46933633/compile-error-user-defined-type-not-defined-error-shown-after-adding-word-obj/46936270#46936270", "title": "&#39;Compile Error: User-defined type not defined&#39; error shown after adding word object library through code", "body": "<p>It seems like Modules and Class Modules are compiled first when the Workbook is opened. Try using <code>Public WithEvents wdApp As Word.Application</code> within a Worksheet so it gets compiled after Workbook_Open. </p>\n"}], "owner": {"reputation": 13, "user_id": 8831663, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tya4HAyE8d4/AAAAAAAAAAI/AAAAAAAAAI0/olZGIuFPGMM/photo.jpg?sz=128", "display_name": "Khasrul Chowdhury", "link": "https://stackoverflow.com/users/8831663/khasrul-chowdhury"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 46936270, "answer_count": 1, "score": 1, "last_activity_date": 1509009645, "creation_date": 1508937771, "last_edit_date": 1531164843, "question_id": 46933633, "link": "https://stackoverflow.com/questions/46933633/compile-error-user-defined-type-not-defined-error-shown-after-adding-word-obj", "title": "&#39;Compile Error: User-defined type not defined&#39; error shown after adding word object library through code", "body": "<p>I am a newbie at VBA programming and this is my first post on a forum so I would like to apologise beforehand in case i make any mistakes.</p>\n\n<p>I am automating an Excel workbook which opens and works with a new Word file from a template. I am using 'WithEvents' to track application events in Word. I am also using code to remove word object library references when closing the workbook and then adding them again at 'Workbook_Open' to make sure this workbook will work on other machines with different versions of word.</p>\n\n<p>Everything works as expected except for a 'Compile Error: User-defined type not defined' error every time I open the workbook but consequent compilations work fine without a hitch. I know what is causing it - there is no reference to word object library during the first compile trial hence the compiler does not know what 'Word.Application' is but from the second instance onwards it does and hence produces no errors.</p>\n\n<p>I just cannot ge my head around how to fix this. I have looked into LateBinding but from research I found out WithEvents is not compatible with LateBinding. Any help will be greatly appreciated.</p>\n\n<p>Thank you in advance for your time.</p>\n\n<pre><code>'ThisWorkbook'\n'------------'\n\nOption Explicit\n\nPrivate Sub Workbook_Open()\n\n    ThisWorkbook.VBProject.References.AddFromGuid GUID:=\"{00020905-0000-0000-C000-000000000046}\", Major:=0, Minor:=0\n    ThisWorkbook.VBProject.References.AddFromGuid GUID:=\"{00062FFF-0000-0000-C000-000000000046}\", Major:=0, Minor:=0\n\nEnd Sub\n\nPrivate Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    If IsEmpty(ThisWorkbook.VBProject.References.Item(\"Word\")) = False Then\n        ThisWorkbook.VBProject.References.Remove ThisWorkbook.VBProject.References.Item(\"Word\")\n    End If\n\n    If IsEmpty(ThisWorkbook.VBProject.References.Item(\"Outlook\")) = False Then\n        ThisWorkbook.VBProject.References.Remove ThisWorkbook.VBProject.References.Item(\"Outlook\")\n    End If\n\n    ActiveWorkbook.Save\n\n    Set wdAppClass = Nothing\n    Set wdAppClass.wdApp = Nothing\n    'Set wdApp = Nothing\n    Set wdDoc = Nothing\n    Set button = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>-</p>\n\n<pre><code>'Module1'\n'-------'\n\nOption Explicit\n\nPublic wdAppClass As New wdAppClass\nPublic wdDoc As Word.Document\nPublic button As Object\nPublic row As Integer\nPublic column As Integer\n\nPublic Sub AutoOpen()\n\n    Set wdAppClass.wdApp = Word.Application\n\nEnd Sub\n\nSub Button_Click()\n\n    Set wdAppClass.wdApp = Word.Application\n    Set button = ActiveSheet.Buttons(Application.Caller)\n\n    With button.TopLeftCell\n        row = .row\n        column = .column\n    End With\n\n    Set wdAppClass.wdApp = CreateObject(\"Word.Application\")\n    Set wdDoc = wdAppClass.wdApp.Documents.Add(ThisWorkbook.Path &amp; \"\\Sales Call Report.dotm\")\n\n    With wdDoc\n\n        .Fields(3).Code.Text = \" Quote \" &amp; \"\"\"\" &amp; ActiveSheet.Range(\"A\" &amp; row &amp; \"\").Text &amp; \"\"\"\" &amp; \" \"\n        .Fields(4).Code.Text = \" Quote \" &amp; \"\"\"\" &amp; ActiveSheet.Range(\"B\" &amp; row &amp; \"\").Text &amp; \"\"\"\" &amp; \" \"\n        .Fields(5).Code.Text = \" Quote \" &amp; \"\"\"\" &amp; ActiveSheet.Range(\"C\" &amp; row &amp; \"\").Text &amp; \"\"\"\" &amp; \" \"\n        .Fields(6).Code.Text = \" Quote \" &amp; \"\"\"\" &amp; ActiveSheet.Range(\"D\" &amp; row &amp; \"\").Text &amp; \"\"\"\" &amp; \" \"\n        .Fields(7).Code.Text = \" Quote \" &amp; \"\"\"\" &amp; ActiveSheet.Range(\"E\" &amp; row &amp; \"\").Text &amp; \"\"\"\" &amp; \" \"\n        .Fields(8).Code.Text = \" Quote \" &amp; \"\"\"\" &amp; ActiveSheet.Range(\"H\" &amp; row &amp; \"\").Text &amp; \"\"\"\" &amp; \" \"\n        .Fields(9).Code.Text = \" Quote \" &amp; \"\"\"\" &amp; ActiveSheet.Range(\"J\" &amp; row &amp; \"\").Text &amp; \"\"\"\" &amp; \" \"\n\n        .Shapes(1).TextFrame.TextRange.Text = ActiveSheet.Range(\"F\" &amp; row &amp; \"\").Text\n        .Shapes(2).TextFrame.TextRange.Text = ActiveSheet.Range(\"K\" &amp; row &amp; \"\").Text\n        '.Shapes(3).TextFrame.TextRange.Text = ActiveSheet.Range(\"M\" &amp; row &amp; \"\").Text\n\n    End With\n\n    wdAppClass.wdApp.Selection.WholeStory\n    wdAppClass.wdApp.Selection.Fields.Update\n    wdAppClass.wdApp.Selection.Collapse\n\n    wdAppClass.wdApp.Visible = True\n    wdAppClass.wdApp.ActiveWindow.WindowState = wdWindowStateMaximize\n    wdAppClass.wdApp.ActiveWindow.SetFocus\n    wdAppClass.wdApp.Activate\n\nEnd Sub\n\nSub Set_Reminder()\n\n    Dim olApp As Outlook.Application\n    Dim olAppt As Outlook.AppointmentItem\n\n    If button Is Nothing Then\n        Set button = ActiveSheet.Buttons(Application.Caller)\n    End If\n\n    With button.TopLeftCell\n        row = .row\n        column = .column\n    End With\n\n    On Error Resume Next\n\n    Set olApp = GetObject(\"\", \"Outlook.Application\")\n    On Error GoTo 0\n    If olApp Is Nothing Then\n        On Error Resume Next\n        Set olApp = CreateObject(\"Outlook.Application\")\n        On Error GoTo 0\n        If olApp Is Nothing Then\n            MsgBox \"Outlook is not available!\"\n            Exit Sub\n        End If\n    End If\n\n    Set olAppt = olApp.CreateItem(olAppointmentItem)\n\n    With olAppt\n        .Start = ThisWorkbook.ActiveSheet.Range(\"M\" &amp; row &amp; \"\").Value &amp; Chr(32) &amp; Time()\n        .Duration = 15\n        .Subject = \"Call \" &amp; ThisWorkbook.ActiveSheet.Range(\"D\" &amp; row &amp; \"\").Value\n        .Location = ThisWorkbook.ActiveSheet.Range(\"A\" &amp; row &amp; \"\").Value &amp; Chr(44) &amp; Chr(32) &amp; ThisWorkbook.ActiveSheet.Range(\"C\" &amp; row &amp; \"\").Value\n        .Save\n        .Display\n    End With\n\n    Set olApp = Nothing\n    Set olAppt = Nothing\n    Set button = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>-</p>\n\n<pre><code>'wdAppClass'\n'----------'\n\nOption Explicit\n\nPublic WithEvents wdApp As Word.Application\n\nPrivate Sub wdApp_DocumentBeforeClose(ByVal Doc As Document, Cancel As Boolean)\n\n    Dim datecheck As Boolean\n\n    ThisWorkbook.ActiveSheet.Range(\"F\" &amp; row &amp; \"\").Value = wdDoc.Shapes(1).TextFrame.TextRange.Text\n    ThisWorkbook.ActiveSheet.Range(\"K\" &amp; row &amp; \"\").Value = wdDoc.Shapes(2).TextFrame.TextRange.Text\n\n    datecheck = IsDate(wdDoc.Shapes(3).TextFrame.TextRange.Text)\n\n    If datecheck = True Then\n        ThisWorkbook.ActiveSheet.Range(\"M\" &amp; row &amp; \"\").Value = wdDoc.Shapes(3).TextFrame.TextRange.Text\n        Set_Reminder\n    End If\n\n    wdAppClass.wdApp.Quit\n    wdApp.Quit\n    wdDoc.Close\n\n    Set wdAppClass = Nothing\n    Set wdAppClass.wdApp = Nothing\n    Set wdApp = Nothing\n    Set wdDoc = Nothing\n    Set button = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1508936617, "post_id": 46933185, "comment_id": 80813346, "body": "What exactly you are trying to do? Convert a String to Integer? Why you don&#39;t declare your variable as <code>Integer</code> instead as <code>String</code>?"}, {"owner": {"reputation": 405, "user_id": 7384011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BY2FF.jpg?s=128&g=1", "display_name": "Pio", "link": "https://stackoverflow.com/users/7384011/pio"}, "edited": false, "score": 0, "creation_date": 1508936798, "post_id": 46933185, "comment_id": 80813483, "body": "@David G. because i read it in from a xml node attribute, it returns me a string, but i need this to be a single"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 2, "creation_date": 1508936817, "post_id": 46933185, "comment_id": 80813491, "body": "Could this be a regional settings issue? What does <code>CSng(&quot;9,0647&quot;)</code> return? Some regions use <code>,</code> for the decimal separator"}], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 7384011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BY2FF.jpg?s=128&g=1", "display_name": "Pio", "link": "https://stackoverflow.com/users/7384011/pio"}, "edited": false, "score": 0, "creation_date": 1508937230, "post_id": 46933316, "comment_id": 80813772, "body": "well it was the opposite case, but this gave me the right direction, thanks"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 405, "user_id": 7384011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BY2FF.jpg?s=128&g=1", "display_name": "Pio", "link": "https://stackoverflow.com/users/7384011/pio"}, "edited": false, "score": 0, "creation_date": 1508937268, "post_id": 46933316, "comment_id": 80813808, "body": "@Pio - you mean that the function is opposite or the explanation?"}, {"owner": {"reputation": 405, "user_id": 7384011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BY2FF.jpg?s=128&g=1", "display_name": "Pio", "link": "https://stackoverflow.com/users/7384011/pio"}, "edited": false, "score": 1, "creation_date": 1508937326, "post_id": 46933316, "comment_id": 80813851, "body": "the replace function, i needed to do <code>Replace(x_coord_string, &quot;.&quot;, &quot;,&quot;)</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 405, "user_id": 7384011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BY2FF.jpg?s=128&g=1", "display_name": "Pio", "link": "https://stackoverflow.com/users/7384011/pio"}, "edited": false, "score": 0, "creation_date": 1508937437, "post_id": 46933316, "comment_id": 80813930, "body": "@pio - true, fixed."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 3, "last_activity_date": 1508937419, "last_edit_date": 1508937419, "creation_date": 1508936875, "answer_id": 46933316, "question_id": 46933185, "link": "https://stackoverflow.com/questions/46933185/vba-csngstring-wrong-format/46933316#46933316", "title": "VBA CSng(string) wrong format", "body": "<p>Try like this:</p>\n\n<pre><code>Public Function fnStrChangeCommas(ByVal myValue As Variant) As String\n    fnStrChangeCommas = Replace(CStr(myValue), \".\", \",\")\nEnd Function\n\nx_coord_single = CSng(fnStrChangeCommas(x_coord_string ))\n</code></pre>\n\n<p>It should work, because your language regional settings use <code>,</code> as a decimal separator and the VBEditor uses the <code>.</code>.</p>\n\n<hr>\n\n<p>To see the separators your system is using in VBA, run the following code:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Debug.Print \"Decimal separator: \"; Application.DecimalSeparator\n    Debug.Print \"Thousands separator: \"; Application.ThousandsSeparator\n\nEnd Sub\n</code></pre>\n\n<p>If it returns this:</p>\n\n<pre><code>Decimal separator: ,\nThousands separator: .\n</code></pre>\n\n<p>Then you may consider using the <code>fnStrChangeCommas</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1508939921, "creation_date": 1508939921, "answer_id": 46934438, "question_id": 46933185, "link": "https://stackoverflow.com/questions/46933185/vba-csngstring-wrong-format/46934438#46934438", "title": "VBA CSng(string) wrong format", "body": "<p>The simple and universal method is to use <em>Val</em>:</p>\n\n<pre><code>x_coord_single = CSng(Val(x_coord_string))\n</code></pre>\n"}], "owner": {"reputation": 405, "user_id": 7384011, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/BY2FF.jpg?s=128&g=1", "display_name": "Pio", "link": "https://stackoverflow.com/users/7384011/pio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "accepted_answer_id": 46933316, "answer_count": 2, "score": 2, "last_activity_date": 1508939921, "creation_date": 1508936453, "question_id": 46933185, "link": "https://stackoverflow.com/questions/46933185/vba-csngstring-wrong-format", "title": "VBA CSng(string) wrong format", "body": "<p>I read in a node from a xml file and try to parse one of its attributes to a single.   </p>\n\n<pre><code>Dim x_coord_single As Single\nDim x_coord_string As String\nx_coord_string = node.Attributes.getNamedItem(\"x_coord\").Text\nx_coord_single = CSng(x_coord_string )\n</code></pre>\n\n<p>After i assign <code>x_coord_string</code> it equals <code>\"9.0647\"</code><br>\nBut the <code>CSng</code> function returns <code>90647</code></p>\n\n<p>I would expect <code>x_coord_single</code> to be <code>9.0647</code>.  </p>\n\n<p>I tried <code>CSng(\"9.0647\")</code> directly but it's the same outcome.  </p>\n\n<p>Any suggestions on why it is not?<br>\nI'm working with MS Access 2010 if it affects this anyhow.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1508936940, "post_id": 46932962, "comment_id": 80813575, "body": "Debug your code to see if <code>vbproj.filename</code> returns a value to work with. <code>Debug.Print vbproj.filename</code>"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1508937013, "post_id": 46932962, "comment_id": 80813627, "body": "it doesn&#39;t return anything and that is one of the cause of the error but why?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1508937390, "post_id": 46932962, "comment_id": 80813890, "body": "Then there is no object In Application.VBE.VBProjects. So you can add an Error Handler it there is no object, then set <code>flag = True</code>"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1508937932, "post_id": 46932962, "comment_id": 80814307, "body": "I&#39;m just curious as to why there would be no vbproject when open after opening a blank workbook compared to opening it by itself."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1508938195, "post_id": 46932962, "comment_id": 80814504, "body": "Try using <code>vbproj.name</code> instead of <code>vbproj.filename</code>"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1508938336, "post_id": 46932962, "comment_id": 80814610, "body": "I think it have to do something with also me activating the tab on open from UI Ribbon editor."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1508938485, "post_id": 46932962, "comment_id": 80814716, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/157479/discussion-between-david-g-and-pokemon-man\">continue this discussion in chat</a>."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1508938493, "post_id": 46932962, "comment_id": 80814719, "body": "vbproj.name only gives (if any) &quot;VBProject&quot; as return."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1508943623, "post_id": 46932962, "comment_id": 80818694, "body": "<a href=\"https://stackoverflow.com/questions/287077/iterating-unregistered-add-ins-xla\" title=\"iterating unregistered add ins xla\">stackoverflow.com/questions/287077/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1508942766, "post_id": 46935305, "comment_id": 80818094, "body": "the addin in technically not installed, it should be just opened when the workbook opens, therefore if you run the above code, it doesn&#39;t find it."}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1508943242, "post_id": 46935305, "comment_id": 80818461, "body": "I&#39;m getting object doesnt&#39; support method or property"}, {"owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1508943510, "post_id": 46935305, "comment_id": 80818637, "body": "oh darn, yes i forgot i was testing on 2007, i will check on 2016"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "reply_to_user": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "edited": false, "score": 0, "creation_date": 1508943600, "post_id": 46935305, "comment_id": 80818684, "body": "@pokemon_Man the pre 2010 version would be similar to yours, but with <code>On Error Resume Next</code> to ignore the error you get, but Office 2007 is not supported by Microsoft anymore <a href=\"https://support.microsoft.com/en-us/help/3198497/office-2007-approaching-end-of-extended-support\" rel=\"nofollow noreferrer\">support.microsoft.com/en-us/help/3198497/&hellip;</a>"}], "tags": [], "owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "is_accepted": true, "score": 0, "last_activity_date": 1508944164, "last_edit_date": 1508944164, "creation_date": 1508942317, "answer_id": 46935305, "question_id": 46932962, "link": "https://stackoverflow.com/questions/46932962/getting-error-looking-for-add-in-on-workbook-open/46935305#46935305", "title": "Getting error looking for add in on workbook open", "body": "<p>The <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/application-addins2-property-excel\" rel=\"nofollow noreferrer\"><code>Application.AddIns2</code></a> collection can be used in Office 2010 and later:</p>\n\n<pre><code>Dim isInstalled As Boolean, a As AddIn\n\nFor Each a In Application.AddIns2                              ' not sure if .IsOpen should be checked \n    If a.Name = \"AddIn.xlam\" Then isInstalled = a.Installed And a.IsOpen: Exit For \nNext\n\nIf Not isInstalled Then Workbooks.Open(\"AddIn.xlam\", , True).IsAddin = True\n</code></pre>\n\n<p>AFAIK, .xla(m) files are always open with <code>.IsAddin = True</code>, so I think that's needed only for .xlsb format add-ins.</p>\n"}], "owner": {"reputation": 878, "user_id": 7321366, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/8168d183e450bbb72f0c3341c847af5c?s=128&d=identicon&r=PG&f=1", "display_name": "pokemon_Man", "link": "https://stackoverflow.com/users/7321366/pokemon-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 46935305, "answer_count": 1, "score": 0, "last_activity_date": 1508944164, "creation_date": 1508935839, "last_edit_date": 1508936515, "question_id": 46932962, "link": "https://stackoverflow.com/questions/46932962/getting-error-looking-for-add-in-on-workbook-open", "title": "Getting error looking for add in on workbook open", "body": "<p>I have a workbook that when open will scan for a specific addin, if it's already opened, it will not reopen it, but if it isn't, it will open it. First it will scan the application.vbe.vbprojects for the unregistered addin. If i open the workbook by itself it works fine, if i have a blank workbook open first then i open the workbook that will open the addin, i get a error:</p>\n\n<pre><code>Private Sub Workbook_Open()\nDim vbproj As Object\nDim theName As String\nDim flag as Boolean\n\nFor Each vbproj In Application.VBE.VBProjects\n    theName = GetFilenameFromPath(vbproj.filename) &lt;&lt;--- Run-time error '76'\" Path not found\n    If theName = \"AddIn.xlam\" Then\n        Flag = True\n        Exit For\n    End If\nNext vbproj\n\n    If Flag = False Then\n    Workbooks.Open (\"C:\\AddIn.xlam\"), , True\n    Workbooks(\"AddIn.xlam\").IsAddin = True\n    End If\n\nEnd Sub\n\nFunction GetFilenameFromPath(ByVal strPath As String) As String    \n        If Right$(strPath, 1) &lt;&gt; \"\\\" And Len(strPath) &gt; 0 Then\n            GetFilenameFromPath = GetFilenameFromPath(Left$(strPath, Len(strPath) - 1)) + Right$(strPath, 1)\n        End If\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1508934758, "post_id": 46932438, "comment_id": 80811910, "body": "I think for starters you should add a sheet reference as when you add a new sheet it becomes the active sheet and the code will refer to that by default."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "edited": false, "score": 0, "creation_date": 1508935444, "post_id": 46932438, "comment_id": 80812414, "body": "Which version of Excel are you using? I experienced this kind of issues using Excel 2010."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1508937840, "post_id": 46932438, "comment_id": 80814236, "body": "FYI: <code>.SpecialCells(xlCellTypeVisible)</code> is not needed. <code>.Copy</code> will only copy visible rows."}], "answers": [{"comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 0, "creation_date": 1508935389, "post_id": 46932559, "comment_id": 80812366, "body": "This isn&#39;t an answer, and shouldn&#39;t be posted as one. If you have additional information to add, edit your question instead and add it there. This space is for one specific use, which is clearly indicated by the bold label above it that says <b>Your Answer</b>. SO isn&#39;t a chatroom or discussion group or forum."}], "tags": [], "owner": {"reputation": 51, "user_id": 6157810, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/5da4b41d44d1393d3522e63c7689136c?s=128&d=identicon&r=PG&f=1", "display_name": "TwoHeartedKale", "link": "https://stackoverflow.com/users/6157810/twoheartedkale"}, "is_accepted": false, "score": 0, "last_activity_date": 1508934778, "creation_date": 1508934778, "answer_id": 46932559, "question_id": 46932438, "link": "https://stackoverflow.com/questions/46932438/vba-copy-paste-loop-not-executing-correctly/46932559#46932559", "title": "VBA Copy Paste Loop Not Executing Correctly", "body": "<p>So - it's resolved itself after I closed all Excel sheets and re-opened. But now I'm curious if anybody knows why this might have happened at all? Is there an issue where the code truncates itself if Excel is low on memory?</p>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1508936057, "last_edit_date": 1508936057, "creation_date": 1508934965, "answer_id": 46932620, "question_id": 46932438, "link": "https://stackoverflow.com/questions/46932438/vba-copy-paste-loop-not-executing-correctly/46932620#46932620", "title": "VBA Copy Paste Loop Not Executing Correctly", "body": "<p>You are relying in your code on <code>ActiveSheet</code>, all of your objects, such as <code>Set rng = Range(\"A1:CN\" &amp; LR)</code>, and <code>Range(\"U1:U\" &amp; LR).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=.Range(\"CO1\"), Unique:=True</code> are not qualified with a worksheet.  </p>\n\n<p>You need to add a <code>With Worksheets(\"Sheet1\")</code> statement at the beginning of your code, then qualify all the nested objects with a <code>.</code>, and it should work fine.  </p>\n\n<p><strong>Code</strong>            </p>\n\n<pre><code>With Worksheets(\"Shee1\") ' &lt;-- you need this line,  modify to your sheet's name\n\n    LR = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n    Set rng = .Range(\"A1:CN\" &amp; LR)\n\n    .Range(\"U1:U\" &amp; LR).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=.Range(\"CO1\"), Unique:=True\n\n    For Each c In .Range(Range(\"CO2\"), .Cells(.Rows.Count, \"CO\").End(xlUp))\n        With rng\n            .AutoFilter\n            .AutoFilter Field:=21, Criteria1:=c.Value\n            .SpecialCells(xlCellTypeVisible).Copy\n            Sheets.Add(After:=Sheets(Sheets.Count)).Name = c.Value\n            ActiveSheet.Paste\n        End With\n    Next c\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6157810, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/5da4b41d44d1393d3522e63c7689136c?s=128&d=identicon&r=PG&f=1", "display_name": "TwoHeartedKale", "link": "https://stackoverflow.com/users/6157810/twoheartedkale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1508936057, "creation_date": 1508934434, "question_id": 46932438, "link": "https://stackoverflow.com/questions/46932438/vba-copy-paste-loop-not-executing-correctly", "title": "VBA Copy Paste Loop Not Executing Correctly", "body": "<p>I've had a piece of code for a VBA copy-paste loop that I've used for a year and half without any issues that is suddenly not executing correctly. The intent is to take a specific column with a few unique values, and copy paste those filters into new sheets that take the name of unique values. Now there suddenly appears to be a problem with the filtering part of this - when I run the macro it executes without any errors, but completely fails to actually copy and paste anything or create any new sheets. The one thing that DOES happen is copying the unique values into the CO column, but the subsequent loop isn't working right for some reason.</p>\n\n<p>As far as I can tell there have been no inadvertent changes in my code or in the formatting of the reports that I run this with (daily, dynamic ranges) so I'm really stumped on what could possibly be different all of the sudden. </p>\n\n<p>Specifically, the range of values to be copied is A1:CN with a dynamic number of rows and the column with the unique values to be filtered is U. Any ideas why it might not be working?</p>\n\n<pre><code>Dim rng as Range\nDim c As Range\nDim LR As Long\n\n    LR = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Set rng = Range(\"A1:CN\" &amp; LR)\n\n    Range(\"U1:U\" &amp; LR).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Range(\"CO1\"), Unique:=True\n\n    For Each c In Range([CO2], Cells(Rows.Count, \"CO\").End(xlUp))\n        With rng\n            .AutoFilter\n            .AutoFilter Field:=21, Criteria1:=c.Value\n            .SpecialCells(xlCellTypeVisible).Copy\n            Sheets.Add(After:=Sheets(Sheets.Count)).Name = c.Value\n            ActiveSheet.Paste\n        End With\n    Next c\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010", "office-2010"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1508933544, "post_id": 46932069, "comment_id": 80810996, "body": "Please share your code attempt, and point us to the line you are receiving this error."}, {"owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1508934257, "post_id": 46932069, "comment_id": 80811535, "body": "Dim appName as String  appName = Range(&quot;AppName&quot;).Value  &#39;this is a name stored in my excel spreadsheet for the mainframe app  AppActivate (appName)   =&gt; this line is giving runtime error &#39;5&#39; invalid procedure call or argument"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1508936352, "post_id": 46932069, "comment_id": 80813141, "body": "Instead of placing code in your comments, you may <a href=\"https://stackoverflow.com/posts/46932069/edit\">edit your original question</a> to make it much easier to read."}, {"owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "edited": false, "score": 0, "creation_date": 1508937972, "post_id": 46932069, "comment_id": 80814340, "body": "Thanks just added the code"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1509258806, "post_id": 46932069, "comment_id": 80941489, "body": "@RShome have you tested any of the answers you got ? any feedback?"}], "answers": [{"comments": [{"owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "edited": false, "score": 0, "creation_date": 1508934167, "post_id": 46932197, "comment_id": 80811489, "body": "Thanks all, sorry maybe I didn&#39;t make myself clear. I actually need to open the mainframe application so it can accept inputs from my excel spreadsheet."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 1, "last_activity_date": 1508933767, "creation_date": 1508933767, "answer_id": 46932197, "question_id": 46932069, "link": "https://stackoverflow.com/questions/46932069/appactivate-works-in-excel-2007-but-not-in-2010/46932197#46932197", "title": "AppActivate works in Excel 2007 but not in 2010", "body": "<p>I found this code, hope it helps:</p>\n\n<pre><code>Dim Myself as string\nMyself = activewindow.caption\n</code></pre>\n\n<p>Then AppActivate(Myself) would take focus back to the original spreadsheet.</p>\n\n<p>After the \"upgrade\", however, the AppActivate line started giving me errors, and I finally figured out that if I only had a single open spreadsheet, the title in the Windows Task Bar was just \"Microsoft Excel\".</p>\n\n<p>I made a temporary fix by changing to </p>\n\n<pre><code>Myself = \"Microsoft Excel - \" &amp; activewindow.caption\n</code></pre>\n\n<blockquote>\n  <p><a href=\"https://www.mrexcel.com/forum/excel-questions/566273-appactivate-excel-2010-a.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/566273-appactivate-excel-2010-a.html</a></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 2, "last_activity_date": 1508934039, "creation_date": 1508934039, "answer_id": 46932297, "question_id": 46932069, "link": "https://stackoverflow.com/questions/46932069/appactivate-works-in-excel-2007-but-not-in-2010/46932297#46932297", "title": "AppActivate works in Excel 2007 but not in 2010", "body": "<p>If you want to return the focus back to the Excel where your VBC code lies, aka <code>ThisWorkbook</code> object, then you can use the following line:</p>\n\n<pre><code>AppActivate Title:=ThisWorkbook.Application.Caption\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "edited": false, "score": 0, "creation_date": 1508938033, "post_id": 46933208, "comment_id": 80814389, "body": "I&#39;ll try this code thanks very much.  My existing code does work with Excel 2007, just not in 2010, so in 2007 it is obviously matching the application title"}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 0, "last_activity_date": 1508936527, "creation_date": 1508936527, "answer_id": 46933208, "question_id": 46932069, "link": "https://stackoverflow.com/questions/46932069/appactivate-works-in-excel-2007-but-not-in-2010/46933208#46933208", "title": "AppActivate works in Excel 2007 but not in 2010", "body": "<p>This error comes when the AppActivate doesn't get exact title. You can try below code and see if it helps you.</p>\n\n<pre><code>    Public Sub AppActTest()\n    Dim objWd As Object\n    Dim objTsk As Object\n    Dim blOpenedByCode As Boolean\n\n    On Error Resume Next\n    Set objWd = GetObject(, \"Word.Application\")\n    If objWd Is Nothing Then\n        Set objWd = CreateObject(\"Word.Application\")\n        blOpenedByCode = True\n    End If\n    On Error GoTo 0\n\n    For Each objTsk In objWd.Tasks\n        If InStr(objTsk.Name, \"MainframeApplicationName\") &gt; 0 Then\n            objTsk.Activate\n            objTsk.WindowState = wdWindowStateMaximize\n            Exit For\n        End If\n    Next\n\n    If blOpenedByCode Then objWd.Quit\n\n    Set objTsk = Nothing\n    Set objWd = Nothing\n\n    End Sub\n</code></pre>\n\n<p>It will require Microsoft Word to be installed on your computer. It will work with partial match.</p>\n"}, {"tags": [], "owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "is_accepted": true, "score": 0, "last_activity_date": 1509357958, "creation_date": 1509357958, "answer_id": 47012600, "question_id": 46932069, "link": "https://stackoverflow.com/questions/46932069/appactivate-works-in-excel-2007-but-not-in-2010/47012600#47012600", "title": "AppActivate works in Excel 2007 but not in 2010", "body": "<p>Thanks for the answers, I only found out later that my users were launching the Excel 2016 version from a remote location, so the application they were trying to open could obviously not be found. \nThe previous version of Excel was launched from their desktop so it worked.</p>\n\n<p>In a nutshell, the AppActivate function works fine for both Excel version.</p>\n\n<p>Thanks for your time.</p>\n\n<p>Regards</p>\n"}, {"tags": [], "owner": {"reputation": 24, "user_id": 2364080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95e189613380c266f35f41ee279abb07?s=128&d=identicon&r=PG", "display_name": "sludge705x", "link": "https://stackoverflow.com/users/2364080/sludge705x"}, "is_accepted": false, "score": -2, "last_activity_date": 1550608574, "last_edit_date": 1550608574, "creation_date": 1550606784, "answer_id": 54774137, "question_id": 46932069, "link": "https://stackoverflow.com/questions/46932069/appactivate-works-in-excel-2007-but-not-in-2010/54774137#54774137", "title": "AppActivate works in Excel 2007 but not in 2010", "body": "<p>I use this macro to open Bookmarks from Excel 2010 in Firefox.</p>\n\n<p>It has worked - then sometimes it doesn't work (Run-time error 5)</p>\n\n<p>I see the fix as:  close &amp; re-open Firefox, then try it - works</p>\n\n<p>What gets messed up, so it doesn't work?</p>\n\n<pre><code>Sub Open_a_Bookmark(control As IRibbonControl)\n\n' Open a Bookmark in Firefox . . . Firefox has to be open for this to work\n\n' Go to the Row of the bookmark you want, then click this button.\n' It automatically goes to the URL column, and copies it.\n    Cells(ActiveCell.Row, \"BK\").Activate\n    ActiveCell.copy\n\n' Open a new tab in Firefox with Ctrl+T\n    AppActivate \"Firefox\"\n    SendKeys (\"^t\"), True\n\n' Sometimes you have to click this macro again, to get it to work, because the \"paste\" doesn't get to Firefox.\n' Give it a second before pasting\n    Application.Wait (Now + TimeValue(\"00:00:01\"))\n\n' The focus defaults to the Address Bar.  Paste the URL / Enter\n    SendKeys (\"^v~\"), True\n\n' * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n\n' See the bottom of \"Process_Bookmarks\" for details.  Used at the end of macros, when necessary.\n\n    SendKeys \"{NUMLOCK}\", True\n\n    Application.Wait (Now + TimeValue(\"00:00:01\"))\n    Selection.Borders(xlEdgeBottom).LineStyle = xlNone\n\n' * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * \nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 391, "user_id": 6370369, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/77985c9576ec365d3dc4172ee88517df?s=128&d=identicon&r=PG", "display_name": "RShome", "link": "https://stackoverflow.com/users/6370369/rshome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7448, "favorite_count": 1, "accepted_answer_id": 47012600, "answer_count": 5, "score": 2, "last_activity_date": 1553636133, "creation_date": 1508933395, "last_edit_date": 1531164843, "question_id": 46932069, "link": "https://stackoverflow.com/questions/46932069/appactivate-works-in-excel-2007-but-not-in-2010", "title": "AppActivate works in Excel 2007 but not in 2010", "body": "<p>I have a excel macro that I run in Excel 2007 and it opens a mainframe application so I can import data from my spreadsheet automatically.</p>\n\n<p>This has been working fine, however it doesn't work in Excel 2010.</p>\n\n<p>I have tried using the shell command to use the ID but the other application is a mainframe application and non windows based.</p>\n\n<p>However, </p>\n\n<p>AppActivate \"Title\" (to open the mainframe application) was working fine in excel 2007.</p>\n\n<p>In Excel 2010 I am getting a Run-time error 5 - Invalid procedure call or argument.</p>\n\n<p>I've been trying to solve this for two days and it all works fine on 2007 version.</p>\n\n<p>Any help would be really appreciated.</p>\n\n<p>Dim appName as String </p>\n\n<p>appName = Range(\"AppName\").Value 'this is a name stored in my excel spreadsheet for the mainframe app </p>\n\n<p>AppActivate (appName) => this line is giving runtime error '5' invalid procedure call or argument</p>\n"}, {"tags": ["xml", "excel", "vba"], "comments": [{"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1508936243, "post_id": 46932066, "comment_id": 80813063, "body": "you can probably find the control id by looping the commandbars <a href=\"https://blogs.msdn.microsoft.com/vsto/2009/04/30/here-is-a-way-to-get-the-id-of-a-built-in-outlook-command-bar-menu-norm-estabrook/\" rel=\"nofollow noreferrer\">blogs.msdn.microsoft.com/vsto/2009/04/30/&hellip;</a>, but not sure if that can be used in the customUI <a href=\"https://msdn.microsoft.com/en-us/library/dd943885?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/&hellip;</a>"}], "owner": {"reputation": 21, "user_id": 8830856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633dc9bfd5a693da41a21718ec5d2913?s=128&d=identicon&r=PG&f=1", "display_name": "S&#248;ren B", "link": "https://stackoverflow.com/users/8830856/s%c3%b8ren-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 502, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1508957522, "creation_date": 1508933391, "last_edit_date": 1531161705, "question_id": 46932066, "link": "https://stackoverflow.com/questions/46932066/disable-excel-2016-share-on-specific-document", "title": "Disable Excel 2016 &quot;Share&quot; on specific document", "body": "<p>Is it possible to disable the Excel 2016 \"Share\" option on a specific document only? I have previously used CustomUI XML to remove all unwanted ribbons buttons etc. for a specific document that I don't want users to send to others or to save locally. But Office 2016 adds a button in the File tab (as well as in the top right corner) that allows users to easily share (as Email attachment, etc.) the document with others.</p>\n\n<p>I would like to prevent that, and I can see that it is possible via a GPO (<a href=\"http://www.urtech.ca/2017/03/solved-disable-share-button-office-2016-using-gpo/\" rel=\"nofollow noreferrer\">http://www.urtech.ca/2017/03/solved-disable-share-button-office-2016-using-gpo/</a>) but I don't want this option to be disabled for everything - just this single document. I have tried all the options in CustomUI including the TabShare but it turns of everything except the \"Share\" button.</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2009/07/customui\"&gt;\n    &lt;backstage&gt;\n        &lt;button idMso=\"FileSave\" visible=\"false\"/&gt;\n        &lt;button idMso=\"FileSaveAs\" visible=\"false\"/&gt;\n        &lt;button idMso=\"FileOpen\" visible=\"false\"/&gt;\n        &lt;button idMso=\"FileClose\" visible=\"false\"/&gt;\n        &lt;button idMso=\"ApplicationOptionsDialog\" visible=\"false\"/&gt;\n        &lt;button idMso=\"FileExit\" visible=\"false\"/&gt;\n        &lt;button idMso=\"HistoryTab\" visible=\"false\"/&gt;\n        &lt;button idMso=\"OfficeFeedback\" visible=\"false\"/&gt;\n        &lt;tab idMso=\"TabInfo\" visible=\"false\" enabled=\"false\"/&gt;\n        &lt;tab idMso=\"TabRecent\" visible=\"false\" enabled=\"false\"/&gt;\n        &lt;tab idMso=\"TabNew\" visible=\"false\" enabled=\"false\"/&gt;\n        &lt;tab idMso=\"TabPrint\" visible=\"false\" enabled=\"false\"/&gt;\n        &lt;tab idMso=\"TabShare\" visible=\"false\" enabled=\"false\" /&gt;\n        &lt;tab idMso=\"TabHelp\" visible=\"false\" enabled=\"false\"/&gt;\n        &lt;tab idMso=\"TabPublish\" visible=\"false\" enabled=\"false\"/&gt;\n        &lt;tab idMso=\"TabSave\" visible=\"false\" enabled=\"false\"/&gt;\n        &lt;tab idMso=\"TabOfficeStart\" visible=\"false\" enabled=\"false\"/&gt;\n    &lt;tab idMso=\"Publish2Tab\" visible=\"false\" enabled=\"false\"/&gt;\n    &lt;tab idMso=\"TabOfficeFeedback\" visible=\"false\" enabled=\"false\"/&gt;\n    &lt;/backstage&gt;\n&lt;/customUI&gt;\n</code></pre>\n"}, {"tags": ["vba", "excel", "datetime"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508934746, "post_id": 46931987, "comment_id": 80811899, "body": "Just FYI, <code>INT(some_Date)</code> does nothing apart from remove the time portion from a date, and <code>INT(2&#47;15&#47;2017)</code> is the same as <code>INT(0.0037183936539415)</code> i.e. <code>0</code>."}], "answers": [{"comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1508933587, "post_id": 46932065, "comment_id": 80811026, "body": "It&#39;s not entirely clear, but am guessing it should also be <code>sht1</code> instead of <code>sht2</code>."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1508933661, "post_id": 46932065, "comment_id": 80811092, "body": "@SJR i think you might be right, but I was&#39;nt sure since the PO didn&#39;t share his entire code, nore what he is trying to achieve (i&#39;ll add it as anoth option)"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1508935244, "post_id": 46932065, "comment_id": 80812256, "body": "Although what you write is technically correct based on what the OP asked, I would guess he really wants the argument to the <code>INT</code> function to be a date.  i.e.:  <code>Range(&quot;B1&quot;).Formula = &quot;=IF(INT(A1)&gt;INT(&quot;&quot;2&#47;15&#47;2017&quot;&quot;),&quot;&quot;Year1&quot;&quot;,&quot;&quot;Year2&quot;&quot;)&quot;</code>"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": true, "score": 1, "last_activity_date": 1508933716, "last_edit_date": 1508933716, "creation_date": 1508933387, "answer_id": 46932065, "question_id": 46931987, "link": "https://stackoverflow.com/questions/46931987/excel-vba-formula-with-date-compare-in-if-function-within-a-formula/46932065#46932065", "title": "excel vba formula with date compare in IF function within a formula", "body": "<p><strong>Excel is English oriented</strong>, you are using <code>;</code> in your formula.</p>\n\n<p>So either change your <code>;</code> to <code>,</code> inside your formula string, like:</p>\n\n<pre><code>sht2.Range(\"B1\").Formula = \"=IF(INT(A1)&gt;INT(2/15/2017),\"\"Year1\"\",\"\"Year2\"\")\"\n</code></pre>\n\n<p>Or, change <code>Formula</code> to <code>FormulaLocal</code> as in the following line:</p>\n\n<pre><code>sht2.Range(\"B1\").FormulaLocal = \"=IF(INT(A1)&gt;INT(2/15/2017);\"\"Year1\"\";\"\"Year2\"\")\"\n</code></pre>\n\n<hr>\n\n<p><strong>Note</strong>: in the <code>Formula</code> line I think you meant to use <code>sht1</code> and not <code>sht2</code>, so it should be:</p>\n\n<pre><code>sht1.Range(\"B1\").Formula = \"=IF(INT(A1)&gt;INT(2/15/2017),\"\"Year1\"\",\"\"Year2\"\")\"\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 8831305, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/53a0bf6767dd12f3d26e34e3f408b1d7?s=128&d=identicon&r=PG&f=1", "display_name": "Heinreich213", "link": "https://stackoverflow.com/users/8831305/heinreich213"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 46932065, "answer_count": 1, "score": 0, "last_activity_date": 1508934129, "creation_date": 1508933136, "last_edit_date": 1508934129, "question_id": 46931987, "link": "https://stackoverflow.com/questions/46931987/excel-vba-formula-with-date-compare-in-if-function-within-a-formula", "title": "excel vba formula with date compare in IF function within a formula", "body": "<p>Let's say cell A1 is a Date: 23/06/2017</p>\n\n<p>Now in excel if I put the following formula in cell B1:</p>\n\n<pre><code>=  IF(INT(C2)&gt;INT(2/15/2017);\"Year1\";\"Year2\") \n</code></pre>\n\n<p>then it's working fine.</p>\n\n<p>However, If I try to put it thought VBA coda as:-</p>\n\n<pre><code>Set sht1 = xWb.Sheets(\"ProcessedData\")\nsht1.Range(\"B1\").Select\nsht1.Range(\"B1\").Formula = _\n    \"=IF(INT(A1)&gt;INT(2/15/2017);\"\"Year1\"\";\"\"Year2\"\")\" \n</code></pre>\n\n<p>It is giving me error 1004 (Object not found). I tried with CDate but I think, I am missing something here. </p>\n\n<p>Can you please help me with this issue. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508933131, "post_id": 46931901, "comment_id": 80810692, "body": "Give more code."}, {"owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1508934040, "post_id": 46931901, "comment_id": 80811388, "body": "Thanks everyone for your thoughts."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508934514, "post_id": 46931901, "comment_id": 80811740, "body": "You could just hide the form in the button click."}], "answers": [{"tags": [], "owner": {"reputation": 340, "user_id": 2474008, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/810145437/picture?type=large", "display_name": "Vexen Crabtree", "link": "https://stackoverflow.com/users/2474008/vexen-crabtree"}, "is_accepted": false, "score": 1, "last_activity_date": 1508933131, "creation_date": 1508933131, "answer_id": 46931983, "question_id": 46931901, "link": "https://stackoverflow.com/questions/46931901/vba-userform-button-macro-to-continue-running-the-sub/46931983#46931983", "title": "VBA - UserForm Button (Macro) to Continue running the sub", "body": "<p>On the form properties for userform1, set its \"Modal\" property to true.</p>\n\n<p>When the form opens, it will have exclusive focus, and the code in sub1 will not continue running until after it closes. This may be the solution you need.</p>\n\n<p>In the code below, the msgbox will only appear once userform1 closes:</p>\n\n<pre><code>sub sub1()\n    userform1.show()\n    msgbox \"Now continuing with sub1\"\nend sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 1, "last_activity_date": 1508933398, "creation_date": 1508933398, "answer_id": 46932071, "question_id": 46931901, "link": "https://stackoverflow.com/questions/46931901/vba-userform-button-macro-to-continue-running-the-sub/46932071#46932071", "title": "VBA - UserForm Button (Macro) to Continue running the sub", "body": "<p>No way as long as you show the form. </p>\n\n<p>If you show the form <em>modal</em>, the calling routine continues if (and only if) the form is closed. </p>\n\n<p>If you show the form <em>non-modal</em>, the code continues to run directly after the <code>show</code> - so it's already done. </p>\n\n<p>So either you have to close the form when the user clicks the \"continue...\" button to let the calling macro continue or you have to split your code into two routines and call the second on button-click.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8753746"}, "is_accepted": false, "score": 1, "last_activity_date": 1508933437, "creation_date": 1508933437, "answer_id": 46932088, "question_id": 46931901, "link": "https://stackoverflow.com/questions/46931901/vba-userform-button-macro-to-continue-running-the-sub/46932088#46932088", "title": "VBA - UserForm Button (Macro) to Continue running the sub", "body": "<p>You can change your Sub1 as follows:</p>\n\n<pre><code>Sub sub1(Optional Continue As Boolean)\n\n   If Continue = True Then\n      DoSomeStuff\n      Exit Sub\n   End If\n   userform1.show\n\nEnd sub\n</code></pre>\n\n<p>And then, you can call your <code>sub1</code> using:</p>\n\n<pre><code>Private Sub continuebutton()\n   Call sub1(True)\nEnd Sub\n</code></pre>\n\n<p>Hope it helps</p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1508933766, "creation_date": 1508933766, "answer_id": 46932196, "question_id": 46931901, "link": "https://stackoverflow.com/questions/46931901/vba-userform-button-macro-to-continue-running-the-sub/46932196#46932196", "title": "VBA - UserForm Button (Macro) to Continue running the sub", "body": "<p>Theoretically, what you want is possible, if you do it like this:</p>\n\n<p>In the UserForm:</p>\n\n<pre><code>Private Sub btnContinue_Click()\n    flag = True\n    Debug.Print \"I continue ...\"\n    sub1\nEnd Sub\n</code></pre>\n\n<p>In a module:</p>\n\n<pre><code>Public flag As Boolean\n\nPublic Sub sub1()\n\n    If flag Then\n        Debug.Print \"sub 1 continues here...\"\n    Else\n        flag = False\n        UserForm1.Show\n        Exit Sub\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>It will work exactly as intended, <strong>BUT</strong> it is not a good practice to work this way. (Some people may throw stones at you for using public variables at all in VBA.) Here are two articles, that give better ideas:</p>\n\n<ul>\n<li><a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/</a></li>\n</ul>\n\n<p><em>Disclaimer - this one is mine:</em></p>\n\n<ul>\n<li><a href=\"http://www.vitoshacademy.com/vba-the-perfect-userform-in-vba/\" rel=\"nofollow noreferrer\">http://www.vitoshacademy.com/vba-the-perfect-userform-in-vba/</a> </li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 340, "user_id": 2474008, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/810145437/picture?type=large", "display_name": "Vexen Crabtree", "link": "https://stackoverflow.com/users/2474008/vexen-crabtree"}, "is_accepted": false, "score": 1, "last_activity_date": 1508933865, "creation_date": 1508933865, "answer_id": 46932235, "question_id": 46931901, "link": "https://stackoverflow.com/questions/46931901/vba-userform-button-macro-to-continue-running-the-sub/46932235#46932235", "title": "VBA - UserForm Button (Macro) to Continue running the sub", "body": "<p>If you don't want to go with the 'Modal Form' solution, you could add a subroutine to your main module, and call it when required. So, in userform1, you have:</p>\n\n<pre><code>sub sub1()\n    userform1.show()\nend sub\n\npublic sub sub2()\n    msgbox \"Now continuing...\"\nend sub\n</code></pre>\n\n<p>And then in userform1, set some code on its onClose event:</p>\n\n<pre><code>Private Sub continuebutton()\n    Call sub2()\nend sub\n</code></pre>\n"}], "owner": {"reputation": 2568, "user_id": 7638174, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/8c25651e0c6634562b6283fa9d76b9cb?s=128&d=identicon&r=PG&f=1", "display_name": "CodingDawg", "link": "https://stackoverflow.com/users/7638174/codingdawg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2626, "favorite_count": 0, "accepted_answer_id": 46932196, "answer_count": 5, "score": 1, "last_activity_date": 1508943691, "creation_date": 1508932876, "last_edit_date": 1531164843, "question_id": 46931901, "link": "https://stackoverflow.com/questions/46931901/vba-userform-button-macro-to-continue-running-the-sub", "title": "VBA - UserForm Button (Macro) to Continue running the sub", "body": "<p>I have a sub called as <code>sub1()</code> which activates the userform1 through the command <code>userform1.show()</code></p>\n\n<p>This userform1 has a button called as continue. On clicking that button continue - A Macro called as <code>Private Sub continuebutton()</code> gets activated. </p>\n\n<p>I want to program in such a way that it redirects to the line after <code>userform1.show()</code> in <code>sub1()</code>.</p>\n\n<p>Is it something that can be done?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8807536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0c700430760f3b60a1683ac91b89df?s=128&d=identicon&r=PG&f=1", "display_name": "Old Flyboy", "link": "https://stackoverflow.com/users/8807536/old-flyboy"}, "edited": false, "score": 0, "creation_date": 1509031751, "post_id": 46931899, "comment_id": 80863909, "body": "Thanks for the tips.  I still ran into difficulties so I started to construct a query using &quot;like&quot; in the criteria entry.  &quot;Like&quot; was changed to &quot;ALike&quot; and the query failed.  research on &quot;ALike&quot; revealed that having the database in &quot;Sql Server Compaible Syntax (ANSI 92) mode selected caused &quot;Like&quot; to be changed to &quot;ALike&quot; and the wildcard is now &quot;%&quot;, not the asterisk.  I deselected the option and incorporated your last suggestion and was met with success.  Thanks for your comments.  You have been a big help."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1508934062, "last_edit_date": 1508934062, "creation_date": 1508932872, "answer_id": 46931899, "question_id": 46931815, "link": "https://stackoverflow.com/questions/46931815/filter-construction-that-no-longer-works/46931899#46931899", "title": "filter construction that no longer works", "body": "<p>You're missing a space before the <code>And</code>, corrected here:</p>\n\n<pre><code>Me.Filter = \"[ItemNomen] like '*'\" &amp; \" And [VendorNbr] = \" &amp; Vendor_Nbr\n</code></pre>\n\n<p>A more logical approach would be to just remove the string concatenation:</p>\n\n<pre><code>Me.Filter = \"[ItemNomen] like '*' And [VendorNbr] = \" &amp; Vendor_Nbr\n</code></pre>\n\n<p>And, knowing that <code>[ItemNomen] Like '*'</code> matches anything except null values, you're better off using <code>IS NOT NULL</code>:</p>\n\n<pre><code>Me.Filter = \"[ItemNomen] IS NOT NULL And [VendorNbr] = \" &amp; Vendor_Nbr\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8807536, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0c700430760f3b60a1683ac91b89df?s=128&d=identicon&r=PG&f=1", "display_name": "Old Flyboy", "link": "https://stackoverflow.com/users/8807536/old-flyboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 46931899, "answer_count": 1, "score": 0, "last_activity_date": 1594638895, "creation_date": 1508932608, "last_edit_date": 1594638895, "question_id": 46931815, "link": "https://stackoverflow.com/questions/46931815/filter-construction-that-no-longer-works", "title": "filter construction that no longer works", "body": "<p>this filter statement work in other access software until I began constructing a new continuous form and now no longer works</p>\n\n<pre><code> Me.Filter = \"[ItemNomen] like '*'\" &amp; \"And [VendorNbr] = \" &amp; Vendor_Nbr\n Me.FilterOn = True\n</code></pre>\n\n<p>I haven't had an issue with the statement until just recently.  it seems the issue is with the \"like \" statement.  I'm self-taught and therefore at a total loss on why it no longer works.  any ideas?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8831267, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155784940095912/picture?type=large", "display_name": "Merlyn Koh", "link": "https://stackoverflow.com/users/8831267/merlyn-koh"}, "edited": false, "score": 0, "creation_date": 1508935611, "post_id": 46932651, "comment_id": 80812557, "body": "ah thank you! Any idea how to extract the minimum price from here?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 11, "user_id": 8831267, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155784940095912/picture?type=large", "display_name": "Merlyn Koh", "link": "https://stackoverflow.com/users/8831267/merlyn-koh"}, "edited": false, "score": 0, "creation_date": 1508936373, "post_id": 46932651, "comment_id": 80813156, "body": "The preferred method would be to create an HTML Document from the   responseText and then find the elements of the Document that have the information that you want.  The answer to <a href=\"https://stackoverflow.com/questions/19958472/vba-msxml2-serverxmlhttp-response-text-is-an-html-page\">VBA MSXML2.ServerXMLHTTP Response text is an HTML Page</a> will show you how to create an HTML Document."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 11, "user_id": 8831267, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155784940095912/picture?type=large", "display_name": "Merlyn Koh", "link": "https://stackoverflow.com/users/8831267/merlyn-koh"}, "edited": false, "score": 0, "creation_date": 1508936980, "post_id": 46932651, "comment_id": 80813606, "body": "You will need to search the list items of <code>&lt;ul id=&quot;flightModuleList&quot;&gt;</code> to find the information of each flight."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "reply_to_user": {"reputation": 11, "user_id": 8831267, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155784940095912/picture?type=large", "display_name": "Merlyn Koh", "link": "https://stackoverflow.com/users/8831267/merlyn-koh"}, "edited": false, "score": 0, "creation_date": 1508937260, "post_id": 46932651, "comment_id": 80813797, "body": "You can still do it your way you will just have to create a loo and change the starting location of the <code>Instr</code> function:   &#39;Locn_price = InStr(Locn_price , buf, &quot;formattedTotalPrice\\&quot;&#39;.  You will also have to initiate the <code>Locn_price = 1</code> before the loop."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1508935051, "creation_date": 1508935051, "answer_id": 46932651, "question_id": 46931687, "link": "https://stackoverflow.com/questions/46931687/retrieving-min-value-from-website-via-vba/46932651#46932651", "title": "Retrieving min. value from website via VBA", "body": "<p>The Date need to be formatted DD/MM/YYYY: Format(Date, \"dd/mm/yyyy\")</p>\n\n<pre><code>pth = \"https://www.expedia.com.sg/Flights-Search?rfrr=TG.LP.SrchWzd.Flight&amp;langid=2057&amp;trip=OneWay&amp;leg1=from:Singapore,%20Singapore%20(SIN-Changi),to:Bangkok,%20Thailand%20(BKK-Suvarnabhumi%20Intl.),departure:\" &amp; Format(Date, \"dd/mm/yyyy\") &amp; \"TANYT&amp;passengers=children:0,adults:1,seniors:0,infantinlap:Y&amp;options=cabinclass:economy,sortby:price,carrier:&amp;mode=search&amp;paandi=true\"\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 8831267, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155784940095912/picture?type=large", "display_name": "Merlyn Koh", "link": "https://stackoverflow.com/users/8831267/merlyn-koh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508935051, "creation_date": 1508932206, "last_edit_date": 1531164843, "question_id": 46931687, "link": "https://stackoverflow.com/questions/46931687/retrieving-min-value-from-website-via-vba", "title": "Retrieving min. value from website via VBA", "body": "<p>I very recently started learning VBA and is facing some difficulties in scraping data. I would like to retrieve the daily minimum flight price from Singapore to Bangkok.</p>\n\n<p>My current code is only able to retrieve the first line of code referencing to \"formattedTotalPrice\" in the website source code, which might not be the minimum price. Would be really grateful if someone could help a newbie out!</p>\n\n<pre><code>Sub GetPrices()\n\nDim wb As Workbook\nDim ws As Worksheet\n\nSet wb = ThisWorkbook\nSet ws = wb.Sheets(\"Sheet1\")\n\nDim pth As String\npth = \"https://www.expedia.com.sg/Flights-Search?rfrr=TG.LP.SrchWzd.Flight&amp;langid=2057&amp;trip=OneWay&amp;leg1=from:Singapore,%20Singapore%20(SIN-Changi),to:Bangkok,%20Thailand%20(BKK-Suvarnabhumi%20Intl.),departure:\" &amp; date &amp; \"TANYT&amp;passengers=children:0,adults:1,seniors:0,infantinlap:Y&amp;options=cabinclass:economy,sortby:price,carrier:&amp;mode=search&amp;paandi=true\"\n\nDim lastRow As Integer\nlastRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nSet XMLHTTP = CreateObject(\"MSXML2.serverXMLHTTP\")\nXMLHTTP.Open \"GET\", pth, False\nXMLHTTP.setRequestHeader \"Content-Type\", \"text/xml\"\nXMLHTTP.send\nbuf = XMLHTTP.ResponseText\n\nLocn_price = InStr(1, buf, \"formattedTotalPrice\\\")\nLocn_end = InStr(Locn_price, buf, \"totalPriceAsDecimal\\\")\ntrim_price = Mid(buf, Locn_price + 27, Locn_end - 32 - Locn_price)\nDebug.Print trim_price\n\nws.Cells(lastRow + 1, 1).Value = Date\nws.Cells(lastRow + 1, 2).Value = trim_price\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "date", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508933545, "post_id": 46931926, "comment_id": 80810997, "body": "I want it to appear as number but in the form of a date"}], "tags": [], "owner": {"reputation": 1632, "user_id": 6072648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qJ2RW.jpg?s=128&g=1", "display_name": "Kerry Jackson", "link": "https://stackoverflow.com/users/6072648/kerry-jackson"}, "is_accepted": false, "score": 2, "last_activity_date": 1508934198, "last_edit_date": 1508934198, "creation_date": 1508932934, "answer_id": 46931926, "question_id": 46931617, "link": "https://stackoverflow.com/questions/46931617/macro-to-calculate-the-difference-in-hhmmss/46931926#46931926", "title": "Macro to calculate the difference in hh:mm:ss", "body": "<p>Are you looking for a number which is the number of hours, or are you looking for text?<br>\nIf you want the number of hours, try just subtracting the dates, and multiplying by 24, so the formula would be <code>=(NOW()-E2)*24</code>.  </p>\n"}, {"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1508934565, "post_id": 46932416, "comment_id": 80811778, "body": "Nice, you could used <code>diff = Abs(d2 - d1)</code>,   instead of <code>If d2 &gt; d1 Then diff = d2 - d1 Else diff = d1 - d2</code>"}, {"owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1508934768, "post_id": 46932416, "comment_id": 80811919, "body": "I also realised that <code>diff = diff - days</code> is redundant, as the later Format function only takes the time part anyway."}], "tags": [], "owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "is_accepted": false, "score": 4, "last_activity_date": 1508934985, "last_edit_date": 1508934985, "creation_date": 1508934375, "answer_id": 46932416, "question_id": 46931617, "link": "https://stackoverflow.com/questions/46931617/macro-to-calculate-the-difference-in-hhmmss/46932416#46932416", "title": "Macro to calculate the difference in hh:mm:ss", "body": "<p>Put this in a module</p>\n\n<pre><code>    Public Function DateTimeDiff(d1 As Date, d2 As Date)\n\n\n        Dim diff As Double\n        diff = ABS(d2 - d1)\n\n        DateTimeDiff = Fix(diff) &amp; Format(diff, \" hh:mm\")\n\n\n    End Function\n</code></pre>\n\n<p>Then use</p>\n\n<pre><code>=DateTimeDiff( NOW(), E2 )\n</code></pre>\n\n<p>as the formula in the worksheet.</p>\n\n<p>You might want to add some validation on the dates and return an error message if they are not valid.</p>\n"}, {"comments": [{"owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "edited": false, "score": 0, "creation_date": 1508935038, "post_id": 46932485, "comment_id": 80812102, "body": "I actually did that exact thing, but I wanted to avoid doing it in two rows so as to cut the size of the macro..."}, {"owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "edited": false, "score": 1, "creation_date": 1508936460, "post_id": 46932485, "comment_id": 80813225, "body": "That&#39;s very neat - I did not know of the trick of putting brackets round the hh."}], "tags": [], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "is_accepted": true, "score": 4, "last_activity_date": 1508934901, "last_edit_date": 1508934901, "creation_date": 1508934559, "answer_id": 46932485, "question_id": 46931617, "link": "https://stackoverflow.com/questions/46931617/macro-to-calculate-the-difference-in-hhmmss/46932485#46932485", "title": "Macro to calculate the difference in hh:mm:ss", "body": "<p>Just use <code>=(NOW()-E2)</code> and apply a custom format <code>[hh]:mm:ss</code>. The brackets around <code>hh</code> will do the trick.<br>\nIf you rather need a number of hours, multiply by 24 as @Kerry Jackson suggested.<br>\nThe logic behing date/time values is that 1 day = 1, so  </p>\n\n<ul>\n<li>1 hour = 1/24</li>\n<li>1 min = 1/1440  '(that is 24*60  )<br>\netc... </li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "is_accepted": false, "score": 1, "last_activity_date": 1508936100, "last_edit_date": 1508936100, "creation_date": 1508935785, "answer_id": 46932930, "question_id": 46931617, "link": "https://stackoverflow.com/questions/46931617/macro-to-calculate-the-difference-in-hhmmss/46932930#46932930", "title": "Macro to calculate the difference in hh:mm:ss", "body": "<pre><code>Public Function timeElapsed(ByVal target_cell As Range) As String\nDim hours As Long, minutes As Long, days As Long\nIf target_cell.Value = 0 Then Exit Function\nx = DateDiff(\"n\", target_cell, Now())\ndays = Format(Application.WorksheetFunction.RoundDown(x / 1440, 0), \"00\")\nhours = Format(Application.WorksheetFunction.RoundDown((x - (days * 1440)) / 60, 0), \"00\")\nminutes = Format(Application.WorksheetFunction.RoundDown((x - ((days * 1440) + (hours * 60))), 0), \"00\")\ntimeElapsed = CStr(days) &amp; \" \" &amp; \"days\" &amp; \" \" &amp; CStr(hours) &amp; \":\" &amp; CStr(minutes)\nEnd Function\n</code></pre>\n\n<p>And use as function with the result as below:</p>\n\n<p><a href=\"https://i.stack.imgur.com/DvB61.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DvB61.png\" alt=\"Result\"></a></p>\n\n<p>So you code becomes:</p>\n\n<pre><code>With ws1\n    .Range(\"N2:N\" &amp; lastrow1).FormulaR1C1 = \"=timeElapsed(RC[-9])\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 606, "user_id": 8319567, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh5.googleusercontent.com/-orxUXTprQns/AAAAAAAAAAI/AAAAAAAAAF8/16O1_DCurfE/photo.jpg?sz=128", "display_name": "Pericles Faliagas", "link": "https://stackoverflow.com/users/8319567/pericles-faliagas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1010, "favorite_count": 0, "accepted_answer_id": 46932485, "answer_count": 4, "score": 1, "last_activity_date": 1508936100, "creation_date": 1508932019, "question_id": 46931617, "link": "https://stackoverflow.com/questions/46931617/macro-to-calculate-the-difference-in-hhmmss", "title": "Macro to calculate the difference in hh:mm:ss", "body": "<p>I want to calculate the difference in hh:mm:ss between Now and column E. They both appear in format dd/mm/yyyy hh:mm. With the code I have written below, it only takes into consideration the hh:mm and not the days. So, if they have 2 days difference in wont add to the hours +48. The code is below:</p>\n\n<pre><code>With ws1.Range(\"N2:N\" &amp; lastrow1)\n.Formula = \"=TIME(HOUR(NOW()),MINUTE(NOW()),SECOND(NOW()))-TIME(HOUR(E2),MINUTE(E2),SECOND(32))\"\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1508931409, "post_id": 46931365, "comment_id": 80809491, "body": "Of course there is a way.  What have you tried?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1508931862, "post_id": 46931365, "comment_id": 80809795, "body": "I would use a <code>Scripting.Dictionary</code> to check for duplicates. You&#39;ll have to iterate over all the cells and use  <code>Split(Cells(x,y).Value, &quot;;&quot; )</code> to split the values into an Array.  Next you loop through the values of the Array testing to see if the value <code>Exists</code> in the <code>Scripting.Dictionary</code>.  If it does then remove the value from the cell else <code>Add</code> the new Key to the <code>Scripting.Dictionary</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1508931962, "post_id": 46931365, "comment_id": 80809867, "body": "I would really like to upvote the question but without an example of attempted code,  it should be closed."}, {"owner": {"reputation": 19, "user_id": 5639820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb863650d439f0b5c0f4ffc0e73de97e?s=128&d=identicon&r=PG&f=1", "display_name": "Zandre", "link": "https://stackoverflow.com/users/5639820/zandre"}, "edited": false, "score": 0, "creation_date": 1508934809, "post_id": 46931365, "comment_id": 80811947, "body": "Thanks for your answer @ThomasInzina. I hadn&#39;t tried anything for the time being because I was not even sure whether this was possible. I was hoping of getting inspired here :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1508935101, "post_id": 46931365, "comment_id": 80812138, "body": "I understand but that is not how SO works."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1508935570, "post_id": 46931365, "comment_id": 80812516, "body": "If you can provide some Sample data and code  that will iterate over range, I will be glad to post an answer."}, {"owner": {"reputation": 19, "user_id": 5639820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb863650d439f0b5c0f4ffc0e73de97e?s=128&d=identicon&r=PG&f=1", "display_name": "Zandre", "link": "https://stackoverflow.com/users/5639820/zandre"}, "edited": false, "score": 0, "creation_date": 1508937605, "post_id": 46931365, "comment_id": 80814054, "body": "@ThomasInzina I do not have any sample code. I do have Sample data, but I did not post it because my problem is as simple as described in the question and I did not want to make the question too heavy. Apologies for misusing SO if this is the case. However, I had seen questions in the past in which people simple wonder if an action was even possible in Excel and I though this was also the purpose of SO :)"}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 5639820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb863650d439f0b5c0f4ffc0e73de97e?s=128&d=identicon&r=PG&f=1", "display_name": "Zandre", "link": "https://stackoverflow.com/users/5639820/zandre"}, "edited": false, "score": 0, "creation_date": 1509003244, "post_id": 46935224, "comment_id": 80843759, "body": "what if I have more than  one column? What I have is a matrix. And I would like to remove duplicates in the first column (which represent the row &quot;headers&quot;). In the other column are values (say 1,0) which I would like to keep if the row headers is not a duplicate. Many thanks"}, {"owner": {"reputation": 158, "user_id": 2794327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36471432ab0c7779ea037601058ab197?s=128&d=identicon&r=PG&f=1", "display_name": "Arjeel", "link": "https://stackoverflow.com/users/2794327/arjeel"}, "reply_to_user": {"reputation": 19, "user_id": 5639820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb863650d439f0b5c0f4ffc0e73de97e?s=128&d=identicon&r=PG&f=1", "display_name": "Zandre", "link": "https://stackoverflow.com/users/5639820/zandre"}, "edited": false, "score": 0, "creation_date": 1509006983, "post_id": 46935224, "comment_id": 80846117, "body": "Are you worried about overwriting the data in case you split?"}, {"owner": {"reputation": 19, "user_id": 5639820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb863650d439f0b5c0f4ffc0e73de97e?s=128&d=identicon&r=PG&f=1", "display_name": "Zandre", "link": "https://stackoverflow.com/users/5639820/zandre"}, "edited": false, "score": 0, "creation_date": 1509007199, "post_id": 46935224, "comment_id": 80846257, "body": "Yes and also I was struggling in filtering all the rows at once since in the option &quot;filter left to right&quot; we have to select row by row. But I imagine I can write a macro for that. Overwriting data in the table is indeed my main concern"}, {"owner": {"reputation": 158, "user_id": 2794327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36471432ab0c7779ea037601058ab197?s=128&d=identicon&r=PG&f=1", "display_name": "Arjeel", "link": "https://stackoverflow.com/users/2794327/arjeel"}, "reply_to_user": {"reputation": 19, "user_id": 5639820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb863650d439f0b5c0f4ffc0e73de97e?s=128&d=identicon&r=PG&f=1", "display_name": "Zandre", "link": "https://stackoverflow.com/users/5639820/zandre"}, "edited": false, "score": 0, "creation_date": 1509008591, "post_id": 46935224, "comment_id": 80847185, "body": "To sort you can use a macro, that&#39;ll be good. In order to avoid overwriting, copy the column , paste it into other sheet, perform steps 1,2&amp;3 from the answer and once you&#39;ve concatenated, paste it back to the original sheet. Then use the column to remove duplicates."}], "tags": [], "owner": {"reputation": 158, "user_id": 2794327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36471432ab0c7779ea037601058ab197?s=128&d=identicon&r=PG&f=1", "display_name": "Arjeel", "link": "https://stackoverflow.com/users/2794327/arjeel"}, "is_accepted": false, "score": 0, "last_activity_date": 1508942105, "creation_date": 1508942105, "answer_id": 46935224, "question_id": 46931365, "link": "https://stackoverflow.com/questions/46931365/is-there-a-way-in-excel-to-filter-out-duplicates-even-if-the-items-occur-in-a-di/46935224#46935224", "title": "Is there a way in Excel to filter out duplicates even if the items occur in a different order within cells? (VBA solutions are also welcome)", "body": "<p>If there is only one column, the solution is simple.</p>\n\n<ol>\n<li>Use split to columns using \";\" as delimiter</li>\n<li>Sort the row, please note you have to sort row wise not column</li>\n<li>Concatenate</li>\n<li>use the highlight duplicate option.</li>\n</ol>\n\n<p>In my opinion, this should be less time taking than going VBA way</p>\n"}], "owner": {"reputation": 19, "user_id": 5639820, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb863650d439f0b5c0f4ffc0e73de97e?s=128&d=identicon&r=PG&f=1", "display_name": "Zandre", "link": "https://stackoverflow.com/users/5639820/zandre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508942105, "creation_date": 1508931263, "question_id": 46931365, "link": "https://stackoverflow.com/questions/46931365/is-there-a-way-in-excel-to-filter-out-duplicates-even-if-the-items-occur-in-a-di", "title": "Is there a way in Excel to filter out duplicates even if the items occur in a different order within cells? (VBA solutions are also welcome)", "body": "<p>What I am trying to do is some sort of smart \"remove duplicates\" in Excel. </p>\n\n<p>I have a list of 200+ cells and each cell in the list potentially contains multiple items separated by a semi-colon (;).So, imagine I have a cell containing items (a,f,g) and another cell containing items (g,a,f). \nThose cells are duplicates since they contain exactly the same items, but in a different order. However the order has no importance to me.</p>\n\n<p>Is there a way that excel could recognize such cells as duplicates?</p>\n\n<p>Many thanks in advance for you suggestions :)</p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1508931555, "post_id": 46931189, "comment_id": 80809581, "body": "Use <code>Formula</code> not <code>FormulaR1C1</code> since you aren&#39;t using <code>R1C1</code> referencing."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1508931717, "post_id": 46931189, "comment_id": 80809707, "body": "And use <code>Range(&quot;H&quot; &amp; Rownumber).Formula ...</code>rather than Select and ActiveCell."}], "answers": [{"comments": [{"owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "edited": false, "score": 0, "creation_date": 1509123278, "post_id": 46935121, "comment_id": 80907396, "body": "I noticed that the calculation of the row number needs slight modification if the dive numbers in a workbook run from, for example 1-50, 51-100 etc. The calculation <code>Rownumber = Divenumber Mod 50 + 9</code> has the effect that the last dive in the workbook i.e. Dive 50, Dive 100 etc go into row 9 instead of row 59. To fix this, the code should be <code>Rownumber = (DiveNumber - 1) Mod 50 + 10</code>"}], "tags": [], "owner": {"reputation": 1036, "user_id": 1992793, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d80078958a2b15908d308fb52b16147d?s=128&d=identicon&r=PG", "display_name": "JohnRC", "link": "https://stackoverflow.com/users/1992793/johnrc"}, "is_accepted": true, "score": 0, "last_activity_date": 1509123569, "last_edit_date": 1509123569, "creation_date": 1508941831, "answer_id": 46935121, "question_id": 46931189, "link": "https://stackoverflow.com/questions/46931189/excel-vba-macro-how-to-write-an-absolute-cell-reference-into-a-cell/46935121#46935121", "title": "Excel VBA macro. How to write an absolute cell reference into a cell", "body": "<p>This approach avoids using hyperlinks (which I find hard to maintain) and instead uses the <code>BeforeDoubleClick</code> event of the index sheet to provide equivalent functionality. </p>\n\n<p>This code goes into the code module for the Dive Index worksheet, so that it picks up the double-click event on the index:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)\n    '// This function is called whenever the sheet is double-clicked\n    '// It checks the value of the target (selected) cell, to see if it is a reference\n    '// to a dive sheet. If so, it activates that sheet\n\n    '// Get hold of the contents of the target cell\n    Dim sTarget As String: sTarget = Target.Cells(1, 1).Value\n\n    '// Check if it refers to a dive sheet\n    If Left(sTarget, 5) = \"Dive \" Then\n        Dim wsTarget As Worksheet\n        On Error Resume Next\n            '// Try to find the worksheet referred to by the target cell\n            Set wsTarget = Worksheets(sTarget)\n        On Error GoTo 0\n\n        '// Check that a target sheet was found\n        If wsTarget Is Nothing Then\n            Exit Sub\n        End If\n\n        '// Activate the sheet\n        wsTarget.Activate\n\n        '// Cancel the default action for double-click\n        Cancel = True\n\n    End If\n\n\nEnd Sub\n</code></pre>\n\n<p>This is the code for your function Add_Links(). I am not sure how you invoke it, but it works effectively the same as your example, except I have used some simpler techniques.</p>\n\n<pre><code>Option Explicit\n\nSub Add_links()\n\n        '\n        ' Add_links Macro\n        ' Adds links to the index sheet so it 'fills itself in'...\n\n        ' Each dive is on the row 9 more than the dive number (bear in mind each log is 50 higher than the previous)\n\n        Dim Divenumber As Double\n        Dim Rownumber As Double\n\n\n        Dim wsDive As Worksheet\n        Set wsDive = ActiveSheet\n\n        '// Dive number is in cell I7 of the sheet\n        Divenumber = wsDive.Range(\"I7\").Value\n\n        '// Make sure the sheet name corresponds to the dive number\n        Dim sDiveName As String\n        sDiveName = \"Dive \" &amp; Divenumber\n        wsDive.Name = sDiveName\n\n\n        '// Calculate the row number for the index entry\n        '-- -- Rownumber = Divenumber Mod 50 + 9\n        '// Use below if dive numbers in sheet run from 1 to 50, not 0 to 49\n        Rownumber = (Divenumber - 1) Mod 50 + 10\n\n        '// Get a reference to the index sheet\n        Dim wsIndex As Worksheet: Set wsIndex = Worksheets(\"Dive Index\")\n\n        '// Get a reference to column A in the index entry row\n        Dim rLink As Range: Set rLink = wsIndex.Range(\"A\" &amp; Rownumber)\n\n        '// Put the Dive name into column A\n        rLink.Value = sDiveName\n\n\n\n        '// Reference data from the dive sheet into the index sheet ================\n\n        '// Project number (in cell F4)\n        rLink.Offset(0, 1).Formula = ReferenceToCell(wsDive.Range(\"F4\")) '// Index Column B\n\n        '// Task(in cell C7)\n        rLink.Offset(0, 2).Formula = ReferenceToCell(wsDive.Range(\"C7\")) '// Index Column C\n\n        '// Start date (in cell C21)\n        rLink.Offset(0, 7).Formula = ReferenceToCell(wsDive.Range(\"C21\")) '// Index Column H\n\n        '// Start time (in cell E21)\n        rLink.Offset(0, 8).Formula = ReferenceToCell(wsDive.Range(\"E21\")) '// Index Column I\n\n        '// End date (in cell F21)\n        rLink.Offset(0, 9).Formula = ReferenceToCell(wsDive.Range(\"F21\")) '// Index Column J\n\n        '// End time (in cell G21)\n        rLink.Offset(0, 11).Formula = ReferenceToCell(wsDive.Range(\"G21\")) '// Index Column L\n\n\nEnd Sub\n\nPrivate Function ReferenceToCell(rCell As Range) As String\n    '// This function returns a formula that references the value of the given cell\n    ReferenceToCell = \"='\" &amp; rCell.Parent.Name &amp; \"'!\" &amp; rCell.Cells(1, 1).Address\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 8831028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e19d3878e4e05a38e0c1e14c0dfd995?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/8831028/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1390, "favorite_count": 0, "accepted_answer_id": 46935121, "answer_count": 1, "score": 1, "last_activity_date": 1509123569, "creation_date": 1508930779, "last_edit_date": 1508932045, "question_id": 46931189, "link": "https://stackoverflow.com/questions/46931189/excel-vba-macro-how-to-write-an-absolute-cell-reference-into-a-cell", "title": "Excel VBA macro. How to write an absolute cell reference into a cell", "body": "<p>I have a workbook with an index as the first sheet. Each subsequent sheet is a dive-log. As I am one of many using this workbook, it needs to be as 'automatic' as possible (because people are lazy)... </p>\n\n<p>Each log has a macro button for 'New Dive'. The macro creates a new sheet, names it with the new sheet number (the dive number) and clears relevant data ready for filling in. Currently the index sheet needs to be filled manually, but it's being ignored.</p>\n\n<p>I have the macro close, but it's the last step that has me stumped. I've tried <code>Activecell.FormulaR1C1 and Cells(r,c) =...</code> gets close, but no piece of pie. I'm also VERY new at this.</p>\n\n<p>Here's my code</p>\n\n<pre><code>Sub Add_links()\n'\n' Add_links Macro\n' Adds links to the index sheet so it 'fills itself in'... \n\n' Each dive is on the row 9 more than the dive number (bear in mind each log is 50 higher than the previous)\n\nDim Divenumber As Double\nDim Rownumber As Double\n\nRange(\"I7\").Select: Divenumber = ActiveCell.FormulaR1C1\n\n' Make Linenumber the same as Divenumber.\n' Do a loop of reducing the Linenumber by 50 until it's in the range 1 to 50.\n' Add 9 to that and it becomes the row number of the index sheet\n\nRownumber = Divenumber\n\nDo\nRownumber = Rownumber - 50\nLoop While Rownumber &gt; 50\n\nRownumber = Rownumber + 9\n\nWorksheets(\"Dive Index\").Activate\n\nRange(\"A\" &amp; Rownumber).Select\nActiveSheet.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= _\n    \"'Dive \" &amp; Divenumber &amp; \"'!A1\"\n'Project number (in cell F4)\nRange(\"B\" &amp; Rownumber).Select\nActiveCell.FormulaR1C1 = \"='Dive \" &amp; Divenumber &amp; \"'!F4\"\n'Task(in cell C7)\nRange(\"C\" &amp; Rownumber &amp; \":G\" &amp; Rownumber).Select\nActiveCell.FormulaR1C1 = \"='Dive \" &amp; Divenumber &amp; \"'!C7\"\n'Start date (in cell C21)\nRange(\"H\" &amp; Rownumber).Select\nActiveCell.FormulaR1C1 = \"='Dive \" &amp; Divenumber &amp; Chr(39) &amp; \"!$C$21\"\n'Start time (in cell E21)\nRange(\"I\" &amp; Rownumber).Select\nActiveCell.FormulaR1C1 = \"='Dive \" &amp; Divenumber &amp; Chr(39) &amp; \"!$E$21\"\n'End date (in cell F21)\nRange(\"J\" &amp; Rownumber &amp; \":K\" &amp; Rownumber).Select\nActiveCell.FormulaR1C1 = \"='Dive \" &amp; Divenumber &amp; Chr(39) &amp; \"!$F$21\"\n'End time (in cell G21)\nRange(\"L\" &amp; Rownumber).Select\nActiveCell.FormulaR1C1 = \"='Dive \" &amp; Divenumber &amp; Chr(39) &amp; \"!$G$21\"\n\nSheets(\"Dive \" &amp; Divenumber).Select\nRange(\"A23\").Select\nEnd Sub\n</code></pre>\n\n<p>This one gets me the closest..</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"='Dive \" &amp; Divenumber &amp; \"'!F4\"\n</code></pre>\n\n<p>but adds a couple of unwanted ' to the cell.. Looks like this...</p>\n\n<p><code>='Dive 53'!'F4'</code> (should be <code>='Dive 53'!F4</code>)</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1508931029, "post_id": 46930964, "comment_id": 80809220, "body": "Can you update your question with the Microsoft Word version you use? For Version 2007 and upwards you could protect them with &quot;Content Controls&quot; (<a href=\"https://support.office.com/en-us/article/About-content-controls-283b1e29-0b77-4781-b236-2d02c1cce1c2\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>)"}], "answers": [{"tags": [], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "is_accepted": false, "score": 0, "last_activity_date": 1509090342, "creation_date": 1509090342, "answer_id": 46969975, "question_id": 46930964, "link": "https://stackoverflow.com/questions/46930964/protect-custom-properties-in-word/46969975#46969975", "title": "Protect custom properties in word", "body": "<p>One possibility is to use continuous sections breaks and protect sections, not an ideal solution because then images can not be formatted and so on..</p>\n"}, {"comments": [{"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1509704630, "post_id": 47075714, "comment_id": 81136277, "body": "You can put the field into a Content Control, seems like you can not do that :("}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1510052507, "post_id": 47075714, "comment_id": 81261784, "body": "@skatun any luck with this??"}, {"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1510146959, "post_id": 47075714, "comment_id": 81310188, "body": "I am thinking about it, how i can add it on the flow when i update the custom properties, or if it should only be implemented for new documents, or if I should convert to use Content control instead of CustomProperties. My idea currently is when I do check the text for customvariables, that I then at same time wrap it inside the rich text Content control"}, {"owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "reply_to_user": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1510195354, "post_id": 47075714, "comment_id": 81335263, "body": "In my templates I use a combination of Custom XML - to which the content control can be mapped, and custom property fields in content controls.  I prefer the Custom XML approach but that&#39;s quite different to what you currently have. I think your current idea to retrospectively wrap variables in content controls is workable - I&#39;d suggest closing out this question and opening a new question if required.  Cheers"}, {"owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "edited": false, "score": 0, "creation_date": 1510215616, "post_id": 47075714, "comment_id": 81342596, "body": "I hope to get around to it tomorrow and upload some example code of how to do it..."}], "tags": [], "owner": {"reputation": 2657, "user_id": 3451115, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e2573c41b4c017cf30c84e445778dfa?s=128&d=identicon&r=PG&f=1", "display_name": "SlowLearner", "link": "https://stackoverflow.com/users/3451115/slowlearner"}, "is_accepted": false, "score": 1, "last_activity_date": 1509744668, "last_edit_date": 1509744668, "creation_date": 1509626834, "answer_id": 47075714, "question_id": 46930964, "link": "https://stackoverflow.com/questions/46930964/protect-custom-properties-in-word/47075714#47075714", "title": "Protect custom properties in word", "body": "<p>You can put the field into a Content Control and lock the content control. Users who know enough about MS Word can still delete the content control but they would need to take some fairly deliberate steps to do so <em>(and I'm guessing those people are not the problem)</em>.</p>\n\n<hr>\n\n<p>Normal fields, including document properties, can be added to content controls (probably best to use <em>rich text</em>). </p>\n\n<blockquote>\n  <p>You can put the field into a Content Control, seems like you can not do that :( \u2013 skatun 10 hours ago</p>\n</blockquote>\n\n<p><strong><em>You can totally do it</em></strong>, follow these steps (<em>Word 2010</em>):</p>\n\n<ol>\n<li>Add a custom property to a new blank (even unsaved) document _SlowLearner</li>\n<li>Add a <em>RichText</em> content control from the <em>DeveloperTab</em> </li>\n<li>Click inside the content control</li>\n<li>Insert > Quick Parts > Field</li>\n<li>Filter fields <em>Document Information</em> > select <em>DocProperty</em></li>\n<li>Select property: _SlowLearner > OK</li>\n</ol>\n\n<p><strong>Note:</strong> the field is protected when the Content Control is fully locked. This has the curious side effect that the Content Control does NOT allow the field to update normally... to get around this you need to add some more code to your VBA, like this:</p>\n\n<pre><code>Sub UpdateProtectedField()\n    With ActiveDocument.ContentControls(1)\n        .LockContents = False\n        .Range.Fields(1).Update\n        .LockContents = True\n    End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ec38V.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ec38V.png\" alt=\"Custom Document Property\"></a> <a href=\"https://i.stack.imgur.com/DJomc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DJomc.png\" alt=\"Content Control Properties\"></a> <a href=\"https://i.stack.imgur.com/KMyRQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KMyRQ.png\" alt=\"Insert Field Dialogue\"></a> <a href=\"https://i.stack.imgur.com/2hdJS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2hdJS.png\" alt=\"Field Protected in Content Control\"></a></p>\n"}], "owner": {"reputation": 805, "user_id": 3909356, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/6e04adf8e08c1a4cd812345e602e06af?s=128&d=identicon&r=PG&f=1", "display_name": "skatun", "link": "https://stackoverflow.com/users/3909356/skatun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1509744668, "creation_date": 1508930124, "last_edit_date": 1508935186, "question_id": 46930964, "link": "https://stackoverflow.com/questions/46930964/protect-custom-properties-in-word", "title": "Protect custom properties in word", "body": "<p>We have several templates in Word2016 which uses custom variables, these variables should be updated with my macro, so that data gets pushed to the Database when the user changes them.</p>\n\n<p>Unfortunately we have some users that deletes the variables in the documents(in the text not in the file properties) which means that the database does not get updated. Is there a setting to make custom properties not able to be deleted from the text?</p>\n\n<p>Properties for one example document are listed below\n<a href=\"https://i.stack.imgur.com/2RovY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2RovY.png\" alt=\"enter image description here\"></a></p>\n\n<p>This is how it should look like in the document\n<a href=\"https://i.stack.imgur.com/DY586.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DY586.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then this is what happens sometimes, which should not be allowed\n<a href=\"https://i.stack.imgur.com/BehNi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BehNi.png\" alt=\"enter image description here\"></a></p>\n\n<p>By doing so I do not need to loop through document to find variables, because I can simply loop through custom properties:</p>\n\n<pre><code>Public Sub initializeVariablesFromDB(doc As Document, dokID As String)\n    Dim docProp As Object\n    Dim rowNumber As Integer\n\n    'Get valid properties\n    If CPearson.IsArrayEmpty(Settings.validPropertiesArray) Then\n        Settings.validPropertiesArray = Post.helpRequest(\"xxxxxx?Dok2=1\")\n    End If\n\n    'We create the docid just in case....\n    Call CustomProperties.createCustomDocumentProperty(doc, \"_DocumentID\", dokID)\n\n    'We loop through all custom properties\n    For Each docProp In doc.CustomDocumentProperties\n        rowNumber = CPearson.findRownumber(docProp.name, Settings.validPropertiesArray)\n        If rowNumber &lt;&gt; -1 Then\n            'we clear all SIGN properties...\n            If InStr(UCase(docProp.name), \"SIGN\") &gt; 0 Then\n                docProp.value = \"\"\n            End If\n\n            'We check if we should use value from DB\n            If Settings.validPropertiesArray(rowNumber, 1) = \"0\" Or InStr(UCase(docProp.name), \"DOCUMENTCREATEDDATE\") &gt; 0 _\n                Or InStr(UCase(docProp.name), \"DOCUMENTCREATOR\") &gt; 0 Or InStr(UCase(docProp.name), \"DOCUMENTNAME\") &gt; 0 Then\n\n                'Update from DB\n                Call Post.updateDBFromCustomProperties(docId:=dokID, PropertyName:=docProp.name, whoRules:=\"dBrules\", doc:=doc)\n\n            End If\n        End If\n    Next docProp\nEnd Sub\n</code></pre>\n\n<p>This will fail for the _DocumentSubject in the text, the new value to the property will be collected but is not reflected in the text anymore because the user deleted the variable in the text, can I prevent this?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13, "user_id": 5277299, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a3a23bb6ef8fc3ea39c584b568ab175a?s=128&d=identicon&r=PG&f=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/5277299/alice"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1508931488, "post_id": 46930946, "comment_id": 80809537, "body": "the code is included in the image link, as well as the locals window showing the results."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1508933891, "post_id": 46930946, "comment_id": 80811268, "body": "Nice work @Alice. You may want to consider storing an Arrays of you variables in your Dictionary, instead of a single value.  In this example I added a rowcount that would be incremented while you traverse the recordset: <code>TargetDict.Add SourceName, Array(Cells(RowCount, lcount + 1).Address, Data_to_Duct, Data_to_Did, SourceName, SourceSheet, SourceRange, search_string)</code>."}, {"owner": {"reputation": 13, "user_id": 5277299, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a3a23bb6ef8fc3ea39c584b568ab175a?s=128&d=identicon&r=PG&f=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/5277299/alice"}, "edited": false, "score": 0, "creation_date": 1509115625, "post_id": 46930946, "comment_id": 80903045, "body": "Thank you. I don&#39;t actually need all of that information, but you did just give me the idea to store the actual record array so I can print all of the relevant info instead of going to the file. Awesome! Thank you again!"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5277299, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a3a23bb6ef8fc3ea39c584b568ab175a?s=128&d=identicon&r=PG&f=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/5277299/alice"}, "edited": false, "score": 0, "creation_date": 1508932184, "post_id": 46931541, "comment_id": 80810002, "body": "You are correct about the resume next. And adding the start parameter worked like a charm. THANK YOU!"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 2, "last_activity_date": 1508931789, "creation_date": 1508931789, "answer_id": 46931541, "question_id": 46930946, "link": "https://stackoverflow.com/questions/46930946/instr-not-working-for-closed-workbook-recordset/46931541#46931541", "title": "instr not working for closed workbook recordset", "body": "<p>You have to include the first parameter for Instr if you are going to specify <code>vbTextCompare</code>:</p>\n\n<pre><code>strCompare = Instr(1, find_in, search_string, vbTextCompare)\n</code></pre>\n\n<p>I suspect you've shoved an <code>On Error Resume Next</code> in there and not turned error trapping back on.</p>\n"}], "owner": {"reputation": 13, "user_id": 5277299, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/a3a23bb6ef8fc3ea39c584b568ab175a?s=128&d=identicon&r=PG&f=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/5277299/alice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508931789, "creation_date": 1508930089, "last_edit_date": 1508931598, "question_id": 46930946, "link": "https://stackoverflow.com/questions/46930946/instr-not-working-for-closed-workbook-recordset", "title": "instr not working for closed workbook recordset", "body": "<p>I have a situation where I need to search for a substring across many workbooks. I have no way of knowing which column the string may be in, nor do the workbooks all have the same column headings, so a SQL statement is out of the question, afaik. I'm trying to do an instr, but it's not finding data I know is there. What am I doing wrong?</p>\n\n<p><a href=\"https://i.stack.imgur.com/57al9.png\" rel=\"nofollow noreferrer\">broken instr image</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1508931651, "post_id": 46930925, "comment_id": 80809656, "body": "<code>WorskSheets</code> - is this just a typo in your question?"}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 0, "creation_date": 1508933111, "post_id": 46930925, "comment_id": 80810674, "body": "Instead of <code>ActiveSheet</code> specify the worksheet you mean, e.g. <code>Set SourceSheet = Worksheets(&quot;CSA y REPO Actual&quot;)</code> and <code>SourceSheet.Cells.Select</code> and so forth."}, {"owner": {"reputation": 323, "user_id": 7667649, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/831275645/picture?type=large", "display_name": "Mauro", "link": "https://stackoverflow.com/users/7667649/mauro"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1509101950, "post_id": 46930925, "comment_id": 80894221, "body": "@SJR Yes, sorry."}, {"owner": {"reputation": 323, "user_id": 7667649, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/831275645/picture?type=large", "display_name": "Mauro", "link": "https://stackoverflow.com/users/7667649/mauro"}, "reply_to_user": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 0, "creation_date": 1509102253, "post_id": 46930925, "comment_id": 80894388, "body": "@BensaysNotoPoliticsonSO And how I do to specify it on the instruction <code>Worksheets.Add(After:=Sheets(Worksheets.Count)).Name = &quot;CSA y REPO Actual&quot;</code>?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1509103448, "post_id": 46930925, "comment_id": 80895107, "body": "Can you correct it then please?"}, {"owner": {"reputation": 32382, "user_id": 587803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7431a850a166ca3a648141c532aa9d0?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/587803/ben"}, "edited": false, "score": 0, "creation_date": 1509125086, "post_id": 46930925, "comment_id": 80908296, "body": "In two steps like this: <code>Set MyWorkSheet = WorkSheets.Add(After = Sheets(Worksheets.Count))</code> then <code>MyWorksheet.Name = &quot;Whatever the name is&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1509103878, "creation_date": 1509103878, "answer_id": 46974024, "question_id": 46930925, "link": "https://stackoverflow.com/questions/46930925/vba-worksheet1-activate-instruction-408-error-the-object-doesnt-admit-this/46974024#46974024", "title": "Vba Worksheet(1).Activate instruction: 408 Error (The object doesn&#39;t admit this property or mehtod)", "body": "<p>Read up on how to avoid select and activate. Try this. It's not entirely clear which workbook you are referring to in every case so may need some tweaking.</p>\n\n<pre><code>Sub createSpreadSheet()\n\nDim NewBook As Workbook, szToday\n\nSet NewBook = Workbooks.Add\nszToday = Format(Date - 1, \"YYYYMMDD\")\n\nWith NewBook\n    .Title = \"Informe_Control_Colaterales_ddmmaaaa\"\n    .Subject = \"Informe_Control_Colaterales\"\n    .SaveAs Filename:=\"V:\\Departamento\\7920-SOLVENCIA\\1. Riesgo de Mercado\\2. RIESGO DE CONTRAPARTIDA\\1. REPORTING DIARIO R.Contrapartida\\1. Enviados\\Informe_Control_Colaterales_\" &amp; szToday &amp; \".xls\"\n    .Worksheets(1).Name = \"CSA y REPO Restrospectivoo\"\n\n    ThisWorkbook.Worksheets(1).Range(\"H1\", \"K37\").Copy\n    .Worksheets(\"CSA y REPO Restrospectivoo\").Range(\"A1\").PasteSpecial xlPasteValues\n    .Worksheets(\"CSA y REPO Restrospectivoo\").Range(\"A1\").PasteSpecial xlPasteFormats\n\n    'in the line below not clear which workbook this refers to so may need changing\n    .Worksheets.Add(After:=.Sheets(.Worksheets.Count)).Name = \"CSA y REPO Actual\"\n    ThisWorkbook.Worksheets(\"CSA y REPO Actual\").UsedRange.Copy\n    .Sheets(\"CSA y REPO Actual\").Range(\"A1\").PasteSpecial xlPasteValues\n    .Sheets(\"CSA y REPO Actual\").Range(\"A1\").PasteSpecial xlPasteFormats\n    .Sheets(1).Activate\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 323, "user_id": 7667649, "user_type": "registered", "accept_rate": 74, "profile_image": "https://graph.facebook.com/831275645/picture?type=large", "display_name": "Mauro", "link": "https://stackoverflow.com/users/7667649/mauro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 352, "favorite_count": 0, "accepted_answer_id": 46974024, "answer_count": 1, "score": -1, "last_activity_date": 1509103878, "creation_date": 1508930023, "last_edit_date": 1509103804, "question_id": 46930925, "link": "https://stackoverflow.com/questions/46930925/vba-worksheet1-activate-instruction-408-error-the-object-doesnt-admit-this", "title": "Vba Worksheet(1).Activate instruction: 408 Error (The object doesn&#39;t admit this property or mehtod)", "body": "<p>I have the following code to copy and paste values in another excel spreadsheet: </p>\n\n<pre><code>Sub createSpreadSheet()\n\nSet NewBook = Workbooks.Add\nszToday = Format(Date - 1, \"YYYYMMDD\")\n    With NewBook\n        .Title = \"Informe_Control_Colaterales_ddmmaaaa\"\n        .Subject = \"Informe_Control_Colaterales\"\n        .SaveAs Filename:=\"V:\\Departamento\\7920-SOLVENCIA\\1. Riesgo de Mercado\\2. RIESGO DE CONTRAPARTIDA\\1. REPORTING DIARIO R.Contrapartida\\1. Enviados\\Informe_Control_Colaterales_\" &amp; szToday &amp; \".xls\"\n    End With\n\nThisWorkbook.Worksheets(1).Activate\nRange(\"H1\", \"K37\").Select\nSelection.Copy\nNewBook.WorkSheets(1).Activate\nActiveSheet.Name = \"CSA y REPO Restrospectivoo\"\nActiveSheet.Range(\"A1\").PasteSpecial xlPasteValues\nActiveSheet.Range(\"A1\").PasteSpecial xlPasteFormats\nWorksheets.Add(After:=Sheets(Worksheets.Count)).Name = \"CSA y REPO Actual\"\nThisWorkbook.Worksheets(1).Activate\nNows = \"CSA y REPO Actual\"\nWorksheets(Nows).Activate\nActiveSheet.Cells.Select\nSelection.Copy\nNewBook.Sheets(2).Activate\nActiveSheet.Range(\"A1\").PasteSpecial xlPasteValues\nActiveSheet.Range(\"A1\").PasteSpecial xlPasteFormats\nNewBook.Sheets(1).Activate\n\n\nEnd Sub\n</code></pre>\n\n<p>When it executes the instruction <code>NewBook.WorkSheets(1).Activate</code> I get the error described in the title of this query. I've tried also to put <code>NewBook.Sheets(1).Activate</code>, but in that case the code execution simply ignore the instruction and doesn't activate \"Newbook\" and executes the rest of the code in \"ThisWorkBook\" wrongly.</p>\n\n<p>Could anyone help me?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "edited": false, "score": 0, "creation_date": 1508931201, "post_id": 46931264, "comment_id": 80809337, "body": "Hello Karl, thank you for the suggestion. However, I am pulling in data from about 8 different sources. Plus this dashboard will be used by many people on the network throughout the week (wanting to pull in the most recent data). So creating copies would be fairly laborious. Thanks anyway."}, {"owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "reply_to_user": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "edited": false, "score": 0, "creation_date": 1508932152, "post_id": 46931264, "comment_id": 80809981, "body": "I see, I figured that out right after I posted that this was probably not what you were going for since you could open a read only copy anyhow.  I just attempted get data--&gt; from excel file and imported a sheet to a new book.  Then I opened the source file (not over network though, same user same pc) edited a little and Refresh worked fine and no issues about the file being open.  Perhaps this is because of your office 2010?"}, {"owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "edited": false, "score": 0, "creation_date": 1508934093, "post_id": 46931264, "comment_id": 80811432, "body": "No Problem. Hmm thanks for testing, however, I think it may be caused by different users accessing the same file over a network. I will test it on my end (lock out a file for editing on the network) and then try to query it for data. I&#39;m also looking into using VBA to setup a OLEDB connection to see if it makes a difference! Thanks"}], "tags": [], "owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "is_accepted": false, "score": 0, "last_activity_date": 1508930981, "creation_date": 1508930981, "answer_id": 46931264, "question_id": 46930646, "link": "https://stackoverflow.com/questions/46930646/excel-connection-string-opens-source-workbook-if-locked-for-editing/46931264#46931264", "title": "Excel Connection String Opens Source Workbook If &#39;Locked for Editing&#39;", "body": "<p>A simple workaround would be to copy the file to a temp directory and delete after extracting the data.</p>\n"}], "owner": {"reputation": 348, "user_id": 4526276, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Ss9YJ.jpg?s=128&g=1", "display_name": "Calico", "link": "https://stackoverflow.com/users/4526276/calico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 316, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508930981, "creation_date": 1508929153, "last_edit_date": 1508930683, "question_id": 46930646, "link": "https://stackoverflow.com/questions/46930646/excel-connection-string-opens-source-workbook-if-locked-for-editing", "title": "Excel Connection String Opens Source Workbook If &#39;Locked for Editing&#39;", "body": "<p>I am creating a dashboard which pulls in data from various sources on a network. I have setup Excel 2010 Microsoft Queries to pull in tables of data (used the ribbon menu to set this up).</p>\n\n<pre><code>Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;Data Source=S:\\2017 process\\2017 main tracker.xlsm;Mode=Read;Extended Properties=\"Jet OLEDB:Bypass UserInfo Validation=False;Jet OLEDB:Bypass UserInfo Validation=False;HDR=YES;MODE=READ;READONLY=TRUE;\";Jet OLEDB:System database=\"\";Jet OLEDB:Registry Path=\"\";Jet OLEDB:Engine Type=37;Jet OLEDB:Database Locking Mode=0;Jet OLEDB:Global Partial Bulk Ops=2;Jet OLEDB:Global Bulk Transactions=1;Jet OLEDB:New Database Password=\"\";Jet OLEDB:Create System Database=False;Jet OLEDB:Encrypt Database=False;Jet OLEDB:Don't Copy Locale on Compact=False;Jet OLEDB:Compact Without Replica Repair=False;Jet OLEDB:SFP=False;Jet OLEDB:Support Complex Data=False;Jet OLEDB:Bypass UserInfo Validation=False\n</code></pre>\n\n<p>However, if someone on the network has the file locked open for editing. Then the workbook im trying to connect to will open (in read-only). This is undesirable. I want to pull in the data, without the source workbook opening at all.</p>\n\n<p>Does anyone know how to stop this from happening? I have added <code>MODE=READ;READONLY=TRUE;</code> to the extended properties of the connection string but still no luck. </p>\n\n<p>Any Help is appreciated,</p>\n\n<p>Calico</p>\n"}, {"tags": ["vba", "excel", "basic"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1508931343, "post_id": 46930209, "comment_id": 80809446, "body": "Clearly this is not code that you actually tried.  Please edit your question and clarify what you expect this function to return and how that return value is supposed to be useful to you."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 2721386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c61a2cf3143939a4f6ee77c70a143edc?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2721386/florian"}, "edited": false, "score": 1, "creation_date": 1508928452, "post_id": 46930289, "comment_id": 80807452, "body": "yes, exactly, that&#39;s what my first version of the code looks like  but, if I call the function, it throws an error saying that myVar is not defined at all?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 31, "user_id": 2721386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c61a2cf3143939a4f6ee77c70a143edc?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2721386/florian"}, "edited": false, "score": 0, "creation_date": 1508928559, "post_id": 46930289, "comment_id": 80807520, "body": "@Florian - see the edit and declare in the Sub."}, {"owner": {"reputation": 31, "user_id": 2721386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c61a2cf3143939a4f6ee77c70a143edc?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2721386/florian"}, "edited": false, "score": 1, "creation_date": 1508928795, "post_id": 46930289, "comment_id": 80807666, "body": "ok, thanks very much for your help! That is really cumbersome. Is it correct tot say then that I need to use the same variable name in any function I write as it is declared in the sub?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1508929716, "post_id": 46930289, "comment_id": 80808321, "body": "No, the variable name you use in the <code>TestMe</code> sub can be anything.  <code>AnotherVariableName=5:  Debug.Print myFun(AnotherVariableName)</code> would still work.  The <code>myVar</code> variable in the <code>myFun</code> function would then just hold a reference to the <code>AnotherVariableName</code> variable."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 3, "last_activity_date": 1508928469, "last_edit_date": 1508928469, "creation_date": 1508928177, "answer_id": 46930289, "question_id": 46930209, "link": "https://stackoverflow.com/questions/46930209/vba-problems-with-defining-variables-in-function-if-option-explicit-is-used/46930289#46930289", "title": "VBA: problems with defining variables in function if Option Explicit is used", "body": "<p>You are declaring it twice, if you add <code>Dim myVar as Double</code> in the function <code>myFun</code>. The first time is with that line and the second line is in the parameters here:</p>\n\n<pre><code>Function myFun( myVar as Double) as double\n</code></pre>\n\n<p>That does not have anything to do with <code>Option Explicit</code>, you are not allowed to declare two variables with the same name in the same scope.</p>\n\n<hr>\n\n<p>I suppose your code looks like this:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    'dim myVar as double (uncomment to avoid the error)\n    myVar = 5\n    Debug.Print myFun(myVar)\n\nEnd Sub\n\nFunction myFun(myVar As Double) As Double\n    myVar = myVar + 1\nEnd Function\n</code></pre>\n\n<p>In order to avoid the \"Not declared error\", you should declare <code>myVar</code> in the <code>Sub TestMe</code> and not in the <code>myFun</code> function.</p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 2721386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c61a2cf3143939a4f6ee77c70a143edc?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2721386/florian"}, "edited": false, "score": 0, "creation_date": 1508938731, "post_id": 46930913, "comment_id": 80814880, "body": "thank you very much! I understood everything I need now. This was very helpful"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 1, "last_activity_date": 1508930299, "last_edit_date": 1508930299, "creation_date": 1508929978, "answer_id": 46930913, "question_id": 46930209, "link": "https://stackoverflow.com/questions/46930209/vba-problems-with-defining-variables-in-function-if-option-explicit-is-used/46930913#46930913", "title": "VBA: problems with defining variables in function if Option Explicit is used", "body": "<p>Based on your comment to Vityata's question, let me try a slightly different way of explaining things.</p>\n\n<p>You need to think about the <strong>Scope</strong> of the variable.</p>\n\n<p>Consider that you have two separate procedures:</p>\n\n<p><strong>Procedure 1</strong></p>\n\n<pre><code>Public Sub TestMe()\n    Dim myVar As Double\n    myVar = 5\n    Debug.Print myFun(myVar)\nEnd Sub\n</code></pre>\n\n<p><strong>Procedure 2</strong></p>\n\n<pre><code>Function myFun(myVar As Double) As Double\n    myFun = myVar + 1\nEnd Function\n</code></pre>\n\n<ul>\n<li>The module has <code>Option Explicit</code> at the top</li>\n<li>Your variables are defined within each procedure\n\n<ul>\n<li>The scope of the variable is the procedure</li>\n</ul></li>\n<li>Therefore, each variable needs to be declared within each procedure.</li>\n<li>Even though they have the same names, since the scope of the variable is only within the procedure, they are not the same variables.</li>\n</ul>\n\n<p>If you want to declare a variable, and have it be the same variable in more than one procedure, you need to declare it a module level (for example).</p>\n\n<pre><code>Option Explicit\nPublic myVar As Double\n\nPublic Sub TestMe()\n    myVar = 5\n    myFun myVar\n    Debug.Print myVar\nEnd Sub\n\nFunction myFun(myVar) As Double\n    myVar = myVar + 1\nEnd Function\n</code></pre>\n\n<p>Note also in the two different modules, the <code>Function</code> and the call to the function are subtly different.</p>\n\n<p>As an aside, declaring the variable with the <code>Public</code> keyword at the module level will make it visible to all procedures within the <code>Project</code>.  Declaring it with the <code>Private</code> keyword will make it visible to all procedures in that <code>Module</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 2721386, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c61a2cf3143939a4f6ee77c70a143edc?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2721386/florian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1045, "favorite_count": 0, "closed_date": 1508974688, "answer_count": 2, "score": 0, "last_activity_date": 1518633673, "creation_date": 1508927953, "last_edit_date": 1518633673, "question_id": 46930209, "link": "https://stackoverflow.com/questions/46930209/vba-problems-with-defining-variables-in-function-if-option-explicit-is-used", "closed_reason": "Not suitable for this site", "title": "VBA: problems with defining variables in function if Option Explicit is used", "body": "<p>I have the following problem:</p>\n\n<p><code>Option Explicit</code> is used.</p>\n\n<p>the code</p>\n\n<pre><code>Function myFun( myVar as Double) as double\n    myVar = myVar + 1\nend function\n</code></pre>\n\n<p>throws an error that <code>myVar</code> is not defined</p>\n\n<p>however, if I add the line <code>Dim myVar as Double</code> it says that the variable is declared twice.</p>\n\n<p>What am I doing wrong?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "combobox", "find"], "comments": [{"owner": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1508927116, "post_id": 46929446, "comment_id": 80806608, "body": "If you want it to be fast the <a href=\"https://fastexcel.wordpress.com/2011/10/26/match-vs-find-vs-variant-array-vba-performance-shootout/\" rel=\"nofollow noreferrer\">find solution isn&#39;t the fastest</a>. Other option that isn&#39;t on the link is to use a Dictionary Object"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 1, "creation_date": 1508928549, "post_id": 46929446, "comment_id": 80807515, "body": "My answer to [is it ppossible to use autofilter or find on a dictionary?] (<a href=\"https://stackoverflow.com/questions/39162841/is-it-ppossible-to-use-autofilter-or-find-on-a-dictionary\" title=\"is it ppossible to use autofilter or find on a dictionary\">stackoverflow.com/questions/39162841/&hellip;</a>) does just that."}, {"owner": {"reputation": 9, "user_id": 8830617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XksDEbJO4-4/AAAAAAAAAAI/AAAAAAAAABQ/MJxvyw6LxXc/photo.jpg?sz=128", "display_name": "Gazzah Ghassen", "link": "https://stackoverflow.com/users/8830617/gazzah-ghassen"}, "reply_to_user": {"reputation": 895, "user_id": 7690982, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3391858e255d5aa7f209ecfb3029526c?s=128&d=identicon&r=PG&f=1", "display_name": "danieltakeshi", "link": "https://stackoverflow.com/users/7690982/danieltakeshi"}, "edited": false, "score": 0, "creation_date": 1508933660, "post_id": 46929446, "comment_id": 80811091, "body": "Thank&#39;s for your answers. I update the link of the code&#39;s screenshot.  @danieltakeshi Now i know that &quot;match&quot; is the fastest one but i don&#39;t have time to look and try it."}, {"owner": {"reputation": 9, "user_id": 8830617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XksDEbJO4-4/AAAAAAAAAAI/AAAAAAAAABQ/MJxvyw6LxXc/photo.jpg?sz=128", "display_name": "Gazzah Ghassen", "link": "https://stackoverflow.com/users/8830617/gazzah-ghassen"}, "edited": false, "score": 0, "creation_date": 1508933699, "post_id": 46929446, "comment_id": 80811129, "body": "@ThomasInzina That&#39;s what i&#39;m looking for. Thank&#39;s"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 0, "creation_date": 1508933960, "post_id": 46929446, "comment_id": 80811325, "body": "Awesome!! It&#39;s always makes me feel good when I recycle :)."}], "owner": {"reputation": 9, "user_id": 8830617, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XksDEbJO4-4/AAAAAAAAAAI/AAAAAAAAABQ/MJxvyw6LxXc/photo.jpg?sz=128", "display_name": "Gazzah Ghassen", "link": "https://stackoverflow.com/users/8830617/gazzah-ghassen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 181, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1509100199, "creation_date": 1508925661, "last_edit_date": 1508932832, "question_id": 46929446, "link": "https://stackoverflow.com/questions/46929446/combobox-with-list-find-function-additem-vba-excel", "title": "Combobox with list find function additem vba excel", "body": "<p>Im trying to do a Combobox on VBA Excel that add items depending on the return of find function that look's if what i wrote exist in my worksheet and show the liste of all words that start with what i wrote. \nTo be more clear, i want to create a kind of speed search box.</p>\n\n<p>Here my userForm :<a href=\"http://hpics.li/e1e8123\" rel=\"nofollow noreferrer\">http://hpics.li/e1e8123</a></p>\n\n<p>And here my code\n<a href=\"http://hpics.li/3a8c45a\" rel=\"nofollow noreferrer\">http://hpics.li/3a8c45a</a>\nAny idea? </p>\n\n<p>Thank's </p>\n"}, {"tags": ["vba", "excel", "delimiter"], "comments": [{"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 3, "creation_date": 1508925819, "post_id": 46929365, "comment_id": 80805767, "body": "In your <code>Workbooks.OpenText</code> line change <code>Semicolon:=True</code> to <code>Semicolon:=False</code> and <code>Other:=False</code> to <code>Other:=True, OtherChar=&quot;=&quot;</code>"}, {"owner": {"reputation": 125, "user_id": 4422932, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/13422c2c20bebbbd82bd536fa11d38c5?s=128&d=identicon&r=PG&f=1", "display_name": "Agni", "link": "https://stackoverflow.com/users/4422932/agni"}, "reply_to_user": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 0, "creation_date": 1508925925, "post_id": 46929365, "comment_id": 80805848, "body": "@Tom It works. Thank you"}], "answers": [{"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 2, "last_activity_date": 1508928206, "creation_date": 1508928206, "answer_id": 46930298, "question_id": 46929365, "link": "https://stackoverflow.com/questions/46929365/vba-text-import-with-other-delimiter/46930298#46930298", "title": "VBA text import with other delimiter &quot;=&quot;", "body": "<p>You just need to include your other criteria. This can handle multiple delimiters.</p>\n\n<p>I've updated this changing <code>Other:=False</code> to <code>Other:=True, OtherChar=\"=\"</code></p>\n\n<pre><code>Sub ImportTextFile()\n    'Imports a text file\n    Dim vFileName\n\n    On Error GoTo ErrorHandle\n\n     vFileName = Application.GetOpenFilename()\n\n    'If the user pressed \"Cancel\" or didn't select a text file,\n    'exit the procedure.\n    If vFileName = False Then\n       GoTo BeforeExit\n    End If\n\n    'Switch off screen updating for speed.\n    Application.ScreenUpdating = False\n\n    'We now import the selected text file, and data is\n    'inserted in a new spreadsheet. If you want to use\n    'another delimiter, you must change \"Semicolon:=True\"\n    'to \"Semicolon:=False\" and set another delimiter\n    '(e.g. \"Tab\") to True.\n    Workbooks.OpenText fileName:=vFileName, _\n        Origin:=xlMSDOS, StartRow:=1, DataType:=xlDelimited, TextQualifier:= _\n        xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=True, _\n        Comma:=False, Space:=False, Other:=True, OtherChar:=\"=\", _\n        TrailingMinusNumbers:=True, Local:=True\n\n    'Just to show how we auto adjust the width of column A.\n    Columns(\"A:A\").EntireColumn.AutoFit\n\nBeforeExit:\n    Application.ScreenUpdating = True\n    Exit Sub\nErrorHandle:\n    MsgBox Err.Description\n    Resume BeforeExit\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 4422932, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/13422c2c20bebbbd82bd536fa11d38c5?s=128&d=identicon&r=PG&f=1", "display_name": "Agni", "link": "https://stackoverflow.com/users/4422932/agni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2968, "favorite_count": 0, "accepted_answer_id": 46930298, "answer_count": 1, "score": 0, "last_activity_date": 1508928206, "creation_date": 1508925424, "last_edit_date": 1531164843, "question_id": 46929365, "link": "https://stackoverflow.com/questions/46929365/vba-text-import-with-other-delimiter", "title": "VBA text import with other delimiter &quot;=&quot;", "body": "<p>I have encountered a problem when trying to import a text file into Excel. I wrote a VBA code which perfectly handles the import with the following semicolon delimiter.</p>\n\n<blockquote>\n  <p>;</p>\n</blockquote>\n\n<p>However, when I try to include other delimiter (In my case equal to) also</p>\n\n<blockquote>\n  <p>=</p>\n</blockquote>\n\n<p>It throws me an error.</p>\n\n<blockquote>\n  <p>The method ' Open Text' for the object 'Workbooks' failed. </p>\n</blockquote>\n\n<p>Please find attached my sample text file which usually has an extension .cfg</p>\n\n<pre><code>Dos-001-Zykl_Date_r(V1.0)=1401174131;27.05.2014 07:02:11;\nDos-002-Zykl_Date_r(V1.0)=1401174225;27.05.2014 07:03:45;\n</code></pre>\n\n<p>and its corresponding VBA code</p>\n\n<pre><code>Sub ImportTextFile()\n'Imports a text file\nDim vFileName\n\nOn Error GoTo ErrorHandle\n\n vFileName = Application.GetOpenFilename()\n\n'If the user pressed \"Cancel\" or didn't select a text file,\n'exit the procedure.\nIf vFileName = False Then\n   GoTo BeforeExit\nEnd If\n\n'Switch off screen updating for speed.\nApplication.ScreenUpdating = False\n\n'We now import the selected text file, and data is\n'inserted in a new spreadsheet. If you want to use\n'another delimiter, you must change \"Semicolon:=True\"\n'to \"Semicolon:=False\" and set another delimiter\n'(e.g. \"Tab\") to True.\nWorkbooks.OpenText Filename:=vFileName, _\n    Origin:=xlMSDOS, StartRow:=1, DataType:=xlDelimited, TextQualifier:= _\n    xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=True, _\n    Comma:=False, Space:=False, Other:=False, _\n    TrailingMinusNumbers:=True, Local:=True\n\n'Just to show how we auto adjust the width of column A.\nColumns(\"A:A\").EntireColumn.AutoFit\n\nBeforeExit:\nApplication.ScreenUpdating = True\nExit Sub\nErrorHandle:\nMsgBox Err.Description\nResume BeforeExit\nEnd Sub\n</code></pre>\n\n<p>Suggestions, ideas would be really helpful in solving this issue.</p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["vba", "excel", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 308, "user_id": 8830612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lL5mn.png?s=128&g=1", "display_name": "default_settings", "link": "https://stackoverflow.com/users/8830612/default-settings"}, "edited": false, "score": 1, "creation_date": 1508929552, "post_id": 46929545, "comment_id": 80808228, "body": "Thanks, first line was the right thing and now is working :)  Set mySlide = myPresentation.Slides(SlideNumb)  But the second part, which is for shape adjustments I really need that."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1508925943, "creation_date": 1508925943, "answer_id": 46929545, "question_id": 46929170, "link": "https://stackoverflow.com/questions/46929170/vba-do-not-copy-range-to-ppt/46929545#46929545", "title": "VBA do not copy range to .ppt", "body": "<p>Change this:</p>\n\n<pre><code>Set mySlide = myPresentation.Slides(SlideNumb).Select \n</code></pre>\n\n<p>To this:</p>\n\n<pre><code>Set mySlide = myPresentation.Slides(SlideNumb) \n</code></pre>\n\n<p>Delete this:</p>\n\n<pre><code>    Set myShape = mySlide.Shapes(mySlide.Shapes.Count)\n        myShape.LockAspectRatio = msoFalse\n        myShape.Left = 36.72\n        myShape.Top = 112.32\n        myShape.Width = 854.64\n        myShape.Height = 397.44\n</code></pre>\n\n<p>remove the comments and give it a try again.</p>\n"}], "owner": {"reputation": 308, "user_id": 8830612, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lL5mn.png?s=128&g=1", "display_name": "default_settings", "link": "https://stackoverflow.com/users/8830612/default-settings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 46929545, "answer_count": 1, "score": 2, "last_activity_date": 1519503595, "creation_date": 1508924875, "last_edit_date": 1519503595, "question_id": 46929170, "link": "https://stackoverflow.com/questions/46929170/vba-do-not-copy-range-to-ppt", "title": "VBA do not copy range to .ppt", "body": "<p>I want VBA to paste all the Worksheets into example PPT, which started from particular slide, for example slide NUM.3</p>\n\n<p>However the code which is in use right now, do not paste the selected area into PPT file. Could you help me?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>    For Each ws In ActiveWorkbook.Worksheets\n        ws.Activate\n        Set rng = ThisWorkbook.ActiveSheet.Range(\"A1:Z100\")\n'        Set mySlide = myPresentation.Slides.Add(myPresentation.Slides.Count + 1, 12)\n'        SlideNumb = myPresentation.Slides.Count\n        Set mySlide = myPresentation.Slides(SlideNumb).Select '(myPresentation.Slides.Count + 1, 12) '(myPresentation.Slides.Count + 1, 12)\n        rng.Copy\n        mySlide.Shapes.PasteSpecial DataType:=2  '2 = ppPasteEnhancedMetafile\n        Set myShape = mySlide.Shapes(mySlide.Shapes.Count)\n            myShape.LockAspectRatio = msoFalse\n            myShape.Left = 36.72\n            myShape.Top = 112.32\n            myShape.Width = 854.64\n            myShape.Height = 397.44\n        Application.CutCopyMode = False\n        ShtNum = ShtNum + 1\n        SlideNumb = SlideNumb + 1\n    Next ws\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1508925143, "creation_date": 1508925143, "answer_id": 46929274, "question_id": 46929162, "link": "https://stackoverflow.com/questions/46929162/copying-multiple-columns-from-worksheets-to-a-single-worksheet/46929274#46929274", "title": "Copying Multiple Columns from Worksheets to a single Worksheet", "body": "<p>You could start by recording a <code>macro</code> while you perform these actions manually, and then look at the <code>VBA</code> generated by the macro to find the areas you'd like to automate.  What have you tried so far?</p>\n"}, {"tags": [], "owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "is_accepted": false, "score": 2, "last_activity_date": 1508926891, "last_edit_date": 1508926891, "creation_date": 1508926313, "answer_id": 46929656, "question_id": 46929162, "link": "https://stackoverflow.com/questions/46929162/copying-multiple-columns-from-worksheets-to-a-single-worksheet/46929656#46929656", "title": "Copying Multiple Columns from Worksheets to a single Worksheet", "body": "<ol>\n<li>In your summary sheet, select A1 and type the equal sign.</li>\n<li>select your first day sheet and select K1 and press enter.\n(now the value in K1 in Day1 should be in summary sheet cell A1)</li>\n<li>In summary sheet, drag A1 down to show all data you need.</li>\n<li>Repeat process for all columns in all sheets.</li>\n</ol>\n\n<p>Now you have a working summary sheet that you can copy/paste into your next month summary sheet also instead of repeating the copy/paste process.</p>\n\n<p>PS:  Better yet, choose column I and copy column A to the right until you reach the data in column P.  Then delete the columns you do not need.  You can just copy the Formula in A1 to E1 and change the sheet name in the formula and repeat the process.</p>\n"}], "owner": {"reputation": 11, "user_id": 8830569, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-m6fwbNfatSw/AAAAAAAAAAI/AAAAAAAAAfQ/nNv7gLpFwHU/photo.jpg?sz=128", "display_name": "itsUsman", "link": "https://stackoverflow.com/users/8830569/itsusman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1508926891, "creation_date": 1508924841, "question_id": 46929162, "link": "https://stackoverflow.com/questions/46929162/copying-multiple-columns-from-worksheets-to-a-single-worksheet", "title": "Copying Multiple Columns from Worksheets to a single Worksheet", "body": "<p>I am interested in copying multiple columns from multiple sheets to a single sheet. Basically, I have water utilization data on 22 sheets. Each one of these sheets contains utilization data pertaining to <strong>a particular day in the month</strong> and <strong>all the sheets have the same formatting</strong>. So, I am interested in copying the utilization columns (let's suppose I,K,N and P) from each one of these 22 sheets and then paste it in a summary sheet so that I can have the <strong>utilization data from each day</strong> in a <strong>single sheet</strong>. The output that i'm looking for on my summary sheet is - (columns I,K,N,P - from Day1); (columns I,K,N,P - from Day2) so on and so forth.</p>\n\n<p>I would appreciate any help in this regard. \nMany thanks. :)</p>\n"}, {"tags": ["vba", "excel", "hyperlink", "excel-formula"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1508926435, "post_id": 46929119, "comment_id": 80806179, "body": "Where are the formulas located? All in one column? In specific columns? An image of the data you are working with would help and any formulas/code you have tried so far."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8830595, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9MZ1x6IRl1Y/AAAAAAAAAAI/AAAAAAAABa0/8gWBdc2EgLM/photo.jpg?sz=128", "display_name": "Gabriela Kalibatseva", "link": "https://stackoverflow.com/users/8830595/gabriela-kalibatseva"}, "edited": false, "score": 0, "creation_date": 1509017005, "post_id": 46930107, "comment_id": 80852959, "body": "Thank you QHarr, that works. However now I get a pop up window for all the lines which I created as placeholders for the projects that are not yet there but may occur - for example I have only 15 projects and I have updated the formula to look for another 5. For those 5 I get a pop up message asking which file to open and provide a path. Can I integrate in the VBA a way to always cancel those pop ups?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 21, "user_id": 8830595, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9MZ1x6IRl1Y/AAAAAAAAAAI/AAAAAAAABa0/8gWBdc2EgLM/photo.jpg?sz=128", "display_name": "Gabriela Kalibatseva", "link": "https://stackoverflow.com/users/8830595/gabriela-kalibatseva"}, "edited": false, "score": 0, "creation_date": 1509019827, "post_id": 46930107, "comment_id": 80854859, "body": "I have edited the code and added    Application.EnableEvents = False at start and set to true at end. See if that works and let me know."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1509019793, "last_edit_date": 1509019793, "creation_date": 1508927623, "answer_id": 46930107, "question_id": 46929119, "link": "https://stackoverflow.com/questions/46929119/how-to-update-formulas-referring-to-different-files-wih-the-newest-sheet-added-t/46930107#46930107", "title": "How to update formulas referring to different files wih the newest sheet added to them in Excel", "body": "<p>You could try the following where you run a sub to find formulas that contain a specific string stored in a variable. I am calling it FindMonth. You search and replace this string with the desired month, ReplaceMonth. Note i am including the end part of the year to the string e.g. \"Nov 17\". When running each month you just edit these two lines: </p>\n\n<pre><code> FindMonth = \"Oct 17\" 'Edit for month you want to find\n ReplaceMonth = \"Nov 17\" 'Edit for month you want to replace with\n</code></pre>\n\n<p>You could associate the procedure with a command button and use inputbox prompts for the FindMonth and ReplaceMonth and assign the value input to the variables instead.</p>\n\n<p>You define the area for replacement in the Set searchRange. \nAs i don't know what area you are searching i have used 2 functions by Ron De Bruin to find the last used row and column in the sheet variable ws (you would amend to the sheet you want to change formulas in) and said the search range is from A1 to the last used cell i.e. lastrow, lastcolumn. </p>\n\n<pre><code> Set searchRange = ws.Range(ws.Cells(1, 1), ws.Cells(LastRow(ws), LastCol(ws)))\n</code></pre>\n\n<p>This is to prevent looping through every cell in the sheet.</p>\n\n<p>You would need to amend to which ever sheet you are actually replacing in.</p>\n\n<p>Also, consider what kind of error handling you want to include in case lookup sheet is not present in lookup workbook (e.g.Dec 17 sheet missing) or workbook is not open...... I have used <code>On Error Resume Next</code> for now. You might choose something like <code>On Error GoTo ErrHandler</code> and in the ErrHandler have a <code>CASE Err.Number 1004 ...do something........</code></p>\n\n<pre><code>  Option Explicit\n\n\n  Sub ReplaceFormula()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Sheet1\") ' change as appropriate to your sheet name\n\n    Dim searchRange As Range\n    Dim cell As Range\n\n    Dim FindMonth As String\n    Dim ReplaceMonth As String\n\n    FindMonth = \"Oct 17\"\n    ReplaceMonth = \"Nov 17\"\n\n    Set searchRange = ws.Range(ws.Cells(1, 1), ws.Cells(LastRow(ws), LastCol(ws)))\n\n    Application.EnableEvents = False\n\n    On Error Resume Next 'Sheet may not be present or source workbook may not be open\n\n    For Each cell In searchRange.Cells\n\n        If InStr(1, cell.Formula, FindMonth) &gt; 0 Then cell.Formula = Replace(cell.Formula, FindMonth, ReplaceMonth)\n\n    Next cell\n\n    On Error GoTo 0\n\n    Application.EnableEvents = True\n\nEnd Sub\n\nFunction LastRow(sh As Worksheet)\n    On Error Resume Next\n    LastRow = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            LookAt:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByRows, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n\n\nFunction LastCol(sh As Worksheet)\n    On Error Resume Next\n    LastCol = sh.Cells.Find(What:=\"*\", _\n                            After:=sh.Range(\"A1\"), _\n                            LookAt:=xlPart, _\n                            LookIn:=xlFormulas, _\n                            SearchOrder:=xlByColumns, _\n                            SearchDirection:=xlPrevious, _\n                            MatchCase:=False).Column\n    On Error GoTo 0\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 973, "user_id": 5272999, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSlFj.jpg?s=128&g=1", "display_name": "Bernard", "link": "https://stackoverflow.com/users/5272999/bernard"}, "is_accepted": false, "score": 0, "last_activity_date": 1508930086, "creation_date": 1508930086, "answer_id": 46930944, "question_id": 46929119, "link": "https://stackoverflow.com/questions/46929119/how-to-update-formulas-referring-to-different-files-wih-the-newest-sheet-added-t/46930944#46930944", "title": "How to update formulas referring to different files wih the newest sheet added to them in Excel", "body": "<p>I typically do a find replace for this - I also have a monthly job where I have this scenario. (You can restrict the search replace to highlighted cells if required).\nAlso, the reference to the directory should dissappear if you load the files in memory.\nWith the above info you could script this - I do find the search replace takes a few seconds of a multi-hour job so I haven't bothered automating. Hit F2 and select what you want to replace and paste that into the find box (e.g. <code>]Oct 17</code> and then replace with <code>]Nov 17</code></p>\n"}], "owner": {"reputation": 21, "user_id": 8830595, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9MZ1x6IRl1Y/AAAAAAAAAAI/AAAAAAAABa0/8gWBdc2EgLM/photo.jpg?sz=128", "display_name": "Gabriela Kalibatseva", "link": "https://stackoverflow.com/users/8830595/gabriela-kalibatseva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1509019793, "creation_date": 1508924682, "last_edit_date": 1508932135, "question_id": 46929119, "link": "https://stackoverflow.com/questions/46929119/how-to-update-formulas-referring-to-different-files-wih-the-newest-sheet-added-t", "title": "How to update formulas referring to different files wih the newest sheet added to them in Excel", "body": "<p>I have several Excel files that represent Projects. Every month there is a new sheet that appears with the updated information for the current month. I need to combine them in one sheet as a summery overview. </p>\n\n<p>My problem comes when from the fact that I am downloading the project files on my PC and the formula dragging information from them refers to the folder and the sheet. Let's say now we are in October and the formula is: </p>\n\n<pre><code>IFERROR('[Project (1).xlsm]Oct 17'!$E$24;\" \"). \n</code></pre>\n\n<p>However, when November comes I will need to update Oct 17 to Nov 17 which is huge manual work.</p>\n\n<p>Is there a way to do that with a drop down menu related to some VBA macro? For example there is an Intro page on which you can choose from a drop down menu the certain month and all the formula paths are updated based on that.</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1508924708, "post_id": 46928994, "comment_id": 80804927, "body": "You can use <code>IsEmpty</code> function to check if the cell is empty."}, {"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "reply_to_user": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1508926180, "post_id": 46928994, "comment_id": 80806000, "body": "@Egan Wolf Edited the question."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1508926748, "post_id": 46928994, "comment_id": 80806378, "body": "<code>WorksheetFunction.VLookup</code> does not return 0 if the lookup cell is empty. Only if you attempt to store the result in a number variable, will it be converted to 0."}, {"owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "edited": false, "score": 0, "creation_date": 1508927614, "post_id": 46928994, "comment_id": 80806934, "body": "@Ans Can you show (at least) the line of your code that uses a <code>VLookup</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 0, "creation_date": 1508926409, "post_id": 46929418, "comment_id": 80806160, "body": "Don&#39;t know the <code>currentCell</code>&#39;s address, so it&#39;s useless. I can only play around with Vlookup result."}, {"owner": {"reputation": 158, "user_id": 2794327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36471432ab0c7779ea037601058ab197?s=128&d=identicon&r=PG&f=1", "display_name": "Arjeel", "link": "https://stackoverflow.com/users/2794327/arjeel"}, "reply_to_user": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "edited": false, "score": 1, "creation_date": 1508926627, "post_id": 46929418, "comment_id": 80806305, "body": "Could you please share your code, the point being , you are putting the result of vlookup somewhere, that must give address. Or, it may be the case that I&#39;m missing something. Sharing code will be of great help."}], "tags": [], "owner": {"reputation": 158, "user_id": 2794327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36471432ab0c7779ea037601058ab197?s=128&d=identicon&r=PG&f=1", "display_name": "Arjeel", "link": "https://stackoverflow.com/users/2794327/arjeel"}, "is_accepted": false, "score": 0, "last_activity_date": 1508925594, "creation_date": 1508925594, "answer_id": 46929418, "question_id": 46928994, "link": "https://stackoverflow.com/questions/46928994/excel-vba-check-if-vlookup-returns-empty-value-given-that-vlookup-substitutes/46929418#46929418", "title": "Excel vba: check if VLookup returns empty value, given that Vlookup substitutes empty with zero", "body": "<p>I am not sure but I think using IF, ISEmpty will solve your problem.</p>\n\n<p>Use WorksheetFunction.Match to get cell address</p>\n\n<pre><code>currentCell= the cell in which you'll be putting value\nconcernedCell=The cell which can be empty\n\nIf(Isempty(concernedCell)) Then\ncurrentCell.value=-1\nElse\ncurrentCell.value=concernedCell.value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": false, "score": 1, "last_activity_date": 1508928794, "creation_date": 1508928794, "answer_id": 46930516, "question_id": 46928994, "link": "https://stackoverflow.com/questions/46928994/excel-vba-check-if-vlookup-returns-empty-value-given-that-vlookup-substitutes/46930516#46930516", "title": "Excel vba: check if VLookup returns empty value, given that Vlookup substitutes empty with zero", "body": "<p>You can check if VLOOKUP returns an empty cell.  </p>\n\n<p>As a worksheet formula you can use:  <code>=IF(VLOOKUP(K9,$F$2:$G$6,2,FALSE)=\"\",-1,VLOOKUP(K9,$F$2:$G$6,2,FALSE))</code>  </p>\n\n<p>As a VBA example you could use:  </p>\n\n<pre><code>Public Function MyVlookup(lookup_value, table_array As Range, col_index_num As Long, Optional range_lookup As Boolean = False) As Variant\n\n    Dim ReturnValue As Variant\n\n    ReturnValue = WorksheetFunction.VLookup(lookup_value, table_array, col_index_num, range_lookup)\n\n    If IsEmpty(ReturnValue) Then\n        MyVlookup = -1\n    Else\n        MyVlookup = ReturnValue\n    End If\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "is_accepted": true, "score": 0, "last_activity_date": 1508932236, "creation_date": 1508932236, "answer_id": 46931702, "question_id": 46928994, "link": "https://stackoverflow.com/questions/46928994/excel-vba-check-if-vlookup-returns-empty-value-given-that-vlookup-substitutes/46931702#46931702", "title": "Excel vba: check if VLookup returns empty value, given that Vlookup substitutes empty with zero", "body": "<p>Worked <a href=\"https://superuser.com/a/571018/769268\">this answer</a></p>\n\n<p><code>=if(len(vlookup(a2,f$2:g$20,2))=0,\"\",vlookup(a2,f$2:g$20,2))</code></p>\n\n<p>The trick is to use any checking functions not on <code>result = VLookup(...)</code> but rather on <code>VLookup</code> itself, before it had time to change emptiness to zero.</p>\n"}], "owner": {"reputation": 1144, "user_id": 8052882, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c5179af1efcb9a5ff24eff57853a605?s=128&d=identicon&r=PG&f=1", "display_name": "Ans", "link": "https://stackoverflow.com/users/8052882/ans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4963, "favorite_count": 0, "accepted_answer_id": 46931702, "answer_count": 3, "score": 0, "last_activity_date": 1508932236, "creation_date": 1508924336, "last_edit_date": 1508926094, "question_id": 46928994, "link": "https://stackoverflow.com/questions/46928994/excel-vba-check-if-vlookup-returns-empty-value-given-that-vlookup-substitutes", "title": "Excel vba: check if VLookup returns empty value, given that Vlookup substitutes empty with zero", "body": "<p>So I have a table for different regions and corresponding values for different years 2014-2017. Not all regions have value for the year 2017. However, if I make a <code>WorksheetFunction.VLookup(...)</code> it will return 0 if the cell in question is empty. </p>\n\n<p>I need to put my special value (-1) instead of 0 if the cell for a given region is empty, however, I can't differentiate between real zeroes and zeroes <code>Vlookup</code> returns instead of empty values. How would I do it?</p>\n\n<p><strong>EDIT</strong>: I can't use <code>IsEmpty</code> on individual cells, because I <strong>don't know</strong> the result's cell's address - I loop though them in a cycle without even knowing a first argument's address. All I have is the result - either a real or a fake zero.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 7320782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4970245428f1a8b403051b2ac21ac8cd?s=128&d=identicon&r=PG&f=1", "display_name": "ewuchatka", "link": "https://stackoverflow.com/users/7320782/ewuchatka"}, "edited": false, "score": 1, "creation_date": 1508925609, "post_id": 46928951, "comment_id": 80805614, "body": "Hi @Vityata, this is great and indeed this is what I asked for, however, is it easy to modify so that that Clearhappens on the re-enter to Sheet1? Currently upon the selection in dropdowns in Sheet1 a Sheet2 is filtered based on A1 and A2 selections, so if I clear dropdowns immediately after leaving Sheet 1, the filter doesn&#39;t work. Thanks a lot :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 33, "user_id": 7320782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4970245428f1a8b403051b2ac21ac8cd?s=128&d=identicon&r=PG&f=1", "display_name": "ewuchatka", "link": "https://stackoverflow.com/users/7320782/ewuchatka"}, "edited": false, "score": 0, "creation_date": 1508925777, "post_id": 46928951, "comment_id": 80805744, "body": "@ewuchatka - put a condition like <code>If Sh.Name &lt;&gt; &quot;TheSpecialOne&quot; then exit sub</code>."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1508924222, "creation_date": 1508924222, "answer_id": 46928951, "question_id": 46928843, "link": "https://stackoverflow.com/questions/46928843/clearing-two-cells-when-i-leave-re-enter-the-tab-tab/46928951#46928951", "title": "Clearing two cells when I leave/re-enter the tab tab", "body": "<p>Write the following event in <code>ThisWorkbook</code>:</p>\n\n<pre><code>Private Sub Workbook_SheetActivate(ByVal Sh As Object)\n    Worksheets(\"TheSpecialOne\").Range(\"A1:A2\").Clear\nEnd Sub\n</code></pre>\n\n<p>It will clear the <code>A1:A2</code>, for the sheet named \"TheSpecialOne\". Write the code here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zry2Y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zry2Y.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 33, "user_id": 7320782, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4970245428f1a8b403051b2ac21ac8cd?s=128&d=identicon&r=PG&f=1", "display_name": "ewuchatka", "link": "https://stackoverflow.com/users/7320782/ewuchatka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 46928951, "answer_count": 1, "score": 0, "last_activity_date": 1508924222, "creation_date": 1508923948, "last_edit_date": 1531164843, "question_id": 46928843, "link": "https://stackoverflow.com/questions/46928843/clearing-two-cells-when-i-leave-re-enter-the-tab-tab", "title": "Clearing two cells when I leave/re-enter the tab tab", "body": "<p>I tried browsing online but no luck.</p>\n\n<p>I would like to clear cell A1 and A2 (dropdown but this shouldn't matter) in Sheet1 upon leaving Sheet1 and moving to any other Sheet within the workbook. How can I do it? </p>\n\n<p>Thanks</p>\n\n<p>Ewa</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1508924684, "post_id": 46928839, "comment_id": 80804911, "body": "Have you tried <code>Set Loc = ActiveSheet.Range(&quot;B2:B10&quot;).Find(48987, LookIn:=xlformulas)</code>? It&#39;s usually a good idea to specify more of the parameters such as searchformat."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508924921, "post_id": 46928839, "comment_id": 80805098, "body": "What happens when you select the <code>48987</code> and you write <code>?selection</code> in the immediate window?"}, {"owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508924997, "post_id": 46928839, "comment_id": 80805155, "body": "@Vityata it gives 48987"}, {"owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1508925044, "post_id": 46928839, "comment_id": 80805178, "body": "@SJR I thought I had tried that but xlformulas does work! I wonder why though"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508925434, "post_id": 46928839, "comment_id": 80805491, "body": "That is strange. What happens if you open a new excel file and manually write 48987 and try to get it through find?"}, {"owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1508925590, "post_id": 46928839, "comment_id": 80805595, "body": "@Vityata That is exactly what I had done. I had a code written by me which was not working so to figure it out I checked every segment in a new excel file. After finding the problem I simplified it and posted it on stackoverflow"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1508925941, "post_id": 46928839, "comment_id": 80805855, "body": "I think Formulas ignores formatting (so if comparing with the properties of a range is more comparable to <code>Value</code>) whereas Values does not (so is actually more comparable to the <code>Text</code> property). Have to say that when I just googled this, there is surprisingly little clear guidance. The lesson seems to be that Formulas is preferable in most cases as it searches contents and formulas."}, {"owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1508926228, "post_id": 46928839, "comment_id": 80806041, "body": "@SJR Exactly even I kind of knew what the problem was, but I couldn&#39;t find much online. Thanks a lot for your help! and I think you should post that as an answer instead of a comment"}], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1508926669, "creation_date": 1508926669, "answer_id": 46929770, "question_id": 46928839, "link": "https://stackoverflow.com/questions/46928839/find-is-not-looking-in-values/46929770#46929770", "title": ".Find is not looking in values", "body": "<p>Since you asked ...</p>\n\n<p>When using the <code>Find</code> method and its <code>LookIn</code> parameter, <code>xlFormulas</code> ignores formatting (so if comparing with a range is more comparable to the <code>Value</code> property) whereas <code>xlValues</code> does not (so is actually more comparable to the <code>Text</code> property). Therefore, in most cases <code>xlFormulas</code> is preferable as it searches contents and formulas.</p>\n\n<p>It's also good practice to specify other <code>Find</code> parameters as they can be inadvertently changed (via the worksheet) and may not be set to the values you expect.</p>\n"}], "owner": {"reputation": 1328, "user_id": 3625350, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7681bb9c5891b48d06ce43c6a847001?s=128&d=identicon&r=PG&f=1", "display_name": "Raunak Thomas", "link": "https://stackoverflow.com/users/3625350/raunak-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 46929770, "answer_count": 1, "score": 0, "last_activity_date": 1508926669, "creation_date": 1508923927, "question_id": 46928839, "link": "https://stackoverflow.com/questions/46928839/find-is-not-looking-in-values", "title": ".Find is not looking in values", "body": "<p>For some weird reason when cell B3 has a value \"48987\" and it is formatted as general (number, not string because it is right aligned) the <code>find</code> function works but when it is formatted as a comma separated number, the <code>find</code> function is unable to find it. The code given below is what I'm trying.</p>\n\n<pre><code>Set Loc = ActiveSheet.Range(\"B2:B10\").Find(\"48987\", LookIn:=xlValues)\nIf Not (Loc Is Nothing) Then\n   Debug.Print Loc.Address\nEnd If\n</code></pre>\n\n<p><strong>Note:</strong> I've tried with/without double quotes and the lookin options</p>\n\n<p>But the moment I change the code to the one given below it works!!</p>\n\n<pre><code>Set Loc = ActiveSheet.Range(\"B2:B10\").Find(\"48,987\", LookIn:=xlValues)\n</code></pre>\n\n<p>I've restarted my system and done a lot of search but I'm unable to find a solution. This happens with dates because they are stored as an integer in excel but I don't know why this would happen with a number. Plus the same cell does get detected when I change the condition</p>\n"}, {"tags": ["arrays", "vba", "excel", "combobox"], "comments": [{"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1508927566, "post_id": 46928606, "comment_id": 80806896, "body": "Is the issue just in your reports? Why don&#39;t you try downloading Power BI (free) and have a play"}, {"owner": {"reputation": 21, "user_id": 8826766, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OL8dhwtsrbk/AAAAAAAAAAI/AAAAAAAAAAc/EM-pk7RuVVw/photo.jpg?sz=128", "display_name": "Agustin Prats", "link": "https://stackoverflow.com/users/8826766/agustin-prats"}, "reply_to_user": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1509022409, "post_id": 46928606, "comment_id": 80856769, "body": "Never heard about it before tbh. It looks quite good. That said, if anyone comes across a problem like this. I&#39;ve come with what it seems a solution (actually a colleague of mine did). Instead of using array formulas we&#39;re using INDIRECT which also allows to have the client as a variable."}], "owner": {"reputation": 21, "user_id": 8826766, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OL8dhwtsrbk/AAAAAAAAAAI/AAAAAAAAAAc/EM-pk7RuVVw/photo.jpg?sz=128", "display_name": "Agustin Prats", "link": "https://stackoverflow.com/users/8826766/agustin-prats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1508926615, "creation_date": 1508923322, "last_edit_date": 1508926615, "question_id": 46928606, "link": "https://stackoverflow.com/questions/46928606/excel-scalability-and-speed-issues-vba-array-and-comboboxes", "title": "Excel Scalability and Speed Issues (VBA, Array and Comboboxes)", "body": "<p><strong>Context</strong></p>\n\n<p>There are two excel.workbooks in the same location: database and dashboards. Whereas database.workbook has as many tabs as clients I manage, dashboard.workbook has as many tabs as reports are required. </p>\n\n<p>Navigation across report's (dashboard.worksheets) it's pretty simple. On each report there's a combobox that contains every dashboard.worksheets' names. Selecting any report on that combobox hides the current worksheet/report and open the desired one.</p>\n\n<p>In each tab/report there is a second combobox that allows you to select a client, populating the report with the selected client's data. </p>\n\n<p><strong>The report</strong></p>\n\n<p>The information in the database looks like this: \nDate|Device|Group|Subgroup|metric1|metric2|metric3|etc.</p>\n\n<p>The information displayed in the report (in the one I'm having issues with) looks like this:\nGroup|metric1|2|3|...</p>\n\n<p><strong>The issues</strong></p>\n\n<p><strong>1)</strong> Currently the group is displayed like this: </p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>=IFERROR(LOOKUP(2,1/(COUNTIF($C$17:C18,IF($C$8=\"Goldsmiths\",Client1_GroupName,IF($C$8=\"Client2\",Client2_GroupName,IF($C$8=\"Client3\",Client3_GroupName,IF($C$8=\"Client4\",Client4_GroupName)))))=0),IF($C$8=\"Client1\",Client1_GroupName,IF($C$8=\"Client2\",Client2_GroupName,IF($C$8=\"Client3\",Z2,Client3_GroupName($C$8=\"Client4\",Client4_GroupName))))),\"\")</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<ul>\n<li>The combobox prints its value into Range(\"C8\"). Through a nested ifs structure the formula identifies the client and then pulls a unique list of groups from the selected client tab (from database.workbook). </li>\n<li>One issue is that it is very messy and hard to escalate (the more clients I get, its complexity growth exponentially). I bet there are easiest ways to do it (maybe VBA?).</li>\n<li>It can be quite slow, the more \"groups\" we get and more days recorded into the database, more slow it will get. </li>\n</ul>\n\n<p><strong>2)</strong> Pulling the data\nMost of the data to pull can be done through array formulas like this one:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>={SUM((Client1_GroupName=C20)*Metric1)}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<ul>\n<li>It sums all the Metric1 for the <em>group</em> matching C20,C21,22,23 (in that c20:xx range we have the first formula pulling the Group list.</li>\n<li>I haven't added the nested ifs yet. It's going to be a pain to do it across 5 more columns. Again very hard to escalate.</li>\n<li>This can be terribly slow. It comes a point that changing client means waiting 2 or 3 minutes to process the array. </li>\n</ul>\n\n<p><strong>Conclusions</strong></p>\n\n<p>I guess what I'm seeking is some advice on how to face this issues, which essentially are: scalability and speed. </p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508923181, "post_id": 46928432, "comment_id": 80803839, "body": "You haven&#39;t given any indication what is in those variables..."}, {"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508925460, "post_id": 46928432, "comment_id": 80805510, "body": "These variables contain the sheet names and ranges."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1508926518, "post_id": 46928432, "comment_id": 80806233, "body": "That really doesn&#39;t help. You need to at least show us the declaration and assignment lines."}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1508925409, "post_id": 46928568, "comment_id": 80805472, "body": "Thanks, could you please help me to apply loops in this pivot table like I need to take all the row labels so how it can be implemented."}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "reply_to_user": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "edited": false, "score": 0, "creation_date": 1508925526, "post_id": 46928568, "comment_id": 80805555, "body": "@yashikavaish you need to show your code , and you PivotTable structure"}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 1, "last_activity_date": 1508923204, "creation_date": 1508923204, "answer_id": 46928568, "question_id": 46928432, "link": "https://stackoverflow.com/questions/46928432/issue-in-creating-pivot-table-through-vba/46928568#46928568", "title": "Issue in Creating Pivot table through VBA", "body": "<p>Hopefully, all of your objects are defined and set correctly (as in my code below).</p>\n\n<pre><code>Option Explicit\n\nSub CreatAutoPivot()\n\nDim myPivotTable As PivotTable\nDim myPivotCache As PivotCache\nDim myDestinationWorksheet As Worksheet\nDim mySourceData As Range\nDim myDestinationRange As Range\n\n' === set of Parameters I've given my objects: for internal tests ===\nSet myDestinationWorksheet = ThisWorkbook.Sheets(\"Pivot_Sht\") ' modify according to your sheet's name\nSet myDestinationRange = myDestinationWorksheet.Range(\"A1\") ' modify to where you want to place your Pivot-Table\n\nSet mySourceData = ThisWorkbook.Sheets(\"Pivot_Data\").Range(\"A1:E10\")  ' modify according to your Source Data Range and worksheet's name\n\n' set the Pivot Cache\nSet myPivotCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=mySourceData.Address(False, False, xlA1, xlExternal))\n\n' set the Pivot Table\nSet myPivotTable = myDestinationWorksheet.PivotTables.Add(PivotCache:=myPivotCache, TableDestination:=myDestinationRange, TableName:=\"Sheet1NewSheet\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 158, "user_id": 2794327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36471432ab0c7779ea037601058ab197?s=128&d=identicon&r=PG&f=1", "display_name": "Arjeel", "link": "https://stackoverflow.com/users/2794327/arjeel"}, "is_accepted": true, "score": 1, "last_activity_date": 1508927023, "creation_date": 1508927023, "answer_id": 46929890, "question_id": 46928432, "link": "https://stackoverflow.com/questions/46928432/issue-in-creating-pivot-table-through-vba/46929890#46929890", "title": "Issue in Creating Pivot table through VBA", "body": "<p>Faced Similar situation, found this code somewhere on web long back. Credits to the unknown person.   </p>\n\n<pre><code>Dim PSheet As Worksheet\n    Dim DSheet As Worksheet\n    Dim PCache As PivotCache\n\n\n\n\nDim PTable As PivotTable\n    Dim PRange As Range\n    Dim LastRow As Long\n    Dim LastCol As Long\n\n'Delete Preivous Pivot Table Worksheet &amp; Insert a New Blank Worksheet With Same Name\nOn Error Resume Next\nApplication.DisplayAlerts = False\nWorksheets(\"PivotTable\").Delete\nSheets.Add Before:=ActiveSheet\nActiveSheet.Name = \"PivotTable\"\nApplication.DisplayAlerts = True\nSet PSheet = Worksheets(\"PivotTable\")\nSet DSheet = Worksheets(\"Raw Data\")\n\n'Define Data Range\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n'Define Pivot Cache\nSet PCache = ActiveWorkbook.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=PRange). _\nCreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\nTableName:=\"PRIMEPivotTable\")\n\n'Insert Blank Pivot Table\nSet PTable = PCache.CreatePivotTable_(TableDestination:=PSheet.Cells(1, 1), TableName:=\"PRIMEPivotTable\")\n\n'Insert Column Fields\n'With ActiveSheet.PivotTables(\"PRIMEPivotTable\").PivotFields(\"Ageing\")\n '.Orientation = xlColumnField\n '.Position = 1\n'End With\n\n'Insert Row Fields\nWith ActiveSheet.PivotTables(\"PRIMEPivotTable\").PivotFields(\"Eid\")\n .Orientation = xlRowField\n .Position = 1\nEnd With\n\n'Insert Data Field\nWith ActiveSheet.PivotTables(\"PRIMEPivotTable\").PivotFields(\"Eid\")\n .Orientation = xlDataField\n .Position = 1\n .Function = xlCount\n .Name = \"Name of ur choice\"\nEnd With\n\n'Format Pivot Table\nActiveSheet.PivotTables(\"PRIMEPivotTable\").ShowTableStyleRowStripes = True\nActiveSheet.PivotTables(\"PRIMEPivotTable\").TableStyle2 = \"PivotStyleMedium9\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 5658623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/589f4ad1339d6763ea2cd54aa2cc5bdd?s=128&d=identicon&r=PG&f=1", "display_name": "yashika vaish", "link": "https://stackoverflow.com/users/5658623/yashika-vaish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 46929890, "answer_count": 2, "score": 0, "last_activity_date": 1508944025, "creation_date": 1508922812, "last_edit_date": 1508944025, "question_id": 46928432, "link": "https://stackoverflow.com/questions/46928432/issue-in-creating-pivot-table-through-vba", "title": "Issue in Creating Pivot table through VBA", "body": "<pre><code>Set myPivotTable = ActiveWorkbook.PivotCaches.Create(\n  SourceType:=xlDatabase, \n  SourceData:=mySourceWorksheet.Name &amp; \"!\" &amp; mySourceData).CreatePivotTable(\n    TableDestination:=myDestinationWorksheet.Name &amp; \"!\" &amp; myDestinationRange, \n    TableName:=\"Sheet1NewSheet\")\n</code></pre>\n\n<p>The above code gives me </p>\n\n<blockquote>\n  <p>runtime error 5 that invalid procedure call or argument.</p>\n</blockquote>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1508922651, "creation_date": 1508922651, "answer_id": 46928375, "question_id": 46928262, "link": "https://stackoverflow.com/questions/46928262/old-text-in-one-color-new-text-in-another-color-excel-vba/46928375#46928375", "title": "Old text in one color, new text in another color. Excel VBA", "body": "<p>Whenever you run it, the cells with values on the activesheet will be blue and on the empty cells you will be writing in black:</p>\n\n<pre><code>Public Sub TestMe()\n\n    Cells.Font.Color = vbBlack\n    ActiveSheet.UsedRange.Font.Color = vbBlue\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 535, "user_id": 4980705, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cfb8a28439044578ba741915bbd61698?s=128&d=identicon&r=PG&f=1", "display_name": "peetman", "link": "https://stackoverflow.com/users/4980705/peetman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508922651, "creation_date": 1508922302, "question_id": 46928262, "link": "https://stackoverflow.com/questions/46928262/old-text-in-one-color-new-text-in-another-color-excel-vba", "title": "Old text in one color, new text in another color. Excel VBA", "body": "<p>Each day there is a new worksheet where I write some notes. I would like to have a button that creates a new worksheet everyday, puts the old text in black and when I start writing new text (can be in a cell with text already) it should be blue.\nIs there a way to do that? I can use VBA as well.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1508922694, "post_id": 46927784, "comment_id": 80803476, "body": "If you want to use a VBA based solution, you can read my answer and code below"}], "answers": [{"comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1508921811, "post_id": 46928065, "comment_id": 80802884, "body": "very fast, nice :)"}, {"owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "reply_to_user": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1508923283, "post_id": 46928065, "comment_id": 80803904, "body": "Thanks!  And I had to convert my locale ; to , which was a the most confusing part on this one... the whole thing is just commas, dots and quotation marks :) Yours is very impressive!"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1508923475, "post_id": 46928065, "comment_id": 80804026, "body": "Thanks, mine is longer, but if you don&#39;t want to keep formulas in a worksheet, it&#39;s a fast solution"}], "tags": [], "owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "is_accepted": true, "score": 2, "last_activity_date": 1508921743, "creation_date": 1508921743, "answer_id": 46928065, "question_id": 46927784, "link": "https://stackoverflow.com/questions/46927784/replace-comma-with-dot-only-at-particular-location-in-the-string/46928065#46928065", "title": "Replace comma(,) with dot(.) only at particular location in the string", "body": "<p>if your text is in cell A1:</p>\n\n<pre><code>=SUBSTITUTE(SUBSTITUTE(A1,\",\",\".\",2),\",\",\".\",3)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1508922623, "creation_date": 1508922623, "answer_id": 46928360, "question_id": 46927784, "link": "https://stackoverflow.com/questions/46927784/replace-comma-with-dot-only-at-particular-location-in-the-string/46928360#46928360", "title": "Replace comma(,) with dot(.) only at particular location in the string", "body": "<p>If you want to use a VBA solution, you can try the code below.</p>\n\n<p>It might seem a little long, but it's very fast to execute since there is little \"messing\" with the worksheet, and most of the logic is done on Arrays.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nSub ImportCsvContents()\n\nDim csvLines As Variant, CurrentRow As Variant\nDim LastRow As Long, i As Long\n\nReDim csvLines(0)\n\nWith Worksheets(1)\n    LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n    ' === logic, each order ends with data data in column \"B\" ===\n    For i = 1 To LastRow\n        csvLines(UBound(csvLines)) = .Range(\"A\" &amp; i).Value\n        ReDim Preserve csvLines(UBound(csvLines) + 1) ' keep record and raise array index by 1\n    Next i\nEnd With\n\n' resize array to actual populated size\nIf csvLines(UBound(csvLines)) = \"\" Then\n    ReDim Preserve csvLines((UBound(csvLines) - 1))\nEnd If\n\n\n' loop through all lines in .csv file\nFor i = 0 To UBound(csvLines)\n    CurrentRow = Split(csvLines(i), \",\")\n\n    CurrentRow(1) = CurrentRow(1) &amp; \".\" &amp; CurrentRow(2)\n    CurrentRow(2) = CurrentRow(3) &amp; \".\" &amp; CurrentRow(4)\n    CurrentRow(3) = CurrentRow(5)\n    CurrentRow(4) = CurrentRow(6)\n\n    ' re-format the current line\n    csvLines(i) = CurrentRow(0) &amp; \",\" &amp; CurrentRow(1) &amp; \",\" &amp; CurrentRow(2) &amp; \",\" &amp; CurrentRow(3) &amp; \",\" &amp; CurrentRow(4)\n\n    Erase CurrentRow ' clear array\nNext i\n\n' now just dump the entre array to the worksheet\nWorksheets(1).Range(\"A1\").Resize(UBound(csvLines) + 1).Value = Application.Transpose(csvLines)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 3237570, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1a82a902fd78b6ad81b9539391b96964?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit", "link": "https://stackoverflow.com/users/3237570/rohit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1779, "favorite_count": 0, "accepted_answer_id": 46928065, "answer_count": 2, "score": 0, "last_activity_date": 1508922623, "creation_date": 1508920863, "last_edit_date": 1531161705, "question_id": 46927784, "link": "https://stackoverflow.com/questions/46927784/replace-comma-with-dot-only-at-particular-location-in-the-string", "title": "Replace comma(,) with dot(.) only at particular location in the string", "body": "<p>I have string each on multiple line which looks like this</p>\n\n<pre><code>S087A1097,99,86,0,14,0,good\nS087A1097,100,0,10,14,0,good\nS087A1097,0,0,100,0,0,good\n</code></pre>\n\n<p>And I need to change it to this respectively.</p>\n\n<pre><code>S087A1097,99.86,0.14,0,good\nS087A1097,100.0,10.14,0,good\nS087A1097,0.0,100.0,0,good\n</code></pre>\n\n<p>How can I achieve this in Excel</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 657, "user_id": 4019835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlgTI.png?s=128&g=1", "display_name": "Bouramas", "link": "https://stackoverflow.com/users/4019835/bouramas"}, "edited": false, "score": 0, "creation_date": 1508920375, "post_id": 46927575, "comment_id": 80801968, "body": "That sounds easy to do with Excel rules. Do your research. I think this post is not so appropriate for StackOverflow. This <a href=\"https://superuser.com/\">site</a> will be best for your questions."}, {"owner": {"reputation": 1, "user_id": 8830240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33f2a534476ac4999324439f040f0600?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8830240/tom"}, "reply_to_user": {"reputation": 657, "user_id": 4019835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NlgTI.png?s=128&g=1", "display_name": "Bouramas", "link": "https://stackoverflow.com/users/4019835/bouramas"}, "edited": false, "score": 0, "creation_date": 1508920541, "post_id": 46927575, "comment_id": 80802068, "body": "Okay how would I go about it then?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8830240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33f2a534476ac4999324439f040f0600?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8830240/tom"}, "edited": false, "score": 0, "creation_date": 1508920831, "post_id": 46927728, "comment_id": 80802243, "body": "How could I adapt this so I can do it with my rand number example? (I am inexperienced with VBA unfortunately)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 1, "user_id": 8830240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33f2a534476ac4999324439f040f0600?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8830240/tom"}, "edited": false, "score": 0, "creation_date": 1508921014, "post_id": 46927728, "comment_id": 80802359, "body": "@Tom - read the examples in the documentation &amp; try them. <code>Target</code> in the documentation is the range, that is changed. Once it gets a given value (from the random function), then exit the function earlier. But in general, spend a few hours reading online tutorials for VBA before trying."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1508920702, "creation_date": 1508920702, "answer_id": 46927728, "question_id": 46927575, "link": "https://stackoverflow.com/questions/46927575/is-it-possible-to-do-a-if-ever-in-excel/46927728#46927728", "title": "Is it possible to do a &quot;if-ever&quot; in excel?", "body": "<p>Just with plain excel the answer is <strong>NO</strong>. \nThe formulas will recalculate every time. However, with <a href=\"https://en.wikipedia.org/wiki/Visual_Basic_for_Applications\" rel=\"nofollow noreferrer\">VBA</a> it is possible.</p>\n\n<p>Press <kbd>Ctrl</kbd>+<kbd>F11</kbd> and give it a try. You need to explore the <code>Worksheet_Change</code> event and to make sure that it checks a specific target for the value. Then simply change the target and that's it.</p>\n\n<p><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-change-event-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-change-event-excel</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8830240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/33f2a534476ac4999324439f040f0600?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/8830240/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508920702, "creation_date": 1508920184, "last_edit_date": 1531161705, "question_id": 46927575, "link": "https://stackoverflow.com/questions/46927575/is-it-possible-to-do-a-if-ever-in-excel", "title": "Is it possible to do a &quot;if-ever&quot; in excel?", "body": "<p>Okay I'm not sure what the official name for what I want is so I will refer to it as an \"if-ever\" function.</p>\n\n<p>Basically I want to say if a certain cell is equal to a certain value at any point then another designated cell will return a certain value if the original cell is change the designated cell will still return the same value.</p>\n\n<p>An example to make this clear:</p>\n\n<p>Let cell A1 be =randbetween(0,10) now refreshing the formulas will return a random integer from {0,1,2,...,10}. </p>\n\n<p>Now I want to say if A1 is ever equal to 5 for instance then cell A2 will return the value 5 (or any other number/words) and will be fixed, i.e. should we then in the future change A1, A2 will still remain with the value 5 (or whatever else we used).</p>\n\n<p>Hopefully this is clear what I want.</p>\n\n<p>Is this even possible and how would I achieve something like this in excel?</p>\n\n<p>Thanks for reading!</p>\n"}, {"tags": ["vba", "excel", "unique"], "comments": [{"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "edited": false, "score": 1, "creation_date": 1508922383, "post_id": 46927512, "comment_id": 80803258, "body": "The output of this <code>IF(B1:B5=C1,A1:A5),&quot; </code> is NOT one of these :<code>xRg As Range</code>, so use Variant and test for both Range and Array/Variant and then go from there"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8562507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbb0b5fbac94bc1860604bac250cafa4?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/8562507/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1508922949, "last_edit_date": 1508922949, "creation_date": 1508922487, "answer_id": 46928323, "question_id": 46927512, "link": "https://stackoverflow.com/questions/46927512/pass-array-function-into-user-defined-function/46928323#46928323", "title": "Pass array function into user defined function", "body": "<p>The easiest solution would probably be to introduce an additional function. This function would take care of the condition and would generate an array consisting only of data fulfilling the condition. \nTry something like this:</p>\n\n<pre><code> function condition_check(data1() as integer, data2() as string, condition_value as string) as integer\n        number_of_elements = Ubound(data1)\n        j = 0\n        for i = 0 to number_of_elements\n            if data2(i) = condition_value then\n               condition_check(j) = data1(i)\n               j = j+1\n            end if\n        next i\nend function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1508925475, "post_id": 46928474, "comment_id": 80805519, "body": "I still think MacroMan&#39;s comment should be taken into account to accommodate all data entry type."}, {"owner": {"reputation": 860, "user_id": 5254902, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/s6Jno.jpg?s=128&g=1", "display_name": "Tobias Dekker", "link": "https://stackoverflow.com/users/5254902/tobias-dekker"}, "edited": false, "score": 0, "creation_date": 1508926380, "post_id": 46928474, "comment_id": 80806139, "body": "What L42 says, this only works if there are numbers in A1:A5"}], "tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 2, "last_activity_date": 1508922927, "creation_date": 1508922927, "answer_id": 46928474, "question_id": 46927512, "link": "https://stackoverflow.com/questions/46927512/pass-array-function-into-user-defined-function/46928474#46928474", "title": "Pass array function into user defined function", "body": "<p>You need to use <code>ParamArray</code> to accommodate array returned from Excel's array formula. As ParamArray should always be the last one, so your method signature will change.</p>\n\n<hr>\n\n<p>This will work with <code>=ConcatUniq(\" \",IF(B1:B5=C1,A1:A5))</code> on CTRL + SHIFT + ENTER</p>\n\n<pre><code>Public Function ConcatUniq(xChar As String, ParamArray args())\n\n    Dim xDic As Object\n    Dim xVal\n\n    Set xDic = CreateObject(\"Scripting.Dictionary\")\n\n    For Each xVal In args(0)\n        If Not Not xVal Then\n        xDic(xVal) = Empty\n        End If\n    Next\n\n    ConcatUniq = Join$(xDic.Keys, xChar)\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 860, "user_id": 5254902, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/s6Jno.jpg?s=128&g=1", "display_name": "Tobias Dekker", "link": "https://stackoverflow.com/users/5254902/tobias-dekker"}, "edited": false, "score": 0, "creation_date": 1508929436, "post_id": 46930574, "comment_id": 80808156, "body": "This almost works, but this also adds the value FALSE to the list so this outputs 1 2 FALSE"}, {"owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "reply_to_user": {"reputation": 860, "user_id": 5254902, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/s6Jno.jpg?s=128&g=1", "display_name": "Tobias Dekker", "link": "https://stackoverflow.com/users/5254902/tobias-dekker"}, "edited": false, "score": 0, "creation_date": 1508930679, "post_id": 46930574, "comment_id": 80808965, "body": "Well if False is being passed in, then you may want to cut it out in the UDF as per my edit in the answer"}], "tags": [], "owner": {"reputation": 3124, "user_id": 5175942, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MiN2o.jpg?s=128&g=1", "display_name": "MacroMarc", "link": "https://stackoverflow.com/users/5175942/macromarc"}, "is_accepted": true, "score": 1, "last_activity_date": 1508931671, "last_edit_date": 1508931671, "creation_date": 1508928950, "answer_id": 46930574, "question_id": 46927512, "link": "https://stackoverflow.com/questions/46927512/pass-array-function-into-user-defined-function/46930574#46930574", "title": "Pass array function into user defined function", "body": "<p>Perhaps something like this: </p>\n\n<pre><code>Public Function ConcatUniq(ByVal rangeOrArray As Variant, ByVal xChar As String) As String\n\n    Dim generalArray As Variant\n    If IsArray(rangeOrArray) Then\n        'operate on it as if was an array\n        generalArray = rangeOrArray\n    Else\n        If TypeName(rangeOrArray) = \"Range\" Then\n            'operate on it as if was a Range\n            If rangeOrArray.Cells.Count &gt; 1 Then\n                generalArray = rangeOrArray.Value\n            Else\n                generalArray = Array(rangeOrArray.Value)\n            End If\n        Else\n            'Try to process as if it was a derivative of a value of a single cell range.....\n            generalArray = Array(rangeOrArray)\n        End If\n    End If\n\n    Dim xDic As Object\n    Set xDic = CreateObject(\"Scripting.Dictionary\")\n\n    Dim xCell As Variant\n    For Each xCell In generalArray\n        If xCell &lt;&gt; False Then xDic(xCell) = Empty  ' EDIT - HACKY....\n    Next\n    ConcatUniq = Join$(xDic.Keys, xChar)\n\nEnd Function\n</code></pre>\n\n<p>You can see that that whole block of if-elses can be factored out to be a separate function to transform worksheet input to a unified form for operating on values of a worksheet.</p>\n"}], "owner": {"reputation": 860, "user_id": 5254902, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/s6Jno.jpg?s=128&g=1", "display_name": "Tobias Dekker", "link": "https://stackoverflow.com/users/5254902/tobias-dekker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 46930574, "answer_count": 3, "score": 1, "last_activity_date": 1508931671, "creation_date": 1508919973, "last_edit_date": 1508921404, "question_id": 46927512, "link": "https://stackoverflow.com/questions/46927512/pass-array-function-into-user-defined-function", "title": "Pass array function into user defined function", "body": "<p>I have a standard user defined function that concationates all the unique values. What I am trying to do is to perform this function on a range that satisfies a condition. </p>\n\n<pre><code>Function ConcatUniq(xRg As Range, xChar As String) As String\n'updateby Extendoffice 20151228\n    Dim xCell As Range\n    Dim xDic As Object\n    Set xDic = CreateObject(\"Scripting.Dictionary\")\n    For Each xCell In xRg\n        xDic(xCell.Value) = Empty\n    Next\n    ConcatUniq = Join$(xDic.Keys, xChar)\n    Set xDic = Nothing\nEnd Function\n</code></pre>\n\n<p>Lets make an example:\nIf we have the following data:</p>\n\n<pre><code>A1:A5 = {1,2,2,4,1}\n\nB1:B5 = {\"group1\", \"group1\",\"group1\", \"group2\", \"group2\"}\n\nC1 = \"group1\"\n</code></pre>\n\n<p>Now I want to find the unique values using the ConcatUniq function for all numbers that are in group1. Usually, if I want to perform another function for example the median I would do the following:</p>\n\n<pre><code>=MEDIAN(IF(B1:B5=C1,A1:A5)) \n</code></pre>\n\n<p>Activate it using cntrl shift enter which gives 2 (create an array function from it).\nFor some reasons this does not work in combination with a user defined function.</p>\n\n<pre><code>=ConcatUniq(IF(B1:B5=C1,A1:A5),\" \") \n</code></pre>\n\n<p>Desired result: </p>\n\n<pre><code>1 2\n</code></pre>\n\n<p>Does someone know how I could fix this problem?</p>\n"}, {"tags": ["vba", "excel", "internet-explorer", "web-scraping", "click"], "comments": [{"owner": {"reputation": 2189, "user_id": 8726447, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/961e6112f7d5aac9646ce1469e89fe20?s=128&d=identicon&r=PG&f=1", "display_name": "MarcinSzaleniec", "link": "https://stackoverflow.com/users/8726447/marcinszaleniec"}, "edited": false, "score": 1, "creation_date": 1508920388, "post_id": 46927414, "comment_id": 80801976, "body": "at first, try debug.print html.getElementsByClassName(&quot;k-selectable&quot;)(0).innerText and see if you are in right place."}, {"owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "edited": false, "score": 0, "creation_date": 1508922073, "post_id": 46927414, "comment_id": 80803040, "body": "try using the ID"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1508922566, "post_id": 46927414, "comment_id": 80803384, "body": "According to the text visible on the link which I want to click can be found using <code>html.getElementsByClassName(&quot;k-selectable&quot;)(1).innerText</code> so I tried using <code>html.getElementsByClassName(&quot;k-selectable&quot;)(1).Click</code> but it doesn&#39;t bring any result either."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514162279, "post_id": 46927414, "comment_id": 82899558, "body": "does your code only need to work for the one link, or dynamically with various records?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514173990, "post_id": 46927414, "comment_id": 82900889, "body": "Clicking on the aforementioned link will suffice @ashleedawg."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1514175159, "post_id": 46927414, "comment_id": 82901008, "body": "In that case, I don&#39;t why don&#39;t you just <a href=\"http://search.wcad.org/Property-Detail?PropertyQuickRefID=R016698\" rel=\"nofollow noreferrer\">load the target directly</a> (instead of loading Search Results and then clicking it)?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1514176009, "post_id": 46927414, "comment_id": 82901080, "body": "Only because I wish to know how click works here. Btw, the data I&#39;m not after cause I&#39;ve already scraped that."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1514177258, "post_id": 46927414, "comment_id": 82901226, "body": "Oh okay, I&#39;m won&#39;t spend time on it then, but the short explanation of why it won&#39;t work is because it&#39;s not a button, nor a hyperlink that needs to be clicked, rather is responding to a javascript event."}], "answers": [{"comments": [{"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1514309953, "post_id": 47981635, "comment_id": 82932173, "body": "Thanks again sir for your response. Basically, it neither works nor throws any error and finally quits the browser gracefully."}, {"owner": {"reputation": 411841, "user_id": 771848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2DTBv.jpg?s=128&g=1", "display_name": "alecxe", "link": "https://stackoverflow.com/users/771848/alecxe"}, "reply_to_user": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1514310895, "post_id": 47981635, "comment_id": 82932458, "body": "@Topto thanks for the information! I&#39;ve updated the answer with some more research. It works for me in the chrome console, but I can imagine you need to tweak the kendo grid selection code to work in VBA.."}], "tags": [], "owner": {"reputation": 411841, "user_id": 771848, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2DTBv.jpg?s=128&g=1", "display_name": "alecxe", "link": "https://stackoverflow.com/users/771848/alecxe"}, "is_accepted": true, "score": 1, "last_activity_date": 1514311253, "last_edit_date": 1514311253, "creation_date": 1514308433, "answer_id": 47981635, "question_id": 46927414, "link": "https://stackoverflow.com/questions/46927414/unable-to-perform-a-click-on-a-certain-link/47981635#47981635", "title": "Unable to perform a click on a certain link", "body": "<p>When you are using <code>k-selectable</code> class to locate an element, what you get is the <code>table</code> element, but you need to get the clickable row - <code>tr</code> element.</p>\n\n<p>Now, the problem is, you cannot trigger the \"click\" of the row element node directly. See what happens when you do it in the browser console:</p>\n\n<pre><code>&gt; document.querySelector(\".k-selectable tr[role=row]\").click()\nProperty-Search-Result?searchtext=319 lizzie taylor:672 Uncaught TypeError: Cannot read property 'PropertyQuickRefID' of null\n    at HTMLTableRowElement.&lt;anonymous&gt; (Property-Search-Result?searchtext=319 lizzie taylor:672)\n    at HTMLDivElement.dispatch (VM45 jquery.js?cdv=282:3074)\n    at HTMLDivElement.elemData.handle (VM45 jquery.js?cdv=282:2750)\n    at &lt;anonymous&gt;:1:54\n</code></pre>\n\n<p>This is because it is a specific <a href=\"https://demos.telerik.com/kendo-ui/grid/index\" rel=\"nofollow noreferrer\">\"kendo UI\" grid</a> and the row selection event needs to happen before the click itself.</p>\n\n<p>Programmatically, we can \"select\" a kendo UI grid row using <a href=\"https://stackoverflow.com/q/33138163/771848\">this suggestion</a>:</p>\n\n<pre><code>var grid = $(\"#grid\").data(\"kendoGrid\"); \n\nvar rows = grid.dataSource.data(); \nvar lastRowUid = rows[0].uid;\n\nvar row = grid.table.find(\"[data-uid=\" + lastRowUid + \"]\");    \ngrid.select(row);\n</code></pre>\n\n<p>And then click:</p>\n\n<pre><code>document.querySelector(\".k-selectable tr[role=row]\").click();\n</code></pre>\n\n<p>Works for me in the Chrome console but I have no way to test it in VBA at the moment.</p>\n\n<p>From what I understand, you can always use <code>execScript</code> to execute javascript with the above-provided logic, example:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/q/43127317/771848\">Selecting/actioning items in Kendo UI widgets using Excel VBA</a></li>\n</ul>\n"}], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 858, "favorite_count": 0, "accepted_answer_id": 47981635, "answer_count": 1, "score": 2, "last_activity_date": 1514625858, "creation_date": 1508919703, "last_edit_date": 1514625858, "question_id": 46927414, "link": "https://stackoverflow.com/questions/46927414/unable-to-perform-a-click-on-a-certain-link", "title": "Unable to perform a click on a certain link", "body": "<p>I've written some code in vba using IE to reach a certain webpage. To get that webpage it is necessary to initiate a click on a link in the opening page and when the click is successfully performed then the page i am after shows up. However, I can't find any way to click on that very link.</p>\n\n<p>Elements for the link within:</p>\n\n<pre><code>&lt;div id=\"grid\" data-role=\"grid\" class=\"k-grid k-widget\" style=\"opacity: 1;\"&gt;&lt;div class=\"k-grid-header\" style=\"padding-right: 17px;\"&gt;&lt;div class=\"k-grid-header-wrap k-auto-scrollable\"&gt;&lt;table role=\"grid\"&gt;&lt;colgroup&gt;&lt;col style=\"width:100px\"&gt;&lt;col style=\"width:210px\"&gt;&lt;col&gt;&lt;col&gt;&lt;col style=\"width:120px\"&gt;&lt;/colgroup&gt;&lt;thead role=\"rowgroup\"&gt;&lt;tr role=\"row\"&gt;&lt;th role=\"columnheader\" data-field=\"PropertyQuickRefID\" rowspan=\"1\" data-title=\"PROPERTY ID\" data-index=\"0\" id=\"68a98aa1-147e-47f5-8eb6-1bb59bc5f37e\" class=\"k-header\" data-role=\"columnsorter\"&gt;&lt;a class=\"k-link\" href=\"#\"&gt;PROPERTY ID&lt;/a&gt;&lt;/th&gt;&lt;th role=\"columnheader\" data-field=\"PropertyNumber\" rowspan=\"1\" data-title=\"ACCOUNT\" data-index=\"1\" id=\"d4f307be-0d97-41cd-8e04-869fd5a041f4\" class=\"k-header\" data-role=\"columnsorter\"&gt;&lt;a class=\"k-link\" href=\"#\"&gt;ACCOUNT&lt;/a&gt;&lt;/th&gt;&lt;th role=\"columnheader\" data-field=\"PartyQuickRefID\" rowspan=\"1\" data-title=\"OWNER ID\" data-index=\"2\" id=\"1a4c6015-4851-4c78-9a67-1e3f2f384b00\" style=\"display:none\" class=\"k-header\" data-role=\"columnsorter\"&gt;&lt;a class=\"k-link\" href=\"#\"&gt;OWNER ID&lt;/a&gt;&lt;/th&gt;&lt;th role=\"columnheader\" data-field=\"OwnerName\" rowspan=\"1\" data-title=\"OWNER NAME\" data-index=\"3\" id=\"206614df-19d6-4ae4-a27a-496bdda92fb3\" class=\"k-header\" data-role=\"columnsorter\"&gt;&lt;a class=\"k-link\" href=\"#\"&gt;OWNER NAME&lt;/a&gt;&lt;/th&gt;&lt;th role=\"columnheader\" data-field=\"SitusAddress\" rowspan=\"1\" data-title=\"SITUS ADDRESS\" data-index=\"4\" id=\"5cba12e3-5dde-4d67-b664-2832adf92c29\" class=\"k-header\" data-role=\"columnsorter\"&gt;&lt;a class=\"k-link\" href=\"#\"&gt;SITUS ADDRESS&lt;/a&gt;&lt;/th&gt;&lt;th role=\"columnheader\" data-field=\"LegalDescription\" rowspan=\"1\" data-title=\"LEGAL DESCRIPTION\" data-index=\"5\" id=\"3199fe1c-1ee1-4f87-87ff-5effca8a9cfe\" style=\"display:none\" class=\"k-header\" data-role=\"columnsorter\"&gt;&lt;a class=\"k-link\" href=\"#\"&gt;LEGAL DESCRIPTION&lt;/a&gt;&lt;/th&gt;&lt;th role=\"columnheader\" data-field=\"NeighborhoodCode\" rowspan=\"1\" data-title=\"NEIGHBORHOOD CODE\" data-index=\"6\" id=\"c4b711f3-e793-45f3-b086-c95f9215a66f\" style=\"display:none\" class=\"k-header\" data-role=\"columnsorter\"&gt;&lt;a class=\"k-link\" href=\"#\"&gt;NEIGHBORHOOD CODE&lt;/a&gt;&lt;/th&gt;&lt;th role=\"columnheader\" data-field=\"Abstract\" rowspan=\"1\" data-title=\"ABSTRACT\" data-index=\"7\" id=\"135291e9-f5e8-4d3e-9c91-50c90bf6f339\" style=\"display:none\" class=\"k-header\" data-role=\"columnsorter\"&gt;&lt;a class=\"k-link\" href=\"#\"&gt;ABSTRACT&lt;/a&gt;&lt;/th&gt;&lt;th role=\"columnheader\" data-field=\"Subdivision\" rowspan=\"1\" data-title=\"SUBDIVISION\" data-index=\"8\" id=\"3951acbf-89f5-4f55-902c-0c55e78d124f\" style=\"display:none\" class=\"k-header\" data-role=\"columnsorter\"&gt;&lt;a class=\"k-link\" href=\"#\"&gt;SUBDIVISION&lt;/a&gt;&lt;/th&gt;&lt;th role=\"columnheader\" data-field=\"PropertyType\" rowspan=\"1\" data-title=\"PROPERTY TYPE\" data-index=\"9\" id=\"d71ff4cd-d5fb-4b9c-9f7f-17f4ce0a2154\" style=\"display:none\" class=\"k-header\" data-role=\"columnsorter\"&gt;&lt;a class=\"k-link\" href=\"#\"&gt;PROPERTY TYPE&lt;/a&gt;&lt;/th&gt;&lt;th role=\"columnheader\" data-field=\"PropertyValue\" rowspan=\"1\" data-title=\"2017 VALUE\" data-index=\"10\" id=\"feb614c1-9ee4-4653-bd92-d5b411bf255e\" class=\"k-header\"&gt;2017 VALUE&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;&lt;/table&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=\"k-grid-content k-auto-scrollable\"&gt;&lt;table role=\"grid\" data-role=\"selectable\" class=\"k-selectable\" style=\"touch-action: none;\"&gt;&lt;colgroup&gt;&lt;col style=\"width:100px\"&gt;&lt;col style=\"width:210px\"&gt;&lt;col&gt;&lt;col&gt;&lt;col style=\"width:120px\"&gt;&lt;/colgroup&gt;&lt;tbody role=\"rowgroup\"&gt;&lt;tr data-uid=\"f6c50847-b17b-4f32-9377-5386deabce48\" role=\"row\" class=\"rowHover\"&gt;&lt;td role=\"gridcell\"&gt;R016698&lt;/td&gt;&lt;td role=\"gridcell\"&gt;R-13-0410-0620-50000&lt;/td&gt;&lt;td style=\"display:none\" role=\"gridcell\"&gt;O0485204&lt;/td&gt;&lt;td role=\"gridcell\"&gt;GOOCH, PHILIP L&lt;/td&gt;&lt;td role=\"gridcell\"&gt;319 LIZZIE ST, TAYLOR, TX  76574&lt;/td&gt;&lt;td style=\"display:none\" role=\"gridcell\"&gt;DOAK ADDITION, BLOCK 62, LOT 5&lt;/td&gt;&lt;td style=\"display:none\" role=\"gridcell\"&gt;T541&lt;/td&gt;&lt;td style=\"display:none\" role=\"gridcell\"&gt; &lt;/td&gt;&lt;td style=\"display:none\" role=\"gridcell\"&gt;S3564 - Doak Addition&lt;/td&gt;&lt;td style=\"display:none\" role=\"gridcell\"&gt;Real&lt;/td&gt;&lt;td role=\"gridcell\"&gt;&lt;div style=\"text-align:right;width:100%\"&gt;$46,785&lt;/div&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;/div&gt;&lt;div class=\"k-pager-wrap k-grid-pager k-widget k-floatwrap\" data-role=\"pager\"&gt;&lt;a href=\"#\" title=\"Go to the first page\" class=\"k-link k-pager-nav k-pager-first k-state-disabled\" data-page=\"1\" tabindex=\"-1\"&gt;&lt;span class=\"k-icon k-i-seek-w\"&gt;Go to the first page&lt;/span&gt;&lt;/a&gt;&lt;a href=\"#\" title=\"Go to the previous page\" class=\"k-link k-pager-nav  k-state-disabled\" data-page=\"1\" tabindex=\"-1\"&gt;&lt;span class=\"k-icon k-i-arrow-w\"&gt;Go to the previous page&lt;/span&gt;&lt;/a&gt;&lt;span class=\"k-pager-input k-label\"&gt;Page&lt;input class=\"k-textbox\"&gt;of 1&lt;/span&gt;&lt;a href=\"#\" title=\"Go to the next page\" class=\"k-link k-pager-nav  k-state-disabled\" data-page=\"1\" tabindex=\"-1\"&gt;&lt;span class=\"k-icon k-i-arrow-e\"&gt;Go to the next page&lt;/span&gt;&lt;/a&gt;&lt;a href=\"#\" title=\"Go to the last page\" class=\"k-link k-pager-nav k-pager-last k-state-disabled\" data-page=\"1\" tabindex=\"-1\"&gt;&lt;span class=\"k-icon k-i-seek-e\"&gt;Go to the last page&lt;/span&gt;&lt;/a&gt;&lt;span class=\"k-pager-sizes k-label\"&gt;&lt;span title=\"\" class=\"k-widget k-dropdown k-header\" unselectable=\"on\" role=\"listbox\" aria-haspopup=\"true\" aria-expanded=\"false\" tabindex=\"0\" aria-owns=\"\" aria-disabled=\"false\" aria-readonly=\"false\" aria-busy=\"false\" aria-activedescendant=\"8334826b-15aa-41ed-976d-52d896a5ac8a\" style=\"\"&gt;&lt;span unselectable=\"on\" class=\"k-dropdown-wrap k-state-default\"&gt;&lt;span unselectable=\"on\" class=\"k-input\"&gt;20&lt;/span&gt;&lt;span unselectable=\"on\" class=\"k-select\"&gt;&lt;span unselectable=\"on\" class=\"k-icon k-i-arrow-s\"&gt;select&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;select data-role=\"dropdownlist\" style=\"display: none;\"&gt;&lt;option value=\"10\"&gt;10&lt;/option&gt;&lt;option value=\"15\"&gt;15&lt;/option&gt;&lt;option value=\"20\"&gt;20&lt;/option&gt;&lt;option value=\"50\"&gt;50&lt;/option&gt;&lt;option value=\"100\"&gt;100&lt;/option&gt;&lt;/select&gt;&lt;/span&gt;items per page&lt;/span&gt;&lt;a href=\"#\" class=\"k-pager-refresh k-link\" title=\"Refresh\"&gt;&lt;span class=\"k-icon k-i-refresh\"&gt;Refresh&lt;/span&gt;&lt;/a&gt;&lt;span class=\"k-pager-info k-label\"&gt;1 - 1 of 1 items&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;\n</code></pre>\n\n<p>Script I'm trying with:</p>\n\n<pre><code>Sub Get_Page()\n    Dim IE As New InternetExplorer, html As HTMLDocument\n\n    With IE\n        .Visible = True\n        .navigate \"link\"\n        Do Until .readyState = READYSTATE_COMPLETE: Loop\n        Set html = .Document\n    End With\n\n   html.getElementsByClassName(\"k-selectable\")(1).Click\n   Application.Wait (Now + TimeValue(\"0:00:05\"))\n\nEnd Sub\n</code></pre>\n\n<p>This is <a href=\"http://search.wcad.org/Property-Search-Result?searchtext=319%20lizzie%20taylor\" rel=\"nofollow noreferrer\">The link</a> which will be placed in my script.</p>\n\n<p>This is the image of that link which is marked with a pencil:</p>\n\n<p><a href=\"https://i.stack.imgur.com/kVqbW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kVqbW.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>When I do the same using selenium along with <code>css selector</code> then it works:</p>\n\n<pre><code>Sub Trigger_Click()\n  Dim driver As New ChromeDriver, html As New HTMLDocument\n\n  With driver\n    .Get \"replace_with_above_link\"\n    .Wait 1000\n  End With\n\n  driver.FindElementByCss(\".k-selectable tr[role='row']\").Click\n  driver.Wait 1000\n\n  driver.Quit\nEnd Sub\n</code></pre>\n\n<p>So I tried with <code>.querySelector()</code> in my above script replacing <code>html.getElementsByClassName(\"k-selectable\")(0).Click</code> with <code>html.querySelector(\".k-selectable tr[role='row']\").Click</code> but it did not work either. As selenium can do the trick I'm still sanguine, IE can do the same.</p>\n\n<p>With sir alecxe's suggestion It seems I'm very close to the solution. I've been able to select the first portion of the grid with the method I'm pasting below along with a picture to show how the grid looks like when i executed my script. The selected portion of the grid gets different look than the other portions. All i need to do now is a click.</p>\n\n<p>Here is the portion of <code>kendoGrid</code> method:</p>\n\n<pre><code>html.parentWindow.execScript \"$('#grid').data('kendoGrid').select('.k-selectable tr td:eq(0)');\"\n</code></pre>\n\n<p>This is the picture of the selected portion of the grid:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EkZnZ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EkZnZ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>This is the refined script which can do the job:</p>\n\n<pre><code>Sub Get_Page()\n    Dim IE As New InternetExplorer, html As HTMLDocument\n\n    With IE\n        .Visible = True\n        .navigate \"replace_with_above_link\"\n        Do Until .readyState = READYSTATE_COMPLETE: Loop\n        Set html = .Document\n    End With\n\n   Application.Wait (Now + TimeValue(\"0:00:05\"))\n   html.parentWindow.execScript \"$('#grid').data('kendoGrid').select('.k-selectable tr[role=row]');\"\n   html.queryselector(\".k-selectable tr[role=row]\").Click\n   Application.Wait (Now + TimeValue(\"0:00:05\"))\nEnd Sub\n</code></pre>\n\n<p>Acknowledgement: Pasted above the working solution by taking permission from the owner of this solution @sir alecxe.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "is_accepted": false, "score": 1, "last_activity_date": 1508919005, "creation_date": 1508919005, "answer_id": 46927197, "question_id": 46926998, "link": "https://stackoverflow.com/questions/46926998/double-loop-absolute-value/46927197#46927197", "title": "Double Loop absolute value", "body": "<p><a href=\"https://i.stack.imgur.com/8N9iB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8N9iB.png\" alt=\"enter image description here\"></a>You can do it simply with this formula:</p>\n\n<p><code>=IFERROR(IF(MAX(OFFSET(E1,-5,0))&lt;E1,\"Increased for 5 steps\",\"\"),\"\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1508919098, "creation_date": 1508919098, "answer_id": 46927233, "question_id": 46926998, "link": "https://stackoverflow.com/questions/46926998/double-loop-absolute-value/46927233#46927233", "title": "Double Loop absolute value", "body": "<p>Try like this, you need a boolean flag to go around it:</p>\n\n<pre><code>Sub IncreasingFor_5Steps()\n\n    Dim i       As Integer, j As Integer\n    Dim flag    As Boolean\n\n    For i = 7 To 20\n        flag = False\n        For j = 1 To 5\n            If Cells(i, 5).Value &lt;= Cells(i - j, 5).Value Then\n                flag = True\n            End If\n        Next j\n        If Not flag Then Cells(i, 6) = \"Increased for 5 steps\"\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>The idea of the boolean flag is that it checks all the 5 cells for being smaller and if one of them is not smaller, then it becomes <code>true</code> Once it is true, the <code>Cells(i,6)</code> does not increment.</p>\n"}, {"tags": [], "owner": {"reputation": 318, "user_id": 7103010, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mJ5MGor2_yQ/AAAAAAAAAAI/AAAAAAAAAGc/wYKZy_kkFrU/photo.jpg?sz=128", "display_name": "Karl Kristjansson", "link": "https://stackoverflow.com/users/7103010/karl-kristjansson"}, "is_accepted": false, "score": 1, "last_activity_date": 1508973379, "last_edit_date": 1508973379, "creation_date": 1508919219, "answer_id": 46927267, "question_id": 46926998, "link": "https://stackoverflow.com/questions/46926998/double-loop-absolute-value/46927267#46927267", "title": "Double Loop absolute value", "body": "<p>Is doing this in VBA necessary?  Would placing this formula in F7 and drag down work?</p>\n\n<pre><code>=IF(E7&gt;MAX(E2:E6),\"Increased for 5 steps\",\"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 0, "last_activity_date": 1508921403, "creation_date": 1508921403, "answer_id": 46927954, "question_id": 46926998, "link": "https://stackoverflow.com/questions/46926998/double-loop-absolute-value/46927954#46927954", "title": "Double Loop absolute value", "body": "<p>If you want to use <strong>VBA</strong>, you can use the <code>WorksheetFunction.Max</code> to get the maximum value in a certain range, and thus eliminating the need to have 2 <code>For</code> loops.</p>\n\n<pre><code>Option Explicit\n\nSub IncreasingFor_5Steps()\n\nDim i As Long\n\nFor i = 7 To 20\n    ' use WorkshettFunction Max instead of a 2nd loop\n    If Cells(i, 5).Value &gt; WorksheetFunction.Max(Range(Cells(i - 5, 5), Cells(i - 1, 5))) Then\n        Cells(i, 6) = \"Increased for 5 steps\"\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8801202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/390151bf5131735f8e5d8d8663d297dc?s=128&d=identicon&r=PG&f=1", "display_name": "Sylvain", "link": "https://stackoverflow.com/users/8801202/sylvain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 46927233, "answer_count": 4, "score": 2, "last_activity_date": 1508973379, "creation_date": 1508918366, "last_edit_date": 1508921515, "question_id": 46926998, "link": "https://stackoverflow.com/questions/46926998/double-loop-absolute-value", "title": "Double Loop absolute value", "body": "<p>I am trying to set up a code that displays a message when a cell's value is higher than each of the 5 previous cells in the same column. </p>\n\n<p>This is my code:</p>\n\n<pre><code>Sub IncreasingFor_5Steps()\n\nDim i, j As Integer\n\nFor i = 7 To 20\n    For j = 1 To 5\n        If Cells(i, 5).Value &gt; Cells(i - j, 5).Value Then    \n            Cells(i, 6) = \"Increased for 5 steps\"    \n        End If        \n    Next j\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>When I run this code, the message <strong>\"Increased for 5 steps\"</strong> is displayed when the cell is higher than AT LEAST one cell (over the 5 previous cells), but what I would like is to display the message ONLY IF the cells is higher than ALL 5 previous cells, but I don't know how to do.</p>\n\n<p>See this for example in F7 the message is displayed whereas E7 is lower than E4, also E20 is lower than E19 but the message is displayed though, because E20 is higher than E15, E16, E17, E18, but I don't want that:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qweFv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qweFv.png\" alt=\"enter image description here\"></a>,</p>\n"}, {"tags": ["excel", "vba", "if-statement"], "answers": [{"tags": [], "owner": {"reputation": 3347, "user_id": 5722505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e2356a75bc16cc5aae3fce6b5ff1b9e?s=128&d=identicon&r=PG&f=1", "display_name": "Egan Wolf", "link": "https://stackoverflow.com/users/5722505/egan-wolf"}, "is_accepted": false, "score": 0, "last_activity_date": 1508919942, "creation_date": 1508919942, "answer_id": 46927504, "question_id": 46926864, "link": "https://stackoverflow.com/questions/46926864/how-can-i-improve-my-multiple-if-and-else-if-vba-code/46927504#46927504", "title": "How can I improve my multiple \u201cif and else if\u201d VBA code", "body": "<p>Welcome to SO. There are some cases that are not supported by your code. What if:</p>\n\n<ol>\n<li><code>Range(\"A\" &amp; i).Value &lt;&gt; Range(\"A\" &amp; i + 1).Value</code></li>\n<li><code>Range(\"G\" &amp; i).Value = Range(\"G\" &amp; i + 1).Value</code></li>\n<li><code>Val(Range(\"G\" &amp; i).Value) &lt; 0.01898</code></li>\n<li><code>Val(Range(\"G\" &amp; i).Value) = 0.02149</code></li>\n</ol>\n\n<p>Also, you can't use two inequalities in one <code>If</code> statement in the way you did it. Use <code>And</code> instead, like</p>\n\n<pre><code>ElseIf 0.01898 &lt; Val(Range(\"G\" &amp; i).Value) And Val(Range(\"G\" &amp; i).Value) &lt; 0.02149 Then\n</code></pre>\n\n<p>And you don't have to use <code>ElseIf</code> with condition opposite to <code>If</code>, just use <code>Else</code>:</p>\n\n<pre><code>If i Mod 2 &lt;&gt; 0 Then\n    ...\nElse\n    ...\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8829934, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ExMxocik958/AAAAAAAAAAI/AAAAAAAAAXg/rQKoG2ixhiM/photo.jpg?sz=128", "display_name": "Ania", "link": "https://stackoverflow.com/users/8829934/ania"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1508920869, "creation_date": 1508917949, "last_edit_date": 1508920869, "question_id": 46926864, "link": "https://stackoverflow.com/questions/46926864/how-can-i-improve-my-multiple-if-and-else-if-vba-code", "title": "How can I improve my multiple \u201cif and else if\u201d VBA code", "body": "<p>I have a series of data and depending on it I have to decide if it's a TE or LE edge. I have several conditions which I tried to sum up in the following code.\nThe code is working but I have some blank spaces left which means certain conditions are not taken into account.</p>\n\n<p>More specifically I think it's this one: </p>\n\n<pre><code>ElseIf Val(Range(\"G\" &amp; i).Value) &gt; 0.02149 Then Range(\"N\" &amp; i).Value = \"TE\"\n</code></pre>\n\n<p>Guess it's a problem of all this If and ElseIf but I couldn't find a solution to it.</p>\n\n<p>So let me know if you have any suggestions. Thank you. </p>\n\n<pre><code>Sub edge()\n\nOn Error Resume Next\n\nDim lastRowIndex As Integer\nDim firstRowIndex As Integer\nDim MyString As String\n\n\nlastRowIndex = ActiveSheet.UsedRange.Rows.Count\n\nMyString = Application.ThisCell.Address\nfirstRowIndex = Range(MyString).Select\n\nFor i = firstRowIndex To lastRowIndex\nIf i Mod 2 &lt;&gt; 0 Then\n    If Range(\"A\" &amp; i).Value = Range(\"A\" &amp; i + 1).Value Then\n            If Range(\"G\" &amp; i).Value &gt; Range(\"G\" &amp; i + 1).Value Then\n                    If Range(\"H\" &amp; i).Value = \"0\" Then Range(\"N\" &amp; i).Value = \"TE\"\n                    ElseIf 0.01898 &lt; Val(Range(\"G\" &amp; i).Value) &lt; 0.02149 Then Range(\"N\" &amp; i).Value = \"LE\"\n                    **ElseIf Val(Range(\"G\" &amp; i).Value) &gt; 0.02149 Then Range(\"N\" &amp; i).Value = \"TE\"**\n                    End If\n\n            ElseIf Range(\"G\" &amp; i).Value &lt; Range(\"G\" &amp; i + 1).Value Then\n                    If Range(\"H\" &amp; i).Value = \"0\" Then Range(\"N\" &amp; i).Value = \"LE\"\n                    ElseIf 0.01898 &lt; Val(Range(\"G\" &amp; i).Value) &lt; 0.02149 Then Range(\"N\" &amp; i).Value = \"LE\"\n                    ElseIf Val(Range(\"G\" &amp; i).Value) &gt; 0.02149 Then Range(\"N\" &amp; i).Value = \"TE\"\n                    End If\n\n\n\nElseIf i Mod 2 = 0 Then\n    If Range(\"A\" &amp; i).Value = Range(\"A\" &amp; i - 1).Value Then\n            If Range(\"G\" &amp; i).Value &gt; Range(\"G\" &amp; i - 1).Value Then\n                    If Range(\"H\" &amp; i).Value = \"0\" Then Range(\"N\" &amp; i).Value = \"TE\"\n                    ElseIf 0.01898 &lt; Val(Range(\"G\" &amp; i).Value) &lt; 0.02149 Then Range(\"N\" &amp; i).Value = \"LE\"\n                    ElseIf Val(Range(\"G\" &amp; i).Value) &gt; 0.02149 Then Range(\"N\" &amp; i).Value = \"TE\"\n\n            ElseIf Range(\"G\" &amp; i).Value &lt; Range(\"G\" &amp; i - 1).Value Then\n                    If Range(\"H\" &amp; i).Value = \"0\" Then Range(\"N\" &amp; i).Value = \"LE\"\n                    ElseIf 0.01898 &lt; Val(Range(\"G\" &amp; i).Value) &lt; 0.02149 Then Range(\"N\" &amp; i).Value = \"LE\"\n                    ElseIf Val(Range(\"G\" &amp; i).Value) &gt; 0.02149 Then Range(\"N\" &amp; i).Value = \"TE\"\n            End If\n    End If\nEnd If\n\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 3, "creation_date": 1508917857, "post_id": 46926772, "comment_id": 80800480, "body": "Overflow: <a href=\"https://msdn.microsoft.com/en-us/library/aa264525(v=vs.60).aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/aa264525(v=vs.60).aspx</a>    <code>Integer\tInteger value (2 bytes) in the range: -32768 to 32767.</code> <code>Long \tInteger value (4 bytes) in the range: -2,147,483,648 to 2,147,483,647.</code>"}, {"owner": {"reputation": 15, "user_id": 8254443, "user_type": "registered", "profile_image": "https://graph.facebook.com/1575191985858649/picture?type=large", "display_name": "Silviu Balan", "link": "https://stackoverflow.com/users/8254443/silviu-balan"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1508918013, "post_id": 46926772, "comment_id": 80800564, "body": "I changed integer to long, it works, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1508922011, "creation_date": 1508922011, "answer_id": 46928154, "question_id": 46926772, "link": "https://stackoverflow.com/questions/46926772/vba-array-runtime-error-6-overflow/46928154#46928154", "title": "VBA array runtime error 6, overflow", "body": "<p>Outside the fact, that you should use <code>long</code> and not <code>integer</code>, your formula for array length is a bit wrong. It returns one less. Take a look at this code:</p>\n\n<pre><code>Function ArrayLength(arr) As Long\n\n    Dim k As Long\n    Dim i As Long\n\n    k = UBound(arr) - LBound(arr)\n    ArrayLength = k\n\nEnd Function\n\nPublic Sub TestMe()\n\n    Dim arr() As Variant\n    arr = Array(1, 2, 3, 4, 5, 6, 7, 8, 9)\n    Debug.Print ArrayLength(arr)\n\nEnd Sub\n</code></pre>\n\n<p>It will return 8, while the answer should be 9. In order to get the length, simply write <code>Debug.Print UBound(arr) + 1</code> to get the length.</p>\n"}], "owner": {"reputation": 15, "user_id": 8254443, "user_type": "registered", "profile_image": "https://graph.facebook.com/1575191985858649/picture?type=large", "display_name": "Silviu Balan", "link": "https://stackoverflow.com/users/8254443/silviu-balan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 978, "favorite_count": 0, "accepted_answer_id": 46928154, "answer_count": 1, "score": 0, "last_activity_date": 1517811532, "creation_date": 1508917629, "last_edit_date": 1517811532, "question_id": 46926772, "link": "https://stackoverflow.com/questions/46926772/vba-array-runtime-error-6-overflow", "title": "VBA array runtime error 6, overflow", "body": "<p>I have following functions:</p>\n\n<pre><code>Function ArrayLength(arr() As Double) As Integer\n    Dim len As Integer\n    Dim i As Integer\n    len = UBound(arr) - LBound(arr)\n    ArrayLength = len\n\nEnd Function\n\n'Print on console array\nSub PrintArray(arr() As Double, column As Integer)\n    Dim len As Integer\n    len = ArrayLength(arr)\n\n    For i = 0 To len - 1\n        ActiveSheet.Cells(i + 2, column).Value = arr(i)\n    Next i\n\nEnd Sub\n</code></pre>\n\n<p>My array has more than 200000 elements, and when I try to print it, it show me next error:\n<a href=\"https://i.stack.imgur.com/6exKi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6exKi.png\" alt=\"Run-time error &#39;6&#39;: Overflow\"></a></p>\n"}, {"tags": ["excel", "vba", "events", "enter", "confirm"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1508917589, "post_id": 46926665, "comment_id": 80800325, "body": "How can I achieve this? 1. Track Sheet Change event. 2. Once on desired cell, track key press on Excel (WinAPI is the only way). 3. Or Else super impose a textbox over the cell and track the keypress on the textbox."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1508920555, "post_id": 46926665, "comment_id": 80802074, "body": "How is <code>10</code> going to be entered as a single character??"}, {"owner": {"reputation": 3, "user_id": 4601147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a726a3c32c5ee01fbf5bcb9750cb6b?s=128&d=identicon&r=PG&f=1", "display_name": "BartH", "link": "https://stackoverflow.com/users/4601147/barth"}, "edited": false, "score": 0, "creation_date": 1508944546, "post_id": 46926665, "comment_id": 80819376, "body": "You are right, YowE3K ;-) this should be 0-9"}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 4601147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a726a3c32c5ee01fbf5bcb9750cb6b?s=128&d=identicon&r=PG&f=1", "display_name": "BartH", "link": "https://stackoverflow.com/users/4601147/barth"}, "is_accepted": false, "score": 0, "last_activity_date": 1508949530, "creation_date": 1508949530, "answer_id": 46937783, "question_id": 46926665, "link": "https://stackoverflow.com/questions/46926665/enter-one-character-in-worksheet-with-having-to-confirm-return-enter/46937783#46937783", "title": "enter one character in worksheet with having to confirm (return/enter)", "body": "<p>OK, \nLooking for WinAPI I figuered out a suitable solution:</p>\n\n<p>In Workbook_Open and Sheet_Activate I used the Application.OnKey procedure to trap my keys, like:</p>\n\n<pre><code>Private Sub Workbook_Open()\n     Application.OnKey (\"1\"), \"testOne\"\n     'Here other keys\nEnd Sub\n</code></pre>\n\n<p>and </p>\n\n<pre><code>Private Sub Worksheet_Activate()\n     Application.OnKey (\"1\"), \"testOne\"\n     'Here other keys\nEnd Sub\n</code></pre>\n\n<p>while the following procedure(s) in a standard Module take care of what I needed:</p>\n\n<pre><code>Sub testOne()\n    ActiveCell.Value = 1\nEnd Sub\n'And Sub testTwo() etc.\n</code></pre>\n\n<p>(I don't need to bother to allow entering values in the other cells as they are locked anyway.)</p>\n\n<p>Make sure you put the release of OnKey in Workbook_BeforeClose and Sheet_Deactive:</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n     Application.OnKey (\"1\")\n     'Here other keys\nEnd Sub\n\nPrivate Sub Worksheet_Deactivate()\n     Application.OnKey (\"1\")\n     'Here other keys\nEnd Sub\n</code></pre>\n\n<p>Maybe not the most advanced solution, but it works for what I need.</p>\n\n<p>Grtz BartH</p>\n"}], "owner": {"reputation": 3, "user_id": 4601147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00a726a3c32c5ee01fbf5bcb9750cb6b?s=128&d=identicon&r=PG&f=1", "display_name": "BartH", "link": "https://stackoverflow.com/users/4601147/barth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508949530, "creation_date": 1508917264, "last_edit_date": 1508944902, "question_id": 46926665, "link": "https://stackoverflow.com/questions/46926665/enter-one-character-in-worksheet-with-having-to-confirm-return-enter", "title": "enter one character in worksheet with having to confirm (return/enter)", "body": "<p>I have a worksheet in which users have to enter one character in a cell and I would like the cell to accept the new value without having to press RETURN (or ENTER) and stay in the same cell.</p>\n\n<p><a href=\"https://i.stack.imgur.com/a7Uov.png\" rel=\"nofollow noreferrer\">enter status in one cell without confirmation</a></p>\n\n<p>How can I achieve this?</p>\n\n<p>Grtz BartH</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2431302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd452a4b41d5d51f3e0591c2ce42513d?s=128&d=identicon&r=PG", "display_name": "user2431302", "link": "https://stackoverflow.com/users/2431302/user2431302"}, "edited": false, "score": 0, "creation_date": 1508988138, "post_id": 46927415, "comment_id": 80837872, "body": "thanks for your reply @jochen, i was a newbie for VBA, can you share a script that you suggest"}, {"owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "reply_to_user": {"reputation": 1, "user_id": 2431302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd452a4b41d5d51f3e0591c2ce42513d?s=128&d=identicon&r=PG", "display_name": "user2431302", "link": "https://stackoverflow.com/users/2431302/user2431302"}, "edited": false, "score": 0, "creation_date": 1509002960, "post_id": 46927415, "comment_id": 80843578, "body": "Sorry, this is no free coding service. Please use the macro recorder, add the formula to the column and try to change the code correspondingly to your needs. Come back if you encounter problems."}], "tags": [], "owner": {"reputation": 1269, "user_id": 6065711, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bedb05fd942a5a6acd9870d295d3afd9?s=128&d=identicon&r=PG&f=1", "display_name": "Jochen", "link": "https://stackoverflow.com/users/6065711/jochen"}, "is_accepted": false, "score": 0, "last_activity_date": 1508919705, "creation_date": 1508919705, "answer_id": 46927415, "question_id": 46926565, "link": "https://stackoverflow.com/questions/46926565/find-duplicates-value-and-sum-a-duplicates-using-index-number-using-vba/46927415#46927415", "title": "Find duplicates Value and sum a duplicates using index number Using VBA", "body": "<p>You dont need VBA for thet. If your data is from A1 to C5 (with Point in Column D), lke in your example, put the following formula in D2 and pull it down:</p>\n\n<pre><code>=SUMIF($C$2:$C$5,C2,$A$2:$A$5)/COUNTIF($C$2:$C$5,C2)\n</code></pre>\n\n<p>If you need VBA, just add Application.Worksheetfunction to both formula parts.</p>\n"}], "owner": {"reputation": 1, "user_id": 2431302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd452a4b41d5d51f3e0591c2ce42513d?s=128&d=identicon&r=PG", "display_name": "user2431302", "link": "https://stackoverflow.com/users/2431302/user2431302"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508919705, "creation_date": 1508916893, "question_id": 46926565, "link": "https://stackoverflow.com/questions/46926565/find-duplicates-value-and-sum-a-duplicates-using-index-number-using-vba", "title": "Find duplicates Value and sum a duplicates using index number Using VBA", "body": "<p>I need a little help here for excel and VBA, lets says my column like this</p>\n\n<p><code>No Name Rank Point\n  1 Foo   1\n  2 Bar   1\n  3 Jhon  1\n  4 Doe   1\n</code>\ni need to fill a point using adds the same rank by using index of number and then divide by the number of duplicates value, <code>point = (1+2+3+4)/4</code> i need an help for using a VBA script, any of help will be appreciate   </p>\n"}, {"tags": ["vba", "excel", "shell", "unix"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1508917116, "post_id": 46926375, "comment_id": 80800034, "body": "Its always good to know about what you want."}, {"owner": {"reputation": 448, "user_id": 3784173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3a6576bd6dd5b353701d5c6cd4d20ab?s=128&d=identicon&r=PG", "display_name": "Nicola Worthington", "link": "https://stackoverflow.com/users/3784173/nicola-worthington"}, "edited": false, "score": 0, "creation_date": 1508937246, "post_id": 46926375, "comment_id": 80813786, "body": "It would be fairly simple to do in a shell script, Perl, Python... any scripting language.The simplest option would be to email a CSV file rather than an Excel specific format document."}], "owner": {"reputation": 11, "user_id": 8829771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3227bb9242ccd82d5ae9e289b145c65b?s=128&d=identicon&r=PG&f=1", "display_name": "Dhaval", "link": "https://stackoverflow.com/users/8829771/dhaval"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1508916289, "creation_date": 1508916289, "question_id": 46926375, "link": "https://stackoverflow.com/questions/46926375/shell-script-to-check-if-website-is-up-and-fill-excel-sheet", "title": "shell script to check if website is up and fill excel sheet", "body": "<p>I want to check if a particular set of websites(around 20) is up or not. This should be done daily at a particular user defined time and the status of the website should be filled in an Excel Sheet and the Excel sheet should be mailed to the user defined email address. \nIs this possible? If yes, what should be the shell script?</p>\n"}, {"tags": ["excel", "vba", "autocad"], "comments": [{"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1508917153, "post_id": 46926288, "comment_id": 80800058, "body": "I suspect that the two inputbox prompts which you are looking at are from different owning applications i.e. FCI Macro has an inputbox (comes from ACAD) and the second inputbox prompt you are getting is from the code you&#39;ve posted above which is owned by Excel."}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1508917246, "post_id": 46926288, "comment_id": 80800111, "body": "yes that&#39;s what happens, how can i fix this"}, {"owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1508918542, "post_id": 46926288, "comment_id": 80800886, "body": "If that is what is happening then I&#39;d think that this line in Excel (above code) is redundant. <code>myValue = InputBox(&quot;1 = FCI&quot; &amp; vbCrLf &amp; _            &quot;2 = ECI&quot;, &quot;Model&quot;, 1)</code> Comment it out and check your code again."}, {"owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "reply_to_user": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "edited": false, "score": 0, "creation_date": 1508922655, "post_id": 46926288, "comment_id": 80803448, "body": "thing is i want the code to open the inputbox on AutoCad and select &quot;1&quot; as the answer and then &quot;enter&quot; the value automatically, i don&#39;t know if I am making sense. So I need a syntax that will link the  <code>myValue</code> line to the inputBox on AutoCad not excel"}], "answers": [{"tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": true, "score": 1, "last_activity_date": 1508925765, "creation_date": 1508925765, "answer_id": 46929481, "question_id": 46926288, "link": "https://stackoverflow.com/questions/46926288/entering-value-on-inputbox-in-autocad-using-excel/46929481#46929481", "title": "ENtering Value on InputBox in AutoCAD using Excel", "body": "<p>I think this is what you need to do based on our exchange above.</p>\n\n<ol>\n<li>Remove code line(s) which are in Excel i.e. code which you have posted here.</li>\n</ol>\n\n<p><code>myValue = InputBox(\"1 = FCI\" &amp; vbCrLf &amp; _\n           \"2 = ECI\", \"Model\", 1)\nApplication.SendKeys \"{ENTER}\"</code></p>\n\n<ol start=\"2\">\n<li>Open AutoCAD VB project's DVB file and macro named \"FCI\". Insert the line</li>\n</ol>\n\n<p><code>myValue = InputBox(\"1 = FCI\" &amp; vbCrLf &amp; _\n           \"2 = ECI\", \"Model\", 1)</code>\nwhere appropriate. You don't need SendKeys syntax since you will get prompt through AutoCAD itself. Use <code>myValue</code> as you need in the code further.</p>\n"}], "owner": {"reputation": 83, "user_id": 8052726, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/1410035282396278/picture?type=large", "display_name": "K Bizzy", "link": "https://stackoverflow.com/users/8052726/k-bizzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "accepted_answer_id": 46929481, "answer_count": 1, "score": 0, "last_activity_date": 1508925765, "creation_date": 1508915954, "question_id": 46926288, "link": "https://stackoverflow.com/questions/46926288/entering-value-on-inputbox-in-autocad-using-excel", "title": "ENtering Value on InputBox in AutoCAD using Excel", "body": "<p>I am working on a code that opens AutoCAD and activates the input box and enters a value and then enters the value. The problem with my code is that it opens autoCad and runs the code for inputBox but then creates a different inputBox in excel. I want my code to work only in AutoCAD but using excel. Here is my code:</p>\n\n<pre><code>Sub Access_ACad()\nDim myValue As Variant\nDim ans As String\nDim MyApp As Object\nDim MyDwg As AcadDocument\nDim ShellDraft As String\nOn Error GoTo ERRORHANDLER\nSet MyApp = GetObject(, \"Autocad.Application\")\nERRORHANDLER:\nIf Err.Description &lt;&gt; \"\" Then\nErr.Clear\nSet MyApp = CreateObject(\"Autocad.Application\")\nEnd If\n\nMyApp.Visible = True\nSet MyDwg = MyApp.ActiveDocument\nSheet1.Cells(1, 1).Value = MyDwg.Name\nShellDraft = \"Z:\\USERS\\KweziM\\PROJECT S\\Project.dvb\"\n\nMyApp.LoadDVB (ShellDraft)\n\nMyApp.RunMacro \"FCI\"\n\nmyValue = InputBox(\"1 = FCI\" &amp; vbCrLf &amp; _\n           \"2 = ECI\", \"Model\", 1)\nApplication.SendKeys \"{ENTER}\"\nEnd Sub\n</code></pre>\n"}]