[{"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1478131153, "post_id": 40391737, "comment_id": 68035096, "body": "This looks like a good place for a user <code>Type</code> or custom <code>Class</code> as opposed to module level variables."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478172505, "post_id": 40391737, "comment_id": 68050523, "body": "As @Comintern mentioned, I would use a <code>Class</code> for this. Within your <code>Class</code>, you can use <code>Class_Initialize</code> and <code>Class_Terminate</code> to set these up"}], "owner": {"reputation": 2031, "user_id": 6097926, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/187bc2674bbdf7651e7137e1427b9bd6?s=128&d=identicon&r=PG&f=1", "display_name": "Ryszard J\u0119draszyk", "link": "https://stackoverflow.com/users/6097926/ryszard-j%c4%99draszyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478130994, "creation_date": 1478130994, "last_edit_date": 1531164843, "question_id": 40391737, "link": "https://stackoverflow.com/questions/40391737/vba-multiple-string-variables-avoid-referencing-to-them-many-times", "title": "VBA - multiple string variables - avoid referencing to them many times", "body": "<p>I'm trying to create an .xlsm web scraping template. I want it to stay very flexible. Perfectly I would like to declare all string variables, have them listed in an array and be able to assign each variable from an array VbNullstring value when needed by typying variable name only once.</p>\n\n<p>Is anything close to this possible? Maybe with scripting directories? </p>\n\n<pre><code>Public ScrapingCancelled As Boolean\nPublic IE As Object\nPublic WS As Worksheet\nPublic RegEx As New RegExp\nPublic Company As String, Address As String, Phone As String, Email As String, Website As String\nPublic resultCounter As Long\n\nPublic Sub ClearGlobals()\n\nScrapingCancelled = False\n\nSet IE = Nothing\nSet WS = Nothing\nSet RegEx = Nothing\n\nClearOutputVariables\n\nresultCounter = 1\n\nEnd Sub\n\nPublic Sub ClearOutputVariables()\n\nCompany = vbNullString\nAddress = vbNullString\nPhone = vbNullString\nEmail = vbNullString\nWebsite = vbNullString\n\nEnd Sub\n\n\nPublic Sub PrintResults()\n\nDim results As Variant 'not string because of phone numbers - they are converted from string to long in variant array\n\nresults = Array(Company, Address, Phone, Email, Website)\n\nWith WS\n    Range(.Cells(resultCounter, 1), .Cells(resultCounter, UBound(results) + 1)).Value2 = results\nEnd With\n\nClearOutputVariables\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": false, "score": 5, "last_activity_date": 1478130750, "creation_date": 1478130750, "answer_id": 40391718, "question_id": 40391574, "link": "https://stackoverflow.com/questions/40391574/convert-a-range-of-numbers-to-a-letter-in-excel/40391718#40391718", "title": "Convert a range of numbers to a letter in Excel", "body": "<p>Try this formula in B1:</p>\n\n<pre><code>=VLOOKUP(A1,{0,\"F\";4000,\"D\";6000,\"C\";8000,\"B\";10000,\"A\"},2,TRUE)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 0, "last_activity_date": 1478160446, "creation_date": 1478160446, "answer_id": 40396527, "question_id": 40391574, "link": "https://stackoverflow.com/questions/40391574/convert-a-range-of-numbers-to-a-letter-in-excel/40396527#40396527", "title": "Convert a range of numbers to a letter in Excel", "body": "<p>Played a little to see if I could shorten it using the repetitive patterns. </p>\n\n<p>The VLOOKUP is easier to understand</p>\n\n<pre><code>=CHOOSE(MAX(INT(A1/2000),1),\"F\",\"D\",\"C\",\"B\",\"A\")\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7096292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e737afd6de395fa94d6538dd3768e676?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Napoles", "link": "https://stackoverflow.com/users/7096292/alexander-napoles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1539, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1478160462, "creation_date": 1478129857, "last_edit_date": 1531161705, "question_id": 40391574, "link": "https://stackoverflow.com/questions/40391574/convert-a-range-of-numbers-to-a-letter-in-excel", "title": "Convert a range of numbers to a letter in Excel", "body": "<p>I have to define a range numbers to a rating and the rating is just one letter and based on the range of numbers the next cell should show the letter.</p>\n\n<pre><code>Example:\n10231 = A\n8034 = B\n6433 = C\n4542 = D\n1323 = F\n</code></pre>\n\n<ul>\n<li>Anything over 10000 Gets converted to letter A</li>\n<li>anything between 8000 and 9999 converted to letter B</li>\n<li>anything between 6000 and 7999 converted to letter C</li>\n<li>anything between 4000 and 5999 converted to letter D</li>\n<li>anything between 0 and 3999 converted to letter F</li>\n</ul>\n\n<p>If I enter number in A1 cell as 3214, in B1 cell I should get F \nCan we do this with simple formula? Or does this require VB?</p>\n"}, {"tags": ["vba", "macros"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478130878, "post_id": 40391512, "comment_id": 68035015, "body": "Could you provide more info? How exactly do you terminate the macro early? Where is your long running macro code running? Inside Form, Standard Module, some other Class Module? In general, it should be possible to add some Cancellation request which will &#39;from outside&#39; request the long running operation to interrupt and run some cleanup code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "edited": false, "score": 2, "creation_date": 1478131491, "post_id": 40391512, "comment_id": 68035176, "body": "Can you post your code?  Also consider posting your code on <a href=\"http://codereview.stackexchange.com/\">Code Review</a> ."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478131498, "post_id": 40391512, "comment_id": 68035177, "body": "Yes post the code please. I would suggest, instead of hitting <code>Esc</code>, to add some button which will request the code to terminate and which will execute the cleanup procedure."}], "answers": [{"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": false, "score": 0, "last_activity_date": 1478136677, "creation_date": 1478136677, "answer_id": 40392431, "question_id": 40391512, "link": "https://stackoverflow.com/questions/40391512/use-exit-code-cleanup-when-terminating-code-prematurely/40392431#40392431", "title": "Use Exit Code Cleanup When Terminating Code Prematurely", "body": "<p>Add e.g. <code>UserForm</code> which will have one button for <em>execution</em> of the long running operation and another button for premature <em>termination</em>. When you decide to terminate the operation prematurely just click the <em>cancel</em> button which sets the bool variable and do-loop will exit.</p>\n\n<blockquote>\n  <p>User Form code\n  <em>(add two command buttons named CancelCommandButton and ExecuteCommandButton)</em></p>\n</blockquote>\n\n<pre><code>Private Sub CancelCommandButton_Click()\n    CancelRequest = True\nEnd Sub\n\nPrivate Sub ExecuteCommandButton_Click()\n    Me.Repaint\n    CancelRequest = False\n    LongRunningTask\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>Standard Module code</p>\n</blockquote>\n\n<pre><code>Public CancelRequest As Boolean\n\nPublic Sub LongRunningTask() ' e.g. like CopyEntireFeeBoard()\n    ' ...\n\n    Dim result As Long\n    Do\n        result = result + 1\n\n        ' ...\n\n        ' At the and of the loop check the bool variable and exit if necessary\n        DoEvents\n        If CancelRequest Then\n            ' Do some cleanup\n            Exit Do\n        End If\n    Loop Until result = 100000000 ' A.GetText(26, aRow, 1, 1) = \" \"\n\n    ' ...\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": true, "score": 2, "last_activity_date": 1478142407, "creation_date": 1478142407, "answer_id": 40393209, "question_id": 40391512, "link": "https://stackoverflow.com/questions/40391512/use-exit-code-cleanup-when-terminating-code-prematurely/40393209#40393209", "title": "Use Exit Code Cleanup When Terminating Code Prematurely", "body": "<p>I revised your code to exit if the <code>Do Loop</code> when the <kbd>End</kbd> key is pressed.  </p>\n\n<p>In addition the data is collected into an array and written to the worksheet n one operation, after the loop is exited.  In this way, there is no need to toggle Calculations and Screen-Updating.</p>\n\n<p>The built-in VBA function <code>RTrim</code> does the samething that <code>RemoveSpaces</code> does but is more efficient.</p>\n\n<hr>\n\n<pre><code>Private Declare Function GetKeyState Lib \"user32\" (ByVal nVirtKey As Long) As Long\nConst VK_END = &amp;H23\n\nDim ATC As AccuTermClasses.AccuTerm, A As Session\n\nSub CopyEntireFeeBoard()\n\n    Set ATC = GetObject(, \"AtWin32.AccuTerm\")\n    Set A = ATC.ActiveSession\n    Dim AllData, RowData(1 To 9)\n\n    Dim xlRow As Long, x As Long   'Excel's and AccuTerm's Row #s\n    Dim Rate As Single, Name As String, Client As String, Desk As Byte\n    aRow = 3\n    ReDim AllData(0)\n\n    Do\n        ReDim Preserve AllData(x)\n\n        Rate = 0\n        On Error Resume Next    'Incase Rate is blank\n        Rate = A.GetText(47, aRow, 4, 1)\n        On Error GoTo 0\n\n        Client = RTrim(A.GetText(10, aRow, 7, 1))\n        If Client = \"100AAA\" Then Client = \"\"\n        Name = RemoveSpaces(A.GetText(26, aRow, 16, 1))\n        Desk = A.GetText(56, aRow, 2, 1)\n\n        RowData(1).Value = A.GetText(0, aRow, 8, 1)       'Date\n        RowData(2).Value = Client                        'Client\n        RowData(3).Value = A.GetText(18, aRow, 7, 1)     'DNUM\n        RowData(4).Value = Name                          'Name\n        RowData(5).Value = A.GetText(43, aRow, 3, 1)     'TC\n        If Rate &lt;&gt; 0 Then RowData(6).Value = Rate        'Rate\n        RowData(7).Value = A.GetText(52, aRow, 3, 1)     'STS\n        RowData(8).Value = Desk                          'DESK\n        RowData(9).Value = A.GetText(59, aRow, 10, 1)    'AMOUNT\n\n        AllData(x) = RowData\n        aRow = aRow + 1\n\n        ' Reached the end of host application's page.\n        If aRow = 22 Then\n\n            aRow = 3 'Reset AccuTerm's Starting Row\n            A.Output Chr(13)    'Enter key\n\n            ' Give time for the next screen to refresh\n            Application.Wait Now + TimeValue(\"00:00:01\")\n\n        End If\n\n        x = x + 1\n    Loop Until A.GetText(26, aRow, 1, 1) = \" \" Or GetKeyState(VK_END)\n\n    'Converts the Array of Arrays into a 2 Dimensional array\n    AllData = Transpose(AllData)\n    AllData = Transpose(AllData)\n\n    With Workbooks(\"2016 FEE BOARD.XLSM\")\n        .Range(\"A1\").Resize(UBound(data, 1) + 1, 9).Value = AllData\n    End With\n\n    Set ATC = Nothing\n    Set Sheet = Nothing\n    Set A = Nothing\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "anon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 0, "accepted_answer_id": 40393209, "answer_count": 2, "score": 1, "last_activity_date": 1478142407, "creation_date": 1478129455, "last_edit_date": 1478132416, "question_id": 40391512, "link": "https://stackoverflow.com/questions/40391512/use-exit-code-cleanup-when-terminating-code-prematurely", "title": "Use Exit Code Cleanup When Terminating Code Prematurely", "body": "<p>I am running a macro that can take some time in Excel. There may be times I need to terminate the macro early. Consequently, this causes the macro to not perform it's clean-up functions, for example: <code>Application.ScreenUpdating = True</code> since it's set to <code>False</code> prior to the <code>Do...Loop</code> statement I use. This will cause obvious issues, and I usually wind up adding the <code>True</code> statement followed by <code>End</code> at the very beginning of the macro just to fix the problem.</p>\n\n<p>Is there any method I can use to enable a post-terminate <code>GoTo</code> statement in my code? I understand it might not be when I click <code>Esc</code>, but what about a persistent box, similar to a <code>MsgBox</code> - but one that doesn't stop the code from running? I can use this box basically as a Cancel button, and this box can stay up for the entire duration of the macro without interrupting the macro's operation. Upon clicking the cancel button in said box, it will immediately stop normal operation and follow my <code>GoTo</code> command that will perform the necessary clean up duties.</p>\n\n<p>I have a strong feeling this is not possible, but figured I'd ask those who know VBA the best.</p>\n\n<pre><code>Option Explicit\n\nDim ATC As AccuTermClasses.AccuTerm, A As Session, Sheet As Worksheet\n\nFunction RemoveSpaces(MyString As String) As String\n    Do Until Right(MyString, 1) &lt;&gt; \" \"\n        MyString = Left(MyString, Len(MyString) - 1)\n    Loop\n    RemoveSpaces = MyString\nEnd Function\n\nSub CopyEntireFeeBoard()\n\n    Set ATC = GetObject(, \"AtWin32.AccuTerm\")\n    Set Sheet = Workbooks(\"2016 FEE BOARD.XLSM\").ActiveSheet\n    Set A = ATC.ActiveSession\n\n    Dim xlRow As Long, aRow As Integer   'Excel's and AccuTerm's Row #s\n    Dim Rate As Single, Name As String, Client As String, Desk As Byte\n    xlRow = 2   'Starting row\n    aRow = 3\n\n    Application.Calculation = xlCalculationManual\n    Do\n        Rate = 0\n        On Error Resume Next    'Incase Rate is blank\n        Rate = A.GetText(47, aRow, 4, 1)\n        On Error GoTo 0\n\n        Client = RemoveSpaces(A.GetText(10, aRow, 7, 1))\n        If Client = \"100AAA\" Then Client = \"\"\n        Name = RemoveSpaces(A.GetText(26, aRow, 16, 1))\n        Desk = A.GetText(56, aRow, 2, 1)\n\n        Sheet.Cells(xlRow, 1).Value = A.GetText(0, aRow, 8, 1)      'Date\n        Sheet.Cells(xlRow, 2).Value = Client                        'Client\n        Sheet.Cells(xlRow, 3).Value = A.GetText(18, aRow, 7, 1)     'DNUM\n        Sheet.Cells(xlRow, 4).Value = Name                          'Name\n        Sheet.Cells(xlRow, 5).Value = A.GetText(43, aRow, 3, 1)     'TC\n        If Rate &lt;&gt; 0 Then Sheet.Cells(xlRow, 6).Value = Rate        'Rate\n        Sheet.Cells(xlRow, 7).Value = A.GetText(52, aRow, 3, 1)     'STS\n        Sheet.Cells(xlRow, 8).Value = Desk                          'DESK\n        Sheet.Cells(xlRow, 9).Value = A.GetText(59, aRow, 10, 1)    'AMOUNT\n        xlRow = xlRow + 1\n        aRow = aRow + 1\n\n        ' Reached the end of host application's page.\n        If aRow = 22 Then\n\n            'Will go ahead and refresh Excel at this point\n            Application.Calculation = xlCalculationAutomatic\n\n            aRow = 3 'Reset AccuTerm's Starting Row\n            A.Output Chr(13)    'Enter key\n\n            ' Give time for the next screen to refresh\n            Application.Wait Now + TimeValue(\"00:00:01\")\n            Application.Calculation = xlCalculationManual\n        End If\n\n    Loop Until A.GetText(26, aRow, 1, 1) = \" \"\n\n    Application.Calculation = xlCalculationAutomatic\n\n    Set ATC = Nothing\n    Set Sheet = Nothing\n    Set A = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478145613, "post_id": 40390976, "comment_id": 68038437, "body": "You don&#39;t appear to have any criteria specified in your &quot;rules&quot;.  Is that intentional?"}, {"owner": {"reputation": 205, "user_id": 7016089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10211115229465070/picture?type=large", "display_name": "Leandro Moreira", "link": "https://stackoverflow.com/users/7016089/leandro-moreira"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478185741, "post_id": 40390976, "comment_id": 68060180, "body": "My Criteria is Range B3:M4 of the Sheet Rules. but I made a chance and now seems to be working. Thanks anyway"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478197743, "post_id": 40390976, "comment_id": 68067627, "body": "I just meant that (assuming your &quot;rules&quot; are the top part of the image) the criteria, i.e. cells B4:M4, were completely blank, which would mean you wouldn&#39;t be filtering on anything.  As long as it&#39;s working now though, that&#39;s all that matters."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 8125557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1159e6ccdaa3906ef7c2ec787e0d325?s=128&d=identicon&r=PG", "display_name": "user8125557", "link": "https://stackoverflow.com/users/8125557/user8125557"}, "is_accepted": false, "score": 1, "last_activity_date": 1500291258, "last_edit_date": 1500291258, "creation_date": 1500290746, "answer_id": 45143025, "question_id": 40390976, "link": "https://stackoverflow.com/questions/40390976/advanced-filter-not-working-vba/45143025#45143025", "title": "Advanced filter not working VBA", "body": "<p>Have you tried changing <code>\"Action:=xlFilterInPlace\"</code> to <code>\"Action:=xlFilterCopy\"</code> to copy the data to another worksheet. Because your method filters it in place, hides data and data only filtered by criteria is shown.</p>\n"}], "owner": {"reputation": 205, "user_id": 7016089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10211115229465070/picture?type=large", "display_name": "Leandro Moreira", "link": "https://stackoverflow.com/users/7016089/leandro-moreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1287, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1500291258, "creation_date": 1478126182, "last_edit_date": 1478142897, "question_id": 40390976, "link": "https://stackoverflow.com/questions/40390976/advanced-filter-not-working-vba", "title": "Advanced filter not working VBA", "body": "<p>I am trying to run an advanced filter, but when I run it, my data gets hidden..Do you know why?</p>\n\n<pre><code>Sub AdvancedFilter()\n'\n' AdvancedFilter Macro\n\n\n Range(\"E34\").Select\n    Range(\"E34:P\" &amp; Range(\"P\" &amp; Rows.Count).End(xlUp).Row).AdvancedFilter Action:=xlFilterInPlace, CriteriaRange:= _\n        Sheets(\"Rules\").Range(\"B3:M4\"), Unique:=False\nEnd Sub\n</code></pre>\n\n<p>So, attached my rules(which is same header) and where I want my data goes.</p>\n\n<p><a href=\"https://i.stack.imgur.com/n4l8Q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n4l8Q.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1478123095, "post_id": 40390287, "comment_id": 68032376, "body": "Just curious - why not declare <code>RangeToLock</code> as a <code>Range</code>?  Also, I think it&#39;s because <code>SpecialCells(2)</code> is the non-blank cells.  You may instead have to loop through that range, and set any cells <code>=&quot;X&quot;</code> as locked."}, {"owner": {"reputation": 3, "user_id": 7107003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe5980d5402366507433cd9b52776e7?s=128&d=identicon&r=PG&f=1", "display_name": "MZ100", "link": "https://stackoverflow.com/users/7107003/mz100"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1478123852, "post_id": 40390287, "comment_id": 68032715, "body": "@BruceWayne The code was adapted from a source as I was in a rush, I did think about declaring it as a range but didn&#39;t know if it would have an impact on the rest of it. I&#39;m still getting to grips with a lot of VBA so was unsure"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478126279, "post_id": 40390287, "comment_id": 68033687, "body": "Note that <code>Target</code> can contain more than one cell, so you can&#39;t use <code>Target.Value &lt;&gt; &quot;X&quot;</code> if <code>Target.Cells.Count &gt; 1</code> without a throwing type mismatch - you need to loop over the entire <code>Target</code>."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7107003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe5980d5402366507433cd9b52776e7?s=128&d=identicon&r=PG&f=1", "display_name": "MZ100", "link": "https://stackoverflow.com/users/7107003/mz100"}, "edited": false, "score": 0, "creation_date": 1478165552, "post_id": 40391225, "comment_id": 68046032, "body": "This is so helpful and is great in assisting my understanding, thank you. Works perfectly. I&#39;ve tried adding in some of my own code to make a vbyesno msbox appear when entering X, asking if they want to submit the value X and to ClearContents if they say no (I can&#39;t post here due to character limits). However, it gets stuck in a cycle. Additionally, I tried setting Target.Parent.Cells(c.Row, 13).Locked = True but it didn&#39;t work. Is there a better way to lock Column M too?  I really appreciate this help, I&#39;m actively trying to improve my knowledge in VBA."}, {"owner": {"reputation": 3, "user_id": 7107003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe5980d5402366507433cd9b52776e7?s=128&d=identicon&r=PG&f=1", "display_name": "MZ100", "link": "https://stackoverflow.com/users/7107003/mz100"}, "edited": false, "score": 0, "creation_date": 1478171922, "post_id": 40391225, "comment_id": 68050142, "body": "As this directly answered my question, I&#39;m selecting this as the correct answer. I figured out the issue with my own problem, if anyone needs that then see below answer from myself."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1478127727, "creation_date": 1478127727, "answer_id": 40391225, "question_id": 40390287, "link": "https://stackoverflow.com/questions/40390287/lock-cells-in-range-based-on-value-in-cell/40391225#40391225", "title": "Lock cells in range based on value in cell", "body": "<p>Based on your description, I'm guessing that you're over-thinking this.</p>\n\n<p>First, you seem to have the sheet locked with <code>UserInterfaceOnly</code>, which means that you don't even <em>have to</em> unlock anything at all.  Just change the <code>.Locked</code> property of the cell that you want to lock and don't mess with the protection of the sheet at all.</p>\n\n<p>Second, as I mentioned in the comments, <code>Target</code> will not always be just one cell (think copy-paste).  That means you have to loop over all of the cells in <code>Target</code> individually.  It also means that you can't test for <code>Target.Value &lt;&gt; \"X\"</code> before you test <code>If Target.Cells.Count &gt; 1</code> because you'll get a type mismatch run-time error if you get more than one cell.</p>\n\n<p>Third, unless you need to process other events based on writing the timestamp in column <code>L</code>, you should disable event processing before you write the change and re-enable it afterwards.  Currently you don't have any method to prevent re-entry into the event handler.</p>\n\n<p>That said, you can simplify the entire procedure to this, which is both safer and has the pleasant side effect of working:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n    Dim c As Range\n    For Each c In Target\n        If c.Column = 11 And c.Value = \"X\" Then\n            Application.EnableEvents = False\n            If Not c.Locked Then\n                c.Locked = True\n                Target.Parent.Cells(c.Row, 12).Value = Now\n            End If\n            Application.EnableEvents = True\n        End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Note that this assumes the worksheet is already protected.  If it isn't, either add the one-liner <code>If Not Me.ProtectionMode Then Me.Protect \"PWD\", , , , True</code> to the top of the procedure or (better) in the <code>Worksheet_Activate()</code> event.</p>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 7107003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe5980d5402366507433cd9b52776e7?s=128&d=identicon&r=PG&f=1", "display_name": "MZ100", "link": "https://stackoverflow.com/users/7107003/mz100"}, "is_accepted": false, "score": 0, "last_activity_date": 1478172281, "creation_date": 1478172281, "answer_id": 40400309, "question_id": 40390287, "link": "https://stackoverflow.com/questions/40390287/lock-cells-in-range-based-on-value-in-cell/40400309#40400309", "title": "Lock cells in range based on value in cell", "body": "<p>For my modified request to Comintern's answer,</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n\nIf Target.Cells.Count &gt; 1 Then Exit Sub\n\nPW = \"PWD\"\n\nDim iRet As Integer\nDim strPrompt As String\nDim strTitle As String\n\nstrPrompt = \"Are you sure you want to set this field to X?\"\nstrTitle = \"Alert\"\n\nIf Not Me.ProtectionMode Then Me.Protect PW, , , , True\nDim c As Range\nFor Each c In Target\n    If c.Column = 11 And c.Value &lt;&gt; \"X\" Then\n    Exit Sub\n\n    ElseIf c.Column = 11 And c.Value = \"X\" Then\n\n    iRet = MsgBox(strPrompt, vbYesNo, strTitle)\n\n     If iRet = vbNo Then\n        ActiveCell.ClearContents\n        ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True, Password:=PW\n        Exit Sub\n\n     ElseIf iRet = vbYes Then\n        Application.EnableEvents = False\n        If Not c.Locked Then\n            c.Locked = True\n            Target.Parent.Cells(c.Row, 13).Value = Now\n            Target.Parent.Cells(c.Row, 13).Locked = True\n        End If\n        Application.EnableEvents = True\n    End If\n    End If\n    Next\nEnd Sub\n</code></pre>\n\n<p>Any tips on how I could have simplified this or made this better are much appreciated!</p>\n"}], "owner": {"reputation": 3, "user_id": 7107003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fe5980d5402366507433cd9b52776e7?s=128&d=identicon&r=PG&f=1", "display_name": "MZ100", "link": "https://stackoverflow.com/users/7107003/mz100"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 541, "favorite_count": 0, "accepted_answer_id": 40391225, "answer_count": 2, "score": 0, "last_activity_date": 1478172281, "creation_date": 1478122861, "question_id": 40390287, "link": "https://stackoverflow.com/questions/40390287/lock-cells-in-range-based-on-value-in-cell", "title": "Lock cells in range based on value in cell", "body": "<p>I'm having a bit of an issue with a VBA code which aims to:</p>\n\n<ol>\n<li>Trigger once value \"X\" is found in Column K</li>\n<li>Paste the date in Column L on the same row</li>\n<li>Lock the cell in Column K so that the same sequence can't be run in the cell by the user selecting another value and then X again, as this would overwrite the date</li>\n</ol>\n\n<p>The current code I have is this:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Excel.Range)\n\nDim blnUnlockedAllCells As Boolean\n\n    If Target.Column = 11 And Target.Value &lt;&gt; \"X\" Then \n        Exit Sub\n\n    ElseIf Target.Column = 11 And Target.Value = \"X\" Then\n        ThisRow = Target.Row\n        If Target.Value &lt;&gt; \"\" Then\n            Range(\"L\" &amp; ThisRow).Value = Now\n            End If\n    End If\n\n    If Target.Value &lt;&gt; \"X\" Then Exit Sub\n\n    Const RangeToLock As String = \"K8:K1000\"\n\n    If Target.Cells.Count &gt; 1 Then Exit Sub\n\n\n    If Not blnUnlockedAllCells Then\n        Me.Cells.Locked = False\n        On Error Resume Next\n        Me.Range(CStr(RangeToLock)).SpecialCells(2).Locked = True\n        On Error GoTo 0\n        blnUnlockedAllCells = True\n        Me.Protect Password:=\"PWD\", userinterfaceonly:=True \n    End If\n\n    If Not Application.Intersect(Target, Me.Range(CStr(RangeToLock))) Is Nothing Then\n        If Len(Target) Then Target.Locked = True\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>It seems to lock all cells in RangeToLock that are not blank rather than the cells which are equal to \"X\".</p>\n\n<p>Any help would be appreciated, I'm entirely open to other suggestions about how to process any of the above.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478128158, "post_id": 40390284, "comment_id": 68034295, "body": "<a href=\"http://stackoverflow.com/q/39755639/4088852\">This question is possibly relevant.</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1478151636, "creation_date": 1478151636, "answer_id": 40394551, "question_id": 40390284, "link": "https://stackoverflow.com/questions/40390284/how-to-refer-to-header-rather-than-column/40394551#40394551", "title": "How to refer to header rather than column?", "body": "<p>The reason to use R1C1 notation is so that you can assign relative formula across a range of cells.  There is no need to loop over individual cells.  Simply define a range and the formula to the entire range.</p>\n\n<p>Here are 4 ways to define the range and assign a formula to it.  Each method has a slightly different approach but all the methods return the same results.  </p>\n\n<p>If first three methods use <code>.End(xlDown)</code> and will not work properly if there is only 1 row of data.</p>\n\n<p>Method 4 is probably the best.  It uses <code>.End(xlUp)</code> and will fail if you have multiple lists in column 7.</p>\n\n<p>The 2nd, 3rd and 4th methods first define a range that extends from <code>Cell(2, 7) to the last used cell and then extends the range to include all the cells in those rows using</code>EntireRow<code>.  In this way you will not need to calculate the offset of the columns.  Next</code>Columns(120)` is used to target all the cells in column 120 of the range.   </p>\n\n<hr>\n\n<p><strong>Note:</strong> I think this is what you are wanting to use.</p>\n\n<p>Methods 3 &amp; 4 uses a different variation of the R1C1 notation.  Instead of using the offset of column 120 it uses the actual column number of the current row.  For example:  Instead of using the offset of column 120 <code>RC[-86]</code> to refer to column  34 (120-86) it uses <code>RC34</code>.</p>\n\n<hr>\n\n<pre><code>With Sheets(\"Macro Time\")\n    With .Range(.Cells(2, 7), .Cells(2, 7).End(xlDown)).Offset(0, 113)\n        .FormulaR1C1 = \"=IFERROR(\"\"\"\"&amp;RC[-86]&amp;\"\" / \"\"&amp;RC[-103]&amp;\"\" \"\"&amp;RC[-102]&amp;\"\" \"\"&amp;RC[-101]&amp;\"\"\"\",)\"\n        .Value = .Value\n    End With\nEnd With\n\nWith Sheets(\"Macro Time\")\n    With .Range(.Cells(2, 7), .Cells(2, 7).End(xlDown)).EntireRow.Columns(120)\n        .FormulaR1C1 = \"=IFERROR(\"\"\"\"&amp;RC[-86]&amp;\"\" / \"\"&amp;RC[-103]&amp;\"\" \"\"&amp;RC[-102]&amp;\"\" \"\"&amp;RC[-101]&amp;\"\"\"\",)\"\n        .Value = .Value\n    End With\nEnd With\n\nWith Sheets(\"Macro Time\")\n    With .Range(.Cells(2, 7), .Cells(2, 7).End(xlDown)).EntireRow.Columns(120)\n        .FormulaR1C1 = \"=IFERROR(\"\"\"\"&amp;RC34 &amp;\"\" / \"\"&amp;RC17&amp;\"\" \"\"&amp;RC18&amp;\"\" \"\"&amp;RC19&amp;\"\"\"\",)\"\n        .Value = .Value\n    End With\nEnd With\n\nWith Sheets(\"Macro Time\")\n    With .Range(.Cells(2, 7), .Cells(.Rows.Count, 7).End(xlUp)).EntireRow.Columns(120)\n        .FormulaR1C1 = \"=IFERROR(\"\"\"\"&amp;RC34 &amp;\"\" / \"\"&amp;RC17&amp;\"\" \"\"&amp;RC18&amp;\"\" \"\"&amp;RC19&amp;\"\"\"\",)\"\n        .Value = .Value\n    End With\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6373301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c10d92d38321c0ab3c238f4077d00cd3?s=128&d=identicon&r=PG&f=1", "display_name": "Justin German", "link": "https://stackoverflow.com/users/6373301/justin-german"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1606478271, "creation_date": 1478122850, "last_edit_date": 1606478271, "question_id": 40390284, "link": "https://stackoverflow.com/questions/40390284/how-to-refer-to-header-rather-than-column", "title": "How to refer to header rather than column?", "body": "<p>I'm looking to change this code so instead of referring to a column by RC number it refers to it by the name of the header.</p>\n<p>The end result looks as simple as this:<br />\nPRESTIGE WORLDWIDE  INC. / 123 TacoTaco DR</p>\n<p>The address is broken out into three columns which are RC-103 102 101 in the code.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ProjectName()\n\n    Dim ws As Excel.Worksheet\n\n    Set ws = ActiveWorkbook.Sheets(&quot;Macro Time&quot;) ' change to name of your sheet\n\n    Dim x As Long\n\n    x = 2 '************CHANGE BACK TO 2********************\n    \n    Do Until ws.Cells(x, 7) = &quot;&quot;\n    \n        With ws.Cells(x, 120)   \n            .Value = &quot;=iferror(&quot;&quot;&quot;&quot;&amp;RC[-86]&amp;&quot;&quot; / &quot;&quot;&amp;RC[-103]&amp;&quot;&quot; &quot;&quot;&amp;RC[-102]&amp;&quot;&quot; &quot;&quot;&amp;RC[-101]&amp;&quot;&quot;&quot;&quot;,)&quot;\n            .Value = .Value\n        End With\n        \n        x = x + 1\n\n    Loop\n\nEnd Sub\n</code></pre>\n<p>I tried a few methods and failed with all of them.</p>\n<p>I will need to do this to about 300 separate RC numbers and plan to do this probably close to 1,000 more times in multiple spreadsheets.</p>\n<hr />\n<p>This was the answer.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>Sub ProjectName()\n    Application.ScreenUpdating = False\n    \n    Dim ws As Excel.Worksheet\n    \n    Set ws = ActiveWorkbook.Sheets(&quot;Macro Time&quot;) ' change to name of your sheet\n\n    Dim projectCell As Range ' Project Name\n    Dim amlCell As Range ' AML_PROV_PATH\n    Dim ultCustNameCell As Range ' ULTIMATE_CUST_NAME\n    Dim sanoCell As Range ' SANO\n    Dim sasnCell As Range ' SASN\n    Dim sathCell As Range ' SATH\n    \n    Set projectCell = FINDCOLUMN(&quot;Project Name&quot;)\n    Set amlCell = FINDCOLUMN(&quot;AML_PROV_PATH&quot;)\n    Set ultCustNameCell = FINDCOLUMN(&quot;ULTIMATE_CUST_NAME&quot;)\n    Set sanoCell = FINDCOLUMN(&quot;SANO&quot;)\n    Set sasnCell = FINDCOLUMN(&quot;SASN&quot;)\n    Set sathCell = FINDCOLUMN(&quot;SATH&quot;)\n    \n    Dim x As Long\n    x = 2 '************CHANGE BACK TO 2********************\n    \n    Do Until ws.Cells(x, amlCell.Column) = &quot;&quot;\n    \n        With ws.Cells(x, projectCell.Column)\n            .Value = &quot;=iferror(&quot;&quot;&quot; &amp; ws.Cells(x, ultCustNameCell.Column).Text &amp; &quot; / &quot; _\n                               &amp; ws.Cells(x, sanoCell.Column).Text &amp; &quot; &quot; _\n                               &amp; ws.Cells(x, sasnCell.Column).Text &amp; &quot; &quot; _\n                               &amp; ws.Cells(x, sathCell.Column).Text &amp; &quot;&quot;&quot; ,)&quot;\n            .Value = .Value\n        End With\n        \n        x = x + 1\n    Loop\n\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1478121147, "creation_date": 1478121147, "answer_id": 40389874, "question_id": 40389718, "link": "https://stackoverflow.com/questions/40389718/create-a-copy-of-a-worksheet-and-name-it-based-on-a-list/40389874#40389874", "title": "Create a copy of a worksheet and name it based on a list", "body": "<p>Per your edit, you could use this:</p>\n\n<pre><code>Sub VisibleSheetsCount()\n'UpdatebyKutoolsforExcel20150909\n' https://www.extendoffice.com/documents/excel/3187-excel-count-visible-sheets.html\n\u00a0\u00a0\u00a0\u00a0Dim xSht As Variant\n\u00a0\u00a0\u00a0\u00a0Dim I As Long\n\u00a0\u00a0\u00a0\u00a0For Each xSht In ActiveWorkbook.Sheets\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0If xSht.Visible Then I = I + 1\n\u00a0\u00a0\u00a0\u00a0Next\n\u00a0\u00a0\u00a0\u00a0MsgBox I &amp; \" sheets are visible\", , \"Kutools for Excel\"\nEnd Sub\n</code></pre>\n\n<p>Then do <code>.Copy(After:=Sheets(I))</code> I think would work.</p>\n"}, {"comments": [{"owner": {"reputation": 7, "user_id": 7082434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-iTxCwvUuAEc/AAAAAAAAAAI/AAAAAAAAADU/K-IuZ0Vc5co/photo.jpg?sz=128", "display_name": "David Pannell", "link": "https://stackoverflow.com/users/7082434/david-pannell"}, "edited": false, "score": 0, "creation_date": 1478727888, "post_id": 40390412, "comment_id": 68274752, "body": "I tried implementing this but for some reason it still stops early - it creates one sheet, renames it and copies the value into C1, but after that it copies the the original sheet and quits even though there are still several items left in the list. There aren&#39;t any hidden sheets or anything like that to hang it up so I&#39;m at wits end..."}, {"owner": {"reputation": 7, "user_id": 7082434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-iTxCwvUuAEc/AAAAAAAAAAI/AAAAAAAAADU/K-IuZ0Vc5co/photo.jpg?sz=128", "display_name": "David Pannell", "link": "https://stackoverflow.com/users/7082434/david-pannell"}, "edited": false, "score": 0, "creation_date": 1478734556, "post_id": 40390412, "comment_id": 68277226, "body": "I figured it out - the value of the cell was too long and it was throwing an error. I resized the cells and it works like a charm. Thanks!!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478757574, "post_id": 40390412, "comment_id": 68282651, "body": "You are welcome. You may then want to accept my answer and give people reading this thread this is the working answer to your question. Thank you!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 2, "last_activity_date": 1478123495, "creation_date": 1478123495, "answer_id": 40390412, "question_id": 40389718, "link": "https://stackoverflow.com/questions/40389718/create-a-copy-of-a-worksheet-and-name-it-based-on-a-list/40390412#40390412", "title": "Create a copy of a worksheet and name it based on a list", "body": "<p>After Copy() method of Worksheet object the newly created worksheet is the <em>active</em> one:</p>\n\n<pre><code>For Each MyCell In MyRange\n    If MyCell.Value = \"\" Then GoTo GetOut\n\n    Sheets(\"StrategicMktPlan\").Copy After:=Sheets(Sheets.Count)\n    With ActiveSheet\n        .Name = \"SMP - \" &amp; MyCell.Value\n        .Range(\"C1\").Value = MyCell.Value\n     End With\nNext MyCell\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 7082434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-iTxCwvUuAEc/AAAAAAAAAAI/AAAAAAAAADU/K-IuZ0Vc5co/photo.jpg?sz=128", "display_name": "David Pannell", "link": "https://stackoverflow.com/users/7082434/david-pannell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 40390412, "answer_count": 2, "score": 0, "last_activity_date": 1478123495, "creation_date": 1478120478, "question_id": 40389718, "link": "https://stackoverflow.com/questions/40389718/create-a-copy-of-a-worksheet-and-name-it-based-on-a-list", "title": "Create a copy of a worksheet and name it based on a list", "body": "<p>Hi I'm trying to create a copy of a worksheet in a workbook for each entry in a range, then rename the worksheet based on the value of the current cell in that range. It was working before, but now it doesn't name the new sheets. If I make blank worksheets, it will name them, however if I copy the worksheet it won't name the worksheet properly. I am also trying to set the value of C1 on each sheet to the value that is from the range. Below is my code:</p>\n\n<pre><code>    Sub CreateSEMSheets()\n    On Error GoTo GetOut\n\n\n    Dim MyCell As Range, MyRange As Range\n\n    Set MyRange = Sheets(\"Strategic End Market Data\").Range(\"SEMListGenerated\")\n\n    For Each MyCell In MyRange\n    If MyCell.Value = \"\" Then GoTo GetOut\n\n        Sheets(\"StrategicMktPlan\").Copy After:=Sheets(Sheets.Count)\n        Sheets(Sheets.Count).Name = \"SMP - \" &amp; MyCell.Value\n        Sheets(Sheets.Count).Range(\"C1\").Value = MyCell.Value\n    Next MyCell\n\nGetOut:\n\nEnd Sub\n</code></pre>\n\n<p>Please help!!! Thanks in advance.</p>\n\n<p><strong>Edit: I figured out why it's not working - there was a hidden sheet that was the last sheet in the workbook and it was renaming that over and over. Any idea how to prevent this?</strong></p>\n"}, {"tags": ["excel", "vba", "ms-project"], "comments": [{"owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1478120283, "post_id": 40389578, "comment_id": 68030988, "body": "What do you mean by mapping? Will the 2000 new files be blank? If not, what is the source of the content?"}, {"owner": {"reputation": 31, "user_id": 6859977, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e75849e8c7a52b03054e985377a4ad86?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/6859977/jim"}, "reply_to_user": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "edited": false, "score": 0, "creation_date": 1478120569, "post_id": 40389578, "comment_id": 68031159, "body": "@RachelHettinger When you import an excel file to Microsoft Project, you choose mapping for each category on project. The 2000 new files would have the data from the specific row in excel that they are created from. The source of the content is my excel file."}], "answers": [{"comments": [{"owner": {"reputation": 26453, "user_id": 2118383, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/JhgC9.jpg?s=128&g=1", "display_name": "Vignesh Kumar A", "link": "https://stackoverflow.com/users/2118383/vignesh-kumar-a"}, "edited": false, "score": 0, "creation_date": 1592558980, "post_id": 40390372, "comment_id": 110474595, "body": "Can you please share some sample code / method? which will be helpful to develop? Also, i have posted question here <a href=\"https://stackoverflow.com/questions/62467266/automate-import-excel-into-microsoft-project-using-vba\" title=\"automate import excel into microsoft project using vba\">stackoverflow.com/questions/62467266/&hellip;</a>"}], "tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": false, "score": 2, "last_activity_date": 1478123266, "creation_date": 1478123266, "answer_id": 40390372, "question_id": 40389578, "link": "https://stackoverflow.com/questions/40389578/automate-creating-n-microsoft-project-files-from-an-excel-file-with-n-rows/40390372#40390372", "title": "Automate creating n Microsoft Project files from an excel file with n rows", "body": "<p>You can do this in an automated way either from Project or Excel using the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff867007(v=office.15).aspx\" rel=\"nofollow noreferrer\">FileOpenEx</a> method of the Project application object to create a schedule file and load it with tasks from an Excel or csv file. This method has a parameter where you can specify the name of a map stored in your global file.</p>\n\n<p>Presuming you are automating Project from Excel, the basic steps are:</p>\n\n<ol>\n<li>Create a reference to the Project application (<code>CreateObject</code>)</li>\n<li>Loop through your list of projects (rows in your Excel file)\n\n<ul>\n<li>Use the FileOpenEx method to create a Project file for each one</li>\n<li>Close the Project file</li>\n</ul></li>\n</ol>\n\n<p>The source data for each of the schedule files needs to be in its own file (Excel or csv) as the FileOpenEx method will import all rows into the new schedule file. </p>\n\n<p>If your source data is all in one Excel file and the number of tasks for each schedule is small, you can automate adding the tasks one-by-one (use <a href=\"https://msdn.microsoft.com/en-us/library/office/ff863202.aspx\" rel=\"nofollow noreferrer\">Projects.Add</a> for a new project, then <a href=\"https://msdn.microsoft.com/en-us/library/office/ff865929.aspx\" rel=\"nofollow noreferrer\">Tasks.Add</a>).</p>\n"}], "owner": {"reputation": 31, "user_id": 6859977, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/e75849e8c7a52b03054e985377a4ad86?s=128&d=identicon&r=PG&f=1", "display_name": "Jim", "link": "https://stackoverflow.com/users/6859977/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 358, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593559467, "creation_date": 1478119936, "last_edit_date": 1593559467, "question_id": 40389578, "link": "https://stackoverflow.com/questions/40389578/automate-creating-n-microsoft-project-files-from-an-excel-file-with-n-rows", "title": "Automate creating n Microsoft Project files from an excel file with n rows", "body": "<p>How would I go about creating n Microsoft Project files from an Excel file with n rows using some form of automation? There are about 2000 rows in my excel file and i would like to create 2000 Microsoft Project files that utilize the same mapping as one another. I would like to automate this rather than do each manually. </p>\n"}, {"tags": ["vba", "hyperlink", "colors", "ms-word", "macros"], "comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 1, "creation_date": 1478122930, "post_id": 40388765, "comment_id": 68032297, "body": "That code would not run for me. There is no <code>ActiveDocument.Selection</code> property, so it was erroring there to begin with. Also, the <code>Add</code> method requires that you have an Address or a SubAddress or both, but not neither. Where do you want the hyperlink to go?"}], "answers": [{"tags": [], "owner": {"reputation": 1703, "user_id": 1174399, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a14a1c76042e287e36b1c765fb1eaaa5?s=128&d=identicon&r=PG", "display_name": "Don Jewett", "link": "https://stackoverflow.com/users/1174399/don-jewett"}, "is_accepted": true, "score": 1, "last_activity_date": 1478127739, "creation_date": 1478127739, "answer_id": 40391228, "question_id": 40388765, "link": "https://stackoverflow.com/questions/40388765/color-of-new-ms-word-hyperlink-is-black-and-i-want-it-to-be-blue/40391228#40391228", "title": "Color of new MS Word hyperlink is black and I want it to be blue", "body": "<p>If you want to create a hyperlink using the selected text as the link and text, this should work fine:</p>\n\n<pre><code>Sub subHyprlinkSrch4PdfFiles_aaa()\n\n    With Application.Selection\n        .Font.ColorIndex = wdBlue\n        ActiveDocument.Hyperlinks.Add Selection.Range, .Text, \"\", \"\", .Text\n        .Style = wdStyleHyperlink\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 657, "user_id": 235218, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/070cd829f2413b16d521c5f4aaa7db95?s=128&d=identicon&r=PG", "display_name": "Marc B. Hankin", "link": "https://stackoverflow.com/users/235218/marc-b-hankin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 0, "accepted_answer_id": 40391228, "answer_count": 1, "score": 0, "last_activity_date": 1478188544, "creation_date": 1478116949, "last_edit_date": 1478188544, "question_id": 40388765, "link": "https://stackoverflow.com/questions/40388765/color-of-new-ms-word-hyperlink-is-black-and-i-want-it-to-be-blue", "title": "Color of new MS Word hyperlink is black and I want it to be blue", "body": "<p>I'm an amateur at vba for Word.\nMy macro (below) creates a hyperlink from selected text, but the new hyperlink is black, whereas a hyperlink that I create using MS Word's menu, is blue.\nI want my macro to create hyperlinks that are blue too.\nAs you'll see in my macro (below), I've not been able to get the hyperlinks to be blue.\nAny suggestions would be much appreciated.</p>\n\n<pre><code>        Marc\n</code></pre>\n\n<p>Here's the macro:</p>\n\n<pre><code>Sub subHyprlinkSrch4PdfFiles_aaa()\n'\n' subHyprlinkSrch4PdfFiles_aaa Macro\n'\n'\n    Dim strTextToDisplay As String\n    Dim rngSelection As RAnge\n\n    Selection.MoveDown Unit:=wdLine, Count:=2\n    Selection.MoveLeft Unit:=wdCharacter, Count:=5\n    Selection.MoveLeft Unit:=wdCharacter, Count:=9, Extend:=wdExtend\n    Set rngSelection = ActiveDocument.Selection.RAnge\n\n    Application.Selection.Font.ColorIndex = wdBlue\n    strTextToDisplay = Application.Selection.Text\n    ActiveDocument.Hyperlinks.Add Anchor:=Selection.RAnge, Address:=\"\" _\n        , SubAddress:=\"\", ScreenTip:=\"\", TextToDisplay:=strTextToDisplay\n    Application.Selection.Style = wdStyleHyperlink\n    Application.Selection.Font.ColorIndex = wdBlue\n    With rngSelection\n        .Font.ColorIndex = wdBlue\n    End With\n\n\nEnd Sub 'subHyprlinkSrch4PdfFiles_aaa()\n</code></pre>\n\n<p>Here's the sub that I fixed with the solution User Don Jewett gave me yesterday, Nov. 2, 2016 (below):</p>\n\n<pre><code>Sub subHyperlinkSelectedTextaaa() 'Hyperlink  to a file whatever text you selected.\n    'Hyperlink  to a file whatever text you selected.\n\n    ' http://www.wiseowl.co.uk/blog/s209/type-filedialog.htm\n\n    Dim Sel01 As Selection\n    Dim fd As FileDialog\n    Set fd = Application.FileDialog(msoFileDialogFilePicker)\n    Dim iFileChosen As Integer\n    Dim strFileFullname As String\n    Dim Txt2Display As String\n\n\n    Set Sel01 = Application.Selection\n\n    If Sel01.Type &lt;&gt; wdSelectionIP Then ' i.e., if the selection is valid, i.e., characters are selected\n        Txt2Display = Sel01.Text\n        'MsgBox Txt2Display\n    Else\n        MsgBox \"No characters were selected validly; so this macro will terminate now.\"\n        Exit Sub\n    End If 'If Sel01.Type &lt;&gt; wdSelectionIP Then ' i.e., if the selection is valid, i.e., characters are selected\n\n\n\n    ' Open FileDialog \"fd\" and select a file\n    iFileChosen = fd.Show\n        If iFileChosen &lt;&gt; -1 Then\n            'You didn't choose anything (clicked on CANCEL)\n            MsgBox \"You chose cancel, or something prevented the file-selection-dialog from operating property.\"\n        Else\n            strFileFullname = CStr(fd.SelectedItems(1))\n            'MsgBox strFileFullname\n        End If\n\n\n    ' http://stackoverflow.com/questions/40388765/color-of-new-ms-word-hyperlink-is-black-and-i-want-it-to-be-blue\n    With Application.Selection\n        .Font.ColorIndex = wdBlue\n        'ActiveDocument.Hyperlinks.Add Selection.Range, .Text, \"\", \"\", .Text\n        ActiveDocument.Hyperlinks.Add Anchor:=Selection.Range, Address:= _\n           strFileFullname, SubAddress:=\"\", ScreenTip:=\"\", TextToDisplay:=Txt2Display\n        .Style = wdStyleHyperlink\n    End With\n\n\nEnd Sub 'subHyperlinkSelectedTextaaa()\n</code></pre>\n"}, {"tags": ["html", "vba", "excel", "internet-explorer"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478116779, "post_id": 40388599, "comment_id": 68029125, "body": "Just <code>Set ieDoc = ie.Document</code> again after you load a new page."}, {"owner": {"reputation": 77, "user_id": 6836499, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-yXfx0SPe7os/AAAAAAAAAAI/AAAAAAAAADI/NbUOZbcoXvQ/photo.jpg?sz=128", "display_name": "Bryce Draper", "link": "https://stackoverflow.com/users/6836499/bryce-draper"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478117080, "post_id": 40388599, "comment_id": 68029285, "body": "@Comintern Unfortunately this does not work. I should have included that I have already tried this."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1478120601, "post_id": 40388599, "comment_id": 68031174, "body": "are you positive that the textbox <b>always</b> has this id on the new page? <code>00Nj0000009FpF9</code>. Also try <code>Dim ieDoc as Object</code> in both places and see what happens."}, {"owner": {"reputation": 77, "user_id": 6836499, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-yXfx0SPe7os/AAAAAAAAAAI/AAAAAAAAADI/NbUOZbcoXvQ/photo.jpg?sz=128", "display_name": "Bryce Draper", "link": "https://stackoverflow.com/users/6836499/bryce-draper"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1478121233, "post_id": 40388599, "comment_id": 68031513, "body": "@ScottHoltzman Yes, the textbox does always have the id. The code to edit it works when I navigate directly to the page that contains it - it just doesn&#39;t work if I navigate to that page from another.  I tried <code>Dim ieDoc as Object</code> instead of as HTMLdocument in both the sub and function but this did not change anything."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1478122296, "post_id": 40388599, "comment_id": 68032019, "body": "sorry i can&#39;t be more help, i did something very similar and had it working very smooth, but unfortunately i am no longer with that project :("}, {"owner": {"reputation": 77, "user_id": 6836499, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-yXfx0SPe7os/AAAAAAAAAAI/AAAAAAAAADI/NbUOZbcoXvQ/photo.jpg?sz=128", "display_name": "Bryce Draper", "link": "https://stackoverflow.com/users/6836499/bryce-draper"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1478122821, "post_id": 40388599, "comment_id": 68032247, "body": "No worries @ScottHoltzman . I really appreciate you trying! :)"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478130335, "post_id": 40388599, "comment_id": 68034891, "body": "Could you post the URL where you navigate? In variable <code>strHTML</code>."}, {"owner": {"reputation": 77, "user_id": 6836499, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-yXfx0SPe7os/AAAAAAAAAAI/AAAAAAAAADI/NbUOZbcoXvQ/photo.jpg?sz=128", "display_name": "Bryce Draper", "link": "https://stackoverflow.com/users/6836499/bryce-draper"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478181710, "post_id": 40388599, "comment_id": 68057086, "body": "@dee It is an internal salesforce page.Unfortunately, it&#39;s no use to anyone without login credentials. :("}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478182623, "post_id": 40388599, "comment_id": 68057703, "body": "Hmm so look in the java script of the button <code>New Service Note</code> and check the URL where the browser navigates. Use this URL with your <code>IE.navigate</code> then."}, {"owner": {"reputation": 77, "user_id": 6836499, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-yXfx0SPe7os/AAAAAAAAAAI/AAAAAAAAADI/NbUOZbcoXvQ/photo.jpg?sz=128", "display_name": "Bryce Draper", "link": "https://stackoverflow.com/users/6836499/bryce-draper"}, "reply_to_user": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478185891, "post_id": 40388599, "comment_id": 68060299, "body": "@dee Unfortunately, that URL changes depending on which project is accessed through the <code>strHTML</code> variable, which is why I have it click the button (which always has the same name) instead of navigate directly to the webpage. I seem to have created a perfect storm of a problem, huh? :P. Thank you very much for all your help."}], "answers": [{"tags": [], "owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "is_accepted": true, "score": 0, "last_activity_date": 1478190727, "last_edit_date": 1478190727, "creation_date": 1478190326, "answer_id": 40406639, "question_id": 40388599, "link": "https://stackoverflow.com/questions/40388599/unable-to-reset-html-document-after-navigating-to-page-in-vba/40406639#40406639", "title": "Unable to reset HTML document after navigating to page in VBA", "body": "<p>I have created two pages where the first page contains the button and the second page contains the text box. Bellow the code which works fine, the text box is filled. So this simple example shows that it should work. Why is it not working with your internal page? No idea. Could it be that you have some <code>IFrame</code> there?  </p>\n\n<pre><code>' Add reference to Microsoft Internet Controls (SHDocVw)\n' Add reference to Microsoft HTML Object Library\n\nSub AddInfoFromIntranet()\n    Dim ie As SHDocVw.InternetExplorer\n    Dim doc As MSHTML.HTMLDocument\n    Dim url As String\n\n    url = \"file:///c:/My Web Sites/main.html\"\n    Set ie = New SHDocVw.InternetExplorer\n    ie.Visible = True\n    ie.navigate url\n    While ie.Busy Or ie.readyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Wend\n\n    Dim newServiceNoteButton As MSHTML.HTMLInputElement\n    Set doc = ie.document\n    Set newServiceNoteButton = doc.querySelector(\"input[title='New Service Note']\")\n\n    If (Not newServiceNoteButton Is Nothing) Then\n        newServiceNoteButton.Click\n        While ie.Busy Or ie.readyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Wend\n        Set doc = ie.document\n        Dim targetTextBox As MSHTML.HTMLInputElement\n        Set targetTextBox = doc.getElementById(\"00Nj0000009FpF9\")\n        If Not targetTextBox Is Nothing Then targetTextBox.Value = \"Placeholder Text\"\n    End If\n    ie.Quit\n    Set ie = Nothing\nEnd Sub\n</code></pre>\n\n<blockquote>\n  <p>First page <em>main.html</em></p>\n</blockquote>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;!-- saved from url=(0014)about:internet --&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n&lt;meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\" /&gt;\n&lt;title&gt;Untitled 1&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;input type=\"button\" title=\"New Service Note\" value=\"Test\" onclick=\"location.href='next.html';\"&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<blockquote>\n  <p>Second page <em>next.html</em></p>\n</blockquote>\n\n<pre><code>&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;!-- saved from url=(0014)about:internet --&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n&lt;head&gt;\n&lt;meta content=\"text/html; charset=utf-8\" http-equiv=\"Content-Type\" /&gt;\n&lt;title&gt;Untitled 1&lt;/title&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;input type=\"text\" id=\"00Nj0000009FpF9\"&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 77, "user_id": 6836499, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-yXfx0SPe7os/AAAAAAAAAAI/AAAAAAAAADI/NbUOZbcoXvQ/photo.jpg?sz=128", "display_name": "Bryce Draper", "link": "https://stackoverflow.com/users/6836499/bryce-draper"}, "is_accepted": false, "score": 1, "last_activity_date": 1478207478, "creation_date": 1478207478, "answer_id": 40411304, "question_id": 40388599, "link": "https://stackoverflow.com/questions/40388599/unable-to-reset-html-document-after-navigating-to-page-in-vba/40411304#40411304", "title": "Unable to reset HTML document after navigating to page in VBA", "body": "<p>@dee You have gone to great lengths to answer this question. Thank you so much!</p>\n\n<p>Your answer wasn't what solved it for me, but it is the reason I was able to solve it. You mentioned that it could be a frame which made us (a coworker and I) realize that IE may be finishing a process prior to a frame finishing loading.</p>\n\n<p>The fix was as simple as adding</p>\n\n<pre><code>Application.wait DateAdd(\"s\", 5, Now)\n</code></pre>\n\n<p>after </p>\n\n<pre><code>While ie.busy Or ie.ReadyState&lt;&gt; Readystate_complete: DoEvents: Wend\n</code></pre>\n\n<p>The last bit of the code now reads</p>\n\n<pre><code>While ie.Busy Or ie.ReadyState &lt;&gt; READYSTATE_COMPLETE: DoEvents: Wend\n\nApplication.Wait DateAdd(\"s\", 5, Now)\n\niedoc.getElementById(\"00Nj0000009FpF9\").Value = \"Place holder Text\"\n\nCall ClickButton(ieDoc, \"Save\")\n</code></pre>\n\n<p>It is an inelegant solution, but it does the job.</p>\n\n<p>Thank you again for your help. I will be implementing a few of the other changes you made to make my code more explicit and more easily readable.</p>\n"}], "owner": {"reputation": 77, "user_id": 6836499, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-yXfx0SPe7os/AAAAAAAAAAI/AAAAAAAAADI/NbUOZbcoXvQ/photo.jpg?sz=128", "display_name": "Bryce Draper", "link": "https://stackoverflow.com/users/6836499/bryce-draper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1766, "favorite_count": 0, "accepted_answer_id": 40406639, "answer_count": 2, "score": 2, "last_activity_date": 1478207478, "creation_date": 1478116329, "last_edit_date": 1495540845, "question_id": 40388599, "link": "https://stackoverflow.com/questions/40388599/unable-to-reset-html-document-after-navigating-to-page-in-vba", "title": "Unable to reset HTML document after navigating to page in VBA", "body": "<p>I'm using VBA to navigate IE and am having trouble resetting the document object so that I can navigate through multiple pages. I used the answer to <a href=\"https://stackoverflow.com/questions/29660589/using-vba-to-navigate-web-page-maniuplate-ie-via-access\">this</a> question to help create the original script, but am running in to a very similar problem that poster ran in to. Unfortunately, the answer listed does not help or guide me to a solution.</p>\n\n<p>I'm using the following code to pull the page and navigate.</p>\n\n<pre><code>Sub UpdatesalesNotes()\n\nDim ie As Object, ieDoc As HTMLDocument\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\nie.Visible = True\n\nstrHTML = ActiveSheet.Range(\"A31\").Value\n\nie.navigate strHTML\n\n'wait for browser\nWhile ie.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nWend\n\n\nSet ieDoc = ie.Document\n\nCall ClickButton(ieDoc, \"New Service Note\")\n\n'wait for browser\nWhile ie.ReadyState &lt;&gt; READYSTATE_COMPLETE\n    DoEvents\nWend\n\n\nieDoc.getElementById(\"00Nj0000009FpF9\").Value = \"Placeholder Text\"\n\n\nCall ClickButton(ieDoc, \"Save\")\n\nEnd Sub\n</code></pre>\n\n<p>The element I'm interacting with on the second page is a text box. The function called (which works fine) is listed below.</p>\n\n<pre><code>Function ClickButton(ieDoc As HTMLDocument, ByVal strButtonName As String)\nDim objInputs As Object, ele As Variant\nSet objInputs = ieDoc.getElementsByTagName(\"input\")\n\nFor Each ele In objInputs\n    If ele.Title = strButtonName Then\n        ele.Click\n    End If\nNext\nEnd Function\n</code></pre>\n\n<p>How do I reset ieDoc to equal the current page so that I am able to interact with the text box on the new page? Inserting the following before interacting with the text box does not work (and I have no idea why).</p>\n\n<pre><code>set ieDoc = ie.document\n</code></pre>\n\n<p>Thank you very much for any help you're able to offer!</p>\n"}, {"tags": ["excel", "vba", "macos", "oledb"], "answers": [{"comments": [{"owner": {"reputation": 1003, "user_id": 57630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e28f5d8eaadeae91a70930812fc14ef2?s=128&d=identicon&r=PG", "display_name": "TravisPUK", "link": "https://stackoverflow.com/users/57630/travispuk"}, "edited": false, "score": 0, "creation_date": 1507124677, "post_id": 40388756, "comment_id": 80086567, "body": "This answer is not a helpful answer, SQL Server queries are available natively on Office 2016 for Mac, which is the version the OP was referring to. This just says you can&#39;t do it in 2011."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1003, "user_id": 57630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e28f5d8eaadeae91a70930812fc14ef2?s=128&d=identicon&r=PG", "display_name": "TravisPUK", "link": "https://stackoverflow.com/users/57630/travispuk"}, "edited": false, "score": 0, "creation_date": 1507125030, "post_id": 40388756, "comment_id": 80086809, "body": "@TravisPUK OP indicates Excel 2016 on PC, no indication given as to what version of Excel for Mac is used. In any case, I&#39;ve revised the answer (and the linked MSDN article <i>does</i> explain that it&#39;s available on 2016 Excel for Mac, also)."}, {"owner": {"reputation": 1003, "user_id": 57630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e28f5d8eaadeae91a70930812fc14ef2?s=128&d=identicon&r=PG", "display_name": "TravisPUK", "link": "https://stackoverflow.com/users/57630/travispuk"}, "edited": false, "score": 0, "creation_date": 1507125104, "post_id": 40388756, "comment_id": 80086866, "body": "Not Correct. OP specifically says &quot;I have write a macro in Excel 2016 on a windows pc via oledb connection. But it doesn&#39;t work in my Mac.&quot;"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1003, "user_id": 57630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e28f5d8eaadeae91a70930812fc14ef2?s=128&d=identicon&r=PG", "display_name": "TravisPUK", "link": "https://stackoverflow.com/users/57630/travispuk"}, "edited": false, "score": 1, "creation_date": 1507125160, "post_id": 40388756, "comment_id": 80086902, "body": "&quot;Excel 2016 on a windows PC&quot; seems to suggest the version of Excel is 2016 Windows. He further states &quot;it doesn&#39;t work on my Mac&quot;. No indication given what version. In any case, the revision to my answer should now qualify it as &quot;helpful&quot;..."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "reply_to_user": {"reputation": 1003, "user_id": 57630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e28f5d8eaadeae91a70930812fc14ef2?s=128&d=identicon&r=PG", "display_name": "TravisPUK", "link": "https://stackoverflow.com/users/57630/travispuk"}, "edited": false, "score": 1, "creation_date": 1507125315, "post_id": 40388756, "comment_id": 80086997, "body": "IOW, the way I&#39;ve interpreted the question is: &quot;I recorded this macro in Excel 2016 Win, but when I try to port it over to my Mac it doesn&#39;t work&quot;. Unfortunately, OP didn&#39;t indicate which version of Excel for Mac. You&#39;re welcome to infer that he&#39;s using 2016 on both, but there&#39;s no concrete evidence for that, either in the question text, or in the tags."}, {"owner": {"reputation": 1003, "user_id": 57630, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e28f5d8eaadeae91a70930812fc14ef2?s=128&d=identicon&r=PG", "display_name": "TravisPUK", "link": "https://stackoverflow.com/users/57630/travispuk"}, "edited": false, "score": 1, "creation_date": 1507125428, "post_id": 40388756, "comment_id": 80087084, "body": "I would agree with that David."}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 5, "last_activity_date": 1507124982, "last_edit_date": 1592644375, "creation_date": 1478116910, "answer_id": 40388756, "question_id": 40388545, "link": "https://stackoverflow.com/questions/40388545/sql-query-for-an-excel-sheet-in-mac/40388756#40388756", "title": "Sql query for an Excel sheet in Mac", "body": "<p>Your code uses late-binding and doesn't require a &quot;Reference&quot; so long as the library is available on the machine. In your case on Mac OS, the library doesn't exist and is, as far as I know, explicitly not allowed.</p>\n<p><a href=\"https://support.office.com/en-us/article/Import-data-from-a-database-e127365a-02a5-47b5-8278-16dd65edbe61\" rel=\"nofollow noreferrer\">From Microsoft</a> (emphasis added):</p>\n<blockquote>\n<p>To import data from a database, such as Microsoft SQL Server, <strong>you must have an ODBC driver that is compatible with Microsoft Query installed on your computer</strong>. Compatible ODBC drivers are available from third-party vendors. For more information, see <a href=\"http://go.microsoft.com/fwlink/?linkid=196583\" rel=\"nofollow noreferrer\">ODBC drivers that are compatible with Excel for Mac</a>. For more information about installing ODBC drivers, see Microsoft Query Help.</p>\n</blockquote>\n<p>Importantly, for your question, OLE DB is explicitly not supported on Mac OS if using Excel 2011 for Mac.</p>\n<blockquote>\n<p>Excel 2011 for Mac cannot import data from OLE DB or OLAP data sources.</p>\n</blockquote>\n<p>So, to answer your question there is no way to get <em>your</em> SQL query to work on Mac, you need to use something else entirely.</p>\n<p>HOWEVER, as noted, if you're using Excel 2016 for Mac, you can do it:</p>\n<blockquote>\n<p>This version of Excel does provide an ODBC driver for connecting to SQL Server Databases. On the Data tab, click New Database Query &gt; SQL Server ODBC. Then use the dialog boxes to import the data.</p>\n<p>If you are connecting to other ODBC data sources (for example, FileMaker Pro), then you'll need to install the ODBC driver for the data source on your Mac. Drivers that are compatible with Excel for Mac are available from these companies:</p>\n</blockquote>\n<p>Alternatively, this answer to a similar question looks promising:</p>\n<p><a href=\"https://stackoverflow.com/a/25126885/1467082\">https://stackoverflow.com/a/25126885/1467082</a></p>\n"}], "owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3817, "favorite_count": 1, "closed_date": 1478117345, "accepted_answer_id": 40388756, "answer_count": 1, "score": 1, "last_activity_date": 1593675746, "creation_date": 1478116130, "last_edit_date": 1593675746, "question_id": 40388545, "link": "https://stackoverflow.com/questions/40388545/sql-query-for-an-excel-sheet-in-mac", "closed_reason": "Duplicate", "title": "Sql query for an Excel sheet in Mac", "body": "<p>I have write a macro in Excel 2016 on a windows pc via oledb connection. But it doesn't work in my Mac. How can I run this? Normally, in windows, you choose tools > references and check oledb connection but there isn't a tools option in Excel Mac. I don't know code is important here but I'll share it anyway.</p>\n\n<pre><code>Dim sorgu1 As String\nDim con As Object, rs As Object\n    Set con = CreateObject(\"adodb.connection\")\n    Set rs = CreateObject(\"adodb.recordset\")\n    con.Open \"provider=microsoft.ace.oledb.12.0;data source=\" &amp; _\n    ThisWorkbook.FullName &amp; \";extended properties=\"\"Excel 12.0;hdr=yes\"\"\"\n\n    makine = Sheets(\"Dashboard\").Cells(2, 11).Value\n\n    sorgu1 = \"select [Resource Id], [Order No], Sum(([Bitim Zamani]-[Basl Zamani])*1440)\" 'as Plansiz, Sum(([Bitim Zamani]-[Basl Zamani])*1440)as Planli, Sum([Qty]) as Uretim\"\n    sorgu1 = sorgu1 + \" from [Data$] where [Resource Id] = \" + \"'\" + makine + \"'\"\n    sorgu1 = sorgu1 + \"GROUP BY [Resource Id], [Order No], [Duru Kodu]\"\n\n    Set rs = con.Execute(sorgu1)\n    Sheets(\"Dashboard\").Range(\"B65536\").End(3).Offset(1, 0).CopyFromRecordset rs\n    Set rs = Nothing\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1478113077, "post_id": 40387699, "comment_id": 68027123, "body": "What about combining the two lists into one column, then using the <a href=\"https://support.office.com/en-us/article/Filter-for-unique-values-or-remove-duplicate-values-ccf664b0-81d6-449b-bbe1-8daaec1e83c2\" rel=\"nofollow noreferrer\">&quot;Remove Duplicates&quot;</a> function that&#39;s built into Excel?  Then, if the formatting goes away, just use a conditional fomatting to say &quot;if x is in List 1, color Green, else Orange&quot;.  What have you tried?"}, {"owner": {"reputation": 43, "user_id": 5434935, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5f091de56a15e6b202a5f7e0ad7287c5?s=128&d=identicon&r=PG&f=1", "display_name": "J. Baker", "link": "https://stackoverflow.com/users/5434935/j-baker"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1478114359, "post_id": 40387699, "comment_id": 68027766, "body": "I actually just added the color to highlight how the combined list was sorted as a visual aid, it is not part of the request. And combining the list into one column and removing duplicates results in the first result."}, {"owner": {"reputation": 1018, "user_id": 6706734, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89cf86a3fd50974771d8041b8f13e5b0?s=128&d=identicon&r=PG&f=1", "display_name": "J_Lard", "link": "https://stackoverflow.com/users/6706734/j-lard"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1478115284, "post_id": 40387699, "comment_id": 68028290, "body": "As @BruceWayne mentioned you can do this with the remove duplicates function. If you really want to use VBA go ahead and append the columns together and use something like <code>ActiveSheet.Range(&quot;$M$2:$M$100&quot;).RemoveDuplicates Columns:=1, Header:=xlYes</code>."}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1478116597, "last_edit_date": 1478116597, "creation_date": 1478113897, "answer_id": 40387935, "question_id": 40387699, "link": "https://stackoverflow.com/questions/40387699/extract-unique-distinct-list-from-two-columns/40387935#40387935", "title": "Extract unique distinct list from two columns", "body": "<p>This will put the unique words in the order you want.</p>\n\n<pre><code>Sub foo()\nDim rng As Range\nDim ws As Worksheet\nDim i&amp;, j&amp;, t&amp;\nDim dict As Object\nDim iArr() As Variant\nDim oarr() As Variant\nDim itm As Variant\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nSet ws = ActiveSheet\nWith ws\n    Set rng = .Range(\"A:B\").Find(\"*\", .Range(\"A1\"), , , , xlPrevious)\n    If Not rng Is Nothing Then\n        iArr = .Range(.Cells(2, 1), .Cells(rng.Row, 2)).Value\n        For i = LBound(iArr, 1) To UBound(iArr, 1)\n            For j = LBound(iArr, 2) To UBound(iArr, 2)\n                If iArr(i, j) &lt;&gt; \"\" Then\n                    On Error Resume Next\n                    dict.Add iArr(i, j), iArr(i, j)\n                    On Error GoTo 0\n                End If\n            Next j\n        Next i\n    End If\n\n    'If your dataset is not that large &lt;30,000, then you can use it directly with transpose\n    .Range(\"C2\").Resize(dict.Count) = Application.Transpose(dict.items)\n    'If your data is large then you will want to put it in a one dimensional array first\n    'just uncomment the below and comment the one line above\n'    ReDim oarr(1 To dict.Count, 1 To 1)\n'    t = 1\n'    For Each itm In dict.keys\n'        oarr(t, 1) = dict(itm)\n'        t = t + 1\n'    Next itm\n'    Range(\"C2\").Resize(dict.Count) = oarr\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 1, "last_activity_date": 1478118853, "creation_date": 1478118853, "answer_id": 40389296, "question_id": 40387699, "link": "https://stackoverflow.com/questions/40387699/extract-unique-distinct-list-from-two-columns/40389296#40389296", "title": "Extract unique distinct list from two columns", "body": "<p>UDF solution.  Using your provided sample data, put this formula in cell I2 and copy down <code>=UnqList(ROW(I1),$G$2:$H$6)</code> or <code>=UnqList(ROW(I1),$G$2:$G$6,$H$2:$H$6)</code> (it can be either because the two or more lists might not be next to each other and the UDF accounts for that)</p>\n\n<pre><code>Public Function UnqList(ByVal lIndex As Long, ParamArray rLists() As Variant) As Variant\n\n    Dim i As Long, j As Long\n    Dim vList As Variant\n    Dim cUnq As Collection\n    Dim lMaxRow As Long, lMaxCol As Long\n\n    If lIndex &lt;= 0 Then\n        UnqList = CVErr(xlErrRef)\n        Exit Function\n    End If\n\n    For Each vList In rLists\n        If TypeName(vList) &lt;&gt; \"Range\" Then\n            UnqList = CVErr(xlErrRef)\n            Exit Function\n        Else\n            If vList.Rows.Count &gt; lMaxRow Then lMaxRow = vList.Rows.Count\n            If vList.Columns.Count &gt; lMaxCol Then lMaxCol = vList.Columns.Count\n        End If\n    Next vList\n\n    Set cUnq = New Collection\n\n    For i = 1 To lMaxRow\n        For j = 1 To lMaxCol\n            For Each vList In rLists\n                If i &lt;= vList.Rows.Count And j &lt;= vList.Columns.Count Then\n                    On Error Resume Next\n                    cUnq.Add vList.Cells(i, j).Value, CStr(vList.Cells(i, j).Value)\n                    On Error GoTo 0\n                    If lIndex = cUnq.Count Then\n                        UnqList = cUnq(cUnq.Count)\n                        Set cUnq = Nothing\n                        Exit Function\n                    End If\n                End If\n            Next vList\n        Next j\n    Next i\n\n    UnqList = CVErr(xlErrRef)\n    Set cUnq = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 1, "last_activity_date": 1478162928, "creation_date": 1478162928, "answer_id": 40397135, "question_id": 40387699, "link": "https://stackoverflow.com/questions/40387699/extract-unique-distinct-list-from-two-columns/40397135#40397135", "title": "Extract unique distinct list from two columns", "body": "<p>You can use my <code>Duplicate Master</code> addin available via my profile.</p>\n\n<p>Advantages are that the addin provides options to</p>\n\n<ul>\n<li>ignore capitilisation</li>\n<li>ignore whitespace</li>\n<li>run <code>RegExp</code> replacements (advanced)</li>\n<li>further options for deletinf, highlighting, selecting duplicates etc</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/yjHN6.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yjHN6.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/enLgG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/enLgG.jpg\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 43, "user_id": 5434935, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5f091de56a15e6b202a5f7e0ad7287c5?s=128&d=identicon&r=PG&f=1", "display_name": "J. Baker", "link": "https://stackoverflow.com/users/5434935/j-baker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 976, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1478162928, "creation_date": 1478112947, "last_edit_date": 1531161705, "question_id": 40387699, "link": "https://stackoverflow.com/questions/40387699/extract-unique-distinct-list-from-two-columns", "title": "Extract unique distinct list from two columns", "body": "<p>So I am trying to create a combined list from two separate columns by omitting the duplicate items. I have searched and found a formula that combines the list this way by going through one column at a time.</p>\n\n<p><a href=\"https://i.stack.imgur.com/mfPsn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mfPsn.png\" alt=\"First way to combine\"></a></p>\n\n<p>But I want to combine the columns like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/KRJzy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KRJzy.png\" alt=\"Second way to combine\"></a></p>\n\n<p>where it goes through each row first.</p>\n\n<p>Is there a formula or VBA code that does that? Thank you. </p>\n\n<p>EDIT: This is just a way to show my request. The color was added to show how the combined list is sorted, it is not part of the request. The actual lists are each about 500 rows long consisting of 9+ digit ID numbers. </p>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1478172632, "post_id": 40387480, "comment_id": 68050598, "body": "I find your approach problematic - what if the second form is requeried (user presses Shift+F9 or for another reason), doesn&#39;t it complain that frmCoord_Selector isn&#39;t open anymore? I would leave the form open, or use <code>DoCmd.SetParameter</code>, or a public function."}], "answers": [{"comments": [{"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "edited": false, "score": 0, "creation_date": 1478194380, "post_id": 40399033, "comment_id": 68065750, "body": "Hmm, the form that is closing shouldn&#39;t be updating anything, so if it is then forcing a save would be forcing a change I don&#39;t want."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "reply_to_user": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "edited": false, "score": 0, "creation_date": 1478195011, "post_id": 40399033, "comment_id": 68066075, "body": "The other option would be that the underlying form has closed before the values you are referring to have been picked up. I think this is what Andre is referring to.  If you have to close the other form, I would pass the value of the cmbCoords in to &quot;CC_Tracker_from_form&quot;  as OpenArgs and then refer to it simply in your query as and unbound control on the current form."}, {"owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "edited": false, "score": 0, "creation_date": 1478200133, "post_id": 40399033, "comment_id": 68068948, "body": "So you think leaving the selection form open might prevent the issue?"}], "tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": false, "score": 1, "last_activity_date": 1478168528, "creation_date": 1478168528, "answer_id": 40399033, "question_id": 40387480, "link": "https://stackoverflow.com/questions/40387480/form-button-intermittently-returns-runtime-error-2101/40399033#40399033", "title": "Form button intermittently returns runtime error 2101", "body": "<p>It's possible that for some reason the form you are trying to close hasn't been able to save any updates. </p>\n\n<p>I would make sure that if the form has any data changed it is saved, so maybe add</p>\n\n<p><code>If Me.Dirty Then Me.Dirty = False</code></p>\n\n<p>To force a save before closing the existing form.</p>\n"}, {"tags": [], "owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "is_accepted": true, "score": 0, "last_activity_date": 1478548748, "creation_date": 1478548748, "answer_id": 40473574, "question_id": 40387480, "link": "https://stackoverflow.com/questions/40387480/form-button-intermittently-returns-runtime-error-2101/40473574#40473574", "title": "Form button intermittently returns runtime error 2101", "body": "<p>Based on the idea that the first form may be closing before passing the dropdown selection to the second form I've changed from closing the form, <code>DoCmd.CLOSE acForm, \"frmCoord_Selector\"</code>, to hiding the form, <code>Me.Visible = False</code> which should keep the selection active despite the first form no longer displaying.</p>\n"}], "owner": {"reputation": 1113, "user_id": 6575213, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/x4LlX.jpg?s=128&g=1", "display_name": "Rominus", "link": "https://stackoverflow.com/users/6575213/rominus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 40473574, "answer_count": 2, "score": 1, "last_activity_date": 1478548748, "creation_date": 1478112135, "last_edit_date": 1478112957, "question_id": 40387480, "link": "https://stackoverflow.com/questions/40387480/form-button-intermittently-returns-runtime-error-2101", "title": "Form button intermittently returns runtime error 2101", "body": "<p>I have a simple form on which the user selects a value from a list in a combo box, then clicks a button to open another form filtered by the selection.  In development and testing it works fine, but in Prod users are occasionally receiving runtime error 2101: 'The setting you entered isn't valid for this property'.  If the user restarts their machine the error doesn't persist, at least for a while.</p>\n\n<p>This happens when the user clicks the 'Ok' button, which closes the selection form and opens the main interface form.  The code for the button is just:</p>\n\n<pre><code>Private Sub btnOK_Click()\n    DoCmd.OpenForm \"CC_Tracker_from_form\", acNormal, , , acFormEdit\n    DoCmd.CLOSE acForm, \"frmCoord_Selector\"\nEnd Sub\n</code></pre>\n\n<p>When the user closes the error popup, the selection form remains visible on top of the main interface, which sort of makes sense if the failure is in the <code>DoCmd.CLOSE</code> line, since Access would have already opened the main form.</p>\n\n<p>Why would error 2101 trigger only some of the time, when the user performs exactly the same action (even the same selection from the combo box)?</p>\n\n<p>I don't think this error has anything to do with the underlying Record Source for the main form, but just in case here's that code:</p>\n\n<pre><code>SELECT \n    [Bunch of columns],\n    IIf(dbo_CC_Tracker.RISK_LVL='Low',Null,dbo_CC_Tracker.CHRA+365) AS CHRA_Next, \n    IIf(dbo_CC_Tracker.RISK_LVL='High',dbo_CC_Tracker.[ICP/Review]+29,\n    IIf(dbo_CC_Tracker.RISK_LVL='Medium',dbo_CC_Tracker.[ICP/Review]+89,Null)) AS ICP_Next, \n    IIf((dbo_CC_Tracker.RISK_LVL='Low' Or dbo_CC_Tracker.RISK_LVL='Medium'),Null,dbo_CC_Tracker.F2F+179) AS F2F_Next, \n    IIf(dbo_CC_Tracker.RISK_LVL='Low',Null,dbo_CC_Tracker.ICTCont+89) AS ICT_Next,\n    dbo_CC_Tracker.HTR_Letter +30 AS Final_Follow, \n    dbo_CC_Tracker.ASSIGNED +59 AS Deadline_1, \n    dbo_CC_Tracker.ASSIGNED +89 AS Deadline_2\nFROM dbo_CC_Tracker\nWHERE \n(((dbo_CC_Tracker.ASSIGNED_CARE_COORDINATOR)=Forms!frmCoord_Selector!cmbCoords)         \n      And dbo_CC_Tracker.[CLOSE] is null)    \nOr Forms!frmCoord_Selector!cmbCoords Is Null;\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 2, "creation_date": 1478110560, "post_id": 40386961, "comment_id": 68025752, "body": "which line does throw the error?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1478110603, "post_id": 40386961, "comment_id": 68025777, "body": "You need to add the worksheet before <b>all</b> instances of <code>Cells()</code> - check the <code>.Interior.ColorIndex</code> lines for example, make sure to add the worksheet there."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478120230, "post_id": 40386961, "comment_id": 68030959, "body": "<a href=\"https://blog.codinghorror.com/flattening-arrow-code/\" rel=\"nofollow noreferrer\">Flattening arrow code</a> &lt;~ please read"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478114007, "post_id": 40387265, "comment_id": 68027603, "body": "shouldn&#39;t all those <code>=</code> in <code>Select Case</code> block be <code>&lt;&gt;</code> ?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 1, "creation_date": 1478119508, "post_id": 40387265, "comment_id": 68030593, "body": "@user3598756 - Nope. It&#39;s selecting the <code>False</code> case, so it will only propogate through the cases if they are <code>True</code>."}, {"owner": {"reputation": 1, "user_id": 7106141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2b3ded6c51f646dfe97f7ab0cf79e6?s=128&d=identicon&r=PG&f=1", "display_name": "KibblaKaze", "link": "https://stackoverflow.com/users/7106141/kibblakaze"}, "edited": false, "score": 0, "creation_date": 1478205871, "post_id": 40387265, "comment_id": 68072031, "body": "@Cominter,  You are the most amazing person I have ever met.  I used your example and tweaked and it works flawlessly!  Thank you and BruceWayne so much for the help.  You Guys Rock!"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1478111413, "creation_date": 1478111413, "answer_id": 40387265, "question_id": 40386961, "link": "https://stackoverflow.com/questions/40386961/run-timne-error-1004-highlighting-range-of-cells/40387265#40387265", "title": "Run-Timne error &#39;1004&#39;: Highlighting range of cells", "body": "<p>As @BruceWayne mentions in the comments, you need to fully qualify all of your references to <code>Range</code>, <code>Cells</code>, and other global objects when you are building ranges:</p>\n\n<pre><code>Worksheets(\"PreviousPEAR\").Range(Worksheets(\"PreviousPEAR\").Cells(PL, 1), Worksheets(\"PreviousPEAR\").Cells(PL, 21)).Interior.ColorIndex = 6\n</code></pre>\n\n<p>This will get unwieldly with your already long code lines and multiple look-ups into the <code>Worksheets</code> collection, so grab references to your worksheets and/or put them in <code>With</code> blocks.  This helps performance tremendously:</p>\n\n<pre><code>With Worksheets(\"PreviousPEAR\")\n    .Range(.Cells(PL, 1), .Cells(PL, 21)).Interior.ColorIndex = 6\nEnd With\n</code></pre>\n\n<p>Finally, you can use a <code>Select Case False</code> structure instead of deeply nested <code>If</code> statements if you want to short-circuit a bunch of expressions:</p>\n\n<pre><code>Select Case False\n    Case Test1\n    Case Test2\n    Case Test3\n    Case Test4\n    Case Else\n        Debug.Print \"All conditions met\"\nEnd Select\n</code></pre>\n\n<p>That would make your loop look like the much more manageable...</p>\n\n<pre><code>With Worksheets(\"PreviousPEAR\")\n    Dim current As Worksheet\n    Set current = Worksheets(\"CurrentPEAR\")\n    PL = 2\n    Do While .Cells(PL, 2).Value = 1\n        If .Cells(PL, 6).Value = PPEAR Then\n            CL = 2\n            Do While current.Cells(CL, 2).Value = 1\n                Select Case False\n                    Case current.Cells(CL, 2).Interior.ColorIndex &lt;&gt; 6\n                    Case .Cells(PL, 3).Value = current.Cells(CL, 3)\n                    Case .Cells(PL, 4).Value = current.Cells(CL, 4)\n                    Case .Cells(PL, 7).Value = current.Cells(CL, 7)\n                    Case .Cells(PL, 12).Value = current.Cells(CL, 12)\n                    Case .Cells(PL, 14).Value = current.Cells(CL, 14)\n                    Case Else\n                        current.Range(current.Cells(CL, 1), current.Cells(CL, 21)).Interior.ColorIndex = 6\n                        .Range(.Cells(PL, 1), .Cells(PL, 21)).Interior.ColorIndex = 6\n                        Exit Do\n                End Select\n            CL = CL + 1\n            Loop\n        End If\n    PL = PL + 1\n    Loop\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7106141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a2b3ded6c51f646dfe97f7ab0cf79e6?s=128&d=identicon&r=PG&f=1", "display_name": "KibblaKaze", "link": "https://stackoverflow.com/users/7106141/kibblakaze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478111413, "creation_date": 1478110409, "last_edit_date": 1478110625, "question_id": 40386961, "link": "https://stackoverflow.com/questions/40386961/run-timne-error-1004-highlighting-range-of-cells", "title": "Run-Timne error &#39;1004&#39;: Highlighting range of cells", "body": "<p>I am trying to create a macro that will compare a previous expenditure report with the latest expenditure report.  The macro should pull data from the line in the Previous report and look for a Row that contains the exact same data, then highlight both Rows (in previous and latest report) to show that there was a match.  This will leave discrepancies un-highlighted in both the current and previous reports to be looked at to see if the discrepancies were intended (to be supported with documentation).</p>\n\n<p>The code I have written is as follows:</p>\n\n<pre><code>Dim CPEAR As String\nDim PPEAR As String\nDim CL As Integer\nDim PL As Integer\nDim DL As Integer\n\nSub KDPM()\nCPEAR = InputBox(\"Enter Current Pay Cycle (MM/DD/YYYY)\", \"Current Pay Cycle\", , 50, 50)\nCPEAR = CDate(CPEAR)\nPPEAR = InputBox(\"Enter Previous Pay Cycle (MM/DD/YYYY)\", \"Previous Pay Cycle\", , 50, 50)\nPPEAR = CDate(PPEAR)\n\n\nPL = 2\n\nDo While Worksheets(\"PreviousPEAR\").Cells(PL, 2).Value = 1\n    If Worksheets(\"PreviousPEAR\").Cells(PL, 6).Value = PPEAR Then\n        CL = 2\n        Do While Worksheets(\"CurrentPEAR\").Cells(CL, 2).Value = 1\n            If Worksheets(\"CurrentPEAR\").Cells(CL, 2).Interior.ColorIndex &lt;&gt; 6 Then\n                If Worksheets(\"PreviousPEAR\").Cells(PL, 3).Value = Worksheets(\"CurrentPEAR\").Cells(CL, 3) Then\n                    If Worksheets(\"PreviousPEAR\").Cells(PL, 4).Value = Worksheets(\"CurrentPEAR\").Cells(CL, 4) Then\n                        If Worksheets(\"PreviousPEAR\").Cells(PL, 7).Value = Worksheets(\"CurrentPEAR\").Cells(CL, 7) Then\n                            If Worksheets(\"PreviousPEAR\").Cells(PL, 12).Value = Worksheets(\"CurrentPEAR\").Cells(CL, 12) Then\n                                If Worksheets(\"PreviousPEAR\").Cells(PL, 14).Value = Worksheets(\"CurrentPEAR\").Cells(CL, 14) Then\n                                     Worksheets(\"CurrentPEAR\").Range(Cells(CL, 1), Cells(CL, 21)).Interior.ColorIndex = 6\n                                    Worksheets(\"PreviousPEAR\").Range(Cells(PL, 1), Cells(PL, 21)).Interior.ColorIndex = 6\n                                    Exit Do\n                                End If\n                            End If\n                        End If\n                    End If\n                End If\n            End If\n\n        CL = CL + 1\n        Loop\n\n\n\n    End If\nPL = PL + 1\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>It seems to work fine through the first four rows of my data, but then it hits a runtime error.  Any Ideas?</p>\n\n<p>And thanks for your help!</p>\n"}, {"tags": ["sql", "excel", "vba", "db2"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478110385, "post_id": 40386856, "comment_id": 68025636, "body": "The easiest (and most robust) way is to add the appropriate unique constraint to the database.  It shouldn&#39;t be the responsibility of the client code to maintain data integrity in the back-end."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1478111543, "post_id": 40386856, "comment_id": 68026309, "body": "First query the database for the current <code>EQUIPID</code> - if it exists then run an update, else run an insert."}, {"owner": {"reputation": 123, "user_id": 5414699, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/0401be09ab5bf1c978b4a072634a2205?s=128&d=identicon&r=PG&f=1", "display_name": "OVO", "link": "https://stackoverflow.com/users/5414699/ovo"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1478112418, "post_id": 40386856, "comment_id": 68026774, "body": "@TimWilliams so basically after conn.execute &quot;case when &#39;&quot;&amp;equipid&amp;&quot;&#39; exists (select 1 from oh_test_table where equipid = &#39;&quot;&amp;equipid&amp;&quot;&#39; ) then update oh_test_table etc else insert"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1478112698, "post_id": 40386856, "comment_id": 68026926, "body": "I&#39;m not a DB2 person but this question covers the topic: <a href=\"http://stackoverflow.com/questions/330241/does-db2-have-an-insert-or-update-statement\" title=\"does db2 have an insert or update statement\">stackoverflow.com/questions/330241/&hellip;</a>"}, {"owner": {"reputation": 123, "user_id": 5414699, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/0401be09ab5bf1c978b4a072634a2205?s=128&d=identicon&r=PG&f=1", "display_name": "OVO", "link": "https://stackoverflow.com/users/5414699/ovo"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1478113537, "post_id": 40386856, "comment_id": 68027365, "body": "@TimWilliams looks like this is for an interaction between two tables within db2, the data values will be coming from the workbook"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1478116223, "post_id": 40386856, "comment_id": 68028825, "body": "You&#39;re Googlng for &quot;DB2 upsert&quot;  - second hit (just after the one I posted) is <a href=\"http://lpar.ath0.com/2013/08/12/upsert-in-db2/\" rel=\"nofollow noreferrer\">lpar.ath0.com/2013/08/12/upsert-in-db2</a> which covers what you want to do."}, {"owner": {"reputation": 16538, "user_id": 1227152, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4hr5l.jpg?s=128&g=1", "display_name": "mustaccio", "link": "https://stackoverflow.com/users/1227152/mustaccio"}, "edited": false, "score": 1, "creation_date": 1478131510, "post_id": 40386856, "comment_id": 68035183, "body": "Consider using the <code>MERGE</code> statement instead, if it&#39;s available in your DB2 version."}], "answers": [{"tags": [], "owner": {"reputation": 13106, "user_id": 3735690, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/fOisS.png?s=128&g=1", "display_name": "Esperento57", "link": "https://stackoverflow.com/users/3735690/esperento57"}, "is_accepted": false, "score": 0, "last_activity_date": 1478156089, "creation_date": 1478156089, "answer_id": 40395481, "question_id": 40386856, "link": "https://stackoverflow.com/questions/40386856/how-to-insert-records-from-excel-using-vba-to-db2-database/40395481#40395481", "title": "How to insert records from Excel using VBA to DB2 Database", "body": "<p>i you are on DB2 iseries you can modify your query like this</p>\n\n<pre><code> conn.Execute \"INSERT INTO OH_TEST_TABLE (EQUIPID, TYPE, NAME) select '\" &amp; sequipid &amp; \"','\" &amp; stype &amp; \"','\" &amp; sname &amp; \"' from SYSIBM.SYSDUMMY1 where not exists (select * from OH_TEST_TABLE where EQUIPID='\" &amp; sequipid &amp; \"')\"\n</code></pre>\n\n<p>or this</p>\n\n<pre><code> conn.Execute \"INSERT INTO OH_TEST_TABLE (EQUIPID, TYPE, NAME) select * from (values ('\" &amp; sequipid &amp; \"','\" &amp; stype &amp; \"','\" &amp; sname &amp; \"') ) tmp(a,b,c)  where not exists (select * from OH_TEST_TABLE where EQUIPID='\" &amp; sequipid &amp; \"')\"\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1919238"}, "is_accepted": false, "score": 1, "last_activity_date": 1478160814, "creation_date": 1478160814, "answer_id": 40396602, "question_id": 40386856, "link": "https://stackoverflow.com/questions/40386856/how-to-insert-records-from-excel-using-vba-to-db2-database/40396602#40396602", "title": "How to insert records from Excel using VBA to DB2 Database", "body": "<p>You could use a merge statement like this to either update or insert (on most modern versions of DB2):</p>\n\n<pre><code>merge into oh_test_table oh1\nusing (select * from oh_test_table where equipid='\"&amp; sequipid &amp;\"') oh2\non oh1.equipid = oh2.equipid\nwhen matched then update set\n     type = '\"&amp; stype &amp;\"',\n     name = '\"&amp; sname &amp;\"'\nwhen not matched then insert\n     (equipid, type, name) values ('\" &amp; sequipid &amp; \"','\" &amp; stype &amp; \"','\" &amp; sname &amp; \"')\n</code></pre>\n\n<p>For the sake of clarity I have displayed it across multiple lines, without the extra VBA formatting required.</p>\n"}], "owner": {"reputation": 123, "user_id": 5414699, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/0401be09ab5bf1c978b4a072634a2205?s=128&d=identicon&r=PG&f=1", "display_name": "OVO", "link": "https://stackoverflow.com/users/5414699/ovo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1975, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1478160814, "creation_date": 1478110048, "question_id": 40386856, "link": "https://stackoverflow.com/questions/40386856/how-to-insert-records-from-excel-using-vba-to-db2-database", "title": "How to insert records from Excel using VBA to DB2 Database", "body": "<p>I want to insert records into a table from data in my workbook, \nusing VBA I do not have a problem with the inserts, but the problem is the duplicates.</p>\n\n<p>How can I have the records from Excel be inserted only if the record does not exist within the database? </p>\n\n<p>This is what I currently have. </p>\n\n<p>Additionally can I have records that do exist be updated or would that require another Module?</p>\n\n<pre><code>Sub Button1_Click()\n\n    Dim conn As New ADODB.Connection\n    Dim iRowNo As Integer\n    Dim sequipid, stype, sname As String\n\n    With Sheets(\"Sheet1\")\n\n        'Open a connection to SQL Server\n        conn.Open \"Driver={IBM DB2 ODBC DRIVER};Database=XXXX;Hostname=192.168.XXX.XX;Port=50000;Protocol=TCPIP;Uid=\" &amp; \"XXXX\" &amp; \";Pwd=\" &amp; \"XXXXXX\" &amp; \";CurrentSchema=LYNX;\"\n\n        'Skip the header row\n        iRowNo = 2\n\n        'Loop until empty cell in CustomerId\n        Do Until .Cells(iRowNo, 1) = \"\"\n            sequipid = .Cells(iRowNo, 1)\n            stype = .Cells(iRowNo, 2)\n            sname = .Cells(iRowNo, 3)\n\n            'Generate and execute sql statement to import the excel rows to SQL Server table\n            conn.Execute \"INSERT INTO OH_TEST_TABLE (EQUIPID, TYPE, NAME) VALUES ('\" &amp; sequipid &amp; \"','\" &amp; stype &amp; \"','\" &amp; sname &amp; \"')\"\n\n            iRowNo = iRowNo + 1\n        Loop\n\n        MsgBox \"RECORD UPDATED\"\n\n        conn.Close\n        Set conn = Nothing\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "find", "match"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1478109920, "post_id": 40386769, "comment_id": 68025334, "body": "You need to test for <code>Nothing</code> after calling <code>Find</code>.  This exact question seriously gets asked here on a daily basis."}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6950672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31be148312be4e3c0ce5c96679896ad5?s=128&d=identicon&r=PG&f=1", "display_name": "M. Anderson", "link": "https://stackoverflow.com/users/6950672/m-anderson"}, "edited": false, "score": 0, "creation_date": 1478110768, "post_id": 40386865, "comment_id": 68025870, "body": "Thank you all! I was trying the suggestions from ALL the other questions posed. My issue was when I was testing for the nothing I didn&#39;t take the .column off at the end of the line. Once I did that and then set up the If statement worked like a charm!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 9, "user_id": 6950672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31be148312be4e3c0ce5c96679896ad5?s=128&d=identicon&r=PG&f=1", "display_name": "M. Anderson", "link": "https://stackoverflow.com/users/6950672/m-anderson"}, "edited": false, "score": 0, "creation_date": 1478111399, "post_id": 40386865, "comment_id": 68026227, "body": "you are welcome. you may then want to mark my answer as accepted. thank you"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1478110074, "creation_date": 1478110074, "answer_id": 40386865, "question_id": 40386769, "link": "https://stackoverflow.com/questions/40386769/find-method-with-no-match-error/40386865#40386865", "title": "Find method with no match error", "body": "<pre><code>Dim f As Range '&lt;-- declare a range to collect the result of 'Find()' method\nFor a = 2 To (lnCol1 - 2)\n    For i = 6 To (cnt1 - 2)\n        Set f = Sheet1.Cells(lnRow, 1).EntireRow.Find(What:=Sh1.Cells(i, 1).Value, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False) '&lt;-- try setting f to the 'Find()' method result\n        If Not f Is Nothing Then '&lt;--| check for f to be a \"real\" range\n            lnCol4 = f.Column\n            Sh1.Cells(i, (lnCol1 + 4)).Formula = \"=SUM(\" &amp; Range(Cells(i, (lnCol4 + 1)), Cells(i, (lnCol1 - 1))).Address(False, False) &amp; \")\"\n        End If\n    Next i\nNext a\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 6950672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31be148312be4e3c0ce5c96679896ad5?s=128&d=identicon&r=PG&f=1", "display_name": "M. Anderson", "link": "https://stackoverflow.com/users/6950672/m-anderson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2061, "favorite_count": 0, "closed_date": 1478110686, "accepted_answer_id": 40386865, "answer_count": 1, "score": -3, "last_activity_date": 1532026464, "creation_date": 1478109757, "last_edit_date": 1532026464, "question_id": 40386769, "link": "https://stackoverflow.com/questions/40386769/find-method-with-no-match-error", "closed_reason": "Duplicate", "title": "Find method with no match error", "body": "<p>I keep getting a <em>\"Run-time error '91': Object Variable or With Block Variable not set</em>. I know the issue is the find method is not finding a match, but I can't seem to find how to fix the issue. I have tried the If Not xxx Is Nothing...but I then get another error.</p>\n\n<pre><code>Sub SetUpFormulas50450()\n\nDim cnt1 As Long\nDim i As Long\nDim lnRow As Long\nDim lnCol As Long\nDim lnCol1 As Long\nDim lnCol4 As Long\nDim lnRow1 As Long\nDim tempA As Long\nDim tempB As Long\nDim a As Long\nDim LR As Long\n\nSet Sh1 = ThisWorkbook.Worksheets(\"Pivot\")\nSh1.Select\n\nlnRow = 5\nlnCol = 2\n\ncnt1 = Sh1.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n'Sh1.Cells(1, 10) = cnt1\n\nlnCol1 = Sheet1.Cells(lnRow, 1).EntireRow.Find(What:=\"Grand Total\", LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False).Column\n'Sh1.Cells(1, 11) = lnCol1\n\nSh1.Cells(cnt1, (lnCol1 + 2)).Formula = \"=SUM(\" &amp; Range(Cells(6, (lnCol1 + 2)), Cells((cnt1 - 1), (lnCol1 + 2))).Address(False, False) &amp; \")\"\n\n'Calculate Frt Pct of Sales\nFor i = 6 To cnt1\n    tempA = Sh1.Cells(i, lnCol1).Value\n    tempB = Sh1.Cells(i, (lnCol1 + 2)).Value\n    If Sh1.Cells(i, (lnCol1 + 2)).Value = 0 Then Sh1.Cells(i, (lnCol1 + 3)).Value = 0 Else Sh1.Cells(i, (lnCol1 + 3)).Value = tempA / tempB\nNext i\n\n'Calculate Frt Pd in Fut Mos\nFor a = 2 To (lnCol1 - 2)\n    For i = 6 To (cnt1 - 2)\n        lnCol4 = Sheet1.Cells(lnRow, 1).EntireRow.Find(What:=Sh1.Cells(i, 1).Value, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False).Column\n        Sh1.Cells(i, (lnCol1 + 4)).Formula = \"=SUM(\" &amp; Range(Cells(i, (lnCol4 + 1)), Cells(i, (lnCol1 - 1))).Address(False, False) &amp; \")\"\n    Next i\nNext a\nEnd Sub\n</code></pre>\n\n<p>I am having the issue at the line: </p>\n\n<pre><code>lnCol4 = Sheet1.Cells(lnRow, 1).EntireRow.Find(What:=Sh1.Cells(i, 1).Value, LookIn:=xlValues, LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False).Column\n</code></pre>\n"}, {"tags": ["r", "vba", "r-table"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1478109325, "post_id": 40386553, "comment_id": 68024953, "body": "Does the database really use a transposed csv like that, or are the column labels on the left of the &quot;wide&quot; example really the headers?"}, {"owner": {"reputation": 383, "user_id": 1932539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7f8ec3b9f74420eda78bb6ec4866671c?s=128&d=identicon&r=PG", "display_name": "NWdev", "link": "https://stackoverflow.com/users/1932539/nwdev"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478113412, "post_id": 40386553, "comment_id": 68027295, "body": "You&#39;re right -- they&#39;re the headers on the left (column names). I think I&#39;ve been staring at this data way too long!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478113699, "post_id": 40386553, "comment_id": 68027448, "body": "Is the data currently in an Excel sheet that looks like &quot;simplified view &quot; or coming from somewhere else?  A VBA solution would be really easy - I can&#39;t speak to R."}, {"owner": {"reputation": 383, "user_id": 1932539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7f8ec3b9f74420eda78bb6ec4866671c?s=128&d=identicon&r=PG", "display_name": "NWdev", "link": "https://stackoverflow.com/users/1932539/nwdev"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478114477, "post_id": 40386553, "comment_id": 68027828, "body": "Yes, it&#39;s in an Excel sheet. For some reason my mind has gone on vacation w/r/t a VBA solution and hopped over to R! (Probably because I need to do some R work again soon - w/ tie-ins to Access.) How would you go about the solution?"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1478116389, "creation_date": 1478116389, "answer_id": 40388613, "question_id": 40386553, "link": "https://stackoverflow.com/questions/40386553/long-to-wide-and-duplicate-column-when-row-has-data/40388613#40388613", "title": "Long to Wide and Duplicate Column when Row has Data", "body": "<p>I'd use an OO approach to this.  Define a simple class that holds information about the plot and data and has a dictionary of species and coverage percentages:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Plot.cls\nOption Explicit\n\nPrivate Type PlotMembers\n    PlotId As Long\n    DataDate As Date\n    Location As String\nEnd Type\n\nPrivate this As PlotMembers\nPrivate mCover As Scripting.Dictionary\n\nPrivate Sub Class_Initialize()\n    Set mCover = New Scripting.Dictionary\nEnd Sub\n\nPublic Property Get PlotId() As Long\n    PlotId = this.PlotId\nEnd Property\n\nPublic Property Let PlotId(inValue As Long)\n    this.PlotId = inValue\nEnd Property\n\nPublic Property Get DataDate() As Date\n    DataDate = this.DataDate\nEnd Property\n\nPublic Property Let DataDate(inValue As Date)\n    this.DataDate = inValue\nEnd Property\n\nPublic Property Get Location() As String\n    Location = this.Location\nEnd Property\n\nPublic Property Let Location(inValue As String)\n    this.Location = inValue\nEnd Property\n\nPublic Sub AddSpeciesCover(species As String, cover As String)\n    mCover.Add species, cover\nEnd Sub\n</code></pre>\n\n<p>Then give it a property that spits out a list of CSV data rows:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Also in Plot.cls\nPublic Property Get CsvRows() As String\n    Dim key As Variant\n    Dim output() As String\n    ReDim output(mCover.Count - 1)\n    Dim i As Long\n    For Each key In mCover.Keys\n        Dim temp(4) As String\n        temp(0) = this.PlotId\n        temp(1) = this.DataDate\n        temp(2) = this.Location\n        temp(3) = key\n        temp(4) = mCover(key)\n        output(i) = Join(temp, \",\")\n        i = i + 1\n    Next key\n    CsvRows = Join(output, vbCrLf)\nEnd Property\n</code></pre>\n\n<p>Then, all you need to do is fill them up from your input data.  Note, the sample usage here assumes that the top grid in your question basically looks like the active sheet with the top left corner at A1.  It should be fairly easy to change this to match how you need to collect the data:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub SampleUsage()\n    Dim plots As New Collection\n\n    With ActiveSheet\n        Dim col As Long\n        For col = 2 To 4\n            Dim current As Plot\n            Set current = New Plot\n            current.PlotId = .Cells(1, col).Value\n            current.DataDate = .Cells(2, col).Value\n            current.Location = .Cells(3, col).Value\n            Dim r As Long\n            For r = 4 To 6\n                Dim cover As String\n                cover = .Cells(r, col).Value\n                If cover &lt;&gt; vbNullString Then\n                    current.AddSpeciesCover .Cells(r, 1).Value, cover\n                End If\n            Next\n            plots.Add current\n        Next\n\n    End With\n\n    For Each current In plots\n        Debug.Print current.CsvRows\n    Next\nEnd Sub\n</code></pre>\n\n<p>Note that this is only a skeleton to demonstrate the gist of the method - it would need error handling, more robust formatting, etc., etc. to be production ready.</p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 1, "last_activity_date": 1478121521, "creation_date": 1478121521, "answer_id": 40389983, "question_id": 40386553, "link": "https://stackoverflow.com/questions/40386553/long-to-wide-and-duplicate-column-when-row-has-data/40389983#40389983", "title": "Long to Wide and Duplicate Column when Row has Data", "body": "<p>Simply reshape your data frame in R using reshape2 package's <code>melt()</code> method. Below assumes the transposed view of your posted data is the actual format as you seem to mention in comments:</p>\n\n<pre class=\"lang-r prettyprint-override\"><code>library(reshape2)\n\ndata = 'plot    date    location    sp1 sp2 sp3\n1   5/3/2016    A       5   T\n4   6/20/2016   F   15      3\n5   6/22/2016   K   30  100 5'\n\ndf &lt;- read.table(text=data, header=TRUE, sep=\"\\t\", stringsAsFactors = FALSE)\ndf    \n#   plot      date location sp1 sp2 sp3\n# 1    1  5/3/2016        A  NA   5   T\n# 2    4 6/20/2016        F  15  NA   3\n# 3    5 6/22/2016        K  30 100   5\n\nmdf &lt;- melt(df, id.vars=c(\"plot\", \"date\", \"location\"),\n            variable.name=\"species\", na.rm = TRUE, value.name=\"cover %\")\nmdf &lt;- mdf[with(mdf, order(date)),]               # ORDER BY DATE\nrownames(mdf) &lt;- seq_len(nrow(mdf))               # RESET ROW NAMES\nmdf\n\n#   plot      date location species cover %\n# 1    1  5/3/2016        A     sp2       5\n# 2    1  5/3/2016        A     sp3       T\n# 3    4 6/20/2016        F     sp1      15\n# 4    4 6/20/2016        F     sp3       3\n# 5    5 6/22/2016        K     sp1      30\n# 6    5 6/22/2016        K     sp2     100\n# 7    5 6/22/2016        K     sp3       5\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 1932539, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7f8ec3b9f74420eda78bb6ec4866671c?s=128&d=identicon&r=PG", "display_name": "NWdev", "link": "https://stackoverflow.com/users/1932539/nwdev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1478121521, "creation_date": 1478109035, "last_edit_date": 1478113566, "question_id": 40386553, "link": "https://stackoverflow.com/questions/40386553/long-to-wide-and-duplicate-column-when-row-has-data", "title": "Long to Wide and Duplicate Column when Row has Data", "body": "<p>Wondering how others might tackle this challenge.</p>\n\n<p><strong>Background</strong></p>\n\n<p>Data is for vegetation monitoring. It includes basic per plot info and identifies the species and % cover for those species.</p>\n\n<p>There are several rows of plot specific information - date, location, distance followed by species rows. Within the species rows values include the % cover for the species in the plot represented by the column.</p>\n\n<p>A simplified view would be a grid like this:</p>\n\n<pre><code>plot        1           4            5\ndate     5/3/2016     6/20/2016     6/22/2016\nlocation    A           F             K\nsp1                    15            30\nsp2         5                        100\nsp3         T           3             5\n</code></pre>\n\n<p>What I hope to get to is a grid like this which lends itself to csv import into the database (<em>species % cover requires a reference to the plot info in the RMDB</em>). <em>Left-most column = table field names.</em></p>\n\n<pre><code>plot        1        1          4        4            5          5       5\ndate     5/3/2016   5/3/2016  6/20/2016 6/20/2016 6/22/2016  6/22/2016 6/22/2016\nlocation    A        A          F        F            K         K        K\nspecies    sp2      sp3        sp1       sp3        sp1        sp2       sp3\ncover %     5        T         15        3           30        100       5\n</code></pre>\n\n<p>This wide format can be readily \"digested\" by the database and properly populate two tables (Plot &amp; CoverPercent).</p>\n\n<p><strong>Approach?</strong></p>\n\n<p>I've thought of a couple approaches, but I think there's a better way that I'm missing.</p>\n\n<p>Here's what I've come up with so far:</p>\n\n<ul>\n<li><p>Flip the data from long to wide</p></li>\n<li><p>Add a <code>species</code> and <code>cover</code> row</p></li>\n<li><p>Count the number of species for a given plot</p></li>\n<li><p>Repeat the plot's column based on the number of species</p></li>\n<li><p>Populate the plot's 'species' and 'cover' rows</p></li>\n</ul>\n\n<p>Originally I had thought I could do this in VBA, but it seems perhaps R is a better/faster/cleaner approach. The question though is \"how\"?</p>\n\n<p>I've done some R work most recently w/ the table package, but I'm certainly rusty having spent the past year on VBA/SQL projects.</p>\n\n<p><strong>I'm curious how others would approach this change. Any thoughts?</strong></p>\n"}, {"tags": ["excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478109311, "post_id": 40386490, "comment_id": 68024942, "body": "&quot;I want that total number to remain the next time I run the macro, but right now it erases the last entry and sums the new total plus the previous total. &quot; What do you mean?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478109850, "post_id": 40386490, "comment_id": 68025281, "body": "Some sample of what your data looks like and your expected output would make this much more answerable."}, {"owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "edited": false, "score": 0, "creation_date": 1478110136, "post_id": 40386490, "comment_id": 68025484, "body": "Before I run the macro I am automatically adding rows before running it which are just job rows. I am using this macro to simply sum the job rows and enter a number. So the user creates 7 job rows and this macro enters a &quot;|&quot; in each cell with the same date and then number 7 at the last cell in that column.  When this gets filled out again later the same day I don&#39;t want the number 7 to go away as it does now."}], "answers": [{"comments": [{"owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "edited": false, "score": 0, "creation_date": 1478113211, "post_id": 40387589, "comment_id": 68027195, "body": "Your second one is just what I needed.... EXCELLENT!  Thank you very much."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 0, "last_activity_date": 1478112570, "creation_date": 1478112570, "answer_id": 40387589, "question_id": 40386490, "link": "https://stackoverflow.com/questions/40386490/excel-2010-sum-column-by-date/40387589#40387589", "title": "Excel 2010 Sum Column by Date", "body": "<p>If you wish to leave anything that is currently in column E untouched by the macro, so that previous counts remain in place, change the line that says:</p>\n\n<pre><code>icell.Offset(0, 1).Value = \"|\"\n</code></pre>\n\n<p>to</p>\n\n<pre><code>If IsEmpty(icell.Offset(0, 1)) Then\n    icell.Offset(0, 1).Value = \"|\"\nEndif\n</code></pre>\n\n<hr>\n\n<p>If you want the new count to only be the count of records added since the previous time the macro was run (and the data is in date order), this could be modified to be:</p>\n\n<pre><code>If IsEmpty(icell.Offset(0, 1)) Then\n    icell.Offset(0, 1).Value = \"|\"\nElse\n    iCount = 0\nEndif\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 3340949, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/75d15e0121983ed7b1e305e593d4a156?s=128&d=identicon&r=PG&f=1", "display_name": "Noob2Java", "link": "https://stackoverflow.com/users/3340949/noob2java"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 40387589, "answer_count": 1, "score": 0, "last_activity_date": 1478112570, "creation_date": 1478108867, "last_edit_date": 1531164843, "question_id": 40386490, "link": "https://stackoverflow.com/questions/40386490/excel-2010-sum-column-by-date", "title": "Excel 2010 Sum Column by Date", "body": "<p>I have this macro that I use to sum total entries by date. The macro can be run two or three times per day which causes a problem as it wants to sum by date. When I run it and it places the total in the last cell in column E, I want that total number to remain the next time I run the macro, but right now it erases the last entry and sums the new total plus the previous total. How can this be changed?  I hope this makes sense the way I am explaining it.</p>\n\n<pre><code>Sub Sum_TodaysDate()\n\nDim sh As Worksheet\nSet sh = ActiveSheet\n\nDim LastRow As Long, iCount As Long\nDim icell As Range\nDim dSplit As Variant\nDim dIndex As Date\n\n\nLastRow = sh.Range(\"D\" &amp; Rows.Count).End(xlUp).Row\niCount = 0\n\nFor Each icell In sh.Range(\"D2:D\" &amp; LastRow)\n    dSplit = Split(icell.Value, \" \")\n    dIndex = Format(dSplit(0), \"mm/dd/yyyy\")\n    If dIndex = Date Then\n        iCount = iCount + 1\n        icell.Offset(0, 1).Value = \"|\"\n    End If\nNext icell\n\n\nsh.Range(\"E\" &amp; LastRow).Value = iCount\nsh.Range(\"E\" &amp; LastRow).Font.Color = vbRed\n\n\nApplication.ScreenUpdating = True\nThisWorkbook.Save\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "solver", "excel-2016"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478113573, "post_id": 40386155, "comment_id": 68027393, "body": "(a) Have you tried using <code>ValueOf:=Worksheets(&quot;AEP&quot;).Range(&quot;D57&quot;)</code> instead of <code>ValueOf:=GeneratedPower</code>? (Not sure why it would help, but it&#39;s worth a try.)  (b) Is &quot;AEP&quot; the active sheet when the macro is run?"}, {"owner": {"reputation": 183, "user_id": 3307903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e39b95ef9aec0a728bec57735c9a414f?s=128&d=identicon&r=PG&f=1", "display_name": "gktscrk", "link": "https://stackoverflow.com/users/3307903/gktscrk"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478130633, "post_id": 40386155, "comment_id": 68034959, "body": "I&#39;ll try that when I can. And, no, not the active sheet. Do you think that might make a difference?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478130916, "post_id": 40386155, "comment_id": 68035028, "body": "Are cells $D$58 and $D$65 meant to be referring to the active sheet?  Or to the AEP sheet?  As it is currently set up, they will be referring to the active sheet."}, {"owner": {"reputation": 183, "user_id": 3307903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e39b95ef9aec0a728bec57735c9a414f?s=128&d=identicon&r=PG&f=1", "display_name": "gktscrk", "link": "https://stackoverflow.com/users/3307903/gktscrk"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478164381, "post_id": 40386155, "comment_id": 68045363, "body": "@YowE3K: You are right; they are referring to the wrong sheet. I can&#39;t believe I missed something that obvious. Would you please post that as the answer?"}, {"owner": {"reputation": 183, "user_id": 3307903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e39b95ef9aec0a728bec57735c9a414f?s=128&d=identicon&r=PG&f=1", "display_name": "gktscrk", "link": "https://stackoverflow.com/users/3307903/gktscrk"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478165370, "post_id": 40386155, "comment_id": 68045929, "body": "@Yow3K: It would be appreciated if you could tell me why it seems I need to run the macro twice for the values to update after having put in a <code>Application.ScreenUpdating=False</code> bit of code when I use VBA to activate the other worksheet. If this doesn&#39;t make sense to you, no worries - you solved the main question I had. :) Cheers again!"}], "answers": [{"comments": [{"owner": {"reputation": 183, "user_id": 3307903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e39b95ef9aec0a728bec57735c9a414f?s=128&d=identicon&r=PG&f=1", "display_name": "gktscrk", "link": "https://stackoverflow.com/users/3307903/gktscrk"}, "edited": false, "score": 0, "creation_date": 1478208243, "post_id": 40409301, "comment_id": 68073215, "body": "Thanks on both counts. I think you are right; I have a corresponding <code>=True</code> for the screenactivating, but I think it is not optimally placed. I will try your version of the worksheet activating and see how that works. The main problem has been solved though."}], "tags": [], "owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "is_accepted": true, "score": 1, "last_activity_date": 1478199609, "creation_date": 1478199609, "answer_id": 40409301, "question_id": 40386155, "link": "https://stackoverflow.com/questions/40386155/vba-solver-constraints-not-set-error-w-no-constraints-specified/40409301#40409301", "title": "VBA Solver Constraints Not Set Error (w/ no constraints specified)", "body": "<p>It appears as if you are not activating the sheet on which your formulae exist, and therefore the Solve is doing its process on whatever the currently Active sheet is.</p>\n\n<p>I recommend changing your code to:</p>\n\n<pre><code>Sub SolverAEP()\n\n    With Worksheets(\"AEP\")\n        .Activate \n\n        SolverReset\n\n        SolverOk SetCell:=\"$D$58\", _\n                 MaxMinVal:=3, _\n                 ValueOf:=[$D$57], _\n                 ByChange:=\"$D$65\", _\n                 Engine:=1, _\n                 EngineDesc:=\"GRG Nonlinear\"\n\n        SolverSolve userFinish:=False\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>The <code>Activate</code> will ensure that the correct sheet is selected when running the Solver.  (Much as I hate the use of <code>Activate</code>, <code>Select</code>, <code>Selection</code>, etc, this is one of those times it is required - the Solver will only work on the Active sheet.)</p>\n\n<hr>\n\n<p>Re your comment about values not being updated until after you run the Solver a second time if you have an <code>Application.ScreenUpdating = False</code> statement included, I can't think of any reason other than the fairly obvious question \"have you included a <code>Application.ScreenUpdating = True</code> statement as well?\".</p>\n\n<p>I tried running it with just the <code>=False</code> and running <code>SolverAEP</code> caused the screen to be updated once the macro ended.</p>\n\n<p>However, if I wrote another subroutine such as the following:</p>\n\n<pre><code>Sub Test\n    SolverAEP\n    MsgBox \"Finished first solve\"\n    SolverAEP\n    MsgBox \"Finished second solve\"\nEnd Sub\n</code></pre>\n\n<p>and ran it, then (with just a <code>=False</code> and no corresponding <code>=True</code>) the screen does not update until the <code>End Sub</code> of <code>Sub Test</code> is reached.  This is the expected behaviour of having stopped <code>ScreenUpdating</code>.</p>\n"}], "owner": {"reputation": 183, "user_id": 3307903, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e39b95ef9aec0a728bec57735c9a414f?s=128&d=identicon&r=PG&f=1", "display_name": "gktscrk", "link": "https://stackoverflow.com/users/3307903/gktscrk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 40409301, "answer_count": 1, "score": 0, "last_activity_date": 1478199609, "creation_date": 1478107754, "last_edit_date": 1495541799, "question_id": 40386155, "link": "https://stackoverflow.com/questions/40386155/vba-solver-constraints-not-set-error-w-no-constraints-specified", "title": "VBA Solver Constraints Not Set Error (w/ no constraints specified)", "body": "<p>Firstly, I have tried researching the problem I have but the solutions I have found (for example, <a href=\"https://stackoverflow.com/questions/13352666/excel-solver-optimizing-using-changing-valueof-inputs\">here</a>, have not worked for me). I am trying to write a macro that uses the (normally) straightforward Solver functionality of solving for a value. </p>\n\n<p>The code I have got to is as follows:</p>\n\n<pre><code>Sub SolverAEP()\n\n    Dim GeneratedPower As Double\n    GeneratedPower = Worksheets(\"AEP\").Range(\"D57\")\n\n    SolverReset\n\n    SolverOk SetCell:=\"$D$58\", _\n         MaxMinVal:=3, _\n         ValueOf:=GeneratedPower, _\n         ByChange:=\"$D$65\" _\n         , Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n\n    SolverSolve userFinish:=False    \n\nEnd Sub\n</code></pre>\n\n<p>The error at present is that <code>Solver could not find a feasible solution. Sovler can not find a point for which all Constraints are satisified.</code></p>\n\n<p>What I have tried:</p>\n\n<ul>\n<li>Some online guidance says that the ValueOf needs to be a string - I tried the CStr approach to both <code>Range(\"D57\")</code> and <code>Cells(57,\"D\").Value</code> and both came up with a Solver error. </li>\n<li>When I manually try to open Solver, it always opens up with a comma instead of a full stop, so I used a small script to replace all commas with a full stop, but that did not change anything (only tried this when I was dealing with a string as the <code>ValueOf</code>. [I am not sure why this actually happens, but I think there's some sort of a culture conflict as I'm using both a Continental and UK keyboard and localisation settings are fairly random.]</li>\n<li><p>Recording the macro doing the same manually in Solver gives me the below as the Solver code:</p>\n\n<pre><code>Sub Macro2()\n    SolverOk SetCell:=\"$D$58\", MaxMinVal:=3, ValueOf:=21000#, ByChange:=\"$D$65\" _\n        , Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n\n    SolverOk SetCell:=\"$D$58\", MaxMinVal:=3, ValueOf:=21000#, ByChange:=\"$D$65\" _\n        , Engine:=1, EngineDesc:=\"GRG Nonlinear\"\n\n    SolverSolve\nEnd Sub\n</code></pre></li>\n<li><p>The values I presently have could be rounded if necessary - as it seems when I stepped through my written macro that the decimal was still using a comma instead of a full stop. I tried rounding the value and putting that in there, but the same error came up. </p></li>\n</ul>\n\n<p>Lastly, I should add that there is no problem in solving this manually with the Solver. The referenced cell D58 is a sum of other cells, the value of which depends on the value of D65. </p>\n\n<p>Can anyone highlight what I am doing wrong please?</p>\n\n<p>In case it matters, I'm using Excel 2016. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3810, "user_id": 2542856, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/9YUxb.jpg?s=128&g=1", "display_name": "Matt C", "link": "https://stackoverflow.com/users/2542856/matt-c"}, "edited": false, "score": 1, "creation_date": 1478110070, "post_id": 40385533, "comment_id": 68025441, "body": "Just a friendly tip, you may want to read over this page: <a href=\"https://stackoverflow.com/help/how-to-ask\">The How-To-Ask Guide</a> so you can always be sure that your questions are easily answerable and as clear as possible. Be sure to include any efforts you&#39;ve made to fix the problem you&#39;re having, and what happened when you attempted those fixes. Also don&#39;t forget to your show code and any error messages!"}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1478109287, "post_id": 40385701, "comment_id": 68024931, "body": "So, now it gives me an error and highlights the fourth line. It says &quot;Method &#39;Range&#39; of object &#39;_Worksheet&#39; failed&quot;."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1478109378, "post_id": 40385701, "comment_id": 68025001, "body": "Are you sure you are looking at the newest edition? Refresh the page and try again :-)"}, {"owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1478109708, "post_id": 40385701, "comment_id": 68025194, "body": "Everything is working! Thank you! I also looked and found out that I had a named range that might have been messing things up. I&#39;m not sure, but I didn&#39;t need it so I deleted it. I ran the macro again and everything worked. Thank you! And for some reason I can&#39;t mark your answer as accepted. A box shows up that says an error has occurred. I think it has something to do with reputation points?"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1478109857, "post_id": 40385701, "comment_id": 68025287, "body": "Glad it worked. I guess you can try again later, should be possible for everyone to accept an answer :-)"}, {"owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "edited": false, "score": 0, "creation_date": 1478110126, "post_id": 40385701, "comment_id": 68025479, "body": "I will do that later when I can get it to work! Thanks!"}], "tags": [], "owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "is_accepted": true, "score": 1, "last_activity_date": 1478114662, "last_edit_date": 1478114662, "creation_date": 1478106299, "answer_id": 40385701, "question_id": 40385533, "link": "https://stackoverflow.com/questions/40385533/error-creating-table-in-vba-excel/40385701#40385701", "title": "Error creating table in VBA Excel", "body": "<p>Try this. You need to have a range object declared, so that you can access its properties.</p>\n\n<pre><code>Dim wks As Worksheet\nSet wks = ThisWorkbook.Sheets(\"Enrollment Data Aggregate\")\nDim rng As Range\nSet rng = wks.Range([A1].End(xlDown), \"$n$1\")\nwks.ListObjects.Add(xlSrcRange, rng, , xlYes).Name = \"EDA_Table\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10092257, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5cc14b21e5f812bc0e26e74e8a7b1ee2?s=128&d=identicon&r=PG", "display_name": "ExcelUser", "link": "https://stackoverflow.com/users/10092257/exceluser"}, "is_accepted": false, "score": 0, "last_activity_date": 1531834951, "last_edit_date": 1531834951, "creation_date": 1531813403, "answer_id": 51375861, "question_id": 40385533, "link": "https://stackoverflow.com/questions/40385533/error-creating-table-in-vba-excel/51375861#51375861", "title": "Error creating table in VBA Excel", "body": "<p>Make sure the Function/Sub/Code, that converts your Range to Table, is put in the same sheet in which you intend to have the table on the VBA Project window. </p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11371225, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_1yPLUAcm4w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyJlPtGXD225bWCRAuTsoEgspCuQ/mo/photo.jpg?sz=128", "display_name": "Moyassar Eltigani", "link": "https://stackoverflow.com/users/11371225/moyassar-eltigani"}, "is_accepted": false, "score": 0, "last_activity_date": 1572331194, "last_edit_date": 1572331194, "creation_date": 1572311869, "answer_id": 58600302, "question_id": 40385533, "link": "https://stackoverflow.com/questions/40385533/error-creating-table-in-vba-excel/58600302#58600302", "title": "Error creating table in VBA Excel", "body": "<p>I believe you can also solve the bug by specifying the range in the table.</p>\n\n<p>For example, changing:</p>\n\n<p><code>Sheets(\"Enrollment Data Aggregate\").ListObjects.Add(xlSrcRange, Range([A1].End(xlDown), \"$n$1\"), , xlYes).Name = \"EDA_Table\"</code></p>\n\n<p>To:</p>\n\n<p><code>Sheets(\"Enrollment Data Aggregate\").ListObjects.Add(xlSrcRange, Sheets(\"Enrollment Data Aggregate\").Range([A1].End(xlDown), \"$n$1\"), , xlYes).Name = \"EDA_Table\"</code></p>\n"}], "owner": {"reputation": 53, "user_id": 7085960, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/84696ec337b6c4875273f356f12113fa?s=128&d=identicon&r=PG&f=1", "display_name": "Lui", "link": "https://stackoverflow.com/users/7085960/lui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2797, "favorite_count": 0, "accepted_answer_id": 40385701, "answer_count": 3, "score": 1, "last_activity_date": 1572331194, "creation_date": 1478105789, "question_id": 40385533, "link": "https://stackoverflow.com/questions/40385533/error-creating-table-in-vba-excel", "title": "Error creating table in VBA Excel", "body": "<p>So I am importing a bunch of data into a sheet and then I want to make it into a table. I do not know how many rows of data there will be. This code was working correctly a few days ago, but I suppose I might have unwittingly changed something. Here is the code:</p>\n\n<pre><code>Sheets(\"Enrollment Data Aggregate\").ListObjects.Add(xlSrcRange, Range([A1].End(xlDown), \"$n$1\"), , xlYes).Name = \"EDA_Table\"\n</code></pre>\n\n<p>I am getting an error message that says \"The worksheet data for a table needs to be on the same sheet as the table.\" As far as I know, I am making the table on the same page as where the data is. Any suggestions?</p>\n"}, {"tags": ["excel", "pivot-table", "vba"], "answers": [{"tags": [], "owner": {"reputation": 13122, "user_id": 1001884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14116728c7413097a42cf22736503f56?s=128&d=identicon&r=PG", "display_name": "Hambone", "link": "https://stackoverflow.com/users/1001884/hambone"}, "is_accepted": true, "score": 1, "last_activity_date": 1478132575, "creation_date": 1478132575, "answer_id": 40391923, "question_id": 40385018, "link": "https://stackoverflow.com/questions/40385018/excel-vba-how-to-use-pivot-table-calculated-field-utilizing-count-of-field/40391923#40391923", "title": "Excel VBA: How to use pivot table calculated field utilizing &quot;Count of...&quot; field", "body": "<p>When you do a calculate field, I don't know of any way to do anything other than a sum.  The good news is that in your example this is easily overcome by adding another column to your source data -- call it \"StopCount\" and fill it with all 1's.  If your data is in a table, you can use the formula <code>=1</code> and it will automatically size as your data sizes.</p>\n\n<p>Once that's done a standard calculated field should work:</p>\n\n<pre><code>pTable_MTBF.PivotFields(\"Date\").Orientation = xlRowField\npTable_MTBF.AddDataField pTable_MTBF.PivotFields(\"Uptime\"), \"Sum of Uptime\", xlSum\npTable_MTBF.AddDataField pTable_MTBF.PivotFields(\"Stops\"), \"Count of Stops\", xlCount\npTable_MTBF.CalculatedFields.Add \"MTBF\", \"=Uptime/StopCount\", True\npTable_MTBF.PivotFields(\"MTBF\").Orientation = xlDataField\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 2461949, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0575fa3110904da550e26323c14ea280?s=128&d=identicon&r=PG", "display_name": "natedogg", "link": "https://stackoverflow.com/users/2461949/natedogg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1314, "favorite_count": 1, "accepted_answer_id": 40391923, "answer_count": 1, "score": 1, "last_activity_date": 1478132575, "creation_date": 1478104178, "last_edit_date": 1531161705, "question_id": 40385018, "link": "https://stackoverflow.com/questions/40385018/excel-vba-how-to-use-pivot-table-calculated-field-utilizing-count-of-field", "title": "Excel VBA: How to use pivot table calculated field utilizing &quot;Count of...&quot; field", "body": "<p>The goal of my pivot table is to calculate <a href=\"https://en.wikipedia.org/wiki/Mean_time_between_failures\" rel=\"nofollow noreferrer\">MTBF</a> (Mean Time Between Failures). It is a very simple calculation used in manufacturing to asses machine performance:</p>\n\n<pre><code>MTBF = machine_uptime / number_of_stops\n</code></pre>\n\n<p>Ex: If a machine runs for 840 minutes with 10 stops or breakdowns, the MTBF is 84 minutes.</p>\n\n<p>This is my ideal pivot table layout:</p>\n\n<pre><code>| Date  |Sum of Uptime|Count of Stops|    MTBF    |\n|-------|-------------|--------------|------------|\n| 08/01 |   1101.4    |      6       |    184     |\n| 08/02 |   1068.0    |      7       |    153     |\n</code></pre>\n\n<p>This is how I generate the pivot table programmatically. However, my question still stands even I was creating this table manually via the GUI.</p>\n\n<pre><code>Dim pTable as PivotTable\nSet pTable_MTBF = Utilities.CreatePivotTable(ws, \"pTable_MTBF\", \"data\", ws.Cells(1, 1))\npTable_MTBF.PivotFields(\"Date\").orientation = xlRowField\npTable_MTBF.AddDataField pTable_MTBF.PivotFields(\"Uptime\"), \"Sum of Uptime\", xlSum\npTable_MTBF.AddDataField pTable_MTBF.PivotFields(\"Stops\"), \"Count of Stops\", xlCount\n' pTable_MTBF.CalculatedFields.Add \"MTBF\", \"=Uptime/'Count of Faults' (something like this?)\n' pTable_MTBF.AddDataField pTable_MTBF.PivotFields(\"MTBF\"), \"MTBF \"\n</code></pre>\n\n<p>The 'uptime' field is a sum of uptime entered with each stop, and the 'stops' field is a count of the stops entered each day. My question is, how can I set up the MTBF calculated field to successfully calculate these value? What formula should I enter in order to achieve this?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 1518663, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2b46634b93bc62b18eebfe15da701d84?s=128&d=identicon&r=PG", "display_name": "Matthew Martin", "link": "https://stackoverflow.com/users/1518663/matthew-martin"}, "edited": false, "score": 0, "creation_date": 1478167563, "post_id": 40395153, "comment_id": 68047346, "body": "Hi, In the &quot;MyFormName&quot; - This is the form containing the label? If so, It&#39;s coming up with an error saying it &#39;cannot find the referenced form&#39;. My Forms are as follows: frm_EditLesson, frm_Main, frm_Edit, Navigation Form. The Navigation form contains the other 3 forms, I&#39;ve also tried plugging the Nav form in, but get the same error."}, {"owner": {"reputation": 29, "user_id": 1518663, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2b46634b93bc62b18eebfe15da701d84?s=128&d=identicon&r=PG", "display_name": "Matthew Martin", "link": "https://stackoverflow.com/users/1518663/matthew-martin"}, "edited": false, "score": 0, "creation_date": 1478168124, "post_id": 40395153, "comment_id": 68047729, "body": "If I try to open the form by itsself, without the Navigation form and run the report, I get the error: &quot;Object doesn&#39;t support this Property or Method&quot;"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 29, "user_id": 1518663, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2b46634b93bc62b18eebfe15da701d84?s=128&d=identicon&r=PG", "display_name": "Matthew Martin", "link": "https://stackoverflow.com/users/1518663/matthew-martin"}, "edited": false, "score": 0, "creation_date": 1478197930, "post_id": 40395153, "comment_id": 68067744, "body": "Which form &quot;<i>has multiple filters in the header</i>&quot; and which form has the button to open the report - and did you put the Label in the same header as the button and filter text boxes"}, {"owner": {"reputation": 29, "user_id": 1518663, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2b46634b93bc62b18eebfe15da701d84?s=128&d=identicon&r=PG", "display_name": "Matthew Martin", "link": "https://stackoverflow.com/users/1518663/matthew-martin"}, "edited": false, "score": 0, "creation_date": 1478252745, "post_id": 40395153, "comment_id": 68087722, "body": "frm_Main has multiple fields in the header, as well as the button to open the report. Yes I have put the Label in the same header as the button and filter text boxes."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 29, "user_id": 1518663, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2b46634b93bc62b18eebfe15da701d84?s=128&d=identicon&r=PG", "display_name": "Matthew Martin", "link": "https://stackoverflow.com/users/1518663/matthew-martin"}, "edited": false, "score": 0, "creation_date": 1478306191, "post_id": 40395153, "comment_id": 68115627, "body": "Change your Report_Open line of code to say <code>Me.lblFilter.Caption = Forms(&quot;MyFormName&quot;).lblFilter.Caption</code> - you need to specify the .Caption property for labels"}, {"owner": {"reputation": 29, "user_id": 1518663, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2b46634b93bc62b18eebfe15da701d84?s=128&d=identicon&r=PG", "display_name": "Matthew Martin", "link": "https://stackoverflow.com/users/1518663/matthew-martin"}, "edited": false, "score": 0, "creation_date": 1478527166, "post_id": 40395153, "comment_id": 68178122, "body": "Thanks alot, I had the line in the Report_Load instead of Open. It&#39;s now displaying the filter in the label. Instead of the actual text appearing however it is returning a number (the ID/Primary Key of the field?) Do you know how I can get it to return the value of the second column instead?"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "reply_to_user": {"reputation": 29, "user_id": 1518663, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2b46634b93bc62b18eebfe15da701d84?s=128&d=identicon&r=PG", "display_name": "Matthew Martin", "link": "https://stackoverflow.com/users/1518663/matthew-martin"}, "edited": false, "score": 0, "creation_date": 1478538404, "post_id": 40395153, "comment_id": 68185656, "body": "Use the .<code>Column</code> property of the combobox (assuming that&#39;s what your referring to). <b>NOTE</b> it&#39;s a zero-based index so you&#39;ll need to subtract one from your actual column location number."}], "tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1478306149, "last_edit_date": 1478306149, "creation_date": 1478154704, "answer_id": 40395153, "question_id": 40384931, "link": "https://stackoverflow.com/questions/40384931/access-2010-vba-filter-how-to-display-the-filter-string-in-a-report-textbox/40395153#40395153", "title": "Access 2010 VBA Filter --&gt; How to display the filter string in a report textbox/label", "body": "<p>You should be able to do it dynamically by referencing a textbox or label in your form</p>\n\n<p>Add a label (<code>lblFilter</code>) to your report with Caption = \"Filter Here\"</p>\n\n<p>Add a label (<code>lblFilter</code>) to your form header (make <code>Visible = False</code>) - same caption</p>\n\n<p>Right after your line</p>\n\n<pre><code>Me.Filter = strWhere\n</code></pre>\n\n<p>Add the line to fill your invisible label</p>\n\n<pre><code>lblFilter.Caption = strWhere\n</code></pre>\n\n<p>Then in your Report_Open event add the code:</p>\n\n<pre><code>Me.lblFilter.Caption = Forms(\"MyFormName\").lblFilter.Caption\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 1518663, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/2b46634b93bc62b18eebfe15da701d84?s=128&d=identicon&r=PG", "display_name": "Matthew Martin", "link": "https://stackoverflow.com/users/1518663/matthew-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 40395153, "answer_count": 1, "score": 0, "last_activity_date": 1478306149, "creation_date": 1478103923, "last_edit_date": 1478157826, "question_id": 40384931, "link": "https://stackoverflow.com/questions/40384931/access-2010-vba-filter-how-to-display-the-filter-string-in-a-report-textbox", "title": "Access 2010 VBA Filter --&gt; How to display the filter string in a report textbox/label", "body": "<p>I have a Continuous Form which has multiple filters in the header, which then apply at the click of a button, and filter the table beneath. \nThe user can then click a 'Report' Button which will put the results of that filter into a Report style, print-out friendly. \nI was wondering whether there was a way to return the filter applied, as a text box or label in my report?</p>\n\n<p>FYI, the code is: </p>\n\n<pre><code>Private Sub frm_Filter_Click()\nDim strWhere As String\nDim lngLen As Long\n\nIf Not IsNull(Me.cmbCategory) Then\n    strWhere = strWhere &amp; \"([Category] = \"\"\" &amp; Me.cmbCategory &amp; \"\"\") AND \"\nEnd If\n\nIf Not IsNull(Me.cmbStage) Then\n    strWhere = strWhere &amp; \"([Stage] = \"\"\" &amp; Me.cmbStage &amp; \"\"\") AND \"\nEnd If\n\nIf Not IsNull(Me.cmbImpact) Then\n    strWhere = strWhere &amp; \"([Impact] = \"\"\" &amp; Me.cmbImpact &amp; \"\"\") AND \"\nEnd If\n\nIf Not IsNull(Me.cmbStatus) Then\n    strWhere = strWhere &amp; \"([Status] = \"\"\" &amp; Me.cmbStatus &amp; \"\"\") AND \"\nEnd If\n\nIf Not IsNull(Me.cmbOwner) Then\n    strWhere = strWhere &amp; \"([Owner] = \"\"\" &amp; Me.cmbOwner &amp; \"\"\") AND \"\nEnd If\n\nIf Not IsNull(Me.cmbChangeType) Then\n    strWhere = strWhere &amp; \"([ChangeType] = \"\"\" &amp; Me.cmbChangeType &amp; \"\"\") AND \"\nEnd If\n\nIf Not IsNull(Me.txtOBR) Then\n    strWhere = strWhere &amp; \"([tbl_Main.OBR] Like \"\"*\" &amp; Me.txtOBR &amp; \"*\"\") AND \"\nEnd If\n\nIf Not IsNull(Me.txtRaisedBy) Then\n    strWhere = strWhere &amp; \"([tbl_Main.RaisedBy] Like \"\"*\" &amp; Me.txtRaisedBy &amp; \"*\"\") AND \"\nEnd If\n\nIf Not IsNull(Me.txtApplication) Then\n    strWhere = strWhere &amp; \"([tbl_Main.Application] Like \"\"*\" &amp; Me.txtApplication &amp; \"*\"\") AND \"\nEnd If\n\nIf Not IsNull(Me.txtSearch) Then\nstrWhere = strWhere &amp; \"(tbl_Main.Description Like '*\" &amp; Me.txtSearch &amp; \"*' OR tbl_Main.LessonsLearnt Like '*\" &amp; Me.txtSearch &amp; \"*' OR tbl_Main.RecommendedAction Like '*\" &amp; Me.txtSearch &amp; \"*') AND \"\nEnd If\n\nlngLen = Len(strWhere) - 5\nIf lngLen &lt;= 0 Then\n    MsgBox \"No Criteria Selected\", vbInformation, \"Nothing to do.\"\nElse\n        strWhere = Left$(strWhere, lngLen)\n\n        Me.Filter = strWhere\n        Me.FilterOn = True\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Any input is greatly appreciated.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1478103732, "post_id": 40384778, "comment_id": 68021608, "body": "Change the <code>saveFolder</code> string value to the network folder, including its IP e.g. <code>saveFolder = &quot;\\\\00.0.00.000\\ExampleNetworkFolderName\\ExampleFolderName</code>"}, {"owner": {"reputation": 11, "user_id": 7105664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mYObb.jpg?s=128&g=1", "display_name": "Morgan Klaif", "link": "https://stackoverflow.com/users/7105664/morgan-klaif"}, "reply_to_user": {"reputation": 4114, "user_id": 5751805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da1c3545802a510a9b283f706d74283a?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/5751805/jordan"}, "edited": false, "score": 0, "creation_date": 1478108044, "post_id": 40384778, "comment_id": 68024218, "body": "Will that work even if Outlook is closed?  As far as I was told, from the initial script used, Outlook has to be open.  Would it work if the VBA was on the exchange server itself?"}], "owner": {"reputation": 11, "user_id": 7105664, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mYObb.jpg?s=128&g=1", "display_name": "Morgan Klaif", "link": "https://stackoverflow.com/users/7105664/morgan-klaif"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 359, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1478103462, "creation_date": 1478103462, "question_id": 40384778, "link": "https://stackoverflow.com/questions/40384778/excel-client-side-to-server-side", "title": "Excel Client Side to Server Side", "body": "<p>Good afternoon.</p>\n\n<p>The YMCA I work at is looking to move into a paperless setup at our membership services desks.  We will be using Adobe Sign to get documents signed which will then send .PDF files to a default email address.</p>\n\n<p>I found a Client Side VBA script to automatically send attachments to a hard drive folder, but I am looking for assistance on how to change it to Server Side.</p>\n\n<p>The Client Side VBA is:</p>\n\n<pre><code>Public Sub saveAttachtoDisk(itm As Outlook.MailItem)\nDim objAtt As Outlook.Attachment\nDim saveFolder As String\nsaveFolder = \"c:\\temp\\\"\n     For Each objAtt In itm.Attachments\n          objAtt.SaveAsFile saveFolder &amp; \"\\\" &amp; objAtt.DisplayName\n          Set objAtt = Nothing\n     Next\nEnd Sub\n</code></pre>\n\n<ol>\n<li>How can I get this Server Side, so it sends to a network folder?</li>\n</ol>\n"}, {"tags": ["vba", "excel", "date"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478103310, "post_id": 40384624, "comment_id": 68021339, "body": "There isn&#39;t, but you could use what you have for date, then timeserial on mid of sections of 2, for timeserial, and add, and have a custom string o/p so in essence, your own function GENERATE_TIMESTAMP() as string maybe"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1478103386, "post_id": 40384624, "comment_id": 68021380, "body": "as to number 2, add them together to get the date and time DateSerial() + TimeSerial() = specific date time.  Date is a long and time a decimal so the two together = a double."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1478108235, "post_id": 40384624, "comment_id": 68024334, "body": "Dates and times are held as numbers. They are only displayed as dates and or times because of NumberFormat. Dates are held as days since 1/1/1900. Times are held as SecondsSinceMidnight / SecondsInDay. So Dates are whole numbers. Times are fractions. They can be added."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1478108608, "post_id": 40384624, "comment_id": 68024566, "body": "No Excel or VBA function of which I am aware displays fractions of a seconds correctly although values are held to the nearest 1/1000th of a second.  I have code for this somewhere.  I will look but no promises.  If I remember correctly, my code multiples the fraction of a second by SecondsInDay * 100 and then left pads that value with a zero to get the fraction."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 5, "last_activity_date": 1478103776, "creation_date": 1478103776, "answer_id": 40384889, "question_id": 40384624, "link": "https://stackoverflow.com/questions/40384624/excel-vba-create-a-datetime-value/40384889#40384889", "title": "Excel VBA create a date+time value", "body": "<p>Something like this, maybe??</p>\n\n<p><code>? generate_timestamp(\"20161102\",\"170522349\")</code></p>\n\n<p>gives</p>\n\n<p><code>02/11/2016 17:05:23.49</code></p>\n\n<pre><code>Function GENERATE_TIMESTAMP(strDate As String, strTime As String) As String\n\nDim dtDate As Date\nDim dtTime As Date\n\ndtDate = DateSerial(Mid(strDate, 1, 4), Mid(strDate, 5, 2), Mid(strDate, 8, 2))\ndtTime = TimeSerial(Mid(strTime, 1, 2), Mid(strTime, 3, 2), Mid(strTime, 6, 2))\n\nGENERATE_TIMESTAMP = FormatDateTime(dtDate, vbShortDate) &amp; \" \" &amp; _\n                        FormatDateTime(dtTime, vbLongTime) &amp; \".\" &amp; _\n                        Mid(strTime, 8, 2)\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1478104042, "post_id": 40384894, "comment_id": 68021787, "body": "Actually testing further I see an error in that custom formatting will only show the integer seconds. So in your example for seconds it would show &quot;23.23&quot; rather than &quot;23.49&quot;. Thinking about alternate solution. Apologies."}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 1, "last_activity_date": 1478104334, "last_edit_date": 1478104334, "creation_date": 1478103790, "answer_id": 40384894, "question_id": 40384624, "link": "https://stackoverflow.com/questions/40384624/excel-vba-create-a-datetime-value/40384894#40384894", "title": "Excel VBA create a date+time value", "body": "<p>EDIT: After testing found formatting was dropping the fractions of seconds, and just repeating fractions. I devised this formula to resolve. Note that the formula here does not output a serial representation of the datetime but is just a text string.</p>\n\n<pre><code>=TEXT(DATE(LEFT(A1,4),MID(A1,5,2),RIGHT(A1,2))+TIME(LEFT(B1,2),MID(B1,3,2),MID(B1,5,2)),\"m/d/yyyy hh:mm:ss\")&amp;\".\"&amp;RIGHT(B1,2)\n</code></pre>\n\n<p>PREVIOUS RESPONSE:</p>\n\n<p>You can create the serial using the following formula:</p>\n\n<pre><code>=DATE(LEFT(A1,4),MID(A1,5,2),RIGHT(A1,2))+TIME(LEFT(B1,2),MID(B1,3,2),MID(B1,5,2))+(RIGHT(B1,2)/(24*60*60*100))\n</code></pre>\n\n<p>And then format your cell as Custom with m/d/yyyy hh:mm:ss.ss. Here I am not passing the fraction of seconds to the <code>TIME()</code> function but rather adding as a fraction of a day.</p>\n"}], "owner": {"reputation": 435, "user_id": 4994393, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/W8OxP.jpg?s=128&g=1", "display_name": "jacek_wi", "link": "https://stackoverflow.com/users/4994393/jacek-wi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9722, "favorite_count": 1, "accepted_answer_id": 40384889, "answer_count": 2, "score": 1, "last_activity_date": 1478104334, "creation_date": 1478103041, "last_edit_date": 1478103799, "question_id": 40384624, "link": "https://stackoverflow.com/questions/40384624/excel-vba-create-a-datetime-value", "title": "Excel VBA create a date+time value", "body": "<p>In my table I have two columns containing data of type: <code>yyyymmdd</code> and <code>hhmmddxx</code> - first contains date and the other time with precision to 0.01 seconds. So for example I have <code>20161102</code> and <code>17052349</code>.</p>\n\n<p>I want to convert this into a single value showing a moment in time and display this in format <code>dd/mm/yyyy hh:mm:ss.xx</code>, so for example I want to get <code>02/11/2016 17:05:23.49</code>. I think I need to use <code>DateSerial</code> and <code>TimeSerial</code> functions, but there are two problems I have no idea how to go around:</p>\n\n<ol>\n<li>TimeSerial accepts hour, minute and second as argument, all are Integer type, how to pass fractions of a second to it?</li>\n<li>DateSerial will create my day and TimeSerial will create my time, is there a function that takes date and time as argument and creates a single \"that day, on that time\" value out of this?</li>\n</ol>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1478103722, "post_id": 40384439, "comment_id": 68021600, "body": "You don&#39;t have any recordsets open yet because your debug line is on the OpenRecordset method - nothing has been opened yet. Other than that - fix your double quotes like @Andre points out"}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 7033426, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jjICw.jpg?s=128&g=1", "display_name": "Matt F.", "link": "https://stackoverflow.com/users/7033426/matt-f"}, "edited": false, "score": 0, "creation_date": 1478104363, "post_id": 40384782, "comment_id": 68021990, "body": "Thanks -- changing the quotes worked.  Curiously the troublesome typographic quotes were in the tutorial."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "reply_to_user": {"reputation": 123, "user_id": 7033426, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jjICw.jpg?s=128&g=1", "display_name": "Matt F.", "link": "https://stackoverflow.com/users/7033426/matt-f"}, "edited": false, "score": 0, "creation_date": 1478111565, "post_id": 40384782, "comment_id": 68026322, "body": "Yeah, that&#39;s unfortunate. The tutorial is a PDF that was probably created from Word, and Word automatically replaces the quotes unless this feature is disabled. @MattF."}], "tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 2, "last_activity_date": 1478103476, "creation_date": 1478103476, "answer_id": 40384782, "question_id": 40384439, "link": "https://stackoverflow.com/questions/40384439/why-does-my-database-object-show-no-recordsets/40384782#40384782", "title": "Why does my database object show no Recordsets?", "body": "<p>You have typographic quotes in there, use straight ones \"\".</p>\n\n<p>And use your assigned database object:</p>\n\n<pre><code>Set rsCourses = dbCurr.OpenRecordset(\"Courses\")\n</code></pre>\n\n<p>And <em>please</em> don't post only screenshots of code, copy &amp; paste the code itself as text.</p>\n"}], "owner": {"reputation": 123, "user_id": 7033426, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jjICw.jpg?s=128&g=1", "display_name": "Matt F.", "link": "https://stackoverflow.com/users/7033426/matt-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 40384782, "answer_count": 1, "score": 1, "last_activity_date": 1594641120, "creation_date": 1478102436, "last_edit_date": 1594641120, "question_id": 40384439, "link": "https://stackoverflow.com/questions/40384439/why-does-my-database-object-show-no-recordsets", "title": "Why does my database object show no Recordsets?", "body": "<p>Why does my database object show no Recordsets?  And why does it not show a Connection?  The key bit of code is:</p>\n\n<pre><code>Public Sub PrintRecords()\n  Dim dbCurr As DAO.Database\n  Set dbCurr = CurrentDb\n\n  Dim rsCourses as Recordset\n  Set rsCourses = CurrentDb.OpenRecordset(\u201cCourses\u201d)\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/nOPcV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nOPcV.png\" alt=\"screenshot at time of error\"></a>\nHere is my screenshot, where the database has tables (upper left), but the CurrentDB object has a name but no Recordsets (in the locals window below.)</p>\n\n<p>For what it\u2019s worth, this is in Access 2013, following <a href=\"https://fisher.osu.edu/~muhanna.1/837/MSAccess/tutorials/dao_intr.pdf\" rel=\"nofollow noreferrer\">this</a> tutorial to manipulate the database, stopping on the error \u201cRun-time error \u20183078\u2019:  The Microsoft Access database engine cannot find the input table or query\u201d.  But the problem seems to be deeper than that.</p>\n"}, {"tags": ["excel", "messagebox", "suppressmessage", "vba"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 2, "creation_date": 1478104643, "post_id": 40384205, "comment_id": 68022153, "body": "Do those files have macros that might be causing those pop ups?"}, {"owner": {"reputation": 43, "user_id": 6930865, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2f94c593478240d5e592e9b0e5e857e4?s=128&d=identicon&r=PG&f=1", "display_name": "R. Patrick-White", "link": "https://stackoverflow.com/users/6930865/r-patrick-white"}, "reply_to_user": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 0, "creation_date": 1478105580, "post_id": 40384205, "comment_id": 68022705, "body": "Ah yes they do didn&#39;t even check that, thanks I think I just need to delete/ turn off the macro in them"}], "answers": [{"tags": [], "owner": {"reputation": 2555, "user_id": 5794172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd463d10de161a2b8fbf601f51c58d01?s=128&d=identicon&r=PG&f=1", "display_name": "jkpieterse", "link": "https://stackoverflow.com/users/5794172/jkpieterse"}, "is_accepted": true, "score": 1, "last_activity_date": 1478108525, "creation_date": 1478108525, "answer_id": 40386387, "question_id": 40384205, "link": "https://stackoverflow.com/questions/40384205/using-vba-how-to-prevent-a-message-from-appearing-when-opening-a-file/40386387#40386387", "title": "Using VBA how to prevent a message from appearing when opening a file?", "body": "<p>Add </p>\n\n<pre><code>Application.EnableEvents=False\n</code></pre>\n\n<p>before opening the wb and set back to true afterwards</p>\n\n<p>Alternatively, use:</p>\n\n<pre><code>Application.AutomationSecurity=msoAutomationSecurityForceDisable\n</code></pre>\n\n<p>Remember to set back to whatever the user has...</p>\n"}], "owner": {"reputation": 43, "user_id": 6930865, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2f94c593478240d5e592e9b0e5e857e4?s=128&d=identicon&r=PG&f=1", "display_name": "R. Patrick-White", "link": "https://stackoverflow.com/users/6930865/r-patrick-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2994, "favorite_count": 1, "accepted_answer_id": 40386387, "answer_count": 1, "score": 0, "last_activity_date": 1478108525, "creation_date": 1478101812, "last_edit_date": 1531164843, "question_id": 40384205, "link": "https://stackoverflow.com/questions/40384205/using-vba-how-to-prevent-a-message-from-appearing-when-opening-a-file", "title": "Using VBA how to prevent a message from appearing when opening a file?", "body": "<p>I'm creating a macro which opens numerous files, refreshes them, and then saves and closes. All is running smoothly however for 2 of the files when they are opened a message pops up which reads \"Files run on an inclusion list - titles may be missing.\" this halts the macro until \"ok\" is pressed. I have used \"Application.DisplayAlerts = False\" before but it doesn't seem to be working here. My code is as follows:</p>\n\n<pre><code>Public Sub Refresh_All()\n\nDim filepathstr As String\nDim filename As String\nDim wbk As Workbook\n\nfilepathstr = Sheet1.Range(\"filepath\").Value\n\nFor Each cell In Sheet1.Range(\"workbooks\")\n\nIf Not cell.Value = \"\" Then\n\n    filename = cell.Value\n    Application.DisplayAlerts = False\n    Set wbk = Workbooks.Open(filepathstr &amp; filename, False)\n\n\n    ''''**REFRESH**''''''\n    SAPBexrefresh (True)\n\n    Application.DisplayAlerts = False\n    wbk.Save\n    wbk.Close False\n    Application.DisplayAlerts = True\n\nEnd If\n\nNext cell\n\nMsgBox \"The Macro has finished; BW Reports are refreshed.\"\n\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1478102799, "post_id": 40384201, "comment_id": 68021030, "body": "Excel has a great feature, called the <a href=\"http://www.dummies.com/software/microsoft-office/excel/how-to-record-a-macro-to-automate-tasks-in-excel-2010/\" rel=\"nofollow noreferrer\">macro recorder</a>.  You can use this to record your manual actions as VBA, for next time."}, {"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1478103283, "post_id": 40384201, "comment_id": 68021322, "body": "What do you mean by copy all sheets &quot;Front&quot;? Is there more than one sheet with the name &quot;Front&quot;?"}, {"owner": {"reputation": 17, "user_id": 4815127, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bef6453d0467d109c71d29dabe276905?s=128&d=identicon&r=PG&f=1", "display_name": "Grz3siu", "link": "https://stackoverflow.com/users/4815127/grz3siu"}, "edited": false, "score": 0, "creation_date": 1478104271, "post_id": 40384201, "comment_id": 68021939, "body": "I have file xlslx to generate Packing List. In this file i have 2 sheets, FRONT  and cache. I need to copy two sheets to new file (save as). Range to COPY from FRONT A1:N24, RANGE TO COPY from CACHE: is dynamic value - at the moment a2:N10.  Now paste in new file: -VALUE FROM &quot;FRONT&quot; -VALUE FROM &quot;CACHE&quot;  I&#39;m make this manual and make screen <a href=\"http://srv3.sendfile.pl/pobierz/950031---wkfb/5316677400_1326980696.jpg\" rel=\"nofollow noreferrer\">srv3.sendfile.pl/pobierz/950031---wkfb/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478108235, "post_id": 40385175, "comment_id": 68024335, "body": "just some (possibly) usefule notes 1) no need for <code>Set NewSheet = ActiveWorkbook.ActiveSheet</code> statement (and for <code>NewSheet</code> declaration as well) since after <code>Front1.Copy</code> the newly created workbook becomes the &quot;active&quot; workbook and its only worksheet becomes its &quot;active&quot; worksheet  2) hence <code>NewSheet.Cells(LastRow, 1).PasteSpecial</code> can become <code>Cells(LastRow, 1).PasteSpecial</code> 3) you can also avoid the declaraton and calculation of <code>LastRow</code> as you can see per my answer"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6200045"}, "reply_to_user": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478623597, "post_id": 40385175, "comment_id": 68228544, "body": "I always declare them so i can switch later"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6200045"}, "is_accepted": false, "score": 0, "last_activity_date": 1478104648, "creation_date": 1478104648, "answer_id": 40385175, "question_id": 40384201, "link": "https://stackoverflow.com/questions/40384201/copy-2-sheets-vba-excel/40385175#40385175", "title": "Copy 2 sheets vba excel", "body": "<pre><code>Sub z()\nDim NewSheet, Cache1, Front1 As Worksheet\nDim LastRow As Integer\nSet Front1 = ActiveWorkbook.Worksheets(\"Front\")\nSet Cache1 = ActiveWorkbook.Worksheets(\"Cache\")\nFront1.Copy\nSet NewSheet = ActiveWorkbook.ActiveSheet\nLastRow = Front1.UsedRange.Rows(Front1.UsedRange.Rows.Count).Row + 1\nCache1.Range(\"A2:N10\").Copy\nNewSheet.Cells(LastRow, 1).PasteSpecial\nApplication.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>Once the Sheets are declared, it's easy to shove the data around. I tested this part; then run your Save code</p>\n"}, {"tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1478107820, "creation_date": 1478107820, "answer_id": 40386173, "question_id": 40384201, "link": "https://stackoverflow.com/questions/40384201/copy-2-sheets-vba-excel/40386173#40386173", "title": "Copy 2 sheets vba excel", "body": "<p>assuming that worksheets \"Front\" and \"Cache\" are in the workbook the macro resides in, then you can type:</p>\n\n<pre><code>Sub main()\n    Worksheets(\"Front\").Copy '&lt;--| this creates a new workbook with one worksheet that becomes the \"active\" one\n    ThisWorkbook.Worksheets(\"Cache\").Range(\"A2:N10\").Copy '&lt;--| 'ThisWorkbook' refers to the workbook the running macro resides in, no matter which is the \"active\" workbook\n    Cells(Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial '&lt;--| no need to qualify range references up to its worksheet to implicitly assume the \"active\" one  \n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n\n<p>While if worksheets \"Front\" and \"Cache\" are NOT in the workbook the macro resides in, then you can type:</p>\n\n<pre><code>Sub main2()\n    Dim rngToCopy As Range\n\n    Set rngToCopy = Worksheets(\"Cache\").Range(\"A2:N10\") '&lt;--| set the range to copy before changing the \"active\" workbook with the worksheet 'Copy' method call        \n    Worksheets(\"Front\").Copy '&lt;--| this creates a new workbook with one worksheet that becomes the \"active\" one\n    rngToCopy.Copy '&lt;--| copy the range you previously stored\n    Cells(Rows.Count, 1).End(xlUp).Offset(1).PasteSpecial '&lt;--| no need to qualify range references up to its worksheet to implicitly assume the \"active\" one\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 4815127, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/bef6453d0467d109c71d29dabe276905?s=128&d=identicon&r=PG&f=1", "display_name": "Grz3siu", "link": "https://stackoverflow.com/users/4815127/grz3siu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 40386173, "answer_count": 2, "score": 0, "last_activity_date": 1478107820, "creation_date": 1478101794, "last_edit_date": 1478102290, "question_id": 40384201, "link": "https://stackoverflow.com/questions/40384201/copy-2-sheets-vba-excel", "title": "Copy 2 sheets vba excel", "body": "<p>I need to copy 2 sheets, and save in other file.</p>\n\n<p>I need copy all sheets \"Front\"\nand bottom add Range(\"A2:N10\") from sheets \"Cache\"</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Worksheets(\"Front\").Copy\r\n    With ActiveSheet.UsedRange\r\n        .Value = .Value\r\n    End With\r\n    \r\n    Set wbNew = ActiveWorkbook\r\n    wbNew.SaveAs \"C:\\______\\pl.xlsx\"\r\n    wbNew.Close True</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Result:\nNew file \"pl.xlsx\"\nwhere\nA1:N25 = Sheets Front</p>\n\n<p>A26:N43 = Sheets Cache :D</p>\n\n<p>Any sugestions ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 1, "creation_date": 1478103039, "post_id": 40384130, "comment_id": 68021189, "body": "I think <code>uDisable</code> is locking and protecting the sheet.  While <code>uEnable</code> is only unlocking.  Will probably need to unprotect, with the relevant password, too."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1478103191, "post_id": 40384130, "comment_id": 68021285, "body": "Also seems to be redundant to have a yes/no check in more than one spot. You should just let the one section handle that"}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1478104929, "post_id": 40384130, "comment_id": 68022318, "body": "@destination-data I tried to use unprotect/protect in uEnable (modified the code above). But that dint help too!!"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1478105026, "post_id": 40384130, "comment_id": 68022383, "body": "What happened when you tried?"}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "reply_to_user": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1478105194, "post_id": 40384130, "comment_id": 68022470, "body": "@destination-data Issue still persist. Cells are not getting enabled when the drop is set &quot;yes&quot;. I have to select &quot;no&quot; and click &quot;ok&quot; on message prompt to click &quot;ok&quot;, so that cells are enabled."}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1478105280, "post_id": 40384130, "comment_id": 68022525, "body": "@DougCoats Sure, do you suggestions on which section to modify? I am out of ideas on it"}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478105235, "post_id": 40385234, "comment_id": 68022492, "body": "@Comintem, sure, let me quickly try that!!"}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478105766, "post_id": 40385234, "comment_id": 68022831, "body": "@Comintem, Unfortunately, It dint help. Any idea, why uEnable function module is not getting called when i select &quot;Yes&quot; value in dropdown"}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478107906, "post_id": 40385234, "comment_id": 68024131, "body": "I guess thats the problem. Call uEnable is not calling the module. But not sure what could be the reason. Please suggest if you have any"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478108032, "post_id": 40385234, "comment_id": 68024210, "body": "@sady - <code>Public uEnable()</code> should be <code>Public Sub uEnable()</code>. Also, you have <code>Range(&quot;A11&quot;)</code> in <code>uDisable</code>, but <code>Range(&quot;A1&quot;)</code> in <code>Worksheet_Change</code>.  Are those supposed to be different cells?"}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478108416, "post_id": 40385234, "comment_id": 68024454, "body": "@Comintem - I did a blunder while copying. It was a typo. On the workbook i see it is public Sub uEnable(). Range (&quot;A1&quot;) is actually (A11), ?It was a typo again"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478108870, "post_id": 40385234, "comment_id": 68024703, "body": "@sady - Are you trying to protect and unprotect the worksheets, or the workbooks?"}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478110834, "post_id": 40385234, "comment_id": 68025898, "body": "@Comintem Its actually worksheets. ActiveSheet.Unprotect Password:=&quot;xyz&quot;...will this help?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478111559, "post_id": 40385234, "comment_id": 68026319, "body": "@sady - Remove the <code>ActiveWorkbook</code> inside of all of the <code>With</code> blocks, i.e. <code>.Unprotect Password:=&quot;xyz&quot;</code>."}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478111708, "post_id": 40385234, "comment_id": 68026404, "body": "@Comintem one more question, In the first line of the worksheet_change event I have used    <code>If Intersect(Target, Range(&quot;A11&quot;)) Is Nothing Then Exit Sub</code>. Instead of exit sub, how to use goto here. Because, I do have other `intersect&#39; code below. I guess its exiting at the first line when it finds no change."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478111861, "post_id": 40385234, "comment_id": 68026478, "body": "@sady - Reverse the condition and build an <code>If ... Else</code> or <code>Select Case</code> structure: <code>If Not Intersect(Target, Range(&quot;A11&quot;)) Is Nothing Then...</code> whatever for <code>A11</code> changing."}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478113618, "post_id": 40385234, "comment_id": 68027413, "body": "@Cominten  I gues that did the trick. I used if not and looks like things started to work. However, I would have to fully test it. Thanks a ton bro!!"}, {"owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478113678, "post_id": 40385234, "comment_id": 68027441, "body": "@Cominten, I would like to use select case structure instead of if not. Can you please help on how to build it. Here is the two intersect code I was talking about. I have pasted it above"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "edited": false, "score": 0, "creation_date": 1478114033, "post_id": 40385234, "comment_id": 68027621, "body": "@sady - That sounds like a different question.  Luckily <a href=\"http://stackoverflow.com/q/29461638/4088852\">it&#39;s already been answered here.</a>"}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 4, "last_activity_date": 1478104887, "creation_date": 1478104887, "answer_id": 40385234, "question_id": 40384130, "link": "https://stackoverflow.com/questions/40384130/vba-code-not-coming-out-of-loop/40385234#40385234", "title": "VBa Code not coming out of loop", "body": "<p>Remove the <code>Exit Sub</code> from underneath <code>Call uDisable</code>.  Otherwise <code>Application.EnableEvents = True</code> never gets called...</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Range(\"A1\")) Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n    Select Case (Target.Value)\n        Case \"YES\"\n            Call uEnable\n        Case \"NO\"\n            Call uDisable\n            'Exit Sub     &lt;---Can't do this.\n    End Select\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>...and there isn't any other code that will turn them back on.  You can't rely on an event handler to set <code>Application.EnableEvents = True</code> after you've turned off event handling.</p>\n"}], "owner": {"reputation": 191, "user_id": 6577318, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/366e286b753b6f393f1abd32db89ea73?s=128&d=identicon&r=PG&f=1", "display_name": "sady", "link": "https://stackoverflow.com/users/6577318/sady"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478113750, "creation_date": 1478101588, "last_edit_date": 1478113750, "question_id": 40384130, "link": "https://stackoverflow.com/questions/40384130/vba-code-not-coming-out-of-loop", "title": "VBa Code not coming out of loop", "body": "<p>Question looks big but answer for you guys will be simple\nI have code that works for first time and not working for second attempt.\nI have 2 sheets \"Menu\" and \"Subsheet\"\nBasically, i have data validation drop-down set on Menu Sheet yes/no values.\n<strong>First scenario</strong>\nSelecting \"Yes\" will enable the cells on second sheet (Subsheet)\nSelecting \"No\" will disable cells on second sheet(Subsheet).</p>\n\n<p><strong>Second scenario,</strong>\nUser selecting \"no\" and selecting second sheet will throw a prompt for him to enable cells \"ok\" and cancel.\nSelect \"ok\" will enable cells and value in dropdown will be changed to \"yes\"\nselecting \"cancel\" in msgprompt  will disable cells and value in dropdown will remain \"no\"\nMsg prompt should not be displayed, if user has selected \"yes\" in dropdown..</p>\n\n<p>Question:Code works fine, until it comes to second scenario.\nUser selects \"No\" and selects second sheet in the message prompt, he selects \"no\". Now cells are disabled. \nIf user comes back to Menu Sheet and selects \"<strong><em>Yes\", will not enable cells.</em></strong>\nNot sure what is it not enabling cells now. Please help</p>\n\n<p>Code on Menu Sheet</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If Intersect(Target, Range(\"A11\")) Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n    Select Case (Target.Value)\n      Case \"YES\"\n        Call uEnable\n      Case \"NO\"\n         Call uDisable\n         Exit Sub\n    End Select\n  Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p>Code on SubSheet</p>\n\n<pre><code>Private Sub Worksheet_Activate()\n  UDisable\nEnd Sub\n</code></pre>\n\n<p>Code on Module</p>\n\n<pre><code>Option Explicit\nPrivate mMessageDisplayed As Boolean\nPublic Sub uDisable()\n  If ActiveSheet.ProtectContents And Not mMessageDisplayed Then\n    mMessageDisplayed = True\n    If ThisWorkbook.Sheets(\"Menu\").Range(\"A11\") = \"NO\" Then\n      If MsgBox(\"Cells are locked on current sheet, press ok to Unlock\", vbOKCancel + vbInformation) = vbOK Then\n        ThisWorkbook.Worksheets(\"Menu\").Range(\"A11\") = \"YES\"\n        With ThisWorkbook.Sheets(\"Subsheet\")\n          ActiveWorkbook.Unprotect Password:=\"xyz\"\n          .Range(\"E13:E14\").Locked = False\n          ActiveWorkbook.Unprotect Password:=\"xyz\"\n        End With\n      Else\n        ThisWorkbook.Worksheets(\"Menu\").Range(\"A11\") = \"NO\"\n        With ThisWorkbook.Sheets(\"Subsheet\")\n          ActiveWorkbook.Unprotect Password:=\"xyz\"\n          .Range(\"E13:E14\").Locked = True\n          ActiveWorkbook.Protect Password:=\"xyz\"\n        End With\n      End If\n    Else\n      Exit Sub\n    End If\n  End If\nEnd Sub\n</code></pre>\n\n<p>Second module</p>\n\n<pre><code>Public Sub uEnable()\n  With ThisWorkbook.Sheets(\"Subsheet\")\n    ActiveWorkbook.Unprotect Password:=\"xyz\"\n    .Range(\"E13:E14\").Locked = False\n    ActiveWorkbook.Protect Password:=\"xyz\"\n  End With\nEnd Sub\n</code></pre>\n\n<p>I tried to use debug method, couldn't identify the root cause.</p>\n\n<p>Two intersect codes</p>\n\n<pre><code>`Private Sub Worksheet_Change(ByVal Target As Range)\nIf Intersect(Target, Range(\"E42\")) Is Nothing Then Exit Sub\n        Application.EnableEvents = False\n        Dim inputCell As Range\n        Set inputCell = Range(\"E43\")\n            Select Case (Target.Value)\n                Case \"Specific Days\"\n                    inputCell.Locked = False\n                    inputCell.Activate\n                Case Else\n                'This handles **ANY** other value in the dropdown\n                    inputCell.Locked = True\n    '                inputCell.Clear\n            End Select\n       Application.EnableEvents = True\n\nIf Intersect(Target, Range(\"E29\")) Is Nothing Then Exit Sub\n        Application.EnableEvents = False\n        Select Case (Target.Value)\n            Case \"YES\"\n                Call Notify\n            Case \"NO\"\n                 Call NotifyUserGeneral\n        End Select\n       Application.EnableEvents = True\nEnd Sub`\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 14066, "user_id": 6426692, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/KDZsR.jpg?s=128&g=1", "display_name": "Ilyes", "link": "https://stackoverflow.com/users/6426692/ilyes"}, "edited": false, "score": 1, "creation_date": 1478101789, "post_id": 40384062, "comment_id": 68020333, "body": "What you try so far?"}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1478110221, "post_id": 40384062, "comment_id": 68025538, "body": "If the data is on the table it should be on the query. When you say &quot;the data from the right hand table will not show up on the query&quot; are you testing the actual query or just the bound form?"}], "owner": {"reputation": 27, "user_id": 7099570, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/194782ef69a39ca51f11aff9ae042442?s=128&d=identicon&r=PG&f=1", "display_name": "Mari", "link": "https://stackoverflow.com/users/7099570/mari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478101390, "creation_date": 1478101390, "question_id": 40384062, "link": "https://stackoverflow.com/questions/40384062/data-entry-forms-into-multiple-tables-in-ms-access", "title": "Data entry forms into multiple tables in MS Access", "body": "<p>I have a data entry form bound to a query which has two tables with a left-to-right join (option 2 on join options).</p>\n\n<p>The fields on the form are all bound to one of the fields from either table in the query.</p>\n\n<p>My problem is that after I enter the data into the form and save it, the data from the right hand table will not show up on the query that the form is linked to, even though the data has been saved into the right hand table. The fields come up as blanks in the middle of fields that are filled. The fields from the left hand table are saved and appear, filled.</p>\n\n<p>I need to be able to do this so that I can display the new data as a sub form in a different form. </p>\n\n<p>Any help appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1856, "user_id": 4949483, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10207184362590012/picture?type=large", "display_name": "Rdster", "link": "https://stackoverflow.com/users/4949483/rdster"}, "edited": false, "score": 1, "creation_date": 1478101837, "post_id": 40383995, "comment_id": 68020365, "body": "You are probably gonna want to use <code>Application.EnableEvents = False</code> to make those other changes, and then re-enable events at the end also."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1478103245, "post_id": 40383995, "comment_id": 68021299, "body": "How will you determine which rows need to be updated?  Can you provide the logic?"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1478108318, "post_id": 40383995, "comment_id": 68024390, "body": "The <code>Target.Row</code> is the row of the cell whose value has changed, triggering the <code>_Change</code> event handler. You can use <i>any</i> other value (e.g., <code>Target.Row+1</code> will put it in the row beneath <code>Target</code>, or use the <code>Target.Offset(1)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478109445, "post_id": 40386156, "comment_id": 68025050, "body": "just to throw in that <code>Cells(Target.Row, Target.Column).Offset(rowOffset:=3, columnOffset:=0)</code> can be simplified to <code>Target.Offset(3)</code>"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6200045"}, "is_accepted": false, "score": 0, "last_activity_date": 1478107755, "creation_date": 1478107755, "answer_id": 40386156, "question_id": 40383995, "link": "https://stackoverflow.com/questions/40383995/worksheet-change-cant-target-different-row/40386156#40386156", "title": "Worksheet Change - can&#39;t target different row", "body": "<p>You could use Offset</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\nCells(Target.Row, Target.Column).Offset(rowOffset:=3, columnOffset:=0) _\n.Value = \"I'm beneath you  :-o\"\nColumns(Target.Column).AutoFit\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 7105428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08aded239546dba5449986282fdfbea6?s=128&d=identicon&r=PG&f=1", "display_name": "Cal", "link": "https://stackoverflow.com/users/7105428/cal"}, "edited": false, "score": 0, "creation_date": 1478176265, "post_id": 40386810, "comment_id": 68052988, "body": "Please ignore that comment - I have worked it out. Thank you for all your suggestions - the functionality I can get is from @DavidZemens"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1478109892, "creation_date": 1478109892, "answer_id": 40386810, "question_id": 40383995, "link": "https://stackoverflow.com/questions/40383995/worksheet-change-cant-target-different-row/40386810#40386810", "title": "Worksheet Change - can&#39;t target different row", "body": "<p>summing up the suggestions you already received with comments and throwing in some new points, you could consider this code: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"I6:I7\")) Is Nothing Then\n        Application.EnableEvents = False '&lt;-- best practice: avoid subsequent possible worksheet changes trigger this event again and again in an infinite loop\n        On Error GoTo ExitSub '&lt;--best practice: be sure to get and enable events should any error cause the end of this sub\n\n        Select Case Cells(Target.Row, 9).Value\n            Case \"Manual\"\n                Target.Offset(, 1).Resize(, 2) = \"N/A\"\n            Case \"Depalletiser\", \"Robot\"\n                Target.Offset(, 1).Resize(, 2).ClearContents\n        End Select\n    End If\n\nExitSub:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7105428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08aded239546dba5449986282fdfbea6?s=128&d=identicon&r=PG&f=1", "display_name": "Cal", "link": "https://stackoverflow.com/users/7105428/cal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 571, "favorite_count": 0, "accepted_answer_id": 40386810, "answer_count": 2, "score": 0, "last_activity_date": 1478109892, "creation_date": 1478101141, "last_edit_date": 1531164843, "question_id": 40383995, "link": "https://stackoverflow.com/questions/40383995/worksheet-change-cant-target-different-row", "title": "Worksheet Change - can&#39;t target different row", "body": "<p>I have just started using VBA and have learned how to change columns using change event handlers - but I can't get it to work when I need to change rows as well. Based on a response in one cell i.e \"Yes\" or \"No\" - I want to populate other cells with \"N/A\" or blank. </p>\n\n<p>I have got this to work for one row but I now need to put \"N/A\" on other rows as well. Could someone please help. My code below: </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  If Not Intersect(Target, Range(\"I6:I7\")) Is Nothing Then\n    If Cells(Target.Row, 9) = \"Manual\" Then\n      Cells(Target.Row, 10) = \"N/A\"\n      Cells(Target.Row, 11) = \"N/A\"\n      '**Cells(8, 11) = \"N/A\"**\n    ElseIf Cells(Target.Row, 9) = \"Depalletiser\" Then\n      Cells(Target.Row, 10) = \"\"\n      Cells(Target.Row, 11) = \"\"\n    ElseIf Cells(Target.Row, 9) = \"Robot\" Then\n      Cells(Target.Row, 10) = \"\"\n      Cells(Target.Row, 11) = \"\"\n    End If\n  End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "excel", "vba"], "comments": [{"owner": {"reputation": 2669, "user_id": 6144259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/999de3cfb3d5fc0b10b7d6a85957eb32?s=128&d=identicon&r=PG&f=1", "display_name": "A Friend", "link": "https://stackoverflow.com/users/6144259/a-friend"}, "edited": false, "score": 0, "creation_date": 1478102072, "post_id": 40383973, "comment_id": 68020547, "body": "The <code>Next x</code> is inside the <code>If</code> statement so it doesn&#39;t match up. You need to move it outside"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7075507"}, "is_accepted": false, "score": 0, "last_activity_date": 1478176642, "creation_date": 1478176642, "answer_id": 40401698, "question_id": 40383973, "link": "https://stackoverflow.com/questions/40383973/excel-vb-searching-for-text-on-a-webpage-and-copying-information-in-the-same-ele/40401698#40401698", "title": "Excel VB Searching for text on a webpage and Copying information in the same Element", "body": "<p>I think you want to grab the 'inner text'.  Take a look at the example below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/jACuz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jACuz.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub Scraper()\n\n   Dim item As Long\n   Dim priceStr As String\n   Dim priceTag As Object\n   Dim priceTable As Object\n\n\n   item = \"10011\" 'this will eventually be placed in a loop for multiple searches\n\n   Set objIE = CreateObject(\"InternetExplorer.Application\")\n   objIE.Visible = True\n   ' navigate and download the web page\n   objIE.Navigate \"www.google.com\"\n   Do While objIE.ReadyState &lt;&gt; 4 Or objIE.Busy\n     DoEvents\n   Loop\n\n  'objIE.Document.getElementsByTagName(\"input\")(0).Value = item\n  'objIE.Document.getElementByID(\"FDI\").Click\n\n  Set priceTable = objIE.Document.getElementByID(\"price_FGC\")\n  Set priceTag = priceTable.getElementsByTagName(\"u\")(3)\n  priceStr = priceTag.innerText\n\n  Sheet1.Range(\"A1\").Value = priceStr\n\n  objIE.Quit\n\n\n  End Sub\n</code></pre>\n\n<p>Also, check out this link for several other ways of how to do other, similar things.</p>\n\n<p><a href=\"http://www.tushar-mehta.com/publish_train/xl_vba_cases/vba_web_pages_services/index.htm\" rel=\"nofollow noreferrer\">http://www.tushar-mehta.com/publish_train/xl_vba_cases/vba_web_pages_services/index.htm</a></p>\n"}], "owner": {"reputation": 23, "user_id": 7105066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6570c42cc5fcdc654608ce602ddbf5e0?s=128&d=identicon&r=PG&f=1", "display_name": "StratusX", "link": "https://stackoverflow.com/users/7105066/stratusx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 30, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1478176642, "creation_date": 1478101074, "last_edit_date": 1531161705, "question_id": 40383973, "link": "https://stackoverflow.com/questions/40383973/excel-vb-searching-for-text-on-a-webpage-and-copying-information-in-the-same-ele", "title": "Excel VB Searching for text on a webpage and Copying information in the same Element", "body": "<p>I am relatively new VBA.</p>\n\n<p>I am trying to use this code to grab a bit of information from a website. When I do it by Element I have to search for the tag name which is <code>tr</code> and use a number next to it to define which one I want to use. The problem with that is it changes frequently with the position on the website. Currently the Keyword I want to search for and the information it contains is like so: </p>\n\n<pre><code>&lt;tr&gt;\n  &lt;td class=\"nt\"&gt;Operations&lt;/td&gt;\n  &lt;td&gt;Windows&lt;/td&gt;\n&lt;/tr&gt;\n</code></pre>\n\n<p>So if I can search by the class \"Operations\", and get the information \"Windows\", that would help. Also, I currently having an error</p>\n\n<blockquote>\n  <p>Next without For</p>\n</blockquote>\n\n<p>If possible, is there a way I can use this to do multiple searches before I close the page? So I look for multiple specific words and input that data into different cells before moving onto the next column where it would repeat until completed at the end of the x value. I currently only have it set to x=2 To 5 but I would like to increase that to 10 or higher in the future.</p>\n\n<p>The current code looks like this.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n  For x = 2 To 5\n    If Target.Row = Cells(x, 35).Row And _\n    Target.Column = Cells(x, 35).Column Then\n    'If Target.Row = Range(\"ManufacturerPartNumber\").Row And _\n    'Target.Column = Range(\"ManufacturerPartNumber\").Column Then\n        Dim IE As New InternetExplorer\n        'IE.Visible = True\n        'For x = 2 To 5\n        'IE.navigate \"\" &amp; Range(\"Website_1\").Value\n        IE.navigate \"\" &amp; Cells(x, 35).Value\n        Do\n            DoEvents\n        Loop Until IE.readyState = READYSTATE_COMPLETE\n        Dim Doc As HTMLDocument\n        Set Doc = IE.document\n        Dim sDD As String\n        sDD = InStr(1, IE.document.body.innerHTML, \"Processor Model\")\n        'sDD = Trim(Doc.getElementsByTagName(\"Processor Model\")(1).innerText) 'Use this with tag like dd and number for which it appears like 0 or 1\n        IE.Quit\n        Dim aDD As Variant\n        aDD = Split(sDD, \",\")\n        Cells(x, 44).Value = aDD(0)\n        'Range(\"ProcessorNumberCd\").Value = aDD(0)\n        'Range(\"OSProvided\").Value = aDD(0)\n    Next x\n\n    End If\n\n  'MsgBox \"Complete\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 1, "creation_date": 1478100608, "post_id": 40383707, "comment_id": 68019435, "body": "It would be better to post the code you have, as a start."}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "edited": false, "score": 0, "creation_date": 1478100685, "post_id": 40383707, "comment_id": 68019500, "body": "Plus some examples showing what you want."}, {"owner": {"reputation": 389, "user_id": 4966349, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/s0s6q.png?s=128&g=1", "display_name": "Nonagon", "link": "https://stackoverflow.com/users/4966349/nonagon"}, "edited": false, "score": 0, "creation_date": 1478101124, "post_id": 40383707, "comment_id": 68019839, "body": "Updated accordingly"}, {"owner": {"reputation": 389, "user_id": 4966349, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/s0s6q.png?s=128&g=1", "display_name": "Nonagon", "link": "https://stackoverflow.com/users/4966349/nonagon"}, "edited": false, "score": 0, "creation_date": 1478104247, "post_id": 40383707, "comment_id": 68021920, "body": "Updated the question with something i am trying to do"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1478101289, "post_id": 40384007, "comment_id": 68019959, "body": "Careful - it would be <code>Sheets(&quot;Sheet1&quot;).Cells(1, Sheets(&quot;Sheet1&quot;).Columns.Count).End(xlToLeft).Column</code> (the <code>Columns.Count</code> needs the sheet ref. too)"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1478101879, "post_id": 40384007, "comment_id": 68020392, "body": "As long as <code>Sheets(&quot;Sheet1&quot;)</code> is the active sheet, it should work.  However, change sheets and then run, it should throw an error.  Without the explicit sheet reference when using range objects (<code>Range()</code>, <code>Cells()</code>, <code>Columns()</code>, <code>Rows()</code>, etc.), it&#39;s best to include the sheet explicitly, otherwise it&#39;s going to use the active sheet."}, {"owner": {"reputation": 389, "user_id": 4966349, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/s0s6q.png?s=128&g=1", "display_name": "Nonagon", "link": "https://stackoverflow.com/users/4966349/nonagon"}, "edited": false, "score": 0, "creation_date": 1478102486, "post_id": 40384007, "comment_id": 68020850, "body": "The organizing of data aspect seems like a good idea, maybe if i can organise the columns to specific columns , i.e paste the Newdata to colum AE i could then set my range to A1:A500 and paste to sheet2"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1478103157, "post_id": 40384007, "comment_id": 68021258, "body": "@BruceWayne it will only through an error if the activesheet has less columns than sheet1.  Otherwise it will work.  <b><i>It is still good practice to ensure no conflicts.</i></b>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1478103390, "post_id": 40384007, "comment_id": 68021383, "body": "@ScottCraner - Ah, thanks for clarifying that for me!"}], "tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": false, "score": 0, "last_activity_date": 1478101348, "last_edit_date": 1478101348, "creation_date": 1478101217, "answer_id": 40384007, "question_id": 40383707, "link": "https://stackoverflow.com/questions/40383707/looping-through-a-column-if-it-has-a-certain-name/40384007#40384007", "title": "Looping through a Column if it has a certain name", "body": "<p>You can start by firstly storing the number of columns in the current dataset, then work with that, thats just a start however:</p>\n\n<pre><code>Dim n As Long\n\nn = Sheets(\"Sheet1\").Cells(1, Columns.Count).End(xlToLeft).Column\n</code></pre>\n\n<p>Additionally, why dont you just do a copy paste of the dynamic ranged dataset everytime?</p>\n"}], "owner": {"reputation": 389, "user_id": 4966349, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/s0s6q.png?s=128&g=1", "display_name": "Nonagon", "link": "https://stackoverflow.com/users/4966349/nonagon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478104229, "creation_date": 1478100257, "last_edit_date": 1478104229, "question_id": 40383707, "link": "https://stackoverflow.com/questions/40383707/looping-through-a-column-if-it-has-a-certain-name", "title": "Looping through a Column if it has a certain name", "body": "<p>I have an Excel file, there is a macro that copies all the data from Sheet1 and pastes it to Sheet2 in a certain order.</p>\n\n<p>Problem: Sometimes the file will be updated with additional Columns so it will need to paste that data into a certain column from sheet 1 into sheet 2, and example will be If Sheet1 has a value of NewData1, copy all the data in that column and paste it to sheet 2. This has to be copied by Name and not the position in sheet 1</p>\n\n<p>I have used Cells.Find to find the name of the Column, now all i need is to copy the values in that entire column and paste it into the new sheet</p>\n\n<p><strong>UPDATED CODE BELOW</strong></p>\n\n<pre><code>Set res = Worksheets(\"Sheet1\").Cells.Find(What:=\"NewData1\")\nIf Not res Is Nothing Then\n\nSheets(\"Sheet1\").Select\nRange(Cells(2, res), Cells(50, res)) 'SOMETHING LIKE THIS\nSelection.Copy\nSheets(\"Sheet2\").Select\nSheets(\"Sheet2\").Cells(3, 9).Select\nActiveSheet.Paste\nEnd If\n</code></pre>\n\n<p><strong>UPDATE EXPECTATIONS</strong></p>\n\n<pre><code>ColA    ColB       ColC\nHello   Goodbye    How are you\nHi      Bye        Are you well\nHey     Seeya      You ok\n</code></pre>\n\n<p>If NewData1 is added to this and it looks like this:</p>\n\n<pre><code>ColA    ColB       ColC           NewData1\nHello   Goodbye    How are you    Im new\nHi      Bye        Are you well   So am i\nHey     Seeya      You ok         Me Too\n</code></pre>\n\n<p>I need to copy that data and paste it to the other sheet, the problem is it may not be the 4th column of the sheet, it may be 5th 6th or 7th. This is why i am looking to copy by Cell Value</p>\n\n<p><strong>UPDATE 2</strong>\nRe edited the code, is there something similar to this that could be done?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1478101006, "post_id": 40383696, "comment_id": 68019758, "body": "(What version of Excel are you in? If it&#39;s 2016, you can use <code>=TextJoin()</code>.)"}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1478101007, "post_id": 40383696, "comment_id": 68019760, "body": "Is it expected to have 2 entries on the same line? Will there be more than 2? Are the number of fields for each entry set? If so using VBA you would just have to split by &quot; | &quot; (space, pipe, space) into an array. Iterate through it, test for empty strings, format string and spit out."}, {"owner": {"reputation": 13, "user_id": 7105349, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JASf1TV5IgI/AAAAAAAAAAI/AAAAAAAAAD4/96LdIAkwMUk/photo.jpg?sz=128", "display_name": "user7105349", "link": "https://stackoverflow.com/users/7105349/user7105349"}, "edited": false, "score": 0, "creation_date": 1478101841, "post_id": 40383696, "comment_id": 68020371, "body": "Thanks - i edited my initial question, but there is a rare case where there would be three composers listed."}, {"owner": {"reputation": 13, "user_id": 7105349, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JASf1TV5IgI/AAAAAAAAAAI/AAAAAAAAAD4/96LdIAkwMUk/photo.jpg?sz=128", "display_name": "user7105349", "link": "https://stackoverflow.com/users/7105349/user7105349"}, "edited": false, "score": 0, "creation_date": 1478101907, "post_id": 40383696, "comment_id": 68020412, "body": "Thanks Bruce, I will investigate Text Join."}, {"owner": {"reputation": 13, "user_id": 7105349, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JASf1TV5IgI/AAAAAAAAAAI/AAAAAAAAAD4/96LdIAkwMUk/photo.jpg?sz=128", "display_name": "user7105349", "link": "https://stackoverflow.com/users/7105349/user7105349"}, "edited": false, "score": 0, "creation_date": 1478102439, "post_id": 40383696, "comment_id": 68020814, "body": "It doesn&#39;t seem like Text Join works on my Mac edition. I tried it and it gives me a NAME error. I looked for the formula function and I only have TEXT as an option."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7105349, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JASf1TV5IgI/AAAAAAAAAAI/AAAAAAAAAD4/96LdIAkwMUk/photo.jpg?sz=128", "display_name": "user7105349", "link": "https://stackoverflow.com/users/7105349/user7105349"}, "edited": false, "score": 0, "creation_date": 1478105597, "post_id": 40383981, "comment_id": 68022714, "body": "Thank - It is a huge, long formula, but I got it to work!!"}, {"owner": {"reputation": 13, "user_id": 7105349, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JASf1TV5IgI/AAAAAAAAAAI/AAAAAAAAAD4/96LdIAkwMUk/photo.jpg?sz=128", "display_name": "user7105349", "link": "https://stackoverflow.com/users/7105349/user7105349"}, "edited": false, "score": 0, "creation_date": 1478116585, "post_id": 40383981, "comment_id": 68029016, "body": "Thanks - It isn&#39;t too long from what I can tell - seems to be working perfectly."}], "tags": [], "owner": {"reputation": 74, "user_id": 5429423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqCKe.jpg?s=128&g=1", "display_name": "Fixer", "link": "https://stackoverflow.com/users/5429423/fixer"}, "is_accepted": true, "score": 1, "last_activity_date": 1493907169, "last_edit_date": 1493907169, "creation_date": 1478101096, "answer_id": 40383981, "question_id": 40383696, "link": "https://stackoverflow.com/questions/40383696/excel-concatenate-cells-while-adding-characters-and-skipping-empty-cells/40383981#40383981", "title": "Excel Concatenate Cells while adding characters and skipping Empty cells", "body": "<p>For the extra spaces, use substitute to get rid of empties.</p>\n\n<p>So, if your code is <code>=concatenate(A1,B1,C1)</code> and your 'empty spaces' are \"| \" then edit your formula to become <code>=substitute(concatenate(A1,B1,C1),\"| \",\"\")</code></p>\n\n<p>You can even stack the substitutes to add more possible 'empties', like \"  \" (two spaces) or the like. <code>=substitute(substitute(concatenate(A1,B1,C1),\"| \",\"\"),\"  \",\"\")</code></p>\n"}], "owner": {"reputation": 13, "user_id": 7105349, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-JASf1TV5IgI/AAAAAAAAAAI/AAAAAAAAAD4/96LdIAkwMUk/photo.jpg?sz=128", "display_name": "user7105349", "link": "https://stackoverflow.com/users/7105349/user7105349"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 40383981, "answer_count": 1, "score": 0, "last_activity_date": 1493907169, "creation_date": 1478100239, "last_edit_date": 1478101782, "question_id": 40383696, "link": "https://stackoverflow.com/questions/40383696/excel-concatenate-cells-while-adding-characters-and-skipping-empty-cells", "title": "Excel Concatenate Cells while adding characters and skipping Empty cells", "body": "<p>I am not a programmer, but doing Excel work for a small library. We have these fields in an excel sheet:</p>\n\n<pre><code>John  | J   | Smith | BMI   | 123 | 100 |\nSarah |  P  | Crown | ASCAP | 564 | 100 |\nTommy |  T  | Stew  | BMI   | 134 | 100 |\nSuzy  | S   | Smith | BMI   | 678 | 50  | \nJohn  | J   | Smith | BMI   | 123 | 50\n</code></pre>\n\n<p>What I would like to be able to combine any of the cells (in the same row)into one cell that would read like this:</p>\n\n<pre><code>John J Smith, (BMI), 100%, IPI 123  \n</code></pre>\n\n<p>or</p>\n\n<pre><code>Suzy S Smith, (BMI), 50%, IPI 678  | John J Smith (BMI), 50% IPI 123\n</code></pre>\n\n<p>I figured out how to use the Concatenate function to do this, but it doesn't skip empty cells, and I get extra \"|\" or \"()\" in those spots. I also found the =StringConCat topic, and that works great for skipping, but I can't figure out how to add the extra characters. </p>\n\n<p>Any help would be most appreciated.\nThank you!!</p>\n\n<p>EDIT: Thanks for the quick responses so far. I should be more clear - </p>\n\n<ul>\n<li><p>the pipes in my example were only to designate different cells - they are not actual characters in the cells (thanks for converting it to a table for me, Bruce). The only Pipe character I would like to use is in the results, as in my example between Suzy and John. </p></li>\n<li><p>There will rarely be more than 2 entries on the same result line, but it is possible. Mostly it will be to composers that are sharing the credit. But there is a chance that they will work on a Public Domain song and I have to list \"Traditional\" or maybe \"Mozart\" as another composer.</p></li>\n</ul>\n\n<p>Sorry that I don't know enough to ask my question as intelligently as I should. Just learning how to do this, and trying to figure it out as I go.</p>\n\n<p>Thanks again!</p>\n"}, {"tags": ["excel", "powerquery", "vba"], "comments": [{"owner": {"reputation": 3484, "user_id": 3851129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd86d2fd71d5f3554f387797b7db37b6?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Lopez-Lago - MSFT", "link": "https://stackoverflow.com/users/3851129/alejandro-lopez-lago-msft"}, "edited": false, "score": 0, "creation_date": 1478111376, "post_id": 40383466, "comment_id": 68026217, "body": "Where do you want user input to come from?"}, {"owner": {"reputation": 335, "user_id": 5062559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/43e2535afaedc5cd9f87f43644514ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/5062559/maddy"}, "reply_to_user": {"reputation": 3484, "user_id": 3851129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd86d2fd71d5f3554f387797b7db37b6?s=128&d=identicon&r=PG&f=1", "display_name": "Alejandro Lopez-Lago - MSFT", "link": "https://stackoverflow.com/users/3851129/alejandro-lopez-lago-msft"}, "edited": false, "score": 0, "creation_date": 1478170922, "post_id": 40383466, "comment_id": 68049577, "body": "@AlejandroLopez-Lago-MSFT : modified the question"}], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 5062559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/43e2535afaedc5cd9f87f43644514ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/5062559/maddy"}, "edited": false, "score": 0, "creation_date": 1478448248, "post_id": 40408276, "comment_id": 68148083, "body": "Thanks for the solution, Its working with my local datasets, but when I&#39;m using SSAS cube data in power query, it shows empty rows. I used (Cube.AttributeMemberId([Dashboard_all.Country]) = &quot;[Dashboard_all].[Country].&amp;[UserInput]&quot; meta [DisplayName = &quot;UserInput&quot;])) in"}, {"owner": {"reputation": 4551, "user_id": 771768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSzIS.jpg?s=128&g=1", "display_name": "Carl Walsh", "link": "https://stackoverflow.com/users/771768/carl-walsh"}, "reply_to_user": {"reputation": 335, "user_id": 5062559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/43e2535afaedc5cd9f87f43644514ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/5062559/maddy"}, "edited": false, "score": 0, "creation_date": 1478449079, "post_id": 40408276, "comment_id": 68148413, "body": "@Maddy great you got it working. For SSAS query, make sure you&#39;re using <code>UserInput</code> as a variable, and not <code>&quot;UserInput&quot;</code> as a string."}, {"owner": {"reputation": 335, "user_id": 5062559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/43e2535afaedc5cd9f87f43644514ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/5062559/maddy"}, "edited": false, "score": 0, "creation_date": 1478512890, "post_id": 40408276, "comment_id": 68169468, "body": "I tried both ways, but it doesn&#39;t work, table shows empty .......................... Cube.AttributeMemberId([Dashboard_all.Country]) = &quot;[Dashboard_all].[Country].&amp;[UserInput]&quot; meta [DisplayName = UserInput]))"}, {"owner": {"reputation": 4551, "user_id": 771768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSzIS.jpg?s=128&g=1", "display_name": "Carl Walsh", "link": "https://stackoverflow.com/users/771768/carl-walsh"}, "reply_to_user": {"reputation": 335, "user_id": 5062559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/43e2535afaedc5cd9f87f43644514ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/5062559/maddy"}, "edited": false, "score": 0, "creation_date": 1478530226, "post_id": 40408276, "comment_id": 68180171, "body": "The code <code>&quot;[Dashboard_all].[Country].&amp;[UserInput]&quot;</code> looks wrong. Why don&#39;t you ask a new stack overflow question showing the working ssas query, what you tried, and what you got!"}], "tags": [], "owner": {"reputation": 4551, "user_id": 771768, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SSzIS.jpg?s=128&g=1", "display_name": "Carl Walsh", "link": "https://stackoverflow.com/users/771768/carl-walsh"}, "is_accepted": false, "score": 1, "last_activity_date": 1478195883, "last_edit_date": 1495541321, "creation_date": 1478195883, "answer_id": 40408276, "question_id": 40383466, "link": "https://stackoverflow.com/questions/40383466/how-to-control-variable-filters-automatically-in-power-query/40408276#40408276", "title": "How to control variable filters automatically in Power query?", "body": "<p>Try putting <code>22</code> in a workbook cell (maybe on another sheet) and choosing from table. Basically, do what this did: <a href=\"https://stackoverflow.com/questions/35533984/power-query-power-pivot-empty-table-and-clearing-pivot\">Power query &amp; power pivot - empty table and clearing pivot</a></p>\n\n<p>You'll want your query to have a line something like:</p>\n\n<pre><code>UserInput = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content][country]{0},\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1101, "user_id": 6560720, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/0a77146708fe3396808040a04ad3a487?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene", "link": "https://stackoverflow.com/users/6560720/eugene"}, "is_accepted": false, "score": 0, "last_activity_date": 1480800866, "last_edit_date": 1480800866, "creation_date": 1480716034, "answer_id": 40941503, "question_id": 40383466, "link": "https://stackoverflow.com/questions/40383466/how-to-control-variable-filters-automatically-in-power-query/40941503#40941503", "title": "How to control variable filters automatically in Power query?", "body": "<p>You should create names for your cells containing Country and Type parameters.\nLet say, cell B1 is country, and B2 is type. Go to Formulas/Name Manager and assign them respective names.</p>\n\n<p>Then (assuming your data table is named Table1) you can use following PowerQuery:</p>\n\n<pre><code>let\n    Country = Excel.CurrentWorkbook(){[Name=\"Country\"]}[Content][Column1]{0}?,\n    Type = Excel.CurrentWorkbook(){[Name=\"type\"]}[Content][Column1]{0}?,\n    Table = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content],\n    Filter = Table.SelectRows(Table, each [country] = Country and [type] = Type)\nin\n    Filter\n</code></pre>\n\n<p>Also pay attention to names, they are case-sensitive.</p>\n"}], "owner": {"reputation": 335, "user_id": 5062559, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/43e2535afaedc5cd9f87f43644514ab4?s=128&d=identicon&r=PG&f=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/5062559/maddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1480800866, "creation_date": 1478099631, "last_edit_date": 1531161705, "question_id": 40383466, "link": "https://stackoverflow.com/questions/40383466/how-to-control-variable-filters-automatically-in-power-query", "title": "How to control variable filters automatically in Power query?", "body": "<p>Is there a way to control the filters in selecting values in queries based on the values given</p>\n\n<p>lets say,\nI have the following power query, data looks like the following</p>\n\n<pre><code>     country          type       value1     value2....\n    ----------------------------------------------------------------------\n     USA              a1         22         12\n     Uk               a2         21         10\n</code></pre>\n\n<p>Now in power query, I manually filter these values to make  like country=\"USA\", type=\"a1\" to get the pivot tables.</p>\n\n<p>How to filter the values automatically using the user inputs in power query?</p>\n\n<p>User inputs:</p>\n\n<pre><code>        country: [textbox] or workbook cell\n        type   : [textbox] or workbook cell\n</code></pre>\n\n<p>Anly help is appreciated, thanks!</p>\n\n<p>PS: My working query looks like the following, </p>\n\n<pre><code>let\n   Source = Csv.Document(File.Contents(\"C:\\Users\\axlptl\\Desktop\\abc.csv\"),[Delimiter=\",\", Columns=4, Encoding=1252, QuoteStyle=QuoteStyle.None]),\n   UserInput = Excel.CurrentWorkbook(){[Name=\"Table1\"]}[Content][country]{0},\n   #\"Promoted Headers\" = Table.PromoteHeaders(Source),\n   #\"Changed Type\" = Table.TransformColumnTypes(#\"Promoted Headers\",{{\"country\", type text}, {\"type\", type text}, {\"value1\", Int64.Type}, {\"value2\", Int64.Type}}),\n   #\"Filtered Rows\" = Table.SelectRows(#\"Changed Type\", each ([type] = UserInput))\n\n\nin\n   #\"Filtered Rows\"\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478099243, "post_id": 40383288, "comment_id": 68018410, "body": "Has PDF Viewer been created on the other machine?  Check something else from its properties."}, {"owner": {"reputation": 181, "user_id": 4383965, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/779509cf6b9ea0864f7db1caec4405b8?s=128&d=identicon&r=PG&f=1", "display_name": "NoobProgrammer", "link": "https://stackoverflow.com/users/4383965/noobprogrammer"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478099882, "post_id": 40383288, "comment_id": 68018915, "body": "both computers have the same pdf reader 11 and everything. I just put the excel file on a usb and transferred it to the other computer and tried running it and I get that error message."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478099940, "post_id": 40383288, "comment_id": 68018959, "body": "Is the control present as desired in design mode of the form? and is the file available to both"}, {"owner": {"reputation": 181, "user_id": 4383965, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/779509cf6b9ea0864f7db1caec4405b8?s=128&d=identicon&r=PG&f=1", "display_name": "NoobProgrammer", "link": "https://stackoverflow.com/users/4383965/noobprogrammer"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478100784, "post_id": 40383288, "comment_id": 68019579, "body": "yes, the form and the other controls are all fine. the file location and file is available for both computers. I was doing some research and I saw that google chrome could affect this activeX additional PDF viewer control. Not sure if this is the problem but the first computer I have does not have chrome while the second computer does."}], "owner": {"reputation": 181, "user_id": 4383965, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/779509cf6b9ea0864f7db1caec4405b8?s=128&d=identicon&r=PG&f=1", "display_name": "NoobProgrammer", "link": "https://stackoverflow.com/users/4383965/noobprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 725, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478099796, "creation_date": 1478099122, "last_edit_date": 1478099796, "question_id": 40383288, "link": "https://stackoverflow.com/questions/40383288/excel-vba-with-pdf-viewer", "title": "Excel VBA With PDF Viewer", "body": "<p>I currently have a form that has the \"Adobe PDF Reader\" additional controls on it, a button and a text box.</p>\n\n<p>The only code I have is on the button that is:</p>\n\n<pre><code>PDFViewer.src = textbox1.text\n</code></pre>\n\n<p>This excel file and macro works on my computer but when someone else tries to open the macro they get the following error message:</p>\n\n<blockquote>\n  <p>\"System error &amp;H80004005 (-2147467259). unspecified error\"</p>\n</blockquote>\n\n<p>I don't know why I am getting this error when it works fine on my computer.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "macros"], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 6777799, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/98e5f71034bc3742519ec24afd87cc87?s=128&d=identicon&r=PG&f=1", "display_name": "darrenvba", "link": "https://stackoverflow.com/users/6777799/darrenvba"}, "edited": false, "score": 0, "creation_date": 1478099663, "post_id": 40383401, "comment_id": 68018737, "body": "Works perfectly! Thanks"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1478107689, "post_id": 40383401, "comment_id": 68024011, "body": "@ShaiRado Your code will remove <b>ALL</b> of the <code>bk</code>&#39;s in the string and not just the one at the end."}], "tags": [], "owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "is_accepted": false, "score": 3, "last_activity_date": 1478110432, "last_edit_date": 1478110432, "creation_date": 1478099453, "answer_id": 40383401, "question_id": 40383187, "link": "https://stackoverflow.com/questions/40383187/vba-case-insentitive-if-cell-string/40383401#40383401", "title": "VBA: case insentitive, if cell = string", "body": "<p>Yes, since you want to replace all sorts of \"bk\" at the end of the string, you can use <code>UCase</code>, like in the code below:</p>\n\n<pre><code>If UCase(Right(Cells(i, 1), 2)) = \"BK\" Then\n    Cells(i, 1) = Replace(Cells(i, 1), \"bk\", \"\", 1, -1, vbTextCompare)\nEnd If\n</code></pre>\n\n<p><strong>Note</strong>: adding the last parameter of <code>vbTextCompare</code> to the <code>Replace</code> function indicates that it's case-insensitive, and will remove all sorts of \"bk\".</p>\n\n<p><strong>Edit 1</strong>:\nIn case you have multiple occurrences of \"bk\" in a certain string, and you only want to remove the one at the end of the string, use the code below (thanks to @Ron Rosenfeld):</p>\n\n<pre><code>If UCase(Right(Cells(i, 1), 2)) = \"BK\" Then\n    Cells(i, 1) = Left(Cells(i, 1), Len(Cells(i, 1)) - 2)\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 0, "last_activity_date": 1478140630, "last_edit_date": 1478140630, "creation_date": 1478107915, "answer_id": 40386207, "question_id": 40383187, "link": "https://stackoverflow.com/questions/40383187/vba-case-insentitive-if-cell-string/40386207#40386207", "title": "VBA: case insentitive, if cell = string", "body": "<p>To remove only the last two characters, I suggest:</p>\n\n<pre><code>If UCase(R) Like \"*bk\" Then R = Left(R, Len(R) - 2)\n</code></pre>\n\n<p>where R is a range object (or text string)</p>\n"}], "owner": {"reputation": 191, "user_id": 6777799, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/98e5f71034bc3742519ec24afd87cc87?s=128&d=identicon&r=PG&f=1", "display_name": "darrenvba", "link": "https://stackoverflow.com/users/6777799/darrenvba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 40386207, "answer_count": 2, "score": 0, "last_activity_date": 1478140630, "creation_date": 1478098853, "question_id": 40383187, "link": "https://stackoverflow.com/questions/40383187/vba-case-insentitive-if-cell-string", "title": "VBA: case insentitive, if cell = string", "body": "<p>In this example, I'm wanting to remove the end of a string if it contains either bk, BK, Bk or bK. Is there a simple way to make this case insentitive? Thanks</p>\n\n<pre><code>If Right(Cells(i, 1), 2) = \"bk\" Then\n    Cells(i, 1) = Replace(Cells(i, 1), \"bk\", \"\")\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 6777799, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/98e5f71034bc3742519ec24afd87cc87?s=128&d=identicon&r=PG&f=1", "display_name": "darrenvba", "link": "https://stackoverflow.com/users/6777799/darrenvba"}, "is_accepted": true, "score": 1, "last_activity_date": 1478099160, "creation_date": 1478099160, "answer_id": 40383296, "question_id": 40383183, "link": "https://stackoverflow.com/questions/40383183/ignore-cells-where-text-is-empty-regardless-of-formula/40383296#40383296", "title": "Ignore cells where text is empty regardless of formula", "body": "<p>Try If w.Cells(a, \"h\").value &lt;> \"\"</p>\n"}], "owner": {"reputation": 47, "user_id": 7105273, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3f19c605c4836f42b8fef74efa155e36?s=128&d=identicon&r=PG&f=1", "display_name": "dsdavidson", "link": "https://stackoverflow.com/users/7105273/dsdavidson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 580, "favorite_count": 0, "accepted_answer_id": 40383296, "answer_count": 1, "score": 0, "last_activity_date": 1478099160, "creation_date": 1478098834, "question_id": 40383183, "link": "https://stackoverflow.com/questions/40383183/ignore-cells-where-text-is-empty-regardless-of-formula", "title": "Ignore cells where text is empty regardless of formula", "body": "<p>I am trying to write a snippet of code to run through multiple worksheets and, if the value in column \"h\" is not empty, copy each sheet row-by-row to a master summary sheet. My problem is that every cell in column \"h\" contains a CONCATENATE formula, but of course if the rest of the row is empty then the CONCATENATE returns an empty or 0 value. For some reason the following code is failing to ignore these rows. (Note: w is the object representing the current worksheet, and dest is the object representing the destination worksheet where rows will be copied to.)</p>\n\n<pre><code>Last = w.Cells(Rows.Count, \"h\").End(xlUp).Row\nFor a = 2 To Last Step 1\n    If w.Cells(a, \"h\").Text &lt;&gt; \"\" Or w.Cells(a, \"h\").Text &lt;&gt; \"0\" Then\n    d = dest.Cells(Rows.Count, \"h\").End(xlUp).Row + 1\n    w.Cells(a, \"h\").EntireRow.Copy dest.Cells(d, 1)\n    End If\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 0, "creation_date": 1478103932, "post_id": 40383026, "comment_id": 68021722, "body": "Read up on the <a href=\"https://msdn.microsoft.com/en-us/library/aa711216%28v=vs.71%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">FileSystemObject</a>.  This handy little class exposes the functionality you are looking for."}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1478165274, "post_id": 40383026, "comment_id": 68045875, "body": "<a href=\"http://stackoverflow.com/a/10382861/1383168\">stackoverflow.com/a/10382861/1383168</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 7076724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53116d32b87aef382a314cf73572e7b?s=128&d=identicon&r=PG&f=1", "display_name": "John Kibbits", "link": "https://stackoverflow.com/users/7076724/john-kibbits"}, "edited": false, "score": 0, "creation_date": 1478100855, "post_id": 40383710, "comment_id": 68019625, "body": "I&#39;m so lost as to where to even insert that because everytime I run the code I automatically get an error message stating method or data member cannot be found. I need it in a for each next loop and I&#39;m having a ton of difficulty."}], "tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": false, "score": 0, "last_activity_date": 1478100270, "creation_date": 1478100270, "answer_id": 40383710, "question_id": 40383026, "link": "https://stackoverflow.com/questions/40383026/opening-multiple-documents-via-for-each-structure-vba/40383710#40383710", "title": "Opening multiple documents via &#39;For Each&#39; structure. VBA", "body": "<p>Try this as a starter for 10, it will open the file and display the file path in a message box, will get back to you with further simplification...</p>\n\n<pre><code>Dim StrFile As String\n\nStrFile = Application.GetOpenFilename\nWorkbooks.Open (StrFile), UpdateLinks:=False\nMsgBox StrFile\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 7076724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53116d32b87aef382a314cf73572e7b?s=128&d=identicon&r=PG&f=1", "display_name": "John Kibbits", "link": "https://stackoverflow.com/users/7076724/john-kibbits"}, "edited": false, "score": 0, "creation_date": 1478105940, "post_id": 40385100, "comment_id": 68022954, "body": "Thank you for this but I&#39;m getting a error message that states &#39;user defined type not defined&#39;"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "reply_to_user": {"reputation": 11, "user_id": 7076724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53116d32b87aef382a314cf73572e7b?s=128&d=identicon&r=PG&f=1", "display_name": "John Kibbits", "link": "https://stackoverflow.com/users/7076724/john-kibbits"}, "edited": false, "score": 0, "creation_date": 1478116467, "post_id": 40385100, "comment_id": 68028950, "body": "Do you know which line is returning the error? Were you able to add the reference?"}, {"owner": {"reputation": 11, "user_id": 7076724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53116d32b87aef382a314cf73572e7b?s=128&d=identicon&r=PG&f=1", "display_name": "John Kibbits", "link": "https://stackoverflow.com/users/7076724/john-kibbits"}, "edited": false, "score": 0, "creation_date": 1478117927, "post_id": 40385100, "comment_id": 68029738, "body": "Dim fso As FileSystemObject is returning the error. User defined type not defined. I was able to add my reference yes but I can&#39;t get passed that."}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "reply_to_user": {"reputation": 11, "user_id": 7076724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53116d32b87aef382a314cf73572e7b?s=128&d=identicon&r=PG&f=1", "display_name": "John Kibbits", "link": "https://stackoverflow.com/users/7076724/john-kibbits"}, "edited": false, "score": 0, "creation_date": 1478164043, "post_id": 40385100, "comment_id": 68045144, "body": "That error normally means the reference hasn&#39;t been added correctly.  I&#39;ll edit my answer to include more details..."}], "tags": [], "owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "is_accepted": false, "score": 0, "last_activity_date": 1478164589, "last_edit_date": 1478164589, "creation_date": 1478104425, "answer_id": 40385100, "question_id": 40383026, "link": "https://stackoverflow.com/questions/40383026/opening-multiple-documents-via-for-each-structure-vba/40385100#40385100", "title": "Opening multiple documents via &#39;For Each&#39; structure. VBA", "body": "<p>This method requires a reference to the <em>Windows Script Host Object Model</em>.  To add select <em>Tools</em> and then <em>References</em> from the VBA menu.  The references are listed alphabetically.</p>\n\n<pre><code>' Requires reference: Windows Script Host Object Model.\nSub FindFile()\n    Const ROOT_DIR As String = \"C:\\MI\\Example\"  ' Update with your folder.\n    Dim fso As FileSystemObject                 ' Used to read from file system.\n    Dim fle As File                             ' Used to loop over files.\n\n    ' Ready object variable for use.\n    Set fso = New FileSystemObject\n\n    ' Loop over files.\n    For Each fle In fso.GetFolder(ROOT_DIR).Files\n\n        If fle.Name Like \"*.docx\" Then Application.Documents.Open fle.Name\n    Next\n\n\n    ' Release object vars before they leave scope.\n    Set fso = Nothing\nEnd Sub\n</code></pre>\n\n<p>The <a href=\"https://msdn.microsoft.com/en-us/library/aa711216%28v=vs.71%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">FileSystemObject</a> is a powerful class, provided by Microsoft.  It allows your code to interact with the Windows file system.</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>The error <em>user defined type not defined</em> means the compiler does not recognise one your data types.  In this case, it does not know what a <code>FileSystemObject</code> is, so it cannot create the variable <code>fso</code> of that type.  To fix it needs the reference, mentioned above.  This contains the definition, telling VBA what an fso is, and how it works.  </p>\n\n<p>From the menu strip can you click <em>Tools</em> >> <em>References</em> and double check <em>Windows Script Host Object Model</em> is checked (selected references should be at the top, the rest are listed alphabetically).</p>\n\n<p><a href=\"https://i.stack.imgur.com/syF2J.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/syF2J.png\" alt=\"References Dialog\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 7076724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f53116d32b87aef382a314cf73572e7b?s=128&d=identicon&r=PG&f=1", "display_name": "John Kibbits", "link": "https://stackoverflow.com/users/7076724/john-kibbits"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1478164589, "creation_date": 1478098418, "last_edit_date": 1478103958, "question_id": 40383026, "link": "https://stackoverflow.com/questions/40383026/opening-multiple-documents-via-for-each-structure-vba", "title": "Opening multiple documents via &#39;For Each&#39; structure. VBA", "body": "<p>I want a piece of code that will allow me to open 3 documents that are placed within a folder - and each time the documents open I want there to be a message box that displays the files name. I wanted to do this loop via a For Each Next structure.</p>\n\n<p>I know that application.documents.open filename:=\"link to the documents\" is the code I need to use but I'm having trouble putting it together.</p>\n\n<pre><code>Option Explicit\n\nSub openthrice()\n\n    Application.Documents.Open FileName:=\"C:\\Users\\John\\Desktop\\New folder\\Doc1.docx\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1478097923, "post_id": 40382731, "comment_id": 68017399, "body": "If you want your code to run whenever someone modified Cell &quot;B3&quot; in a few worksheets, then move this code to <code>Workbook_SheetChange</code> event. Example: <code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)</code> , then add your code there"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478097945, "post_id": 40382731, "comment_id": 68017420, "body": "<code>ActiveSheet.Hyperlinks</code> should probably be <code>Target.Parent.Hyperlinks</code>."}, {"owner": {"reputation": 1, "user_id": 6947100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b0b2e2155bbda52cc512befbbfc20c?s=128&d=identicon&r=PG&f=1", "display_name": "00001", "link": "https://stackoverflow.com/users/6947100/00001"}, "edited": false, "score": 0, "creation_date": 1478140632, "post_id": 40382731, "comment_id": 68037265, "body": "Not work for EV2, EV3. how can I solve by myself???"}], "owner": {"reputation": 1, "user_id": 6947100, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b0b2e2155bbda52cc512befbbfc20c?s=128&d=identicon&r=PG&f=1", "display_name": "00001", "link": "https://stackoverflow.com/users/6947100/00001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478097640, "creation_date": 1478097640, "last_edit_date": 1531161705, "question_id": 40382731, "link": "https://stackoverflow.com/questions/40382731/vba-hyperlink-to-muiltsheets", "title": "VBA Hyperlink to Muiltsheets", "body": "<p>I have a problem with this VBA in hyperlink to multi-sheets. this code below only work on sheet [EV], and how to make it work with sheet [EV2] &amp; [EV3]???. I also attached Excel file in the link</p>\n\n<p><a href=\"https://ufile.io/30110\" rel=\"nofollow noreferrer\">https://ufile.io/30110</a></p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    On Error GoTo err_handler\n    If Target.Address = \"$B$3\" Then\n        ActiveSheet.Hyperlinks.Add Anchor:=[C3], Address:=\"\", SubAddress:= _\n        \"EV!C\" &amp; Cells(3, 3)\n        If Target.Address = \"$B$3\" Then\n    Exit Sub\nerr_handler:\n    MsgBox \"No word in database\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vb.net", "vba", "email", "outlook", "vsto"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 7105037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f7db1215cdc4baba38f7667d1c9900?s=128&d=identicon&r=PG&f=1", "display_name": "Mid", "link": "https://stackoverflow.com/users/7105037/mid"}, "is_accepted": true, "score": 0, "last_activity_date": 1478775395, "last_edit_date": 1478775395, "creation_date": 1478099677, "answer_id": 40383485, "question_id": 40382371, "link": "https://stackoverflow.com/questions/40382371/vsto-outlook-cannot-find-subfolders-of-shared-inbox/40383485#40383485", "title": "VSTO Outlook: Cannot find subfolders of shared inbox", "body": "<p>I solved it - I am not entirely sure how exactly this could have happened but it certainly had to do with the permissions I had.</p>\n"}], "owner": {"reputation": 31, "user_id": 7105037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15f7db1215cdc4baba38f7667d1c9900?s=128&d=identicon&r=PG&f=1", "display_name": "Mid", "link": "https://stackoverflow.com/users/7105037/mid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 1, "accepted_answer_id": 40383485, "answer_count": 1, "score": 0, "last_activity_date": 1545947658, "creation_date": 1478096703, "last_edit_date": 1478775419, "question_id": 40382371, "link": "https://stackoverflow.com/questions/40382371/vsto-outlook-cannot-find-subfolders-of-shared-inbox", "title": "VSTO Outlook: Cannot find subfolders of shared inbox", "body": "<p>I am trying to move mails from any folder to a very specific subfolder of a shared inbox. After trying many different things that did not work I tried to loop through every single folder in the inbox und check if it has the name I am looking for. When I try moving the mailitem, I get the message that the element could not be moved. After searching a little bit longer for the cause I found out, that apparently no folder inside of my inbox exist and the for each loop exits without checking a single entry. So how am I supposed to access a specific subfolder which i only know the name of?</p>\n\n<p>Relevant code:</p>\n\n<pre><code>Private Const destFolder = \"myfoldername\"\n\nPublic Function MoveMail()\n    SelectedItems = Globals.ThisAddIn.Application.ActiveExplorer.Selection\n    For Each Item In SelectedItems\n        Call MoveSelectedMail(Item)\n    Next Item\nEnd Function\n\nFunction MoveSelectedMail(Item As Outlook.MailItem)\n    Item.Move(GetFolderToMove(destFolder))\nEnd Function\n\nFunction GetFolderToMove(ByVal FolderName As String) As Outlook.Folder\n    Dim NS As Outlook.NameSpace\n    Dim objOwner As Outlook.Recipient\n    NS = Globals.ThisAddIn.Application.GetNamespace(\"MAPI\")\n    objOwner = NS.CreateRecipient(\"NameofSharedMailbox\")\n    objOwner.Resolve()\n\n    If objOwner.Resolved Then\n        Dim inbox As Outlook.Folder\n        inbox = NS.GetSharedDefaultFolder(objOwner, OlDefaultFolders.olFolderInbox)\n        For Each folder As Outlook.Folder In inbox.Folders\n            MsgBox(folder.Name)\n            If folder.Name = FolderName Then\n                Return folder\n            End If\n        Next folder\n    End If\nEnd Function\n</code></pre>\n\n<p>This is the code I used in VBA but did not work when I started trying to do the same thing as VSTO addin:</p>\n\n<pre><code>Function GetFolderToMove(ByVal FolderPath As String) As Outlook.Folder\n    Dim NS As Outlook.NameSpace\n    Dim objOwner As Outlook.Recipient\n    Set NS = Application.GetNamespace(\"MAPI\")\n    Set objOwner = NS.CreateRecipient(\"NameofSharedMailbox\")\n    objOwner.Resolve\n\n    If objOwner.Resolved Then\n        Set GetFolderPath = NS.GetSharedDefaultFolder(objOwner, olFolderInbox).Folders(destFolder)\n    End If\nEnd Function\n</code></pre>\n\n<p>What I tried but did not help me solve this problem:</p>\n\n<ul>\n<li>Tried returning only the shared inbox and this worked, however, the inbox is not the folder I want to move the mails to.</li>\n</ul>\n\n<p>In short: I am trying to move a mail to a subfolder of a shared inbox but there seem to be no subfolders according to the error messages.</p>\n\n<p>Hoping you can help me.</p>\n\n<p><strong>Edit:</strong>\nMy Problem might be a little bit out of place as it seems that there might be a problem with the permissions my outlook account has. If the problem is going to be resolved that way, I will update this thread and close ist.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 12976, "user_id": 1758762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nt89f.jpg?s=128&g=1", "display_name": "Leo Chapiro", "link": "https://stackoverflow.com/users/1758762/leo-chapiro"}, "edited": false, "score": 1, "creation_date": 1478096529, "post_id": 40382220, "comment_id": 68016423, "body": "I think, this is not what you want, try to use &quot;For Each ... In a.Rows ... Next&quot;. In other words, try to loop through the rows!"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1478096617, "post_id": 40382220, "comment_id": 68016496, "body": "The loop is probably working correctly, just not as intended."}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 1, "creation_date": 1478097196, "post_id": 40382220, "comment_id": 68016872, "body": "You&#39;re only describing what the loop is doing...which is obvious from the code. Could you please describe what you <i>want</i> it to do. Perhaps you could include a screen shot of the data with some description of what you are tying to accomplish."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "edited": false, "score": 0, "creation_date": 1478098446, "post_id": 40382598, "comment_id": 68017811, "body": "how do i just return what has values in the cells?"}, {"owner": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "edited": false, "score": 0, "creation_date": 1478098813, "post_id": 40382598, "comment_id": 68018076, "body": "ok i fixed it by deleting unneccessary rows in the current spreadsheet.  How do I now stop it from deleting days that are a day apart? It deletes the days that are the same as well as a day apart.  The time stamp doesnt matter since its all 12:00:00"}, {"owner": {"reputation": 1312, "user_id": 2181811, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2390fa3108fe3a63ceafb79cd67452c0?s=128&d=identicon&r=PG", "display_name": "Andrew Magerman", "link": "https://stackoverflow.com/users/2181811/andrew-magerman"}, "reply_to_user": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "edited": false, "score": 0, "creation_date": 1478099678, "post_id": 40382598, "comment_id": 68018750, "body": "Are you perhaps trying to compare the values on the same row? Because your current code will delete anything in column c which is also found in column b."}, {"owner": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "edited": false, "score": 0, "creation_date": 1478105562, "post_id": 40382598, "comment_id": 68022690, "body": "yes same one but the ones that delete are either the same or a day off"}, {"owner": {"reputation": 1312, "user_id": 2181811, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2390fa3108fe3a63ceafb79cd67452c0?s=128&d=identicon&r=PG", "display_name": "Andrew Magerman", "link": "https://stackoverflow.com/users/2181811/andrew-magerman"}, "reply_to_user": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "edited": false, "score": 0, "creation_date": 1478108305, "post_id": 40382598, "comment_id": 68024379, "body": "change the format of the cells to general, you should see some numbers there instead of the dates. That is what is being compared."}], "tags": [], "owner": {"reputation": 1312, "user_id": 2181811, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2390fa3108fe3a63ceafb79cd67452c0?s=128&d=identicon&r=PG", "display_name": "Andrew Magerman", "link": "https://stackoverflow.com/users/2181811/andrew-magerman"}, "is_accepted": false, "score": 1, "last_activity_date": 1478097294, "creation_date": 1478097294, "answer_id": 40382598, "question_id": 40382220, "link": "https://stackoverflow.com/questions/40382220/loop-not-working-corretly/40382598#40382598", "title": "Loop not working corretly", "body": "<p>If your using UsedRange, 'Columns(\"B\") will return the second column of that selection, not necesarily the Column B. I would suggest looking what gets selected with this:</p>\n\n<p><code>ActiveSheet.UsedRange.Columns(\"B\").Cells.Select</code></p>\n\n<p>So you can visually see what is being selected. It's probably not what you're thinking.</p>\n"}], "owner": {"reputation": 31, "user_id": 7095841, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/81504fc7aafdb3da2999fcc09fe292bc?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi Gowda", "link": "https://stackoverflow.com/users/7095841/ravi-gowda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478097294, "creation_date": 1478096269, "last_edit_date": 1531164843, "question_id": 40382220, "link": "https://stackoverflow.com/questions/40382220/loop-not-working-corretly", "title": "Loop not working corretly", "body": "<p>My b and c columns are formatted as a Date and Time in each cell\nand when i run this code:</p>\n\n<pre><code>Dim b As Range\nDim c As Range\nFor Each b In ActiveSheet.UsedRange.Columns(\"B\").Cells\n    For Each c In ActiveSheet.UsedRange.Columns(\"C\").Cells\n        If b.Value = c.Value Then\n            c.Value = Null\n        End If\n    Next c\nNext b\n</code></pre>\n\n<p>It will only make null values where the time is not equal.\nAlso it creates a bunch of blank rows in my spreadsheet.</p>\n\n<p>Any ideas why?</p>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478096454, "post_id": 40382034, "comment_id": 68016356, "body": "Use multiple checks in Inte or use a select case/IF based on the target.column and/or target.row values"}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "edited": false, "score": 0, "creation_date": 1478180401, "post_id": 40382034, "comment_id": 68056064, "body": "@Joseph_Schleiss: I see you&#39;re new. Please be courteous and &quot;Accept&quot; the answer if you think it appropriate."}], "answers": [{"comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1481489118, "post_id": 40382264, "comment_id": 69386621, "body": "I was just looking through some older questions and noticed this answer - I think your <code>Case 2, 3 &#39; &quot;A&quot; or &quot;B&quot;</code> should be <code>Case 1 &#39; &quot;A&quot;</code> because column A and B are columns 1 and 2, not 2 and 3, and the OP was testing for changes in column A, not column A and B.  The way the code is currently set up, a change in column A will not trigger any calculations.   Also <code>Target.Column</code> just returns the column of the <b>first</b> cell in <code>Target</code>, so testing should probably be done by an <code>If Not Intersect(Range(&quot;A:A&quot;), Target) Is Nothing</code>."}, {"owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481581238, "post_id": 40382264, "comment_id": 69425741, "body": "True that. I updated the case statement. I did not update for the Intersect. It&#39;s a valid point, of course. I&#39;ll trust that your comment is enough to steer people in the right direction."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1481581359, "post_id": 40382264, "comment_id": 69425792, "body": "As long as the clean-up routines don&#39;t delete the comment, it should be fine."}], "tags": [], "owner": {"reputation": 5563, "user_id": 2283957, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/ULeS3.jpg?s=128&g=1", "display_name": "LimaNightHawk", "link": "https://stackoverflow.com/users/2283957/limanighthawk"}, "is_accepted": false, "score": 3, "last_activity_date": 1481581121, "last_edit_date": 1481581121, "creation_date": 1478096393, "answer_id": 40382264, "question_id": 40382034, "link": "https://stackoverflow.com/questions/40382034/running-multipile-macros-in-the-same-sheet/40382264#40382264", "title": "Running multipile macros in the same sheet", "body": "<p>You just need to test what the Address/location of the Target range is:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Application.EnableEvents = False\n\n    Select Case Target.Column\n        Case 1 ' \"A\"\n\n            Dim A As Range, B As Range, Inte As Range, r As Range\n            Set A = Range(\"A:A\")\n            Set Inte = Intersect(A, Target)\n            If Inte Is Nothing Then Exit Sub\n            For Each r In Inte\n                If r.Value &gt; 0 Then\n                   r.Offset(0, 1).Value = Date\n                   r.Offset(0, 1).NumberFormat = \"mm-dd-yy\"\n                   r.Offset(0, 2).Value = Time\n                   r.Offset(0, 2).NumberFormat = \"hh:mm AM/PM\"\n                Else\n                   r.Offset(0, 1).Value = \"\"\n                   r.Offset(0, 2).Value = \"\"\n                End If\n            Next r\n\n        Case 14 ' \"N\"\n                ' Do something else\n\n    End Select\n\n    Application.EnableEvents = True ' &lt;-- Don't forget to turn this back on!\n\nEnd Sub\n</code></pre>\n\n<p>Further, since such an approach can get unwieldy, it's often a good idea to break down your methods. (Smaller methods are almost always better.)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Application.EnableEvents = False\n\n    Select Case Target.Column\n        Case 1, ' \"A\"\n            Call AddDatesAfterInitialsEntered(Target)\n\n        Case 14 ' \"N\"\n            ' Do something else\n\n    End Select\n\n    Application.EnableEvents = True ' &lt;-- Don't forget to turn this back on!\n\nEnd Sub\n\nPrivate Sub AddDatesAfterInitialsEntered(Target As Range)\n\n    Dim A As Range, B As Range, Inte As Range, r As Range\n    Set A = Range(\"A:A\")\n    Set Inte = Intersect(A, Target)\n    If Inte Is Nothing Then Exit Sub\n    For Each r In Inte\n        If r.Value &gt; 0 Then\n           r.Offset(0, 1).Value = Date\n           r.Offset(0, 1).NumberFormat = \"mm-dd-yy\"\n           r.Offset(0, 2).Value = Time\n           r.Offset(0, 2).NumberFormat = \"hh:mm AM/PM\"\n        Else\n           r.Offset(0, 1).Value = \"\"\n           r.Offset(0, 2).Value = \"\"\n        End If\n    Next r\n\nEnd Sub \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7105054, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6UA2h4JsqHs/AAAAAAAAAAI/AAAAAAAANMA/1i0J8QINVkg/photo.jpg?sz=128", "display_name": "Joseph Schleiss", "link": "https://stackoverflow.com/users/7105054/joseph-schleiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1481581121, "creation_date": 1478095746, "last_edit_date": 1478101412, "question_id": 40382034, "link": "https://stackoverflow.com/questions/40382034/running-multipile-macros-in-the-same-sheet", "title": "Running multipile macros in the same sheet", "body": "<p>I am trying to run a macro that will fill in the date and time when something has been updated, but I need to have it happen twice in the same row.</p>\n\n<p>I have it set up to fill in column B+C when initials are entered in column A, but I would like to to run when someone enters another value in column N</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim A As Range, B As Range, Inte As Range, r As Range\n    Set A = Range(\"A:A\")\n    Set Inte = Intersect(A, Target)\n    If Inte Is Nothing Then Exit Sub\n    Application.EnableEvents = False\n    For Each r In Inte\n        If r.Value &gt; 0 Then\n           r.Offset(0, 1).Value = Date\n           r.Offset(0, 1).NumberFormat = \"mm-dd-yy\"\n           r.Offset(0, 2).Value = Time\n           r.Offset(0, 2).NumberFormat = \"hh:mm AM/PM\"\n        Else\n           r.Offset(0, 1).Value = \"\"\n           r.Offset(0, 2).Value = \"\"\n        End If\n    Next r\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "ms-office"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478096088, "post_id": 40381894, "comment_id": 68016053, "body": "Select columns <code>Z:BB</code>, right-click the heading, set width to 50. A column is considered &quot;hidden&quot; when its width is 0."}], "answers": [{"comments": [{"owner": {"reputation": 22330, "user_id": 297115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f082b828109520580868db7878690222?s=128&d=identicon&r=PG&f=1", "display_name": "JavaUser", "link": "https://stackoverflow.com/users/297115/javauser"}, "edited": false, "score": 0, "creation_date": 1478095956, "post_id": 40381993, "comment_id": 68015966, "body": "The cell is not hidden . I tried with UNHIDE. It uses vba , hence i tagged a s VBA."}, {"owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "reply_to_user": {"reputation": 22330, "user_id": 297115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f082b828109520580868db7878690222?s=128&d=identicon&r=PG&f=1", "display_name": "JavaUser", "link": "https://stackoverflow.com/users/297115/javauser"}, "edited": false, "score": 0, "creation_date": 1478096033, "post_id": 40381993, "comment_id": 68016016, "body": "Look, if a column is not being shown (say, column &quot;Z&quot;), it is either hidden or its width is near 0."}, {"owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "edited": false, "score": 0, "creation_date": 1478096991, "post_id": 40381993, "comment_id": 68016749, "body": "I agree with the second point.  I am curious as to your confusion on the first, I understood this was normal practice.  See the most upvoted vba question on SO for example: <a href=\"http://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\" title=\"how to use regular expressions regex in microsoft excel both in cell and loops\">stackoverflow.com/questions/22542834/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "is_accepted": false, "score": 0, "last_activity_date": 1478095640, "creation_date": 1478095640, "answer_id": 40381993, "question_id": 40381894, "link": "https://stackoverflow.com/questions/40381894/ms-excel-option-to-show-all-the-cells-aa-ab-ac-ad-ae-af-ai-etc/40381993#40381993", "title": "ms excel - option to show all the cells (AA,AB,AC,AD,AE,AF,AI etc.,)", "body": "<p>First of all, I don't understand why you tagged it with <code>vba</code> and <code>excel-vba</code>.</p>\n\n<p>Second, try to UNHIDE the invisible cells (or change the columns width).</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7104981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fd652cfc59a9388ffd2e4feccf93a3a?s=128&d=identicon&r=PG&f=1", "display_name": "Sedef", "link": "https://stackoverflow.com/users/7104981/sedef"}, "is_accepted": false, "score": 1, "last_activity_date": 1478096031, "creation_date": 1478096031, "answer_id": 40382132, "question_id": 40381894, "link": "https://stackoverflow.com/questions/40381894/ms-excel-option-to-show-all-the-cells-aa-ab-ac-ad-ae-af-ai-etc/40382132#40382132", "title": "ms excel - option to show all the cells (AA,AB,AC,AD,AE,AF,AI etc.,)", "body": "<p>May be cells width are collapsed.You can try that select all cells with Ctrl+A and  select mouse left click on AB and extend them much more.\nSo you can see all your cells.</p>\n"}, {"tags": [], "owner": {"reputation": 74, "user_id": 5429423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqCKe.jpg?s=128&g=1", "display_name": "Fixer", "link": "https://stackoverflow.com/users/5429423/fixer"}, "is_accepted": false, "score": 1, "last_activity_date": 1493907184, "last_edit_date": 1493907184, "creation_date": 1478102404, "answer_id": 40384427, "question_id": 40381894, "link": "https://stackoverflow.com/questions/40381894/ms-excel-option-to-show-all-the-cells-aa-ab-ac-ad-ae-af-ai-etc/40384427#40384427", "title": "ms excel - option to show all the cells (AA,AB,AC,AD,AE,AF,AI etc.,)", "body": "<p>Try this:</p>\n\n<pre><code>Sub UnHideMyColumns()\n    Cells.ColumnWidth = 10\nEnd Sub\n</code></pre>\n\n<p>It just sets all column widths to 10. You can add Columns.AutoFit if you want to add more to it.</p>\n\n<p>If you are not up on your VBA, select the columns around what you want to increase and change the width of ANY columns to a non-zero amount (just drag right) and it'll change all the columns between the selected columns as well.</p>\n"}], "owner": {"reputation": 22330, "user_id": 297115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/f082b828109520580868db7878690222?s=128&d=identicon&r=PG&f=1", "display_name": "JavaUser", "link": "https://stackoverflow.com/users/297115/javauser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 909, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1493907184, "creation_date": 1478095340, "last_edit_date": 1478095954, "question_id": 40381894, "link": "https://stackoverflow.com/questions/40381894/ms-excel-option-to-show-all-the-cells-aa-ab-ac-ad-ae-af-ai-etc", "title": "ms excel - option to show all the cells (AA,AB,AC,AD,AE,AF,AI etc.,)", "body": "<p>I have an microsoft excel sheet which is doing some calculation using VBA.\nI enabled \"Show formulas\" and I could see in one of the cell the formula is shown as <strong>\"=AI38*AO34\"</strong>.\nBut I am not able to see the AI cell in my excel sheet . After \"Z\" , I have \"AA\" and then \"AB\".\nThen it contineous with \"AW\" and \"AX\" and so on.</p>\n\n<p>How to check the AD to rest of the cells . The cells are not hidden in this sheet.</p>\n\n<p>Please let me know the option to show all the cells.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba", "if-statement", "border", "conditional-statements"], "answers": [{"tags": [], "owner": {"reputation": 74, "user_id": 5429423, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UqCKe.jpg?s=128&g=1", "display_name": "Fixer", "link": "https://stackoverflow.com/users/5429423/fixer"}, "is_accepted": false, "score": 0, "last_activity_date": 1493907212, "last_edit_date": 1493907212, "creation_date": 1478104016, "answer_id": 40384962, "question_id": 40381530, "link": "https://stackoverflow.com/questions/40381530/macro-vba-in-excel-to-add-borders-and-merge-cells-if-the-cells-are-not-empty/40384962#40384962", "title": "Macro (VBA) in Excel to add borders and merge cells if the cells are not empty", "body": "<p>This might work. You can adjust the filters and formatting to suit your needs. Be careful about macro-recording, though.</p>\n\n<pre><code>Sub FindAreas()\n    TopRange = 1\n    LastRow = Cells.Find(What:=\"*\", After:=[A1], SearchDirection:=xlPrevious, SearchOrder:=xlByRows).Row\n    For A = 1 To LastRow\n        If Range(\"A\" &amp; A).Value &lt;&gt; \"\" _\n            And Range(\"A\" &amp; A).Borders(xlEdgeLeft).LineStyle = xlNone _\n            And Range(\"A\" &amp; A).Borders(xlEdgeRight).LineStyle = xlNone _\n            And Range(\"A\" &amp; A).Borders(xlEdgeTop).LineStyle = xlNone _\n            And Range(\"A\" &amp; A).Borders(xlEdgeBottom).LineStyle = xlNone _\n                Then Contiguous = True Else Contiguous = False\n        If A = LastRow Then\n            Contiguous = False\n            A = A + 1\n        End If\n        Select Case Contiguous\n            Case False\n                Call ApplyFormattingtoArea(\"A\" &amp; TopRange &amp; \":A\" &amp; A - 1)\n                TopRange = A + 1\n                A = A + 1\n        End Select\n    Next A\nEnd Sub\n\nSub ApplyFormattingtoArea(AppliedArea)\n    Application.DisplayAlerts = False\n    Range(AppliedArea).Merge\n    Range(AppliedArea).Borders(xlInsideVertical).LineStyle = xlNone\n    Range(AppliedArea).Borders(xlInsideHorizontal).LineStyle = xlNone\n    With Range(AppliedArea)\n        .HorizontalAlignment = xlCenter\n        .VerticalAlignment = xlCenter\n        .WrapText = False\n        .Orientation = 0\n        .AddIndent = False\n        .IndentLevel = 0\n        .ShrinkToFit = False\n        .ReadingOrder = xlContext\n    End With\n    Range(AppliedArea).Borders(xlDiagonalDown).LineStyle = xlNone\n    Range(AppliedArea).Borders(xlDiagonalUp).LineStyle = xlNone\n    With Range(AppliedArea).Borders(xlEdgeLeft)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Range(AppliedArea).Borders(xlEdgeTop)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Range(AppliedArea).Borders(xlEdgeBottom)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    With Range(AppliedArea).Borders(xlEdgeRight)\n        .LineStyle = xlContinuous\n        .ColorIndex = 0\n        .TintAndShade = 0\n        .Weight = xlThin\n    End With\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6388547, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206170643649528/picture?type=large", "display_name": "contenrico", "link": "https://stackoverflow.com/users/6388547/contenrico"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 897, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493907212, "creation_date": 1478094325, "question_id": 40381530, "link": "https://stackoverflow.com/questions/40381530/macro-vba-in-excel-to-add-borders-and-merge-cells-if-the-cells-are-not-empty", "title": "Macro (VBA) in Excel to add borders and merge cells if the cells are not empty", "body": "<p>I recorded the following Macro:</p>\n\n<pre><code>Sub Macro1()\nRange(\"E66:F68\").Select\nSelection.Borders(xlDiagonalDown).LineStyle = xlNone\nSelection.Borders(xlDiagonalUp).LineStyle = xlNone\nWith Selection.Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nSelection.Borders(xlInsideVertical).LineStyle = xlNone\nSelection.Borders(xlInsideHorizontal).LineStyle = xlNone\nRange(\"D66:D68,C66:C68,B66:B68,A66:A68\").Select\nRange(\"A66\").Activate\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlBottom\n    .WrapText = False\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nSelection.Merge\nWith Selection\n    .HorizontalAlignment = xlCenter\n    .VerticalAlignment = xlCenter\n    .WrapText = False\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\nEnd With\nSelection.Borders(xlDiagonalDown).LineStyle = xlNone\nSelection.Borders(xlDiagonalUp).LineStyle = xlNone\nWith Selection.Borders(xlEdgeLeft)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeTop)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeBottom)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nWith Selection.Borders(xlEdgeRight)\n    .LineStyle = xlContinuous\n    .ColorIndex = 0\n    .TintAndShade = 0\n    .Weight = xlThin\nEnd With\nSelection.Borders(xlInsideVertical).LineStyle = xlNone\nSelection.Borders(xlInsideHorizontal).LineStyle = xlNone\nRange(\"G73\").Select\nEnd Sub\n</code></pre>\n\n<p>Now, this was recorded for the range starting at E66, and it basically adds borders for the cells selected and merges the cell rows in the adjacent columns. What I'd like to do is add a condition that looks at column E and starts the macro on the first non-empty cell that has no borders and ends it on the last non-empty cell. In the macro I recorded, the first unbordered non-empty cell was E66 (meaning that the cells in the range E1:E65 had all borders on at least one side), and the last non-empty cell was E68 (the range on the second line is E66:F68 because I used outside borders for the rectangle of cells from E66 to F68, but the condition only needs to be verified for column E).</p>\n\n<p>In other words, I need some sort of loop that goes from E1 to E<em>x</em>, and when it finds a cell that is both non-empty <strong>and</strong> unbordered, it stores that cell number as the starting cell (say E<em>y</em>). Then, when it finds an empty cell (say E<em>z</em>), the loop stops and the cell before E<em>z</em> (so E<em>z-1</em>) is stored as the last one. Then the macro that I recorded should run in the range E<em>y</em>:F<em>z-1</em>.</p>\n\n<p>How can I do this? Thanks.</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "comments": [{"owner": {"reputation": 356, "user_id": 6834551, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/576a6f5a5155d448f650296fb4b4e749?s=128&d=identicon&r=PG&f=1", "display_name": "finjo", "link": "https://stackoverflow.com/users/6834551/finjo"}, "edited": false, "score": 0, "creation_date": 1478094416, "post_id": 40381482, "comment_id": 68014880, "body": "Doesn&#39;t look like you have defined pTargetPath in the first code (<code>Dim pTargetPath as String</code>). Does adding that make any difference?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478094630, "post_id": 40381482, "comment_id": 68015046, "body": "Is <code>prcPrepareFile</code> saving the workbook as an <code>xlsx</code> file?"}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "reply_to_user": {"reputation": 356, "user_id": 6834551, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/576a6f5a5155d448f650296fb4b4e749?s=128&d=identicon&r=PG&f=1", "display_name": "finjo", "link": "https://stackoverflow.com/users/6834551/finjo"}, "edited": false, "score": 0, "creation_date": 1478094828, "post_id": 40381482, "comment_id": 68015210, "body": "@finjo, sorry I forget to type it. In normal code it is."}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478094955, "post_id": 40381482, "comment_id": 68015323, "body": "@Comintern Yes, but other file, not this one where code is."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478094998, "post_id": 40381482, "comment_id": 68015348, "body": "Can you post the code for that <code>Sub</code> then?  I suspect that&#39;s where the issue is."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1478095488, "post_id": 40381482, "comment_id": 68015671, "body": "Which workbook and module is the <code>prcPrepareFirstReport</code> code in?"}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478096168, "post_id": 40381482, "comment_id": 68016127, "body": "@Comintern I added it in post. There are also public variable above sub."}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1478096225, "post_id": 40381482, "comment_id": 68016178, "body": "@Rory the same workbook and module as prcPrepareFile"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1478096421, "post_id": 40381482, "comment_id": 68016329, "body": "What is the name of the module? Ideally you should prefix the call with the name of the workbook: <code>Run &#39;workbook_name&#39;!macro_name</code>"}, {"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1478098131, "post_id": 40381482, "comment_id": 68017570, "body": "@Rory Module1 . I&#39;ll try."}], "answers": [{"comments": [{"owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "edited": false, "score": 0, "creation_date": 1478098733, "post_id": 40382520, "comment_id": 68018019, "body": "I got the same error. I noticed something weird. After run this first macro, the pExcel was no this Excel that I runed. <code>pExcel.Name</code> is now H:\\DATA\\Microsoft Excel.xlsx."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1478097057, "creation_date": 1478097057, "answer_id": 40382520, "question_id": 40381482, "link": "https://stackoverflow.com/questions/40381482/second-macro-in-excel-doesnt-run/40382520#40382520", "title": "Second macro in Excel doesn&#39;t run", "body": "<p>It looks like your public variable <code>pSourceName</code> is losing state between the two calls to <code>Application.Run</code> in the calling code. A much more robust solution than using a global state variable is to convert <code>prcPrepareFile</code> to a function that returns the <code>pSourceName</code>, then pass <em>that</em> to <code>prcPrepareFirstReport</code>.</p>\n\n<p><strong>Excel code:</strong></p>\n\n<pre><code>Public Function prcPrepareFile(pPath As String, pPathToSave As String) As String\n    'Snip\n    pName = pFileToPrepare.Name\n    pName = pPathToSave &amp; pName\n    pFileToPrepare.SaveAs pName\n\n    prcPrepareFile = pFileToPrepare.Name\n    With Application\n       .DisplayAlerts = True\n       .ScreenUpdating = True\n    End With\nEnd Function\n\nSub prcPrepareFirstReport(pTargetPath As String, pSourceName As String)\n    Dim pSourceWorbook As Workbook\n    Dim pTargetWorkbook As Workbook\n\n    Set pSourceWorbook = Workbooks(pSourceName)\n    Set pTargetWorkbook = Workbooks.Open(pTargetPath)\nEnd Sub\n</code></pre>\n\n<p><strong>Calling code:</strong></p>\n\n<pre><code>Dim pSourceName As String\npSourceName = pExcel.Run(pMacro, pPath, pPathToSave)\n\npMacro = \"prcPrepareFirstReport\"\n\npTargetPath = DLookup(\"[F_LINK]\", \"tblLinks\", \"[F_ID] = 5\")\n\npExcel.Run pMacro, pTargetPath, pSourceName\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "is_accepted": true, "score": 0, "last_activity_date": 1478177536, "creation_date": 1478177536, "answer_id": 40402009, "question_id": 40381482, "link": "https://stackoverflow.com/questions/40381482/second-macro-in-excel-doesnt-run/40402009#40402009", "title": "Second macro in Excel doesn&#39;t run", "body": "<p>Ok, I figured this up. Help from @Comintern and @Rory was essential:)</p>\n\n<p>So the problem was, that after run <code>prcPrepareFile</code> the other Excel was activate, not this with macro code. I don't know why (maybe someone could it explains), but after it the variable <code>pExcel</code> had in it this second Excel without VBA code...</p>\n\n<p>The solution is to prepare variable with name of this first Excel and then run this second macro with name of this first Excel. The right code below:</p>\n\n<pre><code>Dim pSourceName As String\nDim pWorkWorkbookName As String\n\npWorkWorkbookName = pExcel.Names.Parent.Name\npSourceName = pExcel.Run(pMacro, pPath, pPathToSave)\n\npMacro = \"prcPrepareFirstReport\"\n\npTargetPath = DLookup(\"[F_LINK]\", \"tblLinks\", \"[F_ID] = 5\")\n\npExcel.Run \"'\" &amp; pWorkWorkbookName &amp; \"'!\" &amp; pMacro, pTargetPath, pSourceName\n</code></pre>\n\n<p>Thanks all for help.</p>\n"}], "owner": {"reputation": 535, "user_id": 3668759, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f071fe3e57f795555dfa339ca70ed7d?s=128&d=identicon&r=PG&f=1", "display_name": "Gadziu", "link": "https://stackoverflow.com/users/3668759/gadziu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "accepted_answer_id": 40402009, "answer_count": 2, "score": 1, "last_activity_date": 1478177536, "creation_date": 1478094216, "last_edit_date": 1478096115, "question_id": 40381482, "link": "https://stackoverflow.com/questions/40381482/second-macro-in-excel-doesnt-run", "title": "Second macro in Excel doesn&#39;t run", "body": "<p>my problem is kind of odd... I have code in Access VBA. There I want to run two macros in other Excel file. First macro run with no problem, but when dubbger get second, I'm given a Run-time error 1004: \"Cannot run the macro 'prcPrepareFirstReport'. The macro not be available in this worbook or all macros be disabled.\"</p>\n\n<p>The code of Access:</p>\n\n<pre><code>Private Sub cmdRaport_Click()\n    Dim pPath As String            \n    Dim pWorkPath As String        \n    Dim pExcel As Object\n    Dim pPathToSave As String\n    Dim pTargetPath As String\n\n    pPath = fncFilePicker()\n\n    pWorkPath = DLookup(\"[F_LINK]\", \"tblLinks\", \"[F_ID] = 1\")\n    Set pExcel = CreateObject(\"Excel.Application\")\n\n    pExcel.Workbooks.Open (pWorkPath)\n    pMacro = \"prcPrepareFile\"\n\n    pPathToSave = DLookup(\"[F_LINK]\", \"tblLinks\", \"[F_ID] = 2\")\n\n    pExcel.Run pMacro, pPath, pPathToSave 'this macro is going fine\n\n    pMacro = \"prcPrepareFirstReport\"\n\n    pTargetPath = DLookup(\"[F_LINK]\", \"tblLinks\", \"[F_ID] = 5\")\n\n    pExcel.Run pMacro, pTargetPath 'on this macro I'm given error 1004\n\n    pExcel.ActiveWorkbook.Close\n    pExcel.Quit\n\n    Set pExcel = Nothing\nEnd Sub\n</code></pre>\n\n<p>The Excel VBA code:</p>\n\n<pre><code>Public pSourceName As String\nSub prcPrepareFile(pPath As String, pPathToSave As String)\n    Dim pFileToPrepare As Workbook\n    Dim pSheet As Worksheet\n    Dim pLastRow As Long        \n    Dim pName As String \n    Dim i As Long\n\n    With Application\n       .DisplayAlerts = False\n       .ScreenUpdating = False\n    End With\n\n    Set pFileToPrepare = Workbooks.Open(pPath)\n\n    Set pSheet = pFileToPrepare.Worksheets(1)\n\n    pSheet.Rows(\"1:3\").Select\n    Selection.Delete Shift:=xlUp\n\n    pSheet.Rows(\"2:5\").Select\n    Selection.Delete Shift:=xlUp\n\n    pLastRow = pSheet.Cells(pSheet.Rows.Count, \"A\").End(xlUp).Row\n\n    For i = 2 To pLastRow\n        If pSheet.Cells(i, 1).Value = \"\" Then\n           pSheet.Rows(i &amp; \":\" &amp; i + 5).Select\n           Selection.Delete Shift:=xlUp\n        End If\n    Next i\n\n    pName = pFileToPrepare.Name\n    pName = pPathToSave &amp; pName\n    Debug.Print pName\n    pFileToPrepare.SaveAs pName\n\n    pSourceName = pFileToPrepare.Name\n\n    With Application\n       .DisplayAlerts = True\n       .ScreenUpdating = True\n    End With\nEnd Sub\n\nSub prcPrepareFirstReport(pTargetPath As String)\n    Dim pSourceWorbook As Workbook\n    Dim pTargetWorkbook As Workbook\n\n    Set pSourceWorbook = Workbooks(pSourceName)\n    Set pTargetWorkbook = Workbooks.Open(pTargetPath)\nEnd Sub\n</code></pre>\n\n<p>I've tried version such </p>\n\n<pre><code>pExcel.Application.Run pMacro\n</code></pre>\n\n<p>, but it's not working...</p>\n\n<p>I've tried to run only this second macro and it's on...</p>\n\n<p>Please help.</p>\n"}, {"tags": ["c", "vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1478093897, "post_id": 40381291, "comment_id": 68014495, "body": "<a href=\"http://stackoverflow.com/q/31409006/4088852\">Possibly relevant.</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1478093989, "post_id": 40381291, "comment_id": 68014575, "body": "Also <a href=\"http://stackoverflow.com/q/6134666/4088852\">this</a>."}], "owner": {"reputation": 838, "user_id": 5391191, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-U8c9fH2K_MQ/AAAAAAAAAAI/AAAAAAAAAEo/uSAxoPsAvvs/photo.jpg?sz=128", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/5391191/jacob-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1478093642, "creation_date": 1478093642, "question_id": 40381291, "link": "https://stackoverflow.com/questions/40381291/unexpected-results-when-returing-bstr-from-dll-to-microsoft-excel-vba-applicatio", "title": "Unexpected Results When Returing BSTR from DLL to Microsoft Excel VBA Application", "body": "<p>I am writing a VBA extension in C, from what I have read VBA uses BSTR, which is just a WCHAR* with a length prefix. I have a function:</p>\n\n<pre><code>__declspec(dllexport) VB_STRING _stdcall getStr()\n{\n    return SysAllocString(L\"This is a string.\");\n}\n</code></pre>\n\n<p>Which I call in VBA using:</p>\n\n<pre><code>Private Declare Function getStr Lib \"main.dll\" () As String\n\nSub do_stuff()\n    Range(\"A1\").value = getStr()\nEnd Sub\n</code></pre>\n\n<p>However, the cell A1 will only contain 'T' rather than the entire string. Could anyone give any advice or show me where I am going wrong?</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 2, "creation_date": 1478093679, "post_id": 40381260, "comment_id": 68014366, "body": "IIRC You need <code>Redim</code> whenever the bounds of the array are not constant. Specifically: <code>Public BenData() As Variant : Redim BenData(1 To Worksheets(&quot;Database&quot;).Range(&quot;A9&quot;).End(xlDown).Row, 1 To 4)</code>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 1, "creation_date": 1478093889, "post_id": 40381260, "comment_id": 68014488, "body": "you need to declare it as <code>Public</code>, and later <code>Redim</code> it (like you have)"}, {"owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "edited": false, "score": 0, "creation_date": 1478093984, "post_id": 40381260, "comment_id": 68014569, "body": "OK. Thanks guys"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1478094443, "creation_date": 1478094443, "answer_id": 40381562, "question_id": 40381260, "link": "https://stackoverflow.com/questions/40381260/public-dynamic-array/40381562#40381562", "title": "Public dynamic array", "body": "<p>The issue has nothing to do with whether or not the variable is public or private - VBA requires that <strong><em>any</em></strong> variable declaration is a constant expression.  This is actually why the <code>ReDim</code> statement exists - a normal <code>Dim foo(10) As Bar</code> expression will create a memory allocation at <em>compile time</em>.  Outside of using API calls, <code>ReDim</code> is the only way to allocate memory at run time. As mentioned in the comments, if you really need a global dynamic array you need to initialize it at runtime:</p>\n\n<pre><code>Public BenData() As Variant\n\nSub UseBenData()\n    ReDim BenData(1 To Worksheets(\"Database\").Range(\"A9\").End(xlDown).Row, 1 To 4)\n    '...\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 217, "user_id": 6699361, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7ed976d9a2cceca3ac3a220c901a4ad1?s=128&d=identicon&r=PG&f=1", "display_name": "Pawel", "link": "https://stackoverflow.com/users/6699361/pawel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 40381562, "answer_count": 1, "score": 0, "last_activity_date": 1617861643, "creation_date": 1478093533, "last_edit_date": 1617861643, "question_id": 40381260, "link": "https://stackoverflow.com/questions/40381260/public-dynamic-array", "title": "Public dynamic array", "body": "<p>I'm trying to set public dynamic array like this:</p>\n\n<pre><code>Public BenData(1 To Worksheets(\"Database\").Range(\"A9\").End(xlDown).Row, 1 To 4)\n</code></pre>\n\n<p>But VBA doesn't allow that. Is there any way around?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478093152, "post_id": 40381106, "comment_id": 68014007, "body": "Use document inspector to get the names of the elements and use those to get the values"}, {"owner": {"reputation": 11, "user_id": 6727505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9168f7f50b2d430e756ea340afe1f61d?s=128&d=identicon&r=PG&f=1", "display_name": "manoj prabhakar", "link": "https://stackoverflow.com/users/6727505/manoj-prabhakar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478093315, "post_id": 40381106, "comment_id": 68014121, "body": "i tried it but failed to execute. <a href=\"http://stackoverflow.com/users/5414798/nathan-sav\">stackoverflow.com/users/5414798/nathan-sav</a>"}, {"owner": {"reputation": 11, "user_id": 6727505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9168f7f50b2d430e756ea340afe1f61d?s=128&d=identicon&r=PG&f=1", "display_name": "manoj prabhakar", "link": "https://stackoverflow.com/users/6727505/manoj-prabhakar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478094449, "post_id": 40381106, "comment_id": 68014898, "body": "Nathan, could you please with code for one Element I would try for other.<a href=\"http://stackoverflow.com/users/5414798/nathan-sav\">stackoverflow.com/users/5414798/nathan-sav</a>"}, {"owner": {"reputation": 11, "user_id": 6727505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9168f7f50b2d430e756ea340afe1f61d?s=128&d=identicon&r=PG&f=1", "display_name": "manoj prabhakar", "link": "https://stackoverflow.com/users/6727505/manoj-prabhakar"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478242441, "post_id": 40381106, "comment_id": 68083012, "body": "thank You very much Nathan i would try it and let you know. Sorry for delay reply as i was busy. <a href=\"http://stackoverflow.com/users/5414798/nathan-sav\">stackoverflow.com/users/5414798/nathan-sav</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1478096339, "last_edit_date": 1478096339, "creation_date": 1478095974, "answer_id": 40382115, "question_id": 40381106, "link": "https://stackoverflow.com/questions/40381106/scrape-the-data-after-giving-date-criteria-using-input-box/40382115#40382115", "title": "Scrape the data after giving date criteria using input box", "body": "<p>Using the MS Internet Controls and MS HTML Library, I'd start by doing the following.</p>\n\n<pre><code>Sub Canada_Sorucing()\n\nDim IE As SHDocVw.InternetExplorer\nDim doc As MSHTML.HTMLDocument\nDim col As MSHTML.IHTMLElementCollection\n\nDim mynocFromDate As String\n\nSet IE = New InternetExplorer\n\nWith IE\n\n    .Visible = True\n    .navigate (\"https://health-products.canada.ca/noc-ac/index-eng.jsp\")\n\n    While IE.readyState &lt;&gt; READYSTATE_COMPLETE Or IE.busy\n        DoEvents\n    Wend\n\n    mynocFromDate = InputBox(\"enter from date eg.2016-10-01, yyyymmdd\", , \"2016-10-01\")\n\n    Set doc = IE.document\n\n    With doc\n        .getElementById(\"nocFromDate\").Value = mynocFromDate\n        .getElementById(\"action\").Click\n    End With\n\n    Do While IE.busy Or IE.readyState &lt;&gt; READYSTATE_COMPLETE\n        DoEvents\n    Loop\n\n    Set doc = IE.document\n\n    '   Here's your start\n    MsgBox doc.getElementsByTagName(\"TR\")(1).innerText\n    Set col = doc.getElementsByTagName(\"TR\")\n\nEnd With\n\nIE.Quit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 6727505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9168f7f50b2d430e756ea340afe1f61d?s=128&d=identicon&r=PG&f=1", "display_name": "manoj prabhakar", "link": "https://stackoverflow.com/users/6727505/manoj-prabhakar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1612824392, "creation_date": 1478093070, "last_edit_date": 1612824392, "question_id": 40381106, "link": "https://stackoverflow.com/questions/40381106/scrape-the-data-after-giving-date-criteria-using-input-box", "title": "Scrape the data after giving date criteria using input box", "body": "<p>i need your help on the below code. I am scraping the data from the website based on date criteria. i have the code till it open the page  from the specific date which i give through input box, After that it moves to new page where i have data under headings Product(s), Manufacturer, NOC with conditions, Notice of Compliance date, Medicinal ingredient(s) and DIN(s). i need to copy that data into excel. Could any please help me with the code how to copy the data?\nbelow is my code till it enter the new page.</p>\n<pre><code>Option Explicit\nSub Canada_Sorucing()\n\nDim IE As Object, obj As Object\nDim mynocFromDate As String\n\nSet IE = CreateObject(&quot;InternetExplorer.Application&quot;)\nWith IE\n.Visible = True\n.navigate (&quot;https://health-products.canada.ca/noc-ac/index-eng.jsp&quot;)\nWhile IE.Readystate &lt;&gt; 4 Or IE.busy: DoEvents: Wend\nmynocFromDate = InputBox(&quot;enter from date eg.2016-10-01, yyyymmdd&quot;)\nIE.document.all(&quot;nocFromDate&quot;).Value = mynocFromDate\nIE.document.getElementsByName(&quot;action&quot;).Item.Click\nDo While IE.busy: DoEvents: Loop\nworksheets(&quot;Sheet1&quot;).Range(&quot;A:Z&quot;).ClearContents\n\n'from here i need to copy data under headings Product(s)    ,Manufacturer   ,NOC with conditions    ,Notice of Compliance date  ,Medicinal ingredient(s)    and DIN(s)\n            \nEnd With\nIE.Quit\nEnd Sub\n</code></pre>\n<p>Please help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1478092293, "post_id": 40380686, "comment_id": 68013351, "body": "if ((not range1 is nothing) or (not range2 is nothing)) then"}, {"owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1478092414, "post_id": 40380686, "comment_id": 68013460, "body": "Your condition is incorrect as well. If you want to check whether any of the two objects is &quot;Nothing&quot;, then you don&#39;t need to put the &quot;Not&quot; keyword. It will check for the condition &quot;Object1 is Not Nothing&quot;  =&gt; &quot;Object1 is something&quot;."}, {"owner": {"reputation": 12074, "user_id": 5626112, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7c4f02b1ae7b6e7f262d67e428a35fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Steven G", "link": "https://stackoverflow.com/users/5626112/steven-g"}, "reply_to_user": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "edited": false, "score": 0, "creation_date": 1478092656, "post_id": 40380686, "comment_id": 68013621, "body": "@Nvj yes that was unclear, I was looking for <b>Not Nothingness</b>"}], "answers": [{"tags": [], "owner": {"reputation": 922, "user_id": 6124497, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cc7e273f4fb6461113b19f47881f18d?s=128&d=identicon&r=PG&f=1", "display_name": "nvkrj", "link": "https://stackoverflow.com/users/6124497/nvkrj"}, "is_accepted": true, "score": 2, "last_activity_date": 1478092249, "creation_date": 1478092249, "answer_id": 40380826, "question_id": 40380686, "link": "https://stackoverflow.com/questions/40380686/how-to-check-if-multiple-objects-is-not-nothing-vba-excel/40380826#40380826", "title": "How to check if multiple objects is not nothing VBA Excel", "body": "<p>You should separate the two nothing statements like this:</p>\n\n<pre><code>Dim NArange As Range, NAMERange As Range\n\nSet NArange = ActiveSheet.Range(\"A1\")\nSet NAMERange = ActiveSheet.Range(\"A2\")\n\n\nIf NArange Is Nothing Or NAMERange Is Nothing Then\n    MsgBox (\"nothing\")\nElse\n    MsgBox (\"something\")\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 3, "last_activity_date": 1478092251, "creation_date": 1478092251, "answer_id": 40380829, "question_id": 40380686, "link": "https://stackoverflow.com/questions/40380686/how-to-check-if-multiple-objects-is-not-nothing-vba-excel/40380829#40380829", "title": "How to check if multiple objects is not nothing VBA Excel", "body": "<p>You need to test against nothing first, then combine the results of those comparisons:</p>\n\n<pre><code>If NArange Is Nothing And NAMERange Is Nothing Then\n</code></pre>\n\n<p>If you try to apply operators other than <code>Is</code> to objects, it will attempt to use the default property instead (in this case <code>Value</code>). So, <code>Not NArange</code> is equivalent to <code>Not NArange.Value</code>.  If <code>NArange</code> is <code>Nothing</code> you'll get a run-time error 91 - \"Object variable or With block variable not set\".</p>\n"}], "owner": {"reputation": 12074, "user_id": 5626112, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/7c4f02b1ae7b6e7f262d67e428a35fa8?s=128&d=identicon&r=PG&f=1", "display_name": "Steven G", "link": "https://stackoverflow.com/users/5626112/steven-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 0, "accepted_answer_id": 40380826, "answer_count": 2, "score": 1, "last_activity_date": 1478092670, "creation_date": 1478091863, "last_edit_date": 1531164843, "question_id": 40380686, "link": "https://stackoverflow.com/questions/40380686/how-to-check-if-multiple-objects-is-not-nothing-vba-excel", "title": "How to check if multiple objects is not nothing VBA Excel", "body": "<p>I am trying to check for <strong>not nothingness</strong> in 2 objects and cant' find the right way to write it down.</p>\n\n<p>what I am acutally trying:</p>\n\n<pre><code>Dim NArange As Range, NAMERange As Range\nSet NArange = Rows(DateRange.Row).Find(\"#N/A\", LookIn:=xlValues, LookAt:=xlWhole)\nSet NAMERange = Rows(DateRange.Row).Find(\"#NAME?\", LookIn:=xlValues, LookAt:=xlWhole)\n\n\nIf (Not NArange Or Not NAMERange) Is Nothing Then\n    debug.print \"nothing\"\nEnd If\n</code></pre>\n\n<p>how do I write the </p>\n\n<pre><code>If (Not NArange Or Not NAMERange) Is Nothing Then\n</code></pre>\n\n<p>condition?</p>\n\n<p>thanks!</p>\n"}, {"tags": ["sql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 31907, "user_id": 1016435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aec5b5b34bc32793b277190147e60b5b?s=128&d=identicon&r=PG", "display_name": "xQbert", "link": "https://stackoverflow.com/users/1016435/xqbert"}, "edited": false, "score": 0, "creation_date": 1478092212, "post_id": 40380616, "comment_id": 68013298, "body": "I&#39;d recommend using a paramaterized query. such as defined on a <a href=\"https://msdn.microsoft.com/en-us/library/bb208916(v=office.12).aspx\" rel=\"nofollow noreferrer\">MSDN site</a>  simply adding the criteria to the where clause would work, but it&#39;s not the right approach long term.  IMO better to learn an approach that avoids SQL injection so you don&#39;t fall into bad habits now."}], "answers": [{"tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1478092075, "creation_date": 1478092075, "answer_id": 40380770, "question_id": 40380616, "link": "https://stackoverflow.com/questions/40380616/select-maximum-value-from-a-table-field-with-criteria/40380770#40380770", "title": "Select Maximum value from a table field with criteria", "body": "<p>You should add a WHERE clause to your SQL query</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Source_AfterUpdate()    \n\n    Dim rs As ADODB.Recordset, MyVal\n\n    Dim SQL as String\n\n    Set rs = New ADODB.Recordset\n\n    ' If Source field is STRING type\n    SQL = \"SELECT MAX(Voucher_Number) from tblInvoiceLog WHERE [Source]='\" &amp; Me.Source.Value &amp; \"'\"\n\n    ' If Source field is NUMBER type\n    SQL = \"SELECT MAX(Voucher_Number) from tblInvoiceLog WHERE [Source]=\" &amp; Me.Source.Value \n\n    rs.Open SQL, CurrentProject.Connection\n    rs.MoveFirst\n    MyVal = rs.Fields(0).Value\n    Me.Voucher_Number.Value = MyVal + 1\n    rs.Close\n    Set rs = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 6120983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/760e343353590f1b16441334a7b09b5d?s=128&d=identicon&r=PG&f=1", "display_name": "cenzuratu", "link": "https://stackoverflow.com/users/6120983/cenzuratu"}, "is_accepted": false, "score": 1, "last_activity_date": 1478092164, "creation_date": 1478092164, "answer_id": 40380796, "question_id": 40380616, "link": "https://stackoverflow.com/questions/40380616/select-maximum-value-from-a-table-field-with-criteria/40380796#40380796", "title": "Select Maximum value from a table field with criteria", "body": "<p>Private Sub Source_AfterUpdate()    </p>\n\n<pre><code>Dim rs As ADODB.Recordset, MyVal\nSet rs = New ADODB.Recordset\nrs.Open \"SELECT MAX(Voucher_Number) from tblInvoiceLog where source=\"&amp;me.source.value, CurrentProject.Connection\nrs.MoveFirst\nMyVal = rs.Fields(0).Value\nMe.Voucher_Number.Value = MyVal + 1\nrs.Close\nSet rs = Nothing\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 3022, "user_id": 5398127, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/72c4f99e221026a4aeb2ea8278fae858?s=128&d=identicon&r=PG&f=1", "display_name": "Stupid_Intern", "link": "https://stackoverflow.com/users/5398127/stupid-intern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2343, "favorite_count": 0, "accepted_answer_id": 40380770, "answer_count": 2, "score": 0, "last_activity_date": 1478092164, "creation_date": 1478091653, "last_edit_date": 1478091831, "question_id": 40380616, "link": "https://stackoverflow.com/questions/40380616/select-maximum-value-from-a-table-field-with-criteria", "title": "Select Maximum value from a table field with criteria", "body": "<p>This gets the maximum number from the <code>Voucher_Number</code> field of Table <code>tblInvoiceLog</code> </p>\n\n<p>I want to get the maximum number but only where the field <code>Source</code> in the same table is equal to <code>Me.Source.Value</code>  </p>\n\n<p>I am not sure how can I add this condition please advise:</p>\n\n<p>CODE:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Source_AfterUpdate()    \n\n    Dim rs As ADODB.Recordset, MyVal\n    Set rs = New ADODB.Recordset\n    rs.Open \"SELECT MAX(Voucher_Number) from tblInvoiceLog\", CurrentProject.Connection\n    rs.MoveFirst\n    MyVal = rs.Fields(0).Value\n    Me.Voucher_Number.Value = MyVal + 1\n    rs.Close\n    Set rs = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010", "ms-access-2007", "ms-access-2013"], "comments": [{"owner": {"reputation": 85, "user_id": 6305887, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8207e55563417780c3094630753d9eac?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6305887/thomas"}, "edited": false, "score": 0, "creation_date": 1478090574, "post_id": 40380234, "comment_id": 68012226, "body": "Maybe there is a way to filters the table without doing the left join?"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1478092836, "post_id": 40380234, "comment_id": 68013757, "body": "Why do you tag ms-access 2007, 2010, 2013? If that&#39;s for getting more attention this is not a good idea. Then show what you have tried. VBA code and SQL, add details. Your question is not answerable in that shape and will probably be vote-closed"}, {"owner": {"reputation": 85, "user_id": 6305887, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8207e55563417780c3094630753d9eac?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6305887/thomas"}, "reply_to_user": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1478094094, "post_id": 40380234, "comment_id": 68014653, "body": "I type this out on my phone. So I didn&#39;t post any of my examples. I will as soon as I get back to my desk. Sorry about multiple tags. I&#39;m working on access 2010"}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 6305887, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8207e55563417780c3094630753d9eac?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6305887/thomas"}, "edited": false, "score": 0, "creation_date": 1478193244, "post_id": 40407462, "comment_id": 68065180, "body": "This worked for me. Thank you minty. Another thing that worked for me was a select query. With an in(select.field from table) in the criteria."}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "reply_to_user": {"reputation": 85, "user_id": 6305887, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8207e55563417780c3094630753d9eac?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6305887/thomas"}, "edited": false, "score": 0, "creation_date": 1478193664, "post_id": 40407462, "comment_id": 68065372, "body": "I always think it is safer to have the forms specific query saved within the form rather than as a saved query.   Later on, If you ever forget the saved query is used for that form and changed it you could &quot;break&quot; the way the form works."}], "tags": [], "owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "is_accepted": true, "score": 2, "last_activity_date": 1478193026, "creation_date": 1478193026, "answer_id": 40407462, "question_id": 40380234, "link": "https://stackoverflow.com/questions/40380234/need-to-filter-table-before-using-form-to-update-ms-access/40407462#40407462", "title": "Need to filter table before using form to update. MS Access", "body": "<p>Open your form and set the forms recordsource to the table directly.</p>\n\n<p>Click on the ... next to the record source and say yes when it asks if you want to build a query based on the table.</p>\n\n<p>Build your query to filter to the records and fields your want then close the query and save. This should give you a form with only the records you want to edit.</p>\n"}], "owner": {"reputation": 85, "user_id": 6305887, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8207e55563417780c3094630753d9eac?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas", "link": "https://stackoverflow.com/users/6305887/thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 681, "favorite_count": 0, "accepted_answer_id": 40407462, "answer_count": 1, "score": 0, "last_activity_date": 1478193026, "creation_date": 1478090494, "question_id": 40380234, "link": "https://stackoverflow.com/questions/40380234/need-to-filter-table-before-using-form-to-update-ms-access", "title": "Need to filter table before using form to update. MS Access", "body": "<p>I have a form that I would like to use to update a table. </p>\n\n<p>There are 600 lines in this table.</p>\n\n<p>I have a couple of query that will return which lines i need to update. And I only want to show these lines in the update form. </p>\n\n<p>I tried doing a left join make table. Then opening that table with the form. But error I'm getting is that the table is locked. It will run fine when the form is closed.</p>\n\n<p>I wrote the macro to close the form then run the left join make table. Then open the form. </p>\n"}, {"tags": ["vba", "excel", "formatting", "copy-paste"], "comments": [{"owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "edited": false, "score": 0, "creation_date": 1478090043, "post_id": 40379947, "comment_id": 68011909, "body": "I think the answer is Auto fit the column but I don&#39;t know where to apply it."}], "answers": [{"tags": [], "owner": {"reputation": 201, "user_id": 7104146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc96571ea0cc8da0263342a8a3d02c64?s=128&d=identicon&r=PG&f=1", "display_name": "Mladen Savic", "link": "https://stackoverflow.com/users/7104146/mladen-savic"}, "is_accepted": false, "score": 0, "last_activity_date": 1478090096, "creation_date": 1478090096, "answer_id": 40380106, "question_id": 40379947, "link": "https://stackoverflow.com/questions/40379947/vba-to-paste-format-from-original-workbook-to-new-workbook/40380106#40380106", "title": "VBA to Paste format from original Workbook to new Workbook", "body": "<p>You could make an additional \"Template\" sheet in the original workbook, which would be formatted as the source sheet. Then you copy the filtered data into the template sheet and copy the template sheet as a new workbook.\nThe only issue is that if you change the formatting of your source sheet, you would have to do the same in the template sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 3194, "user_id": 4991677, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7dabe78477c4b3697c3284fb556b1eca?s=128&d=identicon&r=PG&f=1", "display_name": "FDavidov", "link": "https://stackoverflow.com/users/4991677/fdavidov"}, "is_accepted": false, "score": 0, "last_activity_date": 1478090599, "creation_date": 1478090599, "answer_id": 40380260, "question_id": 40379947, "link": "https://stackoverflow.com/questions/40379947/vba-to-paste-format-from-original-workbook-to-new-workbook/40380260#40380260", "title": "VBA to Paste format from original Workbook to new Workbook", "body": "<p>Normally, when I need s small MACRO to do something I hesitate how to implement, I use the MACRO RECORDING feature of Excel. In your case, I would start the recording, go to the source sheet, select and copy the range, go to the target sheet, click on the cell into which the PASTE should start, Paste, Stop recording.</p>\n\n<p>Then, while in developer mode, you will find the generated macro which you can update to fully comply with your needs.</p>\n\n<p>This method ALWAYS worked for me. Hope it does so for you too.</p>\n"}, {"tags": [], "owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "is_accepted": false, "score": 0, "last_activity_date": 1478091746, "creation_date": 1478091746, "answer_id": 40380649, "question_id": 40379947, "link": "https://stackoverflow.com/questions/40379947/vba-to-paste-format-from-original-workbook-to-new-workbook/40380649#40380649", "title": "VBA to Paste format from original Workbook to new Workbook", "body": "<p>I found this piece of code and plugged it in just before the save and close and its working fine </p>\n\n<pre><code>Columns(\"A:B\").Select\n\nSelection.EntireColumn.AutoFit\n</code></pre>\n\n<p>The place where it goes </p>\n\n<pre><code>.SpecialCells(xlCellTypeVisible).Copy ActiveSheet.Range(\"A1\") 'copy data for country under header\n                     Columns(\"A:Y\").Select\n                  Selection.EntireColumn.AutoFit\n                wb.Close SaveChanges:=True '&lt;--... saves and closes workbook\n</code></pre>\n"}], "owner": {"reputation": 613, "user_id": 5952998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-qfYdrblZjug/AAAAAAAAAAI/AAAAAAAADrY/e3mMjWnJhps/photo.jpg?sz=128", "display_name": "Philip Connell", "link": "https://stackoverflow.com/users/5952998/philip-connell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1139, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1478093814, "creation_date": 1478089602, "question_id": 40379947, "link": "https://stackoverflow.com/questions/40379947/vba-to-paste-format-from-original-workbook-to-new-workbook", "title": "VBA to Paste format from original Workbook to new Workbook", "body": "<p>I hope you can help. I have code below. Essentially what it does is, it opens a dialog box that allows a user to select an excel sheet, then it goes out to the country column (11) filters it, then copies and paste that country into a new workbook names the new workbook after that country then repeats the action for the next country, then it saves and closes each Workbook. </p>\n\n<p>The code works perfectly it just does not copy and paste the original format. I cant seem to be able to get the Special Paste area in the code. I have added pic below to show the difference. </p>\n\n<p>I was just wondering if my code below could be altered to keep the look and formatting of the original </p>\n\n<p>Original Format </p>\n\n<p><a href=\"https://i.stack.imgur.com/Y5w7A.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Y5w7A.png\" alt=\"enter image description here\"></a></p>\n\n<p>Pasted Format </p>\n\n<p><a href=\"https://i.stack.imgur.com/OIcvr.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OIcvr.png\" alt=\"enter image description here\"></a></p>\n\n<p>MY CODE </p>\n\n<pre><code>Sub Open_Workbook_Dialog()\n\nDim my_FileName As Variant\nDim my_Workbook As Workbook\n\n  MsgBox \"Pick your CRO file\" '&lt;--| txt box for prompt to pick a file\n\n  my_FileName = Application.GetOpenFilename(FileFilter:=\"Excel Files,*.xl*;*.xm*\") '&lt;--| Opens the file window to allow selection\n\n  If my_FileName &lt;&gt; False Then\n    Set my_Workbook = Workbooks.Open(Filename:=my_FileName)\n\n\n\n    Call Filter(my_Workbook) '&lt;--|Calls the Filter Code and executes\n\n  End If\nEnd Sub\n\nPublic Sub Filter(my_Workbook As Workbook)\n  Dim rCountry As Range, helpCol As Range\n  Dim wb As Workbook\n  With my_Workbook.Sheets(1) '&lt;--| refer to data worksheet\n    With .UsedRange\n      Set helpCol = .Resize(1, 1).Offset(, .Columns.Count) '&lt;--| get a \"helper\" column just at the right of used range, it'll be used to store unique country names in\n    End With\n\n   With .Range(\"A1:Y\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Row) '&lt;--| refer to its columns \"A:Y\" from row 1 to last non empty row of column \"A\"\n            .Columns(11).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=helpCol, Unique:=True '&lt;-- call AdvancedFilter on 11th column of the referenced range and store its unique values in \"helper\" column\n            Set helpCol = Range(helpCol.Offset(1), helpCol.End(xlDown)) '&lt;--| set range with unique names in (skip header row)\n            For Each rCountry In helpCol '&lt;--| iterate over unique country names range (skip header row)\n                .AutoFilter 11, rCountry.Value2 '&lt;--| filter data on country field (11th column) with current unique country name\n                If Application.WorksheetFunction.Subtotal(103, .Cells.Resize(, 1)) &gt; 1 Then '&lt;--| if any cell other than header ones has been filtered...\n                    Set wb = Application.Workbooks.Add '&lt;--... add new Workbook\n                        wb.SaveAs Filename:=rCountry.Value2 '&lt;--... saves the workbook after the country\n                            .SpecialCells(xlCellTypeVisible).Copy wb.Sheets(1).Range(\"A1\")\n                       ActiveSheet.Name = rCountry.Value2  '&lt;--... rename it\n                    .SpecialCells(xlCellTypeVisible).Copy ActiveSheet.Range(\"A1\") 'copy data for country under header\n                    wb.Close SaveChanges:=True '&lt;--... saves and closes workbook\n                End If\n            Next\n        End With\n        .AutoFilterMode = False '&lt;--| remove autofilter and show all rows back\n    End With\n    helpCol.Offset(-1).End(xlDown).Clear '&lt;--| clear helper column (header included)\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1, "user_id": 7104508, "user_type": "registered", "profile_image": "https://graph.facebook.com/1226459480730307/picture?type=large", "display_name": "Hamid Shabbir", "link": "https://stackoverflow.com/users/7104508/hamid-shabbir"}, "edited": false, "score": 0, "creation_date": 1478089379, "post_id": 40379859, "comment_id": 68011503, "body": "It is not copying data"}, {"owner": {"reputation": 634, "user_id": 6671476, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c4a11114810d210447b9dc60467e815?s=128&d=identicon&r=PG&f=1", "display_name": "RCaetano", "link": "https://stackoverflow.com/users/6671476/rcaetano"}, "edited": false, "score": 0, "creation_date": 1478093270, "post_id": 40379859, "comment_id": 68014084, "body": "Aren&#39;t you copying a column (<code>ws.Columns(searchedcolumn).Copy</code>) into a cell? (<code>Set searchheader = ws.Cells(1, i)</code>) And if you are not dealing the errors nothing happens I supose."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 7104508, "user_type": "registered", "profile_image": "https://graph.facebook.com/1226459480730307/picture?type=large", "display_name": "Hamid Shabbir", "link": "https://stackoverflow.com/users/7104508/hamid-shabbir"}, "is_accepted": false, "score": 0, "last_activity_date": 1478175446, "creation_date": 1478175446, "answer_id": 40401271, "question_id": 40379859, "link": "https://stackoverflow.com/questions/40379859/how-to-copy-a-column-based-on-header-from-one-workbook-to-another-in-excel-vba/40401271#40401271", "title": "How to copy a column based on header from one workbook to another in excel VBA", "body": "<p>When i use following programme withen work book, it works fine and copies the date from one sheets to another.\nSub copycolumns1()</p>\n\n<p>Dim i As Integer, searchedcolumn As Integer, searchheader As Object</p>\n\n<p>Set searchheader = Sheets(2).Cells(1, 1)</p>\n\n<p>searchedcolumn = 0\nOn Error Resume Next\n searchedcolumn = Sheets(1).Rows(1).Find(what:=searchheader.Value, lookat:=xlWhole).Column\n On Error GoTo 0</p>\n\n<p>If searchedcolumn &lt;> 0 Then\n  Sheets(1).Columns(searchedcolumn).Copy Destination:=searchheader\n End If</p>\n\n<p>End Sub</p>\n\n<p>but  i am not getting it worked for moving from one workbook to another workbook</p>\n"}], "owner": {"reputation": 1, "user_id": 7104508, "user_type": "registered", "profile_image": "https://graph.facebook.com/1226459480730307/picture?type=large", "display_name": "Hamid Shabbir", "link": "https://stackoverflow.com/users/7104508/hamid-shabbir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 430, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478175446, "creation_date": 1478089338, "last_edit_date": 1531164843, "question_id": 40379859, "link": "https://stackoverflow.com/questions/40379859/how-to-copy-a-column-based-on-header-from-one-workbook-to-another-in-excel-vba", "title": "How to copy a column based on header from one workbook to another in excel VBA", "body": "<pre><code>Sub copycolumns()\n\nDim y As Workbook\nDim x As Workbook\nDim ws As Worksheet\nDim sh As Worksheet\n\nSet x = Workbooks.Open(\"C:\\Users\\hshabbir\\Desktop\\testing.xlsx\")\nSet sh = x.Sheets(\"Sheet2\")\n\nSet y = ThisWorkbook\nSet ws = y.Sheets(\"Sheet1\")\nApplication.ScreenUpdating = 0\n\nDim i As Integer, searchedcolumn As Integer, searchheader As Object\n\nFor i = 1 To 8    \n    Set searchheader = ws.Cells(1, i)    \n    searchedcolumn = 0\n\n    On Error Resume Next\n    searchedcolumn = sh.Rows(1).Find(what:=searchheader.Value, lookat:=xlWhole).Column\n    On Error GoTo 0\n\n    If searchedcolumn &lt;&gt; 0 Then\n        ws.Columns(searchedcolumn).Copy Destination:=searchheader     \n    End If\nNext i\n\nx.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "answers": [{"comments": [{"owner": {"reputation": 3349, "user_id": 731696, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5890514f5bd9d4727fed1d7228b29aeb?s=128&d=identicon&r=PG", "display_name": "gaffcz", "link": "https://stackoverflow.com/users/731696/gaffcz"}, "edited": false, "score": 0, "creation_date": 1478093343, "post_id": 40380098, "comment_id": 68014139, "body": "Thank you very much, that&#39;s exactly what I needed!"}], "tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": true, "score": 1, "last_activity_date": 1478090084, "creation_date": 1478090084, "answer_id": 40380098, "question_id": 40379754, "link": "https://stackoverflow.com/questions/40379754/vba-intersect-filtered-rows-ctrld/40380098#40380098", "title": "VBA - InterSect, filtered rows, CTRL+D", "body": "<p>Use <code>.EntireRow.Hidden</code> to figure out if particular cell is filtered or not. Your code would look like:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n    Dim WatchRange As Range\n    Dim IntersectRange As Range\n    Set WatchRange = Range(\"B2:B65536\")\n    Set IntersectRange = Intersect(Target, WatchRange)\n\n    If IntersectRange Is Nothing Then\n        'Do Nothing\n    Else\n        For Each b In Target\n            If b.EntireRow.Hidden = False Then\n                Range(\"A\" &amp; b.Row).Value = \"*\"\n            End If\n        Next\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3349, "user_id": 731696, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/5890514f5bd9d4727fed1d7228b29aeb?s=128&d=identicon&r=PG", "display_name": "gaffcz", "link": "https://stackoverflow.com/users/731696/gaffcz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 517, "favorite_count": 0, "accepted_answer_id": 40380098, "answer_count": 1, "score": 1, "last_activity_date": 1478093801, "creation_date": 1478089004, "last_edit_date": 1478093801, "question_id": 40379754, "link": "https://stackoverflow.com/questions/40379754/vba-intersect-filtered-rows-ctrld", "title": "VBA - InterSect, filtered rows, CTRL+D", "body": "<p>I'm handling <code>Change event</code> in Excel using <code>intersect</code> like this:</p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Range)\n    Dim WatchRange As Range\n    Dim IntersectRange As Range\n    Set WatchRange = Range(\"B2:B65536\")\n    Set IntersectRange = Intersect(Target, WatchRange)\n\n    If IntersectRange Is Nothing Then\n        'Do Nothing\n    Else\n        For Each b In Target.Rows\n            Range(\"A\" &amp; b.Row).Value = \"*\"\n        Next\n    End If\nEnd Sub\n</code></pre>\n\n<p>When I change something in column <code>B</code>, it writes <code>*</code> to column <code>A</code>. And it works great. </p>\n\n<p>Problem happens when I set the filter and copy some value to filtered rows using <code>CTRL+D</code>. This is my test table: </p>\n\n<p><a href=\"https://i.stack.imgur.com/mOd0X.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mOd0X.jpg\" alt=\"enter image description here\"></a> </p>\n\n<p>Filter only <code>text</code> in column <code>C</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/RiaQh.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RiaQh.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>And copy number <code>100</code> using <code>CTRL+D</code> to all visible rows (column <code>B</code>):</p>\n\n<p><a href=\"https://i.stack.imgur.com/veD6o.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/veD6o.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>When I cancel the filter, all the rows are marked with <code>*</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/geqQv.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/geqQv.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>It wouldn't be a problem in small table, but it takes about 10sec in table with about 1000 rows.</p>\n\n<p>Is it possible to skip hiden files somehow? </p>\n"}, {"tags": ["excel", "vba", "combobox", "duplicates"], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6151904, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10101655294887830/picture?type=large", "display_name": "YS Cheung", "link": "https://stackoverflow.com/users/6151904/ys-cheung"}, "edited": false, "score": 0, "creation_date": 1478099830, "post_id": 40379794, "comment_id": 68018876, "body": "Thanks, I will start searching that direction."}], "tags": [], "owner": {"reputation": 602, "user_id": 4251486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ec38529ac8e0026ead0e432ec827b1b?s=128&d=identicon&r=PG&f=1", "display_name": "Wouter", "link": "https://stackoverflow.com/users/4251486/wouter"}, "is_accepted": true, "score": 1, "last_activity_date": 1478089143, "creation_date": 1478089143, "answer_id": 40379794, "question_id": 40379629, "link": "https://stackoverflow.com/questions/40379629/check-for-duplicate-value-among-10-combox-boxes-when-summit-excel-vba/40379794#40379794", "title": "Check for duplicate value among 10 combox boxes when summit excel vba", "body": "<p>I think your second idea is the best, because it prevents the unwanted behavior instead of correcting it. </p>\n\n<p>You can either build a responsive sql which filters out the already selected values, or you could create 10 queries, one for each combobox.</p>\n\n<p>Start by creating a table with values you want to have for your selection.</p>\n\n<p>Make a query like this: (Combobox1) <code>SELECT value FROM Table;</code>\nThis is the input query for your first combobox.</p>\n\n<p>Create a second query (Combobox2) based on the first query. <code>SELECT value FROM Query1 WHERE value &lt;&gt; Forms!formname!Combobox1</code>\nThis will be the input query for your second combobox.</p>\n\n<p>Now create a third query based on the second like: <code>SELECT value FROM Query2 WHERE value &lt;&gt; Forms!formname!Combobox2;</code> Which will be the input for your third combobox.</p>\n\n<p>Keep on doing this untill you have a query for each combobox.</p>\n"}], "owner": {"reputation": 9, "user_id": 6151904, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/10101655294887830/picture?type=large", "display_name": "YS Cheung", "link": "https://stackoverflow.com/users/6151904/ys-cheung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 40379794, "answer_count": 1, "score": -1, "last_activity_date": 1478089143, "creation_date": 1478088588, "question_id": 40379629, "link": "https://stackoverflow.com/questions/40379629/check-for-duplicate-value-among-10-combox-boxes-when-summit-excel-vba", "title": "Check for duplicate value among 10 combox boxes when summit excel vba", "body": "<p>I have 10 comboboxes on my userform that share 10 same selections, and I would like to check for duplicated value before summit.</p>\n\n<p>As far as I can imagine, there are two ways to get the result, the first one is to check for same value among these ten boxes when summit by using message box OR to hide the selections from other comboboxes once the option is being selected by any one of the boxes. </p>\n\n<p>Since I am new to vba, I am having a hard to grasp this idea in to code, please help.<a href=\"https://i.stack.imgur.com/fI4nf.jpg\" rel=\"nofollow noreferrer\">Userform with 10 comboboxes that share the same selections</a></p>\n"}, {"tags": ["vba", "excel", "printing"], "comments": [{"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1478088731, "post_id": 40379505, "comment_id": 68011142, "body": "you want to select all sheets in your workbook except one , what is this sheet name (that you don&#39;t want to print) ?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5919433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUscZ.jpg?s=128&g=1", "display_name": "invyspirit", "link": "https://stackoverflow.com/users/5919433/invyspirit"}, "edited": false, "score": 0, "creation_date": 1478094297, "post_id": 40379842, "comment_id": 68014795, "body": "Oh, please mind that sheets sometimes are deleted or moved within a workbook or outside of it. That given sheets&#39; indeces do not necessarily correlate with their order within your workbook. To check indeces of sheets that you need you can either try and fail or use the loop as following"}, {"owner": {"reputation": 33, "user_id": 5919433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUscZ.jpg?s=128&g=1", "display_name": "invyspirit", "link": "https://stackoverflow.com/users/5919433/invyspirit"}, "edited": false, "score": 0, "creation_date": 1478094322, "post_id": 40379842, "comment_id": 68014808, "body": "`dim n as integer"}], "tags": [], "owner": {"reputation": 33, "user_id": 5919433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUscZ.jpg?s=128&g=1", "display_name": "invyspirit", "link": "https://stackoverflow.com/users/5919433/invyspirit"}, "is_accepted": false, "score": 1, "last_activity_date": 1478094457, "last_edit_date": 1478094457, "creation_date": 1478089282, "answer_id": 40379842, "question_id": 40379505, "link": "https://stackoverflow.com/questions/40379505/selecting-multiple-sheets-in-vb/40379842#40379842", "title": "Selecting multiple sheets in VB", "body": "<p>You can always refer to sheets not by names, but rather by their indeces, e.g. Sheet1 in a newly created workbook has index 1, Sheet2 - index 2 and so on.</p>\n\n<p>Syntaxis as following: <code>yourWorkbook.Sheets(index as integer)</code></p>\n\n<p>So for example:</p>\n\n<pre><code>dim wbk as Workbook\nset wbk = ActiveWorkbook\n\ndim i as integer\nwbk.Sheets(i).Select\n</code></pre>\n\n<p>EDIT:\nOh, please mind that sheets sometimes are deleted or moved within a workbook or outside of it. That given sheets' indeces do not necessarily correlate with their order within your workbook. To check indeces of sheets that you need you can either try and fail or use the loop as following</p>\n\n<pre><code>dim n as integer\nfor n = 1 to wbk.Sheets.count\n    debug.print \"index \" &amp; i, wbk.Sheets(i).name\nnext n\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7104443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e891a2c517e3a408eff5b758ccbbb17b?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Rotimi", "link": "https://stackoverflow.com/users/7104443/louis-rotimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 889, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487619576, "creation_date": 1478088227, "last_edit_date": 1478088697, "question_id": 40379505, "link": "https://stackoverflow.com/questions/40379505/selecting-multiple-sheets-in-vb", "title": "Selecting multiple sheets in VB", "body": "<p>I want to select multiple sheets for printing all sheets in a book apart from one, so far my code looks like this, recorded through a macro:</p>\n\n<pre><code>Sub Print_All()\n  '\n  ' Print_All Macro\n\n    Sheets(Array(\"Class List\", \"Blank1\", \"Blank2\", \"Blank3\", \"Blank4\", \"Blank5\", \"Blank6\" _\n        , \"Blank7\", \"Blank8\", \"Blank9\", \"Blank10\", \"Blank11\", \"Blank12\", \"Blank13\", \"Blank14\", _\n        \"Blank15\", \"Blank16\", \"Blank17\", \"Blank18\", \"Blank19\", \"Blank20\", \"Blank21\", \"Blank22\" _\n        , \"Blank23\", \"Blank24\")).Select\n    Sheets(\"Blank2\").Activate\n    Sheets(Array(\"Blank25\", \"Blank26\", \"Blank27\", \"Blank28\", \"Blank29\", \"Blank30\")). _\n        Select Replace:=False\n    Sheets(Array(\"Blank1\", \"Blank2\", \"Blank3\", \"Blank4\", \"Blank5\", \"Blank6\", \"Blank7\", _\n        \"Blank8\", \"Blank9\", \"Blank10\", \"Blank11\", \"Blank12\", \"Blank13\", \"Blank14\", \"Blank15\", _\n        \"Blank16\", \"Blank17\", \"Blank18\", \"Blank19\", \"Blank20\", \"Blank21\", \"Blank22\", \"Blank23\" _\n        , \"Blank24\", \"Blank25\")).Select\n    Sheets(\"Blank2\").Activate\n    Sheets(Array(\"Blank26\", \"Blank27\", \"Blank28\", \"Blank29\", \"Blank30\")).Select _\n        Replace:=False\n    Range(\"F5:N10\").Select\n    Selection.PrintOut Copies:=1, Collate:=True\nEnd Sub\n</code></pre>\n\n<p>it works fine but the problems occur if I ever want to change the name of a sheet. It returns an error as it is looking for the blanks. \nIs there a way to select the sheets without naming them in the code?</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1478087102, "post_id": 40378815, "comment_id": 68010112, "body": "try with <code>WorksheetFunction.VLookup</code>..."}, {"owner": {"reputation": 343, "user_id": 2350469, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56e6c825c009b6cc48624e3de0cb95cd?s=128&d=identicon&r=PG", "display_name": "user138957", "link": "https://stackoverflow.com/users/2350469/user138957"}, "reply_to_user": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1478087210, "post_id": 40378815, "comment_id": 68010196, "body": "I get an error here RC[-4] .. separator"}, {"owner": {"reputation": 18134, "user_id": 2143262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pvJyO.jpg?s=128&g=1", "display_name": "Kazimierz Jawor", "link": "https://stackoverflow.com/users/2143262/kazimierz-jawor"}, "edited": false, "score": 0, "creation_date": 1478087265, "post_id": 40378815, "comment_id": 68010225, "body": "oh no, it&#39;s not so easy. you need to search a bit on how to work with <code>Worksheetfunction.function()</code>... <a href=\"http://www.exceltrick.com/formulas_macros/vlookup-in-vba/\" rel=\"nofollow noreferrer\">link</a> or <a href=\"http://www.cpearson.com/excel/callingworksheetfunctionsinvba.aspx\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 31929, "user_id": 6344363, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/V8Gz7.jpg?s=128&g=1", "display_name": "Shai Rado", "link": "https://stackoverflow.com/users/6344363/shai-rado"}, "edited": false, "score": 0, "creation_date": 1478087408, "post_id": 40378815, "comment_id": 68010314, "body": "to replace the <code>RC[-4]</code> you can use <code>ActiveCell.Column - 4</code>"}], "answers": [{"tags": [], "owner": {"reputation": 530, "user_id": 5902659, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c6ed01eb79ca1012c98545e01aaca144?s=128&d=identicon&r=PG&f=1", "display_name": "user1", "link": "https://stackoverflow.com/users/5902659/user1"}, "is_accepted": true, "score": 0, "last_activity_date": 1478088338, "creation_date": 1478088338, "answer_id": 40379547, "question_id": 40378815, "link": "https://stackoverflow.com/questions/40378815/how-to-replace-rc-formula-value-with-variable/40379547#40379547", "title": "How to Replace RC Formula Value with Variable", "body": "<pre><code>dim variable\n\nvariable = WorksheetFunction.VLOOKUP(RC[-4], 'C:\\Users\\me\\Downloads\\Ca%2f_client_vlookup\\[\" &amp; myFileNameCA &amp; \"]\" &amp; mySheetNameCA &amp; \"'!R10C1:R112C7,1,FALSE) \n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 2350469, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56e6c825c009b6cc48624e3de0cb95cd?s=128&d=identicon&r=PG", "display_name": "user138957", "link": "https://stackoverflow.com/users/2350469/user138957"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 40379547, "answer_count": 1, "score": 0, "last_activity_date": 1478088338, "creation_date": 1478086124, "question_id": 40378815, "link": "https://stackoverflow.com/questions/40378815/how-to-replace-rc-formula-value-with-variable", "title": "How to Replace RC Formula Value with Variable", "body": "<p>I have the following lookup </p>\n\n<pre><code>ActiveCell.FormulaR1C1 = _\n       \"=IFERROR(VLOOKUP(RC[-4], 'C:\\Users\\me\\Downloads\\Ca%2f_client_vlookup\\[\" &amp; myFileNameCA &amp; \"]\" &amp; mySheetNameCA &amp; \"'!R10C1:R112C7,1,FALSE),\"\"\"\")\"\n</code></pre>\n\n<p>How could I stored the value returned into variable ?</p>\n"}, {"tags": ["excel", "vba", "csv", "macros"], "answers": [{"tags": [], "owner": {"reputation": 198, "user_id": 5918249, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/22d991e733f2cd8a16e22f7a05c0d93f?s=128&d=identicon&r=PG&f=1", "display_name": "Hello World", "link": "https://stackoverflow.com/users/5918249/hello-world"}, "is_accepted": false, "score": 0, "last_activity_date": 1478088961, "creation_date": 1478088961, "answer_id": 40379741, "question_id": 40378785, "link": "https://stackoverflow.com/questions/40378785/import-multiple-text-files-to-separate-worksheets-in-existing-workbook/40379741#40379741", "title": "Import multiple text files to separate worksheets in existing workbook", "body": "<p>Add <code>Dim whst</code> with your other declarations then change the code between <code>I=1</code> and <code>ExitHandler</code>: to this (Changing xWb as necessary):</p>\n\n<pre><code>Set xWb = \"Whatever workbook you want\"\nApplication.DisplayAlerts = False 'Stop warnings when deleting existing sheet\nDo While I &lt; UBound(xFilesToOpen)\n    Set xTempWb = Workbooks.Open(xFilesToOpen(I))\n    For Each wsht In xWb.Worksheets 'Cycle sheets to find name match and delete if so\n        If wsht.Name = xTempWb.Sheets(1).Name Then\n            wsht.Delete\n        End If\n    Next wsht\n    xTempWb.Sheets(1).Move , xWb.Sheets(xWb.Sheets.Count)\n    xTempWb.Close False\n    I = I + 1 'I increment needs to go at the bottom now we are not doing the first iteration out of the loop\nLoop\nApplication.DisplayAlerts = True\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7104290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90aac3c6060a48f1da6c663ed7b5c8ec?s=128&d=identicon&r=PG&f=1", "display_name": "user7104290", "link": "https://stackoverflow.com/users/7104290/user7104290"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 407, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478088961, "creation_date": 1478086053, "question_id": 40378785, "link": "https://stackoverflow.com/questions/40378785/import-multiple-text-files-to-separate-worksheets-in-existing-workbook", "title": "Import multiple text files to separate worksheets in existing workbook", "body": "<p>The code below is creating separate spreadsheets but in new workbook when ran. What I am needing is for the files to be imported into an existing workbook or active workbook and overwritten if sheet exist already in existing workbook or active workbook.</p>\n\n<pre><code>Sub CombineCsvFiles()\n'updateby Extendoffice 20151015\n    Dim xFilesToOpen As Variant\n    Dim I As Integer\n    Dim xWb As Workbook\n    Dim xTempWb As Workbook\n    Dim xDelimiter As String\n    Dim xScreen As Boolean\n    On Error GoTo ErrHandler\n    xScreen = Application.ScreenUpdating\n    Application.ScreenUpdating = False\n    xDelimiter = \"|\"\n    xFilesToOpen = Application.GetOpenFilename(\"Text Files (*.csv), *.csv\", , \"Kutools for Excel\", , True)\n    If TypeName(xFilesToOpen) = \"Boolean\" Then\n        MsgBox \"No files were selected\", , \"Kutools for Excel\"\n        GoTo ExitHandler\n    End If\n    I = 1\n    Set xTempWb = Workbooks.Open(xFilesToOpen(I))\n    xTempWb.Sheets(1).Copy\n    Set xWb = Application.ActiveWorkbook\n    xTempWb.Close False\n    Do While I &lt; UBound(xFilesToOpen)\n        I = I + 1\n        Set xTempWb = Workbooks.Open(xFilesToOpen(I))\n        xTempWb.Sheets(1).Move , xWb.Sheets(xWb.Sheets.Count)\n    Loop\nExitHandler:\n    Application.ScreenUpdating = xScreen\n    Set xWb = Nothing\n    Set xTempWb = Nothing\n    Exit Sub\nErrHandler:\n    MsgBox Err.Description, , \"Kutools for Excel\"\n    Resume ExitHandler\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "combobox", "vba"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1478083901, "post_id": 40377967, "comment_id": 68008162, "body": "What&#39;s the point of the Dictionary here? If you&#39;re trying to create a unique list, you should only be adding them to the Dictionary, then adding all its Keys to the combobox at the end. You can either test for an existing key using the <code>.Exists</code> method of the Dictionary, or just use: <code>oDictionary(cel.value) = 0</code>"}, {"owner": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1478086604, "post_id": 40377967, "comment_id": 68009798, "body": "thanks @Rory for your response , is there any  other way than Dictionary to store unique list ..."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1478087887, "post_id": 40377967, "comment_id": 68010611, "body": "Several, but what&#39;s wrong with a Dictionary? It would seem ideally suited for what you&#39;re doing."}, {"owner": {"reputation": 14064, "user_id": 765395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xc817.png?s=128&g=1", "display_name": "Robin Mackenzie", "link": "https://stackoverflow.com/users/765395/robin-mackenzie"}, "reply_to_user": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1478093256, "post_id": 40377967, "comment_id": 68014073, "body": "Do you have duplicates in <code>B1:B30</code> where the corresponding value in column <code>A</code> is the same? Agree with @Rory that there is no need for the <code>Dictionary</code> in your code as it stands. You can add duplicate values to  from <code>cel.value</code> to <code>ComboBox2</code>. You better update the question with the purpose for the <code>Dictionary</code>."}], "owner": {"reputation": 305, "user_id": 6789922, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/ce93c7043b20cc43e4cb0b85648282ed?s=128&d=identicon&r=PG&f=1", "display_name": "speedyraz", "link": "https://stackoverflow.com/users/6789922/speedyraz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 328, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478083412, "creation_date": 1478083412, "last_edit_date": 1531164843, "question_id": 40377967, "link": "https://stackoverflow.com/questions/40377967/vba-error-this-key-is-already-associated-with-an-element-of-this-collection", "title": "vba error : this key is already associated with an element of this collection", "body": "<p>i am using two combo-box in my sheet and item list of second combo-box based on the value selected in  first combo-box  and i am using following code for that but it gives the error \"this key is already associated with an element of this collection\" on \"oDictionary.Add cel.value, 0\" line of code .</p>\n\n<pre><code>    Set secondItem = Sheet2.Range(\"b1:b30\")\n    Set oDictionary = CreateObject(\"Scripting.Dictionary\")\n    Sheet3.ComboBox2.Clear\n    With Sheet3.ComboBox2\n    For Each cel In secondItem\n    If ComboBox1.value = cel.Offset(, -1).value Then\n\n        oDictionary.Add cel.value, 0\n        ComboBox2.AddItem (cel.value)\n\n    End If\nNext cel\nEnd With\n</code></pre>\n\n<p>what is the solution of this issue .....</p>\n\n<p>thanks in advance ......   </p>\n"}, {"tags": ["sql-server", "vba", "ms-access", "ms-access-2013"], "comments": [{"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1478110947, "post_id": 40377786, "comment_id": 68025962, "body": "It depends on whether the tables are linked using a static ODBC connection or not. If they are, all you have to do is update that connection with the new server information."}], "answers": [{"comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 1, "creation_date": 1478087140, "post_id": 40378620, "comment_id": 68010139, "body": "+1, but instead of <code>DB.CreateTableDef</code> and the code block after it, I would use <code>DoCmd.TransferDatabase acLink</code> (see <a href=\"http://stackoverflow.com/a/36897853/3820271\">here</a>). It&#39;s shorter and I think it does a better job of identifying the PK in the source table."}, {"owner": {"reputation": 5714, "user_id": 1684486, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/6kb2P.jpg?s=128&g=1", "display_name": "Krish", "link": "https://stackoverflow.com/users/1684486/krish"}, "edited": false, "score": 0, "creation_date": 1478097387, "post_id": 40378620, "comment_id": 68017012, "body": "assuming only the server location has changed not the table definitions. Literally, you could just do. tdf.connect = NewConstr, TDF.RefreshLink"}], "tags": [], "owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1478089555, "last_edit_date": 1478089555, "creation_date": 1478085497, "answer_id": 40378620, "question_id": 40377786, "link": "https://stackoverflow.com/questions/40377786/how-to-change-database-for-linked-tables-in-access-mdb/40378620#40378620", "title": "How to change database for linked tables in Access MDB", "body": "<p>Yes it is possible to do with VBA but the way you'll do it really depends on how you linked the tables.</p>\n\n<p>Here are 2 example of connection strings I use for SQL server tables</p>\n\n<p>Direct connection:</p>\n\n<pre><code>Driver=SQL Server Native Client 10.0;Server=server_name;Address=server_address,1433;Network=network_name;Database=database_name;Trusted_Connection=Yes\n</code></pre>\n\n<p>DSN connection (with an entry in the ODBC control panel)</p>\n\n<pre><code>ODBC;Provider=SQLNCLI10;Server=server_name;DSN=name_of_DSN_entry_in_ODBC_control_panel;Database=database_name;Trusted_Connection=Yes\n</code></pre>\n\n<p>So the first thing to do is to determine how your tables are linked. \nYou can use this code (pay attention to the comments):</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub Check_ODBC_tables()\n    Dim tdef As TableDef\n\n    ' First loop on all tables to determine the connection strings\n\n    For Each tdef In CurrentDb.TableDefs\n\n        ' only print the constring if the database name is your old database (adapt accordingly)\n        If InStr(tdef.Connect, \"Database=old_database_name\") Then\n            Debug.Print tdef.Connect\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>Run this code (F5) and check the output in the immediate window. You'll find how the table are linked and what are the connection strings.</p>\n\n<p>You should prepare a connection string based on that, and adapt in them the database name to use your new DB.</p>\n\n<p>Once you are ready, you can adapt and run the following code that will delete the old table and recreate them with the new database names (some tweaks might be necessary), so go thought it in debug mode !</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub Change_ODBC_tables()\n\n    Dim tDef As TableDef\n    Dim tDefNew As TableDef\n\n    Dim strTable As String\n    Dim strCOnString As String\n\n    ' examples of constrings - ADAPT!!!!\n    strCOnString = \"Driver=SQL Server Native Client 10.0;Server=server_name;Address=server_address,1433;Network=network_name;Database=database_name;Trusted_Connection=Yes\"\n    strCOnString = \"ODBC;Provider=SQLNCLI10;Server=server_name;DSN=name_of_DSN_entry_in_ODBC_control_panel;Database=database_name;Trusted_Connection=Yes\"\n\n    For Each tDef In CurrentDb.TableDefs\n\n        If InStr(tDef.Connect, \"Database=old_database_name\") Then\n\n            ' We find a match, store the table name\n            strTable = tDef.Name\n\n            ' delete the linked table\n            DoCmd.DeleteObject acTable, strTable\n\n            ' recreate the linked table with new DB name\n            Set tDef2 = CurrentDB.CreateTableDef(strTable)\n            tDef2.Connect = strCOnString\n            tDef2.SourceTableName = strTable\n            tDef2.Name = strTable\n            CurrentDb.TableDefs.Append tDef2\n\n        End If\n    Next\n\n\nEnd Sub\n</code></pre>\n\n<p>If you don't fully understand the second piece of code I posted, I urge you to backup your mdb prior to run it because it will delete objects which can cause serious issues.</p>\n"}], "owner": {"reputation": 1555, "user_id": 345994, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/ICKbt.jpg?s=128&g=1", "display_name": "Marco", "link": "https://stackoverflow.com/users/345994/marco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 995, "favorite_count": 0, "accepted_answer_id": 40378620, "answer_count": 1, "score": 0, "last_activity_date": 1478089555, "creation_date": 1478082963, "last_edit_date": 1478084707, "question_id": 40377786, "link": "https://stackoverflow.com/questions/40377786/how-to-change-database-for-linked-tables-in-access-mdb", "title": "How to change database for linked tables in Access MDB", "body": "<p>I have many Access database files that contain linked tables to a SQLServer database. Now the database server has changed and I have to edit the links, possibly without recreating them.</p>\n\n<p>it's possible to do it? I use Access 2013.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 12976, "user_id": 1758762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nt89f.jpg?s=128&g=1", "display_name": "Leo Chapiro", "link": "https://stackoverflow.com/users/1758762/leo-chapiro"}, "edited": false, "score": 2, "creation_date": 1478082574, "post_id": 40377599, "comment_id": 68007331, "body": "Welcome to SO! It may be useful to see your macro, Pferd676!"}, {"owner": {"reputation": 21, "user_id": 7046707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/925360fc48892b92ecb46619ae70c1bc?s=128&d=identicon&r=PG&f=1", "display_name": "Pferd676", "link": "https://stackoverflow.com/users/7046707/pferd676"}, "reply_to_user": {"reputation": 12976, "user_id": 1758762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nt89f.jpg?s=128&g=1", "display_name": "Leo Chapiro", "link": "https://stackoverflow.com/users/1758762/leo-chapiro"}, "edited": false, "score": 0, "creation_date": 1478083280, "post_id": 40377599, "comment_id": 68007766, "body": "Be Pre warned I am an utter noob at this so my macro could be rubbish I have no idea.   ActiveCell.FormulaR1C1 = &quot;=VLOOKUP(RC[-59],ONCE!C[-49],1,0)&quot;     Range(&quot;BI2&quot;).Select     Selection.AutoFill Destination:=Range(&quot;BI2:BI208032&quot;)     Range(&quot;BI2:BI208032&quot;).Select     Selection.Copy     Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _         :=False, Transpose:=False"}], "answers": [{"comments": [{"owner": {"reputation": 12976, "user_id": 1758762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nt89f.jpg?s=128&g=1", "display_name": "Leo Chapiro", "link": "https://stackoverflow.com/users/1758762/leo-chapiro"}, "reply_to_user": {"reputation": 21, "user_id": 7046707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/925360fc48892b92ecb46619ae70c1bc?s=128&d=identicon&r=PG&f=1", "display_name": "Pferd676", "link": "https://stackoverflow.com/users/7046707/pferd676"}, "edited": false, "score": 0, "creation_date": 1478084068, "post_id": 40378123, "comment_id": 68008264, "body": "Try copy and paste :) In &quot;myValue&quot; you will get the answer of the user."}, {"owner": {"reputation": 21, "user_id": 7046707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/925360fc48892b92ecb46619ae70c1bc?s=128&d=identicon&r=PG&f=1", "display_name": "Pferd676", "link": "https://stackoverflow.com/users/7046707/pferd676"}, "edited": false, "score": 0, "creation_date": 1478084195, "post_id": 40378123, "comment_id": 68008359, "body": "much appreciated.do you know if it is possible to get the box tat the wizard uses instead?"}, {"owner": {"reputation": 12976, "user_id": 1758762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nt89f.jpg?s=128&g=1", "display_name": "Leo Chapiro", "link": "https://stackoverflow.com/users/1758762/leo-chapiro"}, "reply_to_user": {"reputation": 21, "user_id": 7046707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/925360fc48892b92ecb46619ae70c1bc?s=128&d=identicon&r=PG&f=1", "display_name": "Pferd676", "link": "https://stackoverflow.com/users/7046707/pferd676"}, "edited": false, "score": 0, "creation_date": 1478084251, "post_id": 40378123, "comment_id": 68008393, "body": "No, I don&#39;t know it."}, {"owner": {"reputation": 21, "user_id": 7046707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/925360fc48892b92ecb46619ae70c1bc?s=128&d=identicon&r=PG&f=1", "display_name": "Pferd676", "link": "https://stackoverflow.com/users/7046707/pferd676"}, "edited": false, "score": 0, "creation_date": 1478084887, "post_id": 40378123, "comment_id": 68008802, "body": "No problem. Not quite what I was looking for but a step in the right direction"}, {"owner": {"reputation": 4627, "user_id": 2572928, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TcMR5.png?s=128&g=1", "display_name": "David Rushton", "link": "https://stackoverflow.com/users/2572928/david-rushton"}, "edited": false, "score": 1, "creation_date": 1478085301, "post_id": 40378123, "comment_id": 68009027, "body": "The control you are looking for is called the <i>RefEdit</i>.  See this previous <a href=\"http://stackoverflow.com/questions/4507350/provide-a-range-selection-tool-utility-to-the-user-in-excel-vba\">question</a> for more.  Using the <i>RefEdit</i> is more complex than @duDe&#39;s approach."}], "tags": [], "owner": {"reputation": 12976, "user_id": 1758762, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Nt89f.jpg?s=128&g=1", "display_name": "Leo Chapiro", "link": "https://stackoverflow.com/users/1758762/leo-chapiro"}, "is_accepted": false, "score": 1, "last_activity_date": 1478083914, "creation_date": 1478083914, "answer_id": 40378123, "question_id": 40377599, "link": "https://stackoverflow.com/questions/40377599/excel-vba-vlookup-where-user-chooses-what-cells/40378123#40378123", "title": "Excel VBA Vlookup where user chooses what cells", "body": "<p>You can use InputBox like this:</p>\n\n<pre><code>myValue = InputBox(\"Give me some input\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/bc1J3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bc1J3.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 7046707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/925360fc48892b92ecb46619ae70c1bc?s=128&d=identicon&r=PG&f=1", "display_name": "Pferd676", "link": "https://stackoverflow.com/users/7046707/pferd676"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1478085491, "creation_date": 1478082403, "last_edit_date": 1478085491, "question_id": 40377599, "link": "https://stackoverflow.com/questions/40377599/excel-vba-vlookup-where-user-chooses-what-cells", "title": "Excel VBA Vlookup where user chooses what cells", "body": "<p>I am creating a macro to do a vlookup between 2 different sheets within the same workbook, but sometime the layout of the cells changes so I wish to be able to add a dialog box that will allow the user to select what they are looking for and what list they would like to compare against but am not sure how to do this.</p>\n\n<p>This is my code thus far:</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=VLOOKUP(RC[-59],ONCE!C[-49],1,0)\" \nRange(\"BI2\").Select \nSelection.AutoFill Destination:=Range(\"BI2:BI208032\") \nRange(\"BI2:BI208032\").Select \nSelection.Copy \nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ :=False, Transpose:=False\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["macos", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1478101173, "post_id": 40377488, "comment_id": 68019877, "body": "The code you posted apparently began life on my site. That&#39;s fine, but it no longer does what the original did (convert comments from new to old style) so to avoid confusion, you might want to change the name of the subroutine and remove the comment line below it."}], "answers": [{"tags": [], "owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "is_accepted": true, "score": 2, "last_activity_date": 1478100890, "creation_date": 1478100890, "answer_id": 40383925, "question_id": 40377488, "link": "https://stackoverflow.com/questions/40377488/extracting-all-comments-from-ppt-slide-using-vba/40383925#40383925", "title": "Extracting All Comments from PPT Slide using VBA", "body": "<p>Here's an example that will show each comment on slide 1 and under it, the number of replies to the comment, the author and text of each reply:</p>\n\n<pre><code>Sub Example()\n\n    Dim oCom As Comment\n    Dim x As Long\n\n    For Each oCom In ActivePresentation.Slides(1).Comments\n        With oCom\n            Debug.Print .Author &amp; vbCrLf &amp; vbTab &amp; .Text\n            Debug.Print .Replies.Count\n            For x = 1 To .Replies.Count\n                With .Replies(x)\n                    Debug.Print vbTab &amp; .Author &amp; vbTab &amp; .Text\n                End With\n            Next\n        End With\n    Next\n\nEnd Sub\n</code></pre>\n\n<p>This works in 2016; I'm not sure of 2013 and I know it won't work in 2010 (and earlier) because it doesn't have the ability to enter replies to comments.  Replies entered in 2016 get converted to multiple comments.</p>\n"}], "owner": {"reputation": 684, "user_id": 2024276, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Ct5OH.jpg?s=128&g=1", "display_name": "Sivaprasad Km", "link": "https://stackoverflow.com/users/2024276/sivaprasad-km"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 1, "accepted_answer_id": 40383925, "answer_count": 1, "score": 1, "last_activity_date": 1590368721, "creation_date": 1478082090, "last_edit_date": 1590368721, "question_id": 40377488, "link": "https://stackoverflow.com/questions/40377488/extracting-all-comments-from-ppt-slide-using-vba", "title": "Extracting All Comments from PPT Slide using VBA", "body": "<p>During the research I found below link, </p>\n\n<p><a href=\"https://stackoverflow.com/questions/3342902/extracting-comments-from-a-powerpoint-presentation-using-vba\">Extracting comments from a PowerPoint presentation using VBA</a></p>\n\n<p>Below is the solution provided in for thissame type of question.</p>\n\n<pre><code>Sub ConvertComments()\n''# Converts new-style comments to old\n\n    Dim oSl As Slide\n    Dim oSlides As Slides\n    Dim oCom As Comment\n    Dim oShape As Shape\n\n\n    Open \"filename.txt\" For Output As 1\n    Set oSlides = ActivePresentation.Slides\n\n    Dim myContext As String\n    For Each oSl In oSlides\n        For Each oCom In oSl.Comments\n            myContext = \"\"\n            For ShapeIndex = oCom.Parent.Shapes.Count To 1 Step -1\n                myContext = myContext &amp; oCom.Parent.Shapes(ShapeIndex).AlternativeText &amp; \" \"\n            Next\n            Write #1, oCom.Author &amp; \";\" &amp; myContext &amp; \";\" &amp; oCom.Text\n        Next oCom\n    Next oSl\n    Close 1\nEnd Sub\n</code></pre>\n\n<p>I found that this script not fetching the reply comments in the slides, Its only fetching the main comments from the slides, I also tried to update this solution to get all comments from the slide, bad luck I couldn't find the solution.</p>\n"}, {"tags": ["vba", "ms-access", "internationalization", "codepages"], "comments": [{"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1478081501, "post_id": 40376951, "comment_id": 68006661, "body": "Could <a href=\"http://stackoverflow.com/questions/7269399/declaring-a-unicode-string-in-vba-in-excel\">this answer</a> help you?"}, {"owner": {"reputation": 8942, "user_id": 4197505, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z0zSl.jpg?s=128&g=1", "display_name": "Thomas G", "link": "https://stackoverflow.com/users/4197505/thomas-g"}, "edited": false, "score": 0, "creation_date": 1478083363, "post_id": 40376951, "comment_id": 68007812, "body": "The default encoding is blackbox to me. You should use an <code>ADODB.stream</code> so you can choose the <code>charset</code>. See <a href=\"http://stackoverflow.com/questions/15906280/need-to-convert-text-files-to-unicode-from-utf8-in-vbscript\">this</a> and <a href=\"http://stackoverflow.com/questions/2524703/save-text-file-utf-8-encoded-with-vba\">that</a>"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1478083631, "post_id": 40376951, "comment_id": 68007973, "body": "Or to create a unicode file, use the <code>Scripting.FileSystemObject</code> methods: <a href=\"https://msdn.microsoft.com/en-us/library/5t9b5c0c%28v=vs.84%29.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/5t9b5c0c%28v=vs.84%29.aspx</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 0, "creation_date": 1478089228, "post_id": 40376951, "comment_id": 68011411, "body": "VBA uses ANSI. So whenever doing any interaction with the OS VBA Unicode strings are converted to ANSI."}, {"owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "edited": false, "score": 0, "creation_date": 1478092109, "post_id": 40376951, "comment_id": 68013229, "body": "@Noodles: That&#39;s also what I suspected. If you have any authorative source for this, this would make a great answer."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 1, "creation_date": 1478092719, "post_id": 40376951, "comment_id": 68013667, "body": "I don&#39;t. But VBA can only call the <code>A</code> functions. So Windows functions have two versions <code>A</code> and <code>W</code> (eg <code>GetWindowsTextA</code> and <code>GetWindowsTextW</code>). VBA always converts internal Unicode strings to ANSI strings when calling API calls. All forms are done using ANSI. You can open DLLs with notepad to see."}], "answers": [{"comments": [{"owner": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 1, "creation_date": 1478102927, "post_id": 40382243, "comment_id": 68021104, "body": "&quot;Windows-1252 is \u2026 as ANSI&quot;; reads like it is the only character encoding referred to as &quot;ANSI&quot;. Actually, any character encoding that can be set as the &quot;Language for non-Unicode programs&quot;  is referred as &quot;an&quot; ANSI encoding and the current one for the thread as &quot;the&quot; ANSI encoding."}, {"owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "reply_to_user": {"reputation": 18759, "user_id": 2226988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6fbec3a71b2e95e4a6e41478deb379?s=128&d=identicon&r=PG", "display_name": "Tom Blodget", "link": "https://stackoverflow.com/users/2226988/tom-blodget"}, "edited": false, "score": 1, "creation_date": 1478104182, "post_id": 40382243, "comment_id": 68021897, "body": "@TomBlodget - Technically correct, but unfortunately lots of English-speaking Windows users equate &quot;ANSI&quot; with &quot;Windows-1252&quot;. Given that &quot;ANSI&quot; is a vague and erroneous name it&#39;s probably best to avoid it altogether, rather than try to find a less incorrect way of using it. (There is a good discussion <a href=\"http://stackoverflow.com/q/701882/2144390\">here</a>.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6017774"}, "edited": false, "score": 0, "creation_date": 1478163775, "post_id": 40382243, "comment_id": 68045006, "body": "It seems pointless to test something well known. VB6 was designed for the ANSI Windows 9.x OSs. Therefore it only does ANSI when interacting with the OS. COM is unicode so it does Unicode when doing COM. It does unicoode internally. BUT ALL API CALLS ARE ANSI. This is well known."}], "tags": [], "owner": {"reputation": 97598, "user_id": 2144390, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6QjmY.jpg?s=128&g=1", "display_name": "Gord Thompson", "link": "https://stackoverflow.com/users/2144390/gord-thompson"}, "is_accepted": true, "score": 5, "last_activity_date": 1478104481, "last_edit_date": 1478104481, "creation_date": 1478096340, "answer_id": 40382243, "question_id": 40376951, "link": "https://stackoverflow.com/questions/40376951/which-string-encoding-do-the-vba-built-in-file-operations-use/40382243#40382243", "title": "Which string encoding do the VBA built-in file operations use?", "body": "<p>Testing indicates that the VBA <code>Print</code> command converts Unicode strings to the single-byte character set of the code page for the current Windows \"Language for non-Unicode programs\" system locale. This can be illustrated with the following code, which attempts to write the Greek word <code>\u038f\u03c0\u03b1</code>:</p>\n\n<pre class=\"lang-vbs prettyprint-override\"><code>Option Compare Database\nOption Explicit\n\nSub GreekTest()\n    Dim someString As String\n    someString = ChrW(&amp;H38F) &amp; ChrW(&amp;H3C0) &amp; ChrW(&amp;H3B1)\n    Open \"C:\\Users\\Gord\\Desktop\\someFile.txt\" For Output As #1\n    Print #1, someString\n    Close #1\nEnd Sub\n</code></pre>\n\n<p>When run with Windows set to the default locale for US English, the resulting file contains the bytes</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>3F 70 61\n</code></pre>\n\n<p>which correspond to the Windows-1252 characters <code>?pa</code>. Windows-1252 is the character set most commonly (but incorrectly) referred to as \"ANSI\".</p>\n\n<p>However, after changing the Windows \"non-Unicode\" locale setting to Greek (Greece)</p>\n\n<p><a href=\"https://i.stack.imgur.com/xFFQw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xFFQw.png\" alt=\"Greek.png\"></a></p>\n\n<p>the same VBA code writes a file containing the bytes</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>BF F0 E1\n</code></pre>\n\n<p>which correspond to the Windows-1253 (Greek) characters <code>\u038f\u03c0\u03b1</code>.</p>\n"}], "owner": {"reputation": 150063, "user_id": 87698, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/33f12c2270fa9d3627845b9f41a08f4f?s=128&d=identicon&r=PG", "display_name": "Heinzi", "link": "https://stackoverflow.com/users/87698/heinzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2481, "favorite_count": 0, "accepted_answer_id": 40382243, "answer_count": 1, "score": 3, "last_activity_date": 1478104481, "creation_date": 1478080512, "last_edit_date": 1478092337, "question_id": 40376951, "link": "https://stackoverflow.com/questions/40376951/which-string-encoding-do-the-vba-built-in-file-operations-use", "title": "Which string encoding do the VBA built-in file operations use?", "body": "<p>Example:</p>\n\n<pre><code>Open \"C:\\...\\someFile.txt\" For Output As #1\nPrint #1, someString\nClose #1\n</code></pre>\n\n<p><strong>If someString contains non-ASCII characters, how are they encoded?</strong> (UTF-8, Latin-1, some codepage depending on the Windows locale, ...)</p>\n\n<p>On my system, the code above <em>seems</em> to use Windows-1252, but since neither the documentation of the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264163.aspx\" rel=\"nofollow noreferrer\">Open statement</a> nor the documentation of the <a href=\"https://msdn.microsoft.com/en-us/library/office/gg264278.aspx\" rel=\"nofollow noreferrer\">Print # statement</a> mention string encodings, I cannot be sure whether this is some built-in default or some system setting, and I'm looking for an authorative answer.</p>\n\n<hr>\n\n<p>Note: Thanks to everyone suggesting alternatives for how to create files with specific encodings (ADODB.Stream, Scripting.FileSystemObject, etc.) - they are appreciated. This question, however, is about understanding the exact behavior of legacy code, so I am only interested in the behavior of the code quoted above.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 1, "creation_date": 1478080602, "post_id": 40376918, "comment_id": 68006078, "body": "So what have you tried?"}, {"owner": {"reputation": 861, "user_id": 2185841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5f1c8c3345afa24238a2598f7fe9d76?s=128&d=identicon&r=PG", "display_name": "Skip Intro", "link": "https://stackoverflow.com/users/2185841/skip-intro"}, "edited": false, "score": 0, "creation_date": 1478081655, "post_id": 40376918, "comment_id": 68006762, "body": "Welcome to StackOverflow. Please note, that this is not a free code-writing service, but we are eager to help fellow programmers (and aspirants) writing their own code. Please read the help topics on <a href=\"http://stackoverflow.com/help/how-to-ask\" title=\"How To\">How To Ask a Good Question</a>. Afterwards, please update your question with the VBA code you have written thus far in order to complete the task(s) you wish to achieve."}, {"owner": {"reputation": 11, "user_id": 7047119, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HEP_7tzbCwk/AAAAAAAAAAI/AAAAAAAADUY/JbZA8Aik4r8/photo.jpg?sz=128", "display_name": "Emcee", "link": "https://stackoverflow.com/users/7047119/emcee"}, "edited": false, "score": 0, "creation_date": 1478081834, "post_id": 40376918, "comment_id": 68006878, "body": "I start  with Split() but got stuck when trying to input the result array into a column"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 2, "creation_date": 1478082650, "post_id": 40376918, "comment_id": 68007379, "body": "A UDF sets the value of the cell in which it is placed.  It cannot write to other cells."}, {"owner": {"reputation": 11, "user_id": 7047119, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HEP_7tzbCwk/AAAAAAAAAAI/AAAAAAAADUY/JbZA8Aik4r8/photo.jpg?sz=128", "display_name": "Emcee", "link": "https://stackoverflow.com/users/7047119/emcee"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1478085838, "post_id": 40376918, "comment_id": 68009323, "body": "Thanks for that info @TonyDallimore. I have solve my question by go for a different approach. By adding additional arguments for the UDF, the code is now much more simple and my function works perfectly."}], "owner": {"reputation": 11, "user_id": 7047119, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HEP_7tzbCwk/AAAAAAAAAAI/AAAAAAAADUY/JbZA8Aik4r8/photo.jpg?sz=128", "display_name": "Emcee", "link": "https://stackoverflow.com/users/7047119/emcee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478080489, "creation_date": 1478080396, "last_edit_date": 1531161705, "question_id": 40376918, "link": "https://stackoverflow.com/questions/40376918/creating-a-udf-to-convert-comma-separated-string-to-rows", "title": "Creating a UDF to convert comma separated string to rows", "body": "<p>I have a column data like this:</p>\n\n<pre><code>    A\n100,100,120\n80,100,120\n20,60,120\n</code></pre>\n\n<p>I want to create a User Defined Function (using vba) to generate below result</p>\n\n<pre><code>   A\n  100\n  100\n  120\n  80\n  100\n  120\n  20\n  60\n  120\n</code></pre>\n\n<p>I know that this can be done by using \"Text to column\" feature and Paste \"Transpose\", however, due to the fact that data size of column A is still growing so I prefer using UDF for updating the whole file as once.</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 1185, "user_id": 4501301, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5b02e0e07be90e603ce8256ac98484?s=128&d=identicon&r=PG&f=1", "display_name": "tebs1200", "link": "https://stackoverflow.com/users/4501301/tebs1200"}, "edited": false, "score": 0, "creation_date": 1478079559, "post_id": 40376550, "comment_id": 68005453, "body": "As you want to actually create new rows, there&#39;s no standard excel formula you can use to achieve this. You&#39;ll need VBA"}, {"owner": {"reputation": 392, "user_id": 6854999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5c06e4724284becdc3e2e901ea35a77?s=128&d=identicon&r=PG&f=1", "display_name": "Pomul", "link": "https://stackoverflow.com/users/6854999/pomul"}, "edited": false, "score": 0, "creation_date": 1478089253, "post_id": 40376550, "comment_id": 68011432, "body": "What about replacing commas with paragraph marks in the notepad or word? Then you can fill id column more easily."}, {"owner": {"reputation": 659, "user_id": 5202456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rHy4s.jpg?s=128&g=1", "display_name": "5202456", "link": "https://stackoverflow.com/users/5202456/5202456"}, "edited": false, "score": 0, "creation_date": 1478091231, "post_id": 40376550, "comment_id": 68012664, "body": "As stated by #tebs1200 there is no formula that will do this, but I have VBA code that can, let me know if you want a copy of the code?"}], "owner": {"reputation": 871, "user_id": 2514925, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/0b3640302f881d24076f5454336e7f23?s=128&d=identicon&r=PG", "display_name": "user2514925", "link": "https://stackoverflow.com/users/2514925/user2514925"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1478079280, "creation_date": 1478079280, "last_edit_date": 1531161705, "question_id": 40376550, "link": "https://stackoverflow.com/questions/40376550/how-to-print-comma-separated-values-to-rows-in-excel-using-formula", "title": "how to print comma separated values to rows in excel using formula", "body": "<p>i have two columns where one column contains id and another column contains comma seperated value. I want to split the comma separated values to rows in excel </p>\n\n<p>For Example</p>\n\n<pre><code>id    value\n1      a1,a2,a3\n2      a1,a2\n</code></pre>\n\n<p>output </p>\n\n<pre><code>id    value\n1     a1\n1     a2\n1     a3\n2     a1\n2     a2\n</code></pre>\n\n<p>is there any formula to do this instead of vba code</p>\n"}, {"tags": ["sql", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 5231081, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-1jOGgJ1TjoA/AAAAAAAAAAI/AAAAAAAAAlw/c5LtJJs60I8/photo.jpg?sz=128", "display_name": "Biswanath Mishra", "link": "https://stackoverflow.com/users/5231081/biswanath-mishra"}, "is_accepted": false, "score": 0, "last_activity_date": 1478079325, "creation_date": 1478079325, "answer_id": 40376565, "question_id": 40376356, "link": "https://stackoverflow.com/questions/40376356/get-results-if-data-exists-in-both-tables/40376565#40376565", "title": "Get results if data exists in BOTH tables", "body": "<p>may be this would help </p>\n\n<pre><code>TEST = \"SELECT DISTINCT s.master_id, s.eventdate, s.code \" _\n    &amp; \"FROM test1 s INNER JOIN person p ON s.master_id=p.entity_id AND p.audit=1 \" _\n    &amp; \"WHERE s.audit=1 and exists (select 1 from test2 h1 where s.master_id = h1.master_id) \" _\n    &amp; \"UNION ALL SELECT DISTINCT h.master_id, h.eventdate, h.code \" _\n    &amp; \"FROM test2 h INNER JOIN person p ON h.master_id=p.entity_id AND p.audit=1 \" _\n    &amp; \"WHERE h.audit=1 and exists (select 1 from test1 s1 where s1.master_id = h.master_id)\" _\n    &amp; \"ORDER BY master_id \"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5357, "user_id": 6220377, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/Kzexv.jpg?s=128&g=1", "display_name": "Marc Guillot", "link": "https://stackoverflow.com/users/6220377/marc-guillot"}, "is_accepted": false, "score": 0, "last_activity_date": 1478079793, "last_edit_date": 1478079793, "creation_date": 1478079372, "answer_id": 40376582, "question_id": 40376356, "link": "https://stackoverflow.com/questions/40376356/get-results-if-data-exists-in-both-tables/40376582#40376582", "title": "Get results if data exists in BOTH tables", "body": "<p>Replace that SQL with this one :</p>\n\n<pre><code>SELECT P.entity_id, s.eventdate eventdate_1, s.code code_1, h.eventdate eventdate_2, h.code code_2\nFROM PERSON P\n     INNER JOIN TEST1 S ON S.master_id = P.entity_id AND S.audit = 1\n     INNER JOIN TEST2 H ON H.master_id = P.entity_id AND H.audit = 1\nWHERE P.audit = 1\nORDER BY P.entity_id\n</code></pre>\n\n<p>It shows data on Test1 and Test2 for Persons on both tables.</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 4684862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f78b3ffa9fc50b80e8835dbca244b1e5?s=128&d=identicon&r=PG&f=1", "display_name": "Radu Maftei", "link": "https://stackoverflow.com/users/4684862/radu-maftei"}, "is_accepted": false, "score": 0, "last_activity_date": 1478081121, "creation_date": 1478081121, "answer_id": 40377146, "question_id": 40376356, "link": "https://stackoverflow.com/questions/40376356/get-results-if-data-exists-in-both-tables/40377146#40377146", "title": "Get results if data exists in BOTH tables", "body": "<p>Check out the JOIN SYNTAX.</p>\n\n<p>In your case INNER JOIN displays only the person which has COMMON DATA in BOTH Tables. ( The equivalent of intersection in mathematics )</p>\n"}], "owner": {"reputation": 191, "user_id": 6068211, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/zVH0c.jpg?s=128&g=1", "display_name": "BradleyS", "link": "https://stackoverflow.com/users/6068211/bradleys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1478081121, "creation_date": 1478078701, "last_edit_date": 1531164843, "question_id": 40376356, "link": "https://stackoverflow.com/questions/40376356/get-results-if-data-exists-in-both-tables", "title": "Get results if data exists in BOTH tables", "body": "<p>I have an SQL search written in VBA (Excel) that works and finds test data from  table(test1) OR table(test2)</p>\n\n<p>However is it possible to write it so that it reports back only if the person has data in BOTH tables, i.e. data from table(test1) <strong>AND</strong> table(test2)</p>\n\n<p>here is my current search that only works as OR:</p>\n\n<pre><code>Worksheets.ADD(After:=Worksheets(Worksheets.Count)).Name = \"TEST\"\nSheets(\"TEST\").Select\nRange(\"A1\").Select\n\nDim TEST As String\n    TEST = \"SELECT DISTINCT s.master_id, s.eventdate, s.code \" _\n        &amp; \"FROM test1 s INNER JOIN person p ON s.master_id=p.entity_id AND p.audit=1 \" _\n        &amp; \"WHERE s.audit=1  \" _\n        &amp; \"UNION ALL SELECT DISTINCT h.master_id, h.eventdate, h.code \" _\n        &amp; \"FROM test2 h INNER JOIN person p ON h.master_id=p.entity_id AND p.audit=1 \" _\n        &amp; \"WHERE h.audit=1 \" _\n        &amp; \"ORDER BY master_id \"\n\nSet rs = conn.Execute(TEST)\nWith ActiveSheet.QueryTables.ADD(Connection:=rs, Destination:=Range(\"A1\"))\n    .Refresh\nEnd With\n\nrs.Close\nSet rs = Nothing\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1325, "user_id": 6139818, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zV0XZ.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/6139818/tom"}, "edited": false, "score": 1, "creation_date": 1478079561, "post_id": 40376327, "comment_id": 68005454, "body": "Is this your code? Are you getting any error?"}, {"owner": {"reputation": 1, "user_id": 7103510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1584600224899596/picture?type=large", "display_name": "Faisal Mirxa", "link": "https://stackoverflow.com/users/7103510/faisal-mirxa"}, "reply_to_user": {"reputation": 1325, "user_id": 6139818, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zV0XZ.png?s=128&g=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/6139818/tom"}, "edited": false, "score": 0, "creation_date": 1478083206, "post_id": 40376327, "comment_id": 68007728, "body": "single sheet (name as 2nd-Party) to Main Sheet work perfect. now i want work from multiple sheets to Main Sheet"}], "answers": [{"tags": [], "owner": {"reputation": 98, "user_id": 6192281, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f573a80b8dba72de5f7bc6ebb6377c5?s=128&d=identicon&r=PG&f=1", "display_name": "Cudny", "link": "https://stackoverflow.com/users/6192281/cudny"}, "is_accepted": false, "score": 0, "last_activity_date": 1478089265, "creation_date": 1478089265, "answer_id": 40379829, "question_id": 40376327, "link": "https://stackoverflow.com/questions/40376327/how-copy-selected-rows-data-from-multiple-sheets-to-main-sheet/40379829#40379829", "title": "How Copy selected Rows data from multiple sheets to Main sheet", "body": "<p>Macro will loop from sheet 2 to sheet 4. You can easily change that in: sheetNr = 2 To 4. </p>\n\n<pre><code>For sheetNr = 2 To 4\n    For Each chkbx In ActiveSheet.CheckBoxes\n        If chkbx.Value = 1 Then\n            For r = 1 To Rows.Count\n                If Cells(r, 1).Top = chkbx.Top Then\n                    With Worksheets(\"Main\")\n                        LRow = .Range(\"C\" &amp; Rows.Count).End(xlUp).Row + 1\n                        .Range(\"C\" &amp; LRow &amp; \":J\" &amp; LRow) = _\n                        Worksheets(sheetNr).Range(\"C\" &amp; r &amp; \":J\" &amp; r).Value\n                        Worksheets(sheetNr).Range(\"C\" &amp; r &amp; \":J\" &amp; r).Interior.ColorIndex = 37\n                    End With\n                    Exit For\n                End If\n            Next r\n        End If\n    Next\nNext sheetNr\n</code></pre>\n\n<p>If you prefer using names of the sheets you can define an array containing names of your sheets and then using for loop grab these names</p>\n\n<p>SheetName = Array(\"1st-Party\", \"2nd-Party\", \"3rd-Party\")</p>\n\n<pre><code>For i = 0 to 2\n...\nWorksheets(SheetName(i)).Range(\"C\" &amp; r &amp; \":J\" &amp; r).Value\n...\nnext i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7103510, "user_type": "registered", "profile_image": "https://graph.facebook.com/1584600224899596/picture?type=large", "display_name": "Faisal Mirxa", "link": "https://stackoverflow.com/users/7103510/faisal-mirxa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478089265, "creation_date": 1478078610, "last_edit_date": 1531164843, "question_id": 40376327, "link": "https://stackoverflow.com/questions/40376327/how-copy-selected-rows-data-from-multiple-sheets-to-main-sheet", "title": "How Copy selected Rows data from multiple sheets to Main sheet", "body": "<p><a href=\"https://i.stack.imgur.com/KM4b4.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KM4b4.jpg\" alt=\"Image\"></a></p>\n\n<p>I want copy rows data from different sheets to single (MAIN) sheet.\nKindly Help</p>\n\n<pre><code>For Each chkbx In ActiveSheet.CheckBoxes\n    If chkbx.Value = 1 Then\n        For r = 1 To Rows.Count\n            If Cells(r, 1).Top = chkbx.Top Then\n                With Worksheets(\"Main\")\n                    LRow = .Range(\"C\" &amp; Rows.Count).End(xlUp).Row + 1\n                    .Range(\"C\" &amp; LRow &amp; \":J\" &amp; LRow) = _\n                    Worksheets(\"2nd-Party\").Range(\"C\" &amp; r &amp; \":J\" &amp; r).Value\n                    Worksheets(\"2nd-Party\").Range(\"C\" &amp; r &amp; \":J\" &amp; r).Interior.ColorIndex = 37\n                End With\n                Exit For\n            End If\n        Next r\n    End If\nNext\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1478078563, "post_id": 40376199, "comment_id": 68004887, "body": "Yes, refer to this: <a href=\"http://stackoverflow.com/questions/16943003/vba-to-copy-a-file-from-one-directory-to-another\">VBA to copy a file from one directory to another</a>. Try to search in <a href=\"https://stackoverflow.com\">Stack Overflow</a>, check <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and provide <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> before you post question."}], "answers": [{"tags": [], "owner": {"reputation": 4621, "user_id": 4709298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/fe41ea7cc395df33b3ad744599248d80?s=128&d=identicon&r=PG&f=1", "display_name": "Preston", "link": "https://stackoverflow.com/users/4709298/preston"}, "is_accepted": false, "score": 0, "last_activity_date": 1478079414, "creation_date": 1478079414, "answer_id": 40376588, "question_id": 40376199, "link": "https://stackoverflow.com/questions/40376199/copy-file-from-folder-based-on-string-in-name/40376588#40376588", "title": "Copy file from folder based on string in name", "body": "<p>To build on Alex's answer, and to confirm what you suspected already, you need to loop through all the files in the originating directory using the Dir command (this tutorial is a bit more readable than the msdn one: <a href=\"https://www.techonthenet.com/excel/formulas/dir.php\" rel=\"nofollow noreferrer\">https://www.techonthenet.com/excel/formulas/dir.php</a>)</p>\n\n<p>then decide whether to move the file based on a rule (see here for string manipulation: <a href=\"http://www.excel-easy.com/vba/string-manipulation.html\" rel=\"nofollow noreferrer\">http://www.excel-easy.com/vba/string-manipulation.html</a>)</p>\n\n<p>Finally, if the conditions are fulfilled, use the .copyfile command that Alex suggests in the comments.  </p>\n"}], "owner": {"reputation": 37, "user_id": 6899239, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c06f3301ce84c9dd603ba93e386ccdee?s=128&d=identicon&r=PG&f=1", "display_name": "La82", "link": "https://stackoverflow.com/users/6899239/la82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478079414, "creation_date": 1478078146, "question_id": 40376199, "link": "https://stackoverflow.com/questions/40376199/copy-file-from-folder-based-on-string-in-name", "title": "Copy file from folder based on string in name", "body": "<p>I have just started vorking with vba, and am slowly getting the hang of it. \nI have a question as to the posibility of something:</p>\n\n<p>I have an Excel sheet where I have part of the names of a lot of text datasheets I need to copy. </p>\n\n<p>My folder destination is the following:\nSame folder/Name from column F/Name from column B/text files with the string x in the name...</p>\n\n<p>Is it at all possible to copy files like this from one folder to another?</p>\n\n<p>I am thinking a for loop and a bunch of if statements?</p>\n\n<p>Best Regards</p>\n\n<p>Lonnie  </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 598, "user_id": 6012182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57576491c6f18b541bb3676cbcba3259?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 M", "link": "https://stackoverflow.com/users/6012182/micha%c5%82-m"}, "edited": false, "score": 0, "creation_date": 1478078800, "post_id": 40376332, "comment_id": 68005028, "body": "Damn... my rookie mistake. Works as charm. Thanks1"}], "tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": true, "score": 1, "last_activity_date": 1478078637, "creation_date": 1478078637, "answer_id": 40376332, "question_id": 40376094, "link": "https://stackoverflow.com/questions/40376094/excel-vba-find-date-in-column/40376332#40376332", "title": "Excel, VBA find date in column", "body": "<p>The <code>For</code> loop does not work that way. If t = 10, and you have <code>For i = t To 0</code>, loop will not iterate even once, because 10 > 0. As far as I have understood your request, you want to make <code>i</code> to go bacward. Try the same with <code>Do While</code> loop:</p>\n\n<pre><code>i = t\nDo while i &gt; 0\n    If IsDate(Cells(i, colc).Value) = True Then\n        date= Cells(i, colc).Value\n    Else\n        rowc = rowc - 1\n    End If\n    i = i - 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 598, "user_id": 6012182, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/57576491c6f18b541bb3676cbcba3259?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 M", "link": "https://stackoverflow.com/users/6012182/micha%c5%82-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 667, "favorite_count": 0, "accepted_answer_id": 40376332, "answer_count": 1, "score": 0, "last_activity_date": 1478078637, "creation_date": 1478077791, "last_edit_date": 1478078100, "question_id": 40376094, "link": "https://stackoverflow.com/questions/40376094/excel-vba-find-date-in-column", "title": "Excel, VBA find date in column", "body": "<p>I have calendar in excel like this:\n<a href=\"https://i.stack.imgur.com/3SylV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3SylV.png\" alt=\"enter image description here\"></a></p>\n\n<p>What i'm trying to do. I want to write a macro that after mark cell and press button, Macro get string (here: user1), then back 1 column to get time and go up to get date (in this case 3). BUT\nI've already got user1 and date, but I can not get the date</p>\n\n<p>Here's a code</p>\n\n<pre><code>Dim cell As Object\nDim client As String\nDim date As Date\nDim hour As Date\nDim rowc As Long\nDim colc As Long\n    For Each cell In Selection\n       client = cell.Value\n       colc = ActiveCell.Column\n       rowc = ActiveCell.Row\n    Next cell\n\n    hour = Cells(rowc, colc - 1).Value\nCells(4, 17).Value = hour 'works to this point\n\n    t = rowc\n    colc = colc-1 \n    For i = t To 0\n\n    If IsDate(Cells(i, colc).Value) = True Then\n\n     date= Cells(i, colc).Value\n\n    Else\n    rowc = rowc - 1\n    End If\n    Next i\n\n\n\n 'Cells(3, 17).Value = date\n Cells(5, 17).Value = client\n</code></pre>\n\n<p>Explanation of line : colc = colc-1 - Every date (31, 1, 2...) it is a 2 cells merged together. If user1 cell address is f.e. 8,14 so 3-11-2016 cell column is not 8 but 7. </p>\n\n<p>Any suggestions?  </p>\n\n<p>EDIT:</p>\n\n<p>It seems that this loop does not even loops. When i change true for false, msgbox did not appear.</p>\n"}, {"tags": ["python", "excel", "vba", "postgresql", "csv"], "comments": [{"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1478077818, "post_id": 40376049, "comment_id": 68004439, "body": "csv files don&#39;t have mulitple sheets. You would have to create 1 file per xlsx sheet."}, {"owner": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1478077869, "post_id": 40376049, "comment_id": 68004459, "body": "I am aware of that"}, {"owner": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 1, "creation_date": 1478077991, "post_id": 40376049, "comment_id": 68004526, "body": "I could help you converting a xlsx in a list of csv in python. but your question is really too broad."}, {"owner": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "reply_to_user": {"reputation": 126278, "user_id": 6451573, "user_type": "moderator", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/4xczZ.jpg?s=128&g=1", "display_name": "Jean-Fran&#231;ois Fabre", "link": "https://stackoverflow.com/users/6451573/jean-fran%c3%a7ois-fabre"}, "edited": false, "score": 0, "creation_date": 1478078462, "post_id": 40376049, "comment_id": 68004824, "body": "That would be too nice of you, just with the knowledge that it can be done that way is enough. I&#39;d post an answer with the code I developed if I follow this option in the end.  Also, I also think that the scope of the question may be too broad too, but this programmers community is the best in terms of expertise and helpfulness, while also being quick to give an answer. Thus I was hoping someone as helpful as you would save me countless minutes/hours of researching and offer me a general direction (which is what I needed).  The problem would finally be solved from start to end. Great, huh?"}], "answers": [{"comments": [{"owner": {"reputation": 8279, "user_id": 5309300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63d02949d5e7330b5db7c59283041d86?s=128&d=identicon&r=PG&f=1", "display_name": "asongtoruin", "link": "https://stackoverflow.com/users/5309300/asongtoruin"}, "edited": false, "score": 1, "creation_date": 1478080608, "post_id": 40376854, "comment_id": 68006080, "body": "This won&#39;t work - it&#39;ll just save the currently active sheet multiple times under different names. Moreover, it doesn&#39;t deal with the issue of getting the <code>.csv</code> files into the database."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 8279, "user_id": 5309300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63d02949d5e7330b5db7c59283041d86?s=128&d=identicon&r=PG&f=1", "display_name": "asongtoruin", "link": "https://stackoverflow.com/users/5309300/asongtoruin"}, "edited": false, "score": 0, "creation_date": 1478080907, "post_id": 40376854, "comment_id": 68006285, "body": "True, I forgot to activate the sheet through the loop. Now we should get a different csv file per sheet. From there, it is another question how it would go to the DB."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 8279, "user_id": 5309300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63d02949d5e7330b5db7c59283041d86?s=128&d=identicon&r=PG&f=1", "display_name": "asongtoruin", "link": "https://stackoverflow.com/users/5309300/asongtoruin"}, "edited": false, "score": 0, "creation_date": 1478080972, "post_id": 40376854, "comment_id": 68006330, "body": "Thanks, @Feillen :)"}, {"owner": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "edited": false, "score": 0, "creation_date": 1478081106, "post_id": 40376854, "comment_id": 68006426, "body": "This looks gorgeous! Thank you both for the input. I will deal with the DB-import separately but this is a <b>great</b> step forward :)"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "edited": false, "score": 0, "creation_date": 1478083183, "post_id": 40376854, "comment_id": 68007711, "body": "@Feillen, just make sure that you make a save, before using the code. Because it would change the names of the Excel tabs. Read more here:<a href=\"http://windowssecrets.com/forums/showthread.php/33489-Sheet-name-changes-when-saved-in-CSV-format-(XL2000)\" rel=\"nofollow noreferrer\">windowssecrets.com/forums/showthread.php/&hellip;</a>"}, {"owner": {"reputation": 8279, "user_id": 5309300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63d02949d5e7330b5db7c59283041d86?s=128&d=identicon&r=PG&f=1", "display_name": "asongtoruin", "link": "https://stackoverflow.com/users/5309300/asongtoruin"}, "edited": false, "score": 0, "creation_date": 1478083852, "post_id": 40376854, "comment_id": 68008128, "body": "@Vityata one easy way to get around this is to <code>Copy</code> each sheet in turn - when you don&#39;t specify an output location it copies to a new workbook. This workbook then becomes the <code>ActiveWorkbook</code>, thus you can save it as a csv and then close it without affecting the original file."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 8279, "user_id": 5309300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/63d02949d5e7330b5db7c59283041d86?s=128&d=identicon&r=PG&f=1", "display_name": "asongtoruin", "link": "https://stackoverflow.com/users/5309300/asongtoruin"}, "edited": false, "score": 0, "creation_date": 1478083972, "post_id": 40376854, "comment_id": 68008203, "body": "@asongtoruin, true, but I was a little just scared, because I tried the code in a wb, which I used for something else. Thus, a take away note for me for SO - always test code in a new wb :)"}, {"owner": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "edited": false, "score": 0, "creation_date": 1478084606, "post_id": 40376854, "comment_id": 68008619, "body": "@Vityata a different work around would be to keep the sheet&#39;s name as the name of the file to be exported, <code>Filename:=ThisWorkbook.Path &amp; &quot;\\&quot; &amp; ws.Name &amp; &quot;.csv&quot;</code>, <i>heh</i>"}, {"owner": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "edited": false, "score": 0, "creation_date": 1478087919, "post_id": 40376854, "comment_id": 68010636, "body": "@Vityata : I have edited the answer inlcluding the final piece of code I have adopted, could you give it a look and point out any errors it could produce? I don&#39;t really know any VBA so... :D"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "edited": false, "score": 0, "creation_date": 1478088640, "post_id": 40376854, "comment_id": 68011090, "body": "@Feillen Which answer?"}, {"owner": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "edited": false, "score": 0, "creation_date": 1478091564, "post_id": 40376854, "comment_id": 68012865, "body": "@Vityata I think that due to my low influence it requires someone&#39;s approval, and only I am able to preview it for now. Anyway, you can view it <a href=\"https://s22.postimg.org/o96eygnj5/Untitled.png\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "edited": false, "score": 0, "creation_date": 1478098910, "post_id": 40376854, "comment_id": 68018148, "body": "@Vityata I totally forgot about pastebin, sorry. <a href=\"http://pastebin.com/WBkN6t5b\" rel=\"nofollow noreferrer\">Here you go</a>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "edited": false, "score": 0, "creation_date": 1478100329, "post_id": 40376854, "comment_id": 68019248, "body": "@Feillen, this is what I came up with. <a href=\"http://pastebin.com/wG7xmWrh\" rel=\"nofollow noreferrer\">pastebin.com/wG7xmWrh</a> I don&#39;t know why you need to close the application with application.quit, but it is probably ok. In the header of the code I have written what I have done. Cheers :)"}, {"owner": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "edited": false, "score": 0, "creation_date": 1478101073, "post_id": 40376854, "comment_id": 68019807, "body": "I don&#39;t really understand the need for all that code but thanks a lot @Vityata after giving it a thought I don&#39;t really need to use <code>Application.Quit</code>since I will be doing it <i>from outside</i> anyways. My objective is to call this macro without opening the excel file, what I plan on achieving using <a href=\"http://stackoverflow.com/questions/2050505/way-to-run-excel-macros-from-command-line-or-batch-file\">this</a>, where <i>MyWorkbook.xls</i> is actually <i>MyWorkbook.xlsm</i> and <i>MyMacro</i> is <i>MyWorkbook!MyMacro</i> if I am not mistaken"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "edited": false, "score": 0, "creation_date": 1478101179, "post_id": 40376854, "comment_id": 68019885, "body": "@Feillen, the error handlers are just a good practise in VBA and the OnStart and OnEnd are something that I usually use. I have added it, because I noticed that you used   <code>Application.DisplayAlerts = False</code>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1478083237, "last_edit_date": 1478083237, "creation_date": 1478080235, "answer_id": 40376854, "question_id": 40376049, "link": "https://stackoverflow.com/questions/40376049/exporting-whole-excel-file-as-csv/40376854#40376854", "title": "Exporting whole Excel file as CSV", "body": "<p>So, with VBA you may do the following:</p>\n\n<ul>\n<li>Loop through each sheet in the Excel application.  </li>\n<li>Save it as a CSV\nfile.</li>\n</ul>\n\n<p>Something like this would do the work:</p>\n\n<pre><code>Sub vba_code_to_convert_excel_to_csv()\n\n    Dim ws                  As Worksheet\n    Dim l_counter           As Long\n\n    For Each ws In ThisWorkbook.Sheets\n        l_counter = l_counter + 1\n        ws.Activate\n        ThisWorkbook.SaveAs Filename:=ThisWorkbook.Path &amp; \"\\new_file\" &amp; l_counter &amp; \".csv\", FileFormat:=xlCSV, CreateBackup:=False\n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>Important Edit:</p>\n\n<p>Make sure that you make a save, before using the code. Because it would change the names of the Excel tabs. Read more here:<a href=\"http://windowssecrets.com/forums/showthread.php/33489-Sheet-name-changes-when-saved-in-CSV-format-(XL2000)\" rel=\"nofollow noreferrer\">http://windowssecrets.com/forums/showthread.php/33489-Sheet-name-changes-when-saved-in-CSV-format-(XL2000)</a></p>\n"}], "owner": {"reputation": 81, "user_id": 5664429, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/v3e8G.jpg?s=128&g=1", "display_name": "Feillen", "link": "https://stackoverflow.com/users/5664429/feillen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 40376854, "answer_count": 1, "score": 1, "last_activity_date": 1478083237, "creation_date": 1478077678, "question_id": 40376049, "link": "https://stackoverflow.com/questions/40376049/exporting-whole-excel-file-as-csv", "title": "Exporting whole Excel file as CSV", "body": "<p>in my scenario, there are some excel files (each of them with possibly more than one sheet) that I will be updating frequently and which contents are to be imported into a <em>PostgreSQL</em> database almost as frequently. This db manager does not work directly with <code>.xlsx</code> files, so I would need to export my <code>.xlsx</code> as <code>.csv</code> first and then import the <code>.csv</code> into the database. </p>\n\n<p>I have looked into different questions on the topic but I don't think any of them really solves my problem. I am not looking for a plain piece of code that could solve this situation (although that would be great) but a general direction as to how to approach the solution (VBA, Java/C#/Python program, <code>.bat</code> executable...).</p>\n\n<p>Any help will be more than welcome.</p>\n\n<p>Side-notes: </p>\n\n<ol>\n<li>it has not been my decision to use PostgreSQL as DBM, I know there are other DBMs that work well with excel files.</li>\n<li>I have not learned VBA yet but I could very well use this as an excuse to start doing so if needed.</li>\n<li>I am aware of the existence of <a href=\"https://wiki.postgresql.org/wiki/Foreign_data_wrappers\" rel=\"nofollow noreferrer\">FDW</a> but I have not found any for <code>.xlsx</code> (which is quite the surprise knowing how extended the use of Excel is). Writing one for the <code>.xlsx</code> file format would be an option but I would really like to avoid this since I may be a bit short in time and I am guessing that it will require much of it.</li>\n</ol>\n"}, {"tags": ["mysql", "vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 4684862, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f78b3ffa9fc50b80e8835dbca244b1e5?s=128&d=identicon&r=PG&f=1", "display_name": "Radu Maftei", "link": "https://stackoverflow.com/users/4684862/radu-maftei"}, "is_accepted": true, "score": 0, "last_activity_date": 1478079134, "creation_date": 1478079134, "answer_id": 40376494, "question_id": 40376008, "link": "https://stackoverflow.com/questions/40376008/what-causes-vba-application-with-backend-mysql-timing-out/40376494#40376494", "title": "What causes vba application with backend MYSQL timing out", "body": "<p>There are different types of isolation levels that exist in MySQL for your transactions : Read-Commited , Read-Uncommited , Deadlocks and so on.Probably there are 2 queries which have the isolation level that only if they are commited to run and they are blocking eachother going into a deadlock, maybe you have some queries which didn't ran in time and are still waiting to be commited, check your isolation levels. (Just a sugestion)</p>\n"}], "owner": {"reputation": 164, "user_id": 6100889, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d668560e423af459bd8d8e701ac1cb72?s=128&d=identicon&r=PG&f=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/6100889/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 40376494, "answer_count": 1, "score": 0, "last_activity_date": 1478079134, "creation_date": 1478077523, "question_id": 40376008, "link": "https://stackoverflow.com/questions/40376008/what-causes-vba-application-with-backend-mysql-timing-out", "title": "What causes vba application with backend MYSQL timing out", "body": "<p>I have a front end database running on top of excel 2010 built on vba and using a back-end MYSQL database and this have been working fine since but just yesterday it started throwing errors like<a href=\"https://i.stack.imgur.com/oif6Q.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oif6Q.jpg\" alt=\"error message \"></a></p>\n\n<p>any one with idea what might be causing this please help.I have tried all the possibilities running the queries again but no change</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 0, "creation_date": 1478077623, "post_id": 40375642, "comment_id": 68004345, "body": "You mean in UserForm, or in some range in spreadsheet, or what?"}, {"owner": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "reply_to_user": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 0, "creation_date": 1478079992, "post_id": 40375642, "comment_id": 68005685, "body": "Yes I mean in UserForm . coz I can&#39;t see all data in a MsgBox"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "edited": false, "score": 0, "creation_date": 1478080290, "post_id": 40375642, "comment_id": 68005872, "body": "You are not using j looping variable: either you get rid of its loop or you use it!"}, {"owner": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "edited": false, "score": 0, "creation_date": 1478080657, "post_id": 40375642, "comment_id": 68006121, "body": "I use j looping ,and I puted it equal to 1 coz I want data of column  1 and 3. The probleme is that when I  click on the button , I get data that I want in a MsgBox , but I can&#39;t see all my data , and I have to click on OK several times to show data one by one and that disturb me . So I need to see all data in a Table or something like that . Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "edited": false, "score": 0, "creation_date": 1478083726, "post_id": 40377226, "comment_id": 68008033, "body": "Thank you for your advise , I know how to create a UserForm and put a ListBox in, but I don&#39;t know how to do to get data when I click on my button"}, {"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "reply_to_user": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "edited": false, "score": 0, "creation_date": 1478084148, "post_id": 40377226, "comment_id": 68008327, "body": "If you mean assigning macro to button, than see: <a href=\"http://stackoverflow.com/questions/10623704/how-can-i-tie-a-vba-macro-to-a-button-in-excel\" title=\"how can i tie a vba macro to a button in excel\">stackoverflow.com/questions/10623704/&hellip;</a> . If not, thats another question for another topic. Please create one, describe your concerns, somebody will help."}, {"owner": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "edited": false, "score": 0, "creation_date": 1478091857, "post_id": 40377226, "comment_id": 68013039, "body": "It works know. but there&#39;s another problem haha, I get my data but they repeted 4 times and I don&#39;t know why :/"}, {"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "reply_to_user": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "edited": false, "score": 0, "creation_date": 1478092160, "post_id": 40377226, "comment_id": 68013268, "body": "I have no idea. Create another thread with screens, code and step-by-step description of a problem, please."}], "tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": true, "score": 0, "last_activity_date": 1478081328, "creation_date": 1478081328, "answer_id": 40377226, "question_id": 40375642, "link": "https://stackoverflow.com/questions/40375642/how-to-show-selected-data-in-a-userform-using-excel-vba/40377226#40377226", "title": "how to show selected data in a userform using excel VBA", "body": "<p>What you need is ListBox. Create UserForm (e.g. Userform1) and listbox inside of it (e.g. Listbox1). Then you can put the data inside by this formula <code>.AddItem</code> function. Your loop will look like:</p>\n\n<pre><code>For i = 1 To table1Rows\n    For j = 1 To table1Cols\n        If table1(i, 1).Value &lt;&gt; table2(i, 1).Value Then\n            UserForm1.ListBox1.AddItem \"Libell\u00e9 : \" &amp; table1(i, 1) &amp; \", du montant : \" &amp; table1(i, 3) &amp; \" est ajout\u00e9 !\"\n        End If\n    Next\nNext\nEnd Sub\nUserForm1.Show\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7080084, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ce54be0417895d3b0450130f172df72?s=128&d=identicon&r=PG&f=1", "display_name": "Yassine", "link": "https://stackoverflow.com/users/7080084/yassine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1109, "favorite_count": 0, "accepted_answer_id": 40377226, "answer_count": 1, "score": -2, "last_activity_date": 1478081328, "creation_date": 1478076390, "last_edit_date": 1531164843, "question_id": 40375642, "link": "https://stackoverflow.com/questions/40375642/how-to-show-selected-data-in-a-userform-using-excel-vba", "title": "how to show selected data in a userform using excel VBA", "body": "<p>I have a code that he selected data that I want ,but I want to show this data in a table and not ina MsgBox.</p>\n\n<p>This is my code and I hope that someone can find a solution for me </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\n\nDim table1 As Range\nDim table2 As Range\n\nDim table1Rows As Integer\nDim table1Cols As Integer\n\nSet ws1 = Worksheets(\"Feuil1\")\nSet ws2 = Worksheets(\"Feuil2\")\nSet table1 = ws1.Cells\nSet table2 = ws2.Cells\n\ntable1Rows = ws1.UsedRange.Rows.Count\ntable1Cols = ws1.UsedRange.Columns.Count\n\nFor i = 1 To table1Rows\n    For j = 1 To table1Cols\n        If table1(i, 1).Value &lt;&gt; table2(i, 1).Value Then\n            MsgBox \"Libell\u00e9 : \" &amp; table1(i, 1) &amp; \", du montant : \" &amp; table1(i, 3) &amp; \" est ajout\u00e9 !\"\n        End If\n    Next\nNext\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 1, "creation_date": 1478074842, "post_id": 40375232, "comment_id": 68003033, "body": "Have you saved it with &quot;.xlsm&quot; or &quot;.xlsb&quot; expansion?"}, {"owner": {"reputation": 347, "user_id": 6821306, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b7e4a451b55661dfb4d60da8c1b702a1?s=128&d=identicon&r=PG&f=1", "display_name": "Testtest11", "link": "https://stackoverflow.com/users/6821306/testtest11"}, "reply_to_user": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 0, "creation_date": 1478089591, "post_id": 40375232, "comment_id": 68011635, "body": "As .xlsx expansion."}], "answers": [{"tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": true, "score": 1, "last_activity_date": 1478089748, "creation_date": 1478089748, "answer_id": 40379979, "question_id": 40375232, "link": "https://stackoverflow.com/questions/40375232/disappearing-toggle-button-macro/40379979#40379979", "title": "Disappearing Toggle Button macro", "body": "<p>Save your file as \".xlsm\" or \".xlsb\" file, and everything should be fine.</p>\n"}], "owner": {"reputation": 347, "user_id": 6821306, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b7e4a451b55661dfb4d60da8c1b702a1?s=128&d=identicon&r=PG&f=1", "display_name": "Testtest11", "link": "https://stackoverflow.com/users/6821306/testtest11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 40379979, "answer_count": 1, "score": 0, "last_activity_date": 1478089748, "creation_date": 1478074677, "question_id": 40375232, "link": "https://stackoverflow.com/questions/40375232/disappearing-toggle-button-macro", "title": "Disappearing Toggle Button macro", "body": "<p>I have simple Excel macro, for ToggleButton:</p>\n\n<pre><code>Private Sub ToggleButton1_Click()\nDim xAddress As String\nxAddress = \"L:R\"\nIf ToggleButton1.Value Then\n    Application.ActiveSheet.Columns(xAddress).Hidden = True\nElse\n    Application.ActiveSheet.Columns(xAddress).Hidden = False\nEnd If\nEnd Sub\n</code></pre>\n\n<p>When I upload this to OneDrive and download, macro disappear.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PBqyG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PBqyG.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have just ToggleButton definition, so it doesn't work.</p>\n\n<p>How I can store this macro permanently?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "edited": false, "score": 1, "creation_date": 1478074692, "post_id": 40375065, "comment_id": 68002957, "body": "Please post the code from your previous approaches. What have been wrong?"}, {"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 1, "creation_date": 1478074815, "post_id": 40375065, "comment_id": 68003015, "body": "I think you should post your sample data"}, {"owner": {"reputation": 13, "user_id": 7103407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8c4b33df3b57244e4fb5ca90bc0db85?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/7103407/tony"}, "edited": false, "score": 0, "creation_date": 1478077325, "post_id": 40375065, "comment_id": 68004199, "body": "I hope this will help <a href=\"https://postimg.org/image/a3m54hf19/\" rel=\"nofollow noreferrer\">postimg.org/image/a3m54hf19</a>"}, {"owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "edited": false, "score": 0, "creation_date": 1478079120, "post_id": 40375065, "comment_id": 68005211, "body": "Please <a href=\"https://stackoverflow.com/posts/40375065/edit\">edit</a> your post, and post the image in the question"}, {"owner": {"reputation": 21459, "user_id": 3894917, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/41Fan.jpg?s=128&g=1", "display_name": "Tom Sharpe", "link": "https://stackoverflow.com/users/3894917/tom-sharpe"}, "edited": false, "score": 0, "creation_date": 1478083730, "post_id": 40375065, "comment_id": 68008038, "body": "I would have thought that you should be doing an interpolation to get the 10 minute values, e.g. the 10-minute value would be 1/3 the 0 minute value plus 2/3 of the 15 minute value?"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7103407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8c4b33df3b57244e4fb5ca90bc0db85?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/7103407/tony"}, "edited": false, "score": 0, "creation_date": 1478077755, "post_id": 40375490, "comment_id": 68004406, "body": "It is not that simple I am afraid. <a href=\"https://postimg.org/image/a3m54hf19/\" rel=\"nofollow noreferrer\">postimg.org/image/a3m54hf19</a>"}], "tags": [], "owner": {"reputation": 92, "user_id": 4686136, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-u_VadhOHQYc/AAAAAAAAAAI/AAAAAAAAAQU/z4QoPPdO9YM/photo.jpg?sz=128", "display_name": "Julli Schaf", "link": "https://stackoverflow.com/users/4686136/julli-schaf"}, "is_accepted": false, "score": 0, "last_activity_date": 1478075859, "creation_date": 1478075859, "answer_id": 40375490, "question_id": 40375065, "link": "https://stackoverflow.com/questions/40375065/excel-trouble-how-to-transfer-15-min-data-to-10-min-data/40375490#40375490", "title": "Excel trouble - how to transfer 15 min data to 10 min data", "body": "<p>Not sure if I got your question right but try this:</p>\n\n<pre><code>=A1/3*2\n</code></pre>\n\n<p>Post that in the column next to your data and doubleclick the small black dot:</p>\n\n<p><a href=\"https://abload.de/img/excelbwbzz.png\" rel=\"nofollow noreferrer\">https://abload.de/img/excelbwbzz.png</a></p>\n"}, {"tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": true, "score": 1, "last_activity_date": 1478081778, "creation_date": 1478081778, "answer_id": 40377367, "question_id": 40375065, "link": "https://stackoverflow.com/questions/40375065/excel-trouble-how-to-transfer-15-min-data-to-10-min-data/40377367#40377367", "title": "Excel trouble - how to transfer 15 min data to 10 min data", "body": "<p>This is not a code writing service, but just create some simple loops.</p>\n\n<pre><code>Sub tenmindata()\n\nDim lastRow As Integer\n\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\n\nlastRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nj = 3\nFor i = 3 To lastRow\n    For k = 1 To 3\n        Cells(j, 7) = Cells(i, 3).Value / 3\n        j = j + 1\n    Next k\nNext i\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7103407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8c4b33df3b57244e4fb5ca90bc0db85?s=128&d=identicon&r=PG&f=1", "display_name": "Tony", "link": "https://stackoverflow.com/users/7103407/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 40377367, "answer_count": 2, "score": 0, "last_activity_date": 1478086481, "creation_date": 1478074045, "last_edit_date": 1531161705, "question_id": 40375065, "link": "https://stackoverflow.com/questions/40375065/excel-trouble-how-to-transfer-15-min-data-to-10-min-data", "title": "Excel trouble - how to transfer 15 min data to 10 min data", "body": "<p>I have a big Excel sheet with data taken from the sensors from one windfarm.</p>\n\n<p>It is in one column, one below the other, just a clean numbers, integer (example 1435). Those columns represent data from every 15 minutes.</p>\n\n<p>I need to get the data from it and transform it to 10 min data. </p>\n\n<p>My idea was to divide it by 3 (get 5 min data) and just add two of those. </p>\n\n<p>But I need the formula in excel which does that in the other column.  </p>\n\n<ul>\n<li>So takes the first column</li>\n<li>divide it by 3,   </li>\n<li>put it in the column next to it,  </li>\n<li>copy it in 2 more rows below  </li>\n<li>then repeat the procedure but with the other value in the 15 min data, below the first one.</li>\n</ul>\n\n<p>I hope it makes sense,\nmuch appreciated for any assistance</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5919433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUscZ.jpg?s=128&g=1", "display_name": "invyspirit", "link": "https://stackoverflow.com/users/5919433/invyspirit"}, "edited": false, "score": 0, "creation_date": 1478072754, "post_id": 40374504, "comment_id": 68002148, "body": "Damn you are amazing. Simple solution for MS being silly here. Works like a charm! Thank you."}, {"owner": {"reputation": 33, "user_id": 5919433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUscZ.jpg?s=128&g=1", "display_name": "invyspirit", "link": "https://stackoverflow.com/users/5919433/invyspirit"}, "edited": false, "score": 0, "creation_date": 1478073087, "post_id": 40374504, "comment_id": 68002289, "body": "I&#39;m wondering, what exactly had led you you to the conclusion of problem being in separators? As well as how is it that <code>formula = i</code> makes excel substitute dot for a comma in the output cell?"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 33, "user_id": 5919433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUscZ.jpg?s=128&g=1", "display_name": "invyspirit", "link": "https://stackoverflow.com/users/5919433/invyspirit"}, "edited": false, "score": 0, "creation_date": 1478074111, "post_id": 40374504, "comment_id": 68002706, "body": "You are welcome 1) I have been brought there by my own excel environment... 2) &quot;.formula=i&quot; lacks the &quot;=&quot; part that makes it a real formula, without that part it&#39;s like &quot;.Value=i&quot; and therefore no formula evaluation is called"}, {"owner": {"reputation": 33, "user_id": 5919433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUscZ.jpg?s=128&g=1", "display_name": "invyspirit", "link": "https://stackoverflow.com/users/5919433/invyspirit"}, "edited": false, "score": 0, "creation_date": 1478074590, "post_id": 40374504, "comment_id": 68002909, "body": "Ah, that explains. <code>.formula= &quot;=&quot;</code> calls some procedure that checks whether the formula is correct hence the error. Cool. Thank you!"}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 1, "last_activity_date": 1478071790, "creation_date": 1478071790, "answer_id": 40374504, "question_id": 40374420, "link": "https://stackoverflow.com/questions/40374420/double-variable-in-cell-formula-what-am-i-doing-wrong-here-rangea2-formula/40374504#40374504", "title": "Double variable in cell formula. What am I doing wrong here? Range(&quot;A2&quot;).Formula = &quot;=A1+&quot; &amp; i", "body": "<p>it must have to do with decimal delimiter, may be your excel environment uses \",\"</p>\n\n<p>try this:</p>\n\n<pre><code>Range(\"A2\").Formula = \"=A1+\" &amp; Replace(i, \",\", \".\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 5919433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUscZ.jpg?s=128&g=1", "display_name": "invyspirit", "link": "https://stackoverflow.com/users/5919433/invyspirit"}, "edited": false, "score": 1, "creation_date": 1478072936, "post_id": 40374779, "comment_id": 68002225, "body": "Should work as well, but I&#39;m afraid there could be a compatibility issue when a code is run on another machine, which does not have separators configured as above. Thank you though!"}, {"owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "reply_to_user": {"reputation": 33, "user_id": 5919433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUscZ.jpg?s=128&g=1", "display_name": "invyspirit", "link": "https://stackoverflow.com/users/5919433/invyspirit"}, "edited": false, "score": 0, "creation_date": 1478074445, "post_id": 40374779, "comment_id": 68002849, "body": "You&#39;re right. Might be programmatically changeable, though."}], "tags": [], "owner": {"reputation": 7547, "user_id": 6019417, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/nA455.jpg?s=128&g=1", "display_name": "J. Chomel", "link": "https://stackoverflow.com/users/6019417/j-chomel"}, "is_accepted": false, "score": 0, "last_activity_date": 1478072791, "creation_date": 1478072791, "answer_id": 40374779, "question_id": 40374420, "link": "https://stackoverflow.com/questions/40374420/double-variable-in-cell-formula-what-am-i-doing-wrong-here-rangea2-formula/40374779#40374779", "title": "Double variable in cell formula. What am I doing wrong here? Range(&quot;A2&quot;).Formula = &quot;=A1+&quot; &amp; i", "body": "<p>Yes, depending on the local you're using, you will either have <code>,</code> or <code>.</code>.</p>\n\n<p>Another solution is to change it in your Excel options:</p>\n\n<p><a href=\"https://i.stack.imgur.com/vlgZn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vlgZn.png\" alt=\"Excel Change local decimal separator\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 3591, "user_id": 5959772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16582d7b8ad17c08dd59266281ea5c7f?s=128&d=identicon&r=PG&f=1", "display_name": "arcadeprecinct", "link": "https://stackoverflow.com/users/5959772/arcadeprecinct"}, "is_accepted": false, "score": 0, "last_activity_date": 1478086883, "creation_date": 1478086883, "answer_id": 40379088, "question_id": 40374420, "link": "https://stackoverflow.com/questions/40374420/double-variable-in-cell-formula-what-am-i-doing-wrong-here-rangea2-formula/40379088#40379088", "title": "Double variable in cell formula. What am I doing wrong here? Range(&quot;A2&quot;).Formula = &quot;=A1+&quot; &amp; i", "body": "<p>Another option is to use <code>.FormulaLocal</code> instead of <code>.Formula</code>. However it can cause new problems, for example with parameter separators in function calls.</p>\n"}], "owner": {"reputation": 33, "user_id": 5919433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RUscZ.jpg?s=128&g=1", "display_name": "invyspirit", "link": "https://stackoverflow.com/users/5919433/invyspirit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 40374504, "answer_count": 3, "score": 1, "last_activity_date": 1478086883, "creation_date": 1478071429, "question_id": 40374420, "link": "https://stackoverflow.com/questions/40374420/double-variable-in-cell-formula-what-am-i-doing-wrong-here-rangea2-formula", "title": "Double variable in cell formula. What am I doing wrong here? Range(&quot;A2&quot;).Formula = &quot;=A1+&quot; &amp; i", "body": "<p>Tried googling that, but no luck.</p>\n\n<p>Anyway, let's say I calculate some value of type double somewhere inside my code. Then I need to use this value in a cell formula. For whatever reason my approach does not seem to work, giving 1004.</p>\n\n<pre><code>Dim i As Double\ni = 0.5\n\nRange(\"A1\").Value2 = 1\nRange(\"A2\").Formula = \"=A1+\" &amp; i\n</code></pre>\n\n<p>What am I doing wrong here and why does it not work? It does work if you change to an integer value</p>\n\n<pre><code>Dim i As Double\ni = 2\n</code></pre>\n\n<p>Btw, the code below executes as expected</p>\n\n<pre><code>Dim i As Double\ni = 0.5\n\nRange(\"A2\").Formula = i\n</code></pre>\n\n<p>Whereas if you change the last line to</p>\n\n<pre><code>Range(\"A2\").Formula = \"=\" &amp; i\n</code></pre>\n\n<p>It returns 1004.</p>\n\n<p>Any help appreciated. Thank you!</p>\n"}, {"tags": ["vba", "dom", "msxml"], "comments": [{"owner": {"reputation": 4077, "user_id": 1988304, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/9tgQl.jpg?s=128&g=1", "display_name": "JimHawkins", "link": "https://stackoverflow.com/users/1988304/jimhawkins"}, "edited": false, "score": 1, "creation_date": 1478069053, "post_id": 40373832, "comment_id": 68000624, "body": "Welcome to stack overflow :-) please look at how to <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. This site isn&#39;t a code generator."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1478071924, "post_id": 40373832, "comment_id": 68001780, "body": "You can just <a href=\"http://stackoverflow.com/a/7413486/111794\">search StackOverflow properly</a>. In particular, search for the [vba] and [mshtml] tags (<a href=\"http://stackoverflow.com/questions/tagged/mshtml%20vba?mode=all\">stackoverflow.com/questions/tagged/mshtml%20vba?mode=all</a>)."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "edited": false, "score": 0, "creation_date": 1478071969, "post_id": 40373832, "comment_id": 68001801, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/7393236/reading-web-pages-using-excel-vba\">Reading Web Pages using Excel VBA</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7075507"}, "is_accepted": false, "score": 0, "last_activity_date": 1480524812, "creation_date": 1480524812, "answer_id": 40893922, "question_id": 40373832, "link": "https://stackoverflow.com/questions/40373832/interacting-with-a-web-page-using-vba/40893922#40893922", "title": "Interacting with a web page using VBA", "body": "<p>Here is a classic example of how to do all of those things.</p>\n\n<pre><code>Dim HTMLDoc As HTMLDocument\nDim oBrowser As InternetExplorer\nSub Login_2_Website()\n\nDim oHTML_Element As IHTMLElement\nDim sURL As String\n\nOn Error GoTo Err_Clear\nsURL = \"https://www.google.com/accounts/Login\"\nSet oBrowser = New InternetExplorer\noBrowser.Silent = True\noBrowser.timeout = 60\noBrowser.navigate sURL\noBrowser.Visible = True\n\nDo\n' Wait till the Browser is loaded\nLoop Until oBrowser.readyState = READYSTATE_COMPLETE\n\nSet HTMLDoc = oBrowser.Document\n\nHTMLDoc.all.Email.Value = \"sample@vbadud.com\"\nHTMLDoc.all.passwd.Value = \"*****\"\n\nFor Each oHTML_Element In HTMLDoc.getElementsByTagName(\"input\")\nIf oHTML_Element.Type = \"submit\" Then oHTML_Element.Click: Exit For\nNext\n\n' oBrowser.Refresh ' Refresh If Needed\nErr_Clear:\nIf Err &lt;&gt; 0 Then\nDebug.Assert Err = 0\nErr.Clear\nResume Next\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Make sure to set references to:\nMicrosoft HTML Object library \n&amp;\nMicrosoft Internet Controls</p>\n"}], "owner": {"reputation": 1, "user_id": 6310180, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-3Cj4vddV77A/AAAAAAAAAAI/AAAAAAAAEuw/8PIcHwMRXEU/photo.jpg?sz=128", "display_name": "Raghavan R R", "link": "https://stackoverflow.com/users/6310180/raghavan-r-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 382, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1542974580, "creation_date": 1478068761, "last_edit_date": 1478071669, "question_id": 40373832, "link": "https://stackoverflow.com/questions/40373832/interacting-with-a-web-page-using-vba", "title": "Interacting with a web page using VBA", "body": "<p>I just want to know the following:</p>\n\n<ol>\n<li>How do I login to a pages using VBA?</li>\n<li>How do I click on various options in a web page using VBA? </li>\n<li>How do I enter text into required forms in a web page using a VBA?</li>\n</ol>\n"}, {"tags": ["python", "vba", "excel", "shell"], "answers": [{"tags": [], "owner": {"reputation": 477, "user_id": 6924242, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28af1e51d394d6d03ffadc5b1db0d3e6?s=128&d=identicon&r=PG&f=1", "display_name": "Karnage", "link": "https://stackoverflow.com/users/6924242/karnage"}, "is_accepted": false, "score": 0, "last_activity_date": 1478068964, "creation_date": 1478068964, "answer_id": 40373875, "question_id": 40373543, "link": "https://stackoverflow.com/questions/40373543/excel-vba-shell-script-that-executes-python-script-not-working/40373875#40373875", "title": "Excel VBA shell script that executes python script not working", "body": "<p>I have a VBA script that does the same thing, this is how it looks:</p>\n\n<pre><code>args = \"\"\"\" &amp; Application.ActiveWorkbook.Path &amp; \"\\helloWorld.py\"\" P\"\noutput = ShellRun(\"\"\"C:\\Python27\\python.exe\"\" \" &amp; args)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 963, "user_id": 1542093, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dRwFe.jpg?s=128&g=1", "display_name": "lordlabakdas", "link": "https://stackoverflow.com/users/1542093/lordlabakdas"}, "is_accepted": false, "score": 0, "last_activity_date": 1478071370, "creation_date": 1478071370, "answer_id": 40374407, "question_id": 40373543, "link": "https://stackoverflow.com/questions/40373543/excel-vba-shell-script-that-executes-python-script-not-working/40374407#40374407", "title": "Excel VBA shell script that executes python script not working", "body": "<p>The issue was with a directory in the args path that had a space in between. Removing the space in the path of the python script fixed the error.</p>\n"}], "owner": {"reputation": 963, "user_id": 1542093, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/dRwFe.jpg?s=128&g=1", "display_name": "lordlabakdas", "link": "https://stackoverflow.com/users/1542093/lordlabakdas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1478071370, "creation_date": 1478067347, "question_id": 40373543, "link": "https://stackoverflow.com/questions/40373543/excel-vba-shell-script-that-executes-python-script-not-working", "title": "Excel VBA shell script that executes python script not working", "body": "<p>I have a VBA script as given below that executes a python script that writes values to Excel workbooks.</p>\n\n<pre><code>Dim args\nDim Ret_Val\nargs = ActiveWorkbook.Path &amp; \"\\helloWorld.py\"\nRet_Val = Shell(\"C:\\Python27\\python.exe \" &amp; args, vbNormalFocus)\n</code></pre>\n\n<p>The helloWorld.py is given below:</p>\n\n<pre><code>import xlrd\nfrom xlutils.copy import copy\nrb = xlrd.open_workbook(\"/a/b/StubProto.xlsm\")\nwb = copy(rb)\nws1 = wb.get_sheet(0)\nws1.write(1, 11, \"Hello World\")\nwb.save(\"StubProto.xlsm\")\n</code></pre>\n\n<p>The above code works OK on its own in a Windows environment but does not work on a VBA environment. It does not seem to return anything in a VBA environment. </p>\n\n<p>Is there some thing I am doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1451, "user_id": 2882327, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OiCh4.png?s=128&g=1", "display_name": "Limak", "link": "https://stackoverflow.com/users/2882327/limak"}, "is_accepted": false, "score": 1, "last_activity_date": 1478073494, "creation_date": 1478073494, "answer_id": 40374934, "question_id": 40373542, "link": "https://stackoverflow.com/questions/40373542/excel-vba-ignoring-pagesetup-changes/40374934#40374934", "title": "Excel VBA Ignoring PageSetup Changes", "body": "<p>The only line you need from this whole recorded macro is:</p>\n\n<pre><code>ActiveSheet.PageSetup.Orientation = xlLandscape\n</code></pre>\n\n<p>Please change the sheet reference, just to be sure that you are interacting with correct sheet. You need to type name of your sheet inside the brackets:</p>\n\n<pre><code>Sheets(\"YourSheetName\").PageSetup.Orientation = xlLandscape\n</code></pre>\n\n<p>Now, check once more on print preview, if there is no change.</p>\n"}], "owner": {"reputation": 1, "user_id": 7102126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f176957633528564f4bb5cb427fe4208?s=128&d=identicon&r=PG&f=1", "display_name": "Dave H", "link": "https://stackoverflow.com/users/7102126/dave-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478073494, "creation_date": 1478067345, "last_edit_date": 1531164843, "question_id": 40373542, "link": "https://stackoverflow.com/questions/40373542/excel-vba-ignoring-pagesetup-changes", "title": "Excel VBA Ignoring PageSetup Changes", "body": "<p>I have a simple Excel Macro (below) that just changes the orientation from Portrait to Landscape.  I used the Excel \"record macro\" tool, but when I use this macro, it ignores the commands.  Has anyone else seen this?  And, is there a good solution?</p>\n\n<pre><code>Sub Writedown_Format_Landscape()\n'\n' Writedown_Format_Landscape Macro\nRange(\"A1\").Select\n\nApplication.PrintCommunication = False\nWith ActiveSheet.PageSetup\n    .PrintTitleRows = \"$1:$1\"\n    .PrintTitleColumns = \"\"\nEnd With\n\nApplication.PrintCommunication = True\nActiveSheet.PageSetup.PrintArea = \"\"\nApplication.PrintCommunication = False\n\nWith ActiveSheet.PageSetup\n    .LeftHeader = \"&amp;D - &amp;T\"\n    .CenterHeader = \"&amp;F\"\n    .RightHeader = \"&amp;P / &amp;N\"\n    .LeftFooter = \"\"\n    .CenterFooter = \"\"\n    .RightFooter = \"\"\n    .LeftMargin = Application.InchesToPoints(0.25)\n    .RightMargin = Application.InchesToPoints(0.25)\n    .TopMargin = Application.InchesToPoints(0.5)\n    .BottomMargin = Application.InchesToPoints(0.25)\n    .HeaderMargin = Application.InchesToPoints(0.25)\n    .FooterMargin = Application.InchesToPoints(0.25)\n    .PrintHeadings = False\n    .PrintGridlines = True\n    .PrintComments = xlPrintNoComments\n    .CenterHorizontally = True\n    .CenterVertically = False\n    .Orientation = xlLandscape\n    .Draft = False\n    .PaperSize = xlPaperLetter\n    .FirstPageNumber = xlAutomatic\n    .Order = xlDownThenOver\n    .BlackAndWhite = False\n    .Zoom = 100\nEnd With\n\nRange(\"A1\").Select\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 1761, "user_id": 1050927, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/445e633a360a3597153c4c84e61db91d?s=128&d=identicon&r=PG&f=1", "display_name": "Prisoner", "link": "https://stackoverflow.com/users/1050927/prisoner"}, "is_accepted": false, "score": 0, "last_activity_date": 1478068367, "last_edit_date": 1495540098, "creation_date": 1478068367, "answer_id": 40373750, "question_id": 40373446, "link": "https://stackoverflow.com/questions/40373446/auto-filename-when-saving-word-document/40373750#40373750", "title": "Auto filename when saving word document", "body": "<p>According to this post - <a href=\"https://stackoverflow.com/a/24702494/1050927\">How to run a macro in Word before save?</a>, you can have your code in <code>BeforeSave</code>, cancel the save and run <code>SaveAs2</code></p>\n\n<pre><code>Private WithEvents App As Word.Application\n\nPrivate Sub Document_Open()\n    Set App = Word.Application\nEnd Sub\n\nPrivate Sub App_DocumentBeforeSave(ByVal Doc As Document, SaveAsUI As Boolean, Cancel As Boolean)\n    MsgBox (\"BeforeSave\")\n    Cancel = True\n    ThisDocument.SaveAs2 FileName:=\"test.docx\"\nEnd Sub\n</code></pre>\n\n<p>But beware you should check the <code>filename</code> in <code>DocumentBeforeSave</code>, if it is same as the title, you should not cancel the save.</p>\n"}], "owner": {"reputation": 1, "user_id": 7102978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdc79fcc399db2ffbada39fa93d85e97?s=128&d=identicon&r=PG&f=1", "display_name": "Filip", "link": "https://stackoverflow.com/users/7102978/filip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 794, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478068367, "creation_date": 1478066775, "question_id": 40373446, "link": "https://stackoverflow.com/questions/40373446/auto-filename-when-saving-word-document", "title": "Auto filename when saving word document", "body": "<p>I'm a novice with VBA and fillable fields.</p>\n\n<p>However here is my question:</p>\n\n<p>I have created a word template which has one fillable field called \"Title\"</p>\n\n<p>I would like to know how to proceed to have the following:</p>\n\n<p>Once I open the template as a normal .doc document, and I have finished to work with it and filled in the fillable field called title\nthat when I click save that the document file name automatically becomes the\ntext that I have within the fillable field called title.</p>\n\n<p>Please help.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1478064708, "post_id": 40372716, "comment_id": 67999096, "body": "There might be an easier way to do this than to do in VBA.  In sheet 1, concatenate the values to a string  In sheet 2, for each column, concatenate the values to a string Then in sheet 1, do a VLOOKUP."}, {"owner": {"reputation": 5, "user_id": 7102744, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_KeEkmDJtfM/AAAAAAAAAAI/AAAAAAAACsA/HT03yXBcaoY/photo.jpg?sz=128", "display_name": "Nicholas Weaver", "link": "https://stackoverflow.com/users/7102744/nicholas-weaver"}, "reply_to_user": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1478066746, "post_id": 40372716, "comment_id": 67999781, "body": "I looked into this but it only allows for 32 cells when using =CONCATENATE, and the list could be more then this."}, {"owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "edited": false, "score": 0, "creation_date": 1478067326, "post_id": 40372716, "comment_id": 67999968, "body": "=CONCAT(A4:A198), as an example worked for me"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 7102744, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_KeEkmDJtfM/AAAAAAAAAAI/AAAAAAAACsA/HT03yXBcaoY/photo.jpg?sz=128", "display_name": "Nicholas Weaver", "link": "https://stackoverflow.com/users/7102744/nicholas-weaver"}, "edited": false, "score": 0, "creation_date": 1478069245, "post_id": 40373362, "comment_id": 68000687, "body": "For some reason the =CONCAT(B4:B8) throws an error for me (#Value?). But looking at the check, I would need it to report the header of the matched column, as these columns are added in by another script."}], "tags": [], "owner": {"reputation": 870, "user_id": 1222349, "user_type": "registered", "accept_rate": 13, "profile_image": "https://i.stack.imgur.com/7vPs9.jpg?s=128&g=1", "display_name": "dgorti", "link": "https://stackoverflow.com/users/1222349/dgorti"}, "is_accepted": false, "score": 0, "last_activity_date": 1478066335, "creation_date": 1478066335, "answer_id": 40373362, "question_id": 40372716, "link": "https://stackoverflow.com/questions/40372716/compare-one-column-against-multiple-columns-for-a-match-quit-if-no-more-columns/40373362#40373362", "title": "Compare one column against multiple columns for a match, quit if no more columns exsist", "body": "<p>So this is what I did. On the first sheet\n<a href=\"https://i.stack.imgur.com/WIGga.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WIGga.png\" alt=\"Sheet 1\"></a></p>\n\n<p>On the second sheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/p85rA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p85rA.png\" alt=\"Sheet 2\"></a></p>\n\n<p>and finally do a match \nin the first sheet\n=IF( ISNUMBER(MATCH(B3, Sheet2!A2:D2, 0)), \"MATCH\", \"NO MATCH\")</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 7102744, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_KeEkmDJtfM/AAAAAAAAAAI/AAAAAAAACsA/HT03yXBcaoY/photo.jpg?sz=128", "display_name": "Nicholas Weaver", "link": "https://stackoverflow.com/users/7102744/nicholas-weaver"}, "edited": false, "score": 0, "creation_date": 1478098423, "post_id": 40373827, "comment_id": 68017796, "body": "Great, man this really helped out, didn&#39;t know about Join very useful. Thanks for all the help on this."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1478068728, "creation_date": 1478068728, "answer_id": 40373827, "question_id": 40372716, "link": "https://stackoverflow.com/questions/40372716/compare-one-column-against-multiple-columns-for-a-match-quit-if-no-more-columns/40373827#40373827", "title": "Compare one column against multiple columns for a match, quit if no more columns exsist", "body": "<p>a VBA solution could be the following:</p>\n\n<pre><code>Sub main()\n    Dim strngToMatch As String\n    Dim cell As Range\n\n    With Worksheets(\"Sheet1\")\n        strngToMatch = Join(Application.Transpose(.Range(\"A3\", .Cells(.Rows.Count, 1).End(xlUp)).Value), \"\")\n    End With\n\n    With Worksheets(\"Sheet2\")\n        For Each cell In .Range(\"A1\", .Cells(1, .Columns.Count).End(xlToLeft)).SpecialCells(xlCellTypeConstants)\n            If strngToMatch = Join(Application.Transpose(.Range(cell.Offset(1), .Cells(.Rows.Count, cell.Column).End(xlUp)).Value), \"\") Then\n                Worksheets(\"Sheet01\").Range(\"A2\").Value = cell.Value\n                Exit For\n            End If\n        Next cell\n    End With\nEnd Sub\n</code></pre>\n\n<p>which can be refactored not to clutter the \"main\" code as follows:</p>\n\n<pre><code>Sub main()        \n    With Worksheets(\"Sheet01\")\n        .Range(\"A2\").Value = Join(Application.Transpose(.Range(\"A3\", .Cells(.Rows.Count, 1).End(xlUp)).Value), \"\")\n    End With\nEnd Sub\n\nFunction GetHeader(shtName As String, strngToMatch As String) As String\n    Dim cell As Range\n\n    With Worksheets(shtName)\n        For Each cell In .Range(\"A1\", .Cells(1, .Columns.Count).End(xlToLeft)).SpecialCells(xlCellTypeConstants)\n            If strngToMatch = Join(Application.Transpose(.Range(cell.Offset(1), .Cells(.Rows.Count, cell.Column).End(xlUp)).Value), \"\") Then\n                GetHeader = cell.Value\n                Exit For\n            End If\n        Next cell\n    End With\nEnd Function\n</code></pre>\n\n<p>where the \"main\" code is quite ready to host a loop over \"FACT\" columns</p>\n"}], "owner": {"reputation": 5, "user_id": 7102744, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_KeEkmDJtfM/AAAAAAAAAAI/AAAAAAAACsA/HT03yXBcaoY/photo.jpg?sz=128", "display_name": "Nicholas Weaver", "link": "https://stackoverflow.com/users/7102744/nicholas-weaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 782, "favorite_count": 0, "accepted_answer_id": 40373827, "answer_count": 2, "score": 0, "last_activity_date": 1478068728, "creation_date": 1478062426, "question_id": 40372716, "link": "https://stackoverflow.com/questions/40372716/compare-one-column-against-multiple-columns-for-a-match-quit-if-no-more-columns", "title": "Compare one column against multiple columns for a match, quit if no more columns exsist", "body": "<p><strong>Problem:</strong> Make a loop that creates an array of all cells under a column,  for each column on a sheet.</p>\n\n<p>I am trying to make a script that will compare data from a column on one sheet, against multiple columns, until there are no more columns. Once I find a match I report the header to the first sheet, if I don't find a match I report \"No Match\". </p>\n\n<p>Right now I have the logic to go through one column and report the outcome, but I'm not sure how to create a loop to compares against each consecutive column on the sheet. I have comments where I think I have gone wrong. </p>\n\n<p>Thanks in advance for any dvice or direction.</p>\n\n<p>Thanks,</p>\n\n<p>Example Data:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3boz1.png\" rel=\"nofollow noreferrer\">SHEET1</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/fmPDv.png\" rel=\"nofollow noreferrer\">SHEET2</a></p>\n\n<pre><code>Sub compareColumns()\nDim a As Long, arrA As Variant, arrB As Variant, dict As Object, c As Long, l As Long, cList As String\n\n\nSet dict = CreateObject(\"scripting.Dictionary\")\ndict.comparemode = vbTextCompare\n\n' Build the dictionary to compare with other columns\nWith Worksheets(\"sheet1\")\n    With Intersect(.UsedRange, .Range(\"A1:A100\"))\n        arrA = .Cells.Value2\n    End With\n    For a = LBound(arrA, 1) + 2 To UBound(arrA, 1) 'LBound(arrA, 1)+2 to skip the column header and leave a space to put a result\n        dict.Item(arrA(a, 1)) = arrA(a, 1)\n    Next a\nEnd With\n\ncList = ThisWorkbook.Sheets(1).Column.Count\n\nWith Worksheets(\"sheet2\")\n    For l = 0 To cList\n        With Intersect(.UsedRange, .Cells(1, l)) 'NOT SURE IF THIS WORKS WITH CELLS\n            arr(l) = .Cells.Value2 ' NOT SURE HOW TO MAKE ARRAYS FROM A LOOP\n        End With\n    Next l\nEnd With\n\n' C for compare, check against a column and if not match go to the next column, if match type result\nFor c = LBound(arrA, 1) + 2 To UBound(arrA, 1) 'LBound(arrA, 1)+2 to skip the column header and leave room for result\n        If dict.Item(arrA(c, 1)) &lt;&gt; arrB(c - 1, 1) Then 'had to -1 the c to make up for the space that are in the columns\n            ' GO TO THE NEXT COLUMN OR ARRAY CHECK\n            Exit For\n        End If\n\nNext c\n\nWith Worksheets(\"sheet1\")\n    .Cells(2, 1).Value = arrB(1, 1) 'UPDATE EACH COLUMN\nEnd With\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478056392, "post_id": 40371871, "comment_id": 67997173, "body": "What&#39;s wrong with <code>^Agree$|^Align$</code>?  Some sample inputs would be helpful."}, {"owner": {"reputation": 1, "user_id": 4202232, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CDQBHyPnN14/AAAAAAAAAAI/AAAAAAAAAKs/AV1Okzzf-N4/photo.jpg?sz=128", "display_name": "maksood alam", "link": "https://stackoverflow.com/users/4202232/maksood-alam"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478057313, "post_id": 40371871, "comment_id": 67997374, "body": "I have below list of words, which I want to replace  Word\tNew Word Agree\tAgree to Agree\tAgree with Agree\tAgree on Align\tAlign with Ban\tBan from Ban\tBan in Ban\tBan on"}, {"owner": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1478067544, "post_id": 40371871, "comment_id": 68000046, "body": "^^ Yoda with a stutter"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 8811, "user_id": 5757159, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/yxD51.png?s=128&g=1", "display_name": "ThunderFrame", "link": "https://stackoverflow.com/users/5757159/thunderframe"}, "edited": false, "score": 0, "creation_date": 1478088619, "post_id": 40371871, "comment_id": 68011075, "body": "I think that what @ThunderFrame is trying to say is that you&#39;d be better off editing your list of words into the OP and adding some formatting, because it&#39;s quite difficult to determine what you&#39;re attempting to do from the unformattable text in a comment."}], "owner": {"reputation": 1, "user_id": 4202232, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-CDQBHyPnN14/AAAAAAAAAAI/AAAAAAAAAKs/AV1Okzzf-N4/photo.jpg?sz=128", "display_name": "maksood alam", "link": "https://stackoverflow.com/users/4202232/maksood-alam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492744265, "creation_date": 1478056099, "last_edit_date": 1478056202, "question_id": 40371871, "link": "https://stackoverflow.com/questions/40371871/regular-expression-in-vba", "title": "Regular Expression in VBA", "body": "<p>I want to write regular expression to select Agree, Ban, compare and many more which are not followed by a preposition like by, to, with, on, for, from and many more.\ne.g. if a text box or cell contains <strong>Agree to</strong> it should do noting but if it contains only <strong>Agree</strong> without any preposition regular expression should select it.\nI have written below pattern but not able to get my expected output.</p>\n\n<pre><code>With objRgX\n    .Global = True\n    .Pattern = \"(Agree|Align)[ ]?(^(to|with|on))\"\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 6937, "user_id": 1091308, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ccc75c826539146f2f9a5f7f9850076c?s=128&d=identicon&r=PG", "display_name": "Niyoko", "link": "https://stackoverflow.com/users/1091308/niyoko"}, "edited": false, "score": 1, "creation_date": 1478055775, "post_id": 40371821, "comment_id": 67996989, "body": "Please use parameterized query."}, {"owner": {"reputation": 11, "user_id": 7102513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3598d5eec5d64a0a8afd5b7540bdd7?s=128&d=identicon&r=PG&f=1", "display_name": "DNguyen", "link": "https://stackoverflow.com/users/7102513/dnguyen"}, "reply_to_user": {"reputation": 6937, "user_id": 1091308, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ccc75c826539146f2f9a5f7f9850076c?s=128&d=identicon&r=PG", "display_name": "Niyoko", "link": "https://stackoverflow.com/users/1091308/niyoko"}, "edited": false, "score": 0, "creation_date": 1478055838, "post_id": 40371821, "comment_id": 67997007, "body": "What do you mean by parameterized query?"}, {"owner": {"reputation": 6937, "user_id": 1091308, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ccc75c826539146f2f9a5f7f9850076c?s=128&d=identicon&r=PG", "display_name": "Niyoko", "link": "https://stackoverflow.com/users/1091308/niyoko"}, "edited": false, "score": 2, "creation_date": 1478055981, "post_id": 40371821, "comment_id": 67997051, "body": "Read <a href=\"http://stackoverflow.com/questions/542510/how-do-i-create-a-parameterized-sql-query-why-should-i\">here</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478056142, "post_id": 40371821, "comment_id": 67997089, "body": "Remove one of these: <code>&amp; &quot;&#39;&quot; &amp; &quot;&#39;&quot;</code>.  Your query doesn&#39;t have balanced quotes:  <code>values (&#39;&#39;,&#39;&#39;&#39;,&#39;&#39;,&#39;&#39;,&#39;&#39;)</code>."}, {"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1478056175, "post_id": 40371821, "comment_id": 67997101, "body": "You have a horrific mismatch in quote characters, missing single quotes, and quotes where they shouldn&#39;t be used in the error message you&#39;ve posted. Either it&#39;s not the actual message, or the code you&#39;ve posted is not your actual code. If you learn to use parameterized queries, you won&#39;t have to worry about properly pairing and escaping quote characters. You&#39;ll also protect yourself against SQL injection."}, {"owner": {"reputation": 11, "user_id": 7102513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3598d5eec5d64a0a8afd5b7540bdd7?s=128&d=identicon&r=PG&f=1", "display_name": "DNguyen", "link": "https://stackoverflow.com/users/7102513/dnguyen"}, "edited": false, "score": 0, "creation_date": 1478056837, "post_id": 40371821, "comment_id": 67997276, "body": "So I removed {&amp; &quot;&#39;&quot; &amp; &quot;&#39;&quot;} but now I have the problem: &#39;Run-time error: &#39;9&#39;: Subscript out of range.  With the {TournamentResultDescription = TournamentResult(num)} code line highlighted as the problem."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478057013, "post_id": 40371821, "comment_id": 67997307, "body": "That&#39;s because <code>TournamentResult</code> only has 10 elements, and you&#39;re selecting random indexes between 0 and 50001."}, {"owner": {"reputation": 11, "user_id": 7102513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3598d5eec5d64a0a8afd5b7540bdd7?s=128&d=identicon&r=PG&f=1", "display_name": "DNguyen", "link": "https://stackoverflow.com/users/7102513/dnguyen"}, "edited": false, "score": 0, "creation_date": 1478057491, "post_id": 40371821, "comment_id": 67997407, "body": "Oh ok, I think I understand where I&#39;m going wrong now. Thank you Comintern!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 6937, "user_id": 1091308, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ccc75c826539146f2f9a5f7f9850076c?s=128&d=identicon&r=PG", "display_name": "Niyoko", "link": "https://stackoverflow.com/users/1091308/niyoko"}, "edited": false, "score": 0, "creation_date": 1478058307, "post_id": 40371821, "comment_id": 67997567, "body": "@NiyokoYuliawan you mean <a href=\"http://stackoverflow.com/a/16571156/1188513\">read here</a>, this is VBA in MS-Access/DAO, not VB.NET."}, {"owner": {"reputation": 6937, "user_id": 1091308, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ccc75c826539146f2f9a5f7f9850076c?s=128&d=identicon&r=PG", "display_name": "Niyoko", "link": "https://stackoverflow.com/users/1091308/niyoko"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1478058498, "post_id": 40371821, "comment_id": 67997611, "body": "@Mat&#39;sMug Yeah. I saw <code>Dim</code> statement and immediately thought it&#39;s VB.NET without saw the tags."}], "answers": [{"tags": [], "owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1478067419, "creation_date": 1478067419, "answer_id": 40373556, "question_id": 40371821, "link": "https://stackoverflow.com/questions/40371821/microsoft-visual-basic-run-time-error-3075-syntax-error-missing-operator-i/40373556#40373556", "title": "Microsoft Visual Basic - Run-time error &#39;3075: Syntax error (missing operator) in query expression &quot;1st&quot;, &#39;A&#39;, 1-Jan-15&#39;, &#39;1&#39;)&#39;", "body": "<p>Commenters are correct in their suggestions.</p>\n\n<p>These types of dynamic statements can be difficult to debug because of the concatenated strings - and you're making it doubly worse by doing extra concatenation of delimiters and commas.</p>\n\n<p>To me it looks like you just had an extra single quote (\"'\") in your SQL.</p>\n\n<p>Try:</p>\n\n<pre><code>InsertRecord = _\n    \"insert into TOURNAMENT_RESULT(TournamentResultNo, TournamentResult, DivisionEntered, DateOfTournament, MembershipNo) values ('\" &amp; _\n        TournamentResultNo &amp; \"','\" &amp; TournamentResultDescription &amp; \"','\" &amp; _\n        DivisionEnteredDescription &amp; \"','\" &amp; DateOfTournamentDescription &amp; _\n        \"','\" &amp; MembershipNo &amp; \"')\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1478076526, "creation_date": 1478076526, "answer_id": 40375678, "question_id": 40371821, "link": "https://stackoverflow.com/questions/40371821/microsoft-visual-basic-run-time-error-3075-syntax-error-missing-operator-i/40375678#40375678", "title": "Microsoft Visual Basic - Run-time error &#39;3075: Syntax error (missing operator) in query expression &quot;1st&quot;, &#39;A&#39;, 1-Jan-15&#39;, &#39;1&#39;)&#39;", "body": "<p>This is probably what you are after:</p>\n\n<pre><code>Public Function InsertRange()\n\n    Const Results   As Long = 50000\n\n    Dim dbs         As DAO.Database\n    Dim rst         As DAO.Recordset\n\n    Dim Num101      As Integer\n    Dim Num102      As Integer\n    Dim Num12       As Integer\n    Dim ResultNo    As Long\n\n    Set dbs = CurrentDb()\n    Set rst = dbs.OpenRecordset(\"Select Top 1 * From TOURNAMENT_RESULT\")\n\n    Randomize\n    For ResultNo = 1 To Results\n        Num101 = 1 + Int(10 * Rnd)\n        Num102 = 1 + Int(10 * Rnd)\n        Num12 = 1 + Int(12 * Rnd)\n        rst.AddNew\n            rst!TournamentResultNo.Value = ResultNo\n            rst!TournamentResult.Value = CStr(Num101) &amp; \"st\"\n            rst!DivisionEntered.Value = Chr(64 + Num102)\n            rst!DateOfTournament.Value = DateSerial(2015, Num12, Num12)\n            rst!MembershipNo.Value = ResultNo\n        rst.Update\n    Next\n    rst.Close\n\n    Set rst = Nothing\n    Set dbs = Nothing\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7102513, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d3598d5eec5d64a0a8afd5b7540bdd7?s=128&d=identicon&r=PG&f=1", "display_name": "DNguyen", "link": "https://stackoverflow.com/users/7102513/dnguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 435, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1478076526, "creation_date": 1478055679, "question_id": 40371821, "link": "https://stackoverflow.com/questions/40371821/microsoft-visual-basic-run-time-error-3075-syntax-error-missing-operator-i", "title": "Microsoft Visual Basic - Run-time error &#39;3075: Syntax error (missing operator) in query expression &quot;1st&quot;, &#39;A&#39;, 1-Jan-15&#39;, &#39;1&#39;)&#39;", "body": "<p>I'm trying to add 50,000 records to my Tournament_Result table in Microsoft Access but I have encountered this error: Run-time error '3075: Syntax error (missing operator) in query expression \"1st\", 'A', 1-Jan-15', '1')'.</p>\n\n<pre><code>  Option Compare Database\n  Option Explicit\n\n  Sub arrayData()\n  Dim TournamentResult() As Variant\n  Dim DivisionEntered() As Variant\n  Dim DateOfTournament() As Variant\n  Dim num As Long, TournamentResultNo As Long, MembershipNo As Long, dbs As    Database, InsertRecord As String\n  Dim num1 As Long 'we need to declare num1 as an Integer to create a loop\n  Dim TournamentResultDescription As String, DivisionEnteredDescription As String, DateOfTournamentDescription As String\n\n\n  Set dbs = CurrentDb()\n  TournamentResultNo = 0\n  MembershipNo = 0\n\n  TournamentResultNo = TournamentResultNo + 1\n  TournamentResult = Array(\"1st\", \"2nd\", \"3rd\", \"4th\", \"5th\", \"6th\", \"7th\",       \"8th\", \"9th\", \"10th\")\n  DivisionEntered = Array(\"A\", \"B\", \"C\", \"D\", \"E\", \"F\", \"G\", \"H\", \"I\", \"J\")\n  DateOfTournament = Array(\"1-Jan-15\", \"2-Feb-15\", \"3-Mar-15\", \"4-Apr-15\", \"5-May-15\", \"6-Jun-15\", \"7-July-15\", \"8-Aug-15\", \"9-Sep-15\", \"10-Oct-15\", \"11-Nov-15\", \"12-Dec-15\")\n  MembershipNo = MembershipNo + 1\n\n  For num1 = 0 To 50000 \n\n  num = Int((50000 - 0 + 1) * Rnd + 0)\n  TournamentResultDescription = TournamentResult(num)\n  DivisionEnteredDescription = DivisionEntered(num)\n  DateOfTournamentDescription = DateOfTournament(num)\n\n  InsertRecord = \"insert into TOURNAMENT_RESULT(TournamentResultNo, TournamentResult, DivisionEntered, DateOfTournament, MembershipNo) values (\" &amp; \"'\" &amp; TournamentResultNo &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; TournamentResultDescription &amp; \"'\" &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; DivisionEnteredDescription &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; DateOfTournamentDescription &amp; \"'\" &amp; \",\" &amp; \"'\" &amp; MembershipNo &amp; \"'\" &amp; \")\"\n\n  dbs.Execute InsertRecord\n  Debug.Print TournamentResultNo; TournamentResultDescription; DivisionEnteredDescription; DateOfTournamentDescription; MembershipNo\n\n  Next\n\nEnd Sub\n</code></pre>\n\n<p>EDIT: <code>dbs.Execute InsertRecord</code> is highlighted as the problem</p>\n"}, {"tags": ["excel", "if-statement", "vba"], "comments": [{"owner": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1478056636, "post_id": 40371810, "comment_id": 67997230, "body": "You would get better response if you posted the code you&#39;ve tried."}, {"owner": {"reputation": 13, "user_id": 7102421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b834b4b4b75f2473ac2980ce1602d0?s=128&d=identicon&r=PG&f=1", "display_name": "ManbyRiver", "link": "https://stackoverflow.com/users/7102421/manbyriver"}, "reply_to_user": {"reputation": 1831, "user_id": 2967019, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/rnBqX.jpg?s=128&g=1", "display_name": "mrbungle", "link": "https://stackoverflow.com/users/2967019/mrbungle"}, "edited": false, "score": 0, "creation_date": 1478058354, "post_id": 40371810, "comment_id": 67997575, "body": "Ok.  I did include a link to the file but I&#39;ve also now edited and included the code in the post. Thanks for commenting."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478090404, "post_id": 40371810, "comment_id": 68012124, "body": "You have a typo - <code>ActivCell</code> - on the first <code>If</code> statement.  Put <code>Option Explicit</code> at the top of all your modules to avoid this type of problem."}, {"owner": {"reputation": 13, "user_id": 7102421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b834b4b4b75f2473ac2980ce1602d0?s=128&d=identicon&r=PG&f=1", "display_name": "ManbyRiver", "link": "https://stackoverflow.com/users/7102421/manbyriver"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478127578, "post_id": 40371810, "comment_id": 68034117, "body": "@Comintern Thanks!  I don&#39;t know what I hadn&#39;t spotted that earlier.  I guess that&#39;s what happens when you stare at a screen too long.  The code now works.  I <b>really</b> appreciate your assistance."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 7102421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b834b4b4b75f2473ac2980ce1602d0?s=128&d=identicon&r=PG&f=1", "display_name": "ManbyRiver", "link": "https://stackoverflow.com/users/7102421/manbyriver"}, "is_accepted": true, "score": 0, "last_activity_date": 1478128153, "creation_date": 1478128153, "answer_id": 40391303, "question_id": 40371810, "link": "https://stackoverflow.com/questions/40371810/error-424-object-required-when-attempting-to-use-activecell-in-vba/40391303#40391303", "title": "Error 424 Object Required When attempting to use ActiveCell in VBA", "body": "<p>It turns out that all I needed was an extra \"e\" on \"ActivCell\" in the first if statement.  Ahh - the little things in life!  Thanks @Comintern for your editing assistance!  Glad I was already on the right track.</p>\n"}], "owner": {"reputation": 13, "user_id": 7102421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5b834b4b4b75f2473ac2980ce1602d0?s=128&d=identicon&r=PG&f=1", "display_name": "ManbyRiver", "link": "https://stackoverflow.com/users/7102421/manbyriver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 536, "favorite_count": 0, "accepted_answer_id": 40391303, "answer_count": 1, "score": -2, "last_activity_date": 1478128153, "creation_date": 1478055618, "last_edit_date": 1531164843, "question_id": 40371810, "link": "https://stackoverflow.com/questions/40371810/error-424-object-required-when-attempting-to-use-activecell-in-vba", "title": "Error 424 Object Required When attempting to use ActiveCell in VBA", "body": "<p>I work in education and I am trying to automatically allocate students to subject choices based on two defining factors: CLV (Curriculum Level) and their term of enrolment.  </p>\n\n<p>I have coded the <code>VBA</code> using a series of <code>if then else</code> statements which I want to be triggered by the selection of a variable from a data validation list to write values in the appropriate corresponding cells (using <code>activecell.offset</code>).  </p>\n\n<p>My first VBA coding test only required one \"if\" dependent on the activecell and it worked and was triggered directly from within the VBA editor, as I was unsure of how to get it to trigger from the data validation list selection.  </p>\n\n<p>As soon as I attempted to put in two other variables offset from the activecell using <code>And</code> commands, however, it returned an <code>Error 424 Object Required</code> statement and I'm not sure why.  </p>\n\n<p>I have included a link to the workbook and also posted the code below.  Any help appreciated!\n<a href=\"https://dl.dropboxusercontent.com/u/53138339/Curriculum%20Variations.xlsm\" rel=\"nofollow noreferrer\">Curriculum Variations File</a></p>\n\n<pre><code>Sub StandardEntry()\n    If ActiveCell.Value = \"Yes\" And ActivCell.Offset(0, -1).Value = \"Term 1\" And ActiveCell.Offset(0, -2).Value = \"CLV 7\" Then\n        CLV7Term1\n    Else\n    If ActiveCell.Value = \"Yes\" And ActiveCell.Offset(0, -1).Value = \"Term 2\" And ActiveCell.Offset(0, -2).Value = \"CLV 7\" Then\n        CLV7Term2\n    Else\n    If ActiveCell.Value = \"Yes\" And ActiveCell.Offset(0, -1).Value = \"Term 3\" And ActiveCell.Offset(0, -2).Value = \"CLV 7\" Then\n        CLV7Term3\n    Else\n    If ActiveCell.Value = \"Yes\" And ActiveCell.Offset(0, -1).Value = \"Term 4\" And ActiveCell.Offset(0, -2).Value = \"CLV 7\" Then\n        CLV7Term4\n    Else\n    If ActiveCell.Value = \"Yes\" And ActiveCell.Offset(0, -1).Value = \"Term 1\" And ActiveCell.Offset(0, -2).Value = \"CLV 8\" Then\n        CLV8Term1\n    Else\n    If ActiveCell.Value = \"Yes\" And ActiveCell.Offset(0, -1).Value = \"Term 2\" And ActiveCell.Offset(0, -2).Value = \"CLV 8\" Then\n        CLV8Term2\n    Else\n    If ActiveCell.Value = \"Yes\" And ActiveCell.Offset(0, -1).Value = \"Term 3\" And ActiveCell.Offset(0, -2).Value = \"CLV 8\" Then\n        CLV8Term3\n    Else\n    If ActiveCell.Value = \"Yes\" And ActiveCell.Offset(0, -1).Value = \"Term 4\" And ActiveCell.Offset(0, -2).Value = \"CLV 8\" Then\n        CLV8Term4\n    Else\n    If ActiveCell.Value = \"Yes\" And ActiveCell.Offset(0, -1).Value = \"Term 1\" And ActiveCell.Offset(0, -2).Value = \"CLV 9\" Then\n        CLV9Term1\n    Else\n    If ActiveCell.Value = \"Yes\" And ActiveCell.Offset(0, -1).Value = \"Term 2\" And ActiveCell.Offset(0, -2).Value = \"CLV 9\" Then\n        CLV9Term2\n    Else\n    If ActiveCell.Value = \"Yes\" And ActiveCell.Offset(0, -1).Value = \"Term 3\" And ActiveCell.Offset(0, -2).Value = \"CLV 9\" Then\n        CLV9Term3\n    Else\n    If ActiveCell.Value = \"Yes\" And ActiveCell.Offset(0, -1).Value = \"Term 4\" And ActiveCell.Offset(0, -2).Value = \"CLV 9\" Then\n        CLV9Term4\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If\n    End If \nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "hyperlink", "macros"], "comments": [{"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478054184, "post_id": 40371322, "comment_id": 67996593, "body": "I would have expected that your line saying <code>If ActiveSheet.Name &lt;&gt; &quot;log&quot; Then</code> would already be stopping the sheet named &quot;log&quot; from being deleted.  Is it actually named &quot;log&quot;?  Or is it perhaps called &quot;Log&quot;?"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478054387, "post_id": 40371322, "comment_id": 67996637, "body": "If row 2 and row 15 both have hyperlinks to Sheet2, and row 2 says &quot;Closed&quot; but row 15 says &quot;Open&quot;, are you expecting Sheet2 to be deleted or kept?  (Or will this be a non-issue because both rows should have the same status?)"}, {"owner": {"reputation": 1, "user_id": 7102359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23eac3ad6e674754f943e53b85bdd829?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/7102359/brian"}, "reply_to_user": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478089786, "post_id": 40371322, "comment_id": 68011772, "body": "The &#39;if ActiveSheet.name &lt;&gt; &quot;log&quot; then&#39; part of my code never seems to work.  I thought it would but it basically was ignored. I&#39;m not sure why it wasn&#39;t working but that is then why I asked the question.  To answer your other question, it should be a non-issue as they should be the same.  It appears Thomas&#39; code below is as he said a simpler approach and works just fine. Thanks"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478101245, "post_id": 40371322, "comment_id": 68019928, "body": "Testing for <code>&quot;log&quot;</code> won&#39;t work if the sheet is called <code>&quot;Log&quot;</code> or <code>&quot;LOG&quot;</code> due to the uppercase characters, so I was just wondering whether something simple like that was causing your issue.  (I was also thinking of other non-obvious differences, such as <code>&quot;0&quot;</code> instead of <code>&quot;o&quot;</code>, or a trailing space in the sheet name, but they would stop <code>Worksheets(&quot;log&quot;)</code> from working, so it couldn&#39;t be those sort if differences.)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7102359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23eac3ad6e674754f943e53b85bdd829?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/7102359/brian"}, "edited": false, "score": 0, "creation_date": 1478089927, "post_id": 40371574, "comment_id": 68011854, "body": "thanks Thomas.  This is simpler and does exactly what I needed."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6432984"}, "is_accepted": false, "score": 0, "last_activity_date": 1478053881, "creation_date": 1478053881, "answer_id": 40371574, "question_id": 40371322, "link": "https://stackoverflow.com/questions/40371322/how-to-loop-through-a-list-follow-a-hyperlink-and-delete-the-corresponding-wor/40371574#40371574", "title": "How to loop through a list, follow a hyperlink, and delete the corresponding worksheet", "body": "<p>A simpler approach would be to iterate over the hyperlinks in the column and use the hyperlink's properties to reference the adjacent cell to see if it equals <code>Closed</code>; then if it does, delete the hyperlinks target worksheet and clear the hyperlink.</p>\n\n<pre><code>Sub DeleteLinks()\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Dim link As Hyperlink\n    For Each link In Worksheets(\"log\").Columns(\"M\").Hyperlinks\n\n        If link.Range.Offset(0, -3) = \"Closed\" Then\n            On Error Resume Next\n            Range(link.SubAddress).Parent.Delete\n            On Error GoTo 0\n            link.Range.ClearContents\n        End If\n\n    Next\n\n    Application.DisplayAlerts = True\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7102359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/23eac3ad6e674754f943e53b85bdd829?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/7102359/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 856, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478053881, "creation_date": 1478051694, "last_edit_date": 1531164843, "question_id": 40371322, "link": "https://stackoverflow.com/questions/40371322/how-to-loop-through-a-list-follow-a-hyperlink-and-delete-the-corresponding-wor", "title": "How to loop through a list, follow a hyperlink, and delete the corresponding worksheet", "body": "<p>I have a workbook that contains about 150 worksheets.  The first worksheet is a table/list of information that is about 150 rows long and 16 columns wide and is named \"log\".  In col. 'j' of the \"log\" worksheet are cell values that are either contain new or closed.  In col. 'm' are hyperlinks to other worksheets in the workbook.  The goal of the code is to go through each row of the \"log\" sheet and identify if it contains closed in col. j. If yes, follow the corresponding hyperlink, in the same row, and delete the sheet.  The issue is that I have situations where the hyperlink is shared by multiple rows.  For instance, row 5 hyperlinks to sheet 2 and row 15 hyperlinks to sheet 2. My issue is that when the code comes to row 15 and goes to follow the hyperlink there is nothing to follow, thus, the \"log\" is the active sheet and the \"log\" ends up getting deleted and my code then bombs out.  Is there a way to write code that says that if the active sheet is the log sheet to not delete it or skip the code that is currently in place to delete a sheet and instead continue the loop?</p>\n\n<p>Here is the code...</p>\n\n<pre><code>Sub Deletelinks()\n\n'Macro will check to see if status is closed and if so it will\n'delete the supporting worksheet by following the hyperlink in\n'same row\n\nDim count As Integer\nDim lrow As Long\nDim Rng As Range\nSet Rng = Range(\"J2\")\nlrow = Worksheets(\"log\").Range(\"J\" &amp; Rows.count).End(xlUp).row - 1\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\nFor count = 1 To lrow\n    Sheets(\"log\").Activate\n    Rng.Offset(count - 1, 0).Activate\n    Select Case ActiveCell.Value = \"Closed\"\n        Case True\n            If ActiveCell.Offset(0, 3).Value = \"Click\" Then\n            ActiveCell.Offset(0, 3).Hyperlinks(1).Follow\n                If ActiveSheet.Name &lt;&gt; \"log\" Then\n                    With ActiveSheet\n                        ActiveWindow.SelectedSheets.delete\n                    End With\n                End If\n            End If\n        Case False\n    End Select\n Next count\n\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 6, "creation_date": 1478048203, "post_id": 40370849, "comment_id": 67995246, "body": "<code>Me</code> will work if your code is in a sheet module (where it will refer to the containing worksheet), but not in a regular module. <code>Me</code> is a way for object code to refer to &quot;itself&quot; (the object instance which it&#39;s running in)  Code in a regular module isn&#39;t in that kind of environment (ie it&#39;s not running in an object instance)"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 1, "creation_date": 1478050393, "post_id": 40370849, "comment_id": 67995813, "body": "You also haven&#39;t defined the variable <code>Row</code> anywhere.  (Unless, perhaps, you have defined it with module or project level scope but not included that part of your code in the question?)"}], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 3144505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc907c7947ecb936ec76c657357aa886?s=128&d=identicon&r=PG", "display_name": "Divyesh M.", "link": "https://stackoverflow.com/users/3144505/divyesh-m"}, "is_accepted": false, "score": 2, "last_activity_date": 1483025458, "creation_date": 1483025458, "answer_id": 41382684, "question_id": 40370849, "link": "https://stackoverflow.com/questions/40370849/creating-dictionary-error-invalid-use-of-me-keyword/41382684#41382684", "title": "Creating dictionary. Error invalid use of Me keyword", "body": "<p>I was in same issue and I foung solution !! \nbut anyone will not believe in reference list \"Microsoft Scripting Runtime\"  set priority to top 3rd. and it will start working and error will be gone.</p>\n"}], "owner": {"reputation": 1, "user_id": 7102257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb3606ed50c7223a6a184b4baff938fd?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Erickson", "link": "https://stackoverflow.com/users/7102257/jason-erickson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1483025458, "creation_date": 1478047871, "last_edit_date": 1531164843, "question_id": 40370849, "link": "https://stackoverflow.com/questions/40370849/creating-dictionary-error-invalid-use-of-me-keyword", "title": "Creating dictionary. Error invalid use of Me keyword", "body": "<p>this is my code. I have column C that has duplicate names and column B that has unique IDs I need to find which unique IDs match with what names and send an email to the names and paste the unique IDs in the email. I am getting an error on the first Me.Cells.</p>\n\n<p>Sub sendEmails()</p>\n\n<pre><code>Dim dict_emails As Scripting.dictionary\nSet dict_emails = New Scripting.dictionary\nDim objOutlook As Object\nDim objMailMessage As Object\nSet objOutlook = CreateObject(\"Outlook.Application\")\nDim row As Range\nDim table As ListObject\nDim row_index As Long\nDim strEmail As String\nDim strExeptionID As String\n\nActiveWorkbook.Sheets(\"New 0-30\").Select\n\nSet table = ActiveSheet.ListObjects(\"New_030_Table\")\n\nFor row_index = 1 To table.DataBodyRange.Rows.Count\n    strEmail = table.DataBodyRange(row_index, 3).Value\n    strExceptionID = table.DataBodyRange(row_index, 2).Value\n\n    If Not dict_emails.Exists(strEmail) Then\n        ' first time we have seen this name\n        dict_emails.Add strEmail, strExceptionID\n    Else\n        dict_emails(strEmail) = dict_emails(strEmail) &amp; vbCrLf &amp; strExceptionID\n    End If\nNext\n\nDim var_key As Variant\nFor Each var_key In dict_emails.Keys\nSet objMailMessage = objOutlook.CreateItem(0) ' create new mail\n    With objMailMessage\n        .To = \"\" &amp; var_key\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Exceptions Set to Expire in Less Than 30 Days\"\n        .Body = \"You have the following exceptions set to expire: \" &amp; vbCrLf &amp; dict_emails(var_key)\n        .Save ' save as draft\n    End With\nNext\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478040702, "post_id": 40369498, "comment_id": 67993300, "body": "I can&#39;t replicate this - your code works just fine for me."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 7101908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f3fc4bd86471781f69e75b968625ac?s=128&d=identicon&r=PG&f=1", "display_name": "TimF", "link": "https://stackoverflow.com/users/7101908/timf"}, "edited": false, "score": 0, "creation_date": 1478068114, "post_id": 40369936, "comment_id": 68000238, "body": "Thanks very much - that must be the problem - the document I have uses different line styles which have been set individually.  I wanted to use the macro to change all the colors without losing the individually set line styles. Seems the style and color need to be set together."}], "tags": [], "owner": {"reputation": 6285, "user_id": 1689180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ad05d9769522004486fcee2b3e53153?s=128&d=identicon&r=PG", "display_name": "KekuSemau", "link": "https://stackoverflow.com/users/1689180/kekusemau"}, "is_accepted": false, "score": 2, "last_activity_date": 1478041187, "creation_date": 1478041187, "answer_id": 40369936, "question_id": 40369498, "link": "https://stackoverflow.com/questions/40369498/change-colors-of-all-borders-in-all-tables-in-word-vba/40369936#40369936", "title": "Change colors of all borders in all tables in word vba", "body": "<p>I did not get the full mechanics, but is seems that your code does not work when some borders have been set individually.\nResetting the LineStyle and LineWidth first, then the color, works for me.<br>\nYou can shorten this down to this:</p>\n\n<pre><code>    With myTable\n        .Borders.InsideLineStyle = wdLineStyleSingle\n        .Borders.InsideLineWidth = wdLineWidth025pt\n        .Borders.InsideColor = mycolor\n\n        .Borders.OutsideLineStyle = wdLineStyleSingle\n        .Borders.OutsideLineWidth = wdLineWidth025pt\n        .Borders.OutsideColor = mycolor\n    End With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 7101908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f3fc4bd86471781f69e75b968625ac?s=128&d=identicon&r=PG&f=1", "display_name": "TimF", "link": "https://stackoverflow.com/users/7101908/timf"}, "is_accepted": false, "score": 1, "last_activity_date": 1478123847, "last_edit_date": 1478123847, "creation_date": 1478074522, "answer_id": 40375197, "question_id": 40369498, "link": "https://stackoverflow.com/questions/40369498/change-colors-of-all-borders-in-all-tables-in-word-vba/40375197#40375197", "title": "Change colors of all borders in all tables in word vba", "body": "<p>Thank you so much KekuSemau - once you pointed out what the problem was I could see the solution. My mistake was to try to deal with the whole table when it had individually set borders. I needed to deal with each cell individually.</p>\n\n<p>The following modification worked (although a bit ugly and horribly slow!):</p>\n\n<pre><code>Sub ChangeTableBordersColors()\nDim mycolor As WdColor\nDim aTable As Table\nDim i As Integer\nDim j As Integer\nDim Row As Integer\nDim Column As Integer\n\nmycolor = wdColorRed\nFor Each aTable In ActiveDocument.Tables\ni = aTable.Rows.Count\nj = aTable.Columns.Count\nFor Row = 1 To i\nFor Column = 1 To j\n    With aTable.Cell(Row, Column)\n    .Borders(wdBorderTop).Color = mycolor\n    .Borders(wdBorderBottom).Color = mycolor\n    .Borders(wdBorderLeft).Color = mycolor\n    .Borders(wdBorderRight).Color = mycolor\n    End With\nNext Column\nNext Row\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 7101908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f3fc4bd86471781f69e75b968625ac?s=128&d=identicon&r=PG&f=1", "display_name": "TimF", "link": "https://stackoverflow.com/users/7101908/timf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2426, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1593951024, "creation_date": 1478038598, "last_edit_date": 1593951024, "question_id": 40369498, "link": "https://stackoverflow.com/questions/40369498/change-colors-of-all-borders-in-all-tables-in-word-vba", "title": "Change colors of all borders in all tables in word vba", "body": "<p>I'm trying to write a macro to change the colours of all the borders of all the tables in a word document at once.</p>\n\n<p>My attempt at doing this changes only the top and bottom borders in my tables:</p>\n\n<pre><code>Sub ChangeTableBordersColors()\nDim mycolor As WdColor\nDim myTable As Table\nmycolor = wdColorRed\nFor Each myTable In ActiveDocument.Tables\nWith myTable\n.Borders(wdBorderTop).Color = mycolor\n.Borders(wdBorderBottom).Color = mycolor\n.Borders(wdBorderHorizontal).Color = mycolor\n.Borders(wdBorderVertical).Color = mycolor\n.Borders(wdBorderLeft).Color = mycolor\n.Borders(wdBorderRight).Color = mycolor\nEnd With\nNext\nEnd Sub\n</code></pre>\n\n<p>Can anyone suggest how to fix this?</p>\n"}, {"tags": ["excel", "excel-formula", "worksheet", "vba"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1478038744, "post_id": 40369384, "comment_id": 67992626, "body": "How does the worksheet get data from API? What API is used? Do you have any code?"}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1478038966, "post_id": 40369384, "comment_id": 67992700, "body": "Its a Forex software with excel integration it doesnt require any code all you have to do is just make new excel file on desktop and from software point that excel file and all data just starts showing on excel file like its in the software. And the cell i mention has a value of total traded volume on that object which keep increasing every 200ms"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1478211817, "post_id": 40369384, "comment_id": 68074597, "body": "Can&#39;t open an image by the link you provided (it just redirected to <a href=\"http://tinypic.com/view.php?pic=2uny5w2&amp;s=9#.WBu4ji197bg\" rel=\"nofollow noreferrer\">tinypic.com/view.php?pic=2uny5w2&amp;s=9#.WBu4ji197bg</a>). What do you intend to do with computed difference? Do you want to store this value somewhere each 200 ms, or just to display on another sheet?"}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1478707298, "post_id": 40369384, "comment_id": 68264311, "body": "Sorry mate. but it works fine here."}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1478707661, "post_id": 40369384, "comment_id": 68264552, "body": "No i dont want to store this value all i want is subtract the value which was 200ms before with the latest value (after 200ms). for example, at 03:14:25:200 (H:M:S:MS) the value was $2568 and at 03:14:25:400 (H:M:S:MS) the value increased to $2601. Now i want to subtract the old vlaue from the latest value which will give me the change. $2601-$2568= $33. This is what i want. Please help me thanks."}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1478724207, "post_id": 40369384, "comment_id": 68272984, "body": "I can see the image now ... i hope its visible for you too. in this image C column is auto-update and i want change in values in D."}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1479798053, "post_id": 40369384, "comment_id": 68697194, "body": "I want one more thing to update. If day cell changes its value all values set to zero or reset in calculation table.. because i left it to record data and when date changes values staring to giving me negative answers because next day values were smaller than yesterdays values. and whole sheet went in negative."}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1479798608, "post_id": 40369384, "comment_id": 68697425, "body": "Thats Date cell not day cell. typo error"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1479803302, "post_id": 40369384, "comment_id": 68699806, "body": "Please edit your question to add new details: the code you are running (for proper formatting see help), screenshot of the worksheet, and what is current and expected output. Comments are not for extended discussion."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1478087915, "post_id": 40370151, "comment_id": 68010633, "body": "I have added a image in my question to clarify my question ... this show how i am getting a data from software. <a href=\"http://i64.tinypic.com/2uny5w2.png\" rel=\"nofollow noreferrer\">i64.tinypic.com/2uny5w2.png</a>"}, {"owner": {"reputation": 670, "user_id": 7071093, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10202175266099488/picture?type=large", "display_name": "Jeff", "link": "https://stackoverflow.com/users/7071093/jeff"}, "reply_to_user": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1478202041, "post_id": 40370151, "comment_id": 68069897, "body": "Are you getting an error or just not getting the desired output? It will need to be modified in order to update in a single cell."}], "tags": [], "owner": {"reputation": 670, "user_id": 7071093, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/10202175266099488/picture?type=large", "display_name": "Jeff", "link": "https://stackoverflow.com/users/7071093/jeff"}, "is_accepted": false, "score": 1, "last_activity_date": 1478054977, "last_edit_date": 1478054977, "creation_date": 1478042655, "answer_id": 40370151, "question_id": 40369384, "link": "https://stackoverflow.com/questions/40369384/excel-calculate-increase-in-value-every-200ms/40370151#40370151", "title": "Excel calculate increase in value every 200ms", "body": "<p>First, enable Iterative Calculations in Excel by going to File -> Options -> Formulas and then checking the box next to \"Enable iterative calculation\".</p>\n\n<p>You need to define the following cells:</p>\n\n<pre><code>cell B1     0 (set to 1 to reset)\ncell B2     =IF($B$1 = 1,, $B$2 + 1)\n</code></pre>\n\n<p>Use the following formula and fill down from B9 for as many changes as you would like to see (This formula assumes you have maximum iterations set to 100):</p>\n\n<p><code>cell B9     =IF($B$1 = 1,\"\", IF($B$2 / 100 = $A9, $B$5, B9))</code></p>\n\n<p>I will try to show an example here. If your cell that automatically updates is B5, then the changes will be tracked in B9 and below as the cell is refreshed. It may not be exactly what you are looking for, but I think it is close.</p>\n\n<pre><code>     A      B\n1    reset  0\n2    count  500\n3       \n4       \n5    price  9\n6       \n7       \n8    ID     price\n9    1      11\n10   2      12\n11   3      13\n12   4      12\n13   5      9\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1479248915, "post_id": 40534577, "comment_id": 68475946, "body": "how do i setup DX and DY? and the second code why cant i use that code in the same worksheet?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1479255223, "post_id": 40534577, "comment_id": 68478006, "body": "@Yasir I removed excessive VBS for testing, and changed buffer size to 0. All constants now already set up correctly and ready to use. Have you placed the code in the worksheet? Do any values appear in column <code>D</code> after column <code>C</code> changed?"}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1479257959, "post_id": 40534577, "comment_id": 68478765, "body": "i am getting an error &quot;compile error user-defined type not defined&quot; and then it highlight this line &quot;oData(0 To Buf) As New Dictionary&quot;"}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1479259031, "post_id": 40534577, "comment_id": 68479029, "body": "i have also added references vba project .. but still not working"}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1479259599, "post_id": 40534577, "comment_id": 68479144, "body": "i have added this new library microsoft word 15.0 object libraray now the error is complie error &quot;invalid use of new keyword&quot;"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1479279098, "post_id": 40534577, "comment_id": 68484863, "body": "@Yasir read the code in my answer carefully, there is the comment <code>add reference to Microsoft Scripting Runtime</code>"}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1479300842, "post_id": 40534577, "comment_id": 68497785, "body": "Sorry again. i have one more question why the value doesn&#39;t stay until it changes? what is happening right now is that it shows me a value which is impossible to see because it turns it into zero straight away. Isnt there anyway where it stays until it changes rather than going back to zero."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1479305719, "post_id": 40534577, "comment_id": 68500960, "body": "@Yasir that means the Forex software updates the worksheet more often, e. g. putting the new value at the first time it changes the worksheet, and other 9 times just repeating the same value. Try to increase <code>Buf</code> constant value experimentally, one by one, until the result will not turn into zero immediately."}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1479328405, "post_id": 40534577, "comment_id": 68515568, "body": "i tried that but didn&#39;t work. can i record every cell indiviually?? like if put only one cell in range. i tried to put that but didn&#39;t work. just wondering how do i put one cell instead of range."}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1479329810, "post_id": 40534577, "comment_id": 68516385, "body": "ok i got the problem at this line &quot;.Offset(DY, DX).Value = .Value - oData(i)(.Address)&quot; its actually subtracting the new value to old if i am not wrong. In my case if the value didnt change then its subtracting it from the same value and the answer is zero. is there is any way if the old is equal to new value then do not subtract? instead show me an old value?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "reply_to_user": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1479332532, "post_id": 40534577, "comment_id": 68517762, "body": "@Yasir try the code within Update section of the answer"}, {"owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "edited": false, "score": 0, "creation_date": 1479333647, "post_id": 40534577, "comment_id": 68518311, "body": "i change this and this work fine &quot;If .Value &gt; oData(i)(.Address) Then .Offset(DY, DX).Value = .Value - oData(i)(.Address)&quot; you i will give a try to your looks more stable. Anyways Thank you so much for your help. I wish i could give you a hug hahaha. Need more people like you. Have a good day."}], "tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": true, "score": 0, "last_activity_date": 1479332428, "last_edit_date": 1479332428, "creation_date": 1478802386, "answer_id": 40534577, "question_id": 40369384, "link": "https://stackoverflow.com/questions/40369384/excel-calculate-increase-in-value-every-200ms/40534577#40534577", "title": "Excel calculate increase in value every 200ms", "body": "<p>I suggest VBA solution, based on worksheet change event handling. Open <strong>VBA Project</strong> and put the below code into the target worksheet in <strong>Microsoft Excel Objects</strong> section:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n    ' add reference to Microsoft Scripting Runtime via Menu - Tools - References\n\n    Const Scope = \"C2:C5\" ' monitoring area\n    Const DX = 1 ' horizontal result offset\n    Const DY = 0 ' vertical result offset\n    Const Buf = 0 ' FIFO buffer size\n\n    Static oData(0 To Buf) As New Dictionary\n    Static oIndex As New Dictionary\n    Dim rCells As Range\n    Dim oCell\n    Dim i As Long\n\n    Set rCells = Application.Intersect(Target, Target.Parent.Range(Scope))\n    If Not rCells Is Nothing Then\n        For Each oCell In rCells\n            With oCell\n                i = oIndex(.Address)\n                .Offset(DY, DX).Value = .Value - oData(i)(.Address)\n                oData(i)(.Address) = .Value\n                i = i + 1\n                If i &gt; Buf Then i = 0\n                oIndex(.Address) = i\n            End With\n        Next\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I added some comments for constants. Set the range which change to be monitored in <code>Scope</code>, the offsets where the resulting delta will be output in <code>DX</code> and <code>DY</code>, and as a bonus that algorithm supports computing delta not only between last and previous numbers, but also between any number of frames for each target cell via buffer organized as array of dictionaries, so set the size of the buffer in <code>Buf</code>, if you do not want to use the buffer then just leave <code>0</code> size, e. g. the value of <code>3</code> will compute delta between the last value and the one  delayed by 800 ms for your case.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>There is slightly simplified version of the code as requested in comment, put the below code into the target worksheet:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Const Scope = \"C2:C5\" ' monitoring area\n\n    Static oData As New Dictionary\n    Dim rCells As Range\n    Dim oCell\n    Dim dDelta\n\n    Set rCells = Application.Intersect(Target, Target.Parent.Range(Scope))\n    If Not rCells Is Nothing Then\n        For Each oCell In rCells\n            With oCell\n                dDelta = .Value - oData(.Address)\n                If dDelta &lt;&gt; 0 Then\n                    .Offset(0, 1).Value = dDelta\n                    oData(.Address) = .Value\n                End If\n            End With\n        Next\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7101860, "user_type": "registered", "profile_image": "https://graph.facebook.com/1138761032904702/picture?type=large", "display_name": "Yasir", "link": "https://stackoverflow.com/users/7101860/yasir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 40534577, "answer_count": 2, "score": 1, "last_activity_date": 1570452771, "creation_date": 1478037971, "last_edit_date": 1592644375, "question_id": 40369384, "link": "https://stackoverflow.com/questions/40369384/excel-calculate-increase-in-value-every-200ms", "title": "Excel calculate increase in value every 200ms", "body": "<p>I have this worksheet which gets data from API and its refreshes itself every 200 milliseconds. I want to calculate the change in value which is constantly increasing every 200 ms. For example Cell B2 has a value of 4 after 200 ms its changes to 7 then to 16 then to 26 etc, it just keeps adding value into it. All I want is to subtract the old value from the latest value to get the change for example 7-4=3 or 16-7=9 or 26-16=10.</p>\n<p>I have added an image for clarification. This shows how I'm getting a data from software. <a href=\"https://i.stack.imgur.com/y8QIi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/y8QIi.png\" alt=\"worksheet\" /></a></p>\n\n<p>And one more image:</p>\n<p><a href=\"https://i.stack.imgur.com/DBxZi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DBxZi.png\" alt=\"worksheet\" /></a></p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 37822, "user_id": 1231450, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b9c98b4ce12bf9fd925d8c35c8861bb2?s=128&d=identicon&r=PG", "display_name": "Jan", "link": "https://stackoverflow.com/users/1231450/jan"}, "edited": false, "score": 0, "creation_date": 1478038263, "post_id": 40369371, "comment_id": 67992441, "body": "Maybe simpler: <a href=\"https://regex101.com/r/1vrOT7/2\" rel=\"nofollow noreferrer\"><code>^(?!.*_)[\\dA-Z:$, ]+$</code></a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1478038495, "post_id": 40369371, "comment_id": 67992530, "body": "Do you need a regex pattern? Just playing around, I think you can do a simple script that just checks if the cell is a valid range. Take the cell, put it in <code>Range(cel.value).Select</code> and if it errors, it&#39;s not a range...?"}, {"owner": {"reputation": 461, "user_id": 6933790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ef7fb7c460676595845863a65a6461b?s=128&d=identicon&r=PG&f=1", "display_name": "J Reid", "link": "https://stackoverflow.com/users/6933790/j-reid"}, "edited": false, "score": 2, "creation_date": 1478039157, "post_id": 40369371, "comment_id": 67992770, "body": "Also named ranges are part of the collection <code>ThisWorkbook.Names</code>"}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1478041996, "post_id": 40369371, "comment_id": 67993681, "body": "@BruceWayne - <code>Range(&quot;AA55:E5&quot;).Select</code> and <code>Range(&quot;PCR1MM_YPCVolume&quot;).Select</code> are both valid statements (assuming that &quot;PCR1MM_YPCVolume&quot; is a cell/range name) so can&#39;t be used to differentiate between a range address and a range name."}, {"owner": {"reputation": 23427, "user_id": 6535336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4f1e6c107a50e0d51c5408fe5f9a566?s=128&d=identicon&r=PG&f=1", "display_name": "YowE3K", "link": "https://stackoverflow.com/users/6535336/yowe3k"}, "edited": false, "score": 0, "creation_date": 1478042132, "post_id": 40369371, "comment_id": 67993727, "body": "Why do you need to determine whether it is a built-in name (such as <code>&quot;AA55:E5&quot;</code>) or a user-defined name (such as <code>&quot;blahE5&quot;</code>) ?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1478042513, "post_id": 40369371, "comment_id": 67993818, "body": "Is this a practical application, or is this for your own learning purposes? What kind of madman would make up such wild named ranges?! Interesting question."}, {"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "edited": false, "score": 0, "creation_date": 1478055734, "post_id": 40369371, "comment_id": 67996979, "body": "Are you using this on a <code>Formula</code> object? A bit of context would be useful because it defines how we can use the start and end string anchors"}, {"owner": {"reputation": 577, "user_id": 3980994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65714e6a7993c40e1358b0b63afb6a31?s=128&d=identicon&r=PG&f=1", "display_name": "deasa", "link": "https://stackoverflow.com/users/3980994/deasa"}, "edited": false, "score": 0, "creation_date": 1478102493, "post_id": 40369371, "comment_id": 68020853, "body": "Thank you, everyone! This is a practical application. There&#39;s a function called <code>GetRange(nameOrAddress as string)</code> that gets a range based on the string parameter. Right now the way I am checking is by trying to get the range&#39;s name via <code>Range(nameOrAddress).Name.Name</code>. If it throws an error, I know that string isn&#39;t associated with a range with a name. This, in my estimation, would be a more efficient and complete way to quickly determine what the string is."}], "answers": [{"comments": [{"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "edited": false, "score": 0, "creation_date": 1478055418, "post_id": 40371766, "comment_id": 67996889, "body": "Great answer, just trying to clarify if OP wants it in the context of a Formula object or not."}, {"owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "edited": false, "score": 0, "creation_date": 1478066296, "post_id": 40371766, "comment_id": 67999593, "body": "Have you tried this in VBA? It&#39;s not working on mine."}, {"owner": {"reputation": 712, "user_id": 3957090, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/q5vNk.png?s=128&g=1", "display_name": "DrMarbuse", "link": "https://stackoverflow.com/users/3957090/drmarbuse"}, "reply_to_user": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "edited": false, "score": 0, "creation_date": 1527256190, "post_id": 40371766, "comment_id": 88073299, "body": "Great answer, added <code>[a-zA-Z]</code> in order to seach case insensitive. In VBA @AER has to reference Microsoft Scripting Regular Expressions 5.5 to use regExp."}], "tags": [], "owner": {"reputation": 4320, "user_id": 5103620, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8ae06ea53a316cc879b9100b3ff25bfc?s=128&d=identicon&r=PG", "display_name": "Sebastian Lenartowicz", "link": "https://stackoverflow.com/users/5103620/sebastian-lenartowicz"}, "is_accepted": true, "score": 8, "last_activity_date": 1478146838, "last_edit_date": 1478146838, "creation_date": 1478055276, "answer_id": 40371766, "question_id": 40369371, "link": "https://stackoverflow.com/questions/40369371/regex-to-determine-if-a-string-is-a-name-of-a-range-or-a-cells-address/40371766#40371766", "title": "Regex to determine if a string is a name of a range or a cell&#39;s address", "body": "<p>OK, this one's fun:</p>\n\n<pre><code>^\\$?[A-Z]+\\$?\\d+(?::\\$?[A-Z]+\\$?\\d+)?(?:,\\s*(?:\\$?[A-Z]+\\$?\\d+(?::\\$?[A-Z]+\\$?\\d+)?))*$\n</code></pre>\n\n<p>Let's break it down, because it's rather nasty. The magic subpattern, really, is this:</p>\n\n<pre><code>\\$?[A-Z]+\\$?\\d+\n</code></pre>\n\n<p>This little thing will match any single valid cell address, with optional absolute-value <code>$</code>s. The next bit,</p>\n\n<pre><code>(?::\\$?[A-Z]+\\$?\\d+)?\n</code></pre>\n\n<p>will match the same thing optionally (the <code>?</code> quantifier at the end), but preceded by a colon (<code>:</code>). That lets us get ranges. The next bit,</p>\n\n<pre><code>(?:,\\s*(?:\\$?[A-Z]+\\$?\\d+(?::\\$?[A-Z]+\\$?\\d+)?))*\n</code></pre>\n\n<p>matches the same thing as the first, but zero or more times (using the <code>*</code> quantifier), and preceded by a comma and optional spaces using the special <code>\\s</code> token (which means \"any whitespace\").</p>\n\n<p><a href=\"https://regex101.com/r/IuKe8u/2\" rel=\"noreferrer\">Demo on Regex101</a></p>\n\n<p>If we want to get really fancy (and, mind you, I have no idea whether Excel's regex engine supports this; I just wrote it for fun), we can use <a href=\"http://www.regular-expressions.info/recurse.html\" rel=\"noreferrer\">recursion</a> to accomplish the same thing:</p>\n\n<pre><code>^((\\$?[A-Z]+\\$?\\d+)(?::(?2))?)(?:,\\s*(?1))*$\n</code></pre>\n\n<p>In this case, the magic <code>\\$?[A-Z]+\\$?\\d+</code> is inside the <em>second</em> capturing group, which is used recursively by the <code>(?2)</code> token. The entire subpattern for a single address or range of them is contained within the <em>first</em> capture group, and is then used to match additional addresses or ranges in a list.</p>\n\n<p><a href=\"https://regex101.com/r/IuKe8u/3\" rel=\"noreferrer\">Demo on Regex101</a></p>\n"}, {"comments": [{"owner": {"reputation": 577, "user_id": 3980994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65714e6a7993c40e1358b0b63afb6a31?s=128&d=identicon&r=PG&f=1", "display_name": "deasa", "link": "https://stackoverflow.com/users/3980994/deasa"}, "edited": false, "score": 0, "creation_date": 1478103755, "post_id": 40373297, "comment_id": 68021624, "body": "Sorry for the poor timing of clarification and context on my part. This is not on a Formula object. The strings that get passed into this <code>GetRange(nameOrAddress)</code> look like the examples I provided."}], "tags": [], "owner": {"reputation": 1408, "user_id": 3251540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PbLpq.jpg?s=128&g=1", "display_name": "AER", "link": "https://stackoverflow.com/users/3251540/aer"}, "is_accepted": false, "score": 2, "last_activity_date": 1478066519, "last_edit_date": 1478066519, "creation_date": 1478065982, "answer_id": 40373297, "question_id": 40369371, "link": "https://stackoverflow.com/questions/40369371/regex-to-determine-if-a-string-is-a-name-of-a-range-or-a-cells-address/40373297#40373297", "title": "Regex to determine if a string is a name of a range or a cell&#39;s address", "body": "<p>So here's a regex for VBA which will find any cell reference irrespective where it is. </p>\n\n<p>NOTE: I've assumed you're performing this on a <code>Formula</code> object and thus doesn't require being at the start or end of the string; so you can have a string with cell references and cell names and it will only pick up the cell references as below:</p>\n\n<pre><code>(?:\\W|^)(\\$?[A-Z]{1,3}\\$?[0-9]{1,7}(:\\$?[A-Z]{1,3}\\$?[0-9]{1,7})?)(?!\\w)\n</code></pre>\n\n<p><code>(?:\\W|^)</code> is at the start and ensures that there is a non-word character before it or the start of the string (remove <code>|^</code> if it there is always a <code>=</code> at the start as in <code>Formula</code> objects) --- VBA I found out regrettably does not have a functioning negative lookbehind)</p>\n\n<p><code>(\\$?[A-Z]{1,3}\\$?[0-9]{1,7}(:\\$?[A-Z]{1,3}\\$?[0-9]{1,7})?)</code> finds the actual cell reference and is broken down below:</p>\n\n<ul>\n<li><code>\\$?[A-Z]{1,3}\\$?[0-9]{1,7}</code> matches to one to three capital letters (as applicable to Excel's possible current ranges;</li>\n<li><code>(:\\$?[A-Z]{1,3}\\$?[0-9]{1,7})?</code> is the same as above except it adds the option of a second cell reference after a column <code>?</code> makes it optional.</li>\n</ul>\n\n<p><code>(?!\\w)</code> is a negative look forward and says that the character after it must not be a word character (presumably in functions the only things you can have around a cell references are parentheses and operators).</p>\n\n<p>I wrote a VBA function in Excel and it returned the following with the above RegEx:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JZ5eF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JZ5eF.png\" alt=\"RegEx Output\"></a></p>\n\n<p>NB: It doesn't pick up obviously if the characters are in the right order as the reference <code>$AZO113:A4</code> is returned despite it being impossible.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5183070, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153400717140272/picture?type=large", "display_name": "Ali Hussain Al Khawaher", "link": "https://stackoverflow.com/users/5183070/ali-hussain-al-khawaher"}, "is_accepted": false, "score": 0, "last_activity_date": 1496743086, "creation_date": 1496743086, "answer_id": 44386899, "question_id": 40369371, "link": "https://stackoverflow.com/questions/40369371/regex-to-determine-if-a-string-is-a-name-of-a-range-or-a-cells-address/44386899#44386899", "title": "Regex to determine if a string is a name of a range or a cell&#39;s address", "body": "<p>After trying several solutions I had to modify a regex so it works for me. my version only support non-named ranges.</p>\n\n<pre><code>((?![\\=,\\(\\);])(\\w+!)|('.+'!))?((\\$?[A-Z]{1,3}\\$?[0-9]{1,7}(:\\$?[A-Z]{1,3}\\$?[0-9]{1,7})?)|(\\$?[A-Z]{1,3}(:\\$?[A-Z]{1,3}\\$?)))\n</code></pre>\n\n<p>It will capture ranges in all of the following situations</p>\n\n<pre><code>=FUNCTION(F:F)\n=FUNCTION($B22,G$5)\n=SUM($F$10:$F$11)\n=$J10-$K10\n=SUMMARY!D4\n</code></pre>\n\n<p>I created the following function for RegEx. but first tick the reference to \"Microsoft VBScript Regular Expressions 5.5\" from Tools>References</p>\n\n<pre><code>Function RegExp(ByVal sText As String, ByVal sPattern, Optional bGlobal As Boolean = True, Optional bIgnoreCase As Boolean = False, Optional bArray As Boolean = False) As Variant\n    Dim objRegex As New RegExp\n    Dim Matches As MatchCollection\n    Dim Match As Match\n    Dim i As Integer\n    objRegex.IgnoreCase = bIgnoreCase\n    objRegex.Global = bGlobal\n    objRegex.Pattern = sPattern\n    If objRegex.test(sText) Then\n        Set Matches = objRegex.Execute(sText)\n        If Matches.count &lt;&gt; 0 Then\n            If bArray Then ' if we want to return array instead of MatchCollection\n                ReDim aMatches(Matches.count - 1) As Variant\n                For Each Match In Matches\n                    aMatches(i) = Match.value\n                    i = i + 1\n                Next\n                RegExp = aMatches\n            Else\n                Set RegExp = Matches\n            End If\n        End If\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 577, "user_id": 3980994, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65714e6a7993c40e1358b0b63afb6a31?s=128&d=identicon&r=PG&f=1", "display_name": "deasa", "link": "https://stackoverflow.com/users/3980994/deasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2067, "favorite_count": 0, "accepted_answer_id": 40371766, "answer_count": 3, "score": 3, "last_activity_date": 1496845352, "creation_date": 1478037917, "last_edit_date": 1531161705, "question_id": 40369371, "link": "https://stackoverflow.com/questions/40369371/regex-to-determine-if-a-string-is-a-name-of-a-range-or-a-cells-address", "title": "Regex to determine if a string is a name of a range or a cell&#39;s address", "body": "<p>I'm struggling to come up with a regular expression pattern that can help me determine if a string is a cell's address or if it is a cell's name.</p>\n\n<p>Here are some examples of cell addresses:</p>\n\n<ul>\n<li>\"E5\"</li>\n<li>\"AA55:E5\"</li>\n<li>\"DD5555:DDD55555, E5, F5:AA55\"</li>\n<li>\"$F7:$G$7\"</li>\n</ul>\n\n<p>Here are some examples of cell names:</p>\n\n<ul>\n<li>\"bis_document_id\"</li>\n<li>\"PCR1MM_YPCVolume\"</li>\n<li>\"sheet_error7\"</li>\n<li>\"blahE5\"</li>\n<li>\"training_A1\"</li>\n<li>\"myNameIsGeorgeJR\"</li>\n</ul>\n\n<h2>Is there a regex pattern you guys can come up with that will match all of either group and none of the other?</h2>\n\n<p>I have been able to think of a couple of ways to determine what a string is not:</p>\n\n<ul>\n<li>If it has any other character than \"$\" or \":\" in it, I know it is not a cell's name and is most likely a cell's address.</li>\n<li>If it has more than three consecutive numbers, it is most likely not a cell's address.</li>\n<li>A cell's address is extremely unlikely to have more than 2 letters preceding a number, 99.9% of the cell addresses will be in columns A to ZZ.</li>\n</ul>\n\n<p>Alas, these three small tests can hardly prove what this string is.</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1478037816, "post_id": 40369214, "comment_id": 67992258, "body": "I don&#39;t have a full picture of what you&#39;re trying to do or what the problem is at all. More images would be helpful. It sounds like a very easy problem to solve."}, {"owner": {"reputation": 205, "user_id": 7016089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10211115229465070/picture?type=large", "display_name": "Leandro Moreira", "link": "https://stackoverflow.com/users/7016089/leandro-moreira"}, "reply_to_user": {"reputation": 6095, "user_id": 1274820, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/620aa435151f022b9c4070eae088d788?s=128&d=identicon&r=PG", "display_name": "user1274820", "link": "https://stackoverflow.com/users/1274820/user1274820"}, "edited": false, "score": 0, "creation_date": 1478038382, "post_id": 40369214, "comment_id": 67992486, "body": "Hi! thanks for answering! Sorry if i am not that clear..But I am attaching a new picture. In the picture you can see that Forecast_Quarter from one sheet  goes until A10(Whatever), and Record Source until A8. The second sheet the forecast_quarter starts at A11(the first blank cell) and goes to A23. As my formula is like, find the first blank cell and paste, my record source will start at B9, because this is where is the first blank, what I want is to start at the same row of the my second sheet forecast quarter(Wherever), in this case B11."}], "answers": [{"comments": [{"owner": {"reputation": 205, "user_id": 7016089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10211115229465070/picture?type=large", "display_name": "Leandro Moreira", "link": "https://stackoverflow.com/users/7016089/leandro-moreira"}, "edited": false, "score": 0, "creation_date": 1478104045, "post_id": 40374360, "comment_id": 68021789, "body": "you are the best, really. Thank you again! so good to see how people help here!"}, {"owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "reply_to_user": {"reputation": 205, "user_id": 7016089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10211115229465070/picture?type=large", "display_name": "Leandro Moreira", "link": "https://stackoverflow.com/users/7016089/leandro-moreira"}, "edited": false, "score": 0, "creation_date": 1478104805, "post_id": 40374360, "comment_id": 68022253, "body": "You are welcome. While I, sadly, am not the best. But glad to be of help."}], "tags": [], "owner": {"reputation": 27288, "user_id": 3598756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c840fcd62a8fd4c0c02530265154a4e9?s=128&d=identicon&r=PG&f=1", "display_name": "user3598756", "link": "https://stackoverflow.com/users/3598756/user3598756"}, "is_accepted": true, "score": 0, "last_activity_date": 1478071181, "creation_date": 1478071181, "answer_id": 40374360, "question_id": 40369214, "link": "https://stackoverflow.com/questions/40369214/paste-in-a-specific-range/40374360#40374360", "title": "Paste in a specific range", "body": "<p>store the row index used for \"L.EMEA.O\" and use it for \"L.EMEO.O\" as well:</p>\n\n<pre><code>   With Worksheets(\"L.NAM.M\")\n           With .Cells.Find(What:=\"forecast_quarter\", After:=ActiveCell, LookIn:= _\n               xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n               xlNext, MatchCase:=False, SearchFormat:=False)\n               .Parent.Range(.Offset(1), .Parent.Cells(Rows.Count, .Column).End(xlUp)).Copy _\n               Destination:=Worksheets(\"NewForecast\").Range(\"K\" &amp; Rows.Count).End(xlUp).Offset(1)\n           End With\n       End With\n\n    Dim L_EMEA_ORow As Long '&lt;--| variable to hold \"forecast_quarter\" sheet column \"K\" row index where to start pasting \"L.EMEA.O\" sheet data from\n    With Worksheets(\"L.EMEA.O\")\n       With .Cells.Find(What:=\"forecast_quarter\", After:=ActiveCell, LookIn:= _\n           xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n           xlNext, MatchCase:=False, SearchFormat:=False)\n           L_EMEA_ORow = Worksheets(\"NewForecast\").Range(\"K\" &amp; Rows.Count).End(xlUp).Offset(1).Row '&lt;--| store relevant row index where to start pasting data from\n           .Parent.Range(.Offset(1), .Parent.Cells(Rows.Count, .Column).End(xlUp)).Copy Destination:=Worksheets(\"NewForecast\").Range(\"K\" &amp; L_EMEA_ORow) '&lt;--| use relevant row index\n       End With\n    End With\n\n\n    'Record Source\n\n    With Worksheets(\"L.EMEO.O\")\n        With .Cells.Find(What:=\"Record Source\", After:=ActiveCell, LookIn:= _\n            xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n            xlNext, MatchCase:=False, SearchFormat:=False)\n            .Parent.Range(.Offset(1), .Parent.Cells(Rows.Count, .Column).End(xlUp)).Copy Destination:=Worksheets(\"NewForecast\").Range(\"N\" &amp; L_EMEA_ORow) '&lt;--| use same relevant row index calculated above\n        End With\n    End With\n</code></pre>\n"}], "owner": {"reputation": 205, "user_id": 7016089, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/10211115229465070/picture?type=large", "display_name": "Leandro Moreira", "link": "https://stackoverflow.com/users/7016089/leandro-moreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 40374360, "answer_count": 1, "score": 0, "last_activity_date": 1478071181, "creation_date": 1478037099, "last_edit_date": 1478055676, "question_id": 40369214, "link": "https://stackoverflow.com/questions/40369214/paste-in-a-specific-range", "title": "Paste in a specific range", "body": "<p><a href=\"https://i.stack.imgur.com/uazNe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uazNe.png\" alt=\"enter image description here\"></a></p>\n\n<p>Look the code below:</p>\n\n<pre><code> With Worksheets(\"L.NAM.M\")\n        With .Cells.Find(What:=\"forecast_quarter\", After:=ActiveCell, LookIn:= _\n            xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n            xlNext, MatchCase:=False, SearchFormat:=False)\n            .Parent.Range(.Offset(1), .Parent.Cells(Rows.Count, .Column).End(xlUp)).Copy _\n            Destination:=Worksheets(\"NewForecast\").Range(\"K\" &amp; Rows.Count).End(xlUp).Offset(1)\n        End With\n    End With\n\nWith Worksheets(\"L.EMEA.O\")\n    With .Cells.Find(What:=\"forecast_quarter\", After:=ActiveCell, LookIn:= _\n        xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n        xlNext, MatchCase:=False, SearchFormat:=False)\n        .Parent.Range(.Offset(1), .Parent.Cells(Rows.Count, .Column).End(xlUp)).Copy Destination:=Worksheets(\"NewForecast\").Range(\"K\" &amp; Rows.Count).End(xlUp).Offset(1)\n    End With\nEnd With\n\n\n      'Record Source\n\n        With Worksheets(\"L.EMEO.O\")\n        With .Cells.Find(What:=\"Record Source\", After:=ActiveCell, LookIn:= _\n            xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:= _\n            xlNext, MatchCase:=False, SearchFormat:=False)\n            .Parent.Range(.Offset(1), .Parent.Cells(Rows.Count, .Column).End(xlUp)).Copy Destination:=Worksheets(\"NewForecast\").Range(\"N\" &amp; Rows.Count).End(xlUp).Offset(1)\n        End With\n    End With\n</code></pre>\n\n<p>What I am doing here..I am getting data forecast_quarter of those two spreadsheets and pasting below the header of a new spreadsheet. So, it is finding the lastrow with data and pasting below. The trick part comes when look for Record Source from \"L.EMEA.O\", as the \"L.NAM.M\" does not have any data for column L, it messes up when I paste the L.EMEA.O data, as it does not align with the L.EMEA.O but with L.NAM.O. What I would like is to paste aligned the row of where it pasted the forecast_quarter for L.EMEA.O. </p>\n\n<p>Any ideas? I attache a photo </p>\n\n<p><a href=\"https://i.stack.imgur.com/tx4jD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tx4jD.png\" alt=\"enter image description here\"></a></p>\n\n<p>In this case it pasted in the K114,if i run the other piece, I want to paste in the same not in the N110, but N114.</p>\n"}, {"tags": ["excel", "vba", "date", "runtime-error", "copy-paste"], "comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 4, "creation_date": 1478035092, "post_id": 40368756, "comment_id": 67991071, "body": "On which line does the error occur ??"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 2, "creation_date": 1478035229, "post_id": 40368756, "comment_id": 67991126, "body": "@Gary&#39;sStudent - Every line with <code>Row.Count</code>...  ;-)  These should all be <code>.Rows.Count</code>.  All the <code>Range</code> and <code>Cells</code> calls inside <code>With</code> blocks should also be <code>.Range</code> and <code>.Cells</code>."}, {"owner": {"reputation": 41, "user_id": 6311795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c732a0342c6c581b96928d320eef9e4c?s=128&d=identicon&r=PG&f=1", "display_name": "sdrloveshim", "link": "https://stackoverflow.com/users/6311795/sdrloveshim"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1478035454, "post_id": 40368756, "comment_id": 67991232, "body": "@Gary&#39;s Student I don&#39;t know that&#39;s one of the main problems I&#39;m having."}, {"owner": {"reputation": 41, "user_id": 6311795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c732a0342c6c581b96928d320eef9e4c?s=128&d=identicon&r=PG&f=1", "display_name": "sdrloveshim", "link": "https://stackoverflow.com/users/6311795/sdrloveshim"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478035457, "post_id": 40368756, "comment_id": 67991234, "body": "@Comintern I&#39;ll give that a shot, thanks."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1478035613, "post_id": 40368756, "comment_id": 67991314, "body": "@Comintern is on it I think. I highly suggest also removing any uses of <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\"><code>.Select</code></a> as that can cause issues, especially if switching between multiple sheets."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 1, "creation_date": 1478035643, "post_id": 40368756, "comment_id": 67991328, "body": "A good custom is to include <code>Option Explicit</code> at the beginning of your module to force you to declare all your variables. In this vein I don&#39;t see where you declare <code>MonDate</code> or some of your other variables. That being said this error usually represents that you haven&#39;t qualified your object correctly. Tough to say without knowing exactly what line errors out. You can try placing a break point early on and step through your code line by line pressing F8. Let us know where the error ocurrs."}, {"owner": {"reputation": 41, "user_id": 6311795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c732a0342c6c581b96928d320eef9e4c?s=128&d=identicon&r=PG&f=1", "display_name": "sdrloveshim", "link": "https://stackoverflow.com/users/6311795/sdrloveshim"}, "edited": false, "score": 0, "creation_date": 1478035985, "post_id": 40368756, "comment_id": 67991489, "body": "@Comitern, I don&#39;t expect you to fix all my problems or anything, but I thought I&#39;d make you aware that your solution seems to have resolve my 424 error, and now I&#39;m getting a 438 error. Again with no debug option and I don&#39;t know what line is causing it."}, {"owner": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 1, "creation_date": 1478036273, "post_id": 40368756, "comment_id": 67991606, "body": "is there any class module executing."}, {"owner": {"reputation": 41, "user_id": 6311795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c732a0342c6c581b96928d320eef9e4c?s=128&d=identicon&r=PG&f=1", "display_name": "sdrloveshim", "link": "https://stackoverflow.com/users/6311795/sdrloveshim"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1478036335, "post_id": 40368756, "comment_id": 67991630, "body": "@Nbayly Thank you! I&#39;ve never been able to understand the step through feature very well, but it seems to have worked here to pin point the problem. I&#39;m currently getting error 438 when I move between  With Workbooks.Open(FilePathText &amp; MonDateFull &amp; &quot;.csv&quot;) to     CheckNumRows = .Cells(.Rows.Count, 1).End(xlUp).Row  Does that mean it&#39;s the CCheckNumRows = .Cells(.Rows.Count, 1).End(xlUp).Row is the line causing the error?"}, {"owner": {"reputation": 41, "user_id": 6311795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c732a0342c6c581b96928d320eef9e4c?s=128&d=identicon&r=PG&f=1", "display_name": "sdrloveshim", "link": "https://stackoverflow.com/users/6311795/sdrloveshim"}, "reply_to_user": {"reputation": 182, "user_id": 4723652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83d76e4d118165936de6866d5f42004?s=128&d=identicon&r=PG&f=1", "display_name": "Techie", "link": "https://stackoverflow.com/users/4723652/techie"}, "edited": false, "score": 0, "creation_date": 1478036522, "post_id": 40368756, "comment_id": 67991715, "body": "@HA560 There is a class module I was originally going to use, but I decided to make it a macro instead. It shouldn&#39;t be running but it is there. I don&#39;t need it anymore. I guess I&#39;ll try deleting it.  Edit: that does not seemed to have worked, but I needed to get rid of it anyway, so thank you."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 1, "creation_date": 1478036647, "post_id": 40368756, "comment_id": 67991774, "body": "When it errors out on the ` CheckNumRows...` line highlight individual parts of the line and add a watch to see what value populates. As a guess I would say that you have scoped to the workbook in your with but not scoped the sheet. Testing will tell you specifically what part of that line is not working."}, {"owner": {"reputation": 41, "user_id": 6311795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c732a0342c6c581b96928d320eef9e4c?s=128&d=identicon&r=PG&f=1", "display_name": "sdrloveshim", "link": "https://stackoverflow.com/users/6311795/sdrloveshim"}, "reply_to_user": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1478037273, "post_id": 40368756, "comment_id": 67992039, "body": "@nbayly I&#39;m not sure exactly how the watch works, but I see the values for monDateFull, CheckNumRows and FilePathText populate correctly. I did put a watch on .Cells(.Rows.Count, 1).End(xlUp).Row and nothing happens to that in terms of value or type, but I&#39;m not sure it&#39;s supposed show anything. I&#39;m guessing that&#39;s not a valid target to watch, but I really don&#39;t know."}, {"owner": {"reputation": 41, "user_id": 6311795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c732a0342c6c581b96928d320eef9e4c?s=128&d=identicon&r=PG&f=1", "display_name": "sdrloveshim", "link": "https://stackoverflow.com/users/6311795/sdrloveshim"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478037508, "post_id": 40368756, "comment_id": 67992129, "body": "@Comintern Sorry, I didn&#39;t see your comment about removing the .select until just now. I went a head and removed that, though it doesn&#39;t seem to have been causing my -current- errors."}, {"owner": {"reputation": 41, "user_id": 6311795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c732a0342c6c581b96928d320eef9e4c?s=128&d=identicon&r=PG&f=1", "display_name": "sdrloveshim", "link": "https://stackoverflow.com/users/6311795/sdrloveshim"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1478037670, "post_id": 40368756, "comment_id": 67992203, "body": "@Gary&#39;s Student Thanks to the help of Nbayly I&#39;ve found I&#39;m getting run time error 438 on line CheckNumRows = .Cells(.Rows.Count, 1).End(xlUp).Row"}], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 6311795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c732a0342c6c581b96928d320eef9e4c?s=128&d=identicon&r=PG&f=1", "display_name": "sdrloveshim", "link": "https://stackoverflow.com/users/6311795/sdrloveshim"}, "is_accepted": false, "score": 0, "last_activity_date": 1478101456, "creation_date": 1478101456, "answer_id": 40384086, "question_id": 40368756, "link": "https://stackoverflow.com/questions/40368756/spot-the-error-run-time-error-424-copying-date-between-workbooks/40384086#40384086", "title": "Spot the error (Run time error 424) copying date between workbooks", "body": "<p>Thanks for all your help! I was able to get this working. Code below for anyone interested.</p>\n\n<pre><code>Sub DailyReportCopyPaste()\nDim MonDateYear As String\nDim MonDateMonth As String\nDim MonDateDay As String\nDim SunDateYear As String\nDim SunDateMonth As String\nDim SunDateDay As String\nDim SatDateYear As String\nDim SatDateMonth As String\nDim SatDateDay As String\nDim FriDateYear As String\nDim FriDateMonth As String\nDim FriDateDay As String\nDim ThuDateYear As String\nDim ThuDateMonth As String\nDim ThuDateDay As String\nDim WedDateYear As String\nDim WedDateMonth As String\nDim WedDateDay As String\nDim TueDateYear As String\nDim TueDateMonth As String\nDim TueDateDay As String\nDim MonDateFull As String\nDim SunDateFull As String\nDim SatDateFull As String\nDim FriDateFull As String\nDim ThuDateFull As String\nDim WedDateFull As String\nDim TueDateFull As String\nDim FilePathText As String\nDim CheckNumRows As Integer\nDim MainWorkbook As Workbook\nDim rowcount As String\nDim rLastRow As Range\nDim r2LastRow As Range\nDim MondayWorkbook As Workbook\nDim SundayWorkBook As Workbook\nDim SaturdayWorkbook As Workbook\nDim FridayWorkbook As Workbook\nDim ThursdayWorkbook As Workbook\nDim WednesdayWorkbook As Workbook\nDim TuesdayWorkbook As Workbook\n\nMonDate = Date\nSunDate = Date - 1\nSatDate = Date - 2\nFriDate = Date - 3\nThuDate = Date - 4\nWedDate = Date - 5\nTueDate = Date - 6\n\nMonDateYear = DatePart(\"yyyy\", MonDate)\nMonDateMonth = Format(DatePart(\"m\", MonDate), \"00\")\nMonDateDay = Format(DatePart(\"d\", MonDate), \"00\")\nMonDateFull = MonDateYear &amp; MonDateMonth &amp; MonDateDay\n\nSunDateYear = DatePart(\"yyyy\", SunDate)\nSunDateMonth = Format(DatePart(\"m\", SunDate), \"00\")\nSunDateDay = Format(DatePart(\"d\", SunDate), \"00\")\nSunDateFull = SunDateYear &amp; SunDateMonth &amp; SunDateDay\n\nSatDateYear = DatePart(\"yyyy\", SatDate)\nSatDateMonth = Format(DatePart(\"m\", SatDate), \"00\")\nSatDateDay = Format(DatePart(\"d\", SatDate), \"00\")\nSatDateFull = SatDateYear &amp; SatDateMonth &amp; SatDateDay\n\nFriDateYear = DatePart(\"yyyy\", FriDate)\nFriDateMonth = Format(DatePart(\"m\", FriDate), \"00\")\nFriDateDay = Format(DatePart(\"d\", FriDate), \"00\")\nFriDateFull = FriDateYear &amp; FriDateMonth &amp; FriDateDay\n\nThuDateYear = DatePart(\"yyyy\", ThuDate)\nThuDateMonth = Format(DatePart(\"m\", ThuDate), \"00\")\nThuDateDay = Format(DatePart(\"d\", ThuDate), \"00\")\nThuDateFull = ThuDateYear &amp; ThuDateMonth &amp; ThuDateDay\n\nWedDateYear = DatePart(\"yyyy\", WedDate)\nWedDateMonth = Format(DatePart(\"m\", WedDate), \"00\")\nWedDateDay = Format(DatePart(\"d\", WedDate), \"00\")\nWedDateFull = WedDateYear &amp; WedDateMonth &amp; WedDateDay\n\nTueDateYear = DatePart(\"yyyy\", TueDate)\nTueDateMonth = Format(DatePart(\"m\", TueDate), \"00\")\nTueDateDay = Format(DatePart(\"d\", TueDate), \"00\")\nTueDateFull = TueDateYear &amp; TueDateMonth &amp; TueDateDay\n\nFilePathText = \"beggining of my file path\"\n\nSet MainWorkbook = ActiveWorkbook\nSheets(1).Cells.Clear\n\nSet MondayWorkbook = Workbooks.Open(FilePathText &amp; MonDateFull &amp; \".csv\")\n\nCheckNumRows = 0\nWith MondayWorkbook.Sheets(1)\n    CheckNumRows = .Cells(.Rows.Count, 1).End(xlUp).Row\n    .Rows(\"2:\" &amp; CheckNumRows).Copy\nEnd With\n\nMainWorkbook.Activate\nMainWorkbook.Sheets(1).Range(\"A1\").Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n\nMondayWorkbook.Close\n\nSet SundayWorkBook = Workbooks.Open(FilePathText &amp; SunDateFull &amp; \".csv\")\nCheckNumRows = 0\nWith SundayWorkBook.Sheets(1)\n    CheckNumRows = .Cells(.Rows.Count, 1).End(xlUp).Row\n    .Rows(\"2:\" &amp; CheckNumRows).Copy\nEnd With\n\nMainWorkbook.Activate\nMainWorkbook.Sheets(1).Range(\"a1\").End(xlDown).Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n\nSundayWorkBook.Close\n\nSet SaturdayWorkbook = Workbooks.Open(FilePathText &amp; SatDateFull &amp; \".csv\")\nCheckNumRows = 0\nWith SaturdayWorkbook.Sheets(1)\n    CheckNumRows = .Cells(.Rows.Count, 1).End(xlUp).Row\n    .Rows(\"2:\" &amp; CheckNumRows).Copy\nEnd With\n\nMainWorkbook.Activate\nMainWorkbook.Sheets(1).Range(\"a1\").End(xlDown).Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n\nSaturdayWorkbook.Close\n\nSet FridayWorkbook = Workbooks.Open(FilePathText &amp; FriDateFull &amp; \".csv\")\nCheckNumRows = 0\nWith FridayWorkbook.Sheets(1)\n    CheckNumRows = .Cells(.Rows.Count, 1).End(xlUp).Row\n    .Rows(\"2:\" &amp; CheckNumRows).Copy\nEnd With\n\nMainWorkbook.Activate\nMainWorkbook.Sheets(1).Range(\"a1\").End(xlDown).Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n\nFridayWorkbook.Close\n\nSet ThursdayWorkbook = Workbooks.Open(FilePathText &amp; ThuDateFull &amp; \".csv\")\nCheckNumRows = 0\nWith ThursdayWorkbook.Sheets(1)\n    CheckNumRows = .Cells(.Rows.Count, 1).End(xlUp).Row\n    .Rows(\"2:\" &amp; CheckNumRows).Copy\nEnd With\n\nMainWorkbook.Activate\nMainWorkbook.Sheets(1).Range(\"a1\").End(xlDown).Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n\nThursdayWorkbook.Close\n\nSet WednesdayWorkbook = Workbooks.Open(FilePathText &amp; WedDateFull &amp; \".csv\")\nCheckNumRows = 0\nWith WednesdayWorkbook.Sheets(1)\n    CheckNumRows = .Cells(.Rows.Count, 1).End(xlUp).Row\n    .Rows(\"2:\" &amp; CheckNumRows).Copy\nEnd With\n\nMainWorkbook.Activate\nMainWorkbook.Sheets(1).Range(\"a1\").End(xlDown).Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n\nWednesdayWorkbook.Close\n\nSet TuesdayWorkbook = Workbooks.Open(FilePathText &amp; TueDateFull &amp; \".csv\")\nCheckNumRows = 0\nWith TuesdayWorkbook.Sheets(1)\n    CheckNumRows = .Cells(.Rows.Count, 1).End(xlUp).Row\n    .Rows(\"2:\" &amp; CheckNumRows).Copy\nEnd With\n\nMainWorkbook.Activate\nMainWorkbook.Sheets(1).Range(\"a1\").End(xlDown).Offset(1, 0).Select\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nApplication.CutCopyMode = False\n\nSet rLastRow = Cells(Rows.Count, \"A\").End(xlUp)\nrLastRow.Offset(-1).Resize(2).EntireRow.Delete\n\nRange(\"A1:o\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row).Select\nSelection.Copy\n\nTuesdayWorkbook.Close\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 6311795, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/c732a0342c6c581b96928d320eef9e4c?s=128&d=identicon&r=PG&f=1", "display_name": "sdrloveshim", "link": "https://stackoverflow.com/users/6311795/sdrloveshim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1478101456, "creation_date": 1478034905, "question_id": 40368756, "link": "https://stackoverflow.com/questions/40368756/spot-the-error-run-time-error-424-copying-date-between-workbooks", "title": "Spot the error (Run time error 424) copying date between workbooks", "body": "<p>Semi new to VBA and my code is throwing run time error 424 object required. I realize is not the most efficient code, but that doesn't matter to me so long as it works. Unfortunately it's not working. I wish that this error gave me the option to debug and see what line is causing it, but oh well. </p>\n\n<p>My code is essentially opening 7 workbooks with dates in the file name that are the last seven days then copying data from each to a single workbook. I'm just trying to save a co worker a chunk of his time and learn a little more about vba. My code is listed below.</p>\n\n<pre><code>Sub DailyReportCopyPaste()\nDim MonDateYear As String\nDim MonDateMonth As String\nDim MonDateDay As String\nDim SunDateYear As String\nDim SunDateMonth As String\nDim SunDateDay As String\nDim SatDateYear As String\nDim SatDateMonth As String\nDim SatDateDay As String\nDim FriDateYear As String\nDim FriDateMonth As String\nDim FriDateDay As String\nDim ThuDateYear As String\nDim ThuDateMonth As String\nDim ThuDateDay As String\nDim WedDateYear As String\nDim WedDateMonth As String\nDim WedDateDay As String\nDim TueDateYear As String\nDim TueDateMonth As String\nDim TueDateDay As String\nDim MonDateFull As String\nDim SunDateFull As String\nDim SatDateFull As String\nDim FriDateFull As String\nDim ThuDateFull As String\nDim WedDateFull As String\nDim TueDateFull As String\nDim FilePathText As String\nDim CheckNumRows As Integer\nDim MainWorkbook As Workbook\nDim rowcount As String\n\nMonDate = Date\nSunDate = Date - 1\nSatDate = Date - 2\nFriDate = Date - 3\nThuDate = Date - 4\nWedDate = Date - 5\nTueDate = Date - 6\n\nMonDateYear = DatePart(\"yyyy\", MonDate)\nMonDateMonth = Format(DatePart(\"m\", MonDate), \"00\")\nMonDateDay = Format(DatePart(\"d\", MonDate), \"00\")\nMonDateFull = MonDateYear &amp; MonDateMonth &amp; MonDateDay\n\nSunDateYear = DatePart(\"yyyy\", SunDate)\nSunDateMonth = Format(DatePart(\"m\", SunDate), \"00\")\nSunDateDay = Format(DatePart(\"d\", SunDate), \"00\")\nSunDateFull = SunDateYear &amp; SunDateMonth &amp; SunDateDay\n\nSatDateYear = DatePart(\"yyyy\", SatDate)\nSatDateMonth = Format(DatePart(\"m\", SatDate), \"00\")\nSatDateDay = Format(DatePart(\"d\", SatDate), \"00\")\nSatDateFull = SatDateYear &amp; SatDateMonth &amp; SatDateDay\n\nFriDateYear = DatePart(\"yyyy\", FriDate)\nFriDateMonth = Format(DatePart(\"m\", FriDate), \"00\")\nFriDateDay = Format(DatePart(\"d\", FriDate), \"00\")\nFriDateFull = FriDateYear &amp; FriDateMonth &amp; FriDateDay\n\nThuDateYear = DatePart(\"yyyy\", ThuDate)\nThuDateMonth = Format(DatePart(\"m\", ThuDate), \"00\")\nThuDateDay = Format(DatePart(\"d\", ThuDate), \"00\")\nThuDateFull = ThuDateYear &amp; ThuDateMonth &amp; ThuDateDay\n\nWedDateYear = DatePart(\"yyyy\", WedDate)\nWedDateMonth = Format(DatePart(\"m\", WedDate), \"00\")\nWedDateDay = Format(DatePart(\"d\", WedDate), \"00\")\nWedDateFull = WedDateYear &amp; WedDateMonth &amp; WedDateDay\n\nTueDateYear = DatePart(\"yyyy\", TueDate)\nTueDateMonth = Format(DatePart(\"m\", TueDate), \"00\")\nTueDateDay = Format(DatePart(\"d\", TueDate), \"00\")\nTueDateFull = TueDateYear &amp; TueDateMonth &amp; TueDateDay\n\nFilePathText = \"The beggining of the file path\"\n\nCheckNumRows = 0\nWith Workbooks.Open(FilePathText &amp; MonDateFull &amp; \".csv\")\n    CheckNumRows = Cells(Row.Count, 1).End(xlUp).Row\n    Rows(\"2:\" &amp; CheckNumRows).Select\n    Selection.Copy\nEnd With\n\nWith Workbooks.Open(\"File path for the sheet I'm pasting into\")\n    Set MainWorkbook = ActiveWorkbook\n    Range(\"A1\").Select\n    Selection.Paste\n    .Close\nEnd With\n\nCheckNumRows = 0\nWith Workbooks.Open(FilePathText &amp; SunDateFull &amp; \".csv\")\n    CheckNumRows = Cells(Row.Count, 1).End(xlUp).Row\n    Rows(\"2:\" &amp; CheckNumRows).Select\n    Selection.Copy\nEnd With\n\nWith MainWorkbook\n    Range(\"a1\").End(xlDown).Offset(1, 0).Select\n    Selection.Paste\nEnd With\n\nCheckNumRows = 0\nWith Workbooks.Open(FilePathText &amp; SatDateFull &amp; \".csv\")\n    CheckNumRows = Cells(Row.Count, 1).End(xlUp).Row\n    Rows(\"2:\" &amp; CheckNumRows).Select\n    Selection.Copy\n    .Close\nEnd With\n\nWith MainWorkbook\n    Range(\"a1\").End(xlDown).Offset(1, 0).Select\n    Selection.Paste\nEnd With\n\nCheckNumRows = 0\nWith Workbooks.Open(FilePathText &amp; FriDateFull &amp; \".csv\")\n    CheckNumRows = Cells(Row.Count, 1).End(xlUp).Row\n    Rows(\"2:\" &amp; CheckNumRows).Select\n    Selection.Copy\n    .Close\nEnd With\n\nWith MainWorkbook\n    Range(\"a1\").End(xlDown).Offset(1, 0).Select\n    Selection.Paste\nEnd With\n\nCheckNumRows = 0\nWith Workbooks.Open(FilePathText &amp; ThuDateFull &amp; \".csv\")\n    CheckNumRows = Cells(Row.Count, 1).End(xlUp).Row\n    Rows(\"2:\" &amp; CheckNumRows).Select\n    Selection.Copy\n    .Close\nEnd With\n\nWith MainWorkbook\n    Range(\"a1\").End(xlDown).Offset(1, 0).Select\n    Selection.Paste\nEnd With\n\nCheckNumRows = 0\nWith Workbooks.Open(FilePathText &amp; WedDateFull &amp; \".csv\")\n    CheckNumRows = Cells(Row.Count, 1).End(xlUp).Row\n    Rows(\"2:\" &amp; CheckNumRows).Select\n    Selection.Copy\n    .Close\nEnd With\n\nWith MainWorkbook\n    Range(\"a1\").End(xlDown).Offset(1, 0).Select\n    Selection.Paste\nEnd With\n\nCheckNumRows = 0\nWith Workbooks.Open(FilePathText &amp; TueDateFull &amp; \".csv\")\n    CheckNumRows = Cells(Row.Count, 1).End(xlUp).Row\n    Rows(\"2:\" &amp; CheckNumRows).Select\n    Selection.Copy\n    .Close\nEnd With\n\nWith MainWorkbook\n    Range(\"a1\").End(xlDown).Offset(1, 0).Select\n    Selection.Paste\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>I have tried removing all of the Dim MonDayYear As String and etc to see if the fact that it's a string rather than a date was causing it, but it doesn't seem to have helped. Unless it won't function as an undeclared variable either... All that is is to get the date into the proper format for the file extension anyway. The file extensions look like \"sometext-20161031.csv\" and I don't know how to get the date feature to show in YYYYMMDD.</p>\n\n<p>Any help on dealing with the 424 error, the date format issue, or anything else you may see is much appreciated! Sorry this is a mess, I'm still learning.</p>\n"}, {"tags": ["vba", "ms-access", "import"], "answers": [{"tags": [], "owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "is_accepted": false, "score": 0, "last_activity_date": 1478034399, "creation_date": 1478034399, "answer_id": 40368653, "question_id": 40368414, "link": "https://stackoverflow.com/questions/40368414/why-does-access-change-the-range-in-docmd-transferspreadsheet/40368653#40368653", "title": "Why does Access change the Range in doCmd.TransferSpreadsheet?", "body": "<p>From the documentation on <a href=\"https://msdn.microsoft.com/en-us/library/office/ff844793.aspx\" rel=\"nofollow noreferrer\">DoCmd.TransferSpreadsheet</a></p>\n\n<blockquote>\n  <p>A string expression that's a valid range of cells or the name of a range in the spreadsheet. This argument applies only to importing. Leave this argument blank to import the entire spreadsheet. When you export to a spreadsheet, you must leave this argument blank. If you enter a range, the export will fail.</p>\n</blockquote>\n\n<p>If you did just </p>\n\n<pre><code>DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12Xml, \"ApplicationLevelSummary_In\", \"C:\\Users\\gfunk\\Desktop\\unserved2.xlsx\", True\n</code></pre>\n\n<p>and <code>C:\\Users\\gfunk\\Desktop\\unserved2.xlsx</code> already exists, then it will be put into A1 of a new worksheet called <code>ApplicationLevelSummary_In</code></p>\n\n<p>If you need your data to go to a specific range I'd suggest using COM automation instead. It is still fast but it's no one-liner.</p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 6860683, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/288d060fee26e8cf4048a9b91f8dc8a7?s=128&d=identicon&r=PG&f=1", "display_name": "gfunkdave", "link": "https://stackoverflow.com/users/6860683/gfunkdave"}, "is_accepted": true, "score": 0, "last_activity_date": 1478090706, "creation_date": 1478090706, "answer_id": 40380304, "question_id": 40368414, "link": "https://stackoverflow.com/questions/40368414/why-does-access-change-the-range-in-docmd-transferspreadsheet/40380304#40380304", "title": "Why does Access change the Range in doCmd.TransferSpreadsheet?", "body": "<p>Turns out it didn't like the single quotes or the dollar signs in the ranges. Once I removed them and passed the entire string as a flat string, it worked fine.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10586582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7454c39ff0c5241c7b1a361ad54e18c7?s=128&d=identicon&r=PG&f=1", "display_name": "DebbieDoesData", "link": "https://stackoverflow.com/users/10586582/debbiedoesdata"}, "is_accepted": false, "score": 0, "last_activity_date": 1550031223, "creation_date": 1550031223, "answer_id": 54662393, "question_id": 40368414, "link": "https://stackoverflow.com/questions/40368414/why-does-access-change-the-range-in-docmd-transferspreadsheet/54662393#54662393", "title": "Why does Access change the Range in doCmd.TransferSpreadsheet?", "body": "<p>I think I've found an answer to this troubling issue.  I had the same issue with Access replacing the \"!\" character with a \"$\" in a range string that I passed to the Range:= parameter of the DoCmd.TransferSpreadsheet routine.  Finally, I tried to separate the worksheet name and the address range into two different strings, concatenating them with a \"!\", as in:</p>\n\n<pre><code>strSheetName = \"MySheet\"\nstrRange = \"A1:Q789\"\n\nDoCmd.TransferSpreadsheet _\n  TransferType:=acImport, _\n  SpreadsheetType:=acSpreadsheetTypeExcel12Xml, _\n  TableName:=\"tblImport\", _\n  FileName:=strFilename, _\n  HasFieldNames:=True, _\n  Range:=strSheetName &amp; \"!\" &amp; strRange\n</code></pre>\n\n<p>I had success in convincing Access to import the sheet and the range I wanted it to, instead of allowing it to replace the \"!\" with a \"$\".</p>\n\n<p>Hope this helps you as it did me.</p>\n"}], "owner": {"reputation": 13, "user_id": 6860683, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/288d060fee26e8cf4048a9b91f8dc8a7?s=128&d=identicon&r=PG&f=1", "display_name": "gfunkdave", "link": "https://stackoverflow.com/users/6860683/gfunkdave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 779, "favorite_count": 0, "accepted_answer_id": 40380304, "answer_count": 3, "score": 1, "last_activity_date": 1550031223, "creation_date": 1478033363, "question_id": 40368414, "link": "https://stackoverflow.com/questions/40368414/why-does-access-change-the-range-in-docmd-transferspreadsheet", "title": "Why does Access change the Range in doCmd.TransferSpreadsheet?", "body": "<p>I am trying to automate importing various ranges in various copies of the same Excel workbook into Access.</p>\n\n<p>The relevant line of code that's causing the error is:</p>\n\n<pre><code>        DoCmd.TransferSpreadsheet acImport, acSpreadsheetTypeExcel12Xml, \"ApplicationLevelSummary_In\", \"C:\\Users\\gfunk\\Desktop\\unserved2.xlsx\", True, \"'BPO Use Only'!A3:Z11\"\n</code></pre>\n\n<p>The error is:</p>\n\n<blockquote>\n  <p>The Microsoft Access database engine could not find the object ''BPO Use Only'$A3:Z11'. Make sure the object exists and that you spell its name and the path name correctly. If ''BPO Use Only'$A3:Z11' is not a local object, check your network connection or contact the server administrator.</p>\n</blockquote>\n\n<p>As you can see, it's removing the exclamation point after the worksheet name and doing some funky things with the quotes. What's going on here?</p>\n\n<p>I can't rename the sheets in the workbook, as they've already been distributed to people who will fill them out.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478033802, "post_id": 40368373, "comment_id": 67990424, "body": "<code>ActiveWindow</code> and <code>appObject.ActiveWindow</code> are the same thing - you just don&#39;t need to qualify it within its own application object."}, {"owner": {"reputation": 2089, "user_id": 2901085, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jxiyV.jpg?s=128&g=1", "display_name": "OldUgly", "link": "https://stackoverflow.com/users/2901085/oldugly"}, "edited": false, "score": 1, "creation_date": 1478033938, "post_id": 40368373, "comment_id": 67990490, "body": "As per <a href=\"https://msdn.microsoft.com/en-us/library/office/ff835196.aspx\" rel=\"nofollow noreferrer\">this</a>, try <code>Windows(&quot;book1.xls&quot;).DisplayGridlines = False</code> ."}, {"owner": {"reputation": 777, "user_id": 1218959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/37cdc38e927f8909e66e091d25282f41?s=128&d=identicon&r=PG", "display_name": "tempidope", "link": "https://stackoverflow.com/users/1218959/tempidope"}, "edited": false, "score": 0, "creation_date": 1478034478, "post_id": 40368373, "comment_id": 67990789, "body": "Sorry guys, Windows(&quot;filename.xls&quot;) gives me subscript out of range. That XLS is not open because of the appObject.Visible=False if that makes any sense."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1478034507, "post_id": 40368373, "comment_id": 67990800, "body": "Do you have a reference to the Workbook?"}, {"owner": {"reputation": 777, "user_id": 1218959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/37cdc38e927f8909e66e091d25282f41?s=128&d=identicon&r=PG", "display_name": "tempidope", "link": "https://stackoverflow.com/users/1218959/tempidope"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478034658, "post_id": 40368373, "comment_id": 67990874, "body": "@Comintern yes I do. I&#39;ve got reference to the sheets, workbook and the application object."}], "answers": [{"comments": [{"owner": {"reputation": 777, "user_id": 1218959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/37cdc38e927f8909e66e091d25282f41?s=128&d=identicon&r=PG", "display_name": "tempidope", "link": "https://stackoverflow.com/users/1218959/tempidope"}, "edited": false, "score": 0, "creation_date": 1478034451, "post_id": 40368583, "comment_id": 67990779, "body": "Sorry @Tim, subscript out of range. That XLS is not open because of the appObject.Visible=False if that makes any sense."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 777, "user_id": 1218959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/37cdc38e927f8909e66e091d25282f41?s=128&d=identicon&r=PG", "display_name": "tempidope", "link": "https://stackoverflow.com/users/1218959/tempidope"}, "edited": false, "score": 0, "creation_date": 1478035244, "post_id": 40368583, "comment_id": 67991135, "body": "I&#39;d need to see more code. So far the only code dim&#39;s an object then sets it invisible. Dimming it is not the same as creating it. Comintern just posted some code for looping through all the windows but it will fail until a workbook is actually created (which we would see in more of your code)."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1478035318, "post_id": 40368583, "comment_id": 67991167, "body": "@Tim - Thus the Workbook as a parameter.  ;-)"}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 2, "last_activity_date": 1478034055, "creation_date": 1478034055, "answer_id": 40368583, "question_id": 40368373, "link": "https://stackoverflow.com/questions/40368373/how-can-i-turn-off-gridlines-in-excel-using-vba-without-using-activewindow/40368583#40368583", "title": "How can I turn off gridlines in excel using VBA, without using ActiveWindow", "body": "<p>The ActiveWindow is a member of the Windows objects collection. As with any collection, simply refer to the actual window by name rather than by specifying the active window. eg</p>\n\n<pre><code>Windows(\"My Workbook.xls\").DisplayGridlines = False\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1478037049, "post_id": 40368746, "comment_id": 67991947, "body": "Dem trickeh parameters! xD But seriously. The MSDN documentation mentions that Sheets is a child of Windows. <a href=\"http://www.mrexcel.com/forum/excel-questions/320215-worksheetview-object.html\" rel=\"nofollow noreferrer\">Mr. Excel</a> has a nice demo of what good can come of two windows for the same workbook. I&#39;m trying to wrap my head around it more."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "edited": false, "score": 0, "creation_date": 1478039102, "post_id": 40368746, "comment_id": 67992752, "body": "@Tim - Interesting link.  I deal with <code>Excel.Windows</code> so rarely I completely forgot about the <code>SheetViews</code> collection.  See the edit."}, {"owner": {"reputation": 777, "user_id": 1218959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/37cdc38e927f8909e66e091d25282f41?s=128&d=identicon&r=PG", "display_name": "tempidope", "link": "https://stackoverflow.com/users/1218959/tempidope"}, "edited": false, "score": 0, "creation_date": 1478098978, "post_id": 40368746, "comment_id": 68018200, "body": "@Comintern fantastic, your solution worked. Really weird how the hierarchy is - however did solve my problem."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 13, "last_activity_date": 1478039101, "last_edit_date": 1478039101, "creation_date": 1478034880, "answer_id": 40368746, "question_id": 40368373, "link": "https://stackoverflow.com/questions/40368373/how-can-i-turn-off-gridlines-in-excel-using-vba-without-using-activewindow/40368746#40368746", "title": "How can I turn off gridlines in excel using VBA, without using ActiveWindow", "body": "<p>If you have a reference to the workbook, you can just iterate over all of the Windows in its collection.  If the application isn't visible, you should only get 1 but it's safer than trying to hard code an index:</p>\n\n<pre><code>Private Sub ToggleGridLines(target As Workbook)\n    Dim wnd As Window\n    For Each wnd In target.Windows\n        wnd.DisplayGridlines = False\n    Next\nEnd Sub\n</code></pre>\n\n<p>Note that this will set change the display on the active worksheet in the workbook - why this is a property of the window and not the worksheet is beyond me.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Thanks to the link that @Tim shared, I realized I'd completely spaced off the <code>SheetViews</code> collection. This should turn off gridlines for an arbitrary <code>Worksheet</code> object:</p>\n\n<pre><code>Private Sub TurnOffGridLines(target As Worksheet)\n    Dim view As WorksheetView\n    For Each view In target.Parent.Windows(1).SheetViews\n        If view.Sheet.Name = target.Name Then\n            view.DisplayGridlines = False\n            Exit Sub\n        End If\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14186843, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-EJVpbeUkLV4/AAAAAAAAAAI/AAAAAAAAAAA/ACevoQPL3StmW45lc_zNJSpTqiyfNANI-w/mo/photo.jpg?sz=128", "display_name": "Jo&#227;o Batista", "link": "https://stackoverflow.com/users/14186843/jo%c3%a3o-batista"}, "is_accepted": false, "score": 0, "last_activity_date": 1598697406, "creation_date": 1598697406, "answer_id": 63646028, "question_id": 40368373, "link": "https://stackoverflow.com/questions/40368373/how-can-i-turn-off-gridlines-in-excel-using-vba-without-using-activewindow/63646028#63646028", "title": "How can I turn off gridlines in excel using VBA, without using ActiveWindow", "body": "<p>We can either do it as &quot;Comintern&quot; suggested or activating the wanted sheets to execute de adequate line of code in a loop.\nI tried the code posted above in several ways and I'm posting the snippet that worked the best for me:</p>\n<pre><code>Sub GridLines(Optional target As Worksheet, Optional display As Boolean = True)\n\n    Dim oWnd As Window\n    Dim oShView As WorksheetView\n    If IsMissing(target) Or target Is Nothing Then\n        For Each oShView In ActiveSheet.Parent.Windows(1).SheetViews\n            oShView.DisplayGridlines = display\n        Next\n    Else\n        For Each oShView In target.Parent.Windows(1).SheetViews\n            If oShView.Sheet.Name = target.Name Then\n                oShView.DisplayGridlines = display\n                Exit For\n            End If\n        Next\n    End If\n    Set oShView = Nothing\n    Set oWnd = Nothing\nEnd Sub\n</code></pre>\n<p>Any feedback is very welcomed</p>\n"}], "owner": {"reputation": 777, "user_id": 1218959, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/37cdc38e927f8909e66e091d25282f41?s=128&d=identicon&r=PG", "display_name": "tempidope", "link": "https://stackoverflow.com/users/1218959/tempidope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40796, "favorite_count": 3, "accepted_answer_id": 40368746, "answer_count": 3, "score": 10, "last_activity_date": 1598697406, "creation_date": 1478033173, "question_id": 40368373, "link": "https://stackoverflow.com/questions/40368373/how-can-i-turn-off-gridlines-in-excel-using-vba-without-using-activewindow", "title": "How can I turn off gridlines in excel using VBA, without using ActiveWindow", "body": "<p>I have a VBA macro over Excel 2013 which generate a separate excel report. In this excel report that is created, I would like to turn off the GridLines.</p>\n\n<p>The only piece of code that I come across to make this happens is as below</p>\n\n<pre><code>ActiveWindow.DisplayGridlines = False\n</code></pre>\n\n<p>However, this excel is generated in the background i.e., </p>\n\n<pre><code>Dim appObject As New Excel.Application\nappObject.Visible = False\n</code></pre>\n\n<p>Which means that this report is not the ActiveWindow. Is there an alternate way of turning off the gridlines without using the ActiveWindow object?</p>\n"}, {"tags": ["excel", "excel-formula", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478031789, "post_id": 40367983, "comment_id": 67989410, "body": "Do you want like a macro button or how would you run the macro?"}, {"owner": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "reply_to_user": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478032109, "post_id": 40367983, "comment_id": 67989556, "body": "@Niclas a Macro Button would be great. All I need is the macro to be able to copy the columns which will be hard coded."}, {"owner": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "reply_to_user": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478032914, "post_id": 40367983, "comment_id": 67990008, "body": "@Niclas I have added more details on end of para 2 and para 3 to make it more clear."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "edited": false, "score": 0, "creation_date": 1478093893, "post_id": 40368495, "comment_id": 68014493, "body": "it didn&#39;t copy anything on Sheet2. After running the macro, Sheet2 is still empty. I replaced all the Tests with actual column names."}, {"owner": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "edited": false, "score": 0, "creation_date": 1478100734, "post_id": 40368495, "comment_id": 68019544, "body": "I ran it again. It seems to work however, the columns are being copied at random locations. Mine is at Column CL, then at CC and AX. Instead of copying the cells to Colum A, B,C..and so on."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "edited": false, "score": 0, "creation_date": 1478102794, "post_id": 40368495, "comment_id": 68021026, "body": "Hmm weird. It should copy the column from Sheet1 to Sheet2, starting with Column A and so on. Do you have any data in Sheet2?"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "edited": false, "score": 0, "creation_date": 1478103294, "post_id": 40368495, "comment_id": 68021332, "body": "But you can just hardcode where the columns are copied to. So if you want Occupation to always be in Column D, Age in Column B, etc. it is possible"}, {"owner": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "edited": false, "score": 0, "creation_date": 1478105358, "post_id": 40368495, "comment_id": 68022576, "body": "would you be able to provide an example using the code above? Let&#39;s say for example Test1 should be copied on Column A. I can modify the code for the remainder. Thank you for helping me out with this."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "edited": false, "score": 0, "creation_date": 1478105428, "post_id": 40368495, "comment_id": 68022619, "body": "just edit targetcol to the number of the column. So A = 1, B = 2 etc"}, {"owner": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "edited": false, "score": 0, "creation_date": 1478110905, "post_id": 40368495, "comment_id": 68025935, "body": "That worked! One minor thing, would it be possible to make the columns be copied from row 2 instead of row 1 so that headers are not included?"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "edited": false, "score": 0, "creation_date": 1478113417, "post_id": 40368495, "comment_id": 68027298, "body": "So you don&#39;t want the whole column now? Just the rows from 2 to lastrow?"}, {"owner": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "edited": false, "score": 0, "creation_date": 1478114114, "post_id": 40368495, "comment_id": 68027658, "body": "yes. That is correct. I apologise for forgetting that last detail."}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "edited": false, "score": 0, "creation_date": 1478115660, "post_id": 40368495, "comment_id": 68028514, "body": "Should work now :-) Just remember to follow the instructions."}], "tags": [], "owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "is_accepted": true, "score": 0, "last_activity_date": 1478115641, "last_edit_date": 1478115641, "creation_date": 1478033687, "answer_id": 40368495, "question_id": 40367983, "link": "https://stackoverflow.com/questions/40367983/automated-copying-of-select-columns-to-new-worksheet/40368495#40368495", "title": "automated copying of select columns to new worksheet", "body": "<p>Try this.. Just replace test1 with your column names, etc.<br>\nRemember to add the column number instead of targetCol as you want to hardcode it. I used the range object to copy data.</p>\n\n<pre><code>Option Explicit\n\nSub CopyCode()\n\n'Declaring the variable lColumn as long to store the last Column number\nDim lColumn As Long\n'Declaring the variable iCntr as long to use in the For loop\nDim iCntr As Long\nDim lastRow As Long\nDim lastCol As Long, targetCol As Long\nDim wks As Worksheet, targetWks As Worksheet\nDim rng As Range\nDim fCol As String\n\n' Set wks so it is the activesheet\nSet wks = ThisWorkbook.Sheets(\"Sheet1\")\n\nSet targetWks = ThisWorkbook.Sheets(\"Sheet2\")\n\n    lastCol = wks.Cells(1, wks.Columns.Count).End(xlToLeft).Column\n\n\n'Assigning the last Column value to the variable lColumn\nlColumn = lastCol\n\n'Using for loop\nFor iCntr = lColumn To 1 Step -1\n\n    If LCase(wks.Cells(1, iCntr)) Like LCase(\"Test1\") Then\n        ' Find column letter\n        fCol = GetColumnLetter(iCntr)\n        lastRow = wks.Range(fCol &amp; wks.Rows.Count).End(xlUp).Row\n\n        ' Declare range object\n        Set rng = wks.Range(fCol &amp; \"2:\" &amp; fCol &amp; lastRow)\n\n        ' Use Range object to copy data\n        rng.Copy _\n        Destination:=targetWks.Cells(1, targetCol) ' Replace targetCol with number of column (A=1, B=2, etc.)\n    End If\n\n    If LCase(wks.Cells(1, iCntr)) Like LCase(\"Test2\") Then\n        ' Find column letter\n        fCol = GetColumnLetter(iCntr)\n        lastRow = wks.Range(fCol &amp; wks.Rows.Count).End(xlUp).Row\n\n        ' Declare range object\n        Set rng = wks.Range(fCol &amp; \"2:\" &amp; fCol &amp; lastRow)\n\n        ' Use Range object to copy data\n        rng.Copy _\n        Destination:=targetWks.Cells(1, targetCol) ' Replace targetCol with number of column (A=1, B=2, etc.)\n    End If\n\n    If LCase(wks.Cells(1, iCntr)) Like LCase(\"Test\") Then\n        ' Find column letter\n        fCol = GetColumnLetter(iCntr)\n        lastRow = wks.Range(fCol &amp; wks.Rows.Count).End(xlUp).Row\n\n        ' Declare range object\n        Set rng = wks.Range(fCol &amp; \"2:\" &amp; fCol &amp; lastRow)\n\n        ' Use Range object to copy data\n        rng.Copy _\n        Destination:=targetWks.Cells(1, targetCol) ' Replace targetCol with number of column (A=1, B=2, etc.)\n    End If\n\n    ' etc etc\nNext\n\nEnd Sub\n\nFunction GetColumnLetter(colNum As Long) As String\n    Dim vArr\n    vArr = Split(Cells(1, colNum).Address(True, False), \"$\")\n    GetColumnLetter = vArr(0)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 6805307, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-B5pPtC-aOPI/AAAAAAAAAAI/AAAAAAAAAVo/akNTTF3s6aQ/photo.jpg?sz=128", "display_name": "Sage Mohan", "link": "https://stackoverflow.com/users/6805307/sage-mohan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 0, "accepted_answer_id": 40368495, "answer_count": 1, "score": 0, "last_activity_date": 1478115641, "creation_date": 1478031596, "last_edit_date": 1531164843, "question_id": 40367983, "link": "https://stackoverflow.com/questions/40367983/automated-copying-of-select-columns-to-new-worksheet", "title": "automated copying of select columns to new worksheet", "body": "<p>Am fairly new to excel and was wondering if there is an easier way to do a routine cut copy paste I do. I have a worksheet that has a long list of columns which looks like following:</p>\n\n<pre><code>Name     Age    Occupation    Major    WorkEx     Position.....\n</code></pre>\n\n<p>I want the macro to copy some predetermined columns from worksheet 1 to worksheet 2 i.e each time I copy raw data into worksheet 1 worksheet 2 should be auto-populated with the selected columns. In this case for example,if I paste the aforementioned columns into worksheet 1, then Name, Major and Position should automatically be copied to worksheet 2.</p>\n\n<p>A point to note is that the raw data is not always in order as shown above. I believe the key is to locate/find the header and then copy the entire column on to worksheet 2 on specific columns.</p>\n\n<p>In this case worksheet 2 will always have Col 8-10 and Col 16 as blank.</p>\n\n<p>Would anyone be able to help me with this issue? Let me know if any additional details are necessary.</p>\n"}, {"tags": ["javascript", "excel", "vba", "office-js"], "answers": [{"comments": [{"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1478042984, "post_id": 40369571, "comment_id": 67993962, "body": "yes I know how to do that: but it does not tell me how to chain a write following a read using Sync: all the examples only use a single Sync and Office JS does not seem to allow a read and a write within a single sync block"}], "tags": [], "owner": {"reputation": 91, "user_id": 6764300, "user_type": "registered", "profile_image": "https://graph.facebook.com/525624967645038/picture?type=large", "display_name": "Thomas R.", "link": "https://stackoverflow.com/users/6764300/thomas-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1478039116, "creation_date": 1478039116, "answer_id": 40369571, "question_id": 40367936, "link": "https://stackoverflow.com/questions/40367936/chaining-read-writes-with-office-js/40369571#40369571", "title": "Chaining Read-Writes with Office-JS", "body": "<p>You can use the Range-Class OfficeJS gives you.\nHere is the full doc: <a href=\"https://dev.office.com/reference/add-ins/excel/range\" rel=\"nofollow noreferrer\">https://dev.office.com/reference/add-ins/excel/range</a> (Also have a look at the examples given there)</p>\n\n<p>To copy the Range, you need to create both ranges and copy the <code>.values[][]</code> from the source to the dest.</p>\n\n<p>For how to copy a two-dimensional array (in this case: <code>values[][]</code>), you should use google.</p>\n\n<p>To Determine the time, you can use the <code>Date()</code>-Class Java gives you. </p>\n"}, {"comments": [{"owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "edited": false, "score": 0, "creation_date": 1478074697, "post_id": 40372548, "comment_id": 68002959, "body": "Thanks Jakob - that looks simple enough"}], "tags": [], "owner": {"reputation": 112, "user_id": 7102687, "user_type": "registered", "profile_image": "https://graph.facebook.com/10154622382715712/picture?type=large", "display_name": "Jakob Nielsen", "link": "https://stackoverflow.com/users/7102687/jakob-nielsen"}, "is_accepted": true, "score": 2, "last_activity_date": 1478061256, "creation_date": 1478061256, "answer_id": 40372548, "question_id": 40367936, "link": "https://stackoverflow.com/questions/40367936/chaining-read-writes-with-office-js/40372548#40372548", "title": "Chaining Read-Writes with Office-JS", "body": "<p>To copy the values from one range to another, you can use the following code:</p>\n\n<pre><code>Excel.run(function(context) {\n    var range1 = context.workbook.worksheets.getItem(\"Sheet1\").getRange(\"A1:A1000\").load('values');\n    return context.sync()\n        .then(() => {\n            var range2 = context.workbook.worksheets.getItem(\"Sheet1\").getRange(\"D1:D1000\");\n            range2.values = range1.values;\n            return context.sync();\n        });\n});\n</code></pre>\n"}], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 40372548, "answer_count": 2, "score": 1, "last_activity_date": 1478061256, "creation_date": 1478031367, "last_edit_date": 1478038302, "question_id": 40367936, "link": "https://stackoverflow.com/questions/40367936/chaining-read-writes-with-office-js", "title": "Chaining Read-Writes with Office-JS", "body": "<p>I am having a problem working out how to chain syncs in Office JS - I think I have to do one sync to read the values then another sync to write them back - must be simple but I can't find a chaining example.</p>\n\n<p>Basically I am trying to code the equivalent of this VBA code which does a read and a write via an array</p>\n\n<pre><code>Application.ScreenUpdating = False\nd1 = MicroTimer\nSet rng1 = Worksheets(\"Sheet1\").Range(\"A1:A1000\")\nSet rng2 = Worksheets(\"Sheet1\").Range(\"D1:D1000\")\nvar = rng1.Value2\nrng2.Value2 = var\nd2 = (MicroTimer - d1) * 1000\n\nMsgBox d2\n</code></pre>\n\n<p>or even simpler</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"D1:D1000\").Value2=Worksheets(\"Sheet1\").Range(\"A1:A1000\").Value2\n</code></pre>\n"}, {"tags": ["vba", "excel", "if-statement"], "comments": [{"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478031394, "post_id": 40367886, "comment_id": 67989205, "body": "Do you want it to look at D6 = E6 etc? or only D5 = E5 and then delete the whole column?"}, {"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "reply_to_user": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "edited": false, "score": 0, "creation_date": 1478081380, "post_id": 40367886, "comment_id": 68006585, "body": "I want to it look at all the rest of the cells in those columns that have something in them."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1478081563, "post_id": 40368289, "comment_id": 68006703, "body": "If I want to remove the pop up message do I just delete &quot;MsgBox rng.Address&quot; ?"}, {"owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "reply_to_user": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "edited": false, "score": 0, "creation_date": 1478083625, "post_id": 40368289, "comment_id": 68007969, "body": "Yes just do that :-)"}], "tags": [], "owner": {"reputation": 853, "user_id": 1042624, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/09856b699a8b2ad857d2a241925396d6?s=128&d=identicon&r=PG", "display_name": "Niclas", "link": "https://stackoverflow.com/users/1042624/niclas"}, "is_accepted": true, "score": 0, "last_activity_date": 1478032809, "creation_date": 1478032809, "answer_id": 40368289, "question_id": 40367886, "link": "https://stackoverflow.com/questions/40367886/deleting-cell-value-the-cell-in-the-next-column-is-the-same/40368289#40368289", "title": "Deleting Cell value the cell in the next column is the same", "body": "<p>Try this.. </p>\n\n<pre><code>Private Sub test()\n\n    Dim rng As Range\n    Dim cell As Range\n    Dim LastRow As Long\n\n    With ActiveSheet\n        LastRow = .Range(\"D1\").SpecialCells(xlCellTypeLastCell).Row\n    End With\n\n    Set rng = Range(\"E2:E\" &amp; LastRow)\n    MsgBox rng.Address\n\n        For Each cell In rng\n            If LCase(cell.Value) = LCase(cell.Offset(0, -1)) Then\n\n                cell.ClearContents\n\n            End If\n        Next cell\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6937076, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1bbad7538c49272e5cd4e5ca21dc76c2?s=128&d=identicon&r=PG&f=1", "display_name": "D.Schiermeyer", "link": "https://stackoverflow.com/users/6937076/d-schiermeyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 40368289, "answer_count": 1, "score": -1, "last_activity_date": 1478032809, "creation_date": 1478031092, "question_id": 40367886, "link": "https://stackoverflow.com/questions/40367886/deleting-cell-value-the-cell-in-the-next-column-is-the-same", "title": "Deleting Cell value the cell in the next column is the same", "body": "<p>I am trying to have a VBA clean up and format data every time a table is refreshed. There are two columns that I want to look at. one is Job #, and the next one is Top level Job #. I would like the vba to look at column E, and if E5 = D5, then delete the contents in E5. If they are not the same, keep the content in E5. I would like it to do that for however many rows in Column E there are, as this will constantly change. If more information is needed let me know. </p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1478030604, "post_id": 40367722, "comment_id": 67988788, "body": "You cannot change other cells values in a function. You should store the lognormal results in a variable that you aggregate to. Output the final value."}, {"owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "edited": false, "score": 0, "creation_date": 1478031951, "post_id": 40367722, "comment_id": 67989478, "body": "Well first here on your edit you are trying to get the average and std dev of a single element array. I would think you need to instantiate lnRange as an array of the same dimensions as your range. You should add a break point early on your script and step through checking watches of each variable to see dimensions, data types, etc."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6019977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431aaa79f25c43521cbd6a066b453a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Stix", "link": "https://stackoverflow.com/users/6019977/stix"}, "edited": false, "score": 0, "creation_date": 1478031486, "post_id": 40367787, "comment_id": 67989257, "body": "Thank you I am apparently still missing something, see my edit please."}], "tags": [], "owner": {"reputation": 2097, "user_id": 4402759, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0d2b1f35b8f999526905db3f4b0fefcd?s=128&d=identicon&r=PG&f=1", "display_name": "nbayly", "link": "https://stackoverflow.com/users/4402759/nbayly"}, "is_accepted": false, "score": 2, "last_activity_date": 1478030727, "creation_date": 1478030727, "answer_id": 40367787, "question_id": 40367722, "link": "https://stackoverflow.com/questions/40367722/custom-excel-function-data-type-issue/40367787#40367787", "title": "Custom Excel Function Data Type Issue", "body": "<p>You cannot change other cells values in a function. You should store the lognormal results in a variable that you aggregate to, output the final value. Code would look like:</p>\n\n<pre><code>Function LogNormProb(Data As Range, Probability As Double) As Double\n\n    Dim Cell As Range\n    Dim dbTotal As Double\n\n    For Each Cell In Data\n        dbTotal = dbTotal + WorksheetFunction.Ln(Cell.Value)\n    Next Cell\n\n    LogNormProb = dbTotal\n\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21725, "user_id": 88173, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/114b7dea411e3648a54fa459c89bed40?s=128&d=identicon&r=PG", "display_name": "Charles Williams", "link": "https://stackoverflow.com/users/88173/charles-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1478030935, "creation_date": 1478030935, "answer_id": 40367840, "question_id": 40367722, "link": "https://stackoverflow.com/questions/40367722/custom-excel-function-data-type-issue/40367840#40367840", "title": "Custom Excel Function Data Type Issue", "body": "<p>A UDF function can only change the values of the cell(s) it resides in - your udf is attempting to change the values of all the cells in Data.</p>\n\n<p>try something like this (not tested)    </p>\n\n<pre><code>Function LogNormProb(Data As Range, Probability As Double) As Double\n\nDim vData as variant\ndim j as long\ndim k as long\n\nvData=Data.Value2\n\nFor j=lbound(vdata) to ubound(vdata)\nfor k= lbound(vdata,2) to ubound(vdata,2)\n    vdata(j,k) = WorksheetFunction.Ln(vdata(j,k))\nNext k\nnext j\n\nLogNormProb = WorksheetFunction.Sum(vData)\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6019977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/431aaa79f25c43521cbd6a066b453a3d?s=128&d=identicon&r=PG&f=1", "display_name": "Stix", "link": "https://stackoverflow.com/users/6019977/stix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 40367840, "answer_count": 2, "score": 0, "last_activity_date": 1478031401, "creation_date": 1478030420, "last_edit_date": 1531161705, "question_id": 40367722, "link": "https://stackoverflow.com/questions/40367722/custom-excel-function-data-type-issue", "title": "Custom Excel Function Data Type Issue", "body": "<pre><code>Function LogNormProb(Data As Range, Probability As Double) As Double\n\nDim Cell As Range\n\nFor Each Cell In Data\n    Cell.Value = WorksheetFunction.Ln(Cell.Value)\nNext Cell\n\nLogNormProb = WorksheetFunction.Sum(Data)\n\nEnd Function\n</code></pre>\n\n<p>I am trying to create a function to calculate the lognormal distribution of a dynamic range.  I am getting a #VALUE error with this as is and cannot figure out why.  Thank you for the help.</p>\n\n<p>EDIT****</p>\n\n<p>I apologize, here is where I am really trying to go.  I tried to update with your suggestion but I am still missing something.</p>\n\n<pre><code>Function LogNormProb(Data As Range, Probability As Double) As Double\n\nDim Cell As Range\nDim lnRange As Variant, lnAvg As Double\nDim lnStdDev As Double\n\nFor Each Cell In Data\n    lnRange = WorksheetFunction.Ln(Cell.Value)\nNext Cell\n\nlnAvg = WorksheetFunction.Average(lnRange)\nlnStdDev = WorksheetFunction.StdDev.S(lnRange)\n\nLogNormProb = WorksheetFunction.LogNorm.INV(Probability, lnAvg, lnStdDev)\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1478030069, "post_id": 40367596, "comment_id": 67988523, "body": "What are you trying to archive with the hidden file? Will the other users need access to the file when they run a macro?"}, {"owner": {"reputation": 69, "user_id": 7032030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db3708a30d0580d8fd5310bc9fd79e4a?s=128&d=identicon&r=PG&f=1", "display_name": "thisguyAgain", "link": "https://stackoverflow.com/users/7032030/thisguyagain"}, "reply_to_user": {"reputation": 2478, "user_id": 6110371, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/O93Qp.jpg?s=128&g=1", "display_name": "VBA Pete", "link": "https://stackoverflow.com/users/6110371/vba-pete"}, "edited": false, "score": 0, "creation_date": 1478030296, "post_id": 40367596, "comment_id": 67988635, "body": "@VBAPete No, they don&#39;t need access to this file. Reason for is, i want to save a file from within the excel file that will save a property to it since my excel workbook will be password protected therefore, I cannot access the properties of that workbook. Then i will have another application that will access these text file for the properties ect."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478031003, "post_id": 40367596, "comment_id": 67989006, "body": "If you <i>really</i> don&#39;t want a regular user to find it, take a look at <a href=\"http://vb.mvps.org/samples/Streams/\" rel=\"nofollow noreferrer\">alternate data streams</a>."}, {"owner": {"reputation": 69, "user_id": 7032030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db3708a30d0580d8fd5310bc9fd79e4a?s=128&d=identicon&r=PG&f=1", "display_name": "thisguyAgain", "link": "https://stackoverflow.com/users/7032030/thisguyagain"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478031557, "post_id": 40367596, "comment_id": 67989291, "body": "@Comintern I really don&#39;t want to have to create two files, a text file and a ads file. I just want to create a text file from excel that stores some values to access by another application for value usage ect."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478031713, "post_id": 40367596, "comment_id": 67989366, "body": "I meant create an ADS for the workbook itself <i>instead of</i> a text file."}, {"owner": {"reputation": 69, "user_id": 7032030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db3708a30d0580d8fd5310bc9fd79e4a?s=128&d=identicon&r=PG&f=1", "display_name": "thisguyAgain", "link": "https://stackoverflow.com/users/7032030/thisguyagain"}, "edited": false, "score": 0, "creation_date": 1478031826, "post_id": 40367596, "comment_id": 67989424, "body": "I&#39;m open for other options. Thanks though."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 7032030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db3708a30d0580d8fd5310bc9fd79e4a?s=128&d=identicon&r=PG&f=1", "display_name": "thisguyAgain", "link": "https://stackoverflow.com/users/7032030/thisguyagain"}, "edited": false, "score": 0, "creation_date": 1481060864, "post_id": 40368427, "comment_id": 69219659, "body": "i don&#39;t know what you are doing."}, {"owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "reply_to_user": {"reputation": 69, "user_id": 7032030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db3708a30d0580d8fd5310bc9fd79e4a?s=128&d=identicon&r=PG&f=1", "display_name": "thisguyAgain", "link": "https://stackoverflow.com/users/7032030/thisguyagain"}, "edited": false, "score": 0, "creation_date": 1481064292, "post_id": 40368427, "comment_id": 69221168, "body": "Which part aren&#39;t you getting, VBA&#39;s <code>shell</code> function or Command&#39;s <code>attrib</code> function? This does exactly what Comintern&#39;s code does, it just uses a Command shell instead of an FSO. There&#39;s many ways to skin a cat."}], "tags": [], "owner": {"reputation": 2324, "user_id": 5094258, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/n4upu.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/5094258/tim"}, "is_accepted": false, "score": 0, "last_activity_date": 1478033401, "creation_date": 1478033401, "answer_id": 40368427, "question_id": 40367596, "link": "https://stackoverflow.com/questions/40367596/how-can-i-create-a-text-file-to-a-folder-location-as-a-operating-system-file/40368427#40368427", "title": "How can I create a text file to a folder location as a operating system file?", "body": "<p>I don't know of a way to do this in pure VBA, but you can create your text file then pass the <a href=\"http://ss64.com/nt/attrib.html\" rel=\"nofollow noreferrer\"><code>attrib</code></a> command to shell. eg:</p>\n\n<pre><code>Shell \"ATTRIB +S +H MyHiddenTextFile.txt\", vbHide \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 0, "last_activity_date": 1478040139, "creation_date": 1478040139, "answer_id": 40369744, "question_id": 40367596, "link": "https://stackoverflow.com/questions/40367596/how-can-i-create-a-text-file-to-a-folder-location-as-a-operating-system-file/40369744#40369744", "title": "How can I create a text file to a folder location as a operating system file?", "body": "<p>You can do this with the <code>Scripting.FileSystemObject</code>:</p>\n\n<pre><code>'Requires reference to Microsoft Scripting Runtime\nSub SetSystemHiddenAttribs(filepath As String)\n    With New Scripting.FileSystemObject\n        With .GetFile(filepath)\n            .Attributes = .Attributes Or Hidden Or System\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 7032030, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/db3708a30d0580d8fd5310bc9fd79e4a?s=128&d=identicon&r=PG&f=1", "display_name": "thisguyAgain", "link": "https://stackoverflow.com/users/7032030/thisguyagain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 40369744, "answer_count": 2, "score": 0, "last_activity_date": 1478040139, "creation_date": 1478029894, "question_id": 40367596, "link": "https://stackoverflow.com/questions/40367596/how-can-i-create-a-text-file-to-a-folder-location-as-a-operating-system-file", "title": "How can I create a text file to a folder location as a operating system file?", "body": "<p>I want to create a text file as a operating system file using vba code? Is this possible? Reason I want to do this is so that the regular user cannot see the text file. I know there's the save file as hidden feature but i don't want to use that. Any help is appreciated. Thanks.</p>\n"}, {"tags": ["vba", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 237, "user_id": 6749069, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/qN7hN.png?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/6749069/john"}, "edited": false, "score": 0, "creation_date": 1478030182, "post_id": 40367564, "comment_id": 67988576, "body": "I can&#39;t believe I missed that!  Thanks!"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 237, "user_id": 6749069, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/qN7hN.png?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/6749069/john"}, "edited": false, "score": 0, "creation_date": 1478030605, "post_id": 40367564, "comment_id": 67988790, "body": "And in case of Exchange, you might want to use MailItem,Sender.GetExchangeUser.PrimarySmtpAddress instead (with checks for nulls of course) - PR_SMTP_ADDRESS is not guaranteed to be available."}, {"owner": {"reputation": 237, "user_id": 6749069, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/qN7hN.png?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/6749069/john"}, "edited": false, "score": 0, "creation_date": 1478030713, "post_id": 40367564, "comment_id": 67988857, "body": "Just wanted to comment that I need to check SenderEmailType.  If the type is &quot;EX&quot; then I must use the code I posted, otherwise Dmitry&#39;s solution works perfectly."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1478029733, "creation_date": 1478029733, "answer_id": 40367564, "question_id": 40367448, "link": "https://stackoverflow.com/questions/40367448/how-to-get-the-sender-of-an-outlook-message/40367564#40367564", "title": "How to get the sender of an outlook message", "body": "<p>You are requesting the <code>PR_SMTP_ADDRESS</code> property, which is Exchange specific. Check if <code>SenderEmailType</code> is \"EX\" and only then read the <code>PR_SMTP_ADDRESS</code> property. Otherwise just read the <code>MailItem.SenderEmailAddress</code> property.</p>\n\n<p>Take a look at the message with <a href=\"http://www.dimastr.com/outspy/\" rel=\"nofollow noreferrer\">OutlookSpy</a> (click IMessage) to see the available properties. </p>\n"}], "owner": {"reputation": 237, "user_id": 6749069, "user_type": "registered", "accept_rate": 45, "profile_image": "https://i.stack.imgur.com/qN7hN.png?s=128&g=1", "display_name": "John", "link": "https://stackoverflow.com/users/6749069/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2159, "favorite_count": 1, "accepted_answer_id": 40367564, "answer_count": 1, "score": 1, "last_activity_date": 1592870104, "creation_date": 1478029234, "last_edit_date": 1592870104, "question_id": 40367448, "link": "https://stackoverflow.com/questions/40367448/how-to-get-the-sender-of-an-outlook-message", "title": "How to get the sender of an outlook message", "body": "<p>I have some code that partially populates an email message as a reply.  But I can not get the sender unless they are on (an / our)? exchange server. </p>\n\n<pre><code>Public Sub CreateMessage()\n\nDim EmailFrom As String\nDim NewMessage As Outlook.MailItem\nDim OldMessage As Outlook.MailItem\n\n\nSet OldMessage = Application.ActiveInspector.CurrentItem\nSet NewMessage = Application.CreateItem(olMailItem)\nEmailFrom = OldMessage.Sender.PropertyAccessor.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x39FE001E\")\nNewMessage.Body = Body(EmailFrom)\nNewMessage.HTMLBody = HTMLBody(EmailFrom)\nNewMessage.Recipients.Add (EmailFrom)\nNewMessage.Display\nSet NewMessage = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The message I receive is \"The property \"<a href=\"http://schemas.microsoft.com/mapi/proptag/0x39FE001E\" rel=\"nofollow noreferrer\">http://schemas.microsoft.com/mapi/proptag/0x39FE001E</a>\" is unknown or cannot be found.\" and it only appears to work with internal messages.  </p>\n\n<p>Anyone know of a way in Outlook VBA to get the sender of a mail message that works for all of them?</p>\n\n<hr>\n\n<p>Fixed based on Dimitry's comments:</p>\n\n<pre><code>Public Sub CreateMessage()\n\nDim EmailFrom As String\nDim NewMessage As Outlook.MailItem\nDim OldMessage As Outlook.MailItem\n\n\nSet OldMessage = Application.ActiveInspector.CurrentItem\nSet NewMessage = Application.CreateItem(olMailItem)\nSelect Case OldMessage.SenderEmailType\n    Case \"EX\"\n        EmailFrom = OldMessage.Sender.GetExchangeUser.PrimarySmtpAddress\n    Case Else\n        EmailFrom = OldMessage.SenderEmailAddress\nEnd Select\nNewMessage.Body = Body(EmailFrom)\nNewMessage.HTMLBody = HTMLBody(EmailFrom)\nNewMessage.Recipients.Add (EmailFrom)\nNewMessage.Display\nSet NewMessage = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "macros"], "comments": [{"owner": {"reputation": 2973, "user_id": 3659226, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/3a1169867c91d72a0e391303410d2f61?s=128&d=identicon&r=PG&f=1", "display_name": "RITZ XAVI", "link": "https://stackoverflow.com/users/3659226/ritz-xavi"}, "edited": false, "score": 0, "creation_date": 1478030104, "post_id": 40367089, "comment_id": 67988538, "body": "You should attach the images inline instead of providing the links to images."}], "answers": [{"tags": [], "owner": {"reputation": 770, "user_id": 7086396, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-yLANabdeAgw/AAAAAAAAAAI/AAAAAAAAAQ4/eCyC7wOMQlU/photo.jpg?sz=128", "display_name": "Moacir", "link": "https://stackoverflow.com/users/7086396/moacir"}, "is_accepted": false, "score": 0, "last_activity_date": 1478029368, "creation_date": 1478029368, "answer_id": 40367490, "question_id": 40367089, "link": "https://stackoverflow.com/questions/40367089/macro-to-create-new-rows-in-separate-tab-based-on-qty-in-cell/40367490#40367490", "title": "Macro to create new rows in separate tab based on qty in cell", "body": "<p>Create an activex button, put this code on it. If the Upload sheet doesnt exist, it is created, otherwise it clears everything before executing the code.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    Dim lastrow As Long\n    Dim lastrow2 As Long\n    Dim row As Long\n    Dim product As String\n    Dim count As Long\n    Dim repeat As Long\n    Dim ws As Worksheet\n    If Evaluate(\"ISREF('\" &amp; \"Upload\" &amp; \"'!A1)\") = False Then\n    With ThisWorkbook\n        Set ws = .Sheets.Add(After:=.Sheets(.Sheets.count))\n        ws.Name = \"Upload\"\n    End With\n    Else\n        Sheets(\"Upload\").UsedRange.ClearContents\n    End If\n    Set ws = Sheets(\"Upload\")\n    ws.Cells(1, 1) = \"Product\"\n    lastrow = Cells(Rows.count, \"A\").End(xlUp).row\n    lastrow2 = ws.Cells(Rows.count, \"A\").End(xlUp).row\n    For row = 2 To lastrow\n        product = Cells(row, 1)\n        count = Cells(row, 2)\n            For repeat = 1 To count\n                lastrow2 = lastrow2 + 1\n                ws.Cells(lastrow2, 1) = product\n            Next repeat\n    Next row\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7101277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9594aec652e644fee80b133d09dc6bf4?s=128&d=identicon&r=PG&f=1", "display_name": "ngriest", "link": "https://stackoverflow.com/users/7101277/ngriest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1478043998, "creation_date": 1478027720, "last_edit_date": 1478043998, "question_id": 40367089, "link": "https://stackoverflow.com/questions/40367089/macro-to-create-new-rows-in-separate-tab-based-on-qty-in-cell", "title": "Macro to create new rows in separate tab based on qty in cell", "body": "<p>I have a tab (data tab) in excel where users can paste in a list of products that need to be ordered in column 'A' and the qty of each product in column 'B'.</p>\n\n<p>I'm trying to create a macro that will look at the qty in column 'B' of each row and create that many records into a new tab (upload tab). </p>\n\n<p>ie. </p>\n\n<p>Data Tab</p>\n\n<p><img src=\"https://i.stack.imgur.com/SEvZQ.png\" alt=\"Data Tab\"></p>\n\n<p>Desired Results</p>\n\n<p><img src=\"https://i.stack.imgur.com/Ss8Lw.png\" alt=\"Desired results in (upload tab)\"></p>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478026142, "post_id": 40366570, "comment_id": 67986567, "body": "If you don&#39;t want the active view to change, why are you calling <code>.Activate</code>?"}, {"owner": {"reputation": 21, "user_id": 6847742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45ace08a1aba74786f63e5c53a5a44f?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Bo", "link": "https://stackoverflow.com/users/6847742/joe-bo"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1478100222, "post_id": 40366570, "comment_id": 68019164, "body": "If I do not call activate at the end, then after closing the userform I will not be back at the original workbook. By using activate in the end, I can at least get back to the original workbook after the modal userform closes."}, {"owner": {"reputation": 2083, "user_id": 2698167, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/78d3b309258827bd033b79f043d2ae13?s=128&d=identicon&r=PG&f=1", "display_name": "Tuntable", "link": "https://stackoverflow.com/users/2698167/tuntable"}, "edited": false, "score": 0, "creation_date": 1517560582, "post_id": 40366570, "comment_id": 84153578, "body": "I have the same bug, calling the userform from the ribbon."}], "answers": [{"tags": [], "owner": {"reputation": 2083, "user_id": 2698167, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/78d3b309258827bd033b79f043d2ae13?s=128&d=identicon&r=PG&f=1", "display_name": "Tuntable", "link": "https://stackoverflow.com/users/2698167/tuntable"}, "is_accepted": false, "score": 0, "last_activity_date": 1572234489, "last_edit_date": 1572234489, "creation_date": 1572056582, "answer_id": 58567564, "question_id": 40366570, "link": "https://stackoverflow.com/questions/40366570/excel-2013-modal-vba-userform-changes-activeworkbook-while-userform-is-visible/58567564#58567564", "title": "Excel 2013 modal VBA Userform changes Activeworkbook while userform is visible", "body": "<p>The following seems to work most of the time.  The OnTime seems to be necessary.  I suspect the Microsoft bug is with the ribbon.</p>\n\n<pre><code>fsShow myUserForm\n\nSub fsShow(form As Object)\n' Work around bug that form.show changes active window rather randomly\n' (Only the displayed window is wrong, not the ActiveCell.parent.parent.)\n  Set fsActiveWindow = Application.ActiveWindow\n  form.Show\n  Application.OnTime Now(), \"fsResetActiveWindowOnTime\"\nEnd Sub\n\nSub fsResetActiveWindowOnTime()\n  If Not fsActiveWindow Is Nothing Then\n    fsActiveWindow.Activate\n    Set fsActiveWindow = Nothing\n  End If\nEnd Sub\n</code></pre>\n\n<p>However, I occasionally get a type mismatch error just by calling this, i.e. a userform is not an object(!).  This whole area is buggy so I avoid using this method.</p>\n\n<p>Sometimes just recreating a userform fixes the problem.  It is not for all userforms.  And I have not figured out a trigger.</p>\n"}], "owner": {"reputation": 21, "user_id": 6847742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f45ace08a1aba74786f63e5c53a5a44f?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Bo", "link": "https://stackoverflow.com/users/6847742/joe-bo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 349, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1572234489, "creation_date": 1478025828, "question_id": 40366570, "link": "https://stackoverflow.com/questions/40366570/excel-2013-modal-vba-userform-changes-activeworkbook-while-userform-is-visible", "title": "Excel 2013 modal VBA Userform changes Activeworkbook while userform is visible", "body": "<p>In Excel 2013 (Office 15) a combination of a shortcut and a very simple userform (for formatting) is sometimes causing the Active Workbook to disappear and another workbook to show for no reason (only happens sometimes, often after just having changed activeworkbook). I am trying to keep the current workbook window in the foreground while the formatting userform is shown but without success.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub AssignKeys()\n Application.OnKey \"^%,\", \"MakeBlue\"\nEnd Sub\n\n\nSub MakeBlue()\n frmFormat.Show     \nEnd Sub\n</code></pre>\n\n<p>frmFormat is a very simple and small form that only has one textbox where a formatting code is entered. It does work to restore the previously active workbook after hiding the modal form using this code:</p>\n\n<pre><code>Private Declare PtrSafe Function SetForegroundWindow Lib \"USER32\" (ByVal hWnd As LongPtr) As LongPtr\nPublic Sub MyAppActive(Handle As Long)\n    Dim lngStatus As LongPtr\n   lngStatus = SetForegroundWindow(Handle)\nEnd Sub\n\nPrivate Sub tbShortcut_KeyUp(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)\n\n\nIf tbShortcut.Text &lt;&gt; \"xn\" Then\n    Dim mySel As Range\n    Dim myWb As workBook\n    Dim myWnd As Window\n    Set myWnd = ActiveWindow\n\n    Set mySel = Selection\n    Set myWb = ActiveWorkbook\n    Debug.Print mySel.Address\n\n    Me.Hide\n\n    'mySel.Parent.Parent.Activate\n    myWb.Activate\n    myWnd.Activate\n    MyAppActive myWnd.hWnd\n\nend if\n\nend sub\n</code></pre>\n\n<p>So once the form is hidden, the original workbook window is restored. But while the userform is shown, the other unwanted Workbook window is displayed. Would be very greatful for any hints. Thank you!</p>\n"}]