[{"tags": ["vba", "list", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1540423591, "post_id": 52979046, "comment_id": 92864934, "body": "If you are selecting from a BOUND listbox, you will either edit an existing record or create a new record. Record edit is committed to table when form closes. This should be expected behavior. Item certainly can be selected from UNBOUND listbox so something is wrong with your design. Why allow user to delete category?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1540426907, "post_id": 52979046, "comment_id": 92865671, "body": "Where does this delete query fit into your problem?"}, {"owner": {"reputation": 1, "user_id": 6901549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bbf075dde0bc73b1a87e5a02dd34ff2?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/6901549/neil"}, "edited": false, "score": 0, "creation_date": 1540431093, "post_id": 52979046, "comment_id": 92866501, "body": "June7, thank you for confirming that an UNBOUND listbox shouldn&#39;t preclude a selection. I thought I was loosing it... As to the BOUND box, I was expecting it to commit a deletion of a record, not to add a record. The category is not a data category. This is a separate table for categories of items that users can identify and self-select into. ashleedawg - the deletion happens when user clicks a delete button (with the quoted code OnClick) after selecting an item from a list on a form. It all works great until the form closes. Then a record is added to a table as described above."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 6901549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bbf075dde0bc73b1a87e5a02dd34ff2?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/6901549/neil"}, "is_accepted": false, "score": 0, "last_activity_date": 1540564074, "creation_date": 1540564074, "answer_id": 53010900, "question_id": 52979046, "link": "https://stackoverflow.com/questions/52979046/access-vba-a-record-is-added-when-a-form-with-a-bound-table-is-closed/53010900#53010900", "title": "Access VBA: a record is added when a form with a bound table is closed", "body": "<p>Apparently, the answer is to define a row source in the Form_Load() sub like this:</p>\n\n<pre><code>Me.Update_Category_lstAllCats.RowSource = \"SELECT * FROM Category ORDER BY Cat_Name;\"\n</code></pre>\n\n<p>and to exclude any reference to a row source in the list properties. Then all other pieces fall into place.</p>\n"}], "owner": {"reputation": 1, "user_id": 6901549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bbf075dde0bc73b1a87e5a02dd34ff2?s=128&d=identicon&r=PG&f=1", "display_name": "Neil", "link": "https://stackoverflow.com/users/6901549/neil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540564074, "creation_date": 1540422059, "last_edit_date": 1540423317, "question_id": 52979046, "link": "https://stackoverflow.com/questions/52979046/access-vba-a-record-is-added-when-a-form-with-a-bound-table-is-closed", "title": "Access VBA: a record is added when a form with a bound table is closed", "body": "<p>I am stuck with this problem and I have no idea what is going on. A form has a bound listbox, when an item on the list is selected, a user can delete that item from a related table by clicking a delete button. That part is simple, and it works. The problem is that every time the form is closed after a delete action, it adds a new record with the ID (Column 0) of the deleted record in the description field (Column 1) and a proper incremental ID in the ID field (Column 0). To make things worse, an unbound list would not allow item selection.</p>\n\n<p>Here's a very simple delete code:</p>\n\n<pre><code>aSQL = \"DELETE * FROM Category WHERE Cat_ID = \" &amp; Me.Update_Category_lstAllCats.Column(0)\nDoCmd.RunSQL aSQL\n</code></pre>\n\n<p>Any suggestion will be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1540421331, "post_id": 52978687, "comment_id": 92864326, "body": "Why are you doing regex even? I would grab all of the values based on a split of <code>;</code>, toss those into a dictionary, and then compare the future cells against that dictionary and dont add back values that dont exist in that first dictionary"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1540421865, "post_id": 52978687, "comment_id": 92864470, "body": "With Office 365 this can be done with a formula, if you are interested."}], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": true, "score": 0, "last_activity_date": 1540423022, "last_edit_date": 1540423022, "creation_date": 1540422541, "answer_id": 52979135, "question_id": 52978687, "link": "https://stackoverflow.com/questions/52978687/excel-vba-compare-delimited-string-in-cell-to-column-of-values/52979135#52979135", "title": "Excel VBA: Compare Delimited String in Cell to Column of Values", "body": "<p>I think this should work for you.</p>\n\n<pre><code>Sub GenesDict()\n\n    Dim dict As Object\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    'add A genes to dictionary\n    Dim i As Long\n    For i = 2 To Cells(Rows.Count, \"A\").End(xlUp).Row\n        Dim temp As Variant\n        temp = Split(Cells(i, \"A\").Value2, \";\")\n\n        Dim j As Long\n        For j = LBound(temp) To UBound(temp)\n            dict.Add Trim(temp(j)), \"text\"\n        Next j\n    Next i\n\n    'clear D\n    Range(\"D2:D\" &amp; Range(\"D\" &amp; Rows.Count).End(xlUp).Row).ClearContents\n\n    'transfer from B to D only genes in A\n    For i = 2 To Cells(Rows.Count, \"B\").End(xlUp).Row\n        temp = Split(Cells(i, \"B\").Value2, \";\")\n\n        For j = LBound(temp) To UBound(temp)\n            If dict.exists(Trim(temp(j))) Then\n                Cells(i, \"D\").Value2 = Cells(i, \"D\").Value2 &amp; Trim(temp(j)) &amp; \";\"\n            End If\n        Next j\n\n        'remove trailing \";\"\n        If Right(Cells(i, \"D\").Value2, 1) = \";\" Then\n            Cells(i, \"D\").Value2 = Left(Cells(i, \"D\").Value2, Len(Cells(i, \"D\").Value2) - 1)\n        End If\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 5429130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19417d3430015ddff4bc9eb8d747d94?s=128&d=identicon&r=PG&f=1", "display_name": "ahhn", "link": "https://stackoverflow.com/users/5429130/ahhn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "accepted_answer_id": 52979135, "answer_count": 1, "score": 3, "last_activity_date": 1586462274, "creation_date": 1540419609, "last_edit_date": 1586462274, "question_id": 52978687, "link": "https://stackoverflow.com/questions/52978687/excel-vba-compare-delimited-string-in-cell-to-column-of-values", "title": "Excel VBA: Compare Delimited String in Cell to Column of Values", "body": "<p>I have a list of (semi-colon delimited) genes within column B I want to create <em>from that list</em>, a list of the genes which are found in Column A. </p>\n\n<pre><code>| Keep             | List                       |   | Result      |\n|------------------|----------------------------|---|-------------|\n| AASS;SESN1;SEPT5 | AASS                       |   | AASS        |\n|                  | ARMC2;SESN1;ARMC2AS1;SEPT5 |   | SESN1;SEPT5 |\n|                  |                            |   |             |\n</code></pre>\n\n<p>I have a start on a code, but it only appears to work for some of the gene lists, but not all.</p>\n\n<p>For example, the lists in cells B2 and B3 are extracted to Column C correctly, but cell B4 ends up with 7 extra terms (but running the VBA Script a second time results in the correct number &amp; composition), and B5 results in a strange output \"4;5;0;2;3;1;SNORD1161\" in D5.</p>\n\n<p>This the code that I have so far, and it was modified from: <a href=\"https://www.mrexcel.com/forum/excel-questions/654920-match-comma-delimited-values-cell-against-individual-values-column.html\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/forum/excel-questions/654920-match-comma-delimited-values-cell-against-individual-values-column.html</a></p>\n\n<p>Any help would be appreciated! Thanks!</p>\n\n<pre><code>Sub matchups2()\n\n    Dim regex_leading As New VBScript_RegExp_55.RegExp\n    Dim regex_middle As New VBScript_RegExp_55.RegExp\n    Dim regex_trailing As New VBScript_RegExp_55.RegExp\n\n    Set d = CreateObject(\"scripting.dictionary\")\n    For Each gene In Range(\"A2\", Cells(Rows.Count, \"A\").End(3)).Value\n        d(gene) = 1\n    Next gene\n    Stop\n\n    For Each genelist In Range(\"B2\", Cells(Rows.Count, \"B\").End(3))\n        c = genelist.Value\n        k = genelist.Row\n\n        For Each q In Split(c, \";\")\n            If d(q) &lt;&gt; 1 Then\n                c = Replace(c, q, \";\")\n            End If\n        Next q\n\n        regex_leading.Pattern = \"^;{1,}\"\n        With regex_middle\n            .Pattern = \";{1,}\"\n            .Global = True\n        End With\n        regex_trailing.Pattern = \";{1,}$\"\n\n        c = regex_leading.Replace(c, \"\")\n        c = regex_middle.Replace(c, \";\")\n        c = regex_trailing.Replace(c, \"\")\n\n        Cells(k, \"D\").Value = c\n    Next genelist\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "split", "ms-word", "page-break"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1540435208, "post_id": 52978637, "comment_id": 92867429, "body": "Why the interest in sections and &quot;records&quot;?  Are you splitting by page breaks or not?"}, {"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1540501166, "post_id": 52978637, "comment_id": 92900760, "body": "There is nothing &#39;wrong&#39; with the macro; it works as intended, <i>provided</i> the document you&#39;re running it on has already been saved. Note also that the code splits the document a <i>Section</i> breaks, not at <i>Page</i> breaks."}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1540442237, "creation_date": 1540442237, "answer_id": 52981436, "question_id": 52978637, "link": "https://stackoverflow.com/questions/52978637/how-do-i-split-my-one-document-into-many-at-page-breaks-in-vba/52981436#52981436", "title": "How do I split my one document into many at page breaks in VBA?", "body": "<p>Without knowing more (such as the value of <code>StrTxt</code>), I can't say for sure <em>why</em> you're getting the error but it's likely either an invalid filename, or the file is locked by another process, or a permissions issue. </p>\n\n<p>Perhaps the procedure below will work better for you.  (I'm unclear on the significance of \"records\" in your code.)</p>\n\n<hr>\n\n<h1>Split document into separate files for each page:</h1>\n\n<p>This procedure splits the <code>ActiveDocument</code> into one <code>.DOCX</code> file per \"visible page\" (calculated page breaks, manual page breaks, section breaks, etc).\\</p>\n\n<pre><code>Sub WordDocToPages()\n'splits active Word doc by page into separate DOCX files (same folder as active doc)\n  Dim doc As Document, docPage As Document, rgPage As Range\n  Dim pgNum As Long, pgCnt As Long, ext As String, fName As String\n  Set doc = ActiveDocument                                        'Use current document\n  Set rgPage = doc.Range                                          'create range of 1 page\n  Application.ScreenUpdating = False                              'prevent screen updates\n  pgCnt = doc.Content.Information(wdNumberOfPagesInDocument)      'get page count\n  Do While pgNum &lt; pgCnt\n      pgNum = pgNum + 1                                           'increment page counter\n      Application.StatusBar = \"Saving page \" &amp; pgNum &amp; \" of \" &amp; pgCnt\n      If pgNum &lt; pgCnt Then\n          Selection.GoTo wdGoToPage, wdGoToAbsolute, pgNum + 1    'top of next page\n          rgPage.End = Selection.Start                            'end of page=top of next\n      Else\n          rgPage.End = doc.Range.End                              'end of last page=EOF\n      End If\n      rgPage.Copy                                                 'copy page\n      Set docPage = Documents.Add(Visible:=False)                 'create new document\n      With docPage\n          With .Range\n              .Paste 'paste page\n              .Find.Execute Findtext:=\"^m\", ReplaceWith:=\"\"       'remove manual breaks\n              .Select\n          End With\n          With Selection\n              .EndKey wdStory                                     'goto end of doc\n              .MoveLeft wdCharacter, 1, wdExtend                  'remove final CR\n              If Asc(.Text) = 13 Then .Delete wdCharacter, 1      'remove trailing CR\n          End With\n          ext = Mid(doc.FullName, InStrRev(doc.FullName, \".\"))    'extract file extension\n          fName = Replace(doc.FullName, ext, \" #\" &amp; _\n              Format(pgNum, String(Len(CStr(pgCnt)), \"0\")) &amp; \".docx\") 'new filename\n          .SaveAs fName, wdFormatDocumentDefault                  'save single-page doc\n          .Close                                                  'close new document\n      End With\n      rgPage.Collapse wdCollapseEnd                               'ready for next page\n  Loop\n\n  Application.ScreenUpdating = True                               'resume screen updates\n  Application.StatusBar = \"Document was split into \" &amp; pgNum &amp; \" files.\"\n  Set docPage = Nothing: Set rgPage = Nothing: Set doc = Nothing  'cleanup objects\nEnd Sub\n</code></pre>\n\n<p><sup>This is loosely based on the example at <a href=\"https://usefulwarecom.wordpress.com/do-you-know-how-to-split-a-massive-document-into-multiple-documents-in-word/\" rel=\"nofollow noreferrer\">Usefulware Sharing</a>.</sup></p>\n\n<p>The new files are saved to the same folder as <code>ActiveDocument.Path</code>, with the document title appended with a sequential number. Note that <strong>existing output files are overwritten</strong>, and there is no validation or error handling.</p>\n"}], "owner": {"reputation": 21, "user_id": 10554414, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B8pVjlYEh0A/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbCHgTqblRapFpQxYZX-8gK7HlHxag/mo/photo.jpg?sz=128", "display_name": "Renee Lahey", "link": "https://stackoverflow.com/users/10554414/renee-lahey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1628, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1586675277, "creation_date": 1540419274, "last_edit_date": 1586675277, "question_id": 52978637, "link": "https://stackoverflow.com/questions/52978637/how-do-i-split-my-one-document-into-many-at-page-breaks-in-vba", "title": "How do I split my one document into many at page breaks in VBA?", "body": "<p>I am new to VBA. I got this macro from online and it has worked for me before, but now I am getting a runtime error from it. </p>\n\n<p>The macro is supposed to take a mail merged document I have, and split it into individual documents for each recipient. </p>\n\n<p>The runtime error 5487 is pointing me to the line </p>\n\n<pre><code>\" .SaveAs fileName:=StrTxt &amp;...\". \n</code></pre>\n\n<p>I have tried to save it as a different file format, and have gone through the other posts on StackOverflow where others have the same error, but I am still getting the error message. </p>\n\n<p>My code is:</p>\n\n<pre><code>Sub SplitMergedDocument()\n  ' Source: http://msofficeforums.com/mail-merge/21803-mailmerge-tips-tricks.html\n  Const StrNoChr As String = \"\"\"*./\\:?|\"\n  Dim i As Long, j As Long, k As Long, StrTxt As String\n  Dim Rng As Range, Doc As Document, HdFt As HeaderFooter\n  Application.ScreenUpdating = False\n  j = InputBox(\"How many Section breaks are there per record?\", \"Split By Sections \", 1)\n  With ActiveDocument\n      For i = 1 To .Sections.Count - 1 Step j ' Process each Section\n          With .Sections(i)\n              Set Rng = .Range.Paragraphs(1).Range ' Get 1st paragraph\n              With Rng\n                  .MoveEnd wdCharacter, -1 'range to exclude final paragraph break\n                  StrTxt = .Text\n                  For k = 1 To Len(StrNoChr)\n                      StrTxt = Replace(StrTxt, Mid(StrNoChr, k, 1), \"_\")\n                  Next\n              End With\n              ' Construct destination file path &amp; name\n              StrTxt = ActiveDocument.Path &amp; Application.PathSeparator &amp; StrTxt\n              Set Rng = .Range ' Get whole Section\n              With Rng\n                  If j &gt; 1 Then .MoveEnd wdSection, j - 1\n                  .MoveEnd wdCharacter, -1 'Contract range to exclude Section break\n                  .Copy ' Copy range\n              End With\n          End With\n          ' Create output document\n          Set Doc = Documents.Add(Template:=ActiveDocument.AttachedTemplate.FullName _\n              , Visible:=False)\n          With Doc\n              ' Paste contents into output document, preserving formatting\n              .Range.PasteAndFormat (wdFormatOriginalFormatting)\n              ' Delete trailing paragraph breaks &amp; page breaks at end\n              While .Characters.Last.Previous = vbCr Or .Characters.Last.Previous = Chr(12)\n                  .Characters.Last.Previous = vbNullString\n              Wend\n              For Each HdFt In Rng.Sections(j).Headers ' Replicate headers &amp; footers\n                  .Sections(j).Headers(HdFt.Index).Range.FormattedText = HdFt.Range.FormattedText\n              Next\n              For Each HdFt In Rng.Sections(j).Footers\n                  .Sections(j).Footers(HdFt.Index).Range.FormattedText = HdFt.Range.FormattedText\n              Next\n              ' Save &amp; close output document\n              .SaveAs FileName:=StrTxt &amp; \".docx\", FileFormat:=wdFormatXMLDocument _\n                    , AddToRecentFiles:=False\n              .Close SaveChanges:=False\n          End With\n      Next\n  End With\n  Set Rng = Nothing: Set Doc = Nothing\n  Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Thank you!</p>\n"}, {"tags": ["excel", "vba", "word-count"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1540419028, "creation_date": 1540419028, "answer_id": 52978581, "question_id": 52978539, "link": "https://stackoverflow.com/questions/52978539/excel-vba-counting-word-occurence-while-creating-list-of-words/52978581#52978581", "title": "EXCEL VBA: Counting word occurence while creating list of words", "body": "<p>I'll just deal with the unique list and count.</p>\n\n<pre><code>...\n'Fill dictionary with all values (this filters out duplicates)\nFor i = LBound(varValues) To UBound(varValues)\n    d.item(varValues(i)) = d.item(varValues(i)) + 1\nNext i\n\n'Write All The values back to your worksheet\nRange(\"B1\").resize(d.count, 1) = Application.Transpose(d.Keys)\nRange(\"C1\").resize(d.count, 1) = Application.Transpose(d.items)\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 10292440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c9d827fe9645a7f0d2e9433a96982b4?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Huh", "link": "https://stackoverflow.com/users/10292440/daniel-huh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 405, "favorite_count": 1, "accepted_answer_id": 52978581, "answer_count": 1, "score": 2, "last_activity_date": 1540419095, "creation_date": 1540418750, "question_id": 52978539, "link": "https://stackoverflow.com/questions/52978539/excel-vba-counting-word-occurence-while-creating-list-of-words", "title": "EXCEL VBA: Counting word occurence while creating list of words", "body": "<p>I need to create a list of words used in all cells in column A, with a count of occurrence for each word on the list.</p>\n\n<p>So far, I've been able to create the list of words. (by searching the forum.)\nThe list of words is generated in column B, can anyone help me with the code so it also generate the count of occurrence in column C?</p>\n\n<p>Thank you!</p>\n\n<pre><code>Sub Sample()\n\nDim varValues As Variant\nDim strAllValues As String\nDim i As Long\nDim d As Object\n\n'Create empty Dictionary\nSet d = CreateObject(\"Scripting.Dictionary\")\n\n'Create String With all possible Values\nstrAllValues = Join(Application.Transpose(Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp))), \" \")\nstrAllValues = Replace(strAllValues, \".\", \"\")\nstrAllValues = Replace(strAllValues, \",\", \"\")\nstrAllValues = Replace(strAllValues, \"!\", \"\")\nstrAllValues = Replace(strAllValues, \"?\", \"\")\nstrAllValues = Application.WorksheetFunction.Trim(strAllValues)\n\n\n'Split All Values by space into array\nvarValues = Split(strAllValues, \" \")\n\n'Fill dictionary with all values (this filters out duplicates)\nFor i = LBound(varValues) To UBound(varValues)\n    d(varValues(i)) = 1\nNext i\n\n'Write All The values back to your worksheet\nRange(\"B1:B\" &amp; d.Count) = Application.Transpose(d.Keys)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13, "user_id": 10554595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda2ce30042b365dd40b65e274886710?s=128&d=identicon&r=PG&f=1", "display_name": "Rokomo", "link": "https://stackoverflow.com/users/10554595/rokomo"}, "edited": false, "score": 0, "creation_date": 1540419134, "post_id": 52978462, "comment_id": 92863641, "body": "The sheet stays protected so the users can not delete the formulas or macro buttons on that sheet by mistake."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10554595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda2ce30042b365dd40b65e274886710?s=128&d=identicon&r=PG&f=1", "display_name": "Rokomo", "link": "https://stackoverflow.com/users/10554595/rokomo"}, "edited": false, "score": 0, "creation_date": 1540430115, "post_id": 52979515, "comment_id": 92866312, "body": "Thanks, that helps a lot. I&#39;m learning  VBA on the fly while working on this project for work."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1540427014, "last_edit_date": 1540427014, "creation_date": 1540425646, "answer_id": 52979515, "question_id": 52978462, "link": "https://stackoverflow.com/questions/52978462/excel-unprotect-sheet-in-a-beforeclose-script-not-working-when-called-by-thiswor/52979515#52979515", "title": "Excel unprotect sheet in a BeforeClose script not working when called by ThisWorkbook.Close", "body": "<p>First off, I wouldn't put that code in Workbook_BeforeClose; I would put it in a Workbook_BeforeSave instead and use,</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\n    if not thisworkbook.saved then _\n        ThisWorkbook.Save\n\nEnd Sub\n</code></pre>\n\n<p>... as the method of closing out the workbook. I'm not going to write paragraphs of white-paper jargon as to why; it just seems like a better method to me and still allows you to force the workbook to a certain condition before it is closed. With your method, it is theoretically possible to manually save the workbook in another condition then make a copy of the freshly saved workbook through file explorer without closing the workbook.</p>\n\n<p>Finally, why isn't the Control Tab worksheet protected with the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.protect\" rel=\"nofollow noreferrer\">UserInterfaceOnly:=True</a> argument? This would allow you to make any modification you want through VBA without unprotecting/modifying/reprotecting that particular worksheet while still restricting the user.</p>\n\n<p>Run this <strong>once</strong> then remove all VBA references to unprotect/protect the \"Control Tab\" worksheet (unless you specifically want to open it up to the user).</p>\n\n<pre><code>sub RunOnce()\n    with thisworkbook.worksheets(\"Control Tab\")\n        .Unprotect Password:=pw\n        .Protect Password:=pw, UserInterfaceOnly:=True\n    end with\nend sub\n</code></pre>\n\n<p>Any and all VBA coding that affects the Control Tab worksheet will run. <em>Caveat:</em> there may be some coded modification that require Application.DisplayAlerts = False if you want to avoid distracting message dialogs altogether.</p>\n"}], "owner": {"reputation": 13, "user_id": 10554595, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cda2ce30042b365dd40b65e274886710?s=128&d=identicon&r=PG&f=1", "display_name": "Rokomo", "link": "https://stackoverflow.com/users/10554595/rokomo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 52979515, "answer_count": 1, "score": 0, "last_activity_date": 1586462310, "creation_date": 1540418292, "last_edit_date": 1586462310, "question_id": 52978462, "link": "https://stackoverflow.com/questions/52978462/excel-unprotect-sheet-in-a-beforeclose-script-not-working-when-called-by-thiswor", "title": "Excel unprotect sheet in a BeforeClose script not working when called by ThisWorkbook.Close", "body": "<p>I have an excel workbook that protects and hides all worksheets but one before the workbook is closed.  On that one worksheet it is supposed to unprotect the sheet, clear out some cell values, then reprotect the sheet. </p>\n\n<p>When I close the workbook with the X in the top corner the sub runs just fine.  When I try to use ThisWorkbook.Close the sub does not actually unprotect the sheet so I get a Run-time error '1004' when it tries to clear the cell values. </p>\n\n<p>I need the .Close method to work for another script which will close the workbook after x amount of time.</p>\n\n<p>Before Close Script</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\nThisWorkbook.Unprotect Password:=pw\nFor Each Worksheet In ThisWorkbook.Worksheets\n    Worksheet.Protect Password:=pw\n    If Worksheet.Name = \"Control Tab\" Then\n        With Worksheet\n            .Unprotect Password:=pw\n            .Cells(24, 4).Value = \"\"\n            .Cells(24, 5).Value = \"\"\n            .Cells(24, 6).Value = \"\"\n            .Cells(24, 7).Value = \"\"\n            .Cells(24, 8).Value = \"\"\n            .Cells(24, 9).Value = \"\"\n            .Cells(24, 10).Value = \"\"\n            .Cells(24, 11).Value = \"\"\n            .Cells(24, 12).Value = \"\"\n            .Cells(24, 13).Value = \"\"\n            .Cells(24, 14).Value = \"\"\n            .Cells(24, 15).Value = \"\"\n            .Cells(24, 16).Value = \"\"\n            .Protect Password:=pw\n        End With\n    Else\n        Worksheet.Visible = 0\n    End If\nNext\nThisWorkbook.Protect Password:=pw\n\nThisWorkbook.Save\nEnd Sub\n</code></pre>\n\n<p>Button to close workbook (for testing)</p>\n\n<pre><code>Sub Button1_Click()\n    ThisWorkbook.Close\nEnd Sub\n</code></pre>\n\n<p>I've tried to search for a reason why there might be a difference between problematically and manually closing a workbook on google and stackoverflow but haven't found any insight as to why the script won't unprotect the sheet. Any help would be greatly appreciated. </p>\n"}, {"tags": ["excel", "vba", "conditional-statements"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 2, "creation_date": 1540417094, "post_id": 52978215, "comment_id": 92863038, "body": "Use a=CLng(inputbox(&quot;value1:&quot;)), and the likes, to have strings converted into longs (or use CDbl() if you expect not integer values)"}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1540417156, "post_id": 52978215, "comment_id": 92863057, "body": "What are the <i>types</i> of the variables? You should get in the habit of declaring them with <code>Dim</code>. Use <code>Option Explicit</code> to force yourself to do so. If you had declared them to be a numerical type, this wouldn&#39;t have been an issue."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1540417776, "last_edit_date": 1540417776, "creation_date": 1540417296, "answer_id": 52978292, "question_id": 52978215, "link": "https://stackoverflow.com/questions/52978215/if-returns-false-when-it-sould-return-true/52978292#52978292", "title": "IF returns FALSE when it sould return TRUE", "body": "<p>Your InputBoxes are returning strings that look like numbers and <code>\"5\"</code> is not less than <code>\"10\"</code>. Do one of the following:</p>\n\n<ul>\n<li><code>Dim a as long, b as long, c as long</code></li>\n<li>Use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.inputbox\" rel=\"nofollow noreferrer\">Application.InputBox</a> with Type:=1 argument.</li>\n<li>Convert the strings to real numbers like <code>a=clng(inputbox(\"value1:\"))</code> or <code>if int(a)&lt;int(b) and int(a)&gt;int(c) then</code>.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 7975863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d58f5314856b1da7ca2db18276fcfd9c?s=128&d=identicon&r=PG&f=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/7975863/mike"}, "is_accepted": true, "score": 2, "last_activity_date": 1540417566, "last_edit_date": 1540417566, "creation_date": 1540417382, "answer_id": 52978307, "question_id": 52978215, "link": "https://stackoverflow.com/questions/52978215/if-returns-false-when-it-sould-return-true/52978307#52978307", "title": "IF returns FALSE when it sould return TRUE", "body": "<p>This happens because VBA is treating your input as strings. Just add a CInt() or a CLng() to the variables to excel know that they are numeric.</p>\n\n<pre><code>Sub test()\n\na = CInt(InputBox(\"value1:\"))\nb = CInt(InputBox(\"value2:\"))\nc = CInt(InputBox(\"value3:\"))\n\n  If a &lt; b And a &gt; c Then\n    MsgBox (a)\n\n    Else\n      MsgBox (b)\n      MsgBox (c)\n   End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1540418322, "creation_date": 1540418322, "answer_id": 52978466, "question_id": 52978215, "link": "https://stackoverflow.com/questions/52978215/if-returns-false-when-it-sould-return-true/52978466#52978466", "title": "IF returns FALSE when it sould return TRUE", "body": "<p>The other two answers are excellent and I would <strong>ultimately go with Jeeped's explicit variable declaration method</strong> (<code>Dim a as long, b as long, c as long</code>).</p>\n\n<p>While I would never suggest <em>not declaring your variables</em> - which you found out the hard way why it's always good practice to do so - you could also simply multiply your inputbox by 1.</p>\n\n<p>Here's just another trick to force a string to a numerical value using the power of multiplication <em>(this is a similar trick used in worksheet formulas that use the double negative <code>--()</code> to convert a value into a number)</em>.</p>\n\n<pre><code>a = InputBox(\"value1:\") * 1\nb = InputBox(\"value2:\") * 1\nc = InputBox(\"value3:\") * 1\n\nIf a &lt; b And a &gt; c Then\n\n    MsgBox (a)\n\nElse\n\n    MsgBox (b)\n    MsgBox (c)\n\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 10554194, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8ce4cb39e5a258701ebc06aa0c365dd?s=128&d=identicon&r=PG&f=1", "display_name": "m.siget", "link": "https://stackoverflow.com/users/10554194/m-siget"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 52978307, "answer_count": 3, "score": 4, "last_activity_date": 1540418322, "creation_date": 1540416874, "question_id": 52978215, "link": "https://stackoverflow.com/questions/52978215/if-returns-false-when-it-sould-return-true", "title": "IF returns FALSE when it sould return TRUE", "body": "<p>I tried to do something like this </p>\n\n<pre><code>sub test()\na=inputbox(\"value1:\")\nb=inputbox(\"value2:\")\nc=inputbox(\"value3:\")\n\n  if a&lt;b and a&gt;c then \n\n    msgbox(a)\n\n    else\n      msgbox(b)\n      msgbox(c)\n   end if\n\nend sub \n</code></pre>\n\n<p>when I enter values such as 5 for a, 10 for b and 2 for c, condition should return TRUE and then message box with a is shown, but it returns FALSE and displays message boxes with b and c. I think the solution is pretty simple but I can't figure it out. </p>\n\n<p>thanks a lot </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1540414461, "post_id": 52977720, "comment_id": 92862036, "body": "Did you confirm that <code>WshSource</code> actually set properly? Maybe add a for each ws loop on that workbook and print the ws names to the immediate window. Verify that those names match your expectations - assuming that <code>WshSource</code> is not &#39;<i>Nothing</i>&#39;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1540414584, "post_id": 52977720, "comment_id": 92862092, "body": "^^ this and <code>directory\\v0.xlsm</code> is an incomplete path that defaults to the &#39;current&#39; directory which may or may not be the folder the coded workbook resides in."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1540414748, "post_id": 52977720, "comment_id": 92862170, "body": "Probably a typo from redacting your code prior to posting but <code>dircectory &lt;&gt; directory</code>."}, {"owner": {"reputation": 13, "user_id": 9525048, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Marcus Delatorre", "link": "https://stackoverflow.com/users/9525048/marcus-delatorre"}, "edited": false, "score": 0, "creation_date": 1540416777, "post_id": 52977720, "comment_id": 92862921, "body": "yea the directory is just redacted."}, {"owner": {"reputation": 13, "user_id": 9525048, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Marcus Delatorre", "link": "https://stackoverflow.com/users/9525048/marcus-delatorre"}, "edited": false, "score": 0, "creation_date": 1540416871, "post_id": 52977720, "comment_id": 92862956, "body": "The WshSource workbook does come back as nothing after I step through setting it but it doesn&#39;t fault out. Should I move the dimensioning into the while loop?"}], "owner": {"reputation": 13, "user_id": 9525048, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Marcus Delatorre", "link": "https://stackoverflow.com/users/9525048/marcus-delatorre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1586462346, "creation_date": 1540414207, "last_edit_date": 1586462346, "question_id": 52977720, "link": "https://stackoverflow.com/questions/52977720/problem-with-workbook-not-being-dimmensioned", "title": "Problem with workbook not being dimmensioned", "body": "<p>I'm trying to copy the formatting from specific workbook sheets from one workbook V0 then loop through a folder and paste the formatting to other workbooks.</p>\n\n<p>The issue I'm having is the when I try set ws1 as one of the source sheets I get an object undefined error. The ws1 is defined at the top. When I run the code through debug all the other variables the function calls are fine and they were defined the same way.   </p>\n\n<pre><code>Dim StrFile As String, SDir As String                              \nDim name As String                        \nDim Src_pg1 As String, Src_pg2 As String     'Source and Target sheets \nDim Trgt_pg1 As String, Trgt_pg2 As String\nDim ws1 As Worksheet, ws2 As Worksheet            'define worksheets\nDim ws3 As Worksheet, ws4 As Worksheet\n\nDim WshSource As Workbook\nDim WshTarget As Workbook\n\nSDir = \"dircectory\"\n\nStrFile = Dir(SDir + \"\\*\")\nSrc_pg1 = \"Homepage Update\"\nTrgt_pg1 = \"Homepage\"\nSrc_pg2 = \"raw\"\nTrgt_pg2 = \"sample\"\n\nApplication.ScreenUpdating = False\nDo While Len(StrFile) &gt; 0\n    name = StrFile\n    Set WshSource = Workbooks.Open(\"directory\\v0.xlsm\", True, True)\n    Set WshTarget = Workbooks.Open(SDir + \"\\\" + name, True, True)\n\n    Set ws1 = WshSource.Sheets(Src_pg1) '******* Where the error happens****\n    Set ws2 = WshTarget.Sheets(Trgt_pg1)\n    Set ws3 = WshSource.Sheets(Src_pg2)\n    Set ws4 = WshTarget.Sheets(Trgt_pg2)\n\n    ws1.Cells.Copy\n    ws2.Cells.PasteSpecial Paste:=xlPasteFormats     'Source format pasted\n    ws2.Cells.PasteSpecial Paste:=xlPasteComments    'Comments are pasted.\n    ws2.Cells.PasteSpecial Paste:=xlPasteValidation  'Validations are pasted\n    Application.CutCopyMode = False\n    'Application.Goto .Cells(1), 1\n    ws3.Cells.Copy\n    ws4.Cells.PasteSpecial Paste:=xlPasteFormats     'Source format pasted\n    ws4.Cells.PasteSpecial Paste:=xlPasteComments    'Comments are pasted.\n    ws4.Cells.PasteSpecial Paste:=xlPasteValidation  'Validations are pasted\n    Application.CutCopyMode = False\n    'Application.Goto .Cells(1), 1\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1540412180, "post_id": 52977261, "comment_id": 92861035, "body": "Is this in the Sheet1 private code sheet or in a public module code sheet?"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1540412260, "post_id": 52977261, "comment_id": 92861079, "body": "remove that <code>On Error Resume Next</code> and check what are you getting <code>lrow</code>. You are comparing column B and looping Column F, bit lRow is coming from Col A. What if Col A is blank."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1540412389, "post_id": 52977261, "comment_id": 92861137, "body": "@cyboashu, you forgot the incorrect use of xldown from rows.count."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "reply_to_user": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1540412592, "post_id": 52977261, "comment_id": 92861229, "body": "@Cyboashu the error I&#39;m getting is &quot;Object variable or with block variable not set&quot; not sure what it doesn&#39;t like. I did change lrow to column 2, but still same error."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1540412696, "post_id": 52977261, "comment_id": 92861264, "body": "Changed to up from down. Issue now with rCell = Range(&quot;B14:B&quot; &amp; lrow).... same error as above"}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1540412714, "post_id": 52977261, "comment_id": 92861276, "body": "because  <code>rCell = Range(&quot;B14:B&quot; &amp; lrow)</code> is wrong. use <code>Set rCell = Range(&quot;B14:B&quot; &amp; lrow)</code>"}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1540412846, "post_id": 52977261, "comment_id": 92861339, "body": "ahh okay that&#39;s a good push. Now it&#39;s working but it&#39;s not taking the date into account. It&#39;s just filing in the value &quot;x&quot; for all the date."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 3, "last_activity_date": 1540413375, "last_edit_date": 1540413375, "creation_date": 1540412999, "answer_id": 52977485, "question_id": 52977261, "link": "https://stackoverflow.com/questions/52977261/make-entry-in-cell-based-on-current-date/52977485#52977485", "title": "Make entry in cell based on current date", "body": "<blockquote>\n  <p>I'm going to assume this is in the Sheet1 private code sheet and not in a public module code sheet. In a worksheeet's private code sheet, all Range and Cells default to that worksheet as the parent so there is no need to quaily a parent worksheet unless you are referring to another worksheet.</p>\n</blockquote>\n\n<p>Run through column B and change column F to suit.</p>\n\n<pre><code>Sub button_1()\n\n    Dim i as long, lrow As Long\n\n    lrow = Cells(Rows.Count, \"B\").End(xlup).Row  '&lt;~~ note xlUp not xlDown\n\n    For i=14 to lrow\n        'might as well make sure we aren't looking at blank cells as well\n        If cells(i, \"B\").Value2 &lt;= Date and not isempty(cells(i, \"B\")) Then\n            cells(i, \"F\") = \"x\"\n        Else     '&lt;~~ no need for further comparisons\n            cells(i, \"F\") = vbnullstring\n        End If\n    Next i   \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 52977485, "answer_count": 1, "score": 2, "last_activity_date": 1543598639, "creation_date": 1540411940, "last_edit_date": 1543598639, "question_id": 52977261, "link": "https://stackoverflow.com/questions/52977261/make-entry-in-cell-based-on-current-date", "title": "Make entry in cell based on current date", "body": "<p>I want to mark an \"X\" in the F column if the date in B14 (and down) are dates less than the current day and leave any where the dates are greater than the current date blank.</p>\n\n<p>It is just marking an X all the way to the bottom regardless of the date.</p>\n\n<pre><code>Sub button_1()\n\nDim rCell As Range\nDim lrow As Long\n\nOn Error Resume Next\n\nlrow = ActiveSheet.Cells(Rows.Count, 1).End(xlDown).Row\nrCell = Range(\"B14:B\" &amp; lrow)\n\nWith Sheet1\n    For Each rCell In .Range(\"F14:F\" &amp; lrow).Cells\n        If rCell.Value &lt;= Date Then\n            rCell.Value = \"x\"\n        ElseIf rCell.Value &gt; Date Then\n            rCell.Value = rCell.Value\n        End If\n    Next rCell\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "image", "export"], "answers": [{"tags": [], "owner": {"reputation": 290, "user_id": 6387947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68bd3078f0f802c7e8769ecfd63878d8?s=128&d=identicon&r=PG&f=1", "display_name": "scenography", "link": "https://stackoverflow.com/users/6387947/scenography"}, "is_accepted": false, "score": 0, "last_activity_date": 1540604594, "creation_date": 1540604594, "answer_id": 53018058, "question_id": 52977136, "link": "https://stackoverflow.com/questions/52977136/i-have-and-excel-file-in-column-a-serial-number-in-column-b-id-number-in-colmn/53018058#53018058", "title": "I have and excel file in column A serial number in column B ID Number, in Colmn 3 photograph of a person", "body": "<p>The photographs are Shape objects. For code to export them, look at the answers to this question, <a href=\"https://stackoverflow.com/a/18234074/6387947\">Export pictures from excel file into jpg using VBA</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10554208, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VyxP_3Lnekw/AAAAAAAAAAI/AAAAAAAABEM/JZPs5Bsjgyg/photo.jpg?sz=128", "display_name": "arshab", "link": "https://stackoverflow.com/users/10554208/arshab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1540604594, "creation_date": 1540411423, "question_id": 52977136, "link": "https://stackoverflow.com/questions/52977136/i-have-and-excel-file-in-column-a-serial-number-in-column-b-id-number-in-colmn", "title": "I have and excel file in column A serial number in column B ID Number, in Colmn 3 photograph of a person", "body": "<p>I have and excel file. in sheet1 column  A is serial number column B is ID Number, Column C is image of a person, and column D is Name,\nnow I want to export photograph to C/temp in jpg format, in the place of name i need there ID number wich is in column B, in vba, there are more then 1000 rows , pls help</p>\n"}, {"tags": ["vba", "loops", "fonts", "ms-word"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1540410882, "post_id": 52976892, "comment_id": 92860437, "body": "You declared <code>Counter</code> as type integer but used the undeclared variable <code>i</code> instead? Not the issue, but just more reason you should use <code>Option Explicit</code> on the top of <b>every module</b>."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1540411530, "post_id": 52976892, "comment_id": 92860710, "body": "<code>If foo = &quot;abc*&quot;</code> will be true if <code>foo</code> is <b>equal to</b> the string literal <code>&quot;abc*&quot;</code>. Equality/comparison operator <code>=</code> doesn&#39;t do wildcards."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1540476382, "post_id": 52976892, "comment_id": 92887795, "body": "Do these font names actually contain asterisks - <code>*</code>? Note that it would probably be faster and more efficient to use Word&#39;s built-in Find/Replace functionality."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 4595085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153191879466834/picture?type=large", "display_name": "Keri", "link": "https://stackoverflow.com/users/4595085/keri"}, "edited": false, "score": 0, "creation_date": 1540570010, "post_id": 52977088, "comment_id": 92928490, "body": "What do I add/adjust here in order to loop the font change through the entire document without a pop-up prompt for each change?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 37, "user_id": 4595085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153191879466834/picture?type=large", "display_name": "Keri", "link": "https://stackoverflow.com/users/4595085/keri"}, "edited": false, "score": 0, "creation_date": 1540572827, "post_id": 52977088, "comment_id": 92929693, "body": "If you are wanting to keep the same method that you are using then I believe you should be able to do something like <code>For i = 1 to doc.Range.Characters.Count</code> instead of <code>... To 6</code>"}, {"owner": {"reputation": 37, "user_id": 4595085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153191879466834/picture?type=large", "display_name": "Keri", "link": "https://stackoverflow.com/users/4595085/keri"}, "edited": false, "score": 0, "creation_date": 1540674197, "post_id": 52977088, "comment_id": 92954256, "body": "Going back to the original scenario. I have table data in excel where 1 column specifies the string, and another specifies the font face for the string. My end goal is to populate the table-boxes in the word file with the string in the font face specified."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 3, "last_activity_date": 1540411851, "last_edit_date": 1540411851, "creation_date": 1540411220, "answer_id": 52977088, "question_id": 52976892, "link": "https://stackoverflow.com/questions/52976892/how-can-i-loop-macro/52977088#52977088", "title": "How can I loop macro?", "body": "<p>Use the <code>Like</code> operator instead of <code>=</code> when using wildcards.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code> Option Explicit\n\n Sub grandma()\n\n     Dim doc As Document\n     Set doc = ActiveDocument\n     Dim i As Integer\n\n     For i = 1 To 6\n\n        With doc.Range.Characters(i).Font\n            Select Case True\n            Case .Name like \"*rage*\"\n                .Name = \"Waiting for the Sunrise\"\n            Case .Name Like \"*wait*\"\n                .Name = \"Rage Italic\"\n            Case .Name Like \"*arial*\"\n                .Name = \"Arial Nova Cond Light\"\n            End Select\n        End With\n\n        MsgBox \"Hi! \" &amp; i\n\n     Next i\n\n End Sub\n</code></pre>\n\n<blockquote>\n  <p><strong>Side Note:</strong> It is my personal preference to avoid using the data type <code>Integer</code> and instead use <code>Long</code> - unless dealing with legacy applications that would overflow with a <code>Long</code> or for some reason I don't want to give up those two extra bytes of memory <em>(sarcasm)</em>. Especially when dealing with individual word document <em>characters</em> - which a document can contain many many thousands of characters, you can overflow an Integer quickly.</p>\n  \n  <p>Take a look at <a href=\"https://stackoverflow.com/q/26409117/5781745\">Why Use Integer Instead of Long?</a> for more information.</p>\n</blockquote>\n"}], "owner": {"reputation": 37, "user_id": 4595085, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153191879466834/picture?type=large", "display_name": "Keri", "link": "https://stackoverflow.com/users/4595085/keri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1586675299, "creation_date": 1540410545, "last_edit_date": 1586675299, "question_id": 52976892, "link": "https://stackoverflow.com/questions/52976892/how-can-i-loop-macro", "title": "How can I loop macro?", "body": "<p>Why does this VBA code not work? These documents used a special font called <strong>rage, wait, arial</strong>. I would like to loop through every letter of the document and whenever the <code>.Font = \"*rage*\"</code> I would like to loop through the dozen letters. (My stroke - patience.)</p>\n\n<pre><code> Sub grandma()\n\n Dim doc As Document\n Set doc = ActiveDocument\n Dim Counter As Integer\n\n For i = 1 To 6\n      doc.Range.Characters.Count\n      If doc.Range.Characters(i).Font.Name = \"*rage*\" Then\n         doc.Range.Characters(i).Font.Name = \"Waiting for the Sunrise\"\n      End If\n      If doc.Range.Characters(i).Font.Name = \"*wait*\" Then\n         doc.Range.Characters(i).Font.Name = \"Rage Italic\"\n      End If\n      If doc.Range.Characters(i).Font.Name = \"*arial*\" Then\n         doc.Range.Characters(i).Font.Name = \"Arial Nova Cond Light\"\n      End If\n      j = i\n\n MsgBox \"Hi! \" &amp; i\n Next i\n\n End Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Ns6Ut.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Ns6Ut.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1540410065, "post_id": 52976696, "comment_id": 92860064, "body": "Best guess is that there is some volatile worksheet function (indirect, offset, today, now, address, etc) that is precedent, dependent or directly involved with <i>collet</i>. I&#39;m unsure but it could be <code>WorksheetFunction.RandBetween</code> which is also volatile."}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1540410157, "post_id": 52976696, "comment_id": 92860109, "body": "Put a breakpoint on the line in the ToColletter function. Once it is hit, check the call stack (Ctrl + L). If there is only one line, you can be fairly sure it is called from a cell. If there are more lines, you have found the code line you were looking for."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1540410322, "post_id": 52976696, "comment_id": 92860190, "body": "(btw, there are easier ways to generate 6 &#39;random&#39; unique numbers)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1540411063, "post_id": 52976696, "comment_id": 92860514, "body": "Well, it&#39;s not your use of WorksheetFunction.RandBetween so look at <i>collet</i>."}, {"owner": {"reputation": 15, "user_id": 10205262, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CpAElIbJGEs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxIZeNWDhZMXzdNxze0Gu4A1qYQQ/mo/photo.jpg?sz=128", "display_name": "Nathan Wulf", "link": "https://stackoverflow.com/users/10205262/nathan-wulf"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1540411769, "post_id": 52976696, "comment_id": 92860825, "body": "Thanks for the feedback! I did as @Sam suggested and placed a breakpoint in the ToColletter function and checked the call stack from there. It was pointing to  ActiveCell.Value = WorksheetFunction.Small(NumbersArr(), x + 1) . I did as recommended by Josh Eller in his answer and placed the Application.Calculation = xlCalculationManual at the beginning and it no longer enters the the UDF ToColleter() until the very end when I set it back to xlCalculationAutomatic. So that seemed to do the trick!"}, {"owner": {"reputation": 15, "user_id": 10205262, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CpAElIbJGEs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxIZeNWDhZMXzdNxze0Gu4A1qYQQ/mo/photo.jpg?sz=128", "display_name": "Nathan Wulf", "link": "https://stackoverflow.com/users/10205262/nathan-wulf"}, "edited": false, "score": 0, "creation_date": 1540412327, "post_id": 52976696, "comment_id": 92861109, "body": "Also, @Jeeped, what are the easier ways to generate 6 random unique numbers? I only did a little bit of digging for other methods but didn&#39;t find anything that seemed significantly better."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10205262, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CpAElIbJGEs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxIZeNWDhZMXzdNxze0Gu4A1qYQQ/mo/photo.jpg?sz=128", "display_name": "Nathan Wulf", "link": "https://stackoverflow.com/users/10205262/nathan-wulf"}, "edited": false, "score": 0, "creation_date": 1540411880, "post_id": 52976881, "comment_id": 92860881, "body": "Not sure why your answer got downvoted, but setting the Application.Calculation = xlCalculationManual worked! Thank you! Perhaps whoever downvoted could give an explanation why they disagree?"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 15, "user_id": 10205262, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CpAElIbJGEs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxIZeNWDhZMXzdNxze0Gu4A1qYQQ/mo/photo.jpg?sz=128", "display_name": "Nathan Wulf", "link": "https://stackoverflow.com/users/10205262/nathan-wulf"}, "edited": false, "score": 0, "creation_date": 1540495995, "post_id": 52976881, "comment_id": 92898519, "body": "@NathanWulf: This answer is fundamentally flawed. The <code>ToColleter</code> function, as written is <i>not</i> volatile. But you may have another volatile function in a sheet/book which is triggered and the change to manual calculation fixes that. A good idea is to look through both books and identify the naturally volatile functions."}], "tags": [], "owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "is_accepted": true, "score": 0, "last_activity_date": 1540410513, "creation_date": 1540410513, "answer_id": 52976881, "question_id": 52976696, "link": "https://stackoverflow.com/questions/52976696/excel-vba-performing-user-defined-function-from-another-workbook-even-though-it/52976881#52976881", "title": "Excel vba performing user defined function from another workbook even though it is not being called", "body": "<p>Your ToColletter function is what's called a volatile function. This means it'll be recalculated every time your workbook is recalculated, regardless of whether the input values have changed. It's being called because your first function is updating values in a workbook, causing Excel to recalculate.</p>\n\n<p>This is because you're not directly giving your function values; instead, the function needs to go lookup a value from the worksheet, so the function can't know whether it needs to be recalculated until it actually goes and looks up that value.</p>\n\n<p>What you can do to fix it is get rid of the cells references in your function, and make the output depend only on the inputs. Alternatively, you can set <code>Application.Calculation = xlCalculationManual</code> prior to running your main sub, and set it back to <code>Application.Calculation = xlCalculationAutomatic</code> after it's finished. This will prevent Excel from automatically recalculating while your sub is running.</p>\n"}], "owner": {"reputation": 15, "user_id": 10205262, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CpAElIbJGEs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7oxIZeNWDhZMXzdNxze0Gu4A1qYQQ/mo/photo.jpg?sz=128", "display_name": "Nathan Wulf", "link": "https://stackoverflow.com/users/10205262/nathan-wulf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "accepted_answer_id": 52976881, "answer_count": 1, "score": 0, "last_activity_date": 1540410513, "creation_date": 1540409742, "question_id": 52976696, "link": "https://stackoverflow.com/questions/52976696/excel-vba-performing-user-defined-function-from-another-workbook-even-though-it", "title": "Excel vba performing user defined function from another workbook even though it is not being called", "body": "<p>I have a subroutine that generates 6 unique random numbers within a certain range and then places them, in ascending order, in individual cells in the worksheet (yes, this is a lottery ticket generator). The code works perfectly fine, except for when I have my other workbook open which contains a few user defined functions. Whenever my code gets to the point where it is placing the values in the cells, it enters my UDF ToColletter() and performs it several times (which does nothing except bog my program down majorly). I do not understand why it is executing my UDF, seeing as I am not calling it from within my subroutine, and it is not being called from within my workbook at all. I tried setting the module with the UDF to Option Private Module, but it would still call it and execute it several times. Even making the function itself a private function did nothing. Can anyone explain to me why this is happening and how I can stop the UDF from being executed unnecessarily? I am working in Excel 2016. Here is my code for the random number generator:</p>\n\n<pre><code>Sub LotteryNumbers()\nDim Num1 As Integer\nDim Num2 As Integer\nDim Num3 As Integer\nDim Num4 As Integer\nDim Num5 As Integer\nDim PwrNum As Integer\nDim NumbersArr(5) As Integer\nApplication.ScreenUpdating = False\n\nRange(\"A6\").Activate\n\n'Each loop generates one ticket containing 6 random numbers\n'The '+1' is the winning numbers\nFor y = 1 To Range(\"NumTickets\").Value + 1\n    'Generate random numbers\n    Num1 = WorksheetFunction.RandBetween(1, 70)\n    Num2 = Num1\n    Num3 = Num2\n    Num4 = Num3\n    Num5 = Num4\n    PwrNum = WorksheetFunction.RandBetween(1, 25)\n    'These loops prevent any of the numbers from equalling each other\n    Do While ((Num2 = Num1) Or (Num2 = Num3) Or (Num2 = Num4) Or (Num2 = Num5))\n        Num2 = WorksheetFunction.RandBetween(1, 70)\n    Loop\n    Do While ((Num3 = Num1) Or (Num3 = Num2) Or (Num3 = Num4) Or (Num3 = Num5))\n        Num3 = WorksheetFunction.RandBetween(1, 70)\n    Loop\n    Do While ((Num4 = Num1) Or (Num4 = Num2) Or (Num4 = Num3) Or (Num4 = Num5))\n        Num4 = WorksheetFunction.RandBetween(1, 70)\n    Loop\n    Do While (Num5 = Num4) Or (Num5 = Num3) Or (Num5 = Num2) Or (Num5 = Num1)\n        Num5 = WorksheetFunction.RandBetween(1, 70)\n    Loop\n\n    'Place the numbers in an array so they can be easily sorted\n    NumbersArr(1) = Num1\n    NumbersArr(2) = Num2\n    NumbersArr(3) = Num3\n    NumbersArr(4) = Num4\n    NumbersArr(5) = Num5\n\n    'Sort the numbers in ascending order and place them in 6 individual cells\n    For x = 1 To 5\n        'This is the line that calls the ToCollet() function\n        ActiveCell.Value = WorksheetFunction.Small(NumbersArr(), x + 1)\n        ActiveCell.Offset(0, 1).Activate\n    Next x\n    ActiveCell.Value = PwrNum\n    'Finish the loop at the beginning of the next row\n    ActiveCell.Offset(1, -5).Activate\nNext y\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Here is my code for the UDF ToCollet(), which is in a separate workbook and in a private module:</p>\n\n<pre><code>Function ToColletter(Collet)\n   ToColletter = Split(Cells(1, Collet).Address, \"$\")(1)\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "click-counting"], "comments": [{"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 1, "creation_date": 1540409891, "post_id": 52976573, "comment_id": 92859984, "body": "Do you have any code to show?"}], "answers": [{"comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1540411181, "post_id": 52976751, "comment_id": 92860559, "body": "Right click on the shape and choose Format Shape. There are also helper button on the Home ribbon. You can get lots of information on a google search for this."}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 3, "last_activity_date": 1540409966, "creation_date": 1540409966, "answer_id": 52976751, "question_id": 52976573, "link": "https://stackoverflow.com/questions/52976573/how-to-count-times-i-have-clicked-a-shape/52976751#52976751", "title": "How to count times I have clicked a shape?", "body": "<p>Add your shapes to a worksheet, then right-click and \"Assign Macro\". As an example, it can look like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/zVhCy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zVhCy.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then your code in a VBA module catches the click events from the shapes (because you linked the shape to the macro in the previous step):</p>\n\n<pre><code>Option Explicit\n\nSub Oval1_Click()\n    Dim countCell As Range\n    Set countCell = ActiveSheet.Range(\"D7\")\n    countCell = countCell + 1\nEnd Sub\n\nSub Oval2_Click()\n    Dim countCell As Range\n    Set countCell = ActiveSheet.Range(\"D7\")\n    countCell = 0\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 2, "creation_date": 1540411367, "post_id": 52977002, "comment_id": 92860640, "body": "Although the answer is correct, it is not the correct answer. I up-voted for your first attempt."}], "tags": [], "owner": {"reputation": 61, "user_id": 10442755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f935cb080ed82d3ef574687457898a5c?s=128&d=identicon&r=PG&f=1", "display_name": "Alvi", "link": "https://stackoverflow.com/users/10442755/alvi"}, "is_accepted": false, "score": 3, "last_activity_date": 1540410962, "creation_date": 1540410962, "answer_id": 52977002, "question_id": 52976573, "link": "https://stackoverflow.com/questions/52976573/how-to-count-times-i-have-clicked-a-shape/52977002#52977002", "title": "How to count times I have clicked a shape?", "body": "<p>You'll need to insert commandbutton from developer option and use that as shape.\nhere is code that will count number of times it is clicked.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nStatic cnt As Long\ncnt = cnt + 1\nMe.CommandButton1.Caption = \"I have been clicked \" &amp; cnt &amp; \" times\"\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10554059"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2397, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1590051871, "creation_date": 1540409254, "last_edit_date": 1590051871, "question_id": 52976573, "link": "https://stackoverflow.com/questions/52976573/how-to-count-times-i-have-clicked-a-shape", "title": "How to count times I have clicked a shape?", "body": "<p>I created a simple aim practice game, where you click on a circle that teleports when you click on it.</p>\n\n<p>I want to count how many times you have clicked the circle.</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1540409791, "post_id": 52976571, "comment_id": 92859933, "body": "The code you posted doesn&#39;t give that compile error.  It gives a bunch of other ones though.  Can you update the question to include the <b><i>actual code that is failing</i></b>?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1540410855, "post_id": 52976571, "comment_id": 92860426, "body": "You never set activeWS,  result 2 should not have a space. Call is not needed and the () can be removed/"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540411711, "post_id": 52976571, "comment_id": 92860795, "body": "Verify <b>all modules</b> have <code>Option Explicit</code> specified. Most likely cause, you&#39;re passing an undeclared <code>Variant&#47;Empty</code> with a typo in the name. Option Explicit catches that."}], "owner": {"reputation": 23, "user_id": 10382480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d32f181bc02ce5e6a606a4d94b2735e5?s=128&d=identicon&r=PG&f=1", "display_name": "user10382480", "link": "https://stackoverflow.com/users/10382480/user10382480"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 26, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540409246, "creation_date": 1540409246, "question_id": 52976571, "link": "https://stackoverflow.com/questions/52976571/get-an-error-byref-argument-type-mismatch", "title": "get an error &#39;ByRef argument type mismatch&#39;", "body": "<p>I have the following code:</p>\n\n<pre><code>sub refresh()\ndim result2 as string\ndim m as integer\ndim activeWS as worksheet\nFor m = 6 To 10\n            code = activeWS.Cells(m, 8).Value\n            result 2 = \"lkdsjlfaksj\" ;a query, I would just put a random string for now, and it would change every time based on value of m\n            Call GetOTCStruc(result2, m)\n            Next m\nend sub\n</code></pre>\n\n<p>'then I do something on the other function, which I just eliminate the code for now</p>\n\n<pre><code>Option Explicit\nPublic Sub GetOTCStruc(result2 As String, m As Integer)\n\n\n    ...\nEnd Sub\n</code></pre>\n\n<p>However, it has an error highlight the part on  Call GetOTCStruc(result2, m); any ideas why?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "loops", "msgbox"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540408514, "post_id": 52976301, "comment_id": 92859324, "body": "Just use <code>Rnd() + 26</code>."}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1540408814, "post_id": 52976301, "comment_id": 92859460, "body": "To get the 20 numbers, add an else statement after <code>ret = ret &amp; Str(f) else b = b -1 </code>"}, {"owner": {"reputation": 37, "user_id": 8649672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ll5L.jpg?s=128&g=1", "display_name": "Mari", "link": "https://stackoverflow.com/users/8649672/mari"}, "edited": false, "score": 0, "creation_date": 1540408951, "post_id": 52976301, "comment_id": 92859522, "body": "Thanks Comintern, this actually solved it. But what if I need to generate numbers from 26 - 30 ? Or even 26,4 | 28,1 | 27,3 etc? I will edit my question accordingly"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8649672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ll5L.jpg?s=128&g=1", "display_name": "Mari", "link": "https://stackoverflow.com/users/8649672/mari"}, "edited": false, "score": 1, "creation_date": 1540409418, "post_id": 52976473, "comment_id": 92859754, "body": "Hi Nicholas, Currently I am practising &quot;For&quot; but &quot;Do-Loop Until&quot; will be very useful for my next tasks. Thank you very much!"}], "tags": [], "owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "is_accepted": false, "score": 0, "last_activity_date": 1540408799, "creation_date": 1540408799, "answer_id": 52976473, "question_id": 52976301, "link": "https://stackoverflow.com/questions/52976301/vba-run-loop-until-have-x-examples-in-msgbox/52976473#52976473", "title": "VBA Run Loop until have X examples in MsgBox", "body": "<p>What you are looking for is a <code>Do-Loop Until</code> or <code>Do While-Loop</code> loop. This kind of loop runs until a condition is met. In your case, that condition would be \"20 messages are printed\".</p>\n\n<p>The <code>Do While-Loop</code> loop checks the condition at the start, so if the condition is <code>False</code> at first, the loop wont run.</p>\n\n<p>The <code>Do-Loop Until</code> loop checks the condition at the end, so the loop will run at least once.</p>\n\n<p>An example code following your previous <code>For</code> loop:</p>\n\n<pre><code>Sub C7()\n\nDim b As Integer\nDim f As Single\nDim ret As String\ndim count as Integer: count = 0\n\nDo\n    f = Rnd() * 28\n    If f &gt;= 26 And f &lt;= 28 Then\n        ret = ret &amp; Str(f)\n        count = count + 1\n    End If\nLoop until count = 20\n\n    MsgBox ret\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 327, "user_id": 9026704, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/52bbb5fedd54409e325089efa870b74c?s=128&d=identicon&r=PG&f=1", "display_name": "Nicholas Kemp", "link": "https://stackoverflow.com/users/9026704/nicholas-kemp"}, "edited": false, "score": 0, "creation_date": 1540409232, "post_id": 52976524, "comment_id": 92859660, "body": "Upvote for most efficient solution. However, I included a generic answer for &quot;run loop X times until something happens&quot; that OP should check."}, {"owner": {"reputation": 37, "user_id": 8649672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ll5L.jpg?s=128&g=1", "display_name": "Mari", "link": "https://stackoverflow.com/users/8649672/mari"}, "edited": false, "score": 0, "creation_date": 1540409245, "post_id": 52976524, "comment_id": 92859668, "body": "Thank you sir! This is exactly what I was looking for."}], "tags": [], "owner": {"reputation": 61, "user_id": 7475923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d69935d8707ae9a7f3272fb346f0f14?s=128&d=identicon&r=PG&f=1", "display_name": "Peter Ward", "link": "https://stackoverflow.com/users/7475923/peter-ward"}, "is_accepted": true, "score": 2, "last_activity_date": 1540409006, "creation_date": 1540409006, "answer_id": 52976524, "question_id": 52976301, "link": "https://stackoverflow.com/questions/52976301/vba-run-loop-until-have-x-examples-in-msgbox/52976524#52976524", "title": "VBA Run Loop until have X examples in MsgBox", "body": "<p>Change the randomize to give a number less than 3, then add 26.</p>\n\n<p>Rnd() returns a number between [0, 1), multiplying that by 28 will never result in 28.  And frequently will result in a number below 28, which gets avoided in the output because of your if block.</p>\n\n<p><code>f = (Rnd() * 3)</code>  will give a random number between [0, 3).</p>\n\n<p><code>f = ((Rnd() * 3) + 26)</code> will give a random number between [26, 29).</p>\n"}], "owner": {"reputation": 37, "user_id": 8649672, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3ll5L.jpg?s=128&g=1", "display_name": "Mari", "link": "https://stackoverflow.com/users/8649672/mari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 52976524, "answer_count": 2, "score": 0, "last_activity_date": 1540409006, "creation_date": 1540408112, "last_edit_date": 1540408641, "question_id": 52976301, "link": "https://stackoverflow.com/questions/52976301/vba-run-loop-until-have-x-examples-in-msgbox", "title": "VBA Run Loop until have X examples in MsgBox", "body": "<p>Today I am trying to run basic loop using \"for\". I would like to run a loop till I get 20 random numbers between 26 - 28 in MsgBox.</p>\n\n<pre><code>Sub C7()\n\n    Dim b As Integer\n    Dim f As Single\n    Dim ret As String\n\n    For b = 1 To 20\n        f = Rnd() * 28\n        If f &gt;= 26 And f &lt;= 28 Then\n        ret = ret &amp; Str(f)\n\n        End If\n    Next b\n\n        MsgBox ret\n\nEnd Sub\n</code></pre>\n\n<p>Following code runs the loop 20-times and gives me all values between 26 - 28 (usually not more than 3). What I need is a code which will run the loop X-times until it gives me 20 numbers between 26 - 27.</p>\n\n<p>Every advice is welcome! Thanks</p>\n"}, {"tags": ["sql", "excel", "vba", "adodb"], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1540476165, "post_id": 52989040, "comment_id": 92887636, "body": "Perfect. Thank you!"}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1540490482, "post_id": 52989040, "comment_id": 92895924, "body": "So in the example that he did, he only used one workbook as a datasource. If i want to use two workbooks as a database, how would i go on about doing it. Alternatively, is it even necessary to use both of them as database?"}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1540577252, "post_id": 52989040, "comment_id": 92931796, "body": "So for some reason, my access database is not being able to pick up the source file. It says the following:"}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1540577270, "post_id": 52989040, "comment_id": 92931801, "body": "The Microsoft Access database engine could not find the object &#39;Sheet1$A1:NC3&#39;. Make sure the object exists and that you spell its name and the path name correctly."}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1540817317, "post_id": 52989040, "comment_id": 92991070, "body": "rsSmall.Open &quot;select [Field1] from [getRollpHierRpt$]&quot;, conn1   assumes that A1 in sheet GetRollpHierRpt holds the text &quot;Field1&quot;   Are you sure that the sheet is named that and A1 has that text?"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1540907998, "post_id": 52989040, "comment_id": 93030331, "body": "20181015-Practice.xlsm has a sheet called getRollpHierRpt as well ? is that right?"}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1540926055, "post_id": 52989040, "comment_id": 93040696, "body": "So 20181015-Practice.xlsm only has a sheet called &quot;App. Book Code&quot; and indeed A1 in sheet GetRollpHierRpt holds the text &quot;Field1 and this is in rsmSmall"}, {"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "reply_to_user": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1541001254, "post_id": 52989040, "comment_id": 93071817, "body": "So it should be rsBig.Open &quot;select [App Code],[Legal Entity Desc],&quot; &amp; rsSmall(&quot;Field1&quot;) &amp; &quot;   As GetRollPH from [App Book Code$] where [BookTransit] = &quot; &amp;   rsSmall(&quot;Field1&quot;), conn2"}, {"owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "edited": false, "score": 0, "creation_date": 1541382219, "post_id": 52989040, "comment_id": 93185705, "body": "Hey, just letting you know, i was out of town. Will report back to you tomorrow"}], "tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1559206240, "last_edit_date": 1559206240, "creation_date": 1540469684, "answer_id": 52989040, "question_id": 52976240, "link": "https://stackoverflow.com/questions/52976240/how-to-merge-two-workbooks-with-one-common-column-using-sql-in-vba/52989040#52989040", "title": "How to merge two workbooks with one common column using SQL in VBA", "body": "<p>You will need to set a connection to each workbook. In effect this relies on treating each workbook as a table in a database. You must have column headings in each workbook, which are treated as field names. Try <a href=\"https://excel-macro.tutorialhorizon.com/vba-excel-read-excel-workbook-as-database-using-odbc-source/\" rel=\"nofollow noreferrer\">this</a> for details </p>\n\n<p>OK So it doesn't seem possible - so one possible workaround is to open the smaller table and then step through it and use the individual values to retrieve the desired records from the larger table: Here's an example using two workbooks called Testfile1 and testfile2. Each contains a sheet called \"test\" and some data with column headings in testfile2 called \"TestC\" and \"TestD\" and the first (linking) filed in testfile1 called \"TestA\". (This requires a reference to Microsoft Active X Data Objects\" library in VBE, Tools, References)</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub TwoFiles()\nDim conn1 As New ADODB.Connection\nDim conn2 As New ADODB.Connection\nWith conn1\n    .ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=P:\\testfile1.xlsm;\" &amp; \"Extended Properties='Excel 12.0 Macro;HDR=YES';\"\n    .Open\nEnd With\nWith conn2\n.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=P:\\testfile2.xlsm;\" &amp; \"Extended Properties='Excel 12.0 Macro;HDR=YES';\"\n.Open\nEnd With\nDim rsSmall As New Recordset\nrsSmall.Open \"select [testA] from [test$]\", conn1\nDim r As Range\nDim rsBig As New Recordset\nDo\nSet r = Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1, 0) 'first unoccupied cell\n\nrsBig.Open \"select [TestC],[TestD],\" &amp; rsSmall(\"testA\") &amp; \" As GetRollPH from [test$] where [testC] = \" &amp; rsSmall(\"testA\"), conn2\nr.CopyFromRecordset rsBig\nrsBig.Close\nrsSmall.MoveNext\nLoop Until rsSmall.EOF  'end if file\nrsSmall.Close\nconn1.Close\nconn2.Close\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 10327178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d795576bc6af57a1b001634ff9750aff?s=128&d=identicon&r=PG&f=1", "display_name": "Piccinin", "link": "https://stackoverflow.com/users/10327178/piccinin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1586462417, "creation_date": 1540407832, "last_edit_date": 1586462417, "question_id": 52976240, "link": "https://stackoverflow.com/questions/52976240/how-to-merge-two-workbooks-with-one-common-column-using-sql-in-vba", "title": "How to merge two workbooks with one common column using SQL in VBA", "body": "<p>I believe i can do this through Macro as well but i would like to get introduced to ADODB and SQL queries in VBA. The datasets are not in Access but separate workbooks and the SQL query for the two workbooks are as follows:</p>\n\n<pre><code>SELECT getRollpHierRpt.Field1, ['App].[Master Book Name], ['App].[App Book Name], ['App].[Secondary App Book Name], ['App].[App Code], ['App].[App Book Status], ['App].[Book Transit], ['App].[Transit Desc], ['App].[Legal Entity Id], ['App].[Legal Entity Desc]\nFROM ['App] INNER JOIN getRollpHierRpt ON ['App].[Book Transit] = getRollpHierRpt.Field1;\n</code></pre>\n\n<p>The examples i have seen on internet include getting a connection to Access/SQL server but if the datasets are two excel workbooks?</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub MergeIt()\nDim conn1 As New ADODB.Connection\nDim conn2 As New ADODB.Connection\n With conn1\n.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data \nSource=C:\\Users\\amzubaid\\Desktop\\Practice Merging\\13-10-2017.xlsm;\" &amp; \n\"Extended Properties=\"\"Excel 12.0 Macro;HDR=YES';IMEX=1\"\"\"\n.Open\n  End With\nWith conn2\n.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data \nSource=C:\\Users\\amzubaid\\Desktop\\Practice Merging\\20181015-Practice.xlsm;\" &amp; \"Extended Properties=\"\"Excel 12.0 Macro;HDR=YES';IMEX=1\"\"\"\n  .Open\n End With\nDim rsSmall As New Recordset\nrsSmall.Open \"select [Field1] from [getRollpHierRpt$]\", conn1\n Dim r As Range\nDim rsBig As New Recordset\nDo\nSet r = Range(\"a\" &amp; Rows.Count).End(xlUp).Offset(1, 0) 'first unoccupied cell\n\nrsBig.Open \"select [App Code],[Legal Entity Desc],\" &amp; rsSmall(\"Field1\") &amp; \" \n As GetRollPH from [getRollpHierRpt$] where [BookTransit] = \" &amp; \n rsSmall(\"Field1\"), conn2\n r.CopyFromRecordset rsBig\nrsBig.Close\nrsSmall.MoveNext\nLoop Until rsSmall.EOF  'end if file\nrsSmall.Close\nconn1.Close\nconn2.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1540410427, "post_id": 52976238, "comment_id": 92860237, "body": "So is what you&#39;ve tried working? What errors are you getting?"}, {"owner": {"reputation": 23944, "user_id": 1305969, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wlo8z.png?s=128&g=1", "display_name": "zx485", "link": "https://stackoverflow.com/users/1305969/zx485"}, "edited": false, "score": 0, "creation_date": 1540588358, "post_id": 52976238, "comment_id": 92936302, "body": "Please edit your question with the error(s) you get."}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1540860949, "post_id": 52976238, "comment_id": 93011112, "body": "Are you adding picture to the Slide or a UserForm (tag:=powerpoint-vba)?"}], "answers": [{"tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1540862198, "creation_date": 1540862198, "answer_id": 53056052, "question_id": 52976238, "link": "https://stackoverflow.com/questions/52976238/loop-of-array-image-control-in-vba-powerpoint/53056052#53056052", "title": "Loop of array image Control in VBA Powerpoint", "body": "<p>Assuming you are loading 10 pictures into a UserForm Images named \"<code>Image#</code>\", below should work fine.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub UserForm_Initialize()\n    Dim i As Long\n    For i = 1 To 10\n        With Me.Controls(\"Image\" &amp; i)\n            Set .Picture = LoadPicture(sPath &amp; \"\\kkk\\\" &amp; i &amp; \".jpg\")\n        End With\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9476649, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3p94Pv8edOw/AAAAAAAAAAI/AAAAAAAAAjs/aOrfxm1EsI4/photo.jpg?sz=128", "display_name": "daffar kq 36999", "link": "https://stackoverflow.com/users/9476649/daffar-kq-36999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540862198, "creation_date": 1540407819, "last_edit_date": 1540588358, "question_id": 52976238, "link": "https://stackoverflow.com/questions/52976238/loop-of-array-image-control-in-vba-powerpoint", "title": "Loop of array image Control in VBA Powerpoint", "body": "<p>In PowerPoint VBA,<br>\nI try to put 10 images named</p>\n\n<pre><code>image1\nimage2\nimage3\netc.\n</code></pre>\n\n<p>in an array of image controls.<br>\nSo I want to do something like this:</p>\n\n<pre><code>for i=1 to 10\n    Set Image(i).Picture = LoadPicture(sPath &amp; \"\\kkk\\\" &amp; i &amp; \".jpg\")\nnext i\n</code></pre>\n\n<p>But it doesn't work so far.</p>\n"}, {"tags": ["c++", "excel", "vba", "xll"], "owner": {"reputation": 31, "user_id": 7313049, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-bqHYUcOLORI/AAAAAAAAAAI/AAAAAAAAAAw/Xo4aUPXF05c/photo.jpg?sz=128", "display_name": "pawan kataria", "link": "https://stackoverflow.com/users/7313049/pawan-kataria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1586462453, "creation_date": 1540407365, "last_edit_date": 1586462453, "question_id": 52976145, "link": "https://stackoverflow.com/questions/52976145/xlcall-lib-for-visual-studio-2013", "title": "XLCALL.LIB for Visual Studio 2013", "body": "<p>We recently migrated to Visual Studio 2013 from VS2010. One of the project generates .xll using XLCALL32.lib and XLCALL dll. Now after migration to Visual Studio 2013, I am getting an error</p>\n\n<pre><code>lnk2026 module unsafe for safeseh image\n</code></pre>\n\n<p>There are some solutions available of disbaling SAFESEH from here:\n<a href=\"https://stackoverflow.com/questions/10599940/module-unsafe-for-safeseh-image-c\">module unsafe for SAFESEH image C++</a></p>\n\n<p>But following this solution, Excel throws exception and crashes, while same code works fine when build on Visual Studio 2010.</p>\n\n<p>I am wondering if XLCALL32.LIB is separately available for VC120 build tools.</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": false, "score": 1, "last_activity_date": 1540456508, "creation_date": 1540456508, "answer_id": 52984842, "question_id": 52975662, "link": "https://stackoverflow.com/questions/52975662/why-is-the-invalid-procedure-or-call-error-occurring-on-the-change-pivot-table-r/52984842#52984842", "title": "Why is the invalid procedure or call error occurring on the change pivot table range line?", "body": "<p>I was able to successfully change an exisiting pivot table using the following code. You may need to adapt to your situation. Original code from <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/8f96cf6b-86d6-4f8d-9a06-3932a0942d44/change-data-source-using-vba?forum=exceldev\" rel=\"nofollow noreferrer\">MSDN Forum</a></p>\n\n<pre><code>Sub ChangePTCache()\nDim PTRange As Range\nDim con_end As String\ncon_end = Range(\"'Sheet1'!A1\").End(xlDown).Offset(0, 1).Address\nSet PTRange = Range(\"'Sheet1'!A1:\" &amp; con_end)\nSheets(1).PivotTables(1).ChangePivotCache ActiveWorkbook.PivotCaches. _\n    Create(xlDatabase, PTRange)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 213, "user_id": 6205487, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/fb16c5a86176fbdc2b08d92e6277647a?s=128&d=identicon&r=PG&f=1", "display_name": "t.mo", "link": "https://stackoverflow.com/users/6205487/t-mo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1586462489, "creation_date": 1540405317, "last_edit_date": 1586462489, "question_id": 52975662, "link": "https://stackoverflow.com/questions/52975662/why-is-the-invalid-procedure-or-call-error-occurring-on-the-change-pivot-table-r", "title": "Why is the invalid procedure or call error occurring on the change pivot table range line?", "body": "<p>Is the issue with the changepivottablecache line?</p>\n\n<p>I have tried to this workbook, but I am able to execute the line to refresh the table.</p>\n\n<p>I have looked at several fixes online but none work as expected.</p>\n\n<pre><code>Dim Data_Sheet As Worksheet\nDim Pivot_Sheet As Worksheet\nDim StartPoint As Range\nDim DataRange As Range\nDim PivotName As String\nDim NewRange As String\nDim LastCol As Long\nDim lastRow As Long\n\n'Set Pivot Table &amp; Source Worksheet\nSet Data_Sheet = ThisWorkbook.Worksheets(\"Data\")\nSet Pivot_Sheet = ThisWorkbook.Worksheets(\"SheetTable\")\n\n'Enter in Pivot Table Name\nPivotName = \"PivotTable2\"\n'Defining Staring Point &amp; Dynamic Range\nData_Sheet.Activate\nSet StartPoint = Data_Sheet.Range(\"A1\")\nLastCol = StartPoint.End(xlToRight).Column\nDownCell = StartPoint.End(xlDown).Row\nSet DataRange = Data_Sheet.Range(StartPoint, Cells(DownCell, LastCol))\nNewRange = Data_Sheet.Name &amp; \"!\" &amp; DataRange.Address(ReferenceStyle:=xlR1C1)\n\n'Change Pivot Table Data Source Range Address\nPivot_Sheet.PivotTables(PivotName). _\nChangePivotCache ActiveWorkbook. _\nPivotCaches.Create(SourceType:=xlDatabase, SourceData:=NewRange)\n\n'Ensure Pivot Table is Refreshed\nPivot_Sheet.PivotTables(PivotName).RefreshTable\n\n'Complete Message\nPivot_Sheet.Activate\nMsgBox \"Your Pivot Table is now updated.\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "connection"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540405309, "post_id": 52975464, "comment_id": 92857829, "body": "Why not create the connection/string when you know where you&#39;re going to be connecting? Also, looks like you&#39;re missing two parameters."}, {"owner": {"reputation": 431, "user_id": 5969893, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c6c5d6a1321f7055e2fff7a3f6736d9b?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostThere", "link": "https://stackoverflow.com/users/5969893/almostthere"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540405695, "post_id": 52975464, "comment_id": 92858004, "body": "sigh..right.  I actually have the connection built but for specifics of the report, I have to remove the connection.  when I remove the connection I want to also create a new blank connection that will be turned into the original connection with an updated connection string and command text."}], "answers": [{"tags": [], "owner": {"reputation": 431, "user_id": 5969893, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c6c5d6a1321f7055e2fff7a3f6736d9b?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostThere", "link": "https://stackoverflow.com/users/5969893/almostthere"}, "is_accepted": false, "score": 0, "last_activity_date": 1540406727, "creation_date": 1540406727, "answer_id": 52975984, "question_id": 52975464, "link": "https://stackoverflow.com/questions/52975464/vba-to-build-blank-connection-in-excel/52975984#52975984", "title": "VBA to build blank Connection in Excel", "body": "<p>So this isn't really an answer but rather a work around.</p>\n\n<pre><code>    Sub Add_Connection()\n\n        Workbooks(\"WorkBook1.xlsm\").Connections.AddFromFile _\n            \"C:\\Document\\template_Connection.odc\"\n\n    With ActiveWorkbook.Connections(\"template\")\n    .Name = \"Facility\"\n    .Description = \"\"\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>I have a saved connection on my computer that I add and rename.</p>\n"}], "owner": {"reputation": 431, "user_id": 5969893, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/c6c5d6a1321f7055e2fff7a3f6736d9b?s=128&d=identicon&r=PG&f=1", "display_name": "AlmostThere", "link": "https://stackoverflow.com/users/5969893/almostthere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1540406727, "creation_date": 1540404509, "question_id": 52975464, "link": "https://stackoverflow.com/questions/52975464/vba-to-build-blank-connection-in-excel", "title": "VBA to build blank Connection in Excel", "body": "<p>I am trying to build a blank SQL connection in Excel that will be updated with a connection string and command text a later point in the report.</p>\n\n<p>Code I am trying to use:</p>\n\n<p><code>Workbooks(\"WorkBook1.xlsm\").Connections.Add2 \"Test1\", \"Test1\", \" \", \" \", \"SQL\"</code></p>\n\n<p>Syntax from Microsoft:</p>\n\n<pre><code>Add2 (string Name, string Description, object ConnectionString, object CommandText, object lCmdtype, object CreateModelConnection, object ImportRelationships);\n</code></pre>\n\n<p>However, I am struggling with the syntax as I keep getting errors.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["excel", "vba", "sample-rate", "aiff", "bit-depth"], "comments": [{"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "edited": false, "score": 0, "creation_date": 1540411227, "post_id": 52975271, "comment_id": 92860577, "body": "Wouldn&#39;t there be a bias for metadata? Things like the ID3/XMP chunk or the common chunk would throw off the calculation so it&#39;s no longer linear."}, {"owner": {"reputation": 3, "user_id": 9469304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956bb5c5f1555459aa54d1a2ef44c4a6?s=128&d=identicon&r=PG&f=1", "display_name": "SamBee", "link": "https://stackoverflow.com/users/9469304/sambee"}, "reply_to_user": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "edited": false, "score": 0, "creation_date": 1540481581, "post_id": 52975271, "comment_id": 92891230, "body": "Quite possibly, but I would imagine the difference would be a few bytes or a few kilobytes tops.  The difference between being 16-bit and 24-bit is about 600MB the problem is that it&#39;s only noticeable if you know what it is and what it should be (comparatively)... hence the predicament.   If I could know the actual file length is 10 seconds but the calculation gives 7 seconds, that shows that the  sample rate or bit depth is wrong. It&#39;s getting the actual length if it is wrong... Hope that makes sense!"}], "owner": {"reputation": 3, "user_id": 9469304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/956bb5c5f1555459aa54d1a2ef44c4a6?s=128&d=identicon&r=PG&f=1", "display_name": "SamBee", "link": "https://stackoverflow.com/users/9469304/sambee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540403791, "creation_date": 1540403791, "question_id": 52975271, "link": "https://stackoverflow.com/questions/52975271/working-out-sample-rate-and-bit-depth-of-aiff-audio-from-file-size", "title": "Working out sample rate and bit depth of aiff audio from file size", "body": "<p>I need some help with Maths/logic here.  Working with aif files.</p>\n\n<p>I have written the following: </p>\n\n<pre><code>        LnByte = FileLen(ToCheck)                                                   'Returns Filesize in Bytes\n        LnBit = LnByte * 8                                                          'Get filesize in Bits\n        Chan = 1                                                                    'Channels in audio: mono = 1\n        BDpth = 24                                                                  'Bit Detph\n        SRate = 48000                                                               'Sample Rate\n        BRate = 1152000                                                             'Expected Bit Rate\n\n              Time_Secs = LnBit / Chan / BDpth / SRate                              'Size in Bits / Channels / Bit Depth / Sample Rate\n              FSize = (BRate / 8) * Time_Secs                                    '(Bitrate / 8) * Length of file in seconds\n</code></pre>\n\n<p>ToCheck is the current file when looping through a folder of files. </p>\n\n<p>So I'm finding the length of audio based on the file size in bits / channels / bit depth / sample rate.  This assumes that the bit depth and sample rate are correct (I need the files to be 24-bit/48kHz). </p>\n\n<p>Time_Secs = Length of the file in seconds.</p>\n\n<p>FSize = File size based on 24/48kHz using the Time_Secs</p>\n\n<p>Probably because the FSize uses Time_Secs, I can't work out how to, from this, work out if the file sample rate and/or bit depth are indeed correct... </p>\n\n<p>Assuming 24/48k should give 144,000 Bytes per second</p>\n\n<p>Assuming 16/48k should give 96,000 Bytes per second</p>\n\n<p>If I check a file that is 16-bit/48 kHz using the above code it gives the incorrect time in secs (naturally) but the correct file size... even though the Bit Rate is 1,152,000 should be wrong. \n-- It would seem that the difference in time is making up for the difference in Bit Rate - or I'm looking at it wrong.</p>\n\n<p>How would I adapt my formula, or do the maths to work out if the sample rate/bit depth of a file is actually 48,000 Hz /24-bit?  Or is there a different way entirely? Remembering that they are aif files, not wavs. </p>\n\n<p>Hope that makes sense. </p>\n\n<p>Many Thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1540401602, "post_id": 52974491, "comment_id": 92855799, "body": "You already know the maximum elements (<code>.UsedRange.Rows.Count + 1</code>). Why not size the array for the maximum and then keep track of the indices that actually contain data. The repeated reallocations aren&#39;t really necessary."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 4, "creation_date": 1540401982, "post_id": 52974491, "comment_id": 92856001, "body": "Can you just use <code>Erase varArray</code> after you&#39;ve printed to the sheet?"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1540402074, "post_id": 52974491, "comment_id": 92856050, "body": "Those are the maximum elements for one workbook. I have a lot more in the directory, so I guess I don&#39;t understand what you&#39;re commenting on. I have an array built off workbook 1, I print it to master.xlsm, I need to clear the array, and then move onto workbook 2 so I can print to master.xlsx and so forth."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1540402152, "post_id": 52974491, "comment_id": 92856096, "body": "@nicklanta Try <code>Erase</code> to just empty/clear it :)"}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1540402194, "post_id": 52974491, "comment_id": 92856117, "body": "@dwirony that&#39;s what I would need to do, but where would I put that so it doesn&#39;t erase it before it prints to the master.xlsm wb?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1540402235, "post_id": 52974491, "comment_id": 92856137, "body": "@nicklanta Replace <code>ReDim varArray(1 To UBound(varArray, 1), 1 To 1)</code> with <code>Erase varArray</code> at the end."}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1540403242, "post_id": 52974491, "comment_id": 92856690, "body": "@dwirony ok, so it worked and erased my varArray, perfect. One problem popped up, but it&#39;s dealing with the files in the directory. It&#39;s just cycling back to the same file and creating the array all over again. Is there some sort of For/Next I should substitute in place of the the Do While/Loop part?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1540406517, "post_id": 52974491, "comment_id": 92858380, "body": "@nicklanta Try adding <code>MyFile = Dir</code> after the <code>Erase</code> line."}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1540475615, "post_id": 52974491, "comment_id": 92887292, "body": "@dwirony quick question, what if I wanted to just keep adding to my array? the above script does a great job of opening the first file and forming an array/printing to the master sheet, but what could I add after the final <code>end with</code> in order to have it preserve that data and then tack on the next file data until I&#39;ve looped through the whole folder?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "edited": false, "score": 0, "creation_date": 1540477345, "post_id": 52974491, "comment_id": 92888455, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/182511/discussion-between-dwirony-and-nick-lanta\">continue this discussion in chat</a>."}, {"owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1540479770, "post_id": 52974491, "comment_id": 92890055, "body": "@dwirony sent you the details"}], "owner": {"reputation": 586, "user_id": 10414376, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-z-gJqibrXTw/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVVyvZcDp0cTm8qKBYWy0xCoBcKig/mo/photo.jpg?sz=128", "display_name": "nick lanta", "link": "https://stackoverflow.com/users/10414376/nick-lanta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1586462525, "creation_date": 1540400792, "last_edit_date": 1586462525, "question_id": 52974491, "link": "https://stackoverflow.com/questions/52974491/how-can-i-redim-my-array-for-the-next-file-i-open-up", "title": "How can I redim my array for the next file I open up?", "body": "<p>I have an script built to go into a file in a <code>dir</code> and form an array based off of the data. </p>\n\n<p>How would I print this: </p>\n\n<pre><code>Dim k As Long, x As Long, j As Long ' counters\nDim varArray() As Variant\nReDim varArray(1 To 13, 1 To 1)\n\nReDim varArray(1 To UBound(varArray, 1), 1 To 1)\n\n        For j = 1 To .UsedRange.Rows.Count + 1\n            If .Cells(j, 1) &lt;&gt; \"\" Then\n                x = x + 1\n                ReDim Preserve varArray(1 To UBound(varArray, 1), 1 To x)\n                    For k = 1 To UBound(varArray, 1)\n                        varArray(k, x) = .Cells(j, k)\n                    Next\n            End If\n        Next\n</code></pre>\n\n<p>This builds the array, but I now need it printed to the sheet, so I wrote this:</p>\n\n<pre><code>    With Workbooks(\"master.xlsm\").Worksheets(\"Sheet2\")\n\n\n            For j = 2 To UBound(varArray, 2)\n                For k = 1 To UBound(varArray, 1)\n                    ActiveSheet.Cells(j, k) = varArray(k, j)\n                Next\n            Next\n\n    End With\n</code></pre>\n\n<p>This works, but now I need to clear out the array after it has printed with a Redim, but this:</p>\n\n<pre><code>ReDim varArray(1 To UBound(varArray, 1), 1 To 1)\n</code></pre>\n\n<p>doesn't clear it after I place it after the last <code>end with</code></p>\n\n<p>Here's the whole script for the sake of the bigger picture: </p>\n\n<pre><code>Option Explicit\n\nSub Stuff()\n\nDim k As Long, x As Long, j As Long ' counters\nDim varArray() As Variant\nReDim varArray(1 To 13, 1 To 1)\n\nDim MyFile As String\n\n\nMyFile = Dir(\"M:\\Merge Files\\\")\n\nIf Len(MyFile) &lt;&gt; 0 Then\n\n\n\n\n    With ThisWorkbook.Worksheets(1)\n\n        ReDim varArray(1 To UBound(varArray, 1), 1 To 1)\n\n            For j = 1 To .UsedRange.Rows.Count + 1\n                If .Cells(j, 1) &lt;&gt; \"\" Then\n                    x = x + 1\n                    ReDim Preserve varArray(1 To UBound(varArray, 1), 1 To x)\n                        For k = 1 To UBound(varArray, 1)\n                            varArray(k, x) = .Cells(j, k)\n                        Next\n                End If\n            Next\n    End With\n\n        With Workbooks(\"master.xlsm\").Worksheets(\"Sheet2\")\n\n\n                For j = 2 To UBound(varArray, 2)\n                    For k = 1 To UBound(varArray, 1)\n                        ActiveSheet.Cells(j, k) = varArray(k, j)\n                    Next\n                Next\n\n        End With\n\nReDim varArray(1 To UBound(varArray, 1), 1 To 1)\n\nEnd If\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "drop-down-menu", "excel-2013", "checkmark"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1540401892, "post_id": 52974489, "comment_id": 92855959, "body": "What error did you get, what is your code? Do you have <code>End Sub</code> at the end? What have you tried?"}, {"owner": {"reputation": 2630, "user_id": 5749062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72aMs.png?s=128&g=1", "display_name": "Bill Hileman", "link": "https://stackoverflow.com/users/5749062/bill-hileman"}, "edited": false, "score": 1, "creation_date": 1540403043, "post_id": 52974489, "comment_id": 92856594, "body": "Welcome to SO. I&#39;d recommend taking the <a href=\"https://stackoverflow.com/tour\">tour</a> and then reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> and <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> as an introduction to how SO works, and how to effectively ask questions."}], "answers": [{"tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": true, "score": 0, "last_activity_date": 1540578486, "last_edit_date": 1540578486, "creation_date": 1540412826, "answer_id": 52977451, "question_id": 52974489, "link": "https://stackoverflow.com/questions/52974489/vba-excel-2013-column-range-with-drop-down-list-to-create-vba-code-to-select-all/52977451#52977451", "title": "VBA Excel 2013 Column Range with Drop Down List to Create VBA Code to Select All &amp; Deselect All Check Marks", "body": "<p>The tricky part here is what kind of character you have used for crossmark/ticker. So I list two approaches, which the first one I have used earlier.<br>\nAs I want it to be standardized in both macro and dropdown list I choose a character set in the cells <code>B1</code> and <code>B2</code> as dummy variables.</p>\n\n<p><code>B1</code> = checkmarks (\u2713) = <code>1</code> and <code>B2</code> = crossmarks (\u2717) = <code>0</code>. The great benefit is that I can use the same characters in my drop down-list (see picture) and the VBA code. Notice that both my cells, <code>B1</code> and <code>B2</code> has drop-down lists. When my code copy these cells, the drop-down list will follow to the new cells.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Xo6tx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Xo6tx.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I run the code I first need to choose <code>1</code> or <code>0</code>. What you choose depends if the code will copy checkmarks (which is value <code>1</code>) or crossmarks (value <code>0</code>).</p>\n\n<p><a href=\"https://i.stack.imgur.com/21yNY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/21yNY.png\" alt=\"enter image description here\"></a></p>\n\n<p>Next window is where you define your range. You can either write it like: <code>E20:E50</code> or you can select it by selecting with your mouse.</p>\n\n<p><a href=\"https://i.stack.imgur.com/pqCbn.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pqCbn.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then the code processes and the result will be changed cells:</p>\n\n<p><a href=\"https://i.stack.imgur.com/lp2F7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lp2F7.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>VBA Code:</strong></p>\n\n<pre><code>Sub change_cells_ref()\nDim c As Range\nDim check_or_cross As Variant\nDim c_row_number As Long\nDim rangeinput As Variant\n\ncheck_or_cross = Application.InputBox(\"Enter \"\"1\"\" for checkmark or \"\"0\"\" for crossmark\") 'Input box for checkmarks (enter: 1) or crossmarks (enter: 0)\nOn Error Resume Next 'If error occurs, this is not a good way to mask errors... but if you press cancel in the inputbox when you are setting a range, VBA automatically throws an error: 13 before we can catch it, so we mask any errors that can occurs.\nSet rangeinput = Application.InputBox(prompt:=\"Select range or Enter range, i.e. E17:E150\", Type:=8) ' Input box for Range, Type:=8 tells us that the value has to be in range format. You could either select or write range.\n\nFor Each c In rangeinput 'Range(\"E17:E150\") - remove \"rangeinput\" to have a static range. This line defines your range where you are look for \"zxyx\", then loop through that range.\n    c_row_number = c.Row 'Gives us the current row for the loop variable c which we are looping.\n        If c &lt;&gt; \"zxyz\" Then 'Checks if the value is combination that is very unlikely to occur. It will overwrite all those values that are not \"zxyz\".\n        'If you replace the above code line with [If c = \"\" Then] the code would only overwrite cells that has not checkmark or crossmark...i,e only empty cells, could be good if you have some workers who answered, and some that hasn't. And only want to fill in those who didn't answer quickly.\n            With c 'Define what you want to do with the variable c\n                If check_or_cross = 1 Then 'If the user wrote 1, then copy checkmarks\n                    .Font.Name = \"Times New Roman\" 'Set font that you want to use, remember all fonts doesn't support special characters/crossmark/checkmarks\n                    .Font.Size = 12 'Set the Font size\n                    Cells(1, 2).Copy 'Copy from cell(1,2) where cells(row number, column number). This will copy row 1, column 2, which is cell B1\n                    Cells(c_row_number, 5).PasteSpecial xlPasteAll 'Paste into current row in loop and column 5 (column E)\n                ElseIf check_or_cross = 0 Then 'If the user wrote 0, then copy crossmarks\n                    .Font.Name = \"Times New Roman\" 'Set font that you want to use, remember all fonts doesn't support special characters/crossmark/checkmarks\n                    .Font.Size = 12 'Set the Font size\n                    Cells(2, 2).Copy 'Copy from cell(2,2) where cells(row number, column number). This will copy row 2, column 2, which is cell B2\n                    Cells(c_row_number, 5).PasteSpecial xlPasteAll 'Paste into current row in loop and column 5 (column E)\n                End If 'End the if statement (if check_or_cross is 1 or 0)\n            End With 'Close the With c part\n        End If 'End the if statement where we check which value c has.\nNext c 'Go to next c in the range\nOn Error GoTo 0\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If you always want a static range and skip the input box for the range part, you could remove these 3 lines: </p>\n\n<pre><code>On Error Resume Next\nSet rangeinput = Application.InputBox(prompt:=\"Select range or Enter range, i.e. E17:E150\", Type:=8) \n'...code....\nOn Error GoTo 0\n</code></pre>\n\n<p>And then replace this part \n<code>For Each c In rangeinput</code> -> <code>For Each c In Range(\"E17:E517\")</code> - where <code>E17:E517</code> is your range that you want to change the check/crossmarks</p>\n\n<hr>\n\n<hr>\n\n<p><strong>Alternative approach:</strong> </p>\n\n<p>This code uses the font size \"Wingding\". </p>\n\n<p>The <em>disadvantage</em> here is that you are not able to use this style in a \"good\" way in drop-down list. You will have values \"\u00fc\" = \u2713 and for \u00fb = \u2717. That means in the drop-down list you will have u's, but in macro it will show correct values when the result is presented. </p>\n\n<p><em>Advantage</em> is that you don't need any dummy cells, as code will not copy any cells. It writes the values directly from the code. If you have case where you only want to use macro and no drop-down list, this could be a perfect approach.</p>\n\n<p><a href=\"https://i.stack.imgur.com/UPYjL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/UPYjL.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Sub change_cells()\nDim c As Range\nDim check As Long\n\ncheck = 0 'Define 0 for crossmark or 1 for checkmark\n\nFor Each c In Range(\"E17:E150\") 'Define your range which should look value not equal to 1, then loop through that range.\n    If c &lt;&gt; 1 Then 'check if value in range is not equal to 1\n    With c 'Define what you want to do with variable c\n        If check = 1 Then 'If cehck = 1, then\n            .Font.Name = \"Wingdings\" 'Apply font \"Wingdings\"\n            .Font.Size = 12 'Font size\n            .FormulaR1C1 = \"\u00fc\" 'special character for checkmark\n        ElseIf check = 0 Then 'If cehck = 1, then\n            .Font.Name = \"Wingdings\" 'Apply font \"Wingdings\"\n            .Font.Size = 12 'Font size\n            .FormulaR1C1 = \" \u00fb \" 'special character for crossmark\n        End If\n    End With\nEnd If\nNext c\nEnd Sub\n</code></pre>\n\n<hr>\n\n<hr>\n\n<hr>\n\n<p><strong>Another light approach is shown in the result below:</strong> </p>\n\n<p><a href=\"https://i.stack.imgur.com/DB20B.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DB20B.png\" alt=\"enter image description here\"></a></p>\n\n<p>The code will look if the cell in column B is <em>not</em> empty. If cell is not empty (formulas that returns: <code>\"\"</code> are treated as empty) it will copy the value from dummy cell <code>A1</code> and paste in the column E in the same row.</p>\n\n<p><em>Notice to setup a dummy cell with data-validation and the checkmark \u2713. The reason is that the character 2713 is a special character and in VBA it would have result in \"?\" character. Therefore we copy it in the excel environment where it can be treated correctly including the drop-down list</em></p>\n\n<p>Variables to in the code set:</p>\n\n<ul>\n<li><p>Worksheet name, pre-defined as: <code>\"Sheet1\"</code></p></li>\n<li><p>Range where to look for data: <code>\"B1:B519\"</code></p></li>\n<li><p><code>ws.Cells(1, \"A\").Copy</code> - cell where dummy variable is located (\"A1\").</p></li>\n<li><p><code>ws.Cells(c_row_number, \"E\").PasteSpecial xlPasteAll</code> - Set column where checkmark should be pasted to.</p></li>\n</ul>\n\n<p><strong>VBA Code:</strong></p>\n\n<pre><code>Sub change_cells_ref2()\nDim ws As Worksheet\nDim c As Range\nDim c_row_number As Long\nDim rangeinput As Variant\n\nSet ws = Worksheets(\"Sheet1\") 'Define the worksheet the code should be applied to\nApplication.ScreenUpdating = False 'Turn off screen update, makes the calculations more smooth and faster.\n\nSet rangeinput = Range(\"B1:B519\") 'Set Range where you want to check if the variable c is empty. If you have headers, set \"B2:B519\"\n\nFor Each c In rangeinput 'This line defines your range where you are looking for \"\", then loop through that range.\n    c_row_number = c.Row 'Gives us the current row number for the loop variable c which we are looping.\n        If c &lt;&gt; \"\" Then 'Checks if the value in variable c is empty\n            ws.Cells(1, \"A\").Copy 'Copy from cell(1,1) where cells(row number, column number). This will copy row 1, column 1, which is cell A1\n            ws.Cells(c_row_number, \"E\").PasteSpecial xlPasteAll 'Paste into current row in loop and column 5 (column E)\n        End If 'End the if statement where we check which value variable c has.\nNext c 'Go to next c in the range\n\nApplication.CutCopyMode = False 'Cancel any copy selection\nApplication.ScreenUpdating = True 'Turn off screen update\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10553418, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tG42wwW_Rdo/AAAAAAAAAAI/AAAAAAAAAe0/jm70-zKouzQ/photo.jpg?sz=128", "display_name": "Monica", "link": "https://stackoverflow.com/users/10553418/monica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 1, "accepted_answer_id": 52977451, "answer_count": 1, "score": 0, "last_activity_date": 1541025278, "creation_date": 1540400779, "last_edit_date": 1541025278, "question_id": 52974489, "link": "https://stackoverflow.com/questions/52974489/vba-excel-2013-column-range-with-drop-down-list-to-create-vba-code-to-select-all", "title": "VBA Excel 2013 Column Range with Drop Down List to Create VBA Code to Select All &amp; Deselect All Check Marks", "body": "<p>I'm newer to vba and need assistance.  Currently, I have a drop-down list in a specific column (E1:E519) where staff can choose a check mark or leave it blank.  However, if someone has 400 people or so to check boxes for, this can be annoying.  So this prompted me to create a command button on the side using vba to select and deselect all in that specific column range.</p>\n\n<p>How do I create a vba code that only allows checks to fill in the blanks in a selected range in cells that have a drop down list option (there is only 1 option in the drop down list, which is a check mark).  The drop down list must remain for users who prefer to check each box individually and not use a command button. Column E either gets a check or is left blank.  It'd be much easier if it recognized that if column B has data, then a check mark should be added to column E in the same row.  If there is a code for that I would sure appreciate all the help I can get.  The exact check mark I use is Arial Unicode MS font with a subset Dingbat character code 2713.</p>\n\n<p>Can someone please help me and show me how to do it properly?  I would also appreciate a bit of an explanation so that I can understand the code language and further learn.  Thank you!</p>\n\n<p>Current Code I'm Using (shows \"?\" instead of a check that is located in cell E14 (row 14, column 5) which is a check mark):</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim c As Range\nDim check As Long\n\ncheck = 0 'Define 0 for crossmark or 1 for checkmark\n\nFor Each c In Range(\"E17:E519\") 'Define your range which should look value not equal to 1, then loop through that range.\nIf c &lt;&gt; 1 Then 'check if value in range is not equal to 1\nWith c 'Define what you want to do with variable c\n    If check = 1 Then 'If check = 1, then\n        .Font.Name = \"Arial Unicode MS\" 'Apply font \"Arial Unicode MS\"\n        .Font.Size = 12 'Font size\n        .FormulaR1C1 = \"\u00fc\" 'special character for checkmark\n    ElseIf check = 0 Then 'If cehck = 1, then\n        .Font.Name = \"Arial Unicode MS\" 'Apply font \"Arial Unicode MS\"\n        .Font.Size = 12 'Font size\n        .Borders(xlEdgeTop).LineStyle = xlContinuous\n        .Borders(xlEdgeBottom).LineStyle = xlContinuous\n        .Borders(xlEdgeLeft).LineStyle = xlContinuous\n        .Borders(xlEdgeRight).LineStyle = xlContinuous\n        .FormulaR1C1 = \"?\"\nEnd If\nEnd With\nEnd If\nNext c\nEnd Sub\n</code></pre>\n\n<p>Next code</p>\n\n<pre><code>Sub change_cells_ref2()\n        Dim ws As Worksheet\n        Dim c As Range\n        Dim c_row_number As Long\n        Dim rangeinput As Variant\n\n    Set ws = Worksheets(\"NFLES ILT Form\") 'Define the worksheet the code should be applied to\nApplication.ScreenUpdating = False 'Turn off screen update, makes the calculations more smooth and faster.\n\nSet rangeinput = Range(\"E17:E519\") 'Set Range where you want to check if the variable c is empty. If you have headers, set \"B2:B519\"\n\nFor Each c In rangeinput 'This line defines your range where you are looking for \"\", then loop through that range.\nc_row_number = c.Row 'Gives us the current row number for the loop variable c which we are looping.\n    If c &lt;&gt; \"\" Then 'Checks if the value in variable c is empty\n        ws.Cells(14, \"E\").Copy 'Copy from cell(14,5) where cells(row number, column number). This will copy row 14, column 5, which is cell E14\n        ws.Cells(c_row_number, \"E\").PasteSpecial xlPasteAll 'Paste into current row in loop and column 5 (column E)\n    End If 'End the if statement where we check which value variable c has.\nNext c 'Go to next c in the range\n\nApplication.CutCopyMode = False 'Cancel any copy selection\nApplication.ScreenUpdating = True 'Turn off screen update\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["java", "vba", "shell", "windows-7", "32bit-64bit"], "answers": [{"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 1, "last_activity_date": 1540400920, "creation_date": 1540400920, "answer_id": 52974523, "question_id": 52974331, "link": "https://stackoverflow.com/questions/52974331/running-java-from-vba-macro-in-windows-7-bypassing-system32-syswow64-javaw-exe/52974523#52974523", "title": "Running java from VBA macro in Windows 7 bypassing System32 / SysWOW64 javaw.exe", "body": "<p>Normally there is a JAVA_HOME environment variable set. If so, then you can do something like this:</p>\n\n<pre><code>Dim JavaExe As String\nJavaExe = \"\"\"\" &amp; Environ(\"JAVA_HOME\") &amp; \"\\bin\\java.exe\"\"\"\nhandleDbl = Shell(\"cmd /k \" &amp; JavaExe &amp; \" -cp theJar.jar com.java.SampleClass\", vbNormalFocus)\n</code></pre>\n\n<p>If it isn't set, you'll have to find it by some searching, before compiling the command.</p>\n"}, {"tags": [], "owner": {"reputation": 134, "user_id": 2419789, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jQVke.jpg?s=128&g=1", "display_name": "CamelCamelius", "link": "https://stackoverflow.com/users/2419789/camelcamelius"}, "is_accepted": false, "score": 0, "last_activity_date": 1541615336, "last_edit_date": 1541615336, "creation_date": 1541614963, "answer_id": 53195523, "question_id": 52974331, "link": "https://stackoverflow.com/questions/52974331/running-java-from-vba-macro-in-windows-7-bypassing-system32-syswow64-javaw-exe/53195523#53195523", "title": "Running java from VBA macro in Windows 7 bypassing System32 / SysWOW64 javaw.exe", "body": "<p><a href=\"https://stackoverflow.com/users/3246362/sam\">Sam</a>'s answer is great but I just felt uneasy about user going through more settings so I wrote some functions to check java's versions and notify the user if it is not there (would have to install java in that case anyway) so here is my code. It might contain some helpful stuff.</p>\n\n<pre class=\"lang-vbs prettyprint-override\"><code>Private Function IsJavaAvailable(ByVal displayMessage As Boolean, Optional ByVal isJavaMandatory As Boolean) As Boolean\n    Dim availability As Boolean\n    Dim minJavaVersion As Integer\n    minJavaVersion = 8\n\n    'isJavaSetup is a global variable\n    If (Not isJavaSetup) Then\n        javawPathQuoted = GetMinimumJavaVersion(minJavaVersion)\n        If StrComp(javawPathQuoted, \"\") &lt;&gt; 0 Then\n            isJavaSetup = True\n        End If\n        SetGlobalVars\n    End If\n\n    If javawPathQuoted = Empty Then\n        availability = False\n    Else\n        availability = True\n    End If\n\n    If (displayMessage) Then\n        If (isJavaMandatory) Then\n            If Not availability Then\n                MsgBox \"This functionality is NOT available without Java \" &amp; minJavaVersion &amp; \".\" &amp; _\n                vbNewLine &amp; vbNewLine &amp; _\n                \"Please install Java \" &amp; minJavaVersion &amp; \" or higher.\", vbCritical, _\n                \"Mimimum Version Required: Java \" &amp; minJavaVersion\n            End If\n        Else\n            If Not availability Then\n                MsgBox \"Some features of this functionality were disabled.\" &amp; _\n                vbNewLine &amp; vbNewLine &amp; _\n                \"Please install Java \" &amp; minJavaVersion &amp; \" or higher.\", vbExclamation, _\n                \"Mimimum Version Required: Java \" &amp; minJavaVersion\n            End If\n\n        End If\n    End If\n\n    IsJavaAvailable = availability\n\nEnd Function\n\nPrivate Function GetMinimumJavaVersion(ByVal javaMinimumMajorVersionInt As Integer) As String\n\n    'Run a shell command, returning the output as a string\n    Dim commandStr As String\n    Dim javawPathVar As Variant\n    Dim javaPathStr As Variant\n    Dim javaVersionStr As String\n    Dim javaMajorVersionInt As Integer\n\n    Dim detectedJavaPaths As Collection\n    Dim javaVersionElements As Collection\n    Dim javaVersionOutput As Collection\n    Dim detectedJavaVersions As Collection\n\n    Dim suitableJavawPath As String\n\n    'Check available javaw executables in the SO\n    commandStr = \"where javaw\"\n    Set detectedJavaPaths = GetCommandOutput(commandStr)\n    Set detectedJavaVersions = New Collection\n\n    For Each javawPathVar In detectedJavaPaths\n\n        'Look for java.exe instead of javaw.exe by substituting it in path\n        '  javaw.exe does NOT return version output like java.exe\n        javaPathStr = StrReverse(Replace(StrReverse(javawPathVar), StrReverse(\"javaw.exe\"), StrReverse(\"java.exe\"), , 1))\n        commandStr = \"\"\"\" &amp; javaPathStr &amp; \"\"\"\" &amp; \" -version\"\n        Set javaVersionOutput = GetCommandOutput(commandStr)\n        javaVersionStr = javaVersionOutput.item(1)\n\n        Debug.Print \"Getting java version: \", commandStr\n        Debug.Print \"Version detected: \"; javaVersionStr\n\n        Set javaVersionElements = SplitOnDelimiter(javaVersionStr, \" \")\n\n        'Check that output is not an error or something else\n        'java version \"1.8.0_75\"\n        If javaVersionElements.Count &gt; 2 Then\n            If StrComp(javaVersionElements.item(1), \"java\", vbTextCompare) = 0 Then\n                If StrComp(javaVersionElements.item(2), \"version\", vbTextCompare) = 0 Then\n                    detectedJavaVersions.Add javaVersionStr\n                    'Remove quotes from \"1.8.0_75\", split on '.', get 2nd item (java major version) and cast it to Integer\n                    javaMajorVersionInt = CInt(SplitOnDelimiter(SplitOnDelimiter(javaVersionElements.item(3), \"\"\"\").item(1), \".\").item(2))\n                    'JAR will only run in Java 8 or later\n                    If (javaMajorVersionInt &gt;= javaMinimumMajorVersionInt) Then\n                        'Validate that \"javaw.exe\" exists since the validation was made with \"java.exe\"\n                        Debug.Print \"Verifying if javaw.exe exists: \", javawPathVar\n                        If Len(Dir(javawPathVar)) &gt; 0 Then\n                            suitableJavawPath = javawPathVar\n                            Debug.Print \"A suitable javaw.exe version found: \", suitableJavawPath\n                            Exit For\n                        End If\n                    End If\n                End If\n            End If\n        End If\n    Next javawPathVar\n\n    GetMinimumJavaVersion = suitableJavawPath\n\nEnd Function\n\nPrivate Function GetCommandOutput(ByRef commandStr As String) As Collection\n\n    'Run a shell command, returning the output as a string\n    Dim shellObj As Object\n    Set shellObj = CreateObject(\"WScript.Shell\")\n\n    'run command\n    Dim wshScriptExecObj As Object\n    Dim stdOutObj As Object\n    Dim stdErrObj As Object\n    Set wshScriptExecObj = shellObj.Exec(commandStr)\n    Set stdOutObj = wshScriptExecObj.StdOut\n    Set stdErrObj = wshScriptExecObj.StdErr\n\n    'handle the results as they are written to and read from the StdOut object\n    Dim fullOutputCollection As Collection\n    Set fullOutputCollection = New Collection\n\n    Dim lineStr As String\n    While Not stdOutObj.AtEndOfStream\n        lineStr = stdOutObj.ReadLine\n        If lineStr &lt;&gt; \"\" Then\n            fullOutputCollection.Add lineStr\n        End If\n    Wend\n\n    If fullOutputCollection.Count = 0 Then\n        While Not stdErrObj.AtEndOfStream\n            lineStr = stdErrObj.ReadLine\n            If lineStr &lt;&gt; \"\" Then\n                fullOutputCollection.Add lineStr\n            End If\n        Wend\n    End If\n\n\n\n    Set GetCommandOutput = fullOutputCollection\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 134, "user_id": 2419789, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/jQVke.jpg?s=128&g=1", "display_name": "CamelCamelius", "link": "https://stackoverflow.com/users/2419789/camelcamelius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 52974523, "answer_count": 2, "score": 0, "last_activity_date": 1541615336, "creation_date": 1540400142, "question_id": 52974331, "link": "https://stackoverflow.com/questions/52974331/running-java-from-vba-macro-in-windows-7-bypassing-system32-syswow64-javaw-exe", "title": "Running java from VBA macro in Windows 7 bypassing System32 / SysWOW64 javaw.exe", "body": "<p>Is there a way to bypass the 32-bit java version (maybe a different way to start a proccess in VBA to invoke the 64-bit version cmd, turn off the UAC or some other sort of tweek) that is being \"forced\" by the following VBA code (this is just an assumption, I am explaining the debugging process below):</p>\n\n<pre><code>handleDbl = Shell(\"javaw -cp theJar.jar com.java.SampleClass\", vbNormalFocus)\n</code></pre>\n\n<p>The main point here is that I want to share my macro and avoid putting extra instructions on the recipient so I am trying to do everything on the code (I am using late binding on VBA code to avoid to setting References manually and that kind of stuff).</p>\n\n<h2>Debugging Process</h2>\n\n<p>An error was thrown so I used the following line instead:</p>\n\n<pre><code>handleDbl = Shell(\"cmd /k java -cp theJar.jar com.java.SampleClass\", vbNormalFocus)\n</code></pre>\n\n<p>And got the error <code>Exception in thread \"main\" java.lang.UnsupportedClassVersionError: Unsupported major.minor version</code> so I checked the <code>java -version</code> and tried to find out which java was running with:</p>\n\n<pre><code>C:\\&gt;where java\nC:\\Windows\\System32\\java.exe\nC:\\Program Files\\Java\\_anyJava.x.x.x_\\bin\\java.exe\n</code></pre>\n\n<p>I went to <code>System32</code> folder and there was no java there but I knew that <a href=\"https://docs.microsoft.com/en-us/windows/desktop/WinProg64/file-system-redirector\" rel=\"nofollow noreferrer\">redirection</a> happens from there to <code>C:\\Windows\\SysWOW64</code> so I compared the previously extracted java version against <code>C:\\Windows\\SysWOW64\\java.exe -version</code> and they matched.</p>\n\n<p>After that I checked my Outlook version and turned out to be a 32-bit installation. That was a hint but it was mostly that and that big <strong>*32</strong> next to the cmd.exe in the Task Manager. I don't know if a 64-bit Outlook would make a difference or it would be the same because of the VBA implementation but that's how I concluded the Shell function from VBA is causing 32-bit java call. </p>\n"}, {"tags": ["excel", "vba", "if-statement"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1540399342, "post_id": 52974101, "comment_id": 92854622, "body": "What triggers a change in the cell&#39;s value?"}], "answers": [{"comments": [{"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 0, "creation_date": 1540400418, "post_id": 52974229, "comment_id": 92855218, "body": "Are you missing <code>.Value</code> on the end of the ranges?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "edited": false, "score": 2, "creation_date": 1540400447, "post_id": 52974229, "comment_id": 92855233, "body": "@Brotato <code>.Value</code> is the default and as such not necessary."}, {"owner": {"reputation": 175, "user_id": 8935349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-4iOAaJzmDJA/AAAAAAAAAAI/AAAAAAAAApM/ZYP8Z_g9o80/photo.jpg?sz=128", "display_name": "Lux Claridge", "link": "https://stackoverflow.com/users/8935349/lux-claridge"}, "edited": false, "score": 0, "creation_date": 1540401125, "post_id": 52974229, "comment_id": 92855571, "body": "What triggers the Calculate event? I haven&#39;t used it before."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 1, "creation_date": 1540401268, "post_id": 52974229, "comment_id": 92855645, "body": "Anytime the worksheet does a calculation, this even will fire. It&#39;s more reliable then the <code>Change()</code> event because Change doesn&#39;t always fire - mainly when updated via code."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1540401631, "post_id": 52974229, "comment_id": 92855812, "body": "<code>Rem</code> comments now? ;-)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1540402450, "post_id": 52974229, "comment_id": 92856257, "body": "@ScottCraner except if it&#39;s parameterized, then <code>.Item</code> is the default... the default member is actually <code>Range.[_Default]</code>, a hidden property few VBA devs know about. I would argue that explicit code that <i>says what it does and does what it says</i> is better code - hence I would add the explicit <code>.Value</code> call (or <code>.Value2</code>?), <i>and</i> an explicit <code>Me.</code> qualifier in front of the <code>Range</code> calls."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540402803, "post_id": 52974229, "comment_id": 92856469, "body": "@MathieuGuindon Fair point and is my practice as well,  more to do with my OCD than any other reason. My point is that in this instance it would work with or without the <code>.Value</code>"}, {"owner": {"reputation": 23, "user_id": 10553294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003fc7081e9716630a342c7cc2fb0287?s=128&d=identicon&r=PG&f=1", "display_name": "Topli", "link": "https://stackoverflow.com/users/10553294/topli"}, "edited": false, "score": 0, "creation_date": 1541606314, "post_id": 52974229, "comment_id": 93275159, "body": "@K.D\u1d00\u1d20\u026as thank you for your answer! Would you mind telling me where is the code module? I have trouble identifying it within VBA. I tried putting it under ThisWorkbook but doesn&#39;t seem to work."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 23, "user_id": 10553294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003fc7081e9716630a342c7cc2fb0287?s=128&d=identicon&r=PG&f=1", "display_name": "Topli", "link": "https://stackoverflow.com/users/10553294/topli"}, "edited": false, "score": 0, "creation_date": 1541606560, "post_id": 52974229, "comment_id": 93275275, "body": "@Topli It would be <code>Sheet##</code> (Not <code>ThisWorkbook</code> - almost there) - it&#39;s a worksheet event - not a workbook event. If you still can&#39;t find it, get out of the VBE and on the sheet tab at the bottom of Excel, right-click and select <code>View Code</code> - that will take you straight there."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 4, "last_activity_date": 1540399696, "creation_date": 1540399696, "answer_id": 52974229, "question_id": 52974101, "link": "https://stackoverflow.com/questions/52974101/excel-if-cell-value-increases-play-sound/52974229#52974229", "title": "Excel: if cell value increases -&gt; play sound", "body": "<p>You can try using the <code>Calculate()</code> event, depending on how the update occurs this may work for you. This needs to be placed in the <strong>worksheet's</strong> code module - NOT a standard module.</p>\n\n<pre><code>Option Explicit\n\nPrivate priorVal As Currency\n\nPrivate Sub Worksheet_Calculate()\n\n    Rem Change this range to be the range that needs to be looked at\n    If Range(\"A1\") &lt;&gt; priorVal Then\n        Beep\n        priorVal = Range(\"A1\")\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10553294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/003fc7081e9716630a342c7cc2fb0287?s=128&d=identicon&r=PG&f=1", "display_name": "Topli", "link": "https://stackoverflow.com/users/10553294/topli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 52974229, "answer_count": 1, "score": 2, "last_activity_date": 1540400703, "creation_date": 1540399208, "last_edit_date": 1540399723, "question_id": 52974101, "link": "https://stackoverflow.com/questions/52974101/excel-if-cell-value-increases-play-sound", "title": "Excel: if cell value increases -&gt; play sound", "body": "<p>I have a cell in excel that increases randomly through the day. This is an API from my trading platform which counts the total number of trades a day.</p>\n\n<p>What I need to do is the following:</p>\n\n<p>Build an IF statement that each time this cell value increases it plays a sound.\nI have the sound part covered with a Macro I found online. But the IF statement is giving me trouble.</p>\n\n<p>Anyone could help me out?</p>\n"}, {"tags": ["excel", "vba", "datepicker"], "comments": [{"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "edited": false, "score": 0, "creation_date": 1540400796, "post_id": 52974026, "comment_id": 92855419, "body": "So you want to use a single calendar as input and drop down boxes as output, is that correct?"}, {"owner": {"reputation": 175, "user_id": 8935349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-4iOAaJzmDJA/AAAAAAAAAAI/AAAAAAAAApM/ZYP8Z_g9o80/photo.jpg?sz=128", "display_name": "Lux Claridge", "link": "https://stackoverflow.com/users/8935349/lux-claridge"}, "edited": false, "score": 2, "creation_date": 1540401006, "post_id": 52974026, "comment_id": 92855517, "body": "Have you thought of using a native Microsoft date picker control instead of combo boxes?"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540406942, "post_id": 52975828, "comment_id": 92858583, "body": "Or you could just use the <code>MonthView</code> control&#39;s <code>Tag</code> property."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540407218, "post_id": 52975828, "comment_id": 92858715, "body": "For example? @MathieuGuindon"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540408050, "post_id": 52975828, "comment_id": 92859106, "body": "<code>Me.MonthView1.Tag = Me.ComboBox1.Name</code>, then <code>s = Me.MonthView1.Tag</code>"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 0, "last_activity_date": 1540409168, "last_edit_date": 1540409168, "creation_date": 1540406050, "answer_id": 52975828, "question_id": 52974026, "link": "https://stackoverflow.com/questions/52974026/one-date-picker-for-all-combo-boxes-in-an-excel-userform/52975828#52975828", "title": "One date picker for all combo boxes in an Excel userform", "body": "<p>Think about this, I can think of one solution.\nAdd a Label.</p>\n\n<p>When clicking the combobox, the label will have the combobox name, then from there, when you click a date in the calendar control, it will send the date to the combobox name in the label.\n<a href=\"https://i.stack.imgur.com/Wu0HQ.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Wu0HQ.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I just grabbed whatever calendar control that was available in the toolbox, yours may be different.</p>\n\n<pre><code>Private Sub ComboBox1_DropButtonClick()\n    Me.Label1 = Me.ComboBox1.Name\nEnd Sub\nPrivate Sub ComboBox2_DropButtonClick()\n    Me.Label1 = Me.ComboBox2.Name\nEnd Sub\nPrivate Sub ComboBox3_DropButtonClick()\n    Me.Label1 = Me.ComboBox3.Name\nEnd Sub\n\nPrivate Sub MonthView1_DateClick(ByVal DateClicked As Date)\n    s = Me.Label1.Caption\n    Me.Controls(s) = Me.MonthView1.Value\nEnd Sub\n</code></pre>\n\n<p>As pointed out by @MathieuGuindon, when clicking the combobox you can assign the tag to the Calendar control, then you would not have to place the label approach.</p>\n\n<p>Thanks Mathieu...</p>\n\n<pre><code>Private Sub ComboBox1_DropButtonClick()\n    Me.MonthView1.Tag = Me.ComboBox1.Name\nEnd Sub\nPrivate Sub ComboBox2_DropButtonClick()\n    Me.MonthView1.Tag = Me.ComboBox2.Name\nEnd Sub\nPrivate Sub ComboBox3_DropButtonClick()\n    Me.MonthView1.Tag = Me.ComboBox3.Name\nEnd Sub\n\nPrivate Sub MonthView1_DateClick(ByVal DateClicked As Date)\n    s = Me.MonthView1.Tag\n    Me.Controls(s) = Me.MonthView1\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2183, "user_id": 1474921, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/629c3c899819f28cbf068691b1c7c618?s=128&d=identicon&r=PG", "display_name": "Jason Kelly", "link": "https://stackoverflow.com/users/1474921/jason-kelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1568, "favorite_count": 0, "accepted_answer_id": 52975828, "answer_count": 1, "score": -3, "last_activity_date": 1543622945, "creation_date": 1540398949, "last_edit_date": 1543622945, "question_id": 52974026, "link": "https://stackoverflow.com/questions/52974026/one-date-picker-for-all-combo-boxes-in-an-excel-userform", "title": "One date picker for all combo boxes in an Excel userform", "body": "<p>What I'd like to accomplish:</p>\n\n<ol>\n<li><p>Have separate comboboxes on a userform, such that when the individual drop down button is clicked, load a global userform with the calendar control on it. Since I will have multiple combo boxes, it wouldn't be feasible to keep adding new separate userforms with calendars controls on it. Instead, just to have one main userform with a calendar control that does all of the work for all my combo boxes.</p></li>\n<li><p>When a date is selected from the global date picker calendar control, to insert the selected date into the combo box that was clicked.</p></li>\n</ol>\n\n<p>I've found pieces but I can't make sense of them since I am new to this.</p>\n"}, {"tags": ["json", "excel", "vba"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 2, "creation_date": 1540398853, "post_id": 52973946, "comment_id": 92854345, "body": "I recommend this: <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">github.com/VBA-tools/VBA-JSON</a>"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1540399199, "post_id": 52973946, "comment_id": 92854535, "body": "Take a look at <a href=\"https://stackoverflow.com/a/46245469/4717755\">this answer</a> for help in understanding how the VBA-JSON link given by @Sam structures the parsed JSON result."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540400079, "post_id": 52973946, "comment_id": 92855042, "body": "I have answered this here: <a href=\"https://stackoverflow.com/a/52682267/6241235\">stackoverflow.com/a/52682267/6241235</a> Exactly the same info I think if using either JSON parser or split function. Not scriptControl."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540403409, "post_id": 52974188, "comment_id": 92856776, "body": "Note that VBA-JSON is now available through <a href=\"https://www.vba-blocks.com/\" rel=\"nofollow noreferrer\">VBA-Blocks</a>, which is essentially &quot;Nuget packages for VBA&quot;, which is BLOODY AWESOME and it cannot be understated how much of a huge revolution this can be."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1540399519, "creation_date": 1540399519, "answer_id": 52974188, "question_id": 52973946, "link": "https://stackoverflow.com/questions/52973946/nested-json-in-vba-cannot-access-the-values/52974188#52974188", "title": "Nested JSON in VBA. Cannot access the values", "body": "<pre><code>Debug.Print scriptControl.Eval(\"obj['Realtime Currency Exchange Rate']['5. Exchange Rate'];\")` \n</code></pre>\n\n<p>...but for your own sanity and security you should not use this approach to parse JSON - instead use the VBA-JSON library </p>\n"}], "owner": {"reputation": 1, "user_id": 10553125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d841bfbe1ece69b23859c0bf4ff469be?s=128&d=identicon&r=PG&f=1", "display_name": "commandos1985", "link": "https://stackoverflow.com/users/10553125/commandos1985"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "closed_date": 1540403982, "answer_count": 1, "score": 0, "last_activity_date": 1540399519, "creation_date": 1540398689, "last_edit_date": 1540399046, "question_id": 52973946, "link": "https://stackoverflow.com/questions/52973946/nested-json-in-vba-cannot-access-the-values", "closed_reason": "Duplicate", "title": "Nested JSON in VBA. Cannot access the values", "body": "<p>This is my JSON structure:</p>\n\n<pre><code>{\n    \"Realtime Currency Exchange Rate\": {\n        \"1. From_Currency Code\": \"AUD\",\n        \"2. From_Currency Name\": \"Australian Dollar\",\n        \"3. To_Currency Code\": \"USD\",\n        \"4. To_Currency Name\": \"United States Dollar\",\n        \"5. Exchange Rate\": \"0.70856660\",\n        \"6. Last Refreshed\": \"2018-10-23 17:37:03\",\n        \"7. Time Zone\": \"UTC\"\n    }\n}\n</code></pre>\n\n<p>The code I'm using:</p>\n\n<pre><code>Dim scriptControl As Object\n\nSet scriptControl = CreateObject(\"MSScriptControl.ScriptControl\")\nscriptControl.Language = \"JScript\"\n\nWith CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://www.alphavantage.co/query?function=CURRENCY_EXCHANGE_RATE&amp;from_currency=AUD&amp;to_currency=USD&amp;apikey=demo\", False\n        .send\n        scriptControl.Eval \"var obj=(\" &amp; .responseText &amp; \")\"\nEnd With\n</code></pre>\n\n<p>How can I access values in VBA? For example, if I want to access \"5. Exchange Rate\" value, what should I do? </p>\n\n<p>I tried many variations using [] and (), but nothing works for me.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 4, "last_activity_date": 1540398519, "creation_date": 1540398519, "answer_id": 52973894, "question_id": 52973711, "link": "https://stackoverflow.com/questions/52973711/excel-vba-how-do-i-refer-to-a-form-control-on-a-worksheet/52973894#52973894", "title": "Excel VBA: How do I refer to a Form Control, on a worksheet?", "body": "<p>You can do something like this:</p>\n\n<pre><code>Sub DropDown1_Change()\n\n    Dim s As Object\n    Set s = ActiveSheet.Shapes(Application.Caller)\n    Debug.Print s.ControlFormat.Value\n\nEnd Sub\n</code></pre>\n\n<p><code>Application.Caller</code> contains the name of the shape \"containing\" the form control</p>\n\n<p>Similarly you can access other controls by name:</p>\n\n<pre><code>Dim myName as String, c As Object\nmyName = \"List Box 2\"\nSet c = ActiveSheet.Shapes(myName).ControlFormat\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6956, "user_id": 196210, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ad90e357ee32d9d8de59f5afe8ad396f?s=128&d=identicon&r=PG", "display_name": "Revious", "link": "https://stackoverflow.com/users/196210/revious"}, "edited": false, "score": 0, "creation_date": 1540415651, "post_id": 52973908, "comment_id": 92862514, "body": "This is something similar to the code behind in Visual Studio?"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 3, "last_activity_date": 1540398550, "creation_date": 1540398550, "answer_id": 52973908, "question_id": 52973711, "link": "https://stackoverflow.com/questions/52973711/excel-vba-how-do-i-refer-to-a-form-control-on-a-worksheet/52973908#52973908", "title": "Excel VBA: How do I refer to a Form Control, on a worksheet?", "body": "<p>Instead of adding it like that I suggest creating a Shape variable, and use that to add data/properties.</p>\n\n<p>Something like <a href=\"https://stackoverflow.com/a/17677080/4650297\">this</a>:</p>\n\n<pre><code>Sub t()\nDim newDD As Shape\n\nSet newDD = ActiveSheet.Shapes.AddFormControl(xlDropDown, Left:=Cells(1, 1).Left, Top:=Cells(2, 1).Top, Width:=100, Height:=20)\n With newDD\n        .ControlFormat.DropDownLines = 2\n        .ControlFormat.AddItem \"Item 1\", 1\n        .ControlFormat.AddItem \"item 2\", 2\n        .Name = \"New Combo Box\"\n        .OnAction = \"myCombo_Change\"\n End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3854, "user_id": 10607772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e478f2600848a3dc5238b7ffb2e148f6?s=128&d=identicon&r=PG", "display_name": "double-beep", "link": "https://stackoverflow.com/users/10607772/double-beep"}, "edited": false, "score": 1, "creation_date": 1608918471, "post_id": 65449954, "comment_id": 115713153, "body": "While this code may solve the question, <a href=\"//meta.stackexchange.com/q/114762\">including an explanation</a> of how and why this solves the problem would really help to improve the quality of your post, and probably result in more up-votes. Remember that you are answering the question for readers in the future, not just the person asking now. Please <a href=\"https://stackoverflow.com/posts/65449954/edit\">edit</a> your answer to add explanations and give an indication of what limitations and assumptions apply. <a href=\"/review/low-quality-posts/27931341\">From Review</a>"}], "tags": [], "owner": {"reputation": 1489, "user_id": 2384066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb30bab70048867d7c55ede4f1cfbaf8?s=128&d=identicon&r=PG", "display_name": "LeslieM", "link": "https://stackoverflow.com/users/2384066/lesliem"}, "is_accepted": false, "score": 1, "last_activity_date": 1608914797, "creation_date": 1608914797, "answer_id": 65449954, "question_id": 52973711, "link": "https://stackoverflow.com/questions/52973711/excel-vba-how-do-i-refer-to-a-form-control-on-a-worksheet/65449954#65449954", "title": "Excel VBA: How do I refer to a Form Control, on a worksheet?", "body": "<p>Try</p>\n<pre><code>Dim checkBox1 As Object\nSet checkBox1 = Sheet1.OLEObjects(&quot;CheckBox1&quot;).Object\nMsgBox checkBox1.Value\n</code></pre>\n"}], "owner": {"reputation": 6956, "user_id": 196210, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/ad90e357ee32d9d8de59f5afe8ad396f?s=128&d=identicon&r=PG", "display_name": "Revious", "link": "https://stackoverflow.com/users/196210/revious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3781, "favorite_count": 1, "accepted_answer_id": 52973894, "answer_count": 3, "score": 2, "last_activity_date": 1608914797, "creation_date": 1540397824, "last_edit_date": 1586462560, "question_id": 52973711, "link": "https://stackoverflow.com/questions/52973711/excel-vba-how-do-i-refer-to-a-form-control-on-a-worksheet", "title": "Excel VBA: How do I refer to a Form Control, on a worksheet?", "body": "<p>I've added two Dropdown (aka ComboBox) to a Sheet\n<a href=\"https://i.stack.imgur.com/QTS1P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QTS1P.png\" alt=\"enter image description here\"></a></p>\n\n<p>Starting from this question (<a href=\"https://stackoverflow.com/questions/8919797/how-do-i-refer-to-a-controls-object-on-a-worksheet-using-a-variable-name\">How do I refer to a controls object, on a worksheet, using a variable name?</a>) I tried the following experiment without succeding.</p>\n\n<p><a href=\"https://i.stack.imgur.com/msRmc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/msRmc.png\" alt=\"enter image description here\"></a></p>\n\n<p>How do I access to the controls on an Excel Sheet? And where do I see the name / properties of the controls I have just inserted?</p>\n"}, {"tags": ["ms-access", "unicode", "vba"], "answers": [{"comments": [{"owner": {"reputation": 368, "user_id": 5344040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a7008604f3ebc5b783828b6cd2377a?s=128&d=identicon&r=PG", "display_name": "Eperbab", "link": "https://stackoverflow.com/users/5344040/eperbab"}, "edited": false, "score": 0, "creation_date": 1540401450, "post_id": 52974365, "comment_id": 92855731, "body": "I&#39;m using the unicode driver. The text is converted when I read out the query result into a variant. Should I read the recordset field value into a byte array?"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 368, "user_id": 5344040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a7008604f3ebc5b783828b6cd2377a?s=128&d=identicon&r=PG", "display_name": "Eperbab", "link": "https://stackoverflow.com/users/5344040/eperbab"}, "edited": false, "score": 1, "creation_date": 1540401622, "post_id": 52974365, "comment_id": 92855810, "body": "How do you read it out? <code>Debug.Print</code> doesn&#39;t support unicode"}, {"owner": {"reputation": 368, "user_id": 5344040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a7008604f3ebc5b783828b6cd2377a?s=128&d=identicon&r=PG", "display_name": "Eperbab", "link": "https://stackoverflow.com/users/5344040/eperbab"}, "edited": false, "score": 0, "creation_date": 1540402507, "post_id": 52974365, "comment_id": 92856285, "body": "I have tested various link texts, and Application.Followhyperlink works, when the system locale is German, and the link doesn&#39;t contain &quot;\u0151\u0171&#246;&#252;&quot;.   My other method was debug.print."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 368, "user_id": 5344040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a7008604f3ebc5b783828b6cd2377a?s=128&d=identicon&r=PG", "display_name": "Eperbab", "link": "https://stackoverflow.com/users/5344040/eperbab"}, "edited": false, "score": 0, "creation_date": 1540402752, "post_id": 52974365, "comment_id": 92856439, "body": "Try printing to a text box, that&#39;s UTF-16 too. I&#39;m not sure if <code>Application.FollowHyperlink</code> support UTF-16. I do have code lying around relying on external method calls to create a message box that does support UTF-16."}, {"owner": {"reputation": 368, "user_id": 5344040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a7008604f3ebc5b783828b6cd2377a?s=128&d=identicon&r=PG", "display_name": "Eperbab", "link": "https://stackoverflow.com/users/5344040/eperbab"}, "edited": false, "score": 0, "creation_date": 1540402869, "post_id": 52974365, "comment_id": 92856511, "body": "Thanks. I will try it tomorrow, in the office. I have an mbox() function, that shows text on a form with yes / no / cancel button."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1540401988, "last_edit_date": 1540401988, "creation_date": 1540400299, "answer_id": 52974365, "question_id": 52973669, "link": "https://stackoverflow.com/questions/52973669/ms-access-vba-how-to-read-utf8-text-indepently-from-windows-system-locale/52974365#52974365", "title": "MS Access VBA - how to read utf8 text indepently from windows system locale", "body": "<p>VBA and Access use UTF-16 internally, not the system codepage, so this shouldn't be a problem at all. Pass-through queries should just work. However:</p>\n\n<ul>\n<li><p>You need to use the MySQL Unicode driver, not the MySQL ANSI driver</p></li>\n<li><p>Not all VBA functions support unicode characters. For example,\n<code>MsgBox</code> is ANSI only, and will cast unavailable characters to\neither questionmarks or the closest equivalent ANSI character.</p></li>\n<li><p>The VBA code itself is not unicode. You can see <a href=\"https://stackoverflow.com/a/51949328/7296893\">this\nanswer</a> for an approach\nto set strings to characters that are unavailable in the codepage\nused by VBA.</p></li>\n</ul>\n"}], "owner": {"reputation": 368, "user_id": 5344040, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a7008604f3ebc5b783828b6cd2377a?s=128&d=identicon&r=PG", "display_name": "Eperbab", "link": "https://stackoverflow.com/users/5344040/eperbab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 52974365, "answer_count": 1, "score": 0, "last_activity_date": 1594627001, "creation_date": 1540397698, "last_edit_date": 1594627001, "question_id": 52973669, "link": "https://stackoverflow.com/questions/52973669/ms-access-vba-how-to-read-utf8-text-indepently-from-windows-system-locale", "title": "MS Access VBA - how to read utf8 text indepently from windows system locale", "body": "<p>I have a MySQL table with a text field. It contains a hyperlink, and it is encoded in utf8 (utf8-unicode-ci collation). I want to open the hyperlink programmatically from VBA.  </p>\n\n<p>The text field may contain characters like \"\u0151\u0171\u00f6\", wich are not present in western european codepage (1252), but avalaible in central european (1250).</p>\n\n<p>My first attempt was to run a pass-trough query, read the field value into a VBA string, and open it with Application.Followhyperlink. It works, when windows system locale - default codepage for non-unicode compatible applications in regional settings - is Hungarian (uses codepage 1250), and fails, when the system locale is German (uses codepage 1252). The VBA string contains a value converted to the codepage specified by the system locale. So \"C:\\t\u00fck\u00f6rt\u0171r\u0151\" will be read as \"C:\\tukorturo\".   </p>\n\n<p>I am not allowed to fix the system locale on 100+ computers. So, how to do it right?  </p>\n\n<hr>\n\n<p>Edit:<br>\nLessons learned:<br>\n * Debug.Print doesn't support unicode \u2013 as stated by Erik von Asmuth. The displayed text in the debug window is misleading.<br>\n * Application.FollowHyperlink can handle unicode.<br>\n * The real problem was a link health check right before opening the link, where I have used the built in GetAttr(), wich depends on system locale settings. I have replaced it with GetFileAttributesW(), everything seems to work now. Some credit goes here to Bonnie West. (<a href=\"https://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=74264&amp;lngWId=1\" rel=\"nofollow noreferrer\">https://www.planet-source-code.com/vb/scripts/ShowCode.asp?txtCodeId=74264&amp;lngWId=1</a>) </p>\n"}, {"tags": ["excel", "vba", "userform", "cd-rom"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1540397637, "post_id": 52973611, "comment_id": 92853674, "body": "Just add <code>PtrSafe</code> in front of it. None of the <code>Long</code>&#39;s are pointers - only the string addresses."}, {"owner": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540398488, "post_id": 52973611, "comment_id": 92854145, "body": "Hi <i>Comintern</i>! Can you further explain or correct the code?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540398604, "post_id": 52973611, "comment_id": 92854206, "body": "<a href=\"https://stackoverflow.com/q/26822004/1188513\">stackoverflow.com/q/26822004/1188513</a>"}, {"owner": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "edited": false, "score": 0, "creation_date": 1540399051, "post_id": 52973611, "comment_id": 92854446, "body": "With the help of <i>Comintern</i> and <i>Mathieu Guindon</i>  my problem was solved. Thank you very much."}, {"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "edited": false, "score": 0, "creation_date": 1540408320, "post_id": 52973611, "comment_id": 92859225, "body": "I nominate Ross, he seems like he would have the most coding experience."}], "owner": {"reputation": 121, "user_id": 9606526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea2f62df748e278e9178b1d76ec7a869?s=128&d=identicon&r=PG&f=1", "display_name": "First Last", "link": "https://stackoverflow.com/users/9606526/first-last"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 1, "closed_date": 1540401909, "answer_count": 0, "score": 0, "last_activity_date": 1540397495, "creation_date": 1540397495, "question_id": 52973611, "link": "https://stackoverflow.com/questions/52973611/how-to-open-and-close-cd-rom-in-vba", "closed_reason": "Duplicate", "title": "How to Open and Close CD-ROM in VBA", "body": "<p>My Excel is 64-bit. The following code is not running on Windows and Excel 64-bit. Someone from friends can update this code for Windows and Excel 64-bit?</p>\n\n<pre><code>Private Declare Function mciSendString Lib \"winmm.dll\" Alias \"mciSendStringA\" (ByVal lpstrCommand As String, ByVal lpstrReturnString As String, ByVal uReturnLength As Long, ByVal hwndCallback As Long) As Long\n\nPrivate Sub command1_Click()\nDim LRet As Long\n    LRet = mciSendString(\"set CDAudio door open\", returnstring, 127, 0)\nEnd Sub\nPrivate Sub command2_Click()\nDim LRet As Long\n    LRet = mciSendString(\"set CDAudio door closed\", returnstring, 127, 0)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1540459704, "post_id": 52973547, "comment_id": 92877191, "body": "Are you getting the expected result if you run it in Word VBA, without creating any Word.Application objects?"}, {"owner": {"reputation": 25, "user_id": 10098272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bea1599c35a36f8ea46cc5fa8357af8?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy.L", "link": "https://stackoverflow.com/users/10098272/jimmy-l"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1540460818, "post_id": 52973547, "comment_id": 92877854, "body": "I have used the code below in Word VBA and it works fine.  <code>Sub TEST()</code> <code>Set aRange = ActiveDocument.Range</code> <code>Do</code>     <code>aRange.Find.Text = &quot;keyword&quot;</code>     <code>aRange.Find.Execute Forward:=True</code>     <code>If aRange.Find.Found Then</code>         <code>aRange.Select</code>         <code>Selection.MoveUp Unit:=wdLine, Count:=1</code>         <code>sectionNum = Selection.Paragraphs(1).Range.ListFormat.ListString</code>         <code>MsgBox sectionNum</code>       <code>End If</code> <code>Loop While aRange.Find.Found</code> <code>End Sub</code>"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10098272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bea1599c35a36f8ea46cc5fa8357af8?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy.L", "link": "https://stackoverflow.com/users/10098272/jimmy-l"}, "edited": false, "score": 0, "creation_date": 1540457187, "post_id": 52977843, "comment_id": 92875674, "body": "Thanks Double E. Please see additional info from the original post."}], "tags": [], "owner": {"reputation": 49, "user_id": 9375703, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WjtZeI0YXRI/AAAAAAAAAAI/AAAAAAAAEkc/Ou7t0-8IN7Q/photo.jpg?sz=128", "display_name": "Double E CPU", "link": "https://stackoverflow.com/users/9375703/double-e-cpu"}, "is_accepted": false, "score": 0, "last_activity_date": 1540414834, "creation_date": 1540414834, "answer_id": 52977843, "question_id": 52973547, "link": "https://stackoverflow.com/questions/52973547/excel-vba-word-selection-issue-with-462-error/52977843#52977843", "title": "Excel VBA - Word.Selection issue with 462 error", "body": "<p>When you mentioned \"line above it\" I tried checking if the word was in a table or else the sentence. So I compare the words in the document to the keyword then read the row above in the table or the sentence it belongs to, then count backwards until the previous sentence is found. </p>\n\n<pre><code>Sub TEST_Line(fileaddress As String, Keyword As String)\n   Set appWrd = CreateObject(\"Word.Application\")\n   Set docWrd = appWrd.Documents.Open(fileaddress)\n   Set DWords = docWrd.Words\n   For Counter = 1 To DWords.Count\n      If UCase(Keyword) Like UCase(DWords.Item(Counter)) Then\n         If DWords.Item(Counter).Tables.Count &gt; 0 Then\n            Row_Ref = DWords.Item(Counter).Rows(1).Index - 1\n            Col_Ref = DWords.Item(Counter).Columns(1).Index\n            If Row_Ref &gt; 0 Then\n               MsgBox DWords.Item(Counter).Tables(1).Columns(Col_Ref).Cells(Row_Ref).Range.Text\n            End If\n         Else\n            aRange = DWords.Item(Counter).Sentences(1)\n            Reverse_Counter = Counter - 1\n            If Reverse_Counter &lt; 1 Then\n               'MsgBox \"First Sentence\"\n            Else\n               Do While DWords.Item(Reverse_Counter).Sentences(1) = DWords.Item(Counter).Sentences(1)\n               Reverse_Counter = Reverse_Counter - 1\n               Loop\n               MsgBox DWords.Item(Reverse_Counter).Sentences(1)\n            End If\n         End If\n      End If\n   Next Counter\n   docWrd.Close\n   appWrd.Quit\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": true, "score": 0, "last_activity_date": 1540462356, "creation_date": 1540462356, "answer_id": 52986781, "question_id": 52973547, "link": "https://stackoverflow.com/questions/52973547/excel-vba-word-selection-issue-with-462-error/52986781#52986781", "title": "Excel VBA - Word.Selection issue with 462 error", "body": "<p>Replace the line</p>\n\n<pre><code>Set s = Word.Selection\n</code></pre>\n\n<p>with </p>\n\n<pre><code>Set s = appWrd.Selection\n</code></pre>\n\n<p>The \"Word\" object does not like to be reused after getting killed (even though it is recreated). </p>\n"}], "owner": {"reputation": 25, "user_id": 10098272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bea1599c35a36f8ea46cc5fa8357af8?s=128&d=identicon&r=PG&f=1", "display_name": "Jimmy.L", "link": "https://stackoverflow.com/users/10098272/jimmy-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "accepted_answer_id": 52986781, "answer_count": 2, "score": 0, "last_activity_date": 1540474649, "creation_date": 1540397295, "last_edit_date": 1540474649, "question_id": 52973547, "link": "https://stackoverflow.com/questions/52973547/excel-vba-word-selection-issue-with-462-error", "title": "Excel VBA - Word.Selection issue with 462 error", "body": "<p>I was creating an Excel vba to search a keyword in a word document and then return the line above it. Here is the code:</p>\n\n<pre><code>Sub TEST()\n\nDim s As Word.Selection\nfileaddress = \"C:\\XXXXXX\"\n\nSet appWrd = New Word.Application\nSet docWrd = appWrd.Documents.Open(fileaddress)\nSet aRange = docWrd.Range\n\nDo\n    aRange.Find.Text = \"keyword\"\n    aRange.Find.Execute Forward:=True\n    If aRange.Find.Found Then\n        aRange.Select\n        Set s = Word.Selection\n        s.MoveUp Unit:=wdLine, COUNT:=1\n        MsgBox s.Paragraphs(1).Range.ListFormat.ListString\n        Set s = Nothing\n    End If\nLoop While aRange.Find.Found\n\ndocWrd.Close\nappWrd.Quit\n\nEnd Sub\n</code></pre>\n\n<p>The code works fine the first time, then in the second time a 462 error appears. I guess the issue is probably with this Word.Selection thing. Any idea forks?</p>\n\n<p>PS: The word file is something like below:</p>\n\n<ol>\n<li>Heading style 1</li>\n</ol>\n\n<p>keyword</p>\n\n<p>1.1 Heading style 2</p>\n\n<p>keyword</p>\n\n<p>So the code searches for keyword and then move the cursor one line up from keyword's location and then the msgbox would return \"1\" and \"1.1\". However, as I said, the code works fine the first time. I think it is something to do with certain process is not killed in the task manager after the previous run of excel. </p>\n\n<p><strong>SOLVED</strong></p>\n\n<p>New code:</p>\n\n<pre><code>Sub TEST()\n\nDim s As Word.Selection\nfileaddress = \"C:\\XXXXXX\"\n\nSet appWrd = New Word.Application\nSet docWrd = appWrd.Documents.Open(fileaddress)\nSet aRange = docWrd.Range\n\nDo\n    aRange.Find.Text = \"keyword\"\n    aRange.Find.Execute Forward:=True\n    If aRange.Find.Found Then\n        aRange.Select\n        Set s = appWrd.Selection   '&lt;------- This is the only change!\n        s.MoveUp Unit:=wdLine, COUNT:=1\n        MsgBox s.Paragraphs(1).Range.ListFormat.ListString\n        Set s = Nothing\n    End If\nLoop While aRange.Find.Found\n\ndocWrd.Close\nappWrd.Quit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1540397293, "post_id": 52973457, "comment_id": 92853471, "body": "Are you using the top answer to that question? What you probably have to do is loop through each sheet to copy the values into one list on your master sheet and then de-dupe that."}, {"owner": {"reputation": 97, "user_id": 10462532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cd8302fee9aa0c677c994a55fd5d82?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Joppich", "link": "https://stackoverflow.com/users/10462532/steve-joppich"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1540397538, "post_id": 52973457, "comment_id": 92853621, "body": "Yes, I was looking at the first answer using a Dictionary object as the solution since it seemed the simplest on that sheet. So I&#39;ll need to run that script for each sheet and have them output to a long master list on the List_Data sheet and sort it down from there?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1540397966, "post_id": 52973457, "comment_id": 92853843, "body": "Once you have a unique list of names in <code>List_Data</code> create a named range:  <code>=List_Data!$A$1:INDEX(List_Data!$A:$A,COUNTA(List_Data!$A:$A&zwnj;&#8203;))</code> and use that name in the <code>RowSource</code> for the combo-box (<code>=NameList</code>).  Then you can use <code>MATCH</code> or <code>FIND</code> when a name is added to check if it exists and add it to the bottom if it doesn&#39;t - the named range will automatically extend to include it."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1540398030, "post_id": 52973457, "comment_id": 92853872, "body": "That&#39;s how I&#39;d do it. You could also check out <a href=\"http://www.snb-vba.eu/VBA_Sortedlist_en.html\" rel=\"nofollow noreferrer\">snb-vba.eu/VBA_Sortedlist_en.html</a> though probably easier to just sort before adding to the dictionary."}, {"owner": {"reputation": 97, "user_id": 10462532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cd8302fee9aa0c677c994a55fd5d82?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Joppich", "link": "https://stackoverflow.com/users/10462532/steve-joppich"}, "edited": false, "score": 0, "creation_date": 1540398223, "post_id": 52973457, "comment_id": 92853990, "body": "Unfortunately the names are being pulled from a list of records that are in date order so they can&#39;t be put in name order or else it will cause the table to read incorrectly."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1540398926, "post_id": 52973457, "comment_id": 92854383, "body": "But you are creating a new list. Or if using the SortedList you are not doing anything on the sheet anyway."}], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 10462532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cd8302fee9aa0c677c994a55fd5d82?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Joppich", "link": "https://stackoverflow.com/users/10462532/steve-joppich"}, "is_accepted": true, "score": 0, "last_activity_date": 1558099393, "creation_date": 1558099393, "answer_id": 56187350, "question_id": 52973457, "link": "https://stackoverflow.com/questions/52973457/creating-a-unique-list-of-words-from-the-same-column-of-multiple-sheets-and-sort/56187350#56187350", "title": "Creating a unique list of words from the same column of multiple sheets and sorting it alphabetically into a dynamic named range", "body": "<p>So I ended up getting this figured out. What I ended up doing was copying only the string value for the supplier names to the next column, then clearing the original column and pasting the string values back into it. Then I used the procedure above to dynamically create the named range, and used the below procedure to sort the range.</p>\n\n<p>This let me add new suppliers to the list and update the list accordingly. The two supporting procedures I used are below. Hopefully this will help someone out in the future.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub AddnewSupplier(supplier As String)\n    Dim newRng As Range, supplierListColumn As Integer\n\n    supplierListColumn = 9\n\n    Set newRng = SelectFirstBlankCell(supplierListColumn, \"List_Data\")\n\n    newRng.Value = supplier\n\n    Call SupplierListDynamic\n    Call sortSupplierList\n\nEnd Sub\n\nPublic Sub sortSupplierList()\n    Range(\"SupplierList\").Sort Key1:=Worksheets(\"List_Data\").Range(\"I1\"), Order1:=xlAscending, Header:=xlYes\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 10462532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d4cd8302fee9aa0c677c994a55fd5d82?s=128&d=identicon&r=PG&f=1", "display_name": "Steve Joppich", "link": "https://stackoverflow.com/users/10462532/steve-joppich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 56187350, "answer_count": 1, "score": 2, "last_activity_date": 1586462596, "creation_date": 1540397027, "last_edit_date": 1586462596, "question_id": 52973457, "link": "https://stackoverflow.com/questions/52973457/creating-a-unique-list-of-words-from-the-same-column-of-multiple-sheets-and-sort", "title": "Creating a unique list of words from the same column of multiple sheets and sorting it alphabetically into a dynamic named range", "body": "<p>I have a user form that has a combo box with a list of names in it for the user to choose from. The list needs to be dynamic since I want the user to be able to type a name into the combo box if it doesn't exist already, but there needs to be a list of already existing names too for them to choose from. I found a similar question asked several years ago on here: <a href=\"https://stackoverflow.com/questions/20007039/excel-all-unique-words-in-a-range\">Excel - All unique words in a range</a></p>\n\n<p>The problem here is that it only works for one sheet and I can't see how to pull from multiple sheets using this, or how to sort the names automatically into alphabetical order. </p>\n\n<p>This is the sub I'm using to create the dynamic range as it is now, the links to the original creator are left in to give credit where credit is due.</p>\n\n<pre><code>Sub SupplierListDynamic()\n'Source: https://powerspreadsheets.com/\n'For further information: https://powerspreadsheets.com/vba-create-named-range/\n'declare object variable to hold reference to worksheet containing cell range\nDim myWorksheet As Worksheet\n\n'declare variables to hold row and column numbers that define named cell range (dynamic)\nDim myFirstRow As Long\nDim myLastRow As Long\nDim myFirstColumn As Long\nDim myNamedRangeDynamic As Range    'declare object variable to hold reference to cell range\nDim myRangeName As String   'declare variable to hold defined name\n\n\nSet myWorksheet = ThisWorkbook.Worksheets(\"List_Data\")  'identify worksheet containing cell range\nmyFirstRow = 2  'identify first row and first column of cell range\nmyFirstColumn = 9\nmyRangeName = \"SupplierList\"    'specify defined name\n\nWith myWorksheet.Cells\n    'find last row and last column of source data cell range\n    myLastRow = .Find(What:=\"*\", LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n    'myLastColumn = .Find(What:=\"*\", LookIn:=xlFormulas, LookAt:=xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\n\n    'specify cell range\n    Set myNamedRangeDynamic = .Range(.Cells(myFirstRow, myFirstColumn), .Cells(myLastRow, myFirstColumn))\nEnd With\n\n'create named range with workbook scope. Defined name is as specified.\n'Cell range is as identified, with the last row and column being dynamically determined\nThisWorkbook.Names.Add Name:=myRangeName, RefersTo:=myNamedRangeDynamic\nEnd Sub\n</code></pre>\n\n<p>but it's not sorted since I'm using<code>{=INDEX(Sep[SUPPLIER],MATCH(0,COUNTIF($I$1:I1,Sep[SUPPLIER]),0))}</code> to pull the unique values from another sheet, when I sort them, they just go back to their original order because of how the formula works. I'd rather this all be done with VBA to keep it in the back ground but I need some help tying everything together.</p>\n"}, {"tags": ["excel", "vba", "automation", "hidden"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1540397790, "post_id": 52973270, "comment_id": 92853751, "body": "It  <i>could</i> be that the data is only in the PivotCache, but for an alternative: if you hit [Alt]+[F11] to open the VBA Project, is there a Worksheet set to &quot;Very Hidden&quot;? (The &quot;Visible&quot; property has 3 settings: &quot;Visible&quot;, &quot;Hidden&quot; - which you can unhide by right-clicking the tabs and selecting &quot;Unhide&quot; or &quot;Very Hidden&quot;, where it doesn&#39;t even show up in the list of Tabs to unhide)"}], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 10161096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b231be785bec2d6114cb0721c68ed5d4?s=128&d=identicon&r=PG&f=1", "display_name": "codingsnake99", "link": "https://stackoverflow.com/users/10161096/codingsnake99"}, "edited": false, "score": 0, "creation_date": 1540457334, "post_id": 52973745, "comment_id": 92875757, "body": "Got it! I don&#39;t know the concept of PivotCache before. I will try the solution you gave me. Thanks."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1540397936, "creation_date": 1540397936, "answer_id": 52973745, "question_id": 52973270, "link": "https://stackoverflow.com/questions/52973270/how-to-use-vba-to-call-out-the-weird-hidden-pivot-table-data-sources/52973745#52973745", "title": "how to use vba to call out the weird hidden Pivot table data sources", "body": "<p>The data is likely stored in a PivotCache - this data is not found on a worksheet but is saved as part of the file.</p>\n\n<p><a href=\"https://trumpexcel.com/pivot-cache-excel/\" rel=\"nofollow noreferrer\">https://trumpexcel.com/pivot-cache-excel/</a></p>\n\n<p>See previous question here on SO:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/1442316/recreate-source-data-from-pivottable-cache\">Recreate Source Data from PivotTable Cache</a></p>\n\n<p>Alternatively, if you are comfortable with XML and your workbook is saved in xlsx format, you can unzip the file (add a .zip extension and double-click) and find the pivotcache details stored as XML in <code>pivotCacheDefinition1.xml</code> and <code>pivotCacheRecords1.xml</code> in the xl\\pivotCache folder.</p>\n"}], "owner": {"reputation": 89, "user_id": 10161096, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b231be785bec2d6114cb0721c68ed5d4?s=128&d=identicon&r=PG&f=1", "display_name": "codingsnake99", "link": "https://stackoverflow.com/users/10161096/codingsnake99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 52973745, "answer_count": 1, "score": 2, "last_activity_date": 1540397936, "creation_date": 1540396380, "question_id": 52973270, "link": "https://stackoverflow.com/questions/52973270/how-to-use-vba-to-call-out-the-weird-hidden-pivot-table-data-sources", "title": "how to use vba to call out the weird hidden Pivot table data sources", "body": "<p>I found a weird stuation in my Excel file and just want to know how the creater made it and how to automatically solve it.</p>\n\n<p>Someone keep sending me an excel file with only one sheet which contains one Pivot table.\nThe weird thing is that I cannot find the data source which this Pivot Table should link to.</p>\n\n<p>Even I tried to click \"unhide\" button, there is no hinden sheet in this file.</p>\n\n<p><strong>However, when I double click the cell in this Pivot, there will be one new sheet appear in this file. And this new sheet is the data source of this Pivot.</strong></p>\n\n<p><strong>Is it possible to create a Macro to call out this hidden sheet without I double click it manually?</strong></p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1540396608, "post_id": 52973254, "comment_id": 92853009, "body": "Are you positive that in Column C, you have data <i>past</i> row 6?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1540396714, "post_id": 52973254, "comment_id": 92853080, "body": "For consistency, you may want to change <code>Set namerange = .Range(Ov.Cells(6, 3), .Cells(lastrow, 3))</code> to <code>Set namerange = .Range(.Cells(6, 3), .Cells(lastrow, 3))</code> (remove the redundant <code>Ov</code>)"}, {"owner": {"reputation": 21, "user_id": 10553029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d565589984b0ca859262cd5b53be4fb7?s=128&d=identicon&r=PG&f=1", "display_name": "JackL", "link": "https://stackoverflow.com/users/10553029/jackl"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1540397335, "post_id": 52973254, "comment_id": 92853498, "body": "@BruceWayne Yes, that\u2019s why this has been so confusing. For reference, in this code \u2018lastrow\u2019 = 43.Setting \u2018namerange\u2019 to \u2018.Range(\u201cC6:C43\u201d)\u2019 also does not work for some reason."}, {"owner": {"reputation": 21, "user_id": 10553029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d565589984b0ca859262cd5b53be4fb7?s=128&d=identicon&r=PG&f=1", "display_name": "JackL", "link": "https://stackoverflow.com/users/10553029/jackl"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1540397387, "post_id": 52973254, "comment_id": 92853535, "body": "@cybernetic.nomad Good point. I will get rid of that, thanks."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540397532, "post_id": 52973254, "comment_id": 92853619, "body": "If the sheets exist at compile-time in <code>ThisWorkbook</code>, all 3 worksheet variables are redundant. Set their <code>(Name)</code> property (F4) to a meaningful identifier, then use that free, global-scope (project-scope actually) object variable whenever you need to refer to these sheets. e.g. <code>With OverviewSheet</code>, <code>With FinancialsSheet</code>, <code>FinancialDataSheet.ListObjects(1)</code>, etc."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1540397617, "post_id": 52973254, "comment_id": 92853665, "body": "I think you need to transpose the range."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1540397694, "post_id": 52973254, "comment_id": 92853704, "body": "^ that. <code>.List = namerange</code> is an implicit member call on <code>Range.Value</code>, which gives you a 2D array - but <code>.List</code> likely wants a single-dimensional array. Try <code>.List = Application.Transpose(namerange.Value)</code>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540397831, "post_id": 52973254, "comment_id": 92853778, "body": "@MathieuGuindon - thanks for the explanation, was struggling to think why."}, {"owner": {"reputation": 21, "user_id": 10553029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d565589984b0ca859262cd5b53be4fb7?s=128&d=identicon&r=PG&f=1", "display_name": "JackL", "link": "https://stackoverflow.com/users/10553029/jackl"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1540400025, "post_id": 52973254, "comment_id": 92855012, "body": "@MathieuGuindon Worked like a charm. Thank you so much for the detailed explanation! I will also incorporate that method of referencing sheets from here on out as well."}], "owner": {"reputation": 21, "user_id": 10553029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d565589984b0ca859262cd5b53be4fb7?s=128&d=identicon&r=PG&f=1", "display_name": "JackL", "link": "https://stackoverflow.com/users/10553029/jackl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 310, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1586462632, "creation_date": 1540396343, "last_edit_date": 1586462632, "question_id": 52973254, "link": "https://stackoverflow.com/questions/52973254/excel-vba-why-does-my-range-variable-return-nothing-no-matter-what-it-is-set-to", "title": "Excel VBA: Why does my Range variable return nothing no matter what it is set to?", "body": "<p>I am attempting to populate a Combobox upon sheet activation with a list of company names from column C on the Overview sheet with a variable number of rows. </p>\n\n<p>Here is the code I have:</p>\n\n<pre><code>Private Sub Worksheet_Activate()\nDim namerange As Range\nDim lastrow As Integer\n\nSet wk1 = ThisWorkbook.Worksheets(\"Financials\")\nSet wk2 = ThisWorkbook.Worksheets(\"FinancialData\")\nSet Ov = ThisWorkbook.Worksheets(\"Overview\")\n\n'Define range of company names\nWith Ov\nlastrow = .Range(\"C\" &amp; .Rows.Count).End(xlUp).Row\nSet namerange = .Range(Ov.Cells(6, 3), .Cells(lastrow, 3))\nEnd With\n\n'Add Portfolio names to combobox\nWith wk1.ComboBox1\n.List = namerange\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I have tried manually setting <code>namerange</code> to the actual range I want to populate the box with, but no matter what I try to set it to, it returns nothing and the <code>.List</code> throws an error.</p>\n\n<p>My knowledge of VBA is very limited so I have a feeling I am missing something obvious here. I am puzzled because I have used similar code elsewhere without problems.  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 3, "creation_date": 1540395275, "post_id": 52972841, "comment_id": 92852141, "body": "Filter might be better than find if you need all of them"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1540395367, "post_id": 52972841, "comment_id": 92852193, "body": "What are you trying to return? Or do you simply want to highlight those cells with a string you&#39;re looking for?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1540395515, "post_id": 52972841, "comment_id": 92852292, "body": "What are you trying to do?  Hide the rest, or just find out where they are?"}, {"owner": {"reputation": 23, "user_id": 10186618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e807a1453fe2bee9824d0323a8627e?s=128&d=identicon&r=PG&f=1", "display_name": "djarve", "link": "https://stackoverflow.com/users/10186618/djarve"}, "edited": false, "score": 0, "creation_date": 1540398894, "post_id": 52972841, "comment_id": 92854365, "body": "Apologies for leaving out some detail. If red or green or yellow is there, I want to copy the value in the cell and copy the corresponding value in the &#39;Number&#39; column, and paste them into a new worksheet."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1540400840, "post_id": 52972841, "comment_id": 92855445, "body": "Take a look at <a href=\"https://superuser.com/questions/536234/excel-how-to-vlookup-to-return-multiple-values#536254\">this</a>"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10186618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e807a1453fe2bee9824d0323a8627e?s=128&d=identicon&r=PG&f=1", "display_name": "djarve", "link": "https://stackoverflow.com/users/10186618/djarve"}, "edited": false, "score": 0, "creation_date": 1540818356, "post_id": 52974708, "comment_id": 92991676, "body": "Thanks! I probably wasn&#39;t as descriptive as I should have been. The sheet that I need to search within is dynamic in that it changes every week, so it&#39;s never the same file. I guess I could create a reference for the most recent file and pass the reference into the MultiFindCopy function?"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "reply_to_user": {"reputation": 23, "user_id": 10186618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e807a1453fe2bee9824d0323a8627e?s=128&d=identicon&r=PG&f=1", "display_name": "djarve", "link": "https://stackoverflow.com/users/10186618/djarve"}, "edited": false, "score": 0, "creation_date": 1540903776, "post_id": 52974708, "comment_id": 93027628, "body": "Yes, The procedure takes in Search Range as a parameter (as well as the destination).  You will just need a method to pass the right search range into the function."}], "tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": false, "score": 0, "last_activity_date": 1540401611, "creation_date": 1540401611, "answer_id": 52974708, "question_id": 52972841, "link": "https://stackoverflow.com/questions/52972841/vba-to-search-column-for-1-of-3-possible-values/52974708#52974708", "title": "VBA to Search Column for 1 of 3 Possible Values", "body": "<p>This will let you specify a range to search, Start Range for the results, and a string list of the values you want to find.  It could easily be converted to an array of values to find.  If you want a case in-sensitive search you can add UCASE to both sides of the IF statement.</p>\n\n<pre><code>Sub TEST()\n    Call MultiFindCopy(Sheet1.Range(\"B1:B10\"), Sheet2.Range(\"A1\"), \"Red, Green, Yellow\")\n\nEnd Sub\n\nPrivate Sub MultiFindCopy(ByRef SearchRange As Range, ByRef DestinationRange As Range, ByVal itemList As String, Optional Delimiter As String = \",\")\n    Dim oFindList() As String\n    oFindList = Split(itemList, Delimiter)\n\n    Dim oDestRow As Long\n    Dim oSourceRow As Long\n\n    For oSourceRow = 1 To SearchRange.Rows.Count\n        For Each oItem In oFindList\n            If SearchRange.Cells(oSourceRow, 1).Value = Trim(oItem) Then\n                DestinationRange.Offset(oDestRow, 0).Value = SearchRange.Cells(oSourceRow, 0).Value\n                DestinationRange.Offset(oDestRow, 1).Value = SearchRange.Cells(oSourceRow, 1).Value\n                oDestRow = oDestRow + 1\n            End If\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10186618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28e807a1453fe2bee9824d0323a8627e?s=128&d=identicon&r=PG&f=1", "display_name": "djarve", "link": "https://stackoverflow.com/users/10186618/djarve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540401611, "creation_date": 1540395117, "last_edit_date": 1540400335, "question_id": 52972841, "link": "https://stackoverflow.com/questions/52972841/vba-to-search-column-for-1-of-3-possible-values", "title": "VBA to Search Column for 1 of 3 Possible Values", "body": "<p>I have a worksheet with multiple columns and I am trying to search on a specific column (in this case Status) for 1 of 3 possible values (red, green, or yellow). If I was only looking for one value I think I'd be able to do a find. But since I'm looking for every instance of at least 1 of 3 values in the Status column, I'm not quite sure how that would work. Thanks in advance for your help. </p>\n\n<pre><code>Num Status\n1   Blah\n2   Green\n3   Red\n4   Blah\n5   Yellow\n6   Blah\n7   Blah\n8   Green\n9   Blah\n10  Blah\n11  Green\n12  Green\n13  Red\n14  Blah\n15  Green\n16  Blah\n17  Green\n18  Blah\n19  Red\n20  Blah\n</code></pre>\n"}, {"tags": ["vba", "date"], "answers": [{"tags": [], "owner": {"reputation": 1110, "user_id": 5572384, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2BvJ.jpg?s=128&g=1", "display_name": "StoneGiant", "link": "https://stackoverflow.com/users/5572384/stonegiant"}, "is_accepted": true, "score": 0, "last_activity_date": 1540395924, "creation_date": 1540395924, "answer_id": 52973135, "question_id": 52972758, "link": "https://stackoverflow.com/questions/52972758/add-now-1-in-column-a-when-adjacent-columns-have-data-added-to-it/52973135#52973135", "title": "Add Now() -1 in Column A When Adjacent Columns Have Data Added to It", "body": "<pre><code>Sub datedd()\n    Dim lastRow As Long\n    Dim firstRow As Long\n    lastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n    firstRow = Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n\n    With Range(\"A\" &amp; CStr(firstRow) &amp; \":A\" &amp; CStr(lastRow))\n        .Value = Now -1\n        .NumberFormat = \"mm/dd/yy\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 10523923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da20be2fe4a7358ff9b1e2d858b88b4f?s=128&d=identicon&r=PG&f=1", "display_name": "LLF", "link": "https://stackoverflow.com/users/10523923/llf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20, "favorite_count": 0, "accepted_answer_id": 52973135, "answer_count": 1, "score": 0, "last_activity_date": 1540395924, "creation_date": 1540394842, "last_edit_date": 1540394947, "question_id": 52972758, "link": "https://stackoverflow.com/questions/52972758/add-now-1-in-column-a-when-adjacent-columns-have-data-added-to-it", "title": "Add Now() -1 in Column A When Adjacent Columns Have Data Added to It", "body": "<p>I'm updating a report everyday and adding data from yesterdays runs. I would like to insert a code in the macro to add the date into column A next to the newly added data without changing the previous dates already in column A.</p>\n\n<pre><code>Sub datedd()\n\n    Dim lastRow As Long\n    lastRow = Range(\"B\" &amp; Rows.Count).End(xlUp).Row\n\n    With Range(\"A2:A\" &amp; lastRow)\n        .Value = Now -1\n        .NumberFormat = \"mm/dd/yy\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>But this changes all the dates in column A</p>\n\n<p>not sure why pasting in the code breaks apart like this, sorry im new here!</p>\n"}, {"tags": ["excel", "vba", "web-scraping", "yahoo-finance"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 1, "creation_date": 1540394675, "post_id": 52972236, "comment_id": 92851769, "body": "What is not working?"}, {"owner": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540395577, "post_id": 52972236, "comment_id": 92852334, "body": "I can&#39;t get de NAV, Price, Outstanding Shares and Total Assets. Basically I don&#39;t know hoy to get the element because the class name appears several time through the code. I can&#39;t &quot;reference&quot; the values."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1540395909, "post_id": 52972236, "comment_id": 92852557, "body": "<a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1540397735, "post_id": 52972236, "comment_id": 92853727, "body": "Try the script that QHarr suggested @Nico Rodriguez. That should work."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540397241, "post_id": 52973126, "comment_id": 92853437, "body": "Perfect! I understood the logic. Thanks. I just tried the code but nothing happen, it just keeps running.  Do you think I should try with Python?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540398395, "post_id": 52973126, "comment_id": 92854082, "body": "Oops you can get rid of the <code>Do...Loop</code> that you had in your original code. I updated mine to remove the <code>Do</code> that was showing."}, {"owner": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540401684, "post_id": 52973126, "comment_id": 92855841, "body": "Excelent! Now it Works perfectly. Thank you."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 1, "last_activity_date": 1540450448, "last_edit_date": 1540450448, "creation_date": 1540395898, "answer_id": 52973126, "question_id": 52972236, "link": "https://stackoverflow.com/questions/52972236/web-scraping-etfs-daily-data-vba/52973126#52973126", "title": "Web Scraping ETFs Daily Data VBA", "body": "<p>Okay, so you will need to create two loops. You can just keep reusing the <code>elem0</code>, <code>elem1</code>, and <code>elemColl(1)</code> variables for each price point you need - just make sure to reset <code>bFoundIt</code> to False for each new iteration so you do not exit the For Loops early.</p>\n\n<p>For your <code>total_net_assets</code> var, you will first <strong>loop the class of <code>kv__item</code></strong>. You will then need to loop each class collection of <code>kv__label</code> within the <code>kv__item</code>'s elements and stop when you match the innerText: <strong>Total Net Assets</strong>. Once you match this, you will use the first coll obj <code>elem0</code> to get the <code>kv__value kv__primary</code> class name for it.</p>\n\n<pre><code>Dim IE As Object, elem0 As Object, elem1 As Object, i As Long, bFoundIt As Boolean\n\nSet IE = CreateObject(\"InternetExplorer.application\")\nWith IE\n    .Visible = False\n    .navigate link\n    While .Busy Or .readyState &lt; 4: DoEvents: Wend\n        DoEvents\n        bFoundIt = False\n        For Each elem0 In .document.getElementsByClassName(\"kv__item\")\n            For Each elem1 In elem0.getElementsByClassName(\"kv__label\")\n                If elem1.innerText = \"Total Net Assets\" Then\n                    bFoundIt = True\n                    total_net_assets = elem0.getElementsByClassName(\"kv__value kv__primary \")(0).innerText\n                    Exit For\n                End If\n            Next elem1\n            If bFoundIt Then Exit For\n        Next elem0\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540402096, "post_id": 52973342, "comment_id": 92856069, "body": "NICE! As always, providing excelent and complete answers. Thank you, I will give it a try and come back to you."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540402119, "post_id": 52973342, "comment_id": 92856076, "body": "No worries. Any problems let me know."}, {"owner": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540410413, "post_id": 52973342, "comment_id": 92860227, "body": "Sorry QHarr, I&#39;m having a compilation error with the GetInfo function. It appears a message that the type hasn&#39;t being defined. How can I fix this?? Maybe the code is too PRO for my coding skills, and I&#39;m implementing it the wrong way :(."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540410623, "post_id": 52973342, "comment_id": 92860321, "body": "Have you added a reference to Microsoft HTML Object Library? VBE &gt; Tools &gt; References."}, {"owner": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540469417, "post_id": 52973342, "comment_id": 92882919, "body": "It keeps throwing a compilation error at &quot;http As clsHTTP&quot;, I don&#39;t know if I have to add another reference"}, {"owner": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540469679, "post_id": 52973342, "comment_id": 92883090, "body": "I can&#39;t access the link :("}, {"owner": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540471045, "post_id": 52973342, "comment_id": 92884054, "body": "I still can&#39;t acces the link, but is because the internet I am connected to blocked them."}, {"owner": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540473406, "post_id": 52973342, "comment_id": 92885655, "body": "Yes! I did, are there any other modules I have to name? I mean, with the functions is the same?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540473488, "post_id": 52973342, "comment_id": 92885704, "body": "No. It you put the code for clsHTTP in a class module named clsHTTP, and the other code in a standard module and use the code exactly as shown it should work fine. Did you include the Dim http As clsHTTP - as shown in code?"}, {"owner": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540473603, "post_id": 52973342, "comment_id": 92885774, "body": "Sorry for the ignorance, I will give a try now."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540473768, "post_id": 52973342, "comment_id": 92885886, "body": "See the latest edit. I have added a version that doesn&#39;t use a class object."}, {"owner": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540473935, "post_id": 52973342, "comment_id": 92886016, "body": "I finally understood the class module hahaha, it Works perfectly. Thanks QHarr!! Sorry for the trouble."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540473986, "post_id": 52973342, "comment_id": 92886055, "body": "Yessssssssssssssssssssssssssssssssssss :-) It is a more efficient way to write code, in this case, in this way and you can easily re-use the class and adapt its methods as required."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "edited": false, "score": 0, "creation_date": 1540474188, "post_id": 52973342, "comment_id": 92886201, "body": "Any further problems let me know and remember to accept an answer at some point if situ solved."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1540473748, "last_edit_date": 1540473748, "creation_date": 1540396655, "answer_id": 52973342, "question_id": 52972236, "link": "https://stackoverflow.com/questions/52972236/web-scraping-etfs-daily-data-vba/52973342#52973342", "title": "Web Scraping ETFs Daily Data VBA", "body": "<p><strong>Access method:</strong></p>\n\n<p>I use <a href=\"https://codingislove.com/http-requests-excel-vba/\" rel=\"nofollow noreferrer\">XMLHTTP</a> requests as much faster than opening IE.</p>\n\n<p><strong>Code notes:</strong></p>\n\n<p>The following reads in fund short codes from Sheet1 column A, starting in <code>A2</code>, into an array. You can easily extend this adding more funds into column A.</p>\n\n<p>This array is looped issuing XMLHTTP requests by concatenating the fund code into the <code>BASE_URL</code> variable.</p>\n\n<p>I use a class, <code>clsHTTP</code>, to hold the XMLHTTP object to be efficient - no need to keep creating and destroying the object. </p>\n\n<p>I provide this class with two methods. One to retrieve the target page innerHTML (<code>GetString</code>), and the other to extract the required info if available (<code>GetInfo</code>). I use a dictionary to test if the searched for labels are present. If present I grab the associated value. If not, I have a placeholder <code>vbNullString</code> in the dictionary.</p>\n\n<p>I add each scraped result into a collection called <code>results</code>. At the end I loop this writing out to the sheet. By keeping most of the work in memory this provides for much faster scraping.</p>\n\n<hr>\n\n<p><strong>Retrieving info from HTML:</strong></p>\n\n<p>The <code>labels</code> e.g. <code>Open</code>, and <code>values</code> come in pairs.</p>\n\n<p>You can generate a <code>nodeList</code> (think collection as with <code>getElementsByClassName</code>)  by using <code>querySelectorAll</code> method to apply a <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Class_selectors\" rel=\"nofollow noreferrer\">class CSS selector</a> to gather the label elements by their class name <code>kv__label</code>. The <code>\".\"</code> is the class selector.</p>\n\n<pre><code>Set labels = .querySelectorAll(\".kv__label\") '&lt;== nodeList of labels\n</code></pre>\n\n<p>You do the same to get the associated values:</p>\n\n<pre><code>Set values = .querySelectorAll(\".kv__value.kv__primary\") '&lt;== nodeList of associated values. Same length as labels nodeList so can use same index to retrieve associated label/value pairs from each nodeList.\n</code></pre>\n\n<p>You loop the labels using the dictionary in the <code>clsHTTP</code> method <code>.GetInfo</code> to see if you searched for labels are present, if they are, the associated value is retrieved from values by using the same index as where the label was found in the <code>nodeList</code> <code>labels</code>, and the dictionary <code>vbNullString</code> value for that label is updated with the actual retrieved value, else it is left as <code>vbNullString</code>.</p>\n\n<hr>\n\n<h2>Sample results:</h2>\n\n<h2><a href=\"https://i.stack.imgur.com/mJ8Q9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mJ8Q9.png\" alt=\"enter image description here\"></a></h2>\n\n<h2>VBA:</h2>\n\n<p><strong>Class module clsHTTP:</strong></p>\n\n<pre><code>Option Explicit\nPrivate http As Object\n\nPrivate Sub Class_Initialize()\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\nEnd Sub\n\nPublic Function GetString(ByVal url As String) As String\n    Dim sResponse As String\n    With http\n        .Open \"GET\", url, False\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n        GetString = sResponse\n    End With\nEnd Function\n\nPublic Function GetInfo(ByVal html As HTMLDocument) As Object\n    Dim dict As Object, i As Long\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    dict.Add \"Open\", vbNullString\n    dict.Add \"Shares Outstanding\", vbNullString\n    dict.Add \"Total Net Assets\", vbNullString\n    dict.Add \"NAV\", vbNullString\n\n    Dim values As Object, labels As Object\n\n    With html\n        Set values = .querySelectorAll(\".kv__value.kv__primary\")\n        Set labels = .querySelectorAll(\".kv__label\")\n\n        For i = 0 To labels.Length - 1\n            If dict.Exists(labels.item(i).innerText) Then dict(labels.item(i).innerText) = values.item(i).innerText\n        Next\n    End With\n    Set GetInfo = dict\nEnd Function\n</code></pre>\n\n<p><strong>Standard module 1:</strong></p>\n\n<pre><code>Option Explicit   \nPublic Sub GetFundInfo()\n    Dim sResponse As String, html As HTMLDocument, http As clsHTTP, i As Long\n    Dim headers(), funds(), url As String, results As Collection, ws As Worksheet\n    Const BASE_URL As String = \"https://www.marketwatch.com/investing/fund/\"\n\n    Application.ScreenUpdating = False\n\n    headers = Array(\"Open\", \"Shares Outstanding\", \"Total Net Assets\", \"NAV\")\n    Set results = New Collection\n    Set http = New clsHTTP\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set html = New HTMLDocument\n\n    funds = Application.Transpose(ws.Range(\"A2:A3\").Value) '&lt;== Change the range here to the single column range containing your dotNums.\n\n    For i = LBound(funds) To UBound(funds)\n        If Not IsEmpty(funds(i)) Then\n            url = BASE_URL &amp; funds(i)\n            html.body.innerHTML = http.GetString(url)\n            results.Add http.GetInfo(html).Items\n        End If\n    Next\n\n    If results.Count &gt; 0 Then\n        Dim item As Variant, r As Long, c As Long\n        r = 2: c = 2\n        With ws\n            .Cells(1, c).Resize(1, UBound(headers) + 1) = headers\n            For Each item In results\n                .Cells(r, c).Resize(1, UBound(item) + 1) = item\n                r = r + 1\n            Next\n        End With\n    End If\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>Set-up:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/yUbXC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yUbXC.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Without using a class:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetFundInfo()\n    Dim sResponse As String, html As HTMLDocument,  i As Long\n    Dim headers(), funds(), url As String, results As Collection, ws As Worksheet\n    Const BASE_URL As String = \"https://www.marketwatch.com/investing/fund/\"\n\n    Application.ScreenUpdating = False\n\n    headers = Array(\"Open\", \"Shares Outstanding\", \"Total Net Assets\", \"NAV\")\n    Set results = New Collection\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set html = New HTMLDocument\n\n    funds = Application.Transpose(ws.Range(\"A2:A3\").Value) '&lt;== Change the range here to the single column range containing your dotNums.\n\n    For i = LBound(funds) To UBound(funds)\n        If Not IsEmpty(funds(i)) Then\n            url = BASE_URL &amp; funds(i)\n            html.body.innerHTML = GetString(url)\n            results.Add GetInfo(html).Items\n        End If\n    Next\n\n    If results.Count &gt; 0 Then\n        Dim item As Variant, r As Long, c As Long\n        r = 2: c = 2\n        With ws\n            .Cells(1, c).Resize(1, UBound(headers) + 1) = headers\n            For Each item In results\n                .Cells(r, c).Resize(1, UBound(item) + 1) = item\n                r = r + 1\n            Next\n        End With\n    End If\n    Application.ScreenUpdating = True\nEnd Sub\n\n\nPublic Function GetString(ByVal url As String) As String\n    Dim http As Object\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\n    Dim sResponse As String\n    With http\n        .Open \"GET\", url, False\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n        GetString = sResponse\n    End With\nEnd Function\n\nPublic Function GetInfo(ByVal html As HTMLDocument) As Object\n    Dim dict As Object, i As Long\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    dict.Add \"Open\", vbNullString\n    dict.Add \"Shares Outstanding\", vbNullString\n    dict.Add \"Total Net Assets\", vbNullString\n    dict.Add \"NAV\", vbNullString\n\n    Dim values As Object, labels As Object\n\n    With html\n        Set values = .querySelectorAll(\".kv__value.kv__primary\")\n        Set labels = .querySelectorAll(\".kv__label\")\n\n        For i = 0 To labels.Length - 1\n            If dict.Exists(labels.item(i).innerText) Then dict(labels.item(i).innerText) = values.item(i).innerText\n        Next\n    End With\n    Set GetInfo = dict\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 10106697, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155843478753722/picture?type=large", "display_name": "Nico Rodriguez", "link": "https://stackoverflow.com/users/10106697/nico-rodriguez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 930, "favorite_count": 1, "accepted_answer_id": 52973342, "answer_count": 2, "score": 3, "last_activity_date": 1613316097, "creation_date": 1540393309, "last_edit_date": 1613316097, "question_id": 52972236, "link": "https://stackoverflow.com/questions/52972236/web-scraping-etfs-daily-data-vba", "title": "Web Scraping ETFs Daily Data VBA", "body": "<p>I'm trying to web scrape some daily info of differents ETFs. I found that <a href=\"https://www.marketwatch.com/\" rel=\"nofollow noreferrer\">https://www.marketwatch.com/</a> have a accurate info.\nThe most relevant info is the open Price, outstanding shares, NAV, total assets of the ETF.\nHere is the link for IVV US Equity: <a href=\"https://www.marketwatch.com/investing/fund/ivv\" rel=\"nofollow noreferrer\">https://www.marketwatch.com/investing/fund/ivv</a></p>\n<p>I have web scraped with VBA before but the HTML of the pages I had used are different, I don't know if this is because some values of the ETFs (such as Price and Taded Volume) change constantly.\nThe idea is to create a code to extract relevant info and create a data base to analyze Macroeconomics factor using the ETFs as market indicators of flows between countries, regions, etc...</p>\n<p>Mi first approach would be with VBA but after I get more into the data I would like to try with Python (after I get more conffident with it) to automate the webscraping process on a daily basis.</p>\n<p>I am open to any suggestion or any other website that could be useful (I have tried with Yahoo Finance and Morningstar and I get the same problema with the HTML code).</p>\n<p>This is my poor code:</p>\n<pre><code>Sub Get_Data()\n    \n    Dim ticker As String, enlace As String\n    \n    ticker = ThisWorkbook.Worksheets(&quot;ETFs&quot;).Cells(2, 2).Value 'IVV\n    'link = &quot;https://www.morningstar.com/etfs/arcx/&quot; &amp; ticker &amp; &quot;/quote.html&quot;\n    'link = &quot;https://finance.yahoo.com/quote/&quot; &amp; ticker &amp; &quot;?p=&quot; &amp; ticker\n    link = &quot;https://www.marketwatch.com/investing/fund/&quot; &amp; ticker\n        \n    Application.ScreenUpdating = False\n        \n    Dim x As Integer\n    x = ThisWorkbook.Worksheets(&quot;ETFs&quot;).Cells(Rows.Count, 1).End(xlUp).Row\n    \n    'Dim i As Integer\n    'For i = 2 To x\n    \n    Dim total_net_assets As Variant, open_price As Variant, NAV As Variant, shares_out\n            \n    Set ie = CreateObject(&quot;InternetExplorer.application&quot;)\n    With ie\n        .Visible = False\n        .navigate link\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n            Do\n                DoEvents\n                On Error Resume Next\n                ' Here is where I get the problem of not knowing how to reference the values I need because the class name appears repeatedly\n                total_net_assets = .document.getElementsByClassName(&quot;&quot;).Value\n                open_price = .document.getElementByClassName(&quot;price&quot;).Value\n                NAV = .document.getElementByClassName(&quot;&quot;).Value\n                shares_out = .document.getElementByClassName(&quot;kv__value kv__primary &quot;).Value\n                On Error GoTo 0\n            Loop\n    End With\n    ThisWorkbook.Worksheets(&quot;ETFs&quot;).Cells(2, 13).Value = total_net_assets\n    ThisWorkbook.Worksheets(&quot;ETFs&quot;).Cells(2, 14).Value = NAV\n    ThisWorkbook.Worksheets(&quot;ETFs&quot;).Cells(2, 15).Value = open_price\n    ThisWorkbook.Worksheets(&quot;ETFs&quot;).Cells(2, 16).Value = shares_out\n    ie.Quit\n    'Next i\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1540393489, "post_id": 52972043, "comment_id": 92850935, "body": "Just use <code>Target</code> instead of <code>Range(Target.Address)</code>. Your intersect line looks ok, it&#39;s just checking the changed cell is in one of those ranges."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1540393742, "post_id": 52972043, "comment_id": 92851103, "body": "Worth noting that worksheet change is not triggered by a formula calculation."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1540394175, "post_id": 52972043, "comment_id": 92851391, "body": "@SJR I was debating if I should move those formulas out of the LTV and CLTV cells and just do the calculations within VBA, but for now its easier to just leave the formulas.  I will have to do some research on how to make sure the calculation runs if there is a formula in a cell.  Thank you very much for pointing that out."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 2, "creation_date": 1540394413, "post_id": 52972043, "comment_id": 92851586, "body": "There is a worksheet calculate event."}, {"owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1540395245, "post_id": 52972043, "comment_id": 92852124, "body": "I will look into that too.  Sorry, im still relatively new to VBA and havent used the <code>Worksheet_Change</code> events or <code>Worksheet_Calculate</code> events that much yet."}], "answers": [{"tags": [], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "is_accepted": true, "score": 1, "last_activity_date": 1540399370, "creation_date": 1540399370, "answer_id": 52974148, "question_id": 52972043, "link": "https://stackoverflow.com/questions/52972043/automatic-worksheet-calculating-cell-value-change-not-working/52974148#52974148", "title": "Automatic Worksheet Calculating cell value change not working", "body": "<p>Thank you all for your ideas and assistance, but I decided to take the formulas out of the sheet.  I created a sub inside a module and then called the sub from the <code>Worksheet_Change</code> event and it works now.  I'm sure that the code could be a lot cleaner, but for now it works.</p>\n\n<p>Module Code:</p>\n\n<pre><code> Sub LTVCalcs()\n    Dim wb As Workbook\n    Dim wsSI As Worksheet, wspGen As Worksheet\n    Dim lAmount As Range, pPrice As Range, eVal As Range, oMtg As Range, oColl As Range, LTV As Range, CLTV As Range, genLTV As Range, genCLTV As Range, keyCells As Range\n    Dim x As Integer\n\n    Set wb = Application.ThisWorkbook\n    Set wsSI = wb.Sheets(\"SavedInfo\")\n    Set wspGen = wb.Sheets(\"pGeneralInfo\")\n    Set lAmount = wsSI.Range(\"Loan_Amount\")\n    Set pPrice = wsSI.Range(\"Purchase_Price\")\n    Set eVal = wsSI.Range(\"Estimated_Value\")\n    Set oMtg = wsSI.Range(\"Total_Other_Mtg\")\n    Set oColl = wsSI.Range(\"Additional_Collateral\")\n    Set LTV = wsSI.Range(\"LTV\")\n    Set CLTV = wsSI.Range(\"CLTV\")\n    Set genLTV = wspGen.Range(\"GenLTV\")\n    Set genCLTV = wspGen.Range(\"GenCLTV\")\n\n    Set keyCells = wsSI.Range(\"Loan_Amount,Purchase_Price,Estimated_Value,Total_Other_Mtg,Additional_Collateral\")\n    oMtg = Application.WorksheetFunction.Sum(wsSI.Range(\"_2nd_Mtg_Amount\"), wsSI.Range(\"_3rd_Mtg_Amount\"), wsSI.Range(\"_4th_Mtg_Amount\"), wsSI.Range(\"_5th_Mtg_Amount\"))\n\n    If lAmount = vbNullString Then lAmount = 0\n    If pPrice = vbNullString Then pPrice = 0\n    If eVal = vbnulsltring Then eVal = 0\n    If oMtg = vbNullString Or oMtg = 0 Then oMtg = 0\n    If oColl = vbNullString Then oColl = 0\n    If LTV = vbNullString Then LTV = 0\n    If CLTV = vbNullString Then CLTV = 0\n\n    If eVal &lt;= pPrice Then\n        x = 1\n    Else: x = 2\n    End If\n\n    Application.EnableEvents = False\n\n    For Each cell In keyCells\n        If cell.Value &gt;= 0 Then Application.EnableEvents = True\n            Select Case x\n                Case Is = 1\n                    LTV = lAmount / (eVal + oColl)\n                    CLTV = (lAmount + oMtg) / (eVal + oColl)\n                    LP.LTV = LTV\n                    LP.CLTV = CLTV\n                    genLTV = LTV\n                    genCLTV = CLTV\n                Case Is = 2\n                    LTV = lAmount / (pPrice + oColl)\n                    CLTV = (lAmount + oMtg) / (pPrice + oColl)\n                    LP.LTV = LTV\n                    LP.CLTV = CLTV\n                    genLTV = LTV\n                    genCLTV = CLTV\n            End Select\n    Next cell\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Code in Worksheet module:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Address = Range(\"Loan_Amount\") Then Call LTVCalcs\n    If Target.Address = Range(\"Estimated_Value\") Then Call LTVCalcs\n    If Target.Address = Range(\"Total_Other_Mtg\") Then Call LTVCalcs\n    If Target.Address = Range(\"Additional_Collateral\") Then Call LTVCalcs\n    If Target.Address = Range(\"Purchase_Price\") Then Call LTVCalcs\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 686, "user_id": 10198184, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae528abfbccfeb2b2ab4dada199237da?s=128&d=identicon&r=PG&f=1", "display_name": "Zack E", "link": "https://stackoverflow.com/users/10198184/zack-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "accepted_answer_id": 52974148, "answer_count": 1, "score": 2, "last_activity_date": 1586462704, "creation_date": 1540392745, "last_edit_date": 1586462704, "question_id": 52972043, "link": "https://stackoverflow.com/questions/52972043/automatic-worksheet-calculating-cell-value-change-not-working", "title": "Automatic Worksheet Calculating cell value change not working", "body": "<p>I am running into an issue with TextBoxes on a UserForm and also two cells on a different sheet in the same workbook updating automatically because the <code>Worksheet_Change(ByVal Target as Range)</code>is not running calculations automatically.  Below is the current code that does not work and im thinking its because of the <code>If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing</code>.  I do not have <code>Application.EnableEvents</code> anywhere that would have an effect on these cells or the TextBoxes the code below would reference.  Any assistance would be greatly appreciated.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim wb As Workbook\n    Dim wspGen As Worksheet\n    Dim KeyCells As Range, genLTV As Range, genCLTV As Range\n\n    Set KeyCells = Range(\"Loan_Amount, Estimated_Value, Purchase_Price, Total_Other_Mtg, Additional_Collateral, LTV, CLTV\")\n    Set genLTV = wspGen.Range(\"GenLTV\")\n    Set genCLTV = wspGen.Range(\"GenCLTV\")\n\n    'I believe this is looking to see if all cell values in this range have changed and not the individual cell value has changed\n    If Not Application.Intersect(KeyCells, Range(Target.Address)) Is Nothing Then  \n        genLTV = LTV\n        genCLTV = CLTV\n        LP.LTV = LTV   'Userform TextBox\n        LP.CLTV = CLTV 'Userform TextBox\n        Call LTVFormat\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1540392794, "post_id": 52971969, "comment_id": 92850452, "body": "Welcome to stack overflow. &quot;Can you help me make...&quot; is usually not a well received question on this website. Try to make a first attempt of code and post it here. We will gladly help you to make sure it works afterwards."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1540394857, "post_id": 52971969, "comment_id": 92851876, "body": "<a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}], "owner": {"reputation": 23, "user_id": 10455161, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2OjbbEiLEeU/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DVNWsibzXxQPKmXrvuqnG-p5PBmfw/mo/photo.jpg?sz=128", "display_name": "Jonas Korani", "link": "https://stackoverflow.com/users/10455161/jonas-korani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540392545, "creation_date": 1540392545, "question_id": 52971969, "link": "https://stackoverflow.com/questions/52971969/track-changes-in-column-paste-to-new-sheet-with-date-it-changed", "title": "Track changes in column paste to new sheet with date it changed", "body": "<p>Can you please help me make a VBA Script that will track Column A:B in sheet1</p>\n\n<p>If there is a change in existing values (Either A, B or Borth), or if a whole new value is added it will take the changes and posts it in sheet 2 A:B</p>\n\n<p>Sheet2 need lastrow so i always have \"Log\" of the changes and it need to paste time when the change happened.</p>\n\n<p>Thank you so much</p>\n"}, {"tags": ["excel", "vba", "syntax", "copy-paste"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1540393377, "post_id": 52971919, "comment_id": 92850845, "body": "If all those variables are numbers the paste destination amounts to something like <code>Range(2, 3:5,3 )</code> which is not valid syntax. I reckon you need <code>Cells</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8954148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8689c5648bd4e9e14f21697db5d1afe3?s=128&d=identicon&r=PG&f=1", "display_name": "OMO", "link": "https://stackoverflow.com/users/8954148/omo"}, "edited": false, "score": 0, "creation_date": 1540393674, "post_id": 52972292, "comment_id": 92851062, "body": "The new line you gave me returns an error &quot;object doesnt support this property or method&quot;"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1540394063, "post_id": 52972292, "comment_id": 92851330, "body": "<code>Pastevalues</code> is not valid syntax. You should also qualify all the cells with the sheet."}, {"owner": {"reputation": 5, "user_id": 8954148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8689c5648bd4e9e14f21697db5d1afe3?s=128&d=identicon&r=PG&f=1", "display_name": "OMO", "link": "https://stackoverflow.com/users/8954148/omo"}, "edited": false, "score": 0, "creation_date": 1540394252, "post_id": 52972292, "comment_id": 92851458, "body": "Could you please explain? I&#39;m pretty new to this...i changed the &quot;pastevalues&quot; to &quot;paste&quot; still no luck."}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 0, "creation_date": 1540394373, "post_id": 52972292, "comment_id": 92851548, "body": "Added in correct paste method. You already used With ThisWorkbook.Worksheets(&quot;TSX-CleanDate&quot;), why type it 4 times?"}, {"owner": {"reputation": 5, "user_id": 8954148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8689c5648bd4e9e14f21697db5d1afe3?s=128&d=identicon&r=PG&f=1", "display_name": "OMO", "link": "https://stackoverflow.com/users/8954148/omo"}, "edited": false, "score": 0, "creation_date": 1540394463, "post_id": 52972292, "comment_id": 92851623, "body": "I was just trying to see if the error had something to do with the page reference, it was more just a safety check."}, {"owner": {"reputation": 5, "user_id": 8954148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8689c5648bd4e9e14f21697db5d1afe3?s=128&d=identicon&r=PG&f=1", "display_name": "OMO", "link": "https://stackoverflow.com/users/8954148/omo"}, "edited": false, "score": 0, "creation_date": 1540395791, "post_id": 52972292, "comment_id": 92852474, "body": "@OwlsSleeping after pasting the data into the correct range, i&#39;m trying to remove the duplicates. I&#39;m not getting an error but the function simply doesnt do anything. I basically use the same .Range as with the PasteSpecial but i use .RemoveDuplicates and its not working."}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 0, "creation_date": 1540395902, "post_id": 52972292, "comment_id": 92852547, "body": "The duplicates part has been covered in depth on SO, try reading this: <a href=\"https://stackoverflow.com/questions/31631231/remove-duplicates-from-range-of-cells-in-excel-vba\" title=\"remove duplicates from range of cells in excel vba\">stackoverflow.com/questions/31631231/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "is_accepted": false, "score": 1, "last_activity_date": 1540394269, "last_edit_date": 1540394269, "creation_date": 1540393445, "answer_id": 52972292, "question_id": 52971919, "link": "https://stackoverflow.com/questions/52971919/paste-range-returning-syntax-error-for-variable-range/52972292#52972292", "title": "Paste Range Returning Syntax Error For Variable Range", "body": "<p>For A) Your range argument should be something like range(\"a2:b2\") rather than range(1,2:2,2)</p>\n\n<p>You can use Cells to refer to them in the way you're trying. For example </p>\n\n<pre><code>Worksheets(\"TSX-CleanDate\").Range(BottomRow2 + 1, RngY.Column + 2:originalRng + 4,RngY.Column + 2 ).PasteValues\n</code></pre>\n\n<p>Could be</p>\n\n<pre><code>Worksheets(\"TSX-CleanDate\").Range(Cells(BottomRow2 + 1, RngY.Column + 2),Cells(originalRng + 4,RngY.Column + 2)).PasteSpecial (xlPasteValues)\n</code></pre>\n\n<p>B) For duplicates, use range.removeduplicates</p>\n"}], "owner": {"reputation": 5, "user_id": 8954148, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8689c5648bd4e9e14f21697db5d1afe3?s=128&d=identicon&r=PG&f=1", "display_name": "OMO", "link": "https://stackoverflow.com/users/8954148/omo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586462740, "creation_date": 1540392404, "last_edit_date": 1586462740, "question_id": 52971919, "link": "https://stackoverflow.com/questions/52971919/paste-range-returning-syntax-error-for-variable-range", "title": "Paste Range Returning Syntax Error For Variable Range", "body": "<p>I am trying to loop through a set of columns with a list of dates that vary in size and have numerous duplicates. I want to copy the column values from     TSX-DeltaFind and paste them in TSX-CleanDate under the corresponding \"Ticker\" and to remove all duplicates once complete.</p>\n\n<p>A) Why am I getting a syntax error on the paste line?<br>\nB) How can I delete all duplicates once these paste? </p>\n\n<pre><code>Sub CleanDate()\n    Dim BottomRow As Long\n    Dim BottomRow2 As Long\n    Dim TopRow As Long\n    Dim col As Integer\n    Dim Ticker As String\n    Dim RngY As Range\n    Dim originalRng As Integer\n\n    With ThisWorkbook.Worksheets(\"TSX-DeltaFind\")\n        col = 4\n        TopRow = 6\n\n        For col = 4 To 3 + (2 * 26) Step 2\n            Ticker = .Cells(TopRow - 1, col - 2).Value\n            BottomRow = .Cells(.Rows.Count, col).End(xlUp).row\n            originalRng = BottomRow - TopRow\n\n            Worksheets(\"TSX-DeltaFind\").Range(.Cells(TopRow, col), .Cells(BottomRow, col)).Copy\n            Worksheets(\"TSX-CleanDate\").Activate\n\n            With ThisWorkbook.Worksheets(\"TSX-CleanDate\")\n                Set RngY = Worksheets(\"TSX-CleanDate\").Range(\"A3:XDF3\").Find(Ticker, lookat:=xlPart)\n                BottomRow2 = .Cells(.Rows.Count, RngY.Column).End(xlUp).row\n\n                Worksheets(\"TSX-CleanDate\").Range(BottomRow2 + 1, RngY.Column + 2:originalRng + 4,RngY.Column + 2 ).PasteValues\n            End With\n\n            Worksheets(\"TSX-DeltaFind\").Activate\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "sorting", "grouping"], "answers": [{"tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": false, "score": 0, "last_activity_date": 1540393913, "creation_date": 1540393913, "answer_id": 52972464, "question_id": 52971828, "link": "https://stackoverflow.com/questions/52971828/trying-to-sort-by-date-but-group-matching-field/52972464#52972464", "title": "Trying to sort by date, but group matching field", "body": "<p>Not having the data available to play with, this is my best attempt. Select the entire table before running the sub and it will sort on column C first, then column A.</p>\n\n<pre><code>Sub sort()\nSelection.Sort Key1:=Range(\"C2\"), Order1:=xlAscending, Key2:=Range(\"A2\") _\n        , Order2:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _\n        False, Orientation:=xlTopToBottom\nEnd Sub\n</code></pre>\n\n<p>Obviously you could hard code the range in, or use <code>usedRange</code> or pretty much any other method to choose the range.\nHope it helps</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 8669613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70928f2d55835345f7b1ef0547509710?s=128&d=identicon&r=PG&f=1", "display_name": "rondeaul", "link": "https://stackoverflow.com/users/8669613/rondeaul"}, "edited": false, "score": 1, "creation_date": 1540563475, "post_id": 52973429, "comment_id": 92924822, "body": "Thanks Donaldo.  I used a helper column with a match formula and it worked greate.  Here&#39;s what I used. =MATCH([@[Client Name]],[Client Name],0)"}], "tags": [], "owner": {"reputation": 71, "user_id": 10424962, "user_type": "registered", "profile_image": "https://graph.facebook.com/2352922924720092/picture?type=large", "display_name": "Donaldo Almazan", "link": "https://stackoverflow.com/users/10424962/donaldo-almazan"}, "is_accepted": true, "score": 0, "last_activity_date": 1540396936, "creation_date": 1540396936, "answer_id": 52973429, "question_id": 52971828, "link": "https://stackoverflow.com/questions/52971828/trying-to-sort-by-date-but-group-matching-field/52973429#52973429", "title": "Trying to sort by date, but group matching field", "body": "<p>When working on a custom sort like this, I always try to create a \"helper\" column:</p>\n\n<p>In this case I first created a reference table to rank the Clients. To do this, I copied the data to another sheet and sorted by Order Date. Then, I used Remove Duplicates (choosing only Client Name as a criteria) and finally added a new \"Rank\" column.</p>\n\n<p>After that, I added my helper column to the original table and populated with a Vlookup. Sorted by Order Date, then by Rank, and it worked!</p>\n\n<p><a href=\"https://i.stack.imgur.com/j6hd4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j6hd4.png\" alt=\"Example\"></a></p>\n\n<p>You might choose to Record a Macro to automate most of this for future tables. Hope this helped!</p>\n"}], "owner": {"reputation": 3, "user_id": 8669613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70928f2d55835345f7b1ef0547509710?s=128&d=identicon&r=PG&f=1", "display_name": "rondeaul", "link": "https://stackoverflow.com/users/8669613/rondeaul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 52973429, "answer_count": 2, "score": 0, "last_activity_date": 1540396936, "creation_date": 1540392111, "last_edit_date": 1540392203, "question_id": 52971828, "link": "https://stackoverflow.com/questions/52971828/trying-to-sort-by-date-but-group-matching-field", "title": "Trying to sort by date, but group matching field", "body": "<p>I've been all over the different questions and answers and can't seem to find one that fits my situation.</p>\n\n<p>I have a large list of data (sales orders) where we might get multiple sales orders for the same client.  I'm trying to sort the overall list by date but then group all orders for the same client together so the newer orders are brought forward with the oldest sales order for that client.  The key is we are working on clients with the oldest sales order first, so I don't simply want to sort by client and then date.  I'm not sure how to get where I need to go.  Any suggestions?</p>\n\n<p>The picture in the link below shows the current and desired output.</p>\n\n<p><img src=\"https://i.stack.imgur.com/fp5GB.jpg\" alt=\"Example of current and desired output\"></p>\n"}, {"tags": ["database", "ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 6, "creation_date": 1540392445, "post_id": 52971794, "comment_id": 92850221, "body": "There are no cells in Access. There is only ever a field and the data it contains. You can&#39;t treat Access as Excel, they are very different. I don&#39;t know of any easy way to dynamically hide a query column based on only it&#39;s data being different. What if there were different fields with different data - it wouldn&#39;t make sense."}, {"owner": {"reputation": 27, "user_id": 4698006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152966599570668/picture?type=large", "display_name": "Alfonso Ventanova", "link": "https://stackoverflow.com/users/4698006/alfonso-ventanova"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1540393678, "post_id": 52971794, "comment_id": 92851065, "body": "Yeah I know. But maybe is possible with some vba code, comparing with an if statement if both fields (TableA.Field1 and TableB.Field1) are equal, in that case use some hide properties = true. I don&#39;t know if it&#39;s possible something like that."}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1540396711, "post_id": 52971794, "comment_id": 92853072, "body": "Just imagine that Field1 changes to Value3 for ID AA1 in TableB. What do you expect to be returned? You want column Field1 be hidden because it did not change for the ID AA2. FIeld2 shall be hidden because it did not change for the ID AA1... so both columns should be hidden? You can&#39;t dynamically change the design of a query based on the records it returns."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1540407766, "post_id": 52971794, "comment_id": 92858971, "body": "You can join tables and conditionally display the value in a field with an IIf() expression. But this is not hiding a &#39;column&#39;. The header label will still display. If you don&#39;t want a &#39;column&#39; to display, don&#39;t include the field in the SELECT clause - don&#39;t use <code>*</code> wildcard to select fields, explicitly reference fields to retrieve. Or build a report and don&#39;t bind a textbox to the field."}, {"owner": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1540409102, "post_id": 52971794, "comment_id": 92859603, "body": "The examples you provide are not adequate to show what you want. What happens if you have an <code>AA3</code> record where <code>Field1</code> has an updated value? What does the result of this look like?"}, {"owner": {"reputation": 27, "user_id": 4698006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152966599570668/picture?type=large", "display_name": "Alfonso Ventanova", "link": "https://stackoverflow.com/users/4698006/alfonso-ventanova"}, "reply_to_user": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1540459376, "post_id": 52971794, "comment_id": 92876980, "body": "@WolfgangKais in that case both columns will be returned. Imagine I have a lot of columns, I wanna see the ones that has changed doesn&#39;t matter in which row"}, {"owner": {"reputation": 27, "user_id": 4698006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152966599570668/picture?type=large", "display_name": "Alfonso Ventanova", "link": "https://stackoverflow.com/users/4698006/alfonso-ventanova"}, "reply_to_user": {"reputation": 3238, "user_id": 3042438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b930cad6b909cf6546dfe29bdeb8af88?s=128&d=identicon&r=PG&f=1", "display_name": "SunKnight0", "link": "https://stackoverflow.com/users/3042438/sunknight0"}, "edited": false, "score": 0, "creation_date": 1540459452, "post_id": 52971794, "comment_id": 92877027, "body": "@SunKnight0 In the case that I have an AA3 with a Field1 with an updated value, then all the column will show up. If any of the records of that colum has changed then all the column has to be there. This is because I will have a lot of columns and only a few of them will be updated every month and I want to see which ones, even if is just in one register. I know is hard o maybe impossible, I just wanted to ask"}, {"owner": {"reputation": 3725, "user_id": 6777839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YYN3g.jpg?s=128&g=1", "display_name": "Wolfgang Kais", "link": "https://stackoverflow.com/users/6777839/wolfgang-kais"}, "edited": false, "score": 0, "creation_date": 1540462235, "post_id": 52971794, "comment_id": 92878812, "body": "You can&#39;t dynamically change the design of a query based on the records it returns."}], "owner": {"reputation": 27, "user_id": 4698006, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10152966599570668/picture?type=large", "display_name": "Alfonso Ventanova", "link": "https://stackoverflow.com/users/4698006/alfonso-ventanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1540459588, "creation_date": 1540392027, "last_edit_date": 1540459588, "question_id": 52971794, "link": "https://stackoverflow.com/questions/52971794/hide-fields-columns-in-ms-access-when-all-values-match", "title": "Hide fields/columns in MS Access when all values match", "body": "<p>What I'm trying to do is the following:</p>\n\n<p>Imagine I have 2 Tables imported from Excel. TableA and TableB as follows:</p>\n\n<pre><code>               TableA                                    TableB\n\n    ID_PK    Field1      Field2   Field3           ID_PK      Field1      Field2   Field3        \n   -------------------------------------           --------------------------------------\n     AA1     Value1      Data1    Reg1              AA1       Value1      Data1     Reg1\n     AA2     Value2      Data2    Reg2              AA2       Value2      Data5     Reg2\n     AA3     Value3      Data3    Reg3              AA3       Value3      Data3     Reg6\n</code></pre>\n\n<p>Note that there is an \"update\" for the ID AA2. Previously in Field2 it was Data2 and now in the TableB it is Data5.</p>\n\n<p>First of all I want to show only the row that has changed. I created this query and it works:</p>\n\n<pre><code>SELECT TableB.*\nFROM TableB \nINNER JOIN TableA ON TableB.ID_PK = TableA.ID_PK\nWHERE \nStrComp([TableB].[Field2],[TableA].[Field2]) Is Null Or\nStrComp([TableB].[Field2],[TableA].[Field2])&lt;&gt;0;\n</code></pre>\n\n<p>I get this:</p>\n\n<pre><code>                TableA\n\n    ID_PK      Field1      Field2      Field3\n   -------------------------------------------\n     AA2       Value2      Data2        Reg2\n     AA3       Value3      Data3        Reg3\n</code></pre>\n\n<p>My problem now is that I would like to HIDE the column that has not change. \nSo, the ouptut would be like this:</p>\n\n<pre><code>                TableA\n\n    ID_PK      Field2    Field3\n   ------------------------------\n     AA2       Data2     Reg2\n     AA3       Data3     Reg3\n</code></pre>\n\n<p>I know I can do it manually, but in the case that I have a lot of columns and rows it has to be automatic (maybe with vba code)</p>\n\n<p>The ideal option, but I do not think is posible with MS Access, is to show the full TableB and highlight the cell that has changed.</p>\n\n<p>Any help would be nice!</p>\n\n<p>Thank you!!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540392214, "post_id": 52971737, "comment_id": 92850050, "body": "A good starting point would be <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">The VBA Guide To ListObject Excel Tables</a>. Give it a try on your own and come back with your code telling where you got stuck or errors."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1540392600, "post_id": 52971737, "comment_id": 92850323, "body": "Here is some Suggested Reading: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.min\" rel=\"nofollow noreferrer\"><code>WorksheetFunction.Min</code></a>, <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction.match\" rel=\"nofollow noreferrer\"><code>WorksheetFunction.Match</code></a>, <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.cells\" rel=\"nofollow noreferrer\"><code>Worksheet.Cells</code></a>, <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.end\" rel=\"nofollow noreferrer\"><code>Range.End</code></a>, and <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.value\" rel=\"nofollow noreferrer\"><code>Range.Value</code></a> or <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.copy\" rel=\"nofollow noreferrer\"><code>Range.Copy</code></a>"}, {"owner": {"reputation": 3, "user_id": 10539873, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PMO5E49gFQA/AAAAAAAAAAI/AAAAAAAAABY/x1gJSqt8h6M/photo.jpg?sz=128", "display_name": "Bernard Dadie", "link": "https://stackoverflow.com/users/10539873/bernard-dadie"}, "edited": false, "score": 0, "creation_date": 1540395037, "post_id": 52971737, "comment_id": 92852001, "body": "I&#39;ve edited my answer, after trying several times"}], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1540393610, "post_id": 52972138, "comment_id": 92851020, "body": "Note that tables are no worksheets. So it is recommended to access them via <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">ListObject</a> instead of directly accessing the <code>Worksheet.Range</code>."}], "tags": [], "owner": {"reputation": 80, "user_id": 10110696, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa0155497e74eedf632c64611a27d0fe?s=128&d=identicon&r=PG&f=1", "display_name": "Random_dude", "link": "https://stackoverflow.com/users/10110696/random-dude"}, "is_accepted": false, "score": 2, "last_activity_date": 1540393006, "creation_date": 1540393006, "answer_id": 52972138, "question_id": 52971737, "link": "https://stackoverflow.com/questions/52971737/find-min-value-and-paste-in-at-the-end-of-a-table-vba/52972138#52972138", "title": "Find Min Value and paste in at the end of a table VBA", "body": "<p>Let's say your table 1 is on columns A and B and table 2 on columns D and E. Should be something like this:</p>\n\n<pre><code>With ActiveSheet\n    .Range(\"A\" &amp; .Cells(Rows.Count, 1).End(xlUp).Row + 1).Value = .Range(\"D\" &amp; Application.Match(Application.Min(.Range(\"E:E\")), .Range(\"E:E\"), 0))\nEnd With\n</code></pre>\n\n<p>Note: I used \"Range\" so you could easily edit the columns.</p>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1540818838, "creation_date": 1540818838, "answer_id": 53046286, "question_id": 52971737, "link": "https://stackoverflow.com/questions/52971737/find-min-value-and-paste-in-at-the-end-of-a-table-vba/53046286#53046286", "title": "Find Min Value and paste in at the end of a table VBA", "body": "<p>This code will take 2 <code>ListObject</code>s, then find the Minimum value in a given column of the First (defaults to Column 2) and paste the First Row with that value to the bottom of the Second <code>ListObject</code>.</p>\n\n<p>It also features a <code>ShowDebug</code> option, which will list the objects and variables as it goes, to make it easier to track down any errors you may encounter.</p>\n\n<pre><code>Sub CopyMinRow(TableFrom As ListObject, TableTo As ListObject, Optional MatchColumn As Long = 2, Optional ShowDebug As Boolean = False)\n    Dim MinVal As Variant, MatchRow As Variant\n\n    If ShowDebug Then\n        Debug.Print \"TableFrom = \" &amp; TableFrom.Name\n        Debug.Print \"    \" &amp; TableFrom.Range.Address(True, True, xlA1, True)\n        Debug.Print \"TableTo = \" &amp; TableTo.Name\n        Debug.Print \"    \" &amp; TableTo.Range.Address(True, True, xlA1, True)\n    End If\n\n    'Find the Min Value\n    MinVal = WorksheetFunction.Min(TableFrom.Range.Columns(MatchColumn))\n    If ShowDebug Then Debug.Print \"MinVal = \" &amp; MinVal\n\n    If Not IsError(MinVal) Then\n        'Finds the first row that the MinVal appears on\n        MatchRow = WorksheetFunction.Match(MinVal, TableFrom.Range.Columns(MatchColumn), 0)\n        If ShowDebug Then Debug.Print \"MatchRow = \" &amp; MatchRow\n\n        If Not IsError(MatchRow) Then\n            If ShowDebug Then Debug.Print \"Copy: \" &amp; TableFrom.Range.Rows(MatchRow).Address(True, True, xlA1)\n            If ShowDebug Then Debug.Print \"Dest: \" &amp; TableTo.Range.Rows(TableTo.Range.Rows.Count + 1).Address(True, True, xlA1)\n            'Copy data to bottom of other table\n            TableFrom.Range.Rows(MatchRow).Copy Destination:= _\n                TableTo.Range.Cells(TableTo.Range.Rows.Count, 1).Offset(1, 0)\n        End If\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10539873, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PMO5E49gFQA/AAAAAAAAAAI/AAAAAAAAABY/x1gJSqt8h6M/photo.jpg?sz=128", "display_name": "Bernard Dadie", "link": "https://stackoverflow.com/users/10539873/bernard-dadie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1586462775, "creation_date": 1540391883, "last_edit_date": 1586462775, "question_id": 52971737, "link": "https://stackoverflow.com/questions/52971737/find-min-value-and-paste-in-at-the-end-of-a-table-vba", "title": "Find Min Value and paste in at the end of a table VBA", "body": "<p>I have a sheet with 2 tables.\nBoth table have 2 columns but table2 has a column(2) with integers values.\nI want a piece of code that takes the minimum value of table2 column(2) and paste table2 Column(1) at the bottom of table(1).</p>\n\n<p>Basically, the code will analyse table2, by finding the minimum value and will paste the column1 of table 2 at the bottom of table column1. (Table2 stays the same, while table1 increases).</p>\n\n<p>I have no clue how to approach the problem. I have tried something but it does not work (See DOES NOT WORK in code). It somehow give me the result which is not the lowest. Am I missing something ?</p>\n\n<pre><code>Sub ssNewJoinerM()\n\nDim YesOrNoAnswerToMessageBox As String\nDim QuestionToMessageBox As String\n\n    QuestionToMessageBox = \"Do you want to add someone to a Hub ?\"\n\n    YesOrNoAnswerToMessageBox = MsgBox(QuestionToMessageBox, vbYesNo, \"New joiner Process\")\n\nIf YesOrNoAnswerToMessageBox = vbYes Then\n    GoTo Start\n    Else: GoTo Finish\nEnd If\n' Double check if the user wants to start the process of adding a new employee to a Hub. If yes, start the Macro. If No, Finish now.\n\nStart:\n\n\nDim ws1 As Worksheet\nDim ws2 As Worksheet\nDim ws3 As Worksheet\nDim ws4 As Worksheet\nDim ws5 As Worksheet\nDim ws6 As Worksheet\nDim ws7 As Worksheet\nDim ws8 As Worksheet\n\nSet ws1 = ActiveSheet\nSet ws2 = ActiveSheet\nSet ws3 = ActiveSheet\nSet ws4 = ActiveSheet\nSet ws5 = ActiveSheet\nSet ws6 = ActiveSheet\nSet ws7 = ActiveSheet\nSet ws8 = ActiveSheet\n\nSet ws1 = ThisWorkbook.Sheets(\"Monthly Movements\")\nSet ws2 = ThisWorkbook.Sheets(\"Howard-Marle Hub\")\nSet ws3 = ThisWorkbook.Sheets(\"Bernard Hub\")\nSet ws4 = ThisWorkbook.Sheets(\"Thomas Hub\")\nSet ws5 = ThisWorkbook.Sheets(\"Michael Hub\")\nSet ws6 = ThisWorkbook.Sheets(\"Oliver Hub\")\nSet ws7 = ThisWorkbook.Sheets(\"Lance Hub\")\nSet ws8 = ThisWorkbook.Sheets(\"John Hub\")\n\nDim table1 As ListObject\nDim table2 As ListObject\nDim table3 As ListObject\nDim table4 As ListObject\nDim table5 As ListObject\nDim table6 As ListObject\nDim table7 As ListObject\nDim table8 As ListObject\nDim table9 As ListObject\nDim table10 As ListObject\nDim table11 As ListObject\nDim table12 As ListObject\nDim table13 As ListObject\nDim table14 As ListObject\nDim table15 As ListObject\n\nSet table1 = ws2.ListObjects(\"Table1\")\nSet table2 = ws2.ListObjects(\"Table2\")\nSet table3 = ws1.ListObjects(\"Table3\")\nSet table4 = ws3.ListObjects(\"Table4\")\nSet table5 = ws3.ListObjects(\"Table5\")\nSet table6 = ws4.ListObjects(\"Table6\")\nSet table7 = ws4.ListObjects(\"Table7\")\nSet table8 = ws5.ListObjects(\"Table8\")\nSet table9 = ws5.ListObjects(\"Table9\")\nSet table10 = ws6.ListObjects(\"Table10\")\nSet table11 = ws6.ListObjects(\"Table11\")\nSet table12 = ws7.ListObjects(\"Table12\")\nSet table13 = ws7.ListObjects(\"Table13\")\nSet table14 = ws8.ListObjects(\"Table14\")\nSet table15 = ws8.ListObjects(\"Table15\")\n\n' Declaration of my objects (tables, worksheets etc..)\n\nDim NewJoiner As String\nNewJoiner = InputBox(\"Enter new joiner name in the following format (Surname, First Name)\", \"Adding New Joiner to Hub\")\nDim Position As String\nPosition = InputBox(\"Enter new joiner Position (A, C, SC, PC, MP, Partner, Admin, Analyst, Director)\", \"Assigning New Joiner to a position\")\n'Input Name and Position and stores it (Could be improved with user form...)\n\n\nIf Position = \"\" Or NewJoiner = \"\" Then\n    GoTo StringEmpty\n    Else: GoTo StringNotEmpty\nEnd If\n'If Position or NewJoiner name are empty, end the process. Otherwise continue\n\nStringNotEmpty:\n\n\nDim tbl As ListObject\nDim sht As Worksheet\nDim MyTable As ListObject\n\n'Loop through each sheet and table in the workbook\nFor Each sht In ThisWorkbook.Worksheets\n    For Each tbl In sht.ListObjects 'loop through all tables\n        'To omit certain tables you can do the below\n        If tbl.Name &lt;&gt; \"Table2\" And tbl.Name &lt;&gt; \"Table3\" And tbl.Name &lt;&gt; \"Table5\" And tbl.Name &lt;&gt; \"Table7\" _\n        And tbl.Name &lt;&gt; \"Table9\" And tbl.Name &lt;&gt; \"Table11\" And tbl.Name &lt;&gt; \"Table13\" And tbl.Name &lt;&gt; \"Table15\" And tbl.Name &lt;&gt; \"Table16\" Then\n            If MyTable Is Nothing Then\n                Set MyTable = tbl 'set the table if not previously set\n                Set MyWorksheet = sht 'set the worksheet if not previously set\n            ElseIf tbl.ListRows.Count &lt; MyTable.ListRows.Count Then   'if table rows is smaller than previously set one, reset\n                Set MyTable = tbl\n                Set MyWorksheet = sht\n            End If\n        End If\n    Next tbl\nNext sht\n\n'DOES Not WORK\nDim Coach As String\nDim ws As Worksheet, t As ListObject, r As Long\n\n    For Each t In MyWorksheet.ListObjects\n        Select Case t.Name\n            Case \"Table1\", \"Table3\", \"Table4\", \"Table6\", \"Table8\", \"Table10\", \"Table12\", \"Table14\", \"Table16\"\n                'do nothing\n            Case Else\n                For r = t.DataBodyRange.Rows.Count To 1 Step -1\n                    If t.DataBodyRange(r, 2) &lt;= t.DataBodyRange(r + 1, 2) Then\n                    Coach = t.DataBodyRange(r, 1)\n                    End If\n                Next r\n        End Select\n    Next t\n\n\n' Adds the NewJoiner to the Hub with least members as long as the Hub as less than 50 employees\nIf MyTable.ListRows.Count &lt;= 50 Then\n        Set newrow1 = MyTable.ListRows.Add\n        With newrow1\n             .Range(1) = NewJoiner\n             .Range(2) = Position\n             .Range(3) = Coach\n        End With\n'Populates the monthly movemement tab with relevant information as long as the Hub as less than 50 employees\n        Set newrow2 = table3.ListRows.Add\n        With newrow2\n              .Range(1) = NewJoiner\n              .Range(2) = Position\n              .Range(3) = MyWorksheet.Name\n        End With\n\n\n'Informative message for End-User as long as the Hub as less than 50 employees (Which Hub the NewJoiner has been added to)\nMsgBox (NewJoiner + \" has been added to the \" + MyWorksheet.Name + \".\" &amp; vbNewLine &amp; vbNewLine &amp; \"Its details can be seen on the monthly movements tab.\")\n' If all the HUBS have more than 50 members, the programme does not  do anaything and ask for the creation of a New Hub\nElse: MsgBox (\" All the Hubs have more than 50 members !\" &amp; vbNewLine &amp; vbNewLine &amp; \" A new hub needs to be created.\")\n\nEnd If\n\nFinish:\nStringEmpty:\n'MsgBox (\" You have not entered a Name or a Position for the new joiner !\")\n\nEnd Su\n</code></pre>\n\n<p>b</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10552055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3938f3b503da2845d41e2046f9d68e86?s=128&d=identicon&r=PG&f=1", "display_name": "BillPayroll", "link": "https://stackoverflow.com/users/10552055/billpayroll"}, "edited": false, "score": 0, "creation_date": 1540485782, "post_id": 52981960, "comment_id": 92893579, "body": "Art, I copied your code and ran it.  It ran without errors, but no results appeared at J1 or anywhere else.  Thoughts?"}, {"owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "reply_to_user": {"reputation": 1, "user_id": 10552055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3938f3b503da2845d41e2046f9d68e86?s=128&d=identicon&r=PG&f=1", "display_name": "BillPayroll", "link": "https://stackoverflow.com/users/10552055/billpayroll"}, "edited": false, "score": 0, "creation_date": 1540505612, "post_id": 52981960, "comment_id": 92902288, "body": "If you put a breakpoint on the last line (Value =) and look at the local values, what do you see in arrResult?"}, {"owner": {"reputation": 1, "user_id": 10552055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3938f3b503da2845d41e2046f9d68e86?s=128&d=identicon&r=PG&f=1", "display_name": "BillPayroll", "link": "https://stackoverflow.com/users/10552055/billpayroll"}, "edited": false, "score": 0, "creation_date": 1540818288, "post_id": 52981960, "comment_id": 92991643, "body": "<code>Sheets(&quot;TestJobs&quot;).Range(&quot;J1&quot;).Resize(UBound(arrResult, 2) - LBound(arrResult, 2) + 1, _     UBound(arrResult, 1) - LBound(arrResult, 1) + 1).Value = WorksheetFunction.Transpose(arrResult)</code>"}, {"owner": {"reputation": 1, "user_id": 10552055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3938f3b503da2845d41e2046f9d68e86?s=128&d=identicon&r=PG&f=1", "display_name": "BillPayroll", "link": "https://stackoverflow.com/users/10552055/billpayroll"}, "edited": false, "score": 0, "creation_date": 1540819315, "post_id": 52981960, "comment_id": 92992253, "body": "Having trouble replying &amp; editing. Sorry.   <code>Sheets(&quot;TestJobs&quot;).Range(&quot;J1&quot;).Resize(UBound(arrResult, 2) - LBound(arrResult, 2) + 1, _     UBound(arrResult, 1) - LBound(arrResult, 1) + 1).Value = WorksheetFunction.Transpose(arrResult)</code>  When I hover on the first UBound I receive:  UBound(arrResult, 2) = 1.  When I hover on the first LBound I receive:  LBound(arrResult, 2) = 1.  At the second UBound I receive: UBound(arrResult, 1) = 6.  At the second LBound I receive LBound(arrResult, 1) = 1.  When I hover over each arrResult, including the last one in the line of code, I receive no response."}, {"owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "reply_to_user": {"reputation": 1, "user_id": 10552055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3938f3b503da2845d41e2046f9d68e86?s=128&d=identicon&r=PG&f=1", "display_name": "BillPayroll", "link": "https://stackoverflow.com/users/10552055/billpayroll"}, "edited": false, "score": 0, "creation_date": 1540865031, "post_id": 52981960, "comment_id": 93011915, "body": "So, the upper and lower second dimensions are the same size, indicating no matching data is being found.  Does the data you see in ClientJob and JobInfo match your sheet?  Are The client and job numbers in the first two columns?"}], "tags": [], "owner": {"reputation": 116, "user_id": 5982062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HFQvV.jpg?s=128&g=1", "display_name": "wallyeye", "link": "https://stackoverflow.com/users/5982062/wallyeye"}, "is_accepted": false, "score": 0, "last_activity_date": 1540445665, "creation_date": 1540445665, "answer_id": 52981960, "question_id": 52971726, "link": "https://stackoverflow.com/questions/52971726/multiple-values-returned-from-multiple-criteria/52981960#52981960", "title": "Multiple values returned from multiple criteria", "body": "<p>You are missing a loop.  Also, I prefer to grab the data and work with it in memory rather than going back and forth to the sheet.  Try this out:</p>\n\n<p>Option Explicit</p>\n\n<p>Sub MultiLookup()</p>\n\n<p>Dim arrClientJob As Variant\nDim arrJobInfo   As Variant\nDim arrResult    As Variant</p>\n\n<p>Dim lngLastRow   As Long\nDim intClient    As Integer\nDim intJobInfo   As Integer\nDim intCol       As Integer</p>\n\n<p>'everything on one sheet if possible</p>\n\n<pre><code>On Error Resume Next\nlngLastRow = Sheets(\"TestJobs\").Range(\"A:A\").Find( _\n    What:=\"*\", After:=Sheets(\"TestJobs\").Range(\"A1\"), _\n    MatchCase:=False, _\n    LookAt:=xlPart, LookIn:=xlValues, _\n    SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Row\nIf Err &lt;&gt; 0 Then\n    lngLastRow = 0\n    Err.Clear\nEnd If\n\nIf lngLastRow &gt; 1 Then\n    arrClientJob = Sheets(\"TestJobs\").Range(\"A2\").Resize(lngLastRow - 1, 2).Value\nElse\n    MsgBox \"No client data, exiting\", vbOKOnly\nEnd If\n\nlngLastRow = Sheets(\"TestJobs\").Range(\"C:C\").Find( _\n    What:=\"*\", After:=Sheets(\"TestJobs\").Range(\"C1\"), _\n    MatchCase:=False, _\n    LookAt:=xlPart, LookIn:=xlValues, _\n    SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Row\nIf Err &lt;&gt; 0 Then\n    lngLastRow = 0\n    Err.Clear\nEnd If\n\nIf lngLastRow &gt; 1 Then\n    arrJobInfo = Sheets(\"TestJobs\").Range(\"C2\").Resize(lngLastRow - 1, 6).Value\nElse\n    MsgBox \"No ClientJob info found, exiting\", vbOKOnly\nEnd If\n\nReDim arrResult(LBound(arrJobInfo, 2) To UBound(arrJobInfo, 2), 1 To 1)\n\nFor intClient = LBound(arrClientJob, 1) To UBound(arrClientJob, 1)\n    For intJobInfo = LBound(arrJobInfo, 1) To UBound(arrJobInfo, 1)\n        If arrClientJob(intClient, 1) = arrJobInfo(intJobInfo, 1) _\n        And arrClientJob(intClient, 2) = arrJobInfo(intJobInfo, 2) Then\n            If arrResult(LBound(arrResult, 1), LBound(arrResult, 2)) &gt; \"\" Then\n                ReDim Preserve arrResult(LBound(arrResult, 1) To UBound(arrResult, 1), _\n                    LBound(arrResult, 2) To UBound(arrResult, 2) + 1)\n            End If\n            For intCol = LBound(arrJobInfo, 2) To UBound(arrJobInfo, 2)\n                arrResult(intCol, UBound(arrResult, 2)) = arrJobInfo(intJobInfo, intCol)\n            Next intCol\n        End If\n    Next intJobInfo\nNext intClient\n\nSheets(\"TestJobs\").Range(\"J1\").Resize(UBound(arrResult, 2) - LBound(arrResult, 2) + 1, _\n    UBound(arrResult, 1) - LBound(arrResult, 1) + 1).Value = WorksheetFunction.Transpose(arrResult)\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 1, "user_id": 10552055, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3938f3b503da2845d41e2046f9d68e86?s=128&d=identicon&r=PG&f=1", "display_name": "BillPayroll", "link": "https://stackoverflow.com/users/10552055/billpayroll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540445665, "creation_date": 1540391831, "last_edit_date": 1540391982, "question_id": 52971726, "link": "https://stackoverflow.com/questions/52971726/multiple-values-returned-from-multiple-criteria", "title": "Multiple values returned from multiple criteria", "body": "<p>I am trying to adapt the code found on this site at this link.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/49903793/return-multiple-rows-of-data-in-vba\">Return multiple rows of data in vba</a></p>\n\n<p>I am needing to look at the info in columns A and B, then pull the matching records based on A and B from columns C thru H. </p>\n\n<p>There will be multiple matches due to the job being worked on multiple dates.  </p>\n\n<p>To learn and understand what's happening, I am trying to build code one column at a time. What I have so far runs w/o errors, but all I receive is the value 1000 in J2.  I am not receiving 4172633414. Also, I do not know if J2 has the value from cell A2 or C2. Only gives the one value of 1000 instead of looping through all entries in columns A and B. In real life, columns A and B have 124 records, columns C thru H have 8,673 entries to select from. </p>\n\n<p>I am hopeful that I am not too far off with my coding attempt. Posting the spreadsheet info was a challenge so I am hoping that it is readable. Thank you in advance.</p>\n\n<p>Columns A and C have the header CNumber. B and D are JobNumber. E thru H are Hours, Units, Date, Branch respectively. This is a very abbreviated showing of what I have to work with.</p>\n\n<pre><code>CNumber JobNumber   CNumber JobNumber Hours Units   Date    Branch  \n1000    4172633414  1000    1955126105  575 100 7/19/2018   3  \n1002    1463149151  1000    1955126105  600 144 7/20/2018   3  \n1004    1955126105  1000    1955126105  200 2.5 6/25/2018   3  \n1005    90999997    1000    4172633414  575 675 7/9/2018    3  \n1007    3965310303  1000    4172633414  100 5   7/10/2018   3  \n1008    1463149151  1002    381134312   300 46  6/29/2018   3  \n1011    3163689368  1002    382309308   575 88  8/22/2018   3  \n1012    3965310303  1002    1013397112  600 139 9/21/2018   3  \n1013    1955126105  1002    1463149151  300 71  6/29/2018   3  \n1016    1463149151  1002    1463149151  575 60  7/2/2018    3  \n1017    1463149151  1002    1463149151  375 77  7/5/2018    3  \n1018    1463149151  1004    1955126105  575 7.25 6/25/2018  3  \n</code></pre>\n\n<p>Below is the very abbreviated result I am looking for. Since CNumber 1000 has JobNumber 4172633414 above in columns A and B. He has 2 matching entries in C and D and related info below. CNumber 1002 has JobNumber 1463149151 above and has 3 matching entries below.  </p>\n\n<pre><code>CNumber JobNumber   Hours Units Date    Branch  \n1000    4172633414  575 675 7/9/2018    3  \n1000    4172633414  100 5   7/10/2018   3  \n1002    1463149151  300 71  6/29/2018   3  \n1002    1463149151  575 60  7/2/2018    3  \n1002    1463149151  375 77  7/5/2018    3  \n1004    1955126105  575 7.25 6/25/2018  3  \n1004    1955126105  575 5   6/26/2018   3  \n1005    90999997    575     6/25/2018   3  \n1005    90999997    250     6/26/2018   3 \n</code></pre>\n\n<hr>\n\n<pre><code>Sub MultiLookup()\nDim RowNumber, ClientCount As Integer\nDim ClientNumber() As Variant\nDim JobNumber() As Variant\nDim i As Integer\nRowNumber = 0\nClientCount = 0\n'everything on one sheet if possible\nSheets(\"TestJobs\").Activate 'sheet name with all info\nRange(\"A2\").Activate\n\nDo While ActiveCell.Offset(RowNumber) &lt;&gt; \"\"\n    If ActiveCell.Offset(RowNumber) = ActiveCell.Offset(RowNumber, 2) _\n        And ActiveCell.Offset(RowNumber, 1) = ActiveCell.Offset(RowNumber, 3) Then\n\n        ClientCount = ClientCount + 1\n        ReDim Preserve ClientNumber(ClientCount + 1)\n        ReDim Preserve JobNumber(ClientCount + 1)\n\n        ClientNumber(ClientCount) = ActiveCell.Offset(RowNumber, 2)\n        JobNumber(ClientCount) = ActiveCell.Offset(RowNumber, 3)\n    End If\n    RowNumber = RowNumber + 1\nLoop\n\nRange(\"J1\").Activate  'beginning cell to receive info (with row offset to J2), _\n        but need J thru O\n'Range(\"J1:K1\").Activate 'this activates the two cells but no info appears _\n    and does not offset to row 2.\n\nFor i = 0 To UBound(ClientNumber)\n    ActiveCell.Offset(i) = ClientNumber(i)\nNext i\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 195, "user_id": 10414921, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o7DRr9Yj9iQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUWFKIbOgOHsrqmpkOE5s6UJlvDAA/mo/photo.jpg?sz=128", "display_name": "Garry W", "link": "https://stackoverflow.com/users/10414921/garry-w"}, "edited": false, "score": 0, "creation_date": 1540392187, "post_id": 52971626, "comment_id": 92850027, "body": "Perhaps Sheet1 isn&#39;t currently active?  <code>Worksheets(&quot;Sheet1&quot;).Activate</code>. I question your need to actually &quot;Select&quot; this range though. Why just select a range at all? That&#39;s something a human does, your VBA probably doesn&#39;t need to."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 3, "last_activity_date": 1540391571, "creation_date": 1540391571, "answer_id": 52971626, "question_id": 52971542, "link": "https://stackoverflow.com/questions/52971542/selecting-a-range-using-variable/52971626#52971626", "title": "Selecting a range using variable", "body": "<p>You must qualify your <code>Cells()</code> otherwise you are saying \"The cells in whatever worksheet is currently active\", which doesn't make sense inside of <code>Worksheeets(\"Sheet1\").Range()</code></p>\n\n<pre><code>Worksheets(\"Sheet1\").range(Worksheets(\"Sheet1\").Cells(10, col_ref),Worksheets(\"Sheet1\").cells(20,col_ref)).Select\n</code></pre>\n\n<p>Consider, instead doing this like:</p>\n\n<pre><code>Worksheets(\"Sheet1\").Cells(10, col_ref).Resize(10).Select\n</code></pre>\n\n<p>Essentially resizing the single cell 10 more rows (down to 20). </p>\n"}, {"comments": [{"owner": {"reputation": 195, "user_id": 10414921, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o7DRr9Yj9iQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUWFKIbOgOHsrqmpkOE5s6UJlvDAA/mo/photo.jpg?sz=128", "display_name": "Garry W", "link": "https://stackoverflow.com/users/10414921/garry-w"}, "edited": false, "score": 0, "creation_date": 1540392000, "post_id": 52971635, "comment_id": 92849872, "body": "Now it&#39;s telling me &quot;Select method of range class failed&quot;"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 3, "last_activity_date": 1540392163, "last_edit_date": 1540392163, "creation_date": 1540391590, "answer_id": 52971635, "question_id": 52971542, "link": "https://stackoverflow.com/questions/52971542/selecting-a-range-using-variable/52971635#52971635", "title": "Selecting a range using variable", "body": "<p>You need to apply the parantage to the Cells() inside the Range.:</p>\n\n<pre><code>Worksheets(\"Sheet1\").range(Worksheets(\"Sheet1\").Cells(10, col_ref),Worksheets(\"Sheet1\").cells(20,col_ref)).Select\n</code></pre>\n\n<p>or use with to shorten:</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    .range(.Cells(10, col_ref),.cells(20,col_ref)).Select\nEnd with\n</code></pre>\n\n<hr>\n\n<p>Note I assume this is for practice, the selecting of a range to do something to it is wasted energy, simply do what you want to the range.</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    .range(.Cells(10, col_ref),.cells(20,col_ref)).copy Worksheets(\"Sheet2\").Range(\"A1\")\nEnd with\n</code></pre>\n\n<p>If you want to actually select the range then the sheet must be active:</p>\n\n<pre><code>With Worksheets(\"Sheet1\")\n    .Activate\n    .range(.Cells(10, col_ref),.cells(20,col_ref)).Select\nEnd with\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 10414921, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-o7DRr9Yj9iQ/AAAAAAAAAAI/AAAAAAAAAAA/AAN31DUWFKIbOgOHsrqmpkOE5s6UJlvDAA/mo/photo.jpg?sz=128", "display_name": "Garry W", "link": "https://stackoverflow.com/users/10414921/garry-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 52971626, "answer_count": 2, "score": 0, "last_activity_date": 1540392163, "creation_date": 1540391352, "last_edit_date": 1540391504, "question_id": 52971542, "link": "https://stackoverflow.com/questions/52971542/selecting-a-range-using-variable", "title": "Selecting a range using variable", "body": "<p>The following code gives me an \"Application defined or object defined error\"</p>\n\n<pre><code>Sub Apply_Changes()\n    Dim col_ref As Integer\n    col_ref = 5\n    Worksheets(\"Sheet1\").range(Cells(10, col_ref),cells(20,col_ref)).Select\nEnd Sub\n</code></pre>\n\n<p>Could someone explain?</p>\n\n<p>Is there another way of defining the range?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 3, "creation_date": 1540390999, "post_id": 52971268, "comment_id": 92849169, "body": "Read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba/10717999#10717999\">this answer</a> to learn how to avoid <code>Select</code> and <code>Activate</code>. That will help you avoid the problem you&#39;re having I think."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1540392090, "creation_date": 1540392090, "answer_id": 52971818, "question_id": 52971268, "link": "https://stackoverflow.com/questions/52971268/vba-copy-past-rename-copy-past-and-runs-through-each-column/52971818#52971818", "title": "VBA Copy, Past, Rename, Copy past and runs through each column", "body": "<p>It is highly recommended to avoid using <code>.Select</code>, <code>.Activate</code> or similar actions.<br>\nSee <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n\n<p>Also always specify in which worksheet or workbook a range is. Otherwise Excel cannot know it and guesses.</p>\n\n<pre><code>Option Explicit\n\nSub Copy_Past_Repeat()\n    Dim rng As Range\n    Set rng = Workbooks(\"Customer.xlsm\").Range(\"N1:N1000\")   'column\n\n    rng.SpecialCells(xlCellTypeConstants).Copy   'Copy only hardcoded data\n\n    Dim NewWs As Worksheet\n    With Workbooks(\"Supplier.xlsm\")\n        Set NewWs = .Sheets.Add(After:=.ActiveSheet) 'remember the new added sheet in NewWs so we can access it later \n        NewWs.Range(\"C2\").Paste\n        NewWs.Name = NewWs.Range(\"C2\")\n\n        ThisWorkbook.Worksheets(\"Template\").Range(\"A1:E1\").Copy\n\n        NewWs.Paste 'should be pasted in just crated spreadsheet Name=(C2)\n        'here you should specify where in the sheet to paste\n        'NewWs.Range(\"A1\").Paste\n    End With\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 7546549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4fb4cf58e43fd227956a15c8007069ac?s=128&d=identicon&r=PG&f=1", "display_name": "Jam_Jam", "link": "https://stackoverflow.com/users/7546549/jam-jam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1586462811, "creation_date": 1540390613, "last_edit_date": 1586462811, "question_id": 52971268, "link": "https://stackoverflow.com/questions/52971268/vba-copy-past-rename-copy-past-and-runs-through-each-column", "title": "VBA Copy, Past, Rename, Copy past and runs through each column", "body": "<p>I am trying to build a vba code.  Some bits are working some not.  Working: It is collecting valued cells from Customers workbook and pasting in new sheet in supplier workbook. New sheet is renamed on cell name.  Not working: I also want to copy a header which is in Supplier workbook named as template.  The last bit i want VBA code run through each column. </p>\n\n<pre><code>Sub Copy_Past_Repeat()\n\nDim rs As Worksheet\nDim rng As Range\n    Windows(\"Customer.xlsm\").Activate\n    Set rng = Range(\"n1:n1000\")   'column\n    rng.SpecialCells(xlCellTypeConstants).Select   'Selecting only hardcoded data\n   Selection.Copy\n   Windows(\"Supplier.xlsm\").Activate\n   Sheets.Add after:=ActiveSheet\n   Range(\"C2\").Select\n    ActiveSheet.Paste\n     ActiveSheet.Name = ActiveSheet.Range(\"C2\")\n\n  'not working\n   ThisWorkbook.Sheets(\"Template\").Range(\"A1:E1\").Select\n    Selection.Copy\n\n   ActiveSheet.Paste 'should be pasted in just crated spreadsheet Name=(C2)\n   Application.CutCopyMode = False\n\n  End Sub `\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1540390716, "post_id": 52970921, "comment_id": 92848938, "body": "Signatures are per file not per sheet. So you must split the 3 sheets into 3 files."}, {"owner": {"reputation": 33, "user_id": 8914514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d1e754bfa4daee224e5cf683a79c653?s=128&d=identicon&r=PG&f=1", "display_name": "sorin", "link": "https://stackoverflow.com/users/8914514/sorin"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540390807, "post_id": 52970921, "comment_id": 92849009, "body": "I would rather not split them. I used 3 as an example, but there are close to 20 sheets and it is very tedious to have 20 working documents. I am asking how to make them per sheet instead of per file. I am aware that it is not a built-in solution and it will require some code. I am looking for a reference on where to begin on this, thank you."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1540390870, "post_id": 52970921, "comment_id": 92849067, "body": "No, that requires Microsoft to change Excel. You cannot change that."}, {"owner": {"reputation": 33, "user_id": 8914514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d1e754bfa4daee224e5cf683a79c653?s=128&d=identicon&r=PG&f=1", "display_name": "sorin", "link": "https://stackoverflow.com/users/8914514/sorin"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540391123, "post_id": 52970921, "comment_id": 92849269, "body": "I have heard of the solution being produced in VBA using custom signatures, but it is a 20,000 lines VBA project, I just want a reference on how to begin. It is ok if you don&#39;t have the answer."}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 8914514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d1e754bfa4daee224e5cf683a79c653?s=128&d=identicon&r=PG&f=1", "display_name": "sorin", "link": "https://stackoverflow.com/users/8914514/sorin"}, "edited": false, "score": 0, "creation_date": 1540392179, "post_id": 52971420, "comment_id": 92850019, "body": "I am more looking for a custom signature rather than excel&#39;s built in signature. The answer is appreciated though."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 0, "last_activity_date": 1540391007, "creation_date": 1540391007, "answer_id": 52971420, "question_id": 52970921, "link": "https://stackoverflow.com/questions/52970921/excel-signature-per-sheet/52971420#52971420", "title": "excel signature per sheet", "body": "<p>This does not work because signing Excel files is a built in Excel feature that is designed by Microsoft to sign a complete file. Therefore it is not possible to sign a worksheet only.</p>\n\n<p>After a file is signed it is closed for editing:<br>\n<a href=\"https://i.stack.imgur.com/bdDxp.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bdDxp.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>For reference: <a href=\"https://support.office.com/en-us/article/add-or-remove-a-digital-signature-in-office-files-70d26dc9-be10-46f1-8efa-719c8b3f1a2d\" rel=\"nofollow noreferrer\">Add or remove a digital signature in Office files</a>.</p>\n"}], "owner": {"reputation": 33, "user_id": 8914514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d1e754bfa4daee224e5cf683a79c653?s=128&d=identicon&r=PG&f=1", "display_name": "sorin", "link": "https://stackoverflow.com/users/8914514/sorin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540391007, "creation_date": 1540389543, "question_id": 52970921, "link": "https://stackoverflow.com/questions/52970921/excel-signature-per-sheet", "title": "excel signature per sheet", "body": "<p>I am trying to have a single working excel document rather than multiple documents. The problem is that every document requires 3 signatures. If I merge the documents, each sheet would require 3 signatures. </p>\n\n<p><strong>The signatures would need to only affect the sheet they are on, rather than the whole document.</strong> For example, if Sheet1 is signed, it cannot be edited, but Sheet2 can still be edited. I do not mind using VBA if that is the best way to do this. I cannot even find a reference to anyone else trying this before... Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1540388269, "post_id": 52970414, "comment_id": 92847128, "body": "Hi, what have you tried so far?"}, {"owner": {"reputation": 2165, "user_id": 1177848, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/42d4bdf0b4fffd7121d58aa328617825?s=128&d=identicon&r=PG&f=1", "display_name": "Jaques", "link": "https://stackoverflow.com/users/1177848/jaques"}, "edited": false, "score": 0, "creation_date": 1540389046, "post_id": 52970414, "comment_id": 92847706, "body": "Welcome to SO. Please provide with what you have tried so far. SO is to assist with errors or problems in code that you experiencing."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 2, "creation_date": 1540390789, "post_id": 52970414, "comment_id": 92848994, "body": "<a href=\"https://stackoverflow.com/posts/52970414/edit\">edit</a> your question with the code, please take it out of the comments. it&#39;s nothing but jibberish there."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1540391077, "post_id": 52970414, "comment_id": 92849225, "body": "take a look at <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">how to avoid using select/activate in vba</a>, it&#39;s not a good idea to bank on the activation to always work properly"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1540391313, "post_id": 52970414, "comment_id": 92849407, "body": "What&#39;s your question? &quot;Please help&quot;...with what?"}, {"owner": {"reputation": 1, "user_id": 10360638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6439a7c2b1644e8e13ee3061bce53cac?s=128&d=identicon&r=PG&f=1", "display_name": "PBlas", "link": "https://stackoverflow.com/users/10360638/pblas"}, "edited": false, "score": 0, "creation_date": 1540398762, "post_id": 52970414, "comment_id": 92854287, "body": "Apologies for the  jibberish. This is my first time using the site. Thanks to all for the comments and assistance. I will be trying the code below."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10360638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6439a7c2b1644e8e13ee3061bce53cac?s=128&d=identicon&r=PG&f=1", "display_name": "PBlas", "link": "https://stackoverflow.com/users/10360638/pblas"}, "edited": false, "score": 0, "creation_date": 1540398573, "post_id": 52973522, "comment_id": 92854193, "body": "Thank you! I will try this."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1540397211, "creation_date": 1540397211, "answer_id": 52973522, "question_id": 52970414, "link": "https://stackoverflow.com/questions/52970414/copy-column-b-cell-b2-in-book1-column-b-cell-b2-in-book2/52973522#52973522", "title": "Copy column B (cell B2) in Book1 Column B (cell B2) in Book2", "body": "<p>The answer to your question is...\nAfter you open your workbooks, then use this line of code.\nNote: Change the workbook names and worksheet names, and ranges as needed.</p>\n\n<pre><code>Workbooks(\"Book1\").Sheets(1).Range(\"B2\", Cells(Rows.Count, \"B\").End(xlUp)).Copy Workbooks(\"Book2\").Sheets(1).Range(\"B2\")\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10360638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6439a7c2b1644e8e13ee3061bce53cac?s=128&d=identicon&r=PG&f=1", "display_name": "PBlas", "link": "https://stackoverflow.com/users/10360638/pblas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1586462847, "creation_date": 1540388084, "last_edit_date": 1586462847, "question_id": 52970414, "link": "https://stackoverflow.com/questions/52970414/copy-column-b-cell-b2-in-book1-column-b-cell-b2-in-book2", "title": "Copy column B (cell B2) in Book1 Column B (cell B2) in Book2", "body": "<p>Can someone please help? </p>\n\n<p>What is the shortest excel-vba code to copy all of column B (starting a cell B2) from Book1.xls to Column B (starting at cell B2) in Book2? </p>\n\n<p>I will be copying multiple files Book1, Book2, and Book3. Book2 and Book3 need to be pasted in the blank space (lastrow +1) in column B.  </p>\n\n<pre><code>Sub CopyWorkbooks1()\n\n    Workbooks.Open \"C:\\test\\RESOURCE\\Book1.xls\"\n    Range(\"B2:E15\").Copy\n    Workbooks.Open \"C:\\test\\PUBLISH\\PubFile.xls\"\n    Range(\"B2\").Select\n    ActiveSheet.Paste\n\n    'activate, copy, and, paste G and H -- F and G\n    Workbooks(\"book1.xls\").Activate\n    Range(\"G2:H15\").Copy\n    'activate and paste to PubFile\n    Workbooks(\"pubfile.xls\").Activate\n    Range(\"F2:G15\").Select\n    ActiveSheet.Paste\n\nEnd Sub\n\nSub LastRowMacro1()\n\n    Dim ws As Worksheet\n    Set ws = ActiveSheet\n    For Each cell In ws.Columns(2).Cells\n        If IsEmpty(cell) = True Then cell.Select: Exit For\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p>Your help is greatly appreciated.</p>\n"}, {"tags": ["vba", "pdf", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "edited": false, "score": 0, "creation_date": 1543506547, "post_id": 52971146, "comment_id": 93952373, "body": "I know this, but this requered to be printer installed in system"}], "tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": false, "score": 1, "last_activity_date": 1540390211, "creation_date": 1540390211, "answer_id": 52971146, "question_id": 52969785, "link": "https://stackoverflow.com/questions/52969785/document-exportasfixedformat-or-document-saveas-in-reverse-order/52971146#52971146", "title": "Document.ExportAsFixedFormat or Document.SaveAs in reverse order", "body": "<p>You can reverse the pages in the document using the  the .Printout method and specifying the first and last page as the last and first page.  This works because you are printing to a pdf.</p>\n\n<pre><code>ActivePrinter = \"Adobe PDF\"\nApplication.PrintOut FileName:=\"\", Range:=wdPrintRangeOfPages, Item:= _\n        wdPrintDocumentWithMarkup, Copies:=1, Pages:=\"10 -1\", PageType:= _\n        wdPrintAllPages, Collate:=False, Background:=True, PrintToFile:=False, _\n        PrintZoomColumn:=0, PrintZoomRow:=0, PrintZoomPaperWidth:=0, _\n        PrintZoomPaperHeight:=0\n</code></pre>\n"}], "owner": {"reputation": 2808, "user_id": 1444097, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/eeae121e100ca62b430bc825f36ebb61?s=128&d=identicon&r=PG", "display_name": "Dmitrij Holkin", "link": "https://stackoverflow.com/users/1444097/dmitrij-holkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586675311, "creation_date": 1540386265, "last_edit_date": 1586675311, "question_id": 52969785, "link": "https://stackoverflow.com/questions/52969785/document-exportasfixedformat-or-document-saveas-in-reverse-order", "title": "Document.ExportAsFixedFormat or Document.SaveAs in reverse order", "body": "<p>it is posible to save Word file as PDF without printer in reverse order?</p>\n\n<p>in normal order it works</p>\n\n<pre><code>WD.ExportAsFixedFormat PdfFile, wdExportFormatPDF, , wdExportOptimizeForOnScreen, wdExportFromTo, 1, WD.Range.Information(wdNumberOfPagesInDocument)\n</code></pre>\n\n<p>but in reverse it wont work</p>\n\n<pre><code>WD.ExportAsFixedFormat PdfFile, wdExportFormatPDF, , wdExportOptimizeForOnScreen, wdExportFromTo, WD.Range.Information(wdNumberOfPagesInDocument),1\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540386535, "post_id": 52969556, "comment_id": 92845921, "body": "So what is the installed status from the above please i.e. the expected string to retain? And what is the value of SRN? Please give an example. Is the real URL a public facing URL? Otherwise, can you include the full responseText? If too long you can use a <a href=\"https://pastebin.com/\" rel=\"nofollow noreferrer\">pastebin.com</a>."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1540387081, "post_id": 52969556, "comment_id": 92846296, "body": "<code>websitedatgoeshere.com&quot; &amp; SRN</code> what, as @QHarr has asked do these values look like.  If they are just ID&#39;s it wont work as you&#39;ll have <code>.com1234</code> rather than something like <code>.com&#47;?id=1234</code>"}, {"owner": {"reputation": 3, "user_id": 10552093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03bf505610b6d7305a45518f5ba78fe?s=128&d=identicon&r=PG&f=1", "display_name": "MOR", "link": "https://stackoverflow.com/users/10552093/mor"}, "edited": false, "score": 0, "creation_date": 1540387231, "post_id": 52969556, "comment_id": 92846417, "body": "Thanks for the quick response. i&#39;m not sure what you mean by your first question. The information i want the string to retain is the status the word &#39;installed&#39; or what ever variant is shown when the page is loaded.  The Value of the SRN is a numbered ID written into the cell in the sheet so something like 156789. the real URL is private. The full response text will change give the SRN but here is an example."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540388014, "post_id": 52969556, "comment_id": 92846951, "body": "Is websitedatgoeshere.com&quot; &amp; SRN valid? And is it always &quot;----targetWord----MUM&quot;  Do you mind providing a pastebin of the full html ?"}, {"owner": {"reputation": 3, "user_id": 10552093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03bf505610b6d7305a45518f5ba78fe?s=128&d=identicon&r=PG&f=1", "display_name": "MOR", "link": "https://stackoverflow.com/users/10552093/mor"}, "edited": false, "score": 0, "creation_date": 1540388179, "post_id": 52969556, "comment_id": 92847063, "body": "yes it works when fetching the data. i can not post more of the site information. maybe if guys can not help i need to rethink the code completely"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540388311, "post_id": 52969556, "comment_id": 92847165, "body": "Is it always between ---- and ---- , and is this the only occurence of ---- word ---- in the html?"}, {"owner": {"reputation": 3, "user_id": 10552093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03bf505610b6d7305a45518f5ba78fe?s=128&d=identicon&r=PG&f=1", "display_name": "MOR", "link": "https://stackoverflow.com/users/10552093/mor"}, "edited": false, "score": 0, "creation_date": 1540388422, "post_id": 52969556, "comment_id": 92847246, "body": "yes its always between --- and ---, and the word will change but it normally is the only occurrence."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10552093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03bf505610b6d7305a45518f5ba78fe?s=128&d=identicon&r=PG&f=1", "display_name": "MOR", "link": "https://stackoverflow.com/users/10552093/mor"}, "edited": false, "score": 0, "creation_date": 1540388864, "post_id": 52970565, "comment_id": 92847552, "body": "Thank you. it did not seem to work, i got a compile error: invalid or unqualified reference. this happened before when i tried splitting. im not sure why this happens. ive tried changing .responsetext but that does not seem to work."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10552093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03bf505610b6d7305a45518f5ba78fe?s=128&d=identicon&r=PG&f=1", "display_name": "MOR", "link": "https://stackoverflow.com/users/10552093/mor"}, "edited": false, "score": 0, "creation_date": 1540388938, "post_id": 52970565, "comment_id": 92847613, "body": "Use whttp.responseText  if not within a With statement holding the http object."}, {"owner": {"reputation": 3, "user_id": 10552093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03bf505610b6d7305a45518f5ba78fe?s=128&d=identicon&r=PG&f=1", "display_name": "MOR", "link": "https://stackoverflow.com/users/10552093/mor"}, "edited": false, "score": 0, "creation_date": 1540389092, "post_id": 52970565, "comment_id": 92847743, "body": "Debug.Print whttp.responseText         sheet.Cells(row, 2) = whttp.responseText         row = row + 1         SRN = sheet.Cells(row, 1)         Debug.Print Split(Split(whttp.responseText, &quot;----&quot;)(1), &quot;----&quot;)(0)                       Loop"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10552093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03bf505610b6d7305a45518f5ba78fe?s=128&d=identicon&r=PG&f=1", "display_name": "MOR", "link": "https://stackoverflow.com/users/10552093/mor"}, "edited": false, "score": 0, "creation_date": 1540389328, "post_id": 52970565, "comment_id": 92847913, "body": "Remove the debug.print if using that way i.e. sheet.Cells(row, 2) = Split(Split(whttp.responseText, &quot;----&quot;)(1), &quot;----&quot;)(0)"}, {"owner": {"reputation": 3, "user_id": 10552093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03bf505610b6d7305a45518f5ba78fe?s=128&d=identicon&r=PG&f=1", "display_name": "MOR", "link": "https://stackoverflow.com/users/10552093/mor"}, "edited": false, "score": 0, "creation_date": 1540391705, "post_id": 52970565, "comment_id": 92849674, "body": "that made sense Thank you very much."}, {"owner": {"reputation": 3, "user_id": 10552093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03bf505610b6d7305a45518f5ba78fe?s=128&d=identicon&r=PG&f=1", "display_name": "MOR", "link": "https://stackoverflow.com/users/10552093/mor"}, "edited": false, "score": 0, "creation_date": 1540392889, "post_id": 52970565, "comment_id": 92850512, "body": "its kind of working. it wont go into the correct row now though. when i change the row to row 1 an error appears."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10552093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03bf505610b6d7305a45518f5ba78fe?s=128&d=identicon&r=PG&f=1", "display_name": "MOR", "link": "https://stackoverflow.com/users/10552093/mor"}, "edited": false, "score": 0, "creation_date": 1540395095, "post_id": 52970565, "comment_id": 92852040, "body": "You will need to debug with f8 and find out what is happening. What is the error message? And what does go into correct row mean please?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 3, "user_id": 10552093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03bf505610b6d7305a45518f5ba78fe?s=128&d=identicon&r=PG&f=1", "display_name": "MOR", "link": "https://stackoverflow.com/users/10552093/mor"}, "edited": false, "score": 0, "creation_date": 1540395469, "post_id": 52970565, "comment_id": 92852262, "body": "Pleasure. Glad it helped."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1540389356, "last_edit_date": 1540389356, "creation_date": 1540388509, "answer_id": 52970565, "question_id": 52969556, "link": "https://stackoverflow.com/questions/52969556/parsing-html-in-vba-using-a-query-get-request/52970565#52970565", "title": "Parsing Html in VBA using a query get request", "body": "<p>This is based on if, and only if, the word is always between \"----\" and \"----\", and that it is the first occurrence in the response. If not the first you can adjust the index 1 as required.</p>\n\n<pre><code>Debug.Print Split(Split(whttp.responseText, \"----\")(1), \"----\")(0)\nsheet.Cells(row, 2) = Split(Split(whttp.responseText, \"----\")(1), \"----\")(0)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10552093, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e03bf505610b6d7305a45518f5ba78fe?s=128&d=identicon&r=PG&f=1", "display_name": "MOR", "link": "https://stackoverflow.com/users/10552093/mor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 52970565, "answer_count": 1, "score": 0, "last_activity_date": 1540395832, "creation_date": 1540385656, "last_edit_date": 1540395832, "question_id": 52969556, "link": "https://stackoverflow.com/questions/52969556/parsing-html-in-vba-using-a-query-get-request", "title": "Parsing Html in VBA using a query get request", "body": "<p>I am using someone else's code because this is an old file other people are using, I want to update it to make it more efficient but I need a little help. Below is the vba operation. What I need is it to get the information but delete everything but a certain word which changes every time the operation is run. I could use regex and objRE.Pattern = \"|\" but the word changes depending on the status.</p>\n\n<p>HTML:</p>\n\n<pre><code>&lt;span  onmouseover=\"ShowText('Message','blahblah'); return true;\" \nonmouseout=\"HideText('Message'); return true;\" \nhref=\"javascript:ShowText('Message')\"&gt;---(PSA)---&lt;/span&gt;\n&lt;/font&gt;&lt;a href='?srn=numbers12131131'target='_self'&gt;&lt;font color='#6666FF' \nsize='3'&gt;numbers123232343&lt;/font&gt;&lt;/a&gt;&lt;font  size='3'&gt;----Installed----MUM \nIndication:In Scope-&lt;font color='#00CC00'&gt;PASS WITH WARNING&lt;/font&gt;--- (20181018) \n&lt;/td&gt;&lt;tr&gt;&lt;/table&gt; &lt;/b&gt;&lt;br&gt;\n&lt;table class=\"OrderForm\" width=\"1000\"&gt; '\n</code></pre>\n\n<p>I just want the Installed status in my excel sheet.</p>\n\n<p>VBA code that needs work:</p>\n\n<pre><code>Sub GetComment()\n\nDim book As Workbook\nDim sheet As Worksheet\nDim row As Integer\nDim SRN As String\nDim whttp As Object\n\n\nSet book = ThisWorkbook\nSet sheet = book.Worksheets(\"CMT Data\")\nSet whttp = CreateObject(\"WinHTTP.WinHTTPrequest.5.1\")\n\n\nrow = 2\nSRN = sheet.Cells(row, 1)\nDo While SRN &lt;&gt; \"\"\n    Debug.Print SRN\n    whttp.Open \"GET\", \"www.websitedatgoeshere.com\" &amp; SRN, False\n    whttp.SetRequestHeader \"Cookie\", \"mycookiefromwebsite;\"\n    whttp.send\n    Debug.Print whttp.responseText\n    sheet.Cells(row, 2) = whttp.responseText\n    row = row + 1\n    SRN = sheet.Cells(row, 1)\n\nLoop\n\nSet whttp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1540384414, "post_id": 52969007, "comment_id": 92844373, "body": "Use the INDEX or INDIRECT formula."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1540384615, "post_id": 52969007, "comment_id": 92844522, "body": "That said, I&#39;m not sure how you define a table dynamically without VBA."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1540385337, "post_id": 52969308, "comment_id": 92845048, "body": "Could that string concatenation be shortened to <code>&quot;A2:C&quot;&amp;G2</code> ?"}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1540385562, "post_id": 52969308, "comment_id": 92845226, "body": "@Jeeped, you&#39;re so fast and I love it!! Yes, it could be shortened to: <code>=SUM(INDIRECT(&quot;A2:C&quot;&amp;G2))</code>, nice spot!!"}, {"owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 1, "creation_date": 1540385932, "post_id": 52969308, "comment_id": 92845524, "body": "Hi @Wizhi, I understand what you&#39;re telling me, but that is not the thing I&#39;m looking for. In your example: select A1:C2 and insert table. In my original question I reffered to F1 and let&#39;s say that number is in your picture in cell G2. I need to link the number from G2 to the range of the table so when the number changes to 3, my table range changes A1:C3. The reason for this is that I have formulas in my table which refer to another sheet. If this sheet is expanded i want to expand my table with it."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 0, "creation_date": 1540386438, "post_id": 52969308, "comment_id": 92845870, "body": "Thanks, then I understand. I think the answer is no, not with formula only. I think the closest you might achieve is @SJR solution, which could be worth a try!. That could include a range you want to look at and would be the same size as the table. Therefore could the range change as the table change, but it wouldn&#39;t be linked to the table itself."}], "tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": false, "score": 4, "last_activity_date": 1540386666, "last_edit_date": 1540386666, "creation_date": 1540384967, "answer_id": 52969308, "question_id": 52969007, "link": "https://stackoverflow.com/questions/52969007/excel-link-table-range-to-value/52969308#52969308", "title": "excel link table range to value", "body": "<p>Yes, INDIRECT is your way to make any formula dynamic / dependent on other cell values.</p>\n\n<p>Say you want to sum range <code>A2:C2</code>. But the value <code>2</code> for <code>C</code> is located in Cell <code>G2</code>.</p>\n\n<pre><code>=SUM(INDIRECT(\"A2\"&amp;\":C\"&amp;G2)) \n</code></pre>\n\n<p>this is equal to write <code>=SUM(A2:C2)</code> in my example below.</p>\n\n<p><a href=\"https://i.stack.imgur.com/reYfi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/reYfi.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you set <code>G2</code> to 3 it would calculate <code>A2:C3</code> for this <code>=SUM(INDIRECT(\"A2\"&amp;\":C\"&amp;G2))</code>.</p>\n\n<hr>\n\n<p>If you mean Excel <a href=\"https://support.office.com/en-us/article/overview-of-excel-tables-7ab0bb7d-3a9e-4b56-a3c9-6c94334e492c\" rel=\"nofollow noreferrer\">table</a>, I guess the answer is no with formula, probably with <a href=\"https://stackoverflow.com/questions/8087736/how-do-you-make-a-dynamically-sized-data-table\">VBA</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 1, "creation_date": 1540386549, "post_id": 52969502, "comment_id": 92845936, "body": "thank you very much for your answer! I think it works now!"}, {"owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1540386947, "post_id": 52969502, "comment_id": 92846207, "body": "when i select the table and go to --&gt; design --&gt; change table size, I can enter the offset formula and the size changes. But after entering this the table size is set to the new values and the connection to the formula is lost. Can I keep this formula to work for the table size?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1540387156, "post_id": 52969502, "comment_id": 92846360, "body": "As far as I know (which may not be very far so don&#39;t take it as gospel) is that you can&#39;t do this without VBA. However, a named range does cover many of the attributes of a table. Thus, I think your choice is either a dynamic used range &amp; formula or table &amp; VBA."}, {"owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1540387289, "post_id": 52969502, "comment_id": 92846465, "body": "Ok thank you for your help. I think I need the table/VBA in this situation because all other formulas are linked to the table ranges like: Table1[value] so the connection is lost if I don&#39;t use tables"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "edited": false, "score": 0, "creation_date": 1540387354, "post_id": 52969502, "comment_id": 92846507, "body": "Ok in that case I suggest you post a new question."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 4, "last_activity_date": 1540385472, "creation_date": 1540385472, "answer_id": 52969502, "question_id": 52969007, "link": "https://stackoverflow.com/questions/52969007/excel-link-table-range-to-value/52969502#52969502", "title": "excel link table range to value", "body": "<p>An alternative is to use a dynamic named range which is what we used to do before tables. The range, enclosed by marching ants below, is defined as follows:</p>\n\n<p>=OFFSET(Sheet3!$A$1,0,0,Sheet3!$F$1,5)</p>\n\n<p>The top left cell is A1. It is as many rows deep as the number in F1 and 5 columns wide (which could also be made dynamic).</p>\n\n<p><a href=\"https://i.stack.imgur.com/rc57u.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rc57u.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 87, "user_id": 10524258, "user_type": "registered", "profile_image": "https://graph.facebook.com/1801917166533938/picture?type=large", "display_name": "Mischa Urlings", "link": "https://stackoverflow.com/users/10524258/mischa-urlings"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 0, "accepted_answer_id": 52969502, "answer_count": 2, "score": 0, "last_activity_date": 1586462883, "creation_date": 1540384120, "last_edit_date": 1586462883, "question_id": 52969007, "link": "https://stackoverflow.com/questions/52969007/excel-link-table-range-to-value", "title": "excel link table range to value", "body": "<p>I'm searching for a way to link the range of an Excel table to a specific number. </p>\n\n<p>Let's say I have a table that has a range of A1:B10. I want to make the number '10' dynamic and link it to a number that is calculated from another sheet. Let's say cell F1 contains that number and the value is '20'. \nIs it possible to make a dynamic range so the table range changes to: A1:B(F1). Then my table would adapt automatically and this has to work in my file. </p>\n\n<p>I prefer a formula instead of a macro in VBA, because I normally don't work with VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1540383929, "post_id": 52968764, "comment_id": 92844068, "body": "My mind was leaning towards your update as well"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10086705"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1540384511, "post_id": 52968764, "comment_id": 92844438, "body": "Yea it kinda &quot;fixes&quot; the problem as long as the user remembers to use the Userform instead of clicking the actual X at the top right corner."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1540385494, "post_id": 52968764, "comment_id": 92845177, "body": "Is your intention to close the workbook without saving?"}, {"owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 2, "creation_date": 1540385862, "post_id": 52968764, "comment_id": 92845453, "body": "Sharing the code you use to create the workbook and close it would enable us to provide a more informed answer."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1540390561, "post_id": 52968764, "comment_id": 92848830, "body": "open the new workbook in a <i>separate</i> Excel instance. that way closing the new workbook will have no effect on the state of the hidden workbook"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10086705"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1540444206, "post_id": 52968764, "comment_id": 92869458, "body": "@ScottHoltzman as in there are 2 Excel icon&#39;s at the bottom of the screen?  It already does that."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10086705"}, "reply_to_user": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "edited": false, "score": 0, "creation_date": 1540444301, "post_id": 52968764, "comment_id": 92869492, "body": "@Xabier After the data is copied just a simple ActiveWorkbook.SaveAs Filename:=&quot;&quot;Filename and location&quot;, FileFormat:=xlCSVWindows"}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 1, "creation_date": 1540451109, "post_id": 52968764, "comment_id": 92872248, "body": "@A.Bakker - two icons doesn&#39;t necessarily mean two instances of the application. you can force it by <code>Dim xl = CreateObject(&quot;Excel.Application&quot;) &#39;or use early binding</code> and then work off that application"}], "owner": {"user_type": "does_not_exist", "display_name": "user10086705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1586462919, "creation_date": 1540383280, "last_edit_date": 1586462919, "question_id": 52968764, "link": "https://stackoverflow.com/questions/52968764/hiding-a-workbook-while-being-able-to-close-others", "title": "Hiding a workbook while being able to close others", "body": "<p>I got a workbook that automatically opens a UserForm. \nThe workbook itself I hide using <code>Application.Visible = False</code> \nWhile in the UserForm the user is able to create a new workbook (.CSV file)  and this all works. </p>\n\n<p>But if the user tries to close the newly created workbook it will ask if you want to save it AND also want to save the original workbook (closing it in the process). If I select <code>No</code> on the first menu (new workbook) and cancel on the second (the original workbook) both workbooks remain open. If I don't select cancel on the second menu both will close. </p>\n\n<p>Is there a way to hide my workbook and later on closing a different workbook without being forced to close the hidden workbook? </p>\n\n<p>Update:<br>\nA current workaround I have is putting a button on the UserForm to close any newly created workbook with <code>Application.DisplayAlerts = False</code> enabled during this process (and of course setting it to <code>true</code> after) .</p>\n"}, {"tags": ["vba", "ms-word", "vb6"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1540383926, "post_id": 52968540, "comment_id": 92844065, "body": "Is your additional code in VB6? or the documents VBA?"}, {"owner": {"reputation": 470, "user_id": 2482299, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/J8yzU.png?s=128&g=1", "display_name": "ApsSanj", "link": "https://stackoverflow.com/users/2482299/apssanj"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1540393959, "post_id": 52968540, "comment_id": 92851257, "body": "@Nathan_Sav, My project includes a vb6 code (ActiveX dll) and a .dotm file (our ribbon bar)."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1540394710, "post_id": 52968540, "comment_id": 92851783, "body": "I am not sure how this code is set up, so the code is in the VB6 project relating to the <code>mobjWord</code> object, also created in VB6?  I think you&#39;ll need to create a class with automated events from a base of <code>word.application</code>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1540474381, "post_id": 52968540, "comment_id": 92886337, "body": "You need to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> meaning code that will run that lets us reproduce what you&#39;re doing. We can&#39;t even tell if the code you show us is in the VB6 project or the VBA project! Also, what object is <code>Project</code>? We can&#39;t know what <code>Project.Document</code> and <code>Project-Applciation</code> are. And so on..."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1540395406, "creation_date": 1540395406, "answer_id": 52972942, "question_id": 52968540, "link": "https://stackoverflow.com/questions/52968540/word-documentbeforeclose-event-not-working-sometimes/52972942#52972942", "title": "Word DocumentBeforeClose event not working sometimes", "body": "<p>I am not sure I fully understand you, but in VBA, so you can adapt for your VB6, I would have the following in a normal module</p>\n\n<pre><code>Public wdCustomWordApplication As clsCustomWordApplication\n\nSub Setup()\n\nDim w As Word.Application\n\nSet w = New Word.Application\nw.Visible = True\n\nSet wdCustomWordApplication = New clsCustomWordApplication\nwdCustomWordApplication.InitialiseCustomWordApplication w\n\nEnd Sub\n</code></pre>\n\n<p>and then a class module called clsCustomWordApplication, like so</p>\n\n<pre><code>Private WithEvents wdWordApplication As Word.Application\n\nPublic Sub InitialiseCustomWordApplication(objWord As Word.Application)\n    Set wdWordApplication = objWord\nEnd Sub\n\nPrivate Sub wdWordApplication_DocumentBeforeClose( _\n    ByVal Doc As Word.Document, Cancel As Boolean)\n    MsgBox \"Some question\"\nEnd Sub\n</code></pre>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 470, "user_id": 2482299, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/J8yzU.png?s=128&g=1", "display_name": "ApsSanj", "link": "https://stackoverflow.com/users/2482299/apssanj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1540474160, "creation_date": 1540382613, "last_edit_date": 1540474160, "question_id": 52968540, "link": "https://stackoverflow.com/questions/52968540/word-documentbeforeclose-event-not-working-sometimes", "title": "Word DocumentBeforeClose event not working sometimes", "body": "<p>I am maintaining a Word related vb6 project. When we download a word document from our server and make changes on it. Then click Close. </p>\n\n<p>Then \nthe <code>objWord_DocumentBeforeClose</code> event will occur. \nIf the downloaded file has not uploaded back to server, then we prompt a yes/no message box <code>Do you want to check-in the document?</code></p>\n\n<p>If clicked on 'Yes' and if click again on <code>ctrl+w</code> before the check-in process completed, document will close without reaching the <code>mobjWord_DocumentBeforeClose</code>event. </p>\n\n<p>I have added some code in the DocumentBeforeClose event to prevent closing the document if the check-in process is running using document variables. </p>\n\n<p>Could anybody please explain me why the <code>mobjWord_DocumentBeforeClose</code> is not reaching at the second close click? </p>\n\n<p>Below is my code.</p>\n\n<pre><code>Private Sub mobjWord_DocumentBeforeClose(ByVal Doc As Document, Cancel As Boolean)\n\nDim objDoc As Project.Document\nDim objApp As Project.Application\nDim strProcess As String\n\nSet objApp = New Project.Application\nIf objApp.Settings.RespondToWordEvents Then\n    Set objDoc = objApp.GetDocument(Doc)\n    'Check the document variable to seen if any process is running with the document\n   If objDoc.IsBusy = False Then\n        if objDoc.NotCheckedIn\n             If objDoc.DownloadProperties.WasCheckedOut Then\n                Select Case MsgBox(\"Do you want to check-in the document?\", vbYesNoCancel + vbQuestion)\n                    Case vbYes\n                        If objApp.CheckInDocument(WordDocument:=Doc) Is Nothing Then\n                            Cancel = True\n                        End If\n                        fDisebleCheckIn = True\n                    Case vbNo\n                        fDisebleCheckIn = True\n                    Case vbCancel\n                        Cancel = True\n                End Select\n            End If\n        Else\n            //some code\n        End If\n    Else\n        Cancel = True\n        strProcess = ProcessInProgress(objDoc, objApp)\n        MsgBox objApp.GetUIString(\"Unable to close the document \" + strProcess + \"process is running\"), vbOKOnly + vbInformation\n    End If\nEnd If\n\nErrorHandler:\n    objApp.Quit\n    Set objDoc = Nothing\n    Set objApp = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 1, "creation_date": 1540382431, "post_id": 52968374, "comment_id": 92843094, "body": "I could be missunderstanding... So from last row + 1 in Column A until last row in Column B? So Range( ColumnA, last row +1 : Column B last row)? Is column B on the same worksheet?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1540382614, "post_id": 52968374, "comment_id": 92843219, "body": "Can you please <a href=\"https://stackoverflow.com/posts/52968374/edit\">edit your question</a> and show us what the expected result looks like?"}, {"owner": {"reputation": 143, "user_id": 10456629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc7902b164522945b30a009146540080?s=128&d=identicon&r=PG&f=1", "display_name": "eenz", "link": "https://stackoverflow.com/users/10456629/eenz"}, "edited": false, "score": 0, "creation_date": 1540382811, "post_id": 52968374, "comment_id": 92843334, "body": "Yes Wizhi, column A and B are in the same worksheet ABC"}], "answers": [{"comments": [{"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 1, "creation_date": 1540384293, "post_id": 52968794, "comment_id": 92844296, "body": "Really neat answer @Jeeped. This is my interpretation... <code>.Range(.Cells(.Rows.Count, &quot;A&quot;).End(xlUp), .Cells(.Rows.Count, &quot;B&quot;).End(xlUp).Offset(0, -1)).Formula =</code>, i.e. that the formula should start depending on the last row for Column A of sheet ABC and then go down to the last row of Column B... only Leena knows, see if we get more clarifications :)!"}, {"owner": {"reputation": 143, "user_id": 10456629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc7902b164522945b30a009146540080?s=128&d=identicon&r=PG&f=1", "display_name": "eenz", "link": "https://stackoverflow.com/users/10456629/eenz"}, "edited": false, "score": 0, "creation_date": 1540391934, "post_id": 52968794, "comment_id": 92849831, "body": "Jeeped I tried your code but got an application or object defined error. Wizhi with your code I got a type mismatch error"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1540405390, "post_id": 52968794, "comment_id": 92857866, "body": "You get that you have to actually put in a working formula, don&#39;t you?"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1540383390, "creation_date": 1540383390, "answer_id": 52968794, "question_id": 52968374, "link": "https://stackoverflow.com/questions/52968374/macro-to-insert-formula-after-last-used-cell-in-a-column/52968794#52968794", "title": "Macro to insert formula after last used cell in a column", "body": "<p>Try,</p>\n\n<pre><code>dim lRow as long\n\nWith ThisWorkbook\n\n    With .Sheets(\"XYZ\")\n        lRow = .Cells(.Rows.count, \"A\").End(xlUp).Row\n        'or is it ....?\n        lRow = .Cells(.Rows.count, \"A\").End(xlUp).Row + 1\n    end with\n\n    With.Sheets(\"ABC\")\n        .Range(.cells(lRow, \"A\"), .cells(.rows.count, \"B\").end(xlup).offset(0, -1)).formula = _\n            \"=IF(..Very long formula..)\"\n    end with\n\nend with\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 10456629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc7902b164522945b30a009146540080?s=128&d=identicon&r=PG&f=1", "display_name": "eenz", "link": "https://stackoverflow.com/users/10456629/eenz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1540383629, "creation_date": 1540382084, "last_edit_date": 1540383629, "question_id": 52968374, "link": "https://stackoverflow.com/questions/52968374/macro-to-insert-formula-after-last-used-cell-in-a-column", "title": "Macro to insert formula after last used cell in a column", "body": "<p>I want my macro to paste two different formulas in the same column (A). The reason for this is my formula references 2 different sheets so when I combine them into one formula the ranges for my cells get messed up. </p>\n\n<p>So my code uses the last used row from reference sheet 1 and inserts my formula into column A. So my question is, how do I define a range that allows me to insert a formula after the last used row in column A, but the range has to stop according to the last used range in column B(in the same worksheet). So if column B stops at row 33, I want my formula to only be inserted until cell 33</p>\n\n<p>This is what I have so far</p>\n\n<pre><code>With ThisWorkbook\n\nWith .Sheets(\"XYZ\")\n lRow = .Cells(.Rows.count, 1).End(xlUp).Row\n\nWith.Sheets(\"ABC\")\n Set rng2 = .Range(\"A6:A\" &amp; lRow)\n     rng2.Formula = \"=IF(..Very long formula..)\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1540383955, "last_edit_date": 1540383955, "creation_date": 1540383556, "answer_id": 52968834, "question_id": 52968181, "link": "https://stackoverflow.com/questions/52968181/excel-vba-to-populate-parent-child-drop-down-source-from-sheet/52968834#52968834", "title": "Excel VBA to populate parent child drop down source from sheet", "body": "<p>I recommend to use a <code>Dictionary</code> to remember which entries in ComboBox1 already exists because you can easily test with <code>dict.Exists(NewItem)</code>.</p>\n\n<p>And the Data for ComboBox2 needs to automatically re-initialize on the <code>ComboBox1_Change</code> event.</p>\n\n<p><em>Note that you should use more descriptive variable names <code>s, r, nr, wr, v</code> are pretty meaningless, while names like <code>ComboRange1</code> or <code>NewItem</code> are pretty good readable for humans. Makes your life much easier and results in less errors.</em></p>\n\n<pre><code>Option Explicit\n\nSub InitComboBox1()\n    Dim ComboRange1 As Range\n    Set ComboRange1 = Sheet1.Range(\"A1\", Sheet1.Cells(Rows.Count, \"A\").End(xlUp))\n\n    ComboBox1.Clear\n\n    Dim dict As Object\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    Dim i As Long\n    For i = 1 To ComboRange1.Rows.Count\n        Dim NewItem As String\n        NewItem = ComboRange1.Cells(i, 1).Text\n\n        If Not dict.Exists(NewItem) Then\n            dict.Add NewItem, 0\n            ComboBox1.AddItem NewItem\n        End If\n    Next i\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\n    Dim ComboRange2 As Range\n    Set ComboRange2 = Sheet1.Range(\"A1\", Sheet1.Cells(Rows.Count, \"A\").End(xlUp)).Resize(ColumnSize:=2)\n\n    ComboBox2.Clear\n\n    Dim dict As Object\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    Dim i As Long\n    For i = 1 To ComboRange2.Rows.Count\n        If ComboRange2.Cells(i, 1).Text = ComboBox1.Value Then\n            Dim NewItem As String\n            NewItem = ComboRange2.Cells(i, 2).Text\n\n            If Not dict.Exists(NewItem) Then\n                dict.Add NewItem, 0\n                ComboBox2.AddItem NewItem\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 8669168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d878bf203d50df50a5d03a0cbd756ad2?s=128&d=identicon&r=PG&f=1", "display_name": "Scales", "link": "https://stackoverflow.com/users/8669168/scales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 52968834, "answer_count": 1, "score": -1, "last_activity_date": 1586462955, "creation_date": 1540381525, "last_edit_date": 1586462955, "question_id": 52968181, "link": "https://stackoverflow.com/questions/52968181/excel-vba-to-populate-parent-child-drop-down-source-from-sheet", "title": "Excel VBA to populate parent child drop down source from sheet", "body": "<p>I have sheet with data like below and 2 combo boxes in user form with the names ComboBox1(parent) and ComboBox2(child)</p>\n\n<pre><code>Parent |Child\n-------|------\n  A    |   1\n  A    |   2\n  A    |   3\n  X    |   100\n  X    |   101\n  X    |   102\n</code></pre>\n\n<p>With below code I took distinct values into Parent combo.</p>\n\n<pre><code>Dim s As String, r As Integer, nr As Integer, wr, v\nSet wr = Sheet1.Range(\"A1:A10\")\nnr = wr.Rows.Count\nWith ComboBox1\n .Clear\n For r = 1 To nr\n  v = wr(r, 1)\n  If InStr(s, v &amp; \",\") = 0 Then\n   s = s &amp; v &amp; \",\"\n   .AddItem (v)\n  End If\n Next\nEnd With\n</code></pre>\n\n<p>I am looking help to populate child combo based on selected value in Parent combo!</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540385040, "post_id": 52967842, "comment_id": 92844796, "body": "I wouldn&#39;t even attempt to process the entire file at once. Use <code>Split(sTxt, vbCrLf)</code> to get an array of lines. The loop through the resulting array line by line looking for &quot;FAILED&quot;. If you find that, scan forward in the array up to 3 lines looking for &quot;PASSED&quot;."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 0, "creation_date": 1540385211, "post_id": 52967842, "comment_id": 92844945, "body": "I would follow the lead in PeterT&#39;s answer below and read through the data with <code>.readline</code> instead of <code>.readall</code>, although that would require restructuring the code somewhat."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 0, "creation_date": 1540385374, "post_id": 52967842, "comment_id": 92845077, "body": "@Egalth Disagree. We&#39;re talking about &quot;tens of thousands&quot; of files - reading them line by line is going to be slooooooow."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540385613, "post_id": 52967842, "comment_id": 92845272, "body": "(@Comintern, se my comment in PeterT&#39;s answer)"}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1540385311, "post_id": 52969312, "comment_id": 92845022, "body": "The approach is spot on, but I&#39;d consider reading the entire file at once and splitting it into an array. Using a <code>Collection</code> and reading individual lines from &quot;tens of thousands of text files&quot; is likely to be considerably slower."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 0, "creation_date": 1540385409, "post_id": 52969312, "comment_id": 92845106, "body": "This approach is attractive. I find that VBA&#39;s <code>Like</code> operator often does the job of <code>regex</code> simpler and faster."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540385499, "post_id": 52969312, "comment_id": 92845182, "body": "@Comintern, good point, but are you sure about that or is it a hypothesis? I have some code that uses basically the same idea and I find that reading line by line is typically very fast, less than a second for tens of thousands of lines in a bunch of files, but I haven&#39;t tried it against tens of thousands of <i>files</i>..."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "edited": false, "score": 1, "creation_date": 1540385747, "post_id": 52969312, "comment_id": 92845363, "body": "@Egalth Positive. Assuming sufficient memory to hold the entire file, limiting the IO operations will remove a significant bottleneck.  For individual files it probably isn&#39;t that big a deal, but it adds up."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1540386426, "post_id": 52969312, "comment_id": 92845859, "body": "Are streams in VBA implemented such that files less than a certain size would be read into memory (internal to the stream) and then <code>ReadLine</code> would then perform memory accesses?  (I seem to remember I/O streams in C++ could use this approach for performance improvements, addressing your exact concerns.)"}, {"owner": {"reputation": 21, "user_id": 4005183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166a23cb10eebb35c8a1534f3e88d4ae?s=128&d=identicon&r=PG", "display_name": "GoodMD", "link": "https://stackoverflow.com/users/4005183/goodmd"}, "edited": false, "score": 0, "creation_date": 1540386955, "post_id": 52969312, "comment_id": 92846214, "body": "OMG, Thank You everyone for your input.  I am trying to digest it now and will come back in a little while with my findings.  Thank You SO much for everything."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540387152, "post_id": 52969312, "comment_id": 92846357, "body": "@PeterT Think memory copies. The internal implementation of <code>ReadLine</code> isn&#39;t as relevant as the fact that you perform N memory allocations and copies as opposed to 1."}, {"owner": {"reputation": 21, "user_id": 4005183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166a23cb10eebb35c8a1534f3e88d4ae?s=128&d=identicon&r=PG", "display_name": "GoodMD", "link": "https://stackoverflow.com/users/4005183/goodmd"}, "edited": false, "score": 0, "creation_date": 1540392275, "post_id": 52969312, "comment_id": 92850108, "body": "PeterT, this is working perfectly.  I&#39;ve added a few additional lines to do exactly what is needed and this can be added to what I already have to clean up the final worksheet. Thank You so very much. I do have a question as I don&#39;t completely understand the ScanInputFile routine. I paused the code to take a snapshot of what was happening and I noticed that in the Locals window the filelines collection only has 256 lines whereas one of the files that I tested resulted in the Debug.Print displaying a PASSED find on line 24536.  Could you explain how that happens?"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540398901, "post_id": 52969312, "comment_id": 92854370, "body": "If the <code>Debug.Print</code> said that PASSED was found on line 24536, then the Collection has to have more than 256 entries. I&#39;ve seen collections in the locals window that have had many more than 256 items, so I&#39;m not sure what&#39;s happening. But it appears to be working fine. You can also consider following @Comintern&#39;s advice to read the whole file in one operation and returning a string array by using <code>Split</code>, which would give you a bit better performance."}, {"owner": {"reputation": 812, "user_id": 5457466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/438a24229b00e5d4327425c37518aca7?s=128&d=identicon&r=PG&f=1", "display_name": "Egalth", "link": "https://stackoverflow.com/users/5457466/egalth"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540545299, "post_id": 52969312, "comment_id": 92914546, "body": "Just out of curiosity I tested my own script, which is performing similar work using <code>.readline</code> (but no regex). Parsing one file with 3300 lines takes less than a second, while parsing 100 such files increases execution time to 10 secs. Point taken, thanks @Comintern :)"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 2, "last_activity_date": 1540384975, "creation_date": 1540384975, "answer_id": 52969312, "question_id": 52967842, "link": "https://stackoverflow.com/questions/52967842/vba-regex-second-match-to-start-at-first-match-firstindex/52969312#52969312", "title": "VBA RegEx Second Match to Start at First Match FirstIndex", "body": "<p><em>This is an indirect answer to your question: at the risk of starting a flamewar, I'm not a fan of <code>regex</code>. I've used it before, mostly in bash scripting in Perl, but have (almost) always been able to work around it when developing text parsing code. Below is an example of how to approach your specific problem. Clearly, adapting my approach will cause a refactoring of your code. Please consider this as an alternative.</em></p>\n\n<p>My approach ingests the log file into a VBA <code>Collection</code> where each <code>Item</code> in the collection is a separate line. I'm using a collection instead of a <code>String()</code> array because the collection readily expands for an unknown number of lines, whereas an array must be <code>ReDim</code>-ed with prior knowledge of exactly how many lines there are (probably causing a double loop, double read of the same file).</p>\n\n<pre><code>Private Function GetFileByLines(ByVal filePath As String) As Collection\n    Dim fso As FileSystemObject\n    Set fso = New FileSystemObject\n\n    Dim txtStream As Object\n    Set txtStream = fso.OpenTextFile(filePath, ForReading, False)\n\n    Dim lines As Collection\n    Set lines = New Collection\n\n    Do While Not txtStream.AtEndOfStream\n        Dim line As String\n        lines.Add txtStream.ReadLine\n    Loop\n    txtStream.Close\n    Set GetFileByLines = lines\nEnd Function\n</code></pre>\n\n<p>Once you have the collection of lines from the text file, it's then an easy loop with indexing to check if \"PASSED\" exists three lines after a \"FAILED\" line.</p>\n\n<pre><code>Private Sub ScanInputFile(ByVal filename As String)\n    Dim fileLines As Collection\n    Set fileLines = GetFileByLines(filename)\n\n    Dim i As Long\n    For i = 1 To fileLines.Count\n        If LCase(fileLines(i)) Like \"*failed*\" Then\n            '--- check to make sure we're not near the end of the file\n            If i + 3 &lt; fileLines.Count Then\n                If LCase(fileLines(i + 3)) Like \"*passed*\" Then\n                    Debug.Print \"found a PASSED line three lines after FAILED, \" &amp; _\n                                \"lines \" &amp; i &amp; \" and \" &amp; i + 3\n                End If\n            End If\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>Obviously, this does not integrate directly into your whole solution as I'm not addressing parts that you have already coded and debugged. As a quick code review though, please read up on <a href=\"https://stackoverflow.com/a/10717999/4717755\">avoiding the use of <code>Activate</code> and <code>Select</code></a>.</p>\n\n<p>Here's the whole test module I used. The \"testlog.txt\" file is a direct copypasta from your data above.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n    ScanInputFile \"C:\\Temp\\testlog.txt\"\nEnd Sub\n\nPrivate Sub ScanInputFile(ByVal filename As String)\n    Dim fileLines As Collection\n    Set fileLines = GetFileByLines(filename)\n\n    Dim i As Long\n    For i = 1 To fileLines.Count\n        If LCase(fileLines(i)) Like \"*failed*\" Then\n            '--- check to make sure we're not near the end of the file\n            If i + 3 &lt; fileLines.Count Then\n                If LCase(fileLines(i + 3)) Like \"*passed*\" Then\n                    Debug.Print \"found a PASSED line three lines after FAILED, \" &amp; _\n                                \"lines \" &amp; i &amp; \" and \" &amp; i + 3\n                End If\n            End If\n        End If\n    Next i\nEnd Sub\n\nPrivate Function GetFileByLines(ByVal filePath As String) As Collection\n    Dim fso As FileSystemObject\n    Set fso = New FileSystemObject\n\n    Dim txtStream As Object\n    Set txtStream = fso.OpenTextFile(filePath, ForReading, False)\n\n    Dim lines As Collection\n    Set lines = New Collection\n\n    Do While Not txtStream.AtEndOfStream\n        Dim line As String\n        lines.Add txtStream.ReadLine\n    Loop\n    txtStream.Close\n    Set GetFileByLines = lines\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4005183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/166a23cb10eebb35c8a1534f3e88d4ae?s=128&d=identicon&r=PG", "display_name": "GoodMD", "link": "https://stackoverflow.com/users/4005183/goodmd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1540384975, "creation_date": 1540380539, "question_id": 52967842, "link": "https://stackoverflow.com/questions/52967842/vba-regex-second-match-to-start-at-first-match-firstindex", "title": "VBA RegEx Second Match to Start at First Match FirstIndex", "body": "<p>Good Day \u2013 I have a routine that searches through tens of thousands of text files to capture relevant file names resulting in just under 10,000 of them remaining.  These filenames provide the starting point for the next routine to open each of these remaining text files to search for specific data.  Each text file may have anywhere between 50 and 50,000 lines of data.  Looping through each file the routine first finds a serial number and then finds all occurrences of FAILED which it then captures the date/time stamp near the beginning of that line of text and populates another worksheet.  This all works great for the various failure occurrences. Except for one.</p>\n\n<p>(See <em>Beginning of area of concern</em> in code sample below) I have now come to the area where I would appreciate some guidance.  There is one instance of FAILED that I need to verify if PASSED occurs three lines after the line containing FAILED.  If PASSED is there, it will <em>always</em> be the third line below FAILED.  I cannot use the date/time stamps such as PASSED occurring within a certain number of seconds after FAILED as it varies too much and may produce false results.  I thought the best way to capture the first PASSED after the FAILED would be to capture the FAILED\u2019s FirstIndex location and begin a search for PASSED from there.  But, I have no idea how to do that or if it is even possible.  To be honest, I don\u2019t know if this can be done using RegEx or something in VBA that I haven\u2019t thought of.  I am just learning RegEx, so I am very weak in this area, even after everything that I have read.  An explanation with an answer would be most appreciated.  VBA I am very comfy with.   I am using Excel 2010 Professional with Microsoft VBScript Regular Expression 5.5 referenced.</p>\n\n<p>I thought that this answer might help, but if it would I do not understand it.  <a href=\"https://stackoverflow.com/questions/39490458/how-to-get-the-position-of-submatches-in-vba\">How to get the position of submatches in VBA?</a> Any help or guidance would be most appreciated.  Thank You in advance.</p>\n\n<p>Kind Regards,\nMark</p>\n\n<p>Sample sanitized search data</p>\n\n<p>LOG: 00::01:11:03.129 [XXX_##] XXX: 3390, 3412, 3401, 3400, 3401, 3398, 3402, 3409 0090123101000172</p>\n\n<p>LOG: 00::01:11:15.576 [XXX_###] XXX: 3393, 3399, 3393, 3395, 3394, 3396, 3397, 3395 0090123101000200</p>\n\n<p>LOG: 00::01:11:23.568 [XXX_##] XXX: 3390, 3411, 3401, 3400, 3401, 3398, 3402, 3409 0090123101000173</p>\n\n<p>LOG: 00::01:11:37.049 [XXX_###] XXX: 3393, 3400, 3393, 3394, 3394, 3396, 3396, 3395 0090123101000201</p>\n\n<p>LOG: 00::01:11:53.265 [XXX_##] XXX: 3388, 3409, 3399, 3397, 3399, 3396, 3400, 3406 0090123101000129</p>\n\n<p>LOG: 00::01:11:56.361 [XXX_###] XXX: 3393, 3399, 3392, 3394, 3394, 3396, 3396, 3395 0090123101000202</p>\n\n<p>LOG: 00::01:12:14.596 [XXX_##] XXXX Xxxxxxxxxxxxx Xxxxxxxxxxx <strong>FAILED</strong>, Xxxxxxxxxxx: A:1, 0090123101000130</p>\n\n<p>LOG: 00::01:12:16.432 [XXX_##] XXXX ADC 3401, 3402, 3401, 3399, 3399, 3401, 3399, 3401,</p>\n\n<p>LOG: 00::01:12:16.502 [XXX_##] XXXX DAC 1477, 1301, 1405, 1229, 1406, 1473, 1770, 1543,</p>\n\n<p>LOG: 00::01:12:16.581 [XXX_##] XXXX Xxxxxxxxxxxxx Xxxxxxxxxxx <strong>PASSED</strong>, Xxxxxxxxxxx: 1</p>\n\n<p>LOG: 00::01:12:16.846 [XXX_##] XXX: 3407, 3408, 3406, 3405, 3405, 3406, 3404, 3405 0090123101000130</p>\n\n<p>LOG: 00::01:12:17.406 [XXX_###] XXX: 3398, 3403, 3397, 3400, 3399, 3401, 3402, 3399 0090123101000203</p>\n\n<p>LOG: 00::01:12:37.508 [XXX_##] XXX: 3402, 3402, 3400, 3398, 3400, 3401, 3400, 3401 0090123101000131</p>\n\n<p>LOG: 00::01:12:38.511 [XXX_###] XXX: 3386, 3393, 3386, 3386, 3387, 3389, 3389, 3387 0090123101000204</p>\n\n<p>LOG: 00::01:13:02.619 [XXX_##] XXX: 3403, 3402, 3400, 3397, 3400, 3401, 3399, 3401 0090123101000132</p>\n\n<pre><code>    Dim bFound              As Boolean          'Used to identify if sFile &lt;&gt; \"\".\n    Dim dHr                 As Double    'Test  'Number of hours in dEndTime\n    Dim dMin                As Double    'Test  'Number of minutes in dEndTime.\n    Dim dSec                As Double    'Test  'Number of seconds in dEndTime.\n    Dim dStartTime          As Double    'Test  'Time routine starts.\n    Dim dEndTime            As Double    'Test  'Time routine completes.\n    Dim i                   As Integer          'Array variable for rows.\n    Dim iCurrentRow         As Integer          'Variable used in centering filename cells.\n    Dim iNextRow            As Integer          'Used to find last row in column to add new data.\n    Dim j                   As Integer          'Array variable for columns.\n    Dim LastRow             As Integer          'Last row used by any column in current range.\n    Dim NextRow             As Integer          'Last row of current column.\n    Dim z                   As Integer          'Counter for files &gt; 200 bytes.\n    Dim lFileLen            As Long             'Length of text file.\n    Dim oM                  As Object           'Single match.\n    Dim oMtch               As Object           'Match collection.\n    Dim oS                  As Object           'Number of matches found.\n    Dim LastCol             As String           'Identify last column used.\n    Dim LastColLetter       As String           'Last Column letter.\n    Dim s1LastCol           As String           'Identify last column in Row 1 used.\n    Dim s1LastColLetter     As String           'Last column in Row 1 letter.\n    Dim sCurrCol            As String           'Numerical value of current column.\n    Dim sCurrColLetter      As String           'Alphabetical value of current column.\n    Dim sFile               As String           'File name to search in.\n    Dim sFn                 As String           'Combined path and file to search in.\n    Dim sPath               As String           'Path of file to search in.\n    Dim sTxt                As String           'Variable to hold scripting.filesystemobject.\n    Dim vArr                As Variant          'Array containing all finlenames.\n\n'   Turn the following activity off to increase program speed.\n    With Application\n        .StatusBar = True\n        .EnableEvents = False\n        .DisplayAlerts = False\n        .ScreenUpdating = False\n    End With\n\n    dStartTime = Now()                                   'For testing purposes ONLY.\n\n    Sheets(\"Failures\").Activate\n    LastCol = ActiveSheet.UsedRange.SpecialCells(xlLastCell).Column\n    If LastCol &gt; 26 Then\n        LastColLetter = Chr(Int((LastCol - 1) / 26) + 64) &amp; Chr(((LastCol - 1) Mod 26) + 65)\n    Else\n        LastColLetter = Chr(LastCol + 64)\n    End If\n\n'   Get last row used by any column in current range.\n    LastRow = ActiveSheet.UsedRange.Rows.Count\n\n'   Set range values.\n    vArr = Range(\"B1:\" &amp; LastColLetter &amp; LastRow).Value\n    Columns(\"B:\" &amp; LastColLetter).Delete Shift:=xlToLeft    'Delete previous data.\n\n    sPath = \"U:\\Serial_Server_Data\\\"                        'Get path name.\n\n    Sheets(\"Log Files\").Activate\n\n'   Will provide the last used column letter.\n    LastCol = ActiveSheet.UsedRange.SpecialCells(xlLastCell).Column\n    If LastCol &gt; 26 Then\n        LastColLetter = Chr(Int((LastCol - 1) / 26) + 64) &amp; Chr(((LastCol - 1) Mod 26) + 65)\n    Else\n        LastColLetter = Chr(LastCol + 64)\n    End If\n\n'   Get last row used by any column in current range.\n    LastRow = ActiveSheet.UsedRange.Rows.Count\n\n'   Set range values.\n    vArr = Range(\"C2:\" &amp; LastColLetter &amp; LastRow).Value\n\n'   Initialize variables.\n    z = 1\n    bFound = False\n\n'   Step through files to apply Pattern to.\n    For i = LBound(vArr, 1) To UBound(vArr, 1)          'Step through rows to apply Pattern to.\n        For j = LBound(vArr, 2) To UBound(vArr, 2)      'Step through columns to apply Pattern to.\n\n            If vArr(i, j) = \"\" Then GoTo SkipAll        'Skip cell if empty.\n\n            sFile = vArr(i, j)                          'Get file name.\n            lFileLen = GetDirOrFileSize(sPath, sFile)   'Get the file size for later use.\n\n            If lFileLen &gt; 200 Then          'Only search files that are over 200 bytes in length.\n                Application.StatusBar = \"Processing file \" &amp; z &amp; \" - \" &amp; sFile\n\n'               Create full path with filename.\n                sFn = sPath &amp; sFile\n\n'               Determine the next file number available for use by the FileOpen function\n                sTxt = FreeFile\n\n                sTxt = CreateObject(\"scripting.filesystemobject\").OpenTextFile(sFn).ReadAll\n\n'                i = 0\n                With CreateObject(\"vbscript.regexp\")    'Search for serial number.\n                    .Global = False                     'Search for first instance.\n                    .IgnoreCase = True                  'Select either upper or lowercase.\n                    .Pattern = \"Serial\\sNo.\\s\\d{4}\"\n                    Set oMtch = .Execute(sTxt)\n                    For Each oM In oMtch\n                        For Each oS In .Execute(oM.Value)\n'                            Debug.Print oS.Value\n\n                            If oS &lt;&gt; vbNull Then    'Continue on only if serial number found.\n                                Sheets(\"Failures\").Activate\n                                Range(\"A1\").Activate\n                                Do While ActiveCell.Value &lt;&gt; \"\"\n                                    ActiveCell.Offset(0, 1).Activate\n\n'                                   sFile already exists.\n                                    If ActiveCell.Value = Right(oS.Value, 4) Then\n                                        sCurrCol = ActiveCell.Column\n                                        Do While ActiveCell.Value &lt;&gt; \"\"\n                                            ActiveCell.Offset(1, 0).Activate\n                                        Loop\n                                        ActiveCell.Value = sFile\n\n'                                       Get column letter from column number.\n                                        If sCurrCol &gt; 26 Then\n                                            sCurrColLetter = Chr(Int((sCurrCol - 1) / 26) + 64) _\n                                                &amp; Chr(((sCurrCol - 1) Mod 26) + 65)\n                                        Else\n                                            sCurrColLetter = Chr(sCurrCol + 64)\n                                        End If\n\n'                                       Center cell.\n                                        iCurrentRow = Application.WorksheetFunction.CountA(Range _\n                                            (sCurrColLetter &amp; \":\" &amp; sCurrColLetter))\n                                        Range(sCurrColLetter &amp; iCurrentRow).HorizontalAlignment _\n                                            = xlCenter\n\n'                                       Adjust the column to fit file name.\n                                        Columns(sCurrColLetter &amp; \":\" &amp; _\n                                            sCurrColLetter).ColumnWidth = 35\n                                        bFound = True\n                                        z = z + 1\n                                        Exit Do\n                                    End If\n                                Loop\n\n'                               sFile doesn't exist.\n                                If ActiveCell.Value = \"\" And bFound = False Then\n                                    ActiveCell.Value = Right(oS.Value, 4)\n                                    ActiveCell.Offset(1, 0).Value = sFile\n                                    sCurrCol = ActiveCell.Column\n\n'                                   Get column letter from column number.\n                                    If sCurrCol &gt; 26 Then\n                                        sCurrColLetter = Chr(Int((sCurrCol - 1) / 26) + 64) _\n                                            &amp; Chr(((sCurrCol - 1) Mod 26) + 65)\n                                    Else\n                                        sCurrColLetter = Chr(sCurrCol + 64)\n                                    End If\n\n'                                   Center cell.\n                                    iCurrentRow = Application.WorksheetFunction.CountA(Range _\n                                        (sCurrColLetter &amp; \":\" &amp; sCurrColLetter))\n                                    Range(sCurrColLetter &amp; iCurrentRow).HorizontalAlignment _\n                                        = xlCenter\n\n'                                   Adjust the column to fit file name.\n                                    Columns(sCurrColLetter &amp; \":\" &amp; sCurrColLetter).ColumnWidth _\n                                        = 35\n                                    z = z + 1\n                                End If\n                            End If\n                        Next\n                    Next\n\n'   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n'   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n'   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  Beginning of area of concern.\n'   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n'   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n\n                    .Global = True                      'Search for instance.\n                    .IgnoreCase = True                  'Select either upper or lowercase.\n\n'                   Search for 'failed' with any amount of text on either side.\n                    .Pattern = \".*failed.*\"\n                    Set oMtch = .Execute(sTxt)\n                    For Each oM In oMtch\n                        For Each oS In .Execute(oM.Value)\n                            iNextRow = Application.WorksheetFunction.CountA(Range _\n                                (sCurrColLetter &amp; \":\" &amp; sCurrColLetter)) + 1\n                            If Left(oS.Value, 4) = \"LOG:\" Then\n\n'                               Ignore FLR-x PeakDetector Dash failure.\n                                If UCase(Mid(oS.Value, 32, 3)) &lt;&gt; \"FLR\" Then\n\n'                                   Print all other \"Failed\" occurances.\n                                    Range(sCurrColLetter &amp; iNextRow).Activate\n                                    ActiveCell.Value = Mid(oS.Value, 6, 16)\n                                End If\n                            End If\n                            If Mid(oS.Value, 4, 4) = \"LOG:\" Then\n                                Range(sCurrColLetter &amp; iNextRow).Activate\n                                ActiveCell.Value = Mid(oS.Value, 9, 16)\n                            End If\n                        Next\n                    Next\n                End With\n            End If\n\n'   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n'   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n'   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;  End of area of concern.\n'   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n'   &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;\n\nSkipAll:\n            bFound = False\n            Sheets(\"Log Files\").Activate\n        Next j\n    Next i\n\n'   Cleanup: Add borders, heading background fill, remove gridlines.\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 344, "user_id": 7915175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff6640a70932cf34a7f78a9faf5a208?s=128&d=identicon&r=PG&f=1", "display_name": "aozk", "link": "https://stackoverflow.com/users/7915175/aozk"}, "edited": false, "score": 0, "creation_date": 1540472497, "post_id": 52968149, "comment_id": 92885029, "body": "I tried use GetAncestor in many ways, i can&#39;t understand how it excatly works. Anyway, I still can&#39;t change position of osk.exe. Could you explain that in my example with On-Screen Keyboard?"}], "tags": [], "owner": {"reputation": 513, "user_id": 10059074, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d5f487d1ae5cbf54ac9f5641f10c5fb4?s=128&d=identicon&r=PG", "display_name": "CatCat", "link": "https://stackoverflow.com/users/10059074/catcat"}, "is_accepted": false, "score": 1, "last_activity_date": 1540383664, "last_edit_date": 1540383664, "creation_date": 1540381423, "answer_id": 52968149, "question_id": 52967751, "link": "https://stackoverflow.com/questions/52967751/setwindowpos-doesnt-works-with-some-programs/52968149#52968149", "title": "SetWindowPos doesn&#39;t works with some programs", "body": "<p>This is the Window List for Edge with one tab open to Google.</p>\n\n<pre><code>WindowText  ClassName   HWnd    ParentHWnd  ProcessID   ParentProcessID ThreadID    ModuleNameHWin  EXENameProcess\n-------------------------------------------------------------------------------------------------------------------\nMicrosoft Edge  Windows.UI.Core.CoreWindow  82182908    45353128    7336    968 3544    \u00abNot Available Error=126\u00bb   MicrosoftEdge.exe\n    \u00abNo Window Text 0\u00bb  Spartan ServiceUI XAML-To-Trident Input Routing Window  21627338    82182908    7336    968 1112    \u00abNot Available Error=126\u00bb   MicrosoftEdge.exe\n    \u00abNo Window Text 0\u00bb  Spartan XAML-To-Trident Input Routing Window    54593368    82182908    7336    968 1112    \u00abNot Available Error=126\u00bb   MicrosoftEdge.exe\n        \u00abNo Window Text 0\u00bb  Spartan Tab XAML-To-Trident Input Routing Window    64488388    54593368    7336    968 1112    \u00abNot Available Error=126\u00bb   MicrosoftEdge.exe\n            Google  TabWindowClass  30934882    64488388    7992    4380    3564    \u00abNot Available Error=126\u00bb   MicrosoftEdgeCP.exe\n                CoreInput   Windows.UI.Core.CoreComponentInputSource    57214268    30934882    7992    4380    3564    \u00abNot Available Error=126\u00bb   MicrosoftEdgeCP.exe\n                \u00abNo Window Text 0\u00bb  Internet Explorer_Server    64620588    30934882    7992    4380    3564    \u00abNot Available Error=126\u00bb   MicrosoftEdgeCP.exe\n        \u00abNo Window Text 0\u00bb  Spartan ServiceUI XAML-To-Trident Input Routing Window  30344376    54593368    7336    968 1112    \u00abNot Available Error=126\u00bb   MicrosoftEdge.exe\n        \u00abNo Window Text 0\u00bb  Spartan ServiceUI XAML-To-Trident Input Routing Window  29230712    54593368    7336    968 1112    \u00abNot Available Error=126\u00bb   MicrosoftEdge.exe\n</code></pre>\n\n<p>You can't size child windows bigger than the parent window. And it's in relation to the parent window not the desktop window. Your Window is 4 levels down. The second field is the ClassName, as the top window doesn't have a title (well it's the same for all MS Edge running).</p>\n\n<p>This function may help.</p>\n\n<blockquote>\n  <p><strong>GetAncestor</strong></p>\n  \n  <p>The GetAncestor function retrieves the handle to the ancestor of the\n  specified window. </p>\n\n<pre><code>HWND GetAncestor(\n  HWND hwnd,    // handle to window\n  UINT gaFlags  // ancestor\n);\n</code></pre>\n  \n  <p><strong>Parameters</strong></p>\n  \n  <p>hwnd  [in] Handle to the window whose ancestor is to be retrieved. If\n  this parameter is the desktop window, the function returns NULL. </p>\n  \n  <p>gaFlags  [in] Specifies the ancestor to be retrieved. This parameter\n  can be one of the following values. </p>\n  \n  <p><strong>Value Meaning</strong><br>\n  <strong>GA_PARENT</strong> Retrieves the parent window. This does not include the owner, as it does with the GetParent function.<br>\n  <strong>GA_ROOT</strong> Retrieves the root window by walking the chain of parent windows. \n  <strong>GA_ROOTOWNER</strong> Retrieves the owned root window by walking the chain of parent and owner windows returned by GetParent.  </p>\n  \n  <p><strong>Return Values</strong> The return value is the handle to the ancestor window.</p>\n</blockquote>\n\n<p>From Help.</p>\n\n<p>Also Edge is for Users. The browser for automation is Internet Explorer. It is also the browser for automating editing of HTML or for incorporating Browser controls into your app. (note this is vbscript and if you use it in VBA remove the <code>wscript.sleep</code> line as VBA can't use that line but it has it's own equiv.</p>\n\n<pre><code>Set ie = CreateObject(\"InternetExplorer.Application\")\nie.Navigate2 \"www.google.com.au\"\nie.visible=true\nwscript.sleep 5000\nie.refresh2 \nie.top=0\nie.left=0\nie.height=200\nie.width=100 \n</code></pre>\n"}], "owner": {"reputation": 344, "user_id": 7915175, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fff6640a70932cf34a7f78a9faf5a208?s=128&d=identicon&r=PG&f=1", "display_name": "aozk", "link": "https://stackoverflow.com/users/7915175/aozk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540383664, "creation_date": 1540380311, "question_id": 52967751, "link": "https://stackoverflow.com/questions/52967751/setwindowpos-doesnt-works-with-some-programs", "title": "SetWindowPos doesn&#39;t works with some programs", "body": "<p>I have a problem with positioning and moving on-screen keyboard (osk.exe). I used <em>SetWindowsPos</em> to do this, but it takes no effect. I also tried use <em>MoveWindow</em> instead of <em>SetWindowsPos</em> but it takes no effect too. I used <em>SetWindowsPos</em> on Mozilla Firefox and it works fine. I have no idea why it only works with some programs.<br>\nIt is my code:   </p>\n\n<pre><code>Private Declare Function FindWindow Lib \"user32\" Alias \"FindWindowA\" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long\nPrivate Declare Sub SetWindowPos Lib \"user32\" (ByVal hwnd As Long, ByVal hWndInsertAfter As Long, ByVal x As Long, ByVal y As Long, ByVal cx As Long, ByVal cy As Long, ByVal wFlags As Long)\n\nPrivate Sub ResizeOsk()\nDim retval As Long\nDim OskHandle As Long\nOskHandle = FindWindow(vbNullString, \"Klawiatura ekranowa\")\nSetWindowPos OskHandle, -1, 0, 0, 1000, 1000, &amp;H40\n'MoveWindow OskHandle, 500, 400, 1500, 1000, 1\nEnd Sub\n</code></pre>\n\n<p>When I debug the program, variable OskHandle isn't empty.<br>\nMaybe is there another solution to solve my problem with positioning on-screen keyboard.</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "is_accepted": true, "score": 1, "last_activity_date": 1540388266, "creation_date": 1540388266, "answer_id": 52970472, "question_id": 52967571, "link": "https://stackoverflow.com/questions/52967571/how-can-i-quickly-identify-a-blank-table-column-in-word/52970472#52970472", "title": "How Can I Quickly Identify a Blank Table Column in Word?", "body": "<p>What you want to do is perfectly possible but can run into an issue.  There is a difference in the number of cells in the selection range reported (and consequently the text to process) depending on whether you use</p>\n\n<pre><code>selection.cells\n</code></pre>\n\n<p>or</p>\n\n<pre><code>selection.range.cells\n</code></pre>\n\n<p>The former works as expected, the latter does not.</p>\n\n<p>The code below deletes columns in the way in which you describe and also includes debug.print statements to demonstrate the problem.</p>\n\n<p>I've tested the code on a 5x6 table.  Your experience may differ.</p>\n\n<pre><code>Sub DeleteEmptyTableColumns(this_table As Word.Table)\n    Dim my_cells                As Range\n    Dim my_column               As Long\n    Dim my_text                 As String\n    Dim my_last_row             As Long\n\n    ' Assumes that the Table is uniform\n    my_last_row = this_table.Rows.Count\n    Application.ScreenUpdating = False\n\n    With this_table\n        For my_column = .Columns.Count To 1 Step -1\n            DoEvents\n            Set my_cells = .Range.Document.Range( _\n                Start:=.Cell(2, my_column).Range.Start, _\n                End:=.Cell(my_last_row, my_column).Range.End)\n            ' We have to use selection to get the correct text\n            my_cells.Select\n\n            Debug.Print\n            ' Wrong numbers and text\n            Debug.Print my_cells.Cells.Count\n            Debug.Print my_cells.Text\n\n            ' Correct information\n            Debug.Print Selection.Cells.Count\n            Debug.Print Selection.Text\n\n            ' Back to the wrong information\n            Debug.Print Selection.Range.Cells.Count\n            Debug.Print Selection.Range.Text\n\n            my_text = Selection.Text\n\n            ' Add other replacments as required.\n            my_text = Replace(my_text, \" \", vbNullString)\n            my_text = Replace(my_text, vbCrLf, vbNullString)\n            my_text = Replace(my_text, Chr$(13), vbNullString)\n            my_text = Replace(my_text, Chr$(7), vbNullString)\n\n            If Len(my_text) = 0 Then\n                this_table.Columns(my_column).Delete\n\n            End If\n\n        Next\n\n    End With\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 942495, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/rA4mL.jpg?s=128&g=1", "display_name": "CaptainFuzzyFace", "link": "https://stackoverflow.com/users/942495/captainfuzzyface"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 52970472, "answer_count": 1, "score": 1, "last_activity_date": 1586675337, "creation_date": 1540379807, "last_edit_date": 1586675337, "question_id": 52967571, "link": "https://stackoverflow.com/questions/52967571/how-can-i-quickly-identify-a-blank-table-column-in-word", "title": "How Can I Quickly Identify a Blank Table Column in Word?", "body": "<p>I have a lot of large tables in automatically generated word documents and I want to delete columns that have no values in them. They will all have headers, so essentially I need to check the values of rows 2 to the end or just get the whole column in a string and check after the first chr(14) which I understand is the column marker.</p>\n\n<p>Is this possible without looping through the cells, row by row, which appears to be slow, or selecting the column which seems to cause the screen to have issues and the UI freezes, sometimes crashing Word.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1540378160, "creation_date": 1540378160, "answer_id": 52967089, "question_id": 52966906, "link": "https://stackoverflow.com/questions/52966906/change-font-size-font-family-long-name-on-outlook-mail-through-vba/52967089#52967089", "title": "Change font size &amp; font family (long name) on Outlook mail through VBA", "body": "<p>Try using single quotes within the quoted string. It's allowed in HTML styles.</p>\n\n<pre><code>strbody = \"&lt;BODY style='font-size:12pt;font-family:Times New Roman'&gt;\" &amp; \"Hello\" &amp; \"&lt;/BODY&gt;\"\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 9960421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8f90c51776d36614de1077414eafb2d?s=128&d=identicon&r=PG&f=1", "display_name": "Shira L.", "link": "https://stackoverflow.com/users/9960421/shira-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 52967089, "answer_count": 1, "score": 0, "last_activity_date": 1586462990, "creation_date": 1540377633, "last_edit_date": 1586462990, "question_id": 52966906, "link": "https://stackoverflow.com/questions/52966906/change-font-size-font-family-long-name-on-outlook-mail-through-vba", "title": "Change font size &amp; font family (long name) on Outlook mail through VBA", "body": "<p>In addition to the question : <a href=\"https://stackoverflow.com/questions/22200910/change-html-email-body-font-type-and-size-in-vba\">Change HTML email body font type and size in VBA</a>, i would like to know how can i change both the font size &amp; the font family with long name. \nHere is my code which change only the font size:</p>\n\n<pre><code>strbody = \"&lt;BODY style=\" &amp; Chr(34) &amp; \"font-size:12pt;\" &amp; Chr(34) &amp; \"font-family:Times New Roman\" &amp; Chr(34) &amp; \"&gt;\" &amp; \"Hello\" &amp; \"&lt;/BODY&gt;\"\n</code></pre>\n\n<p>When i remove the font size from the code it's indeed change the font-family.</p>\n\n<p>Thanks for your assistance,</p>\n"}, {"tags": ["excel", "vba", "powerpoint", "activexobject"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1540378486, "post_id": 52966671, "comment_id": 92840608, "body": "You have a typo where you assign the Powerpoint filename (<code>detinationppt</code> instead of <code>destinationppt</code>). Always use <b>Option Explicit</b> to avoid such errors."}, {"owner": {"reputation": 1, "user_id": 10254986, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h7xggrzUN04/AAAAAAAAAAI/AAAAAAAAAIU/J8iWVHb5vgo/photo.jpg?sz=128", "display_name": "dharven tyagi", "link": "https://stackoverflow.com/users/10254986/dharven-tyagi"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1540378868, "post_id": 52966671, "comment_id": 92840819, "body": "thanks, but I still get the same error. &quot;activeX cant create the object&quot;. Should I change my code?"}, {"owner": {"reputation": 1, "user_id": 10254986, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h7xggrzUN04/AAAAAAAAAAI/AAAAAAAAAIU/J8iWVHb5vgo/photo.jpg?sz=128", "display_name": "dharven tyagi", "link": "https://stackoverflow.com/users/10254986/dharven-tyagi"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1540379403, "post_id": 52966671, "comment_id": 92841131, "body": "I have a code which is working fine,  it is copying a data range from excel and pasting it into new powerpoint file. I want help to change it to copy paste into an existing powerpoint file, rather than creating a new one.  I want this range to be pasted in an existing ppt slide no 4."}, {"owner": {"reputation": 1, "user_id": 10254986, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h7xggrzUN04/AAAAAAAAAAI/AAAAAAAAAIU/J8iWVHb5vgo/photo.jpg?sz=128", "display_name": "dharven tyagi", "link": "https://stackoverflow.com/users/10254986/dharven-tyagi"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1540379444, "post_id": 52966671, "comment_id": 92841161, "body": "Here is the code: (if this helps), this is working fine but this creates a new excel sheet and I want to create into an existing. Please see the answer below:"}], "answers": [{"comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1540382413, "post_id": 52967488, "comment_id": 92843081, "body": "Please don&#39;t put a change in your question as answer - instead, edit your original question"}], "tags": [], "owner": {"reputation": 1, "user_id": 10254986, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h7xggrzUN04/AAAAAAAAAAI/AAAAAAAAAIU/J8iWVHb5vgo/photo.jpg?sz=128", "display_name": "dharven tyagi", "link": "https://stackoverflow.com/users/10254986/dharven-tyagi"}, "is_accepted": false, "score": -1, "last_activity_date": 1540382363, "last_edit_date": 1540382363, "creation_date": 1540379490, "answer_id": 52967488, "question_id": 52966671, "link": "https://stackoverflow.com/questions/52966671/active-x-error-429-cannot-create-an-object-when-i-try-to-run-the-below-macro/52967488#52967488", "title": "Active X error 429 cannot create an object , when I try to run the below macro", "body": "<p>Here is the code which is working fine:</p>\n\n<pre><code>Sub ExcelRangeToPowerPoint()\n\nDim rng As Range\nDim PowerPointApp As Object\nDim myPresentation As Object\nDim mySlide As Object\nDim myShape As Object\n\n'Range to copy\nSet rng = Worksheets(\"regions\").Range(\"B1:N18\")\n\nOn Error Resume Next\n\nSet PowerPointApp = GetObject(class:=\"PowerPoint.Application\")\n\nErr.Clear\n\n'If PowerPoint is not already open then open PowerPoint\nIf PowerPointApp Is Nothing Then Set PowerPointApp = CreateObject(class:=\"PowerPoint.Application\")\n\n'Handle if the PowerPoint Application is not found\nIf Err.Number = 429 Then\nMsgBox \"PowerPoint could not be found, aborting.\"\nExit Sub\nEnd If\n\nOn Error GoTo 0\n\nApplication.ScreenUpdating = False\n\n'To create new presentation\nSet myPresentation = PowerPointApp.Presentations.Add\n'to add new slide to the Presentation\nSet mySlide = myPresentation.Slides.Add(1, 11) '11 = ppLayoutTitleOnly\n\nrng.Copy\n\n'Paste to PowerPoint and position\nmySlide.Shapes.PasteSpecial DataType:=2  '2 = ppPasteEnhancedMetafile\nSet myShape = mySlide.Shapes(mySlide.Shapes.Count)\n\nmyShape.Left = 152\nmyShape.Top = 152\n\nPowerPointApp.Visible = True\nPowerPointApp.Activate\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1540395661, "last_edit_date": 1540395661, "creation_date": 1540384303, "answer_id": 52969066, "question_id": 52966671, "link": "https://stackoverflow.com/questions/52966671/active-x-error-429-cannot-create-an-object-when-i-try-to-run-the-below-macro/52969066#52969066", "title": "Active X error 429 cannot create an object , when I try to run the below macro", "body": "<p>You have two undefined variables in your code </p>\n\n<p><code>detinationppt</code> instead of <code>destinationppt</code><br>\nYou assign the PowerPoint Application Object to <code>powerpointapp</code>, but 2 lines later you access an (undefined) object <code>PowerPoint</code></p>\n\n<p>You can easily avoid such errors by putting <code>Option Explicit</code> at the top of your code.</p>\n\n<p>Next thing is that you can assign the opened presentation rather than access the <code>ActivePresentation</code>. I made a test, and for me accessing  <code>ActivePresentation</code> failed.</p>\n\n<p>And please don't put <code>On Error resume Next</code> into your code unless you know exactly what you're doing. If you want to avoid a runtime error because Powerpoint coudn't be started, you have to handle the error case by yourself (as it is done by your \"code which is working fine\"). For the beginning, simply remove it.</p>\n\n<p>This code worked for me (of course with a different file name)</p>\n\n<pre><code>Set powerpointApp = CreateObject(\"powerpoint.application\")\ndestinationPPT = C:\\Users\\OLX-Admin\\Dropbox (Corporate Finance)\\Naspers Monthly Reporting\\Prep for call\\From teams\\FY2019\\OLX Group Monthly Report_Sep'18_Macro.pptx    \nSet myPresentation = powerpointApp.Presentations.Open(destinationPPT)\nSet mySlide = myPresentation.Slides(4)\n(...)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1540384305, "creation_date": 1540384305, "answer_id": 52969067, "question_id": 52966671, "link": "https://stackoverflow.com/questions/52966671/active-x-error-429-cannot-create-an-object-when-i-try-to-run-the-below-macro/52969067#52969067", "title": "Active X error 429 cannot create an object , when I try to run the below macro", "body": "<p>First, add this line to the top of your module, as the very first text in the whole thing:</p>\n\n<pre><code>Option Explicit\n</code></pre>\n\n<p>Then, in the Menu bar click \"Debug\" and \"Compile VBA Project\"</p>\n\n<p>You will get a series of Error Messages, like this:</p>\n\n<blockquote>\n  <p>Compile error:  </p>\n  \n  <p>Variable not defined</p>\n</blockquote>\n\n<p>And the variable that has not been defined will be Selected for you by VBA.  Most of these seem to be typos, such as</p>\n\n<ul>\n<li><code>detinationppt = (\"C:</code> instead of <code>destinationPPT = (\"C:</code>  </li>\n<li><code>PowerPoint.Presentations.Open (destinationPPT)</code> instead of <code>PowerPointApp.Presentations.Open (destinationPPT)</code>  </li>\n<li><code>Set mypresentation = PowerPoint.ActivePresentation</code> instead of <code>Set mypresentation = PowerPointApp.ActivePresentation</code></li>\n</ul>\n\n<p>Basically, it looks like you have copied and pasted 2 different blocks of code together, and forgotten to check that the Variable Names all match up (also, one seems to be <a href=\"https://support.microsoft.com/en-gb/help/245115/using-early-binding-and-late-binding-in-automation\" rel=\"nofollow noreferrer\">Early Binding, and the other is Late Binding</a>)</p>\n\n<p>If you go to \"Tools\" > \"Options...\" > \"Editor\", there is a Tickbox, \"Require Variable Declaration\".  Turn this on, leave this on, and use the \"Compile VBA Project\" option regularly to check for typos and similar errors.</p>\n"}], "owner": {"reputation": 1, "user_id": 10254986, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-h7xggrzUN04/AAAAAAAAAAI/AAAAAAAAAIU/J8iWVHb5vgo/photo.jpg?sz=128", "display_name": "dharven tyagi", "link": "https://stackoverflow.com/users/10254986/dharven-tyagi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 282, "favorite_count": 1, "answer_count": 3, "score": -1, "last_activity_date": 1540395661, "creation_date": 1540376910, "last_edit_date": 1540378328, "question_id": 52966671, "link": "https://stackoverflow.com/questions/52966671/active-x-error-429-cannot-create-an-object-when-i-try-to-run-the-below-macro", "title": "Active X error 429 cannot create an object , when I try to run the below macro", "body": "<p>So, I am trying to create a macro which will copy data from an excel sheet (in this case sheet \"Regions\") and then copy paste in an existing powerpoint template, slide no 4.</p>\n\n<p>Please note the powerpoint and excel file both are saved in a dropbox folder. (if that changes anything)\nI am not an expert in VBA so cannot understand why it is showing me this error.</p>\n\n<p>The code is below:</p>\n\n<pre><code>Sub excelrangetopowerpoint()\n\nDim rng As Range\nDim powerpointapp As Object\nDim mypresentation As Object\nDim destinationPPT As String\nDim myshape As Object\nDim myslide As Object\n\nSet rng = Worksheets(\"regions\").Range(\"B1:N18\")\n\nOn Error Resume Next\n\nSet powerpointapp = CreateObject(\"powerpoint.application\")\ndetinationppt = (\"C:\\Users\\OLX-Admin\\Dropbox (Corporate Finance)\\Naspers Monthly Reporting\\Prep for call\\From teams\\FY2019\\OLX Group Monthly Report_Sep'18_Macro.pptx\")\nPowerPoint.Presentations.Open (destinationPPT)\n\nOn Error GoTo 0\n\nApplication.ScreenUpdating = False\n\nSet mypresentation = PowerPoint.ActivePresentation\nSet myslide = mypresentation.Slides(4)\n\nrng.Copy\n\nmyslide.Shapes.PasteSpecial DataType:=2 '2 = enhanced metafile\nSet myshape = myslide.Shapes(myslide.Shapes.Count)\n\nmyshape.Left = 152\nmyshape.Top = 152\n\npowerpointapp.Visible = True\npowerpointapp.Activate\n\nApplication.CutCopyMode = False\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/3ak0D.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3ak0D.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 5650329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/021503ecae4265393b3ef05723fe7d24?s=128&d=identicon&r=PG&f=1", "display_name": "P.Costa", "link": "https://stackoverflow.com/users/5650329/p-costa"}, "edited": false, "score": 0, "creation_date": 1540375489, "post_id": 52966181, "comment_id": 92838812, "body": "it gives me a runtime error 13 type mismatch (i only run the last case &quot;A&quot;, the other code was commented out"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 79, "user_id": 5650329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/021503ecae4265393b3ef05723fe7d24?s=128&d=identicon&r=PG&f=1", "display_name": "P.Costa", "link": "https://stackoverflow.com/users/5650329/p-costa"}, "edited": false, "score": 0, "creation_date": 1540375558, "post_id": 52966181, "comment_id": 92838861, "body": "Did you catch my recent edit? I missed changing to <code>Select Case True</code>"}, {"owner": {"reputation": 79, "user_id": 5650329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/021503ecae4265393b3ef05723fe7d24?s=128&d=identicon&r=PG&f=1", "display_name": "P.Costa", "link": "https://stackoverflow.com/users/5650329/p-costa"}, "edited": false, "score": 0, "creation_date": 1540376289, "post_id": 52966181, "comment_id": 92839256, "body": "let me try this"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1540375288, "creation_date": 1540375288, "answer_id": 52966181, "question_id": 52965994, "link": "https://stackoverflow.com/questions/52965994/select-statement-with-multiple-true-conditions-excel-vba/52966181#52966181", "title": "Select Statement with multiple true conditions Excel vba", "body": "<p>You could evaluate the Select for True.</p>\n\n<pre><code>Select Case True\n    Case Cells(i, 248) = \"B\"\n        Fees_Jan = (Cells(i, 267).Value - Cells(i, 265)) / 2\n    Case Cells(i, 248) = \"C\"\n        Fees_Jan = (Cells(i, 267).Value - Cells(i, 265)) * 0.25\n    Case Cells(i, 248) = \"A\" And Cells(i, 250) = \"BANANAS\" And Cells(i, 236) = \"WILLHILL_CLEVERADV_HYBRID\"\n        Fees_Jan = (Cells(i, 267).Value * 0.35 / 1 / 2)\n    Case Cells(i, 248) = \"A\" And Cells(i, 250) = \"PERAS\" And Cells(i, 236) = \"MORANGOS\"\n        Fees_Jan = ((Cells(i, 262).Value) * 0.2 / 2) + (Cells(i, 263).Value - (Cells(i, 265).Value) / 3)\n    Case Else\n        Fees_Jan = Cells(i, 265).Value / 2\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5650329, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/021503ecae4265393b3ef05723fe7d24?s=128&d=identicon&r=PG&f=1", "display_name": "P.Costa", "link": "https://stackoverflow.com/users/5650329/p-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 52966181, "answer_count": 1, "score": 2, "last_activity_date": 1586463026, "creation_date": 1540374728, "last_edit_date": 1586463026, "question_id": 52965994, "link": "https://stackoverflow.com/questions/52965994/select-statement-with-multiple-true-conditions-excel-vba", "title": "Select Statement with multiple true conditions Excel vba", "body": "<p>i am trying to make a macro run with a state case with multiple conditions, i know that we are supost to use a \" , \" to separate multiple conditions, but what can we use to separate conditions that both have to be met?</p>\n\n<p>here is the code</p>\n\n<pre><code>Select Case Cells(i, 248)\n        Case \"B\":    Fees_Jan = (Cells(i, 267).Value - Cells(i, 265)) / 2\n        Case \"C\":    Fees_Jan = (Cells(i, 267).Value - Cells(i, 265)) * 0.25\n        Case \"A\", Cells(i, 250) = \"BANANAS\", Cells(i, 236) = \"MA\u00c7AS\": Fees_Jan = (Cells(i, 267).Value * 0.35 / 1 / 2)\n        Case \"A\", Cells(i, 250) = \"PERAS\", Cells(i, 236) = \"MORANGOS\": Fees_Jan = ((Cells(i, 262).Value) * 0.2 / 2) + (Cells(i, 263).Value - (Cells(i, 265).Value) / 3)\n        Case Else:     Fees_Jan = Cells(i, 265).Value / 2\n    End Select\n</code></pre>\n\n<p>if i isolate and run only the last Case \"A\", it works fine, but wen i run all the code it doesent work well.. can anyone help please?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2197, "user_id": 1725871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06e1c4b46656313883eda6e96e9ab4e9?s=128&d=identicon&r=PG", "display_name": "JoSSte", "link": "https://stackoverflow.com/users/1725871/josste"}, "edited": false, "score": 0, "creation_date": 1540375002, "post_id": 52965422, "comment_id": 92838504, "body": "Hi. welcome to SO. You get the best answers by showing your own effort to solve the problem, instead of just stating what you wnt to achieve..."}, {"owner": {"reputation": 1, "user_id": 10550939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0285a0b19a49f459a4cdbae57860524?s=128&d=identicon&r=PG&f=1", "display_name": "Riccardo15", "link": "https://stackoverflow.com/users/10550939/riccardo15"}, "reply_to_user": {"reputation": 2197, "user_id": 1725871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06e1c4b46656313883eda6e96e9ab4e9?s=128&d=identicon&r=PG", "display_name": "JoSSte", "link": "https://stackoverflow.com/users/1725871/josste"}, "edited": false, "score": 0, "creation_date": 1540375366, "post_id": 52965422, "comment_id": 92838725, "body": "Hi. welcome to SO. You get the best answers by showing your own effort to solve the problem, instead of just stating what you wnt to achieve... \u2013 JoSSte  Hi @JoSSte, thanks for your replay. I&#39;m currently working on the code, but I have no clue on how to solve the problem. At the moment I&#39;m trying with a classic For i to NumRows loop, but I can&#39;t go any further. Do you have any suggestions?"}, {"owner": {"reputation": 2197, "user_id": 1725871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06e1c4b46656313883eda6e96e9ab4e9?s=128&d=identicon&r=PG", "display_name": "JoSSte", "link": "https://stackoverflow.com/users/1725871/josste"}, "edited": false, "score": 0, "creation_date": 1540375681, "post_id": 52965422, "comment_id": 92838909, "body": "The code you have listed is with the ibox. have you got some (not working) code with the loop you described?"}, {"owner": {"reputation": 1, "user_id": 10550939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0285a0b19a49f459a4cdbae57860524?s=128&d=identicon&r=PG&f=1", "display_name": "Riccardo15", "link": "https://stackoverflow.com/users/10550939/riccardo15"}, "reply_to_user": {"reputation": 2197, "user_id": 1725871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06e1c4b46656313883eda6e96e9ab4e9?s=128&d=identicon&r=PG", "display_name": "JoSSte", "link": "https://stackoverflow.com/users/1725871/josste"}, "edited": false, "score": 0, "creation_date": 1540376188, "post_id": 52965422, "comment_id": 92839200, "body": "@JoSSte yes, here is the actual code:  Sub Find_Files() Dim fldr As FileDialog Set fldr = Application.FileDialog(msoFileDialogFolderPicker) fldr.Show f = fldr.SelectedItems(1) f = f &amp; &quot;\\&quot; NumRows = Range(&quot;B14&quot;, Range(&quot;B14&quot;).End(xlDown)).Rows.Count For i = 14 To NumRows sn = Split(CreateObject(&quot;wscript.shell&quot;).exec(&quot;cmd /c Dir &quot;&quot;&quot; &amp; f &amp; Active.Cells &amp; &quot;&quot;&quot; /s /a /b&quot;).stdout.readall, vbCrLf) Cells(i, 2).Offset(0, 1).Resize(UBound(sn) + 1) = Application.Transpose(sn) Next i ext: End Sub  it seems the loop doesn&#39;t works."}, {"owner": {"reputation": 2197, "user_id": 1725871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06e1c4b46656313883eda6e96e9ab4e9?s=128&d=identicon&r=PG", "display_name": "JoSSte", "link": "https://stackoverflow.com/users/1725871/josste"}, "edited": false, "score": 1, "creation_date": 1540380032, "post_id": 52965422, "comment_id": 92841520, "body": "please update your queston ;-)"}, {"owner": {"reputation": 1, "user_id": 10550939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0285a0b19a49f459a4cdbae57860524?s=128&d=identicon&r=PG&f=1", "display_name": "Riccardo15", "link": "https://stackoverflow.com/users/10550939/riccardo15"}, "reply_to_user": {"reputation": 2197, "user_id": 1725871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06e1c4b46656313883eda6e96e9ab4e9?s=128&d=identicon&r=PG", "display_name": "JoSSte", "link": "https://stackoverflow.com/users/1725871/josste"}, "edited": false, "score": 0, "creation_date": 1540381766, "post_id": 52965422, "comment_id": 92842654, "body": "@JoSSte alright done. I&#39;m new to both vba and this website so i&#39;m a bit struggling. what do you think about this code? thanks mate!"}, {"owner": {"reputation": 2197, "user_id": 1725871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06e1c4b46656313883eda6e96e9ab4e9?s=128&d=identicon&r=PG", "display_name": "JoSSte", "link": "https://stackoverflow.com/users/1725871/josste"}, "edited": false, "score": 0, "creation_date": 1540382592, "post_id": 52965422, "comment_id": 92843207, "body": "which office application are you using btw? if you mouseover the vba tag, there are some recommendations..."}, {"owner": {"reputation": 1, "user_id": 10550939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0285a0b19a49f459a4cdbae57860524?s=128&d=identicon&r=PG&f=1", "display_name": "Riccardo15", "link": "https://stackoverflow.com/users/10550939/riccardo15"}, "reply_to_user": {"reputation": 2197, "user_id": 1725871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06e1c4b46656313883eda6e96e9ab4e9?s=128&d=identicon&r=PG", "display_name": "JoSSte", "link": "https://stackoverflow.com/users/1725871/josste"}, "edited": false, "score": 0, "creation_date": 1540383050, "post_id": 52965422, "comment_id": 92843494, "body": "excel 2016..sorry to bother you all but I&#39;m trying to make it up for tonight"}, {"owner": {"reputation": 2197, "user_id": 1725871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06e1c4b46656313883eda6e96e9ab4e9?s=128&d=identicon&r=PG", "display_name": "JoSSte", "link": "https://stackoverflow.com/users/1725871/josste"}, "edited": false, "score": 0, "creation_date": 1540384954, "post_id": 52965422, "comment_id": 92844748, "body": "I&#39;m just trying to help you get your question answered..."}, {"owner": {"reputation": 1, "user_id": 10550939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0285a0b19a49f459a4cdbae57860524?s=128&d=identicon&r=PG&f=1", "display_name": "Riccardo15", "link": "https://stackoverflow.com/users/10550939/riccardo15"}, "reply_to_user": {"reputation": 2197, "user_id": 1725871, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/06e1c4b46656313883eda6e96e9ab4e9?s=128&d=identicon&r=PG", "display_name": "JoSSte", "link": "https://stackoverflow.com/users/1725871/josste"}, "edited": false, "score": 0, "creation_date": 1540385320, "post_id": 52965422, "comment_id": 92845030, "body": "didn&#39;t meant to be rude, my point was &quot;I haven&#39;t studied nor vba nor this website because I&#39;m fresh new to both and have no time today to unfortunately&quot;. thanks for your kind help I do really appreciate what you are doing to help me. @JoSSte"}], "owner": {"reputation": 1, "user_id": 10550939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0285a0b19a49f459a4cdbae57860524?s=128&d=identicon&r=PG&f=1", "display_name": "Riccardo15", "link": "https://stackoverflow.com/users/10550939/riccardo15"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586463062, "creation_date": 1540373020, "last_edit_date": 1586463062, "question_id": 52965422, "link": "https://stackoverflow.com/questions/52965422/find-files-in-folder-from-list-and-paste-path", "title": "find files in folder from list and paste path", "body": "<p>I'm currently using the following string to find files into folders, but I would like to make it search automatically from a list of names.\nthe actual code is:</p>\n\n<pre><code>    Sub Find_Files()\nDim fldr As FileDialog\nSet fldr = Application.FileDialog(msoFileDialogFolderPicker)\nfldr.Show\nf = fldr.SelectedItems(1)\nf = f &amp; \"\\\"\nNumRows = Range(\"B14\", Range(\"B14\").End(xlDown)).Rows.Count\nFor i = 14 To NumRows\nsn = Split(CreateObject(\"wscript.shell\").exec(\"cmd /c Dir \"\"\" &amp; f &amp; Active.Cells &amp; \"\"\" /s /a /b\").stdout.readall, vbCrLf)\nCells(i, 2).Offset(0, 1).Resize(UBound(sn) + 1) = Application.Transpose(sn)\nNext i\next:\nEnd Sub\n</code></pre>\n\n<p>I've tried to change the old version which had \"ibox\" code into a \"For i=14 to NumRows\" loop, but it seems to not work.\ndo anyone has an advice on how to make it work?(I'm new with vba coding)</p>\n\n<p>thanks in advance, \nRiccardo</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 945, "user_id": 4219600, "user_type": "registered", "profile_image": "https://graph.facebook.com/511041755/picture?type=large", "display_name": "James Cooke", "link": "https://stackoverflow.com/users/4219600/james-cooke"}, "edited": false, "score": 0, "creation_date": 1540374091, "post_id": 52965195, "comment_id": 92837898, "body": "Post your solution first? - if I was to do this I would just split the commas into an array loop through that array and have a function that checks if the number exists already in a second array - if it does I wouldnt add it otherwise i would"}, {"owner": {"reputation": 1000, "user_id": 1366407, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2D1g2.jpg?s=128&g=1", "display_name": "LadderLogic", "link": "https://stackoverflow.com/users/1366407/ladderlogic"}, "reply_to_user": {"reputation": 945, "user_id": 4219600, "user_type": "registered", "profile_image": "https://graph.facebook.com/511041755/picture?type=large", "display_name": "James Cooke", "link": "https://stackoverflow.com/users/4219600/james-cooke"}, "edited": false, "score": 0, "creation_date": 1540402021, "post_id": 52965195, "comment_id": 92856022, "body": "@JamesCooke, you&#39;re right, I should&#39;ve waited until I got on a computer to post my question."}], "answers": [{"tags": [], "owner": {"reputation": 945, "user_id": 4219600, "user_type": "registered", "profile_image": "https://graph.facebook.com/511041755/picture?type=large", "display_name": "James Cooke", "link": "https://stackoverflow.com/users/4219600/james-cooke"}, "is_accepted": false, "score": 3, "last_activity_date": 1540378542, "creation_date": 1540378542, "answer_id": 52967212, "question_id": 52965195, "link": "https://stackoverflow.com/questions/52965195/distinct-or-unique-values-from-csv-using-vba/52967212#52967212", "title": "Distinct or Unique values from CSV using VBA", "body": "<p>You can use this as a basis for what you want to do - there are some steps to help demonstrate what I said in my comment - perhaps instead of building a collection and then converting it into an array which is joined in the msgbox you could write it to a cell - or do whatever you want with it downstream. This would reduce the need for the collectionToArray function. </p>\n\n<p>Alternatively you could do this with arrays, but i find collections to be neater.</p>\n\n<pre><code>Public Sub GetDistinctCommaSeparated()\n\nDim values As String\nDim valuesArr() As String\nDim DistinctCol As New Collection\n\n' Get an array from the comma separated field\nvalues = Range(\"A1\").Value\nvaluesArr = Split(values, \",\")\n\n' get a distinct collection\nSet DistinctCol = MakeCommaArrayDistinct(valuesArr)\n\n' convert to array - and join (demonstration purposes)\nMsgBox Join(CollectionToArray(DistinctCol), \",\")\n\n\nEnd Sub\n\nPrivate Function MakeCommaArrayDistinct(valuesArr() As String) As Collection\n\nDim output As New Collection\n\n ' Loop through your array and push items to a secondary collection only if they are not already there\n For Each x In valuesArr\n        If IsInCollection(CStr(x), output) &lt;&gt; True Then\n          output.Add CStr(x)\n        End If\n    Next x\n\nSet MakeCommaArrayDistinct = output\n\nEnd Function\n\n' Checks if the current item exists within the collection\nPublic Function IsInCollection(stringToBeFound As String, col As Collection) As Boolean\n\n    Dim x As Variant\n\n    ' Empty Collection\n    If col.Count = 0 Then\n        IsInCollection = False\n        Exit Function\n    End If\n\n    ' Loop and Check\n    For Each x In col\n        If CStr(x) = stringToBeFound Then\n            IsInCollection = True\n            Exit Function\n        End If\n    Next x\n\nEnd Function\n\n' Used to convert the collection to an array to easily display in the msgbox - Demonstration only\nPublic Function CollectionToArray(myCol As Collection) As Variant\n\n    Dim result  As Variant\n    Dim cnt     As Long\n\n    ReDim result(myCol.Count - 1)\n\n    For cnt = 0 To myCol.Count - 1\n        result(cnt) = myCol(cnt + 1)\n    Next cnt\n\n    CollectionToArray = result\n\nEnd Function\n</code></pre>\n\n<p>output;</p>\n\n<p><a href=\"https://i.stack.imgur.com/TA7Uy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TA7Uy.png\" alt=\"enter image description here\"></a></p>\n"}, {"comments": [{"owner": {"reputation": 1000, "user_id": 1366407, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2D1g2.jpg?s=128&g=1", "display_name": "LadderLogic", "link": "https://stackoverflow.com/users/1366407/ladderlogic"}, "edited": false, "score": 1, "creation_date": 1540402402, "post_id": 52968267, "comment_id": 92856228, "body": "Marked this as answer for it&#39;s simplicity."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1540381818, "creation_date": 1540381818, "answer_id": 52968267, "question_id": 52965195, "link": "https://stackoverflow.com/questions/52965195/distinct-or-unique-values-from-csv-using-vba/52968267#52968267", "title": "Distinct or Unique values from CSV using VBA", "body": "<p>I would use a dictionary as a quick and easy way to do this. Add values to dictionary using overwrite syntax to handle duplicates. Then use <code>.Keys</code> to generate an array which you can return as a string by using <code>Join</code> with delimiter <code>\",\"</code>.</p>\n\n<pre><code>Option Explicit\nPublic Sub Test()\n    Dim inputValue As String, outputValue As String, arr() As String, i As Long, dict As Object\n    inputValue = \"1,45,2,4,5,2,3,5\"\n    arr = Split(inputValue, \",\")\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n    For i = LBound(arr) To UBound(arr)\n        dict(arr(i)) = vbNullString\n    Next\n    outputValue = Join(dict.keys, \",\")\n    Debug.Print outputValue\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1000, "user_id": 1366407, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2D1g2.jpg?s=128&g=1", "display_name": "LadderLogic", "link": "https://stackoverflow.com/users/1366407/ladderlogic"}, "is_accepted": false, "score": 0, "last_activity_date": 1540401980, "creation_date": 1540401980, "answer_id": 52974818, "question_id": 52965195, "link": "https://stackoverflow.com/questions/52965195/distinct-or-unique-values-from-csv-using-vba/52974818#52974818", "title": "Distinct or Unique values from CSV using VBA", "body": "<p>This was the solution I came up with</p>\n\n<pre><code>Function GetUnique(notUnique As String) As String\n\n    ar = Split(notUnique, \",\")\n    Dim result As String\n    Dim retVal As New Collection\n\n    For Each a In ar\n     If HasKey(retVal, a) Then\n      ' do nothomg\n     Else\n      retVal.Add a, a\n     End If\n    Next\n    result = \"\"\n    For Each r In retVal\n     result = result + r + \",\"\n    Next\n\n    GetUnique = Mid(result, 1, Len(result) - 1)\n\nEnd Function\n\nFunction HasKey(coll As Collection, strKey) As Boolean\n    Dim var As Variant\n    On Error Resume Next\n    var = coll(strKey)\n    HasKey = (Err.Number = 0)\n    Err.Clear\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1000, "user_id": 1366407, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/2D1g2.jpg?s=128&g=1", "display_name": "LadderLogic", "link": "https://stackoverflow.com/users/1366407/ladderlogic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 52968267, "answer_count": 3, "score": -2, "last_activity_date": 1586463098, "creation_date": 1540372434, "last_edit_date": 1586463098, "question_id": 52965195, "link": "https://stackoverflow.com/questions/52965195/distinct-or-unique-values-from-csv-using-vba", "title": "Distinct or Unique values from CSV using VBA", "body": "<p>Today, I was asked by a friend who uses macros and Excel spreadsheets if there was a way to convert a csv integer string to csv with distinct values. Being from modern era of linq and fancy huha, I thought it would be straight forward, but I spent a good hour to come up with my own solution after Google and SO not turning up. I'd like to know if there's a better solution to it. Here is the input:\n\"1,45,2,4,5,2,3,5\"\nExpected output:\n\"1,45,2,4,5,3\"</p>\n\n<p>I'll post my solution soon, but I am hoping to hear a better SO solution.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 9139573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49628b16c5a4dfa7e26868a23cec863?s=128&d=identicon&r=PG&f=1", "display_name": "MelBee", "link": "https://stackoverflow.com/users/9139573/melbee"}, "edited": false, "score": 0, "creation_date": 1540448857, "post_id": 52965001, "comment_id": 92871132, "body": "I found this to be very useful. Referencing ranges of a pivot table. <a href=\"https://peltiertech.com/referencing-pivot-table-ranges-in-vba/\" rel=\"nofollow noreferrer\">URL</a>"}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 4, "last_activity_date": 1540371892, "creation_date": 1540371892, "answer_id": 52965001, "question_id": 52964791, "link": "https://stackoverflow.com/questions/52964791/change-font-size-for-pivot-table/52965001#52965001", "title": "Change font size for pivot table?", "body": "<p>Try using </p>\n\n<pre><code>With ActiveSheet.PivotTables(\"PivotTable\")\n   .PivotFields(\"FieldName\").ShowDetail = False\n   .TableRange1.Font.Size = 10\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 9139573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c49628b16c5a4dfa7e26868a23cec863?s=128&d=identicon&r=PG&f=1", "display_name": "MelBee", "link": "https://stackoverflow.com/users/9139573/melbee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1562, "favorite_count": 2, "accepted_answer_id": 52965001, "answer_count": 1, "score": 3, "last_activity_date": 1586463134, "creation_date": 1540371335, "last_edit_date": 1586463134, "question_id": 52964791, "link": "https://stackoverflow.com/questions/52964791/change-font-size-for-pivot-table", "title": "Change font size for pivot table?", "body": "<p>I would simply like to change the font size of a pivot table produced with a macro.</p>\n\n<pre><code>With ActiveSheet.PivotTables(\"PivotTable\")\n   .PivotFields(\"FieldName\").ShowDetail = False\n   .DataBodyRange.Font.Size = 10\nEnd With\n</code></pre>\n\n<p>I am using this right now to change the font size, but this only effects the cells that contain data, and leaves out the cells that are field names. I would like to change the font size of everything in the pivot table.</p>\n"}, {"tags": ["excel", "vba", "userform"], "answers": [{"comments": [{"owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "edited": false, "score": 0, "creation_date": 1540431357, "post_id": 52967913, "comment_id": 92866561, "body": "My question is not about application display alerts. Like i mentioned in my question, scenario is; <code>userform</code> is active and <code>ThisWorkbook</code> is hidden. But meanwhile when try to close another workbook which is not hidden, whole excel will be closing including <code>userform</code> and <code>ThisWorkbook</code> for that userform."}], "tags": [], "owner": {"reputation": 23, "user_id": 8771339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RDASZ.jpg?s=128&g=1", "display_name": "Piotr", "link": "https://stackoverflow.com/users/8771339/piotr"}, "is_accepted": false, "score": 0, "last_activity_date": 1540380777, "creation_date": 1540380777, "answer_id": 52967913, "question_id": 52964673, "link": "https://stackoverflow.com/questions/52964673/how-to-make-sure-macro-workbook-dont-close-while-closing-other-workbooks/52967913#52967913", "title": "How to make sure Macro workbook don&#39;t close while closing other workbooks", "body": "<p>I don't understand where the problem is? If you are closing last visible (not hidden) workbook, Excel also tries to close all other open workbooks (even if they're hidden). And I think it's normal Excel behavior. You can only avoid to see a prompt, e.g. by setting up <code>Workbook.Saved</code> property to <code>True</code> or by setting up <code>Application.DisplayAlerts</code> property to <code>False</code> or just by saving workbook before closing.</p>\n\n<p>If you don't want to close hidden workbook you just have to make it visible before closing the second workbook.</p>\n"}], "owner": {"reputation": 849, "user_id": 9151274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49f96542b2315af0983a1e2aae197d2b?s=128&d=identicon&r=PG", "display_name": "Anu", "link": "https://stackoverflow.com/users/9151274/anu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 166, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540385032, "creation_date": 1540370994, "last_edit_date": 1540385032, "question_id": 52964673, "link": "https://stackoverflow.com/questions/52964673/how-to-make-sure-macro-workbook-dont-close-while-closing-other-workbooks", "title": "How to make sure Macro workbook don&#39;t close while closing other workbooks", "body": "<p><strong>Scenario</strong></p>\n\n<p>I have a userform whereby excel workbook will be hidden while opening using the following method of <code>Application.Visible = False</code>. These are the codes </p>\n\n<p><strong>My userform</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/FXT6R.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FXT6R.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><code>show excel</code> button is <code>Commandbutton1</code><br>\n<code>hide excel</code> button is <code>Commandbutton2</code></p>\n\n<p><strong>This workbook</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/2E9Fz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2E9Fz.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Codes</strong></p>\n\n<pre><code>Private Sub Workbook_Open()\n  Call hideExcel\n  UserForm1.Show\nEnd Sub\n</code></pre>\n\n<p><strong>Userform1</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/ISzsP.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ISzsP.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Codes</strong></p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    If Workbooks.Count &gt; 1 Then\n        Windows(ThisWorkbook.Name).Visible = True\n    Else\n        Application.Visible = True\n    End If\nEnd Sub\nPrivate Sub CommandButton2_Click()\n    Call hideExcel\nEnd Sub\nSub UserForm_Initialize()\n    Call hideExcel\nEnd Sub\nPrivate Sub UserForm_Terminate()\n    If Workbooks.Count &gt; 1 Then\n        Windows(ThisWorkbook.Name).Visible = True\n    Else\n        Application.Visible = True\n    End If\nEnd Sub\nSub userform_click()\n    Call hideExcel\nEnd Sub\n</code></pre>\n\n<p><strong>Module</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/mktZH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mktZH.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Codes</strong></p>\n\n<pre><code>Sub hideExcel()\n    If Workbooks.Count &gt; 1 Then\n        Windows(ThisWorkbook.Name).Visible = False\n    Else\n        Application.Visible = False\n    End If\nEnd Sub\n</code></pre>\n\n<p><strong>Problem</strong></p>\n\n<p>The problem I am facing is</p>\n\n<ol>\n<li>Open my macro and userform activated. Lets call this file <code>A</code></li>\n<li>Then open another workbook. Lets call this file <code>B</code></li>\n<li>Tried to close file <code>B</code> while workbook <code>A</code> is hidden. But there is a prompt to close file <code>A</code> also and eventually all excel will be closing including my macro file which is <code>A</code>.</li>\n</ol>\n\n<p>Does anyone know what is the problem here?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 968, "user_id": 5910169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/601a40180e3fa49fbf4e55145adf54d9?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Ball", "link": "https://stackoverflow.com/users/5910169/frank-ball"}, "edited": false, "score": 0, "creation_date": 1586463501, "post_id": 52964765, "comment_id": 108145388, "body": "I would modify your method to take the worksheet name as a parameter and return a bool (true if the worksheet already exists, false if not). By doing this, your method is more generic and you have a bool if you need to do anything different later on if the worksheet was added vs. an existing one was used."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1540371275, "creation_date": 1540371275, "answer_id": 52964765, "question_id": 52964625, "link": "https://stackoverflow.com/questions/52964625/issue-with-next-if-there-is-an-error-on-error-ends-vba/52964765#52964765", "title": "Issue with &#39;Next&#39; if there is an error &#39;On Error&#39; ends VBA", "body": "<p>I've used a method where you simply try to use the worksheet and let error control create the worksheet if an error is thrown.</p>\n\n<p>In this, if the <em>abc</em> worksheet exists, it is used. If it doesn't exist, it is created then used.</p>\n\n<pre><code>sub testws()\n\n    dim wsn as string\n\n    wsn = \"abc\"\n\n    on error goto make_ws\n    with worksheets(wsn)\n        on error goto 0\n        ...\n    end with\n\n    exit sub\n\nmake_ws:\n    with worksheets.add\n        .name = wsn\n    end with\n    resume\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 6813404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48f9fb414484cb5a7aeb91b6de19ce9e?s=128&d=identicon&r=PG&f=1", "display_name": "mhaverk", "link": "https://stackoverflow.com/users/6813404/mhaverk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1586463170, "creation_date": 1540370824, "last_edit_date": 1586463170, "question_id": 52964625, "link": "https://stackoverflow.com/questions/52964625/issue-with-next-if-there-is-an-error-on-error-ends-vba", "title": "Issue with &#39;Next&#39; if there is an error &#39;On Error&#39; ends VBA", "body": "<p>I have a code to filter data and copy to new worksheet. I have an issue where if the sheet being created already exists then it will jump to error handling and stop not continue with remaining 'next'. If i move the 'Next' after the error handling it will only loop if there is and error. Is there a way I can have both? </p>\n\n<pre><code>Sub SortDataAll()\n    ' Sort Data All\n\n    If (Workbooks(\"Fakturagrunnlag All_1.xlsm\").Sheets(\"All Focal Point Data\").AutoFilterMode And Workbooks(\"Fakturagrunnlag All_1.xlsm\").Sheets(\"All Focal Point Data\").FilterMode) _\n      Or Workbooks(\"Fakturagrunnlag All_1.xlsm\").Sheets(\"All Focal Point Data\").FilterMode Then\n        Workbooks(\"Fakturagrunnlag All_1.xlsm\").Sheets(\"All Focal Point Data\").ShowAllData\n    End If\n\n    '~~&gt; Set filter of main data\n    Dim rRange As Range\n    Dim rCell As Range\n    Set rRange = Worksheets(\"Front Page\").Range(\"A7:A21\")\n\n    For Each rCell In rRange\n        MsgBox \"Setting filter for \" &amp; rCell\n\n        Dim rList As String\n        rList = rCell &amp; \"List\"\n\n        MsgBox \"The list for filter is\" &amp; rList\n\n        ' can remove after\n        Worksheets(\"All Focal Point Data\").Activate\n\n        Dim v As Variant\n        v = Application.WorksheetFunction.Transpose(Range(rList).Value)\n\n        Range(\"A:BC\").AutoFilter Field:=54, Criteria1:=v, Operator:=xlFilterValues\n        Selection.AutoFilter Field:=54, Criteria1:=v, Operator:=xlFilterValues\n\n        MsgBox \"Check data is filtered\"\n\n        '~~&gt; Create new sheet and paste data\n        On Error Resume Next\n\n        With ThisWorkbook\n            .Sheets.Add(After:=.Sheets(.Sheets.Count)).Name = rCell\n        End With\n\n        If Err Then GoTo ErrorJump\n\n        Err.clear\n\n        Worksheets(\"All Focal Point Data\").Range(\"A1:BC5000\").Copy Worksheets(rCell).Range(\"A1\").Paste\n        Columns(\"BB:BB\").Delete Shift:=xlToLeft\n\n    Next rCell\n\n    Exit Sub\n\nErrorJump:\n    MsgBox \"Sheet already exists\":\n    Application.DisplayAlerts = False\n    ActiveWindow.SelectedSheets.Delete\n    Application.DisplayAlerts = True\n    'Worksheets(\"Front Page\").Activate\n    'Range(\"A1\").Select\n\n    Next rCell\nEnd Sub\n</code></pre>\n"}, {"tags": ["css", "excel", "vba", "user-interface", "button"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540390611, "post_id": 52964581, "comment_id": 92848866, "body": "<a href=\"https://superuser.com/questions/802479/how-can-i-trigger-an-excel-macro-by-hovering-a-mouse-over-a-cell\" title=\"how can i trigger an excel macro by hovering a mouse over a cell\">superuser.com/questions/802479/&hellip;</a>"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540390711, "post_id": 52964581, "comment_id": 92848932, "body": "@QHarr I&#39;m not looking for a mouseover event, I&#39;m looking to insert the button&#39;s CSS code into my VBA macro."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540390799, "post_id": 52964581, "comment_id": 92848997, "body": "You would have to translate the effect as CSS is not for VBA objects. One way, is through the use of transparent labels with mouseover events that trigger code."}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540391673, "post_id": 52964581, "comment_id": 92849653, "body": "In that case, I don&#39;t think it&#39;s possible to do what I want at all. Have you taken a look at the webpage? The buttons use complex animations I don&#39;t think are replicable with VBA code.  Is there any way I can insert a non-VBA object? I&#39;m really pushing the limits of my coding knowledge here. If I can&#39;t add CSS code to a regular VBA button, perhaps I can create a button-like object myself?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540392016, "post_id": 52964581, "comment_id": 92849879, "body": "I haven&#39;t logged in to view what is here: <a href=\"https://www.excelforum.com/excel-programming-vba-macros/1047801-how-to-combine-css-html-and-vba-to-produce-customized-buttons-on-an-outlook-email.html\" rel=\"nofollow noreferrer\">excelforum.com/excel-programming-vba-macros/&hellip;</a>"}, {"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540393039, "post_id": 52964581, "comment_id": 92850616, "body": "That thread is about adding CSS to an e-mail body, I&#39;ll have to look whether that&#39;s applicable to my worksheet once I&#39;m back in the office"}], "answers": [{"comments": [{"owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1540390047, "post_id": 52969705, "comment_id": 92848458, "body": "Thank you for your comment Ox. I&#39;m aware of this event, I&#39;m instead looking for information on how to add the button code (which is in CSS) to a VBA macro."}, {"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "reply_to_user": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "edited": false, "score": 0, "creation_date": 1540392090, "post_id": 52969705, "comment_id": 92849948, "body": "@TimStack Right, I see that--my comment was that your CSS includes &quot;hover,&quot; which would translate into a mouseover event. So you wouldn&#39;t be able to take advantage of the hover feature here."}], "tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": false, "score": 0, "last_activity_date": 1540386049, "creation_date": 1540386049, "answer_id": 52969705, "question_id": 52964581, "link": "https://stackoverflow.com/questions/52964581/adding-css-animation-buttons-to-excel-with-vba/52969705#52969705", "title": "Adding CSS animation buttons to Excel with VBA", "body": "<p>VBA doesn't include mouseover events, so it's not likely without maybe some API hacks. There are some mouseMove events that would require defining hotspots for each button, but in order for it to work, your CPU would basically be processing a sub every time you moved your mouse. I don't think it would be great for performance, but maybe someone here could correct me.</p>\n\n<p>Take a look at <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/mousemove-event\" rel=\"nofollow noreferrer\">this page</a> from Microsoft for more information on the mouseMove event.</p>\n"}], "owner": {"reputation": 3060, "user_id": 10540017, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9FbKL.jpg?s=128&g=1", "display_name": "Tim Stack", "link": "https://stackoverflow.com/users/10540017/tim-stack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 403, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540390789, "creation_date": 1540370716, "last_edit_date": 1540390789, "question_id": 52964581, "link": "https://stackoverflow.com/questions/52964581/adding-css-animation-buttons-to-excel-with-vba", "title": "Adding CSS animation buttons to Excel with VBA", "body": "<p>I came across <a href=\"https://codepen.io/anon/pen/ReeEyx\" rel=\"nofollow noreferrer\">this webpage with some beautiful animated buttons</a> . I have a few buttons in an Excel Workbook that activate some VBA projects, and I was wondering if I could add the buttons I found into that Excel Workbook. I have no knowledge of integrating different languages into VBA, except for some SQL. </p>\n\n<p><strong>Any way this could be possible?</strong></p>\n\n<p>P.S. Button 1 (diagonal swipe) is all I need, CCS code below</p>\n\n<pre><code>.btn-1 {\n  $btn-color: random-color($max:200);\n  $btn-color-dark: shade($btn-color, 40%);\n  color: tint($btn-color);\n\n  &amp;:before {\n    content: '';\n    @include absolute(0,-50px,0,0);\n    border-right: 50px solid transparent;\n    border-bottom: $btn-height solid $btn-color-dark;\n    transform: translateX(-100%);\n  }\n\n  &amp;:hover {\n    color: tint($btn-color, 75%);\n\n    &amp;:before {\n      transform: translateX(0);\n    }\n  }\n}\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 1117, "user_id": 6836407, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/69832d4c9bf4d0b26bd4e44306b39528?s=128&d=identicon&r=PG&f=1", "display_name": "Selkie", "link": "https://stackoverflow.com/users/6836407/selkie"}, "edited": false, "score": 0, "creation_date": 1540397341, "post_id": 52964410, "comment_id": 92853503, "body": "A style note - I&#39;m a BIG fan of picking the column, and going UP from the bottom of the column, as opposed to starting at the top and going DOWN - this will let you find the bottom, even if there&#39;s a gap in the middle of your data."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 3, "last_activity_date": 1540370774, "last_edit_date": 1540370774, "creation_date": 1540370407, "answer_id": 52964489, "question_id": 52964410, "link": "https://stackoverflow.com/questions/52964410/create-array-from-range-values-vba/52964489#52964489", "title": "create array from range values VBA", "body": "<p>Use the last row number in the range assignment.</p>\n\n<pre><code>dim last as long\n\nlast = Range(\"r1\").End(xlDown).row\nmyarray = Range(\"r1:r\" &amp; last).Value\n</code></pre>\n\n<p>You're creating a 2-D array. Although some of the functions default to the first rank, it is better to treat a 2-D array as a 2-D array.</p>\n\n<pre><code>For i = LBound(myarray, 1) To UBound(myarray, 1)\n        msg = msg &amp; myarray(i, 1) &amp; vbNewLine\nNext i\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1540370764, "post_id": 52964570, "comment_id": 92835770, "body": "Make sure you prefix your range with the sheet that is referring to avoid unexpected results."}, {"owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "edited": false, "score": 0, "creation_date": 1540370801, "post_id": 52964570, "comment_id": 92835797, "body": "your array is two dimensional (x,y) so you need to be indexing the second dimension too."}], "tags": [], "owner": {"reputation": 522, "user_id": 10462701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/413b87f883585682a395af8bc755afbd?s=128&d=identicon&r=PG&f=1", "display_name": "SNicolaou", "link": "https://stackoverflow.com/users/10462701/snicolaou"}, "is_accepted": false, "score": 1, "last_activity_date": 1540370679, "creation_date": 1540370679, "answer_id": 52964570, "question_id": 52964410, "link": "https://stackoverflow.com/questions/52964410/create-array-from-range-values-vba/52964570#52964570", "title": "create array from range values VBA", "body": "<p>See below: </p>\n\n<pre><code>Sub chase()\n\n  Dim i As Integer, msg As String\n  Dim last As Variant\n  Dim rng As Range\n  Dim myarray As Variant\n\n  last = Sheet1.Range(\"r1\").End(xlDown).Address\n  MsgBox last\n\n  myarray = Sheet1.Range(\"r1:\" &amp; last).Value\n  For i = LBound(myarray) To UBound(myarray)\n    msg = msg &amp; myarray(i, 1) &amp; vbNewLine\n  Next i\n\n  MsgBox \"the values of my dynamic array are: \" &amp; vbNewLine &amp; msg\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 7473846, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh3.googleusercontent.com/-2nlqcek6Im4/AAAAAAAAAAI/AAAAAAAAAAA/h_84lKUeRBo/photo.jpg?sz=128", "display_name": "eric paris", "link": "https://stackoverflow.com/users/7473846/eric-paris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5872, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1586463205, "creation_date": 1540370140, "last_edit_date": 1586463205, "question_id": 52964410, "link": "https://stackoverflow.com/questions/52964410/create-array-from-range-values-vba", "title": "create array from range values VBA", "body": "<p>i'm trying to do a macro where i will need an array of values.\nthis array is created from a range which will be variable in size.\ni've tried the below but keep having an error:</p>\n\n<pre><code>Sub chase()\n\n\nDim rng As Range\nDim myarray() As Variant\n\nlast = Range(\"r1\").End(xlDown).Address\nMsgBox last\n\nmyarray = Range(\"r1:\" &amp; last).Value\nFor i = LBound(myarray) To UBound(myarray)\n        msg = msg &amp; myarray(i) &amp; vbNewLine\n    Next i\nMsgBox \"the values of my dynamic array are: \" &amp; vbNewLine &amp; msg\n\n\nEnd Sub\n</code></pre>\n\n<p>any idea how to process?</p>\n\n<p>thanks</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1540372602, "creation_date": 1540372602, "answer_id": 52965253, "question_id": 52964216, "link": "https://stackoverflow.com/questions/52964216/excel-vba-lock-cells-without-protecting-the-workbook/52965253#52965253", "title": "Excel VBA: Lock cells without protecting the workbook", "body": "<p>You don't have to protect the <code>Workbook</code>, only the <code>Worksheet</code>.</p>\n\n<p>To protect/unprotect a sheet via VBA, use Worksheet-methods <code>protect</code> resp. <code>unprotect</code> (you can apply a password).</p>\n\n<p>To prevent a range to be modified, you have to set it's <code>locked</code>-property to True <em>and</em> protect the sheet (all cells have the propery <code>locked</code> set by default).</p>\n\n<p>Be aware that, if a Range is locked and the worksheet is protected, you cannot modifiy the Range via VBA. If you want to do so, use the unprotect method at the top of the code (but don't forget to protect the sheet again when you're done). As an alternative, you can call <code>protect</code> with parameter <code>UserInterfaceOnly:=True</code>, but unfortunately Excel doesn't save this property. So if you save an Excel file where a worksheet is protected with <code>UserInterfaceOnly:=True</code> and reopen it, the sheet is protected also for VBA.</p>\n"}, {"comments": [{"owner": {"reputation": 41, "user_id": 9764742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b05eac6fc60f71ff225d5d0efbe66d3?s=128&d=identicon&r=PG&f=1", "display_name": "robbertvdh", "link": "https://stackoverflow.com/users/9764742/robbertvdh"}, "edited": false, "score": 0, "creation_date": 1540376720, "post_id": 52965337, "comment_id": 92839519, "body": "This seems to solve almost all the issues I had with locking and protecting! Except for one, which is being able to use Home -&gt; Fill -&gt; Series/Justify etc. If I am correct this is not an extra setting for the Protect function, so what should I do to make this functionality available for the end-user?"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 41, "user_id": 9764742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b05eac6fc60f71ff225d5d0efbe66d3?s=128&d=identicon&r=PG&f=1", "display_name": "robbertvdh", "link": "https://stackoverflow.com/users/9764742/robbertvdh"}, "edited": false, "score": 0, "creation_date": 1540409445, "post_id": 52965337, "comment_id": 92859770, "body": "@robbertvdh: If your functionality is very specific, you can create VBA code to cover your situation and lock the sheet <code>UserInterfaceOnly</code>."}], "tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": false, "score": 2, "last_activity_date": 1540372818, "creation_date": 1540372818, "answer_id": 52965337, "question_id": 52964216, "link": "https://stackoverflow.com/questions/52964216/excel-vba-lock-cells-without-protecting-the-workbook/52965337#52965337", "title": "Excel VBA: Lock cells without protecting the workbook", "body": "<p>Use</p>\n\n<pre><code>ActiveSheet.Cells.Locked=False\n</code></pre>\n\n<p>Then Lock your range which you don't want to be edited using:</p>\n\n<pre><code>Range(\"A1:A4\").Cells.Locked=True\n</code></pre>\n\n<p>Then protect the sheet</p>\n\n<pre><code>ActiveSheet.Protect Contents:=True, DrawingObjects:=False\n</code></pre>\n\n<p>This will only protect the contents that are <code>Locked</code> and still allow you to change values in the rest of the sheet and insert/delete charts. You may have to change extra settings with Protect. <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.protect\" rel=\"nofollow noreferrer\">More details can be found here</a></p>\n"}], "owner": {"reputation": 41, "user_id": 9764742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b05eac6fc60f71ff225d5d0efbe66d3?s=128&d=identicon&r=PG&f=1", "display_name": "robbertvdh", "link": "https://stackoverflow.com/users/9764742/robbertvdh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5618, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1586463241, "creation_date": 1540369564, "last_edit_date": 1586463241, "question_id": 52964216, "link": "https://stackoverflow.com/questions/52964216/excel-vba-lock-cells-without-protecting-the-workbook", "title": "Excel VBA: Lock cells without protecting the workbook", "body": "<p>I have created an add-in that sends and retrieves data from a database in order for this data to be used by our analysts. \nTo prevent changes made to existing data points I want to lock the cells containing this data. Initially, I did this by locking the range of the data and protecting the workbook, since otherwise the locking does not work. However, protecting the workbook also removes/limits a lot of functionality for the end-user, such as creating graphs, the auto fill function, changing the format etc. Since these and other functionalities are needed for the end-user, I cannot protect the workbook. Still, I want to lock the cell containing the data points. </p>\n\n<p>So my question is, is it possible to lock the cells in a dynamic range (I have macros detecting the correct end column and end row of the data points) without protecting the workbook? If so, how? If not, would it be possible to detect changes in the dynamic range and show a messagebox that changes are not allowed in this specific cell/range and revert back to the old value of the cell? If so, how? </p>\n\n<p>I have seen a few posts asking a similar question, but these were either not answered or the answer was not satisfying for my case (e.g. a macro implemented in the VBA project of the workbook instead of the VBA project of the add-in).</p>\n\n<p>Thanks in advance for your answer(s)!</p>\n\n<p>Kind regards,\nRobbert</p>\n"}, {"tags": ["excel", "vba", "bloomberg"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540369613, "post_id": 52964139, "comment_id": 92835133, "body": "You don&#39;t need = True just if IsEmpty(Cells(i,2))"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1540370779, "post_id": 52964139, "comment_id": 92835783, "body": "So next to <i>Svenska</i> you want the formula <code>=BDP(&quot;EUR AUD Crncy&quot;)*10</code>?  Shouldn&#39;t there be a comma before <code>Crncy</code>?"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1540371483, "post_id": 52964139, "comment_id": 92836203, "body": "I don&#39;t have the add-in so don&#39;t want to add as an answer - would this work:  <code>PriceHomeCountry = WorksheetFunction.BDP(&quot;EUR &quot; &amp; Split(rng2, &quot; &quot;)(1), &quot;Crncy&quot;) * rng1</code>?"}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1540374593, "post_id": 52964139, "comment_id": 92838235, "body": "@DarrenBartrup-Cook it won&#39;t work - the op probably needs something like <code>Cells(i, 3).FormulaR1C1 = &quot;=BDP(&quot;&quot;EURAUD Curncy&quot;&quot;, &quot;&quot;PX_LAST&quot;&quot;) * 10</code>. But the op needs to clarify his question as you asked in your first comment."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 0, "creation_date": 1540375166, "post_id": 52964139, "comment_id": 92838606, "body": "@assylias I was wondering about that - and looking at your profile you&#39;d have a better idea than me.  I was also thinking of BDP as a worksheet function, but it&#39;s in an add-in so is just a <code>Public Function</code> that could be called from VBA with something like (for example) <code>DEBUG.PRINT BDP(&quot;EURAUD Curncy&quot;, &quot;PX_LAST&quot;)</code>?"}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "reply_to_user": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 0, "creation_date": 1540377553, "post_id": 52964139, "comment_id": 92840048, "body": "@DarrenBartrup-Cook No that won&#39;t work - it can only be used in a formula. To access it programmatically is a bit more involved."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "reply_to_user": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 1, "creation_date": 1540377850, "post_id": 52964139, "comment_id": 92840224, "body": "@assylias  Damn.  At least my code gives the way to enter it as a formula.  Do you have a link to any resources so I could get my head around the &quot;more involved&quot; bit?"}, {"owner": {"reputation": 296034, "user_id": 829571, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zflGZ.png?s=128&g=1", "display_name": "assylias", "link": "https://stackoverflow.com/users/829571/assylias"}, "edited": false, "score": 1, "creation_date": 1540378793, "post_id": 52964139, "comment_id": 92840775, "body": "I don&#39;t think the reference document is publicly available - but the code would look like the last piece of code in this question: <a href=\"https://stackoverflow.com/q/39669487/829571\">stackoverflow.com/q/39669487/829571</a>"}], "answers": [{"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 3, "last_activity_date": 1540378004, "last_edit_date": 1540378004, "creation_date": 1540377392, "answer_id": 52966821, "question_id": 52964139, "link": "https://stackoverflow.com/questions/52964139/how-do-i-extract-the-currency-from-total-currency-vba-bdp/52966821#52966821", "title": "How do I extract the Currency from &quot;Total Currency&quot; VBA /BDP", "body": "<p>This code <em>should</em> do the trick.  I can't test using the BDP formula as I don't have the add-in so I've given three ways to use it.  </p>\n\n<pre><code>Sub Test()\n\n    Dim rCell As Range\n    Dim CalcRange As Range\n    Dim CountryRange As Range\n    Dim TotalCell As Range\n    Dim HomeCountry As String\n\n    'Every reference to a range that starts \".\" will be referencing Sheet1.\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        'Define the ranges we're working with.\n        Set CountryRange = .Range(\"A2:A9\")\n        Set CalcRange = .Range(\"C2:C9\")\n\n        'Look at each cell in C2:C9.\n        For Each rCell In CalcRange\n            If Not IsEmpty(rCell.Offset(, -1)) Then\n                'Find the first cell before the current rCell in column A that contains the word Total.\n                Set TotalCell = CountryRange.Find(What:=\"Total\", After:=rCell.Offset(, -2), _\n                    LookIn:=xlValues, LookAt:=xlPart, SearchDirection:=xlPrevious)\n\n                'If found then check the found value is in a row higher than rCell.\n                ' - FIND wraps when it reaches the top so could find a Total from lower down.\n                If Not TotalCell Is Nothing Then\n                    If TotalCell.Row &lt; rCell.Row Then\n                        rCell = PriceHomeCountry(rCell.Offset(, -1), TotalCell)\n\n                        'If PriceHomeCountry isn't working this will place the formula in column C.\n                        'rCell.Formula = \"=BDP(\"\"EUR\" &amp; Split(TotalCell, \" \")(1) &amp; \" Curncy\"\",\"\"PX_LAST\"\")\"\n                    End If                        \n                End If\n            End If\n        Next rCell\n    End With\n\nEnd Sub\n\nPublic Function PriceHomeCountry(rng1 As Range, rng2 As Range) As Variant\n\n    'Should work if you set a reference to the Bloomberge add-in in Tools ~ References.\n    PriceHomeCountry = BDP(\"EUR\" &amp; Split(rng2, \" \")(1), \" Curncy\", \"PX_Last\") * rng1\n\n    'Might work without setting a reference.\n    'PriceHomeCountry = Application.Run(\"BDP\", \"EUR\" &amp; Split(rng2, \" \")(1), \" Curncy\", \"PX_Last\") * rng1\n\nEnd Function  \n</code></pre>\n\n<p><strong>Edit:</strong>  Also thanks to @assylias for the heads up on the formula construction.</p>\n"}], "owner": {"reputation": 271, "user_id": 10379579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e4ddc4d27e52867841974780d2e836a?s=128&d=identicon&r=PG&f=1", "display_name": "user9078057", "link": "https://stackoverflow.com/users/10379579/user9078057"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 52966821, "answer_count": 1, "score": 2, "last_activity_date": 1586463277, "creation_date": 1540369325, "last_edit_date": 1586463277, "question_id": 52964139, "link": "https://stackoverflow.com/questions/52964139/how-do-i-extract-the-currency-from-total-currency-vba-bdp", "title": "How do I extract the Currency from &quot;Total Currency&quot; VBA /BDP", "body": "<p>I have a list:</p>\n\n<pre><code>           Price in EUR       Price in Home Country\nTotal AUD\nSvenska     10\nUbinse      15 \nIlluao      20\nTotal USD\nZelo        12\nJhasma      11\nHedsaw      17\n</code></pre>\n\n<p>Ideally, I want to use VBA to insert a a sub that inserts a BDP function in each row of the column <code>Price in Home Country</code> </p>\n\n<p>So like:</p>\n\n<pre><code>for i = 1 to 7\nif IsEmpty(Cells(i,2)) = True Then\nElse\nCells(i,3).Value = PriceHomeCountry(Cells(i,2), Cells(ws.Rows.Count,2).End(xlBottom).Offset(1,-1)\nEnd if \nNext i \n</code></pre>\n\n<p>Please note I want to use <code>Cells(ws.Rows.Count,2).End(xlBottom).Offset(1,-1).Value</code> to refer to the \"Total <code>Insert Currency</code>\" above </p>\n\n<p>I am unsure how to structure the <code>PriceHomeCountry()</code> function</p>\n\n<p><strong>Suggestion:</strong></p>\n\n<pre><code>Function PriceHomeCountry(rng1 as Range, rng2 as Range)\n'I want to basically separate the \"Total\" from the \"Currency\" in rng2,let's call the result rng2.1\nPriceHomeCountry = \"=BDP( \"EUR\" &amp; rng2.1 &amp; \" Crncy\")*rng1\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1540369163, "post_id": 52963938, "comment_id": 92834835, "body": "@Jeeped if the OP is using Flow, chances are that they&#39;ll never touch Excel for Desktop and VBA is certainly not an option in this cloud scenario."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1540370013, "post_id": 52963938, "comment_id": 92835350, "body": "Forms stores the replies in an Excel workbook. Out of the box. Your question implies that you may be using Flow to re-create the same data in another workbook. Is that correct? If so, why would you want to do that? Why duplicate the data entry collection?"}, {"owner": {"reputation": 1, "user_id": 10550569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1d5f75b391b6819dffe4dbe906ecd9?s=128&d=identicon&r=PG&f=1", "display_name": "Mm2018", "link": "https://stackoverflow.com/users/10550569/mm2018"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1540389073, "post_id": 52963938, "comment_id": 92847725, "body": "Hi guys, I am pushing the data from the survey into an excel sheet. I don&#39;t think it&#39;s being duplicated?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10550569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1d5f75b391b6819dffe4dbe906ecd9?s=128&d=identicon&r=PG&f=1", "display_name": "Mm2018", "link": "https://stackoverflow.com/users/10550569/mm2018"}, "edited": false, "score": 0, "creation_date": 1540375403, "post_id": 52964283, "comment_id": 92838747, "body": "Thanks for the reply. My terminology is all over the place because I am still learning.What I was referring to is there a formula in excel that can look at the new row entry and calculate that into the second worksheet automatically?"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 2, "last_activity_date": 1540369767, "creation_date": 1540369767, "answer_id": 52964283, "question_id": 52963938, "link": "https://stackoverflow.com/questions/52963938/how-can-formula-in-another-sheet-automatically-detect-a-new-row-in-excel/52964283#52964283", "title": "How can formula in another sheet automatically detect a new row in Excel?", "body": "<p>Some terminology: In an Excel spreadsheet, a row does not have a letter. Row \"A\" and row \"B\" is just wrong wording. Please use the correct terms. It should be row 1 and row 2, but since you are writing into an Excel table, row 1 will be the column titles (or table headers), so your first row of data returned by Forms will be in row 2. </p>\n\n<p>An Excel survey or Forms reply is not <strong><em>created</em></strong> with Flow, the Forms reply is collected with the Forms engine and added to the Excel workbook. If you have another sheet in the workbook that wants to evaluate the original responses coming in through forms, you can use an Index function and pre-fill it for the expected number of replies.</p>\n\n<p>You can use formulas to pull the last populated row from the original data table. </p>\n\n<p>You can use Flow to do something if the workbook that stores the Forms data is modified, but as far as I know, Flow does not have any tools to look at the \"last\" entry made in a Forms survey.</p>\n\n<p>You may want to check your expectations and spell out what you would like to achieve before focusing on tools that may or may not be able to deliver that outcome.</p>\n"}], "owner": {"reputation": 1, "user_id": 10550569, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1d5f75b391b6819dffe4dbe906ecd9?s=128&d=identicon&r=PG&f=1", "display_name": "Mm2018", "link": "https://stackoverflow.com/users/10550569/mm2018"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": -6, "last_activity_date": 1586463313, "creation_date": 1540368652, "last_edit_date": 1586463313, "question_id": 52963938, "link": "https://stackoverflow.com/questions/52963938/how-can-formula-in-another-sheet-automatically-detect-a-new-row-in-excel", "title": "How can formula in another sheet automatically detect a new row in Excel?", "body": "<p>So I have created a Microsoft Flow between MS forms and an excel workbook. </p>\n\n<p>Every time a form is submitted, the responses are collected in a table in a single row (4 columns). Every time a new form is submitted, a new row is inserted at the bottom. </p>\n\n<p>For example, my table has one row (Row 1). a new survey is submitted ->  row 2 is created using MS flow.</p>\n\n<p>Now I have another worksheet in the workbook that has some formulas looking at the row 1 in the table. The row in this new worksheet full of formula is also in A. Now when a new survey is submitted, I can't find a way to automatically detect the new row b and insert a new row into 2.</p>\n\n<p>Is there something, like a macro that can do this?</p>\n\n<p>Thanks  in advance.</p>\n"}, {"tags": ["excel", "vba", "hide", "rows"], "answers": [{"tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": false, "score": 0, "last_activity_date": 1540381654, "creation_date": 1540381654, "answer_id": 52968225, "question_id": 52963835, "link": "https://stackoverflow.com/questions/52963835/ms-excel-vba-hide-unhide-rows/52968225#52968225", "title": "MS Excel VBA hide / unhide rows", "body": "<p>Yes you could have this code to hide your rows:</p>\n\n<pre><code>Sub HideRowsInRange()\n\nDim c As Range\n\nFor Each c In Range(\"B3:B27\") 'Define your range which should look for 1/0, then loop through that range.\n    If c.Value = 0 Then Rows(c.Row).Hidden = True 'If my range has 0 then it will hide the row.\n    Next c\n\nEnd Sub\n</code></pre>\n\n<p>Before hiding:</p>\n\n<p><a href=\"https://i.stack.imgur.com/3N1BL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3N1BL.png\" alt=\"enter image description here\"></a></p>\n\n<p>After hiding (hiding all 0 in Column B):</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZPonT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZPonT.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 10095629, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156506383129655/picture?type=large", "display_name": "konstantinos", "link": "https://stackoverflow.com/users/10095629/konstantinos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1586463349, "creation_date": 1540368293, "last_edit_date": 1586463349, "question_id": 52963835, "link": "https://stackoverflow.com/questions/52963835/ms-excel-vba-hide-unhide-rows", "title": "MS Excel VBA hide / unhide rows", "body": "<p>I am new to VBA/Macro. I need some help figuring how to hide/unhide rows given my scenario. </p>\n\n<p>This is the scenario.</p>\n\n<p>I have created in a sheet multiple tables. </p>\n\n<p>C3:O14 &amp; C16:O27 etc..</p>\n\n<p>All of them have same dimensions: 12 Rows x 13 Columns</p>\n\n<p>Depending on a cell (dropdown list) data on these tables are refreshed.</p>\n\n<p>Here's the problem: While Columns will always be 13, data won't always fill all 12 Rows. </p>\n\n<p>So i need rows with empty data to be automatically hidden.</p>\n\n<p>If helps, in column B i have created a formula which returns 0/1 in order to know in each case which rows should be hidden.</p>\n\n<p>Any advice / help will be much appreciated.</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1540367857, "post_id": 52963599, "comment_id": 92834114, "body": "You <code>Dim wsEF As Worksheet</code> and then use <code>TableDestination:=wsEF.Cells(10, 7)</code> but you never defined a worksheet for <code>wsEF</code>. You must do something like <code>Set wsEF = ThisWorkbook.Worksheets(&quot;MySheet&quot;)</code> (same issue for <code>wsTO</code> and <code>wbTO</code> both are not defined to a worksheet/workbook). \u2022 By the way your code should throw an error message. If you have errors and ask a question always tell which line the error is and which message."}, {"owner": {"reputation": 520, "user_id": 6425980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b524dab02b94a074d78b988cf62e1405?s=128&d=identicon&r=PG&f=1", "display_name": "Lambik", "link": "https://stackoverflow.com/users/6425980/lambik"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540376322, "post_id": 52963599, "comment_id": 92839270, "body": "ok, I did that, just forgot to copy that part of the code, that is not the problem."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540382026, "post_id": 52963599, "comment_id": 92842818, "body": "We still cannot see that in your question. If we don&#39;t have the code you are <b>actually</b> using we cannot provide help. The code you have shown won&#39;t run at all."}], "answers": [{"tags": [], "owner": {"reputation": 520, "user_id": 6425980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b524dab02b94a074d78b988cf62e1405?s=128&d=identicon&r=PG&f=1", "display_name": "Lambik", "link": "https://stackoverflow.com/users/6425980/lambik"}, "is_accepted": true, "score": 0, "last_activity_date": 1540384076, "creation_date": 1540384076, "answer_id": 52968997, "question_id": 52963599, "link": "https://stackoverflow.com/questions/52963599/vba-is-not-creating-pivotcache/52968997#52968997", "title": "VBA is not creating PivotCache", "body": "<p>Searching on other fora, I have found that the problem is related to the fact that excel doesn't always accept a range that is set (although it should).\nI have rewritten the code to encode the range as a STRING, using the R1C1 reference style, which solves my problem. The cache and thus the pivot table is now created. Full working code below.</p>\n\n<pre><code>Dim LastColumn As Long, LastRow As Long\nDim wsTO As Worksheet, wsEF As Worksheet\nDim wbTO As Workbook\nDim PCache As PivotCache, PTable As PivotTable\nDim PivotRange As String\n\nSet wbEFiche = Workbooks(\"ThisWorkbook.xlsm\")\nSet wsEF = wbEFiche.Worksheets(\"Sheet1\")\nSet wsTO = wbTO.Sheets(\"Sheet2\")\n\nLastColumn = wsTO.Cells(1, Columns.Count).End(xlToLeft).Column\nLastRow = wsTO.Cells(Rows.Count, 1).End(xlUp).Row\n'Due to an excel bug, the range has to be encoded in a string format, using a R1C1 reference style\nPivotRange = wsTO.Name &amp; \"!\" &amp; wsTO.Range(wsTO.Cells(1, 1), wsTO.Cells(LastRow, LastColumn)).Address(ReferenceStyle:=xlA1)\n'Set the pivot cache\nSet PCache = wbTO.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=PivotRange). _\nCreatePivotTable(TableDestination:=wsEF.Cells(10, 7), _\nTableName:=\"PostOccupationTable\")\n'Create a blank pivot table\nSet PTable = PCache.CreatePivotTable _\n(TableDestination:=wsEF.Cells(10, 7), TableName:=\"PostOccupationTable\")\n'Insert Row &amp; Column Fields\n With wsEF.PivotTables(\"PostOccupationTable\").PivotFields(\"IndCategory2\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nWith wsEF.PivotTables(\"PostOccupationTable\").PivotFields(\"PostCategory2\")\n    .Orientation = xlColumnField\n    .Position = 1\nEnd With\n'Insert data field\nwsEF.PivotTables(\"PostOccupationTable\").AddDataField ActiveSheet.PivotTables( _\n    \"PostOccupationTable\").PivotFields(\"NAME\"), \"Count of NAME\", xlCount\n'Set filters\nWith wsEF.PivotTables(\"PostOccupationTable\").PivotFields(\"PostCategory2\")\n    .PivotItems(\"(blank)\").Visible = False\nEnd With\nWith wsEF.PivotTables(\"PostOccupationTable\").PivotFields(\"IndCategory2\")\n    .PivotItems(\"(blank)\").Visible = False\nEnd With\n'Apply Style\nwsEF.PivotTables(\"PostOccupationTable\").TableStyle2 = _\n    \"PivotStyleMedium2\"\n</code></pre>\n"}], "owner": {"reputation": 520, "user_id": 6425980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b524dab02b94a074d78b988cf62e1405?s=128&d=identicon&r=PG&f=1", "display_name": "Lambik", "link": "https://stackoverflow.com/users/6425980/lambik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "accepted_answer_id": 52968997, "answer_count": 1, "score": 0, "last_activity_date": 1540384076, "creation_date": 1540367560, "question_id": 52963599, "link": "https://stackoverflow.com/questions/52963599/vba-is-not-creating-pivotcache", "title": "VBA is not creating PivotCache", "body": "<p>I have written a macro to create a pivot table, but the pivot table is not created, because the pivot cache is not created. I can't seem to figure out why. Can anyone tell me what i'm doing wrong please?</p>\n\n<pre><code>Dim LastColumn As Long, LastRow As Long\nDim wsTO As Worksheet, wsEF As Worksheet\nDim wbTO As Workbook\nDim PCache As PivotCache, PTable As PivotTable\n'Determine the data range you want to pivot\nLastColumn = wsTO.Cells(1, Columns.Count).End(xlToLeft).Column\nLastRow = wsTO.Cells(Rows.Count, 1).End(xlUp).Row\nSet PRange = wsTO.Cells(1, 1).Resize(LastRow, LastColumn)\n\n'Set the pivot cache\nSet PCache = wbTO.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=PRange). _\nCreatePivotTable(TableDestination:=wsEF.Cells(10, 7), _\nTableName:=\"PostOccupationTable\")\n'Create a blank pivot table\nSet PTable = PCache.CreatePivotTable _\n(TableDestination:=wsEF.Cells(10, 7), TableName:=\"PostOccupationTable\")\n'Insert Row &amp; Column Fields\n With wsEF.PivotTables(\"PostOccupationTable\").PivotFields(\"IndCategory2\")\n    .Orientation = xlRowField\n    .Position = 1\nEnd With\nWith wsEF.PivotTables(\"PostOccupationTable\").PivotFields(\"PostCategory2\")\n    .Orientation = xlColumnField\n    .Position = 1\nEnd With\n'Insert data field\nwsEF.PivotTables(\"PostOccupationTable\").AddDataField ActiveSheet.PivotTables( _\n    \"PostOccupationTable\").PivotFields(\"NAME\"), \"Count of NAME\", xlCount\n'Set filters\nWith wsEF.PivotTables(\"PostOccupationTable\").PivotFields(\"PostCategory2\")\n    .PivotItems(\"(blank)\").Visible = False\nEnd With\nWith wsEF.PivotTables(\"PostOccupationTable\").PivotFields(\"IndCategory2\")\n    .PivotItems(\"(blank)\").Visible = False\nEnd With\n'Apply Style\nwsEF.PivotTables(\"PostOccupationTable\").TableStyle2 = _\n    \"PivotStyleMedium2\"\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013", "ms-access-2016"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1540415196, "post_id": 52963561, "comment_id": 92862355, "body": "What are you trying to do with the line &#39;Set rs = Recordset&#39;"}, {"owner": {"reputation": 1, "user_id": 9629777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d0a2a578be0a1900e3c2ec7cfc28193?s=128&d=identicon&r=PG&f=1", "display_name": "Abonai", "link": "https://stackoverflow.com/users/9629777/abonai"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1540442846, "post_id": 52963561, "comment_id": 92869133, "body": "Its supposed to refer to the recordset inside my form, which does work."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9629777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d0a2a578be0a1900e3c2ec7cfc28193?s=128&d=identicon&r=PG&f=1", "display_name": "Abonai", "link": "https://stackoverflow.com/users/9629777/abonai"}, "edited": false, "score": 0, "creation_date": 1540471428, "post_id": 52986771, "comment_id": 92884320, "body": "I do use it for the later injection of my isEndDate Value and Focussing the next Field. I dont have time for testing this right now, but will come back to it next Week, thanks."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1540462331, "creation_date": 1540462331, "answer_id": 52986771, "question_id": 52963561, "link": "https://stackoverflow.com/questions/52963561/ms-access-vba-me-recordset-findfirst-runtime-error/52986771#52986771", "title": "MS Access VBA Me.Recordset.Findfirst Runtime Error", "body": "<p>Try using the RecordsetClone and don't duplicate the control names:</p>\n\n<pre><code>Private Sub isEnd_AfterUpdate()\n\n    Dim isEndDate As Date\n    Dim rs As DAO.Recordset\n    Dim strFind As String\n    Dim test As Variant\n\n    'On Error Resume Next\n\n    Set rs = Me.RecordsetClone\n\n    With rs\n        If Not .EOF Then\n            isEndDate = Me!isEnd\n            If Me!isStart &gt; 0 Then\n                Me!isDur = (Me!isEnd - Me!isStart) * 24\n            End If\n\n            strFind = \"IdMa = '\" &amp; Me!IdMa &amp; \"' and OrderRow = \" &amp; Me!OrderRow + 1\n           'test = MsgBox(strFind &amp; \" - \" &amp; .Name &amp; \" - '\" &amp; isEnd &amp; \"'\", vbOKOnly, \"test\")\n            .FindFirst strFind\n            ' and use the found record for something ..?\n\n            Me!isStart.Value = isEndDate\n            Me!isEnd.SetFocus\n        End If\n        .Close\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9629777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d0a2a578be0a1900e3c2ec7cfc28193?s=128&d=identicon&r=PG&f=1", "display_name": "Abonai", "link": "https://stackoverflow.com/users/9629777/abonai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 306, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594627032, "creation_date": 1540367463, "last_edit_date": 1594627032, "question_id": 52963561, "link": "https://stackoverflow.com/questions/52963561/ms-access-vba-me-recordset-findfirst-runtime-error", "title": "MS Access VBA Me.Recordset.Findfirst Runtime Error", "body": "<p>I've got a Problem with one of my vba Events.</p>\n\n<p>Firstly, the event triggers after a change in a field is made, that field belongs to a form which shows multiple data entrys from one table, this form sits inside a NavigationPane.</p>\n\n<p>My database is being programmed in access 2016 32bit and will be mostly used by our workers on an server with Access Runtime 2013</p>\n\n<p>Now when I trigger the event on my pc everything works as intended, but on the server Runtime version it shows me an Error, which i will try to translate into English, for i am in Germany: \"The Execution of this program cant continue, due to a runtime Error\" - \"This Program cant continue to run and will be closed\".</p>\n\n<p>I already tried looking through the duck but couldnt find what i need, mostly due to the keyword \"Runtime\" having two different meanings in this context.</p>\n\n<p>Here's the Code:</p>\n\n<pre><code>Private Sub isEnd_AfterUpdate()\nDim isEnd As Date\nDim rs As Recordset\nDim strFind As String\nDim test As Variant\n\n'On Error Resume Next\n\nSet rs = Recordset\n\nWith rs\nIf Not .EOF Then\n        isEnd = Me!isEnd\n    If Me!isStart &gt; 0 Then\n        Me!isDur = (Me!isEnd - Me!isStart) * 24\n    End If\n\n    strFind = \"IdMa = '\" &amp; Me!IdMa &amp; \"' and OrderRow = \" &amp; Me!OrderRow + 1\n    'test = MsgBox(strFind &amp; \" - \" &amp; rs.Name &amp; \" - '\" &amp; isEnd &amp; \"'\", vbOKOnly, \"test\")\n    Me.Recordset.FindFirst (strFind)\n    Me!isStart = isEnd\n    Me.isEnd.SetFocus\nEnd If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>You may ignore the Error Handling and MsgBox which i tried to use for Debugging.</p>\n\n<p>The Database is for Planning our Processes and this field keeps the endtime of the finished process and should enter it into the starttime of the next process, to save a little bit of time.</p>\n\n<p>Edit1:\nI should mention that i pinpointed the Error down to the line: </p>\n\n<pre><code>Me.Recordset.Findfirst (strFind)\n</code></pre>\n\n<p>but cant figure out why this is a problem, the exact same line is used just fine in some Buttons on the same Form.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "edited": false, "score": 0, "creation_date": 1540365643, "post_id": 52962343, "comment_id": 92832824, "body": "Merged cells are a PITA for several reasons. When possible, always prefer <code>CenterAcrossSelection</code>, which is visually similar."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10549561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397a94847248317dd55413cefaa7ba52?s=128&d=identicon&r=PG&f=1", "display_name": "Russ Sidney", "link": "https://stackoverflow.com/users/10549561/russ-sidney"}, "edited": false, "score": 0, "creation_date": 1540396272, "post_id": 52962798, "comment_id": 92852783, "body": "Let&#39;s say I have multiple tables of data with the same type and format on 1 sheet and there are multiple sheets. And how can I get the macro to run automatically everytime I open the workbook."}, {"owner": {"reputation": 23, "user_id": 10549561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397a94847248317dd55413cefaa7ba52?s=128&d=identicon&r=PG&f=1", "display_name": "Russ Sidney", "link": "https://stackoverflow.com/users/10549561/russ-sidney"}, "edited": false, "score": 1, "creation_date": 1540400167, "post_id": 52962798, "comment_id": 92855082, "body": "Great! I found this:     Private Sub Workbook_Open()         ...     End Sub"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1540402313, "post_id": 52962798, "comment_id": 92856175, "body": "Yes!that it is!"}], "tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": true, "score": 4, "last_activity_date": 1540364622, "creation_date": 1540364622, "answer_id": 52962798, "question_id": 52962343, "link": "https://stackoverflow.com/questions/52962343/merge-cells-in-multiple-columns-base-on-cell-value/52962798#52962798", "title": "merge cells in multiple columns base on cell value", "body": "<p>Try this code</p>\n\n<pre><code>Sub Test()\nDim x, r As Long, c As Long\n\nApplication.ScreenUpdating = False\n    With Worksheets(\"Sheet1\")\n        For r = 2 To .Cells(Rows.Count, 1).End(xlUp).Row\n            x = .Cells(r, 3).Value\n            If IsNumeric(x) And x &gt; 1 Then\n                For c = 2 To 4\n                    .Cells(r, c).Resize(x).Merge\n                Next c\n            End If\n        Next r\n    End With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 10549561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397a94847248317dd55413cefaa7ba52?s=128&d=identicon&r=PG&f=1", "display_name": "Russ Sidney", "link": "https://stackoverflow.com/users/10549561/russ-sidney"}, "edited": false, "score": 0, "creation_date": 1540395720, "post_id": 52962878, "comment_id": 92852424, "body": "Nice! But the sample screenshot is just an abbreviated example and the code will be very lengthy if let&#39;s say I have large no. of  columns eg. &gt;20 to merge."}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1540366732, "last_edit_date": 1540366732, "creation_date": 1540364902, "answer_id": 52962878, "question_id": 52962343, "link": "https://stackoverflow.com/questions/52962343/merge-cells-in-multiple-columns-base-on-cell-value/52962878#52962878", "title": "merge cells in multiple columns base on cell value", "body": "<p>Change sheet name and range if needed and try:</p>\n\n<pre><code>Option Explicit\n\nSub Test()\n\n    Dim LastRow As Long\n    Dim i As Long\n    Dim Number_Of_Rows As Long\n    Dim wsTest As Worksheet\n\n    With wsTest\n        LastRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        For i = 2 To LastRow\n            If .Range(\"C\" &amp; i).Value &gt; 1 Then\n                Number_Of_Rows = .Range(\"C\" &amp; i).Value\n                With .Range(\"B\" &amp; .Range(\"C\" &amp; i).Row &amp; \":B\" &amp; .Range(\"C\" &amp; i).Row + (Number_Of_Rows - 1))\n                    .HorizontalAlignment = xlCenter\n                    .VerticalAlignment = xlCenter\n                    .MergeCells = True\n                End With\n                With .Range(\"C\" &amp; .Range(\"C\" &amp; i).Row &amp; \":C\" &amp; .Range(\"C\" &amp; i).Row + (Number_Of_Rows - 1))\n                    .HorizontalAlignment = xlCenter\n                    .VerticalAlignment = xlCenter\n                    .MergeCells = True\n                End With\n                With .Range(\"D\" &amp; .Range(\"C\" &amp; i).Row &amp; \":D\" &amp; .Range(\"C\" &amp; i).Row + (Number_Of_Rows - 1))\n                    .HorizontalAlignment = xlCenter\n                    .VerticalAlignment = xlCenter\n                    .MergeCells = True\n                End With\n            ElseIf .Range(\"C\" &amp; i).Value &lt;&gt; \"\" Then\n                With .Range(\"B\" &amp; i &amp; \":D\" &amp; i)\n                    .HorizontalAlignment = xlCenter\n                    .VerticalAlignment = xlCenter\n                End With\n            End If\n        Next i\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10549561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397a94847248317dd55413cefaa7ba52?s=128&d=identicon&r=PG&f=1", "display_name": "Russ Sidney", "link": "https://stackoverflow.com/users/10549561/russ-sidney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 52962798, "answer_count": 2, "score": 2, "last_activity_date": 1586463384, "creation_date": 1540362817, "last_edit_date": 1586463384, "question_id": 52962343, "link": "https://stackoverflow.com/questions/52962343/merge-cells-in-multiple-columns-base-on-cell-value", "title": "merge cells in multiple columns base on cell value", "body": "<p>I would like to automate the merging of cells based by column for multiple columns based on the information in a specific column.</p>\n\n<p>Base on the Initial image, the Stack value will determine the no. of rows to merge for Color, Stack and Size column as shown in Outcome screenshot.</p>\n\n<p>I found this code below but I don't know how to adapt it to my requirement. (I am new on code and am learning)</p>\n\n<pre><code>Dim srw As Long, frw As Variant\nWith Worksheets(\"Sheet1\")\n    With Intersect(.Columns(3), .UsedRange)\n        srw = 0\n        Do While srw &lt; .Rows.Count\n            frw = .Cells(srw + 1, 1).Value\n            If Not IsError(frw) Then\n                .Cells(srw + 1, 1).Resize(frw, 1).Offset(0, -1).Merge\n                srw = srw + frw\n            Else\n                srw = .Cells(Rows.Count, 1).End(xlUp).Row\n            End If\n        Loop\n    End With\nEnd With\n</code></pre>\n\n<p>Initial:<br>\n<a href=\"https://i.stack.imgur.com/54j7P.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/54j7P.png\" alt=\"Initial\"></a></p>\n\n<p>Outcome:<br>\n<a href=\"https://i.stack.imgur.com/kZo9F.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kZo9F.png\" alt=\"Outcome\"></a></p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1540363874, "post_id": 52962126, "comment_id": 92831830, "body": "Welcome to Stack Overflow.  I assume that by &quot;dropbox&quot; you mean a ListBox control because that is the only multi-selection control available...  Unless your &quot;supervisor&quot; field is a <i>multi-valued field</i> (?), then a ComboBox can also display and allow multiple value selection.  But if that is the case, that is a detail which you need to make explicitly clear.  A correct answer will depend on being precise about terminology.   Also, please apply code formatting to code. There are a couple ways to do this, and the help icon/button in the top right corner of the question editor can help."}, {"owner": {"reputation": 1, "user_id": 10550045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c7bc5c04bc280a97e1015a6e85760d?s=128&d=identicon&r=PG&f=1", "display_name": "SashaSolo", "link": "https://stackoverflow.com/users/10550045/sashasolo"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1540364390, "post_id": 52962126, "comment_id": 92832093, "body": "My apologize, its a combo box, not sure what question editor your talking about :("}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1540364945, "post_id": 52962126, "comment_id": 92832422, "body": "By question editor, I mean the textbox where you entered and posted your question on Stack Overflow.  It has a toolbar with few buttons, but also a question mark button on the right side that you can click for help in formatting the question."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1540365008, "post_id": 52962126, "comment_id": 92832460, "body": "But a ComboBox in Access does not normally allow multiple selections.  Is the field a multi-valued field?"}, {"owner": {"reputation": 1, "user_id": 10550045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c7bc5c04bc280a97e1015a6e85760d?s=128&d=identicon&r=PG&f=1", "display_name": "SashaSolo", "link": "https://stackoverflow.com/users/10550045/sashasolo"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1540365656, "post_id": 52962126, "comment_id": 92832833, "body": "no, guys lol i&#39;m not going crazy here am I lol? What is that? <a href=\"https://imgur.com/a/z982VjM\" rel=\"nofollow noreferrer\">imgur.com/a/z982VjM</a> because access says its a combo box :)"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 1, "creation_date": 1540370836, "post_id": 52962126, "comment_id": 92835821, "body": "That&#39;s a multi-valued combo-box, I highly recommend not using those since they tend to exhibit buggy behavior, and use a list box instead. If the column you&#39;re taking the value from is the bound column, I can provide a solution, though."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 1, "creation_date": 1540374834, "post_id": 52962126, "comment_id": 92838380, "body": "You show a multi-select combobox which means a multi-value field. Combobox should show multiple selections separated by comma. Understand that a multi-value field displays data from a hidden table. And as you learned, if multiple values in field, referencing Column() doesn&#39;t work. If you allow selection of multiple supervisors, really doesn&#39;t make sense to create an identifier concatenating 1 of the supervisors with date."}, {"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1540391703, "post_id": 52962126, "comment_id": 92849670, "body": "Also, having a multi-value column in your table is a <b>very</b> bad design decision. If a record can have multiple supervisors, that should be modeled as a separate table (e.g. <code>EmergencyExitSupervisors</code>), and you could use a sub-form to display all the supervisors attached to a record."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "reply_to_user": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1540407370, "post_id": 52962126, "comment_id": 92858786, "body": "@Zack  See <a href=\"https://stackoverflow.com/questions/13505838/alternative-to-multi-valued-fields-in-ms-access\">Alternative to multi-valued fields in MS Access</a> for some counter points to your advice.  Many would call anything to do with Access a <i>very bad design decision</i>, yet so many find it extremely useful and approachable.  Same with MVF.  There are certainly drawbacks, but they were added to Access because so many novice (and even intermediate) Access users had extreme difficulty in correctly designing and implementing the table and form structure necessary to implement similar functionality."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1540407838, "post_id": 52962126, "comment_id": 92859002, "body": "General note: I find it curious (and a little frustrating) that just the mention of multi-value fields brings immediate condemnation of the design and implications that it should be removed, as though the OP has the option of simply replacing the MVF as though it&#39;s a straight-forward task.  Frankly, that&#39;s bologna.  First of all, the screenshots shows a rather mature looking interface that wasn&#39;t implemented just yesterday. Unless the OP says otherwise, I gather from the question and comments that the OP might not even be the original designer of the DB or form. OP is also first-time poster."}, {"owner": {"reputation": 1, "user_id": 10550045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c7bc5c04bc280a97e1015a6e85760d?s=128&d=identicon&r=PG&f=1", "display_name": "SashaSolo", "link": "https://stackoverflow.com/users/10550045/sashasolo"}, "edited": false, "score": 0, "creation_date": 1540409853, "post_id": 52962126, "comment_id": 92859969, "body": "Thank you all for the comments and options. As far as design, this is my own design and worked very hard on getting it done the way I want it. Just have this small hickup. Or now lol it seems like its not so small. Using the mulitvalue combobox, never thought I would have issues with it. Looks like there is a solution provided below, just need to tweak it  a little bit, hope Perkins has the answer :)"}, {"owner": {"reputation": 1, "user_id": 10550045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c7bc5c04bc280a97e1015a6e85760d?s=128&d=identicon&r=PG&f=1", "display_name": "SashaSolo", "link": "https://stackoverflow.com/users/10550045/sashasolo"}, "edited": false, "score": 0, "creation_date": 1540410609, "post_id": 52962126, "comment_id": 92860310, "body": "@ Erik von Asmuth can you shine some light on this issue? what is your suggestion?"}, {"owner": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1540410775, "post_id": 52962126, "comment_id": 92860395, "body": "@CPerkins: I should note that the link you provided is specifically asking for alternatives to multi-valued fields in Access (certainly not singing the praises of those types of fields). Of course, if OP already has a design that works for him, more power to him. But one should be aware that using this type of field can complicate your overall design (as evidenced by this very question). Also, if you end up porting to MS SQL Server down the road, you&#39;re just deferring have to properly normalize your data.  Also, I would argue that this field type needlessly complicates your queries."}, {"owner": {"reputation": 1, "user_id": 10550045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c7bc5c04bc280a97e1015a6e85760d?s=128&d=identicon&r=PG&f=1", "display_name": "SashaSolo", "link": "https://stackoverflow.com/users/10550045/sashasolo"}, "reply_to_user": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 0, "creation_date": 1540411653, "post_id": 52962126, "comment_id": 92860768, "body": "@Zack all i use this box is to select which supervisor worked that day, why is this so bad? sorry just don&#39;t understand. I don&#39;t use it in reports nor do I do any query requests for that box. The field that i do use is the WORK_ID which is populated on after event of that box. But as in my OP, I need just the first selected supervisor value to show. That was the hick up."}, {"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "reply_to_user": {"reputation": 2071, "user_id": 9990662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8262X.jpg?s=128&g=1", "display_name": "Zack", "link": "https://stackoverflow.com/users/9990662/zack"}, "edited": false, "score": 1, "creation_date": 1540413569, "post_id": 52962126, "comment_id": 92861635, "body": "@Zack  I understood the irony when I posted the link.  I will not sing praises for MVF, but if you looked at details in my answer, you see that by design a table-based alternative complicates queries also without exception.  I completely agree that an alternative table-based implementation is <i>more portable</i>, but it is not necessarily true that MVF&#39;s make all queries more complicated.  After handling both types, I experienced different challenges, but neither is overall easier for advanced scenarios.  But for some simple scenarios, an MVF is actually very concise."}], "answers": [{"tags": [], "owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "is_accepted": false, "score": 2, "last_activity_date": 1540420346, "last_edit_date": 1540420346, "creation_date": 1540390931, "answer_id": 52971397, "question_id": 52962126, "link": "https://stackoverflow.com/questions/52962126/how-to-obtain-multi-value-field-mvf-data-from-combobox-control/52971397#52971397", "title": "How to obtain multi-value field (MVF) data from ComboBox control?", "body": "<p>The following code demonstrates how to get the selected values from a Multi-value Field (MVF) ComboBox.  I include verbose debugging lines to demonstrate how this information could have been deduced, even when unfamiliar with MVF's or why it was not working as you expected.</p>\n\n<p>I agree with comments from June7 that creating an ID from only one of the multiple values is questionable, but that design decision is beyond the point of the question.  However, at least the code provides ample information for looping through all selected values to generate whatever detail you desire. </p>\n\n<p><strong>Updated</strong> code more specific to question (and without verbose debugging):</p>\n\n<pre><code>  Dim supe1Data As String\n\n  Dim va As Variant\n  va = Me.SUPERVISOR.Value '* Multi-valued Field (MVF)\n\n  Debug.Print \"===============================\"\n\n  If IsNull(va) Then\n    'Value is NULL if NO MVF list items are selected\n\n    supe1Data = \"\"\n  Else\n    '* A Multi-valued Field (MVF) ComboBox will\n    '*   return a variant array of variants.  The\n    '*   array-element variants will be of a type\n    '*   that is compatible with the underlying field value.\n\n    '*** Question-specific code ***\n    Dim iLower As Integer\n    Dim iUpper As Integer\n\n    iLower = LBound(va)\n    iUpper = UBound(va)\n\n    '* Get first selected supervisor code\n\n    If iUpper = 0 Then\n      '* Only ONE value selected, so\n      '*    .Column(2) contains valid data\n      '*    .Recordset property is NOTHING\n\n      '* Contrary to online docs, for MVF...\n      '*   Column(0) is bound data value\n      '*   Column(i) is column i from 1 to .ColumnCount\n      supe1Data = Me.MVF.Column(2)\n    Else\n      '* MULTIPLE value selected, so\n      '*    .Column(2) is NULL\n      '*    .Recordset property is valid and open\n\n      Dim rs As Recordset2\n      Set rs = Me.SUPERVISOR.Recordset.Clone\n\n      '* Since data is already available, lookup can be \n      '*   more efficient than new query (i.e. using DLookup)\n      rs.FindFirst \"[LAST NAME] = '\" &amp; va(0) &amp; \"'\"\n      If Not rs.NoMatch Then\n        '* Here, column indices start at 0\n        supe1Data = rs.Fields(1).Value 'Second column\n      Else\n        supe1Data = \"ERROR\" 'Unexpected\n      End If\n\n      rs.Close\n    End If\n  End If\n\n  Me.WORK_ID = Right(supe1Data, 3) &amp; Format(Me.RECEIVED_DATE, \"yymmdd\")  \n</code></pre>\n\n<p>Original code:</p>\n\n<pre><code>  Dim supe1 As String\n\n  Dim va As Variant\n  va = Me.SUPERVISOR.Value '* Multi-valued Field (MVF)\n\n  If IsNull(va) Then\n    'Value is Null if no MVF list items are selected\n    Debug.Print \"No Supervisor selected\"\n\n    supe1 = \"\"\n  Else\n    '* A Multi-valued Field (MVF) ComboBox will\n    '*   return a variant array of variants.  The\n    '*   array-element variants will be of a type\n    '*   that is compatible with the underlying field value.\n\n    'Discover details of the control value by inspecting\n    '  the types of the returned values.\n    Debug.Print \"Field type: \" &amp; TypeName(va)\n\n    Debug.Print \"Variant array type: \" &amp; VarType(va)\n    Debug.Print \"   vbArray OR vbVariant = \" &amp; (VarType(va) Or vbArray)\n    Debug.Print \"   vbArray   = 8192\"\n    Debug.Print \"   VbVariant = 12\"\n\n    'Inspect the first element\n    Debug.Print \"Element type: \" &amp; VarType(va(0))\n    Debug.Print \"   VbString = 8\"\n\n    Debug.Print \"Array upper-bound: \" &amp; UBound(va)\n\n    '*** Question-specific code ***\n    Dim iLower As Integer\n    Dim iUpper As Integer\n\n    iLower = LBound(va)\n    iUpper = UBound(va)\n\n    supe1 = va(iLower)\n    Debug.Print \"First selected Supervisor: \" &amp; supe1\n  End If\n\n  Me.WORK_ID = Right(supe1, 3) &amp; Format(Me.RECEIVED_DATE, \"yymmdd\")        \n</code></pre>\n\n<p>See <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/vartype-function\" rel=\"nofollow noreferrer\">Microsoft Docs</a> for more info on <code>VarType()</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1540449769, "post_id": 52978370, "comment_id": 92871587, "body": "Solution for the &quot;next&quot; vs &quot;every other&quot; supervisor problem were revealed in the comments of the other answer, <i>now moved to chat</i>.  For the record, I pointed out that Access does not track or encode the order which checkboxes in the list are clicked.  My interpretation of &quot;first selected&quot; was based on default sort orders.  Note that the RowSource sort order is the second column--the code next to the supervisors&#39; names.  However, <b>the sort order of the variant array is the data column--the name column!  In both images the &quot;first selected&quot; record is alphabetical by the name, as expected.</b>"}, {"owner": {"reputation": 1, "user_id": 10550045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c7bc5c04bc280a97e1015a6e85760d?s=128&d=identicon&r=PG&f=1", "display_name": "SashaSolo", "link": "https://stackoverflow.com/users/10550045/sashasolo"}, "reply_to_user": {"reputation": 3502, "user_id": 1261752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OjAfn.png?s=128&g=1", "display_name": "C Perkins", "link": "https://stackoverflow.com/users/1261752/c-perkins"}, "edited": false, "score": 0, "creation_date": 1540450009, "post_id": 52978370, "comment_id": 92871713, "body": "sorry i&#39;m at work and cannot access that section on this PC. I will take a look at home, can you please take a look at my other post? greatly appreciate it :)"}], "tags": [], "owner": {"reputation": 1, "user_id": 10550045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c7bc5c04bc280a97e1015a6e85760d?s=128&d=identicon&r=PG&f=1", "display_name": "SashaSolo", "link": "https://stackoverflow.com/users/10550045/sashasolo"}, "is_accepted": false, "score": 0, "last_activity_date": 1540422397, "last_edit_date": 1540422397, "creation_date": 1540417773, "answer_id": 52978370, "question_id": 52962126, "link": "https://stackoverflow.com/questions/52962126/how-to-obtain-multi-value-field-mvf-data-from-combobox-control/52978370#52978370", "title": "How to obtain multi-value field (MVF) data from ComboBox control?", "body": "<p>OK so thank you for the above here is the code at the moment, BUT still an issue. </p>\n\n<p>So the issue is it still not doing what my original post stated. Just to be clear.</p>\n\n<p>Example: I click to select supervisor, I select for example SUKDEO and then I select BISSO. SUKDEO is the primary supervisor for that job (which in turn I need ONLY his gang number to populate). BUT with this code, when I select SUKDEO and then I select BISSO, Bissos gang number is the one that populates not the (back to my OP) FIRST SELECTED or (maybe I should have said primary) SUPERVISOR.</p>\n\n<p><strong>CORRECTION:</strong> the issue only happens with the NEXT supervisor. IF I select every other supervisor the code works. please see pic.</p>\n\n<p>Hope that makes scene, here is the code and here is a pic.</p>\n\n<p><a href=\"https://i.stack.imgur.com/H572u.jpg\" rel=\"nofollow noreferrer\">does not work with next supervisor</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/lpkrI.jpg\" rel=\"nofollow noreferrer\">only works with every other supervisor</a></p>\n\n<pre><code>Private Sub SUPERVISOR_AfterUpdate()\n Dim supe1Data As String\n\n  Dim va As Variant\n  va = Me.SUPERVISOR.Value '* Multi-valued Field (MVF)\n\n  Debug.Print \"===============================\"\n\n  If IsNull(va) Then\n    'Value is NULL if NO MVF list items are selected\n\n    supe1Data = \"\"\n  Else\n    '* A Multi-valued Field (MVF) ComboBox will\n    '*   return a variant array of variants.  The\n    '*   array-element variants will be of a type\n    '*   that is compatible with the underlying field value.\n\n    '*** Question-specific code ***\n    Dim iLower As Integer\n    Dim iUpper As Integer\n\n    iLower = LBound(va)\n    iUpper = UBound(va)\n\n    '* Get first selected supervisor code\n\n    If iUpper = 0 Then\n      '* Only ONE value selected, so\n      '*    .Column(2) contains valid data\n      '*    .Recordset property is NOTHING\n\n      '* Contrary to online docs, for MVF...\n      '*   Column(0) is bound data value\n      '*   Column(i) is column i from 1 to .ColumnCount\n      supe1Data = Me.SUPERVISOR.Column(2)\n    Else\n      '* MULTIPLE value selected, so\n      '*    .Column(2) is NULL\n      '*    .Recordset property is valid and open\n\n      Dim rs As Recordset2\n      Set rs = Me.SUPERVISOR.Recordset.Clone\n\n      '* Since data is already available, lookup can be\n      '*   more efficient than new query (i.e. using DLookup)\n      rs.FindFirst \"[LAST NAME] = '\" &amp; va(0) &amp; \"'\"\n      If Not rs.NoMatch Then\n        '* Here, column indices start at 0\n        supe1Data = rs.Fields(1).Value 'Second column\n      Else\n        supe1Data = \"ERROR\" 'Unexpected\n      End If\n\n      rs.Close\n    End If\n  End If\n\n  Me.WORK_ID = Right(supe1Data, 3) &amp; Format(Me.RECEIVED_DATE, \"yymmdd\")\nEnd Sub\n</code></pre>\n\n<p>I think that's as clear as I can get lol thank you guys once more, looks like we are almost there :)</p>\n\n<p>-S</p>\n"}], "owner": {"reputation": 1, "user_id": 10550045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c7bc5c04bc280a97e1015a6e85760d?s=128&d=identicon&r=PG&f=1", "display_name": "SashaSolo", "link": "https://stackoverflow.com/users/10550045/sashasolo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541633391, "creation_date": 1540361831, "last_edit_date": 1541633391, "question_id": 52962126, "link": "https://stackoverflow.com/questions/52962126/how-to-obtain-multi-value-field-mvf-data-from-combobox-control", "title": "How to obtain multi-value field (MVF) data from ComboBox control?", "body": "<p>I have a (multi selection) Combo Box of supervisors, when choosing a supervisor from the Combo Box it populates a text box with the supervisors job ID. Now here is the tricky part, sometimes there are two supervisors that need to be selected, when I do that the textbox does not show anything.</p>\n\n<p>So the question is, what is the correct VBA code to have the textbox display only the FIRST selected supervisor and ignore everything else after, and display that supervisors value in the textbox.</p>\n\n<p>Here is the code which I have in vba at the moment. (P.S. the textbox also grabs some other data)</p>\n\n<pre><code>Private Sub SUPERVISOR_AfterUpdate()\n\nMe.WORK_ID = Right(Me.SUPERVISOR.Column(2), 3) &amp; Format(Me.RECEIVED_DATE, \"yymmd\")\n\nEnd Sub\n</code></pre>\n\n<p>Here is a picture of what I refer to:</p>\n\n<p><a href=\"https://imgur.com/a/z982VjM\" rel=\"nofollow noreferrer\">https://imgur.com/a/z982VjM</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 3, "creation_date": 1540361920, "post_id": 52961352, "comment_id": 92830927, "body": "I recommend to still use a UserForm because: 1) Stay away from ActiveX controls where possible, there is a high probability that they cause any kind of issues. 2) UserForms are made exactly for that task, worksheets are not! 3) You could use the <code>TextBox1_KeyDown</code> event to trigger on tab or enter and write some code to focus the next text box but this will bloat up your code and is even more complex than using a UserForm. \u2022 Alternative way, let the user input data in cells instead of TextBoxes."}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1540362670, "post_id": 52961352, "comment_id": 92831253, "body": "Check this <a href=\"https://stackoverflow.com/questions/40766347/change-tab-order-of-some-activex-and-form-controls\">answer</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540366949, "post_id": 52961352, "comment_id": 92833604, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/40766347/change-tab-order-of-some-activex-and-form-controls\">Change tab order of some ActiveX and Form Controls</a>"}, {"owner": {"reputation": 23, "user_id": 10118408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e15bc974aba87bc5aecfd4cae18640?s=128&d=identicon&r=PG&f=1", "display_name": "guffka", "link": "https://stackoverflow.com/users/10118408/guffka"}, "edited": false, "score": 0, "creation_date": 1540369197, "post_id": 52961352, "comment_id": 92834856, "body": "Thank you for your answers. They really help me get the idea of how it could be done. Anyway, currently in my worksheet there are about 180-200 TextBoxes. If I followed your answer method, I would have to put the codes into every TextBoxes. So, is there any way to make a loop (a single set of code) for this? For example, some thing similar to this a = a + 1 Me.Controls(&quot;TextBox&quot; &amp; a).Active"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540373368, "post_id": 52961352, "comment_id": 92837441, "body": "This is why I suggested to use a UserForm. Because it is easier. If there are 200 TextBoxes then you should re-think your general approach. You probably chose the wrong control and a ListView would be better. I cannot imagine any reason why not to use a UserForm for that. \u2022 If you try to explain (in your question) what you are trying to do in general then we can probably suggest a better way to do that."}, {"owner": {"reputation": 23, "user_id": 10118408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e15bc974aba87bc5aecfd4cae18640?s=128&d=identicon&r=PG&f=1", "display_name": "guffka", "link": "https://stackoverflow.com/users/10118408/guffka"}, "edited": false, "score": 0, "creation_date": 1540376039, "post_id": 52961352, "comment_id": 92839114, "body": "Thank you again for your help. The purpose of this worksheet is to make a filling form to get data from a paper form. So, to make it easier for others to fill the data in, I have to make the worksheet looks like the paper.   In this case, there are many products; 1 product/1 paper form. IMO, working in a worksheet is easier to manipulate the contents because there are some parts of the form that are the same in each product. So, I can just copy/paste those parts for other forms."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1540450927, "post_id": 52961352, "comment_id": 92872171, "body": "You can easily make the UserForm looking like a paper form by making a JPEG of that paper form and then use the <code>Picture</code> property to add it into the background of the UserForm. Then just put your TextBoxes at the right positions of the &quot;paper&quot; form. Working with UserForms is as easy as with worksheets (you can <a href=\"https://stackoverflow.com/questions/16817764/duplicate-user-form-in-excel-vba\">export/import UserForms to duplicate</a> them) or you can also copy parts of one form to another. I see only advantages of using UserForms."}, {"owner": {"reputation": 23, "user_id": 10118408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e15bc974aba87bc5aecfd4cae18640?s=128&d=identicon&r=PG&f=1", "display_name": "guffka", "link": "https://stackoverflow.com/users/10118408/guffka"}, "edited": false, "score": 0, "creation_date": 1540798021, "post_id": 52961352, "comment_id": 92980504, "body": "That&#39;s really cool. I have tried as you suggested. The problem I find is that the height of the page is to large. So, I have to use ScrollBar and I have tried once with the codes that enable mouse&#39;s scroll wheel to work. The codes do not work with MultiPage. Do you have any advice?"}], "owner": {"reputation": 23, "user_id": 10118408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e15bc974aba87bc5aecfd4cae18640?s=128&d=identicon&r=PG&f=1", "display_name": "guffka", "link": "https://stackoverflow.com/users/10118408/guffka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586463420, "creation_date": 1540357083, "last_edit_date": 1586463420, "question_id": 52961352, "link": "https://stackoverflow.com/questions/52961352/can-we-use-tab-enter-to-move-on-to-other-textbox-in-excel-worksheet", "title": "Can we use tab/enter to move on to other TextBox in Excel Worksheet?", "body": "<p><a href=\"https://i.stack.imgur.com/D1Qje.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D1Qje.png\" alt=\"enter image description here\"></a></p>\n\n<p>I wonder if I can move from TextBox to TextBox in a worksheet by using tab or enter just like it can in userform where we can set the TabOrder.\n(The reason for not using userform is that my sheet is quite complex, which building it on a worksheet is much easier and more flexible for adjusting the size and position.)</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1540353290, "post_id": 52960833, "comment_id": 92828469, "body": "Is <code>NumToWords</code> referencing any cells on the deleted sheet? I suspect all you need to do is set calculation to manual.  That&#39;s if you&#39;re even worried about it - does it really matter if cells on the deleting sheet are evaluating when you delete it?"}, {"owner": {"reputation": 57, "user_id": 9509928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148a4f7680e0b4afa56d634f5c75a3a5?s=128&d=identicon&r=PG", "display_name": "Vimal", "link": "https://stackoverflow.com/users/9509928/vimal"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540353888, "post_id": 52960833, "comment_id": 92828589, "body": "No i dont want to check the content of the sheet being deleted. This is just a sanity cleanup which i am doing each time the user form closes. I tried below code for setting up the calculation to manual. still its happening - &quot;ThisWorkbook.Worksheets(&quot;Agent_info_Temp&quot;).EnableCalculatio&zwnj;&#8203;n = False&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1540354191, "post_id": 52960833, "comment_id": 92828657, "body": "Try <code>Application.Calculation = xlCalculationManual|xlCalculationAutomatic</code>"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 9509928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148a4f7680e0b4afa56d634f5c75a3a5?s=128&d=identicon&r=PG", "display_name": "Vimal", "link": "https://stackoverflow.com/users/9509928/vimal"}, "edited": false, "score": 0, "creation_date": 1540354109, "post_id": 52960902, "comment_id": 92828641, "body": "Yea.. this worked. I guess thats what Comintern was also referring. thanks to both. appreciate your quick help. But strange thing is there was no reference of he module in that sheet Still it was being invoked."}], "tags": [], "owner": {"reputation": 66, "user_id": 10549684, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6117d60257762198048bf6bd186ad9ca?s=128&d=identicon&r=PG", "display_name": "HiddenChineseSpyChip", "link": "https://stackoverflow.com/users/10549684/hiddenchinesespychip"}, "is_accepted": true, "score": 5, "last_activity_date": 1540353639, "creation_date": 1540353639, "answer_id": 52960902, "question_id": 52960833, "link": "https://stackoverflow.com/questions/52960833/vba-execution-being-passed-to-module-while-deleting-a-worksheet/52960902#52960902", "title": "VBA execution being passed to module while deleting a worksheet", "body": "<p>It is likely Agent_Info_Temp is invoking NumToWords as a formula in one of its columns.  When you Set wsSheet, the sheet goes through its calculation procedure.  If NumToWords is there, it gets invoked and you see it in the debug stream.</p>\n\n<p>I think you can turn Automatic ReCalc off (in VBA), then go through the deletion step.</p>\n"}], "owner": {"reputation": 57, "user_id": 9509928, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/148a4f7680e0b4afa56d634f5c75a3a5?s=128&d=identicon&r=PG", "display_name": "Vimal", "link": "https://stackoverflow.com/users/9509928/vimal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 1, "accepted_answer_id": 52960902, "answer_count": 1, "score": 1, "last_activity_date": 1586463456, "creation_date": 1540353022, "last_edit_date": 1586463456, "question_id": 52960833, "link": "https://stackoverflow.com/questions/52960833/vba-execution-being-passed-to-module-while-deleting-a-worksheet", "title": "VBA execution being passed to module while deleting a worksheet", "body": "<p>I am facing a strange issue. Sorry if its too dumb or something obvious i missed.</p>\n\n<p>I have userform termination sub. While debugging i saw the control was being passed to another module in the workbook called \"Numtowords\" when i am trying to delete a temp worksheet while userform termination. I am nowhere invoking the module. So not sure why such behavior. Below are screens that show as soon as i press F8 when the control is at Worksheet (\"Agent_info_temp\").Delete the control reaches the module numtowords. </p>\n\n<p>Please help why this is happening. I searched a lot but may be my phrasing is incorrect. If cant be resolved can i somehow stop the module call??\n<a href=\"https://i.stack.imgur.com/Kiuwb.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Kiuwb.jpg\" alt=\"Step 1:\"></a> </p>\n\n<p>then this happens </p>\n\n<p><a href=\"https://i.stack.imgur.com/LCGCA.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LCGCA.jpg\" alt=\"Step 2:\"></a></p>\n"}, {"tags": ["vba", "loops", "conditional-formatting", "worksheet"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10549560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v7XDt85DZFQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAHZEXeYSJsGPUhMXPD5Ivf3Rty6Q/mo/photo.jpg?sz=128", "display_name": "pharzand inc", "link": "https://stackoverflow.com/users/10549560/pharzand-inc"}, "edited": false, "score": 0, "creation_date": 1540410802, "post_id": 52961213, "comment_id": 92860404, "body": "THANK YOU! Worked perfectly."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 13, "user_id": 10549560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v7XDt85DZFQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAHZEXeYSJsGPUhMXPD5Ivf3Rty6Q/mo/photo.jpg?sz=128", "display_name": "pharzand inc", "link": "https://stackoverflow.com/users/10549560/pharzand-inc"}, "edited": false, "score": 0, "creation_date": 1540451652, "post_id": 52961213, "comment_id": 92872522, "body": "@pharzandinc, Please mark this answer as accepted. It shows other people that the question is solved and gives the person who answered some credit. Take care :) <a href=\"https://meta.stackexchange.com/questions/5234/how-does-accepting-an-answer-work\">Accepting Answers: How does it work?</a>"}, {"owner": {"reputation": 13, "user_id": 10549560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v7XDt85DZFQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAHZEXeYSJsGPUhMXPD5Ivf3Rty6Q/mo/photo.jpg?sz=128", "display_name": "pharzand inc", "link": "https://stackoverflow.com/users/10549560/pharzand-inc"}, "reply_to_user": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "edited": false, "score": 1, "creation_date": 1540525261, "post_id": 52961213, "comment_id": 92906451, "body": "@wizhi thank you for telling me this, I was looking at marking it as responded but didn&#39;t see anything so left it as is until you have mentioned it"}], "tags": [], "owner": {"reputation": 76, "user_id": 10547491, "user_type": "registered", "profile_image": "https://graph.facebook.com/2499022153458365/picture?type=large", "display_name": "Jimmy M.", "link": "https://stackoverflow.com/users/10547491/jimmy-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1540356025, "creation_date": 1540356025, "answer_id": 52961213, "question_id": 52960659, "link": "https://stackoverflow.com/questions/52960659/vba-looping-through-different-worksheets-and-pasting-rows-into-master-worksheet/52961213#52961213", "title": "VBA Looping through different worksheets and pasting rows into master worksheet if condition is met", "body": "<p>I don't know where you put the IF statement, but it must work in this way:</p>\n\n<pre><code>Dim ws As Worksheet\nDim i, LastRow\n\nFor Each ws In Worksheets\nIf ws.Name &lt;&gt; \"Sold\" Then\n    LastRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For i = 2 To LastRow\n        If ws.Cells(i, \"M\").Value = \"Paid\" Then\n         ws.Cells(i, \"M\").EntireRow.Copy Destination:=Sheets(\"Sold\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n        End If\n    Next i\nEnd If\n\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10549560, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v7XDt85DZFQ/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAHZEXeYSJsGPUhMXPD5Ivf3Rty6Q/mo/photo.jpg?sz=128", "display_name": "pharzand inc", "link": "https://stackoverflow.com/users/10549560/pharzand-inc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 52961213, "answer_count": 1, "score": 1, "last_activity_date": 1540356025, "creation_date": 1540351559, "question_id": 52960659, "link": "https://stackoverflow.com/questions/52960659/vba-looping-through-different-worksheets-and-pasting-rows-into-master-worksheet", "title": "VBA Looping through different worksheets and pasting rows into master worksheet if condition is met", "body": "<p>I would like to create VBA code for a command button that does the following:\n1. Loops through all worksheets except master worksheet (SOLD)\n2. Copies rows if condition is met (Paid)\n3. Pastes rows to Master worksheet (Sold)</p>\n\n<p>So far I have the code but my problem is that it loops through all worksheets including master worksheet (i.e duplicates information in master worksheet) and if I try to write for If ws.name&lt;>\"Sold\" then The code stops working giving message box error .  Please help me modify the code.</p>\n\n<pre><code>    Private Sub CommandButton1_Click()\nDim ws As Worksheet\nFor Each ws In ThisWorkbook.Worksheets\n\nDim i, LastRow\n\nLastRow = ws.Range(\"A\" &amp; Rows.count).End(xlUp).Row\nFor i = 2 To LastRow\nIf ws.Cells(i, \"M\").Value = \"Paid\" Then\nws.Cells(i, \"M\").EntireRow.Copy Destination:=Sheets(\"Sold\").Range(\"A\" &amp; Rows.count).End(xlUp).Offset(1)\nEnd If\nNext i\nNext ws\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "combobox", "userform"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1541971044, "post_id": 52960627, "comment_id": 93391252, "body": "Added a fast solution using a datafield array - @RoryAdamson"}], "answers": [{"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1542097104, "last_edit_date": 1542097104, "creation_date": 1541970975, "answer_id": 53253306, "question_id": 52960627, "link": "https://stackoverflow.com/questions/52960627/three-cascading-comboboxes/53253306#53253306", "title": "Three cascading Comboboxes", "body": "<p><strong>Speed it up by using a datafield array</strong> </p>\n\n<p>As far as I understood, your main concern is to achieve improved speed using cascading comboboxes in a UserForm and readable code avoiding numerous <code>.Offset</code> .</p>\n\n<p>[i.] Looping through a range is always time consuming, it's <strong>faster</strong> to assign your complete data set to a <em>variant</em> <strong>datafield array (<code>myData</code>)</strong>. </p>\n\n<p>[ii.] Calling a <strong>single helper procedure</strong> <code>fillComboNo</code> makes the <code>_Change</code> event procedures <em>more readable</em>.</p>\n\n<p>[iii.] The additional helper procedure <code>SortColl</code> <strong>sorts</strong> each collection to make selections <em>user friendly</em>. </p>\n\n<p>[iv.]  Furthermore this example code allows to <strong>add</strong> <em>even more comboboxes</em> using the same helper procedure <code>fillComboNo</code> in additional <code>Combobox{No}_Change</code> event procedures. - Of course, in this case it would be necessary to extend the range assigned to the datafield array <code>myData</code>, too <em>(i.e. from 3 columns <code>A:C</code> to e.g. <code>A:D</code>)</em>.</p>\n\n<p><strong>Example code</strong></p>\n\n<p>Basically this solution is close to your approach as it uses collections, too. It is <em>faster</em> as it uses a datafield array as described above; <em>it does not pretend to offer the most efficient way to show cascading comboboxes.</em> </p>\n\n<p>This example assumes that all needed ComboBoxes are enumerated <code>ComboBox1</code>, <code>ComboBox2</code>, <code>ComboBox3</code>, ...</p>\n\n<pre><code>Option Explicit                                     ' declaration head of the UserForm code module\nDim myData                                          ' Variant 2-dim datafield array ( 1-based !)\n\nPrivate Sub UserForm_Initialize()\n  Dim LR   As Long, ws As Worksheet\n  Set ws = Sheet1                                   ' if using CodeName in thisWorkbook\n' ~~~~~~~~~~~~~~~~~~~~~~~~~\n' [0] get entire DATA FIELD                         ' e.g. columns A:C (omitting title row)\n' ~~~~~~~~~~~~~~~~~~~~~~~~~\n  LR = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row     ' get last row\n  myData = ws.Range(\"A2:C\" &amp; LR).Value2             ' &lt;&lt;  assign range values to datafield array\n\n' [1] fill first ComboBox\n  FillComboNo 1                                     ' &lt;~~ helper procedure FillComboNo\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\n    FillComboNo 2                                   ' &lt;~~ helper procedure FillComboNo\nEnd Sub\n\nPrivate Sub ComboBox2_Change()\n    FillComboNo 3                                   ' &lt;~~ helper procedure FillComboNo\nEnd Sub\n</code></pre>\n\n<p><strong>Helper procedure <code>FillComboNo</code></strong></p>\n\n<pre><code>Sub FillComboNo(ByVal no As Long)\n' Purpose: fill cascading comboboxes\n' Note:    assumes controls named as \"ComboBox\" &amp; No (ComboBox1, ComboBox2, ...)\nDim myList As New Collection\nDim item   As Variant\nDim i      As Long, ii As Long\nDim OK     As Boolean, OKTemp As Boolean\n' [0] clear ComboBox{No}\n  Me.Controls(\"ComboBox\" &amp; no).Clear\n' [1] assign values in column No based on prior hierarchy levels\n  For i = LBound(myData) To UBound(myData)\n    ' [1a] check upper hierarchy\n      OK = True\n      For ii = 1 To no - 1\n          OKTemp = myData(i, ii) = Me.Controls(\"ComboBox\" &amp; ii): OK = OK And OKTemp\n      Next ii\n    ' [1b] add to collection\n      If OK Then\n         On Error Resume Next\n         myList.Add myData(i, no), myData(i, no)\n         If Err.Number &lt;&gt; 0 Then Err.Clear\n      End If\n  Next i\n' [1c] sort collection via helper procedure\n      SortColl myList                               ' &lt;~~ helper procedure SortColl\n' [2] fill ComboBox{No}\n  For Each item In myList\n      Me.Controls(\"ComboBox\" &amp; no).AddItem item\n  Next item\nEnd Sub\n</code></pre>\n\n<p><strong>Sorting routine <code>SortColl</code></strong></p>\n\n<pre><code>Sub SortColl(ByRef c As Collection)\n' Purpose: sort collection by keys via bubble sort method\n  Dim i     As Long, j As Long\n  Dim vTemp As Variant\n  For i = 1 To c.Count - 1\n      For j = i + 1 To c.Count\n          If c(i) &gt; c(j) Then\n            ' remember the lesser item\n              vTemp = c(j)\n            ' remove the lesser item\n              c.Remove j\n            ' add the lesser item before the greater one\n              c.Add vTemp, vTemp, i\n          End If\n      Next j\n  Next i\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10549552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac7f2e9fcb762d20376803f88a4fec5a?s=128&d=identicon&r=PG&f=1", "display_name": "RoryAdamson", "link": "https://stackoverflow.com/users/10549552/roryadamson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1542097104, "creation_date": 1540351270, "last_edit_date": 1541971487, "question_id": 52960627, "link": "https://stackoverflow.com/questions/52960627/three-cascading-comboboxes", "title": "Three cascading Comboboxes", "body": "<p>I have a relatively large amount of data that I am trying to convert into three <code>comboboxes</code> in an <code>excel userform</code>. Basically I am trying to create a purchase order system for construction products. This involves the three comboboxes, basically broken down into \"Category\", \"Sub Category\" and \"Product\". </p>\n\n<p>I found some code that uses the <code>.offset</code> function, however the only way I found to use this was very time consuming. I am very new to VBA. </p>\n\n<p>Is there a way to use this code or another code to effectively sort through my data rather than me manually changing the offset each time?</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim ws As Worksheet\nDim LR As Long\nDim Cell As Range\nDim List As New Collection\nDim Item As Variant\nSet ws = ActiveSheet\n\nWith ws\nLR = Sheet1.Cells(.Rows.Count, 1).End(xlUp).Row\nFor Each Cell In .Range(\"A2:A\" &amp; LR)\n    With Cell\n        On Error Resume Next\n        List.Add .Text, CStr(.Value)\n        On Error GoTo 0\n    End With\nNext Cell\nFor Each Item In List\n    ComboBox1.AddItem Item\n    Next Item\nEnd With\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\n\nDim ws As Worksheet\nDim LR As Long\nDim Cell As Range\nDim List As New Collection\nDim Item As Variant\nSet ws = ActiveSheet\n\n\nWith ws\n    LR = Sheet1.Cells(.Rows.Count, 1).End(xlUp).Row\n    ComboBox2.Clear\n    For Each Cell In .Range(\"A2:A\" &amp; LR)\n        With Cell\n            If .Text = ComboBox1.Value Then\n                On Error Resume Next\n                List.Add .Offset(0, 1).Text, CStr(.Offset(0, 1).Value)\n                On Error GoTo 0\n            End If\n        End With\n    Next Cell\n    For Each Item In List\n        ComboBox2.AddItem Item\n    Next Item\nEnd With\n\n\nEnd Sub\n\nPrivate Sub ComboBox2_Change()\n\nDim ws As Worksheet\nDim LR As Long\nDim Cell As Range\nDim List As New Collection\nDim Item As Variant\nSet ws = ActiveSheet\n\nWith ws\n    LR = Sheet1.Cells(.Rows.Count, 1).End(xlUp).Row\n    ComboBox3.Clear\n    For Each Cell In .Range(\"A2:A\" &amp; LR)\n        With Cell\n            If .Text = ComboBox1.Value Then\n                If .Offset(0, 1).Text = ComboBox2.Value Then\n                On Error Resume Next\n                List.Add .Offset(0, 2).Text, CStr(.Offset(0, 2).Value)\n                On Error GoTo 0\n            End If\n        End If\n        End With\n    Next Cell\n    For Each Item In List\n        ComboBox3.AddItem Item\n    Next Item\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be awesome! </p>\n"}, {"tags": ["excel", "vba", "sharepoint-online"], "comments": [{"owner": {"reputation": 101, "user_id": 1690180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccc099d7398069a9ab353a0f747ec5a?s=128&d=identicon&r=PG", "display_name": "angelofdev", "link": "https://stackoverflow.com/users/1690180/angelofdev"}, "edited": false, "score": 0, "creation_date": 1540352268, "post_id": 52960619, "comment_id": 92828270, "body": "You might get a faster response asking this on <a href=\"https://superuser.com/\">superuser</a>."}, {"owner": {"reputation": 1, "user_id": 10549541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ebd1cbd0f00dd290c1d29fa95123b4?s=128&d=identicon&r=PG&f=1", "display_name": "riss", "link": "https://stackoverflow.com/users/10549541/riss"}, "reply_to_user": {"reputation": 101, "user_id": 1690180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ccc099d7398069a9ab353a0f747ec5a?s=128&d=identicon&r=PG", "display_name": "angelofdev", "link": "https://stackoverflow.com/users/1690180/angelofdev"}, "edited": false, "score": 0, "creation_date": 1540357763, "post_id": 52960619, "comment_id": 92829554, "body": "Okay, thanks.. will do."}, {"owner": {"reputation": 3363, "user_id": 786238, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2ad644dfd29b5e1705af19c770ff65d5?s=128&d=identicon&r=PG", "display_name": "Laurent Crivello", "link": "https://stackoverflow.com/users/786238/laurent-crivello"}, "edited": false, "score": 0, "creation_date": 1561838286, "post_id": 52960619, "comment_id": 100193936, "body": "Hey, did you have an answer on this question ? Having same challenge now. Thanks !"}], "owner": {"reputation": 1, "user_id": 10549541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/70ebd1cbd0f00dd290c1d29fa95123b4?s=128&d=identicon&r=PG&f=1", "display_name": "riss", "link": "https://stackoverflow.com/users/10549541/riss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 440, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1586463492, "creation_date": 1540351184, "last_edit_date": 1586463492, "question_id": 52960619, "link": "https://stackoverflow.com/questions/52960619/updating-list-in-sharepoint-online-o365-via-excel-vba", "title": "Updating List in Sharepoint Online (o365) via Excel/VBA", "body": "<p>I am currently using VBA to update/create new sharepoint list items via SOAP.</p>\n\n<p>My IT dept has advised that they are migrating to SharePoint Online and the same code no longer works, I believe due to different authentication processes.</p>\n\n<p>I have spent close to four days trying to find an alternative solution for o365 via VBA but unfortunately I'm not having much luck.</p>\n\n<p>I am hoping that there is someone out there that may be able to assist, I've included my original VBA/SOAP code as a reference for what I'm trying to replicate.</p>\n\n<p>Many thanks,\nRiss</p>\n\n<pre><code>Sub addItemtoList()\n\n    Dim LISTNAME As String\n    Dim SharepointUrl As String\n    Dim ValueVar As String\n    Dim FieldNameVar As String\n    Dim CurUserName As String, CurPassword As String\n    CurUserName = \"user.name\"\n    CurPassword = \"password123\"\n\n    LISTNAME = \"SharepointlistName\"      'Or Guild\n\n    SharepointUrl = \"https://xxxxxxxx.sharepoint.com/sites/au/finance/xxxxxx/\"\n    ValueVar = \"Testing Value Add\"\n    FieldNameVar = \"'Title'\"\n\n    Dim objXMLHTTP As MSXML2.XMLHTTP\n\n    Dim strListNameOrGuid As String\n    Dim strBatchXml As String\n    Dim strSoapBody As String\n\n    Set objXMLHTTP = New MSXML2.XMLHTTP\n\n    strListNameOrGuid = LISTNAME\n\n\n    'Add New Item'\n    strBatchXml = \"&lt;Batch OnError='Continue'&gt;&lt;Method ID='1' Cmd='New'&gt;&lt;Field Name='ID'&gt;New&lt;/Field&gt;&lt;Field Name=\" + FieldNameVar + \"&gt;\" + ValueVar + \"&lt;/Field&gt;&lt;/Method&gt;&lt;/Batch&gt;\"\n\n    objXMLHTTP.Open \"POST\", SharepointUrl + \"_vti_bin/Lists.asmx\", False, CurUserName, CurPassword\n    objXMLHTTP.setRequestHeader \"Content-Type\", \"text/xml; charset=\"\"UTF-8\"\"\"\n    objXMLHTTP.setRequestHeader \"SOAPAction\", \"http://schemas.microsoft.com/sharepoint/soap/UpdateListItems\"\n\n    strSoapBody = \"&lt;soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' \" _\n     &amp; \"xmlns:xsd='http://www.w3.org/2001/XMLSchema' \" _\n     &amp; \"xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'&gt;&lt;soap:Body&gt;&lt;UpdateListItems \" _\n     &amp; \"xmlns='http://schemas.microsoft.com/sharepoint/soap/'&gt;&lt;listName&gt;\" &amp; strListNameOrGuid _\n     &amp; \"&lt;/listName&gt;&lt;updates&gt;\" &amp; strBatchXml &amp; \"&lt;/updates&gt;&lt;/UpdateListItems&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;\"\n\n    objXMLHTTP.send strSoapBody\n\n    If objXMLHTTP.Status = 200 Then\n    ' Do something with response\n    End If\n\n    Set objXMLHTTP = Nothing\n\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "concat"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1540348402, "post_id": 52960214, "comment_id": 92827551, "body": "Please update your question to include the full code in the screenshot. When you&#39;re done with that, add <code>Option Explicit</code> to the top of the module and fix all the compile errors. You get the 1004 because <code>mylastcell_5</code> is never defined."}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1540349154, "post_id": 52960214, "comment_id": 92827688, "body": "which version of Excel?"}, {"owner": {"reputation": 101, "user_id": 6222102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8ace7c283705e74b46f3b48d4470f1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Begg", "link": "https://stackoverflow.com/users/6222102/n-begg"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540349705, "post_id": 52960214, "comment_id": 92827798, "body": "@Comintern  I&#39;ve updated the script and I&#39;m no longer getting errors, but it still isn&#39;t doing anything I want it to."}, {"owner": {"reputation": 101, "user_id": 6222102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8ace7c283705e74b46f3b48d4470f1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Begg", "link": "https://stackoverflow.com/users/6222102/n-begg"}, "reply_to_user": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1540349919, "post_id": 52960214, "comment_id": 92827845, "body": "@Vasily Excel version Professional Plus 2016"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540350147, "post_id": 52960214, "comment_id": 92827890, "body": "You forgot the part about <a href=\"https://stackoverflow.com/posts/52960214/edit\">editing your question</a> to include the full code instead of <a href=\"https://meta.stackoverflow.com/q/374700/4088852\">a screenshot of your code</a>."}, {"owner": {"reputation": 101, "user_id": 6222102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8ace7c283705e74b46f3b48d4470f1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Begg", "link": "https://stackoverflow.com/users/6222102/n-begg"}, "edited": false, "score": 0, "creation_date": 1540352202, "post_id": 52960214, "comment_id": 92828254, "body": "textjoin is only in the 365 subscription excel rather than the version we have :/ That would be amazing if I could use it!"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540353056, "post_id": 52960214, "comment_id": 92828423, "body": "So what would a typical value for <code>mylastcell_5</code> be?  Remember, <code>.Address</code> returns an <i>absolute</i> cell address, i.e. <code>$A$1</code>."}, {"owner": {"reputation": 101, "user_id": 6222102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8ace7c283705e74b46f3b48d4470f1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Begg", "link": "https://stackoverflow.com/users/6222102/n-begg"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1540353927, "post_id": 52960214, "comment_id": 92828596, "body": "@Comintern mylastcell_5 should be null.  It is the place holder to tell the concatenate when to stop.  It has been generated by looking down from the original row to find out when those values have stopped.  I&#39;ve added a screenshot of this into my question.  Does this mean that I need to change the activecell to be an offest of mylastcell_1 (which does have a value) can you do this? is there another way of doing it that doesn&#39;t use .address?"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 6222102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8ace7c283705e74b46f3b48d4470f1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Begg", "link": "https://stackoverflow.com/users/6222102/n-begg"}, "edited": false, "score": 0, "creation_date": 1540413463, "post_id": 52971779, "comment_id": 92861583, "body": "Hi Oxwilder, it is asking for c to be defined, what do I define it as?"}, {"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "reply_to_user": {"reputation": 101, "user_id": 6222102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8ace7c283705e74b46f3b48d4470f1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Begg", "link": "https://stackoverflow.com/users/6222102/n-begg"}, "edited": false, "score": 0, "creation_date": 1540417148, "post_id": 52971779, "comment_id": 92863052, "body": "When the input box comes up, did you select a range of cells you want to add to the list? You can select the range with your mouse or type a group of cells into the box."}, {"owner": {"reputation": 101, "user_id": 6222102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8ace7c283705e74b46f3b48d4470f1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Begg", "link": "https://stackoverflow.com/users/6222102/n-begg"}, "edited": false, "score": 0, "creation_date": 1540418188, "post_id": 52971779, "comment_id": 92863383, "body": "I ended up defining c as a range which made that part happy so I could actually run the tool.  But when I copied my selection of values into the input box I got an error from Excel saying that there is a problem with the formula. I have tried to change the input box to a selection by changing it to   Range(&quot;A1&quot;).Select  Set rng = Selection.End(xlToRight).Select.  But its not actually doing anything still."}, {"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "reply_to_user": {"reputation": 101, "user_id": 6222102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8ace7c283705e74b46f3b48d4470f1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Begg", "link": "https://stackoverflow.com/users/6222102/n-begg"}, "edited": false, "score": 0, "creation_date": 1540433149, "post_id": 52971779, "comment_id": 92866945, "body": "No, you don&#39;t want to add the values. You just select the cells where the values are. Drag the mouse over the cells containing the data you want to concatenate."}, {"owner": {"reputation": 101, "user_id": 6222102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8ace7c283705e74b46f3b48d4470f1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Begg", "link": "https://stackoverflow.com/users/6222102/n-begg"}, "edited": false, "score": 0, "creation_date": 1540434801, "post_id": 52971779, "comment_id": 92867341, "body": "I have selected the values and it looks like it does something, but there is no output at all."}, {"owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "reply_to_user": {"reputation": 101, "user_id": 6222102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8ace7c283705e74b46f3b48d4470f1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Begg", "link": "https://stackoverflow.com/users/6222102/n-begg"}, "edited": false, "score": 0, "creation_date": 1540444035, "post_id": 52971779, "comment_id": 92869411, "body": "@N.Begg Adapted function to your issue. Try these instead."}], "tags": [], "owner": {"reputation": 540, "user_id": 7747667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6XJn7.jpg?s=128&g=1", "display_name": "oxwilder", "link": "https://stackoverflow.com/users/7747667/oxwilder"}, "is_accepted": false, "score": 0, "last_activity_date": 1540443996, "last_edit_date": 1540443996, "creation_date": 1540391995, "answer_id": 52971779, "question_id": 52960214, "link": "https://stackoverflow.com/questions/52960214/concatenate-an-unknown-number-of-cells/52971779#52971779", "title": "Concatenate an unknown number of cells", "body": "<p>I don't know if you always plan to concatenate elements into a single-quote enclosed comma-delimited string, but if you do here are a couple ways to do that (I've found it useful for quickly inserting things into SQL statements, for example). One joins vertical strings (single column) and one joins horizontal strings (single row). This would be a standard worksheet function where you would enter something like <code>=hjoin(a1:h1)</code> or <code>=vjoin(a1:a7)</code></p>\n\n<pre><code>Function hJoin(inRng As Range) As String\nDim c As Range\nDim outStr As String\nDim rng As Range\n\nSet rng = Range(inRng.Address)\n\n\nFor Each c In rng.Columns\n    If c.Address = rng.Cells(rng.Cells.Count).Address Then\n            outStr = outStr &amp; \" '\" &amp; c.Value &amp; \"'\"\n        Else\n            outStr = outStr &amp; \" '\" &amp; c.Value &amp; \"',\"\n        End If\n    Next c\n\nhJoin = outStr\n\nEnd Function\n\nFunction vJoin(inRng As Range) As String\nDim c As Range\nDim outStr As String\nDim rng As Range\n\nSet rng = Range(inRng.Address)\n\n\nFor Each c In rng.Rows\n    If c.Address = rng.Cells(rng.Cells.Count).Address Then\n         outStr = outStr &amp; \" '\" &amp; c.Value &amp; \"'\"\n    Else\n         outStr = outStr &amp; \" '\" &amp; c.Value &amp; \"',\"\n    End If\nNext c\n\nvJoin = outStr\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 6222102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc8ace7c283705e74b46f3b48d4470f1?s=128&d=identicon&r=PG&f=1", "display_name": "N. Begg", "link": "https://stackoverflow.com/users/6222102/n-begg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 222, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1540443996, "creation_date": 1540347637, "last_edit_date": 1540382297, "question_id": 52960214, "link": "https://stackoverflow.com/questions/52960214/concatenate-an-unknown-number-of-cells", "title": "Concatenate an unknown number of cells", "body": "<p>This is a follow on question from my original question which has helped me solve the first part of my script: <a href=\"https://stackoverflow.com/questions/52958308/autofill-unknown-amount-of-cells\">Autofill unknown amount of cells</a>.</p>\n\n<p>The second part of my script is to concatenate an unknown number of cells.\nUsing the logic from the first question I have tried to alter my script for to this <code>myconcatenate = ActiveCell.FormulaArray = \"=Concatenate(\"A5\", mylastcell_4)\"</code>\nBut it is resulting in a <strong>syntax error.</strong></p>\n\n<p>Originally I was given this piece of script which worked fine on its own but doesn't work when added to the bottom of my script </p>\n\n<pre><code>  Do\n    myconcatenate = myconcatenate &amp; ActiveCell.Value\n    ActiveCell.Offset(0, 1).Select\n  Loop Until ActiveCell.Address = mylastcell_5\n\n  Range(\"A5\").Select\n  ActiveCell.Value = myconcatenate\n</code></pre>\n\n<p>This gives a <strong>run time error '1004' Application-defined or object-defined error</strong> and will go to the very last cell on row 5 (even though I only have 5 currently occupied in Row 1) and does nothing while it passes through all the cells.  Sometimes it will do the first bit of the script (adds '', to the cell values) other times it doesn't.</p>\n\n<p>Here is my full script for context: <a href=\"https://i.stack.imgur.com/y4Oga.png\" rel=\"nofollow noreferrer\">Screenshot of full script</a></p>\n\n<p>Ultimately I am trying to get from a list of abcdedf to 'a','b','c','d','e','f', into one cell.</p>\n\n<p>Ultimate goal picture: <br><img src=\"https://i.stack.imgur.com/5vEnI.png\" alt=\"Ultimate goal picture\">  <br>row 5 cell D gives the ultimate answer I'm after, E5 would be <strong>mylastcell_5</strong> </p>\n\n<p>This is my first day on VBA, and I have spent the whole day googling bits to try and answer questions but this hasn't resulted in anything for me.</p>\n\n<p><strong>UPDATE:</strong> I've declared mylastcell_5 which I hadn't done previously.  I'm now getting no error in the script and it is just hanging out at A5 rather than going to the very end of the page, but it's not actually concatenating.</p>\n\n<p><strong>So I think that somehow I need to change my loop so that it is writing to row 5 but reading from row 4 ... but I don't know how to do this.</strong></p>\n\n<pre><code>Option Explicit\nSub concat()\n'\n' concat Macro\n' 'text','text'\n'\n' Keyboard Shortcut: Ctrl+Shift+C\n'\nWith ThisWorkbook.Worksheets(\"Sheet1\")\nDim mylastcell_1 As String, mylastcell_2 As String, mylastcell_3 As String, mylastcell_4 As String, mylastcell_5 As String, myconcatenate As String, myconcatenate1 As String\n    Range(\"A1\").Select\n    Selection.End(xlToRight).Select\n    mylastcell_1 = ActiveCell.Address\n\n    Range(mylastcell_1).Select\n    ActiveCell.Offset(1, 0).Select\n    mylastcell_2 = ActiveCell.Address\n\n    Range(mylastcell_2).Select\n    ActiveCell.Offset(1, 0).Select\n    mylastcell_3 = ActiveCell.Address\n\n    Range(mylastcell_3).Select\n    ActiveCell.Offset(1, 0).Select\n    mylastcell_4 = ActiveCell.Address\n\n    Range(mylastcell_4).Select\n    ActiveCell.Offset(1, 0).Select\n    mylastcell_5 = ActiveCell.Address\n\n    myconcatenate = ActiveCell.Value\n    ActiveCell.Offset(0, 1).Select\n\n\n    Range(\"A2\").Select\n    Selection.End(xlToRight).Select\n    Range(\"A2\").Select\n    Range(\"A2\", mylastcell_2).Select\n    Selection.FormulaArray = \"''\"\n    Range(\"A3\").Select\n    Range(\"A3\", mylastcell_3).Select\n    Selection.FormulaArray = \"'',\"\n    Range(\"A4\").Select\n    ActiveCell.FormulaR1C1 = \"=CONCATENATE(R[-2]C,R[-3]C,R[-1]C)\"\n    Range(\"A4\").Select\n   .Range(.Cells(4, \"A\"), .Cells(1, .Columns.Count).End(xlToLeft).Offset(3, 0)).Formula = \"=concatenate(a2, a1, a3)\"\n    Range(\"A5\").Select\n\nDo\n        myconcatenate = myconcatenate &amp; ActiveCell.Value\n        ActiveCell.Offset(0, 1).Select\n\n    Loop Until ActiveCell.Address = mylastcell_5\n\n    Range(\"A5\").Select\n    ActiveCell.Value = myconcatenate\n\n\n\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 21, "user_id": 9803297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969a991fea856aef66abd7e7d54083d3?s=128&d=identicon&r=PG&f=1", "display_name": "navneesi", "link": "https://stackoverflow.com/users/9803297/navneesi"}, "edited": false, "score": 0, "creation_date": 1540345382, "post_id": 52959989, "comment_id": 92826988, "body": "My VBA code looks something like this - <a href=\"http://www.rondebruin.nl/win/s1/outlook/bmail4.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s1/outlook/bmail4.htm</a>"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 3, "creation_date": 1540345453, "post_id": 52959989, "comment_id": 92827004, "body": "Those are <a href=\"https://blogs.msdn.microsoft.com/ericlippert/2004/04/28/when-are-you-required-to-set-objects-to-nothing/\" rel=\"nofollow noreferrer\">completely unnecessary</a>."}], "answers": [{"tags": [], "owner": {"reputation": 293, "user_id": 10025039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4c1e4aa063ea5bcc59fcb59286fb08?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Li", "link": "https://stackoverflow.com/users/10025039/simon-li"}, "is_accepted": true, "score": 1, "last_activity_date": 1540435885, "creation_date": 1540435885, "answer_id": 52980640, "question_id": 52959989, "link": "https://stackoverflow.com/questions/52959989/what-do-set-olmail-nothing-set-olapp-nothing-do-in-a-vba-code-to-send-emails/52980640#52980640", "title": "What do Set olMail = Nothing Set olApp = Nothing do in a VBA code to send emails via outlook from excel?", "body": "<p>Setting to Nothing isn't necessary(in modern Excel versions 2010+). but there were issues with older versions of Excel (for which the workaround was to explicitly set).</p>\n\n<p>It's just release an object and clear memory in VBA. For more information, you can refer the following link:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/19038350/when-should-an-excel-vba-variable-be-killed-or-set-to-nothing/19038890\">When should an Excel VBA variable be killed or set to Nothing?</a></p>\n"}], "owner": {"reputation": 21, "user_id": 9803297, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/969a991fea856aef66abd7e7d54083d3?s=128&d=identicon&r=PG&f=1", "display_name": "navneesi", "link": "https://stackoverflow.com/users/9803297/navneesi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 52980640, "answer_count": 1, "score": 1, "last_activity_date": 1592869822, "creation_date": 1540345257, "last_edit_date": 1592869822, "question_id": 52959989, "link": "https://stackoverflow.com/questions/52959989/what-do-set-olmail-nothing-set-olapp-nothing-do-in-a-vba-code-to-send-emails", "title": "What do Set olMail = Nothing Set olApp = Nothing do in a VBA code to send emails via outlook from excel?", "body": "<p>I am trying to edit an existing macro that sends out each row of a spreadsheet as an email. I want the macro to send out these emails in batches instead of all at once. \nI am using .<code>DeferredDeliveryTime</code> to do this.\nThe macro that I have has this at the end</p>\n\n<pre><code>Set olMail = Nothing\nSet olApp = Nothing \n</code></pre>\n\n<p>My question is if I remove this part will my deferred emails still be sent. I am afraid these lines will close outlook and the emails won't be sent.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1540352942, "post_id": 52959963, "comment_id": 92828405, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.shape.type\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.shape.type</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1540911271, "post_id": 52961084, "comment_id": 93032499, "body": "Good for you, glad to see someone following up and answering their own problems!"}], "tags": [], "owner": {"reputation": 528, "user_id": 3714936, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fac5e6e9ddad58381b45e34905c4c228?s=128&d=identicon&r=PG&f=1", "display_name": "youcantryreachingme", "link": "https://stackoverflow.com/users/3714936/youcantryreachingme"}, "is_accepted": true, "score": 1, "last_activity_date": 1540354907, "creation_date": 1540354907, "answer_id": 52961084, "question_id": 52959963, "link": "https://stackoverflow.com/questions/52959963/test-whether-shape-is-a-specific-shape-ie-button/52961084#52961084", "title": "Test whether shape is a specific shape ie button", "body": "<p>Marucciboy2's comment put me on the path to an answer.</p>\n\n<p>The code that works is:</p>\n\n<pre><code>If shp.Type &lt;&gt; 8 Then\n</code></pre>\n\n<p>In addition to the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.shape.type\" rel=\"nofollow noreferrer\">docs on the Shape Type property</a>, the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/office.msoshapetype\" rel=\"nofollow noreferrer\">docs on msoShapeType enumeration</a> map the type values (ie numbers) with descriptions of the shape types encountered. </p>\n\n<p>In this case, type 8 matches the button controls. </p>\n\n<p>As a bonus, the below will (crudely) aggregate the shape types encountered when looping through <code>ActiveSheet.Shapes</code>:</p>\n\n<pre><code>Dim sShapeTypes As String\n\nFor Each shp In ActiveSheet.Shapes\n    sShapeTypes = sShapeTypes &amp; \", \" &amp; shp.Type\nNext\n\nMsgBox sShapeTypes\n</code></pre>\n\n<p>If you have many shapes, the message box won't accommodate a long message. You can use an <code>If</code> statement to exclude some that you see appear in the message box.</p>\n\n<pre><code>If shp.Type &lt;&gt; 17 Then ' Ignores msoTextBox\n    sShapeTypes = sShapeTypes &amp; \", \" &amp; shp.Type\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 528, "user_id": 3714936, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fac5e6e9ddad58381b45e34905c4c228?s=128&d=identicon&r=PG&f=1", "display_name": "youcantryreachingme", "link": "https://stackoverflow.com/users/3714936/youcantryreachingme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 52961084, "answer_count": 1, "score": 0, "last_activity_date": 1586463528, "creation_date": 1540345085, "last_edit_date": 1586463528, "question_id": 52959963, "link": "https://stackoverflow.com/questions/52959963/test-whether-shape-is-a-specific-shape-ie-button", "title": "Test whether shape is a specific shape ie button", "body": "<p>I have a workbook with many shape objects. The shapes contain text. I'm using  <a href=\"https://excel.tips.net/T011281_Finding_Text_in_Text_Boxes.html\" rel=\"nofollow noreferrer\">a script</a> to emulate a text search. I've added two buttons - one for \"search\" (to run <code>FindInShape2</code>) and one to \"clear\" the formatting that was applied by the search (ie run <code>ResetFont</code>). (I've had to add <code>On Error Resume Next</code> just inside each loop). I have formatted the text on those buttons. My issue is that the \"clear\" script resets the formatting on the buttons.</p>\n\n<p>To resolve this I'm looking for a test that is logically \"if the current shape is not a button\".</p>\n\n<p>The local variable name for the shape object is <code>shp</code>. The key line populating this is:</p>\n\n<pre><code>For Each shp In ActiveSheet.Shapes\n</code></pre>\n\n<p>I need something like </p>\n\n<pre><code>if shp.name not like 'Button%'\n</code></pre>\n\n<p>Note, the display texts on the buttons are \"find\" and \"clear\" but when I select the buttons they are named \"Button 1\" and \"Button 2\".</p>\n\n<p>Any suggestions? Open to other methods of solving.</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1540343129, "post_id": 52959517, "comment_id": 92826584, "body": "Have you try recording your macro?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1540344381, "post_id": 52959517, "comment_id": 92826792, "body": "Assuming that you know the column layout of your own table, why don&#39;t you hard-code the offsets and use VBA to make the replacement? Structured listobject table addressing is a pain in VBA."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1540344466, "post_id": 52959885, "comment_id": 92826800, "body": "I don&#39;t this isn&#39;t going to help within a Worksheet_BeforeDoubleClick with Target."}], "tags": [], "owner": {"reputation": 21, "user_id": 8720549, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1F9ja.png?s=128&g=1", "display_name": "Dudesville Hurynnx", "link": "https://stackoverflow.com/users/8720549/dudesville-hurynnx"}, "is_accepted": false, "score": -1, "last_activity_date": 1540344380, "creation_date": 1540344380, "answer_id": 52959885, "question_id": 52959517, "link": "https://stackoverflow.com/questions/52959517/translate-formula-to-vba/52959885#52959885", "title": "Translate formula to VBA", "body": "<p>You can record it to create a vba code in your macro. Cut your formula first then click Record in Developer Tab, then paste the formula back. Stop the recording and click Visual Basic, in Module1,  you will see the generated code with a method name <code>Macro1</code>.</p>\n"}], "owner": {"reputation": 307, "user_id": 2319146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a1ef9c552251cdd0123d3c5fd21a71d6?s=128&d=identicon&r=PG", "display_name": "user2319146", "link": "https://stackoverflow.com/users/2319146/user2319146"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1541548456, "creation_date": 1540340890, "last_edit_date": 1541548456, "question_id": 52959517, "link": "https://stackoverflow.com/questions/52959517/translate-formula-to-vba", "title": "Translate formula to VBA", "body": "<p>I have translated this formula to VBA for use as a variable with the FollowHyperlink method:</p>\n\n<pre><code>=SUBSTITUTE(INDEX(Sites[Base], MATCH([@Site], Sites[Site], 0)), \"*\", [@Variable])\n</code></pre>\n\n<p>How can I refer to <code>Selection.Offset(0, -1)</code> by the column's name (in case the table structure changes)?</p>\n\n<pre><code>Dim sSite As String\nIf Not Intersect(Target, tb.ListColumns(\"Variable\").DataBodyRange) Is Nothing Then\n    Cancel = True\n    sSite = WorksheetFunction.Substitute(WorksheetFunction.Index(Range(\"Sites[[Base]]\") _\n    , WorksheetFunction.Match(Selection.Offset(0, -1), Range(\"Sites[[Site]]\"), 0)), \"*\", \"\" &amp; ActiveCell.Value &amp; \"\")\n    ThisWorkbook.FollowHyperlink (sSite)\nEnd If\n</code></pre>\n\n<p>Also, how can I deal with the case where there is no Site? This is not limited to the Variable column:</p>\n\n<pre><code>If Intersect(Target, tb.ListColumns(\"Variable\").DataBodyRange) &lt;&gt; \"\" And Selection.Offset(0, -1) &lt;&gt; \"\" Then\n</code></pre>\n"}, {"tags": ["vba", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1540336852, "post_id": 52958924, "comment_id": 92825317, "body": "There should be no problems using the same methods you&#39;d normally use - how exactly did you try, and what errors did you run into?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1540337430, "post_id": 52958924, "comment_id": 92825426, "body": "When I attempt to open your link, I get redirected to <code>&#47;DS&#47;DocumentSearch&#47;Error</code> - which is just an error page. This leads me to believe that your issue is that you&#39;ve set a reference to one IE object, and upon performing some action with that object another IE instance (popup) opens up which I presume to be the link you provided - and you are having troubles setting a reference to that new object? You cannot use the same IE reference if a new window opens up - but your question is difficult to follow, so correct me if I am wrong."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1540363604, "post_id": 52958924, "comment_id": 92831683, "body": "Are you open to a selenium basic vba answer?"}, {"owner": {"reputation": 11, "user_id": 7058719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c03f09d95e31bee94823fd77f62611?s=128&d=identicon&r=PG&f=1", "display_name": "Skeys", "link": "https://stackoverflow.com/users/7058719/skeys"}, "edited": false, "score": 0, "creation_date": 1540383884, "post_id": 52958924, "comment_id": 92844034, "body": "I haven&#39;t explored selenium yet.  Actually recently signed up for an online class that covers it(in part), but haven&#39;t had the time to go through it yet.  Is selenium a better way to scrape? or just a good adjunct to IE?  Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 0, "last_activity_date": 1540384071, "last_edit_date": 1540384071, "creation_date": 1540367896, "answer_id": 52963713, "question_id": 52958924, "link": "https://stackoverflow.com/questions/52958924/connect-to-data-after-having-found-an-already-open-ie-window-using-shell-applica/52963713#52963713", "title": "Connect to data after having found an already open IE window using shell application", "body": "<p>I haven't experienced a problem with this as although you have an intermediate window the final IE window resolves to being the main IE window with focus. I was able to grab the results table with the following code using the indicated search parameters:</p>\n\n<pre><code>Option Explicit\nPublic Sub GetInfo()\n    Dim IE As New InternetExplorer\n    With IE\n        .Visible = True\n        .navigate \"https://a836-acris.nyc.gov/DS/DocumentSearch/BBL\"\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        With .document\n            .querySelector(\"option[value='3']\").Selected = True\n            .querySelector(\"[name=edt_block]\").Value = 1\n            .querySelector(\"[name=edt_lot]\").Value = \"0000\"\n            .querySelector(\"[name=Submit2]\").Click\n        End With\n\n        While .Busy Or .readyState &lt; 4: DoEvents: Wend\n\n        Dim hTable As HTMLTable\n\n        Set hTable = .document.getElementsByTagName(\"table\")(6)\n\n        'do stuff with table\n\n        .Quit\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>You can copy a table via clipboard. Any tick windings appear in the right place but as empty icons.</p>\n\n<p>For clipboard early bound go VBE > Tools > References > Microsoft-Forms 2.0 Object Library.</p>\n\n<p>If you add a UserForm to your project, the library will get automatically added.</p>\n\n<pre><code>Dim clipboard As DataObject\nSet clipboard = New DataObject\nclipboard.SetText hTable.outerHTML\nclipboard.PutInClipboard\nThisWorkbook.Worksheets(\"Sheet1\").Cells(1, 1).PasteSpecial\n</code></pre>\n\n<p>Late bound use</p>\n\n<pre><code>Dim clipboard As Object\nSet clipboard =  GetObject(\"New:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 7058719, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7c03f09d95e31bee94823fd77f62611?s=128&d=identicon&r=PG&f=1", "display_name": "Skeys", "link": "https://stackoverflow.com/users/7058719/skeys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 52963713, "answer_count": 1, "score": 0, "last_activity_date": 1586463564, "creation_date": 1540335783, "last_edit_date": 1586463564, "question_id": 52958924, "link": "https://stackoverflow.com/questions/52958924/connect-to-data-after-having-found-an-already-open-ie-window-using-shell-applica", "title": "Connect to data after having found an already open IE window using shell application", "body": "<p><a href=\"https://stackoverflow.com/questions/21837844/vba-code-to-interact-with-specific-ie-window-that-is-already-open\">VBA code to interact with specific IE window that is already open</a></p>\n\n<p>Above is a thread to find and go to an already open instance of IE using shell applications in VBA.  AFTER I found the open IE instance I am looking for, I need to query the tables from that IE page without using it's URL.  The reason that I cannot use it's URL is that this IE page is a generic 'result' page that opens in a separate window after doing a search on the main website, so if I use the URL of the result page, which is:  <a href=\"https://a836-acris.nyc.gov/DS/DocumentSearch/BBLResult\" rel=\"nofollow noreferrer\">https://a836-acris.nyc.gov/DS/DocumentSearch/BBLResult</a>, it will return an error.  Are there any other methods that allow querying tables without using URL connections, like a \"getElements\" for tables?  </p>\n\n<p>K.Davis, Tim William: you are correct in your assumptions.  The first part of my code/project opens up a search page:  objIE.navigate \"<a href=\"https://a836-acris.nyc.gov/DS/DocumentSearch/BBL\" rel=\"nofollow noreferrer\">https://a836-acris.nyc.gov/DS/DocumentSearch/BBL</a>\" and through it I submit a search form.  The second part (outlined above in the first paragraph) opens up a result page (pop-up). I am trying to automate the retrieving of the tables from that page.  I tried using QueryTables.Add method, the way I am familiar with to connect to the data/webpage requires an URL.  If I use the URL from the result page it returns an error, thus I am looking for suggestions/help on how I could otherwise connect.  That said I am able to retrieve elements of the page using 'getElements' method but not able to query tables. There are other ways to connect to the data source using the QueryTables.Add method, see, <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.querytables.add\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.querytables.add</a>  but I am not familiar with these other methods. Hope this clarifies a bit.</p>\n"}, {"tags": ["excel", "vba", "duplicates"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10525626, "user_type": "registered", "profile_image": "https://graph.facebook.com/1944110822292533/picture?type=large", "display_name": "Garrett Rincon", "link": "https://stackoverflow.com/users/10525626/garrett-rincon"}, "edited": false, "score": 0, "creation_date": 1540398823, "post_id": 52959066, "comment_id": 92854320, "body": "I&#39;m pretty new to the whole scripting thing, I haven&#39;t touched SQL so this is definitely outside of what I know how to do. I tried plugging it into my excel VBA however it returned most the information as <code>######</code>. The data I have isn&#39;t contained in a table, does it need to be for your script to work?"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "reply_to_user": {"reputation": 3, "user_id": 10525626, "user_type": "registered", "profile_image": "https://graph.facebook.com/1944110822292533/picture?type=large", "display_name": "Garrett Rincon", "link": "https://stackoverflow.com/users/10525626/garrett-rincon"}, "edited": false, "score": 0, "creation_date": 1540405427, "post_id": 52959066, "comment_id": 92857883, "body": "FROM [filteredData$]  gets the data from your sheet (suffixed by the dollar sign).  Your sheet should have column names in row 1, and the data should be in columns A, B, C, with PhoneNum being in column B. Tracing what is the problem may take a few iterations.  Scripting and VBA were new to you, and you began those ok; SQL makes some of that logic easier.  Please verify the worksheet contents and tell me more"}, {"owner": {"reputation": 3, "user_id": 10525626, "user_type": "registered", "profile_image": "https://graph.facebook.com/1944110822292533/picture?type=large", "display_name": "Garrett Rincon", "link": "https://stackoverflow.com/users/10525626/garrett-rincon"}, "edited": false, "score": 0, "creation_date": 1540414988, "post_id": 52959066, "comment_id": 92862272, "body": "I originally wasn&#39;t making the row 1 &quot;Name&quot; case sensitive, not the information is available, however it skips adding names to column A. It puts the phone numbers into column A, and the emails into column B."}, {"owner": {"reputation": 3, "user_id": 10525626, "user_type": "registered", "profile_image": "https://graph.facebook.com/1944110822292533/picture?type=large", "display_name": "Garrett Rincon", "link": "https://stackoverflow.com/users/10525626/garrett-rincon"}, "edited": false, "score": 0, "creation_date": 1540415210, "post_id": 52959066, "comment_id": 92862359, "body": "Found the issue, this line of code <code>Cells(nRow, &quot;A&quot;) = rs.Fields(1): </code> needed to start at <code>rs.Fields(0)</code>. Now it&#39;s doing exactly what I wanted. I also wanted to be able to search for other criteria such as duplicate emails. Will it let me swap out <code>PhoneNum</code> to <code>EMail</code> when creating/opening the SQL to search for EMail duplicates?"}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "reply_to_user": {"reputation": 3, "user_id": 10525626, "user_type": "registered", "profile_image": "https://graph.facebook.com/1944110822292533/picture?type=large", "display_name": "Garrett Rincon", "link": "https://stackoverflow.com/users/10525626/garrett-rincon"}, "edited": false, "score": 0, "creation_date": 1540415403, "post_id": 52959066, "comment_id": 92862429, "body": "Clone the SQL to become strSQL2, make changes to that, and then rs.Open strSQL2, cn   Try it, and learn."}, {"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "reply_to_user": {"reputation": 3, "user_id": 10525626, "user_type": "registered", "profile_image": "https://graph.facebook.com/1944110822292533/picture?type=large", "display_name": "Garrett Rincon", "link": "https://stackoverflow.com/users/10525626/garrett-rincon"}, "edited": false, "score": 0, "creation_date": 1540501969, "post_id": 52959066, "comment_id": 92901076, "body": "Since this is a solution, click on the CheckMark near the top.   Did it work for EMail?"}], "tags": [], "owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "is_accepted": false, "score": 0, "last_activity_date": 1540415297, "last_edit_date": 1540415297, "creation_date": 1540337047, "answer_id": 52959066, "question_id": 52958566, "link": "https://stackoverflow.com/questions/52958566/excel-vba-finding-duplicates-posting-matching-rows-and-search-value/52959066#52959066", "title": "Excel VBA finding duplicates, posting matching rows and search value", "body": "<p>I would avoid loops like the above, but rather use SQL</p>\n\n<pre><code>Option Explicit\n\nSub SQL()\n    ' from https://stackoverflow.com/questions/19755396/performing-sql-queries-on-an-excel-table-within-a-workbook-with-vba-macro\n    ' by Joan-Diego Rodriguez\n\n    ' get where we are and setup strings\n    Dim strFile As String, strCon As String\n    strFile = ThisWorkbook.FullName\n    strCon = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; strFile _\n        &amp; \";Extended Properties=\"\"Excel 12.0;HDR=Yes;IMEX=1\"\";\"\n\n    ' set up for ADO\n    Dim cn As ADODB.Connection, rs As ADODB.Recordset, strSQL As String\n    Set cn = CreateObject(\"ADODB.Connection\")\n    Set rs = CreateObject(\"ADODB.Recordset\")\n    cn.Open strCon\n\n    ' create SQL and open it\n    strSQL = \"\"\n    strSQL = strSQL &amp; \"SELECT * FROM [filteredData$] \"\n    strSQL = strSQL &amp; \"  Where PhoneNum In \"\n    strSQL = strSQL &amp; \"    (Select PhoneNum FROM [filteredData$] \"\n    strSQL = strSQL &amp; \"      Group By PhoneNum \"\n    strSQL = strSQL &amp; \"      Having Count(*) &gt; 1\"\n    strSQL = strSQL &amp; \"     )\"\n    strSQL = strSQL &amp; \"   \"   ' maybe have an order by here\n\n    rs.Open strSQL, cn\n    'Debug.Print rs.Name, rs.PhoneNum\n\n    Dim nRow As Long\n    nRow = 1\n    Worksheets(\"phoneFlags\").Activate\n    Cells(nRow, \"A\") = \"Name\": Cells(nRow, \"B\") = \"PhoneNum\": Cells(nRow, \"C\") = \"EMail\"\n    Do While Not rs.EOF\n        nRow = nRow + 1\n            Cells(nRow, \"A\") = rs.Fields(0): Cells(nRow, \"B\") = rs.Fields(1): Cells(nRow, \"C\") = rs.Fields(2)\n        rs.movenext\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>While in View/Macros, on your top menu bar, where it sez File Edit View ...</p>\n\n<p>Press TOOLS and then Press References</p>\n\n<p>Scroll down to Microsoft ActiveX Data Objects, and select the last one with a check mark</p>\n\n<p>...\nChange this row which has new subscripts to (0) (1) (2)</p>\n\n<p>Cells(nRow, \"A\") = rs.Fields(0): Cells(nRow, \"B\") = rs.Fields(1): Cells(nRow, \"C\") = rs.Fields(2)</p>\n"}, {"tags": [], "owner": {"reputation": 892, "user_id": 10503508, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q1Afy.jpg?s=128&g=1", "display_name": "Ferdinando", "link": "https://stackoverflow.com/users/10503508/ferdinando"}, "is_accepted": false, "score": 0, "last_activity_date": 1541368996, "creation_date": 1541368996, "answer_id": 53145959, "question_id": 52958566, "link": "https://stackoverflow.com/questions/52958566/excel-vba-finding-duplicates-posting-matching-rows-and-search-value/53145959#53145959", "title": "Excel VBA finding duplicates, posting matching rows and search value", "body": "<p>if i understood your question i have an alternative code:</p>\n\n<pre><code>Sub test()\n'control duplicate phone number. Execute macro in sheet1(active)\n\nDim rows, j, i, c, k As Integer\nDim swap As Variant\n\n'in sheet where are all the data count number rows\nrows = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A:A\").Cells.SpecialCells(xlCellTypeConstants).Count\n\nc = 1 ' count rows number of the second sheet\nFor j = 1 To rows\n    swap = Cells(j, 2) 'control the phone number\n    For i = 1 To rows\n\n        If (Cells(i, 2) = swap And i &lt;&gt; j) Then ' if find duplicate copy data into 2\u00b0 sheet\n\n            With Sheets(\"Sheet2\")\n                .Cells(c, 1) = Cells(j, 1) 'copy name\n                .Cells(c, 2) = Cells(j, 2) 'copy phone number\n                .Cells(c, 3) = Cells(j, 3) ' copy mail\n                c = c + 1 'increment row of the second sheet\n                i = rows \n            End With\n        End If\n    Next i\nNext j\nEnd Sub\n</code></pre>\n\n<p>i tried code and works fine.</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 3, "user_id": 10525626, "user_type": "registered", "profile_image": "https://graph.facebook.com/1944110822292533/picture?type=large", "display_name": "Garrett Rincon", "link": "https://stackoverflow.com/users/10525626/garrett-rincon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 903, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1541368996, "creation_date": 1540332968, "last_edit_date": 1540361982, "question_id": 52958566, "link": "https://stackoverflow.com/questions/52958566/excel-vba-finding-duplicates-posting-matching-rows-and-search-value", "title": "Excel VBA finding duplicates, posting matching rows and search value", "body": "<p>I am working with a list of customer info searching for duplicates then pasting the entire row to a different sheet. My current code will find duplicates and paste them, however it will not paste the row being used for the search criteria.</p>\n\n<p><a href=\"https://i.stack.imgur.com/udt39.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/udt39.png\" alt=\"Example\"></a></p>\n\n<p>When I run my code it will copy row 3 to a different page, However I need it to also copy over row 1, to be able to see all \"names\" listed under the same \"phone\" not only the duplicate.</p>\n\n<p>Here is my current code:</p>\n\n<pre><code>Option Explicit\nDim output As Worksheet\nDim data As Worksheet\nDim hold As Object\nDim celli\nDim nextRow\n\nSub main()\n    Set output = Worksheets(\"phoneFlags\")\n    Set data = Worksheets(\"filteredData\")\n    Set hold = CreateObject(\"Scripting.Dictionary\")\n\n    For Each celli In data.Columns(3).Cells\n        If Not hold.Exists(CStr(celli.Value)) Then\n            If Not IsEmpty(celli.Value) Then\n                hold.Add Key:=\"\" &amp; celli.Value, Item:=celli.Row\n            End If\n        ElseIf hold.Exists(CStr(celli.Value)) Then\n            'Copies row to sheet\n            data.Rows(celli.Row).Copy (output.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0))\n        End If\n    Next celli\nEnd Sub\n</code></pre>\n\n<p>I've tried making a second <code>For Each</code> loop, but it returns the same result.</p>\n\n<pre><code>        ElseIf hold.Exists(CStr(celli.Value)) Then\n        match = celli.Value\n            For Each match In data.Columns(3).Cells\n                data.Rows(celli.Row).Copy (output.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0))\n            Next match\n        End If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8910551, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210380606736311/picture?type=large", "display_name": "Sobia Bhatti", "link": "https://stackoverflow.com/users/8910551/sobia-bhatti"}, "edited": false, "score": 0, "creation_date": 1540474782, "post_id": 52958781, "comment_id": 92886614, "body": "I do not want to append to text in a cell. I want to append an entire column of unknown length from sheet 2 to the end of an existing column in sheet 3."}, {"owner": {"reputation": 1857, "user_id": 2824961, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/xMjHa.png?s=128&g=1", "display_name": "C1pher", "link": "https://stackoverflow.com/users/2824961/c1pher"}, "reply_to_user": {"reputation": 1, "user_id": 8910551, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210380606736311/picture?type=large", "display_name": "Sobia Bhatti", "link": "https://stackoverflow.com/users/8910551/sobia-bhatti"}, "edited": false, "score": 0, "creation_date": 1540490424, "post_id": 52958781, "comment_id": 92895894, "body": "@SobiaBhatti It appears you are going row by row in your loop.  Wouldn&#39;t the loop append the entire column one cell at a time?"}, {"owner": {"reputation": 1, "user_id": 8910551, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210380606736311/picture?type=large", "display_name": "Sobia Bhatti", "link": "https://stackoverflow.com/users/8910551/sobia-bhatti"}, "edited": false, "score": 0, "creation_date": 1540498311, "post_id": 52958781, "comment_id": 92899583, "body": "That&#39;s the problem, it is going row by row and instead of appending it is replacing. @FarzamMoshtagh"}], "tags": [], "owner": {"reputation": 1857, "user_id": 2824961, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/xMjHa.png?s=128&g=1", "display_name": "C1pher", "link": "https://stackoverflow.com/users/2824961/c1pher"}, "is_accepted": false, "score": 0, "last_activity_date": 1540334580, "creation_date": 1540334580, "answer_id": 52958781, "question_id": 52958543, "link": "https://stackoverflow.com/questions/52958543/vba-append-column-to-other-sheet-column/52958781#52958781", "title": "VBA- append column to other sheet column", "body": "<p>Instead of setting a paste destination, you can append to the existing text in the cell.  Something like this:</p>\n\n<pre><code>Sheet3.Cells(erow, 3) = Sheet3.Cells(erow, 3) + Sheet2.Cells(i, 1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8910551, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210380606736311/picture?type=large", "display_name": "Sobia Bhatti", "link": "https://stackoverflow.com/users/8910551/sobia-bhatti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 127, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586463599, "creation_date": 1540332839, "last_edit_date": 1586463599, "question_id": 52958543, "link": "https://stackoverflow.com/questions/52958543/vba-append-column-to-other-sheet-column", "title": "VBA- append column to other sheet column", "body": "<p>I am consolidating two sheets into one and choosing select columns to do so. The sheets are schedules for employee shifts. I have copied the first sheets(1) columns to the new sheets(3) :Date, Day of week, Time, Show Covering, Employee. I am trying to now copy the needed columns from sheets(2) to sheets(3). One of them is shift time. I need this to be added to the existing column of time which is column 3. Currently it is replacing that data. Here is what I have:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim lastrow As Long, erow As Long\n\nlastrow = Sheet1.Cells(Rows.Count, 1).End(xlUp).Row\nFor i = 1 To lastrow\nSheet1.Cells(i, 1).Copy\nerow = Sheet3.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\nSheet1.Paste Destination:=Sheets(3).Cells(erow, 1)\nSheet1.Cells(i, 2).Copy\nSheet1.Paste Destination:=Sheets(3).Cells(erow, 2)\nSheet1.Cells(i, 3).Copy\nSheet1.Paste Destination:=Sheets(3).Cells(erow, 3)\nSheet1.Cells(i, 5).Copy\nSheet1.Paste Destination:=Sheets(3).Cells(erow, 4)\nSheet1.Cells(i, 8).Copy\nSheet1.Paste Destination:=Sheets(3).Cells(erow, 5)\nSheet2.Cells(i, 1).Copy\nSheet2.Paste Destination:=Sheets(3).Cells(erow, 3)\n\nNext i\n\nApplication.CutCopyMode = False\nSheet3.Columns.AutoFit\nRange(\"A1\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "database", "vba", "duplicates"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 10525765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6a2d281cdadba77c69afe23ce66134?s=128&d=identicon&r=PG&f=1", "display_name": "Sam S.", "link": "https://stackoverflow.com/users/10525765/sam-s"}, "edited": false, "score": 0, "creation_date": 1540510177, "post_id": 52959013, "comment_id": 92903491, "body": "First off, thanks so much for your help!  How do I customize this code to a specific file (One that has different columns than the one I gave in the example)"}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 1, "last_activity_date": 1540336497, "creation_date": 1540336497, "answer_id": 52959013, "question_id": 52958093, "link": "https://stackoverflow.com/questions/52958093/excel-vba-deleting-duplicate-rows-and-merging-cells-with-unique-data/52959013#52959013", "title": "Excel VBA: Deleting duplicate rows and merging cells with unique data", "body": "<p>you can use something like this:</p>\n\n<pre><code>Sub test()\n    Dim Dic As Object: Set Dic = CreateObject(\"Scripting.Dictionary\")\n    Dic.comparemode = vbTextCompare\n\n    Dim rng As Range: Set rng = Range([A1], Cells(Rows.Count, \"A\").End(xlUp))\n    Dim cl As Range, sPhone$, sCell$, sEmail$, sAddress$\n\n    For Each cl In rng\n\n        sPhone = Cells(cl.Row, \"B\").Value2\n        sCell = Cells(cl.Row, \"C\").Value2\n        sEmail = Cells(cl.Row, \"D\").Value2\n        sAddress = Cells(cl.Row, \"E\").Value2\n\n        If Not Dic.exists(cl.Value2) Then\n            Dic.Add cl.Value2, sPhone &amp; \"|\" &amp; sCell &amp; \"|\" &amp; sEmail &amp; \"|\" &amp; sAddress\n        Else\n            If Not (Split(Dic(cl.Value2), \"|\")(0) Like \"*\" &amp; sPhone &amp; \"*\") And sPhone &lt;&gt; \"\" Then\n                Dic(cl.Value2) = sPhone &amp; \", \" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(0) &amp; \"|\" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(1) &amp; \"|\" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(2) &amp; \"|\" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(3)\n            End If\n            If Not Split(Dic(cl.Value2), \"|\")(1) Like \"*\" &amp; sCell &amp; \"*\" And sCell &lt;&gt; \"\" Then\n                Dic(cl.Value2) = Split(Dic(cl.Value2), \"|\")(0) &amp; \"|\" &amp; _\n                                 sCell &amp; \", \" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(1) &amp; \"|\" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(2) &amp; \"|\" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(3)\n\n            End If\n            If Not Split(Dic(cl.Value2), \"|\")(2) Like \"*\" &amp; sEmail &amp; \"*\" And sEmail &lt;&gt; \"\" Then\n                Dic(cl.Value2) = Split(Dic(cl.Value2), \"|\")(0) &amp; \"|\" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(1) &amp; \"|\" &amp; _\n                                 sEmail &amp; \",\" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(2) &amp; \"|\" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(3)\n\n            End If\n            If Not Split(Dic(cl.Value2), \"|\")(3) Like \"*\" &amp; sAddress &amp; \"*\" And sAddress &lt;&gt; \"\" Then\n                Dic(cl.Value2) = Split(Dic(cl.Value2), \"|\")(0) &amp; \"|\" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(1) &amp; \"|\" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(2) &amp; \"|\" &amp; _\n                                 sAddress &amp; \",\" &amp; _\n                                 Split(Dic(cl.Value2), \"|\")(3)\n\n            End If\n        End If\n    Next cl\n\n    Dim key, i&amp;, ws As Worksheet\n    Set ws = Worksheets.Add: ws.Name = \"Result \" &amp; Replace(Now, \":\", \"-\")\n    With ws\n        i = 1\n        For Each key In Dic\n            .Cells(i, \"A\").Value2 = key\n            .Cells(i, \"B\").Value2 = Split(Dic(key), \"|\")(0)\n            .Cells(i, \"C\").Value2 = Split(Dic(key), \"|\")(1)\n            .Cells(i, \"D\").Value2 = Split(Dic(key), \"|\")(2)\n            .Cells(i, \"E\").Value2 = Split(Dic(key), \"|\")(3)\n            i = i + 1\n        Next key\n        ws.Columns(\"A:E\").AutoFit\n    End With\nEnd Sub\n</code></pre>\n\n<p><strong>test:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/olgM8.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/olgM8.gif\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 10525765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a6a2d281cdadba77c69afe23ce66134?s=128&d=identicon&r=PG&f=1", "display_name": "Sam S.", "link": "https://stackoverflow.com/users/10525765/sam-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1540336497, "creation_date": 1540330099, "last_edit_date": 1540334887, "question_id": 52958093, "link": "https://stackoverflow.com/questions/52958093/excel-vba-deleting-duplicate-rows-and-merging-cells-with-unique-data", "title": "Excel VBA: Deleting duplicate rows and merging cells with unique data", "body": "<p>I have a file that contains contact info. There's 44 columns and 680 rows. Each row contains one person's data and each column is a different piece of data as well. The problem is that there are multiple rows for most of the people and many times each row contains redundant info as well as unique.</p>\n\n<p><strong>Note:</strong></p>\n\n<ol>\n<li>There's no pattern to how many rows for each person, some can have\n3, some only 1</li>\n<li>Sometimes there are no unique values in one of the rows</li>\n<li>Sometimes a cell might just be blank</li>\n</ol>\n\n<hr>\n\n<h2>My Question:</h2>\n\n<p>How can I merge the rows so that I have one row per person without losing the unique data from each row?</p>\n\n<p>What I have:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CLY1a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CLY1a.png\" alt=\"enter image description here\"></a></p>\n\n<p>What I need:</p>\n\n<p><a href=\"https://i.stack.imgur.com/mqi1i.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mqi1i.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>P.S. In the \"what I need\" image I put the merged unique data into the same cell but separated by a comma. To be honest it would be nice if I can automatically have it that a new column is created for the unique data (so for example if there's a new cell # it adds a column and puts the unique cell value in the row that will now be the only row for that person.</p>\n\n<p>If that's too hard it's fine, I can just do text to column.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1540325717, "post_id": 52957070, "comment_id": 92821876, "body": "<code>WorksheetFunction.Month(Now, -1)</code> is the problem"}], "answers": [{"comments": [{"owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "edited": false, "score": 0, "creation_date": 1540326532, "post_id": 52957221, "comment_id": 92822237, "body": "Thank you, I learned something today...to use <code>Dateadd()</code>. Your codes just needs slightly changed since 09 September is the folder name, but I was able to get it to work, just take out second <code>Application.PathSeparator</code>."}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 3, "last_activity_date": 1540325784, "creation_date": 1540325784, "answer_id": 52957221, "question_id": 52957070, "link": "https://stackoverflow.com/questions/52957070/worksheetfunction-month-error-with-object-doesnt-support-property-or-method/52957221#52957221", "title": "WorksheetFunction.Month error with object doesn&#39;t support property or method", "body": "<p>You are not able to use <code>WorksheetFunction.Month</code> - it doesn't exist.</p>\n\n<p>Since you are trying to subtract a month, you can use the <code>DateAdd()</code> function instead.</p>\n\n<pre><code>Dim Path As String\nPath = \"S:\\Main\\\" &amp; Format(Now(), \"YYYY\") &amp; Application.PathSeparator &amp; _\n    Format(DateAdd(\"m\", -1, Date), \"00 \") &amp; Application.PathSeparator &amp; _\n    Format(DateAdd(\"m\", -1, Date), \"MMMM\") &amp; Application.PathSeparator &amp; _\n    \"PIF_\" &amp; Format(WorksheetFunction.EoMonth(Now, -1), \"M.D.YYYY\") &amp; \".xlsx\"\n</code></pre>\n"}], "owner": {"reputation": 580, "user_id": 1046884, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4397c31a66aaf33dd73431227519ac47?s=128&d=identicon&r=PG", "display_name": "sc1324", "link": "https://stackoverflow.com/users/1046884/sc1324"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "accepted_answer_id": 52957221, "answer_count": 1, "score": 3, "last_activity_date": 1545486112, "creation_date": 1540325114, "last_edit_date": 1545486112, "question_id": 52957070, "link": "https://stackoverflow.com/questions/52957070/worksheetfunction-month-error-with-object-doesnt-support-property-or-method", "title": "WorksheetFunction.Month error with object doesn&#39;t support property or method", "body": "<p>I am trying to save a file into folder &amp; sub folder that has dynamic names.</p>\n\n<p>Structure of my folder &amp; sub folder is</p>\n\n<blockquote>\n  <p>Shared Drive -> Main -> Year (i.e. 2018) -> Month (i.e. 09 September).</p>\n</blockquote>\n\n<p>I wish to save in last month's folder since data comes from last month. I want to save the file name as PIF_09.30.2018 so using end of last month's dates.</p>\n\n<p>I am getting an error</p>\n\n<blockquote>\n  <p>object doesn't support this property or method.</p>\n</blockquote>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Save_wkb()\nDim Path As String\nActiveWorkbook.SaveAs \"S:\\Main\\\" &amp; Format(Now(), \"YYYY\") &amp; _\n     Application.PathSeparator &amp; Format(WorksheetFunction.Month(Now, -1), \"MM \") &amp; _\n   Format(WorksheetFunction.Month(Now, -1), \"MMMM\") &amp; _\n   Application.PathSeparator &amp; \"PIF_\" &amp; _\n   Format(WorksheetFunction.EoMonth(Now, -1), \"MM.D.YYYY\") &amp; \".xlsx\", _\n   FileFormat:=51\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1540328140, "post_id": 52956926, "comment_id": 92822843, "body": "You probably don&#39;t need a scripting solution for this, which means it&#39;s likely this question would be better asked on <a href=\"https://superuser.com\">Superuser</a>. Letting people know what kind of chart it is would also be useful"}], "answers": [{"comments": [{"owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "edited": false, "score": 1, "creation_date": 1540394407, "post_id": 52958627, "comment_id": 92851579, "body": "Wow that is a neat trick, unfortunately, my company is using an excel build which predates this feature and thus I don&#39;t have the &quot;show #n/a as an empty cell not available&quot; feature. I do have the treat cells empty cells as null ability, but apparently does not consider a cell containing a formula to be blank. Any work arounds for this? I like the hide ability as well although I will most likely need to build a short macro that hides rows when the data=&quot;&quot; in the cell."}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "edited": false, "score": 0, "creation_date": 1540394720, "post_id": 52958627, "comment_id": 92851787, "body": "That&#39;s sad :(, then I can only think about filtering or hiding rows. I wrote a piece of code earlier today which you can likewise use or have as an starting point :) It checks for cells that are empty (&quot;&quot;) in the range <code>B3:B27</code> and hides if that condition is true. Take care! :)"}, {"owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "reply_to_user": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "edited": false, "score": 0, "creation_date": 1540394764, "post_id": 52958627, "comment_id": 92851810, "body": "<code>Sub HideRowsInRange()  Dim c As Range  For Each c In Range(&quot;B3:B27&quot;) &#39;Define your range which should look for &quot;&quot;, then loop through that range.     If c.Value = &quot;&quot; Then Rows(c.Row).Hidden = True &#39;If my range has &quot;&quot; then it will hide the row.     Next c  End Sub</code>"}], "tags": [], "owner": {"reputation": 5038, "user_id": 4552529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e7dff9245051269e55748c81670088e8?s=128&d=identicon&r=PG&f=1", "display_name": "Wizhi", "link": "https://stackoverflow.com/users/4552529/wizhi"}, "is_accepted": true, "score": 1, "last_activity_date": 1540333738, "last_edit_date": 1540333738, "creation_date": 1540333380, "answer_id": 52958627, "question_id": 52956926, "link": "https://stackoverflow.com/questions/52956926/a-variable-chart-axis-depending-on-if-data-is-present-in-the-corresponding-cell/52958627#52958627", "title": "A variable chart axis depending on if data is present in the corresponding cell", "body": "<p>There is a simple trick in excel to hide values in charts (not all charts but quite a few). If you use #N/A the chart can ignore these values (see my table 1). It creates \"gaps\" where the #N/A is located as default. But you could choose to treat #N/A's as \"gap\", \"0\" or \"fill gap by connect lines\".</p>\n\n<p>If the cell is hidden (column or row is hidden) or <strong>filtered out</strong>... which I did on my second table, excel ignores these values. So for my second table I only filter values, while excluding all #N/A. I would treat those 0% as #N/A for graphical purpose (dummy column...)</p>\n\n<p><a href=\"https://i.stack.imgur.com/hlkDf.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hlkDf.png\" alt=\"enter image description here\"></a></p>\n\n<p>Some extended reading can also be found here: \n<a href=\"https://support.office.com/en-us/article/display-empty-cells-null-n-a-values-and-hidden-worksheet-data-in-a-chart-a1ee6f0c-192f-4248-abeb-9ca49cb92274\" rel=\"nofollow noreferrer\">Display empty cells, null (#N/A) values, and hidden worksheet data in a chart</a></p>\n"}], "owner": {"reputation": 343, "user_id": 9626171, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9587856742de2015aec848c7749c4b15?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan", "link": "https://stackoverflow.com/users/9626171/jordan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 52958627, "answer_count": 1, "score": -1, "last_activity_date": 1586463635, "creation_date": 1540324607, "last_edit_date": 1586463635, "question_id": 52956926, "link": "https://stackoverflow.com/questions/52956926/a-variable-chart-axis-depending-on-if-data-is-present-in-the-corresponding-cell", "title": "A variable chart axis depending on if data is present in the corresponding cell", "body": "<p>I have a chart which contains Output in percent on the y axis and days of the week on the x axis. Some days, there may be no output if production is not running that day (some weekends but not all). This causes a dip in the chart as it jumps from some output value (lets say 90%) to 0% on a day when there was not production. When there was not production, I do not want the data to be recorded in the chart.</p>\n\n<p>Is there a way through chart setup, cell formulas, or vba to format the chart axis to use only the days that contain output data?</p>\n"}, {"tags": ["excel", "vba", "file", "collections"], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1540325085, "creation_date": 1540325085, "answer_id": 52957061, "question_id": 52956916, "link": "https://stackoverflow.com/questions/52956916/vba-collection-retrieves-data-but-does-not-show-values/52957061#52957061", "title": "VBA Collection retrieves data but does not show values", "body": "<p>Replace:</p>\n\n<pre><code> ActiveSheet.Cells(ERow + i, 1).Value = coll(i)\n</code></pre>\n\n<p>with:</p>\n\n<pre><code> ActiveSheet.Cells(ERow + i, 1).Value = coll.Item(i)\n</code></pre>\n\n<p><em>(there may be other issues)</em></p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 10548304, "user_type": "registered", "profile_image": "https://graph.facebook.com/724878561223727/picture?type=large", "display_name": "Alejandro Garza", "link": "https://stackoverflow.com/users/10548304/alejandro-garza"}, "edited": false, "score": 0, "creation_date": 1540468161, "post_id": 52962720, "comment_id": 92882192, "body": "Thank you!, yes, adding &quot;.value&quot; was part of the solution.  I will take the advice on the loop!"}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1540380961, "last_edit_date": 1540380961, "creation_date": 1540364345, "answer_id": 52962720, "question_id": 52956916, "link": "https://stackoverflow.com/questions/52956916/vba-collection-retrieves-data-but-does-not-show-values/52962720#52962720", "title": "VBA Collection retrieves data but does not show values", "body": "<p>Kindly change <code>coll.Add Cells(iRow, 1)</code> to <code>coll.Add Cells(iRow, 1).Value</code> and it will start working.</p>\n\n<p>further it is better to give some wild card in 1st dir statement like '<code>Path = Dir(ActiveWorkbook.Path &amp; \"\\*.xlsx\")</code>'</p>\n\n<p>Also <code>Do While Path &lt;&gt; DataBase</code> may cause to terminate the loop once Database is encountered. It is be better to do this like</p>\n\n<pre><code>   Do While Path &lt;&gt; \"\"\n        If Path &lt;&gt; DataBase Then\n        '''''''''''''''  \n        '''''''''''''' \n        End If\n    Path = Dir\n    Loop\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 10548304, "user_type": "registered", "profile_image": "https://graph.facebook.com/724878561223727/picture?type=large", "display_name": "Alejandro Garza", "link": "https://stackoverflow.com/users/10548304/alejandro-garza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1586756033, "creation_date": 1540324556, "last_edit_date": 1586756033, "question_id": 52956916, "link": "https://stackoverflow.com/questions/52956916/vba-collection-retrieves-data-but-does-not-show-values", "title": "VBA Collection retrieves data but does not show values", "body": "<p>My question is about Collections.</p>\n\n<p>In this code, I open each other excel within the folder of my current excel and retrieve all its data for the first column into a Collection.</p>\n\n<p>Then, I try to insert the collected values in my current file.</p>\n\n<p>When I use coll.count, the count is the correct one, so I believe the data is efectively being collected.</p>\n\n<p>I have used the form of 'Sheet.cells.value=coll(i)' before and has worked perfectly, but in this case it doesn't. </p>\n\n<p>An Error 1004 appears - 'Run time error '1004': Application-defined or object-defined error' in that line.</p>\n\n<p>Would you have any ideas as to why?\nAny recommendation?</p>\n\n<p>Thank you!</p>\n\n<pre><code>Option Explicit\nSub LoopThroughFolder()\nApplication.ScreenUpdating = False\n\n'State variables\nDim Path As String          'path of folder\nDim DataBase As String      ' current excel file\nDim ERow As Long            'last row of current excel file\nDim coll As New Collection  'collection of data\nDim iRow As Long            'rows of other excel files\nDim n As Long               'total records of other excel files\nDim i As Integer\n\n\n'Name of files to open\nPath = Dir(ActiveWorkbook.Path &amp; \"\\\")\nDataBase = ActiveWorkbook.Name\n\n'For each file\nDo While Path &lt;&gt; DataBase\n\n        'Open, retrieve data, close\n        Workbooks.Open (ActiveWorkbook.Path &amp; \"\\\" &amp; Path)\n        n = Application.WorksheetFunction.CountA(Range(\"A:A\"))\n            For iRow = 2 To n\n            coll.Add Cells(iRow, 1)\n            Next iRow\n        ActiveWorkbook.Close\n\n    'Next file\n    Path = Dir\n    Loop\n\n'Now place the values in my current excel file (here is the problem)(?)\nERow = ActiveSheet.Cells(Rows.Count, \"A\").End(xlUp).Row\n    For i = 1 To coll.Count\n    ActiveSheet.Cells(ERow + i, 1).Value = coll(i)\n    Next i\n\n'End\nSet coll = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1540325056, "post_id": 52956849, "comment_id": 92821552, "body": "That code should go in the <code>ThisWorkbook</code> code module, not a worksheet module."}, {"owner": {"reputation": 11, "user_id": 9903837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KRqP81ONchk/AAAAAAAAAAI/AAAAAAAAAJE/3P1_A97zfMk/photo.jpg?sz=128", "display_name": "Chris Mishler", "link": "https://stackoverflow.com/users/9903837/chris-mishler"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1540329015, "post_id": 52956849, "comment_id": 92823159, "body": "So true, I forgot to mention that the Workbook_Open code was moved into that module. Here&#39;s the revised code:  With      ThisWorkbook.VBProject.VBComponents(&quot;ThisWorkbook&quot;).CodeModu&zwnj;&#8203;le                What is a bother is that if I turn off events at the end of my &quot;convert to values&quot; procedure, the auto open event handler is ineffective in enabling events."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1540329719, "post_id": 52956849, "comment_id": 92823371, "body": "Typically you&#39;d manage this by including error handling in any procedure where you turn off events, to ensure your code won&#39;t crash and leave events turned off."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9903837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KRqP81ONchk/AAAAAAAAAAI/AAAAAAAAAJE/3P1_A97zfMk/photo.jpg?sz=128", "display_name": "Chris Mishler", "link": "https://stackoverflow.com/users/9903837/chris-mishler"}, "edited": false, "score": 0, "creation_date": 1540383972, "post_id": 52961921, "comment_id": 92844094, "body": "You are correct in that line 3 needed to refer to the specific sheet name, not the Excel sheet # (Sheet7). I did make that change. I am not using &quot;Sheet7&quot; as a sheetname on the sheet tab."}, {"owner": {"reputation": 11, "user_id": 9903837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KRqP81ONchk/AAAAAAAAAAI/AAAAAAAAAJE/3P1_A97zfMk/photo.jpg?sz=128", "display_name": "Chris Mishler", "link": "https://stackoverflow.com/users/9903837/chris-mishler"}, "edited": false, "score": 0, "creation_date": 1540384246, "post_id": 52961921, "comment_id": 92844272, "body": "As Tim recommends, I have been considering how to use error handling to turn on events, but I do not receive an error message that the auto open event did not run or work properly. It just does not enable events. I will think harder how I can arrange the components to ensure events are enabled after a) removing VBA code (except that which reinserts the desired event code for navigation to other sheets), b) saving the file as a &quot;VALUES&quot; one, and c) reopening the VALUES file, where the Open event would turn on events and leave them on."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1540375053, "last_edit_date": 1540375053, "creation_date": 1540360752, "answer_id": 52961921, "question_id": 52956849, "link": "https://stackoverflow.com/questions/52956849/excel-2010-vba-enableevent-in-open-event-not-working-when-code-inserted/52961921#52961921", "title": "Excel 2010 vba EnableEvent in Open event not working when code inserted", "body": "<p>I think Line 3 is encountering an error. Changing the 3 will do the trick</p>\n\n<pre><code>.InsertLines 3, \"Sheets(\" &amp; Chr(34) &amp; \"Sheet7\" &amp; Chr(34) &amp; \").Select\"\n</code></pre>\n\n<p>also it depends on existence of \"Sheet7\".</p>\n\n<p><strong>But still best solution is the suggestion by @Tim Williams</strong></p>\n"}], "owner": {"reputation": 11, "user_id": 9903837, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KRqP81ONchk/AAAAAAAAAAI/AAAAAAAAAJE/3P1_A97zfMk/photo.jpg?sz=128", "display_name": "Chris Mishler", "link": "https://stackoverflow.com/users/9903837/chris-mishler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1540375053, "creation_date": 1540324288, "last_edit_date": 1540325053, "question_id": 52956849, "link": "https://stackoverflow.com/questions/52956849/excel-2010-vba-enableevent-in-open-event-not-working-when-code-inserted", "title": "Excel 2010 vba EnableEvent in Open event not working when code inserted", "body": "<p>As I attempt to improve efficiency in a complex Excel model with over 100 macros, I wanted to ensure events were enabled after a module ran to convert a template with formulas to a values only file.  Using the code below, I expected that other event code inserted into an otherwise VBA-less Excel file would work, but the Open event code below does not enable events. I've done a search and see that EnableEvents is tricky. My goal is that use of some other code that I found online to \"Optimize\" or speed up the running of codes would be more widely possible. It includes EnableEvent language (turn it off at the beginning and on at the end of code).  </p>\n\n<p>Here is the code I have adapted to get the \"VALUES\" version of the template to enable events in general, once I navigate to another tab and make a selection change with a sub called <strong>Private Sub Worksheet_SelectionChange(ByVal Target As Range)</strong>.</p>\n\n<pre><code>Sub AddSheetCodeToAuto_Open()\n' To turn on events\nDim Startline As Long, HowManyLines As Long\nWith ThisWorkbook.VBProject.VBComponents(ActiveSheet.CodeName).CodeModule\n    Startline = 1\n    HowManyLines = .CountOfLines\n    .DeleteLines Startline, HowManyLines\n.InsertLines 1, \"Private Sub Workbook_Open()\"\n.InsertLines 2, vbNewLine\n.InsertLines 3, \"Sheets(Sheet7).Select\n.InsertLines 4, \"Application.EnableEvents = True\"\n.InsertLines 5, \"End Sub\"\nEnd With\nEnd Sub\n</code></pre>\n\n<p>When I use the Immediate window and step through code, the Application.EnableEvents value is always FALSE after opening the file in question, but given that the event handler for the open workbook event is as seen above, why will events not turn on?\nThank you in advance for your expertise.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 50, "user_id": 10548322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b9652e1e8f07915c874a11c5e8db4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Nick S", "link": "https://stackoverflow.com/users/10548322/nick-s"}, "edited": false, "score": 0, "creation_date": 1540328335, "post_id": 52957141, "comment_id": 92822921, "body": "Thanks! I didn&#39;t realize that the sheet name was being appended to the name of the chart property when accessed. I revised my code and everything is working properly."}], "tags": [], "owner": {"reputation": 170, "user_id": 6142378, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/593e89e4256dd201a541c13e29abdf5d?s=128&d=identicon&r=PG&f=1", "display_name": "Dammer15", "link": "https://stackoverflow.com/users/6142378/dammer15"}, "is_accepted": true, "score": 1, "last_activity_date": 1540326209, "last_edit_date": 1540326209, "creation_date": 1540325454, "answer_id": 52957141, "question_id": 52956827, "link": "https://stackoverflow.com/questions/52956827/deleting-specific-chartobjects-by-name-property-excel-vba/52957141#52957141", "title": "Deleting specific ChartObjects by Name Property Excel VBA", "body": "<p>You never get the correct Chart Name. Use the sheets and indexing you need but here's the general idea. You must remove the Sheet name from the accessed property.</p>\n\n<pre><code>'List of Chart Objects\nDim ChartList As ChartObjects\n\n'The square that holds the chart\nDim MyChartFrame As ChartObject\nDim ChartToDelete As ChartObject\n\n'The Physical chart with data\nDim MyChart As Chart\n\n'Accessing the Objects\nSet ChartList = Sheet1.ChartObjects\nSet MyChartFrame = Sheet1.ChartObjects(1)\nSet MyChart = MyChartFrame.Chart\n\nDim ChartName As String\n\n'Remove SheetName from ChartName!!!!\nChartName = MyChart.Name\n\n'Deleting Chart\nSet ChartToDelete = Sheet1.ChartObjects(ChartName)\nChartToDelete.Delete\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ANspX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ANspX.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 50, "user_id": 10548322, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b9652e1e8f07915c874a11c5e8db4d7?s=128&d=identicon&r=PG&f=1", "display_name": "Nick S", "link": "https://stackoverflow.com/users/10548322/nick-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2618, "favorite_count": 0, "accepted_answer_id": 52957141, "answer_count": 1, "score": 1, "last_activity_date": 1586756091, "creation_date": 1540324185, "last_edit_date": 1586756091, "question_id": 52956827, "link": "https://stackoverflow.com/questions/52956827/deleting-specific-chartobjects-by-name-property-excel-vba", "title": "Deleting specific ChartObjects by Name Property Excel VBA", "body": "<p>I have an excel worksheet with two chart objects (pie chart and line graph). I have separate buttons to generate each graph and I want to delete the according pre-existing graph each time the generation button is pressed. Right now, I am attempting to access the Name property of the chart object to determine if the chart needs to be deleted. The deletion code looks like this:</p>\n\n<pre><code>For i = 1 To ActiveSheet.ChartObjects.Count\n    If ActiveSheet.ChartObjects(i).Chart.Name = \"Genre\" Then\n        ActiveSheet.ChartObjects(\"Genre\").Delete\n    End If\nNext i\n</code></pre>\n\n<p>Here is the code that generates the piechart:</p>\n\n<pre><code>Range(\"A2:B16\").Select\nActiveSheet.Shapes.AddChart.Select\nActiveChart.ChartType = xlPie 'Exploded\nActiveChart.SetElement (msoElementChartTitleAboveChart)\nActiveChart.ChartTitle.Text = \"Genre Breakdown\"\nActiveChart.Parent.Name = \"Genre\"\nDim ChartSize As ChartObject\nSet ChartSizing = Worksheets(\"Graphs and Stats\").ChartObjects(\"Genre\")\nWith ChartSizing\n    .Top = Range(\"D2\").Top\n    .Width = Range(\"D2:H23\").Width\n    .Height = Range(\"D2:H23\").Height\n    .Left = Range(\"D2\").Left\nEnd With\n</code></pre>\n\n<p>Currently, the If-statement in the deletion for loop never resolves as true and I don't understand why. What is wrong with that line and/or is there better logic I could be using to check for pre-existing charts? I would prefer not use</p>\n\n<pre><code>ActiveSheet.ChartObjects.Delete\n</code></pre>\n\n<p>if I can avoid it to keep the generation buttons separate from each other.</p>\n\n<p><strong>EDIT:</strong> Corrected code (where worksheet name is \"Graphs and Stats\") using Dammer15's solution:</p>\n\n<pre><code>For i = 1 To ActiveSheet.ChartObjects.Count\n    If ActiveSheet.ChartObjects(i).Chart.Name = \"Graphs and Stats Genre\" Then\n        ActiveSheet.ChartObjects(\"Genre\").Delete\n    End If\nNext i\n\nSet Rng = ActiveSheet.Range(\"A2:B16\")\nSet GenreChart = ActiveSheet.Shapes.AddChart\nGenreChart.Name = \"Genre\"\nWith GenreChart.Chart\n    .SetSourceData Source:=Rng\n    .ChartType = xlPie\n    .SetElement (msoElementChartTitleAboveChart)\n    .ChartTitle.Text = \"Genre Breakdown\"\nEnd With\n</code></pre>\n"}, {"tags": ["html", "excel", "vba", "web-scraping"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1540324155, "post_id": 52956702, "comment_id": 92821136, "body": "can you provide an example of <code>DOTNum</code> so I can take a look at the HTML?"}, {"owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "edited": false, "score": 0, "creation_date": 1540327064, "post_id": 52956702, "comment_id": 92822438, "body": "So your post is about getting a macro capale of fetching all of your required fields!!! If someone does that whole thing for you then what will be your try @Kevin Harris KreizK?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 3950448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86fa6f9d1b522194634b7fff282d1b2?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Harris KreizK", "link": "https://stackoverflow.com/users/3950448/kevin-harris-kreizk"}, "edited": false, "score": 0, "creation_date": 1540395624, "post_id": 52957563, "comment_id": 92852361, "body": "I was using a subroutine to search for the Motor Carrier (MC#) on  from <a href=\"https://safer.fmcsa.dot.gov/CompanySnapshot.aspx\" rel=\"nofollow noreferrer\">safer.fmcsa.dot.gov/CompanySnapshot.aspx</a>, then from here we&#39;ll get the DOTNum to proceed with this subroutine.  With all of your help I was able to have my list of MCNumbers (000000 to 999999) which will continuously pull updated dated from FMCSA&#39;s site (I like getting all the emails)"}], "tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 1, "last_activity_date": 1540328336, "last_edit_date": 1540328336, "creation_date": 1540327383, "answer_id": 52957563, "question_id": 52956702, "link": "https://stackoverflow.com/questions/52956702/web-scrape-from-article-or-span-in-source/52957563#52957563", "title": "Web Scrape from &lt;Article or &lt;Span in Source", "body": "<p>Running the following macro, you will get your first three required fields:</p>\n\n<pre><code>Sub GetInformation()\n    Const Url$ = \"https://ai.fmcsa.dot.gov/SMS/Carrier/621247/CarrierRegistration.aspx\"\n    Dim Http As New xmlhttp60, Html As New HTMLDocument, post As Object, I&amp;\n\n    With Http\n        .Open \"GET\", Url, False\n        .send\n        Html.body.innerHTML = .responseText\n    End With\n\n    For Each post In Html.getElementsByTagName(\"label\")\n        If InStr(post.innerText, \"Legal Name\") &gt; 0 Then\n            I = I + 1: Cells(I, 1) = post.NextSibling.innerText\n        End If\n\n        If InStr(post.innerText, \"Address\") &gt; 0 Then\n            Cells(I, 2) = post.NextSibling.innerText\n        End If\n\n        If InStr(post.innerText, \"Vehicle Miles Traveled\") &gt; 0 Then\n            Cells(I, 3) = post.NextSibling.innerText\n        End If\n    Next post\nEnd Sub\n</code></pre>\n\n<p>Reference to add:</p>\n\n<pre><code>Microsoft xml, v6.0\nMicrosoft Html Object Library\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 3950448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86fa6f9d1b522194634b7fff282d1b2?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Harris KreizK", "link": "https://stackoverflow.com/users/3950448/kevin-harris-kreizk"}, "edited": false, "score": 1, "creation_date": 1540388421, "post_id": 52957620, "comment_id": 92847244, "body": "Thank you so much for this!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 2, "last_activity_date": 1540383180, "last_edit_date": 1540383180, "creation_date": 1540327731, "answer_id": 52957620, "question_id": 52956702, "link": "https://stackoverflow.com/questions/52956702/web-scrape-from-article-or-span-in-source/52957620#52957620", "title": "Web Scrape from &lt;Article or &lt;Span in Source", "body": "<p>I would do this as shown below. This solution is written with your future looping over multiple DOTNums in mind. I have tested with a loop over 3 numbers and it works perfectly.</p>\n\n<p><strong>Access method:</strong></p>\n\n<p>I use XMLHTTP request as a much faster method of retrieval than launching IE.</p>\n\n<p><strong>Registration Info:</strong></p>\n\n<p>The registration info I get by applying a CSS class selector to target elements with class <code>.dat</code>. I then index into the <code>nodeList</code> returned by <code>querySelectorAll</code> to retrieve the required elements.</p>\n\n<p><strong>Vehicle type breakdown:</strong></p>\n\n<p>The full vehicle type breakdown table I initially grab by index and tag with <code>.getElementsByTagName(\"table\")(0)</code>.</p>\n\n<p>The table has a slightly tricky layout. For example, the first column elements are actually <code>th</code> not <code>td</code> tagged. I get around this by first isolating the actual headers with a CSS descendant selector combination of <code>thead th</code>. This targets just the <code>th</code> elements in the table header. I then use the CSS OR operator within a CSS descendant selector combination to pull back the first column <code>th</code> elements or the remaining columns <code>td</code> tagged elements: <code>tbody tr th,td</code>. \nI use <code>mod 4</code> to determine whether it is first column or not and adjust the write out to a new row accordingly.</p>\n\n<p><strong>Helpers (modular code is best practice):</strong></p>\n\n<p>I have used a <code>GetLastRow</code> helper function to determine where to start writing out to as it looks like you will be deploying this in a loop eventually over different DOTnums. I use a class to hold the XMLHTTP object. </p>\n\n<p><code>WriteTable</code> does at is says. It writes out the table.</p>\n\n<p><strong>dotNums:</strong></p>\n\n<p>I read the dotNums in from a sheet called <code>DOTNumbers</code>. In my example, I use 3 numbers to grab info for <code>{529136,621247,2474795}</code>. The array <code>dotNums</code> is populated with these values from the sheet, and is looped over to provide the dotNum to be added into the Url.</p>\n\n<hr>\n\n<p><strong>Example of the OR operator in the CSS query (sample):</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/cpXL1.png\" height=\"300\"></p>\n\n<hr>\n\n<p><strong>Sample Output:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/uZO4j.png\" height=\"400\"></p>\n\n<hr>\n\n<h2><strong>VBA:</strong></h2>\n\n<p><strong>Class module clsHTTP:</strong></p>\n\n<pre><code>Option Explicit    \nPrivate http As Object\n\nPrivate Sub Class_Initialize()\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\nEnd Sub\n\nPublic Function GetString(ByVal url As String) As String\n    Dim sResponse As String\n    With http\n        .Open \"GET\", url, False\n        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n        .send\n        sResponse = StrConv(.responseBody, vbUnicode)\n        GetString = sResponse\n    End With\nEnd Function\n</code></pre>\n\n<p><strong>Standard module 1:</strong></p>\n\n<pre><code>Option Explicit    \nPublic Sub GetInfo()\n    Dim html As HTMLDocument, headers1(), hTable As HTMLTable\n    Dim ws As Worksheet, wsDotNums As Worksheet, registrationinfo As Object, nextRow As Long\n    Dim dotNums(), http As clsHTTP, url As String, i As Long\n\n    Application.ScreenUpdating = True\n\n    Set http = New clsHTTP\n    Set ws = ThisWorkbook.Worksheets(\"Sheet1\")\n    Set wsDotNums = ThisWorkbook.Worksheets(\"DOTNumbers\")\n    Set html = New HTMLDocument\n\n    dotNums = Application.Transpose(wsDotNums.Range(\"A1:A3\").Value) '&lt;== Change the range here to the single column range containing your dotNums.\n\n    For i = LBound(dotNums) To UBound(dotNums)\n        If Not IsEmpty(dotNums(i)) Then\n            With html\n                url = \"https://ai.fmcsa.dot.gov/SMS/Carrier/\" &amp; dotNums(i) &amp; \"/CarrierRegistration.aspx\"\n                html.body.innerHTML = http.GetString(url)\n                Set registrationinfo = .querySelectorAll(\".dat\")\n                Set hTable = .getElementsByTagName(\"table\")(0)\n            End With\n\n            headers1 = Array(\"Legal Name\", \"Address\", \"Miles Traveled \", \"Email\")\n\n            nextRow = IIf(GetLastRow(ws, 1) = 1, 1, GetLastRow(ws, 1) + 2)\n\n            With ws\n                .Cells(nextRow, 1).Resize(1, UBound(headers1) + 1) = headers1\n                .Cells(nextRow + 1, 1) = registrationinfo.item(0).innerText\n                .Cells(nextRow + 1, 2) = registrationinfo.item(3).innerText\n                .Cells(nextRow + 1, 3) = registrationinfo.item(7).innerText\n                .Cells(nextRow + 1, 4) = registrationinfo.item(6).innerText\n            End With\n\n            WriteTable hTable, nextRow + 3, ws\n\n        End If     \n    Next      \n    Application.ScreenUpdating = True\nEnd Sub\n\nPublic Sub WriteTable(ByVal hTable As HTMLTable, Optional ByVal startRow As Long = 1, Optional ByVal ws As Worksheet)\n    If ws Is Nothing Then Set ws = ActiveSheet\n\n    Dim r As Long, c As Long, i As Long, headers As Object\n    r = startRow\n    With ws\n        Set headers = hTable.querySelectorAll(\"thead th\")\n        For i = 0 To headers.Length - 1\n            .Cells(r, i + 1) = headers.item(i).innerText\n        Next\n\n        Dim tableContents As Object\n        Set tableContents = hTable.querySelectorAll(\"tbody tr th,td\")\n\n        For i = 0 To tableContents.Length - 1\n            If i Mod 4 = 0 Then\n                c = 1: r = r + 1\n            Else\n                c = c + 1\n            End If\n            .Cells(r, c) = tableContents.item(i).innerText\n        Next\n    End With\nEnd Sub\n\nPublic Function GetLastRow(ByVal ws As Worksheet, Optional ByVal columnNumber As Long = 1) As Long\n    With ws\n        GetLastRow = .Cells(.Rows.Count, columnNumber).End(xlUp).Row\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19801, "user_id": 9189799, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/U2hEg.jpg?s=128&g=1", "display_name": "SIM", "link": "https://stackoverflow.com/users/9189799/sim"}, "is_accepted": false, "score": 2, "last_activity_date": 1540370167, "creation_date": 1540370167, "answer_id": 52964419, "question_id": 52956702, "link": "https://stackoverflow.com/questions/52956702/web-scrape-from-article-or-span-in-source/52964419#52964419", "title": "Web Scrape from &lt;Article or &lt;Span in Source", "body": "<p>You might think of giving a shot the following way as well. It should fetch you all your aforementioned fields. I tried to compact it within a single sub. However, If you have loops to carry on the script should not make a mess. I've used simple selectors within the script along with nested loops to get your job done. Hope this helps.</p>\n\n<pre><code>Sub FetchData()\n    Const link As String = \"https://ai.fmcsa.dot.gov/SMS/Carrier/621247/CarrierRegistration.aspx\"\n    Dim Httpreq As New XMLHTTP60, Htmldoc As New HTMLDocument\n    Dim R&amp;, I&amp;, tR&amp;, N&amp;, C&amp;\n\n    With Httpreq\n        .Open \"GET\", link, False\n        .send\n        Htmldoc.body.innerHTML = .responseText\n    End With\n\n    [A1:C1] = [{\"Legal Name\", \"Address\", \"Miles Traveled\"}]\n\n    With Htmldoc.querySelectorAll(\"#regBox label,#regBox h3\")\n        For R = 0 To .Length - 1\n            If .item(R).innerText Like \"*Legal Name*\" Then\n                I = I + 1: Cells(I + 1, 1) = .item(R).NextSibling.innerText\n            End If\n\n            If .item(R).innerText Like \"*Address*\" Then\n                Cells(I + 1, 2) = .item(R).NextSibling.innerText\n            End If\n\n            If .item(R).innerText Like \"*Vehicle Miles Traveled*\" Then\n                Cells(I + 1, 3) = .item(R).NextSibling.innerText\n            End If\n\n            If .item(R).innerText Like \"*Vehicle Type Breakdown*\" Then\n                With .item(R).NextSibling.Rows\n                    For tR = 0 To .Length - 1\n                        With .item(tR).Cells\n                            For N = 0 To .Length - 1\n                                C = C + 1: Cells(I + 2, C) = .item(N).innerText\n                            Next N\n                        End With\n                        I = I + 1: C = 0\n                    Next tR\n                End With\n            End If\n        Next R\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 3950448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c86fa6f9d1b522194634b7fff282d1b2?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Harris KreizK", "link": "https://stackoverflow.com/users/3950448/kevin-harris-kreizk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 52957620, "answer_count": 3, "score": 0, "last_activity_date": 1586756111, "creation_date": 1540323696, "last_edit_date": 1586756111, "question_id": 52956702, "link": "https://stackoverflow.com/questions/52956702/web-scrape-from-article-or-span-in-source", "title": "Web Scrape from &lt;Article or &lt;Span in Source", "body": "<p>What about if it's not in a frame? I am working to gather some details from this site <a href=\"https://ai.fmcsa.dot.gov/SMS/Carrier/621247/CarrierRegistration.aspx\" rel=\"nofollow noreferrer\">https://ai.fmcsa.dot.gov/SMS/Carrier/621247/CarrierRegistration.aspx</a> in which I am not able to pull the data.</p>\n\n<p>I'm trying to pull the text in <code>&lt;span class=\"dat\"&gt;</code> items from the <code>&lt;div id=\"regBox\"&gt;</code> though not retrieving. Wanting Legal Name, Address, Miles Traveled and Email. As well the entire Vehicle Type Breakdown listed in separate cells within 1 cell.</p>\n\n<p>Can this be done?</p>\n\n<pre><code>Sub ScrapeFMSCA(DOTNum)\n\n\nDim ie As Object\nDim ieDoc As Object\nDim ieEle As Object\n\nDim k As Long\nDim s As Object\nDim P As String\nDim txt As String\nDim rng As Range, cname As String\nDim r As Integer, c As Integer\nDim elemCollection As Object, curHTMLRow As Object\n\nApplication.ScreenUpdating = True\n\nSet ie = CreateObject(\"InternetExplorer.Application\")\n\nk = 2\n\nWith ie\n    .Visible = True\n\n    URL = \"https://ai.fmcsa.dot.gov/SMS/Carrier/\" &amp; DOTNum &amp; \"/CarrierRegistration.aspx\"\n    Application.StatusBar = \" Logging In \"\n    .Navigate URL\n\n    Do While ie.Busy: DoEvents: Loop '** Wait til page loaded\n    Do While ie.ReadyState &lt;&gt; 4: DoEvents: Loop '** Wait til IE READY\n\n    Set ieDoc = ie.Document\n    Set NodeList = ieDoc.getElementsByTagName(\"article\").getElementsByTagName(\"span\").getElementsByClassName(\"dat\")(1)\n    MsgBox NodeList.span\n\n    cTime = Now + TimeValue(\"00:01:00\")\n    Do Until (ie.ReadyState = 4 And Not ie.Busy)\n        If Now &lt; cTime Then\n            DoEvents\n        Else\n            GoTo Here1\n        End If\n    Loop\n\nHere1:\n\n    ie.Quit\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1540359640, "post_id": 52956656, "comment_id": 92830130, "body": "<code>Range(Cells(i, 5), Cells(i, 10)).Cells</code> is six cells"}], "answers": [{"tags": [], "owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1540370067, "creation_date": 1540370067, "answer_id": 52964382, "question_id": 52956656, "link": "https://stackoverflow.com/questions/52956656/deleting-rows-based-on-values-in-multiple-cells-per-row/52964382#52964382", "title": "Deleting rows based on values in multiple cells per row", "body": "<p>I don't see any advantage in copying data to array and looping array after to check values. <BR> \nAlso i'd be carefull using <code>integer</code> type as it's only -32 768 to 32 767. <code>Long</code> is safer to use i think. <BR> \nWhen you refer to cells/ranges use workbook/sheet to point directly where you want. <BR> \nThis for example <code>Cells(Rows.Count, 11).End(xlUp).Row</code> refers to currently active sheet and that might be not intended. <BR> </p>\n\n<p>So here is my version </p>\n\n<pre><code>Option Explicit\n\nSub DeleteRowtest()\n    Dim LastRow As Long, i As Long\n    Dim Found As Boolean\n    Dim Ws As Worksheet\n    Dim aCell As Range\n\n    'turn off screen updating and sheet calculation to improve speed\n    Application.ScreenUpdating = False\n    Application.Calculation = xlCalculationManual\n\n    Set Ws = ThisWorkbook.Sheets(\"Your sheet name\") 'set reference to sheet\n\n    With Ws 'all references starting with \".\" from now on will refer to sheet \"Ws\"\n        LastRow = .Cells(.Rows.Count, 11).End(xlUp).Row 'Find last row\n\n        For i = LastRow To 2 Step -1 'loop rows from last to 2\n            Found = False 'reset variable\n            For Each aCell In .Range(.Cells(i, 5), .Cells(i, 10))\n                If aCell.Value &gt; 0 Then ' this will be true also for text in cells\n                'if you want to check for numeric values only you can try this\n            '   If aCell.Value &gt; 0 And IsNumeric(aCell.Value) Then\n                    Found = True\n                    Exit For\n                End If\n            Next aCell\n            If Not Found Then 'no positive value found in row\n                .Rows(i &amp; \":\" &amp; i).EntireRow.Delete\n            End If\n        Next i\n        .Range(\"B2\").Select\n    End With\n\n    Application.ScreenUpdating = True\n    Application.Calculation = xlCalculationAutomatic\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10547832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c4dff46691137b1d6735f0bc7ae6b8c?s=128&d=identicon&r=PG&f=1", "display_name": "Writhe", "link": "https://stackoverflow.com/users/10547832/writhe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 52964382, "answer_count": 1, "score": 2, "last_activity_date": 1557038292, "creation_date": 1540323499, "last_edit_date": 1557038292, "question_id": 52956656, "link": "https://stackoverflow.com/questions/52956656/deleting-rows-based-on-values-in-multiple-cells-per-row", "title": "Deleting rows based on values in multiple cells per row", "body": "<p>The functioning code below is cobbled together out of answers on this site.</p>\n\n<p>I feel that it is not as elegant as it could be.</p>\n\n<p>The purpose of the code is to check a range of five cells in each row, and if there are no positive values in those cells, delete the row.</p>\n\n<pre><code>Sub DeleteRowtest()\nDim lr As Integer ' are any of these dims redundant or unnecessary? Incorrect?\nDim cval As Variant\nDim ArrCt As Integer\nDim val As Variant\n\n'the initial redim is there on purpose\n' instead of ValArray as Variant then ValArray = array().\n' this seems cleaner but which is better?\nReDim ValArray(0) As Integer \n\nDim T As Boolean\n\nlr = Cells(Rows.Count, 11).End(xlUp).Row\nFor i = lr To 2 Step -1\n    ArrCt = 0\n\n    'this loop appears to work the way I want,\n    ' but am I using .cells and .value correct here?\n    For Each cval In Range(Cells(i, 5), Cells(i, 10)).Cells\n        ValArray(ArrCt) = cval.Value\n        ArrCt = ArrCt + 1\n        ReDim Preserve ValArray(ArrCt)\n    Next\n\n    'is there a cleaner way than this array and nested loop\n    ' to determine the same info and act on it?\n    ' (i.e. if all values of cell range are &lt;1 delete row)\n    For Each val In ValArray\n        If val &gt; 0 Then\n            T = True\n        End If\n    Next\n\n    If T = False Then Rows(i &amp; \":\" &amp; i).EntireRow.Delete\n    T = False\nNext\n\n'finally, are there any errors/broken logic at all here that I dont see?\n\nRange(\"B2\").Select\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powershell"], "comments": [{"owner": {"reputation": 239138, "user_id": 45375, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39f6e2dc52425b1e08027c01bb880be0?s=128&d=identicon&r=PG", "display_name": "mklement0", "link": "https://stackoverflow.com/users/45375/mklement0"}, "edited": false, "score": 1, "creation_date": 1540324007, "post_id": 52956136, "comment_id": 92821065, "body": "Your PowerShell <code>Get-ChildItem</code> command acts on the current directory, which it inherits from the calling application. Is that the right directory?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1540324460, "post_id": 52956136, "comment_id": 92821265, "body": "Can you provide the command line that runs directly in Powershell ? and how do your filenames look like?"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 1, "creation_date": 1540332288, "post_id": 52956136, "comment_id": 92824211, "body": "and why not use the shell/command prompt, why only powershell to rename the file extensions ?"}], "answers": [{"tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": false, "score": 0, "last_activity_date": 1540337966, "creation_date": 1540337966, "answer_id": 52959178, "question_id": 52956136, "link": "https://stackoverflow.com/questions/52956136/vba-macro-to-run-powershell-command/52959178#52959178", "title": "VBA Macro to run PowerShell Command", "body": "<p>You have to provide the path where your files exist\nTry this and change the path to suit you</p>\n\n<pre><code>Sub Test()\nDim retval, pscmd\n\npscmd = \"PowerShell -ExecutionPolicy Bypass -Command \"\"Get-ChildItem -Path \" &amp; ThisWorkbook.Path &amp; \"\\Files\\\" &amp; \" *.docx -Recurse | Rename-Item -NewName {$_.Name.Substring(0,7) + $_.Extension }\"\"\"\nretval = Shell(pscmd, vbNormalFocus)\n\nDebug.Print pscmd\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10188082, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c25c775c13f2ee4c4614b3bd3d4f7cf6?s=128&d=identicon&r=PG&f=1", "display_name": "T.J.", "link": "https://stackoverflow.com/users/10188082/t-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1607, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1586756126, "creation_date": 1540321171, "last_edit_date": 1586756126, "question_id": 52956136, "link": "https://stackoverflow.com/questions/52956136/vba-macro-to-run-powershell-command", "title": "VBA Macro to run PowerShell Command", "body": "<p>I am trying to create a macro, that would be able to rename all files with \".docx\" extension in a folder.</p>\n\n<p>The PowerShell command works when used directly, but when used through the VBA code, it's not executing.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub test()\n    Dim retval\n    Dim pscmd\n\n    pscmd = \"PowerShell -ExecutionPolicy Bypass -Command \"\"Get-ChildItem -Path *.docx -Recurse | Rename-Item -NewName {$_.Name.Substring(0,7) + $_.Extension }\"\"\"\n\n    retval = Shell(pscmd, vbNormalFocus)\n\n    Debug.Print pscmd\nEnd Sub\n</code></pre>\n\n<p>The script is executing without compilation errors, but the files are not being renamed.</p>\n\n<p>What do I need to change?</p>\n"}, {"tags": ["vba", "pdf", "ms-word"], "comments": [{"owner": {"reputation": 5, "user_id": 10547886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7cdc27d5aedc9cdfe85d43958e62682?s=128&d=identicon&r=PG&f=1", "display_name": "MWalker", "link": "https://stackoverflow.com/users/10547886/mwalker"}, "edited": false, "score": 0, "creation_date": 1540572751, "post_id": 52955676, "comment_id": 92929659, "body": "Thanks, @macropod! I am having trouble figuring out how/where to insert the naming rules. Do you have any suggestions as to where these might fit in this macro? I tried adding it but keep getting an error.                                                                                                        Dim StrFilename As String   Dim StrNm As String   Dim StrCat As String  StrNm = Split(ActiveDocument.Tables(1).Cell(5, 1).Range.Text, vbCr)(0)  StrCat = Split(ActiveDocument.Tables(1).Cell(2, 1).Range.Text, vbCr)(0)  StrFilename = StrCat &amp; &quot;_&quot; &amp; StrNm &amp; &quot;.pdf&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1540500606, "creation_date": 1540500606, "answer_id": 52997910, "question_id": 52955676, "link": "https://stackoverflow.com/questions/52955676/word-vba-convert-batch-of-word-files-to-pdf-with-name-from-table-contents-withi/52997910#52997910", "title": "Word VBA: Convert Batch of Word Files to PDF with Name From Table Contents within Each Doc", "body": "<p>Try:</p>\n\n<pre><code>Sub ConvertDocs2PDFs()\nApplication.ScreenUpdating = False\nDim strFolder As String, strFile As String, strDocNm As String, wdDoc As Document\nstrDocNm = ActiveDocument.FullName\nstrFolder = GetFolder\nIf strFolder = \"\" Then Exit Sub\nstrFile = Dir(strFolder &amp; \"\\*.doc\", vbNormal)\nWhile strFile &lt;&gt; \"\"\n  If strFolder &amp; \"\\\" &amp; strFile &lt;&gt; strDocNm Then\n    Set wdDoc = Documents.Open(FileName:=strFolder &amp; \"\\\" &amp; strFile, AddToRecentFiles:=False, Visible:=False)\n    With wdDoc\n      .SaveAs FileName:=Split(.FullName, \".doc\")(0) &amp; \".pdf\", FileFormat:=wdFormatPDF, AddToRecentFiles:=False\n      .Close SaveChanges:=False\n    End With\n  End If\n  strFile = Dir()\nWend\nSet wdDoc = Nothing\nApplication.ScreenUpdating = True\nEnd Sub\n\nFunction GetFolder() As String\nDim oFolder As Object\nGetFolder = \"\"\nSet oFolder = CreateObject(\"Shell.Application\").BrowseForFolder(0, \"Choose a folder\", 0)\nIf (Not oFolder Is Nothing) Then GetFolder = oFolder.Items.Item.Path\nSet oFolder = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 10547886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7cdc27d5aedc9cdfe85d43958e62682?s=128&d=identicon&r=PG&f=1", "display_name": "MWalker", "link": "https://stackoverflow.com/users/10547886/mwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 448, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1586675322, "creation_date": 1540319438, "last_edit_date": 1586675322, "question_id": 52955676, "link": "https://stackoverflow.com/questions/52955676/word-vba-convert-batch-of-word-files-to-pdf-with-name-from-table-contents-withi", "title": "Word VBA: Convert Batch of Word Files to PDF with Name From Table Contents within Each Doc", "body": "<p>Trying to put together a macro that converts a batch of word files into PDFs with file names pulling from table contents within each word file.</p>\n\n<p>I found one macro that converts an open document to PDF with the correct file name and another that converts a batch of selected word files to PDF. </p>\n\n<p>I'm having trouble 'combining' them to get the PDFs to have the correct file name. Any help or suggestions would be greatly appreciated! </p>\n\n<pre><code>Sub Open_File_To_PDF()\n\nDim StrFilename As String  \nDim StrNm As String  \nDim StrCat As String\n\nStrNm = Split(ActiveDocument.Tables(1).Cell(5, 1).Range.Text, vbCr)(0) \nStrCat = Split(ActiveDocument.Tables(1).Cell(2, 1).Range.Text, vbCr)(0) \nStrFilename = StrCat &amp; \"_\" &amp; StrNm &amp; \".pdf\"\n\n    ActiveDocument.ExportAsFixedFormat OutputFileName:= _\n        StrFilename, _\n        ExportFormat:=wdExportFormatPDF, OpenAfterExport:=True, OptimizeFor:= _\n        wdExportOptimizeForPrint, Range:=wdExportAllDocument, Item:= _\n        wdExportDocumentContent, IncludeDocProps:=False, KeepIRM:=True, _\n        CreateBookmarks:=wdExportCreateNoBookmarks, DocStructureTags:=True, _\n        BitmapMissingFonts:=True, UseISO19005_1:=False\n End Sub\n\nSub ConvertDocmInDirToPDF()\n\nDim filePath As String\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .AllowMultiSelect = False\n    .Show\n    On Error Resume Next\n    filePath = .SelectedItems(1)\nEnd With\n\nIf filePath = \"\" Then Exit Sub\nIf Right(filePath, 1) &lt;&gt; \"\\\" Then filePath = filePath &amp; \"\\\"\n\nApplication.ScreenUpdating = False\n\nDim currFile As String\ncurrFile = Dir(filePath &amp; \"*.docm\")\n\nDo While currFile &lt;&gt; \"\"\n\n    Documents.Open (filePath &amp; currFile)\n    Documents(currFile).ExportAsFixedFormat _\n        OutputFileName:=filePath &amp; Left(currFile, Len(currFile) - Len(\".docm\")) &amp; \".pdf\", _\n        ExportFormat:=wdExportFormatPDF, _\n        OpenAfterExport:=False, _\n        OptimizeFor:=wdExportOptimizeForPrint, Range:=wdExportAllDocument, _\n        From:=1, To:=1, Item:=wdExportDocumentContent, IncludeDocProps:=True, _\n        KeepIRM:=True, CreateBookmarks:=wdExportCreateNoBookmarks, _\n        DocStructureTags:=True, BitmapMissingFonts:=True, UseISO19005_1:=False\n    Documents(currFile).Close\n\n    currFile = Dir()\nLoop\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "concatenation"], "comments": [{"owner": {"reputation": 61, "user_id": 10442755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f935cb080ed82d3ef574687457898a5c?s=128&d=identicon&r=PG&f=1", "display_name": "Alvi", "link": "https://stackoverflow.com/users/10442755/alvi"}, "edited": false, "score": 0, "creation_date": 1540321555, "post_id": 52955419, "comment_id": 92819947, "body": "I am getting Object required error 424 with line: lRow = .Range(&quot;A&quot; &amp; Rows.Count).End(xlUp).Row"}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 10442755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f935cb080ed82d3ef574687457898a5c?s=128&d=identicon&r=PG&f=1", "display_name": "Alvi", "link": "https://stackoverflow.com/users/10442755/alvi"}, "edited": false, "score": 0, "creation_date": 1540320914, "post_id": 52955803, "comment_id": 92819614, "body": "in 6th line starting with 1Row = .Range... error comes up as Object required error 424 Thank you for help"}, {"owner": {"reputation": 412, "user_id": 9984864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853e1965adbcfc68089abb6a77ed8780?s=128&d=identicon&r=PG", "display_name": "Guest", "link": "https://stackoverflow.com/users/9984864/guest"}, "edited": false, "score": 0, "creation_date": 1540340889, "post_id": 52955803, "comment_id": 92826161, "body": "Use: ActiveSheet"}, {"owner": {"reputation": 61, "user_id": 10442755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f935cb080ed82d3ef574687457898a5c?s=128&d=identicon&r=PG&f=1", "display_name": "Alvi", "link": "https://stackoverflow.com/users/10442755/alvi"}, "edited": false, "score": 0, "creation_date": 1540406428, "post_id": 52955803, "comment_id": 92858349, "body": "Thank you all with ActiveSheet code worked perfectly."}, {"owner": {"reputation": 11170, "user_id": 726127, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TA0YX.jpg?s=128&g=1", "display_name": "Brad", "link": "https://stackoverflow.com/users/726127/brad"}, "edited": false, "score": 0, "creation_date": 1540473778, "post_id": 52955803, "comment_id": 92885891, "body": "<code>Rows.Count</code> refers to the active sheet only. Not that it&#39;ll be different for each sheet but if you want to be explicit there should be a sheet object before <code>Rows</code>"}], "tags": [], "owner": {"reputation": 79, "user_id": 8748581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4874ca1a6ac350e7545bb83b5a41240c?s=128&d=identicon&r=PG&f=1", "display_name": "Reece", "link": "https://stackoverflow.com/users/8748581/reece"}, "is_accepted": true, "score": 1, "last_activity_date": 1540473420, "last_edit_date": 1540473420, "creation_date": 1540319850, "answer_id": 52955803, "question_id": 52955419, "link": "https://stackoverflow.com/questions/52955419/how-can-i-apply-this-vba-concatenate-to-all-worksheets/52955803#52955803", "title": "How can i apply this VBA concatenate to all worksheets?", "body": "<p>Edit: I misunderstood. This would apply to all worksheets.</p>\n\n<pre><code>Dim l as Long, lRow as Long\nFor Each ws in Activeworkbook.Worksheets\n  With Sheets(ws)\n    lRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For l = 2 To lRow\n        Sheets(\"Sheet1\").Cells(l, 3) = .Cells(l, 1) &amp; \" \" &amp; .Cells(l, 2)\n    Next l\nEnd With\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>Use this code to apply to the active worksheet only</p>\n\n<pre><code>Sub Concatenate()\n\n' Concatenate two columns\nDim l As Long, lRow As Long\nWith ActiveSheet\n    lRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n    For l = 2 To lRow\n        ActiveSheet.Cells(l, 3) = .Cells(l, 1) &amp; \" \" &amp; .Cells(l, 2)\n    Next l\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 10442755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f935cb080ed82d3ef574687457898a5c?s=128&d=identicon&r=PG&f=1", "display_name": "Alvi", "link": "https://stackoverflow.com/users/10442755/alvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 52955803, "answer_count": 1, "score": 0, "last_activity_date": 1586756139, "creation_date": 1540318576, "last_edit_date": 1586756139, "question_id": 52955419, "link": "https://stackoverflow.com/questions/52955419/how-can-i-apply-this-vba-concatenate-to-all-worksheets", "title": "How can i apply this VBA concatenate to all worksheets?", "body": "<p>I want to use this code on Active sheet instead of Sheet 1?</p>\n\n<pre><code>Sub Concatenate()\n\n' Concatenate two columns\n    Dim l As Long, lRow As Long\n    With Sheets(\"Sheet1\")\n        lRow = .Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n        For l = 2 To lRow\n            Sheets(\"Sheet1\").Cells(l, 3) = .Cells(l, 1) &amp; \" \" &amp; .Cells(l, 2)\n        Next l\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1540329096, "post_id": 52955394, "comment_id": 92823181, "body": "If you want each record to go to a new page, you wouldn&#39;t be using a label merge, which is what your code employs, via <i>oDoc.MailMerge.MainDocumentType = wdMailingLabels</i>. But then, you also wouldn&#39;t be using code like <i>oWord.Dialogs(wdDialogLabelOptions).Show</i> or <i>oWord.WordBasic.mailmergepropagatelabel</i>. You need to give a better explanation of what you&#39;re trying to do."}, {"owner": {"reputation": 1, "user_id": 10547884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7ea48b3d680431602bc62d7e163494?s=128&d=identicon&r=PG&f=1", "display_name": "SSJErito", "link": "https://stackoverflow.com/users/10547884/ssjerito"}, "reply_to_user": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1540406538, "post_id": 52955394, "comment_id": 92858391, "body": "Hi macropod, What my code currently does is transport data from the sheet to one page in the document in the form of a mail merge. Since it&#39;s mostly just name labels and addresses, I was hoping if there is a way to put the labels from each row on a different page in the same document."}, {"owner": {"reputation": 1, "user_id": 10547884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7ea48b3d680431602bc62d7e163494?s=128&d=identicon&r=PG&f=1", "display_name": "SSJErito", "link": "https://stackoverflow.com/users/10547884/ssjerito"}, "reply_to_user": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "edited": false, "score": 0, "creation_date": 1540406618, "post_id": 52955394, "comment_id": 92858425, "body": "I am definitely open to new methods of doing this, this was just something I found online and edited a bit. Thanks in advance"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1540475173, "post_id": 52955394, "comment_id": 92886951, "body": "Do you want a full sheet of labels for each address? Then try this (no VBA involved): Alt+F9 in the main merge document to display the field codes. Remove the { NEXT } field from the second and all following labels. That should repeat the same address on the one sheet, and the next address on a new sheet, etc."}], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1540416492, "creation_date": 1540416492, "answer_id": 52978140, "question_id": 52955394, "link": "https://stackoverflow.com/questions/52955394/mail-merge-macro-how-to-send-data-from-each-row-in-my-excel-sheet-to-different/52978140#52978140", "title": "Mail Merge Macro: How to send data from each row in my Excel sheet to different pages on Word?", "body": "<p>What you need to do is create a mailmerge main document with a single label containing all the mergefields required for that label, rather than a sheet of labels, and combine that with an ordinary letter merge. Having created the mailmerge main document with a single label, you can then use code like the following:</p>\n\n<pre><code>Sub RunMerge()\n'Note: this code requires a reference to the Word object model\nApplication.ScreenUpdating = False\nDim wdApp As New Word.Application, wdDoc As Word.Document\nDim StrMMSrc As String, StrMMDoc As String\nStrMMSrc = ThisWorkbook.FullName\nStrMMDoc = ThisWorkbook.Path &amp; \"\\MailMergeMainDocument.doc\"\nWith wdApp\n  .Visible = True\n  .DisplayAlerts = wdAlertsNone\n  Set wdDoc = .Documents.Open(Filename:=StrMMDoc, AddToRecentFiles:=False, ReadOnly:=True, Visible:=False)\n  With wdDoc\n    With .MailMerge\n      .MainDocumentType = wdFormLetters\n      .OpenDataSource Name:=StrMMSrc, ReadOnly:=True, AddToRecentFiles:=False, _\n        LinkToSource:=False, Connection:=\"Provider=Microsoft.ACE.OLEDB.12.0;User ID=Admin;\" &amp; _\n        \"Data Source=StrMMSrc;Mode=Read;Extended Properties=\"\"HDR=YES;IMEX=1\"\";\", _\n        SQLStatement:=\"SELECT * FROM `Sheet1$`\"\n      .Destination = wdSendToNewDocument\n      .SuppressBlankLines = True\n      .Execute Pause:=False\n    End With\n    .Close SaveChanges:=False\n  End With\n  .DisplayAlerts = wdAlertsAll\n  .Activate\nEnd With\nSet wdDoc = Nothing: Set wdApp = Nothing\nApplication.ScreenUpdating = False\nEnd Sub\n</code></pre>\n\n<p>Naturally, you may need to edit the 'StrMMDoc' variable to suit your setup &amp; document name and, perhaps, edit the SQL Statement:</p>\n\n<p>SQLStatement:=\"SELECT * FROM <code>Sheet1$</code>\"</p>\n\n<p>to reference the correct worksheet.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10547884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7ea48b3d680431602bc62d7e163494?s=128&d=identicon&r=PG&f=1", "display_name": "SSJErito", "link": "https://stackoverflow.com/users/10547884/ssjerito"}, "is_accepted": false, "score": 0, "last_activity_date": 1540576473, "creation_date": 1540576473, "answer_id": 53013991, "question_id": 52955394, "link": "https://stackoverflow.com/questions/52955394/mail-merge-macro-how-to-send-data-from-each-row-in-my-excel-sheet-to-different/53013991#53013991", "title": "Mail Merge Macro: How to send data from each row in my Excel sheet to different pages on Word?", "body": "<p>Thank you for your suggestions, I did however find something close to what I was looking for, here is the link for those of you that are curious to know: <a href=\"https://www.youtube.com/watch?v=URF3ikW0Svc\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=URF3ikW0Svc</a> </p>\n"}], "owner": {"reputation": 1, "user_id": 10547884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d7ea48b3d680431602bc62d7e163494?s=128&d=identicon&r=PG&f=1", "display_name": "SSJErito", "link": "https://stackoverflow.com/users/10547884/ssjerito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1082, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1540576473, "creation_date": 1540318493, "last_edit_date": 1540475102, "question_id": 52955394, "link": "https://stackoverflow.com/questions/52955394/mail-merge-macro-how-to-send-data-from-each-row-in-my-excel-sheet-to-different", "title": "Mail Merge Macro: How to send data from each row in my Excel sheet to different pages on Word?", "body": "<p>I have been working on a macro that adds data to a page on Word in the form of a Mail Merge label. I found a code online that gets all the data into one page on Word. I was wondering if there is a way that the data from each row in my Excel Spreadsheet could go to different pages in Word? The code is given below.</p>\n\n<pre><code>Sub LabelMerge()\n\n   Dim oWord As Word.Application, oDoc As Word.Document\n   Dim sPath As String, I As Integer, oHeaders As Range\n\nApplication.ScreenUpdating = False\n\n   Set oHeaders = Range(\"A1\").CurrentRegion.Rows(1)\n   sPath = ThisWorkbook.FullName\n   Set oWord = CreateObject(\"Word.Application\")\n   Set oDoc = oWord.Documents.Add\n   oWord.Visible = True\n   oDoc.MailMerge.MainDocumentType = wdMailingLabels\n   oWord.Dialogs(wdDialogLabelOptions).Show\n   oDoc.Activate\n\n   With oDoc.MailMerge.Fields\n\n     For I = 1 To oHeaders.Columns.Count\n       .Add oWord.Selection.Range, oHeaders.Cells(1, I)\n       oWord.Selection.TypeText \" \"\n     Next I\n\n   End With\n\n   oDoc.MailMerge.OpenDataSource sPath\n   oWord.WordBasic.mailmergepropagatelabel\n   oDoc.MailMerge.ViewMailMergeFieldCodes = False\n   oDoc.ActiveWindow.View.ShowFieldCodes = False\n\n   Set oDoc = Nothing\n   Set oWord = Nothing\n\n   Application.ScreenUpdating = True\n\n   End Sub\n</code></pre>\n\n<p>This is how the data looks like before and after the code is run from the VBA Editor. I am fairly new to VBA and would appreciate any help!</p>\n\n<p>Sample Data in Excel</p>\n\n<p><a href=\"https://i.stack.imgur.com/QVjZ4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QVjZ4.png\" alt=\"enter image description here\"></a></p>\n\n<p>Labels on Word</p>\n\n<p><a href=\"https://i.stack.imgur.com/pPm4U.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pPm4U.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1540316398, "post_id": 52954787, "comment_id": 92817461, "body": "If you add <code>Option Explicit</code> to the top of the module, it&#39;ll cause errors at run time when it sees undeclared variables (Variables without a <code>Dim</code> line). This can be helpful for catching things like typos, or forgetting the quotation marks for strings, etc."}], "answers": [{"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1540321271, "post_id": 52954861, "comment_id": 92819800, "body": "I haven&#39;t been able to get the drop down selected value, to be compared to a string, from <code>Set X = ActiveSheet.Shapes(&quot;Drop Down 95&quot;).ControlFormat</code>. How did you?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 4, "last_activity_date": 1540316270, "creation_date": 1540316270, "answer_id": 52954861, "question_id": 52954787, "link": "https://stackoverflow.com/questions/52954787/why-doesnt-my-combobox-macro-work-when-the-input-range-is-a-string/52954861#52954861", "title": "Why doesn&#39;t my combobox macro work when the input range is a string?", "body": "<p>Replace:</p>\n\n<pre><code> If X = Matrix Then\n</code></pre>\n\n<p>with</p>\n\n<pre><code> If X = \"Matrix\" Then\n</code></pre>\n\n<p>etc.</p>\n"}, {"tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": false, "score": 3, "last_activity_date": 1540316802, "creation_date": 1540316802, "answer_id": 52954984, "question_id": 52954787, "link": "https://stackoverflow.com/questions/52954787/why-doesnt-my-combobox-macro-work-when-the-input-range-is-a-string/52954984#52954984", "title": "Why doesn&#39;t my combobox macro work when the input range is a string?", "body": "<p>I really hate adding a new answer when Gary summed it up well, but just to add another option for the sake of improved readability, <code>Select Case</code> would work well here.</p>\n\n<pre><code>Select Case X\nCase \"Matrix\"\n    Hide_Matrix\nCase \"Radar\"\n    Hide_Radar\nCase \"Goal Ranks\"\n    Hide_Goal_Ranks\nCase \"Goal Breakdown\"\n    Hide_Goal_Ranks_bd\nCase \"KPI Values\"\n    Hide_KPI_Values\nCase \"Goal Ratios\"\n    Hide_Goal_Ratio\nCase \"KPI Ratios\"\n    Hide_KPI_Ratio\nCase \"Unitized Ratios\"\n    Hide_Unitized_Ratio\nEnd Select\n</code></pre>\n\n<p><code>Select Case</code> works well for readability because you are comparing the <em>same variable</em>, where you can quickly gather by looking at the case that each one is referring to <code>x</code>.</p>\n\n<p>In an <code>If...Then</code> statement, you have to read line-by-line, thus making you read more and also having an increased chance for errors.</p>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 3, "last_activity_date": 1540321118, "creation_date": 1540321118, "answer_id": 52956127, "question_id": 52954787, "link": "https://stackoverflow.com/questions/52954787/why-doesnt-my-combobox-macro-work-when-the-input-range-is-a-string/52956127#52956127", "title": "Why doesn&#39;t my combobox macro work when the input range is a string?", "body": "<p>you could use <code>Application.Run</code> method and feed it with chosen sub name taken from drop down <em>input range</em> (obtained from <code>ControlFormat</code> <code>ListFillRange</code> property) selected cell (obtained from <code>ControlFormat</code> <code>ListIndex</code> property):</p>\n\n<pre><code>Sub Hide_Charts_Combobox()\n    Dim X As ControlFormat\n    Set X = ActiveSheet.Shapes(\"Drop Down 95\").ControlFormat\n\n    Application.Run \"Hide_\" &amp; Range(X.ListFillRange).Offset(X.ListIndex - 1).Resize(1).Value\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10547726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5a3a4845194dd597f85f277cce22dd2?s=128&d=identicon&r=PG&f=1", "display_name": "Beshr", "link": "https://stackoverflow.com/users/10547726/beshr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1586756149, "creation_date": 1540315923, "last_edit_date": 1586756149, "question_id": 52954787, "link": "https://stackoverflow.com/questions/52954787/why-doesnt-my-combobox-macro-work-when-the-input-range-is-a-string", "title": "Why doesn&#39;t my combobox macro work when the input range is a string?", "body": "<p>I want different macros to run when different items are selected in my Excel sheet combobox. This works perfectly fine when the input range is an integer (see VBA code below).</p>\n\n<pre><code>Sub Hide_Charts_Combobox()\n'\n' Hide_Charts_Combobox\n'\n    Dim X As ControlFormat\n    Set X = ActiveSheet.Shapes(\"Drop Down 95\").ControlFormat\n    If X = 1 Then\n    Hide_Matrix\n    ElseIf X = 2 Then\n    Hide_Radar\n    ElseIf X = 3 Then\n    Hide_Goal_Ranks\n    ElseIf X = 4 Then\n    Hide_Goal_Ranks_bd\n    ElseIf X = 5 Then\n    Hide_KPI_Values\n    ElseIf X = 6 Then\n    Hide_Goal_Ratio\n    ElseIf X = 7 Then\n    Hide_KPI_Ratio\n    ElseIf X = 8 Then\n    Hide_Unitized_Ratio\n    End If\n'\nEnd Sub\n</code></pre>\n\n<p>However, I don't want my combobox input range to be numbers; I want certain words instead. When I replace the inputs by strings, the macro simply does not run (no errors appear either). This is the actual code I want to use (and which is currently not working):</p>\n\n<pre><code>Sub Hide_Charts_Combobox()\n'\n' Hide_Charts_Combobox\n'\n    Dim X As ControlFormat\n    Set X = ActiveSheet.Shapes(\"Drop Down 95\").ControlFormat\n    If X = Matrix Then\n    Hide_Matrix\n    ElseIf X = Radar Then\n    Hide_Radar\n    ElseIf X = Goal Ranks Then\n    Hide_Goal_Ranks\n    ElseIf X = Goal Breakdown Then\n    Hide_Goal_Ranks_bd\n    ElseIf X = KPI Values Then\n    Hide_KPI_Values\n    ElseIf X = Goal Ratios Then\n    Hide_Goal_Ratio\n    ElseIf X = KPI Ratios Then\n    Hide_KPI_Ratio\n    ElseIf X = Unitized Ratios Then\n    Hide_Unitized_Ratio\n    End If\n'\nEnd Sub\n</code></pre>\n\n<p>I suspect it has something to do with Dim X being defined as a ControlFormat which cannot hold a string, but I'm not sure. What should I do to make it work?</p>\n"}]