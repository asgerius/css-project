[{"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1577836172, "creation_date": 1577836172, "answer_id": 59549184, "question_id": 59549009, "link": "https://stackoverflow.com/questions/59549009/run-macro-on-change-within-target-range-change-byval-target-as-range/59549184#59549184", "title": "Run macro on change within target range | Change (ByVal Target As Range)", "body": "<p>You can accomplish this by toggling events off and on, like the following:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Intersect(Target, Me.Range(\"A1:A2\")) Is Nothing Then Exit Sub\n\n    On Error GoTo SafeExit\n    Application.EnableEvents = False\n\n    If Target.Address = \"$A$1\" Then\n        Me.Range(\"A2\").Clear\n    ElseIf Target.Address = \"$A$2\" Then\n        Me.Range(\"A1\").Clear\n    End If\n\nSafeExit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1577842208, "creation_date": 1577842208, "answer_id": 59549482, "question_id": 59549009, "link": "https://stackoverflow.com/questions/59549009/run-macro-on-change-within-target-range-change-byval-target-as-range/59549482#59549482", "title": "Run macro on change within target range | Change (ByVal Target As Range)", "body": "<p>There are a few edge cases here, around changing more than one cell eg via copy pasting a range (possibly include other cells too).</p>\n\n<p>Here's a version thats more robust in those cases</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim rng As Range\n    Set rng = Intersect(Target, Me.Range(\"A1:A2\"))\n    If rng Is Nothing Then Exit Sub\n\n    On Error GoTo SafeExit\n    Application.EnableEvents = False\n\n    Select Case rng.Address(0, 0)\n        ' If both changed, what now? Default to clearing A2\n        Case \"A1\", \"A1:A2\"\n            If Not IsEmpty(Me.Cells(1, 1)) Then\n                Me.Cells(2, 1).Clear\n            End If\n        Case \"A2\"\n            If Not IsEmpty(Me.Cells(2, 1)) Then\n                Me.Cells(1, 1).Clear\n            End If\n    End Select\n\nSafeExit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 594, "user_id": 12634230, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PjhLmvrT18I/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVhLt0VYANWIiWwH9yeHhZw9LVqQ/photo.jpg?sz=128", "display_name": "P.b", "link": "https://stackoverflow.com/users/12634230/p-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 0, "accepted_answer_id": 59549184, "answer_count": 2, "score": 0, "last_activity_date": 1577842208, "creation_date": 1577833109, "last_edit_date": 1577841363, "question_id": 59549009, "link": "https://stackoverflow.com/questions/59549009/run-macro-on-change-within-target-range-change-byval-target-as-range", "title": "Run macro on change within target range | Change (ByVal Target As Range)", "body": "<p>I'm working with the <code>Worksheet_Change(ByVal Target As Range)</code> event.</p>\n\n<p>I wanted to run a macro if either on of cells <code>A1</code> or <code>A2</code> are changed.\nSo the target range is set to <code>[A1, A2]</code></p>\n\n<p>Then, if <code>A1</code> is changed, I want to clear <code>A2</code>, or the other way around (<code>A2</code> is changed: clear <code>A1</code>).</p>\n\n<p>Now the problem:</p>\n\n<p>If <code>A1</code> value is changed. the macro clears <code>A2</code>. That's seen as a change in <code>A2</code>, so it clears <code>A1</code>, which is a change, etc...</p>\n\n<p>I'm sure it's something simple, but I can't see how I can have cell <code>A1</code> be changed without triggering the change macro if <code>A2</code> is being cleared.</p>\n\n<p>Anyone who has experience in this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1577832048, "post_id": 59548796, "comment_id": 105266879, "body": "Why don&#39;t you post your full code. The example you have is meaningless."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1577832483, "post_id": 59548796, "comment_id": 105266965, "body": "see: <a href=\"https://stackoverflow.com/questions/24353024/setting-color-to-a-comments-characters-in-vba\" title=\"setting color to a comments characters in vba\">stackoverflow.com/questions/24353024/&hellip;</a>"}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "edited": false, "score": 0, "creation_date": 1577832758, "post_id": 59548796, "comment_id": 105267017, "body": "But how do I get the size of the chunk of text that his highlighted while still editing the comment?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1577832822, "post_id": 59548796, "comment_id": 105267029, "body": "You can&#39;t  Vba will not run while in edit mode."}, {"owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "edited": false, "score": 0, "creation_date": 1577832874, "post_id": 59548796, "comment_id": 105267034, "body": "Is there a way to hijack keyboard shortcuts like ctrl-5 to have more functionality than just adding a strikethrough?  I&#39;m able to strikethrough selected text while still in edit mode but to change color I&#39;d have to do more stuff."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1577834206, "post_id": 59548796, "comment_id": 105267202, "body": "FWIW, the new (ish) <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.commentthreaded?f1url=https%3A%2F%2Fmsdn.microsoft.com%2Fquery%2Fdev11.query%3FappId%3DDev11IDEF1%26l%3Den-US%26k%3Dk(vbaxl10.chm1009072)%3Bk(TargetFrameworkMoniker-Office.Version%3Dv16)%26rd%3Dtrue\" rel=\"nofollow noreferrer\">Threaded Comments</a> feature allows VBA to run while the comment editor is open.  However I cannot find a way to interact with the editor, maybe someone else can"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12640413, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/d06f86c65d2b7ec40dd0e5f9bad520d3?s=128&d=identicon&r=PG", "display_name": "Ashish Gupta", "link": "https://stackoverflow.com/users/12640413/ashish-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1577966439, "last_edit_date": 1577966439, "creation_date": 1577960491, "answer_id": 59561680, "question_id": 59548796, "link": "https://stackoverflow.com/questions/59548796/how-do-i-refer-to-highlighted-text-in-an-excel-comment/59561680#59561680", "title": "How do I refer to highlighted text in an Excel comment?", "body": "<p>Please try the following code:</p>\n\n<pre><code>Sub TaskFinished()\n   With Selection.Font\n    .Strikethrough = True\n    .Color = rgbGreen\n  End With\nMsgBox (\"Ran macro!\")\nEnd Sub\n</code></pre>\n\n<p>'use rgb for color coding</p>\n"}], "owner": {"reputation": 189, "user_id": 5221310, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2838fa0055eb15c38ba2dd372c6ae68d?s=128&d=identicon&r=PG&f=1", "display_name": "Aaron Parisi", "link": "https://stackoverflow.com/users/5221310/aaron-parisi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577966439, "creation_date": 1577830594, "last_edit_date": 1577832305, "question_id": 59548796, "link": "https://stackoverflow.com/questions/59548796/how-do-i-refer-to-highlighted-text-in-an-excel-comment", "title": "How do I refer to highlighted text in an Excel comment?", "body": "<p>I have a macro that runs when I press ctrl-d.  It should turn the selected text green and make it strikethrough.</p>\n\n<p>However I want it to apply to selected text in a comment, not the text in the cell itself.</p>\n\n<p>If I say:</p>\n\n<pre><code>Sub TaskFinished()\n    With Selection.Font\n        .Strikethrough = True\n        .Color = Green\n    End With\n    MsgBox (\"Ran macro!\")\nEnd Sub\n</code></pre>\n\n<p>it works for the text in the cell (color doesn't work but I can figure that out later), but only if the cell is selected (as opposed to being in F2 edit mode).</p>\n\n<p>The message box only appears when I am not in edit mode.  Seems a macro can't even be triggered in edit mode at all?</p>\n"}, {"tags": ["excel", "vba", "ms-word"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1577831799, "post_id": 59548688, "comment_id": 105266836, "body": "Please edit the question with the code you&#39;ve tried in Excel and describe exactly how &quot;that doesn&#39;t work&quot;. The same basic approach should work, but &quot;the devil is in the details&quot; - you need to show us the details..."}, {"owner": {"reputation": 35, "user_id": 7978741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AqyrzuDZ7bM/AAAAAAAAAAI/AAAAAAAAABE/iRlBQUSszXc/photo.jpg?sz=128", "display_name": "RLee", "link": "https://stackoverflow.com/users/7978741/rlee"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1577832883, "post_id": 59548688, "comment_id": 105267035, "body": "Thanks Cindy - I just updated the question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11818836"}, "edited": false, "score": 1, "creation_date": 1577842156, "post_id": 59548688, "comment_id": 105268100, "body": "Don&#39;t forget to describe what goes wrong - does Word display an error, or does nothing apparently happen? (Here, the objDoc.SelectContentControlsByTitle(&quot;control&quot;).Item(1).Range&zwnj;&#8203;.Text = &quot;...&quot; line works fine."}], "answers": [{"tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": false, "score": 1, "last_activity_date": 1577831672, "creation_date": 1577831672, "answer_id": 59548882, "question_id": 59548688, "link": "https://stackoverflow.com/questions/59548688/vba-using-excel-2016-to-populate-word-2016-content-controls/59548882#59548882", "title": "VBA Using Excel 2016 to Populate Word 2016 Content Controls", "body": "<p>In any macro, but especially in cross-program macros, avoid using the Selection object and use <strong>Range</strong> object instead. Sometimes using the range object requires a slightly less direct route to accessing the control, such as having to poll all content controls to find which one has the correct title:</p>\n\n<pre><code>Sub SetCCText()\n    Dim CC As ContentControl\n    For Each CC In ActiveDocument.ContentControls\n        If CC.Title = \"control\" Then\n            CC.Range.Text = \"Text\"\n        End If\n    Next CC\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 7978741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AqyrzuDZ7bM/AAAAAAAAAAI/AAAAAAAAABE/iRlBQUSszXc/photo.jpg?sz=128", "display_name": "RLee", "link": "https://stackoverflow.com/users/7978741/rlee"}, "edited": false, "score": 0, "creation_date": 1577979316, "post_id": 59552518, "comment_id": 105299793, "body": "I tried the early binding method you presented but it still doesn&#39;t seem to work. I get &quot;Compile Error: User-Defined type not recognized&quot; when I attempt to run the function."}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "reply_to_user": {"reputation": 35, "user_id": 7978741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AqyrzuDZ7bM/AAAAAAAAAAI/AAAAAAAAABE/iRlBQUSszXc/photo.jpg?sz=128", "display_name": "RLee", "link": "https://stackoverflow.com/users/7978741/rlee"}, "edited": false, "score": 0, "creation_date": 1577996289, "post_id": 59552518, "comment_id": 105306765, "body": "When using early binding you need to set a reference to the library you wish to use. From the tools menu select References then find the library you wish to use in the list. Or, be consistent and just use late binding as you have with your other object variables."}, {"owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "reply_to_user": {"reputation": 35, "user_id": 7978741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AqyrzuDZ7bM/AAAAAAAAAAI/AAAAAAAAABE/iRlBQUSszXc/photo.jpg?sz=128", "display_name": "RLee", "link": "https://stackoverflow.com/users/7978741/rlee"}, "edited": false, "score": 0, "creation_date": 1577996818, "post_id": 59552518, "comment_id": 105306946, "body": "For more information see <a href=\"https://stackoverflow.com/questions/50293956/convert-early-binding-code-to-late-binding\" title=\"convert early binding code to late binding\">stackoverflow.com/questions/50293956/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3865, "user_id": 5211752, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9hLRL.png?s=128&g=1", "display_name": "Timothy Rylatt", "link": "https://stackoverflow.com/users/5211752/timothy-rylatt"}, "is_accepted": true, "score": 1, "last_activity_date": 1577881814, "creation_date": 1577881814, "answer_id": 59552518, "question_id": 59548688, "link": "https://stackoverflow.com/questions/59548688/vba-using-excel-2016-to-populate-word-2016-content-controls/59552518#59552518", "title": "VBA Using Excel 2016 to Populate Word 2016 Content Controls", "body": "<p>Although you have declared <code>ctrl</code> as a <code>ContentControl</code> it is not a Word content control, which is why the <code>For Each</code> loop won't work.</p>\n\n<p>If you want to use early binding you need to specify the library that the object type belongs to in the variable declaration. Some libraries have objects with the same name but which are completely different.</p>\n\n<pre><code>Dim ctrl As Word.ContentControl\n</code></pre>\n\n<p>NB: You should also create a document from the Word template rather than edit the template directly:</p>\n\n<pre><code>Set objDoc = objWord.Documents.Add(ThisWorkbook.Path &amp; \"\\MyDoc.dotm\")\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 7978741, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AqyrzuDZ7bM/AAAAAAAAAAI/AAAAAAAAABE/iRlBQUSszXc/photo.jpg?sz=128", "display_name": "RLee", "link": "https://stackoverflow.com/users/7978741/rlee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "accepted_answer_id": 59552518, "answer_count": 2, "score": -1, "last_activity_date": 1577982857, "creation_date": 1577829159, "last_edit_date": 1577982857, "question_id": 59548688, "link": "https://stackoverflow.com/questions/59548688/vba-using-excel-2016-to-populate-word-2016-content-controls", "title": "VBA Using Excel 2016 to Populate Word 2016 Content Controls", "body": "<p>I'm attempting to populate a Word.dotm document that has content control text boxes using Excel. </p>\n\n<p>In Excel, I create the word objects and open the file, but I can't figure out how to actually access the controls. </p>\n\n<p>In the Word doc's VBA, I can access them via </p>\n\n<p><code>.SelectContentControlsByTitle(\"control\").Item(1).Range.Text = \"...\"</code> </p>\n\n<p>but that doesn't work using an Object in Excel..</p>\n\n<p>Here's the code I've tried in Excel:</p>\n\n<pre><code>Dim objWord         As Object\nDim objDoc          As Object\nDim objSelection    As Object\nDim ctrl            As Word.ContentControl\n\nSet objWord = CreateObject(\"Word.Application\")\n\nSet objDoc = objWord.Documents.Add(ThisWorkbook.Path &amp; \"\\MyDoc.dotm\")\n\nobjWord.Visible = True\n\nSet objSelection = objWord.Selection\n\n'Doesn't work\nobjDoc.SelectContentControlsByTitle(\"control\").Item(1).Range.Text = \"...\"        \n\n'Doesn't work either, but tried nonetheless\nFor Each ctrl In objDoc.contentcontrols\n    If ctrl.Title = \"control\" Then\n        ctrl.Range.Text = \"!\"\n        Exit For\n    End If\n Next ctrl\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>I didn't have the MS Word 16.0 Object Library referenced... the early binding and the tip to copy the template file rather than altering it directly mentioned by Timothy Rylatt now works and John Korchok's For Each loop works as well. Their additions have been added to the code above. Thank you!</p>\n"}, {"tags": ["excel", "vba", "range", "comparison"], "comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1577827914, "post_id": 59548563, "comment_id": 105266177, "body": "Only the last line is &quot;working &quot; because each line overwrites the previous one.  Write a single formula that achieves your requirements and write that to the sheet once"}, {"owner": {"reputation": 13, "user_id": 12634013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0654614f7dc99a3a022c9d55c4cc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Ang", "link": "https://stackoverflow.com/users/12634013/ang"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1577827951, "post_id": 59548563, "comment_id": 105266180, "body": "I\u2019m sorry, I\u2019m posting this on my phone. I\u2019ll try and clean it up a little."}], "answers": [{"comments": [{"owner": {"reputation": 31052, "user_id": 4280, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bc588d9f099467ce6bc6fc68426119aa?s=128&d=identicon&r=PG", "display_name": "Dick Kusleika", "link": "https://stackoverflow.com/users/4280/dick-kusleika"}, "edited": false, "score": 0, "creation_date": 1577828268, "post_id": 59548595, "comment_id": 105266222, "body": "Here&#39;s another formula option: <code>Range(&quot;J6:J1447&quot;).FormulaR1C1 = &quot;=CHOOSE(RC[-1],&quot;&quot;Annually&quot;&quot;,&quot;&quot;Semi-annually&quot;&quot;,&quot;&quot;&quot;&quot;,&quot;&quot;Quarte&zwnj;&#8203;rly&quot;&quot;,&quot;&quot;&quot;&quot;,&quot;&quot;&quot;&quot;,&quot;&quot;&quot;&quot;&zwnj;&#8203;,&quot;&quot;&quot;&quot;,&quot;&quot;&quot;&quot;,&quot;&quot;&quot;&quot;,&quot;&quot;&quot;&quot;&zwnj;&#8203;,&quot;&quot;Monthly&quot;&quot;)&quot;</code>"}, {"owner": {"reputation": 13, "user_id": 12634013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0654614f7dc99a3a022c9d55c4cc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Ang", "link": "https://stackoverflow.com/users/12634013/ang"}, "edited": false, "score": 0, "creation_date": 1577828479, "post_id": 59548595, "comment_id": 105266256, "body": "Holy crap I feel like an idiot. Thank you, this worked."}], "tags": [], "owner": {"reputation": 191, "user_id": 11947129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f80370ac301768f3fb202f013b49223?s=128&d=identicon&r=PG&f=1", "display_name": "jsteurer", "link": "https://stackoverflow.com/users/11947129/jsteurer"}, "is_accepted": true, "score": 1, "last_activity_date": 1577831041, "last_edit_date": 1577831041, "creation_date": 1577828001, "answer_id": 59548595, "question_id": 59548563, "link": "https://stackoverflow.com/questions/59548563/using-vba-to-convert-integers-into-text/59548595#59548595", "title": "Using VBA to Convert Integers into Text", "body": "<pre><code>Range(\"J6:J1447\").formular1c1-\"=if(rc[-1]=1,\"\"ANNUALLY\"\",if(rc[-1]=2,\"\"SEMI-ANNUALLY\"\",if(rc[-1]=4,\"\"QUARTERLY\"\",if(rc[-1]=12,\"\"MONTHLY\"\",\"\"\"\"))))\"\n</code></pre>\n\n<p>You could also do an Last row option to not limit yourself with your range. </p>\n"}], "owner": {"reputation": 13, "user_id": 12634013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b0654614f7dc99a3a022c9d55c4cc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Ang", "link": "https://stackoverflow.com/users/12634013/ang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 59548595, "answer_count": 1, "score": 1, "last_activity_date": 1577831041, "creation_date": 1577827604, "last_edit_date": 1577827831, "question_id": 59548563, "link": "https://stackoverflow.com/questions/59548563/using-vba-to-convert-integers-into-text", "title": "Using VBA to Convert Integers into Text", "body": "<p>I am trying to write a Vba that will take the numbers in one column and convert the numbers to text in another column. </p>\n\n<p>For example: </p>\n\n<p>4 will be \u201cquarterly\u201d, \n1 will be \u201cannually\u201d and 12 will be \u201cmonthly\u201d. </p>\n\n<p>This is what I wrote but only the last line is working. </p>\n\n<pre><code>Sub Convert ()\n\n    Range(\"J6:J1447\").Formula = \"If(I6:I299=1, (\"\"Annually\"\"), \"\"\"\")\"\n\n    Range(\"J6:J1447\").Formula = \"=If(I6:I299=2, (\"\"Semi-Annually\"\"), \"\"\"\")\"\n\n    Range(\"J6:J1447\").Formula = \"=If(I6:I299=4, (\"\"Quarterly\"\"), \"\"\"\")\"\n\n    Range(\"J6:J1447\").Formula = \"=If(I6:I299=12, (\"\"Monthly\"\"), \"\"\"\")\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12633943, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBqCL1HG860Mh69Y8IQkZ6zYpJN6FvXlwc4_d-Jp7c=k-s128", "display_name": "Chesky Kay", "link": "https://stackoverflow.com/users/12633943/chesky-kay"}, "is_accepted": true, "score": 0, "last_activity_date": 1579120203, "creation_date": 1579120203, "answer_id": 59759118, "question_id": 59548361, "link": "https://stackoverflow.com/questions/59548361/looking-to-populate-in-an-email-a-table-with-the-headers-in-the-left-column-and/59759118#59759118", "title": "Looking to populate in an email a table with the headers in the left column and listing all the rows in the columns", "body": "<p>Managed to work it out with using some arrays to help in the work of looping, instead of using the record set </p>\n\n<pre><code>Public Function fHTMLBodyTablevertical(objRst As Object, Optional intBorder As Integer = 1) As String\n\n    Dim strHTML As String\n    Dim varFld\n\n    Dim vDat          As Variant\n    objRst.MoveFirst\n    vDat = objRst.GetRows\n\n    Dim vhdr() As Variant\n    ReDim vhdr(UBound(vDat, 1))\n\n     i = 0\n     For Each varFld In objRst.Fields\n\n     vhdr(i) = StrConv(Replace(varFld.Name, \"_\", \" \"), vbProperCase)\n         i = i + 1\n     Next\n\n    strHTML = \"&lt;table id=\"\"vertical -1\"\" border='\" &amp; intBorder &amp; \"'&gt;\" '&lt;tr&gt;\n\n    Dim d As Integer, u As Integer\n\n    d = 0: u = 0\n\n    For d = 0 To UBound(vDat, 1)\n    strHTML = strHTML &amp; \"&lt;tr&gt;\"\n    strHTML = strHTML &amp; \"&lt;th&gt;\" &amp; vhdr(d) &amp; \"&lt;/th&gt;\"\n        For u = 0 To UBound(vDat, 2)\n            strHTML = strHTML &amp; \"&lt;td&gt;\" &amp; vDat(d, u) &amp; \"&lt;/td&gt;\"\n        Next u\n\n    Next d\n\n         'Debug.Print strHTML\n    strHTML = strHTML &amp; \"&lt;/table&gt;\"\n\n    fHTMLBodyTablevertical = strHTML\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12633943, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBqCL1HG860Mh69Y8IQkZ6zYpJN6FvXlwc4_d-Jp7c=k-s128", "display_name": "Chesky Kay", "link": "https://stackoverflow.com/users/12633943/chesky-kay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 59759118, "answer_count": 1, "score": 0, "last_activity_date": 1579120203, "creation_date": 1577825551, "last_edit_date": 1577828594, "question_id": 59548361, "link": "https://stackoverflow.com/questions/59548361/looking-to-populate-in-an-email-a-table-with-the-headers-in-the-left-column-and", "title": "Looking to populate in an email a table with the headers in the left column and listing all the rows in the columns", "body": "<p>i have a function that runs a report from our tables and then returns it into an email and sends it to me. </p>\n\n<p>the results can sometimes return more then one row. and my goal is to be able to list the headers in the first column and then the data should be on the right row per column, below is the code that I am using, </p>\n\n<p>this works well for one record, as once it returns more then one record it will repeat the headers in the first column and list the second row of information in the same column, instead of adding a new column. </p>\n\n<pre><code>Public Function fHTMLBodyTablevertical(objRst As Object, Optional intBorder As Integer = 1) As String\n\n    Dim strHTML As String\n    Dim varFld\n\n    strHTML = \"&lt;table id=\"\"vertical -1\"\" border='\" &amp; intBorder &amp; \"'&gt;\" '&lt;tr&gt;\n\n    Do Until objRst.EOF\n\n\n        For Each varFld In objRst.Fields\n\n            strHTML = strHTML &amp; \"&lt;tr&gt;\"\n            strHTML = strHTML &amp; \"&lt;th&gt;\" &amp; StrConv(Replace(varFld.Name, \"_\", \" \"), vbProperCase) &amp; \"&lt;/th&gt;\"\n            strHTML = strHTML &amp; \"&lt;td&gt;\" &amp; varFld.Value &amp; \"&lt;/td&gt;\"\n            strHTML = strHTML &amp; \"&lt;/tr&gt;\" &amp; vbCrLf\n         Debug.Print strHTML\n        Next\n\n        objRst.MoveNext\n    Loop\n    strHTML = strHTML &amp; \"&lt;/table&gt;\"\n\n    fHTMLBodyTablevertical = strHTML\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "hotkeys"], "comments": [{"owner": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1577821589, "post_id": 59547922, "comment_id": 105264918, "body": "Let me see if  I understand.  You say that the Macro runs, but it runs differently when you use the hot key. Is that correct?"}, {"owner": {"reputation": 167, "user_id": 7443269, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f0d01d07b39701d06f607a812b048093?s=128&d=identicon&r=PG&f=1", "display_name": "SkysLastChance", "link": "https://stackoverflow.com/users/7443269/skyslastchance"}, "reply_to_user": {"reputation": 312, "user_id": 5376832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/131cf551898d23800289731848abedbc?s=128&d=identicon&r=PG&f=1", "display_name": "Karlomanio", "link": "https://stackoverflow.com/users/5376832/karlomanio"}, "edited": false, "score": 0, "creation_date": 1577821811, "post_id": 59547922, "comment_id": 105264973, "body": "Correct. I have the macro saved in a module in another workbook though. I have a feeling that is what is causing the problem. I want the macro to work on all excel files I open though not just one workbook. So that is why I was saving it there."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1577822311, "post_id": 59547922, "comment_id": 105265061, "body": "If you are using two workbooks, you need to use explicit object references. Your code is currently defaulting to whatever workbook/worksheet is currently active and that is going to give weird results."}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1577822379, "post_id": 59547922, "comment_id": 105265071, "body": "This will be helpful as well: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 7443269, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f0d01d07b39701d06f607a812b048093?s=128&d=identicon&r=PG&f=1", "display_name": "SkysLastChance", "link": "https://stackoverflow.com/users/7443269/skyslastchance"}, "edited": false, "score": 0, "creation_date": 1577823107, "post_id": 59548072, "comment_id": 105265225, "body": "That is exactly what was happening. I thought it was kind of working too because Ctrl+Shift+L adds a filter. In reality it was never running too funny. Just my luck. Thank you!"}], "tags": [], "owner": {"reputation": 191, "user_id": 11947129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f80370ac301768f3fb202f013b49223?s=128&d=identicon&r=PG&f=1", "display_name": "jsteurer", "link": "https://stackoverflow.com/users/11947129/jsteurer"}, "is_accepted": true, "score": 3, "last_activity_date": 1577822648, "creation_date": 1577822648, "answer_id": 59548072, "question_id": 59547922, "link": "https://stackoverflow.com/questions/59547922/run-vba-macro-from-a-hotkey/59548072#59548072", "title": "Run VBA macro from a hotkey", "body": "<p>did you set the hotkeys? open up your macros (Alt+f8) go to options(for that macro) and set your ctrl+shift+L.\nalso, naming the module removes all hotkey function. </p>\n"}], "owner": {"reputation": 167, "user_id": 7443269, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f0d01d07b39701d06f607a812b048093?s=128&d=identicon&r=PG&f=1", "display_name": "SkysLastChance", "link": "https://stackoverflow.com/users/7443269/skyslastchance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 59548072, "answer_count": 1, "score": 0, "last_activity_date": 1582141690, "creation_date": 1577821278, "last_edit_date": 1582141690, "question_id": 59547922, "link": "https://stackoverflow.com/questions/59547922/run-vba-macro-from-a-hotkey", "title": "Run VBA macro from a hotkey", "body": "<p>I have this macro that formats my Excel sheet. It changes the color of the top row and adds a filter, freezes pane, etc.</p>\n\n<p>I have a personal workbook I saved it to, so I can use it in any Excel file I open. </p>\n\n<p>It works if I run the macro from the developer tab. If I try running it using a hotkey it does not work.</p>\n\n<p>The only thing that works when I use the hotkey is it will add a filter to the top row.</p>\n\n<pre><code>Sub FormatSheet()\n'\n' FormatSheet Macro\n'\n' Keyboard Shortcut: Ctrl+Shift+L\n\nWorksheets(1).Select\nRange(\"A1\").Select\nRange(Selection, Selection.End(xlToRight)).Select\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorDark1\n    .TintAndShade = -0.349986266670736\n    .PatternTintAndShade = 0\nEnd With\nSelection.AutoFilter\nWith ActiveWindow\n    .SplitColumn = 0\n    .SplitRow = 1\nEnd With\nActiveWindow.FreezePanes = True\nCells.Select\nWith Selection\n    .HorizontalAlignment = xlLeft\n    .VerticalAlignment = xlBottom\n    .WrapText = False\n    .Orientation = 0\n    .AddIndent = False\n    .IndentLevel = 0\n    .ShrinkToFit = False\n    .ReadingOrder = xlContext\n    .MergeCells = False\nEnd With\nCells.EntireColumn.AutoFit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1577827005, "post_id": 59547394, "comment_id": 105266009, "body": "<a href=\"https://wellsr.com/vba/2017/outlook/set-outlook-out-of-office-automatic-reply-with-vba/\" rel=\"nofollow noreferrer\">wellsr.com/vba/2017/outlook/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 2774460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf93b39b87305e1cc0e0bd7b367ea34?s=128&d=identicon&r=PG&f=1", "display_name": "Codr4Life", "link": "https://stackoverflow.com/users/2774460/codr4life"}, "edited": false, "score": 0, "creation_date": 1582608974, "post_id": 59553865, "comment_id": 106826203, "body": "Thanks for the suggestion! it looks like the GetSMTPAddress type function would require access to Exchange server which I don&#39;t have access to."}], "tags": [], "owner": {"reputation": 15, "user_id": 4642781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ad4e8984384f25e06630a3d86372fa?s=128&d=identicon&r=PG&f=1", "display_name": "AirWreck", "link": "https://stackoverflow.com/users/4642781/airwreck"}, "is_accepted": false, "score": 0, "last_activity_date": 1577893762, "creation_date": 1577893762, "answer_id": 59553865, "question_id": 59547394, "link": "https://stackoverflow.com/questions/59547394/activate-out-of-office-reply/59553865#59553865", "title": "Activate Out of Office reply", "body": "<p>I am assuming you've checked out Om3r's link, but I have a less elegant, if not clunky solution. I once created a VBA out of office message as a practical joke (just to avoid someone). I could not find the code, but here is a summary of what you'd need to do. </p>\n\n<p>(Outlook has to be running for this to work)</p>\n\n<p>Create a public boolean variable, for example OutofOffice, set by a ribbon/QAT button or on a schedule.</p>\n\n<p>Create and save a draft email with your message (e.g. \"I am out of the office...\")</p>\n\n<p>Use or set up an Inbox_ItemAdd event listener, and for each incoming email:</p>\n\n<p>Reply to it, </p>\n\n<p>concatenating \"Auto-Reply \" to the subject line</p>\n\n<p>Retrieve the draft email and concatenate your draft message body to the reply body (and you'll have to figure out HTMLBody versus (non-HTML) Body. Something like:</p>\n\n<pre><code>OutMail.HTMLBody = OutMail.HTMLBody &amp; ObjDraft.HTMLBody\n</code></pre>\n\n<p>or you might save your OOO message as a public static string (instead of a draft email).</p>\n\n<p>Send the email</p>\n\n<hr>\n\n<p>as you mentioned, you don't want to repeatedly send this to people who sent you additional emails during this period. I would probably add the sender's email address (after passing to a GetSMTPAddress type function) to an array. I'd add a IsInArray type function to check each new sender (to see if they were emailed already). This array would be erased by your procedure called when you click that control again to turn off the OOO reply. </p>\n\n<p>If this worked for you, of course you could create a userform to edit the OOO message and set the schedule (day of week or specific dates). </p>\n"}], "owner": {"reputation": 27, "user_id": 2774460, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cf93b39b87305e1cc0e0bd7b367ea34?s=128&d=identicon&r=PG&f=1", "display_name": "Codr4Life", "link": "https://stackoverflow.com/users/2774460/codr4life"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1612010900, "creation_date": 1577816495, "last_edit_date": 1582608821, "question_id": 59547394, "link": "https://stackoverflow.com/questions/59547394/activate-out-of-office-reply", "title": "Activate Out of Office reply", "body": "<p>I would like to automate my Out of Office based on the days that I'll be out on a biweekly basis. I don't have access to the Exchange server that hosts our Outlook.</p>\n\n<p>I set an Outlook rule to send a automatic reply on Monday and apply VBA code to disable this rule when I'm in the office (with Outlook open). This is not an elegant way because the rule sends a reply to the user repeatedly every time an email is sent to me. </p>\n\n<p>How can I activate my Out of Office reply on Outlook 2010 using VBA?</p>\n\n<p>Here are the two resources I used:\n<a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_outlook-mso_win10/set-up-recurring-out-of-office-auto-reply-for/71dd1fef-ba99-4a2b-be72-7d509e8848eb\" rel=\"nofollow noreferrer\">https://answers.microsoft.com/en-us/msoffice/forum/msoffice_outlook-mso_win10/set-up-recurring-out-of-office-auto-reply-for/71dd1fef-ba99-4a2b-be72-7d509e8848eb</a></p>\n\n<p><a href=\"https://superuser.com/questions/292426/outlook-2010-how-to-turn-out-of-office-on-automatically-when-outlook-is-closed\">https://superuser.com/questions/292426/outlook-2010-how-to-turn-out-of-office-on-automatically-when-outlook-is-closed</a></p>\n\n<p>This is the script I have in \"ThisOutlookSession\" to enable/disable the rule, \"HomeTime\" containing my Out Of Office-like message.</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Application_Quit()\n    SetRuleEnabled True\nEnd Sub\n\nPrivate Sub Application_Startup()\n    SetRuleEnabled False\nEnd Sub\n\nPrivate Sub SetRuleEnabled(ByVal bEnable As Boolean)\n    Dim oSession    As Outlook.NameSpace\n    Dim oRule       As Outlook.Rule\n    Dim oRules      As Outlook.Rules\n    Dim oPA         As Outlook.PropertyAccessor\n\n    Set oSession = Application.Session\n    Set oRules = oSession.DefaultStore.GetRules()\n    Set oPA = oSession.DefaultStore.PropertyAccessor\n\n    '*** If the Out-Of-Office is already on (eg. holidays, sick leave etc.) \n    '*** then it might be best to force this rule permanently off\n    If oPA.GetProperty(\"http://schemas.microsoft.com/mapi/proptag/0x661D000B\") Then\n        bEnable = False\n    End If\n\n    For Each oRule In oRules\n        If oRule.Name = \"HomeTime\" Then\n            oRule.Enabled = bEnable\n            oRules.Save\n            Exit For\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577813939, "post_id": 59547046, "comment_id": 105263058, "body": "<code>ActiveWorkbook.Name</code>? Or just <code>Value</code>?"}, {"owner": {"reputation": 9, "user_id": 11633613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96861cbca3bf4d54d7d1aa62839c5158?s=128&d=identicon&r=PG&f=1", "display_name": "lekoppa", "link": "https://stackoverflow.com/users/11633613/lekoppa"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577815023, "post_id": 59547046, "comment_id": 105263361, "body": "-I must have been spacing, lol!  Thanks for the help,  WS.Range(&quot;A&quot; &amp; Lrow &amp; &quot;:A&quot; &amp; Lrow + 8).Value = ActiveWorkbook.Name worked perfectly!"}], "owner": {"reputation": 9, "user_id": 11633613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96861cbca3bf4d54d7d1aa62839c5158?s=128&d=identicon&r=PG&f=1", "display_name": "lekoppa", "link": "https://stackoverflow.com/users/11633613/lekoppa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577963773, "creation_date": 1577813811, "last_edit_date": 1577963773, "question_id": 59547046, "link": "https://stackoverflow.com/questions/59547046/save-name-of-reference-workbook-as-value", "title": "Save Name of Reference Workbook as Value", "body": "<p>The macro below is designed to compile data from an audit form used throughout my organization.<br>\nEach manager saves their audit in a separate workbook monthly--I modify the If-Then statement frequently, dependent upon what data points I am investigating.</p>\n\n<p>In the example below, the \"F2\" and \"F3\" range signify the manager, and date for each audit, so the output may look something like this:</p>\n\n<ul>\n<li>Manager A | Jan 1 | data point 1</li>\n<li>Manager A | Jan 1 | data point 2</li>\n<li>Manager A | Jan 1 | data point 3</li>\n<li>Manager B | Jan 2 | data point 1</li>\n<li>Manager B | Jan 2 | data point 2</li>\n<li>Manager B | Jan 2 | data point 3</li>\n</ul>\n\n<p>etc.</p>\n\n<p>Because these fields require manual entry, I've been experiencing some issues attributed to human error.  I'd like to add a column that records the name of the workbook being referenced, so that I can more easily deep dive these issues.</p>\n\n<p>I know the destination:\nWS.Range(\"A\" &amp; Lrow &amp; \":A\" &amp; Lrow + 2)</p>\n\n<p>But I can't quite figure out how to save the file name for each Active Workbook in the loop.  Any suggestions?</p>\n\n<hr>\n\n<pre><code>Dim WS As Worksheet\nDim myfolder As String\nDim Str As String\nDim a As Single\nDim sht As Worksheet\n\nSet WS = Sheets.Add\n\nWith Application.FileDialog(msoFileDialogFolderPicker)\n    .Show\n    myfolder = .SelectedItems(1) &amp; \"\\\"\nEnd With\n\nValue = Dir(myfolder)\nDo Until Value = \"\"\n    If Value = \".\" Or Value = \"..\" Then\n    Else\n        If Right(Value, 3) = \"xls\" Or Right(Value, 4) = \"xlsx\" Or Right(Value, 4) = \"xlsm\" Then\n            On Error Resume Next\n            Workbooks.Open Filename:=myfolder &amp; Value, Password:=\"zzzzzzzzzzzz\"\n            If Err.Number &gt; 0 Then\n            Else\n                On Error GoTo 0\n            For Each sht In ActiveWorkbook.Worksheets\n                    If sht.Name Like \"CQI\" Then\n                        Lrow = WS.Range(\"B\" &amp; Rows.Count).End(xlUp).Row + 1\n                        sht.Range(\"F2\").Copy\n                        WS.Range(\"B\" &amp; Lrow &amp; \":B\" &amp; Lrow + 2).PasteSpecial (xlPasteValues)\n                        sht.Range(\"F3\").Copy\n                        WS.Range(\"C\" &amp; Lrow &amp; \":C\" &amp; Lrow + 2).PasteSpecial (xlPasteValues)\n                        sht.Range(\"F54:F56\").Copy\n                        WS.Range(\"D\" &amp; Lrow).PasteSpecial (xlPasteValues)\n                        sht.Range(\"C54:E56\").Copy\n                        WS.Range(\"E\" &amp; Lrow).PasteSpecial (xlPasteValues)\n\n                    End If\n                Next sht\n            End If\n\n\n            End If\n            Workbooks(Value).Close False\n            On Error GoTo 0\n        End If\n    Value = Dir\nLoop\nCells.EntireColumn.AutoFit\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1577811427, "post_id": 59546712, "comment_id": 105262336, "body": "As you are new to VBA I&#39;d recomment to do some reading for example on <a href=\"https://excelmacromastery.com/vba-for-loop/\" rel=\"nofollow noreferrer\">for loops</a> or you go for <a href=\"https://support.office.com/en-us/article/introduction-to-microsoft-power-query-for-excel-6e92e2f4-2079-4e1f-bad5-89f6269cd605?ui=en-US&amp;rs=en-US&amp;ad=US\" rel=\"nofollow noreferrer\">Power Query</a> which might also be a solution for your problem."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1577811543, "post_id": 59546712, "comment_id": 105262375, "body": "Reading up on <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">how to avoid using Select</a> in your code will also be useful"}], "owner": {"reputation": 1, "user_id": 12633178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06b11ff691cca5daa06a034255e95b2c?s=128&d=identicon&r=PG&f=1", "display_name": "riaden14", "link": "https://stackoverflow.com/users/12633178/riaden14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577815643, "creation_date": 1577811323, "question_id": 59546712, "link": "https://stackoverflow.com/questions/59546712/updating-multiple-workbooks-based-on-1-cells-value-vba", "title": "Updating Multiple Workbooks based on 1 Cells Value (VBA)", "body": "<p>I'm new to VBA, and I'm trying to optimize some code. I currently have a few workbooks that are being updated based on a single cells value, and then copied to a new workbook. Is there a way of running a For loop so that I don't have to add a new block of code for each unique value?</p>\n\n<pre><code>'\nRange(\"Account\") = \"='A1 List'!R[1]C[0]\"\nCalculate\nActiveWorkbook.RefreshAll\nColumns(\"D:F\").Select\nSelection.ColumnWidth = 11\n    Cells.Select\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorLight1\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nThisWorkbook.SaveCopyAs Filename:=XPath &amp; \"\\\" &amp; Range(\"Account\") &amp; \".xlsm\"'\n  Range(\"Account\") = \"='A1 List'!R[2]C[0]\"\nCalculate\nActiveWorkbook.RefreshAll\nColumns(\"D:F\").Select\nSelection.ColumnWidth = 11\n    Cells.Select\nWith Selection.Interior\n    .Pattern = xlSolid\n    .PatternColorIndex = xlAutomatic\n    .ThemeColor = xlThemeColorLight1\n    .TintAndShade = 0\n    .PatternTintAndShade = 0\nEnd With\nThisWorkbook.SaveCopyAs Filename:=XPath &amp; \"\\\" &amp; Range(\"Account\") &amp; \".xlsm\"\n</code></pre>\n\n<p>TIA</p>\n"}, {"tags": ["excel", "python-3.x", "vba", "xlwings"], "answers": [{"tags": [], "owner": {"reputation": 455, "user_id": 9572605, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214151296270813/picture?type=large", "display_name": "Philippe Haumesser", "link": "https://stackoverflow.com/users/9572605/philippe-haumesser"}, "is_accepted": true, "score": 1, "last_activity_date": 1577819222, "creation_date": 1577819222, "answer_id": 59547702, "question_id": 59546462, "link": "https://stackoverflow.com/questions/59546462/python-xlwings-scraping-data-in-put-in-excel-sheet/59547702#59547702", "title": "python xlwings scraping data in put in excel sheet", "body": "<p>Hin \nfind my error.\nin first def timed()\njust add at the end:\nreturn df</p>\n"}], "owner": {"reputation": 455, "user_id": 9572605, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214151296270813/picture?type=large", "display_name": "Philippe Haumesser", "link": "https://stackoverflow.com/users/9572605/philippe-haumesser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 59547702, "answer_count": 1, "score": 0, "last_activity_date": 1612824272, "creation_date": 1577809546, "last_edit_date": 1612824272, "question_id": 59546462, "link": "https://stackoverflow.com/questions/59546462/python-xlwings-scraping-data-in-put-in-excel-sheet", "title": "python xlwings scraping data in put in excel sheet", "body": "<p>I m trying to have an code that permit to add harvest timesheets in excel automatically with a python code (which works fine).\nSo using xlwings, I add this code. It seems working as it takes one minute to work but nothing is imported in excel file.\nCould some can help me ?</p>\n\n<pre><code>def timed():\n    # id of the API\n    headers = {\n        \"Authorization\": \"Bearer \" + \"XXXXXXXX\",\n        \"Harvest-Account-ID\": \"XXXXX\"\n    }\n    # define login infos\n    headers = headers\n\n    # define period for saving info about date of file update\n    current_time = datetime.datetime.now()\n    Year = current_time.year\n    Month = current_time.month\n    actualMonth = \"{:02d}\".format(Month)  # mis au format 00 du mois\n    day = current_time.day\n    period = str(Year) + '-' + str(actualMonth) + '-' + str(day)\n\n    # connection to harvest\n    # premier jour de l'ann\u00e9e\n    begin_period = str(Year) + '-' + '01' + '-' + '01'\n    url_address = \"https://api.harvestapp.com/v2/time_entries?from=\" + begin_period + \"&amp;per_page=100\"\n\n    response = requests.get(url_address, headers=headers)\n\n    r = requests.get(url=url_address, headers=headers).json()\n\n    # add info about number of pages\n    try:\n        total_pages = int(r['total_pages'])\n    except:\n        total_pages = 1\n\n\n    timeentries = []\n    # add data to pandas dataframe\n    for page in range(0, total_pages):\n        pages = page + 1\n        url = \"https://api.harvestapp.com/v2/time_entries?from=\" + begin_period + \"&amp;page=\" + str(\n            pages) + \"&amp;per_page=100\"\n        response = requests.get(url=url, headers=headers).json()\n        test = response['time_entries']\n\n        for tet in test:\n            e = dict()\n            e['id'] = tet['id']\n            e['client'] = tet['client']['name']\n            e['user'] = tet['user']['id']\n            e['user_name'] = tet['user']['name']\n            e['ID_project'] = tet['project']['id']\n            e['ProjectName'] = tet['project']['name']\n            e['hours'] = tet['hours']\n            e['billable'] = tet['billable']\n            e['Billed'] = tet['is_billed']\n            e['spent_date'] = tet['spent_date']\n            try:\n                e['invoice'] = tet['invoice']['id']\n            except:\n                e['invoice'] = ''\n            try:\n                e['invoice_name'] = tet['invoice']['number']\n            except:\n                e['invoice_name'] = ''\n\n            timeentries.append(e)\n\n    # transfer to panda frame\n    df = pd.DataFrame(timeentries)\n\n@xw.func\n@xw.ret(index=False, header=True, expand='table')\ndef ret_data_frame():\n    return timed()\n</code></pre>\n\n<p>Objectif is to update all timesheet in an excel table...</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 1, "user_id": 12633029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3R1v8.jpg?s=128&g=1", "display_name": "Quantmodels", "link": "https://stackoverflow.com/users/12633029/quantmodels"}, "edited": false, "score": 0, "creation_date": 1577973411, "post_id": 59546440, "comment_id": 105296867, "body": "Thank you very much. Code mostly worked except (i) if there is no bold text in the textbox, the code copies the entire text contained in the text box; (ii) the part of the code MsgBox (&quot;There is no texbox&quot;) is not executing as no message is displayed if there is not textbox in the document. I am trying but have not been successful yet. Any suggestions will ber very helpful. Thanks again."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12633029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3R1v8.jpg?s=128&g=1", "display_name": "Quantmodels", "link": "https://stackoverflow.com/users/12633029/quantmodels"}, "edited": false, "score": 0, "creation_date": 1578072990, "post_id": 59547362, "comment_id": 105332083, "body": "One more question please. The above code is not copying from the first text box to the last textbox in the table. It is copying the text from the textbox that was inserted first in the document to the next and so on. For example, if textbox 2 was inserted above textbox 1 in the document then the text from textbox 2 will be copied first in the table. Kindly advise, how I can reset the sequence of all textboxes so that the text is always copied from the first textbox to the last. Thank you"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 1, "user_id": 12633029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3R1v8.jpg?s=128&g=1", "display_name": "Quantmodels", "link": "https://stackoverflow.com/users/12633029/quantmodels"}, "edited": false, "score": 0, "creation_date": 1578073361, "post_id": 59547362, "comment_id": 105332231, "body": "@Quantmodels The reasoning for this subsequent issue is somewhat complex. Handling it here would detract from the core stated question: how to move each text box&#39;s content to a specific table row/cell. Would you mind asking this in a new question, specifically stating this problem, please? Stack Overflow&#39;s goal is to be a Q&amp;A to help everyone, so it&#39;s important that questions and answers are narrowly targeted, making information easier to find and understand. If we get the second part sorted satisfactorily, we can link to that as a &quot;next step&quot;..."}, {"owner": {"reputation": 1, "user_id": 12633029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3R1v8.jpg?s=128&g=1", "display_name": "Quantmodels", "link": "https://stackoverflow.com/users/12633029/quantmodels"}, "edited": false, "score": 0, "creation_date": 1578074509, "post_id": 59547362, "comment_id": 105332668, "body": "Sure thanks so much for your help. I posted it as a separate question."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1577816204, "creation_date": 1577816204, "answer_id": 59547362, "question_id": 59546440, "link": "https://stackoverflow.com/questions/59546440/microsoft-word-copying-text-from-multiple-text-boxes-into-a-select-table/59547362#59547362", "title": "Microsoft word: Copying text from multiple text boxes into a select table", "body": "<p>Exactly what you need is not clear, it would help to give an example of what the content of a text box could be and what part should be transferred to a table cell. The following will do what I understand to be the requirement:</p>\n\n<blockquote>\n  <p>Loop all Shapes in a document. If the Shape is a TextBox, locate the\n  bold text and transfer it to the second column of a specific table, in\n  the row index +1 of the position of the text box in the document\n  (first in row 2, second in row 3, and so on).</p>\n</blockquote>\n\n<p>Note that I've added <em>object variables</em> for the Word \"things\" the code uses, such as a <code>Document</code>, a <code>Table</code>, a <code>Range</code> and a <code>Shape</code>. This is more efficient, easier to follow and less prone to working with the wrong thing.</p>\n\n<p>Looping the Shapes is clearer using <code>For Each</code>.</p>\n\n<p>In order to pick up the <strong>bold</strong> text, Word's <code>Find</code> functionality is efficient. This is performed on the <code>TextRange</code> of the textbox. (For more information about using <code>Find</code> please refer to the Word VBA language reference and the many contributions that use it here and elsewhere on the Internet. Working with Word's \"Advanced Find\" in the Word application, as a user, and recording a macro is also instructive.)</p>\n\n<p>Every time a text box is found, <code>i</code> is incremented in order to identify the table row.</p>\n\n<pre><code>Sub Copytextfromtextbox()\n    Dim nNumber As Integer\n    Dim strText As String\n    Dim i As Long\n    Dim doc As Document\n    Dim tbl As Table\n    Dim rng As Range\n    Dim shp As Shape\n\n    Set doc = ActiveDocument\n    Set tbl = doc.Tables(5)\n    i = 0\n    With doc\n        For Each shp In .Shapes\n            If shp.Type = msoTextBox Then\n                Set rng = shp.TextFrame.TextRange\n                With rng.Find\n                    .Font.Bold = True\n                    .Wrap = wdFindStop\n                    .Execute\n                    strText = rng.Text\n                End With\n                i = i + 1\n                With tbl.Cell(Row:=i + 1, Column:=2).Range\n                    .Delete\n                    .InsertAfter Text:=strText\n                End With\n            Else\n                MsgBox (\"There is no textbox.\")\n            End If\n        Next\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 12633029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3R1v8.jpg?s=128&g=1", "display_name": "Quantmodels", "link": "https://stackoverflow.com/users/12633029/quantmodels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 496, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577816204, "creation_date": 1577809405, "last_edit_date": 1577811492, "question_id": 59546440, "link": "https://stackoverflow.com/questions/59546440/microsoft-word-copying-text-from-multiple-text-boxes-into-a-select-table", "title": "Microsoft word: Copying text from multiple text boxes into a select table", "body": "<p>I am trying to copy only bold text from multiple text boxes in a word document and paste it into a selected column in a table in different rows. For example the bold text from textbox 1 should go into row 2 and column 2 of the table. Similarly, text from textbox 2 should go into row 3 and column 2 of the table. This should continue till all textboxes have been read and copied.</p>\n\n<p>However the code I am trying is copying all text from all text boxes and pasting it into different rows . I have not been able to figure out how to extract only bold text from the textbox and paste text from messagebox 1 into row 1, message box 2 into row 2 and so on.</p>\n\n<p>I am new to VBA so any help will be highly appreciated.</p>\n\n<p>The code I have customized is as follows:</p>\n\n<pre><code>Sub Copytextfromtextbox()\n    Dim nNumber As Integer\n    Dim strText As String\n    Dim i As Long\n    With ActiveDocument\nFor nNumber = 1 To .Shapes.Count Step 1\nIf .Shapes(nNumber).Type = msoTextBox Then\n       strText = strText &amp; .Shapes(nNumber).TextFrame.TextRange.Text &amp; vbCr\n  For i = 2 To nNumber Step 1\n         With ActiveDocument.Tables(5).Cell(Row:=i, Column:=2).Range\n     .Delete\n     .InsertAfter Text:=strText\n End With\n Next\n    Else\nMsgBox (\"There is no textbox.\")\n    End If\n  Next\nEnd With\n        End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577803717, "post_id": 59545510, "comment_id": 105259909, "body": "Examine the value in that cell - it&#39;s most likely text, not a number."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1577804040, "post_id": 59545510, "comment_id": 105260005, "body": "Side note - use <code>Long</code> instead of <code>Integer</code>. There is no benefit to using <code>Integer</code>, and it in fact can cause issues."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577804093, "post_id": 59545510, "comment_id": 105260021, "body": "@BigBen it is a number formatted as general, see my edit in post above"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577804208, "post_id": 59545510, "comment_id": 105260059, "body": "@BigBen and i went ahead and changed them from Integer to Long but still got the same error"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1577804223, "post_id": 59545510, "comment_id": 105260065, "body": "Where do you declare <code>x</code>?  That might be some of the issue.  Also, I&#39;d not use <code>ActiveSheet</code>, and use the actual sheet name (or a variable), e.g. <code>Dim dataWS as Worksheet &#47;&#47; Set dataWS = Worksheets(&quot;My Data Sheet&quot;) &#47;&#47; x = dataWS.Cells(RowIndex, VAR5)</code>.  Also, do you need those variables to really be Public?  That might be an issue. Add <code>Debug.Print rowIndex, VAR5</code> right before that line, what is output in the Immediate Window (press <code>CTRL+G</code> in the VBEditor)."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577804229, "post_id": 59545510, "comment_id": 105260067, "body": "<code>Debug.Print</code> the value just to make sure that it is what you expect."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577804347, "post_id": 59545510, "comment_id": 105260102, "body": "@BigBen when do i put the debug.print"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577804393, "post_id": 59545510, "comment_id": 105260115, "body": "Comment out the line that errors or put a breakpoint on it, then right before it, <code>Debug.Print ActiveSheet.Cells(RowIndex, VAR5).Value</code>."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577804702, "post_id": 59545510, "comment_id": 105260236, "body": "@BigBen ok so when i comment out the line that was erroring and put in the debug. print line it works except the first bar isnt created and it creates solid bars in all the empty cells below the gantt chart. ill post a screenshot in my question"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577804732, "post_id": 59545510, "comment_id": 105260244, "body": "What is the output in the Immediate Window (Ctrl+G)?"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577804906, "post_id": 59545510, "comment_id": 105260297, "body": "@BigBen when I hit ctrl+G the &quot;go-to&quot; window opens with nothing in it"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1577805147, "post_id": 59545510, "comment_id": 105260375, "body": "Would definitely implement @BruceWayne&#39;s suggestion to replace <code>ActiveSheet</code> with the actual sheet in question."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577805170, "post_id": 59545510, "comment_id": 105260383, "body": "@BigBen i did that as well"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577805265, "post_id": 59545510, "comment_id": 105260411, "body": "Change <code>Debug.Print</code> to <code>MsgBox</code> and rerun - what&#39;s in the <code>MsgBox</code>?"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577805434, "post_id": 59545510, "comment_id": 105260476, "body": "@BigBen it spits out 1.5 the duration of that first value. but now its stuck in a loop with an empty message box pupping up over and over"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1577805512, "post_id": 59545510, "comment_id": 105260493, "body": "@Vbasic4now - one of your <code>Cells()</code> variables is <code>1.5</code>?  That&#39;s why you&#39;re getting an error..."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1577805721, "post_id": 59545510, "comment_id": 105260556, "body": "@BruceWayne where do i define the cell() variable as 1.5? i cant find it"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1577806466, "post_id": 59545510, "comment_id": 105260809, "body": "It hasn&#39;t been said here yet so I&#39;ll just put it out there. In the Immediate window, type <code>Print {expression of interest}</code> to determine the values of long expressions in your code. I use this method all of the time! It&#39;s also useful to toggle parameters like <code>Application.EnableEvents = True</code> or running subroutines on the fly without having to locate them in the VBE (type <code>Call MyRoutine</code> and hit enter)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "edited": false, "score": 0, "creation_date": 1577807237, "post_id": 59545510, "comment_id": 105261086, "body": "@MBB70 we already did suggest <code>Debug.Print</code>..."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577807332, "post_id": 59545510, "comment_id": 105261121, "body": "@BigBen why would the program work perfectly on an identical document but not here?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577807447, "post_id": 59545510, "comment_id": 105261152, "body": "A <code>Type Mismatch</code> is because the cell in question contains something other than a <code>Single</code>. Without your spreadsheet in front of me, I can&#39;t tell you what that value is.... it just can&#39;t be a <code>Single</code>."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577807538, "post_id": 59545510, "comment_id": 105261177, "body": "@BigBen can i change that type to look for something else? the cell its tripping up on contains a general formatted number in this case &quot;1.5&quot; but it will error no matter what number i put there"}, {"owner": {"reputation": 345, "user_id": 9531261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675ee91979b1a8e3c09b1437e5fe4edd?s=128&d=identicon&r=PG&f=1", "display_name": "MBB70", "link": "https://stackoverflow.com/users/9531261/mbb70"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577808719, "post_id": 59545510, "comment_id": 105261552, "body": "@BigBen Yes I saw that, thanks...I was suggesting doing things (checking values, executing commands) directly in the Immediate window itself...using it as more than a static debug printer....thought it would be a helpful contribution to this particular conversation. Not trying to step on any toes...just sharing what I think might help."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1577809663, "post_id": 59545510, "comment_id": 105261790, "body": "I think i figured it out. when i changed the duration cells to &quot;=value&quot; then indicated which cell to pull from it worked."}], "owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577806485, "creation_date": 1577803543, "last_edit_date": 1577806485, "question_id": 59545510, "link": "https://stackoverflow.com/questions/59545510/gantt-chart-creation-is-causing-program-error", "title": "Gantt chart creation is causing program error", "body": "<p>I have this VBA program that I created a long time ago. In its original document it work perfectly and outputs something that looks like the following:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xezYY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xezYY.png\" alt=\"main\"></a></p>\n\n<p>However, when I copy the input sheet and VBA code to a new document that set up exactly the same it gives me a</p>\n\n<blockquote>\n  <p>Runtime error 13: type mismatch error</p>\n</blockquote>\n\n<p>on the line that says <code>EndTime = ActiveSheet.Cells(RowIndex, VAR5)</code> about halfway down the code.</p>\n\n<pre><code>Public RESOL As Single\nPublic StepRow As Integer       'this is the start ROW for the STEP numbers\nPublic StepColumn As Integer    'this is the COLUMN for the STEP numbers\nPublic VAR3 As Integer          'this is the COLUMN for ABSOLUTE START\nPublic VAR4 As Integer          'this is the COLUMN for LINK\nPublic VAR5 As Integer          'this is the COLUMN for DURATION\nPublic VAR6 As Integer          'this is the COLUMN for the first time period\nPublic VAR7 As Integer  '       this is the ROW for the labels\nPublic RowPos As Single\nPublic TotalTime As Single\nPublic x1 As Single\nPublic RowIndex As Integer\nPublic LastColumn As Integer\nPublic StartTime As Single\nPublic EndTime As Single\nPublic WindowSize As Single\n\nSub Chart()\n\n    StepRow = 5         ' starting row for step numbers\n    StepColumn = 2      ' this is the COLUMN for the STEP numbers\n    VAR3 = 4            ' this is the COLUMN for ABSOLUTE START\n    VAR4 = 5            ' this is the COLUMN for LINK\n    VAR5 = 6            ' this is the COLUMN for DURATION\n    VAR6 = 11            ' this is the COLUMN for the first time period\n    VAR7 = 3            ' this is the ROW for the labels.\n\n    RESOL = ActiveSheet.Cells(1, VAR3)\n\n    'when the resolution to .01 if less than .01\n    If RESOL &lt; 0.01 Then\n        MsgBox (\"Grid resolution must be at least .01\")\n        Exit Sub\n    End If\n\n    LastColumn = VAR6\n    TotalTime = 0\n    RowIndex = StepRow\n    CheckNum = 1\n\n    Do\n        x = ActiveSheet.Cells(RowIndex, StepColumn)\n\n        ' bomb if no step number present\n        If IsNumeric(x) = False Then\n            MsgBox (\"Couldn't find a step number at position \" &amp; CheckNum)\n            Exit Sub\n        End If\n\n        If x &lt; 1 Then\n            LastNum = CheckNum - 1\n            Exit Do\n        End If\n\n\n        If x &lt;&gt; CheckNum Then\n            MsgBox (\"Step number does not match position\" &amp; CheckNum)\n            Exit Sub\n        End If\n\n        RowIndex = RowIndex + 1\n        CheckNum = CheckNum + 1\n\n    Loop\n\n    ActiveSheet.Lines.Delete\n    ActiveSheet.Range(Cells(VAR7, VAR6), Cells(VAR7, 256)).ClearContents\n    Application.ScreenUpdating = False\n    WindowSize = ActiveWindow.Zoom\n    ActiveWindow.Zoom = 100\n    RowIndex = StepRow\n    CheckNum = 1\n\n    Do\n        LinkPos = ActiveSheet.Cells(RowIndex, VAR4)\n\n        If Val(LinkPos) &gt; LastNum Then\n            MsgBox (\"Illegal LINK number for step \" + CheckNum)\n            ActiveWindow.Zoom = WindowSize\n            Application.ScreenUpdating = True\n            Exit Sub\n        End If\n\n        If Val(LinkPos) &lt; 1 Then\n            ActiveSheet.Cells(RowIndex, VAR4).Formula = Empty\n        End If\n\n        If Val(LinkPos) &gt; 0 And Val(LinkPos) &lt;= LastNum Then\n            ActiveSheet.Cells(RowIndex, VAR3).Formula = \"NA\"\n        End If\n\n        If CheckNum = LastNum Then\n            Exit Do\n        End If\n\n        CheckNum = CheckNum + 1\n        RowIndex = RowIndex + 1\n\n    Loop\n\n    CompletedSteps = 0\n    RowIndex = StepRow\n    CheckNum = 1\n\n    Do\n        AbsPos = ActiveSheet.Cells(RowIndex, VAR3)\n\n        If AbsPos &lt;&gt; \"NA\" And IsNumeric(AbsPos) = True Then\n            StartTime = Val(AbsPos)\n            EndTime = ActiveSheet.Cells(RowIndex, VAR5)\n            EndTime = EndTime + StartTime\n            Run (\"DrawLine\")\n            CompletedSteps = CompletedSteps + 1\n        End If\n\n        If CheckNum = LastNum Then\n            Exit Do\n        End If\n\n        CheckNum = CheckNum + 1\n        RowIndex = RowIndex + 1\n    Loop\n\n    NoOfTries = 1\n\n    Do\n\n        If CompletedSteps = LastNum Then\n            Exit Do\n        End If\n\n        RowIndex = StepRow\n        CheckNum = 1\n\n        Do\n            LinkTo = ActiveSheet.Cells(RowIndex, VAR4)\n\n            If Val(LinkTo) &gt;= 1 And Val(LinkTo) &lt;= LastNum Then\n\n                AbsPos = ActiveSheet.Cells(StepRow - 1 + LinkTo, VAR3)\n\n                If AbsPos &lt;&gt; \"NA\" And IsNumeric(AbsPos) = True Then\n                    DurPos = ActiveSheet.Cells(StepRow - 1 + LinkTo, VAR5)\n                    AbsPos = AbsPos + DurPos\n                    StartTime = Val(AbsPos)\n                    EndTime = ActiveSheet.Cells(RowIndex, VAR5)\n                    EndTime = EndTime + StartTime\n                    ActiveSheet.Cells(RowIndex, VAR3).Formula = StartTime\n                    Run (\"DrawLine\")\n                    Top1 = ActiveSheet.Cells(StepRow - 1 + LinkTo, VAR6).Top\n                    Top2 = ActiveSheet.Cells(StepRow + LinkTo, VAR6).Top\n                    RowPos2 = Top1 + ((Top2 - Top1) / 2)\n\n                    Set mySheet = ActiveSheet\n                    With mySheet.Shapes.AddLine(x1, RowPos, x1, RowPos2).Line\n                        .DashStyle = msoLineDash\n                        .ForeColor.RGB = RGB(0, 0, 0)\n                    End With\n\n                    CompletedSteps = CompletedSteps + 1\n\n                End If\n\n            End If\n\n            If CheckNum = LastNum Then\n                Exit Do\n            End If\n\n            CheckNum = CheckNum + 1\n            RowIndex = RowIndex + 1\n\n        Loop\n\n        If NoOfTries = LastNum Then\n            Exit Do\n        End If\n\n        NoOfTries = NoOfTries + 1\n    Loop\n\n    RowIndex = StepRow\n    CheckNum = 1\n\n    Do\n        LinkPos = ActiveSheet.Cells(RowIndex, VAR4)\n        If Val(LinkPos) &gt; 0 And Val(LinkPos) &lt;= LastNum Then\n            ActiveSheet.Cells(RowIndex, VAR3).Formula = Empty\n        End If\n\n        If CheckNum = LastNum Then\n            Exit Do\n        End If\n\n        CheckNum = CheckNum + 1\n        RowIndex = RowIndex + 1\n    Loop\n\n    CheckCol = VAR6\n    ColVal = RESOL\n\n    Do\n        ActiveSheet.Cells(VAR7, CheckCol).Formula = ColVal\n\n        If CheckCol &gt;= LastColumn Then\n            Exit Do\n        End If\n\n        ColVal = ColVal + RESOL\n        CheckCol = CheckCol + 1\n    Loop\n\n    ActiveSheet.Cells(2, VAR3).Formula = TotalTime\n    Range(\"A1\").Select\n    ActiveWindow.Zoom = WindowSize\n    Application.ScreenUpdating = True\n\nEnd Sub\n\nSub Drawline()\n    If EndTime &gt; TotalTime Then\n        TotalTime = EndTime\n    End If\n\n    Top1 = ActiveSheet.Cells(RowIndex, VAR6).Top\n    Top2 = ActiveSheet.Cells(RowIndex + 1, VAR6).Top\n    RowPos = Top1 + ((Top2 - Top1) / 2)\n    CheckCol = VAR6\n    ColTime = 0\n\n    Do\n        x1 = ActiveSheet.Cells(RowIndex, CheckCol).Left\n\n        If ColTime = StartTime Then\n            Exit Do\n        End If\n\n        If ColTime &gt; StartTime Then\n            x2 = ActiveSheet.Cells(RowIndex, CheckCol - 1).Left\n            Span = x1 - x2\n            Differencial = (ColTime - StartTime) / RESOL\n            TimeOffset = Differencial * Span\n            x1 = x1 - TimeOffset\n            Exit Do\n        End If\n\n        ColTime = ColTime + RESOL\n        CheckCol = CheckCol + 1\n\n    Loop\n\n    CheckCol = VAR6\n    ColTime = 0\n\n    Do\n        y1 = ActiveSheet.Cells(RowIndex, CheckCol).Left\n\n        If ColTime = EndTime Then\n            Exit Do\n        End If\n\n        If ColTime &gt; EndTime Then\n            y2 = ActiveSheet.Cells(RowIndex, CheckCol - 1).Left\n            Span = y1 - y2\n            Differencial = (ColTime - EndTime) / RESOL\n            TimeOffset = Differencial * Span\n            y1 = y1 - TimeOffset\n            Exit Do\n        End If\n\n        ColTime = ColTime + RESOL\n        CheckCol = CheckCol + 1\n\n    Loop\n\n    If CheckCol &gt; LastColumn Then\n        LastColumn = CheckCol\n    End If\n\n    Set mySheet = ActiveSheet\n    With mySheet.Shapes.AddLine(x1, RowPos - 2, y1, RowPos - 2).Line\n        .DashStyle = msoLineSolid\n        .ForeColor.RGB = RGB(128, 0, 25)\n         .Weight = xlHairline\n    End With\n\n    With mySheet.Shapes.AddLine(x1, RowPos, y1, RowPos).Line\n        .DashStyle = msoLineSolid\n        .ForeColor.RGB = RGB(128, 0, 25)\n        .Weight = xlThick\n    End With\n\n    With mySheet.Shapes.AddLine(x1, RowPos + 2, y1, RowPos + 2).Line\n        .DashStyle = msoLineSolid\n        .ForeColor.RGB = RGB(128, 0, 25)\n        .Weight = xlHairline\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p>Any help would be greatly appreciated. I have the two documents set up exactly the same so I can't figure out why its working on one, but not the other.</p>\n\n<p><strong>Edit:</strong> below is the state of the document when it errors out. It added all the \"NA\" to the start time column, but doesn't do that on the original sheet.</p>\n\n<p><a href=\"https://i.stack.imgur.com/lPPn8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lPPn8.png\" alt=\"enter image description here\"></a></p>\n\n<p>When I comment out the error it works, but prints the following where there are solid bars beneath the gantt chart and the starting bar is solid.</p>\n\n<p><a href=\"https://i.stack.imgur.com/RRCFV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RRCFV.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 8552125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0d05e85c1bf3b55c9b1677a76301ca?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8552125/john-john"}, "edited": false, "score": 0, "creation_date": 1577813014, "post_id": 59544808, "comment_id": 105262808, "body": "CurrentItem is not a folder, but an outlook appointment item. I would like to save the new appointment item to the same location. I have edited my question to clarify that. Apologies that it was not clear."}], "tags": [], "owner": {"reputation": 640, "user_id": 12626835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d667d2965d6d89fe6716a7e56ba1f764?s=128&d=identicon&r=PG&f=1", "display_name": "jclasley", "link": "https://stackoverflow.com/users/12626835/jclasley"}, "is_accepted": false, "score": 0, "last_activity_date": 1577804266, "last_edit_date": 1577804266, "creation_date": 1577799357, "answer_id": 59544808, "question_id": 59543605, "link": "https://stackoverflow.com/questions/59543605/save-outlook-appointment-to-specific-folder/59544808#59544808", "title": "Save Outlook appointment to specific folder", "body": "<p><code>CurrentItem</code> is already set as the folder to which you are moving the folder. If it were the identifying string, not the folder, your code would be correct. However, because it's the folder, you just need to <code>.Move CurrentItem</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 8552125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0d05e85c1bf3b55c9b1677a76301ca?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8552125/john-john"}, "edited": false, "score": 0, "creation_date": 1577813054, "post_id": 59545343, "comment_id": 105262817, "body": "The problem is I still don&#39;t know what folder I am saving to, because it should be the same one as the CurrentItem is in. If I could reference that folder, then I could easily save a new item to that location. How do I find that folder? I have edited my question to clarify that. Apologies that it was not clear."}, {"owner": {"reputation": 45, "user_id": 8552125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0d05e85c1bf3b55c9b1677a76301ca?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8552125/john-john"}, "edited": false, "score": 0, "creation_date": 1577895191, "post_id": 59545343, "comment_id": 105276525, "body": "Sorry this is still not making sense to me. MAPIFolder is evidently a variable, but set as what?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 45, "user_id": 8552125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0d05e85c1bf3b55c9b1677a76301ca?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8552125/john-john"}, "edited": false, "score": 0, "creation_date": 1577906360, "post_id": 59545343, "comment_id": 105279329, "body": "MAPIFolder is the object type - <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa210948(v%3Doffice.11)\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/previous-versions/office/developer/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 45, "user_id": 8552125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0d05e85c1bf3b55c9b1677a76301ca?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8552125/john-john"}, "edited": false, "score": 0, "creation_date": 1577906750, "post_id": 59545343, "comment_id": 105279407, "body": "In your case, the code should be Set MyAppt = CurrentItem.Parent.Items.Add"}, {"owner": {"reputation": 45, "user_id": 8552125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0d05e85c1bf3b55c9b1677a76301ca?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8552125/john-john"}, "edited": false, "score": 0, "creation_date": 1578038262, "post_id": 59545343, "comment_id": 105316868, "body": "Oh, ok that makes sense to me now. It works great, thank you!"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 1, "last_activity_date": 1577853182, "last_edit_date": 1577853182, "creation_date": 1577802569, "answer_id": 59545343, "question_id": 59543605, "link": "https://stackoverflow.com/questions/59543605/save-outlook-appointment-to-specific-folder/59545343#59545343", "title": "Save Outlook appointment to specific folder", "body": "<p>Firstly, create the item in the destination folder to begin with using <code>MAPIFolder.Items.Add</code> instead of <code>CreateItem</code> / <code>Move</code>.<br>\nIf you need to figure out the parent folder of another item, cast <code>MailItem.Parent</code> property to <code>MAPIFolder</code>.</p>\n\n<p>Secondly (it won't matter if you use <code>MAPIFolder.Items.Add</code>) - <code>Move</code> is a function that returns the newly created item, and the original item from that moment on must not be touched. Your code ignores the new item and keeps setting the properties on the old (moved) item.</p>\n"}], "owner": {"reputation": 45, "user_id": 8552125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a0d05e85c1bf3b55c9b1677a76301ca?s=128&d=identicon&r=PG&f=1", "display_name": "John John", "link": "https://stackoverflow.com/users/8552125/john-john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 59545343, "answer_count": 2, "score": 0, "last_activity_date": 1577853182, "creation_date": 1577792145, "last_edit_date": 1577812944, "question_id": 59543605, "link": "https://stackoverflow.com/questions/59543605/save-outlook-appointment-to-specific-folder", "title": "Save Outlook appointment to specific folder", "body": "<p>How do I save a new outlook appointment to the same folder as another appointment, for which I have the EntryID? The folder should be the same one that the \"currentitem\" appointment is saved to. I think I should then use the \"item.move\" function to set the folder, but I can't get it to work.</p>\n\n<pre><code>EntryID = Cells(ActiveCell.Row, 23)\nSet myolApp = CreateObject(\"Outlook.Application\")\nSet NS = myolApp.GetNamespace(\"MAPI\")\nNS.Logon\nSet CurrentItem = NS.GetItemFromID(EntryID)\nDim MyAppt As Outlook.AppointmentItem\nSet MyAppt = Outlook.Application.CreateItem(olAppointmentItem)\nWith MyAppt\n    .Move (NS.Folders(CurrentItem)) 'THIS IS WHERE I AM STUCK\n    .Start = CurrentItem.Start\n    .End = CurrentItem.End\n    .AllDayEvent = False\n    .Display\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 1, "creation_date": 1577791697, "post_id": 59543116, "comment_id": 105255923, "body": "Good answer! On top of that, there is a risk that Excel will follow the native <code>Find</code> function instead of Pawel&#39;s <code>Find</code> function; I&#39;d recommend changing the name to something more unique, e.g. <code>FindN</code>."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1577798336, "post_id": 59543116, "comment_id": 105258133, "body": "@JustynaMK since it&#39;s <code>Range.Find</code> (i.e. <code>Find</code> is a method of <code>Range</code>, not a function), there&#39;s not this issue, but I still agree with you in choosing a more appropriate name."}], "tags": [], "owner": {"reputation": 523, "user_id": 7865428, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c172a66464575485df7130ceca8fd294?s=128&d=identicon&r=PG", "display_name": "David G.", "link": "https://stackoverflow.com/users/7865428/david-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1577789596, "creation_date": 1577789596, "answer_id": 59543116, "question_id": 59542865, "link": "https://stackoverflow.com/questions/59542865/collatz-conjecture-find-the-smallest-a-k/59543116#59543116", "title": "Collatz conjecture. Find the smallest a_k", "body": "<p>you forgot to return the result.  </p>\n\n<p>Find = k</p>\n"}], "owner": {"reputation": 141, "user_id": 11375223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce686057dcbb1f4703d4b8ffad9c384a?s=128&d=identicon&r=PG&f=1", "display_name": "pawelK", "link": "https://stackoverflow.com/users/11375223/pawelk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 59543116, "answer_count": 1, "score": 2, "last_activity_date": 1577828901, "creation_date": 1577788172, "last_edit_date": 1577828901, "question_id": 59542865, "link": "https://stackoverflow.com/questions/59542865/collatz-conjecture-find-the-smallest-a-k", "title": "Collatz conjecture. Find the smallest a_k", "body": "<p>I am trying to create a function, that will return the smallest a_k, such that a_k equal to one. I wrote this code:</p>\n\n<pre><code>Function Collatz(N As Integer) As Integer\n\n    If N Mod 2 = 0 Then\n        F = N / 2\n    Else\n        F = (3 * N) + 1\n    End If\n\n    Collatz = F\n\nEnd Function\n\n\n\nFunction Find(N As Integer) As Integer\n k = 0\n Do While N &lt;&gt; 1\n    N = Collatz(N): k = k + 1\n    If k &gt; 10000000000# Then Exit Do\n Loop\n\nEnd Function\n</code></pre>\n\n<p>Function Collatz works fine, but function Find always returns zero. How can I improve this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1577789538, "post_id": 59542832, "comment_id": 105255207, "body": "This kind of question should be posted at <a href=\"https://codereview.stackexchange.com/questions/tagged/excel+vba\">codereview</a>"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "edited": false, "score": 0, "creation_date": 1577794458, "post_id": 59543337, "comment_id": 105256833, "body": "This is incredible, it&#39;s like 3 time faster when processing a big set of data and the solution is really elegant. Thank you! Changing it to array made an 1/3 improvement when processing a lot of text. I added loop from my original solution to remove any potential double spaces (do while instr &quot;  &quot;: replace &quot;  &quot;: &quot; &quot; loop). Can you think of any better solutions, or is this the only way?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "edited": false, "score": 0, "creation_date": 1577796796, "post_id": 59543337, "comment_id": 105257647, "body": "<code>application.Evaluate(&quot;=SUM(LEN(N1:N5)-LEN(SUBSTITUTE(N1:N5,&quot;&zwnj;&#8203;&quot; &quot;&quot;,&quot;&quot;&quot;&quot;))+1)&quot;)</code>"}, {"owner": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "edited": false, "score": 0, "creation_date": 1577798745, "post_id": 59543337, "comment_id": 105258287, "body": "There is an edge case not accounted for. If the cell has a string with more than one space between two words like &#39;word_one (space) (space) word_two&#39; this method <code>l + (Len(s) - Len(Replace(s, &quot; &quot;, &quot;&quot;)))</code> would count more than 2 words. See my solution below for one way to handle this edge case."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "reply_to_user": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "edited": false, "score": 0, "creation_date": 1577799026, "post_id": 59543337, "comment_id": 105258393, "body": "@AlexL Hi, I did add that to the answer.  It was not really clear how they were to be as no example data was shown.  This was a start approach :)"}, {"owner": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "edited": false, "score": 1, "creation_date": 1577799178, "post_id": 59543337, "comment_id": 105258449, "body": "Nathan_Sav, sorry I missed that in your text! Too eager to look at code :) Yeah I agree."}], "tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 1, "last_activity_date": 1577800683, "last_edit_date": 1577800683, "creation_date": 1577790848, "answer_id": 59543337, "question_id": 59542832, "link": "https://stackoverflow.com/questions/59542832/universal-vba-word-count-for-excel/59543337#59543337", "title": "Universal VBA Word Count for Excel", "body": "<p>You could try this sort of approach?  There may be the need to check for the next character to the space being another space, which would need some additions made.  To detect <code>word  one</code> as being the same as <code>word one</code> in the count.  Also, transferring the range to an array would make it a touch faster.</p>\n\n<pre><code>Function Word_Count(rng As Excel.Range) As Long\n\nDim c As Excel.Range\nDim s As String\nDim l As Long\n\nFor Each c In rng.Cells\n\n    s = Trim(c.Value)\n\n    If s &lt;&gt; \"\" Then\n        If InStr(1, s, \" \") &gt; 0 Then\n            '   Find number of spaces.  You can use the ubound of split maybe here instead\n            l = l + (Len(s) - Len(Replace(s, \" \", \"\")))\n        Else\n        End If\n        '   Will always be 1 word\n        l = l + 1\n    End If\n\nNext c\n\nWord_Count = l\n\nSet c = Nothing\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "edited": false, "score": 0, "creation_date": 1577794174, "post_id": 59543633, "comment_id": 105256736, "body": "Hi, thank you very much, it&#39;s the code is much shorter, more elegant and even a little faster. May I just ask where there is the &#39;- LBound(r)&#39; part, when the lbound is always going to be 0? Thank you."}, {"owner": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "reply_to_user": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "edited": false, "score": 0, "creation_date": 1577794417, "post_id": 59543633, "comment_id": 105256820, "body": "Hi Papaniks, you are right, <code>LBound(r)</code> will be zero, this is just me typing out of habbit <code>UBound - LBound</code> as not all arrays are zero indexed. You can Dim an array like <code>Dim arr(5 To 10)</code> if you like and so the <code>UBound - LBound</code> is more robust to these edge cases so it&#39;s just a habit I got in to. If my answer solves your question then please consider marking it as the accepted answer and voting it up. thanks."}, {"owner": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "reply_to_user": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "edited": false, "score": 0, "creation_date": 1577795122, "post_id": 59543633, "comment_id": 105257075, "body": "We could speed it up by copying the selection to an array and looping through the array instead."}, {"owner": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "edited": false, "score": 0, "creation_date": 1577796778, "post_id": 59543633, "comment_id": 105257640, "body": "Thank you for the update and the explations, It runs really great! The solution from Nathan_Sav with the &#39;l = l + (Len(s) - Len(Replace(s, &quot; &quot;, &quot;&quot;)))&#39; seems even faster (about 50 %) though.  To copy the selection to an array to work with non adjacent cells (where the address is A1,B2,C3...), there must be an if condition, to treat it differently from A1:C3, or is there a better way?"}, {"owner": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "reply_to_user": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "edited": false, "score": 0, "creation_date": 1577797155, "post_id": 59543633, "comment_id": 105257772, "body": "Please see the way I would approach it (updated answer). <code>For Each partial_selection In Split(Selection.Address, &quot;,&quot;)</code> then each loop copy the range to the array <code>arr = Range(partial_selection).Value</code> - let me know what you think."}, {"owner": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "reply_to_user": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "edited": false, "score": 0, "creation_date": 1577798670, "post_id": 59543633, "comment_id": 105258260, "body": "Actually, we would need to loop the split array r and ensure that there were no blank words. For example Nathan_Sav&#39;s answer here would miscount <code>&#39;word_one (space) (space) word_two&#39;</code> as more than two words if there is more than one space between the words. See my solution here looping the split array r."}, {"owner": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "reply_to_user": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "edited": false, "score": 0, "creation_date": 1577799024, "post_id": 59543633, "comment_id": 105258392, "body": "File here: <a href=\"https://drive.google.com/file/d/1_8k_2KV8F_cR3osWYAxGanq7wlBU7k_R/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1_8k_2KV8F_cR3osWYAxGanq7wlBU7k_R/&hellip;</a>"}, {"owner": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "edited": false, "score": 0, "creation_date": 1578052619, "post_id": 59543633, "comment_id": 105322629, "body": "Hey, sorry it took me so long to reply, but your answer after the edits is perfect. It&#39;s reliable, works no matter how the user selects the cells, doesn&#39;t count double spaces as separate words and it&#39;s super-fast. Thank you for all the effort!"}, {"owner": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "reply_to_user": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "edited": false, "score": 0, "creation_date": 1578058708, "post_id": 59543633, "comment_id": 105325340, "body": "My Pleasure St3ve :)"}], "tags": [], "owner": {"reputation": 3573, "user_id": 9792594, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jbiKo.png?s=128&g=1", "display_name": "Alex L", "link": "https://stackoverflow.com/users/9792594/alex-l"}, "is_accepted": true, "score": 1, "last_activity_date": 1577798561, "last_edit_date": 1577798561, "creation_date": 1577792269, "answer_id": 59543633, "question_id": 59542832, "link": "https://stackoverflow.com/questions/59542832/universal-vba-word-count-for-excel/59543633#59543633", "title": "Universal VBA Word Count for Excel", "body": "<p>You can achieve this in a similar way but with less code if you are interested to see?:</p>\n\n<pre><code>Sub word_count()\n    start_time = Timer\n    Dim r As Variant 'temp split array\n    Dim arr As Variant 'array\n    Dim c As Long 'total counter\n\n    If Selection Is Nothing Then\n        MsgBox \"Sorry, you need to select a cell/range first\", vbCritical\n        Exit Sub\n    Else\n        c = 0\n        For Each partial_selection In Split(Selection.Address, \",\")\n\n            If Range(partial_selection).Cells.Count &gt; 1 Then\n                arr = Range(partial_selection).Value\n            Else\n                Set arr = Range(partial_selection)\n                'single cell selected don't convert to array\n            End If\n\n            For Each temp_cell In arr\n                If Len(Trim(temp_cell)) &gt; 0 Then\n                    r = Split(temp_cell, \" \")\n                    For Each temp_word In r\n                        If Len(Trim(temp_word)) &gt; 0 Then\n                            c = c + 1\n                            'If the word is just a blank space don't count\n                        End If\n                    Next\n\n                    'c = c + (UBound(r) - LBound(r) + 1)\n\n                    'trimmed = Trim(temp_cell)\n                    'c = c + 1 + (Len(trimmed) - Len(Replace(trimmed, \" \", \"\")))\n                Else 'Blank cell\n                    'Do nothing\n                End If\n            Next\n        Next\n    End If\n\n    Dim item As Variant\n\n    time_taken = Round(Timer - start_time, 3)\n\n    MsgBox \"Your selected range '\" &amp; Replace(Selection.Address, \"$\", \"\") _\n        &amp; \"' in '\" &amp; Selection.Parent.Name &amp; \"' has \" &amp; c &amp; \" words.\" _\n        &amp; vbNewLine &amp; \"Time Taken: \" &amp; time_taken &amp; \" secs\"\n\n        Debug.Print c &amp; \" in \"; time_taken; \" secs\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 10010199, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-3uK6o060DtE/AAAAAAAAAAI/AAAAAAAAAEY/9VOm6jNZEAM/photo.jpg?sz=128", "display_name": "St3ve", "link": "https://stackoverflow.com/users/10010199/st3ve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 59543633, "answer_count": 2, "score": 0, "last_activity_date": 1577800683, "creation_date": 1577788024, "last_edit_date": 1577788749, "question_id": 59542832, "link": "https://stackoverflow.com/questions/59542832/universal-vba-word-count-for-excel", "title": "Universal VBA Word Count for Excel", "body": "<p>I was trying to create a universal, error resistant VBA code that would count words in selected ranges as MS Word does. This below is the best I could do and I was hoping that somebody would have a look and let me know if I missed something or suggest any improvements. The code is quite fast and works with single cell, non-adjacent cells and whole columns, I need it to be as universal as possible. I'll be looking forward to feedback.</p>\n\n<pre><code>Option Explicit\n\nSub word_count()\n\n\nDim r() As Variant 'array\nDim c As Long 'total counter\nDim i As Long\n\nDim l As Long 'string lenght\nDim c_ch As Long 'character counter\nDim c_s As String 'string variable\nDim cell As range\nDim rng As range\n\nIf Selection Is Nothing Then\n    MsgBox \"Sorry, you need to select a cell/range first\", vbCritical\n    Exit Sub\nElseIf InStr(1, Selection.Address, \":\", vbTextCompare) = 0 And InStr(1, Selection.Address, \",\", vbTextCompare) = 0 Then  'for when only one cell is selected\n\n    word_count_f Selection.Value, c\n    MsgBox \"Your selected cell '\" &amp; Replace(Selection.Address, \"$\", \"\") &amp; \"' in '\" &amp; Selection.Parent.Name &amp; \"' has \" &amp; c &amp; \" words.\"\n    Exit Sub\n\nElseIf InStr(1, Selection.Address, \",\", vbTextCompare) &gt; 0 Then 'when user selects more than one cell by clicking one by one -&gt; address looks like ('A1,A2,A3') etc\n\n    Application.ScreenUpdating = False\n    Dim help() As Variant\n    ReDim help(1 To Selection.Cells.Count)\n    i = 1\n    For Each cell In Selection 'loading straigh to array wouldn't work, so I create a helper array\n        help(i) = cell.Value\n        i = i + 1\n    Next cell\n\n    r = help\n\nElse 'load selection to array to improve speed\n\n    Application.ScreenUpdating = False\n    r = Selection.Value\n\nEnd If\n\nDim item As Variant\n\nFor Each item In r\n\n    word_count_f item, c\n\nNext item\n\n\nMsgBox \"Your selected range '\" &amp; Replace(Selection.Address, \"$\", \"\") &amp; \"' in '\" &amp; Selection.Parent.Name &amp; \"' has \" &amp; c &amp; \" words.\"\n\nEnd Sub\n\nPrivate Function word_count_f(ByVal item As Variant, ByRef c As Long)\n\nDim l As Long 'lenght variable\nDim c_s As String 'whole string variable\nDim c_ch As Long 'characted count variable\n\n    l = Len(item)\n    If l = 0 Then Exit Function\n    c_s = item\n    c_s = Trim(c_s)\n\n    Do While InStr(1, c_s, \"  \", vbTextCompare) &gt; 0 'remove double spaces to improve accuracy\n        c_s = Replace(c_s, \"  \", \" \")\n    Loop\n\n    If InStr(1, c_s, \" \", vbTextCompare) = 0 And l &gt; 0 Then 'if there was just one word in the cell\n        c = c + 1\n    ElseIf InStr(1, c_s, \" \", vbTextCompare) &gt; 0 Then 'else loop through string to count words\n\n        For c_ch = 1 To l 'loop through charactes of the string\n            If (Mid(c_s, c_ch, 1)) = \" \" Then\n                c = c + 1 'for each word\n            End If\n        Next c_ch\n        c = c + 1 'add one for the first word in cell\n    Else 'hopefully useless msgbox, but I wanted to be sure to inform the user correctly\n        MsgBox \"Sorry, there was an error while processing one of the cells, the result might not be accurate\", vbCritical\n    End If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "row"], "answers": [{"comments": [{"owner": {"reputation": 584, "user_id": 2756864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbTJ2.jpg?s=128&g=1", "display_name": "r0berts", "link": "https://stackoverflow.com/users/2756864/r0berts"}, "edited": false, "score": 0, "creation_date": 1577789234, "post_id": 59542481, "comment_id": 105255075, "body": "Thank you! It works so much better now! In the <code>Case</code> statement <code>Sheet1</code> is the same <code>ActiveSheet</code> and I updated it accordingly. I wonder; probably the speed improvement is due to not repeating <code>AutoFit</code> so many times and using <code>With</code>?"}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "reply_to_user": {"reputation": 584, "user_id": 2756864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbTJ2.jpg?s=128&g=1", "display_name": "r0berts", "link": "https://stackoverflow.com/users/2756864/r0berts"}, "edited": false, "score": 1, "creation_date": 1577809803, "post_id": 59542481, "comment_id": 105261825, "body": "@r0berts <code>With</code> statements is a syntactic sugar, as for me, and as for the rest - yes, in general that&#39;s right. Try another thing - go to VB editor, left click somewhere on the <code>IsEmpty</code> statement in your code, read Excel Help - and you&#39;ll see that you&#39;re applying a method for variables to range object. I suppose that that was the major time eater."}], "tags": [], "owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "is_accepted": true, "score": 1, "last_activity_date": 1577786227, "creation_date": 1577786227, "answer_id": 59542481, "question_id": 59541880, "link": "https://stackoverflow.com/questions/59541880/excel-vba-routine-to-wrap-text-and-set-row-height/59542481#59542481", "title": "Excel VBA routine to wrap text and set row height", "body": "<p>Try this version</p>\n\n<pre><code>Sub wrapText()\n\nDim targetRange As Range\nDim targetCell As Range\nDim w As Worksheet\nDim lastRow As Long\n\n\n' avoid screen flicker\n\nWith Application\n   .DisplayAlerts = False\n   .ScreenUpdating = False\n\n\n    Set w = ActiveSheet\n    'lastRow = w.UsedRange.Rows.Count ' this is a quite bad and unstable idea, see below a better one\n\n\n    'Wrap cell text\n    Set targetRange = Range(w.Cells(1, 7), w.Cells(Rows.Count, 7).End(xlUp))\n\n    With targetRange\n        .Cells.RowHeight = 15 ' set all rows to 15 height\n\n        For Each targetCell In .Cells\n            If Not targetCell.Value = \"\" Then\n                If Len(targetCell.Value) &gt; 60 Then targetCell.wrapText = True\n            End If\n        Next targetCell\n\n        .Cells.EntireRow.AutoFit ' autofit all rows in range\n    End With\n\n\n    ' This checks value of \"O1\" - I store 1 there if a custom filter is on\n\n\n    Select Case Sheet1.Range(\"O1\").Value ' is this another sheet?\n        Case 0\n            ActiveSheet.ListObjects(\"tblPatients\").Range.AutoFilter Field:=6\n        Case 1\n            ActiveSheet.ListObjects(\"tblPatients\").Range.AutoFilter Field:=6, Criteria1:=\"=\"\n    End Select\n\n    '\\restore normal XL settings for application\n\n    .DisplayAlerts = True\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Comment in case of questions!</p>\n"}], "owner": {"reputation": 584, "user_id": 2756864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QbTJ2.jpg?s=128&g=1", "display_name": "r0berts", "link": "https://stackoverflow.com/users/2756864/r0berts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 964, "favorite_count": 0, "accepted_answer_id": 59542481, "answer_count": 1, "score": 0, "last_activity_date": 1578816014, "creation_date": 1577783038, "last_edit_date": 1578816014, "question_id": 59541880, "link": "https://stackoverflow.com/questions/59541880/excel-vba-routine-to-wrap-text-and-set-row-height", "title": "Excel VBA routine to wrap text and set row height", "body": "<p>I have built a spreadsheet that at times requires to view \"Notes\" column so that all the text is visible, and sometimes so that all rows are the same height (15 works well). I wrote a routine called through click of a button and it works, but is slow (takes a few seconds for a table with 200 entries and could become longer if we have a couple of thousand records). I wonder if there was a better way to set row height. I base it on condition - if cell text is longer than 60 char, then wrap text and set row height. If less than 61 - set row height to 15.</p>\n\n<pre><code>Sub wrapText()\n\nDim targetRange As Range\nDim targetCell As Range\nDim w As Worksheet\nDim lastRow As Long\n\n\n' avoid screen flicker\n\nWith Application\n   .DisplayAlerts = False\n   .ScreenUpdating = False\n\n\nSet w = ActiveSheet\nlastRow = w.UsedRange.Rows.Count\n\n\n'Wrap cell text\n\nSet targetRange = Range(\"G3:G\" &amp; lastRow)\nFor Each targetCell In targetRange.Cells\n    If Not IsEmpty(targetCell.Value) Then\n        If Len(targetCell.Value) &gt; 60 Then\n            targetCell.wrapText = True\n            targetCell.EntireRow.AutoFit\n        Else: targetCell.RowHeight = 15\n        End If\n    End If\nNext targetCell\n\n' This checks value of \"O1\" - I store 1 there if a custom filter is on\n\nIf Sheet1.Range(\"O1\").Value = 0 Then  \n    ActiveSheet.ListObjects(\"tblPatients\").Range.AutoFilter Field:=6  \nEnd If  \nIf Sheet1.Range(\"O1\").Value = 1 Then\n     ActiveSheet.ListObjects(\"tblPatients\").Range.AutoFilter Field:=6, Criteria1:=\"=\"\nEnd If\n\n'\\restore normal XL settings for application\n\n    .DisplayAlerts = True\n    .ScreenUpdating = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>I wonder if there is something obvious how I could achieve the same but in a more efficient way? Thanks.</p>\n"}, {"tags": ["html", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "edited": false, "score": 0, "creation_date": 1577778252, "post_id": 59541033, "comment_id": 105251380, "body": "I tried: Shell &quot;wscript.exe&quot; &amp; strFile &amp; &quot; &quot; &amp; strUploadFile as well but error receiving &quot; File not Found&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "edited": false, "score": 0, "creation_date": 1577793047, "post_id": 59541565, "comment_id": 105256364, "body": "I tried this code but same error I am getting that is &quot;file not found&quot;. have you test this code on your PC and is it works for you?"}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "reply_to_user": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "edited": false, "score": 0, "creation_date": 1577876757, "post_id": 59541565, "comment_id": 105272535, "body": "@kiranmamalwad I&#39;ve pointed on obvious mistakes, posted it as an answer because comments are limited in text length and formatting. I suppose that <a href=\"https://stackoverflow.com/questions/13133126/calling-a-vbs-script-from-excel-vba\">this</a> link will help you."}], "tags": [], "owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "is_accepted": false, "score": 0, "last_activity_date": 1577781056, "creation_date": 1577781056, "answer_id": 59541565, "question_id": 59541033, "link": "https://stackoverflow.com/questions/59541033/unable-to-run-vbscript-file-due-to-access-limit/59541565#59541565", "title": "Unable to run vbscript file due to access limit", "body": "<p>Here is how<br>\n <code>Chr(34) &amp; strFile &amp; Chr(34) &amp; strUploadFile &amp; Chr(34)</code><br>\nreally looks like (this is from your code): <code>\"C:\\Users\\kiranm\\Desktop\\2019\\FileUpload.vbs\"C:\\Users\\kiranm\\Desktop\\2019\\fl0005.pdf\"</code>\nAs you see, there are not enough double quotes and spaces.</p>\n\n<p>And here is how<br>\n<code>\"wscript.exe\" &amp; strFile &amp; \" \" &amp; strUploadFile</code><br>\nlook like (this is from your comment)<br>\n<code>wscript.exeC:\\Users\\kiranm\\Desktop\\2019\\FileUpload.vbs C:\\Users\\kiranm\\Desktop\\2019\\fl0005.pdf</code></p>\n\n<p>So, I would have tried to use this version:<br>\n<code>Chr(34) &amp; strFile &amp; Chr(34) &amp; \" \" &amp; Chr(34) &amp; strUploadFile &amp; Chr(34)</code><br>\n in the code in post.</p>\n"}], "owner": {"reputation": 159, "user_id": 9167093, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yumMXrR-vps/AAAAAAAAAAI/AAAAAAAAAAA/TIEk7zjfLXg/photo.jpg?sz=128", "display_name": "kiran mamalwad", "link": "https://stackoverflow.com/users/9167093/kiran-mamalwad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577781056, "creation_date": 1577777738, "last_edit_date": 1577779276, "question_id": 59541033, "link": "https://stackoverflow.com/questions/59541033/unable-to-run-vbscript-file-due-to-access-limit", "title": "Unable to run vbscript file due to access limit", "body": "<p>I am trying to upload a file on HTML page, for which I need to run the vbascript saved on my desktop. But when I am executing the code its asking for admin permission and getting error as \"Access Denied\". So is there any way to run this file without but it should not break any policy and as I don't want to create any security issue.</p>\n\n<p>Thanks in advance:) </p>\n\n<pre><code>Sub uploadFiles()\n\nDim ie As Object\nDim strFile As Variant\nDim strUploadFile As Variant\nDim objShell As Variant\n\n\n Set ie = CreateObject(\"InternetExplorer.Application\")\n ie.navigate \"https://www.pdftoexcelconverter.net/\"\n ie.Visible = True\n\nApplication.Wait DateAdd(\"s\", 5, Now)\nstrFile = \"C:\\Users\\kiranm\\Desktop\\2019\\FileUpload.vbs\"  \nstrUploadFile = \"C:\\Users\\kiranm\\Desktop\\2019\\fl0005.pdf\" \n\nDim R_Shl As Double\n\n\nSet objShell = CreateObject(\"WScript.Shell\")\n   objShell.Run Chr(34) &amp; strFile &amp; Chr(34) &amp; strUploadFile &amp; Chr(34)\n\n\nie.document.getElementsByName(\"Filedata\")(0).Click\nApplication.Wait DateAdd(\"s\", 2, Now)\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "email"], "comments": [{"owner": {"reputation": 5, "user_id": 8622545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5f02029188df034c876a6574949b4?s=128&d=identicon&r=PG&f=1", "display_name": "T.Sarathchandra", "link": "https://stackoverflow.com/users/8622545/t-sarathchandra"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577786781, "post_id": 59540953, "comment_id": 105254147, "body": "I also came to know that it is possible through this thread <a href=\"https://stackoverflow.com/questions/31189863/sending-email-from-excel-automatically-based-on-date\" title=\"sending email from excel automatically based on date\">stackoverflow.com/questions/31189863/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 38, "user_id": 12607147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88a90a9f4426f9af0c6aea6472a91b1c?s=128&d=identicon&r=PG&f=1", "display_name": "MartijnDib", "link": "https://stackoverflow.com/users/12607147/martijndib"}, "is_accepted": true, "score": 0, "last_activity_date": 1577797605, "creation_date": 1577797605, "answer_id": 59544507, "question_id": 59540953, "link": "https://stackoverflow.com/questions/59540953/sending-an-email-notification-using-excel-vba-when-the-due-date-is-approaching/59544507#59544507", "title": "Sending an email notification using Excel VBA when the due date is approaching", "body": "<p>scheduling a macro is not as difficult as it may sound! \nThe code below can execute any sub inside the module it resides in at any given time\nwith task_sub being \"email\" in your case!</p>\n\n<pre><code>Sub schedule_macro()\nApplication.OnTime \"05:00:00\", \"task_sub\"\nEnd Sub\n</code></pre>\n\n<p>Here is the catch, for this macro to work. The file containing your macro needs to be open, basically always to really make sense. </p>\n\n<p>To circumvent this, windows (I am guessing all other operating systems have similar options) has Task Scheduler. I found a good explanation <a href=\"https://www.windowscentral.com/how-create-automated-task-using-task-scheduler-windows-10\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Now, this still requires your machine to be switched on at some point during the day. So perhaps you can simply just schedule all this during lunch breaks as to not interupt your normal schedule. If going on holidays, just copy paste the routine to a colleague that will be in the office during your time off. </p>\n\n<p>I hope this information will help you!</p>\n"}], "owner": {"reputation": 5, "user_id": 8622545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63d5f02029188df034c876a6574949b4?s=128&d=identicon&r=PG&f=1", "display_name": "T.Sarathchandra", "link": "https://stackoverflow.com/users/8622545/t-sarathchandra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1255, "favorite_count": 0, "accepted_answer_id": 59544507, "answer_count": 1, "score": 0, "last_activity_date": 1582152796, "creation_date": 1577777176, "last_edit_date": 1582152796, "question_id": 59540953, "link": "https://stackoverflow.com/questions/59540953/sending-an-email-notification-using-excel-vba-when-the-due-date-is-approaching", "title": "Sending an email notification using Excel VBA when the due date is approaching", "body": "<p>I am developing a machine maintenance system. I need to send a reminder email to the party which does machine maintenance when the servicing date of a particular machine is approaching.</p>\n\n<p>I want to search for the date of the next service from Service Details sheet and I want to get the email address of the service provider for that particular machine from the Machine Details sheet.</p>\n\n<p>I want to send two emails:</p>\n\n<ol>\n<li>seven days before the service date</li>\n<li>on the service date</li>\n</ol>\n\n<p>The body of the email should be,</p>\n\n<ol>\n<li>There is a service scheduled for a Photo copy machine (Machine type taken from machine details sheet) on 1/1/2020 (next service date taken from Service Details sheet.</li>\n<li>There is a service scheduled for a Photo copy machine (Machine type taken from machine details sheet) today.</li>\n</ol>\n\n<p>I want to send the email automatically without opening the Excel file.</p>\n\n<p>I went through many similar online threads and couldn't find what I am searching for and I am not proficient enough in VBA to adapt them.</p>\n\n<p>Here is the code I am using: </p>\n\n<pre><code>Sub email()\n\nDim r As Range\nDim cell As Range\n\nSet r = Range(\"U2:U10000\")\n\nFor Each cell In r\n    If cell.Value = Date + 7 Then\n\n        Dim Email_Subject, Email_Send_From, Email_Send_To, _\n        Email_Cc, Email_Body As String\n        Dim Mail_Object, Mail_Single As Variant\n        Dim Machine_Code As Long\n        Dim Machine_Type As Long\n\n        Machine_Code = Application.WorksheetFunction.VLookup(cell.Value, Range(\"A:U\"), 21, False)\n        Machine_Type = Application.WorksheetFunction.VLookup(Machine_Code, Sheet1.Range(\"B:C\"), 1, False)\n\n        Email_Subject = \"Service Reminder\"\n        Email_Send_From = \"k.s@*******\"\n        Email_Send_To = Application.WorksheetFunction.VLookup(Machine_Code, Sheet1.Range(\"C:M\"), 11, False)\n        Email_Cc = \"D@******.com\"\n        Email_Body = \"There is a Service scheduled for a\" &amp; Machine_Type &amp; \"on\" &amp; cell.Value\n\n        On Error GoTo debugs\n        Set Mail_Object = CreateObject(\"Outlook.Application\")\n        Set Mail_Single = Mail_Object.CreateItem(0)\n        With Mail_Single\n            .Subject = Email_Subject\n            .To = Email_Send_To\n            .cc = Email_Cc\n            .Body = Email_Body\n            .send\n        End With\n\n    End If\nNext\n\nExit Sub\n\ndebugs:\n    If Err.Description &lt;&gt; \"\" Then MsgBox Err.Description\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 11960693, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215170896689648/picture?type=large", "display_name": "Oleksandr Krasnoshchok", "link": "https://stackoverflow.com/users/11960693/oleksandr-krasnoshchok"}, "edited": false, "score": 0, "creation_date": 1577792572, "post_id": 59539407, "comment_id": 105256218, "body": "if lastRow &gt;= 2 then"}], "tags": [], "owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "is_accepted": true, "score": 1, "last_activity_date": 1577764853, "creation_date": 1577764853, "answer_id": 59539407, "question_id": 59539364, "link": "https://stackoverflow.com/questions/59539364/vba-setting-values-to-a-column-to-the-last-row-of-another-column/59539407#59539407", "title": "VBA setting values to a column to the last row of another column", "body": "<p>all good, worked it out. Pretty basic</p>\n\n<pre><code>Sub Macro8()\n'\n' Macro8 Macro\n'\n\n        Dim sh As Worksheet, lastRow As Long\n        Set sh = ActiveWorkbook.ActiveSheet\n\n        lastRow = sh.Cells(sh.Rows.Count, \"A\").End(xlUp).Row\n        sh.Range(\"D2:D\" &amp; lastRow).Value = 8.5\n        sh.Range(\"E2:E\" &amp; lastRow).Value = 6\n\nEnd Sub\n</code></pre>\n\n<p>didnt set the range up properly</p>\n"}, {"tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 0, "last_activity_date": 1577790018, "creation_date": 1577790018, "answer_id": 59543190, "question_id": 59539364, "link": "https://stackoverflow.com/questions/59539364/vba-setting-values-to-a-column-to-the-last-row-of-another-column/59543190#59543190", "title": "VBA setting values to a column to the last row of another column", "body": "<p>lastRow = sh.Cells(sh.Rows.Count, \"A\").End(xlUp).Row + 1</p>\n"}], "owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 59539407, "answer_count": 2, "score": 0, "last_activity_date": 1577790018, "creation_date": 1577764361, "question_id": 59539364, "link": "https://stackoverflow.com/questions/59539364/vba-setting-values-to-a-column-to-the-last-row-of-another-column", "title": "VBA setting values to a column to the last row of another column", "body": "<p>I am trying to make a VBA that gives certain columns a value up until the last row of the first column. This is my code:</p>\n\n<pre><code>Sub Macro8()\n'\n' Macro8 Macro\n'\n\n        Dim sh As Worksheet, lastRow As Long\n        Set sh = ActiveWorkbook.ActiveSheet\n\n        lastRow = sh.Cells(sh.Rows.Count, \"A\").End(xlUp).Row\n        sh.Range(\"D\" &amp; lastRow).Value = 8.5\n        sh.Range(\"E\" &amp; lastRow).Value = 6\n\nEnd Sub\n</code></pre>\n\n<p>I only seem to get the value on the last row of data, but I want it from the 2nd row to the last row of the first column</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1577761363, "creation_date": 1577761363, "answer_id": 59539105, "question_id": 59538671, "link": "https://stackoverflow.com/questions/59538671/hide-y-axis-below-a-certain-x-value-when-floating-zero/59539105#59539105", "title": "Hide y axis below a certain x value when floating zero", "body": "<p>The regular axis formatting options won't do what you want to achieve, so you need a workaround. For example:</p>\n\n<p>Hide the X axis altogether by formatting it to have no line. Use a new data series with two points. The first point is X=0, Y=-0.02, the second data point is x=the max of the other two series (formula) and Y is the same as the first data point.</p>\n\n<p>Format this series as a line without markers and use it in lieu of the X axis. You can even make the position of this fake X axis dynamic by calculating the Y value from your data, if you want.</p>\n\n<p>This will work with data from the grid, so you don't need to manipulate with VBA, but you could place the series with VBA instead, if you want.</p>\n\n<p>If you need more help implementing this, leave a comment and I'll add more detail.</p>\n"}], "owner": {"reputation": 75, "user_id": 11941541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fvbNU1hLFeM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVCWKM6wI0n77u2ysRcIMkEOIQ9Q/photo.jpg?sz=128", "display_name": "Alex Elfont", "link": "https://stackoverflow.com/users/11941541/alex-elfont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577963828, "creation_date": 1577756625, "last_edit_date": 1577963828, "question_id": 59538671, "link": "https://stackoverflow.com/questions/59538671/hide-y-axis-below-a-certain-x-value-when-floating-zero", "title": "Hide y axis below a certain x value when floating zero", "body": "<p>Say I have data graphed in an xy scatter with straight lines and markers. Data are plotted at (1, 3), (2, 4), (3, 0), and (4, 0). The last two data points are directly on the x axis. To fix this, I want the x axis to be slightly below y= 0.</p>\n\n<p>Here's what I've tried:</p>\n\n<p>Setting the min-y value to a negative number (e.g. -1). I then set the x axis to cross at a number greater than y = -1 (e.g. y= -.02). While this drops the x axis (i.e. floats the zero) as desired, the y axis and negative y-axis values up to -1 are shown on the graph. Typically to cover this area up, I add a white shape with no border. This is neither elegant nor works well when set up in VBA to be used with data sets of various sizes.</p>\n\n<p>When I set the min value to y=-.02 and the x axis to cross at y= -.02, I don't have to worry about the negative values on the y-axis, but the major interval changes to .8, 1.8, 2.8, etc. If I wanted to change the major interval to 0.5, 1.0, 1.5, etc., I'd need to set the min value to -.5, which is far too large when I only want the data points to be slightly above y=0.</p>\n\n<p>Any thoughts?</p>\n\n<p><a href=\"https://i.stack.imgur.com/tkoe5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tkoe5.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/TKQoU.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TKQoU.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-access", "setfocus"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577753598, "post_id": 59538342, "comment_id": 105246876, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/language/concepts/getting-started/understanding-objects-properties-methods-and-events\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/language/concepts/&hellip;</a>"}, {"owner": {"reputation": 2358, "user_id": 5730279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GYwj.jpg?s=128&g=1", "display_name": "hc_dev", "link": "https://stackoverflow.com/users/5730279/hc-dev"}, "edited": false, "score": 0, "creation_date": 1578135657, "post_id": 59538342, "comment_id": 105345709, "body": "Please consider <b>voting</b> to <a href=\"https://stackoverflow.com/help/someone-answers\">rate answers as (not) helpful</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1577776735, "post_id": 59538374, "comment_id": 105250970, "body": "Question is to return, or not to return sth. (without ByRef) <a href=\"https://riptutorial.com/vba/example/4805/introduction-to-procedures\" rel=\"nofollow noreferrer\">riptutorial.com/vba/example/4805/introduction-to-procedures</a>"}, {"owner": {"reputation": 3, "user_id": 12628609, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oi-4HvKy4bY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcB3uLBms-GdhNEaOxoemHE2Cni7A/photo.jpg?sz=128", "display_name": "Edward", "link": "https://stackoverflow.com/users/12628609/edward"}, "edited": false, "score": 0, "creation_date": 1578090451, "post_id": 59538374, "comment_id": 105338571, "body": "Thanks for your help!"}], "tags": [], "owner": {"reputation": 640, "user_id": 12626835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d667d2965d6d89fe6716a7e56ba1f764?s=128&d=identicon&r=PG&f=1", "display_name": "jclasley", "link": "https://stackoverflow.com/users/12626835/jclasley"}, "is_accepted": false, "score": 0, "last_activity_date": 1577752832, "creation_date": 1577752832, "answer_id": 59538374, "question_id": 59538342, "link": "https://stackoverflow.com/questions/59538342/is-setfocus-a-function/59538374#59538374", "title": "Is SetFocus a Function?", "body": "<p>Functions don't necessarily have to return a value. You can call functions just like you can call subs. Try for yourself: write a function, step through the function in a sub, and then check your locals window. </p>\n\n<p>Functions have the added bonus of being able to return values, but don't have to.</p>\n\n<p>EDIT: Aside from the need to return a value, I'm sure there is a reason to use one over the other, but I generally determine whether to use a sub or a function by the complexity of the task. I use functions to perform simple tasks and subs to perform more complex ones.</p>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 12628609, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oi-4HvKy4bY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcB3uLBms-GdhNEaOxoemHE2Cni7A/photo.jpg?sz=128", "display_name": "Edward", "link": "https://stackoverflow.com/users/12628609/edward"}, "edited": false, "score": 0, "creation_date": 1578089657, "post_id": 59538501, "comment_id": 105338333, "body": "Thank you for your help!"}], "tags": [], "owner": {"reputation": 2358, "user_id": 5730279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GYwj.jpg?s=128&g=1", "display_name": "hc_dev", "link": "https://stackoverflow.com/users/5730279/hc-dev"}, "is_accepted": false, "score": -1, "last_activity_date": 1577755871, "last_edit_date": 1577755871, "creation_date": 1577754549, "answer_id": 59538501, "question_id": 59538342, "link": "https://stackoverflow.com/questions/59538342/is-setfocus-a-function/59538501#59538501", "title": "Is SetFocus a Function?", "body": "<p>If you <a href=\"https://social.msdn.microsoft.com/Search/en-US?query=SetFocus&amp;ac=8\" rel=\"nofollow noreferrer\">search the <strong>Microsoft Documentation (MSDN)</strong>  for <code>SetFocus</code></a>, you will find it defined as:</p>\n\n<blockquote>\n  <p><strong>method</strong> on a user-interface control object, moving the focus to it ... with <strong>no return value</strong></p>\n</blockquote>\n\n<p><em>(above quotation is not literally cited, but conveys the meaning)</em></p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa221598(v=office.11)\" rel=\"nofollow noreferrer\">SetFocus Method [Access 2003 VBA Language Reference]</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/api/Access.TextBox.SetFocus\" rel=\"nofollow noreferrer\">TextBox.SetFocus method (Access)</a> </li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Reference/User-Interface-Help/setfocus-method\" rel=\"nofollow noreferrer\">SetFocus method (Microsoft Forms)</a></li>\n</ul>\n\n<h3>Function?</h3>\n\n<p>Thus it is not a <em>function</em> in VBA syntax.\nBesides: a <strong>function's return value</strong> in VBA <strong>is optional</strong>. See <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/function-statement\" rel=\"nofollow noreferrer\">VBA language reference: Function statement</a>:</p>\n\n<blockquote>\n  <p>Optional. Return value of the Function.</p>\n</blockquote>\n\n<h3>Common method naming conventions</h3>\n\n<p>In most programming languages the common <strong>naming convention</strong> (case ignored) for methods apply:</p>\n\n<ul>\n<li>use <code>get</code> (often without parameters) to return a value. Such methods are called <em>getter</em> or <em>accessor</em>.</li>\n<li>use <code>set</code> (often with parameter as value to set) to set a new state (or value). Usually the have no return value, because the new value or state is predicted by the argument passed (their parameter). Such methods are called <em>setter</em> or <em>mutator</em>.</li>\n<li>use <code>is</code>, <code>has</code>, <code>exists</code>, <code>contains</code>, <code>starts</code>, <code>ends</code>, etc. to return a <em>boolean</em> value. Such methods are used to check flags (on/off, true/false, yes/no).</li>\n<li>use <code>calculate</code>, <code>locate</code>, <code>indexOf</code>, <code>find</code>, <code>fetch</code>, <code>lookup</code>, <code>determine</code>, etc. (often with parameters) to return a value resulting of some processing based on specified parameters (by some logical, mathematical algorithm or queried by data-retrieval)</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 2358, "user_id": 5730279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GYwj.jpg?s=128&g=1", "display_name": "hc_dev", "link": "https://stackoverflow.com/users/5730279/hc-dev"}, "edited": false, "score": 0, "creation_date": 1577756602, "post_id": 59538551, "comment_id": 105247380, "body": "Very comprehensive explanation that differentiates well. Since it became very long, some headings would give structure. Maybe even a <code>TL;DR</code> would summarize on top :-)"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1577777777, "post_id": 59538551, "comment_id": 105251244, "body": "Isn&#39;t it both (method, type is sub)? E.g.  Application.BuildCriteria is a method too, but type is function."}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1577813477, "post_id": 59538551, "comment_id": 105262932, "body": "As I stated, it can get somewhat &quot;gray&quot;. The main difference between a method and a property comes down to does setting (or getting) a value also cause some kind of OTHER action. So, you might set the recordPointer, and that not only allows you to get (or set) the record pointer, but ALSO causes the recordset to &quot;move&quot; to the given record. So while both properties and methods &quot;often&quot; allow a set and get of a value, the distinction is that a method also does something MORE then just a get/set of a value.  Often a method is labled as a property and vice versa. But the distinction is a &quot;action&quot;."}, {"owner": {"reputation": 3, "user_id": 12628609, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oi-4HvKy4bY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcB3uLBms-GdhNEaOxoemHE2Cni7A/photo.jpg?sz=128", "display_name": "Edward", "link": "https://stackoverflow.com/users/12628609/edward"}, "edited": false, "score": 0, "creation_date": 1578089636, "post_id": 59538551, "comment_id": 105338327, "body": "Thank you for your detailed answer. It&#39;s very helpful!"}], "tags": [], "owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "is_accepted": true, "score": 2, "last_activity_date": 1577764380, "last_edit_date": 1577764380, "creation_date": 1577755114, "answer_id": 59538551, "question_id": 59538342, "link": "https://stackoverflow.com/questions/59538342/is-setfocus-a-function/59538551#59538551", "title": "Is SetFocus a Function?", "body": "<p>Well, in this case and example, .setFocus is not a sub, nor is it a function.</p>\n\n<p>A sub  is a separate bit of code, you call it like</p>\n\n<pre><code>Call MySub\n</code></pre>\n\n<p>(or a shorter form skips the word \"call\" - it is optional)\neg:</p>\n\n<pre><code>MySub\n</code></pre>\n\n<p>Or, if there are parameters, you might go:</p>\n\n<pre><code>Call MySub(InvoiceNumber)\n</code></pre>\n\n<p>In the case of a function? That is again a external bit of code. You can use functions that return a value and IGNORE that return value.</p>\n\n<p>So</p>\n\n<pre><code>MyVar = MyFunction()\n</code></pre>\n\n<p>And just like subs, the function can accept parameters:</p>\n\n<pre><code>MyVar = MyFunction(InvoiceNumber)\n</code></pre>\n\n<p>And as I noted, you can \"ignore\" the return value of a function like this:</p>\n\n<pre><code>MyFuncton  InvoiceNumber\n</code></pre>\n\n<p>If you write as per above, the you are passing the value, but the return value of the function is not \"placed\" or put into anything. so you can \"use\" a function that returns a value. You also skip use of the () around the value you pass.</p>\n\n<p>However, in the above two examples we are talking about VBA sub and functions YOU write.</p>\n\n<p>SomeTextBox.SetFocus is NOT  sub, nor is it a function.</p>\n\n<p>What the above is called? It is called a Method of the object.</p>\n\n<p>So, when you use Access objects, say record Sets, controls etc? Well that \"object\" will have what we call properties (usually things that you can set or get a value from).</p>\n\n<p>So, for a text box, you have:</p>\n\n<pre><code>MyControl.Value = \"Hello\"\n</code></pre>\n\n<p>The above would set the value (text) of a text box to Hello. Thus \".value\" is the property of that text box. It also happens to be the default property. So you can go:</p>\n\n<pre><code>MyControl = \"Hello\"\n</code></pre>\n\n<p>Now, if you go:</p>\n\n<pre><code> Msgbox(\"Value of MyControl = \" &amp; MyControl.Value)\n</code></pre>\n\n<p>So a property of a \"thing\" (a object) often can be set a value, and you can get (retrieve) a value. This is called a property.</p>\n\n<p>However, these objects also have what are called methods. Methods are a \"action\" and are similar to a sub/function (but YOU did not write that method).</p>\n\n<p>And such methods are \"some code\" that runs that is part of the object. So sometimes the difference between a property of a object, and a method of a object  is \"gray\". Some methods can accept values and return values, but the distinction between the two (method and property) is that MORE then setting a value can occur with a method. (so it not just limited to get and set). </p>\n\n<p>A \"method\" can be thought of some \"action\" and code. Use of that Method tends to be assumed that some code will run. (and it not your code in most cases - it is \"code\" attached to the built in object.</p>\n\n<p>So</p>\n\n<pre><code>MyTextBox.SetFocus\n</code></pre>\n\n<p>It is a method of the text box control, or the given control in question. Not all controls necessary may have this \"method\".</p>\n\n<p>So .SetFocus is not sub, not a function, but is in fact a method of the control in question.</p>\n"}], "owner": {"reputation": 3, "user_id": 12628609, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Oi-4HvKy4bY/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcB3uLBms-GdhNEaOxoemHE2Cni7A/photo.jpg?sz=128", "display_name": "Edward", "link": "https://stackoverflow.com/users/12628609/edward"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 59538551, "answer_count": 3, "score": -1, "last_activity_date": 1577764380, "creation_date": 1577752502, "last_edit_date": 1577752873, "question_id": 59538342, "link": "https://stackoverflow.com/questions/59538342/is-setfocus-a-function", "title": "Is SetFocus a Function?", "body": "<p>I saw this line of code <code>txtNewCaption.SetFocus</code> and was told that <code>SetFocus</code> is used as a sub\nhere but it is also a function. I also read online that the difference between a sub and a function is that a sub doesn't return any value but a function returns a value. I couldn't imagine what kind of value <code>SetFoucs</code> could return, so I searched quite some articles online about <code>SetFocus</code> but none of them gave me an example of <code>SetFocus</code> used as a function to return a value. I am assuming there is something inaccurate or wrong with either my understanding or what I was told. </p>\n\n<p>Could you please help me to clarify the confusion?</p>\n\n<p>Thank you! </p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 11941541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fvbNU1hLFeM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVCWKM6wI0n77u2ysRcIMkEOIQ9Q/photo.jpg?sz=128", "display_name": "Alex Elfont", "link": "https://stackoverflow.com/users/11941541/alex-elfont"}, "edited": false, "score": 0, "creation_date": 1577756738, "post_id": 59538444, "comment_id": 105247400, "body": "ActiveChart is just from the recorded macro. I&#39;m using a variable to reference the chart. There will not always be two headers. The range of headers will always be positioned at B1, C1, etc. There will only be one chart. There will only be one sheet."}, {"owner": {"reputation": 640, "user_id": 12626835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d667d2965d6d89fe6716a7e56ba1f764?s=128&d=identicon&r=PG&f=1", "display_name": "jclasley", "link": "https://stackoverflow.com/users/12626835/jclasley"}, "reply_to_user": {"reputation": 75, "user_id": 11941541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fvbNU1hLFeM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVCWKM6wI0n77u2ysRcIMkEOIQ9Q/photo.jpg?sz=128", "display_name": "Alex Elfont", "link": "https://stackoverflow.com/users/11941541/alex-elfont"}, "edited": false, "score": 0, "creation_date": 1577756876, "post_id": 59538444, "comment_id": 105247422, "body": "Create a range defining the header locations. I&#39;ll do so with the example you provided, and add an edit to my comment since I don&#39;t know how to format the comment"}, {"owner": {"reputation": 75, "user_id": 11941541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fvbNU1hLFeM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVCWKM6wI0n77u2ysRcIMkEOIQ9Q/photo.jpg?sz=128", "display_name": "Alex Elfont", "link": "https://stackoverflow.com/users/11941541/alex-elfont"}, "edited": false, "score": 0, "creation_date": 1577801248, "post_id": 59538444, "comment_id": 105259103, "body": "I had to declare &quot;Dim Cell As Range&quot; to get this to compile. Using the provided code, the legend entries were renamed to &quot;1&quot; and &quot;2&quot;, so I don&#39;t think the cells B1, C1 were referenced."}, {"owner": {"reputation": 75, "user_id": 11941541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fvbNU1hLFeM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVCWKM6wI0n77u2ysRcIMkEOIQ9Q/photo.jpg?sz=128", "display_name": "Alex Elfont", "link": "https://stackoverflow.com/users/11941541/alex-elfont"}, "edited": false, "score": 0, "creation_date": 1577803615, "post_id": 59538444, "comment_id": 105259865, "body": "Got it to work! I edited your original post with the accepted answer."}, {"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1578972882, "post_id": 59538444, "comment_id": 105604395, "body": "If I&#39;m writing a routine that a user will apply to an active chart, then ActiveChart is exactly the right way to reference the chart."}], "tags": [], "owner": {"reputation": 640, "user_id": 12626835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d667d2965d6d89fe6716a7e56ba1f764?s=128&d=identicon&r=PG&f=1", "display_name": "jclasley", "link": "https://stackoverflow.com/users/12626835/jclasley"}, "is_accepted": true, "score": 1, "last_activity_date": 1577805014, "last_edit_date": 1577805014, "creation_date": 1577753773, "answer_id": 59538444, "question_id": 59538110, "link": "https://stackoverflow.com/questions/59538110/using-vba-to-set-legend-entry-titles-to-series-titles/59538444#59538444", "title": "Using VBA to set legend entry titles to series titles", "body": "<p>We will need more information. Specifically:</p>\n\n<ul>\n<li>Is the range of headers dynamic? Will there always be two?</li>\n<li>Will the range of headers always be positioned at B1, C1?</li>\n<li>Will there be more than one sheet, or will you only be working in this sheet?</li>\n<li>Will there be multiple charts?</li>\n</ul>\n\n<p>As an aside, in doing my due diligence to the VBA community, you should avoid using <code>ActiveChart</code> or really anything dependent on what's \"active\", including <code>Selection</code>. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n\n<p>Based on comment:</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>    Dim rng as Range\n    Dim i as Long\n    Set rng = ThisWorkbook.Worksheets(1).Range(\"b1\", Range(\"b1\").End(xlToRight))\n    i = 0\n    For Each Cell in rng.Cells\n        i = i + 1\n        ActiveChart.FullSeriesCollection(i).Name = Cell.Text\n    Next Cell\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 0, "last_activity_date": 1578971923, "creation_date": 1578971923, "answer_id": 59727072, "question_id": 59538110, "link": "https://stackoverflow.com/questions/59538110/using-vba-to-set-legend-entry-titles-to-series-titles/59727072#59727072", "title": "Using VBA to set legend entry titles to series titles", "body": "<p>So let's write a little procedure you can use for any general chart.</p>\n\n<p>Assume: if Y values are in columns, the name is in the cell above the first Y value; if Y values are in rows, the name is in the cell to the left of the first Y value.</p>\n\n<p>Approach: loop through each series in the active chart, extract the Y values address from the series formula, determine which cell has the name, and apply it to the series.</p>\n\n<pre><code>Sub ApplyNamesToSeries()\n  If Not ActiveChart Is Nothing Then\n    With ActiveChart\n      Dim srs As Series\n      For Each srs In .SeriesCollection\n        ' series formula\n        Dim sFmla As String\n        sFmla = srs.Formula\n        ' just the arguments\n        sFmla = Mid$(Left$(sFmla, Len(sFmla) - 1), InStr(sFmla, \"(\") + 1)\n        ' split into an array\n        Dim vFmla As Variant\n        vFmla = Split(sFmla, \",\")\n        ' Y values are the 3rd argument\n        Dim sYVals As String\n        sYVals = vFmla(LBound(vFmla) + 2)\n        ' the Y value range\n        Dim rYVals As Range\n        Set rYVals = Range(sYVals)\n        ' by row or column?\n        If rYVals.Rows.Count &gt; 1 Then\n          ' by column, so use cell above column of Y values\n          Dim rName As Range\n          Set rName = rYVals.Offset(-1).Resize(1)\n        ElseIf rYVals.Columns.Count &gt; 1 Then\n          ' by row, so use cell to left of Y values\n          Set rName = rYVals.Offset(, -1).Resize(, 1)\n        Else\n          ' one cell only: who knows?\n          Set rName = Nothing\n        End If\n        If Not rName Is Nothing Then\n          srs.Name = \"=\" &amp; rName.Address(, , , True)\n        End If\n      Next\n    End With\n  End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "is_accepted": false, "score": 0, "last_activity_date": 1578972694, "creation_date": 1578972694, "answer_id": 59727175, "question_id": 59538110, "link": "https://stackoverflow.com/questions/59538110/using-vba-to-set-legend-entry-titles-to-series-titles/59727175#59727175", "title": "Using VBA to set legend entry titles to series titles", "body": "<p>A different approach is to pop up an input box so you can select a range that contains series names for the active chart, then loop through the series and the range, applying each cell to the name of each series.</p>\n\n<pre><code>Sub SelectRangeAndApplySeriesNames()\n  If Not ActiveChart Is Nothing Then\n    Dim rNames As Range\n    On Error Resume Next\n    Set rNames = Application.InputBox( _\n        \"Select a range that contains series names for your chart.\", _\n        \"Select Range of names\", , , , , , 8)\n    If Not rNames Is Nothing Then\n      ' if a range was selected\n      If rNames.Rows.Count = 1 Or rNames.Columns.Count = 1 Then\n        ' ignore complications...\n        With ActiveChart\n        Dim iSrs As Long\n        For iSrs = 1 To .SeriesCollection.Count\n          If iSrs &lt;= rNames.Cells.Count Then\n            .SeriesCollection(iSrs).Name = _\n                \"=\" &amp; rNames.Cells(iSrs).Address(, , , True)\n          End If\n        Next\n        End With\n      End If\n    End If\n  End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 11941541, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fvbNU1hLFeM/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reVCWKM6wI0n77u2ysRcIMkEOIQ9Q/photo.jpg?sz=128", "display_name": "Alex Elfont", "link": "https://stackoverflow.com/users/11941541/alex-elfont"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "accepted_answer_id": 59538444, "answer_count": 3, "score": 0, "last_activity_date": 1578972694, "creation_date": 1577750186, "last_edit_date": 1577751362, "question_id": 59538110, "link": "https://stackoverflow.com/questions/59538110/using-vba-to-set-legend-entry-titles-to-series-titles", "title": "Using VBA to set legend entry titles to series titles", "body": "<p>Using VBA, I'm hoping to rename legend entries to their corresponding series titles. In the included picture, I want \"Series 1\" and \"Series 2\" to be replaced with \"pbx\" and \"alt\". I recorded a macro to learn how to do individually but would like to create a loop to avoid specifically referencing each series title (e.g. If I added a series title at D1 and E1, the legend would automatically include the new titles.</p>\n\n<pre><code>ActiveChart.FullSeriesCollection(1).Name = \"=Sheet1!$B$1\"\n\nActiveChart.FullSeriesCollection(2).Name = \"=Sheet1!$C$1\"\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/pXCCc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pXCCc.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "python-requests", "python-3.7", "xlwings"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1577748386, "post_id": 59537890, "comment_id": 105245802, "body": "Please share sample html tables with img tags you are scraping."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577787657, "post_id": 59537890, "comment_id": 105254444, "body": "clipboard from msforms in vba will copy the table formatting allowing whole thing to be done in VBA. For images however, you will likely need the img srcs and to embed from those (matrix overlay positionally)"}], "owner": {"reputation": 53, "user_id": 2495485, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sbINx.png?s=128&g=1", "display_name": "C3Theo", "link": "https://stackoverflow.com/users/2495485/c3theo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 220, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577987926, "creation_date": 1577748091, "last_edit_date": 1577987926, "question_id": 59537890, "link": "https://stackoverflow.com/questions/59537890/how-to-scrape-images-from-img-and-paste-them-into-excel-with-proper-placement", "title": "How to scrape images from &lt;img&gt; and paste them into excel with proper placement/formatting?", "body": "<h2>The process I want to automate:</h2>\n\n<p>Copy/paste formatted html tables and a sequence of Barcode gif's into Excel.</p>\n\n<h2>Progress so far:</h2>\n\n<ol>\n<li>Able to scrape HTML tables and  tags</li>\n<li>Able to paste HTML tables into Excel with proper formatting</li>\n</ol>\n\n<p>My current solution is to scrape the html tables using requests/BeautifulSoup, copy html to the clipboard using pywin32, and then run a simple VBA macro to send the keys '^v' to past the html with formatting. This is the only way I've been able to get the html into Excel with formatting. The problem I ran into is that all the img tags are replaced by blank shapes. I've seen how to download images with requests, but I'm not sure how to get them into Excel with the proper placement. I explored generating the Barcode again with pyzbar, but there are several different types of 2D Barcodes and am not sure which I'm working with.</p>\n\n<p>Example HTML snippet:</p>\n\n<pre class=\"lang-html prettyprint-override\"><code>&lt;td&gt;\n&lt;img src=\"barcodes/!asterisk.gif\"&gt;\n&lt;img src=\"barcodes/X.gif\"&gt;\n&lt;img src=\"barcodes/Y.gif\"&gt;\n&lt;img src=\"barcodes/Z.gif\"&gt;\n&lt;img src=\"barcodes/D.gif\"&gt;\n&lt;img src=\"barcodes/H.gif\"&gt;\n&lt;img src=\"barcodes/4.gif\"&gt;\n&lt;img src=\"barcodes/8.gif\"&gt;\n&lt;img src=\"barcodes/N.gif\"&gt;\n&lt;img src=\"barcodes/6.gif\"&gt;\n&lt;img src=\"barcodes/V.gif\"&gt;\n&lt;img src=\"barcodes/!space.gif\"&gt;\n&lt;img src=\"barcodes/1.gif\"&gt;\n&lt;img src=\"barcodes/2.gif\"&gt;\n&lt;img src=\"barcodes/0.gif\"&gt;\n&lt;img src=\"barcodes/6.gif\"&gt;\n&lt;img src=\"barcodes/0.gif\"&gt;\n&lt;img src=\"barcodes/2.gif\"&gt;\n&lt;img src=\"barcodes/!asterisk.gif\"&gt;\n&lt;/td&gt;\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 2, "creation_date": 1577748233, "post_id": 59537880, "comment_id": 105245767, "body": "<code>.Value = Left(.Value, Len(.Value) - 1)</code>"}, {"owner": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 1, "creation_date": 1577749456, "post_id": 59537880, "comment_id": 105246049, "body": "I&#39;m pretty sure you need to loop through the cells in the selected range...?"}, {"owner": {"reputation": 9743, "user_id": 2127508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b1d5bcb39ec4baad76d20c66506318?s=128&d=identicon&r=PG", "display_name": "barrowc", "link": "https://stackoverflow.com/users/2127508/barrowc"}, "edited": false, "score": 1, "creation_date": 1577749474, "post_id": 59537880, "comment_id": 105246051, "body": "&quot;Be careful to distinguish between the active cell and the selection. The active cell is a single cell inside the current selection. The selection may contain more than one cell, but only one is the active cell.&quot; - <a href=\"https://docs.microsoft.com/en-gb/office/vba/api/excel.window.activecell\" rel=\"nofollow noreferrer\">MSDN</a>"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1577752538, "post_id": 59537880, "comment_id": 105246676, "body": "Try to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using <code>Select</code></a>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1577794531, "post_id": 59537880, "comment_id": 105256863, "body": "You can do this simply in Power Query with <code>Trim.End</code>, but maybe a better approach would be to change the method you used to construct the strings in the first place. It might be simpler to change that code."}], "answers": [{"comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1577763901, "post_id": 59538294, "comment_id": 105248440, "body": "Down voting because your code replaces all commas in the cells, not the last comma, as the OP ask. The correct approach is the one in the comment by @braX."}], "tags": [], "owner": {"reputation": 640, "user_id": 12626835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d667d2965d6d89fe6716a7e56ba1f764?s=128&d=identicon&r=PG&f=1", "display_name": "jclasley", "link": "https://stackoverflow.com/users/12626835/jclasley"}, "is_accepted": false, "score": -1, "last_activity_date": 1577753440, "last_edit_date": 1577753440, "creation_date": 1577752027, "answer_id": 59538294, "question_id": 59537880, "link": "https://stackoverflow.com/questions/59537880/remove-last-comma-from-a-cell-in-a-dynamic-range/59538294#59538294", "title": "Remove last comma from a cell in a dynamic range", "body": "<p>Use the <code>Replace()</code> function:</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>For Each Cell in Range.Cells\n    Cell.Value = Replace(Cell.Text, \",\", \"\")\nNext Cell\n</code></pre>\n\n<p>Edit: After testing, replaced <code>.Text</code> with <code>.Value</code></p>\n\n<p>Edit 2: I'd also like to add, why are you selecting the range? My supposition is that you are selecting it to enable use of <code>ActiveCell</code> but you can simply manipulate the range without selecting it. Selecting the range is asking to incur errors. My suggestion is:</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Dim rplcRng as Range\nSet rplcRange = sht.Range(StartCell, sht.Cells(LastRow, LastColumn))\n\nFor Each Cell in rplcRng.Cells\n    Cell.Value = Replace(Cell.Text, \",\", \"\")\nNext Cell\n</code></pre>\n\n<p>Edit 3: added \"s\"s</p>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1577781232, "post_id": 59539436, "comment_id": 105252294, "body": "I think looping is the correct way of doing this, however OP wants a check for a comma. Otherwise you are removing the last character unwanted. Also, you are using an implicit sheet reference on <code>Cells(Rows.Count...)</code>"}, {"owner": {"reputation": 13, "user_id": 12470037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a54e46ad22da9d0dd2f009a76da696?s=128&d=identicon&r=PG&f=1", "display_name": "AleksLi", "link": "https://stackoverflow.com/users/12470037/aleksli"}, "edited": false, "score": 0, "creation_date": 1577899117, "post_id": 59539436, "comment_id": 105277553, "body": "Thanks for taking the time to look into this. Your code worked, and did exactly what I needed!"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 13, "user_id": 12470037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a54e46ad22da9d0dd2f009a76da696?s=128&d=identicon&r=PG&f=1", "display_name": "AleksLi", "link": "https://stackoverflow.com/users/12470037/aleksli"}, "edited": false, "score": 0, "creation_date": 1577921275, "post_id": 59539436, "comment_id": 105282170, "body": "@AleksLi I think the problem was the code or formula you used to combine the cells added the last <code>,</code> which could probably be fixed without using this additional code."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": true, "score": 1, "last_activity_date": 1577832114, "last_edit_date": 1577832114, "creation_date": 1577765077, "answer_id": 59539436, "question_id": 59537880, "link": "https://stackoverflow.com/questions/59537880/remove-last-comma-from-a-cell-in-a-dynamic-range/59539436#59539436", "title": "Remove last comma from a cell in a dynamic range", "body": "<p>Since you want to remove the last character from each cell in column D, try this variation on braX's comment. It loops trough each used cell in column 4 and deletes the last character.</p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Sheet1\")\n    For Each cel In .Range(\"D1\", .Cells(.Rows.Count, 4).End(xlUp))\n        cel.Value = Left(cel, Len(cel) - 1)\n    Next cel\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1577781992, "creation_date": 1577781992, "answer_id": 59541710, "question_id": 59537880, "link": "https://stackoverflow.com/questions/59537880/remove-last-comma-from-a-cell-in-a-dynamic-range/59541710#59541710", "title": "Remove last comma from a cell in a dynamic range", "body": "<p>The most conventional way would be to loop over your cells:</p>\n\n<hr>\n\n<pre><code>Sub Replacing()\n\nDim lr As Long, lc As Long\nDim rng As Range, cl As Range\n\nWith Worksheets(\"Sheet1\")\n\n    'Find Last Row and Column\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    lc = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n    'Go through range\n    Set rng = .Range(.Cells(1, lc), .Cells(lr, lc))\n    For Each cl In rng\n        If Right(cl.Value, 1) = \",\" Then cl.Value = Left(cl.Value, Len(cl.Value) - 1)\n    Next cl\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Better would be to go through memory if your range is actually much larger (for performance sake)</p>\n\n<pre><code>Sub Replacing()\n\nDim lr As Long, lc As Long, x As Long\nDim arr As Variant\n\nWith Worksheets(\"Sheet1\")\n\n    'Find Last Row and Column\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    lc = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n    'Go through array\n    arr = .Range(.Cells(1, lc), .Cells(lr, lc)).Value\n    For x = LBound(arr) To UBound(arr)\n        If Right(arr(x, 1), 1) = \",\" Then arr(x, 1) = Left(arr(x, 1), Len(arr(x, 1)) - 1)\n    Next x\n\n    'Write array back to range\n    .Range(.Cells(1, lc), .Cells(lr, lc)).Value = arr\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>And a more less conventional way (alright for small ranges I guess) would be to evalate a range and avoid an iteration. This however comes at the cost of an array formula:</p>\n\n<pre><code>Sub Replacing()\n\nDim lr As Long, lc As Long\nDim rng As Range\n\nWith Worksheets(\"Sheet1\")\n\n    'Find Last Row and Column\n    lr = .Cells(.Rows.Count, 1).End(xlUp).Row\n    lc = .Cells(1, .Columns.Count).End(xlToLeft).Column\n\n    'Evaluate your range\n    Set rng = .Range(.Cells(1, lc), .Cells(lr, lc))\n    rng.Value = .Evaluate(\"IF(RIGHT(\" &amp; rng.Address &amp; \",1)=\"\",\"\",LEFT(\" &amp; rng.Address &amp; \",LEN(\" &amp; rng.Address &amp; \")-1),\" &amp; rng.Address &amp; \")\")\n\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 12470037, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a54e46ad22da9d0dd2f009a76da696?s=128&d=identicon&r=PG&f=1", "display_name": "AleksLi", "link": "https://stackoverflow.com/users/12470037/aleksli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 59539436, "answer_count": 3, "score": 1, "last_activity_date": 1582119853, "creation_date": 1577748002, "last_edit_date": 1582119853, "question_id": 59537880, "link": "https://stackoverflow.com/questions/59537880/remove-last-comma-from-a-cell-in-a-dynamic-range", "title": "Remove last comma from a cell in a dynamic range", "body": "<p>I'm trying to delete the last comma from each cell of a dynamic range.</p>\n\n<p>The macro doesn't delete the comma, it just selects the range.</p>\n\n<pre><code>Sub selecting()\nDim sht As Worksheet\nDim LastColumn As Long\nDim StartCell As Range\n\nSet sht = Worksheets(\"Sheet1\")\nSet StartCell = Range(\"D1\")\n\n'Find Last Row and Column\nLastRow = sht.Cells(sht.Rows.Count, StartCell.Column).End(xlUp).row\nLastColumn = sht.Cells(StartCell.row, sht.Columns.Count).End(xlToLeft).Column\n\n'Select Range\nsht.Range(StartCell, sht.Cells(LastRow, LastColumn)).Select\n\nWith ActiveCell\n    If Right(.Value, 1) = \",\" Then .Value = Right(.Value, Len(.Value) - 1)\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Here is what is returned</p>\n\n<p><a href=\"https://i.stack.imgur.com/ET5QN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ET5QN.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 2, "creation_date": 1577776127, "post_id": 59537708, "comment_id": 105250789, "body": "You are missing path separators in the folder name and a &quot;.&quot; in the file extension"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1577747382, "creation_date": 1577747382, "answer_id": 59537809, "question_id": 59537708, "link": "https://stackoverflow.com/questions/59537708/vba-error-1004-cant-find-file-name-when-trying-to-open-file/59537809#59537809", "title": "VBA Error 1004 Can&#39;t Find &quot;File Name&quot; When Trying To Open File", "body": "<p>Specify both the folder path and the file name:</p>\n\n<pre><code>Set attachmentWorkBook = Workbooks.Open(FolderName &amp; \"\\\" &amp; StrFile)\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12628272, "user_type": "registered", "profile_image": "https://graph.facebook.com/2590835014365096/picture?type=large", "display_name": "Marie Presley", "link": "https://stackoverflow.com/users/12628272/marie-presley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 59537809, "answer_count": 1, "score": 0, "last_activity_date": 1582051963, "creation_date": 1577746506, "last_edit_date": 1582051963, "question_id": 59537708, "link": "https://stackoverflow.com/questions/59537708/vba-error-1004-cant-find-file-name-when-trying-to-open-file", "title": "VBA Error 1004 Can&#39;t Find &quot;File Name&quot; When Trying To Open File", "body": "<p>I am trying to open all Excel files (.xlsx) in a specified folder and extract information from each one to add to a master spreadsheet for a report.</p>\n\n<p>I can't open the file. I get a</p>\n\n<blockquote>\n  <p>Run-time error '1004'</p>\n</blockquote>\n\n<p>saying it couldn't find FILE.xlsx.</p>\n\n<p>The file name is correct and matches the file name and extension (.xlsx).</p>\n\n<p>The last line of the code isn't working.</p>\n\n<pre><code>Dim FileName As String\nDim Folder As String\nDim Month As String\nDim File As Variant\n\nMonth = MonthName(CurrentMonth)\nFolder = \"C:\\Users\\mpresley\\Documents\\Other\\Ben\\Forecast Summary\\Forecast\"\nFolderName = Folder &amp; Month &amp; CurrentYear\n\nDim firstEmptyRow As Long\nDim attachmentFolder As String, StrFile As String, filenameCriteria As String\nDim attachmentWorkBook As Workbook\nDim copyRngToArray As Variant\n\n'# Set file extension\nfilenameCriteria = \"xlsx\"\n\n'set\nStrFile = Dir(FolderName &amp; \"\\*\" &amp; filenameCriteria)\nDo While Len(StrFile) &gt; 0\n    Set attachmentWorkBook = Workbooks.Open(StrFile)\n</code></pre>\n"}, {"tags": ["excel", "vba", "validation", "cascadingdropdown", "named-ranges"], "comments": [{"owner": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "edited": false, "score": 0, "creation_date": 1577772960, "post_id": 59537620, "comment_id": 105249988, "body": "What is the value of <code>targetWS.Names(currentDropDownListName).RefersToLocal</code> and <code>targetWs.Names(dropDownName).RefersToLocal</code> before the line which causes an error? Is it a valid formula? Have you tried to manually set a validation to a cell using exactly the same formula?"}, {"owner": {"reputation": 1, "user_id": 12628074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc4e809a4ab192075dbd652500f7d93?s=128&d=identicon&r=PG&f=1", "display_name": "user248691", "link": "https://stackoverflow.com/users/12628074/user248691"}, "reply_to_user": {"reputation": 327, "user_id": 8571717, "user_type": "registered", "profile_image": "https://graph.facebook.com/1524531667605038/picture?type=large", "display_name": "Kirill Tkachenko", "link": "https://stackoverflow.com/users/8571717/kirill-tkachenko"}, "edited": false, "score": 0, "creation_date": 1577802706, "post_id": 59537620, "comment_id": 105259529, "body": "The values are as wished and when I copy them and try it manually with these values it works fine. That is what I wanted to describe in the paragraph starting with &quot;When I add a break point...&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12628074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc4e809a4ab192075dbd652500f7d93?s=128&d=identicon&r=PG&f=1", "display_name": "user248691", "link": "https://stackoverflow.com/users/12628074/user248691"}, "is_accepted": true, "score": 0, "last_activity_date": 1577955792, "creation_date": 1577955792, "answer_id": 59560686, "question_id": 59537620, "link": "https://stackoverflow.com/questions/59537620/create-excel-data-validation-with-vba-using-named-ranges/59560686#59560686", "title": "Create excel data validation with vba using named ranges", "body": "<p>Since nobody around here got an idea up to now I guess this problem is fairly hard to solve or not solvable. In case anybody else wants to create cascading drop-down menus programmatically, here is a workaround, that works without tables, since I think the tables were the problem. By the way it is possible to format the worksheet as table <strong>afterwards</strong>:</p>\n\n<pre><code>Function createCascadingDropDown(sourceWs As Worksheet, targetWs As Worksheet, targetCorespondingColumn As Integer, targetDropDownColumn As Integer, sourceNumberOfRowsPerColumnAs Object)\n    Dim numberOfColumns As Integer, numberOfRows As Integer, targetLastRow As Long\n    Dim targetCorespondingColumnSecondRowRange As String, valDataName As String, counterName As String, useListeName As String\n    valDataName = \"ValData\" &amp; sourceWs.Name\n    counterName = \"Counter\" &amp; sourceWs.Name\n    useListeName = \"UseListe\" &amp; sourceWs.Name\n    targetLastRow = targetWs.Rows.CountLarge\n    numberOfCulumns = sourceNumberOfRowsPerColumn.Count\n    'Get the maximum number of rows in the source worksheet\n    numberOfRows = 0\n    For Each columnKey In sourceNumberOfRowsPerColumn.Keys\n        If sourceNumberOfRowsPerColumn(columnKey) &gt; numberOfRows Then\n            numberOfRows = sourceNumberOfRowsPerColumn(columnKey)\n        End If\n    Next columnKey\n    targetCorespondingColumnSecondRowRange = targetWs.Cells(1, targetCorespondingColumn).Address(RowAbsolute:=False, ColumnAbsolute:=True)\n    targetWs.Names.Add Name:=counterName, RefersTo:=\"=COUNTA(INDEX(\" &amp; valDataName &amp; \",,MATCH(\" &amp; targetWs.Name &amp; \"!\" &amp; targetCorespondingColumnSecondRowRange &amp; \",\" &amp; sourceWs.Name &amp; \"!$1:$1,0)))\"\n    targetWs.Names.Add Name:=useListeName, RefersTo:=\"=INDEX(\" &amp; valDataName &amp; \",1,MATCH(\" &amp; targetWs.Name &amp; \"!\" &amp; targetCorespondingColumnSecondRowRange &amp; \",\" &amp; sourceWs.Name &amp; \"!$1:$1,0)):INDEX(\" &amp; valDataName &amp; \",\" &amp; counterName &amp; \",MATCH(\" &amp; targetWs.Name &amp; \"!\" &amp; targetCorespondingColumnSecondRowRange &amp; \",\" &amp; sourceWs.Name &amp; \"!$1:$1,0))\"\n    With targetWs.Range(targetWs.Cells(2, targetDropDownColumn), targetWs.Cells(targetLastRow, targetDropDownColumn)).Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=\"=\" &amp; useListeName\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorTitle = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = False\n        .ShowError = True\n    End With\nEnd Function\n</code></pre>\n\n<p>Where <code>sourceNumberOfRowsPerColumn</code> has to be a dictionary and the <em>Master</em>-column is created elsewhere in the column <code>targetCorespondingColumn</code>. Also this solution allows only one cascading-step and the source of the <em>Master</em>-column is in a different worksheet.</p>\n\n<p>As a basis for this solution I took the example from <a href=\"https://www.contextures.com/xlDataVal15.html\" rel=\"nofollow noreferrer\">https://www.contextures.com/xlDataVal15.html</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 12628074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bc4e809a4ab192075dbd652500f7d93?s=128&d=identicon&r=PG&f=1", "display_name": "user248691", "link": "https://stackoverflow.com/users/12628074/user248691"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 59560686, "answer_count": 1, "score": 0, "last_activity_date": 1577963839, "creation_date": 1577745838, "last_edit_date": 1577963839, "question_id": 59537620, "link": "https://stackoverflow.com/questions/59537620/create-excel-data-validation-with-vba-using-named-ranges", "title": "Create excel data validation with vba using named ranges", "body": "<p>I have the following code:</p>\n\n<pre><code>Function createCascadingDropDown(sourceTable As ListObject, targetTable As ListObject, targetTableCorespondingColumn As Integer, targetWs As Worksheet, targetWsDropDownColumn As Integer)\n    Dim currentDropDownList As String, dropDownName As String, formula As String\n    Dim validationVariable As Validation\n    currentDropDownListName = targetWs.Name &amp; \"CurrentDropDownList\"\n    dropDownName = targetWs.Name &amp; \"DropDown\"\n    targetWs.Names.Add Name:=currentDropDownListName, RefersToLocal:=\"=INDEX(\" &amp; targetWs.Name &amp; \"!\" &amp; currentDropDownListName &amp; \";1;1):INDEX(\" &amp; targetWs.Name &amp; \"!\" &amp; currentDropDownListName &amp; \";COUNTA(\" &amp; targetWs.Name &amp; \"!\" &amp; currentDropDownListName &amp; \"))\"\n    targetWs.Names.Add Name:=dropDownName, RefersToLocal:=\"=INDEX(\" &amp; sourceTable.Name &amp; \";0;MATCH(INDEX(\" &amp; targetTable.Name &amp; \"[@];\" &amp; CStr(targetTableCorespondingColumn) &amp; \");\" &amp; sourceTable.Name &amp; \"[#Headers];0))\"\n    formula = \"=\" &amp; dropDownName\n    With targetWs.columns(targetWsDropDownColumn).EntireColumn.Validation\n        .Delete\n        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:=xlBetween, Formula1:=formula\n        .IgnoreBlank = True\n        .InCellDropdown = True\n        .InputTitle = \"\"\n        .InputMessage = \"\"\n        .ErrorTitle = \"\"\n        .ErrorMessage = \"\"\n        .ShowInput = False\n        .ShowError = True\n    End With\n    targetWs.Cells(1, targetWsColumn).Validation.Delete\nEnd Function\n</code></pre>\n\n<p>In general I am trying to programmatically build up a cascading drop-down-menu like in <a href=\"https://www.contextures.com/exceldatavaldependindextables.html\" rel=\"nofollow noreferrer\">https://www.contextures.com/exceldatavaldependindextables.html</a>.</p>\n\n<p>The problem occurs in the line where I add the validation. Here the error \"Application-defined or object-defined error\" comes up.</p>\n\n<p>When I add a break point and do this step manually it works, despite the fact, that excel tells me \"The source currently evaluates to an error. Do you want to continue?\". It might be that this is the problem; at least I found <a href=\"https://stackoverflow.com/questions/10510160/data-validation-with-vba\">this</a> and <a href=\"https://www.mrexcel.com/board/threads/how-to-add-erroneous-list-formula-validation-in-vba.840156/\" rel=\"nofollow noreferrer\">this</a>, which both did not help. Wrapping IFERROR around the formula makes it invalid.</p>\n\n<p>So I also tried to set the RefereToLocal to an empty cell (e.g. \"=$A$20\") and change it afterwards. Now the problem is, that it does not accept the <strong>exact same</strong> formula again:</p>\n\n<pre><code>targetWs.Names.Item(dropDownName).RefersToLocal =\"=INDEX(\" &amp; targetWs.Name &amp; \"!\" &amp; currentDropDownListName &amp; \";1;1):INDEX(\" &amp; targetWs.Name &amp; \"!\" &amp; currentDropDownListName &amp; \";COUNTA(\" &amp; targetWs.Name &amp; \"!\" &amp; currentDropDownListName &amp; \"))\"\n</code></pre>\n\n<p>I am really running out of ideas. In case you have any to solve also the original problem (implement a vba-free cascading drop-down using vba) I would be happy to about them!</p>\n"}, {"tags": ["excel", "vba", "adodb"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1577742536, "post_id": 59537097, "comment_id": 105244207, "body": "How large is <code>JobOrders</code> sheet in terms of rows and columns?"}, {"owner": {"reputation": 11, "user_id": 11218507, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218733316308050/picture?type=large", "display_name": "Chrisk", "link": "https://stackoverflow.com/users/11218507/chrisk"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1577743341, "post_id": 59537097, "comment_id": 105244474, "body": "@Parfait I am copying the whole sheet, but the actual amount of data in the sheet is very small at this point. Maybe 10-15 rows of data with 30 columns."}, {"owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 1, "creation_date": 1577744228, "post_id": 59537097, "comment_id": 105244751, "body": "Have you checked the <code>UsedRange.Address</code> for that <code>JobOrders</code> sheet? It might be that it&#39;s absurdly larger than what you expect to see for that particular."}, {"owner": {"reputation": 11, "user_id": 11218507, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218733316308050/picture?type=large", "display_name": "Chrisk", "link": "https://stackoverflow.com/users/11218507/chrisk"}, "reply_to_user": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "edited": false, "score": 0, "creation_date": 1577758786, "post_id": 59537097, "comment_id": 105247705, "body": "@this you nailed it. My usedrange was enormous. I was able to delete all of the unwanted rows/columns and, combined with the more efficient code from the answer below its working like a charm!"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11218507, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218733316308050/picture?type=large", "display_name": "Chrisk", "link": "https://stackoverflow.com/users/11218507/chrisk"}, "edited": false, "score": 0, "creation_date": 1577754010, "post_id": 59537486, "comment_id": 105246943, "body": "This code looks much more efficient than what I have, and I have put it in my sheet. I looked at the usedrange.address, and that is crazy big, which is probably what&#39;s causing the issue. How do you reduce that to what is actually being used?"}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": false, "score": 2, "last_activity_date": 1577744576, "creation_date": 1577744576, "answer_id": 59537486, "question_id": 59537097, "link": "https://stackoverflow.com/questions/59537097/copyfromrecordset-not-responding/59537486#59537486", "title": ".copyfromrecordset not responding", "body": "<p>While your situation is not too reproducible, possibly how your objects are uilitized might be the problem. Consider a DRY-er approach since you appear to be running nested <code>For</code>, <code>If</code>, and <code>Select</code>.</p>\n\n<ul>\n<li>Since all <code>Case</code> blocks are virtually the same, use them only to assign the SQL statement, worksheet name, and contact sheet column number</li>\n<li>Keep database objects, <code>objConncection</code> and <code>objRecordset</code>, near each other and open/close after needed querying and outputting task</li>\n<li>Use <code>With</code> blocks to avoid repeating object and better organize methods and properties</li>\n<li>Try releasing all objects with <code>Set obj = Nothing</code></li>\n</ul>\n\n<p>Refactored Code</p>\n\n<pre><code>For i = ...\n    ...\n    If ...\n        myConn = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; _\n                 \"Data Source=\" &amp; dbFile &amp; _\n                 \";Extended Properties=\"\"Excel 12.0 Xml;HDR=Yes;IMX=0\"\";\"\n\n        Select Case ...\n            ...\n            Case Is = 4\n                mySql = \"Select * FROM [Database$]\"\n                mySheet = \"Database\"\n                myContactCol = 17\n\n            Case Is = 5\n                mySql = \"Select * FROM [Documents$]\"\n                mySheet = \"Documents\"\n                myContactCol = 8\n\n            Case Is = 6\n                mySql = \"Select * FROM [JobOrders$]\"\n                mySheet = \"JobOrders\"\n                myContactCol = 29\n\n        End Select\n\n        objConnection.Open myConn                       ' OPEN CONNECTION\n        objRecordset.Open mySql                         ' OPEN RECORDSET\n        With ThisWorkbook.Sheets(mySheet)\n            .Range(\"A2\").CopyFromRecordset objRecordset\n            .Cells.WrapText = False\n        End With\n        objRecordset.Close                              ' CLOSE RECORDSET\n        objConnection.Close                             ' CLOSE CONNECTION\n\n        ThisWorkbook.Sheets(\"Contacts\").Cells(1, myContactCol).value = Now\n        Application.CutCopyMode = False\n\n        ' RELEASE SET OBJECTS\n        Set objFile = Nothing: Set objFSO = Nothing\n        Set objRecordset = Nothing: Set objConnection = Nothing\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11218507, "user_type": "registered", "profile_image": "https://graph.facebook.com/10218733316308050/picture?type=large", "display_name": "Chrisk", "link": "https://stackoverflow.com/users/11218507/chrisk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577744576, "creation_date": 1577741788, "last_edit_date": 1577742314, "question_id": 59537097, "link": "https://stackoverflow.com/questions/59537097/copyfromrecordset-not-responding", "title": ".copyfromrecordset not responding", "body": "<p>I have the below code which is copying data from a spreadsheet database which I have established a connection with and pasting it in the active workbook. There are 6 cases that it checks for, and depending on the case it it opens a recordset for the specific sheet. </p>\n\n<p>For 5 out of 6 cases, this works swimmingly. For the 6th case, the line:</p>\n\n<pre><code>ThisWorkbook.Sheets(\"JobOrders\").Range(\"A2\").CopyFromRecordset objRecordset\n</code></pre>\n\n<p>makes Excel Not Respond for about 15-20 seconds, and then it will continue to execute afterwords. I am at a complete loss on this. Below is what I believe to be all the relevant code.</p>\n\n<pre><code>        Set objConnection = CreateObject(\"ADODB.Connection\")\n        Set objRecordset = CreateObject(\"ADODB.Recordset\")\n        Set objFSO = CreateObject(\"Scripting.filesystemobject\")\n        dbFile = dbPath &amp; SheetArr(i)\n        Set objFile = objFSO.getfile(dbFile)\n        objConnection.Open \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; \"Data Source=\" &amp; dbFile &amp; \";Extended Properties=\"\"Excel 12.0 Xml;HDR=Yes;IMX=0\"\";\"\n        ...\n        Case Is = 4\n            objRecordset.Open \"Select * FROM [Database$]\", objConnection\n            ThisWorkbook.Sheets(\"Database\").Range(\"A2\").CopyFromRecordset objRecordset\n            ThisWorkbook.Sheets(\"Database\").Cells.WrapText = False\n            Application.CutCopyMode = False\n            objRecordset.Close\n            objConnection.Close\n            ThisWorkbook.Sheets(\"Contacts\").Cells(1, 17).value = Now\n        Case Is = 5\n            objRecordset.Open \"Select * FROM [Documents$]\", objConnection\n            ThisWorkbook.Sheets(\"Documents\").Range(\"A2\").CopyFromRecordset objRecordset\n            ThisWorkbook.Sheets(\"Documents\").Cells.WrapText = False\n            Application.CutCopyMode = False\n            objRecordset.Close\n            objConnection.Close\n            ThisWorkbook.Sheets(\"Contacts\").Cells(1, 8).value = Now\n        Case Is = 6\n            objRecordset.Open \"Select * FROM [JobOrders$]\", objConnection\n            ThisWorkbook.Sheets(\"JobOrders\").Range(\"A2\").CopyFromRecordset objRecordset\n            ThisWorkbook.Sheets(\"JobOrders\").Cells.WrapText = False\n            Application.CutCopyMode = False\n            objRecordset.Close\n            objConnection.Close\n            ThisWorkbook.Sheets(\"Contacts\").Cells(1, 29).value = Now\n    End Select\nEnd If\nNext i\n</code></pre>\n\n<p>Any help would be very appreciated! Let me know if you need more or have questions!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 113, "user_id": 12431810, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214746620159450/picture?type=large", "display_name": "Danielle Travassos", "link": "https://stackoverflow.com/users/12431810/danielle-travassos"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577741788, "post_id": 59536988, "comment_id": 105243943, "body": "It worked until I added the date part...."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 1, "creation_date": 1577742171, "post_id": 59536988, "comment_id": 105244067, "body": "In VBA the path is built using backslash... So, I would suggest to use &quot;\\&quot; instead of &quot;/&quot;."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1577742452, "post_id": 59536988, "comment_id": 105244171, "body": "You might want to check whether <code>mypath</code> contains the text you&#39;re expecting... And you probably need to add a folder separator (<code>&#47;</code> or <code>` after </code>complete<code>. Or between </code>mypath` and <code>myfilename</code> in the <code>Dir</code>."}, {"owner": {"reputation": 316, "user_id": 12131488, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EVDpB.jpg?s=128&g=1", "display_name": "SmileyFtW", "link": "https://stackoverflow.com/users/12131488/smileyftw"}, "edited": false, "score": 1, "creation_date": 1577742960, "post_id": 59536988, "comment_id": 105244357, "body": "Suggest you use <code>Application.PathSeparator</code> instead of an explicit string when building your path. I&#39;d also suggest checking that the folder exists and that the file exists before trying to open the file."}, {"owner": {"reputation": 113, "user_id": 12431810, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214746620159450/picture?type=large", "display_name": "Danielle Travassos", "link": "https://stackoverflow.com/users/12431810/danielle-travassos"}, "edited": false, "score": 0, "creation_date": 1577743140, "post_id": 59536988, "comment_id": 105244413, "body": "Hi All, Thank you for your reply. The Path does exist and the files are there. I added &quot;/&quot; after complete as Cindy suggested and it worked :). Thank you everyone for your help."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1577743795, "post_id": 59536988, "comment_id": 105244622, "body": "FYI you can check for a slash, and add automatically in a single line: <code>myPath = iif(Right$(myPath, 1) &lt;&gt;&quot;\\&quot;, myPath &amp; &quot;\\&quot;, myPath)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3795, "user_id": 6672923, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff4bdb9435397969c9b7d3acbdc1583?s=128&d=identicon&r=PG&f=1", "display_name": "zip", "link": "https://stackoverflow.com/users/6672923/zip"}, "is_accepted": true, "score": 1, "last_activity_date": 1577752648, "creation_date": 1577752648, "answer_id": 59538357, "question_id": 59536988, "link": "https://stackoverflow.com/questions/59536988/open-a-file-from-a-dynamic-path-in-vba/59538357#59538357", "title": "Open a file from a dynamic path in VBA", "body": "<p>Danielle,\nIf it was working before you added the date thing, I think its just because you are missing a forward slash:\nReplace:</p>\n\n<pre><code>mypath = \"//mynetworkpath/\" &amp; Format(Now, \"yyyy-mm\") &amp; \"/\" &amp; \"complete\"\n</code></pre>\n\n<p>with </p>\n\n<pre><code>mypath = \"//mynetworkpath/\" &amp; Format(Now, \"yyyy-mm\") &amp; \"/\" &amp; \"complete\" &amp; \"/\"\n</code></pre>\n\n<p>and just do  </p>\n\n<pre><code>Workbooks.Open (file) \n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 12431810, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214746620159450/picture?type=large", "display_name": "Danielle Travassos", "link": "https://stackoverflow.com/users/12431810/danielle-travassos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 0, "closed_date": 1577798119, "accepted_answer_id": 59538357, "answer_count": 1, "score": 0, "last_activity_date": 1577752648, "creation_date": 1577740938, "last_edit_date": 1577741199, "question_id": 59536988, "link": "https://stackoverflow.com/questions/59536988/open-a-file-from-a-dynamic-path-in-vba", "closed_reason": "Not suitable for this site", "title": "Open a file from a dynamic path in VBA", "body": "<p>I have a code that opens a excel file formats and closes. When I use only the network path, the code works perfectly. When I add the dynamic part of the path which is  \"//mynetworkpath/year-month/complete\", the code doesn't find the file. So the path is like this:   \"//mynetworkpath/2019-12/complete\". Could anyone tell me what I'm doing wrong?</p>\n\n<pre><code>Sub format_excel()\n\nApplication.ScreenUpdating = False\n\nDim mypath As String\n\nDim file As String\n\nmypath = \"//mynetworkpath/\" &amp; Format(Now, \"yyyy-mm\") &amp; \"/\" &amp; \"complete\"\n\nfile = Dir(mypath &amp; \"myfilename_*.xlsx\")\n\nIf Not IsEmpty(file) Then\n\n   Workbooks.Open (mypath &amp; file)\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1577949481, "creation_date": 1577949481, "answer_id": 59559647, "question_id": 59536967, "link": "https://stackoverflow.com/questions/59536967/import-outlook-contacts-in-vba-from-a-secondary-email/59559647#59559647", "title": "Import outlook contacts in vba from a secondary email", "body": "<p>Instead of calling <code>Namespace.GetDefaultFolder</code>, call <code>Store.GetDefaultFolder</code>. A <code>Store</code> object can be retrieved from the <code>Namespace.Stores</code> collection. </p>\n"}], "owner": {"reputation": 15, "user_id": 11121780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1fd89c1c1aeb1240203af503b2292dc?s=128&d=identicon&r=PG&f=1", "display_name": "F.Lost", "link": "https://stackoverflow.com/users/11121780/f-lost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577949481, "creation_date": 1577740795, "last_edit_date": 1577742273, "question_id": 59536967, "link": "https://stackoverflow.com/questions/59536967/import-outlook-contacts-in-vba-from-a-secondary-email", "title": "Import outlook contacts in vba from a secondary email", "body": "<p>So I'm having some difficulty with some VBA code and Outlook on MS Access. I'm trying to open the contacts folder from my outlook. The only thing is that I am trying to open it from a secondary email account as my email account does not have the same contacts as my company account on outlook. This is the following code that I have. When I run it, it will display the contacts on my default email account. I tried  using <code>.Session.Accounts</code> but that didn't work either. Is there a way I can open a folder from just the path? If so, how would I get the path for contacts folder? Thanks!</p>\n\n<pre><code>    Private Sub Command12_Click()\n    Dim xOutlookApp As Outlook.Application\n    Dim xNameSpace As Outlook.NameSpace\n    Dim xFolder As Outlook.Folder\n\n    '\n    'On Error Resume Next\n    Set xOutlookApp = New Outlook.Application\n    Set xNameSpace = xOutlookApp.Session\n    Set xFolder = xNameSpace.GetDefaultFolder(10)\n    xFolder.Display\n    '\n    Set xFolder = Nothing\n    Set xNameSpace = Nothing\n    Set xOutlookApp = Nothing\n    Exit Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "hyperlink", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 12627845, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2UW10u1lUnE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyZYrXEQr_O8tVjqyaTljGbVtMEw/photo.jpg?sz=128", "display_name": "Richard Raschke", "link": "https://stackoverflow.com/users/12627845/richard-raschke"}, "edited": false, "score": 0, "creation_date": 1577743635, "post_id": 59537136, "comment_id": 105244571, "body": "Thank you Cindy.  I am using early-binding, so that will answer that for you.  The piece in question is actually (y3,7) the phone number in question, and it is at the beginning of the piece of code I have quoted.  (y3,8) and (y3,9), (y3,10) and (y3,11) are also phone numbers, and you can see that all I am doing with them (at least the last ones) is inserting them at the left margin and then putting a hard return.  I have no problems creating the hyperlink.  I am not sure what you mean by &quot;How the document is manipulated&quot;  I would be quite happy to provide more code to be helpful in that."}, {"owner": {"reputation": 3, "user_id": 12627845, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2UW10u1lUnE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyZYrXEQr_O8tVjqyaTljGbVtMEw/photo.jpg?sz=128", "display_name": "Richard Raschke", "link": "https://stackoverflow.com/users/12627845/richard-raschke"}, "edited": false, "score": 0, "creation_date": 1577744690, "post_id": 59537136, "comment_id": 105244876, "body": "And, a couple of further questions...The hyperlink already exists in Excel.  Does that make a difference? This seems to suggest it&#39;s easier to create it in the VBA process.  Secondly, the address for a phone number is: &quot;+tel:&quot;followed by the phone number.  And, i am not sure to do that syntactally here.  Thanks."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 3, "user_id": 12627845, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2UW10u1lUnE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyZYrXEQr_O8tVjqyaTljGbVtMEw/photo.jpg?sz=128", "display_name": "Richard Raschke", "link": "https://stackoverflow.com/users/12627845/richard-raschke"}, "edited": false, "score": 0, "creation_date": 1577745384, "post_id": 59537136, "comment_id": 105245067, "body": "@RichardRaschke The key to all of this is to find out what field code syntax Word uses to hyperlink a telephone number. Look at the end of the Answer. This is not something I can do for you..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11818836"}, "edited": false, "score": 0, "creation_date": 1577753079, "post_id": 59537136, "comment_id": 105246787, "body": "Let&#39;s say you have a phone number like 555-123-4567. What would you expect the <i>link text</i> for that phone number to be? The reality is that some systems <i>wrongly interpret</i> numbers as phone numbers, for example."}, {"owner": {"reputation": 3, "user_id": 12627845, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2UW10u1lUnE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyZYrXEQr_O8tVjqyaTljGbVtMEw/photo.jpg?sz=128", "display_name": "Richard Raschke", "link": "https://stackoverflow.com/users/12627845/richard-raschke"}, "edited": false, "score": 0, "creation_date": 1577755057, "post_id": 59537136, "comment_id": 105247117, "body": "Ok.. I am trying this.....  I simply inserted Cindy&#39;s suggestion in my code:"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 3, "user_id": 12627845, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2UW10u1lUnE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyZYrXEQr_O8tVjqyaTljGbVtMEw/photo.jpg?sz=128", "display_name": "Richard Raschke", "link": "https://stackoverflow.com/users/12627845/richard-raschke"}, "edited": false, "score": 0, "creation_date": 1577796435, "post_id": 59537136, "comment_id": 105257518, "body": "@RichardRaschke I can&#39;t see where you&#39;ve tried creating a field code to get the necessary hyperlink address, as described <i>a the end of my answer</i> - after the code."}, {"owner": {"reputation": 3, "user_id": 12627845, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2UW10u1lUnE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyZYrXEQr_O8tVjqyaTljGbVtMEw/photo.jpg?sz=128", "display_name": "Richard Raschke", "link": "https://stackoverflow.com/users/12627845/richard-raschke"}, "edited": false, "score": 0, "creation_date": 1577808330, "post_id": 59537136, "comment_id": 105261429, "body": "Thanks again.  I have now put in this:                                                                             Dim rng As Word.Range             Set rng = Selection.Range             For y3 = (b + 1) To d                          &#39;FirstPhone             &#39;.TypeText (Cells(y3, 7)) &amp; vbTab                          If Cells(y3, 7) &lt;&gt; &quot;&quot; Then                 rng.Text = Cells(y3, 7)                 rng.Parent.Hyperlinks.Add rng, (&quot;tel:320-648-8777&quot; \\ t)             End If......................Again, the code seems to hang on the step of &quot;Set rng = Selection.Range"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "reply_to_user": {"reputation": 3, "user_id": 12627845, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2UW10u1lUnE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyZYrXEQr_O8tVjqyaTljGbVtMEw/photo.jpg?sz=128", "display_name": "Richard Raschke", "link": "https://stackoverflow.com/users/12627845/richard-raschke"}, "edited": false, "score": 0, "creation_date": 1577816462, "post_id": 59537136, "comment_id": 105263764, "body": "@RichardRaschke You don&#39;t provide enough code context. You &quot;obviously&quot; have a <code>With</code> in the code, somewhere &quot;above&quot; the code shown in the question. Without knowing exactly what that is, one can only guess. You might <i>try</i> <code>Set rng = .Range</code>. FWIW I doubt very much that <code>Hyperlinks.Add</code> in your comment will work as <code>\\t</code> is &quot;nonsense&quot;..."}, {"owner": {"reputation": 3, "user_id": 12627845, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2UW10u1lUnE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyZYrXEQr_O8tVjqyaTljGbVtMEw/photo.jpg?sz=128", "display_name": "Richard Raschke", "link": "https://stackoverflow.com/users/12627845/richard-raschke"}, "edited": false, "score": 0, "creation_date": 1577849228, "post_id": 59537136, "comment_id": 105268669, "body": "Thank you Cindy.  As I say, I am a very big rookie at this.  Now, I have a section of code reading like this: As you say, inside of With....the code reads...                         &#39;Print Individual information                      Dim rng As Word.Range             Set rng = .Range             For y3 = (b + 1) To d                          &#39;FirstPhone                 rng.Text = Cells(y3, 7) &amp; Chr(11)                 PhoneString = &quot;+tel:&quot; &amp; Cells(y3, 7)                 rng.Parent.Hyperlinks.Add rng, PhoneString..And, this works, but see next comment"}, {"owner": {"reputation": 3, "user_id": 12627845, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2UW10u1lUnE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyZYrXEQr_O8tVjqyaTljGbVtMEw/photo.jpg?sz=128", "display_name": "Richard Raschke", "link": "https://stackoverflow.com/users/12627845/richard-raschke"}, "edited": false, "score": 0, "creation_date": 1577849376, "post_id": 59537136, "comment_id": 105268679, "body": "The problem now is that I get the hyperlink, and it is correct, but it is printed after the next section of code (if you look at the original, that&#39;s a last name and potentially an address, and there is a 9604 error code.  I don&#39;t really understand how the next part of the code can be executed and .TypeText go in there BEFORE the hyperlink for the phone number.  Thank you again.  This is very helpful, and I am sorry for not copying the entire code in the first place."}, {"owner": {"reputation": 3, "user_id": 12627845, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2UW10u1lUnE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyZYrXEQr_O8tVjqyaTljGbVtMEw/photo.jpg?sz=128", "display_name": "Richard Raschke", "link": "https://stackoverflow.com/users/12627845/richard-raschke"}, "edited": false, "score": 0, "creation_date": 1577849572, "post_id": 59537136, "comment_id": 105268692, "body": "Please forgive me.  That is a 6028 error code.  My mistake."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1577864812, "post_id": 59537136, "comment_id": 105270367, "body": "What&#39;s the error <i>message</i>? No one memorizes the numbers... And it would help for you to use the <a href=\"https://stackoverflow.com/posts/59537136/edit\">edit</a> link below your question to update it with the <i>current</i> code that is inserting the Hyperlink but in the wrong place. Indicate the line of code causing the error (important!) and show screen shots of what the result looks like as well as how the result <i>should</i> look."}, {"owner": {"reputation": 3, "user_id": 12627845, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2UW10u1lUnE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyZYrXEQr_O8tVjqyaTljGbVtMEw/photo.jpg?sz=128", "display_name": "Richard Raschke", "link": "https://stackoverflow.com/users/12627845/richard-raschke"}, "edited": false, "score": 0, "creation_date": 1577891483, "post_id": 59537136, "comment_id": 105275684, "body": "Thanks again Cindy.  The error was due to the Set command not being within the print loop.  And, I had to learn how to use Selection.direction to move the insertion point to the end of the hyperlink rather than the beginning.  All is well now. Thank you so much."}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 0, "last_activity_date": 1577742081, "creation_date": 1577742081, "answer_id": 59537136, "question_id": 59536941, "link": "https://stackoverflow.com/questions/59536941/how-to-copy-a-hyperlink-from-a-single-cell-in-excel-to-a-word-document-which-is/59537136#59537136", "title": "How to copy a hyperlink from a single cell in excel to a word document which is being created and populated by VBA aleady?", "body": "<p>In order to do what you describe, it would be useful to make the transition from user emulation (the macro, likely recorded, does exactly what a user does) to working with Word's object model. Since only a code snippet is provided, it's difficult to demonstrate what this means, but...</p>\n\n<p>Rather than <code>Selection.TypeText</code>, in this context, it means working with a <code>Range</code> object, to which text can be assigned (<code>Range.Text = \"abc\"</code>). The <code>Range</code>can then also be used as the target object for creating a <code>Hyperlink</code> object. </p>\n\n<p>Taking just the line of code that seems to deal with the telephone number:</p>\n\n<pre><code>Dim rng as Word.Range `or Object, if late-binding is use - not evident from the code in the question\nSet rng = Selection.Range\nIf Cells(y3, 11) &lt;&gt; \"\" Then \n    rng.Text = Cells(y3, 11) &amp; Chr(11)  'Assign normal text\n    'rng.Parent is the document. I use this since there's no information in \n    'the question about how the document is manipulated in this code\n    rng.Parent.Hyperlinks.Add rng, \"link information\"\nEnd If\n</code></pre>\n\n<p>Note that I cannot give you the hyperlink address information as I do not know what that might be for a telephone number. My system does not hyperlink to telephone numbers. You have to research what the valid hyperlink address would be for a telephone number. Best would probably be to create one directly in Word, then press Alt+F9 to toggle to the underlying field code. That basic format is what is needed for <code>\"link information\"</code> in the code snippet, above.</p>\n"}], "owner": {"reputation": 3, "user_id": 12627845, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-2UW10u1lUnE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reyZYrXEQr_O8tVjqyaTljGbVtMEw/photo.jpg?sz=128", "display_name": "Richard Raschke", "link": "https://stackoverflow.com/users/12627845/richard-raschke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 59537136, "answer_count": 1, "score": 0, "last_activity_date": 1577755565, "creation_date": 1577740665, "last_edit_date": 1577741421, "question_id": 59536941, "link": "https://stackoverflow.com/questions/59536941/how-to-copy-a-hyperlink-from-a-single-cell-in-excel-to-a-word-document-which-is", "title": "How to copy a hyperlink from a single cell in excel to a word document which is being created and populated by VBA aleady?", "body": "<p>Very inexperienced with VBA, but trying to work on a project.  I have an excel file with lots of contact information.  Each entry contains Names, phone numbers, addresses for a particular family.</p>\n\n<p>I am creating an address book of sorts with this information, which requires a Word document (yes, there would be other ways to do this, but it's a joint project, and this is the chosen method).</p>\n\n<p>I am able to populate the entire address book in the way I want to, including page and page formatting, etc.</p>\n\n<p>Obviously, most of this is a case of following through the workbook in an orderly fashion, and using TypeText to put the various pieces of information where I want them.</p>\n\n<p>However, I would also like to make this a pdf, and put it on my phone, and make the phone numbers hyperlinks, so that I can dial them directly.  My only snag is maintaining the hyperlink in the transfer from Excel to Word.  It seems that .TypeText only carries the text, not the hyperlink formatting, so it's not doing what I need.</p>\n\n<p>Is there something else I can do?</p>\n\n<p>I am thinking that there is a Copy/Paste arrangement which would help me, but I lack enough experience to be able to insert such a routine in the middle of my code.</p>\n\n<p>This is the piece of code which transfers the phone numbers over:</p>\n\n<p>For y3 = (b + 1) To d</p>\n\n<pre><code>        'FirstPhone\n        .TypeText Value(Cells(y3, 7)) &amp; vbTab\n        'LastName\n        .BoldRun\n        If Cells(y3, 20) = \"U\" Then .Font.Underline = wdUnderlineSingle\n        .TypeText (Cells(y3, 3))\n        .Font.Underline = wdUnderlineNone\n        .BoldRun\n        'Logic to determine if there needs to be a hard return, and if there are more phones\n        ' Add if there is a spouse, or children, etc\n        .TypeText (\", \" &amp; Cells(y3, 4))\n          If Cells(y3, 5).Value &lt;&gt; \"\" Then .TypeText (\" &amp; \" &amp; Cells(y3, 5))\n          If Cells(y3, 6) &lt;&gt; \"\" Then .TypeText (\"; \" &amp; Cells(y3, 6))\n            Names = Cells(y3, 3) &amp; \", \" &amp; Cells(y3, 4) &amp; \" &amp; \" &amp; Cells(y3, 5) &amp; \"; \" &amp; Cells(y3, 6)\n            Address = Cells(y3, 15) &amp; \", \" &amp; Cells(y3, 17) &amp; \", \" &amp; Cells(y3, 18) &amp; \"  \" &amp; Cells(y3, 19)\n          If Len(Names) + Len(Address) &gt; 70 Or Cells(y3, 8) &lt;&gt; \"\" Then .TypeText (Chr(11))\n          If Cells(y3, 8) = \"\" And Address = \", ,   \" Then .TypeText (Chr(11))\n          If Cells(y3, 8) &lt;&gt; \"\" Then .TypeText (Cells(y3, 8))\n          If Cells(y3, 15) &lt;&gt; \"\" Then .TypeText (vbTab &amp; Address)\n          If Cells(y3, 8) &lt;&gt; \"\" Or Cells(y3, 15) &lt;&gt; \"\" Then .TypeText (Chr(11))\n          If Cells(y3, 9) &lt;&gt; \"\" Then .TypeText (Cells(y3, 9) &amp; Chr(11))\n          If Cells(y3, 10) &lt;&gt; \"\" Then .TypeText (Cells(y3, 10) &amp; Chr(11))\n          If Cells(y3, 11) &lt;&gt; \"\" Then .TypeText (Cells(y3, 11) &amp; Chr(11))\n\n        Next y3\n</code></pre>\n\n<p>y3 is the index of the rows. The 7th column in the Workbook is where the phone number is located.  The rest of this section is devoted to bringing in addresses, etc... And is not so necessary for the question.</p>\n\n<p>Prior to this piece of code, I have already created the Word Doc, chosen some formatting, and printed a section heading in the Word Doc.  That's why I can begin here by simply TypeText the contents of the cell in question.</p>\n\n<p>What I would like to know is:  How can I copy a hyperlink of a telephone number here, rather than simply typing the text into the WordDoc?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577779140, "post_id": 59536928, "comment_id": 105251642, "body": "Not an answer, but one way to get VBA to use the worksheetfunction would be: <code>Debug.Print [YEAR(A1)]</code>, obviously some other form of &quot;worksheetfunction&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1577740805, "post_id": 59536961, "comment_id": 105243600, "body": "I thought any formula in Excel was a member of <code>WorksheetFunction</code> - how can I know which are and which aren&#39;t?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1577740814, "post_id": 59536961, "comment_id": 105243602, "body": "Intellisense should help."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 2, "creation_date": 1577740850, "post_id": 59536961, "comment_id": 105243615, "body": "@dwirony if there is a natural vba that does the same then there is no worksheetfunction version."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1577740884, "post_id": 59536961, "comment_id": 105243623, "body": "^ <code>Round</code> being one exception, though <code>WorksheetFunction.Round</code> and <code>Round</code> don&#39;t operate the same way so maybe that&#39;s not really an exception."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1577740926, "post_id": 59536961, "comment_id": 105243637, "body": "Trim and worksheetfunction.trim also exist but they do different things."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1577740951, "post_id": 59536961, "comment_id": 105243649, "body": "Ah... I&#39;m surprised I hadn&#39;t run into this issue before. Good to know!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1577741007, "post_id": 59536961, "comment_id": 105243676, "body": "@BigBen Funny about the Intellisense, I was annoyed because it kept autopopulating to <code>YearFrac()</code>, I thought it was bugging out! Haha"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1577741041, "post_id": 59536961, "comment_id": 105243690, "body": "Haha yes that would be annoying."}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 2, "last_activity_date": 1577741164, "last_edit_date": 1577741164, "creation_date": 1577740752, "answer_id": 59536961, "question_id": 59536928, "link": "https://stackoverflow.com/questions/59536928/why-cant-i-use-application-worksheetfunction-year-on-a-date-or-long/59536961#59536961", "title": "Why can&#39;t I use Application.WorksheetFunction.Year() on a date or long?", "body": "<p>There is no <code>Year</code> method of <code>WorksheetFunction</code>, as Intellisense or the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheetfunction\" rel=\"nofollow noreferrer\">documentation</a> will quickly show. Since the <code>VBA.Year</code> and <code>VBA.Month</code> functions already exist, there is no need for a <code>WorksheetFunction</code> version.</p>\n\n<p>Just use the <code>Year</code> function.</p>\n"}], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 59536961, "answer_count": 1, "score": 0, "last_activity_date": 1577741164, "creation_date": 1577740605, "question_id": 59536928, "link": "https://stackoverflow.com/questions/59536928/why-cant-i-use-application-worksheetfunction-year-on-a-date-or-long", "title": "Why can&#39;t I use Application.WorksheetFunction.Year() on a date or long?", "body": "<p>I was tired and accidentally tried to use <code>Application.WorksheetFunction.Year()</code> instead of <code>Year()</code> in VBA, but this still puzzled me and I'm trying to figure out why this errors out. Take the following code:</p>\n\n<pre><code>Sub Test()\n\n    Dim mydate As Date\n\n    'In cell A1 on the activesheet is the short date \"12/30/2019\"\n    mydate = Range(\"A1\").Value\n\n    Debug.Print Application.WorksheetFunction.Year(mydate)\n\nEnd Sub\n</code></pre>\n\n<p>When <code>maxdate</code> is a <code>Date</code>, this results in </p>\n\n<blockquote>\n  <p>Run-time error '438': Object doesn't support this property or method.</p>\n</blockquote>\n\n<p>When <code>maxdate</code> is a <code>Long</code>, it results in the same error. Just for kicks I tried <code>Integer</code> (which obviously doesn't work since the serial number of a date is bigger than the <code>Integer</code> cap) so you get an overflow error.</p>\n\n<p>Why can't I use <code>Application.WorksheetFunction.Year()</code> or <code>Application.WorksheetFunction.Month()</code> here? I also tried using <code>CLng()</code> to convert it to what I thought the function was expecting, same results (Run-time error '438').</p>\n"}, {"tags": ["c#", "excel", "vba", "windows", "com"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1577741397, "post_id": 59536773, "comment_id": 105243814, "body": "What do you mean by &quot;previously&quot;? WHEN was &quot;previously&quot;? What changed? Do you mean the problem occurred when you moved to C#? As far as I know, C# has always supported <i>only</i> 0-based arrays. VBA supports 1- or 0-based. About ATL I don&#39;t know..."}, {"owner": {"reputation": 2123, "user_id": 3715853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ab97a97ef6e4c263972d713671b58e3?s=128&d=identicon&r=PG&f=1", "display_name": "Holger", "link": "https://stackoverflow.com/users/3715853/holger"}, "edited": false, "score": 0, "creation_date": 1577742691, "post_id": 59536773, "comment_id": 105244261, "body": "here are some hints about what works, and what doesn&#39;t. <a href=\"https://stackoverflow.com/questions/56446/net-arrays-with-lower-bound-0\" title=\"net arrays with lower bound 0\">stackoverflow.com/questions/56446/net-arrays-with-lower-boun&zwnj;&#8203;d-0</a>  with ToArray() you can always create a quick 0-based copy of your array, if this is already sufficient."}, {"owner": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1577746182, "post_id": 59536773, "comment_id": 105245322, "body": "When you use an array in VBA with lower boundary 1 there is still an index zero with no data.  So if you are passing the array to c# nothing will change.  c# arrays have a GetLowerBound property just like VBA,  Are you sure you fully compiled before changing.  Try again to be sure it works with an lower boundary zero."}, {"owner": {"reputation": 197, "user_id": 8119788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03634f0195e28990d601365c2ebd96d9?s=128&d=identicon&r=PG&f=1", "display_name": "Johan A", "link": "https://stackoverflow.com/users/8119788/johan-a"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1577746906, "post_id": 59536773, "comment_id": 105245486, "body": "@CindyMeister With previously, I meant with the legacy ATL COM function. Peeking into the header file of that project reveals that the same function has the same COM interface, i.e. arrays defined as SAFEARRAY*."}, {"owner": {"reputation": 197, "user_id": 8119788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03634f0195e28990d601365c2ebd96d9?s=128&d=identicon&r=PG&f=1", "display_name": "Johan A", "link": "https://stackoverflow.com/users/8119788/johan-a"}, "reply_to_user": {"reputation": 28373, "user_id": 5015238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8790f8091d3c6c58fd45664a165117a?s=128&d=identicon&r=PG", "display_name": "jdweng", "link": "https://stackoverflow.com/users/5015238/jdweng"}, "edited": false, "score": 0, "creation_date": 1577747103, "post_id": 59536773, "comment_id": 105245540, "body": "@jdweng I have tried and it works fine with lower boundary set to zero. It compiles also when it&#39;s set to 1. But during runtime I get that runtime error 5. It doesn&#39;t even enter into the DLL file, so that I can debug it. It just bounces off, as somehow the interface doesn&#39;t match."}, {"owner": {"reputation": 197, "user_id": 8119788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03634f0195e28990d601365c2ebd96d9?s=128&d=identicon&r=PG&f=1", "display_name": "Johan A", "link": "https://stackoverflow.com/users/8119788/johan-a"}, "edited": false, "score": 0, "creation_date": 1577749605, "post_id": 59536773, "comment_id": 105246071, "body": "Found a hint at <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/interop/default-marshaling-for-arrays\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/framework/interop/&hellip;</a> where it reads: &quot;Multidimensional, or nonzero-bound safe arrays, can be marshaled into managed code if the method signature produced by Tlbimp.exe is modified to indicate an element type of ELEMENT_TYPE_ARRAY instead of ELEMENT_TYPE_SZARRAY. Alternatively, you can use the /sysarray switch with Tlbimp.exe to import all arrays as System.Array objects&quot;."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1577779284, "post_id": 59536773, "comment_id": 105251690, "body": "You have to change the parameter type to <code>Array</code> and state the SafeArraySubType in the attribute.  Use the Array methods to access the array in your C# code (GetLowerBound, GetUpperBound, GetValue)."}, {"owner": {"reputation": 197, "user_id": 8119788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03634f0195e28990d601365c2ebd96d9?s=128&d=identicon&r=PG&f=1", "display_name": "Johan A", "link": "https://stackoverflow.com/users/8119788/johan-a"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1577802097, "post_id": 59536773, "comment_id": 105259338, "body": "@HansPassant You mean the C# core function has to use System.Array instead of double[]?"}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1577802266, "post_id": 59536773, "comment_id": 105259390, "body": "Yes.  You declared LinearInterpolation() with double[] parameters, that needs to be Array parameters to let the VBA code pass non-conformant arrays."}], "answers": [{"tags": [], "owner": {"reputation": 197, "user_id": 8119788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03634f0195e28990d601365c2ebd96d9?s=128&d=identicon&r=PG&f=1", "display_name": "Johan A", "link": "https://stackoverflow.com/users/8119788/johan-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1577960621, "creation_date": 1577960621, "answer_id": 59561714, "question_id": 59536773, "link": "https://stackoverflow.com/questions/59536773/vba-array-with-lower-boundary-0-passed-to-net/59561714#59561714", "title": "VBA array with lower boundary &gt; 0 passed to .NET", "body": "<p>Changing the method signature in the COM-wrappers Interface to using Array instead of double[] and defining SafeArraySubType:</p>\n\n<pre><code>[return: MarshalAs(UnmanagedType.R8)] double \n   LinearInterpolation(\n     [MarshalAs(UnmanagedType.SafeArray, SafeArraySubType = VarEnum.VT_R8 )]Array psaXvector, \n     [MarshalAs(UnmanagedType.SafeArray, SafeArraySubType = VarEnum.VT_R8 )]Array psaYvector, \n     [MarshalAs(UnmanagedType.R8)]double Xvalue);\n\n</code></pre>\n\n<p>This allows a COM Safearray being passed to the method being defined from [n to m] where n > 0.  </p>\n\n<p>Before the array is passed on to the core C# method, it's converted from Array to double[] in the COM-wrapper Class</p>\n\n<pre><code>public double LinearInterpolation(Array psaXvector, Array psaYvector, double Xvalue)\n{\n    double[] xarray = psaXvector.OfType&lt;double&gt;().ToArray();\n    double[] yarray = psaYvector.OfType&lt;double&gt;().ToArray();\n    return _mix.LinearInterpolation(xarray, yarray, Xvalue);\n}\n</code></pre>\n"}], "owner": {"reputation": 197, "user_id": 8119788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03634f0195e28990d601365c2ebd96d9?s=128&d=identicon&r=PG&f=1", "display_name": "Johan A", "link": "https://stackoverflow.com/users/8119788/johan-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577960621, "creation_date": 1577739501, "question_id": 59536773, "link": "https://stackoverflow.com/questions/59536773/vba-array-with-lower-boundary-0-passed-to-net", "title": "VBA array with lower boundary &gt; 0 passed to .NET", "body": "<p>I have .NET Dll with a C# method, which I use in Excel VBA. It's being called through a COM-wrapper from VBA. The method takes among others, two double arrays as arguments. </p>\n\n<p>When the double arrays are defined in VBA with a lower boundary of 1, and being passed to the C# method though COM, Excel fails with following error:</p>\n\n<p><strong>Runtime error 5</strong> <em>(Invalid procedure call or argument)</em> </p>\n\n<p>Although it may sound crazy, I would want to be able to pass a VBA/COM array with lower boudary of 1 to C# .NET. Is this possible?</p>\n\n<p>This is how the C# function is declared:</p>\n\n<pre><code>public double LinearInterpolation(\n                                double[] psaXvector,\n                                double[] psaYvector,\n                                double Xvalue)\n{\n</code></pre>\n\n<p>The COM-wrapper in C#</p>\n\n<pre><code> [Guid(\"CE93D637-0673-4EBC-8FFA-6CE162959262\")]\n [ComVisible(true)]\n [InterfaceType(ComInterfaceType.InterfaceIsDual)]\n public interface IMixedTools\n {\n   [DispId(1)]\n   [return: MarshalAs(UnmanagedType.R8)] double \n   LinearInterpolation(\n     [MarshalAs(UnmanagedType.SafeArray)]double[] psaXvector, \n     [MarshalAs(UnmanagedType.SafeArray)]double[] psaYvector, \n     [MarshalAs(UnmanagedType.R8)]double Xvalue);\n</code></pre>\n\n<p>This is what the generated .tlh file looks like</p>\n\n<pre><code>struct __declspec(uuid(\"ce93d637-0673-4ebc-8ffa-6ce162959262\"))\nIMixedTools : IDispatch\n{\n  virtual HRESULT __stdcall LinearInterpolation (\n    /*[in]*/ SAFEARRAY * psaXvector,\n    /*[in]*/ SAFEARRAY * psaYvector,\n    /*[in]*/ double Xvalue,\n    /*[out,retval]*/ double * pRetVal ) = 0;\n</code></pre>\n\n<p>The calling VBA code</p>\n\n<pre><code>  Dim mixu As Object\n  Set mixu = CreateObject(\"TlibCOM.CMixedTools\")\n  Dim Xarr() As Double\n  Dim Yarr() As Double\n  ReDim Xarr(1 To 4) As Double\n  ReDim Yarr(1 To 4) As Double\n  Dim x As Double\n\n  Xarr(1) = 1\n  Xarr(2) = 2\n  Xarr(3) = 5\n  Xarr(4) = 7.5\n\n  Yarr(1) = 14\n  Yarr(2) = 9\n  Yarr(3) = 4\n  Yarr(4) = -3\n\n  x = 4\n  result = mixu.LinearInterpolation(Xarr, Yarr, x)\n\n  Set mixu = Nothing\n</code></pre>\n\n<p>If I define the arrays with lower boundaries of 0, the function will work. But I have a quite large legacy codebase where arrays may be defined either with 0 or 1 as lower boundary of arrays, so the functions having arrays as arguments would need to be able to handle this.</p>\n\n<p>The C# .NET DLL is a library of methods, replacing legacy ATL COM functions. Previously this was not an issue whether the double array passed from VBA was having a low boundary of 1 or 0. </p>\n\n<p>Is there a way to go round this limitation, so that VBA can pass an array with the low boundary of 1, to C# methods in a DLL? </p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1577752400, "post_id": 59536648, "comment_id": 105246643, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/59529165/what-does-openrecordset-return\">What does OpenRecordset return</a>"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 1, "creation_date": 1577778909, "post_id": 59536648, "comment_id": 105251583, "body": "See <a href=\"https://stackoverflow.com/a/5942862/9439330\">stackoverflow.com/a/5942862/9439330</a>. Scope is workspace, not database. @Lee Mac will update his answer (or I do)."}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 2, "creation_date": 1577778723, "post_id": 59537958, "comment_id": 105251510, "body": "Add infos from <a href=\"https://stackoverflow.com/a/5942862/9439330\">stackoverflow.com/a/5942862/9439330</a>, as Dao uses the workspace as scope"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1577801322, "post_id": 59537958, "comment_id": 105259119, "body": "@ComputerVersteher Thank you for this valuable clarification - I have updated my answer above."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 2, "last_activity_date": 1577801303, "last_edit_date": 1577801303, "creation_date": 1577748622, "answer_id": 59537958, "question_id": 59536648, "link": "https://stackoverflow.com/questions/59536648/how-to-know-the-id-of-the-most-recently-added-record/59537958#59537958", "title": "How to know the ID of the most recently added record?", "body": "<p>Firstly, you should be aware that this method of obtaining the autonumber value for the most recently added record only works reliably when evaluated within the scope of the same database workspace which created the record (when using DAO) or the same database connection (when using ADO). Evaluated independently of such connection, the statement will merely yield <code>0</code>.</p>\n\n<h3>Example</h3>\n\n<p>Say we have a table called <code>Table1</code> with two fields:</p>\n\n<pre><code>Table1\n+------------+--------+\n|     ID     | Field1 |\n+------------+--------+\n| AutoNumber | Text   |\n+------------+--------+\n</code></pre>\n\n<p>We can create a new record using the following code:</p>\n\n<pre><code>With CurrentDb\n    .Execute \"insert into table1 (field1) values ('abc')\"\nEnd With\n</code></pre>\n\n<p>If we want to find the value assigned to the AutoNumber field <code>ID</code>, we can then do this:</p>\n\n<pre><code>With CurrentDb\n    .Execute \"insert into table1 (field1) values ('abc')\"\n    Debug.Print .OpenRecordset(\"select @@identity\")(0)\nEnd With\n</code></pre>\n\n<h3>What is <code>@@IDENTITY</code>?</h3>\n\n<p>Note that the SQL statement used in the above example is independent of any one particular table or field (there is no <code>from</code> clause), as the <code>@@identity</code> column merely refers to the last autonumber value issued (to any record within any table) for the current database workspace (DAO)/connection (ADO).</p>\n\n<p>This <a href=\"https://docs.microsoft.com/en-us/sql/t-sql/functions/identity-transact-sql?view=sql-server-ver15\" rel=\"nofollow noreferrer\">T-SQL documentation</a> may help with your understanding, but note that this applies to SQL Server, not MS Access, and so whilst this provides a description of the purpose of <code>@@identity</code>, not everything will translate directly to MS Access.</p>\n\n<h3>How Does <code>.OpenRecordset(\"...\")(0)</code> Work?</h3>\n\n<p>As for the use of <code>(0)</code> directly following the <code>.OpenRecordset</code> method, this simply shorthand for accessing the first item in the <code>Fields</code> collection (which is the default member of the <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/recordset-object-dao\" rel=\"nofollow noreferrer\">Recordset class</a>), and is therefore equivalent to:</p>\n\n<pre><code>.OpenRecordset(\"select @@identity\").Fields(0)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 3640838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a686245e0f976e1fa490fd39573de09?s=128&d=identicon&r=PG&f=1", "display_name": "JoCaBa", "link": "https://stackoverflow.com/users/3640838/jocaba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 59537958, "answer_count": 1, "score": 0, "last_activity_date": 1587958990, "creation_date": 1577738610, "last_edit_date": 1587958990, "question_id": 59536648, "link": "https://stackoverflow.com/questions/59536648/how-to-know-the-id-of-the-most-recently-added-record", "title": "How to know the ID of the most recently added record?", "body": "<p>I want to know the ID of the most recently added record.</p>\n\n<p>From a posting on StackOverflow, I use</p>\n\n<pre><code>nNewID = CurrentDb.OpenRecordset(\"SELECT @@IDENTITY\")(0)\n</code></pre>\n\n<p>There doesn't seem to be any reference to the table that the record has been added to - so does @@IDENTITY refer to the last added record, whichever table it was added to? Also what is the role of the (0) at the end of the statement?</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 28253, "user_id": 1139830, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/fAXTi.jpg?s=128&g=1", "display_name": "mason", "link": "https://stackoverflow.com/users/1139830/mason"}, "edited": false, "score": 5, "creation_date": 1577737586, "post_id": 59536464, "comment_id": 105242546, "body": "You should include the full error message in your question. And of course look up what that error means. Seems like this is one you should be able to get on your own."}, {"owner": {"reputation": 173187, "user_id": 128165, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cdef5bd2099545a776ee86fb8049bdc6?s=128&d=identicon&r=PG", "display_name": "Gabriele Petrioli", "link": "https://stackoverflow.com/users/128165/gabriele-petrioli"}, "edited": false, "score": 0, "creation_date": 1577737708, "post_id": 59536464, "comment_id": 105242585, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/5445062/run-time-error-3061-too-few-parameters-expected-1-access-2007\">Run-time error &#39;3061&#39;. Too few parameters. Expected 1. (Access 2007)</a>"}], "answers": [{"tags": [], "owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "is_accepted": false, "score": 0, "last_activity_date": 1577738189, "creation_date": 1577738189, "answer_id": 59536577, "question_id": 59536464, "link": "https://stackoverflow.com/questions/59536464/passing-values-in-database-execute-returns-an-error-3061/59536577#59536577", "title": "Passing values in Database.Execute returns an error 3061", "body": "<p>In the list of columns:</p>\n\n<pre><code>(Aanmaakdatum, VerlofDatum, VerlofReden, Aantal, me.VerlofPoule, Notitie, Status)\n</code></pre>\n\n<p>what is <code>me.VerlofPoule</code>?<br/>\nThis is not a column's name, right?<br/>\nChange it to the correct column name.</p>\n"}, {"tags": [], "owner": {"reputation": 15289, "user_id": 27968, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4706003a8f571f612606affcb2e9417e?s=128&d=identicon&r=PG", "display_name": "Paul Williams", "link": "https://stackoverflow.com/users/27968/paul-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1577738204, "creation_date": 1577738204, "answer_id": 59536582, "question_id": 59536464, "link": "https://stackoverflow.com/questions/59536464/passing-values-in-database-execute-returns-an-error-3061/59536582#59536582", "title": "Passing values in Database.Execute returns an error 3061", "body": "<p>I found in <a href=\"https://stackoverflow.com/questions/5445062/run-time-error-3061-too-few-parameters-expected-1-access-2007\">this question</a> that error 3061 is \"\"Run-time error '3061'. Too few parameters.\"  According to the answer on that question, the insert column names could be wrong.</p>\n\n<p>It looks like the query has a column named <code>me.VerlofPoule</code>.  That is also the value that is supposed to go into this column.  Maybe this is supposed to be the name of a different column?</p>\n"}, {"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 0, "last_activity_date": 1577738232, "creation_date": 1577738232, "answer_id": 59536587, "question_id": 59536464, "link": "https://stackoverflow.com/questions/59536464/passing-values-in-database-execute-returns-an-error-3061/59536587#59536587", "title": "Passing values in Database.Execute returns an error 3061", "body": "<p>The fifth column in your <code>insert</code> statement isn't a valid field name:</p>\n\n<pre><code>CurrentDb.Execute \"INSERT INTO tblVerlof(Aanmaakdatum, VerlofDatum, VerlofReden, Aantal, me.VerlofPoule, Notitie, Status)VALUES(now(), me.startdatum, 2, me.txturen, me.verlofpoule, me.txttitel, 2)\"\n                                                                         This field -----^\n</code></pre>\n\n<p>If the field name is represented by the value held by the <code>VerlofPoule</code> control on your form, then you would need to concatenate the field name, as it will not be evaluated when the SQL statement is executed.</p>\n\n<p>Similarly, the <code>Me.XXX</code> items in your <code>values</code> clause will also not be evaluated, instead, you should either use parameters or reference the form controls using the syntax: <code>Forms![YourForm]![YourControl]</code></p>\n"}, {"tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 2, "last_activity_date": 1577738817, "creation_date": 1577738817, "answer_id": 59536677, "question_id": 59536464, "link": "https://stackoverflow.com/questions/59536464/passing-values-in-database-execute-returns-an-error-3061/59536677#59536677", "title": "Passing values in Database.Execute returns an error 3061", "body": "<p>Of the <a href=\"https://stackoverflow.com/a/59493412/1422451\">multiple ways</a> to run action queries in MS Access VBA, for <code>Database.Execute</code> you cannot pass form values directly in SQL and should avoid concatenating values from VBA into the SQL. </p>\n\n<p>Instead, consider using  <code>DoCmd.OpenQuery</code> or <code>QueryDefs.Execute</code> to parameterize form controls into SQL statement:</p>\n\n<p><strong>DoCmd.OpenQuery</strong> approach</p>\n\n<p>SQL <em>(save as a query object)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>INSERT INTO tblVerlof(Aanmaakdatum, VerlofDatum, VerlofReden, Aantal, \n                      VerlofPoule, Notitie, Status)\nVALUES(NOW(), Forms!myform!startdatum, 2, Forms!myform!txturen, \n       Forms!myform!verlofpoule, Forms!myform!txttitel, 2)\n</code></pre>\n\n<p>VBA <em>(no need to close action queries)</em></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.OpenQuery \"mySavedQuery\"\n</code></pre>\n\n<hr>\n\n<p><strong>QueryDefs.Execute</strong> approach</p>\n\n<p>SQL <em>(save as a query object and <code>PARAMETERS</code> clause is valid in Access SQL)</em></p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>PARAMETERS prm_startdatum Date, prm_txturen Text,\n           prm_verlofpoule Text, prm_txttitel Text;\nINSERT INTO tblVerlof(Aanmaakdatum, VerlofDatum, VerlofReden, Aantal, \n                      VerlofPoule, Notitie, Status)\nVALUES(NOW(), prm_startdatum, 2, prm_txturen, \n       prm_verlofpoule, prm_txttitel, 2)\n</code></pre>\n\n<p>VBA</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim qdef As QueryDef\n\nSet qdef = CurrentDb.QueryDefs(\"mySavedQuery\")\n\nqdef!prm_startdatum   = Me.startdatum\nqdef!prm_txturen      = Me.txturen\nqdef!prm_verlofpoule  = Me.verlofpoule\nqdef!prm_txttitel     = Me.txttitel\n\nqdef.Execute\n\nSet qdef = Nothing\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 12160565, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mByekkKX-l7b3GiVGqOhuuTGR2Ol6if44XodZxZsw=k-s128", "display_name": "Quincy Chamberlain", "link": "https://stackoverflow.com/users/12160565/quincy-chamberlain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 59536677, "answer_count": 4, "score": -3, "last_activity_date": 1587959004, "creation_date": 1577737459, "last_edit_date": 1587959004, "question_id": 59536464, "link": "https://stackoverflow.com/questions/59536464/passing-values-in-database-execute-returns-an-error-3061", "title": "Passing values in Database.Execute returns an error 3061", "body": "<p>I assigned the code below to a commandbutton.</p>\n\n<p>It returns an error (3061).</p>\n\n<pre><code>CurrentDb.Execute \"INSERT INTO tblVerlof(Aanmaakdatum, VerlofDatum, VerlofReden, Aantal, me.VerlofPoule, Notitie, Status)VALUES(now(), me.startdatum, 2, me.txturen, me.verlofpoule, me.txttitel, 2)\"\n</code></pre>\n"}, {"tags": ["excel", "vba", "google-chrome"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1577736837, "post_id": 59536323, "comment_id": 105242269, "body": "Have you any parenthesis around search? like <code>&quot;one two three&quot;</code>"}, {"owner": {"reputation": 1, "user_id": 12627558, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD01YhtCjoPS9nW54e3VqHfLLANEBeeLUQfkChh=k-s128", "display_name": "El Paso", "link": "https://stackoverflow.com/users/12627558/el-paso"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577737072, "post_id": 59536323, "comment_id": 105242360, "body": "im afraid im not sure what you mean by parenthesis?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577737291, "post_id": 59536323, "comment_id": 105242436, "body": "Like the example <code>&quot;one two three&quot;</code> or are you passing like <code>one two three</code>"}, {"owner": {"reputation": 1, "user_id": 12627558, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD01YhtCjoPS9nW54e3VqHfLLANEBeeLUQfkChh=k-s128", "display_name": "El Paso", "link": "https://stackoverflow.com/users/12627558/el-paso"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577737972, "post_id": 59536323, "comment_id": 105242679, "body": "you put me on the right path, a quick dummies guide to parenthesis has solved it. thanks"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577739143, "post_id": 59536323, "comment_id": 105243045, "body": "no worries.  They can quickly become confusing in themselves :o)"}], "owner": {"reputation": 1, "user_id": 12627558, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mD01YhtCjoPS9nW54e3VqHfLLANEBeeLUQfkChh=k-s128", "display_name": "El Paso", "link": "https://stackoverflow.com/users/12627558/el-paso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 250, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577741242, "creation_date": 1577736558, "last_edit_date": 1577741242, "question_id": 59536323, "link": "https://stackoverflow.com/questions/59536323/my-vba-code-to-open-chrome-and-use-the-text-from-a-cell-is-opening-multiple-tabs", "title": "My VBA code to open Chrome and use the text from a cell is opening multiple tabs instead of just 1", "body": "<p>I have some text in cell B3 which I want to use to search Chrome. Sometimes the text has several words and for each word it is opening a separate tab. How do I work the code below to use the full text in a single tab?</p>\n\n<p>Dim search As String</p>\n\n<p>search = Range(\"b3\").Value</p>\n\n<p>Shell (\"C:\\Program Files (x86)\\Google\\Chrome\\Application\\chrome.exe -url \" &amp; search)</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1577735593, "post_id": 59536138, "comment_id": 105241842, "body": "Use <code>&amp;</code> to concatenate, not <code>+</code>."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1577735731, "post_id": 59536138, "comment_id": 105241897, "body": "Also, you could look at using parameters also  <a href=\"https://stackoverflow.com/questions/10352211/vba-ado-connection-and-query-parameters\" title=\"vba ado connection and query parameters\">stackoverflow.com/questions/10352211/&hellip;</a>"}, {"owner": {"reputation": 328, "user_id": 251887, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3b5d234e288c4d1e9bad807771fcb67?s=128&d=identicon&r=PG", "display_name": "HunterX3", "link": "https://stackoverflow.com/users/251887/hunterx3"}, "edited": false, "score": 3, "creation_date": 1577735739, "post_id": 59536138, "comment_id": 105241902, "body": "Your query is trying to compare a number field type to a string.  Remove the single quotes."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1577740987, "post_id": 59536138, "comment_id": 105243668, "body": "To avoid <a href=\"https://xkcd.com/327/\" rel=\"nofollow noreferrer\">SQL injection</a> (which may not work in Access but can if you later switch backends to Access app), consider parameterization as @Nathan_Sav. This is a good practice beyond VBA and beyond Access."}], "answers": [{"comments": [{"owner": {"reputation": 2358, "user_id": 5730279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GYwj.jpg?s=128&g=1", "display_name": "hc_dev", "link": "https://stackoverflow.com/users/5730279/hc-dev"}, "edited": false, "score": 1, "creation_date": 1577747476, "post_id": 59536495, "comment_id": 105245606, "body": "Thanks to <a href=\"https://stackoverflow.com/questions/59536138/how-to-write-a-query-that-uses-a-number-as-parameter-and-number-type-field/59536495#comment105241902_59536138\">HunterX3: for setting the main focus</a>, <a href=\"https://stackoverflow.com/questions/59536138/how-to-write-a-query-that-uses-a-number-as-parameter-and-number-type-field/59536495#comment105241842_59536138\">BigBen: for the concat-hint</a>,  <a href=\"https://stackoverflow.com/questions/59536138/how-to-write-a-query-that-uses-a-number-as-parameter-and-number-type-field/59536495#comment105241897_59536138\">Nathan_Sav: for parameterized-queries</a>."}], "tags": [], "owner": {"reputation": 2358, "user_id": 5730279, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9GYwj.jpg?s=128&g=1", "display_name": "hc_dev", "link": "https://stackoverflow.com/users/5730279/hc-dev"}, "is_accepted": false, "score": 1, "last_activity_date": 1577747446, "last_edit_date": 1577747446, "creation_date": 1577737654, "answer_id": 59536495, "question_id": 59536138, "link": "https://stackoverflow.com/questions/59536138/how-to-write-a-query-that-uses-a-number-as-parameter-and-number-type-field/59536495#59536495", "title": "How to write a query that uses a number as parameter and number type field?", "body": "<h3>Multiple Issues</h3>\n\n<ol>\n<li><p><strong>Type-mismatch</strong> in WHERE clause:\nYour query (i.e. the WHERE clause) tries to compare a Number-column from database with a String-value (e.g. <code>WHERE numberField = '123'</code>). This will result in a runtime error <a href=\"https://docs.microsoft.com/en-us/office/vba/Language/Reference/User-Interface-Help/type-mismatch-error-13\" rel=\"nofollow noreferrer\">Type mismatch (Error 13)</a>. See also <a href=\"https://stackoverflow.com/questions/8885506/excel-vba-run-time-error-13-type-mismatch\">similar question</a>.</p></li>\n<li><p><strong>Unsafe to use <code>+</code></strong> to concatenate Strings \nWhen building the query you tried to concatenate the query-template with the number-parameter by a plus-sign. This works only when operating on numbers. See <a href=\"https://stackoverflow.com/questions/7743823/concatenating-strings-in-vba\">related question</a></p></li>\n</ol>\n\n<h3>Solution</h3>\n\n<ol>\n<li>remove single-quotes: you should compare the Number-column <code>NMT</code> with a number literal (e.g. <code>WHERE nmt = 123</code>)</li>\n<li>use <code>&amp;</code> to concatenate strings. This will also convert numbers to strings. Besides I explicitly used <code>CStr</code> function below.</li>\n</ol>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim Con As New ADODB.Connection\nDim RS As New ADODB.Recordset\nDim strSQL As String\nDim nmtNumber as Integer ' you named it x before\n\nnmtNumber = me.textbox1.value\nstrSQL = \"SELECT * FROM Orders WHERE nmt = \" &amp; CStr(nmtNumber) ' removed single-quotes and used ampersand to concatenate with converted string\nCon.Open \"Provider= Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; U.Database01 &amp; \"\\DB.accdb;Persist Security Info=False\"\nRS.Open strSQL, Con, adOpenDynamic, adLockPessimistic\n</code></pre>\n\n<h3>Further improvement</h3>\n\n<p>I already extracted the SQL string (building) into a separate variable <code>strSQL</code> above.</p>\n\n<p>Better would be to use <em>predefined/prepared</em> and <em>parameterized</em> queries:</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/querydef-object-dao\" rel=\"nofollow noreferrer\"><code>QueryDef</code> (DAO)</a> where you can set the parameters (type-safe). See <a href=\"https://stackoverflow.com/questions/31059553/how-to-run-parameterized-query-from-vba-parameters-sourced-from-recordset\">this question</a>.</li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/querydef-object-dao\" rel=\"nofollow noreferrer\"><code>Command</code> (ADODB)</a> where you can set parameters (type-safe). See <a href=\"https://stackoverflow.com/questions/10352211/vba-ado-connection-and-query-parameters\">this question</a>.</li>\n</ul>\n\n<h3>See also</h3>\n\n<ul>\n<li><a href=\"https://software-solutions-online.com/run-time-error-13-type-mismatch-fix/\" rel=\"nofollow noreferrer\">What is \u2018Run-time error \u201813\u2019: Type mismatch\u2019? And How Do You Fix It?</a></li>\n<li><a href=\"https://www.wallstreetmojo.com/vba-type-mismatch/\" rel=\"nofollow noreferrer\">VBA Type Mismatch Error</a></li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 10993710, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/03bf1990b520c3029634d7f02416818d?s=128&d=identicon&r=PG&f=1", "display_name": "ali Ali", "link": "https://stackoverflow.com/users/10993710/ali-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577747446, "creation_date": 1577735413, "last_edit_date": 1577740823, "question_id": 59536138, "link": "https://stackoverflow.com/questions/59536138/how-to-write-a-query-that-uses-a-number-as-parameter-and-number-type-field", "title": "How to write a query that uses a number as parameter and number type field?", "body": "<p>I need to start a query to retrieve data from Access database using VBA which I want to use a variable number as a parameter. Is it possible?</p>\n\n<p>like the: </p>\n\n<pre><code>field name: NMT field type (number)\ntable name: Orders\n</code></pre>\n\n<p>and the code is like the following:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim Con As New ADODB.Connection\nDim RS As New ADODB.Recordset\nDim X as Integer\nX = me.textbox1.value\nCon.Open \"Provider= Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; U.Database01 &amp; \"\\DB.accdb;Persist Security Info=False\"\nRs.Open \"select * from Orders where nmt = '\" + X + \"'\", Con, adOpenDynamic, adLockPessimistic\n</code></pre>\n\n<p>Whenever I run this query, I get a run-time error '13' type mismatch.</p>\n\n<p>Any suggestions ?</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1577735760, "post_id": 59536099, "comment_id": 105241909, "body": "Pass the values you find as arguments to the sub that is copying to a new sheet and put that into <code>sheets()</code>. You will need to check to see if the sheet exists and if not then create it."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1577737216, "post_id": 59536099, "comment_id": 105242412, "body": "You&#39;re creating over 600 sheets in a workbook, duplicating the data from one sheet??? Why? What are you trying to achieve? There&#39;s got to be a better way."}, {"owner": {"reputation": 1, "user_id": 12394160, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fxLarZAwGac/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezYXoHvYFDnK9VwWFulYBs5uiQKQ/photo.jpg?sz=128", "display_name": "awibbin", "link": "https://stackoverflow.com/users/12394160/awibbin"}, "edited": false, "score": 0, "creation_date": 1577739665, "post_id": 59536099, "comment_id": 105243245, "body": "I&#39;m going to do analysis of data based on each work order so it&#39;s important that all the data is separated out. I will have to aggregate operations and calculate average time to complete and then insert results in to final report."}], "owner": {"reputation": 1, "user_id": 12394160, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-fxLarZAwGac/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rezYXoHvYFDnK9VwWFulYBs5uiQKQ/photo.jpg?sz=128", "display_name": "awibbin", "link": "https://stackoverflow.com/users/12394160/awibbin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577735196, "creation_date": 1577735184, "last_edit_date": 1577735196, "question_id": 59536099, "link": "https://stackoverflow.com/questions/59536099/copy-range-of-rows-to-named-sheet", "title": "Copy range of rows to named sheet", "body": "<p>The code below will create a new sheet for each cell in column A. The second module will copy all rows that have a specific value in column A to a specific destination. </p>\n\n<p>I created this so each work order number gets its own sheet and all rows with that work order number is copied over to the sheet named that work order number. </p>\n\n<p>The issue is there are 604 unique work order numbers and I have to edit the second module for each work order in order for it to work.</p>\n\n<p>Is there some way I could have it loop through all the values in column A and maybe compare it to a set variable and then copy the rows to the sheet that has that work order number? I don't know how to make the destination sheet be whatever new value is found in column A.</p>\n\n<p>I'm new to VBA, so this question probably doesn't make much sense. And yes I have seen code for creating and naming a sheet based on each new work order in one module but it generally won't compile so I split the process out to 2 modules. </p>\n\n<p>Anyway, to better understand what I mean: say column A has 4 rows for work order number 1234. I'd need the macro to copy all 4 rows for 1234 into the sheet that is named 1234. Then move on to the next work order number. \nThe range it is checking for work orders in is A2:A39986, but the full range is A2:F39986. </p>\n\n<p>Thank you for your time. </p>\n\n<pre><code>Option Explicit\n\nSub parse_data()\n   Dim xRCount As Long\n   Dim xSht As Worksheet\n   Dim xNSht As Worksheet\n   Dim I As Long\n   Dim xTRow As Integer\n   Dim xCol As New Collection\n   Dim xTitle As String\n   Dim xSUpdate As Boolean\n   Set xSht = ActiveSheet\n   On Error Resume Next\n   xRCount = xSht.Cells(xSht.Rows.Count, 1).End(xlUp).Row\n   xTitle = \"A60:A604\"\n   xTRow = xSht.Range(xTitle).Cells(1).Row\n   For I = 2 To xRCount\n     Call xCol.Add(xSht.Cells(I, 1).Text, xSht.Cells(I, 1).Text)\n   Next\n   xSUpdate = Application.ScreenUpdating\n   Application.ScreenUpdating = False\n   For I = 1 To xCol.Count\n      Call xSht.Range(xTitle).AutoFilter(1, CStr(xCol.Item(I)))\n      Set xNSht = Nothing\n      Set xNSht = Worksheets(CStr(xCol.Item(I)))\n      If xNSht Is Nothing Then\n         Set xNSht = Worksheets.Add(, Sheets(Sheets.Count))\n         xNSht.Name = CStr(xCol.Item(I))\n      Else\n         xNSht.Move , Sheets(Sheets.Count)\n      End If\n      xSht.Range(\"A\" &amp; xTRow &amp; xRCount).EntireRow.Copy xNSht.Range(\"A60\")\n      xNSht.Columns.AutoFit\n    Next\n    xSht.AutoFilterMode = False\n    xSht.Activate\n    Application.ScreenUpdating = xSUpdate\n\n\nEnd Sub\n\n\n</code></pre>\n\n<p>and the module that copies data to a specific destination:</p>\n\n<pre><code>    Sub CopyColumnOver()\n\n    Dim wsSource As Worksheet\n    Dim wsDestin As Worksheet\n    Dim lngDestinRow As Long\n    Dim rngSource As Range\n    Dim rngCel As Range\n\n    Set wsSource = Sheets(\"Sheet1\")     'Edit \"Sheet1\" to your source sheet name\n    Set wsDestin = Sheets(\"11556\")\n\n    With wsSource\n        'Following line assumes column headers in Source worksheet so starts at row2\n        Set rngSource = .Range(.Cells(2, \"A\"), .Cells(.Rows.Count, \"A\").End(xlUp))\n    End With\n\n    For Each rngCel In rngSource\n        If rngCel.Value = \"11556\" Then\n            With wsDestin\n                'Following line assumes column headers in Destination worksheet\n                lngDestinRow = .Cells(.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Row\n                rngCel.EntireRow.Copy Destination:=wsDestin.Cells(lngDestinRow, \"A\")\n            End With\n        End If\n    Next rngCel\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1577735080, "post_id": 59536051, "comment_id": 105241671, "body": "...what issues are you having?"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1577735233, "post_id": 59536051, "comment_id": 105241715, "body": "@BruceWayne I&#39;m getting a run time error &#39;424&quot; object required"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1577735292, "post_id": 59536051, "comment_id": 105241736, "body": "Where do you declare <code>RThisWorkbook</code>?  Or is that a Typo and you mean <code>ThisWorkbook</code>?  What line throws the error?  Also, you&#39;re starting at row 4...but have references to rows that would become negative, which you can&#39;t have...if I&#39;m reading this correctly."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1577735293, "post_id": 59536051, "comment_id": 105241738, "body": "This can easily be done with formula, is vba necessary"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1577735498, "post_id": 59536051, "comment_id": 105241813, "body": "the RThisWorkbook is a typo. when i fixed it it gives me run time error 1004 application defined or object defined error on the line below x = cel.Value"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1577735575, "post_id": 59536051, "comment_id": 105241837, "body": "@ScottCraner VBA is necessary because the the numbers may be entered into any cell in the grid in any order and may have repeats"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1577735600, "post_id": 59536051, "comment_id": 105241847, "body": "And Formulas are still possible."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1577735645, "post_id": 59536051, "comment_id": 105241867, "body": "It just needs to be <code>cel.offset</code> no need for the range bit. <code>cel.Offset(a, 0)).Copy (cel.Offset(a, 39 + x))</code>"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1577735720, "post_id": 59536051, "comment_id": 105241895, "body": "@ScottCraner what formula could i use to bring one of the lines down to the output chart to the corresponding row? for example &quot;index pallet to transfer&quot; needs to go to row 47 and 58"}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577735797, "post_id": 59536051, "comment_id": 105241921, "body": "@Nathan_Sav when i do that i still get the same error"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1577735954, "post_id": 59536051, "comment_id": 105241975, "body": "See my answer below."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577736266, "post_id": 59536051, "comment_id": 105242081, "body": "You are offsetting -11 from a start row of 4"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1577736703, "post_id": 59536051, "comment_id": 105242230, "body": "You have the rows and columns switched in all you offsets.  <code>Offset(Row,Column)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1577736033, "post_id": 59536209, "comment_id": 105242000, "body": "what does the IFERROR(small telling excel to do?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1577736107, "post_id": 59536209, "comment_id": 105242025, "body": "It allows you to copy the formula down a lot of cells and if the user does not put in enough numbers to satisfy all the formula it just blanks them out instead returning an error."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1577736178, "post_id": 59536209, "comment_id": 105242052, "body": "BTW, this will also work if there are duplicate numbers.  It will return duplicates in order as they appear in the original list."}, {"owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1577736363, "post_id": 59536209, "comment_id": 105242115, "body": "this works in practice, but i need it to be a VBA macro than is run when a button is pressed. then a sum is placed at the bottom"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "edited": false, "score": 0, "creation_date": 1577736432, "post_id": 59536209, "comment_id": 105242139, "body": "I can also place the sum dynamically at the bottom if you would like."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1577737379, "last_edit_date": 1577737379, "creation_date": 1577735825, "answer_id": 59536209, "question_id": 59536051, "link": "https://stackoverflow.com/questions/59536051/looping-through-a-range-to-copy-cells-in-corresponding-columns-when-a-number-is/59536209#59536209", "title": "Looping through a range to copy cells in corresponding columns when a number is found", "body": "<p>to get the numbers put this in A39 and copy down:</p>\n\n<pre><code>=IFERROR(SMALL($M$4:$AG$33,ROW(A1)),\"\")\n</code></pre>\n\n<p>To get the Actions, put this in B29 and copy down:</p>\n\n<pre><code>=IF(A39&lt;&gt;\"\",INDEX(B:B,AGGREGATE(15,7,ROW($M$4:$AG$33)/($M$4:$AG$33=A39),COUNTIF($A$39:A39,A39))),\"\")\n</code></pre>\n\n<p>To get the time, put this in F39 and copy down:</p>\n\n<pre><code>=IF(A39&lt;&gt;\"\",INDEX(F:F,MATCH(B39,$B:$B,0)),\"\")\n</code></pre>\n\n<p>So with data like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/XZMt4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XZMt4.png\" alt=\"enter image description here\"></a></p>\n\n<p>using those formula we get:</p>\n\n<p><a href=\"https://i.stack.imgur.com/b5qHQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/b5qHQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>If you really want vba then forget using offset and just refer to the column:</p>\n\n<pre><code>Sub TimingChart()\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n\n        Dim rng As Range\n        Set rng = .Range(\"M4:AG33\")\n\n        'loop columns\n        Dim col As Range\n        For Each col In rng.Columns\n\n        'loop rows of that column\n            Dim cel As Range\n            For Each cel In col.Cells\n        'skip cells with nothing in them\n                If cel.Value = \"\" Then\n\n        'any cell with a number copy the data in row B and row F and\n        'paste in the chart below the entry field starting in row 40\n        'the data should copy into row 39 + x putting the operations in order\n                Else\n                    'x is the variable for row adjustment to determine what cell to paste into\n                    Dim x As Long\n                    x = cel.Value\n                    .Cells(cel.Row, 2).Copy .Cells(39 + x, 2)\n                    .Cells(cel.Row, 6).Copy .Cells(39 + x, 6)\n                    cel.Copy .Cells(39 + x, 1)\n\n                End If\n            Next cel\n        Next col\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 559, "user_id": 4994594, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/cb48f2101f21149eb5eeb26f45825f2a?s=128&d=identicon&r=PG&f=1", "display_name": "Vbasic4now", "link": "https://stackoverflow.com/users/4994594/vbasic4now"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 59536209, "answer_count": 1, "score": 0, "last_activity_date": 1582046107, "creation_date": 1577734866, "last_edit_date": 1582046107, "question_id": 59536051, "link": "https://stackoverflow.com/questions/59536051/looping-through-a-range-to-copy-cells-in-corresponding-columns-when-a-number-is", "title": "Looping through a range to copy cells in corresponding columns when a number is found", "body": "<p>I'm trying to create a user interface for making timing charts.</p>\n\n<p>I have a list of processes and how long each takes.</p>\n\n<p>The user will enter numbers starting at 1 in the cells to the right</p>\n\n<p><a href=\"https://i.stack.imgur.com/HGZem.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HGZem.png\" alt=\"order of operations chart\"></a></p>\n\n<p>I'm trying to do the following:<br>\nFor any row with a number copy the info from column B and F then paste it into row 39 + whatever number it finds.<br>\nThis should create a list that is in the correct order in a chart.</p>\n\n<p><a href=\"https://i.stack.imgur.com/i7LGq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/i7LGq.png\" alt=\"output chart\"></a></p>\n\n<p>I attempted to put together a program that loops through every row of every column in that number entry area.</p>\n\n<pre><code>Sub TimingChart()\n\nDim rng As Range\nDim cel As Range\nDim col As Range\n'x is the variable for row adjustment to determine what cell to paste into\nDim x As Long\n'a is the variable for column adjustments\nDim a As Long\nSet rng = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"M4:AG33\")\n\na = -11\n\n'loop columns\nFor Each col In rng.Columns\n\n'loop rows of that column\n    For Each cel In col.Cells\n'skip cells with nothing in them\n        If cel.Value = \"\" Then\n\n'any cell with a number copy the data in row B and row F and\n'paste in the chart below the entry field starting in row 40\n'the data should copy into row 39 + x putting the operations in order\n        Else\n\n            x = cel.Value\n            cel.Offset(a, 0).Copy cel.Offset(a, 39 + x)\n            cel.Offset(a + 4, 0).Copy cel.Offset(a + 4, 39 + x)\n            cel.Value.Copy cel.Offset(a - 1, 39 + x)\n\n        End If\n    Next\n    a = a - 1\nNext col\n\nEnd Sub\n</code></pre>\n\n<p>Edited to reflect removal of \"range(\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1577734610, "post_id": 59535992, "comment_id": 105241534, "body": "See <a href=\"https://stackoverflow.com/questions/11169445/error-in-finding-last-used-cell-in-excel-with-vba\">this question</a> for how to find the last cell"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577735220, "post_id": 59535992, "comment_id": 105241713, "body": "It&#39;s best to use the max columns and/or rows and then go back.  So <code>range(&quot;a&quot; &amp; rows.count).end(xlUp).row</code> for example"}, {"owner": {"reputation": 19920, "user_id": 1383168, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/atB67.png?s=128&g=1", "display_name": "Slai", "link": "https://stackoverflow.com/users/1383168/slai"}, "edited": false, "score": 0, "creation_date": 1577738051, "post_id": 59535992, "comment_id": 105242707, "body": "To sort specific range instead of the sheet, try the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.sort\" rel=\"nofollow noreferrer\"><code>Range.Sort</code></a> method. You can also try Record Macro to compare the generated code"}], "answers": [{"tags": [], "owner": {"reputation": 89, "user_id": 5556320, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7c38340c5618bc34e2cfed7557ebdb9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Phil", "link": "https://stackoverflow.com/users/5556320/dr-phil"}, "is_accepted": false, "score": 1, "last_activity_date": 1577738104, "creation_date": 1577738104, "answer_id": 59536571, "question_id": 59535992, "link": "https://stackoverflow.com/questions/59535992/vba-excel-range-sort-by-few-columns/59536571#59536571", "title": "VBA Excel Range - Sort by few columns", "body": "<p>At first I thought the error was in Range selection.\nTurns out the problem is that excel saves sort criteria between sessions (it's saved within the file).<br>\nEvery time I run the code, excel was throwing the error because the sort criteria was duplicate. So, the fix was to clear all criteria first.</p>\n\n<pre><code>With inputSheet.Sort\n    .SortFields.Clear\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 5556320, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/7c38340c5618bc34e2cfed7557ebdb9c?s=128&d=identicon&r=PG&f=1", "display_name": "Dr Phil", "link": "https://stackoverflow.com/users/5556320/dr-phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577738142, "creation_date": 1577734458, "last_edit_date": 1577738142, "question_id": 59535992, "link": "https://stackoverflow.com/questions/59535992/vba-excel-range-sort-by-few-columns", "title": "VBA Excel Range - Sort by few columns", "body": "<p>I am trying to sort an excel table that looks like this (this is a small snapshot. It has hundreds of rows and many more columns):</p>\n\n<p><a href=\"https://i.stack.imgur.com/73kb8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/73kb8.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here's my vba code</p>\n\n<pre><code>With inputSheet.Sort\n    .SetRange Range(\"B3\", inputSheet.Range(\"B3\").End(xlToRight).End(xlDown))\n    .SortFields.Add Key:=inputSheet.Range(\"C3\"), Order:=xlAscending 'FieldSize\n    .SortFields.Add Key:=inputSheet.Range(\"H3\"), Order:=xlDescending 'Bracket complexity score\n    .Header = xlYes\n    .Apply\nEnd With\n</code></pre>\n\n<p>This code leads to an error on .SortFields.Add\n\"the sort reference is not valid. Make sure that it's within the data you want to sort, and the first Sort By box isn't the same or blank.\"</p>\n\n<p>Any thoughts on how I could correct for this?</p>\n\n<p><strong>Additional comments</strong><br>\n1) In one of my previous versions, I had it as .End(xlDown).End(xlToRight) (down first, then right). That one never worked. I thought I found a brilliant solution with .End(xlToRight).End(xlDown). It worked for a few days, but then stopped working.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1577734539, "post_id": 59535939, "comment_id": 105241509, "body": "I suggest you enable screen updating and step through the code with <code>F8</code> to see what&#39;s happening."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1577735272, "post_id": 59535939, "comment_id": 105241730, "body": "I would also avoid using <code>ActiveWorkbook</code>...May help to clarify things."}, {"owner": {"reputation": 3, "user_id": 4547344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V2S6d.jpg?s=128&g=1", "display_name": "Laura Defibaugh", "link": "https://stackoverflow.com/users/4547344/laura-defibaugh"}, "edited": false, "score": 0, "creation_date": 1577735515, "post_id": 59535939, "comment_id": 105241821, "body": "I did step through the code with F8 initially - I did it again to re-check and found that the rows aren&#39;t actually deleted, but are being hidden.  Initially, when I clicked &quot;Show All&quot; I only saw one school - this time I saw that the rows weren&#39;t contiguous, and used clear filters instead, and found that the data had just been hidden."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577739337, "post_id": 59535939, "comment_id": 105243113, "body": "try <code>.entirerow.delete</code> if you&#39;re trying to remove the whole row that is."}], "answers": [{"tags": [], "owner": {"reputation": 3, "user_id": 4547344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V2S6d.jpg?s=128&g=1", "display_name": "Laura Defibaugh", "link": "https://stackoverflow.com/users/4547344/laura-defibaugh"}, "is_accepted": false, "score": 0, "last_activity_date": 1577741489, "creation_date": 1577741489, "answer_id": 59537061, "question_id": 59535939, "link": "https://stackoverflow.com/questions/59535939/why-are-deleted-rows-reappearing-in-an-excel-table-when-the-filter-in-removed-in/59537061#59537061", "title": "Why are deleted rows reappearing in an excel table when the filter in removed in VBA?", "body": "<p>I found the problem - the .AutoFilterMode = False didn't actually clear the filters that had already been placed on the table in question.  The visible data WAS deleted, but the data that was filtered before the macro was run remained, and when the  ws.ListObjects(\"Data\").AutoFilter.ShowAllData ran, it cleared the previous filter, showing the rows that had been filtered before.  I added the .ShowAllData code to the beginning of the With statement to avoid the same problem at a future date.</p>\n"}], "owner": {"reputation": 3, "user_id": 4547344, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/V2S6d.jpg?s=128&g=1", "display_name": "Laura Defibaugh", "link": "https://stackoverflow.com/users/4547344/laura-defibaugh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577741489, "creation_date": 1577734117, "question_id": 59535939, "link": "https://stackoverflow.com/questions/59535939/why-are-deleted-rows-reappearing-in-an-excel-table-when-the-filter-in-removed-in", "title": "Why are deleted rows reappearing in an excel table when the filter in removed in VBA?", "body": "<p>The VBA code I have has worked perfectly on two other machines and with several other worksheets without the data reappearing. I've created a macro that takes a master spreadsheet and creates a new spreadsheet for each school listed in the table. I just got a new laptop and installed Excel 365 on it. I copied the VBA code to the new machine, but when I ran it, each new worksheet still contained the data for all the schools, not just the school for that particular file. I stepped through the code, and the schools did delete, but when it got to the part where the filter was removed from the table <code>ws.ListObjects(\"Data\").AutoFilter.ShowAllData</code>, all the deleted rows reappeared. I'm stumped on why this is happening - It didn't happen on the other two machines and other iterations of the file that I've used this macro on. I don't know if it's an Excel setting or a setting on this particular master file. The other two machines - one used Excel 365, and the other Excel 2016.  The data is not part of PowerPivot  and is not a PowerQuery, so the data only lives in the table in the worksheet.</p>\n\n<p>Here is the macro:</p>\n\n<pre><code>Dim i As Integer, wb As Workbook, schools() As Variant, schools_to_delete() As Variant\nDim ws As Worksheet, rng As Range, dt As String\nschools = SchoolsInList()\ndt = MonthName(Month(Now)) &amp; \" \" &amp; Year(Now)\n\nSet wb = ActiveWorkbook\nApplication.ScreenUpdating = False\nApplication.Calculation = xlCalculationManual\nApplication.DisplayAlerts = False\n\nFor i = 1 To UBound(schools)\n    wb.SaveCopyAs (\"Galileo \" &amp; dt &amp; \" \" &amp; schools(i) &amp; \".xlsx\")\n    Workbooks.Open (\"Galileo \" &amp; dt &amp; \" \" &amp; schools(i) &amp; \".xlsx\")\n    Workbooks(\"Galileo \" &amp; dt &amp; \" \" &amp; schools(i) &amp; \".xlsx\").Activate\n    Set ws = Sheets(\"Data\")\n    ws.Activate\n    schools_to_delete = schools\n    schools_to_delete(i) = \"x\"\n    Set rng = ws.ListObjects(\"Data\").DataBodyRange\n\n    With ws\n        .AutoFilterMode = False\n        ws.ListObjects(\"Data\").Range.AutoFilter Field:=18, Criteria1:= _\n        Array(schools_to_delete), Operator:=xlFilterValues\n        ws.Range(rng.Address).SpecialCells(xlCellTypeVisible).Delete\n        .AutoFilterMode = False\n        ws.ListObjects(\"Data\").AutoFilter.ShowAllData\n    End With\n\n    ActiveWorkbook.RefreshAll\n    Call SelectA1\n    ActiveWorkbook.Save\n    ActiveWorkbook.Close\nNext i\n\nApplication.ScreenUpdating = True\nApplication.Calculation = xlCalculationAutomatic\nApplication.DisplayAlerts = True\n\nEnd Sub\nFunction SchoolsInList() As Variant\nDim schools() As String\nDim C As Collection\nDim r As Range\nDim i As Long\nDim last_row As Long\nlast_row = Cells(Rows.Count, 1).End(xlUp).Row\nSet C = New Collection\nOn Error Resume Next\nFor Each r In Worksheets(\"Data\").Range(\"R2:R\" &amp; last_row).Cells\n    C.Add r.Value, CStr(r.Value)\nNext\n\nOn Error GoTo 0\n\nReDim A(1 To C.Count)\n\nFor i = 1 To C.Count\n    A(i) = C.Item(i)\nNext i\n\nSchoolsInList = A\n\nEnd Function\n\n\nSub SelectA1()\nDim i As Long\nFor i = 1 To ActiveWorkbook.Sheets.Count\nSheets(i).Activate\nActiveWindow.ScrollColumn = 1\nActiveWindow.ScrollRow = 1\nRange(\"A1\").Select\nNext i\nActiveWorkbook.Worksheets(2).Activate\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577734248, "post_id": 59535932, "comment_id": 105241413, "body": "Side note - instead of using <code>Mid</code> and then concatenating the parts, why not just use <code>Replace</code>?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1577734434, "post_id": 59535932, "comment_id": 105241478, "body": "Also - does that folder exist? <code>...2020\\5 - May</code>?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577734803, "post_id": 59535932, "comment_id": 105241588, "body": "Your file format has to match the extension, or it will fail"}, {"owner": {"reputation": 443, "user_id": 2227549, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40926c66f5213789b3fbec11a3ba56a8?s=128&d=identicon&r=PG", "display_name": "Bill Flippen", "link": "https://stackoverflow.com/users/2227549/bill-flippen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577808729, "post_id": 59535932, "comment_id": 105261554, "body": "@BigBen  yes the folder exist and I didn&#39;t know about replace!  I will file that one away, thanks!"}, {"owner": {"reputation": 443, "user_id": 2227549, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40926c66f5213789b3fbec11a3ba56a8?s=128&d=identicon&r=PG", "display_name": "Bill Flippen", "link": "https://stackoverflow.com/users/2227549/bill-flippen"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577809356, "post_id": 59535932, "comment_id": 105261715, "body": "@braX are you saying I need to include the .xlsx extension in the save string like this: &#39;I:\\EUG\\Eugene Timesheets\\Bill&#39;s Timesheets\\timesheets\\2020\\5 - May\\5 - Bill F - May 1-15 Timesheet.xlsx&#39;"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577809488, "post_id": 59535932, "comment_id": 105261749, "body": "Yes, meaning that you cannot save it as an XLS if you use the XLSX file format. It&#39;s a pretty simple thing to try to see if I&#39;m right, right?"}, {"owner": {"reputation": 443, "user_id": 2227549, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40926c66f5213789b3fbec11a3ba56a8?s=128&d=identicon&r=PG", "display_name": "Bill Flippen", "link": "https://stackoverflow.com/users/2227549/bill-flippen"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577810978, "post_id": 59535932, "comment_id": 105262189, "body": "@braX  I just tried modifying it and I still get the same error. To be clear I am opening a XLS file - Microsoft Excel 97-2003 Worksheet, importing a module, running the module, and in said module it will take the opened workbook and save it in a new folder as a macro free XLSX file"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577810993, "post_id": 59535932, "comment_id": 105262193, "body": "Honestly, the way I would approach it is by putting the code in an XLAM file, including that in Excel as an Add-In, and then you can open the XLS file and modify it without adding any code to it in the first place."}, {"owner": {"reputation": 443, "user_id": 2227549, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40926c66f5213789b3fbec11a3ba56a8?s=128&d=identicon&r=PG", "display_name": "Bill Flippen", "link": "https://stackoverflow.com/users/2227549/bill-flippen"}, "edited": false, "score": 0, "creation_date": 1577811144, "post_id": 59535932, "comment_id": 105262241, "body": "running with that, but I forsee the save still being an issue"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1577811279, "post_id": 59535932, "comment_id": 105262288, "body": "If the save is still an issue, either something is wrong with the filename, or the destination folder doesn&#39;t exist."}, {"owner": {"reputation": 443, "user_id": 2227549, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40926c66f5213789b3fbec11a3ba56a8?s=128&d=identicon&r=PG", "display_name": "Bill Flippen", "link": "https://stackoverflow.com/users/2227549/bill-flippen"}, "edited": false, "score": 0, "creation_date": 1577812204, "post_id": 59535932, "comment_id": 105262573, "body": "Trying to do the add-in and it is now thinking that the file name is C:\\Users\\BillF.VNZ\\AppData\\Roaming\\Microsoft\\AddIns\\year.xla  ( i did xla as the files are xls ). So I will shelf the add - in and open a new question for that specifically."}, {"owner": {"reputation": 443, "user_id": 2227549, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40926c66f5213789b3fbec11a3ba56a8?s=128&d=identicon&r=PG", "display_name": "Bill Flippen", "link": "https://stackoverflow.com/users/2227549/bill-flippen"}, "edited": false, "score": 0, "creation_date": 1577812638, "post_id": 59535932, "comment_id": 105262707, "body": "OMG I am an idiot!!!!  you are correct the folder doesn&#39;t exist.    I am pulling from a folder 2019/5-may/ or 2019/6-jun.   I am saving to a folder /2020/    no month path.  the files get moved to the month folders after they are filled out.  as such I have not built the month folders yet   I am so sorry."}], "owner": {"reputation": 443, "user_id": 2227549, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/40926c66f5213789b3fbec11a3ba56a8?s=128&d=identicon&r=PG", "display_name": "Bill Flippen", "link": "https://stackoverflow.com/users/2227549/bill-flippen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577736440, "creation_date": 1577734067, "last_edit_date": 1577736440, "question_id": 59535932, "link": "https://stackoverflow.com/questions/59535932/i-need-excel-vba-code-to-save-as-a-work-book-to-a-non-vba-excel-file", "title": "I need Excel VBA code to save as a work book to a non-vba Excel file", "body": "<p>currently I am opening a file, running a bit of code to clear entries, then I want to save the file in a new folder.</p>\n\n<pre><code>strFilefullname = ThisWorkbook.FullName\nx = InStr(1, strFilefullname, \"2019\")\nNewYear = 2020\nnewFileFullName = Mid(strFilefullname, 1, x - 1) &amp; NewYear &amp; Mid(strFilefullname, x + 4,len(strFilefullname) - 62)\n</code></pre>\n\n<p>Up to this point it is working good by taking the current file path and name:<br>\n<code>I:\\EUG\\Eugene Timesheets\\Bill's Timesheets\\timesheets\\2019\\5 - May\\5 - Bill F - May 1-15 Timesheet.xls</code><br>\nand converting it to this:<br>\n<code>I:\\EUG\\Eugene Timesheets\\Bill's Timesheets\\timesheets\\2020\\5 - May\\5 - Bill F - May 1-15 Timesheet</code>\n(NOTE: stripped off the file extension in this case to help</p>\n\n<p>but when it gets down to this part of the code  </p>\n\n<pre><code>Dim wb As Workbook\nDim Path As String\nSet wb = ThisWorkbook\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nwb.saveas Filename:=newFileFullName, FileFormat:=xlOpenXMLWorkbook\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\n</code></pre>\n\n<p>I get  a Run-time error '1004 . Method 'SaveAs'of object'_workbook'failed.<br>\nIt is my impression that since I have the 2019 version open I should be able to save it as the 2020 version and keep it macros free by doing this. \nAm I going about this the wrong way?</p>\n"}, {"tags": ["excel", "vba", "do-loops"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user12431753"}, "edited": false, "score": 0, "creation_date": 1577730697, "post_id": 59535232, "comment_id": 105240210, "body": "Did you read the error message? Somewhere you are scheduling a system shutdown TWICE."}, {"owner": {"reputation": 345, "user_id": 5976543, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/tO0fM.jpg?s=128&g=1", "display_name": "Ken Carter", "link": "https://stackoverflow.com/users/5976543/ken-carter"}, "edited": false, "score": 0, "creation_date": 1577731077, "post_id": 59535232, "comment_id": 105240325, "body": "Yes i read it and it makes no sense because I am not scheduling a shutdown. All my code is there. No shutdown instruction."}, {"owner": {"user_type": "does_not_exist", "display_name": "user12431753"}, "edited": false, "score": 0, "creation_date": 1577731200, "post_id": 59535232, "comment_id": 105240361, "body": "Well you have some code somewhere. And it appears to be VB6 code. When you pressed debug in the dialog what line did it take you too? What does your web page do - reboot systems?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1577731360, "post_id": 59535232, "comment_id": 105240413, "body": "<a href=\"https://stackoverflow.com/questions/23994477/createobject-randomly-throws-a-system-shutdown-has-already-been-scheduled-erro\" title=\"createobject randomly throws a system shutdown has already been scheduled erro\">stackoverflow.com/questions/23994477/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12431753"}, "edited": false, "score": 0, "creation_date": 1577731376, "post_id": 59535232, "comment_id": 105240420, "body": "<a href=\"https://winsourcecode.blogspot.com/2019/12/decoding-errors.html\" rel=\"nofollow noreferrer\">winsourcecode.blogspot.com/2019/12/decoding-errors.html</a> So it is a Win32 error in a hResult. <code>C:\\WINDOWS\\system32&gt;net helpmsg 1190</code>  <code>A system shutdown has already been scheduled.</code>"}, {"owner": {"reputation": 345, "user_id": 5976543, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/tO0fM.jpg?s=128&g=1", "display_name": "Ken Carter", "link": "https://stackoverflow.com/users/5976543/ken-carter"}, "edited": false, "score": 0, "creation_date": 1577732207, "post_id": 59535232, "comment_id": 105240717, "body": "The web page itself I have nothing to do with other than filling in and clicking on options to bring up the report. This is a clean load of Excel with nothing but the button on the single worksheet that is up. That button imitates the first sub which triggers the repeated execution of the second one.    It works perfectly if the wait (X) is set to 10 seconds in stead of 1 hour. I ran the loop for about 50 reiterations before attempting the 1 hour wait.  It would seem to me that if it was a shutdown directed that it would have shown up in both scenarios."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1577738816, "post_id": 59535232, "comment_id": 105242953, "body": "Nice flowchart!"}], "answers": [{"tags": [], "owner": {"reputation": 345, "user_id": 5976543, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/tO0fM.jpg?s=128&g=1", "display_name": "Ken Carter", "link": "https://stackoverflow.com/users/5976543/ken-carter"}, "is_accepted": true, "score": 0, "last_activity_date": 1578151773, "creation_date": 1578151773, "answer_id": 59592134, "question_id": 59535232, "link": "https://stackoverflow.com/questions/59535232/what-is-causing-my-timing-loop-to-break-when-extending-timer/59592134#59592134", "title": "What is causing my timing loop to break when extending timer", "body": "<p>The final solution to this project has been running 24/7 for three days now, so I think it is safe to provide you with where all the extremely helpful discussion and suggestions has taken me.</p>\n\n<p>The key changes that made this a success:</p>\n\n<ol>\n<li>Focusing in on the elements of the IE to direct the login to the report.</li>\n<li>Adding a 'On Error Resume Next' statement.</li>\n</ol>\n\n<p>The network is wireless where this is implemented and periodically there will be momentary signal interruptions. Once all the timing loops and element controls were made effective for getting the session to the report and back out again, we were seeing an intermittent issue with the code bombing. The 'Resume Next' assured that when we had these interruptions, which the macro would step down to the point of closing the IE session, which resulted in the restart of a fresh session.</p>\n\n<p>Doing this provided stability. </p>\n\n<p>The entire solution is below. Note that the first sub is the one that is initiated in the work flow above. It waits briefly to let the system settle, then fires off the sub that calls and navigates the IE session.</p>\n\n<p>The second sub includes the timing loop (59 minutes) and the key 'On Error' statement that overcame our network issues.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Looper As Long\nLooper = 0\n\nDo While Looper &lt; 1\n    Application.Wait Now + TimeValue(\"00:00:10\")\n    Call OpenReport\nLoop\nEnd Sub\n\nPrivate Sub OpenReport()\nDim text As String\nDim Looper As Long\nDim x As Integer\nDim IE\nSet IE = New InternetExplorerMedium\ntext = \"PCode\"\n'Load link\nIE.Visible = True\n\n    On Error Resume Next '&lt;&lt;&lt;--- Final resolution'\n\n    IE.Navigate \"http://~~~~~~~~.net/reports/views/result/reportResult.faces\"\n\n'Wait for page to load\n    Do While IE.Busy Or IE.ReadyState &lt;&gt; 4\n        DoEvents\n    Loop\n\n'fill in the pcode\n    IE.Document.getelementbyid(\"PCode\").Value = text\n\n'Click Submit\n    IE.Document.getElementsByClassName(\"btn btn-lg btn-primary btn-block\")(0).Click\n\n'Wait for page to load\n    Do While IE.Busy Or IE.ReadyState &lt;&gt; 4\n        DoEvents\n    Loop\n\n'Click on Favorites\n    IE.Document.getElementsByClassName(\"myMRSFavoritesLink\")(0).Click\n\n'Wait for page to load\n    Do While IE.Busy Or IE.ReadyState &lt;&gt; 4\n    DoEvents\n    Loop\n\n'Click on report\n    IE.Document.getElementsByName(\"myFavoritesForm:treeTable_tableId:6:infoButton98772406j_id__v_55\")(0).Click\n\n'Wait for page to load\n    Do While IE.Busy Or IE.ReadyState &lt;&gt; 4\n        DoEvents\n    Loop\n\n'Click on execute report\n    IE.Document.getElementsByName(\"setParametersForm:startReportButton\")(0).Click\n\n'Wait for a period of time contained in TimeValue\n    Application.Wait (Now + TimeValue(\"00:59:00\"))\n\n'Close IE\nCloseIE:\n    IE.Quit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 345, "user_id": 5976543, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/tO0fM.jpg?s=128&g=1", "display_name": "Ken Carter", "link": "https://stackoverflow.com/users/5976543/ken-carter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 59592134, "answer_count": 1, "score": 1, "last_activity_date": 1578151773, "creation_date": 1577730248, "last_edit_date": 1577739454, "question_id": 59535232, "link": "https://stackoverflow.com/questions/59535232/what-is-causing-my-timing-loop-to-break-when-extending-timer", "title": "What is causing my timing loop to break when extending timer", "body": "<p>The macro I'm developing is designed to launch from a button. The button triggers a looping sub that simply fires the sub's child process which does most of the work.</p>\n\n<p>The child process loads a URL in IE and then navigates to a report screen. Following that it waits a specified pored of time (in the flow the value is X. When X is exceeded IE is closed and control is surrendered back to the parent which waits 10 seconds before relaunching the sub.</p>\n\n<p><a href=\"https://i.stack.imgur.com/NQum9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NQum9.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The problem comes into play when X is changed to one hour from my 10 second test timer. I'm suspecting that there is something in VBA Excel that decays so after about five minutes I get the error (which doesn't make a lot of sense to me). </p>\n\n<p>Interested in finding out what the time change does to break this and see if anyone knows of a way around the problem. </p>\n\n<p>Code below... Thanks in advance!</p>\n\n<pre><code>Private Sub OpenReport()\nDim text As String\nDim x As Integer\nDim IE\nSet IE = New InternetExplorerMedium\ntext = \"PCode\"\n\n'Load link\nIE.Visible = True\n\nIE.Navigate \"http://~~~~~~~~~~~~.net/reports/views/result/reportResult.faces\"\n\n'Wait for page to load\nDo While IE.Busy Or IE.ReadyState &lt;&gt; 4\n    DoEvents\nLoop\n\n'fill in the pcode\nIE.Document.getelementbyid(\"Pcode\").Value = text\n\n'Click Submit\nIE.Document.getElementsByClassName(\"btn btn-lg btn-primary btn-block\")(0).Click\n\n'Wait for page to load\nDo While IE.Busy Or IE.ReadyState &lt;&gt; 4\n    DoEvents\nLoop\n\n'Click on Favorites\nIE.Document.getElementsByClassName(\"myMRSFavoritesLink\")(0).Click\n\n'Wait for page to load\nDo While IE.Busy Or IE.ReadyState &lt;&gt; 4\n    DoEvents\nLoop\n\n'Click on report\nIE.Document.getElementsByName(\"myFavoritesForm:treeTable_tableId:6:infoButton98772406j_id__v_55\")(0).Click\n\n'Wait for page to load\nDo While IE.Busy Or IE.ReadyState &lt;&gt; 4\n    DoEvents\nLoop\n\nIE.Document.getElementsByName(\"setParametersForm:startReportButton\")(0).Click\n\n'Wait for a period of time contained in TimeValue\n    Application.Wait (Now + TimeValue(\"00:01:00\")) ' This is X\n'Close IE\n    IE.Quit\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\nDim Looper As Long\nLooper = 0\n\nDo While Looper &lt; 1\n    Application.Wait Now + TimeValue(\"00:00:10\")\n    Call OpenReport\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "image", "email", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 8880985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d71e9b7a02847a66c018f305ca0e7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "jmartin0807", "link": "https://stackoverflow.com/users/8880985/jmartin0807"}, "edited": false, "score": 0, "creation_date": 1577977947, "post_id": 59559719, "comment_id": 105299082, "body": "Hi Dmitry! Yes, I am using the RTF format type for this particular email. I&#39;d love to be able to keep using it because it makes it easier to add a range of cells to the email body. Is there no way to do this with an RTF email type? Thank you for your help."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 13, "user_id": 8880985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d71e9b7a02847a66c018f305ca0e7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "jmartin0807", "link": "https://stackoverflow.com/users/8880985/jmartin0807"}, "edited": false, "score": 0, "creation_date": 1578002191, "post_id": 59559719, "comment_id": 105308686, "body": "RTF with OLE objects is Outlook specific, Google and other email clients might have a problem with it."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1577949887, "creation_date": 1577949887, "answer_id": 59559719, "question_id": 59535075, "link": "https://stackoverflow.com/questions/59535075/receiver-cant-see-images-in-outlook-email/59559719#59559719", "title": "Receiver can&#39;t see images in Outlook Email", "body": "<p>It sure sounds like you are sending in the RTF format. You need to send an HTML formatted message with with an image added as an attachment and referenced by the HTML body.</p>\n"}], "owner": {"reputation": 13, "user_id": 8880985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d71e9b7a02847a66c018f305ca0e7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "jmartin0807", "link": "https://stackoverflow.com/users/8880985/jmartin0807"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 59559719, "answer_count": 1, "score": 0, "last_activity_date": 1577963862, "creation_date": 1577729505, "last_edit_date": 1577963862, "question_id": 59535075, "link": "https://stackoverflow.com/questions/59535075/receiver-cant-see-images-in-outlook-email", "title": "Receiver can&#39;t see images in Outlook Email", "body": "<p>I am having trouble getting my images to display when I send emails in Outlook. In my email sending function, I add an inlineshape picture to the beginning of the word document and everything displays fine, but when I send the email, both the inline picture and the picture in my signature disappear. Please see the screenshots and code below. I have tried searching for answers with no success.</p>\n\n<pre><code>Sub Send_Email( _\n            strTo As String, _\n            Optional strFromEmail As String, _\n            Optional strSubject As String, _\n            Optional strCC As String, _\n            Optional strBCC As String, _\n            Optional BodyFormat As olBodyFormat = olFormatPlain, _\n            Optional varBody1 As Variant, _\n            Optional strPicturePath As String, _\n            Optional lngPicutreSize As Long = 100, _\n            Optional varBody2 As Variant, _\n            Optional strAttachmentPath As String, _\n            Optional blnSendEmail As Boolean = False)\n\nDim olApp As Outlook.Application\nSet olApp = New Outlook.Application\n\nDim olEmail As Outlook.MailItem\nSet olEmail = olApp.CreateItem(olMailItem)\n\nDim olInsp As Outlook.Inspector\nDim wdDoc As Word.document\nDim shpEmailShape As Word.InlineShape\n\nWith olEmail\n    .BodyFormat = BodyFormat\n    .display\n    If strFromEmail &lt;&gt; \"\" Then\n        .SentOnBehalfOfName = strFromEmail\n    End If\n    .To = strTo\n    .Subject = strSubject\n    .CC = strCC\n    .BCC = strBCC\n    If BodyFormat = olFormatHTML Then\n        If varBody2 &lt;&gt; \"\" Then\n            .HTMLBody = varBody2 &amp; \"&lt;br&gt;\" &amp; .HTMLBody\n        End If\n        If varBody1 &lt;&gt; \"\" Then\n            .HTMLBody = varBody1 &amp; \"&lt;br&gt;\" &amp; .HTMLBody\n        End If\n    ElseIf BodyFormat = olFormatRichText Then\n        Set olInsp = .GetInspector\n        Set wdDoc = olInsp.WordEditor\n        If IsMissing(varBody2) = False Then\n            varBody2.Copy\n            wdDoc.Range(0, 0).Paste\n        End If\n        If strPicturePath &lt;&gt; \"\" Then\n            Set shpEmailShape = wdDoc.Range(0, 0).InlineShapes.AddPicture(strPicturePath)\n            shpEmailShape.LockAspectRatio = msoCTrue\n            shpEmailShape.Height = lngPicutreSize\n        End If\n        If IsMissing(varBody1) = False Then\n            varBody1.Copy\n            wdDoc.Range(0, 0).Paste\n        End If\n    Else\n        On Error Resume Next\n        If varBody2 &lt;&gt; \"\" Then\n            .body = varBody2 &amp; vbCrLf &amp; .body\n        End If\n        On Error GoTo 0\n        On Error Resume Next\n        If varBody1 &lt;&gt; \"\" Then\n            .body = varBody1 &amp; vbCrLf &amp; .body\n        End If\n        On Error GoTo 0\n    End If\n    If strAttachmentPath &lt;&gt; \"\" Then\n        .Attachments.Add strAttachmentPath\n    End If\nEnd With\n\nIf blnSendEmail = True Then\n    olEmail.send\nEnd If\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/3DayP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3DayP.png\" alt=\"Email before sending with pictures displayed\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/0CBmb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0CBmb.png\" alt=\"Email after sending with pictures gone\"></a></p>\n"}, {"tags": ["vba", "string", "ms-access", "comma"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 2, "creation_date": 1577725299, "post_id": 59534302, "comment_id": 105238273, "body": "Here is where to start: <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.listbox\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/access.listbox</a>"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 1, "creation_date": 1577726034, "post_id": 59534302, "comment_id": 105238554, "body": "All displayed items, or all selected items?"}, {"owner": {"reputation": 3, "user_id": 11073622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ed2125da40f65dd8a2420985f2cad9?s=128&d=identicon&r=PG&f=1", "display_name": "Olinssito", "link": "https://stackoverflow.com/users/11073622/olinssito"}, "edited": false, "score": 0, "creation_date": 1577738118, "post_id": 59534302, "comment_id": 105242734, "body": "All Displayed Items"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11073622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ed2125da40f65dd8a2420985f2cad9?s=128&d=identicon&r=PG&f=1", "display_name": "Olinssito", "link": "https://stackoverflow.com/users/11073622/olinssito"}, "edited": false, "score": 0, "creation_date": 1577738707, "post_id": 59534356, "comment_id": 105242908, "body": "Error in: sList = sList &amp; ListBox1.List(nIndex) &amp; &quot;,&quot;  .List not acceptance in vba :("}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 3, "user_id": 11073622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ed2125da40f65dd8a2420985f2cad9?s=128&d=identicon&r=PG&f=1", "display_name": "Olinssito", "link": "https://stackoverflow.com/users/11073622/olinssito"}, "edited": false, "score": 0, "creation_date": 1577739518, "post_id": 59534356, "comment_id": 105243182, "body": "Ah ok - I updated the answer. Tested it in Access and it works. Ooops looks like i was too late lol"}, {"owner": {"reputation": 3, "user_id": 11073622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ed2125da40f65dd8a2420985f2cad9?s=128&d=identicon&r=PG&f=1", "display_name": "Olinssito", "link": "https://stackoverflow.com/users/11073622/olinssito"}, "edited": false, "score": 0, "creation_date": 1577740169, "post_id": 59534356, "comment_id": 105243401, "body": "thank you! Correct the new code.  I have a new problem: If select item, for example:  1 5 3 ---- this item 7  How to delete value in a table with &quot;3&quot;.  Save value in a variable?"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 3, "user_id": 11073622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ed2125da40f65dd8a2420985f2cad9?s=128&d=identicon&r=PG&f=1", "display_name": "Olinssito", "link": "https://stackoverflow.com/users/11073622/olinssito"}, "edited": false, "score": 0, "creation_date": 1577741176, "post_id": 59534356, "comment_id": 105243733, "body": "That is outside of the scope of your question. You would be better off creating a new question. Keep in mind that the answers we give are used by other people in the future, so no one else who wonders how to do this additional item is going to be able to find it using your previous question."}], "tags": [], "owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "is_accepted": false, "score": 0, "last_activity_date": 1577739474, "last_edit_date": 1577739474, "creation_date": 1577725537, "answer_id": 59534356, "question_id": 59534302, "link": "https://stackoverflow.com/questions/59534302/listbox-values-to-string-in-access-vba-separated-with-comma/59534356#59534356", "title": "Listbox values to String in Access VBA (Separated with Comma)", "body": "<p>You can build the string this way</p>\n\n<p><strong>In Excel:</strong></p>\n\n<pre><code>Private Sub ShowItems()\n  Dim sList As String\n  Dim nIndex As Integer\n\n  For nIndex = 0 To ListBox1.ListCount - 1\n    sList = sList &amp; ListBox1.List(nIndex) &amp; \",\"\n  Next\n  sList = Left$(sList, Len(sList) - 1)\n\n  MsgBox sList\nEnd Sub\n</code></pre>\n\n<p><strong>In Access:</strong></p>\n\n<pre><code>Private Sub ShowItems()\n  Dim sList As String\n  Dim nIndex As Integer\n\n  For nIndex = 0 To ListBox1.ListCount - 1\n    sList = sList &amp; ListBox1.ItemData(nIndex) &amp; \",\"\n  Next\n  sList = Left$(sList, Len(sList) - 1)\n\n  MsgBox sList\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 0, "last_activity_date": 1577731371, "creation_date": 1577731371, "answer_id": 59535452, "question_id": 59534302, "link": "https://stackoverflow.com/questions/59534302/listbox-values-to-string-in-access-vba-separated-with-comma/59535452#59535452", "title": "Listbox values to String in Access VBA (Separated with Comma)", "body": "<p>You can construct an array of listbox items and then use the <code>join</code> function to convert the array to a string using an arbitrary delimiter, e.g.:</p>\n\n<pre><code>ReDim strArr(0 To Listbox1.ListCount - 1) As String\nDim strRtn As String\nDim i As Integer\n\nFor i = 0 To UBound(strArr)\n    strArr(i) = Listbox1.ItemData(i)\nNext i\nstrRtn = Join(strArr, \",\")\n</code></pre>\n\n<p>Or, for selected items, you might use:</p>\n\n<pre><code>Dim strRtn As String\nDim n As Integer\nn = Listbox1.ItemsSelected.Count - 1\n\nIf n &gt;= 0 Then\n    ReDim strArr(0 To n) As String\n    Dim i As Integer\n\n    For i = 0 To n\n        strArr(i) = Listbox1.ItemData(Listbox1.ItemsSelected(i))\n    Next i\n    strRtn = Join(strArr, \",\")\nEnd If\n</code></pre>\n\n<p>In all of the above, change <code>Listbox1</code> to the name of your listbox form control.</p>\n"}], "owner": {"reputation": 3, "user_id": 11073622, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ed2125da40f65dd8a2420985f2cad9?s=128&d=identicon&r=PG&f=1", "display_name": "Olinssito", "link": "https://stackoverflow.com/users/11073622/olinssito"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 0, "accepted_answer_id": 59535452, "answer_count": 2, "score": 0, "last_activity_date": 1577739474, "creation_date": 1577725205, "last_edit_date": 1577725567, "question_id": 59534302, "link": "https://stackoverflow.com/questions/59534302/listbox-values-to-string-in-access-vba-separated-with-comma", "title": "Listbox values to String in Access VBA (Separated with Comma)", "body": "<p>How to store all values by ListBox in a string and separated with Commas in Access VBA </p>\n\n<p>For Example:</p>\n\n<p>ListBox </p>\n\n<pre><code>1\n2\n3\n4\n5\n</code></pre>\n\n<p>String</p>\n\n<pre><code>1,2,3,4,5\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1577719300, "post_id": 59533024, "comment_id": 105235717, "body": "Do you mean it&#39;s open in another instance of Excel? If so, this might be helpful: <a href=\"https://stackoverflow.com/questions/46140256/how-to-connect-to-open-workbook-in-another-instance-of-excel\" title=\"how to connect to open workbook in another instance of excel\">stackoverflow.com/questions/46140256/&hellip;</a>"}, {"owner": {"reputation": 60, "user_id": 9272794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wptKNuuquVA/AAAAAAAAAAI/AAAAAAAAAEU/FBFAaeWQjDg/photo.jpg?sz=128", "display_name": "nigiroux", "link": "https://stackoverflow.com/users/9272794/nigiroux"}, "reply_to_user": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "edited": false, "score": 0, "creation_date": 1577720044, "post_id": 59533024, "comment_id": 105236050, "body": "I&#39;ve come with a simple solution. Probably not the best but it does the trick for what I want to do. What I do is that if there is an error caused by the set suivi line (because the file is open in another instance), I just open the file in the same instance and then close it."}], "owner": {"reputation": 60, "user_id": 9272794, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-wptKNuuquVA/AAAAAAAAAAI/AAAAAAAAAEU/FBFAaeWQjDg/photo.jpg?sz=128", "display_name": "nigiroux", "link": "https://stackoverflow.com/users/9272794/nigiroux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577720071, "creation_date": 1577719035, "last_edit_date": 1577720071, "question_id": 59533024, "link": "https://stackoverflow.com/questions/59533024/workbooksname-excel-vba", "title": "Workbooks(name) Excel VBA", "body": "<p>I am working in a main excel workbook where I keep all the data. I have a button that  allow the user to update the \"state\" of the data in progress by looking in another workbook. When clicked on it, it will open the Excel file containing the workbook, and read the column corresponding to the state of the data. If the Excel containing the workbook is already open in the same \"tab\", it will read the information needed, and return to the main file. If the Excel file is not open, it will open it and then close it when over. The problem I am currently facing is that if the file is open in a different \"tab\", I am not allowed to use the name of the Excel file to assign it as a Workbook.</p>\n\n<pre><code>check = IsWorkBookOpen(\"\\\\\\\u00c9clairage\\Demandes\\\" + nomSuivi)\n\nIf check = True Then  \n\nSet suivi = Workbooks(nomSuivi)  'nomSuivi is the name of the Excel file ex: file.xls \n\n\n\n\n    TotalRows = suivi.Worksheets(\"Feuil1\").Cells(Rows.Count, 1).End(xlUp).Row    \n    ReDim mandat(1 To TotalRows)\n    ReDim etat(1 To TotalRows)\n\n    For i = 2 To TotalRows\n     mandat(i - 1) = suivi.Worksheets(\"Feuil1\").Cells(i, 1).Value   \n     etat(i - 1) = suivi.Worksheets(\"Feuil1\").Cells(i, 5).Value   \n    Next i\n\n\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577722621, "post_id": 59533008, "comment_id": 105237215, "body": "<code>.SentOnBehalfOfName</code> is a property of the Outlook <code>Mailitem</code>. I&#39;m not sure you can do this using <code>MailEnvelope</code>."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1577844350, "post_id": 59533008, "comment_id": 105268294, "body": "Welcome to SO! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>! <a href=\"https://riptutorial.com/excel-vba/example/9292/avoid-using-select-or-activate\" rel=\"nofollow noreferrer\">Why avoid Select</a> and why avoid <a href=\"http://rubberduckvba.com/Inspections/Details/ImplicitActiveSheetReference\" rel=\"nofollow noreferrer\">implicit references</a> and the <a href=\"https://rubberduckvba.wordpress.com/2019/06/30/the-macro-recorder-curse/\" rel=\"nofollow noreferrer\">the-macro-recorder-curse/</a>"}], "owner": {"reputation": 11, "user_id": 12625981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3402088625a4cdd0aaffc67a803217d0?s=128&d=identicon&r=PG&f=1", "display_name": "Jaris", "link": "https://stackoverflow.com/users/12625981/jaris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1577741091, "creation_date": 1577718961, "last_edit_date": 1577741091, "question_id": 59533008, "link": "https://stackoverflow.com/questions/59533008/run-time-error-440-the-object-does-not-support-this-method", "title": "Run-time error &#39;440&#39; - the object does not support this method", "body": "<p>I have this problem when running a Macro to send out shipped order emails to customers. It seems to be completely random and follows no pattern. Is there something wrong with the code? I have to go through sent on behalf of, as I need it to show that the email is coming from the main admin account, but VBA highlights the .DESIGNATED line as the problem when it crashes. Here is the code, can anyone tell me what I am doing wrong?</p>\n\n<pre><code>Sub EmailRep()\n\nDo\n\nWith Application\n    .DisplayAlerts = False\n    .ScreenUpdating = False\n    Sheets(\"Email\").Select\n\nEnd With\n\nDim sDESIGNATED As String\n\nsDESIGNATED = [C100]\nRange(\"A2:D35\").SpecialCells(xlCellTypeVisible).Select\n\nActiveWorkbook.EnvelopeVisible = True\n\nWith ActiveSheet.MailEnvelope\n    .Item.To = sDESIGNATED\n    .Item.Subject = \"Your Order Has Shipped!\"\n    .Item.SentOnBehalfOfName = \"me@me.com\"\n    .Item.Send\nEnd With\n\nActiveWorkbook.EnvelopeVisible = False\n\nWith Application\n    .DisplayAlerts = True\n    .ScreenUpdating = True\n\n    Sheets(\"Orders\").Select\n        Rows(\"2:2\").Select\n    Selection.Copy\n    Sheets(\"Sent\").Select\n    Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Select\n    ActiveSheet.Paste\n    Sheets(\"Orders\").Select\n    Rows(\"2:2\").Select\n    Selection.Delete Shift:=xlUp\n    Range(\"A2\").Select\n\nEnd With\n\nLoop Until ActiveCell.Value = \"\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577718221, "post_id": 59532831, "comment_id": 105235258, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/7851859/delete-a-row-in-excel-vba\">Delete a row in Excel VBA</a>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577718277, "post_id": 59532831, "comment_id": 105235283, "body": "<a href=\"https://stackoverflow.com/questions/29006416/excel-vba-if-cell-value-then\" title=\"excel vba if cell value then\">stackoverflow.com/questions/29006416/&hellip;</a>"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1577718629, "post_id": 59532831, "comment_id": 105235408, "body": "Simple solution <b>1.</b> After the last column, add this formula <code>=COUNTA(A1:D1)</code> and pull it down. <b>2.</b> Autofilter the data on anything <code>= 4</code> and delete it. You may want to see how to use Autofilter to delete the data based <a href=\"https://stackoverflow.com/questions/11317172/delete-row-based-on-condition\">on a condition</a>"}, {"owner": {"reputation": 71, "user_id": 5590930, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-4cWusdqCBIg/AAAAAAAAAAI/AAAAAAAAAD0/s1u54tjFLXQ/photo.jpg?sz=128", "display_name": "Harlan", "link": "https://stackoverflow.com/users/5590930/harlan"}, "reply_to_user": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1577721456, "post_id": 59532831, "comment_id": 105236669, "body": "@SiddharthRout This seems to be the quickest and easiest solution. Thanks."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1577723774, "post_id": 59532831, "comment_id": 105237665, "body": "I&#39;ve used this code without any problems. <code>ThisWorkbook.Sheets(&quot;Sheet1&quot;).UsedRange.SpecialCells(xlCellT&zwnj;&#8203;ypeBlanks).EntireRow&zwnj;&#8203;.Delete</code> change the worksheet name as needed."}], "answers": [{"tags": [], "owner": {"reputation": 640, "user_id": 12626835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d667d2965d6d89fe6716a7e56ba1f764?s=128&d=identicon&r=PG&f=1", "display_name": "jclasley", "link": "https://stackoverflow.com/users/12626835/jclasley"}, "is_accepted": false, "score": 0, "last_activity_date": 1577729971, "creation_date": 1577729971, "answer_id": 59535173, "question_id": 59532831, "link": "https://stackoverflow.com/questions/59532831/how-to-delete-a-row-of-data-if-none-of-the-cells-are-misssing-values/59535173#59535173", "title": "How to delete a row of data if none of the cells are misssing values?", "body": "<p>This throws an error if there are no blank cells, so we just resume next in that case. Doesn't delete the row (because that will cause the data to shift up), just hides the whole row.</p>\n\n<pre class=\"lang-vba prettyprint-override\"><code>Dim salesRng as Range\nDim colCount as Long\nSet salesRng = Range(\"B2:AB450\")\n\nFor Each row in salesRng\n    On Error Resume Next\n    If row.SpecialCells(xlCellTypeBlanks).count = 0 Then\n            row.hidden = true\n        End If\nNext row\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5590930, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-4cWusdqCBIg/AAAAAAAAAAI/AAAAAAAAAD0/s1u54tjFLXQ/photo.jpg?sz=128", "display_name": "Harlan", "link": "https://stackoverflow.com/users/5590930/harlan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577729971, "creation_date": 1577718096, "question_id": 59532831, "link": "https://stackoverflow.com/questions/59532831/how-to-delete-a-row-of-data-if-none-of-the-cells-are-misssing-values", "title": "How to delete a row of data if none of the cells are misssing values?", "body": "<p>I have a spreadsheet with sales data for a given month for a number of different stores. There are approximately 450 rows (stores) to go through. The days of the month are in row 1, starting in column B, with the store numbers in column A, starting in row 2. What I need to find are the rows that are missing data for different days. I can use conditional formatting to highlight the cells that are empty, but that is still a lot to look at. What I am trying to do is reduce the amount of cells to look at by deleting any rows that are not missing data. So if a row is not missing any days of data, then I don't need to look at it, and can delete it. But if it is missing data, then keep the row. I'm stuck on figuring out the actual code, but I have come up with pseudo code for what I want:</p>\n\n<pre><code>foreach row in range ($B$2:$AB$450)\n    foreach cell in row \n        if cell &lt; 1\n            delete row\n    end foreach\nend foreach\n</code></pre>\n\n<p>Here is an example of the spreadsheet:</p>\n\n<pre><code>        A           B               C               D\n1               12/1/2019       12/2/2019       12/3/2019\n2   Site 1          1000                            2000\n3   Site 2          5000            5000            3000\n4   Site 3          6000            4000            3000\n</code></pre>\n\n<p>In this example, rows 4 and 4 would be deleted because they are not missing any data.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 643, "user_id": 5030969, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/022ea41a8cfa13927b8c15978b31705c?s=128&d=identicon&r=PG&f=1", "display_name": "Ludo", "link": "https://stackoverflow.com/users/5030969/ludo"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1577731541, "post_id": 59531806, "comment_id": 105240481, "body": "I added a pictue and the VBA code ;-)"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577731881, "post_id": 59531806, "comment_id": 105240595, "body": "Untested, but try changing <code>Set myShape = .Shapes.AddChart2(201, xlColumnClustered)</code> to <code>Set myShape = .Shapes.AddChart2(-1, xlColumnClustered)</code>"}, {"owner": {"reputation": 643, "user_id": 5030969, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/022ea41a8cfa13927b8c15978b31705c?s=128&d=identicon&r=PG&f=1", "display_name": "Ludo", "link": "https://stackoverflow.com/users/5030969/ludo"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577750746, "post_id": 59531806, "comment_id": 105246308, "body": "Unfortunately it does not work better."}, {"owner": {"reputation": 643, "user_id": 5030969, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/022ea41a8cfa13927b8c15978b31705c?s=128&d=identicon&r=PG&f=1", "display_name": "Ludo", "link": "https://stackoverflow.com/users/5030969/ludo"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577786758, "post_id": 59531806, "comment_id": 105254134, "body": "I have used a template from the chart I want and I have applied with: myShape.Chart.ApplyChartTemplate ( _ &quot;C:\\..........\\Charts\\ChartTpl.crtx&quot;) but it does not work, I have sometimes the ColumnClustered with multiple colors."}], "answers": [{"tags": [], "owner": {"reputation": 643, "user_id": 5030969, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/022ea41a8cfa13927b8c15978b31705c?s=128&d=identicon&r=PG&f=1", "display_name": "Ludo", "link": "https://stackoverflow.com/users/5030969/ludo"}, "is_accepted": true, "score": 0, "last_activity_date": 1577790377, "creation_date": 1577790377, "answer_id": 59543256, "question_id": 59531806, "link": "https://stackoverflow.com/questions/59531806/how-to-set-xlcolumnclustered-style-with-only-one-color-and-values-below-each-bar/59543256#59543256", "title": "How to set xlColumnClustered style with only one color and values below each bar?", "body": "<p>Thanks to a similar question on <a href=\"https://stackoverflow.com/questions/53672735/vba-xlbarclustered-how-do-you-distinguish-between-the-two-different-presets\">xlBarClustered</a>, you need to change how the data is plotted:</p>\n\n<p>To get the left hand chart:</p>\n\n<pre><code>myShape.Chart.PlotBy = xlColumns\n</code></pre>\n\n<p>To get the right hand chart:</p>\n\n<pre><code>myShape.Chart.PlotBy = xlRows\n</code></pre>\n"}], "owner": {"reputation": 643, "user_id": 5030969, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/022ea41a8cfa13927b8c15978b31705c?s=128&d=identicon&r=PG&f=1", "display_name": "Ludo", "link": "https://stackoverflow.com/users/5030969/ludo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 59543256, "answer_count": 1, "score": 0, "last_activity_date": 1577790377, "creation_date": 1577713031, "last_edit_date": 1577790024, "question_id": 59531806, "link": "https://stackoverflow.com/questions/59531806/how-to-set-xlcolumnclustered-style-with-only-one-color-and-values-below-each-bar", "title": "How to set xlColumnClustered style with only one color and values below each bar?", "body": "<p>I create VBA Column Clustered charts and there are two styles of xlColumnClustered:</p>\n\n<ul>\n<li>with multiple colors</li>\n<li>with one color and values below each bar</li>\n</ul>\n\n<p>It displays the first one and I need the second one:</p>\n\n<p><a href=\"https://i.stack.imgur.com/CXlmb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/CXlmb.png\" alt=\"Column clustered\"></a></p>\n\n<p>In VBA how do I set xlColumnClustered to have one  color with values below each bar?</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub CreateGraph()\n\nDim strChrt As String\nDim ws As Worksheet\nDim x As Integer\nDim lastRow As Integer\nDim lastCol As Integer\nDim myShape As Shape\n\nSet ws = ActiveSheet\nlastCol = ws.Cells(3, Columns.Count).End(xlToLeft).Column\nlastRow = ws.Cells(Rows.Count, \"B\").End(xlUp).Row\nFor x = 4 To lastRow\n\n  With ws\n    Set range1 = .Range(.Cells(3, \"A\"), .Cells(3, lastCol))\n    Set range2 = .Range(.Cells(x, \"A\"), .Cells(x, lastCol))\n    Set range3 = Union(range1, range2)\n    Set myShape = .Shapes.AddChart2(201, xlColumnClustered) \n  End With\n\n  With myShape.Chart\n    .SetSourceData Source:=range3\n    .ChartTitle.Text = ws.Cells(x, \"A\")\n    .ChartType = xlColumnClustered\n    .HasLegend = False     \n  End With\n\n  With myShape.Chart.Axes(xlValue)\n    .HasTitle = True\n    .AxisTitle.Caption = \"Frequency\"\n  End With\n\n  With myShape.Chart.Axes(xlCategory)\n    .HasTitle = True\n    .AxisTitle.Caption = \"Time\"\n  End With\nNext x\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1577712463, "post_id": 59531646, "comment_id": 105232728, "body": "You have to loop."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1577713732, "last_edit_date": 1577713732, "creation_date": 1577713023, "answer_id": 59531803, "question_id": 59531646, "link": "https://stackoverflow.com/questions/59531646/modify-different-range-values-with-string-concatenation/59531803#59531803", "title": "Modify different range values with string concatenation", "body": "<p>As noted in the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.value\" rel=\"nofollow noreferrer\"><code>Range.Value</code> docs</a> and many places elsewhere:</p>\n\n<blockquote>\n  <p>For ranges whose first area contains more than one cell, <strong><code>Value</code></strong> returns a <strong><code>Variant</code></strong> containing a 2-dimensional array of the values in the individual cells of the first range.</p>\n</blockquote>\n\n<p>You can't concatenate strings and an array. Hence you need to loop.</p>\n\n<p>Note - while you need to loop, it will be faster to loop through the array instead of cell-by-cell.</p>\n"}], "owner": {"reputation": 400, "user_id": 9148880, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XKm4r.jpg?s=128&g=1", "display_name": "manoelpqueiroz", "link": "https://stackoverflow.com/users/9148880/manoelpqueiroz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 59531803, "answer_count": 1, "score": 0, "last_activity_date": 1577741024, "creation_date": 1577712369, "last_edit_date": 1577741024, "question_id": 59531646, "link": "https://stackoverflow.com/questions/59531646/modify-different-range-values-with-string-concatenation", "title": "Modify different range values with string concatenation", "body": "<p>I have a range where I paste a few values previously typed by the user and in order to properly set an advanced filter, I have to change its values (namely the text that sets up the filter, so that something like <code>parameter</code> becomes <code>&lt;&gt;*parameter*</code> for all cells in range).</p>\n\n<p>However, when trying to do it directly with <code>rng.Value = \"&lt;&gt;*\" &amp; rng.Value &amp; \"*\"</code>, VBA runs into <code>Error 13</code> (incompatible types).</p>\n\n<p>I have found a workaround by doing</p>\n\n<pre><code>For each cel in rng\n    cel.Value = \"&lt;&gt;*\" &amp; cell.Value &amp; \"*\"\nNext cel\n</code></pre>\n\n<p>But I would like to know if it is possible to be done in an alternative way without a loop and using <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range(object)\" rel=\"nofollow noreferrer\">Range's</a> own methods and properties. Note that I'm not trying to set a single value for all cells in range, but rather concatenate each different value with <code>&lt;&gt;*</code> at the beginning and <code>*</code> at the end.</p>\n"}, {"tags": ["excel", "vba", "autofilter"], "answers": [{"tags": [], "owner": {"reputation": 3035, "user_id": 1357061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbacb6daf199175a515c835c3350e6cf?s=128&d=identicon&r=PG", "display_name": "Ryan B.", "link": "https://stackoverflow.com/users/1357061/ryan-b"}, "is_accepted": true, "score": 0, "last_activity_date": 1577719862, "creation_date": 1577719862, "answer_id": 59533182, "question_id": 59531476, "link": "https://stackoverflow.com/questions/59531476/vba-autofilter-with-dynamic-field-column/59533182#59533182", "title": "VBA Autofilter with dynamic field column", "body": "<p>I'm having some trouble understanding your problem, but I think that your situation looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gy4yb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gy4yb.png\" alt=\"enter image description here\"></a></p>\n\n<p>In this example, if the given code is run we will filter on Column E instead of on Column C.</p>\n\n<p>This is because the selected cell is in Column 3.  But the field that we want to filter isn't the 3rd field in the AutoFilter -- it's the 1st field in the AutoFilter.  It looks like the bit of code <code>Field:=ActiveCell.Column</code> isn't doing the right thing for us.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>Sub Filtro_Valor_C\u00e9lula()\n'Filtra a coluna pelo valor da c\u00e9lula selecionada\n'\n\n\n    Valor = ActiveCell.Value\n    FieldToFilter= ActiveCell.Column - ActiveSheet.AutoFilter.Range.Column + 1\n\n    ActiveSheet.Range(ActiveSheet.AutoFilter.Range.Address).AutoFilter Field:=FieldToFilter, Criteria1:=Valor\n\n\nEnd Sub\n</code></pre>\n\n<p>Here we take the position of the selected column (ActiveCell.Column) and subtract the column number that our AutoFilter begins in.  We want to start counting from 1 and not zero, so we need to add 1 to the result.   </p>\n\n<p><a href=\"https://i.stack.imgur.com/wP1zo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wP1zo.png\" alt=\"enter image description here\"></a></p>\n\n<p>Hope it helps.</p>\n"}], "owner": {"reputation": 37, "user_id": 11428246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345bcbb15b8304fcdac214f87c95fbf1?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Matioli", "link": "https://stackoverflow.com/users/11428246/carlos-matioli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 236, "favorite_count": 0, "accepted_answer_id": 59533182, "answer_count": 1, "score": 0, "last_activity_date": 1577719862, "creation_date": 1577711582, "last_edit_date": 1577713387, "question_id": 59531476, "link": "https://stackoverflow.com/questions/59531476/vba-autofilter-with-dynamic-field-column", "title": "VBA Autofilter with dynamic field column", "body": "<p>I made a code for filter by selected cell value, to create an quick access toolbar icon and make it faster to filter. It worked perfectly when the filter started in column A. But some filters starts in columns B or C... and the value is filtered in another column, jumping the exact same number of blank columns that has no filter. Do you guys know how to fix it? How to get the VBA to return the field number?</p>\n\n<pre><code>Sub Filtro_Valor_C\u00e9lula()\n'Filtra a coluna pelo valor da c\u00e9lula selecionada\n'\n\n\n    Valor = ActiveCell.Value\n\n    ActiveSheet.Range(ActiveSheet.AutoFilter.Range.Address).AutoFilter Field:=ActiveCell.Column, Criteria1:=Valor\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577711090, "post_id": 59531315, "comment_id": 105232152, "body": "Use <code>.Text</code> instead of <code>.Value</code> assuming they are formatted correctly on the worksheet."}, {"owner": {"reputation": 113, "user_id": 12625366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f8ad1e5659e617061d0c209015bd337?s=128&d=identicon&r=PG&f=1", "display_name": "TerrifiedJelly", "link": "https://stackoverflow.com/users/12625366/terrifiedjelly"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577711609, "post_id": 59531315, "comment_id": 105232362, "body": "I&#39;m afraid this came back with the error message &quot;Could not set the List property. Invalid property array index. NewRangePlan.VATRateDD.List = Ref.Range(&quot;AE2:AE7&quot;).Text"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577711847, "post_id": 59531315, "comment_id": 105232470, "body": "But <code>.Value</code> worked just fine? Then I guess you will have to loop thru them and format them as you go."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577712108, "post_id": 59531315, "comment_id": 105232588, "body": "^ <code>.Text</code> doesn&#39;t return an array like <code>.Value</code> does. Returns <code>Null</code> unless each cell in the source range has the same text."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1577712756, "post_id": 59531315, "comment_id": 105232858, "body": "@BigBen Good to know (why I made it a comment and not an answer, because I&#39;ve never tried it). I guess I&#39;ve I always just looped anyways because I will often want multiple columns formatted differently."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1577735055, "post_id": 59531315, "comment_id": 105241664, "body": "FYI added a short <code>.List</code> assignment solution using <code>MMult()</code> :-)"}], "answers": [{"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1577734855, "creation_date": 1577734855, "answer_id": 59536049, "question_id": 59531315, "link": "https://stackoverflow.com/questions/59531315/format-drop-down-list-in-userform-vba/59536049#59536049", "title": "Format Drop Down List in UserForm VBA", "body": "<p><strong>Short <code>.List</code> assignment using <code>MMult()</code></strong></p>\n\n<p>If you can live with a display without the percent sign (\"%\") in the drop down list, you can try the following approach via WorksheetFunction <code>MMult()</code>; otherwise you <em>\"will have to loop thru them and format them as you go\"</em> as mentioned in comment by braX. </p>\n\n<pre><code>Dim percents As Range\nSet percents = Sheet1.Range(\"AE2:AE7\")  ' set percent data range to memory\nDim factor100 As Range\nSet factor100 = Sheet1.Range(\"A\" &amp; Sheet1.Rows.Count).Resize(1, percents.Rows.Count)\n    factor100 = 100                     ' write factor 100 to temporary range\nWith Me.VATRateDD                       ' assuming DropDown reference within the UserForm code module\n    .List = WorksheetFunction.MMult(percents, factor100)\nEnd With\nfactor100 = vbNullString                ' clear temp range\n</code></pre>\n\n<p><strong>Further note</strong></p>\n\n<p>Don't address a form's <em>default</em> instance. If you are referring to a control, within the UserForm code module, you may use the <code>Me</code> qualifier addressing the form's <em>current</em> instance. - <em>FYI Recommend reading <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">UserForm1.Show?</a> for a deeper insight.</em></p>\n"}], "owner": {"reputation": 113, "user_id": 12625366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f8ad1e5659e617061d0c209015bd337?s=128&d=identicon&r=PG&f=1", "display_name": "TerrifiedJelly", "link": "https://stackoverflow.com/users/12625366/terrifiedjelly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 155, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577734855, "creation_date": 1577710896, "last_edit_date": 1577711035, "question_id": 59531315, "link": "https://stackoverflow.com/questions/59531315/format-drop-down-list-in-userform-vba", "title": "Format Drop Down List in UserForm VBA", "body": "<p>I have a list in a reference tab of VAT rates shown as 0.0%, 2.0%, 5.0%, 17.5%, 20.0% however when these are added to the userform, they change to the following format: 0.00, 0.02, 0.05, 0.175 and 0.2.</p>\n\n<p>Can anyone advise how I can correct the formatting?</p>\n\n<pre><code>#importing the VAT Rate list\nNewRangePlan.VATRateDD.List = Ref.Range(\"AE2:AE7\").Value\n</code></pre>\n"}, {"tags": ["excel", "vba", "textbox"], "answers": [{"tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": true, "score": 0, "last_activity_date": 1577712758, "creation_date": 1577712758, "answer_id": 59531744, "question_id": 59531262, "link": "https://stackoverflow.com/questions/59531262/how-to-not-clean-a-specific-textbox-when-other-userform-controls-are-cleaned/59531744#59531744", "title": "How to not clean a specific Textbox when other Userform controls are cleaned?", "body": "<p>To skip over Text1 but clear the rest of the text boxes you need a conditional in your controls loop.</p>\n\n<pre><code>Dim TC As Control\n    For Each TC In Controls\n        If TypeName(TC) = \"TextBox\" Or TypeName(TC) = \"ComboBox\" Then\n            If Not TC.name = \"TextBox1\" then 'Assuming this is the right name\n                TC.Value = \"\"\n            end if\n        End If\n    Next TC\n    Set TC = Nothing\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 11902097, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-80dzybjktFc/AAAAAAAAAAI/AAAAAAAABNE/wKp4n05PutM/photo.jpg?sz=128", "display_name": "Emir G&#246;kbudak", "link": "https://stackoverflow.com/users/11902097/emir-g%c3%b6kbudak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 59531744, "answer_count": 1, "score": 0, "last_activity_date": 1581393532, "creation_date": 1577710657, "last_edit_date": 1581393532, "question_id": 59531262, "link": "https://stackoverflow.com/questions/59531262/how-to-not-clean-a-specific-textbox-when-other-userform-controls-are-cleaned", "title": "How to not clean a specific Textbox when other Userform controls are cleaned?", "body": "<p>On my Userform, I have a textbox (let's say Txt1). I use it as a search bar for my listbox (Lst1).</p>\n\n<p>When I write any expression to Txt1, I find what I am looking for inside Lst1. \nThese two (Txt1 and Lst1) are integrated to my stock program.</p>\n\n<p>When I search any product with Txt1, I can choose product name from Lst1.</p>\n\n<p>When I choose the product from Lst1, I write quantity to Txt2 and press enter.\nIt makes necessary process at the backside of the program.</p>\n\n<p>When I press enter, Txt1 cleans itself.<br>\nI need to re-write new product name again to Txt1.</p>\n\n<p><strong>I want:</strong><br>\nTo not clean Txt1.</p>\n\n<p><strong>Txt1 Code :</strong></p>\n\n<pre><code>Private Sub TextBox17_Change()\n\nDim i As Long\nMe.TextBox17.Text = StrConv(Me.TextBox17.Text, 1)\nMe.ListBox4.Clear\nFor i = 2 To Application.WorksheetFunction.CountA(Sayfa2.Range(\"C:C\"))\n    a = Len(Me.TextBox17.Text)\n    If Left(Sayfa2.Cells(i, 3).Value, a) = Left(Me.TextBox17.Text, a) Then\n        Me.ListBox4.AddItem Sayfa2.Cells(i, 3).Value\n        Me.ListBox4.List(ListBox4.ListCount - 1, 3) = Sayfa2.Cells(i, 10).Value\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><strong>Lst1 Code :</strong></p>\n\n<pre><code>Private Sub ListBox4_Click()\n\nDim i As Long, lastrow As Long\nlastrow = Sheets(\"CDepo\").Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nFor i = 2 To lastrow\n    If CStr(Sheets(\"CDepo\").Cells(i, \"C\").Value) = (Me.ListBox4.Value) Then\n        Me.TextBox2 = Sheets(\"CDepo\").Cells(i, \"A\").Value\n        Me.TextBox11 = Sheets(\"CDepo\").Cells(i, \"H\").Value\n        Me.TextBox9 = Sheets(\"CDepo\").Cells(i, \"C\").Value\n        Me.ComboBox2 = Sheets(\"CDepo\").Cells(i, \"B\").Value\n        Me.TextBox6 = Sheets(\"CDepo\").Cells(i, \"I\").Value\n        Me.TextBox13 = Sheets(\"CDepo\").Cells(i, \"J\").Value\n        Me.TextBox15 = Sheets(\"CDepo\").Cells(i, \"P\").Value\n        Me.TextBox8 = Sheets(\"CDepo\").Cells(i, \"D\").Value\n        Me.TextBox16 = Sheets(\"CDepo\").Cells(i, \"Q\").Value\n    End If\nNext\n\nEnd Sub\n</code></pre>\n\n<p><strong>Commandbutton for Enter :</strong></p>\n\n<pre><code>Private Sub CommandButton6_Click()\n\nIf UserForm11.ComboBox4 = \"TesellumFisi\" Then\n\n    If TextBox2.Text &lt;&gt; \"\" Then\n        Son_Dolu_Satir = Sheets(\"TesellumFisi\").Range(\"A65536\").End(xlUp).Row\n\n        For i = 23 To Son_Dolu_Satir\n            If Sheets(\"TesellumFisi\").Cells(i, 2).Value = TextBox2.Text Then\n                Exit Sub\n            End If\n        Next i\n        Bos_Satir = Son_Dolu_Satir + 1\n        Sheets(\"TesellumFisi\").Range(\"A\" &amp; Bos_Satir).Value = Application.WorksheetFunction.Max(Sheets(\"TesellumFisi\").Range(\"A:A\")) + 1\n        Sheets(\"TesellumFisi\").Range(\"B\" &amp; Bos_Satir).Value = TextBox2.Text\n        Sheets(\"TesellumFisi\").Range(\"C\" &amp; Bos_Satir).Value = TextBox13.Text\n        Sheets(\"TesellumFisi\").Range(\"E\" &amp; Bos_Satir).Value = TextBox9.Text\n        Sheets(\"TesellumFisi\").Range(\"I\" &amp; Bos_Satir).Value = TextBox4.Text\n        Sheets(\"TesellumFisi\").Range(\"J\" &amp; Bos_Satir).Value = TextBox6.Text\n        Sheets(\"TesellumFisi\").Range(\"O13\").Value = UserForm11.ComboBox1.Text\n        Sheets(\"TesellumFisi\").Range(\"H\" &amp; Bos_Satir).Value = UserForm11.ComboBox2.Text\n        Sheets(\"TesellumFisi\").Range(\"G\" &amp; Bos_Satir).Value = TextBox8.Text\n    End If\nEnd If\n\nDim TC As Control\nFor Each TC In Controls\n    If TypeName(TC) = \"TextBox\" Or TypeName(TC) = \"ComboBox\" Then\n        TC.Value = \"\"\n    End If\nNext TC\nSet TC = Nothing\n\n'--\nTextBox2.SetFocus\nTextBox2.SelStart = 1\nTextBox2.SelLength = Len(TextBox2.Text)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "checkbox", "groupname"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1577708394, "post_id": 59530638, "comment_id": 105230976, "body": "You can look at the <code>parent</code> of the control, whether it the userform or the multipage page.  Or reference deeper, so instead of <code>me.controls</code> use <code>Me.MultiPage1.Pages(0).Controls</code>"}, {"owner": {"reputation": 35, "user_id": 12624838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80130bcef1b2e4a4c0bc9a6e63a3ff6d?s=128&d=identicon&r=PG&f=1", "display_name": "Davey", "link": "https://stackoverflow.com/users/12624838/davey"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577711592, "post_id": 59530638, "comment_id": 105232349, "body": "Exchanging me.controls for Me.MultiPage1.Pages(0).Controls solved my issues with the multipages, and prints Reeks1 to Reeks4 as requested. How do I adress the original Reeks parent?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577711960, "post_id": 59530638, "comment_id": 105232520, "body": "How do you mean the original reeks parent?"}, {"owner": {"reputation": 35, "user_id": 12624838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80130bcef1b2e4a4c0bc9a6e63a3ff6d?s=128&d=identicon&r=PG&f=1", "display_name": "Davey", "link": "https://stackoverflow.com/users/12624838/davey"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577712576, "post_id": 59530638, "comment_id": 105232778, "body": "The orginal &#39;Reeks&#39; is placed above/outside of the Multipage menu. I copy pasted 4 Me.MultiPage1.Pages(0 to 3).Controls bits of code which take their info from their individual Reeks1(to4). But Reeks still has Me.Controls which claims the input from the multipages still.   I tried Me.Userform.Controls, Me.Userform.Reeks.Controls, but VBA says no to those."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577713565, "post_id": 59530638, "comment_id": 105233249, "body": "Use the <code>.parent</code> then from <code>me.controls</code> so say <code>if ctl.parent=&quot;UserForm1&quot; then </code> and base on that, or <code>select case ctl.parent</code>"}, {"owner": {"reputation": 35, "user_id": 12624838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80130bcef1b2e4a4c0bc9a6e63a3ff6d?s=128&d=identicon&r=PG&f=1", "display_name": "Davey", "link": "https://stackoverflow.com/users/12624838/davey"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577789512, "post_id": 59530638, "comment_id": 105255195, "body": "Sorry, I dont fully understand .parent/ctl/select case yet,  is it possible to show me a sample of how it should look? I added a sample image of my form, am now finding Me.Multipage gives me the same issues when trying to define just the first colours and not also the Frame locations."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577790218, "post_id": 59530638, "comment_id": 105255446, "body": "<code>if control.parent=&quot;UserForm1&quot; then strX=&quot;Reeks&quot; else &lt;&lt;do your string bit here&gt;&gt; end if</code>  also avoid using keywords like <code>control</code> for your variable names, this can get confusing.  Use something like <code>for each ctl in me.controls</code>"}, {"owner": {"reputation": 35, "user_id": 12624838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80130bcef1b2e4a4c0bc9a6e63a3ff6d?s=128&d=identicon&r=PG&f=1", "display_name": "Davey", "link": "https://stackoverflow.com/users/12624838/davey"}, "reply_to_user": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1577972531, "post_id": 59530638, "comment_id": 105296449, "body": "Thank you for your patience &amp; help. Your comments helped me a lot, your last suggestion gave me another error (450). However I found the solution by changing the &#39;comment line to If ctl.Object.Groupname = &quot;Reeks&quot; Then. And now it seems to be working!"}], "owner": {"reputation": 35, "user_id": 12624838, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/80130bcef1b2e4a4c0bc9a6e63a3ff6d?s=128&d=identicon&r=PG&f=1", "display_name": "Davey", "link": "https://stackoverflow.com/users/12624838/davey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577788520, "creation_date": 1577707918, "last_edit_date": 1577788520, "question_id": 59530638, "link": "https://stackoverflow.com/questions/59530638/how-do-i-call-upon-checkboxes-with-groupname-or-tag", "title": "How do I call upon checkboxes with groupname or tag?", "body": "<p>Am creating a form in which the user will be able to select 4 checkboxes. Blue, Green, Yellow, Red. They have to do this atleast twice, up to 5 times in total. </p>\n\n<p><a href=\"https://i.stack.imgur.com/PekqB.png\" rel=\"nofollow noreferrer\">The Form Example</a></p>\n\n<p>The first checkboxes are on the form, the other 4 grouped checkboxes are on multipages. </p>\n\n<p>I've tried giving them a group name \"Reeks\" to \"Reeks4\", to then print their values into a single cell separated by comma. </p>\n\n<p>The code I've found so far does print the values neatly, however, it grabs every available checkbox on my form instead of just from the group \"Reeks\". </p>\n\n<p>The ways I've tried to add the groupname (or tag, named them both the same) to the code, only gives me errors. </p>\n\n<pre><code>For Each Control In Me.Controls\n   If TypeName(Control) = \"CheckBox\" Then\n               'If Control.GroupName = \"Reeks\" Then\n                If Control.Value Then \n            Reeks = IIf(Reeks &lt;&gt; \"\", Reeks &amp; \", \", \"\") &amp; Control.Caption\n        End If\n        End If\n    Next\n</code></pre>\n\n<pre><code>With ws \n.Cells(iRow, 5).Value = Reeks\nEnd With\n</code></pre>\n\n<p>Any help is welcome, but if at all possible please add comments as I only started on VBA last week. </p>\n\n<p>(Side note. I also have framed checkboxes on the multipages in which the user can select the location of said colour. Side + Top view. Which will need to work the same as with the colours, but printed in different columns. ) </p>\n"}, {"tags": ["excel", "vba", "loops", "web-scraping"], "comments": [{"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 1, "creation_date": 1577708452, "post_id": 59530636, "comment_id": 105230997, "body": "Does this code work? It looks to be a mess in terms of loops... <code>Next i</code> should be the last (because it appears first). I will try editing and improve the indentation to make it more readable..."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1577709839, "post_id": 59530636, "comment_id": 105231594, "body": "What &quot;number of pages&quot; is listed in column D?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1577710617, "post_id": 59530636, "comment_id": 105231947, "body": "What references did you add to your project in order to work with <code>http As New XMLHTTP60, html As New HTMLDocument</code>?"}, {"owner": {"reputation": 43, "user_id": 12460530, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0ZgxaaY3yls/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXajrrRijaGwiZHM_jm30f8fOE5w/photo.jpg?sz=128", "display_name": "Serge Atareev", "link": "https://stackoverflow.com/users/12460530/serge-atareev"}, "reply_to_user": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1577710986, "post_id": 59530636, "comment_id": 105232119, "body": "FaneDuru, yes, it work.."}], "answers": [{"comments": [{"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1577716592, "post_id": 59531768, "comment_id": 105234554, "body": "Nice. Even if the most time consuming comes from the HTML reading side, after I understood what that &#39;page&#39; means, I tried to optimize your initial answer in a way to work only in memory."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 1, "creation_date": 1577716657, "post_id": 59531768, "comment_id": 105234590, "body": "@FaneDuru Sure. There is a lot of room for improvement in the above. :-)"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1577717304, "last_edit_date": 1577717304, "creation_date": 1577712864, "answer_id": 59531768, "question_id": 59530636, "link": "https://stackoverflow.com/questions/59530636/optimizing-scraping-and-looping/59531768#59531768", "title": "Optimizing Scraping and Looping", "body": "<p>What you really want to do is a re-factor (which I may add in with time) to reduce code complexity. For now, to fix your looping problem see how you can generate two 1D arrays containing urls and page counts and then use 1 loop over page counts and index into the other array using the current loop counter value.</p>\n\n<p>Get rid of auto-instantiation, qualify with class names, use Long rather than Integer, worksheets rather than sheets.</p>\n\n<p>In a re-factor work with arrays so as to write out faster to sheet.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetData()\n    Dim wsSheet As Worksheet, rezultSheet As Worksheet, rowCount As Long\n    Dim http As MSXML2.XMLHTTP60, html As MSHTML.HTMLDocument\n    Dim i As Long, topic As MSHTML.HTMLHtmlElement\n    Dim x As Long, pageCounts(), numPages As Long, page As Long, links()\n\n    Application.ScreenUpdating = False\n\n    On Error GoTo errHand\n\n    Set http = New MSXML2.XMLHTTP60\n    Set html = New MSHTML.HTMLDocument\n    Set wsSheet = ThisWorkbook.Worksheets(\"URLs_2\")\n    Set rezultSheet = ThisWorkbook.Worksheets(\"Products\")\n\n    rowCount = wsSheet.Cells(wsSheet.Rows.Count, \"A\").End(xlUp).Row\n    links = Application.Transpose(wsSheet.Range(\"A1:A\" &amp; rowCount)) 'turn into 1D array\n    pageCounts = Application.Transpose(wsSheet.Range(\"D1:D\" &amp; rowCount))\n\n    For i = LBound(pageCounts) To UBound(pageCounts)\n        numPages = pageCounts(i)\n\n        With http\n            For page = 1 To numPages\n                .Open \"GET\", links(i) &amp; \"?display=90&amp;sortby=1&amp;page=\" &amp; page, False\n                .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n                .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n                .send\n\n                html.body.innerHTML = .responseText\n\n                For Each topic In html.getElementsByClassName(\"ui-product-card__info\")\n                    x = x + 1\n                    With topic.getElementsByClassName(\"product-name\")\n                        If .Length Then rezultSheet.Cells(x, 2) = .Item(0).innerText\n                    End With\n                    With topic.getElementsByClassName(\"price-section-inner\")\n                        If .Length Then rezultSheet.Cells(x, 3) = .Item(0).innerText\n                    End With\n                    With topic.getElementsByClassName(\"madein__text\") '\n                        If .Length Then rezultSheet.Cells(x, 1) = .Item(1).innerText\n                    End With\n                Next topic\n\n                html.body.innerHTML = vbNullString\n            Next\n        End With\n    Next\nerrHand:\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Re-factoring (not my best I'm afraid but a starting point. You'll want some lower level error handling for example). It is more code but starts to allocate separate logical tasks into their own sub/func: </p>\n\n<pre><code>Option Explicit\nPublic wsSheet As Worksheet, rezultSheet As Worksheet\n\nPublic Sub GetData()\n\n    Dim http As MSXML2.XMLHTTP60, rowCount As Long, pageCounts(), links()\n\n    Application.ScreenUpdating = False\n\n    On Error GoTo errHand\n\n    Set http = New MSXML2.XMLHTTP60\n    Set wsSheet = Sheets(\"URLs_2\")\n    Set rezultSheet = ThisWorkbook.Worksheets(\"Products\")\n\n    With rezultSheet.Cells\n        .ClearContents\n        .ClearFormats\n    End With\n\n    rowCount = wsSheet.Cells(wsSheet.Rows.Count, \"A\").End(xlUp).Row\n    links = Application.Transpose(wsSheet.Range(\"A1:A\" &amp; rowCount)) 'turn into 1D array\n    pageCounts = Application.Transpose(wsSheet.Range(\"D1:D\" &amp; rowCount))\n\n    GetResults http, pageCounts, links\n\nerrHand:\n    Application.ScreenUpdating = True\n    If Err.Number &lt;&gt; 0 Then Debug.Print Err.Number, Err.Description\nEnd Sub\n\n\nPublic Sub GetResults(ByVal http As MSXML2.XMLHTTP60, ByRef pageCounts(), ByRef links())\n    Dim i As Long, numPages As Long\n    Dim page As Long, html As MSHTML.HTMLDocument\n\n    Set html = New MSHTML.HTMLDocument\n\n    For i = LBound(pageCounts) To UBound(pageCounts)\n        numPages = pageCounts(i)\n\n        With http\n            For page = 1 To numPages\n                .Open \"GET\", links(i) &amp; \"?display=90&amp;sortby=1&amp;page=\" &amp; page, False\n                .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n                .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n                .send\n\n                html.body.innerHTML = .responseText\n\n                WriteOutResults html\n\n                html.body.innerHTML = vbNullString\n            Next\n        End With\n    Next\nEnd Sub\n\n\nPublic Sub WriteOutResults(ByVal html As MSHTML.HTMLDocument)\n    Dim topic As MSHTML.HTMLHtmlElement, results()\n    Dim r As Long, productCards As Object\n\n    Set productCards = html.getElementsByClassName(\"ui-product-card__info\")\n\n    ReDim results(1 To productCards.Length, 1 To 3)\n\n    For Each topic In productCards\n        r = r + 1\n        With topic.getElementsByClassName(\"product-name\")\n            If .Length Then results(r, 2) = .Item(0).innerText\n        End With\n        With topic.getElementsByClassName(\"price-section-inner\")\n            If .Length Then results(r, 3) = .Item(0).innerText\n        End With\n        With topic.getElementsByClassName(\"madein__text\") '\n            If .Length Then results(r, 1) = .Item(1).innerText\n        End With\n    Next topic\n\n    Dim lastRow As Long\n\n    lastRow = GetLastRow(rezultSheet)\n    rezultSheet.Cells(lastRow + 1, 1).Resize(UBound(results, 1), UBound(results, 2)) = results\nEnd Sub\n\nPublic Function GetLastRow(ByVal sh As Worksheet) As Long\n    On Error Resume Next\n    GetLastRow = sh.Cells.Find(What:=\"*\", _\n                               After:=sh.Range(\"A1\"), _\n                               Lookat:=xlPart, _\n                               LookIn:=xlFormulas, _\n                               SearchOrder:=xlByRows, _\n                               SearchDirection:=xlPrevious, _\n                               MatchCase:=False).Row\n    On Error GoTo 0\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577716925, "post_id": 59532561, "comment_id": 105234705, "body": "If you can find a reliable way to get an estimate total result count you would be better off oversizing array and having just the initial redim and final redim rather as more efficient than lots of redim."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577717445, "post_id": 59532561, "comment_id": 105234946, "body": "It is not really impossible, but redim takes very little time. I downloaded his workbook and I sow how the page number is calculated. It rounds using CEILING formula the total used tags divided by 90. So, multiplying the total &#39;pages&#39; with 90 will obtain a dimension a little biggar then necessary and adding empty rows will not take more then half of millisecond... But I do not think that will gain some significant/observable time."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1577717494, "post_id": 59532561, "comment_id": 105234964, "body": "It is about memory efficiency rather than time as redim is a copy of the array IIRC."}, {"owner": {"reputation": 43, "user_id": 12460530, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0ZgxaaY3yls/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXajrrRijaGwiZHM_jm30f8fOE5w/photo.jpg?sz=128", "display_name": "Serge Atareev", "link": "https://stackoverflow.com/users/12460530/serge-atareev"}, "edited": false, "score": 1, "creation_date": 1577777495, "post_id": 59532561, "comment_id": 105251165, "body": "QHarr, FaneDuru perfect.  Thank you so much! And happy New Year!"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 43, "user_id": 12460530, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0ZgxaaY3yls/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXajrrRijaGwiZHM_jm30f8fOE5w/photo.jpg?sz=128", "display_name": "Serge Atareev", "link": "https://stackoverflow.com/users/12460530/serge-atareev"}, "edited": false, "score": 0, "creation_date": 1577788624, "post_id": 59532561, "comment_id": 105254848, "body": "@Serge Atareev: I wish you a Happy New Year, too!            And, if you followed my discussion with @QHar I would like to emphasize that if will avoid <code>Redim Preserve</code> it will be good to initially <code>Redim</code> your array in a different way: You must reverse its rows and columns. In this way you will avoid <code>Transpose</code>, which also consumes time and resources. Not very much, but for the sake of optimization it is good to be known, I think..."}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": true, "score": 2, "last_activity_date": 1577716727, "creation_date": 1577716727, "answer_id": 59532561, "question_id": 59530636, "link": "https://stackoverflow.com/questions/59530636/optimizing-scraping-and-looping/59532561#59532561", "title": "Optimizing Scraping and Looping", "body": "<p>Code adapting @QHar solution, in order to work only in computer memory...</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub GetDataInMemory()\n    Dim wsSheet As Worksheet, rezultSheet As Worksheet, rowCount As Long\n    Dim http As MSXML2.XMLHTTP60, html As MSHTML.HTMLDocument\n    Dim i As Long, topic As MSHTML.HTMLHtmlElement\n    Dim x As Long, pageCounts(), numPages As Long, page As Long, links()\n    Dim Data() As String, k As Long\n\n    Set http = New MSXML2.XMLHTTP60\n    Set html = New MSHTML.HTMLDocument\n    Set wsSheet = ThisWorkbook.Worksheets(\"URLs_2\")\n    Set rezultSheet = ThisWorkbook.Worksheets(\"Products\")\n\n    rowCount = wsSheet.Cells(wsSheet.Rows.Count, \"A\").End(xlUp).Row\n    links = Application.Transpose(wsSheet.Range(\"A1:A\" &amp; rowCount)) 'turn into 1D array\n    pageCounts = Application.Transpose(wsSheet.Range(\"D1:D\" &amp; rowCount))\n\n    ReDim Data(2, k)\n    For i = LBound(pageCounts) To UBound(pageCounts)\n        numPages = pageCounts(i)\n\n        With http\n            For page = 1 To numPages\n                .Open \"GET\", links(i) &amp; \"?display=90&amp;sortby=1&amp;page=\" &amp; page, False\n                .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n                .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n                .send\n                html.body.innerHTML = .responseText\n                For Each topic In html.getElementsByClassName(\"ui-product-card__info\")\n                    With topic.getElementsByClassName(\"product-name\")\n                        If .Length Then Data(1, x) = .Item(0).innerText\n                    End With\n                    With topic.getElementsByClassName(\"price-section-inner\")\n                        If .Length Then Data(2, x) = .Item(0).innerText\n                    End With\n                    With topic.getElementsByClassName(\"madein__text\")\n                        If .Length Then Data(0, x) = .Item(0).innerText\n                    End With\n                    x = x + 1: ReDim Preserve Data(2, x)\n                Next topic\n\n                html.body.innerHTML = vbNullString\n            Next\n        End With\n    Next\n    rezultSheet.Range(\"A1:C\" &amp; x - 1).Value = Application.Transpose(Data)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 12460530, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0ZgxaaY3yls/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfXajrrRijaGwiZHM_jm30f8fOE5w/photo.jpg?sz=128", "display_name": "Serge Atareev", "link": "https://stackoverflow.com/users/12460530/serge-atareev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 59532561, "answer_count": 2, "score": 0, "last_activity_date": 1577741185, "creation_date": 1577707899, "last_edit_date": 1577741185, "question_id": 59530636, "link": "https://stackoverflow.com/questions/59530636/optimizing-scraping-and-looping", "title": "Optimizing Scraping and Looping", "body": "<p>I want to find a collection and loop over it to load each page. I am attempting to:</p>\n\n<ol>\n<li>Find the number of pages - it's done (column D)</li>\n<li>Loop over links (column A) and past last page number as <code>i</code>\n\n<ul>\n<li>I know that I can loop to the next page, from page 1, with:<br>\n<code>For i = 1 To \"number of last page (column D)\"</code></li>\n</ul></li>\n</ol>\n\n<p></p>\n\n<pre><code>| https://voronezh.leroymerlin.ru/catalogue/krovelnye-mastiki/                          |       | -7    | 1     |\n| https://voronezh.leroymerlin.ru/catalogue/vodostok/                                   |       | -125  | 2     |\n| https://voronezh.leroymerlin.ru/catalogue/rozetki-i-vyklyuchateli/                    |       | -898  | 10    |\n| https://voronezh.leroymerlin.ru/catalogue/ramki-dlya-rozetok-i-vyklyuchateley/        |       | -398  | 5     |\n| https://voronezh.leroymerlin.ru/catalogue/nakladki-dlya-rozetok-i-vyklyuchateley/     |       | -35   | 1     |\n| https://voronezh.leroymerlin.ru/catalogue/podrozetniki/                               |       | -11   | 1     |\n| https://voronezh.leroymerlin.ru/catalogue/silovye-kabeli/                             |       | -175  | 2     |\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/a1gW8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a1gW8.png\" alt=\"enter image description here\"></a></p>\n\n<p>I tried the following code to loop all urls, but it is not working correctly.</p>\n\n<pre><code>Sub get_data()\nDim wsSheet As Worksheet, REZULTSheet As Worksheet, Rows As Long, http As New XMLHTTP60, html As New HTMLDocument\nDim i As Integer, topic As HTMLHtmlElement, link As Variant, x As Long, num_pages As Variant, links As Variant\nSet wsSheet = Sheets(\"URLs_2\")\nSet REZULTSheet = Sheets(\"Products\")\nRows = wsSheet.Cells(wsSheet.Rows.Count, \"A\").End(xlUp).row\nlinks = wsSheet.Range(\"A1:A\" &amp; Rows)\nnum_pages = wsSheet.Range(\"D1:D\" &amp; Rows)\nREZULTSheet.Select\n\nFor i = 1 To ??? 'num_pages?\n    Application.ScreenUpdating = False\n    With http\n        For Each link In links\n            .Open \"GET\", link &amp; \"?display=90&amp;sortby=1&amp;page=\" &amp; i, False\n            .setRequestHeader \"User-Agent\", \"Mozilla/5.0\"\n            .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n            .send\n            Do: DoEvents: Loop Until .readyState = 4\n            html.body.innerHTML = .responseText\n            For Each topic In html.getElementsByClassName(\"ui-product-card__info\")\n                With topic.getElementsByClassName(\"product-name\")\n                    If .Length Then x = x + 1: Cells(x, 2) = .item(0).innerText\n                End With\n                With topic.getElementsByClassName(\"price-section-inner\")\n                    If .Length Then Cells(x, 3) = .item(0).innerText\n                End With\n                With topic.getElementsByClassName(\"madein__text\") '\n                    If .Length Then Cells(x, 1) = .item(1).innerText\n                End With\n            Next topic        \n        Next link\n    End With\nNext i\nEnd Sub\n</code></pre>\n\n<p>Since most of the code repeats, is there any way to run a loop to reduce the amount of code.</p>\n\n<p><a href=\"https://dropmefiles.com/b5enY\" rel=\"nofollow noreferrer\">Current test file </a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 11267251, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLwoZYvfTWk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdkpBk-xk33OL1Q0q6hi2EVEXifTA/mo/photo.jpg?sz=128", "display_name": "Justin jant", "link": "https://stackoverflow.com/users/11267251/justin-jant"}, "edited": false, "score": 0, "creation_date": 1577961527, "post_id": 59530552, "comment_id": 105291468, "body": "how if i want it while user is typing, i tried your code but the decimal only shows when user finish inserting number on the textbox"}, {"owner": {"reputation": 1750, "user_id": 11640763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tS29l.png?s=128&g=1", "display_name": "stud3nt", "link": "https://stackoverflow.com/users/11640763/stud3nt"}, "reply_to_user": {"reputation": 75, "user_id": 11267251, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLwoZYvfTWk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdkpBk-xk33OL1Q0q6hi2EVEXifTA/mo/photo.jpg?sz=128", "display_name": "Justin jant", "link": "https://stackoverflow.com/users/11267251/justin-jant"}, "edited": false, "score": 0, "creation_date": 1577961923, "post_id": 59530552, "comment_id": 105291612, "body": "For that you can use <code>tbPrice_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)</code> function but then you have to write some logic to handle the keypress on every input the user will type in."}, {"owner": {"reputation": 1750, "user_id": 11640763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tS29l.png?s=128&g=1", "display_name": "stud3nt", "link": "https://stackoverflow.com/users/11640763/stud3nt"}, "reply_to_user": {"reputation": 75, "user_id": 11267251, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLwoZYvfTWk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdkpBk-xk33OL1Q0q6hi2EVEXifTA/mo/photo.jpg?sz=128", "display_name": "Justin jant", "link": "https://stackoverflow.com/users/11267251/justin-jant"}, "edited": false, "score": 0, "creation_date": 1578029684, "post_id": 59530552, "comment_id": 105314551, "body": "@Justinjant Easy way out will be to enter <code>0.000</code> as a default value or on load of the textbox."}], "tags": [], "owner": {"reputation": 1750, "user_id": 11640763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tS29l.png?s=128&g=1", "display_name": "stud3nt", "link": "https://stackoverflow.com/users/11640763/stud3nt"}, "is_accepted": false, "score": 1, "last_activity_date": 1577708725, "last_edit_date": 1577708725, "creation_date": 1577707485, "answer_id": 59530552, "question_id": 59530349, "link": "https://stackoverflow.com/questions/59530349/how-to-apply-decimal-format-to-a-userform-textbox-entry/59530552#59530552", "title": "How to apply decimal format to a Userform Textbox entry?", "body": "<p>You are updating the value on <code>ForUserForm_Initializem()</code> which will only update once the User form is loaded for first time. So in order to update the value which user enters into the textbox, you have to use <code>AfterUpdate()</code></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub tbPrice_AfterUpdate()\n    tbPrice.Text = Format(tbPrice.Text, \"0.000\")\nEnd Sub\n</code></pre>\n\n<p>This function will called every time the user updates the value in the textbox - <code>tbPrice</code></p>\n"}], "owner": {"reputation": 75, "user_id": 11267251, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-jLwoZYvfTWk/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdkpBk-xk33OL1Q0q6hi2EVEXifTA/mo/photo.jpg?sz=128", "display_name": "Justin jant", "link": "https://stackoverflow.com/users/11267251/justin-jant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1581417682, "creation_date": 1577706574, "last_edit_date": 1581417682, "question_id": 59530349, "link": "https://stackoverflow.com/questions/59530349/how-to-apply-decimal-format-to-a-userform-textbox-entry", "title": "How to apply decimal format to a Userform Textbox entry?", "body": "<p>I want my Price Text Box to have decimal format so when a user types <code>1000000</code> it shows <code>1.000.000</code>.</p>\n\n<p>I tried the code below but it doesn't show the decimal format in Price Textbox.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    tbPrice.Text = Format(Number, \"0.000\")\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/c7VOm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c7VOm.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11, "user_id": 1445209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc8dba56ae95524dd88fc4c565f2515?s=128&d=identicon&r=PG", "display_name": "user1445209", "link": "https://stackoverflow.com/users/1445209/user1445209"}, "edited": false, "score": 0, "creation_date": 1577703934, "post_id": 59529688, "comment_id": 105229158, "body": "DataWB = SourceWB both are same"}, {"owner": {"reputation": 847, "user_id": 8096556, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213647938011768/picture?type=large", "display_name": "Vitaliy Prushak", "link": "https://stackoverflow.com/users/8096556/vitaliy-prushak"}, "edited": false, "score": 0, "creation_date": 1577703948, "post_id": 59529688, "comment_id": 105229165, "body": "What do you have in <code>ThisWorkbook.Worksheets(1).Cells(2, 3)</code>?"}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1577704261, "post_id": 59529688, "comment_id": 105229282, "body": "I think you&#39;d need to turn your expression (<code>f</code>) into a valid Excel formula. For example, <code>?Evaluate(&quot;=OR($A$2=&quot;&quot;BP&quot;&quot;,$A$2=&quot;&quot;Trip&quot;&quot;)&quot;)</code> should work properly."}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 0, "creation_date": 1577705092, "post_id": 59529688, "comment_id": 105229588, "body": "You cannot use VBA variables like that in an <code>Evaluate</code> call."}, {"owner": {"reputation": 11, "user_id": 1445209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc8dba56ae95524dd88fc4c565f2515?s=128&d=identicon&r=PG", "display_name": "user1445209", "link": "https://stackoverflow.com/users/1445209/user1445209"}, "reply_to_user": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1577708322, "post_id": 59529688, "comment_id": 105230948, "body": "@JustynaMK Even that is not working properly. this expression works in cell, but when i put same in evaluate it throws type mismatch; if i dont use another workbook rather another sheet then evaluate works =OR(&#39;D:\\Work&#91;LCR16.xlsx]LCR16&#39;!$A$2=&quot;BP&quot;,&#39;D:\\Work&#91;LC&zwnj;&#8203;R16.xlsx]LCR16&#39;!$A$2&zwnj;&#8203;=&quot;Trip&quot;)"}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1577708681, "post_id": 59529688, "comment_id": 105231103, "body": "Thanks for the update. Does it work when LCR16 workbook is opened? After checking some sources on the internet it looks like <code>Evaluate</code> does not work with closed workbooks..."}, {"owner": {"reputation": 11, "user_id": 1445209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc8dba56ae95524dd88fc4c565f2515?s=128&d=identicon&r=PG", "display_name": "user1445209", "link": "https://stackoverflow.com/users/1445209/user1445209"}, "reply_to_user": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 1, "creation_date": 1577709444, "post_id": 59529688, "comment_id": 105231428, "body": "@JustynaMK Yes it works with open WB only. thanks a lot. why cant evaluate resolve workbook name with this =OR(SourceWB.Worksheets(1).cells(2,1) = &quot;BP&quot;) while same file is used in this case. I think it only accepts absolute reference?"}, {"owner": {"reputation": 11, "user_id": 1445209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc8dba56ae95524dd88fc4c565f2515?s=128&d=identicon&r=PG", "display_name": "user1445209", "link": "https://stackoverflow.com/users/1445209/user1445209"}, "edited": false, "score": 0, "creation_date": 1577709533, "post_id": 59529688, "comment_id": 105231470, "body": "since i have many files, i want to give option to user to choose file and then same rules to be applied"}, {"owner": {"reputation": 3435, "user_id": 10671926, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4y7fi.jpg?s=128&g=1", "display_name": "Justyna MK", "link": "https://stackoverflow.com/users/10671926/justyna-mk"}, "edited": false, "score": 0, "creation_date": 1577709722, "post_id": 59529688, "comment_id": 105231542, "body": "As Rory mentioned, Evaluate cannot be used with VBA variables (like <code>SourceWB.Worksheets(1).cells(2,1)</code>). In other words, if you were to paste <code>=OR(SourceWB.Worksheets(1).cells(2,1) = &quot;BP&quot;)</code> into your Excel window, cell A1, it would return an error as Excel doesn&#39;t recognize this syntax. However, <code>=OR(SheetName!$A$2=&quot;BP&quot;)</code> would work properly. So you need to make sure that you only parse formulas recognized by Excel (not VBA) into your Evaluate command."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 1445209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc8dba56ae95524dd88fc4c565f2515?s=128&d=identicon&r=PG", "display_name": "user1445209", "link": "https://stackoverflow.com/users/1445209/user1445209"}, "is_accepted": false, "score": 0, "last_activity_date": 1577729869, "creation_date": 1577729869, "answer_id": 59535155, "question_id": 59529688, "link": "https://stackoverflow.com/questions/59529688/excel-evaluate-function-inconsistent-result/59535155#59535155", "title": "EXCEL Evaluate function inconsistent result", "body": "<p>Evaluate cant understand VBA Code rather excel worksheet formula can only be used, so i replaced with formula as in picture and it works perfectly now</p>\n\n<pre><code>For J = 2 To lRow\n    For x = 2 To 26\n        f = Trim(ThisWorkbook.Worksheets(1).Cells(x, 3))\n        f = Replace(f, \"WB\", SourceWB.Name)\n        f = Replace(f, \"WS\", SourceWB.Worksheets(1).Name)\n        f = Replace(f, \"R#\", J)\n        test = Evaluate(f)\n        If Not test Then Call LogError(J, x)\n    Next x\nNext J\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/fDAPL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fDAPL.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 1445209, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcc8dba56ae95524dd88fc4c565f2515?s=128&d=identicon&r=PG", "display_name": "user1445209", "link": "https://stackoverflow.com/users/1445209/user1445209"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577729869, "creation_date": 1577703544, "question_id": 59529688, "link": "https://stackoverflow.com/questions/59529688/excel-evaluate-function-inconsistent-result", "title": "EXCEL Evaluate function inconsistent result", "body": "<p>I have one data worksheet which is as per below format (100+ cols)</p>\n\n<p><a href=\"https://i.stack.imgur.com/x30xv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/x30xv.png\" alt=\"enter image description here\"></a></p>\n\n<p>then I have another file containing some rules (multiple rules for each column in data file). I formulated vba conditions for every rule; for example, one rule was to check column A of data file should have only BP or Trip value for all rows (50K+ rows). So I translated that to below VBA</p>\n\n<p>DataWB.Worksheets(1).Cells(J,X) = \"BP\" OR DataWB.Worksheets(1).Cells(J,X) = \"Trip\"</p>\n\n<p><a href=\"https://i.stack.imgur.com/SmPEF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SmPEF.png\" alt=\"enter image description here\"></a></p>\n\n<p>validate button code</p>\n\n<pre><code>        f = Trim(ThisWorkbook.Worksheets(1).Cells(2, 3))\n        f = Replace(f, \"J\", 2)\n        f = Replace(f, \"X\", 1)\n        Debug.Print Application.Evaluate(f)\n</code></pre>\n\n<p>now problem is that evaluate throws type mismatch and if I use CBOOL it always return TRUE. I tried different variations too (like adding = or ? prefix) but nothing seem working. Any help will be highly appreciated.</p>\n\n<p><a href=\"https://i.stack.imgur.com/R0LRt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/R0LRt.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "error-handling", "automation"], "comments": [{"owner": {"reputation": 9, "user_id": 12298279, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC6JogrsW0N0c26N5eWlw2B9ErEhAGS6FISlo4nSg=k-s128", "display_name": "Sparts17", "link": "https://stackoverflow.com/users/12298279/sparts17"}, "edited": false, "score": 0, "creation_date": 1577705152, "post_id": 59529553, "comment_id": 105229615, "body": "I also wanted to say that I&#39;m getting out of memory issues at certain points as well using the same code. That could be related to my crappy work rig, but if someone has pointers on keeping that from occurring with the same code, I&#39;d be very grateful."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1577709952, "post_id": 59529553, "comment_id": 105231646, "body": "You get an automation error very likely because you use the default instance of your user form <code>GetIssForm</code> and you have an <code>Unload GetIssForm</code> in your code."}, {"owner": {"reputation": 9, "user_id": 12298279, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC6JogrsW0N0c26N5eWlw2B9ErEhAGS6FISlo4nSg=k-s128", "display_name": "Sparts17", "link": "https://stackoverflow.com/users/12298279/sparts17"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1577794108, "post_id": 59529553, "comment_id": 105256710, "body": "how do I fix that then? What would a non-default instance of that be? I unload the userform once I&#39;ve passed the combobox into the variable memory. Is that not correct?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1577798497, "post_id": 59529553, "comment_id": 105258186, "body": "Reading suggestions <a href=\"https://excelmacromastery.com/vba-user-forms-1/\" rel=\"nofollow noreferrer\">Userforms</a>, <a href=\"https://gregmaxey.com/word_tip_pages/userforms_advanced_tips.html\" rel=\"nofollow noreferrer\">Default Instance</a>, <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">Userform1.show</a>"}], "owner": {"reputation": 9, "user_id": 12298279, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mC6JogrsW0N0c26N5eWlw2B9ErEhAGS6FISlo4nSg=k-s128", "display_name": "Sparts17", "link": "https://stackoverflow.com/users/12298279/sparts17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577710166, "creation_date": 1577702953, "last_edit_date": 1577710166, "question_id": 59529553, "link": "https://stackoverflow.com/questions/59529553/why-is-excel-crashing-with-automation-error", "title": "Why is Excel Crashing with Automation Error?", "body": "<p>this is my first post, so if I do it wrong, please don't crucify me. </p>\n\n<p>I have this code I've written that opens a series of workbooks (the number of workbooks it opens depends on the number of clinics in that country, up to 200 of them), and then copies any issue data from the workbook into the macro workbook. It then takes all the issues it's tracked, and copies them into another workbook and saves it as an issue log. As it runs through, at some random point, I'm getting an Automation Error that crashes excel entirely. I don't get to break on the error line. I don't get any interaction or other warning and the Automation Error does not have an error code, just Automation Error with \"OK\", and \"Help\" buttons. The help button does nothing for me. I've tried putting in timers to let the workbooks open. I've tried disabling macros that may run when the workbooks are opened to speed them up. I've tried stepping through but that doesn't produce the error, so it's only when it's running at full tilt. </p>\n\n<p>I've read that these errors are caused by VBA not being able to reference the workbook object because it's not fully \"open\" by the time an object associated with the workbook is called, hence the timing and macro-killing code being added in, but to no avail. </p>\n\n<p>Can someone please tell me what I'm doing wrong? This is for work and I need this reporting to operate properly. Thanks to anyone willing to give a hand ahead of time. </p>\n\n<p>Here's the code that pulls the issues from the workbooks:</p>\n\n<pre><code>Public Declare PtrSafe Function GetTickCount Lib \"kernel32\" () As Long\n\nSub GetIssues()\n\n    Dim country As String, checkPer As String, CheckMon As String, fiscYear As String, fPath As String, openFile As String, openName As String, clerk As String\n    Dim company As Integer, i As Integer, clinic As Integer, checkMonDays As Integer, last As Integer, b As Integer, tableRow As Integer\n    Dim setupWS As Worksheet, checkWS As Worksheet, issueWS As Worksheet, valueWS As Worksheet, metaWS As Worksheet, ws As Worksheet\n    Dim checkWB As Workbook\n    Dim fso As New FileSystemObject\n    Dim listObj As ListObject\n    Dim issueWSfile As Range, valueWSfile As Range, checkWSRng As Range, checkWSRng2 As Range, dateRange As Range, cell As Range, tableRng As Range, tableRng2 As Range\n    Dim startDate As Date, Timer As Date, StartTime As Date, EndTime As Date\n    Dim NowTick As Long, EndTick As Long\n\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    'previousSecurity = Application.AutomationSecurity\n    'Application.AutomationSecurity = msoAutomationSecurityForceDisable\n\n    StartTime = TimeValue(Time)\n\n    Set setupWS = ThisWorkbook.Sheets(\"Setup\")\n    Set metaWS = ThisWorkbook.Sheets(\"Meta Data\")\n    Set issueWS = ThisWorkbook.Sheets(\"Issues\")\n    Set valueWS = ThisWorkbook.Sheets(\"Values\")\n    Set dateRange = issueWS.Range(\"F1:AL1\")\n\n    last = metaWS.Cells(Rows.count, \"B\").End(xlUp).Row\n    startDate = DateValue(setupWS.Range(\"F4\").Value)\n\n    Set issueWSfile = issueWS.Range(\"A2:A\" &amp; last)\n    Set valueWSfile = valueWS.Range(\"A2:A\" &amp; last)\n\n    issueWS.Range(\"A2:AK1000,F1:AJ1\").ClearContents\n    valueWS.Range(\"A2:AK1000,F1:AJ1\").ClearContents\n    dateRange.ClearContents\n\n    fPath = Left(ThisWorkbook.Path, Len(ThisWorkbook.Path) - Len(\"Takings Control Recs\"))\n\n    checkPer = Trim(Right(GetIssForm.ComboBox2.Value, 3))\n    fiscYear = Left(GetIssForm.ComboBox2.Value, 4)\n\n    If checkPer = \"P1\" Then\n        CheckMon = \"Oct\"\n    ElseIf checkPer = \"P2\" Then\n        CheckMon = \"Nov\"\n    ElseIf checkPer = \"P3\" Then\n        CheckMon = \"Dec\"\n    ElseIf checkPer = \"P4\" Then\n        CheckMon = \"Jan\"\n    ElseIf checkPer = \"P5\" Then\n        CheckMon = \"Feb\"\n    ElseIf checkPer = \"P6\" Then\n        CheckMon = \"Mar\"\n    ElseIf checkPer = \"P7\" Then\n        CheckMon = \"Apr\"\n    ElseIf checkPer = \"P8\" Then\n        CheckMon = \"May\"\n    ElseIf checkPer = \"P9\" Then\n        CheckMon = \"Jun\"\n    ElseIf checkPer = \"P10\" Then\n        CheckMon = \"Jul\"\n    ElseIf checkPer = \"P11\" Then\n        CheckMon = \"Aug\"\n    ElseIf checkPer = \"P12\" Then\n        CheckMon = \"Sep\"\n    End If\n\n    Application.Calculation = xlCalculationAutomatic\n    setupWS.Range(\"F1\").Value = checkPer\n    Application.Calculation = xlCalculationManual\n\n    If CheckMon = \"Jan\" Or CheckMon = \"Mar\" Or CheckMon = \"May\" Or CheckMon = \"Jul\" Or CheckMon = \"Aug\" Or CheckMon = \"Oct\" Or CheckMon = \"Dec\" Then\n        checkMonDays = 31\n    ElseIf CheckMon = \"Apr\" Or CheckMon = \"Jun\" Or CheckMon = \"Sep\" Or CheckMon = \"Nov\" Then\n        checkMonDays = 30\n    Else: checkMonDays = 28\n    End If\n\n    For b = 1 To checkMonDays\n        issueWS.Cells(1, b + 5).Value = startDate\n        valueWS.Cells(1, b + 5).Value = startDate\n        startDate = startDate + 1\n    Next b\n\n    country = GetIssForm.ComboBox3.Value\n\n    'Unload GetIssForm\n\n    For i = 5 To last\n        If metaWS.Range(\"H\" &amp; i).Value = country Then\n            company = metaWS.Range(\"D\" &amp; i).Value\n            clinic = metaWS.Range(\"B\" &amp; i).Value\n            clerk = metaWS.Range(\"F\" &amp; i).Value\n            openFile = fPath &amp; country &amp; \"\\\" &amp; fiscYear &amp; \"\\\" &amp; checkPer &amp; \"\\E \" &amp; company &amp; \"\\\" &amp; clinic &amp; \" \" &amp; checkPer &amp; \" \" &amp; CheckMon &amp; \".xlsb\"\n            If Dir(openFile) &lt;&gt; \"\" Then\n                openName = fso.getfilename(openFile)\n                Set checkWB = Workbooks.Open(openFile)\n                'EndTick = GetTickCount + 500\n                'Do\n                 '   NowTick = GetTickCount\n                  '  DoEvents\n                'Loop Until NowTick &gt; EndTick\n                Set checkWS = checkWB.Sheets(\"Transaction Hub\")\n                Set checkWSRng = checkWS.Range(\"AX11:AX41\")\n                Set checkWSRng2 = checkWS.Range(\"AU11:AU41\")\n                issueWS.Range(\"A\" &amp; i - 3).Value = openFile\n                issueWS.Range(\"B\" &amp; i - 3).Value = company\n                issueWS.Range(\"C\" &amp; i - 3).Value = clinic\n                issueWS.Range(\"D\" &amp; i - 3).Value = clerk\n                issueWS.Range(\"E\" &amp; i - 3).Value = country\n                valueWS.Range(\"A\" &amp; i - 3).Value = openFile\n                valueWS.Range(\"B\" &amp; i - 3).Value = company\n                valueWS.Range(\"C\" &amp; i - 3).Value = clinic\n                valueWS.Range(\"D\" &amp; i - 3).Value = clerk\n                valueWS.Range(\"E\" &amp; i - 3).Value = country\n                checkWSRng.Copy\n                issueWS.Range(\"F\" &amp; i - 3).PasteSpecial xlPasteValues, xlPasteSpecialOperationNone, , True\n                checkWSRng2.Copy\n                valueWS.Range(\"F\" &amp; i - 3).PasteSpecial xlPasteValues, xlPasteSpecialOperationNone, , True\n                Application.CutCopyMode = False\n                Workbooks(openName).Close False\n                Set checkWB = Nothing\n            Else: End If\n        End If\n    Next i\n\n    last = issueWS.Cells(Rows.count, \"A\").End(xlUp).Row\n\n    Set listObj = issueWS.ListObjects(1)\n\n    listObj.Resize Range(\"A1:AJ\" &amp; last)\n\n    Set listObj = valueWS.ListObjects(1)\n\n    listObj.Resize Range(\"A1:AJ\" &amp; last)\n\n    Set tableRng = issueWS.ListObjects(\"Table2\").Range\n    Set tableRng2 = valueWS.ListObjects(\"Table1\").Range\n\n    issueWS.Activate\n\n    For tableRow = tableRng.Row + tableRng.Rows.count - 1 To tableRng.Row Step -1\n        If Application.WorksheetFunction.CountA(Rows(tableRow)) = 0 Then Rows(tableRow).EntireRow.Delete\n    Next\n\n    valueWS.Activate\n\n    For tableRow = tableRng2.Row + tableRng2.Rows.count - 1 To tableRng2.Row Step -1\n        If Application.WorksheetFunction.CountA(Rows(tableRow)) = 0 Then Rows(tableRow).EntireRow.Delete\n    Next\n\n    For Each ws In ThisWorkbook.Worksheets\n        ws.Activate\n        ActiveWindow.ScrollRow = 1\n        ActiveWindow.ScrollColumn = 1\n        Range(\"A1\").Select\n    Next ws\n\n    ThisWorkbook.Sheets(\"Run\").Activate\n\n    issueWS.Range(\"B:D\").EntireColumn.AutoFit\n    valueWS.Range(\"B:D\").EntireColumn.AutoFit\n\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    'Application.AutomationSecurity = previousSecurity\n\n    EndTime = TimeValue(Time)\n\n    Timer = Format(EndTime - StartTime, \"hh:mm:ss\")\n\n    'MsgBox \"Finished in \" &amp; -Timer &amp; \" seconds\", vbOKOnly, \"Workbooks Created -\"\n\n    Call ReportIssues\n\nEnd Sub```\n\nAnd here's the code that creates the issue log:\n\n```Option Explicit\n\nSub ReportIssues()\n\n    Dim ARow As Long, issuesLastRow As Long, ACol As Long, issuesLastCol As Long, IRow As Long, issuesLastRow2 As Long, issuesLastCol2 As Long\n    Dim DateNum As String, Month As String, Year As String, country As String, TestStr As String, answer As String, fPath As String\n    Dim issuesWB As Workbook\n    Dim ws As Worksheet, issuesWS As Worksheet, valuesWS As Worksheet, dataWS As Worksheet, setupWS As Worksheet\n    Dim count As Integer\n\n    Application.EnableEvents = False\n    Application.DisplayAlerts = False\n\n    Set dataWS = ThisWorkbook.Sheets(\"Issues\")\n    Set setupWS = ThisWorkbook.Sheets(\"Setup\")\n    Set valuesWS = ThisWorkbook.Sheets(\"Values\")\n\n    dataWS.Activate\n\n    fPath = ThisWorkbook.Path &amp; \"\\Issue Logs\\\"\n    Debug.Print fPath\n    issuesLastRow = dataWS.Cells(Rows.count, \"B\").End(xlUp).Row\n    issuesLastCol = dataWS.Cells(1, Columns.count).End(xlToLeft).Column\n    issuesLastRow2 = valuesWS.Cells(Rows.count, \"B\").End(xlUp).Row\n    issuesLastCol2 = valuesWS.Cells(1, Columns.count).End(xlToLeft).Column\n    IRow = 3\n    DateNum = Replace(setupWS.Range(\"D2\"), \"/\", \"\")\n    count = 0\n    Application.ScreenUpdating = False\n\n    country = GetIssForm.ComboBox3.Value\n\n    Unload GetIssForm\n\n    Set issuesWB = Workbooks.Open(\"Z:\\Finance\\HO European Transformation\\15.SSC\\Q Track\\Build\\Issues Sheet Temp.xlsb\")\n    Set issuesWS = issuesWB.Sheets(\"Issues\")\n\n    dataWS.ListObjects(\"Table2\").Range.AutoFilter Field:=5, Criteria1:=country\n\n    valuesWS.ListObjects(\"Table1\").Range.AutoFilter Field:=5, Criteria1:=country\n\n    If Dir(fPath &amp; country &amp; \" \" &amp; DateNum &amp; \".xlsb\") = \"\" Then\nhere:\n        For ACol = 6 To issuesLastCol\n            For ARow = 2 To issuesLastRow\n                If Not IsError(dataWS.Cells(ARow, ACol)) And dataWS.Cells(ARow, ACol) &lt;&gt; 0 And dataWS.Cells(ARow, ACol) &lt;&gt; \"\" And Len(dataWS.Cells(ARow, ACol)) &gt; 5 And dataWS.Cells(ARow, 5) = country Then 'And dataWS.Cells(1, ACol) &lt; setupWS.Range(\"D2\") Then 'And dataWS.Cells(1, ACol) &gt; setupWS.Range(\"F4\") - 1 Then\n                    issuesWS.Cells(IRow, 1) = dataWS.Cells(1, ACol)\n                    issuesWS.Cells(IRow, 2) = dataWS.Cells(ARow, 5)\n                    issuesWS.Cells(IRow, 3) = dataWS.Cells(ARow, 3)\n                    issuesWS.Cells(IRow, 4) = dataWS.Cells(ARow, 2)\n                    issuesWS.Cells(IRow, 5) = dataWS.Cells(ARow, ACol)\n                    issuesWS.Cells(IRow, 6) = valuesWS.Cells(ARow, ACol)\n                    IRow = IRow + 1\n                    count = count + 1\n                End If\n            Next ARow\n            ARow = 2\n        Next ACol\n        If count = 0 Then\n        For ACol = 6 To issuesLastCol2\n            For ARow = 2 To issuesLastRow2\n                If Not IsError(valuesWS.Cells(ARow, ACol)) And valuesWS.Cells(ARow, ACol) &lt;&gt; 0 And valuesWS.Cells(ARow, ACol) &lt;&gt; \"\" And valuesWS.Cells(ARow, 5) = country Then 'And dataWS.Cells(1, ACol) &lt; setupWS.Range(\"D2\") Then 'And dataWS.Cells(1, ACol) &gt; setupWS.Range(\"F4\") - 1 Then\n                    issuesWS.Cells(IRow, 1) = dataWS.Cells(1, ACol)\n                    issuesWS.Cells(IRow, 2) = dataWS.Cells(ARow, 5)\n                    issuesWS.Cells(IRow, 3) = dataWS.Cells(ARow, 3)\n                    issuesWS.Cells(IRow, 4) = dataWS.Cells(ARow, 2)\n                    issuesWS.Cells(IRow, 5) = dataWS.Cells(ARow, ACol)\n                    issuesWS.Cells(IRow, 6) = valuesWS.Cells(ARow, ACol)\n                    IRow = IRow + 1\n                    count = count + 1\n                End If\n            Next ARow\n            ARow = 2\n        Next ACol\n        End If\n        With issuesWB\n            .SaveAs fPath &amp; country &amp; \" \" &amp; DateNum &amp; \".xlsb\"\n            .Activate\n            .Close False\n        End With\n        MsgBox country &amp; \" Issue Sheet saved to Issue Log folder.\", vbOKOnly, \"File Saved -\"\n    ElseIf Dir(fPath &amp; country &amp; \" \" &amp; DateNum &amp; \".xlsb\") &lt;&gt; \"\" Then\n        answer = MsgBox(\"Do you wish to overwrite the previous Issue Report file for \" &amp; country &amp; \"?\", vbYesNo, \"Existing File -\")\n        If answer = vbYes Then\n            GoTo here:\n        ElseIf answer = vbNo Then\n            issuesWB.Close False\n        End If\n    End If\n\n    For Each ws In ThisWorkbook.Worksheets\n        ws.Activate\n        ActiveWindow.ScrollRow = 1\n        ActiveWindow.ScrollColumn = 1\n        Range(\"A1\").Select\n    Next ws\n\n    ThisWorkbook.Sheets(\"Run\").Activate\n\n    'Unload RepIssForm\n\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\n    Application.DisplayAlerts = True\n\nEnd Sub```\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1577706104, "last_edit_date": 1577706104, "creation_date": 1577699857, "answer_id": 59528861, "question_id": 59528471, "link": "https://stackoverflow.com/questions/59528471/create-a-table-with-a-macro/59528861#59528861", "title": "Create a table with a macro", "body": "<p>You could use the currentregion property </p>\n\n<pre><code>Sub CreateTbl()\n\n    Dim ws As Worksheet\n    Set ws = ActiveSheet\n    Dim rg As Range\n    Set rg = ws.Range(\"A1\").CurrentRegion\n\n    ws.ListObjects.Add(xlSrcRange, rg, , xlYes).Name = \"myTable\"\n\nEnd Sub\n</code></pre>\n\n<p>But be aware this code will create a table named like <code>myTable_1</code> in case you already have a table namend <code>myTable</code> somewhere else and it will faill if you run it twice for the same range.</p>\n\n<p><strong>Addition</strong>: Based on the comments one could try to use the active cell</p>\n\n<pre><code>Sub CreateTbl()\n\n    Dim ws As Worksheet\n    Dim rg As Range\n    Set rg = ActiveCell.CurrentRegion\n\n    Set ws = rg.Parent\n    ws.ListObjects.Add(xlSrcRange, rg, , xlYes).Name = \"myTable\"\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 155, "user_id": 10916973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10c9fce73c032bdb68517a8ab65ad15?s=128&d=identicon&r=PG&f=1", "display_name": "user394334", "link": "https://stackoverflow.com/users/10916973/user394334"}, "edited": false, "score": 0, "creation_date": 1577709805, "post_id": 59530498, "comment_id": 105231576, "body": "Now, it is good to understand the logic of range creation and you can do whatever you want/need on this issue..."}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": true, "score": 2, "last_activity_date": 1577707827, "last_edit_date": 1577707827, "creation_date": 1577707261, "answer_id": 59530498, "question_id": 59528471, "link": "https://stackoverflow.com/questions/59528471/create-a-table-with-a-macro/59530498#59530498", "title": "Create a table with a macro", "body": "<p>The next piece of code will create a table (\"MyTable\") starting from the active cell to the adjacent most right column and to the down filled row of active cell column:</p>\n\n<pre><code>Sub TableRightDownOfSelection()\n    Dim rnG As Range\n    UnlistIt\n\n    Set rnG = Range(ActiveCell.Address &amp; \":\" &amp; Cells(Cells(Rows.count, _\n         ActiveCell.Column).End(xlUp).Row, ActiveCell.End(xlToRight).Column).Address)\n    ActiveSheet.ListObjects.Add(xlSrcRange, rnG, , xlYes).Name = \"MyTable\"\nEnd Sub\n\nSub UnlistIt()\n    On Error Resume Next\n    ActiveSheet.ListObjects(\"Table1\").Unlist\n    If Err.Number &gt; 0 Then Err.Clear\n    On Error GoTo 0\nEnd Sub\n</code></pre>\n\n<p>In order to avoid an error message, in case you try the code again, the UnlistIt Sub will be called before creating the table...</p>\n"}], "owner": {"reputation": 155, "user_id": 10916973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a10c9fce73c032bdb68517a8ab65ad15?s=128&d=identicon&r=PG&f=1", "display_name": "user394334", "link": "https://stackoverflow.com/users/10916973/user394334"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 59530498, "answer_count": 2, "score": 0, "last_activity_date": 1577707827, "creation_date": 1577698161, "last_edit_date": 1577699083, "question_id": 59528471, "link": "https://stackoverflow.com/questions/59528471/create-a-table-with-a-macro", "title": "Create a table with a macro", "body": "<p>I have this simple range:</p>\n\n<p><a href=\"https://i.stack.imgur.com/TlSlq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/TlSlq.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want to create a macro which creates a table from a range. The macro I get is this:</p>\n\n<pre><code>Sub Macro1()\n'\n' Macro1 Macro\n'\n\n'\n    Range(Selection, Selection.End(xlToRight)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Application.CutCopyMode = False\n    ActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$A$1:$B$3\"), , xlYes).Name = _\n        \"Table12\"\n    ActiveCell.Range(\"Table12[#All]\").Select\nEnd Sub\n</code></pre>\n\n<p>The problem is that I want the macro to not be contingent on a specific size. I for instance want it to be able to work with this table as range aswell:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fWB0q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fWB0q.png\" alt=\"enter image description here\"></a></p>\n\n<p>The problem in the code seems that it uses \"$A$1:$B$3\" but it should be independent of that. Is there a simple way to fix this? How can I record the macro so that it works for all tables?</p>\n"}, {"tags": ["excel", "vba", "list", "combobox", "conditional-statements"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577698117, "post_id": 59528056, "comment_id": 105226838, "body": "Maybe you&#39;ll find an answer in this rather similar <a href=\"https://stackoverflow.com/q/59480927/9758194\">question</a>. Edit the range to be put into your array, and add a check for <code>i,10</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12624025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UD9kAkyb6wE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH3JGeEtN5XMpRjU9cFVWj7C4aVw/photo.jpg?sz=128", "display_name": "Sebastien Blanc", "link": "https://stackoverflow.com/users/12624025/sebastien-blanc"}, "edited": false, "score": 0, "creation_date": 1577699728, "post_id": 59528633, "comment_id": 105227458, "body": "thanks for your advice.I will pay attention of it !!"}, {"owner": {"reputation": 11, "user_id": 12624025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UD9kAkyb6wE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH3JGeEtN5XMpRjU9cFVWj7C4aVw/photo.jpg?sz=128", "display_name": "Sebastien Blanc", "link": "https://stackoverflow.com/users/12624025/sebastien-blanc"}, "edited": false, "score": 0, "creation_date": 1577699788, "post_id": 59528633, "comment_id": 105227488, "body": "But I still have a execution error message &quot;1004&quot; or &quot;9&quot;"}], "tags": [], "owner": {"reputation": 123, "user_id": 11960693, "user_type": "registered", "profile_image": "https://graph.facebook.com/10215170896689648/picture?type=large", "display_name": "Oleksandr Krasnoshchok", "link": "https://stackoverflow.com/users/11960693/oleksandr-krasnoshchok"}, "is_accepted": false, "score": 0, "last_activity_date": 1577698797, "creation_date": 1577698797, "answer_id": 59528633, "question_id": 59528056, "link": "https://stackoverflow.com/questions/59528056/unique-item-with-conditions-in-combobox-problem/59528633#59528633", "title": "Unique item with conditions in combobox problem", "body": "<p>try to be more precise with specifying the ranges</p>\n\n<p>for example, here:</p>\n\n<pre><code>    If Cells(i, 10) = \"Stock\" Then\n</code></pre>\n\n<p>you are referencing the active sheet. Shoud it not be:</p>\n\n<pre><code>    If Sheets(\"Articles\").Cells(i, 10) = \"Stock\" Then\n</code></pre>\n\n<p>?</p>\n\n<p>the same applies here:</p>\n\n<pre><code>            oDictionary.Add Cells(i, 1).Value, 0\n            .AddItem Cells(i, 1).Value\n</code></pre>\n\n<p>one more small suggestion to enhance your code: get rid of your \"else\" in if-else statement with:</p>\n\n<pre><code>       If NOT oDictionary.exists(Sheets(\"Articles\").Cells(i, 1).Value) Then\n</code></pre>\n\n<p>pay attention to how you declared the variable \"nb_lignes\" (you declared it as \"nb_ligne\"). Always use \"Option Explicit\" in the very above of the page.</p>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1577701766, "last_edit_date": 1577701766, "creation_date": 1577700839, "answer_id": 59529112, "question_id": 59528056, "link": "https://stackoverflow.com/questions/59528056/unique-item-with-conditions-in-combobox-problem/59529112#59529112", "title": "Unique item with conditions in combobox problem", "body": "<p>As you did not post your whole code I guess you want to populate a combobox from a range and you would like to show unique values in the combobox.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nDim dict As Object\nSet dict = CreateObject(\"Scripting.Dictionary\")\nDim rg As Range\n\n    ' From your code it was not clear where you pull the data from\n    ' Let's assume your values are in the following range on the active sheet\n    Set rg = Range(\"A4:A11\")\n    Dim sngCell As Range\n    For Each sngCell In rg\n        ' This will add the key in case it does not exist\n        dict(sngCell.Value) = sngCell.Value\n    Next\n\n    ComboBox_depart_article.List = dict.Keys\n\nEnd Sub\n</code></pre>\n\n<p>That means the code you used is much too complicated for the task at hand, at least as I understood it.</p>\n\n<pre><code>       If oDictionary.exists(Sheets(\"Articles\").Cells(i, 1).Value) Then 'si vrai do nothing\n        Else\n            'Ajout de la valeure de la celule dans le dictionnaire et le combobox\n            oDictionary.Add Cells(i, 1).Value, 0\n            .AddItem Cells(i, 1).Value\n        End If\n</code></pre>\n\n<p>Without the other suggestions regarding the ranges your code could look like that</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    'd\u00e9claration variable dictionnaire et nombre de ligne article\n    Dim oDictionary As Object\n    Dim nb_ligne As Integer\n\n    'cr\u00e9ation objet dictionnaire\n    Set oDictionary = CreateObject(\"Scripting.Dictionary\")\n\n    'd\u00e9termination du nombre de lignes artcile\n    nb_lignes = Sheets(\"Articles\").Cells(4, no_colonne).End(xlDown).Row\n\n    With ComboBox_depart_article\n        'cr\u00e9ation de la boucle\n        For i = 4 To nb_lignes\n            'Condition si article en stock\n            If Cells(i, 10) &lt;&gt; \"Stock\" Then\n                oDictionary(Cells(i, 1).Value) = Cells(i, 1).Value\n            End If\n        Next i\n        .List = oDictionary.Keys\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12624025, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-UD9kAkyb6wE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcH3JGeEtN5XMpRjU9cFVWj7C4aVw/photo.jpg?sz=128", "display_name": "Sebastien Blanc", "link": "https://stackoverflow.com/users/12624025/sebastien-blanc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 45, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1577701766, "creation_date": 1577696173, "last_edit_date": 1577697614, "question_id": 59528056, "link": "https://stackoverflow.com/questions/59528056/unique-item-with-conditions-in-combobox-problem", "title": "Unique item with conditions in combobox problem", "body": "<p>I try to make a list for a combobox with unique item and a selection.\nI wrote this code without positive conclusion.\nAny helpfull people to guide me please ?</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    'd\u00e9claration variable dictionnaire et nombre de ligne article\n    Dim oDictionary As Object\n    Dim nb_ligne As Integer\n\n    'cr\u00e9ation objet dictionnaire\n    Set oDictionary = CreateObject(\"Scripting.Dictionary\")\n\n    'd\u00e9termination du nombre de lignes artcile\n    nb_lignes = Sheets(\"Articles\").Cells(4, no_colonne).End(xlDown).Row\n\n    With ComboBox_depart_article\n        'cr\u00e9ation de la boucle\n        For i = 4 To nb_lignes\n            'Condition si article en stock\n            If Cells(i, 10) = \"Stock\" Then 'si vrai do nothing condition suivante\n                'Condition si article existe dans dictionnaire\n                If oDictionary.exists(Sheets(\"Articles\").Cells(i, 1).Value) Then 'si vrai do nothing\n                Else\n                    'Ajout de la valeure de la celule dans le dictionnaire et le combobox\n                    oDictionary.Add Cells(i, 1).Value, 0\n                    .AddItem Cells(i, 1).Value\n                End If\n            Else\n            End If\n        Next i\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "format", "listobject"], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 0, "last_activity_date": 1577696044, "last_edit_date": 1577696044, "creation_date": 1577692822, "answer_id": 59527500, "question_id": 59527223, "link": "https://stackoverflow.com/questions/59527223/vba-applying-format-for-table-column/59527500#59527500", "title": "vba applying format for table column", "body": "<p>As far as I understood you would like to do something like that</p>\n\n<pre><code>Sub FormatIt()\nDim v As ListColumn\n    Set v = Sheet1.ListObjects(\"MyTaqble\").ListColumns(\"Balance\")\n    v.Range.Style = \"Currency\"\nEnd Sub\n</code></pre>\n\n<p>or </p>\n\n<pre><code>Sub FormatItA()\nDim v As ListColumn\n    Set v = Sheet1.ListObjects(\"MyTaqble\").ListColumns(\"Balance\")\n    v.Range.NumberFormat = _\n    \"_([$\u20ac-x-euro2] * #,##0.00_);_([$\u20ac-x-euro2] * (#,##0.00);_([$\u20ac-x-euro2] * \"\"-\"\"??_);_(@_)\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1577706359, "creation_date": 1577706359, "answer_id": 59530306, "question_id": 59527223, "link": "https://stackoverflow.com/questions/59527223/vba-applying-format-for-table-column/59530306#59530306", "title": "vba applying format for table column", "body": "<p>You're close. You need to apply the style (or numberformat) to the <strong><code>Range</code></strong> property of the <code>ListColumns</code> object.</p>\n\n<p>So:</p>\n\n<pre><code>Sheet1.ListObjects(\"Table1\").ListColumns(\"Balance\").Range.Style = \"Currency\"\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 12496883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2433a2befb3492582d4bf582dc4c51e7?s=128&d=identicon&r=PG&f=1", "display_name": "Hana", "link": "https://stackoverflow.com/users/12496883/hana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1241, "favorite_count": 0, "accepted_answer_id": 59527500, "answer_count": 2, "score": 0, "last_activity_date": 1577706359, "creation_date": 1577691136, "question_id": 59527223, "link": "https://stackoverflow.com/questions/59527223/vba-applying-format-for-table-column", "title": "vba applying format for table column", "body": "<p>I am trying to apply a currency format to a specific column in a table.\nI am trying 2 options:</p>\n\n<pre><code>Sheet1.ListObjects(\"MyTaqble\").ListColumns(\"Balance\").Style = \"Currency\"\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>Sheet1.ListObjects(\"MyTaqble\").ListColumns(\"Balance\").NumberFormat = _\n    \"_([$\u20ac-x-euro2] * #,##0.00_);_([$\u20ac-x-euro2] * (#,##0.00);_([$\u20ac-x-euro2] * \"\"-\"\"??_);_(@_)\"\n</code></pre>\n\n<p>For both I get the following error:\nObject doesn't support this property or method</p>\n\n<p>What is the right way to apply format to a table column?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1577691391, "post_id": 59527219, "comment_id": 105224782, "body": "Yeah, address property is what I missed. Thanks."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 1, "last_activity_date": 1577691101, "creation_date": 1577691101, "answer_id": 59527219, "question_id": 59527128, "link": "https://stackoverflow.com/questions/59527128/unable-to-print-the-value-of-cells-upto-the-last-row/59527219#59527219", "title": "Unable to print the value of cells upto the last row", "body": "<p>Your forgot an <code>A</code> and <code>row</code>:</p>\n\n<pre><code>For Each oCel In Range(\"A1\" &amp; \":A\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Row)\n</code></pre>\n\n<p>or you use the <code>address</code> property </p>\n\n<pre><code>For Each oCel In Range(\"A1\" &amp; \":\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp).Address)\n</code></pre>\n\n<p>But be aware that you always refer to the ActiveSheet.</p>\n"}], "owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 59527219, "answer_count": 1, "score": 0, "last_activity_date": 1577736286, "creation_date": 1577690697, "last_edit_date": 1577736286, "question_id": 59527128, "link": "https://stackoverflow.com/questions/59527128/unable-to-print-the-value-of-cells-upto-the-last-row", "title": "Unable to print the value of cells upto the last row", "body": "<p>I'm trying to print the content of column A. There are 10 rows in there, so when I try like the following I get the results accordingly:</p>\n\n<pre><code>Sub PrintUptoLastRow()\n    Dim oCel As Range\n\n    For Each oCel In Range(\"A1\", \"A10\")\n        Debug.Print oCel\n    Next oCel\nEnd Sub\n</code></pre>\n\n<p>I can get the same results without hardcoding the last row:</p>\n\n<pre><code>Sub PrintUptoLastRow()\n    Dim oCel As Range\n\n    For Each oCel In Range(\"A1\", Range(\"A\" &amp; Rows.Count).End(xlUp))\n        Debug.Print oCel\n    Next oCel\nEnd Sub\n</code></pre>\n\n<p>The above two methods are identical as long as the last row is <code>A10</code>. </p>\n\n<p>However, I can also get the results using:</p>\n\n<pre><code>Sub PrintUptoLastRow()\n    Dim oCel As Range\n\n    For Each oCel In Range(\"A1:A5\")\n        Debug.Print oCel\n    Next oCel\nEnd Sub\n</code></pre>\n\n<p>But things go wrong when I try to mimick the above using last row:</p>\n\n<pre><code>Sub PrintUptoLastRow()\n    Dim oCel As Range\n\n    For Each oCel In Range(\"A1\" &amp; \":\" &amp; Range(\"A\" &amp; Rows.Count).End(xlUp))\n       Debug.Print oCel\n    Next oCel\nEnd Sub\n</code></pre>\n\n<p>It throws the following error:</p>\n\n<pre><code>Run-time error `1004`\nMethod `Range` of object`_Global` failed\n</code></pre>\n\n<p><strong><em>How can I make the last piece of code work the way I tried?</em></strong></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577693492, "post_id": 59526669, "comment_id": 105225418, "body": "Is the error not self-explanatory? NumberOnly does not refer to any method within the object library or anything so this should be your own function you are invoking. However, the error tells you it doesn&#39;t exist."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "edited": false, "score": 0, "creation_date": 1577762326, "post_id": 59527114, "comment_id": 105248184, "body": "The values seem to only appear in the last row?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "edited": false, "score": 0, "creation_date": 1577787664, "post_id": 59527114, "comment_id": 105254447, "body": "Good, but if it answered your question, voting the answer up will not kill anybody... :-)"}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": true, "score": 1, "last_activity_date": 1577690581, "creation_date": 1577690581, "answer_id": 59527114, "question_id": 59526669, "link": "https://stackoverflow.com/questions/59526669/vba-how-to-set-column-values-to-end-at-a-range/59527114#59527114", "title": "VBA how to set column values to end at a range", "body": "<pre><code>Dim sh As Worksheet, lastRow As Long\n   Set sh = ActiveWorkbook.Sheets(\"Sheet1\")\n\n  lastRow = sh.Cells(sh.Rows.count, \"A\").End(xlUp).Row\n  sh.Range(\"D\" &amp; lastRow + 1 ).value = 8.5\n  sh.Range(\"E\" &amp; lastRow + 1).value = 6\n</code></pre>\n\n<p>If you need to add another value on the same column, you can define again the <code>lastRow</code> variable, or count the values you add and use <code>lastRow + k</code>, k being your number of added values on the same column.</p>\n"}], "owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 59527114, "answer_count": 1, "score": 0, "last_activity_date": 1577695236, "creation_date": 1577687565, "last_edit_date": 1577695236, "question_id": 59526669, "link": "https://stackoverflow.com/questions/59526669/vba-how-to-set-column-values-to-end-at-a-range", "title": "VBA how to set column values to end at a range", "body": "<p>Trying to set multiple columns different values but only until the last row of the first column: </p>\n\n<pre><code>Sub Macro7()\n'\n' Macro7 Macro\n'\n        Dim rng As Range\n\n        For Each rng In Sheets(\"Sheet1\").Range(\"A1\").CurrentRegion\n            rng.Value = NumberOnly(rng.Value)\n\n        Columns(\"E:rng\").Value = 6\n        Columns(\"D:rng\").Value = 8.5\n\n        Next\n\n\nEnd Sub\n</code></pre>\n\n<p>I get the message:</p>\n\n<blockquote>\n  <p>Compile error: Sub or Function not defined</p>\n</blockquote>\n\n<p>highlighting the <code>NumberOnly</code> part of the code</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1577693885, "post_id": 59526627, "comment_id": 105225538, "body": "If ws is not the active sheet then <code>ws.Range(&quot;B15&quot;).Select</code> would fail before. But you are right <code>Cells()</code> refers to the active sheet and <code>ws.Range(Cells(15, 3), Cells(lrow, 3))</code> will fail in case ws is not the active sheet."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1577687307, "creation_date": 1577687307, "answer_id": 59526627, "question_id": 59526024, "link": "https://stackoverflow.com/questions/59526024/getting-error-as-run-time-error-1004-range-of-object-worksheet-failed-unable/59526627#59526627", "title": "Getting error as &#39;Run time error 1004 range of object _worksheet failed&#39; Unable to find exact reason behind it", "body": "<p><code>Cells()</code> without a worksheet qualifier will default to the active sheet, so</p>\n\n<pre><code>Set myrange = ws.Range(Cells(15, 3), Cells(lrow, 3))\n</code></pre>\n\n<p>will fail if ws is not the active sheet.</p>\n\n<p>You need something like:</p>\n\n<pre><code>Set myrange = ws.Range(ws.Cells(15, 3), ws.Cells(lrow, 3))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1577694219, "creation_date": 1577694219, "answer_id": 59527724, "question_id": 59526024, "link": "https://stackoverflow.com/questions/59526024/getting-error-as-run-time-error-1004-range-of-object-worksheet-failed-unable/59527724#59527724", "title": "Getting error as &#39;Run time error 1004 range of object _worksheet failed&#39; Unable to find exact reason behind it", "body": "<p>You could shorten the above code to</p>\n\n<pre><code>Sub AutoSRIn()\n\n    With Sheet9\n        lrow = .Cells(.Rows.Count, 3).End(xlUp).Row\n        Set myrange = .Range(.Cells(15, 3), .Cells(lrow, 3))\n    End With\n\n    For Each cell In myrange\n        cell.Offset(0, -1).Value = i + 1\n        i = i + 1\n    Next cell\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 12622797, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HQUPN9OajJg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXcrGc_wNoqN6j8FOtvII4fKasbA/photo.jpg?sz=128", "display_name": "RkVeer", "link": "https://stackoverflow.com/users/12622797/rkveer"}, "edited": false, "score": 0, "creation_date": 1577704270, "post_id": 59528037, "comment_id": 105229287, "body": "Thanks to @JvdV. I noted your suggestions"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": false, "score": 0, "last_activity_date": 1577696743, "last_edit_date": 1577696743, "creation_date": 1577696062, "answer_id": 59528037, "question_id": 59526024, "link": "https://stackoverflow.com/questions/59526024/getting-error-as-run-time-error-1004-range-of-object-worksheet-failed-unable/59528037#59528037", "title": "Getting error as &#39;Run time error 1004 range of object _worksheet failed&#39; Unable to find exact reason behind it", "body": "<p>Others have mentioned the explicit/implicit sheet reference issues. But you still make use of an iteration through range objects (not bad in itself, but not necessary and slow on a large range). </p>\n\n<p><strong><sub>Alternatively try:</sub></strong></p>\n\n<pre><code>Sub AutoSRIn()\n\nWith Sheet9\n    Dim lr As Long: lr = .Cells(.Rows.Count, 3).End(xlUp).Row\n    If lr &gt; 14 Then .Range(\"B15:B\" &amp; lr) = .Evaluate(\"ROW(1:\" &amp; lr - 14 &amp; \")\")\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>Btw, it's good practice to <code>Dim</code> all your variables to some <code>Data</code> type if possible (<code>Dim myrange As Range</code> and <code>Dim i As Long</code> for example)</p>\n"}], "owner": {"reputation": 1, "user_id": 12622797, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HQUPN9OajJg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcXcrGc_wNoqN6j8FOtvII4fKasbA/photo.jpg?sz=128", "display_name": "RkVeer", "link": "https://stackoverflow.com/users/12622797/rkveer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1577696743, "creation_date": 1577683100, "last_edit_date": 1577694337, "question_id": 59526024, "link": "https://stackoverflow.com/questions/59526024/getting-error-as-run-time-error-1004-range-of-object-worksheet-failed-unable", "title": "Getting error as &#39;Run time error 1004 range of object _worksheet failed&#39; Unable to find exact reason behind it", "body": "<p>I have the following code to generate Auto Serial Number in Column B and start from B15. It also depends upon Column C cells data records. when the C column cell will go empty at any point then the serial number will stop automatically in Column B. </p>\n\n<pre><code>  Sub AutoSRIn()\n\n    Dim ws As Worksheet\n    Set ws = Sheet9\n\n    ws.Range(\"B15\").Select\n    lrow = ws.Cells(Rows.Count, 3).End(xlUp).Row\n\n    Set myrange = ws.Range(Cells(15, 3), Cells(lrow, 3))\n\n    For Each cell In myrange\n        cell.Offset(0, -1).Value = i + 1\n        i = i + 1\n    Next cell\n\nEnd Sub\n</code></pre>\n\n<p>But I am getting an error 'run time error 1004 range of object _worksheet failed at following line number'.</p>\n\n<pre><code>Set myrange = ws.Range(Cells(15, 3), Cells(lrow, 3))\n</code></pre>\n\n<p>The important and strange thing is that sometimes it works but if used in any other version like excel 2010 it is not working</p>\n\n<p>I am trying to get a result through userform submit button. First, there is code for insert records in C column from C15 then Use this code to get the auto serial number for records.\nPlease Help Many thanks in advance!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1577686444, "post_id": 59525951, "comment_id": 105223512, "body": "Are you calling this as a UDF from a worksheet?  It would help to post the entire function."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1577692567, "post_id": 59525951, "comment_id": 105225146, "body": "I cannot understand what you really need... So, when a cell from column D:D will have its <code>IndentLevel = 2</code> you would like to have the B cell from the same row equal with <code>cell.Value - 2</code>? If not, can you better explain what you want to do? When you say &quot;Validation&quot; is it a real validation formula for B cell, or you consider validation the result of that arithmetic operation? If this is what you want, why then do you use that <code>Sumr</code> variable which will calculate all the range in discussion respecting the <code>IndentLevel = 2</code> condition?"}], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1577692118, "last_edit_date": 1577692118, "creation_date": 1577691725, "answer_id": 59527318, "question_id": 59525951, "link": "https://stackoverflow.com/questions/59525951/move-column-by-2-for-if-validation/59527318#59527318", "title": "Move column by 2 for if validation", "body": "<p>If <code>ActiveCell</code> is really in column <code>D</code> and you would like to get the value to the left in column <code>B</code> this should work</p>\n\n<pre><code>For Each cell In Range(ActiveCell, ActiveCell.End(xlDown))\n    If cell.IndentLevel = 2 Then\n        sumr = sumr + cell.Offset(0, -2).Value\n    End If\nNext cell\n</code></pre>\n\n<p>In case you mean to check the <code>Indentlevel</code> of column <code>B</code> then you need to apply offset one line above</p>\n\n<pre><code>If cell.offset(0,-2).IndentLevel = 2 Then\n</code></pre>\n\n<p>This solution will fail if <code>ActiveCell</code> is Column <code>B</code> or <code>A</code>.</p>\n\n<p>Further information on <a href=\"https://docs.microsoft.com/de-de/office/vba/api/excel.range.offset\" rel=\"nofollow noreferrer\">Offset</a></p>\n"}], "owner": {"reputation": 11, "user_id": 8862630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8935b55ca34b0bf4cc951a505350b044?s=128&d=identicon&r=PG&f=1", "display_name": "Robin", "link": "https://stackoverflow.com/users/8862630/robin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577692197, "creation_date": 1577682346, "last_edit_date": 1577692197, "question_id": 59525951, "link": "https://stackoverflow.com/questions/59525951/move-column-by-2-for-if-validation", "title": "Move column by 2 for if validation", "body": "<p>In excel VBA, I have written the below code to sum by indentlevel. I have my indents in column B while i am calling this function from Column D.So basically my ActiveCell is column 'D'.\nNow in below condition where i am checking the cell.Indentlevel=2 i need the cell to point to column 'B' so i need to move the value of cell by 2 so something like,\n tmpcell= cell-2 so that i can do on the validation on column B.</p>\n\n<pre><code>Dim cell As Range\nfor Each cell In Range(ActiveCell, ActiveCell.End(xlDown))\n If cell.IndentLevel =2 Then \n  Sumr=Sumr+cell.Value\n End If\n Next cell\n</code></pre>\n\n<p>Can someone help as to how i can move the cell by 2 columns</p>\n"}, {"tags": ["excel", "vba", "charts"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1577674772, "post_id": 59525169, "comment_id": 105221313, "body": "<code>ActiveChart.ChartTitle.Text = Selection.Cells(1).Value + &quot; - &quot; + ActiveSheet.Name</code>"}, {"owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1577674835, "post_id": 59525169, "comment_id": 105221323, "body": "or is it possible to reference from a &quot;Series&quot; from the chart legend?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1577674947, "post_id": 59525169, "comment_id": 105221341, "body": "Not sure what you mean by that"}, {"owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1577675047, "post_id": 59525169, "comment_id": 105221354, "body": "using <code>Selection.Cells(1).Value</code> I get the &quot;Run-time error &#39;438&#39;: Object doesnt support this property or methods"}, {"owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1577675217, "post_id": 59525169, "comment_id": 105221387, "body": "By Series I mean legend entries. So one of the data values"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1577675474, "post_id": 59525169, "comment_id": 105221433, "body": "You might need to grab that value before creating the chart, since the chart will at some point become the selection"}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "edited": false, "score": 0, "creation_date": 1577677144, "post_id": 59525298, "comment_id": 105221694, "body": "perfect. Cheers"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1585928412, "last_edit_date": 1585928412, "creation_date": 1577675641, "answer_id": 59525298, "question_id": 59525169, "link": "https://stackoverflow.com/questions/59525169/vba-chart-title-to-include-selected-active-cell/59525298#59525298", "title": "VBA chart title to include selected/active cell", "body": "<p>Something like this: </p>\n\n<pre><code>Sub Graphs()\n\n    Dim my_range    As Range, t \n\n    t = Selection.Cells(1, 1).Value + \" - \" &amp; ActiveSheet.Name\n\n    Set my_range = Union(Selection, ActiveSheet.Range(\"A:A\"))\n    ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n    With ActiveChart\n        .FullSeriesCollection(1).ChartType = xlColumnClustered\n        .FullSeriesCollection(1).AxisGroup = 1\n        .FullSeriesCollection(2).ChartType = xlLine\n        .FullSeriesCollection(2).AxisGroup = 1\n        .FullSeriesCollection(1).ChartType = xlXYScatter\n        .FullSeriesCollection(1).AxisGroup = 1\n        .SetSourceData Source:=my_range\n        .HasTitle = True\n        .ChartTitle.Text = t\n        .Location Where:=xlLocationAsObject, Name:=\"Graphs\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 59525298, "answer_count": 1, "score": 0, "last_activity_date": 1585928412, "creation_date": 1577674379, "question_id": 59525169, "link": "https://stackoverflow.com/questions/59525169/vba-chart-title-to-include-selected-active-cell", "title": "VBA chart title to include selected/active cell", "body": "<p>I've made a macro so that I can select two data columns to create a chart. I want the chart title to include the data column title (row 1) from the first column I have selected, but as I use the macro on multiple data columns within a sheet, it needs to automatically update the title from the appropriate (selected) column of data.</p>\n\n<pre><code>Sub Graphs()\n\n    Dim my_range    As Range\n\n    Set my_range = Union(Selection, ActiveSheet.Range(\"A:A\"))\n    ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n    ActiveChart.FullSeriesCollection(1).ChartType = xlColumnClustered\n    ActiveChart.FullSeriesCollection(1).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(2).ChartType = xlLine\n    ActiveChart.FullSeriesCollection(2).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(1).ChartType = xlXYScatter\n    ActiveChart.FullSeriesCollection(1).AxisGroup = 1\n    ActiveChart.SetSourceData Source:=my_range\n    ActiveChart.HasTitle = True\n    ActiveChart.ChartTitle.Text = Cells(1, 1).Value + \" - \" + ActiveSheet.Name\n    ActiveChart.Location Where:=xlLocationAsObject, Name:=\"Graphs\"\n\nEnd Sub\n</code></pre>\n\n<p>I have managed to make the title named from a specific cell (1, 6 in this example):\n<code>ActiveChart.ChartTitle.Text = Cells(1, 6).Value + \" - \" + ActiveSheet.Name</code>\nBut I want it to change to the cell from the column of data I have selected</p>\n"}, {"tags": ["vba", "powerpoint", "activex", "windows-media-player"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 12459750, "user_type": "registered", "profile_image": "https://graph.facebook.com/716373728853559/picture?type=large", "display_name": "Tr\u1ea7n Th\u1ebf Trung", "link": "https://stackoverflow.com/users/12459750/tr%e1%ba%a7n-th%e1%ba%bf-trung"}, "edited": false, "score": 0, "creation_date": 1577768596, "post_id": 59532742, "comment_id": 105249168, "body": "Thanks for the answer. I already tried it, but there still remains the problem of the visual image from the video not showing while the sound still does. However when I go to the next slide and back, the video shows fully with both images and sound. Is there a way to solve this problem?"}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 11, "user_id": 12459750, "user_type": "registered", "profile_image": "https://graph.facebook.com/716373728853559/picture?type=large", "display_name": "Tr\u1ea7n Th\u1ebf Trung", "link": "https://stackoverflow.com/users/12459750/tr%e1%ba%a7n-th%e1%ba%bf-trung"}, "edited": false, "score": 0, "creation_date": 1577809966, "post_id": 59532742, "comment_id": 105261881, "body": "Turning off the visibility as in my second suggestion may solve the problem of non-displaying video."}, {"owner": {"reputation": 11, "user_id": 12459750, "user_type": "registered", "profile_image": "https://graph.facebook.com/716373728853559/picture?type=large", "display_name": "Tr\u1ea7n Th\u1ebf Trung", "link": "https://stackoverflow.com/users/12459750/tr%e1%ba%a7n-th%e1%ba%bf-trung"}, "edited": false, "score": 0, "creation_date": 1577883948, "post_id": 59532742, "comment_id": 105274023, "body": "Wait, that seems to make no sense... why am I turning off the visibility when I need the video to show up?"}, {"owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "reply_to_user": {"reputation": 11, "user_id": 12459750, "user_type": "registered", "profile_image": "https://graph.facebook.com/716373728853559/picture?type=large", "display_name": "Tr\u1ea7n Th\u1ebf Trung", "link": "https://stackoverflow.com/users/12459750/tr%e1%ba%a7n-th%e1%ba%bf-trung"}, "edited": false, "score": 0, "creation_date": 1577895375, "post_id": 59532742, "comment_id": 105276571, "body": "After drawing the video control, you would have to first hide it using oShape.Visible.msoFalse. Then at run-time you would show the video using the macro above."}, {"owner": {"reputation": 11, "user_id": 12459750, "user_type": "registered", "profile_image": "https://graph.facebook.com/716373728853559/picture?type=large", "display_name": "Tr\u1ea7n Th\u1ebf Trung", "link": "https://stackoverflow.com/users/12459750/tr%e1%ba%a7n-th%e1%ba%bf-trung"}, "edited": false, "score": 0, "creation_date": 1577932758, "post_id": 59532742, "comment_id": 105283862, "body": "Now there&#39;s another problem. I used this ``` Slide85.WMP_videoTT.settings.mute = True ``` to mute, and it mutes the whole application."}], "tags": [], "owner": {"reputation": 3305, "user_id": 4394120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/406cb60beef9747079a4e43625b43c35?s=128&d=identicon&r=PG", "display_name": "John Korchok", "link": "https://stackoverflow.com/users/4394120/john-korchok"}, "is_accepted": true, "score": 0, "last_activity_date": 1577717666, "creation_date": 1577717666, "answer_id": 59532742, "question_id": 59525024, "link": "https://stackoverflow.com/questions/59525024/problem-with-windows-media-player-activex-control-in-vba-powerpoint/59532742#59532742", "title": "Problem with Windows Media Player ActiveX control in VBA Powerpoint", "body": "<p>As mentioned on this Microsoft help page, you have to set height and width parameters in code for the player to reserve the space when triggering uiMode=\"invisible\": <a href=\"https://docs.microsoft.com/en-us/windows/win32/wmp/player-uimode\" rel=\"nofollow noreferrer\">Player.uiMode</a></p>\n\n<p>As an alternative, you can draw the size as you have done, then use VBA to hide or show it on the slide with code like this:</p>\n\n<pre><code>Sub HideWMP()\n    Dim oSlide As Slide\n    Dim oShape As Shape\n    For Each oSlide In ActivePresentation.Slides\n        For Each oShape In oSlide.Shapes\n            If oShape.Type = msoOLEControlObject Then\n                oShape.Visible = msoTrue\n            End If\n        Next oShape\n    Next oSlide\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 12459750, "user_type": "registered", "profile_image": "https://graph.facebook.com/716373728853559/picture?type=large", "display_name": "Tr\u1ea7n Th\u1ebf Trung", "link": "https://stackoverflow.com/users/12459750/tr%e1%ba%a7n-th%e1%ba%bf-trung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 975, "favorite_count": 0, "accepted_answer_id": 59532742, "answer_count": 1, "score": -1, "last_activity_date": 1577717666, "creation_date": 1577672709, "last_edit_date": 1577678310, "question_id": 59525024, "link": "https://stackoverflow.com/questions/59525024/problem-with-windows-media-player-activex-control-in-vba-powerpoint", "title": "Problem with Windows Media Player ActiveX control in VBA Powerpoint", "body": "<p>it's me and my projects for school again. This time I wanted to insert a video into PowerPoint using file path via WMP ActiveX, so I drew one as follows: (<code>uiMode</code> set to <code>\"none\"</code>)</p>\n\n<p><a href=\"https://i.stack.imgur.com/4CQzV.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4CQzV.jpg\" alt=\"\"></a></p>\n\n<p>When the slide show starts, I transfer all data from an Excel file to the presentation, including the paths to the video. Then I hide the WMP with <code>Slide85.WMP.uiMode = \"invisible\"</code>.</p>\n\n<p>When the time comes, I want the WMP to appear at the original size that i drawn and the linked video to play, so I used these codes:</p>\n\n<pre><code>Slide85.WMP_TT.uiMode = \"none\"\nSlide85.WMP_TT.URL = \"C:\\inetpub\\wwwroot\\TT2.mp4\"\nSlide85.WMP_TT.Controls.Play\n</code></pre>\n\n<p>Already muted the video by changing the settings in the Properties tab.</p>\n\n<p>Then the result came out like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xr1YS.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xr1YS.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The video still plays, but only with sound, which is impossible because I muted the control. No visual images is shown from the video, and the control's dimensions changes too.</p>\n\n<p>As of now I cannot think of any causes to this problem. Please help me, I'd be very grateful.</p>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577667212, "post_id": 59524541, "comment_id": 105220168, "body": "Have you tried <code>Set my_range = ActiveSheet.Range(&quot;A:A&quot;)</code> ?"}, {"owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577667651, "post_id": 59524541, "comment_id": 105220230, "body": "That works to get &quot;A:A&quot; but I still need the range to include <code>Selection</code>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577667707, "post_id": 59524541, "comment_id": 105220238, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/15140786/setting-selection-as-range\">Setting Selection as Range</a>"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 0, "last_activity_date": 1577667691, "creation_date": 1577667691, "answer_id": 59524650, "question_id": 59524541, "link": "https://stackoverflow.com/questions/59524541/vba-compile-error-syntax-error-while-trying-to-set-range-for-chart/59524650#59524650", "title": "VBA Compile error: Syntax error while trying to set range for chart", "body": "<p>Perhaps use <code>Union</code>:</p>\n\n<pre><code>Set my_range = Union(Selection, ActiveSheet.Range(\"A:A\"))\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 59524650, "answer_count": 1, "score": 0, "last_activity_date": 1577667691, "creation_date": 1577666148, "last_edit_date": 1577666622, "question_id": 59524541, "link": "https://stackoverflow.com/questions/59524541/vba-compile-error-syntax-error-while-trying-to-set-range-for-chart", "title": "VBA Compile error: Syntax error while trying to set range for chart", "body": "<p>I am trying to make a macro that creates a chart from three selected columns. It works fine but I am trying to make column 1 (A:A) always apart of the range and then just select the remaining to columns I need as there are multiple charts i need to make from a data sheet</p>\n\n<pre><code>Sub Charter()\n\n    Dim my_range    As Range\n\n    Set my_range = (\"A:A\", Selection)\n    ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n    ActiveChart.FullSeriesCollection(1).ChartType = xlColumnClustered\n    ActiveChart.FullSeriesCollection(1).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(2).ChartType = xlLine\n    ActiveChart.FullSeriesCollection(2).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(1).ChartType = xlXYScatter\n    ActiveChart.FullSeriesCollection(1).AxisGroup = 1\n    ActiveChart.SetSourceData Source:=my_range\n\n    Cells(1, 1).Select\n\nEnd Sub\n</code></pre>\n\n<p>I get an </p>\n\n<blockquote>\n  <p>\"Compile error: Syntax error\"</p>\n</blockquote>\n\n<p>at the <code>Set my_range = (\"A:A\", Selection)</code></p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "edited": false, "score": 4, "creation_date": 1577678882, "post_id": 59524353, "comment_id": 105221989, "body": "Instead of <code>innerHTML</code> try <code>innerText</code>"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1577712340, "post_id": 59524353, "comment_id": 105232673, "body": "Just because you dont already know (given by your post) thats how you escape ampersands in HTML. You could use Santosh&#39;s response or you could learn how to escape html characters. I think its worth knowing about but not necessarily the best approach to escape them here. You should look up which ones need to be escaped."}], "answers": [{"tags": [], "owner": {"reputation": 11712, "user_id": 2227085, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/zr2qw.png?s=128&g=1", "display_name": "Santosh", "link": "https://stackoverflow.com/users/2227085/santosh"}, "is_accepted": true, "score": 1, "last_activity_date": 1577725092, "creation_date": 1577725092, "answer_id": 59534280, "question_id": 59524353, "link": "https://stackoverflow.com/questions/59524353/ms-access-vba-web-scraper-return-amp-inplace-of/59534280#59534280", "title": "MS Access VBA web scraper return &quot;&amp;amp;&quot; inplace of &quot;&amp;&quot;", "body": "<p>Use <strong>innerText</strong> to get just the text, without spacing and inner element tags.</p>\n"}], "owner": {"reputation": 517, "user_id": 10661104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37b469f4c23b63bf3bae19f45ddb9a5e?s=128&d=identicon&r=PG&f=1", "display_name": "namko", "link": "https://stackoverflow.com/users/10661104/namko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 59534280, "answer_count": 1, "score": 1, "last_activity_date": 1591703985, "creation_date": 1577663758, "last_edit_date": 1591703985, "question_id": 59524353, "link": "https://stackoverflow.com/questions/59524353/ms-access-vba-web-scraper-return-amp-inplace-of", "title": "MS Access VBA web scraper return &quot;&amp;amp;&quot; inplace of &quot;&amp;&quot;", "body": "<p>I am using the Access VBA to do some web scraping.</p>\n\n<p>It works fine for scraping table columns in most places but I have found that when there is a string such as </p>\n\n<p><code>Mon&amp;day</code> it actually returns <code>Mon&amp;amp;day</code>.  </p>\n\n<p>I am using the IE object to do the web scraping</p>\n\n<pre><code>Set ie = CreateObject(\"InternetExplorer.Application\")\n</code></pre>\n\n<p>And for scraping individual cells I am doing:</p>\n\n<pre><code>tdRow(subCounter).innerHTML\n</code></pre>\n\n<p>I know that the <code>&amp;</code> is a special character in HTML, which is probably why this is happening. Is there a way to return the HTML as it is instead of letting VBA do some further parsing?</p>\n"}, {"tags": ["excel", "vba", "charts", "title"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "edited": false, "score": 0, "creation_date": 1577662478, "post_id": 59524112, "comment_id": 105219419, "body": "thank you, but do you know how to set it so that the chart title is taken from the data used in <code>ActiveChart.FullSeriesCollection(1).ChartType = xlXYScatter</code>"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "edited": false, "score": 0, "creation_date": 1577663007, "post_id": 59524112, "comment_id": 105219496, "body": "@ZacEpstein - I miss what you mean by &quot;the data used in <code>ActiveChart.FullSeriesCollection(1).ChartType = xlXYScatter</code> <code>xlXYScatter</code> is the ChartType of the collection, it is no data."}, {"owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "edited": false, "score": 0, "creation_date": 1577664218, "post_id": 59524112, "comment_id": 105219678, "body": "I want the chart title to be the third column of data that I select, the same data that is used in the scatterplot name from the chart legend"}, {"owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "edited": false, "score": 0, "creation_date": 1577665323, "post_id": 59524112, "comment_id": 105219870, "body": "I want it to have the same name as series 2 from the legend"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "edited": false, "score": 0, "creation_date": 1577686049, "post_id": 59524112, "comment_id": 105223397, "body": "@Zacchini - <code>ActiveChart.ChartTitle.Text = ActiveChart.FullSeriesCollection(1).Name</code> this should work"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1577686034, "last_edit_date": 1577686034, "creation_date": 1577661181, "answer_id": 59524112, "question_id": 59524057, "link": "https://stackoverflow.com/questions/59524057/how-to-set-chart-title-as-a-selected-column-in-vba/59524112#59524112", "title": "How to set chart title as a selected column in VBA", "body": "<p><code>ActiveChart.ChartTitle.Text</code> is the property needed for the text. This is a way to refer it in the <code>ActiveChart</code>:</p>\n\n<pre><code>ActiveChart.ChartTitle.Text = ActiveSheet.Cells(1, 1).Text\n</code></pre>\n\n<p>If the name of the <code>FullSeriesCollection(1)</code> is to be used, then:</p>\n\n<pre><code>ActiveChart.ChartTitle.Text = ActiveChart.FullSeriesCollection(1).Name\n</code></pre>\n\n<p>(in general, avoid working with <code>Select</code> and <code>ActiveChart</code> in VBA - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>)</p>\n"}], "owner": {"reputation": 141, "user_id": 12587670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7136ec9ead0898af20205e6523c50e6?s=128&d=identicon&r=PG&f=1", "display_name": "Zacchini", "link": "https://stackoverflow.com/users/12587670/zacchini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577686034, "creation_date": 1577660545, "question_id": 59524057, "link": "https://stackoverflow.com/questions/59524057/how-to-set-chart-title-as-a-selected-column-in-vba", "title": "How to set chart title as a selected column in VBA", "body": "<p>New to VBA and not sure how to set the Chart title to a specific selected column. I am creating multiple graphs from one data sheet so want to be able to select the data and the graph to be named appropriately. </p>\n\n<pre><code>Sub Charter()\n\n    Dim my_range    As Range\n\n    Set my_range = Selection\n    ActiveSheet.Shapes.AddChart2(201, xlColumnClustered).Select\n    ActiveChart.FullSeriesCollection(1).ChartType = xlColumnClustered\n    ActiveChart.FullSeriesCollection(1).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(2).ChartType = xlLine\n    ActiveChart.FullSeriesCollection(2).AxisGroup = 1\n    ActiveChart.FullSeriesCollection(1).ChartType = xlXYScatter\n    ActiveChart.FullSeriesCollection(1).AxisGroup = 1\n    ActiveChart.SetSourceData Source:=my_range\n\n    Cells(1, 1).Select\n\nEnd Sub\n</code></pre>\n\n<p>I want the graph title to use the data set name that is used in \n<code>ActiveChart.FullSeriesCollection(1).ChartType = xlXYScatter</code></p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1577658985, "post_id": 59523882, "comment_id": 105218789, "body": "I&#39;m a bit confused why you&#39;re using a loop. Deleting should be done in one statement."}, {"owner": {"reputation": 442, "user_id": 1832175, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6559a21eddd2c8d44c816c0601d78d6e?s=128&d=identicon&r=PG", "display_name": "Marius Katinas", "link": "https://stackoverflow.com/users/1832175/marius-katinas"}, "edited": false, "score": 0, "creation_date": 1577659733, "post_id": 59523882, "comment_id": 105218930, "body": "To be more precise: ActiveSheet.UsedRange.Delete or if you need to leave some rows out ActiveSheet.Range(&quot;A2:J&quot; &amp; ActiveSheet.UsedRange.Rows.Count).Delete"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1577659789, "post_id": 59523882, "comment_id": 105218941, "body": "Useful tip:  You can delete <code>ActiveSheet.Protect &quot;Password&quot;</code>, and replace <code>ActiveSheet.Unprotect &quot;Password&quot;</code> with <code>ActiveSheet.Protect &quot;Password&quot;, UserInterfaceOnly:=True</code>.  This will allow VBA to edit the sheet, but not the User.  <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.protect\" rel=\"nofollow noreferrer\">Documentation and more information can be found here</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577660564, "post_id": 59523882, "comment_id": 105219099, "body": "While I would rewrite portions of your code for smoother execution, you could try invoke that &quot;error&quot; but instead of running it, step through the code and check step-by-step what is done by VBA."}], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1577662516, "creation_date": 1577662516, "answer_id": 59524238, "question_id": 59523882, "link": "https://stackoverflow.com/questions/59523882/why-does-my-excel-vba-code-not-fully-execute-on-first-attempt/59524238#59524238", "title": "Why does my Excel VBA code not fully execute on first attempt?", "body": "<p>Not an actual answer to your question, but a suggestion to help debuging it.</p>\n\n<p>Add a trap to detect the error condition, and break into debug mode, so you can examine the state of things.</p>\n\n<pre><code>Sub ClearData()\n    Dim ToDelete As VbMsgBoxResult\n    Dim RowCount As Long\n\n    ToDelete = MsgBox(\"Are you sure you want to delete all data?\", vbYesNo, \"Are you sure?\")\n\n    If ToDelete = vbYes Then\n       ActiveSheet.Unprotect \"Password\"\n       Do While Range(\"A2\").Value &lt;&gt; \"\"\n          Range(\"A2:J2\").Delete Shift:=xlUp\n          RowCount = RowCount + 1\n       Loop\n       If RowCount = 1 Then Stop\n       ActiveSheet.Protect \"Password\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>It the loop ends after one deletion, the code will break on the <code>Stop</code> command.  You can then examine the state of your sheet and the value of cell A2, which may (or may not!) shed some light.</p>\n\n<hr>\n\n<p>Again not an answer, but an alternative method:</p>\n\n<p><Sub>This assumes two things</Sub></p>\n\n<p><Sub> - There is no additional data you want to keep <em>below</em> the first blank row in column A</Sub></p>\n\n<p><Sub>- There is no additional data you want to keep <em>to the right</em> of column J</Sub></p>\n\n<p><Sub>If either of these assumptions are wrong, the code can easily be adjusted to suit</Sub></p>\n\n<pre><code>Sub ClearData()\n    Dim rng As Range\n    If MsgBox(\"Are you sure you want to delete all data?\", vbYesNo, \"Are you sure?\") &lt;&gt; vbYes Then Exit Sub\n\n    With ActiveSheet\n        Set rng = .Range(.Cells(.Rows.Count, 1).End(xlUp), .Cells(2, 1))\n\n        ' account for possibility there are no data rows\n        If rng.Row = 1 Then Exit Sub\n\n       .Unprotect \"Password\"\n       rng.EntireRow.Delete\n       .Protect \"Password\"\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 9313545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4457d1c29d888e70d4725a9b9e35de80?s=128&d=identicon&r=PG&f=1", "display_name": "Terry Townsend", "link": "https://stackoverflow.com/users/9313545/terry-townsend"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577662516, "creation_date": 1577658909, "question_id": 59523882, "link": "https://stackoverflow.com/questions/59523882/why-does-my-excel-vba-code-not-fully-execute-on-first-attempt", "title": "Why does my Excel VBA code not fully execute on first attempt?", "body": "<p>To start, I am using Excel 2016 on Windows 10.</p>\n\n<p>I have a spreadsheet in Excel that utilizes two macros to either insert data based on a userform or delete all data from the spreadsheet when someone wants to clear it. The focus of this question is the program that clears the data (seen below), though I will be discussing the other one as well.</p>\n\n<pre><code>Sub ClearData()\n\nToDelete = MsgBox(\"Are you sure you want to delete all data?\", vbYesNo, \"Are you sure?\")\n\nif ToDelete = vbYes Then\n   ActiveSheet.Unprotect \"Password\"\n   Do While Range(\"A2\").Value &lt;&gt; \"\"\n      Range(\"A2:J2\").Delete Shift:=xlUp\n   Loop\n\n   ActiveSheet.Protect \"Password\"\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The code is pretty straight forward. It asks the user to confirm they want to delete all the data, and if they do, it unlocks the sheet, continuously deletes the second row until there are no more rows, and then it locks the sheet back.</p>\n\n<p>Problem: So let's say I have 10 rows of data in my spreadsheet and hit the button that leads to the ClearData() sub. In this case, the first row deletes, and then the macro stops entirely, leaving 9 rows of data. Now if I hit the ClearData() button again, the macro executes flawlessly and deletes the remaining 9 rows.</p>\n\n<p>I thought maybe the issue was with the locking and unlocking the spreadsheet portion of the code. So I manually unlocked the sheet and clicked the button, and the same bug occurred.</p>\n\n<p>Another similar issue that occasionally occurs with the \"insert data\" macro is that it will only add data to one cell (not even a full row, just the first cell). Then, if I run the program again and enter the same exact information into the userform, all of it fills in correctly. In both of these cases, the macro runs through a few lines of code until it executes the first line of code that actually updates the spreadsheet and then completely exits the code without executing any further lines. Also note that no error messages occur, either.</p>\n\n<p>One thing to note is that this problem appears to be intermittent. I just tried it again, and the data is filling out and clearing correctly. There is one thing I can do that will cause the \"insert data\" macro to have the problem. If I change the code and save it again, even if the code I changed was irrelevant (e.g. adding a space to a comment), then the insert data error will occur on the next execution. </p>\n"}, {"tags": ["excel", "vba", "blueprism"], "answers": [{"comments": [{"owner": {"reputation": 102, "user_id": 1745947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cbuSa.png?s=128&g=1", "display_name": "Nicholas", "link": "https://stackoverflow.com/users/1745947/nicholas"}, "edited": false, "score": 2, "creation_date": 1577826192, "post_id": 59540803, "comment_id": 105265858, "body": "xlTabularRow is a constant value in Excel VBA. You can retrieve the values from the VBA editor in Excel for any of the xl constants using the Immediate window. Entering ?xlTabularRow will give you the value of 1. As a coding practice, I find it helps to define any special values used as a constant in your BluePrism-side code so that future editors will know that, for example, 1 means xlTabularRow."}], "tags": [], "owner": {"reputation": 469, "user_id": 8061761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/731cc572d7642d35921b615f5271b30e?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/8061761/oliver"}, "is_accepted": true, "score": 1, "last_activity_date": 1577776149, "creation_date": 1577776149, "answer_id": 59540803, "question_id": 59523775, "link": "https://stackoverflow.com/questions/59523775/excel-vbo-pivot-table-report-layout-in-blue-prism/59540803#59540803", "title": "Excel VBO - Pivot Table Report Layout in Blue Prism", "body": "<p>I found the solution! Just simply change the </p>\n\n<p><code>PvtTbl.RowAxisLayout = \"xlTabularRow\"</code></p>\n\n<p>to</p>\n\n<p><code>PvtTbl.RowAxisLayout(1)</code></p>\n"}], "owner": {"reputation": 469, "user_id": 8061761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/731cc572d7642d35921b615f5271b30e?s=128&d=identicon&r=PG&f=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/8061761/oliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 59540803, "answer_count": 1, "score": 0, "last_activity_date": 1577776149, "creation_date": 1577657728, "last_edit_date": 1577698555, "question_id": 59523775, "link": "https://stackoverflow.com/questions/59523775/excel-vbo-pivot-table-report-layout-in-blue-prism", "title": "Excel VBO - Pivot Table Report Layout in Blue Prism", "body": "<p>I'm trying to arrange my pivot table's report layout as tabular form.</p>\n\n<p>In the offical document of Microsoft Excel, the related code for changing report layout is:</p>\n\n<p><code>pvt.RowAxisLayout xlTabularRow</code></p>\n\n<p>I wrote this code in Blue Prism as:</p>\n\n<p><code>PvtTbl.RowAxisLayout = \"xlTabularRow\"</code></p>\n\n<p>Also tried,</p>\n\n<p><code>PvtTbl.RowAxisLayout(\"xlTabularRow\")</code></p>\n\n<p>However, somehow I'm facing with the exception. The message is about type mismatch.  xlTabularRow is the child of XlLayoutRow (Source)</p>\n\n<p>Can you please help me?</p>\n\n<p>The whole code:</p>\n\n<pre><code>\nTry\n\nwb = GetWorkbook(Handle, Workbook)\nws = GetWorksheet(Handle, Workbook, Worksheet)\n\nwb.Activate()\nws.Activate()\n\nexcel = ws.Application\nsheet = excel.ActiveSheet\n\nPvtTbl = ws.PivotTables(PivotTableName)\nPvtTbl.RowAxisLayout = \"xlTabularRow\"\n\nSuccess = True\n\nCatch e As Exception\nSuccess = False\nMessage = e.Message()\n\nFinally\n\nPvtTbl = Nothing\nws = Nothing\n\nEnd Try```\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 2, "creation_date": 1577667825, "post_id": 59523380, "comment_id": 105220250, "body": "What is the ControlSource for each of those text boxes? What number of rows are returned in the rs?  Is &quot;pTitel&quot; spelled correctly?"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 2, "creation_date": 1577712555, "post_id": 59523380, "comment_id": 105232767, "body": "Id be curious to know why you arent checking for empty recordsets? Is there a chance it is empty? Also, why are you assigning textbox values this way? Can the form not be bound? It just seems like a lot of work just to display data on a control on a form. It would also be helpful to see more details of your situation."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1577780114, "post_id": 59523380, "comment_id": 105251954, "body": "@DougCoats sfrm is bound to disconnected rs. Useful to fill combos on conti-frm with low resource usage or create rs without db (e.g list of files in folder on form).  Quite sure textbox.ControlSource is wrong."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1577800358, "post_id": 59523380, "comment_id": 105258831, "body": "@ComputerVersteher IDK, using recordsets for this just seems out of place. I would rather update the recordsource SQL to limit what you pull in and use bound controls. It might be a style difference, granted, but recordsets are the worst. There is most certainly a better approach."}, {"owner": {"reputation": 6466, "user_id": 2016456, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/QLCh5.png?s=128&g=1", "display_name": "michi", "link": "https://stackoverflow.com/users/2016456/michi"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1577801398, "post_id": 59523380, "comment_id": 105259143, "body": "@DougCoats I see your point, and I would resort to bound forms if necessary. I think the concept of disconnected in-memory recordsets has a lot of potential for a variety of applications, and I&#39;d like to master that."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1577802114, "post_id": 59523380, "comment_id": 105259344, "body": "@Michi fair, knowing how is important, so please disregard my comments as they appear to be discouraging. Let me ask a few questions to make sure I understand exactly what you are doing. 1. You are using a recordset to fill the form on load, yes? And as an extension to that question, you are filling a recordset from nothing it looks like, right?  2. The issue is after filling the recordset youre having issues assigning values to controls? Sorry to ask dumb questions but Im making sure I understand the issue 100%"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1577802811, "post_id": 59523380, "comment_id": 105259566, "body": "IM thinking this might be an issue with referencing the control that is the subform. Can you try this? Me!Subform1.SourceObject (obviously replace the subform1 with the name of the subform)."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1577803692, "post_id": 59523380, "comment_id": 105259899, "body": "@DougCoats, binding a form to a rs is out of place ;) He just uses Adodb, not DAO and the rs is disconnected, but you can connect to a db at anytime (just set `rs. ActiveConnection&#39; ). Useful pattern to creater a temp table without the need to compact after deletion."}, {"owner": {"reputation": 6466, "user_id": 2016456, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/QLCh5.png?s=128&g=1", "display_name": "michi", "link": "https://stackoverflow.com/users/2016456/michi"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1577804490, "post_id": 59523380, "comment_id": 105260155, "body": "@DougCoats the code above is in <code>sfrmService</code>, and the problem persists when I open <code>sfrmService</code>as main form, so I can rule out the issue you brought up."}, {"owner": {"reputation": 6466, "user_id": 2016456, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/QLCh5.png?s=128&g=1", "display_name": "michi", "link": "https://stackoverflow.com/users/2016456/michi"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1577804678, "post_id": 59523380, "comment_id": 105260229, "body": "@DougCoats ok, this is what I do: when loading <code>sfrmService&#39;, I create a </code>ADODB.Recordset` with the fields I need, add 1 row of sample data, and assign the Recordset to <code>sfrmService.Recordset</code>. This should now display the rows in the textboxes <code>pID</code> and <code>pTitel</code>, but instead <code>#Name?</code> appears..."}, {"owner": {"reputation": 6466, "user_id": 2016456, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/QLCh5.png?s=128&g=1", "display_name": "michi", "link": "https://stackoverflow.com/users/2016456/michi"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1577805425, "post_id": 59523380, "comment_id": 105260473, "body": "@ComputerVersteher unfortunately no difference with <code>Me.pID.ControlSource = &quot;pID&quot;</code> etc."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1577807188, "post_id": 59523380, "comment_id": 105261067, "body": "And you have to set<code>CountrolSource</code> after you assigned the forms new rs! Design-View is not valid, vba needed!"}, {"owner": {"reputation": 6466, "user_id": 2016456, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/QLCh5.png?s=128&g=1", "display_name": "michi", "link": "https://stackoverflow.com/users/2016456/michi"}, "reply_to_user": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1577807314, "post_id": 59523380, "comment_id": 105261117, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/205157/discussion-between-michi-and-computerversteher\">continue this discussion in chat</a>."}, {"owner": {"reputation": 6466, "user_id": 2016456, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/QLCh5.png?s=128&g=1", "display_name": "michi", "link": "https://stackoverflow.com/users/2016456/michi"}, "edited": false, "score": 0, "creation_date": 1577807708, "post_id": 59523380, "comment_id": 105261236, "body": "ohhhhhhhhhhhhhhhhhhhh!!!! It is working!!!!! Errr, I discovered a seemingly innocent <code>Me.Requery</code> after the `Set Me.Recordset = rs&#39; that I had not commented out. When I removed that, it started working like a charm!"}, {"owner": {"reputation": 6466, "user_id": 2016456, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/QLCh5.png?s=128&g=1", "display_name": "michi", "link": "https://stackoverflow.com/users/2016456/michi"}, "edited": false, "score": 0, "creation_date": 1577807839, "post_id": 59523380, "comment_id": 105261271, "body": "THANKS TO ALL, and a happy new year!"}], "answers": [{"comments": [{"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 1, "creation_date": 1577811724, "post_id": 59546556, "comment_id": 105262422, "body": "Add<code>.ControlSource</code>to be set and you can requery forms bound to adodb recorset swith<code>Set Me.RecordSet = Me.RecordSet</code>"}], "tags": [], "owner": {"reputation": 6466, "user_id": 2016456, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/QLCh5.png?s=128&g=1", "display_name": "michi", "link": "https://stackoverflow.com/users/2016456/michi"}, "is_accepted": false, "score": 1, "last_activity_date": 1577810308, "creation_date": 1577810308, "answer_id": 59546556, "question_id": 59523380, "link": "https://stackoverflow.com/questions/59523380/subform-text-fields-show-name-instead-of-data-from-ado-recordset/59546556#59546556", "title": "Subform text fields show #Name? instead of data from ADO-recordset", "body": "<p>I find it a bit embarassing, but I'll post it anyway so it might be of value to other people fighting a similar battle...</p>\n\n<p>Contrary to my code in the question, I had a <code>Me.Requery</code> after the <code>Set Me.Recordset = rs</code> that I forgot to comment out...</p>\n\n<pre><code>Private Sub Form_Load()\n\n  Set rs = New ADODB.Recordset\n\n  With rs\n    .Fields.Append \"pID\", adInteger, 4, adFldKeyColumn\n    .Fields.Append \"pTitel\", adVarChar, 255, adFldUpdatable\n    .CursorLocation = adUseClient\n    .LockType = adLockPessimistic\n    .Open\n  End With\n\n  Set Me.Recordset = rs\n  Me.Requery &lt;--------------------- BAD IDEA\nEnd Sub\n</code></pre>\n\n<p>After I deleted the <code>Me.Requery</code>, it worked like a charm.</p>\n\n<p><strong>Thanks to all commenters who shared their ideas, leading finally to the solution!</strong></p>\n"}], "owner": {"reputation": 6466, "user_id": 2016456, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/QLCh5.png?s=128&g=1", "display_name": "michi", "link": "https://stackoverflow.com/users/2016456/michi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1591703850, "creation_date": 1577654310, "last_edit_date": 1591703850, "question_id": 59523380, "link": "https://stackoverflow.com/questions/59523380/subform-text-fields-show-name-instead-of-data-from-ado-recordset", "title": "Subform text fields show #Name? instead of data from ADO-recordset", "body": "<p>In response to comments:</p>\n\n<p>I built up a new form <code>sfrmService</code> from scratch --> getting <code>#Name?</code> again  :-(<br>\nI built it with form-assistant, taking the field-names from a table. ControlSources therefore match, because I named fields in my <code>rs</code> accordingly.</p>\n\n<p><code>? Me.pID.ControlSource</code> yields <code>pID</code>, same for <code>pTitel</code>, name is correct </p>\n\n<p>I added a routine to fill <code>rs</code> with 1 row (see below), and <code>? rs.RecordCount</code> yields <code>1</code></p>\n\n<p>Bigger picture: In a booking-system, I collect data for a new booking over 3 sequential forms. <code>sfrmService</code> (subform on 1 of these 3 forms) holds a list of services to be linked to that new booking.<br>\nOf course, I restricted the textfields to only 2, there are more in the original subform. I created a subform with only those 2 textfields for testing, though.<br>\nOnly when the user commits the newly created booking, the data will be written to the tables. \nI want to do these operations in-memory with disconnected recordsets. I could write them directly to the tables, but would need to update them every so often and delete them in case of cancel --> resource usage.<br>\nAnd: I'd like to challenge myself to learn new techniques :-)</p>\n\n<hr>\n\n<p>I have a main-form <code>frmBooking</code> with a subform <code>sfrmService</code>, both are unbound and no links between them defined.</p>\n\n<p>The recordset is built up in the subform's <code>onload</code>-Event like this:</p>\n\n<pre><code>Option Explicit\nPublic rs As ADODB.Recordset\n\n...\n\nPrivate Sub Form_Load()\n\n  Set rs = New ADODB.Recordset\n\n  With rs\n    .Fields.Append \"pID\", adInteger, 4, adFldKeyColumn\n    .Fields.Append \"pTitel\", adVarChar, 255, adFldUpdatable\n    .CursorLocation = adUseClient\n    .LockType = adLockPessimistic\n    .Open\n  End With\n\n  ' *** added with 1st update of question ***\n  rs.AddNew\n  rs!pID = 100\n  rs!pTitel = \"test\"\n  rs.Update\n  rs.MoveFirst\n\n  Set Me.Recordset = rs\n\nEnd Sub\n</code></pre>\n\n<p>The recordset is built correctly without errors. It is then filled with data by a routine in the main-form, all is working fine, but the textboxes on <code>sfrmService</code> show <code>#Name?</code> instead.</p>\n\n<p>I tried to re-bind the controls of the subform with VBA, no difference.<br>\nI added <code>rs.CursorType = adOpenKeySet</code> before opening the rs, no difference.</p>\n\n<p>I'm just beyond my means here, so any help is greatly appreciated!</p>\n\n<p>Working with MS Access 2019 64-Bit</p>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1577648588, "post_id": 59522500, "comment_id": 105216381, "body": "Without a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>, I don&#39;t see how your question can be answered since the answer seems to depend on things that you have not told us about (the structure of this mysterious &quot;big complicated workbook&quot;, as well as presumably some other code). The code that you posted works for me when I mock up an example. (Not your problem -- but it would be better to use <code>Long</code> than <code>Integer</code> and would be better to use <code>Option Explicit</code> to force yourself to declare variables. <code>i</code> is nowhere declared.)"}, {"owner": {"reputation": 11, "user_id": 9392897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BPr1cMFfhbE/AAAAAAAAAAI/AAAAAAAAQns/SLxaWTxXqyQ/photo.jpg?sz=128", "display_name": "Robert Mills", "link": "https://stackoverflow.com/users/9392897/robert-mills"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1577725560, "post_id": 59522500, "comment_id": 105238373, "body": "Thank you John. The workbook has about thirty different macros I&#39;ve written, though none of them should influence the code in question, so I wasn&#39;t sure how to disclose them. I have just sort of given up and resorted to pasting the range into the worksheet and referencing the pasted cells vs storing it in an array and referencing that way."}], "answers": [{"comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1577651229, "post_id": 59522789, "comment_id": 105217070, "body": "This code is (more or less) functionally equivalent to OP&#39;s code, so it is likely to fail for whatever unknown reason their original code is failing. Having said that, this code is of course a more idiomatic way of doing what they are trying to do."}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 0, "last_activity_date": 1577649182, "creation_date": 1577649182, "answer_id": 59522789, "question_id": 59522500, "link": "https://stackoverflow.com/questions/59522500/range-to-array-getting-gummed-up-somehow-in-vba/59522789#59522789", "title": "Range to Array getting gummed up somehow in VBA", "body": "<pre><code>Option Explicit\n\nSub Button1_Click()\n        Dim pN As Variant, i As Long\n        Dim LastRow As Long\n\n        With Worksheets(\"merp\")\n            LastRow = .Cells(.Rows.count, \"A\").End(xlUp).Row\n            pN = .Range(\"A1:B\" &amp; LastRow).value\n            MsgBox LastRow\n\n            For i = 1 To LastRow\n                MsgBox CStr(pN(i, 1)) &amp; \" and \" &amp; CStr(pN(i, 2))\n            Next\n        End With\nEnd Sub\n</code></pre>\n\n<p>It should work if your \"complicated workbook\" does not have merged cells in that specific range...</p>\n"}], "owner": {"reputation": 11, "user_id": 9392897, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BPr1cMFfhbE/AAAAAAAAAAI/AAAAAAAAQns/SLxaWTxXqyQ/photo.jpg?sz=128", "display_name": "Robert Mills", "link": "https://stackoverflow.com/users/9392897/robert-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1577649182, "creation_date": 1577646794, "question_id": 59522500, "link": "https://stackoverflow.com/questions/59522500/range-to-array-getting-gummed-up-somehow-in-vba", "title": "Range to Array getting gummed up somehow in VBA", "body": "<p>I am looking to copy a range into an array. The range is two columns and unknown rows.</p>\n\n<p>This code works perfectly in a fresh workbook but not in my big complicated workbook. </p>\n\n<p>What could be going wrong? in the complicated workbook, the below code shows the correct number of message boxes (and LastRow is right) but blanks for the array values. </p>\n\n<pre><code>Sub Button1_Click()\n    Dim pN() As Variant\n    Dim LastRow As Integer\n\n    With Worksheets(\"merp\")\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n\n        ReDim pN(1 To LastRow, 1 To 2)\n        pN = .Range(\"A1:B\" &amp; LastRow).Value\n\n        MsgBox LastRow\n\n        For i = 1 To LastRow\n            MsgBox CStr(pN(i, 1)) &amp; \" and \" &amp; CStr(pN(i, 2))\n        Next\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577646767, "post_id": 59522306, "comment_id": 105215889, "body": "&quot;It doesnt work&quot;? What error did you get? What happens when you step through it? Where are you asking the user for a password?"}, {"owner": {"reputation": 15, "user_id": 12580560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4aLpzXSUWYE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfve4FOMQ7lQnRy2Mi-3pT_zgiPxg/photo.jpg?sz=128", "display_name": "axel", "link": "https://stackoverflow.com/users/12580560/axel"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577648117, "post_id": 59522306, "comment_id": 105216258, "body": "@brax I have the error 424 and the ligne lstdiplay.Selected(i) highlighted"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577648780, "post_id": 59522306, "comment_id": 105216431, "body": "Do you really have data in all 65656 rows? What is the value of <code>i</code> when it breaks? how many items are in the listbox? 65656?"}, {"owner": {"reputation": 15, "user_id": 12580560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4aLpzXSUWYE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfve4FOMQ7lQnRy2Mi-3pT_zgiPxg/photo.jpg?sz=128", "display_name": "axel", "link": "https://stackoverflow.com/users/12580560/axel"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577649597, "post_id": 59522306, "comment_id": 105216634, "body": "@braX no I do not have 65656 entries, I do not have an exact number from the start because I fill in a sheet so I must take into account a maximum number, this is why I left 65656; but when I entered only 4 entries, and I tried the code, it gives me the error; normally my table starts from line 3, so even if I put i=3 , nothing has changed"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577649794, "post_id": 59522306, "comment_id": 105216681, "body": "The <code>.Selected</code> property tells you if an item is selected or not, or is used to make it selected or unselected. You are not using it like that. <a href=\"https://stackoverflow.com/questions/39244444/how-to-get-selected-value-in-multicolumn-listbox\" title=\"how to get selected value in multicolumn listbox\">stackoverflow.com/questions/39244444/&hellip;</a> <code>Rows(i + 1).Selected</code> makes no sense."}, {"owner": {"reputation": 15, "user_id": 12580560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4aLpzXSUWYE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfve4FOMQ7lQnRy2Mi-3pT_zgiPxg/photo.jpg?sz=128", "display_name": "axel", "link": "https://stackoverflow.com/users/12580560/axel"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577650673, "post_id": 59522306, "comment_id": 105216920, "body": "ok, so how can delete from the listbox, ie by selecting the entry from the listbox and then delete it ?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1577651055, "post_id": 59522306, "comment_id": 105217021, "body": "Do you want to delete the row only from the listbox, or from the worksheet, too?"}, {"owner": {"reputation": 15, "user_id": 12580560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4aLpzXSUWYE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfve4FOMQ7lQnRy2Mi-3pT_zgiPxg/photo.jpg?sz=128", "display_name": "axel", "link": "https://stackoverflow.com/users/12580560/axel"}, "reply_to_user": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1577651245, "post_id": 59522306, "comment_id": 105217076, "body": "@FaneDuru from the listbox and the worksheet"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 0, "creation_date": 1577652053, "post_id": 59522306, "comment_id": 105217289, "body": "When you save the &quot;cells to remain blank&quot; this doesn&#39;t mean the row will be deleted... So, you need to remove the line from the listbox and clear the specific row? If yes, next time when you will load the data in the listbox you will have a blank row, if you do not use some conditions. The most rapid method to load it is to create a Variant variable which to be load with the range you need and then use the &#39;.list&#39; listbox property..."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 12580560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4aLpzXSUWYE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfve4FOMQ7lQnRy2Mi-3pT_zgiPxg/photo.jpg?sz=128", "display_name": "axel", "link": "https://stackoverflow.com/users/12580560/axel"}, "edited": false, "score": 1, "creation_date": 1577654040, "post_id": 59523160, "comment_id": 105217704, "body": "thanks a lot for your help, it&#39;s works, but I want to undestand well your code, why you put Me.lstdiplay.ListIndex = -1 , why is equal -1 ? because I knwo listindex start from 0"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 15, "user_id": 12580560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4aLpzXSUWYE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfve4FOMQ7lQnRy2Mi-3pT_zgiPxg/photo.jpg?sz=128", "display_name": "axel", "link": "https://stackoverflow.com/users/12580560/axel"}, "edited": false, "score": 1, "creation_date": 1577654827, "post_id": 59523160, "comment_id": 105217901, "body": "Not really... If you do not have anything selected <code>Me.lstdiplay.ListIndex</code> will return -1. The code &quot;says&quot; <code>Not Me.lstdisplay.ListIndex = -1</code>. If nothing selected, you receive a message to warn you about that, instead of an error message..."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 15, "user_id": 12580560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4aLpzXSUWYE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfve4FOMQ7lQnRy2Mi-3pT_zgiPxg/photo.jpg?sz=128", "display_name": "axel", "link": "https://stackoverflow.com/users/12580560/axel"}, "edited": false, "score": 1, "creation_date": 1577690947, "post_id": 59523160, "comment_id": 105224652, "body": "@axel: If it works as needed, an answer vote up will not kill anybody... :-)"}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": true, "score": 0, "last_activity_date": 1577655343, "last_edit_date": 1577655343, "creation_date": 1577652577, "answer_id": 59523160, "question_id": 59522306, "link": "https://stackoverflow.com/questions/59522306/delete-a-line-or-item-selected-on-listbox-of-userform/59523160#59523160", "title": "delete a line or item selected on listbox of userform", "body": "<pre><code>Private Sub delete_Click()\n    Const listStart As Long = 3 'Your listbox keeps the rows starting with row 3\n    Dim sh As Worksheet\n    Set sh = ActiveSheet 'better use your worksheet name here...\n    If Not Me.lstdiplay.ListIndex = -1 Then\n        Me.lstdiplay.RemoveItem Me.lstdiplay.ListIndex\n        sh.Rows(Me.lstdiplay.ListIndex + listStart).Delete\n    Else\n        MsgBox \"You must have a listbox selected row!\", vbInformation, \"No row selected\"\n    End If        \nEnd Sub\n</code></pre>\n\n<p>It removes the selected listbox row and deletes the equivalent sheet row. If the listbox has been loaded starting from row 3 inclusive. Otherwise, you should adapt the `listStart ' constant value...</p>\n\n<p>It also warns in case of selection missing.</p>\n"}], "owner": {"reputation": 15, "user_id": 12580560, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-4aLpzXSUWYE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfve4FOMQ7lQnRy2Mi-3pT_zgiPxg/photo.jpg?sz=128", "display_name": "axel", "link": "https://stackoverflow.com/users/12580560/axel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 0, "accepted_answer_id": 59523160, "answer_count": 1, "score": 1, "last_activity_date": 1577655343, "creation_date": 1577645226, "last_edit_date": 1577646783, "question_id": 59522306, "link": "https://stackoverflow.com/questions/59522306/delete-a-line-or-item-selected-on-listbox-of-userform", "title": "delete a line or item selected on listbox of userform", "body": "<p>I have a userform where I can enter some information, but I want also to give the user the possibility to delete the data that he entered by selecting it from listbox and then click on delete and they need to put a password. Unfortunately, I tried this code but it's doesn't work.</p>\n\n<pre><code>Private Sub delete_Click()\nDim i As Integer\n  For i = 1 To Range(\"A65656\").End(xlUp).Row\n    If lstdiplay.Selected(i) Then\n      Rows(i + 1).Selected\n      Rows(i).Select\n      Selection.delete\n    End If\n  Next i\nEnd Sub\n</code></pre>\n\n<p>When I select for example XOXO like the picture, and click on DELETE, i want to delete the entire information about XOXO, does mean delete XOXO and SA and his number phone etc.....and yes I have the same data on worksheet and After deleting data cells I want to remain blank</p>\n\n<p><a href=\"https://i.stack.imgur.com/w1SGa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w1SGa.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-access", "ms-access-forms"], "comments": [{"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 2, "creation_date": 1577644053, "post_id": 59522118, "comment_id": 105215172, "body": "What is the datatype of the <code>NIIN</code> field? And does the bound column of your combobox correspond to this field?"}, {"owner": {"reputation": 125, "user_id": 9549062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88933ff35c3bc8eda6945983cc94085c?s=128&d=identicon&r=PG&f=1", "display_name": "hIlary", "link": "https://stackoverflow.com/users/9549062/hilary"}, "reply_to_user": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "edited": false, "score": 0, "creation_date": 1577653713, "post_id": 59522118, "comment_id": 105217627, "body": "the datatype is text, but the data is like this 00033422.  So the combo box has the datatype as numbers."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 9549062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88933ff35c3bc8eda6945983cc94085c?s=128&d=identicon&r=PG&f=1", "display_name": "hIlary", "link": "https://stackoverflow.com/users/9549062/hilary"}, "edited": false, "score": 0, "creation_date": 1577721692, "post_id": 59523996, "comment_id": 105236762, "body": "I tried that plus, <code>Me.SubSearchMaster_frm.Form.Filter = &quot;[NIIN] = &#39;&quot; &amp; CStr(Me.CboNIIN) &amp; &quot; &#39; &quot;</code>"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 125, "user_id": 9549062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88933ff35c3bc8eda6945983cc94085c?s=128&d=identicon&r=PG&f=1", "display_name": "hIlary", "link": "https://stackoverflow.com/users/9549062/hilary"}, "edited": false, "score": 0, "creation_date": 1577722599, "post_id": 59523996, "comment_id": 105237205, "body": "Does the bound column of the combobox correspond to the <code>NIIN</code> field? (You can test this by creating a new query with SQL <code>select Forms![Your Form]!CboNIIN</code> and see what value it returns (changing <code>Your Form</code> to the name of your form)."}, {"owner": {"reputation": 125, "user_id": 9549062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88933ff35c3bc8eda6945983cc94085c?s=128&d=identicon&r=PG&f=1", "display_name": "hIlary", "link": "https://stackoverflow.com/users/9549062/hilary"}, "edited": false, "score": 1, "creation_date": 1577726239, "post_id": 59523996, "comment_id": 105238634, "body": "The problem was the bound column = 1 (which is ID) and it should have been column 2."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": true, "score": 1, "last_activity_date": 1577659843, "creation_date": 1577659843, "answer_id": 59523996, "question_id": 59522118, "link": "https://stackoverflow.com/questions/59522118/filter-subform-by-using-combo-box/59523996#59523996", "title": "Filter subform by using combo box", "body": "<p>Since you have stated that the <code>NIIN</code> field is of <strong>Text</strong> datatype, you will need to surround the filter value with single or double quotes else you will receive the familiar datatype mismatch error message.</p>\n\n<p>For example:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.SubSearchMaster_frm.Form.Filter = \"[NIIN] = '\" &amp; Me.CboNIIN &amp; \"'\"\n</code></pre>\n\n<p>Without the quotes, a numerical value is being supplied, thus resulting in a data type mismatch.</p>\n"}], "owner": {"reputation": 125, "user_id": 9549062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88933ff35c3bc8eda6945983cc94085c?s=128&d=identicon&r=PG&f=1", "display_name": "hIlary", "link": "https://stackoverflow.com/users/9549062/hilary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 59523996, "answer_count": 1, "score": 0, "last_activity_date": 1593592851, "creation_date": 1577643854, "last_edit_date": 1593592851, "question_id": 59522118, "link": "https://stackoverflow.com/questions/59522118/filter-subform-by-using-combo-box", "title": "Filter subform by using combo box", "body": "<p>I have a combo box on a form that I want to filter a subform (<code>SubSearchMaster_frm</code>).  </p>\n\n<p>I am receiving:</p>\n\n<blockquote>\n  <p>Runtime error 3464: data type mismatch in expression.  </p>\n</blockquote>\n\n<p>The code is below:</p>\n\n<pre><code>Private Sub CboNIIN_AfterUpdate()\n    Me.SubSearchMaster_frm.Form.Filter = \"[NIIN] = \" &amp; Me.CboNIIN\n    Me.SubSearchMaster_frm.Form.FilterOn = True\nEnd Sub\n</code></pre>\n\n<p>The subform is a query.</p>\n\n<p>I have also tried:</p>\n\n<pre><code>Private Sub CboNIIN_AfterUpdate()\n    Dim sql As String\n    sql = \"Select * from SubSearchMaster_frm where ([NIIN] = \" &amp; Me.CboNIIN &amp; \") From subsearchmaster_frm\"\n    Me.SubSearchMaster_frm.Form.RecordSource = sql\n    Me.SubSearchMaster_frm.Form.Requery\nEnd Sub\n</code></pre>\n\n<p>But I'm getting an error on that too.  </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1577639113, "post_id": 59520335, "comment_id": 105213892, "body": "It\u2019s not clear what you\u2019re trying to accomplish. To handle errors you can use an On error statement. Please edit your questions and explain with examples what\u2019s going on with your code and the expected results"}, {"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1577642435, "post_id": 59520335, "comment_id": 105214762, "body": "i edited the comment, hopes this make it a bit more clearer."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1577642946, "post_id": 59520335, "comment_id": 105214887, "body": "What do you mean with doubled?"}, {"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1577643229, "post_id": 59520335, "comment_id": 105214953, "body": "file name,(based on first line of text to come across) which can be double."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1577645234, "post_id": 59520335, "comment_id": 105215494, "body": "Please post an example. Something like if X is found in the first line of the file, I expect that the file is saved in the Y directory."}, {"owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1577646114, "post_id": 59520335, "comment_id": 105215717, "body": "all files should be saved in the out directory, except if the file description is the same as earlier in the loop than it should be saved in out\\error\\"}], "answers": [{"tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": true, "score": 0, "last_activity_date": 1577648817, "last_edit_date": 1577648817, "creation_date": 1577648472, "answer_id": 59522694, "question_id": 59520335, "link": "https://stackoverflow.com/questions/59520335/move-file-to-error-different-directory-in-case-of-duplicate-file-name/59522694#59522694", "title": "Move file to (error) different directory in case of duplicate file name", "body": "<pre><code>Option Explicit\n\nSub RenameTextFile()\n    Const SpecialCharacters As String = \"\\,/,:,*,?,&lt;,&gt;,|,\"\",\" ' Modify this as neccesary\n    Const ForReading = 1, ForWriting = 2, ForAppending = 8\n    Const foldPath As String = \"C:\\Research syntheses - Meta analysis\\Txt files ECS\\out\\\"\n    Dim fso, MyFile, FileName, TextLine, fol As Object, fil As Object\n    Dim char As Variant, arrSavedFiles(), k As Long, El As Variant, boolFound As Boolean\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set fol = fso.GetFolder(foldPath)\n    ReDim arrSavedFiles(k)\n\n     For Each fil In fol.Files\n        FileName = fil\n        Set MyFile = fso.OpenTextFile(FileName, ForReading)\n        Do While MyFile.AtEndOfStream &lt;&gt; True\n            Do\n                Dim tmpLine As String\n                TextLine = MyFile.ReadLine\n                tmpLine = Trim(TextLine)\n                If Len(tmpLine) &lt;&gt; 0 Then\n                    TextLine = tmpLine:  Exit Do\n                End If\n            Loop Until Len(TextLine) &gt; 0\n            MyFile.Close\n\n            For Each char In Split(SpecialCharacters, \",\")\n                TextLine = Replace(TextLine, char, \"\")\n            Next\n            For Each El In arrSavedFiles\n                If El = TextLine &amp; \".txt\" Then boolFound = True: Exit For\n            Next\n            If Not boolFound Then\n                fil.Name = TextLine &amp; \".txt\"\n                arrSavedFiles(k) = TextLine &amp; \".txt\"\n                k = k + 1: ReDim Preserve arrSavedFiles(k)\n            Else\n                boolFound = False\n                If Not fso.FolderExists(foldPath &amp; \"error\\\") Then MkDir foldPath &amp; \"error\\\"\n                FileCopy foldPath &amp; fil.Name, foldPath &amp; \"error\\\" &amp; fil.Name\n                Kill foldPath &amp; fil.Name\n            End If\n            Exit Do\n        Loop\n        MyFile.Close\n    Next fil\nEnd Sub\n</code></pre>\n\n<p>This will do what (I understood) you need. But, <strong>if there will be more then two files containing the same first line text</strong>, you must adapt the code in a similar way. I mean, before copying the file in the 'error' folder you must fill another array and check the file existence there. And do something (create another folder, warn using a message etc.)...\nThe moved files name will not be changed! It can be if necessary, in the same piece of code, or run the code again for the 'error' folder. </p>\n"}], "owner": {"reputation": 15, "user_id": 12580945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bdb24c1d9a5bde5b1b4575597c2506ca?s=128&d=identicon&r=PG&f=1", "display_name": "nikos", "link": "https://stackoverflow.com/users/12580945/nikos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 59522694, "answer_count": 1, "score": 0, "last_activity_date": 1582848223, "creation_date": 1577630294, "last_edit_date": 1582848223, "question_id": 59520335, "link": "https://stackoverflow.com/questions/59520335/move-file-to-error-different-directory-in-case-of-duplicate-file-name", "title": "Move file to (error) different directory in case of duplicate file name", "body": "<p>I have a code which renames text files based on content of the first row of text.</p>\n\n<p>The name of the saved text file could be <s>doubled</s> a duplicate.</p>\n\n<p>I want to save <s>double</s> duplicate text files in a different directory \"C:\\Research syntheses - Meta analysis\\Txt files ECS\\out\\double\\\".</p>\n\n<pre><code>Sub RenameTextFile()\n\n    Const SpecialCharacters As String = \"\\,/,:,*,?,&lt;,&gt;,|,\"\",\" ' Modify this as neccesary\n    Const ForReading = 1, ForWriting = 2, ForAppending = 8\n    Dim fso, MyFile, FileName, TextLine\n    Dim char As Variant\n\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n\n    Set fol = fso.GetFolder(\"C:\\Research syntheses - Meta analysis\\Txt files ECS\\out\\\")\n\n     For Each fil In fol.Files\n\n        FileName = fil\n\n        Set MyFile = fso.OpenTextFile(FileName, ForReading)\n\n        Do While MyFile.AtEndOfStream &lt;&gt; True\n\n            Do\n                Dim tmpLine As String\n                TextLine = MyFile.ReadLine\n                tmpLine = RemoveWhiteSpace(TextLine)\n                If Len(tmpLine) = 0 Then\n                    TextLine = tmpLine\n                End If\n            Loop Until Len(TextLine) &gt; 0\n            MyFile.Close\n\n            For Each char In Split(SpecialCharacters, \",\")\n                TextLine = Replace(TextLine, char, \"\")\n            Next\n\n            fil.Name = TextLine &amp; \".txt\"\n            Exit Do\n\n        Loop\n\n        MyFile.Close\n    Next fil\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "for-loop", "if-statement"], "comments": [{"owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577641274, "post_id": 59520088, "comment_id": 105214469, "body": "I am still a bit confused this is what I tried.  If ws.Cells(i, 16).Value2 &gt; 0 Then lstProd.AddItem ws.Cells(i, 1).Value.   The code runs until it finds a zero in column 16 or untill it gets to the Lastline then it returns error &quot;381 could not set the list property. Invalid property array index&quot; Debug highlights the lstProd.list (i-1, 1) = ws.cells(i, 2).Value line.  Not sure if I am putting the line in the correct place or should I add it to the front of each line?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577655470, "post_id": 59521930, "comment_id": 105218033, "body": "Actually there is a formula that takes the target stock quantity and subtracts the current stock quantity to give the need to order quantity.  The number will all ways be Zero or higher. I am trying to get the VBA code to check to see if the need to order amount is zero, if so then don&#39;t list that row from the table to the list box, but I still want the code to continue running and checking each line after that so all products that need to be ordered show up in the list box."}, {"owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577656190, "post_id": 59521930, "comment_id": 105218193, "body": "What I was thinking would work is adding  &quot;If ws.cells(i, 16) = 0 then next i&quot;  I tried adding this after the &quot;For i = 1 to LastRow&quot; but this gives me the error &quot; next without for&quot;."}, {"owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577656687, "post_id": 59521930, "comment_id": 105218304, "body": "I am checking the 16 column in the table and not the first column,  could this possibly be causing an issue?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577691695, "post_id": 59521930, "comment_id": 105224879, "body": "@TheTracker: If the returned <code>lastRow</code> reflect your reality in the page you want to work, it should do what you want. I mean, the listbox will be loaded only with data from rows having  no/zero value in column A:A. But, are you sure that your formula does not return small amounts (ex. 0.12) which are rounded to 0 only for displaying? Was you the one who make that formula? Can you post it here?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577691825, "post_id": 59521930, "comment_id": 105224929, "body": "@TheTracker: <code>&quot;If ws.cells(i, 16) = 0 then ... next i</code> has no meaning in VBA. <code>If</code> must be ended with <code>End If</code>. And <code>For i = 1 to ....</code> must end with <code>Next i</code>."}, {"owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577711994, "post_id": 59521930, "comment_id": 105232533, "body": "The cells in the table are formatted to whole number Values. So there will never be a .**.  After further reading basically what I am after is a &quot;Continue Loop&quot; function. From what I have read, this does not exist in Excel VBA. I have thus tried a goto statement but when it finds a zero in column 16 the code stops running after the AddItem line. It says could not get the list property. Invalid Property. I don&#39;t know why because If I take the &quot;If ws.Cells(i, 16).Value = 0 Then&quot; line out it runs fine except it shows the rows with the 0 values."}, {"owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577712790, "post_id": 59521930, "comment_id": 105232876, "body": "The Formula for Column P is &quot;F2-I2&quot; F2 being the target Quantity to stock, and I2 is the current amount in stock. They are both in case Quantities.  I built a quick little userform and data table to test on ( so I didn&#39;t mess up what I already had.  I will Post the code for it in the next comment."}, {"owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577713114, "post_id": 59521930, "comment_id": 105233030, "body": "&quot;Private Sub comClick_Click()&quot; &quot;Dim ws As Worksheet&quot; &quot;Dim i As Integer&quot; &quot;Set ws = Worksheets(&quot;Data&quot;)&quot; &quot;lstbox1.Clear&quot; &quot;lstbox1.ColumnCount = 5&quot; &quot;Dim LastRow As Long&quot; &quot;LastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row&quot; &quot; For i = 1 To LastRow&quot;  &quot; If ws.Cells(i, 5) = 0 Then GoTo NextIteration&quot;   &quot;lstbox1.AddItem ws.Cells(i, 1).Value&quot; &quot;lstbox1.List(i - 1, 1) = ws.Cells(i, 2).Value&quot; &quot;lstbox1.List(i - 1, 2) = ws.Cells(i, 3).Value&quot; &quot;lstbox1.List(i - 1, 3) = ws.Cells(i, 4).Value&quot; &quot;lstbox1.List(i - 1, 4) = ws.Cells(i, 5).Value&quot;  &quot;NextIteration:&quot; &quot;Next i&quot;  &quot;End Sub&quot;"}, {"owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577713319, "post_id": 59521930, "comment_id": 105233138, "body": "The Data sheet is just a simple table with with the Dim of A1 - E10. I have just filled the cells with arbitrary information except for E1-E10 these I put whole numbers in from 1 to 9 just to run the code. It is having the same issues as the actual tracking system I am working on."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577714408, "post_id": 59521930, "comment_id": 105233652, "body": "Can you put your workbook somewhere on a transfer site (ex. <a href=\"https://wetransfer.com/\" rel=\"nofollow noreferrer\">here</a>) and add the link? I will work on it and solve the issue, when I will find some time..."}, {"owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577714553, "post_id": 59521930, "comment_id": 105233708, "body": "I just tried your first adjusted my sample to use your first suggestion by adding another column with the formula  &quot;If (E2&gt;0,E2,&quot;&quot;) and ofcourse copping it down the whole column. This would give me the &quot; If ws.Cells(i, 6)&lt;&gt; &quot;&quot; Then&quot;"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577716897, "post_id": 59521930, "comment_id": 105234684, "body": "@TheTracker: But, it&#39;s a pity to find a work around when it should work without that... But, it is your choice. I wish you luck!"}, {"owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577717083, "post_id": 59521930, "comment_id": 105234773, "body": "<a href=\"https://drive.google.com/file/d/1TsMTFGSL7ccq2E4PyqlL4mUKls99wcfH/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1TsMTFGSL7ccq2E4PyqlL4mUKls99wcfH/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577717122, "post_id": 59521930, "comment_id": 105234790, "body": "The comment above is a link to the project on Google Drive"}, {"owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577717188, "post_id": 59521930, "comment_id": 105234823, "body": "I prefer no work around,  I hate to be stumped like this. but with the lack of the Continue function I am not sure what else I can do."}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "reply_to_user": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "edited": false, "score": 0, "creation_date": 1577717646, "post_id": 59521930, "comment_id": 105235023, "body": "The function in discussion cannot be continue! It iterates only up to LastRow. Please, check if it is correctly returned..."}], "tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 1, "last_activity_date": 1577642330, "creation_date": 1577642330, "answer_id": 59521930, "question_id": 59520088, "link": "https://stackoverflow.com/questions/59520088/running-a-loop-only-if-the-value-in-column-16-of-the-active-sheet-is-0/59521930#59521930", "title": "Running a loop only if the value in column 16 of the active sheet is &gt; 0", "body": "<p>If \"the table says we don't need to order\" means there is an empty cell in the checked range you may use the next code:</p>\n\n<pre><code>For i = 1 To LastRow\n    If ws.Cells(i, 1).Value &lt;&gt; \"\" Then\n        lstProd.AddItem ws.Cells(i, 1).Value\n        lstProd.List(i - 1, 1) = ws.Cells(i, 2).Value\n        lstProd.List(i - 1, 2) = ws.Cells(i, 3).Value\n        lstProd.List(i - 1, 3) = \"$\" &amp; Format(ws.Cells(i, 4).Value, \"0.00\")\n        lstProd.List(i - 1, 4) = ws.Cells(i, 5).Value\n        lstProd.List(i - 1, 5) = ws.Cells(i, 6).Value\n        lstProd.List(i - 1, 6) = ws.Cells(i, 9).Value\n        lstProd.List(i - 1, 7) = ws.Cells(i, 14).Value\n        lstProd.List(i - 1, 8) = ws.Cells(i, 16).Value\n    End if\nNext i\n</code></pre>\n\n<p>If not, you must describe how those cells look/contain in order to make you understand \"we don't need to order\"...</p>\n"}], "owner": {"reputation": 1, "user_id": 12619240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9143c5947f761ad42f2f9a533f9cda39?s=128&d=identicon&r=PG&f=1", "display_name": "TheTracker", "link": "https://stackoverflow.com/users/12619240/thetracker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577642330, "creation_date": 1577628375, "last_edit_date": 1577633869, "question_id": 59520088, "link": "https://stackoverflow.com/questions/59520088/running-a-loop-only-if-the-value-in-column-16-of-the-active-sheet-is-0", "title": "Running a loop only if the value in column 16 of the active sheet is &gt; 0", "body": "<p>This is my first experience writing any kind of code. I have been building a tracking system for my work in Excel. I have everything that I want currently working except I have a user form that when you click the command button it will look at my current inventory table (the table has a column (16 or P) that list how many cases of a product we should order to get us to our target stock quantity) and return a list of products and what we need to order. I have the form so it works, It populates a list box on the form with all the info that I want, but I would like it to exclude any rows that the table says we don't need to order. Here is my current code.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub CommandButton1_Click()\n    Dim ws As Worksheet\n    Dim i As Integer\n    Set ws = Worksheets(\"Current\")\n    lstProd.Clear\n    lstProd.ColumnCount = 9\n    Dim LastRow As Long\n    LastRow = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row\n\n    For i = 1 To LastRow\n        lstProd.AddItem ws.Cells(i, 1).Value\n        lstProd.List(i - 1, 1) = ws.Cells(i, 2).Value\n        lstProd.List(i - 1, 2) = ws.Cells(i, 3).Value\n        lstProd.List(i - 1, 3) = \"$\" &amp; Format(ws.Cells(i, 4).Value, \"0.00\")\n        lstProd.List(i - 1, 4) = ws.Cells(i, 5).Value\n        lstProd.List(i - 1, 5) = ws.Cells(i, 6).Value\n        lstProd.List(i - 1, 6) = ws.Cells(i, 9).Value\n        lstProd.List(i - 1, 7) = ws.Cells(i, 14).Value\n        lstProd.List(i - 1, 8) = ws.Cells(i, 16).Value\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I have tried a lot of <code>if ws.cells(i, 16) = \"0\"</code> and <code>For ws.cells.....</code> but always end up with different errors. I know it is something simple that I am missing but it has just eluded me so I thought I would break down and ask for help.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577618983, "post_id": 59518790, "comment_id": 105208894, "body": "You could just give it a try on a sample workbook and check the results when you step through your code =)"}, {"owner": {"reputation": 3, "user_id": 12496257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDXZvqIlpq0vn31zEcenoU8xaZNcULM1zUsZnSg8g=k-s128", "display_name": "Ketan Bhate", "link": "https://stackoverflow.com/users/12496257/ketan-bhate"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1577620046, "post_id": 59518790, "comment_id": 105209129, "body": "i did and it does rotate about left top corner of the sketch. it really complicates my X and Y coordinate. is there a way to rotate about center of the sketch? like can we define the rotation center for .rotation property?"}, {"owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "edited": false, "score": 1, "creation_date": 1577628932, "post_id": 59518790, "comment_id": 105211329, "body": "I&#39;m afraid VBA Excel does not have a property able to (directly) change the shape rotation center. It can be done in a little more complicated way making some calculations. You can be inspired from <a href=\"https://www.ozgrid.com/forum/core/index.php?attachment/1128183-00-rotate-out-center-xls/\" rel=\"nofollow noreferrer\">this</a> (old) .xls file and its VBA code. You can play with &#39;Pt_2 height from bottom rectangle&#39;, see what is happening and adjust the code to keep the rotation center in the middle."}], "answers": [{"tags": [], "owner": {"reputation": 16669, "user_id": 2233308, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Fi2aQ.jpg?s=128&g=1", "display_name": "FaneDuru", "link": "https://stackoverflow.com/users/2233308/faneduru"}, "is_accepted": false, "score": 1, "last_activity_date": 1577638573, "last_edit_date": 1577638573, "creation_date": 1577638016, "answer_id": 59521345, "question_id": 59518790, "link": "https://stackoverflow.com/questions/59518790/shape-rotation-property-behavior/59521345#59521345", "title": "Shape.Rotation property behavior", "body": "<p>The next procedure is able to rotate a shape, according to its center coordinates. Of course, when you test it (unchanged), on the active worksheet you must have a shape named 'sketch':</p>\n\n<pre><code>Sub testRotFunction()\n  Dim sketch As Shape\n  Set sketch = ActiveSheet.Shapes(\"sketch\")\n  centerRotation sketch, 0\nEnd Sub\n\nSub centerRotation(sR As Shape, rotAngle As Double)\n    Dim rad As Double, x As Double, y As Double\n    Dim x1 As Double, x2 As Double\n\n    x = sR.Top: y = sR.Left\n    x1 = (sR.Width / 2) * -1\n    x2 = sR.Height\n    rad = rotAngle * Atn(1) / 45\n\n    With sR\n        .Top = x + (.Height - .Width / 2 - x1 - x2) * (1 - Cos(rad)) / 2\n        .Left = y + (.Height - .Width / 2 - x1 - x2) * Sin(rad) / 2\n        .Rotation = rotAngle\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12496257, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDXZvqIlpq0vn31zEcenoU8xaZNcULM1zUsZnSg8g=k-s128", "display_name": "Ketan Bhate", "link": "https://stackoverflow.com/users/12496257/ketan-bhate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577638573, "creation_date": 1577617261, "last_edit_date": 1577633791, "question_id": 59518790, "link": "https://stackoverflow.com/questions/59518790/shape-rotation-property-behavior", "title": "Shape.Rotation property behavior", "body": "<pre><code>With sketch\n    .ScaleHeight 16, msoFalse\n    .ScaleWidth 16, msoFalse\n    .Fill.Visible = False\n    .Line.Weight = 1\n    .Line.ForeColor.RGB = RGB(0, 0, 0)\n    .Left = XCoordinate\n    .Top = YCoordinate\n    .Rotation = AngleDeg\nEnd With\n</code></pre>\n\n<p>This is a code i am writing. I have X and Y coordinate calculated using a formula that changes during every iteration of for loop.</p>\n\n<p>My question is does this shape then go to the given X and Y before rotating itself? Plus, <strong>what is the axis of rotation it uses when it rotates by this angle value</strong> stored in variable AngleDeg?</p>\n\n<p>I am concerned about this because if this rotates about it's left top corner, then it is a problem for me because i need it to rotate about axis passing through it's center point.  Same is the reason for why i have my scalewidth and scaleheight properties before this Left and Top properties.</p>\n\n<p>I found that it was using correct X and Y of my center of the sketch (calculated considering origin of the sketch is left top corner), but then it was getting disturbed when it was scaling the sketch which was then moving/messing up the co-ordinates of the center of the sketch.</p>\n\n<p>Please guide.</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 568, "user_id": 383423, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f1520ce9ef9f7a58192e40eefbb45b97?s=128&d=identicon&r=PG", "display_name": "mazoula", "link": "https://stackoverflow.com/users/383423/mazoula"}, "edited": false, "score": 0, "creation_date": 1577614951, "post_id": 59518255, "comment_id": 105208139, "body": "First guess badly written dlookup change to: if DLookup(&quot;Rifampicin&quot;, &quot;TableGeneXpert&quot;, &quot;[PatientID] = &quot; &amp; Forms.FrmTreatment!PatientID &amp; &quot; AND Rifampicin = Resistant&quot;) Then Me.btnDSTMatch.Enabled = True Else Me.btnDSTMatch.Enabled = False"}, {"owner": {"reputation": 27, "user_id": 12568947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbc50dd306925ecb0c06189ed587d72?s=128&d=identicon&r=PG&f=1", "display_name": "jef", "link": "https://stackoverflow.com/users/12568947/jef"}, "reply_to_user": {"reputation": 568, "user_id": 383423, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f1520ce9ef9f7a58192e40eefbb45b97?s=128&d=identicon&r=PG", "display_name": "mazoula", "link": "https://stackoverflow.com/users/383423/mazoula"}, "edited": false, "score": 0, "creation_date": 1577615678, "post_id": 59518255, "comment_id": 105208278, "body": "It is giving error  runtime 2471 The expression you entered as a query parameter produced this error: &#39;Resistant&#39;"}, {"owner": {"reputation": 568, "user_id": 383423, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f1520ce9ef9f7a58192e40eefbb45b97?s=128&d=identicon&r=PG", "display_name": "mazoula", "link": "https://stackoverflow.com/users/383423/mazoula"}, "edited": false, "score": 0, "creation_date": 1577616738, "post_id": 59518255, "comment_id": 105208454, "body": "assuming &quot;Rifampicin&quot; is a column of String type(?) and &quot;Resistant&quot; is a legitimate value then try putting Resistant in single quotes like this:   &quot; AND Rifampicin = &#39;Resistant&#39; &quot;)"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 12568947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbc50dd306925ecb0c06189ed587d72?s=128&d=identicon&r=PG&f=1", "display_name": "jef", "link": "https://stackoverflow.com/users/12568947/jef"}, "edited": false, "score": 0, "creation_date": 1577618534, "post_id": 59518768, "comment_id": 105208810, "body": "Is there possible way for that dlookup to take the latest result of the patient based on the date field in that table?"}, {"owner": {"reputation": 568, "user_id": 383423, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f1520ce9ef9f7a58192e40eefbb45b97?s=128&d=identicon&r=PG", "display_name": "mazoula", "link": "https://stackoverflow.com/users/383423/mazoula"}, "edited": false, "score": 0, "creation_date": 1577619085, "post_id": 59518768, "comment_id": 105208919, "body": "use dmax instead of dlookup"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1577640449, "post_id": 59518768, "comment_id": 105214248, "body": "Yes, see expanded answer, please."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 0, "last_activity_date": 1577640415, "last_edit_date": 1577640415, "creation_date": 1577617064, "answer_id": 59518768, "question_id": 59518255, "link": "https://stackoverflow.com/questions/59518255/i-am-trying-to-check-if-a-value-isl-resistant-in-a-table-from-a-form-using-dlook/59518768#59518768", "title": "I am trying to check if a value isl Resistant in a table from a Form using dlookup", "body": "<p>Try with:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If DLookup(\"Rifampicin\", \"TableGeneXpert\", \"[PatientID] = \" &amp; Forms.FrmTreatment!PatientID &amp; \"\") = \"Resistant\" Then\n    Me.btnDSTMatch.Enabled = True\nElse\n    Me.btnDSTMatch.Enabled = False \nEnd If\n</code></pre>\n\n<p>Or perhaps directly:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.btnDSTMatch.Enabled = IsNull(DLookup(\"Rifampicin\", \"TableGeneXpert\", \"[PatientID] = \" &amp; Forms.FrmTreatment!PatientID &amp; \" And [Rifampicin] = 'Resistant'\"))\n</code></pre>\n\n<p>To filter on the latest date you can include a <em>DMax</em> expression or (the little known option) an <em>SQL filter</em>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.btnDSTMatch.Enabled = IsNull(DLookup(\"Rifampicin\", \"TableGeneXpert\", \"[PatientID] = \" &amp; Forms.FrmTreatment!PatientID &amp; \" And [Rifampicin] = 'Resistant' And [JournalDate] = (Select Max([JournalDate]) From TableGeneXpert Where [PatientID] = \" &amp; Forms.FrmTreatment!PatientID &amp; \" And [Rifampicin] = 'Resistant')\"))\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 12568947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecbc50dd306925ecb0c06189ed587d72?s=128&d=identicon&r=PG&f=1", "display_name": "jef", "link": "https://stackoverflow.com/users/12568947/jef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 59518768, "answer_count": 1, "score": 1, "last_activity_date": 1593592866, "creation_date": 1577612166, "last_edit_date": 1593592866, "question_id": 59518255, "link": "https://stackoverflow.com/questions/59518255/i-am-trying-to-check-if-a-value-isl-resistant-in-a-table-from-a-form-using-dlook", "title": "I am trying to check if a value isl Resistant in a table from a Form using dlookup", "body": "<p>I am trying to lookup a value in a table for a particular patient ID and see whether that patient has the value Resistant. If so then disable a particular button on the form. I tried the following dlookup but it's giving me compiler error:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If DLookup(\"Rifampicin\", \"TableGeneXpert\", \"[PatientID] = \" &amp; Forms.FrmTreatment!PatientID) = Resistant Then\n    Me.btnDSTMatch.Enabled = True\nElse\n    Me.btnDSTMatch.Enabled = False \n</code></pre>\n"}, {"tags": ["vba", "vbe"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577615802, "post_id": 59518221, "comment_id": 105208303, "body": "Why dont you just use an Excel Add-In? (XLAM file)"}, {"owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577621704, "post_id": 59518221, "comment_id": 105209495, "body": "Because I want to edit text file with Visual Studio Code."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577629052, "post_id": 59518221, "comment_id": 105211359, "body": "Perhaps explain what isn&#39;t working with your code above?"}, {"owner": {"reputation": 2624, "user_id": 5143214, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cIthU.jpg?s=128&g=1", "display_name": "skkakkar", "link": "https://stackoverflow.com/users/5143214/skkakkar"}, "edited": false, "score": 0, "creation_date": 1577631511, "post_id": 59518221, "comment_id": 105211962, "body": "Please look into this post [Excel-VBA Import Module from text file (without requiring trust center)][<a href=\"https://stackoverflow.com/questions/54221055/excel-vba-import-module-from-text-file-without-requiring-trust-center]\" title=\"excel vba import module from text file without requiring trust center%5d\">stackoverflow.com/questions/54221055/&hellip;</a>, if it meets your reuirement.It works for me for similar situation."}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577633740, "post_id": 59518221, "comment_id": 105212488, "body": "Personally, I think you are asking for more problems than it is worth, but over time you will probably see that for yourself."}, {"owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "edited": false, "score": 0, "creation_date": 1577635367, "post_id": 59518221, "comment_id": 105212901, "body": "Edited code in question to make it more clear. Problem is that it works by adding code from txt file in front of code in excel file, but I want that code in txt file is executed."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1577636787, "post_id": 59518221, "comment_id": 105213252, "body": "It\u2019s still not clear what isn\u2019t working. ITMT, Check these two projects: <a href=\"https://github.com/mattpalermo/VBA-Import-Export\" rel=\"nofollow noreferrer\">github.com/mattpalermo/VBA-Import-Export</a> and <a href=\"https://github.com/spences10/VBA-IDE-Code-Export\" rel=\"nofollow noreferrer\">github.com/spences10/VBA-IDE-Code-Export</a>"}, {"owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "edited": false, "score": 0, "creation_date": 1577641117, "post_id": 59518221, "comment_id": 105214427, "body": "I&#39;m not trying to import or export code, I&#39;m trying to call VBA code in txt file from excel(.xlsm file) and execute what is inside txt file."}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": false, "score": 0, "last_activity_date": 1577737225, "creation_date": 1577737225, "answer_id": 59536419, "question_id": 59518221, "link": "https://stackoverflow.com/questions/59518221/import-source-from-txt-or-bas-file/59536419#59536419", "title": "Import source from txt or bas file", "body": "<p>It is not possible to execute code in a text file as a VBA \"macro\". The programming language/environment/interface simply does not work that way - no ifs, ands or buts - no workarounds. </p>\n\n<p>The content of a text or bas file <em>must</em> be imported into a VBA project, using code similar to what's in the question.</p>\n\n<p>In order to be able to use the VB Extensibility libraries that this code depends on, a specific security setting in the host Office application must be disabled, making this kind of approach unreliable, at best. The setting cannot be disabled using code, for understandable reasons.</p>\n\n<p>Indeed, the approach proposed in the question would be a massive security risk...</p>\n"}], "owner": {"reputation": 142, "user_id": 10982978, "user_type": "registered", "profile_image": "https://graph.facebook.com/2540501589325589/picture?type=large", "display_name": "Matiss Zuravlevs", "link": "https://stackoverflow.com/users/10982978/matiss-zuravlevs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577737251, "creation_date": 1577611855, "last_edit_date": 1577737251, "question_id": 59518221, "link": "https://stackoverflow.com/questions/59518221/import-source-from-txt-or-bas-file", "title": "Import source from txt or bas file", "body": "<p>I want to store source code of VBA macro in .bas or .txt file and run it when user runs macro. I have macro that is used by multiple people, and I would like to store file on server to prevent them to use older versions of same macro. I found following line in stackoverflow and placed it in module code that should import code</p>\n\n<pre><code>'Library should be turned on Microsoft Visual Basic for Applications Extensibility 5.3\nOption Explicit\n\nSub main()\nDim VBPrj As VBIDE.VBProject\nDim VBCom As VBIDE.VBComponent\n    Set VBPrj = Application.VBE.ActiveVBProject\n    Set VBCom = VBPrj.VBComponents(\"Module1\")\n    VBCom.CodeModule.AddFromFile (\"C:\\Users\\lietu\\OneDrive\\Documents\\tests\\Module1.txt\")\nEnd Sub\n</code></pre>\n\n<p>then I created txt file with following code in right location</p>\n\n<pre><code>Attribute VB_Name = \"Module1\"\nSub main()\n    MsgBox \"Hello World\"\nEnd Sub\n</code></pre>\n\n<p>What I'm doing wrong?</p>\n"}, {"tags": ["vba", "ms-access", "while-loop", "comparison"], "comments": [{"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1577608701, "post_id": 59516983, "comment_id": 105207059, "body": "Which exact line causes the error? <a href=\"http://www.cpearson.com/excel/DebuggingVBA.aspx\" rel=\"nofollow noreferrer\">Debugging VBA Code</a>"}, {"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1577676686, "post_id": 59516983, "comment_id": 105221612, "body": "<code>While fd.SelectedItems(1) = vbNullString</code> causes the error."}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 2, "creation_date": 1577705550, "post_id": 59516983, "comment_id": 105229765, "body": "I&#39;m not sure what you are trying to do with this code, but are you aware that <code>CurrentProject.Path</code> gives you the current db&#39;s path? There is no need for the user to supply that path."}, {"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "reply_to_user": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1577706132, "post_id": 59516983, "comment_id": 105230032, "body": "I&#39;ve seen that before but never connected the dots. Thanks for pointing me to that; it&#39;ll help reduce the complexity of what I&#39;m trying to do."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 0, "creation_date": 1577678445, "post_id": 59517757, "comment_id": 105221911, "body": "See my reply to @LeeMac above."}], "tags": [], "owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "is_accepted": false, "score": 1, "last_activity_date": 1577606617, "creation_date": 1577606617, "answer_id": 59517757, "question_id": 59516983, "link": "https://stackoverflow.com/questions/59516983/broken-selecteditems-comparison-in-access-while-loop/59517757#59517757", "title": "Broken SelectedItems comparison in Access While loop", "body": "<p>I don't see need for nested While. Consider:</p>\n\n<pre><code>Dim booResult As Boolean\n...\nWhile booResult = False\n    If fd.Show = True Then 'folder path was selected\n        booResult = True\n        sFolder = fd.SelectedItems(1)\n    End If\nWend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 0, "creation_date": 1577678360, "post_id": 59521352, "comment_id": 105221893, "body": "Thanks for catching that editing error. Also, I didn&#39;t realize one could use Nz in the fashion you do here. Third, I will try QueryDefs at some point, but I am uncertain how useful they will be with SQLite down the road."}, {"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 0, "creation_date": 1577678561, "post_id": 59521352, "comment_id": 105221928, "body": "I need to clarify some assumptions I&#39;m making. I want this database to be usable throughout my company without the need for a server, and the path to the database may change from computer to computer. Knowing that path would allow pictures to be included in each entry in the main table. I may be overthinking this at the cost of usability."}, {"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 0, "creation_date": 1577697453, "post_id": 59521352, "comment_id": 105226615, "body": "Is the CreateQueryDefs code the parameterized SQL statement? That&#39;s pretty advanced for me."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 1, "creation_date": 1577705687, "post_id": 59521352, "comment_id": 105229828, "body": "You&#39;re welcome. Using <code>CreateQueryDef</code> to provide a means of manipulating a temporary query is but one way to work with parameterised queries - <a href=\"https://stackoverflow.com/a/49509616/7531598\">there are many other methods</a> - any of which should be favoured over concatenating values directly within a SQL statement. Your other questions would be better answered as a new question, though note that asking for the best way to do something will likely attract opinion-based answers and may therefore be closed."}, {"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 0, "creation_date": 1577706948, "post_id": 59521352, "comment_id": 105230396, "body": "Parameterised queries feature a whole lot of subtlety to study in Access. I&#39;ll have to figure it out as I go along, referring back to that along the way. Until I move on to more sophisticated databases, my current &quot;ugly&quot; method will have to do."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 1, "creation_date": 1577723889, "post_id": 59521352, "comment_id": 105237723, "body": "Don&#39;t fret - they&#39;re not as difficult as they may initially appear - in fact, because they handle escaping data types automatically (so you don&#39;t have to remember to surround values with single/double quotes, and escape quotes within the values), they are actually easier in that regard. FWIW, note that the alternative is not frowned upon for being &quot;ugly&quot;, but rather that it leaves apps open to SQL injection attacks. Nevertheless, if my answer sufficiently answered your question, please mark it as the solution so that the question shows as resolved for others browsing the site. Thanks!"}, {"owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 0, "creation_date": 1577766374, "post_id": 59521352, "comment_id": 105248756, "body": "Final thoughts here: 1) Your use of CreateQueryDefs syntax is new to me. Where do I find out more? 2) The link you gave states that this result can be accomplished through referring to form controls. I&#39;ve done that in SQL statements elsewhere."}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "edited": false, "score": 0, "creation_date": 1577801154, "post_id": 59521352, "comment_id": 105259071, "body": "1) You can find out more about the CreateQueryDef method <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/database-createquerydef-method-dao\" rel=\"nofollow noreferrer\">here</a> - the &#39;Remarks&#39; describe my use of this method with a zero-length string as the query name. 2) Referencing form controls is certainly a viable alternative - though this requires creating a separate form object and so the code isn&#39;t quite as self-contained."}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 2, "last_activity_date": 1577677656, "last_edit_date": 1577677656, "creation_date": 1577638107, "answer_id": 59521352, "question_id": 59516983, "link": "https://stackoverflow.com/questions/59516983/broken-selecteditems-comparison-in-access-while-loop/59521352#59521352", "title": "Broken SelectedItems comparison in Access While loop", "body": "<p>Firstly, note that you have doubled-up the ampersand in this concatenation:</p>\n\n<pre><code>strSQL = \"UPDATE t_ComputerInfo SET [t_ComputerInfo].[ComputerName] = '\" &amp; sHostName &amp; _\n         &amp; \" [t_ComputerInfo].[DBPath] = '\" &amp; sFolder &amp; \"' WHERE [t_ComputerInfo].[ID] = 1\"\n         ^----- Here \n</code></pre>\n\n<hr>\n\n<p>For the rest of your code, I believe you can remove the <code>while</code> loop entirely (unless you really want the user to be stuck in a loop until they select a folder...?).</p>\n\n<p>I might suggest something along the lines of the following:</p>\n\n<pre><code>Private Sub btn_CorrectPath_Click()\n    Dim fdr As String\n    Dim pcn As String\n\n    pcn = Environ$(\"computername\")\n    If Nz(DLookup(\"computername\", \"t_computerinfo\"), \"\") &lt;&gt; pcn Then\n        With Application.FileDialog(4)\n            .AllowMultiSelect = False\n            .Title = \"Select Database Folder\"\n            If .Show Then fdr = .selecteditems(1)\n        End With\n        If fdr &lt;&gt; \"\" Then\n            With CurrentDb.CreateQueryDef(\"\", \"update t_computerinfo t set t.computername = @pcn, t.dbpath = @fdr where t.id = 1\")\n                .Parameters(0) = pcn\n                .Parameters(1) = fdr\n                .Execute dbFailOnError\n            End With\n        End If\n    End If\nEnd Sub\n</code></pre>\n\n<p>Here, I've used <code>DLookup</code> in place of opening a recordset, as this seemed overkill when querying a single value, though, you will probably want to supply <code>DLookup</code> with some criteria.</p>\n\n<p>I've also used a parameterised SQL statement in place of concatenating values, as this is better practice and also takes care of the data types.</p>\n"}], "owner": {"reputation": 59, "user_id": 10913860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b723f7f855ab9f90f8bf2a1198b8172?s=128&d=identicon&r=PG&f=1", "display_name": "N.Barrett", "link": "https://stackoverflow.com/users/10913860/n-barrett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593644327, "creation_date": 1577595870, "last_edit_date": 1593644327, "question_id": 59516983, "link": "https://stackoverflow.com/questions/59516983/broken-selecteditems-comparison-in-access-while-loop", "title": "Broken SelectedItems comparison in Access While loop", "body": "<p>To allow portability of an Access database, I want to force the user to select its folder if it's copied to another computer. I have run into a stumbling block, though, in trying to test for the folder's path.</p>\n\n<p>In the code below, the <code>if</code> statement block works when not commented out, but the <code>while</code> statement above it does not. I get:</p>\n\n<blockquote>\n  <p>Run-time error '5': Invalid procedure call or argument. </p>\n</blockquote>\n\n<p>I've looked at <code>Tools &gt; References</code>, and the appropriate pieces seem to be in place. I've tried <code>fd.SelectedItems.Count = 0</code>, but that doesn't prevent an unwanted string from being passed. </p>\n\n<pre><code>Private Sub btn_CorrectPath_Click()\n   Dim sHostName As String, strSQL As String, sFolder As String\n   Dim rs As Recordset, db As Database, fd As FileDialog\n   Dim intResult As Integer\n\n   Set db = CurrentDb\n   ' Get Host Name / Get Computer Name\n   sHostName = Environ$(\"computername\")\n   Set rs = CurrentDb.OpenRecordset(\"SELECT * FROM t_ComputerInfo\")\n\n   If rs!ComputerName &lt;&gt; sHostName Then\n      Set fd = Application.FileDialog(msoFileDialogFolderPicker)\n      fd.AllowMultiSelect = False\n      fd.Title = \"Select database folder\"\n\n      intResult = fd.Show\n      While intResult = False\n         intResult = fd.Show\n         While fd.SelectedItems(1) = vbNullString 'folder path was not selected\n            intResult = fd.Show\n         Wend\n      Wend\n      sFolder = fd.SelectedItems(1)\n      strSQL = \"UPDATE t_ComputerInfo SET [t_ComputerInfo].[ComputerName] = '\" &amp; sHostName &amp; _ \n             &amp; \" [t_ComputerInfo].[DBPath] = '\" &amp; sFolder &amp; \"' WHERE [t_ComputerInfo].[ID] = 1\"\n      CurrentDb.Execute strSQL, dbFailOnError\n\n'      If fd.Show = True Then 'Action button was pressed\n'         MsgBox (\"Directory was given. fd.SelectedItems(1)= \" &amp; fd.SelectedItems(1))\n'         If fd.SelectedItems(1) &lt;&gt; vbNullString Then\n'            sFolder = fd.SelectedItems(1)\n'            strSQL = \"UPDATE t_ComputerInfo SET [t_ComputerInfo].[ComputerName] = '\" &amp; sHostName &amp; _\n                     \"', [t_ComputerInfo].[DBPath] = '\" &amp; sFolder &amp; \"' WHERE [t_ComputerInfo].[ID] = 1\"\n'            MsgBox (\"SQL statement = \" &amp; vbCrLf &amp; strSQL)\n'            CurrentDb.Execute strSQL, dbFailOnError\n'         End If\n'      Else 'Cancel button was pressed\n'         sFolder = fd.SelectedItems(1)\n'         MsgBox (\"The location of the database is required and will be requested later. fd.SelectedItems(1)= \" &amp; sFolder)\n'      End If\n      Set fd = Nothing\n   End If\n\n   db.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1578772514, "post_id": 59517999, "comment_id": 105550702, "body": "FYI - I listed the advanced possibilities of the <code>Application.Index</code> function like filtering and restructuring already in a 2018 post <a href=\"https://stackoverflow.com/questions/51688593/excel-vba-insert-new-first-column-in-datafield-array-without-loops-or-api-call/51714153#51714153\">Array insertion without loops or API calls</a>; it&#39;s worth playing around with undiscovered or not so well known methods : +1)"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": true, "score": 3, "last_activity_date": 1577609854, "last_edit_date": 1577609854, "creation_date": 1577609494, "answer_id": 59517999, "question_id": 59516912, "link": "https://stackoverflow.com/questions/59516912/vba-array-exporting-to-sheet/59517999#59517999", "title": "VBA array exporting to sheet", "body": "<p>Something like that is possible:\nLet's assume we have a sheet like in the picture below\n<a href=\"https://i.stack.imgur.com/QOm71.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QOm71.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>The following code will put the first and third column into the variable <code>vDat</code> and write it back.</p>\n\n<pre><code>Sub TestIt()\n    Dim matrix As Variant\n    matrix = Sheet1.Range(\"A1:C3\")\n\n    Dim vDat As Variant\n    vDat = Application.Index(matrix, Array(1, 2, 3), Application.Transpose(Array(1, 3)))\n\n    Sheet1.Range(\"E1\").Resize(3, 2).Value = Application.Transpose(vDat)\n\nEnd Sub\n</code></pre>\n\n<p>You \"only\" need to modify the code to your needs</p>\n"}], "owner": {"reputation": 143, "user_id": 12002029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc2b97d3a76ebda6738c225065552b45?s=128&d=identicon&r=PG&f=1", "display_name": "Carlsberg789", "link": "https://stackoverflow.com/users/12002029/carlsberg789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 59517999, "answer_count": 1, "score": 1, "last_activity_date": 1577737295, "creation_date": 1577594597, "last_edit_date": 1577737295, "question_id": 59516912, "link": "https://stackoverflow.com/questions/59516912/vba-array-exporting-to-sheet", "title": "VBA array exporting to sheet", "body": "<p>I have an array with values in it, and i want to paste several columns to two parts of the same sheet. First matrix would be pasted in column B and second in column H. </p>\n\n<p>Is it possible to export several columns (not one and not all) with a single procedure?\nSo far i have the options below, i can export one or all of the columns but not \"a few\".</p>\n\n<pre><code>Worksheets(\"Sheet1\").Range(\"B\" &amp; m).Resize(s, 14).Value = Matrix3 'Exports entire matrix\nWorksheets(\"E02 Sheet2\").Range(\"B\" &amp; o).Resize(t, 9).Value = Application.Index(Matrix, 0, 1) 'Exports a single column of a matrix\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4004058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8205039855e9605b04aaaaded4da5d5a?s=128&d=identicon&r=PG&f=1", "display_name": "RPM", "link": "https://stackoverflow.com/users/4004058/rpm"}, "edited": false, "score": 1, "creation_date": 1577592757, "post_id": 59516773, "comment_id": 105205001, "body": "YOU&#39;RE A SUPER HERO! works flawlessly. I&#39;ve been trying to get help from reddit for days. Lesson learned."}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 2, "last_activity_date": 1577594392, "last_edit_date": 1577594392, "creation_date": 1577592145, "answer_id": 59516773, "question_id": 59516750, "link": "https://stackoverflow.com/questions/59516750/how-do-i-get-excel-to-refresh-a-specific-cell/59516773#59516773", "title": "How do I get Excel to refresh a specific cell", "body": "<p>This will replicate the action of pressing <code>F2</code> to edit/refresh/recalculate the cell without changing it.</p>\n\n<pre><code>Sub YourMacro()\n\nDim c As Range\n\n    For Each c In Selection.Cells\n        If c.Value = \"ERROR\" Then c.Formula = c.Formula\n\n    Next c\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4004058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8205039855e9605b04aaaaded4da5d5a?s=128&d=identicon&r=PG&f=1", "display_name": "RPM", "link": "https://stackoverflow.com/users/4004058/rpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 59516773, "answer_count": 1, "score": 1, "last_activity_date": 1577594392, "creation_date": 1577591771, "last_edit_date": 1577593417, "question_id": 59516750, "link": "https://stackoverflow.com/questions/59516750/how-do-i-get-excel-to-refresh-a-specific-cell", "title": "How do I get Excel to refresh a specific cell", "body": "<p>Sorry I'm new to macros.</p>\n\n<p>Essentially what I need done is if a cells value is \"ERROR\" then refresh the cell to check for new data. I have the msgbox there to make sure I have everything up to that working. I'm not attached to this code if theres a better method. </p>\n\n<pre><code>Sub Cell_Looping1()\n\n'c = cell\n\nFor Each c In Selection\n\n'Do this\nIf c.Value = \"ERROR\" Then\nMsgBox \"Cell \" &amp; c.Address &amp; \" needs to be refreshed\"\n\n\n\nEnd If\n\nNext c\n    End Sub\n</code></pre>\n\n<p>To add some context. \u201cERROR\u201d happens when I pull too much data from the API. I generally resolve this by selecting the cell in error pressing F2 then Enter. This macro will make life so much easier.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1577592077, "post_id": 59516524, "comment_id": 105204942, "body": "What do you mean by Transposing them into one column? If you want them in one column, that would not by transposing since the data is already in columns."}, {"owner": {"reputation": 21, "user_id": 2930673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ndP6N.jpg?s=128&g=1", "display_name": "Synod", "link": "https://stackoverflow.com/users/2930673/synod"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1577592373, "post_id": 59516524, "comment_id": 105204966, "body": "Sorry, I corrected it. I mean row not column."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1580449324, "post_id": 59516524, "comment_id": 106108407, "body": "People have taken the time to answer your question, you need to take the time to select an answer."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 2930673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ndP6N.jpg?s=128&g=1", "display_name": "Synod", "link": "https://stackoverflow.com/users/2930673/synod"}, "edited": false, "score": 0, "creation_date": 1577676081, "post_id": 59516809, "comment_id": 105221516, "body": "I didn&#39;t mean that the list must start at A1 every time the code starts. What I meant that in using your code, it starts in the top-left most part. Further, when I use your code, the results appeared in a column after the finalRow. As I have asked, It must appear as a row.  Thank you."}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1577646062, "last_edit_date": 1577646062, "creation_date": 1577592912, "answer_id": 59516809, "question_id": 59516524, "link": "https://stackoverflow.com/questions/59516524/adding-and-setting-ranges-in-excel-vba/59516809#59516809", "title": "Adding and Setting Ranges in Excel VBA", "body": "<p>You are correct that your code is wrong where you highlight. Try a <code>union</code>. From there, it should be pretty basic to just loop through your range and put them wherever you want in the Sheet2 spreadsheet. See if the below does what you need.</p>\n\n<pre><code>  Sub AddRanges()\n\nDim inRange As Range, acell As Range, aCounter As Long\nConst startAddress As String = \"A1\"\n\nSet inRange = Union(Sheet1.Range(\"A1:A6\"), Sheet1.Range(\"C1:C6\"), Sheet1.Range(\"C10:C14\"))\n\nFor Each acell In inRange.Cells\n\n    If Not IsEmpty(acell) Then\n\n    finalRow = sheet2.Cells(Rows.Count, 1).End(xlUp).Row + 1 'find last row\n\n    sheet2.Cells(finalRow, 1).Value = acell.Value\n    End If\n\n\nNext acell\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 2930673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ndP6N.jpg?s=128&g=1", "display_name": "Synod", "link": "https://stackoverflow.com/users/2930673/synod"}, "edited": false, "score": 0, "creation_date": 1577621021, "post_id": 59516898, "comment_id": 105209335, "body": "Thanks for reply, before I start checking your suggestion I am thinking that probably the code will let me place the values in a column. if so, I am sorry but I corrected by question that I am trying to place it in the last row of the second sheet. Thanks."}, {"owner": {"reputation": 21, "user_id": 2930673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ndP6N.jpg?s=128&g=1", "display_name": "Synod", "link": "https://stackoverflow.com/users/2930673/synod"}, "edited": false, "score": 0, "creation_date": 1577634787, "post_id": 59516898, "comment_id": 105212729, "body": "I tested your code, but i am having a runtime error code 1004 by at the start of &quot;For Each RangeArea In InRange.Areas&quot;. Do I need to define(?) RangeArea first?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 21, "user_id": 2930673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ndP6N.jpg?s=128&g=1", "display_name": "Synod", "link": "https://stackoverflow.com/users/2930673/synod"}, "edited": false, "score": 0, "creation_date": 1577635796, "post_id": 59516898, "comment_id": 105213016, "body": "The code works as is. Where have you placed the code?"}, {"owner": {"reputation": 21, "user_id": 2930673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ndP6N.jpg?s=128&g=1", "display_name": "Synod", "link": "https://stackoverflow.com/users/2930673/synod"}, "edited": false, "score": 0, "creation_date": 1577642818, "post_id": 59516898, "comment_id": 105214850, "body": "Sorry, I tried it and works well. However, I am just wondering what is it in the code that does not consider blanks. Further, although minor already, It does not go to the next finalrow. Thanks. It leads me to a new option."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 21, "user_id": 2930673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ndP6N.jpg?s=128&g=1", "display_name": "Synod", "link": "https://stackoverflow.com/users/2930673/synod"}, "edited": false, "score": 0, "creation_date": 1577658320, "post_id": 59516898, "comment_id": 105218642, "body": "SpecialCells(xlCellTypeConstants). copies just the cells with values.Code has been edited to paste to next row."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1577658373, "last_edit_date": 1577658373, "creation_date": 1577594352, "answer_id": 59516898, "question_id": 59516524, "link": "https://stackoverflow.com/questions/59516524/adding-and-setting-ranges-in-excel-vba/59516898#59516898", "title": "Adding and Setting Ranges in Excel VBA", "body": "<p>Check it out.</p>\n\n<pre><code>Sub RngAreaTransps()\n\n    Dim RangeArea As Range, LstRw As Long\n    Dim sh As Worksheet, ws As Worksheet\n    Dim col As Long, InRange As Range\n\n    Set sh = Sheets(1)\n    Set ws = Sheets(2)\n    LstRw = ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Row + 1\n    With sh\n        Set InRange = .Range(\"A1:A6, C1:C6, C10:C14\")\n\n        For Each RangeArea In InRange.Areas\n\n            With ws\n\n                col = .Cells(LstRw, .Columns.Count).End(xlToLeft).Column\n                If col &lt;&gt; 1 Then col = col + 1\n                RangeArea.SpecialCells(xlCellTypeConstants).Copy\n                .Cells(LstRw, col).PasteSpecial Transpose:=True\n\n            End With\n\n        Next RangeArea\n\n    End With\n\n    Application.CutCopyMode = False\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 2930673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ndP6N.jpg?s=128&g=1", "display_name": "Synod", "link": "https://stackoverflow.com/users/2930673/synod"}, "edited": false, "score": 0, "creation_date": 1577676779, "post_id": 59519409, "comment_id": 105221627, "body": "I really appreciate your suggestion and i am hoping I can make this work. However, I am a newbie and learning along the way. If you can Please continue the code as I was really stuck on that part I will highly appreciate your answer. Also, I am hoping to have the output be placed on the lastrow of the next worksheet. Thanks."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 21, "user_id": 2930673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ndP6N.jpg?s=128&g=1", "display_name": "Synod", "link": "https://stackoverflow.com/users/2930673/synod"}, "edited": false, "score": 0, "creation_date": 1577759458, "post_id": 59519409, "comment_id": 105247783, "body": "@Synod It&#39;s just a matter of changing <code>Range(&quot;f20&quot;)\u2026</code> to wherever you want.  If you want it on the last row of the next worksheet, the something like <code>wsNext.Cells(wsNext.Rows.Count,1).Resize(columnsize:=uBound(&zwnj;&#8203;outRangeValues)).Val&zwnj;&#8203;ue = outRangeValue</code>.  If you mean the last <b>empty</b> row, then something like <code>wsNext.Cells(wsNext.Rows.Count,1).End(xlup).Offset(1,0).Resi&zwnj;&#8203;ze(\u2026.</code>"}], "tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1577622866, "last_edit_date": 1577622866, "creation_date": 1577622477, "answer_id": 59519409, "question_id": 59516524, "link": "https://stackoverflow.com/questions/59516524/adding-and-setting-ranges-in-excel-vba/59519409#59519409", "title": "Adding and Setting Ranges in Excel VBA", "body": "<p>Your code has major problems due to:</p>\n\n<ul>\n<li>Double declaration of <code>inRange</code></li>\n<li>Wrong syntax for <code>Set inRange</code> <em>the entire address needs to be enclosed in a single pair of quotes</em>\n\n<ul>\n<li>Try <code>Set inRange = Range(\"a1:a6, c1:c6, c10:c14\")</code></li>\n</ul></li>\n<li>Wrong method of reading into an array</li>\n</ul>\n\n<p>When you have a range that consists of multiple areas, you have to convert each area separately.</p>\n\n<p>Then you can create a 1-D array from this depending on the order you wish to have these elements, and write it wherever you want.</p>\n\n<p>For example:</p>\n\n<pre><code>Option Explicit\nSub test()\n    Dim inRange As Range, inRangeValues As Variant, outRangeValues As Variant\n    Dim finalRow As Long\n    Dim I As Long, J As Long, V As Variant, L As Long\n    Dim lCols As Long\n\nSet inRange = Range(\"a1:a6, c1:c6, c10:c14\")\n\nReDim inRangeValues(1 To inRange.Areas.Count)\nFor I = 1 To inRange.Areas.Count\n    inRangeValues(I) = inRange.Areas(I)\nNext I\n\n'how many columns?\nlCols = 0\n For I = 1 To UBound(inRangeValues, 1)\n    lCols = lCols + UBound(inRangeValues(I), 1)\n Next I\n\nReDim outRangeValues(1 To lCols)\n\nL = 0\nFor I = 1 To UBound(inRangeValues, 1)\n    For J = 1 To UBound(inRangeValues(I), 1)\n        L = L + 1\n        outRangeValues(L) = inRangeValues(I)(J, 1)\n    Next J\nNext I\n\nStop\n\n   ' enter some code to write the results where you want\n   ' below is just throwaway for proof of concept\n\nRange(\"f20\").Resize(columnsize:=UBound(outRangeValues)).Value = outRangeValues\n\n\nEnd Sub\n</code></pre>\n\n<p>Given your input, the above code would  create output like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/VdHwc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/VdHwc.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 21, "user_id": 2930673, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ndP6N.jpg?s=128&g=1", "display_name": "Synod", "link": "https://stackoverflow.com/users/2930673/synod"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 1, "answer_count": 3, "score": -1, "last_activity_date": 1577676830, "creation_date": 1577588116, "last_edit_date": 1577676830, "question_id": 59516524, "link": "https://stackoverflow.com/questions/59516524/adding-and-setting-ranges-in-excel-vba", "title": "Adding and Setting Ranges in Excel VBA", "body": "<p>I have this sample table.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nx8zF.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nx8zF.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>What I am trying to do is to get all the cell values in all colored cells and transpose them to another worksheet. \nI have trouble with the code below to add and set those ranges together so that I can transpose all of them in a ROW in the other worksheet. I have started with the code below</p>\n\n<pre><code>Sub AddRanges()\n\nDim inRange As Range, inRangeValues() As Variant, outRangeValues() As Variant\nDim finalRow As Long\nDim inRange As Range\n\n\nSet inRange = Sheet1.Range(\"A1:A6\", \"C1:C6\", C10:C14) 'I think i got this wrong; Error Type Mismatch\n\ninRangeValues() = inRange.Value 'generate 2d array\noutRangeValues = Application.Transpose(inRangeValues)\n\nWith Sheet2 \n    finalRow = .Cells(Rows.Count, 1).End(xlUp).Row 'find last row\n\n    If inRange.Columns.Count &gt; 1 Then        '2d array for output\n        .Cells(finalRow + 1, 1).Resize(UBound(outRangeValues, 1), UBound(outRangeValues, 2)) = outRangeValues 'Resize according to output array dimensions\n    Else                                     '1D array for output\n        .Cells(finalRow + 1, 1).Resize(1, UBound(outRangeValues, 1)) = outRangeValues\n    End If\nEnd With\nEnd sub\n</code></pre>\n\n<p>In this example, what is the best approach to combine these ranges so I can transpose them as a ROW? Thanks. </p>\n"}, {"tags": ["vba", "ms-word", "mailmerge"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11818836"}, "edited": false, "score": 1, "creation_date": 1577627755, "post_id": 59516038, "comment_id": 105211006, "body": "Clarification please: you say you get an error 5852, but then you seem to iterate successfully over the records. Did you just continue after the error, or what? Hint: if you use ThisDocument, be sure that the MailMerge data source is set up in that document. If your code is in a template and not in the document with the Data Source attached, you would get that error because ThisDocument has no Mail Merge Data Source object. FWIW long ago using &quot;.Included&quot; used to crash Word - it seems OK here in the simple test I just did but perhaps there&#39;s still an unsolved problem."}, {"owner": {"reputation": 99, "user_id": 11500248, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9g3-VzjJMZo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNUJKj3EywWNaiRPMkj8JhV48CrQ/mo/photo.jpg?sz=128", "display_name": "Torben E", "link": "https://stackoverflow.com/users/11500248/torben-e"}, "edited": false, "score": 0, "creation_date": 1577652894, "post_id": 59516038, "comment_id": 105217459, "body": "Thanks for your reply, I added the information to the question. I had tested the iteration and .Included seperately. BTW, .Included is not my prefered solution, it&#39;s just the only thing I could find which I thought could help."}, {"owner": {"reputation": 99, "user_id": 11500248, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9g3-VzjJMZo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNUJKj3EywWNaiRPMkj8JhV48CrQ/mo/photo.jpg?sz=128", "display_name": "Torben E", "link": "https://stackoverflow.com/users/11500248/torben-e"}, "edited": false, "score": 0, "creation_date": 1577668039, "post_id": 59516038, "comment_id": 105220287, "body": "Let it take as long as it needs, my main issue is that I can&#39;t figure out which rows are checked and which aren&#39;t (without actually merging the document). As a side note, at around 10 columns and 1000 rows it takes about one or two minutes to iterate over all of them, which isn&#39;t lightning fast but also not too slow either."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1577737629, "post_id": 59516038, "comment_id": 105242564, "body": "Just to be absolutely sure, since you haven&#39;t commented on the proposed answer: it&#39;s unclear whether <code>ThisDocument</code> is the correct object. If you substitute <code>ActiveDocument</code> throughout, does <code>.Included</code> still cause an error?"}, {"owner": {"reputation": 99, "user_id": 11500248, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9g3-VzjJMZo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNUJKj3EywWNaiRPMkj8JhV48CrQ/mo/photo.jpg?sz=128", "display_name": "Torben E", "link": "https://stackoverflow.com/users/11500248/torben-e"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1577748364, "post_id": 59516038, "comment_id": 105245792, "body": "@CindyMeister As stated below, for some reason I don&#39;t get the error anymore. I havr the code in the same document the data fields are inserted into and the source gets linked to. I for myself am quite conservative using <code>ActiveDocument</code> since like I understand it, this will refer to the result document after the merge."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 11500248, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9g3-VzjJMZo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNUJKj3EywWNaiRPMkj8JhV48CrQ/mo/photo.jpg?sz=128", "display_name": "Torben E", "link": "https://stackoverflow.com/users/11500248/torben-e"}, "edited": false, "score": 0, "creation_date": 1577747152, "post_id": 59533163, "comment_id": 105245547, "body": "Thank you very much for your answer.  1. I tried it again and for some reason, it stopped giving me the error. I don&#39;t know why.  3. If I try your code with the last record unchecked, it returns all indices as expected, but also a 5853 Invalid parameter error. It does work fine if the last record is checked. This helped me very much.  4. To be honest, I don&#39;t fully understand what you did here but since I already have all the data in an array using &#39;masterData = wks.Range(&quot;A1&quot;).CurrentRegion.Offset(RowOffset:=1).Resize(Ro&zwnj;&#8203;wSize:=numRows).Valu&zwnj;&#8203;e&#39; all I need are said indices."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user11818836"}, "is_accepted": false, "score": 1, "last_activity_date": 1577719752, "creation_date": 1577719752, "answer_id": 59533163, "question_id": 59516038, "link": "https://stackoverflow.com/questions/59516038/how-can-get-a-list-of-included-records-in-a-word-mail-merge-document/59533163#59533163", "title": "How can get a list of included records in a Word Mail Merge Document?", "body": "<p>This Answer is based on the comments so far.</p>\n\n<ol>\n<li>I do not get the problem with .Included here unless ThisDocument is the wrong document. However, since your loop code does not appear to throw an error when accessing other members of ThisDocument.MailMerge.DataSource it is not obvious what is wrong. However, I don't think you need to use .Included.</li>\n<li>I see an immediate slowdown as soon as I try to access any of the .Datasource.DataFields items. I do not know why that is. There is a delay for each access, not just the first access for each record. The one idea I had is that as soon as you change the active record, Word refreshes the values of the merge fields in the main document, and that might cause a problem, particularly if Word needed to access the printer driver for some reason. But nothing I tried (e.g. change the View to Draft) changes that.</li>\n<li><p>You don't really need .Included because you can iterate the records like this:</p>\n\n<pre><code>With ActiveDocument.MailMerge.DataSource\n  previousRecord = 0\n  .ActiveRecord = wdFirstRecord\n  While .ActiveRecord &lt;&gt; previousRecord\n    previousRecord = .ActiveRecord\n    Debug.Print .ActiveRecord ' (just lists the record number)\n    previousRecord = .ActiveRecord\n    .ActiveRecord = wdNextRecord\n    DoEvents ' advisable if you need to stop the code\n  Wend\n</code></pre>\n\n<p>If you need to iterate <em>all</em> the records then you need to use wdFirstDataSourceRecord and wdNextDataSourceRecord instead.</p></li>\n<li><p>The only way I was able to speed up access to the data was to modify the document to include all the fields I wanted to list, then get the values from the document rather than from .DataSource.Datafields. Personally I do not think modify the Mail Merge main document is ideal - in particular, something might stop you from inserting material at the beginning, as I have done. But my test code (needs more error trapping etc. is like this):</p>\n\n<pre><code>Sub checkincluded()\nDim b As Word.Bookmark\nDim bVMMFC As Boolean\nDim bSFC As Boolean\nDim i As Integer\nDim previousRecord As Long\nDim p As Word.Paragraph\nDim r As Word.Range\n\nWith ActiveWindow.View\n  bSFC = .ShowFieldCodes\n  .ShowFieldCodes = False\nEnd With\n\nWith ActiveDocument.MailMerge\n  bVMMFC = .ViewMailMergeFieldCodes\n  .ViewMailMergeFieldCodes = False\n\n  With .DataSource\n    Set r = ActiveDocument.Range(0, 0)\n    Set p = ActiveDocument.Range(0, 0).Paragraphs.Add\n\n\n    For i = 1 To .FieldNames.Count\n      If i &gt; 1 Then\n        r.Text = vbTab\n        r.Start = p.Range.End - 1\n        r.End = p.Range.End - 1\n      End If\n      r.Fields.Add r, WdFieldType.wdFieldMergeField, .FieldNames(i), False\n      r.Start = p.Range.End - 1\n      r.End = p.Range.End - 1\n    Next\n    r.Start = 0\n    r.End = p.Range.End - 1\n    Set b = r.Bookmarks.Add(\"recorddata\")\n    Set r = Nothing\n\n    previousRecord = 0\n    .ActiveRecord = wdFirstRecord\n    While .ActiveRecord &lt;&gt; previousRecord\n      previousRecord = .ActiveRecord\n      Debug.Print .ActiveRecord, b.Range.Text\n      previousRecord = .ActiveRecord\n      .ActiveRecord = wdNextRecord\n      DoEvents\n    Wend\n    b.Delete\n    Set b = Nothing\n    p.Range.Text = \"\"\n    Set p = Nothing\n  End With\n  .ViewMailMergeFieldCodes = bVMMFC\nEnd With\n\nActiveWindow.View.ShowFieldCodes = bSFC\n\nEnd Sub\n</code></pre></li>\n<li><p>Finally, it is probably worth pointing out that there are other ways to exclude records, e.g. using NEXT, NEXTIF, SKIP and SKIPIF fields. But that is perhaps another question.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 99, "user_id": 11500248, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9g3-VzjJMZo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNUJKj3EywWNaiRPMkj8JhV48CrQ/mo/photo.jpg?sz=128", "display_name": "Torben E", "link": "https://stackoverflow.com/users/11500248/torben-e"}, "is_accepted": true, "score": 0, "last_activity_date": 1577748078, "creation_date": 1577748078, "answer_id": 59537888, "question_id": 59516038, "link": "https://stackoverflow.com/questions/59516038/how-can-get-a-list-of-included-records-in-a-word-mail-merge-document/59537888#59537888", "title": "How can get a list of included records in a Word Mail Merge Document?", "body": "<p>Thanks to @yokki's answer, I was able to combine that with what I know and ended up with the following</p>\n\n<pre><code>Sub listIncluded()\n    Dim LastRecord As Long\n    With ActiveDocument.MailMerge.DataSource\n\n    ' Storing the index of the last record for later use\n    .ActiveRecord = wdLastRecord\n    LastRecord = .ActiveRecord\n\n    .ActiveRecord = wdFirstRecord\n        Do\n            Debug.Print .ActiveRecord\n            DoEvents\n            If .ActiveRecord = LastRecord Then Exit Do\n            .ActiveRecord = wdNextRecord\n        Loop Until .ActiveRecord &gt; LastRecord ' Note this will never be satisfied and the loop will always be exited via the Exit Do statement\n    End With\nEnd Sub\n</code></pre>\n\n<p>I find the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.wdmailmergeactiverecord\" rel=\"nofollow noreferrer\">WdMailMergeActiveRecord enumeration</a> a bit confusing but this works.</p>\n\n<p>The original answer threw a <code>5853 Invalid parameter</code> error on the <code>wdNextRecord</code> if the last included record had already been reached and was not equal to the last record overall (i.e. the last record was not included). I circumvented this issue by storing the index of the last record into a local variable and using that to check if the last included record was reached.</p>\n\n<p>Thank you very much to everyone who helped!</p>\n\n<p>As briefly pointed out in a comment, I already have a list of all the\ndata in the data source as an array since I also use it in other parts\nof the script. I used the following statement for that </p>\n\n<pre><code>numRows = wks.Range(\"A1\").CurrentRegion.Rows.Count\nmasterData = wks.Range(\"A1\").CurrentRegion.Offset(RowOffset:=1).Resize(RowSize:=numRows).Value\n</code></pre>\n\n<p><code>wks</code> refers to an Excel worksheet object.</p>\n"}], "owner": {"reputation": 99, "user_id": 11500248, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-9g3-VzjJMZo/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNUJKj3EywWNaiRPMkj8JhV48CrQ/mo/photo.jpg?sz=128", "display_name": "Torben E", "link": "https://stackoverflow.com/users/11500248/torben-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 470, "favorite_count": 0, "accepted_answer_id": 59537888, "answer_count": 2, "score": 0, "last_activity_date": 1577748078, "creation_date": 1577579536, "last_edit_date": 1577653197, "question_id": 59516038, "link": "https://stackoverflow.com/questions/59516038/how-can-get-a-list-of-included-records-in-a-word-mail-merge-document", "title": "How can get a list of included records in a Word Mail Merge Document?", "body": "<p>I have a Mail Merge Document which is controlled via VBA. After the user selects the records he wants to print, I want these to get a print date set in the database. For that I need a list of the records included in the mail merge. </p>\n\n<p>I tried using the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/word.mailmergedatasource.included\" rel=\"nofollow noreferrer\">.Included property</a>, setting <code>ThisDocument.MailMerge.DataSource.ActiveRecord = wdFirstRecord</code> (I later removed the <code>wdFirstRecord</code> in favour of <code>1</code> since it was giving me trouble)\nand then checking for <code>ThisDocument.MailMerge.DataSource.Included</code> to be true but got a 5852 runtime-error \"Object not available\". <strong>EDIT:</strong> I used the following code to iterate over the records. When I remove either of the commented .Included statements, I get said error. (The execution does not feel as slow as yesterday anymore, though it is not especially fast.)</p>\n\n<pre><code>Function outputRecords(Optional limitRecords = -1)\n    With ThisDocument.MailMerge.DataSource\n    Dim str\n        For currentFieldNameIndex = 1 To .FieldNames.Count\n            str = str &amp; .FieldNames(currentFieldNameIndex) &amp; vbTab\n        Next\n        Debug.Print str\n\n        For currentRecordIndex = 1 To .RecordCount\n            If currentRecordIndex &lt;= limitRecords Or limitRecords &lt; 0 Then\n                .ActiveRecord = currentRecordIndex\n                str = \"\"\n                For currentDataFieldIndex = 1 To .DataFields.Count\n                    str = str &amp; .DataFields(currentDataFieldIndex) &amp; vbTab\n                Next\n                'Debug.Print str\n            End If\n            '.Included = True\n            'Debug.Print .Included\n        Next\n\n    End With\nEnd Function\n</code></pre>\n\n<p><strong>Is there a solution to know which records are selected by the user?</strong></p>\n\n<p>About my document: After some general computation, the data source is linked to the document using</p>\n\n<pre><code>Dim sql As String\nsql = \"SELECT * FROM `Sheet0$` \"\nsql = sql &amp; \"WHERE ((`\" &amp; photoPathHeader &amp; \"` &gt; '') AND (`\" &amp; photoLastEditHeader &amp; \"` &gt;= #\" &amp; Format(printFromDate, \"yyyy-mm-dd\") &amp; \"#)) \"\nsql = sql &amp; \"ORDER BY `klasse#name` ASC\"\nThisDocument.MailMerge.OpenDataSource _\n    name:=ThisDocument.Path &amp; \"\\\" &amp; ThisDocument.Variables(\"masterDataFileName\"), _\n    SQLStatement1:=sql, _\n    ReadOnly:=True, LinkToSource:=True\n</code></pre>\n\n<p>a dialog where the user can select individual records for printing is shown. I used this code for that:</p>\n\n<pre><code>Application.Dialogs(wdDialogMailMergeRecipients).Display\n</code></pre>\n\n<p>And finally, the Mail Merge is executed using</p>\n\n<pre><code>ThisDocument.MailMerge.Execute\n</code></pre>\n\n<p>Many thanks in advance!</p>\n"}, {"tags": ["vba", "postgresql", "azure", "ssl", "adodb"], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 12616495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038598cd10db6f64b99fad1de61ab389?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic James-Moore", "link": "https://stackoverflow.com/users/12616495/dominic-james-moore"}, "is_accepted": false, "score": 0, "last_activity_date": 1577927699, "creation_date": 1577927699, "answer_id": 59557406, "question_id": 59516000, "link": "https://stackoverflow.com/questions/59516000/ssl-connection-string-for-azure-postgresql-correct-syntax/59557406#59557406", "title": "SSL connection string for Azure PostgreSQL - correct syntax", "body": "<p>Hi anyone who is watching.  So I worked this out. </p>\n\n<p>Actually very simple, the required parameter is <code>ssmode=require</code>.  It is case sensitive.  I must have somehow missed this from my permutations.  And therefore assume that the syntax is determined by the PostgreSQL ODBC driver. </p>\n\n<p>This resource helped: \n<a href=\"https://www.connectionstrings.com/\" rel=\"nofollow noreferrer\">https://www.connectionstrings.com/</a></p>\n\n<p>Additional gotcha to watch out for :  when the password is included in the connection string, then any non-alphanumerics need to be url encoded which I wasn't thinking about,so my system generated password with an exclamation mark had to be converted to %21.  I got the encoded password from the User DSN at <code>HKEY_CURRENT_USER\\Software\\ODBC\\ODBC.INI\\</code> </p>\n\n<p>However I have now changed the password so that it does not use non-alphanumerics. </p>\n\n<p>Hope this is useful. </p>\n"}], "owner": {"reputation": 1, "user_id": 12616495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/038598cd10db6f64b99fad1de61ab389?s=128&d=identicon&r=PG&f=1", "display_name": "Dominic James-Moore", "link": "https://stackoverflow.com/users/12616495/dominic-james-moore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 538, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577927699, "creation_date": 1577579086, "last_edit_date": 1577579268, "question_id": 59516000, "link": "https://stackoverflow.com/questions/59516000/ssl-connection-string-for-azure-postgresql-correct-syntax", "title": "SSL connection string for Azure PostgreSQL - correct syntax", "body": "<p>I have a Microsoft Excel workbook which I connect to a PostgreSQL db.  I have had this working with the db on localhost for some time. </p>\n\n<p>I have now moved my db to Azure PostgreSQL.  I have successfully reconfigured my queries/connections to pull data into the spreadsheet (by setting up a DSN in 'ODBC Data sources 64 bit') with SSL set to require. </p>\n\n<p>The workbook includes some vba to write data back to the database.  I am getting the error: </p>\n\n<blockquote>\n  <p>Runtime error: '-2147467259 (80004005)': FATAL: SSL connection is\n  required. Please specify SSL options and retry.</p>\n</blockquote>\n\n<p>The error throws on the <code>dbConnPublic.Open sqlConnString</code> line</p>\n\n<p>The relevant parts of the code look like this: </p>\n\n<pre><code>Sub WriteRowToDB()\n\n' Define connectivity\nDim dbConnPublic As New ADODB.Connection\nDim sqlConnString As String\n\nsqlConnString = OpenConnection()\ndbConnPublic.Open sqlConnString\n\nEnd Sub\n\n\nPublic Function OpenConnection() As String\n\n'Define connection objects and terms\nDim sqlConnString As String\n\nDim myDriver As String: myDriver = \"{PostgreSQL ANSI(x64)}\"\nDim myServer As String: myServer = \"djm-main-01.postgres.database.azure.com\"\n\nDim myDatabase As String: myDatabase = \"postgres\"\nDim myUserName As String: myUserName = \"djmmain01admin@djm-main-01\"\nDim myPassword As String: myPassword = \"[my password]\" ' this replaced by the real password\n\n' Open connection\nsqlConnString = \"Driver={PostgreSQL ANSI(x64)};\" &amp; _\n                \"DSN=postgres;\" &amp; _\n                \"Server=\" &amp; myServer &amp; \";\" &amp; _\n                \"Port=5432;\" &amp; _\n                \"UID=\" &amp; myUserName &amp; \";\" &amp; _\n                \"PWD=\" &amp; myPassword &amp; \";\" &amp; _\n                \"Database=\" &amp; myDatabase &amp; \";\" &amp; _\n\n\n\n\n \"ssl=true;READONLY=0;PROTOCOL=6.4;FAKEOIDINDEX=0;SHOWOIDCOLUMN=0;ROWVERSIONING=0;SHOWSYSTEMTABLES=1\"\n\nOpenConnection = sqlConnString\n\nEnd Function\n</code></pre>\n\n<p>I have tried every combination of ssl=true, ssl=required, sslmode=required, using two parameters and three, some with caps, some lowercase, some mixed.  cannot find anything that makes a difference. Also not sure if this syntax is Azure, PostgreSQL or ADODB. </p>\n\n<p>Note that I can also successfully connect to the Azure db using DBeaver and command line psql from Windows, using SSL. </p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1577572781, "creation_date": 1577572781, "answer_id": 59515469, "question_id": 59515374, "link": "https://stackoverflow.com/questions/59515374/how-to-convert-date-format-thats-being-used-to-identify-activesheet/59515469#59515469", "title": "How To Convert Date Format that&#39;s being used to identify Activesheet?", "body": "<p><code>Format</code> returns a <code>Variant/String</code>. There isn't a date any longer after <code>DT.Text = Format(CDate(Me.DT.Text), \"mmm\")</code></p>\n\n<p>If that step is absolutely necessary (not sure why it is), then \"save the date\" :)</p>\n\n<pre><code>If If IsDate(DT.Text) Then\n    Dim theDate as Date\n    theDate = CDate(DT.Text)\n</code></pre>\n\n<p>Then use the date as necessary, <code>Format</code>ting it along the way.</p>\n\n<pre><code>Dim theMonth as String\ntheMonth = Format(theDate, \"Mmm\")\n\nSet ws = ThisWorkbook.Worksheets(theMonth)\n...\nws.Range(\"A\" &amp; newRow).Value = theDate\nws.Range(\"A\" &amp; newRow).NumberFormat = \"dd.mm.yy\"\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 11173362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d55fc9ea751100ecdc0643b9d909f0a1?s=128&d=identicon&r=PG&f=1", "display_name": "junepeace", "link": "https://stackoverflow.com/users/11173362/junepeace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 59515469, "answer_count": 1, "score": 0, "last_activity_date": 1577572781, "creation_date": 1577571753, "question_id": 59515374, "link": "https://stackoverflow.com/questions/59515374/how-to-convert-date-format-thats-being-used-to-identify-activesheet", "title": "How To Convert Date Format that&#39;s being used to identify Activesheet?", "body": "<p>I have a userform that's being used to set up appointments and paste them into the month specific sheet.\nWhat I need is for the full date (dd.mm.yy) to be pasted and not just the \"MMM\" date.</p>\n\n<pre><code>Private Sub Submit_Click()\n\n\nIf IsDate(DT.Text) Then\n\n        DT.Text = Format(CDate(Me.DT.Text), \"mmm\") 'Format as abrivated month\n\n        'Define and Assign worksheet and newRow variables\n        Dim ws As Worksheet, newRow As Long\n        Set ws = ThisWorkbook.Worksheets(Me.DT.Text)\n        newRow = ws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\nDim dtnew As Long\n\ndtnew = DT.NumberFormat = \"dd.mm.yy\"\n\n    ws.Range(\"A\" &amp; newRow).Value = dtnew 'Adds the TextBox3 into Col A &amp; Last Blank Row\n    ws.Range(\"B\" &amp; newRow).Value = GroupName.Text\n    ws.Range(\"D\" &amp; newRow).Value = Coordinator.Text\n    ws.Range(\"E\" &amp; newRow).Value = Email.Text\n    ws.Range(\"F\" &amp; newRow).Value = PhoneNumber.Text\n    ws.Range(\"H\" &amp; newRow).Value = NumberPPL.Text\n\n</code></pre>\n\n<p>How can I get the date from DT.Text to paste as \"dd.mm.yy\" while still sorting the data into the correct worksheet?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1231, "user_id": 4469914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/325b032d62aa1386cb97b10f99d0a1c5?s=128&d=identicon&r=PG&f=1", "display_name": "Nelson M", "link": "https://stackoverflow.com/users/4469914/nelson-m"}, "edited": false, "score": 0, "creation_date": 1577569899, "post_id": 59515082, "comment_id": 105201967, "body": "kindly edit this question for more clarity."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577570281, "post_id": 59515082, "comment_id": 105202052, "body": "Please share how you are calling <code>LowerCom</code>."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 2, "creation_date": 1577570571, "post_id": 59515082, "comment_id": 105202111, "body": "Convert all values to inches, sum, then divide by 12, this gives number of feet. Then take the remainder as a decimal expression of inches - convert to inches as needed."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1577570812, "post_id": 59515082, "comment_id": 105202166, "body": "We still don&#39;t know what <code>myarray</code>, <code>CatvNew</code> and <code>CatvExist</code> are. But I think you have a good <a href=\"https://stackoverflow.com/questions/59515082/rounding-measurement-to-foot-instead-of-12-in?noredirect=1#comment105202111_59515082\">comment</a> already."}, {"owner": {"reputation": 102, "user_id": 276730, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2f2e432b6d179bbaf87c57311ed0b1af?s=128&d=identicon&r=PG", "display_name": "MikeAinOz", "link": "https://stackoverflow.com/users/276730/mikeainoz"}, "edited": false, "score": 0, "creation_date": 1577570871, "post_id": 59515082, "comment_id": 105202181, "body": "Hi John, welcome to StackOverflow. I presume your input fields are decimal feet? You need to break that equation down for clarity for yourself and us. Declare a couple of variables for Existing and New and operate on those. To convert decimal feet to get the inches your need something like Inches = (Feet * 12) MOD 12 . Use the MOD function to get the remainder"}], "answers": [{"tags": [], "owner": {"reputation": 6992, "user_id": 495157, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/UFMPn.png?s=128&g=1", "display_name": "JGFMK", "link": "https://stackoverflow.com/users/495157/jgfmk"}, "is_accepted": false, "score": 0, "last_activity_date": 1577576637, "last_edit_date": 1577576637, "creation_date": 1577575886, "answer_id": 59515759, "question_id": 59515082, "link": "https://stackoverflow.com/questions/59515082/rounding-measurement-to-foot-instead-of-12-in/59515759#59515759", "title": "Rounding Measurement to Foot instead of 12 in", "body": "<p>You don't need VBA for this. </p>\n\n<p>Could be done in straight Excel with formulas.</p>\n\n<p>The trick is to:</p>\n\n<ol>\n<li>convert everything to the lowest common denominator, (inches in your case. Could be date and times too. Same concept applies). </li>\n<li>Then subtract inches from each other.</li>\n<li>Then convert back to feet and inches.</li>\n</ol>\n\n<p>You only need to know about Excel <code>MOD</code> and <code>INT</code> along with some rudimentary maths.</p>\n\n<p>VBA ref for these operands:</p>\n\n<ul>\n<li><a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/operators/mod-operator\" rel=\"nofollow noreferrer\">MOD</a></li>\n<li><a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/int-fix-functions\" rel=\"nofollow noreferrer\">INT</a></li>\n</ul>\n\n<p>The only other thing you might consider is the <code>ABS</code> operator so you always get a positive result.</p>\n\n<p><code>D4 = ABS(D2-D3)</code></p>\n\n<p>See this <a href=\"https://docs.google.com/spreadsheets/d/1pNGL6CABj6f39_35roqoZHNImN1OZtTW-eAk3B7SNXU/edit?usp=sharing\" rel=\"nofollow noreferrer\">example</a></p>\n\n<p><strong>Formulas:</strong>\n<a href=\"https://i.stack.imgur.com/a22pL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/a22pL.png\" alt=\"Formulas\"></a></p>\n\n<p><strong>Data:</strong>\n<a href=\"https://i.stack.imgur.com/Rq3gG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Rq3gG.png\" alt=\"Data\"></a></p>\n"}], "owner": {"reputation": 11, "user_id": 12374664, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-nG7AoTeKtR4/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3retYnj3baEZLDMEIQg1SWH5ftYiZQ/photo.jpg?sz=128", "display_name": "John Lewis", "link": "https://stackoverflow.com/users/12374664/john-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577576637, "creation_date": 1577569108, "last_edit_date": 1577572974, "question_id": 59515082, "link": "https://stackoverflow.com/questions/59515082/rounding-measurement-to-foot-instead-of-12-in", "title": "Rounding Measurement to Foot instead of 12 in", "body": "<p>I have a VBA macro that is taking the difference of two integers and printing it on another sheet. Instead of saying 1ft - 12in I want it to say 2ft - 0in. Below is the code I have been working on.  ExistingCom and NewCom are the two measurements between subtracted. The Round function rounds the measurement to the nears tenth. So 19.33 would be 19.3. The full sentence that is being produced is as follows - \"Lower attachment by 2ft-0in to a height of 18ft-3in\".Thanks!!</p>\n\n<pre><code>Private Sub LowerCom(MakeReadyData, Index, ExistingCom, NewCom)\n\n    ActiveCell.Offset(0, 1).Value = \"Lower attachment by \" &amp; _\n     Int(MakeReadyData(Index, ExistingCom) - MakeReadyData(Index, NewCom)) &amp; _\n     \"ft-\" &amp; Round(((MakeReadyData(Index, ExistingCom) - MakeReadyData(Index, NewCom)) _\n      - Int(MakeReadyData(Index, ExistingCom) - MakeReadyData(Index, NewCom))) * 12, 0) &amp; _\n     \"in to a height of \" &amp; Int(MakeReadyData(Index, NewCom)) &amp; \"ft-\" &amp; _\n      Round(((MakeReadyData(Index, NewCom)) - (Int(MakeReadyData(Index, NewCom)))) * 12, 0) &amp; \"in.\"\n      Range(ActiveCell.Offset(0, 1), ActiveCell.Offset(0, 6)).Merge\n\nEnd Sub\n\n\n\n                    If myarray(i, CatvNew) &lt; myarray(i, CatvExist) Then\n\n                    Call LowerCom(myarray, i, CatvExist, CatvNew)\n                    XX = \"*POLE CLEARANCE FROM \" &amp; myarray(i, 3)\n\n                Else\n\n                    Call RaiseCom(myarray, i, CatvExist, CatvNew)\n                    XX = \"*GROUND CLEARANCE\"\n\n                End If\n            End If\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577570287, "post_id": 59514214, "comment_id": 105202054, "body": "If it is RSS I might condider switching to xmlhttp requests for small request numbers and check the status codes. You need to be careful though with number of requests and timings as SO can temp IP ban you."}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "edited": false, "score": 0, "creation_date": 1577772250, "post_id": 59514214, "comment_id": 105249837, "body": "Any reason not using the <a href=\"https://api.stackexchange.com/docs\">API</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1577596251, "post_id": 59516886, "comment_id": 105205406, "body": "you only need one IE instance created outside loop"}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1577725527, "post_id": 59516886, "comment_id": 105238359, "body": "Thanks.  You probably know this stuff better than anyone I know."}], "tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1577594194, "creation_date": 1577594194, "answer_id": 59516886, "question_id": 59514214, "link": "https://stackoverflow.com/questions/59514214/using-outlook-to-read-rss-items-want-to-delete-item-if-web-page-has-page-not-f/59516886#59516886", "title": "Using Outlook to Read RSS Items. Want to delete Item if Web Page has &#39;Page Not Found&#39;", "body": "<p>I figured it out!  This is the solution!!</p>\n\n<pre><code>Sub GetRssItem()\nDim myNameSpace As Outlook.NameSpace\nDim myFolder As Outlook.Folder\nDim subFolder As Outlook.Folder\nDim myItem As Object\nDim IE As InternetExplorer\n\nSet myNameSpace = Application.GetNamespace(\"MAPI\")\nSet myFolder = myNameSpace.GetDefaultFolder(olFolderRssFeeds)\nFor i = 1 To 27\nSet subFolder = myFolder.Folders(i)\nSet IE = New InternetExplorer\n\n   Debug.Print subFolder\n      For Each myItem In subFolder.Items\n        If InStr(myItem.Subject, \"[on hold]\") &gt; 0 Or _\n            InStr(myItem.Subject, \"[closed]\") &gt; 0 Then\n            Debug.Print myItem.Subject\n            myItem.Delete\n        End If\n\n        If myItem.Body Like \"*\" &amp; \"View article...\" &amp; \"*\" Then\n\n            StartPos = InStr(myItem.Body, \"View article...\") + 17\n            EndPos = InStrRev(myItem.Body, \"&gt;\")\n            myStr = Mid(myItem.Body, StartPos, EndPos - StartPos)\n\n            With IE\n            .Visible = False\n            .navigate myStr\n\n            While .Busy Or .readyState &lt;&gt; READYSTATE_COMPLETE\n                DoEvents\n            Wend\n            Set HTMLdoc = IE.Document\n            If IE.Document.Body.innerHTML Like \"*\" &amp; \"Page not found\" &amp; \"*\" Then\n                myItem.Delete\n            End If\n            End With\n        End If\n\n\n      Next myItem\nNext i\n\nIE.Quit\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1577594194, "creation_date": 1577561443, "last_edit_date": 1577562899, "question_id": 59514214, "link": "https://stackoverflow.com/questions/59514214/using-outlook-to-read-rss-items-want-to-delete-item-if-web-page-has-page-not-f", "title": "Using Outlook to Read RSS Items. Want to delete Item if Web Page has &#39;Page Not Found&#39;", "body": "<p>I am using MS Outlook to read a bunch of forums on SO.  I have code that loop through items and checks for \"[on hold]\" or \"[closed]\" in the subject line.   This works fine.  I'm trying to modify the code a bit to do the following:</p>\n\n<pre><code>#1)  look for language that reads \"View article...\"\n#2)  click this link (need to get innerText)\n#3)  scan the page that opens and check for language that reads \"Page not found\"\n</code></pre>\n\n<p>If this is true, I want to delete the current 'myItem' and move to the next 'myItem'.  I know my code below is close, but instead of '.navigate \"https:' etc., I need to get the innerText from the \"View article...\" hyperlink, click that, and scan the page that opens for the language \"Page not found\".  How can I do that?</p>\n\n<pre><code>Sub GetRssItem()\nDim myNameSpace As Outlook.NameSpace\nDim myFolder As Outlook.Folder\nDim subFolder As Outlook.Folder\nDim myItem As Object\nDim IE As InternetExplorer\n\nSet myNameSpace = Application.GetNamespace(\"MAPI\")\nSet myFolder = myNameSpace.GetDefaultFolder(olFolderRssFeeds)\nFor i = 1 To 27\nSet subFolder = myFolder.Folders(i)\n   Debug.Print subFolder\n      For Each myItem In subFolder.Items\n        If InStr(myItem.Subject, \"[on hold]\") &gt; 0 Or _\n            InStr(myItem.Subject, \"[closed]\") &gt; 0 Then\n            Debug.Print myItem.Subject\n            myItem.Delete\n        End If\n\n        If myItem.Body Like \"*\" &amp; \"View article...\" &amp; \"*\" Then\n            Set IE = New InternetExplorer\n            With IE\n            .Visible = True\n            .navigate \"https://stackoverflow.com/questions/57632973/delete-label-points-and-set-hover-text-and-legend-in-clustering-scatter-plot\" 'CHANGE THIS\n                While .Busy Or .readyState &lt;&gt; READYSTATE_COMPLETE\n                    DoEvents\n                Wend\n            Set HTMLdoc = .document\n            If IE.Body Like \"*\" &amp; \"Page not found\" &amp; \"*\" Then\n                myItem.Delete\n            End If\n            End With\n        End If\n      Next myItem\nNext i\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 1, "creation_date": 1577558265, "post_id": 59513783, "comment_id": 105199310, "body": "<code>cel.cut</code> look at the properties and methods of the <code>range</code> object <code>cel</code> is that type"}, {"owner": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 1, "creation_date": 1577558581, "post_id": 59513783, "comment_id": 105199403, "body": "Once the loop discovers a cell with a value of &quot;Fakturering&quot; it&#39;s your <code>cel</code> variable. Now you can do different stuff with it. You can get the range cel.address for example or you can copy and past or cut that range."}, {"owner": {"reputation": 92, "user_id": 3063055, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5a53c020987b7d1d71813230feaaccc?s=128&d=identicon&r=PG&f=1", "display_name": "MNDevelopments", "link": "https://stackoverflow.com/users/3063055/mndevelopments"}, "edited": false, "score": 0, "creation_date": 1577558945, "post_id": 59513783, "comment_id": 105199510, "body": "Thank you guys - That gives me something to play around with! :)"}], "answers": [{"comments": [{"owner": {"reputation": 92, "user_id": 3063055, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5a53c020987b7d1d71813230feaaccc?s=128&d=identicon&r=PG&f=1", "display_name": "MNDevelopments", "link": "https://stackoverflow.com/users/3063055/mndevelopments"}, "edited": false, "score": 0, "creation_date": 1577559156, "post_id": 59513888, "comment_id": 105199567, "body": "Wow - Thank you! Very neatly explained. Is it possible to cut a preset number of cells to the left of the cell?  Ex: If &quot;Fakturering&quot; is found in cell A4, but I also want cells A1:A3 to be cut and moved as well?"}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 2, "creation_date": 1577560159, "post_id": 59513888, "comment_id": 105199829, "body": "you may wish to check the existence of <code>Range(&quot;H1:H100&quot;).Find(What:=&quot;Fakturering&quot;)</code> before proceeding with the cut, to avoid any errors if Fakturering is not found and the presence of more than 1 if possible."}, {"owner": {"reputation": 92, "user_id": 3063055, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5a53c020987b7d1d71813230feaaccc?s=128&d=identicon&r=PG&f=1", "display_name": "MNDevelopments", "link": "https://stackoverflow.com/users/3063055/mndevelopments"}, "edited": false, "score": 0, "creation_date": 1577561496, "post_id": 59513888, "comment_id": 105200124, "body": "See my solution below - Feel free to correct it (Y)"}], "tags": [], "owner": {"reputation": 19261, "user_id": 10138734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sf6Zj.jpg?s=128&g=1", "display_name": "Akina", "link": "https://stackoverflow.com/users/10138734/akina"}, "is_accepted": true, "score": 1, "last_activity_date": 1577561720, "last_edit_date": 1577561720, "creation_date": 1577558724, "answer_id": 59513888, "question_id": 59513783, "link": "https://stackoverflow.com/questions/59513783/select-the-cell-that-your-if-statement-triggers-at-and-select-that-cell-in-vba/59513888#59513888", "title": "Select the cell that your if statement triggers at and select that cell in vba", "body": "<p>Simply</p>\n\n<pre><code>Call Range(\"H1:H100\").Find(What:=\"Fakturering\").Cut(Destination:=Range(\"A1\"))\n</code></pre>\n\n<p>where \"A1\" is the address of destination cell.</p>\n\n<p>Logic: in <code>Range(\"H1:H100\")</code> perform <code>Find(What:=\"Fakturering\")</code>, then <code>.Cut</code> found cell and paste it to <code>Destination:=Range(\"A1\")</code>.</p>\n\n<p>Of course you may loop until .Find become Nothing. Do not forget to alter Destination...</p>\n\n<hr>\n\n<blockquote>\n  <p>Is it possible to cut a preset number of cells to the left of the cell?</p>\n</blockquote>\n\n<p>No problems.</p>\n\n<pre><code>strAddress = Range(\"H1:H100\").Find(What:=\"Fakturering\").Address\nRange(Range(strAddress), Range(strAddress).Offset(2, 1)).Cut Destination:=Range(\"A1\")\n</code></pre>\n\n<p>Logic: we search the value and get the address of found cell. Then we get a rectangle range, where left-upper corner is found cell <code>Range(strAddress)</code> and right-lower corner is 2 row down and 1 column to right <code>Range(strAddress).Offset(2, 1)</code>. We cut it and paste into destination.</p>\n"}, {"comments": [{"owner": {"reputation": 19261, "user_id": 10138734, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sf6Zj.jpg?s=128&g=1", "display_name": "Akina", "link": "https://stackoverflow.com/users/10138734/akina"}, "edited": false, "score": 0, "creation_date": 1577562078, "post_id": 59514160, "comment_id": 105200261, "body": "It is too difficult to verify your code. <code>End(xlSome)</code> is very capricious and self willed when empty cells present in <code>Worksheet.UsedRange</code>. I&#39;m afraid always when I see it."}, {"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577562509, "post_id": 59514160, "comment_id": 105200347, "body": "<code>cel.cut cel.Offset(5, 0)</code> I think will do it, the method <code>cut</code> has a <code>destination</code> argument"}], "tags": [], "owner": {"reputation": 92, "user_id": 3063055, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5a53c020987b7d1d71813230feaaccc?s=128&d=identicon&r=PG&f=1", "display_name": "MNDevelopments", "link": "https://stackoverflow.com/users/3063055/mndevelopments"}, "is_accepted": false, "score": 0, "last_activity_date": 1577561034, "creation_date": 1577561034, "answer_id": 59514160, "question_id": 59513783, "link": "https://stackoverflow.com/questions/59513783/select-the-cell-that-your-if-statement-triggers-at-and-select-that-cell-in-vba/59514160#59514160", "title": "Select the cell that your if statement triggers at and select that cell in vba", "body": "<p>I ended up doing the following to select the cell, and the rest of the data to the left of that cell: </p>\n\n<pre><code>Dim cel As Range\n\nSub Opdaterstatus()\n\nFor Each cel In Range(\"H1:H100\")\n    If cel.value = \"Fakturering\" Then\n\n       Range(cel, cel.Rows.End(xlToLeft)).Cut\n\n        cel.Offset(5, 0).Insert\n\n\n    End If\n\nNext cel\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 92, "user_id": 3063055, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5a53c020987b7d1d71813230feaaccc?s=128&d=identicon&r=PG&f=1", "display_name": "MNDevelopments", "link": "https://stackoverflow.com/users/3063055/mndevelopments"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 59513888, "answer_count": 2, "score": 0, "last_activity_date": 1577561720, "creation_date": 1577558086, "last_edit_date": 1577558301, "question_id": 59513783, "link": "https://stackoverflow.com/questions/59513783/select-the-cell-that-your-if-statement-triggers-at-and-select-that-cell-in-vba", "title": "Select the cell that your if statement triggers at and select that cell in vba", "body": "<p>Fairly new to VBA.</p>\n\n<p>I'm trying search a column for a specific value, and then select that cell in order to cut and move it. </p>\n\n<p>All i have right now is: </p>\n\n<pre><code>Dim cel As Range\n\nSub Opdaterstatus()\n\nFor Each cel In Range(\"H1:H100\")\n    If cel.value = \"Fakturering\" Then\n\n        MsgBox (cel.value)\n\n    End If\n\nNext cel\n\n\nEnd Sub\n</code></pre>\n\n<p>This finds the cells i want, but <strong>my problem is targeting the actual cell</strong> the if statement triggers on. There is hopefully and most likely an easy way to achieve this.\nThe <code>MsgBox</code> is purely for testing purposes. </p>\n"}, {"tags": ["excel", "vba", "with-statement"], "comments": [{"owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "edited": false, "score": 0, "creation_date": 1577549371, "post_id": 59512506, "comment_id": 105196887, "body": "Create a worksheet object, so <code>dim w as excel.worksheet</code> then <code>set w=Worksheets(&quot;Blabla&quot; &amp; SelectedSystem &amp; &quot; Blabla&quot;)</code> and then use <code>with w</code>"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1577551623, "post_id": 59512506, "comment_id": 105197499, "body": "Just use <code>With Worksheets(&quot;Blabla&quot; &amp; SelectedSystem &amp; &quot; Blabla&quot;)</code>"}, {"owner": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 0, "creation_date": 1577551765, "post_id": 59512506, "comment_id": 105197534, "body": "In VBA you need to declare all variables - even though in your Workbook there is a Worksheet which is named &quot;Sheet2&quot; it doesn&#39;t mean that you can directly use that as an object in your VBA code. As the guys ^ said. Declare the Sheet2 object and then use in your code."}, {"owner": {"reputation": 591, "user_id": 9743237, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O3QG5.jpg?s=128&g=1", "display_name": "rickmanalexander", "link": "https://stackoverflow.com/users/9743237/rickmanalexander"}, "reply_to_user": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 1, "creation_date": 1577572323, "post_id": 59512506, "comment_id": 105202455, "body": "@DannyPapadopulos  He can if \u2018Sheet2\u2019 is the codename of the sheet."}], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": true, "score": 1, "last_activity_date": 1577549636, "creation_date": 1577549636, "answer_id": 59512594, "question_id": 59512506, "link": "https://stackoverflow.com/questions/59512506/how-to-make-a-dynamic-with-reference/59512594#59512594", "title": "How to make a dynamic With reference?", "body": "<p>Create a <code>worksheet</code> object, </p>\n\n<p>so </p>\n\n<p><code>dim w as excel.worksheet</code> </p>\n\n<p>then </p>\n\n<p><code>set w=Worksheets(\"Blabla\" &amp; SelectedSystem &amp; \" Blabla\")</code> </p>\n\n<p>and then use <code>with w</code></p>\n"}], "owner": {"reputation": 143, "user_id": 12002029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc2b97d3a76ebda6738c225065552b45?s=128&d=identicon&r=PG&f=1", "display_name": "Carlsberg789", "link": "https://stackoverflow.com/users/12002029/carlsberg789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 59512594, "answer_count": 1, "score": 0, "last_activity_date": 1580714093, "creation_date": 1577549088, "last_edit_date": 1580714093, "question_id": 59512506, "link": "https://stackoverflow.com/questions/59512506/how-to-make-a-dynamic-with-reference", "title": "How to make a dynamic With reference?", "body": "<p>How do I make a dynamic With reference to a sheet?</p>\n\n<pre><code>Dim lr2 As Long\nDim rng As Range\n\nSelectedSystem = ThisWorkbook.Worksheets(\"Blabla\").Range(\"AI2\").Value\n\n'I would like to change this to a version like the one below,\n' where I reference the selected system rather than a specific sheet.\nWith Sheet2\n    lr2 = Worksheets(\"Blabla\" &amp; SelectedSystem &amp; \" Blabla\").Cells(.Rows.Count, 2).End(xlUp).Row\n    Set rng = Worksheets(\"Blabla\" &amp; SelectedSystem &amp; \" Blabla\").Range(\"H2:H\" &amp; lr2)\nEnd With\n</code></pre>\n"}, {"tags": ["excel", "vba", "filter", "deselect"], "comments": [{"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1577639284, "post_id": 59512016, "comment_id": 105213950, "body": "Without some sample data, a good explanation of what your trying to achieve and what\u2019s wrong with your code it\u2019s difficult to help you"}, {"owner": {"reputation": 1, "user_id": 12614315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0abe0605d99255ca9cce014becd24b9?s=128&d=identicon&r=PG&f=1", "display_name": "DukeMooke", "link": "https://stackoverflow.com/users/12614315/dukemooke"}, "reply_to_user": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1577717396, "post_id": 59512016, "comment_id": 105234923, "body": "Thanks for taking a look at it.  I made some edits to the original post, so hopefully it is easier to understand."}], "owner": {"reputation": 1, "user_id": 12614315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0abe0605d99255ca9cce014becd24b9?s=128&d=identicon&r=PG&f=1", "display_name": "DukeMooke", "link": "https://stackoverflow.com/users/12614315/dukemooke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1577718874, "creation_date": 1577545286, "last_edit_date": 1577718874, "question_id": 59512016, "link": "https://stackoverflow.com/questions/59512016/excel-filter-to-deselect-0", "title": "Excel Filter to Deselect &quot;0&quot;", "body": "<p>I am creating an Excel spreadsheet for inventory management.  Every month I will be changing the quantities on-hand and that need to be ordered.  I'm writing the macro, and I can only get it to \"select\" the quantities that exist on the current sheet.  In order to get it work properly during the next inventory cycle, I need it to refresh all data, and then apply a filter across 3 different sheets that will Deselect items that have the quantity \"0\".  Currently, the macro will only select what items are currently in the filter as opposed to deselecting the unwanted quantities.</p>\n\n<p>The current macro looks like:</p>\n\n<pre><code>Sheets(\"Functional Inventory\").Select\nActiveWorkbook.RefreshAll\nSheets(\"Atlantic Medical Order Sheet\").Select\nActiveSheet.Range(\"$A$3:$C$21\").AutoFilter Field:=2, Criteria1:=Array(\"1\"), Operator:=xlFilterValues\nSheets(\"BG Order Sheet\").Select\nActiveSheet.Range(\"$A$4:$D$212\").AutoFilter Field:=2, Criteria1:=Array(\"1\", _\n    \"2\", \"30\", \"4\", \"5\", \"60\"), Operator:=xlFilterValues\nSheets(\"Choice Order Form\").Select\nActiveSheet.Range(\"$A$5:$C$12\").AutoFilter Field:=2, Criteria1:=\"1\"\nSheets(\"Atlantic Medical Order Sheet\").Select\nActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n    IgnorePrintAreas:=False\nSheets(\"BG Order Sheet\").Select\nActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n    IgnorePrintAreas:=False\nSheets(\"Choice Order Form\").Select\nActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _\n    IgnorePrintAreas:=FalseAny \n</code></pre>\n\n<p>help would be greatly appreciated!</p>\n\n<p>I enclosed a picture of one of the workbooks that I am trying to improve.  <a href=\"https://i.stack.imgur.com/YXWvl.jpg\" rel=\"nofollow noreferrer\">Example Order Form</a></p>\n\n<p>So basically, the quantity to be ordered is populated by a number from another workbook.  Each month, we perform inventory duties, so the quantity to be ordered for each item will range from 0 to infinity.  I just want the macro to use the filter to deselect the items that have a quantity \"0\" to be ordered, therefore the order sheet will only display the items that need to be ordered in non-zero quantities.  </p>\n\n<p>My current problem is that when I record the macro, I deselect \"0\", but the macro recorder is selecting all of the example quantities that I have entered instead of deselecting 0. For example, \"Criteria1=\"1\" when the only items to be ordered have \"1\" entered in the quantity to be ordered, or Criteria1:=Array(\"1\",\"2\",\"30\"...etc) when my test quantities for items to be ordered are 1,2,30, etc. I would like the logic to be something like Criteria1= (not 0), so any non-zero quantity from 1 to a million will be selected.  The problem with selecting the available quantities that exist today, is that next month, the quantity to be ordered may be different, and with the logic that the macro is using, the new quantities will not be selected.  However, I cannot figure out how to perform this simple task.  Any help would be appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6992, "user_id": 495157, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/UFMPn.png?s=128&g=1", "display_name": "JGFMK", "link": "https://stackoverflow.com/users/495157/jgfmk"}, "edited": false, "score": 0, "creation_date": 1577540861, "post_id": 59511418, "comment_id": 105194684, "body": "And the question is? Perhaps upload into Google Sheets and link it. Then tabulate in your question what you are looking to see, explaining why."}, {"owner": {"reputation": 471, "user_id": 11909222, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abc87742e0e00a94fbc6703427d09621?s=128&d=identicon&r=PG&f=1", "display_name": "Danny Papadopulos", "link": "https://stackoverflow.com/users/11909222/danny-papadopulos"}, "edited": false, "score": 0, "creation_date": 1577541191, "post_id": 59511418, "comment_id": 105194755, "body": "You explain pretty well what you would like to achieve with your code. In the end you state that the code works, so what&#39;s the question?"}, {"owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "edited": false, "score": 0, "creation_date": 1577541591, "post_id": 59511418, "comment_id": 105194863, "body": "Sorry, my question was whether there is any more efficient or more summarized code."}, {"owner": {"reputation": 5138, "user_id": 1521579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ac29d48f7dad9997fb6fcc07d9d330?s=128&d=identicon&r=PG", "display_name": "Ricardo Diaz", "link": "https://stackoverflow.com/users/1521579/ricardo-diaz"}, "edited": false, "score": 0, "creation_date": 1577541974, "post_id": 59511418, "comment_id": 105194960, "body": "Better post it in <a href=\"https://codereview.stackexchange.com/\">codereview</a> and remember to post the complete code"}, {"owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "edited": false, "score": 0, "creation_date": 1577548514, "post_id": 59511418, "comment_id": 105196653, "body": "My bad, Thank you :)"}], "owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577540410, "creation_date": 1577540410, "question_id": 59511418, "link": "https://stackoverflow.com/questions/59511418/sum-specific-cells-up-to-a-certain-value-and-then-multiply-the-remaining-ones", "title": "Sum specific cells up to a certain value and then multiply the remaining ones", "body": "<p>I am trying to make a code to add specific hours cells until I reach \"HorasE\" in this case the limit is 45. If the sum is reached from 45 it is subtracted 45 and the remaining is multiplied by 1.5, then the remaining cells multiply individually by 1.5 but round to the nearest .5. Then everything adds up to 45 and the multiplications of the rest. In case of not exceeding 45 simply a normal sum is made. The code I made is as follows, but I think it is very poorly organized and not very simplified, but it works.</p>\n\n<pre><code> With Sheets(\"Llenado\")\n        Set J = .Range(\"D11\")\n        Set V = .Range(\"F11\")\n        Set S = .Range(\"H11\")\n        Set L = .Range(\"L11\")\n        Set M = .Range(\"N11\")\n        Set Mi = .Range(\"P11\")\n        Set J2 = .Range(\"D14\")\n        Set V2 = .Range(\"F14\")\n        Set S2 = .Range(\"H14\")\n        Set L2 = .Range(\"L14\")\n        Set M2 = .Range(\"N14\")\n        Set Mi2 = .Range(\"P14\")\n        Set D = .Range(\"J11\")\n        Set D2 = .Range(\"J14\")\n    End With\n\n    HorasE = Sheets(\"Llenado\").Range(\"D7\")\n\n    If Sheets(\"Llenado\").Range(\"B6\").Value = \"Si\" Then\n        If J.Value + V.Value + S.Value + L.Value + M.Value + Mi.Value &gt; HorasE Then\n            Extras = Application.WorksheetFunction.Floor(J.Value, 0.5) + Application.WorksheetFunction.Floor(V.Value, 0.5) + Application.WorksheetFunction.Floor(S.Value, 0.5) + Application.WorksheetFunction.Floor(L.Value, 0.5) + Application.WorksheetFunction.Floor(M.Value, 0.5) + Application.WorksheetFunction.Floor(Mi.Value, 0.5) - HorasE\n            Extras = Application.WorksheetFunction.Floor(Extras * 1.5, 0.5) + HorasE\n            Extras2 = Application.WorksheetFunction.Floor(J2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(V2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(S2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(L2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(M2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(Mi2.Value * 1.5, 0.5)\n            Extras3 = Application.WorksheetFunction.Floor(D.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(D2.Value * 1.5, 0.5)\n            Sheets(\"Llenado\").Range(\"Q10\").Value = Application.WorksheetFunction.Floor(Extras + Extras2 + Extras3, 0.5)\n        Else\n            If J.Value + V.Value + S.Value + L.Value + M.Value + Mi.Value + J2.Value &gt; HorasE Then\n                Extras = Application.WorksheetFunction.Floor(J.Value, 0.5) + Application.WorksheetFunction.Floor(V.Value, 0.5) + Application.WorksheetFunction.Floor(S.Value, 0.5) + Application.WorksheetFunction.Floor(L.Value, 0.5) + Application.WorksheetFunction.Floor(M.Value, 0.5) + Application.WorksheetFunction.Floor(Mi.Value, 0.5) + Application.WorksheetFunction.Floor(J2.Value, 0.5) - HorasE\n                Extras = Application.WorksheetFunction.Floor(Extras * 1.5, 0.5) + HorasE\n                Extras2 = Application.WorksheetFunction.Floor(V2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(S2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(L2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(M2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(Mi2.Value * 1.5, 0.5)\n                Extras3 = Application.WorksheetFunction.Floor(D.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(D2.Value * 1.5, 0.5)\n                Sheets(\"Llenado\").Range(\"Q10\").Value = Application.WorksheetFunction.Floor(Extras + Extras2 + Extras3, 0.5)\n            Else\n                If J.Value + V.Value + S.Value + L.Value + M.Value + Mi.Value + J2.Value + V2.Value &gt; HorasE Then\n                    Extras = Application.WorksheetFunction.Floor(J.Value, 0.5) + Application.WorksheetFunction.Floor(V.Value, 0.5) + Application.WorksheetFunction.Floor(S.Value, 0.5) + Application.WorksheetFunction.Floor(L.Value, 0.5) + Application.WorksheetFunction.Floor(M.Value, 0.5) + Application.WorksheetFunction.Floor(Mi.Value, 0.5) + Application.WorksheetFunction.Floor(J2.Value, 0.5) + Application.WorksheetFunction.Floor(V2.Value, 0.5) - HorasE\n                    Extras = Application.WorksheetFunction.Floor(Extras * 1.5, 0.5) + HorasE\n                    Extras2 = Application.WorksheetFunction.Floor(S2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(L2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(M2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(Mi2.Value * 1.5, 0.5)\n                    Extras3 = Application.WorksheetFunction.Floor(D.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(D2.Value * 1.5, 0.5)\n                    Sheets(\"Llenado\").Range(\"Q10\").Value = Application.WorksheetFunction.Floor(Extras + Extras2 + Extras3, 0.5)\n                Else\n                    If J.Value + V.Value + S.Value + L.Value + M.Value + Mi.Value + J2.Value + V2.Value + S2.Value &gt; HorasE Then\n                        Extras = Application.WorksheetFunction.Floor(J.Value, 0.5) + Application.WorksheetFunction.Floor(V.Value, 0.5) + Application.WorksheetFunction.Floor(S.Value, 0.5) + Application.WorksheetFunction.Floor(L.Value, 0.5) + Application.WorksheetFunction.Floor(M.Value, 0.5) + Application.WorksheetFunction.Floor(Mi.Value, 0.5) + Application.WorksheetFunction.Floor(J2.Value, 0.5) + Application.WorksheetFunction.Floor(V2.Value, 0.5) + Application.WorksheetFunction.Floor(S2.Value, 0.5) - HorasE\n                        Extras = Application.WorksheetFunction.Floor(Extras * 1.5, 0.5) + HorasE\n                        Extras2 = Application.WorksheetFunction.Floor(L2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(M2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(Mi2.Value * 1.5, 0.5)\n                        Extras3 = Application.WorksheetFunction.Floor(D.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(D2.Value * 1.5, 0.5)\n                        Sheets(\"Llenado\").Range(\"Q10\").Value = Application.WorksheetFunction.Floor(Extras + Extras2 + Extras3, 0.5)\n                    Else\n                        If J.Value + V.Value + S.Value + L.Value + M.Value + Mi.Value + J2.Value + V2.Value + S2.Value + L2.Value &gt; HorasE Then\n                            Extras = Application.WorksheetFunction.Floor(J.Value, 0.5) + Application.WorksheetFunction.Floor(V.Value, 0.5) + Application.WorksheetFunction.Floor(S.Value, 0.5) + Application.WorksheetFunction.Floor(L.Value, 0.5) + Application.WorksheetFunction.Floor(M.Value, 0.5) + Application.WorksheetFunction.Floor(Mi.Value, 0.5) + Application.WorksheetFunction.Floor(J2.Value, 0.5) + Application.WorksheetFunction.Floor(V2.Value, 0.5) + Application.WorksheetFunction.Floor(S2.Value, 0.5) + Application.WorksheetFunction.Floor(L2.Value, 0.5) - HorasE\n                            Extras = Application.WorksheetFunction.Floor(Extras * 1.5, 0.5) + HorasE\n                            Extras2 = Application.WorksheetFunction.Floor(M2.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(Mi2.Value * 1.5, 0.5)\n                            Extras3 = Application.WorksheetFunction.Floor(D.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(D2.Value * 1.5, 0.5)\n                            Sheets(\"Llenado\").Range(\"Q10\").Value = Application.WorksheetFunction.Floor(Extras + Extras2 + Extras3, 0.5)\n                        Else\n                            If J.Value + V.Value + S.Value + L.Value + M.Value + Mi.Value + J2.Value + V2.Value + S2.Value + L2.Value + M2.Value &gt; HorasE Then\n                                Extras = Application.WorksheetFunction.Floor(J.Value, 0.5) + Application.WorksheetFunction.Floor(V.Value, 0.5) + Application.WorksheetFunction.Floor(S.Value, 0.5) + Application.WorksheetFunction.Floor(L.Value, 0.5) + Application.WorksheetFunction.Floor(M.Value, 0.5) + Application.WorksheetFunction.Floor(Mi.Value, 0.5) + Application.WorksheetFunction.Floor(J2.Value, 0.5) + Application.WorksheetFunction.Floor(V2.Value, 0.5) + Application.WorksheetFunction.Floor(S2.Value, 0.5) + Application.WorksheetFunction.Floor(L2.Value, 0.5) + Application.WorksheetFunction.Floor(M2.Value, 0.5) - HorasE\n                                Extras = Application.WorksheetFunction.Floor(Extras * 1.5, 0.5) + HorasE\n                                Extras2 = Application.WorksheetFunction.Floor(Mi2.Value * 1.5, 0.5)\n                                Extras3 = Application.WorksheetFunction.Floor(D.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(D2.Value * 1.5, 0.5)\n                                Sheets(\"Llenado\").Range(\"Q10\").Value = Application.WorksheetFunction.Floor(Extras + Extras2 + Extras3, 0.5)\n                            Else\n                                If J.Value + V.Value + S.Value + L.Value + M.Value + Mi.Value + J2.Value + V2.Value + S2.Value + L2.Value + M2.Value + Mi2.Value &gt; HorasE Then\n                                    Extras = Application.WorksheetFunction.Floor(J.Value, 0.5) + Application.WorksheetFunction.Floor(V.Value, 0.5) + Application.WorksheetFunction.Floor(S.Value, 0.5) + Application.WorksheetFunction.Floor(L.Value, 0.5) + Application.WorksheetFunction.Floor(M.Value, 0.5) + Application.WorksheetFunction.Floor(Mi.Value, 0.5) + Application.WorksheetFunction.Floor(J2.Value, 0.5) + Application.WorksheetFunction.Floor(V2.Value, 0.5) + Application.WorksheetFunction.Floor(S2.Value, 0.5) + Application.WorksheetFunction.Floor(L2.Value, 0.5) + Application.WorksheetFunction.Floor(M2.Value, 0.5) + Application.WorksheetFunction.Floor(Mi2.Value, 0.5) - HorasE\n                                    Extras = Application.WorksheetFunction.Floor(Extras * 1.5, 0.5) + HorasE\n                                    Extras3 = Application.WorksheetFunction.Floor(D.Value * 1.5, 0.5) + Application.WorksheetFunction.Floor(D2.Value * 1.5, 0.5)\n                                    Sheets(\"Llenado\").Range(\"Q10\").Value = Application.WorksheetFunction.Floor(Extras + Extras3, 0.5)\n                                Else\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/glGgo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/glGgo.png\" alt=\"\"></a></p>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1577538389, "post_id": 59510929, "comment_id": 105194080, "body": "Take a look at <a href=\"https://stackoverflow.com/a/11169920/2292722\">this answer</a> to find the last used cell in a column."}, {"owner": {"reputation": 92, "user_id": 3063055, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5a53c020987b7d1d71813230feaaccc?s=128&d=identicon&r=PG&f=1", "display_name": "MNDevelopments", "link": "https://stackoverflow.com/users/3063055/mndevelopments"}, "reply_to_user": {"reputation": 17543, "user_id": 2292722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93a9ec04aa8782640288292e87f3547e?s=128&d=identicon&r=PG&f=1", "display_name": "Tom Brunberg", "link": "https://stackoverflow.com/users/2292722/tom-brunberg"}, "edited": false, "score": 0, "creation_date": 1577540027, "post_id": 59510929, "comment_id": 105194471, "body": "Thank you for the reply - Allthough i&#39;ve seen the thread, but the solutions seemed complicated for what i needed (Maybe I just didn&#39;t understand them properbly) - I solved it by using the code in my comment below (Y)"}], "answers": [{"tags": [], "owner": {"reputation": 92, "user_id": 3063055, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5a53c020987b7d1d71813230feaaccc?s=128&d=identicon&r=PG&f=1", "display_name": "MNDevelopments", "link": "https://stackoverflow.com/users/3063055/mndevelopments"}, "is_accepted": false, "score": 1, "last_activity_date": 1577538370, "creation_date": 1577538370, "answer_id": 59511166, "question_id": 59510929, "link": "https://stackoverflow.com/questions/59510929/how-to-select-the-last-cell-that-contains-data-in-a-specific-column-and-then-us/59511166#59511166", "title": "How to select the last cell that contains data in a specific column, and then use that cell to move to target cell with offset", "body": "<p>I ended up solving my problem with the following code: </p>\n\n<pre><code>Dim korrektion1 As Double\nPrivate Sub CommandButton1_Click()\n\nRange(\"E4\").End(xlDown).Select\n\nSelection.Offset(-3, 0).Select\n\nSelection.Value = korrektion1\n\nUnload UserForm2\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 473, "user_id": 12324907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEBfA.jpg?s=128&g=1", "display_name": "manoj0790", "link": "https://stackoverflow.com/users/12324907/manoj0790"}, "is_accepted": true, "score": 1, "last_activity_date": 1577549640, "creation_date": 1577549640, "answer_id": 59512595, "question_id": 59510929, "link": "https://stackoverflow.com/questions/59510929/how-to-select-the-last-cell-that-contains-data-in-a-specific-column-and-then-us/59512595#59512595", "title": "How to select the last cell that contains data in a specific column, and then use that cell to move to target cell with offset", "body": "<p>You may convert that to one line rather than multiple lines.</p>\n\n<pre><code>Dim korrektion1 As Double\nPrivate Sub CommandButton1_Click()\nRange(\"E4\").End(xlDown).Offset(-3, 0).Value = korrektion1\nUnload UserForm2\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 92, "user_id": 3063055, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c5a53c020987b7d1d71813230feaaccc?s=128&d=identicon&r=PG&f=1", "display_name": "MNDevelopments", "link": "https://stackoverflow.com/users/3063055/mndevelopments"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 59512595, "answer_count": 2, "score": 0, "last_activity_date": 1582735069, "creation_date": 1577536506, "last_edit_date": 1582735069, "question_id": 59510929, "link": "https://stackoverflow.com/questions/59510929/how-to-select-the-last-cell-that-contains-data-in-a-specific-column-and-then-us", "title": "How to select the last cell that contains data in a specific column, and then use that cell to move to target cell with offset", "body": "<p>I'm trying to find the last row off column D, then move three up, and one to the right and insert data to that column. </p>\n\n<p>The reason for this, is that the above cells are dynamic and can be deleted and added as you go along - the last cell and the cell I'm trying to target, doesn't contain the same reference (except from the last line in any column, which are always three down and one to the right from D (LastRow). </p>\n\n<p>I haven't found a solution in similar posts. </p>\n\n<p>The image shows the sheet.<br>\nThe cells marked with yellow are the lastRow cell and the cell I'm trying to insert data into.<br>\nThe cells marked with a blue ring, contains the dynamic cells, which gets longer/shorter depending on the situation.</p>\n\n<p><a href=\"https://i.stack.imgur.com/excEg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/excEg.png\" alt=\"Sheet I&#39;m working on\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577530464, "post_id": 59510184, "comment_id": 105192469, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/40874165/excel-vba-check-if-a-worksheet-is-protected-with-a-password\">Excel VBA - Check if a worksheet is protected WITH A PASSWORD</a>"}, {"owner": {"reputation": 3, "user_id": 12312631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83996027c23c5055a982a6cb4875c45?s=128&d=identicon&r=PG&f=1", "display_name": "Irfan", "link": "https://stackoverflow.com/users/12312631/irfan"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577530888, "post_id": 59510184, "comment_id": 105192558, "body": "No, I mean a code to check if any sheets are protected. Thank you for your response"}], "answers": [{"comments": [{"owner": {"reputation": 473, "user_id": 12324907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEBfA.jpg?s=128&g=1", "display_name": "manoj0790", "link": "https://stackoverflow.com/users/12324907/manoj0790"}, "reply_to_user": {"reputation": 3, "user_id": 12312631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83996027c23c5055a982a6cb4875c45?s=128&d=identicon&r=PG&f=1", "display_name": "Irfan", "link": "https://stackoverflow.com/users/12312631/irfan"}, "edited": false, "score": 0, "creation_date": 1577540686, "post_id": 59510245, "comment_id": 105194639, "body": "Glad it helped :)"}], "tags": [], "owner": {"reputation": 473, "user_id": 12324907, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fEBfA.jpg?s=128&g=1", "display_name": "manoj0790", "link": "https://stackoverflow.com/users/12324907/manoj0790"}, "is_accepted": true, "score": 1, "last_activity_date": 1577530507, "creation_date": 1577530507, "answer_id": 59510245, "question_id": 59510184, "link": "https://stackoverflow.com/questions/59510184/how-to-create-code-to-detect-if-any-sheet-is-protected/59510245#59510245", "title": "How to create code to detect if any Sheet is protected?", "body": "<p>If you want to check whether any sheets are protected you can use the below code. </p>\n\n<pre><code>Sub ProtectCheck()\n\nDim Ws As Worksheet\nProtectCount = 0\nFor Each Ws In ThisWorkbook.Worksheets\n    If Ws.ProtectContents = True Then\n        ProtectCount = ProtectCount + 1\n    End If\nNext Ws\n\nIf ProtectCount = 0 Then\n    MsgBox \"No Sheets are protected\", vbInformation + vbOKOnly\nElse\n    MsgBox ProtectCount &amp; \" sheet(s) are protected\", vbInformation + vbOKOnly\nEnd If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 12312631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a83996027c23c5055a982a6cb4875c45?s=128&d=identicon&r=PG&f=1", "display_name": "Irfan", "link": "https://stackoverflow.com/users/12312631/irfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 59510245, "answer_count": 1, "score": 0, "last_activity_date": 1577530764, "creation_date": 1577530016, "last_edit_date": 1577530764, "question_id": 59510184, "link": "https://stackoverflow.com/questions/59510184/how-to-create-code-to-detect-if-any-sheet-is-protected", "title": "How to create code to detect if any Sheet is protected?", "body": "<p>Below is the logic of my code:</p>\n\n<pre><code>If &lt;any sheets protected&gt; Then\n   Msgbox \"There's some sheets protected\"\nelse\n   Msgbox \"No sheets are protected\"\nend if\n</code></pre>\n"}, {"tags": ["excel", "vba", "performance"], "comments": [{"owner": {"reputation": 5847, "user_id": 3187033, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/DfSEN.png?s=128&g=1", "display_name": "JohnyL", "link": "https://stackoverflow.com/users/3187033/johnyl"}, "edited": false, "score": 3, "creation_date": 1577519756, "post_id": 59509036, "comment_id": 105190444, "body": "You need to go to <a href=\"https://codereview.stackexchange.com\">Code Review</a>"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 3, "creation_date": 1577521325, "post_id": 59509036, "comment_id": 105190675, "body": "Read everything into an array, process everything using the array, and then transfer it all back to Excel in one shot. Every time you have to read/write a value to a cell it gets slow. (also, use <code>.Value2</code> instead of <code>.Value</code> and it will be slightly faster.)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12431753"}, "edited": false, "score": 0, "creation_date": 1577578305, "post_id": 59509036, "comment_id": 105203383, "body": "<a href=\"http://stackoverflow.com/questions/29596432/pointers-needed-for-speeding-up-nested-loop-macro-in-vba/29597193#29597193\" title=\"pointers needed for speeding up nested loop macro in vba\">stackoverflow.com/questions/29596432/&hellip;</a>"}], "owner": {"reputation": 143, "user_id": 12002029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc2b97d3a76ebda6738c225065552b45?s=128&d=identicon&r=PG&f=1", "display_name": "Carlsberg789", "link": "https://stackoverflow.com/users/12002029/carlsberg789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1577738498, "creation_date": 1577519062, "last_edit_date": 1577738498, "question_id": 59509036, "link": "https://stackoverflow.com/questions/59509036/ideas-to-make-vba-looping-faster", "title": "Ideas to make VBA looping faster?", "body": "<p>I have an issue with my code below (i only copied the relevant part). The code works fine, but it's too slow. Basically the code compares data from Examplesheet2 with the data in Examplesheet3 and then moves it to 4 different worksheets. The code includes a search function and multiple nested if's. There is no way around the fact that there are a lot of \"if\" conditions. </p>\n\n<p>Does anyone have an idea how to improve the code in order to make it faster?</p>\n\n<pre><code>Sub WorksFine()\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\nApplication.Calculation = xlManual\n\nDim lr1 As Long\nDim lr2 As Long\nDim x As Long, n As Integer, m As Integer, o As Integer\nDim Arr As Variant\nDim rng As Range, rng2 As Range, cl As Range, cl2 As Range\n\n\n\nn = 20 'Start row \nm = 20 'Start row \no = 20 'Start row \np = 21 'Start row \n\nSelect Case ThisWorkbook.Worksheets(\"Examplesheet1\").Range(\"AI2\").Value\n\n    Case Is = \"Example\"\n\n\n        'Define range from which to match from\n        With Blad6\n            lr1 = Worksheets(\"ExampleSheet2\").Cells(.Rows.Count, 1).End(xlUp).Row\n            Arr = Worksheets(\"ExampleSheet2\").Range(\"A2:A\" &amp; lr1 + 1)\n\n        End With\n\n\n        'Define range from which to look from\n        With Sheet2\n            lr2 = Worksheets(\"Examplesheet3\").Cells(.Rows.Count, 2).End(xlUp).Row\n            Set rng = Worksheets(\"Examplesheet3\").Range(\"H2:H\" &amp; lr2)\n        End With\n\n        With Blad6\n        For x = 1 To UBound(Arr)\n        Set cl = rng.Find(Arr(x, 1), LookIn:=xlValues)\n\n            If Not cl Is Nothing Then\n                If Worksheets(\"Examplesheet1\").Cells(x + 1, 7) = cl.Offset(0, -4) And cl.Offset(0, -5) &gt; Worksheets(\"Examplesheet1\").Cells(x + 1, 3) Then\nFoundFullMatch:\n                    Worksheets(\"Outputsheet1\").Cells(n, 2).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 1)\n                    Worksheets(\"Outputsheet1\").Cells(n, 3).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 2)\n                    Worksheets(\"Outputsheet1\").Cells(n, 4).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 8)\n                    Worksheets(\"Outputsheet1\").Cells(n, 5).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 3)\n                    Worksheets(\"Outputsheet1\").Cells(n, 6).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 4)\n                    Worksheets(\"Outputsheet1\").Cells(n, 7) = cl.Offset(0, -5)\n                    Worksheets(\"Outputsheet1\").Cells(n, 8).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 6)\n                    Worksheets(\"Outputsheet1\").Cells(n, 9).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 5)\n                    Worksheets(\"Outputsheet1\").Cells(n, 10).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 7)\n                    Worksheets(\"Outputsheet1\").Cells(n, 11) = cl.Offset(0, -4)\n                    Worksheets(\"Outputsheet1\").Cells(n, 12).Value = Worksheets(\"Outputsheet1\").Cells(n, 10).Value - Worksheets(\"Outputsheet1\").Cells(n, 11).Value\n                    If Worksheets(\"Outputsheet1\").Cells(n, 6) = \"\" Then\n                        GoTo ErrorHandler\n                        ElseIf DateValue(Worksheets(\"Outputsheet1\").Cells(n, 6)) &lt; DateValue(Worksheets(\"Outputsheet1\").Cells(n, 7)) Then\n                        Worksheets(\"Outputsheet1\").Cells(n, 13).Value = Worksheets(\"Outputsheet1\").Cells(n, 7) - Worksheets(\"Outputsheet1\").Cells(n, 6)\n                        Else\nErrorHandler:\n                    End If\n                    Worksheets(\"Outputsheet2\").Cells(p, 3).Value = cl.Offset(0, -5)\n                    Worksheets(\"Outputsheet2\").Cells(p, 4).Value = cl.Offset(0, -4) \n                    Worksheets(\"Outputsheet2\").Cells(p, 5).Value = cl.Offset(0, 0) \n                    Worksheets(\"Outputsheet2\").Cells(p, 6).Value = cl.Offset(0, 3) \n                    Worksheets(\"Outputsheet2\").Cells(p, 7).Value = \"Text\" \n                    p = p + 1\n                    n = n + 1\n\n                Else\n\n\n\n                    If cl.Row &lt; lr2 Then\n                    clmem = 1\nKeepLooking:\n                    With Sheet2\n                        lr2 = Worksheets(\"Examplesheet2\").Cells(.Rows.Count, 2).End(xlUp).Row\n                        Set rng2 = Worksheets(\"Examplesheet2\").Range(\"H\" &amp; cl.Row &amp; \":H\" &amp; lr2)\n                    End With\n                    Set cl = rng2.Find(Arr(x, 1), LookIn:=xlValues)\n                    If Not cl Is Nothing Then\n                        If Worksheets(\"Examplesheet1\").Cells(x + 1, 7) = cl.Offset(0, -4) And cl.Offset(0, -5) &gt; Worksheets(\"Examplesheet1\").Cells(x + 1, 3) Then\n                        GoTo FoundFullMatch\n                        Else\n                            If cl.Row &lt; lr2 And cl.Row &lt;&gt; clmem Then\n                            clmem = cl.Row\n                            GoTo KeepLooking\n\n                    Else\n\n                        If Not cl Is Nothing Then\n\n                            If Worksheets(\"Examplesheet1\").Cells(x + 1, 7) &lt;&gt; cl.Offset(0, -4) And cl.Offset(0, -4) &lt;&gt; 0 And cl.Offset(0, -5) &gt; Worksheets(\"Examplesheet1\").Cells(x + 1, 3) Then\n                                Worksheets(\"Outputsheet3\").Cells(m, 2).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 1)\n                                Worksheets(\"Outputsheet3\").Cells(m, 3).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 2)\n                                Worksheets(\"Outputsheet3\").Cells(m, 4).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 8)\n                                Worksheets(\"Outputsheet3\").Cells(m, 5).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 3)\n                                Worksheets(\"Outputsheet3\").Cells(m, 6).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 4)\n                                Worksheets(\"Outputsheet3\").Cells(m, 7) = cl.Offset(0, -5)\n                                Worksheets(\"Outputsheet3\").Cells(m, 8).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 6)\n                                Worksheets(\"Outputsheet3\").Cells(m, 9).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 5)\n                                Worksheets(\"Outputsheet3\").Cells(m, 10).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 7)\n                                Worksheets(\"Outputsheet3\").Cells(m, 11) = cl.Offset(0, -4)\n                                Worksheets(\"Outputsheet3\").Cells(m, 12).Value = Worksheets(\"Outputsheet3\").Cells(m, 10).Value - Worksheets(\"Outputsheet3\").Cells(m, 11).Value\n                                Worksheets(\"Outputsheet3\").Cells(m, 14) = cl.Offset(0, -2)\n                                Worksheets(\"Outputsheet3\").Cells(m, 15) = cl\n                                Worksheets(\"Outputsheet2\").Cells(p, 3).Value = cl.Offset(0, -5) \n                                Worksheets(\"Outputsheet2\").Cells(p, 4).Value = cl.Offset(0, -4) \n                                Worksheets(\"Outputsheet2\").Cells(p, 5).Value = cl.Offset(0, 0) \n                                Worksheets(\"Outputsheet2\").Cells(p, 6).Value = cl.Offset(0, 3) \n                                Worksheets(\"Outputsheet2\").Cells(p, 7).Value = \"Text\" \n                                p = p + 1\n                                m = m + 1\n\n                                Else\n\n\n                                Worksheets(\"Outputsheet4\").Cells(o, 2).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 1)\n                                Worksheets(\"Outputsheet4\").Cells(o, 3).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 2)\n                                Worksheets(\"Outputsheet4\").Cells(o, 4).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 8)\n                                Worksheets(\"Outputsheet4\").Cells(o, 5).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 3)\n                                Worksheets(\"Outputsheet4\").Cells(o, 6).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 4)\n                                Worksheets(\"Outputsheet4\").Cells(o, 8).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 6)\n                                Worksheets(\"Outputsheet4\").Cells(o, 9).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 5)\n                                Worksheets(\"Outputsheet4\").Cells(o, 10).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 7)\n\n                                o = o + 1\n\n                                End If\n\n\n                        Else\n\n                         Worksheets(\"Outputsheet4\").Cells(o, 2).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 1)\n                                Worksheets(\"Outputsheet4\").Cells(o, 3).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 2)\n                                Worksheets(\"Outputsheet4\").Cells(o, 4).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 8)\n                                Worksheets(\"Outputsheet4\").Cells(o, 5).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 3)\n                                Worksheets(\"Outputsheet4\").Cells(o, 6).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 4)\n                                Worksheets(\"Outputsheet4\").Cells(o, 8).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 6)\n                                Worksheets(\"Outputsheet4\").Cells(o, 9).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 5)\n                                Worksheets(\"Outputsheet4\").Cells(o, 10).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 7)\n\n                                o = o + 1\n\n                        End If\n                        End If\n                        End If\n                        End If\n                        End If\n                        End If\n\n                    Else\n\n                     Worksheets(\"Outputsheet4\").Cells(o, 2).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 1)\n                                Worksheets(\"Outputsheet4\").Cells(o, 3).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 2)\n                                Worksheets(\"Outputsheet4\").Cells(o, 4).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 8)\n                                Worksheets(\"Outputsheet4\").Cells(o, 5).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 3)\n                                Worksheets(\"Outputsheet4\").Cells(o, 6).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 4)\n                                Worksheets(\"Outputsheet4\").Cells(o, 8).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 6)\n                                Worksheets(\"Outputsheet4\").Cells(o, 9).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 5)\n                                Worksheets(\"Outputsheet4\").Cells(o, 10).Value = Worksheets(\"Examplesheet1\").Cells(x + 1, 7)\n\n                    o = o + 1\n\n                    End If\n\n        Next\n\n    End With\n</code></pre>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 1040, "user_id": 11767140, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Tbfr3YlhoOs/AAAAAAAAAAI/AAAAAAAAAWo/4_25j9xubwc/photo.jpg?sz=128", "display_name": "David Garc&#237;a Bodego", "link": "https://stackoverflow.com/users/11767140/david-garc%c3%ada-bodego"}, "edited": false, "score": 1, "creation_date": 1577517469, "post_id": 59508885, "comment_id": 105190131, "body": "Welcome to SO! WHen you post a wuestion that is just code, try to explain which one is your problem, where you got it... In fact, as it is just code, you can not apply code format and the readibility is really poor."}, {"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 1, "creation_date": 1577537151, "post_id": 59508885, "comment_id": 105193805, "body": "Don&#39;t not munge query strings with values.  Instead, learn to use parameters."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1577522913, "creation_date": 1577522913, "answer_id": 59509390, "question_id": 59508885, "link": "https://stackoverflow.com/questions/59508885/how-can-i-fix-my-syntax-error-3134-in-this-code/59509390#59509390", "title": "How can I fix my syntax error 3134 in this code?", "body": "<p>Try manually to run the SQL with some values.</p>\n\n<p>You probably need to use either parameters or to concatenate the variables properly, for example using my function <a href=\"https://stackoverflow.com/questions/43589800/syntax-error-in-insert-into-statement-whats-the-error/43591778#43591778\">CSql</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 19, "user_id": 12612103, "user_type": "registered", "profile_image": "https://graph.facebook.com/2772618406092582/picture?type=large", "display_name": "Amos Okongo Okello", "link": "https://stackoverflow.com/users/12612103/amos-okongo-okello"}, "edited": false, "score": 0, "creation_date": 1577607668, "post_id": 59510729, "comment_id": 105206894, "body": "this has really been so helpful i really appreciate"}, {"owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "reply_to_user": {"reputation": 19, "user_id": 12612103, "user_type": "registered", "profile_image": "https://graph.facebook.com/2772618406092582/picture?type=large", "display_name": "Amos Okongo Okello", "link": "https://stackoverflow.com/users/12612103/amos-okongo-okello"}, "edited": false, "score": 0, "creation_date": 1577621978, "post_id": 59510729, "comment_id": 105209573, "body": "You&#39;re welcome! If my answer sufficiently answered your question, please mark the answer as the solution (and upvote if you feel appropriate), so that the question appears as resolved for others browsing the site. Refer to <a href=\"https://stackoverflow.com/help/someone-answers\">this article</a> if you are unsure how to do this. Thanks!"}], "tags": [], "owner": {"reputation": 14479, "user_id": 7531598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/DKnSq.jpg?s=128&g=1", "display_name": "Lee Mac", "link": "https://stackoverflow.com/users/7531598/lee-mac"}, "is_accepted": false, "score": 2, "last_activity_date": 1577541613, "last_edit_date": 1577541613, "creation_date": 1577534794, "answer_id": 59510729, "question_id": 59508885, "link": "https://stackoverflow.com/questions/59508885/how-can-i-fix-my-syntax-error-3134-in-this-code/59510729#59510729", "title": "How can I fix my syntax error 3134 in this code?", "body": "<p>Firstly, note that this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim sSQL, stringSQL As String\n</code></pre>\n\n<p>Results in <code>sSQL</code> being defined as a <strong>Variant</strong>, not a String; which, although will not cause your code to fail (since a Variant can hold data of any type), it will be memory inefficient.</p>\n\n<p>Instead, you should use:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim sSQL As String, stringSQL As String\n</code></pre>\n\n<p>Or, perhaps more readable:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim sSQL As String\nDim stringSQL As String\n</code></pre>\n\n<hr>\n\n<p>Secondly, when invoking a function independently of any other expression, you should not surround the arguments with parentheses of any type.</p>\n\n<p>In your code, on line <strong>11</strong> you have:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.RunSQL [stringSQL]\n</code></pre>\n\n<p>And on line <strong>16</strong> you have:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.RunSQL (stringSQL)\n</code></pre>\n\n<p>Both of these should be changed to:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.RunSQL stringSQL\n</code></pre>\n\n<p>Or, just supply the SQL string directly, e.g.:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DoCmd.SetWarnings False\nDoCmd.RunSQL \"UPDATE tblInventory SET [Current Stock]=[Current Stock]+\" &amp; Me.Amount &amp; \" WHERE BarCode='\" &amp; Me.ID &amp; \"'\"\nDoCmd.SetWarnings True\n</code></pre>\n\n<hr>\n\n<p>Also, since you are only using the recordset to test whether a record exists, you could simplify this to a <code>DLookup</code> call, e.g.:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>DLookup(\"BarCode\",\"tblInventory\",\"BarCode=Forms![YourForm]!ID\")\n</code></pre>\n\n<p>And test whether or not this returns <code>Null</code> using <code>IsNull</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>If IsNull(DLookup(\"BarCode\", \"tblInventory\", \"BarCode=Forms![YourForm]!ID\")) Then\n    ...\nElse\n    ...\nEnd If\n</code></pre>\n\n<hr>\n\n<p>Finally, it is much better practice to use a <strong>parameterised query</strong> in place of concatenating values within a SQL statement.</p>\n\n<p>Using parameters offers two key advantages:</p>\n\n<ul>\n<li>Protects against SQL injection.</li>\n<li>Automatically handles SQL data types.</li>\n</ul>\n\n<p>For example, consider the following code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Close()\n    If IsNull(DLookup(\"BarCode\", \"tblInventory\", \"BarCode=Forms![YourForm]!ID\")) Then\n        With CurrentDb.CreateQueryDef _\n            ( _\n                \"\", _\n                \"insert into tblInventory(BarCode,[Goods Name],Unit,[Unit Price],[Initial Stock],[Current Stock],[Exit Item]) \" &amp; _\n                \"values(@id, @goodsname, @unit, @unitprice, @initstock, @stock, 0)\" _\n            )\n            .Parameters(0) = Me.ID\n            .Parameters(1) = Me.GoodsName\n            .Parameters(2) = Me.Unit\n            .Parameters(3) = Replace(Format(Me.Price, \"0.00\"), \",\", \".\")\n            .Parameters(4) = Me.Amount\n            .Parameters(5) = Me.Amount\n            .Execute\n        End With\n    Else\n        With CurrentDb.CreateQueryDef _\n            ( _\n                \"\", _\n                \"update tblInventory set [Current Stock]=[Current Stock]+@amount where BarCode=@id\" _\n            )\n            .Parameters(0) = Me.Amount\n            .Parameters(1) = Me.ID\n            .Execute\n        End With\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 12612103, "user_type": "registered", "profile_image": "https://graph.facebook.com/2772618406092582/picture?type=large", "display_name": "Amos Okongo Okello", "link": "https://stackoverflow.com/users/12612103/amos-okongo-okello"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1577574534, "creation_date": 1577517054, "last_edit_date": 1577574534, "question_id": 59508885, "link": "https://stackoverflow.com/questions/59508885/how-can-i-fix-my-syntax-error-3134-in-this-code", "title": "How can I fix my syntax error 3134 in this code?", "body": "<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Close()\n\n    Dim sSQL, stringSQL As String\n    Dim rst As DAO.Recordset\n\n    sSQL = \"SELECT BarCode, [Goods Name] FROM tblInventory WHERE BarCode='\" &amp; Me.ID &amp; \"'\"\n    Set rst = CurrentDb.OpenRecordset(sSQL)\n    If rst.EOF Then\n        stringSQL = \"INSERT INTO tblInventory(BarCode,[Goods Name],Unit,[Unit Price],[Initial Stock],[Current Stock],[Exit Item]) values('\" &amp; Me.ID &amp; \"','\" &amp; Me.GoodsName &amp; \"','\" &amp; Me.Unit &amp; \"',\" &amp; Replace(Format(Me.Price, \"0.00\"), \",\", \".\") &amp; \",\" &amp; Me.Amount &amp; \",\" &amp; Me.Amount &amp; \",0)\"\n        DoCmd.SetWarnings False\n        DoCmd.RunSQL [stringSQL]\n        DoCmd.SetWarnings True\n    Else\n        stringSQL = \"UPDATE tblInventory SET [Current Stock]=[Current Stock]+\" &amp; Me.Amount &amp; \" WHERE BarCode='\" &amp; Me.ID &amp; \"'\"\n        DoCmd.SetWarnings False\n        DoCmd.RunSQL (stringSQL)\n        DoCmd.SetWarnings True\n    End If\n    rst.Close\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577503252, "post_id": 59507832, "comment_id": 105188335, "body": "Sounds like something that would be better done with an actual database. What have you tried? Please include your code in your question."}, {"owner": {"reputation": 60, "user_id": 668129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2002f9aaabe65ed0502427c6761060d?s=128&d=identicon&r=PG", "display_name": "nestalgia", "link": "https://stackoverflow.com/users/668129/nestalgia"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577506905, "post_id": 59507832, "comment_id": 105188739, "body": "I&#39;m not really a programmer. Actually, this is the daily statistic of patient&#39;s name and MRN and their respective treatment separated in sheets(month). They(my colleague) have gotten used to just keying in the data manually(directly) onto Excel spreadsheets. As you can probably imagine , this very slow, and really we don&#39;t have time doing this  Right now I&#39;m trying to turn all these entered data into an excel &quot;database&quot; so later I could spruce up some VBA GUI data entry Form that could update the &quot;database&quot; later on and just use that database to quickly pull information from previous entries"}, {"owner": {"reputation": 60, "user_id": 668129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2002f9aaabe65ed0502427c6761060d?s=128&d=identicon&r=PG", "display_name": "nestalgia", "link": "https://stackoverflow.com/users/668129/nestalgia"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577507038, "post_id": 59507832, "comment_id": 105188748, "body": "@braX , I&#39;ve only tried the Advanced Filter method so far but I&#39;m still trying it out. I have a feeling that there is probably a way easier way to do this but I&#39;m not really sure what to search for"}, {"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577507205, "post_id": 59507832, "comment_id": 105188764, "body": "I see. Well, when you have code you need help with, you can come back and ask some specific questions about it. Questions like this are out of scope for Stack Overflow."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1577508817, "post_id": 59507832, "comment_id": 105188985, "body": "@brax just because the Q isn&#39;t about debugging existing code doesn&#39;t automatically make it off topic."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1577509046, "post_id": 59507832, "comment_id": 105189020, "body": "@nostalgia there are many ways to approach this. One would be to copy the entire tables from each source sheet, then use Remove Duplicates (that may have been added to Excel after 2003, so you may have to code a version yourself)."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 1, "creation_date": 1577510245, "post_id": 59507832, "comment_id": 105189183, "body": "@brax <a href=\"https://meta.stackoverflow.com/a/392433/445425\">here&#39;s a better explanation of why Q&#39;s like this are ok</a>"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1577518376, "post_id": 59507832, "comment_id": 105190250, "body": "You can record a macro while performing your task.                                                                                                                <code>1st</code> _ Select the Developer Tab <code>2nd</code> _ Select Record Macro     <code>Step A _ Add a blank worksheet     </code>Step B _ Copy all data from each worksheet and paste to the new Worksheet directly below the previous copied data     <code>Step C _ Select all columns on the new worksheet - Select the Data Tab _ Select Remove Duplicates </code>3rd` _ Select <code>Stop Recording</code> _ Select <code>Macro</code> _ Select <code>Macro1</code> and clean it up."}], "answers": [{"comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1577533423, "post_id": 59509151, "comment_id": 105193107, "body": "I don&#39;t think the <code>Range.RemoveDuplicates</code> method appeared until Excel 2007. <i>(I know the Excel method did not)</i>.  If that is the case, you can code a method using the Collection or Dictionary object."}, {"owner": {"reputation": 60, "user_id": 668129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2002f9aaabe65ed0502427c6761060d?s=128&d=identicon&r=PG", "display_name": "nestalgia", "link": "https://stackoverflow.com/users/668129/nestalgia"}, "edited": false, "score": 0, "creation_date": 1577554940, "post_id": 59509151, "comment_id": 105198420, "body": "I think this might be it, I will try tomorrow. @RonRosenfield , okay thanks for the heads up, I&#39;m willing to install 2007 or use another PC just to do that ."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1577636097, "post_id": 59509151, "comment_id": 105213095, "body": "@RonRosenfeld ah yes, I will give another option for xl&#39;03"}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": true, "score": 1, "last_activity_date": 1577520199, "creation_date": 1577520199, "answer_id": 59509151, "question_id": 59507832, "link": "https://stackoverflow.com/questions/59507832/how-can-i-make-a-new-excel-sheet-containing-unique-individual-id-and-credentials/59509151#59509151", "title": "How can I make a new Excel sheet containing unique individual ID and credentials based on multiple sheet records?", "body": "<p>Add a sheet and Name it Combine</p>\n\n<p>You can loop through the sheets and send the data to sheets(\"Combine\").\nThen remove the duplicates base on column A</p>\n\n<pre><code>Sub GetStuff()\n    Dim ws As Worksheet, sh As Worksheet\n\n    Set ws = Sheets(\"Combine\")\n\n    For Each sh In Sheets\n        If sh.Name &lt;&gt; ws.Name Then\n            With sh\n                .Range(\"A2:D\" &amp; .Cells(.Rows.Count, 1).End(xlUp).Row).Copy _\n                        ws.Cells(ws.Rows.Count, 1).End(xlUp).Offset(1)\n            End With\n        End If\n    Next sh\n\n    ws.Columns(\"A:D\").RemoveDuplicates Columns:=1, Header:=xlYes\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 668129, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d2002f9aaabe65ed0502427c6761060d?s=128&d=identicon&r=PG", "display_name": "nestalgia", "link": "https://stackoverflow.com/users/668129/nestalgia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 59509151, "answer_count": 1, "score": 0, "last_activity_date": 1577520199, "creation_date": 1577502974, "last_edit_date": 1577503214, "question_id": 59507832, "link": "https://stackoverflow.com/questions/59507832/how-can-i-make-a-new-excel-sheet-containing-unique-individual-id-and-credentials", "title": "How can I make a new Excel sheet containing unique individual ID and credentials based on multiple sheet records?", "body": "<p>The computer in my office uses Windows 7 and Microsoft Office 2003(Excel 2003)</p>\n\n<p>Say for example I have the table below in a sheet named JANUARY</p>\n\n<p><a href=\"https://i.stack.imgur.com/IDwIW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/IDwIW.png\" alt=\"JANUARY\"></a></p>\n\n<p>and another named FEBRUARY.</p>\n\n<p><a href=\"https://i.stack.imgur.com/57vIV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/57vIV.png\" alt=\"FEBRUARY\"></a></p>\n\n<p>How can I make a \"database\" of these people?\nSomething like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/KBwRO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KBwRO.png\" alt=\"result\"></a></p>\n\n<p>What I have tried was the Data - > Filter - > Advanced Filter method to copy only the the unique ones into another sheet but it doesn't even seem to work even on a simple test data</p>\n"}, {"tags": ["javascript", "vba", "ms-access", "leaflet", "geojson"], "comments": [{"owner": {"reputation": 1066, "user_id": 6566741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d4e290cef80d739bcf148e397d637af?s=128&d=identicon&r=PG", "display_name": "Rene", "link": "https://stackoverflow.com/users/6566741/rene"}, "edited": false, "score": 0, "creation_date": 1577683075, "post_id": 59507269, "comment_id": 105222707, "body": "Have a look at MapServer: <a href=\"https://mapserver.org/input/vector/pgeo.html\" rel=\"nofollow noreferrer\">ESRI Personal Geodatabase (MDB) \u2014 MapServer 7.4.3 documentation</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2453, "user_id": 1853243, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ka9z.jpg?s=128&g=1", "display_name": "Sreeram Nair", "link": "https://stackoverflow.com/users/1853243/sreeram-nair"}, "is_accepted": false, "score": 1, "last_activity_date": 1577695144, "creation_date": 1577695144, "answer_id": 59527881, "question_id": 59507269, "link": "https://stackoverflow.com/questions/59507269/html-map-that-reads-from-personal-geodatabase/59527881#59527881", "title": "HTML Map that Reads from Personal Geodatabase", "body": "<p><a href=\"http://www.manifold.net/\" rel=\"nofollow noreferrer\">Manifold</a>'s Export  capability can convert an entire ESRI personal geodatabase into a .map or .mxb project in a single step.</p>\n\n<p>Also, we have <a href=\"http://wpfsharpmapcontrols.codeplex.com/\" rel=\"nofollow noreferrer\">WPF SharpMap</a> Controls, which is a set of WPF mapping controls which is a .Net control which you can explore to convert. </p>\n\n<p>I have not tried these yet, but I just thought of giving you some ideas. Meanwhile I will also explore.</p>\n"}], "owner": {"reputation": 167, "user_id": 5712506, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/93977cba096188b080ea40470bd08373?s=128&d=identicon&r=PG&f=1", "display_name": "AlphaKevy", "link": "https://stackoverflow.com/users/5712506/alphakevy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "closed_date": 1577716100, "answer_count": 1, "score": -2, "last_activity_date": 1593644346, "creation_date": 1577493486, "last_edit_date": 1593644346, "question_id": 59507269, "link": "https://stackoverflow.com/questions/59507269/html-map-that-reads-from-personal-geodatabase", "closed_reason": "Needs more focus", "title": "HTML Map that Reads from Personal Geodatabase", "body": "<p>I am looking for solutions on how to possibly load polygon data from an ESRI Personal Geodatabase (.mdb) to an HTML map?</p>\n\n<p><strong><em>Goal</em></strong></p>\n\n<p>To load a Map within a web-browser.  The map to display polygons that are read from a personal geodatabase.  This map will then be embedded into a Microsoft Access Form for the user to interact with through the web-browser.</p>\n\n<p><strong>Options I have Explored:</strong></p>\n\n<p><strong><em>Google Maps:</em></strong> </p>\n\n<p>I have looked at using google maps that reads a kml/kmz file with the polygon information from the geodatabase, but this requires me to update the kml/kmz each time a new polygon is entered. A more automated solution would be preferable.</p>\n\n<p><strong><em>Leaflet</em></strong></p>\n\n<p>Having researched leaflet, it appears that it is possible to load a map from a file geodatabase, but not a personal geodatabase.  Unfortunately, I am handcuffed by the personal geodatabase in this particular scenario (many users, multiple geodatabases, and Microsoft Access forms)</p>\n\n<p><strong><em>ArcGIS Online</em></strong></p>\n\n<p>Is it possible to have arcGIS online read from a local file each time it is opened.  I realize ArcGIS online requires a zip file, but I could automate the compression of a document. Any suggestions regarding the direction I should take this would be greatly appreciated.</p>\n\n<p>Thank you for taking the time to read my problem, and providing feedback.  I really appreciate it.</p>\n\n<p>Kev</p>\n"}, {"tags": ["sql", "vba", "ms-access"], "comments": [{"owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "edited": false, "score": 3, "creation_date": 1577485682, "post_id": 59506570, "comment_id": 105185821, "body": "SQL is a string and you assign 2 values to it one after the other. When you execute DoCmd.RunSQL SQL it contains the last value that you have assigned to it."}, {"owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "edited": false, "score": 0, "creation_date": 1577486428, "post_id": 59506570, "comment_id": 105185983, "body": "Who can answer this: where is the <b>typo</b> or the <b>problem that can&#39;t be reproduced</b> in this question?"}], "answers": [{"tags": [], "owner": {"reputation": 114574, "user_id": 10498828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1360dd652f1e970ba098d1d5b63c14d?s=128&d=identicon&r=PG&f=1", "display_name": "forpas", "link": "https://stackoverflow.com/users/10498828/forpas"}, "is_accepted": false, "score": 2, "last_activity_date": 1577485933, "creation_date": 1577485933, "answer_id": 59506629, "question_id": 59506570, "link": "https://stackoverflow.com/questions/59506570/update-statement-in-sql-half-working-half-not-doing-anything/59506629#59506629", "title": "UPDATE statement in SQL half working half not doing anything", "body": "<p><code>SQL</code> is a string and you assign 2 values to it one after the other. When you execute <code>DoCmd.RunSQL SQL</code> it contains the last value that you have assigned to it.<br/>\nExecute each statement separately:</p>\n\n<pre><code>SQL = \"UPDATE tblFlightRecords SET strLand = '\" &amp; Me.strStopTime &amp; \"' WHERE strWorkingRecord = TRUE\"\nDoCmd.RunSQL SQL\nSQL = \"UPDATE tblFlightRecords SET strWorkingRecord = FALSE WHERE strWorkingRecord = TRUE\"\nDoCmd.RunSQL SQL\n</code></pre>\n\n<p>Or you can do it in 1 statement like this:</p>\n\n<pre><code>SQL = \"UPDATE tblFlightRecords SET strLand = '\" &amp; Me.strStopTime &amp; \"', strWorkingRecord = FALSE WHERE strWorkingRecord = TRUE\"\nDoCmd.RunSQL SQL\n</code></pre>\n\n<p>Also the <code>VALUES</code> clause in an <code>UPDATE</code> statement is wrong. You can use it only in an <code>INSERT</code> statement.</p>\n"}], "owner": {"reputation": 19, "user_id": 12569770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa1bf7179372850c942c26c85fcf647e?s=128&d=identicon&r=PG&f=1", "display_name": "Cam ", "link": "https://stackoverflow.com/users/12569770/cam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1577486177, "answer_count": 1, "score": 0, "last_activity_date": 1577486319, "creation_date": 1577485412, "last_edit_date": 1577486319, "question_id": 59506570, "link": "https://stackoverflow.com/questions/59506570/update-statement-in-sql-half-working-half-not-doing-anything", "closed_reason": "Not suitable for this site", "title": "UPDATE statement in SQL half working half not doing anything", "body": "<p>So I can't for the life of me figure out what the heck I'm doing wrong.  The words, A LOT, comes to mind.  But right now I have got half of the <code>UPDATE</code> to work but can't get the rest of it to work.</p>\n\n<pre><code>DoCmd.SetWarnings True\n\nIf Me.butCompleteFlight.Value = True Then\n    SQL = \"UPDATE tblFlightRecords SET strLand = values('\" &amp; Me.strStopTime &amp; \"') WHERE strWorkingRecord = TRUE\"\n    SQL = \"UPDATE tblFlightRecords SET strWorkingRecord = FALSE WHERE strWorkingRecord = TRUE\"\n    DoCmd.RunSQL SQL\n\nEnd If\n\nDoCmd.SetWarnings True\n</code></pre>\n\n<p>the strWorkingRecord switching from <code>TRUE</code> to <code>FALSE</code> works.  The issue I'm having is the strLand is not populating, I used the same syntax as the <code>INSERT</code> sql that I used in a different section of the database but can't find out what I'm messing up on this one.</p>\n\n<p>Thanks</p>\n"}]