[{"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1520465366, "creation_date": 1520465366, "answer_id": 49162987, "question_id": 49162633, "link": "https://stackoverflow.com/questions/49162633/copy-multiple-label-and-textbox-in-excel-vb/49162987#49162987", "title": "Copy Multiple label and textbox in excel vb", "body": "<p>The following macro allows you to send a string of text to the clipboard:</p>\n\n<pre><code>Sub CopyText(Text As String)\n    'VBA Macro using late binding to copy text to clipboard.\n    'By Justin Kay, 8/15/2014\n    Dim MSForms_DataObject As Object\n    Set MSForms_DataObject = CreateObject(\"new:{1C3B4210-F441-11CE-B9EA-00AA006B1A69}\")\n    MSForms_DataObject.SetText Text\n    MSForms_DataObject.PutInClipboard\n    Set MSForms_DataObject = Nothing\nEnd Sub\n</code></pre>\n\n<p>Disclaimer: this is not mine, but it comes from <a href=\"https://stackoverflow.com/a/25336423/3111149\">this answer</a>.</p>\n\n<p>Once you have added this macro to your project, your Copy Button's code should look something like this: </p>\n\n<pre><code>Private Sub CommandButton3_Click()  &lt;--COPY button\n\n    Dim stringToCopy As String\n    stringToCopy = Label1.Text &amp; \": \" &amp; TextBox1.Text &amp; vbNewLine\n    stringToCopy = stringToCopy &amp; Label2.Text &amp; \": \" &amp; TextBox2.Text &amp; vbNewLine\n    'etc.\n\n    'then you send this string to the clipboard:\n    CopyText stringToCopy\n\nEnd Sub\n</code></pre>\n\n<p>Your clipboard now contains your string that you can paste anywhere in your computer.</p>\n"}], "owner": {"reputation": 1, "user_id": 9458340, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Mr.Willing2Learn", "link": "https://stackoverflow.com/users/9458340/mr-willing2learn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 665, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520482053, "creation_date": 1520463510, "last_edit_date": 1531164843, "question_id": 49162633, "link": "https://stackoverflow.com/questions/49162633/copy-multiple-label-and-textbox-in-excel-vb", "title": "Copy Multiple label and textbox in excel vb", "body": "<p>My problem is the copy button I honestly do not know where to start I tried google but with no results, I know it is a messed up codes but please bear with me. Some of the codes I just copied from the internet like the message box, I hope to make the Copy button replicate the Ctrl+C and when I Ctrl+V to notepad all will show. You can check the image that I have posted.</p>\n\n<p><img src=\"https://i.stack.imgur.com/sNWwo.png\" alt=\"Userform\"></p>\n\n<p><br>\nHere is my code:</p>\n\n<pre><code>Private Sub CommandButton2_Click()\n\nAnswer = MsgBox(\"Are you sure you want to continue?\", vbYesNoCancel + vbInformation, \"Application Message\")\n\nIf Answer = vbYes Then Else Exit Sub\n\n    TextBox1.Text = \"\"\n    TextBox2.Text = \"\"\n    TextBox3.Text = \"\"\n    TextBox4.Text = \"\"\n    TextBox5.Text = \"\"\n    TextBox6.Text = \"\"\n    TextBox7.Text = \"\"\n    TextBox8.Text = \"\"\n    TextBox9.Text = \"\"\n    TextBox10.Text = \"\"\n    TextBox11.Text = \"\"\n---------------------------------------\nPrivate Sub CommandButton3_Click()  &lt;--COPY button\n\nLabel1.text&amp;\"\"&amp;TextBox1.text Select\nLabel2.text&amp;\"\"&amp;TextBox2.text Select\nand so forth\nSelect.Copy\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "solver"], "comments": [{"owner": {"reputation": 1, "user_id": 9459245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9554e9ccfb5eac841158939837d0b2f?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleApple22", "link": "https://stackoverflow.com/users/9459245/doubleapple22"}, "edited": false, "score": 0, "creation_date": 1520463540, "post_id": 49162484, "comment_id": 85330964, "body": "As further information and an after-thought that may influence the problem, I&#39;ve run into this same problem on two separate PCs but both were running Microsoft Office 365. Despite having installed the typical array of files/folders, might this be influencing the success of the Solver pairing?"}, {"owner": {"reputation": 1, "user_id": 9459245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9554e9ccfb5eac841158939837d0b2f?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleApple22", "link": "https://stackoverflow.com/users/9459245/doubleapple22"}, "edited": false, "score": 0, "creation_date": 1520528205, "post_id": 49162484, "comment_id": 85362282, "body": "Also realizing now that I&#39;ve been attempting to write this using .NET despite the majority of the results giving direction for VBA."}], "owner": {"reputation": 1, "user_id": 9459245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9554e9ccfb5eac841158939837d0b2f?s=128&d=identicon&r=PG&f=1", "display_name": "DoubleApple22", "link": "https://stackoverflow.com/users/9459245/doubleapple22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 346, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520462782, "creation_date": 1520462782, "question_id": 49162484, "link": "https://stackoverflow.com/questions/49162484/a-reference-to-c-solver32-dll-could-not-be-added-please-make-sure-that-the-f", "title": "A reference to &#39;C:\\Solver32.DLL&#39; could not be added. Please make sure that the file is accessible, and that it is a valid assembly or COM component", "body": "<p>Still green when it comes to programming, so bear with me. I'm currently trying to create a program in Visual Studio 2017 (VB.NET) intended to make modifications to a paired Excel spreadsheet using the Solver add-on. I've successfully created a reference for the Excel reference library but am unable to do so for the Solver reference library. I've tried creating references for both SOLVER32.DLL and SOLVER.XLAM, but both produce the same general error message:</p>\n\n<p>\"A reference to 'C:\\xxxx.(DLL/XLAM)' could not be added. Please make sure that the file is accessible, and that it is a valid assembly or COM component.\"</p>\n\n<p>I've browsed for hours looking for viable solutions, some of which seem to suggest repackaging the .DLL file (use of TlbImp.exe) through use of CMD and Native Tools CMD for VS (run as Admin), but that hasn't generated success (generated following error: \"The input file 'C:\\xxxx.DLL' is not a valid type library.\") Some of the posts I've read on linking the Solver suggest the .XLAM file is specifically what needs to be used, but that hasn't generated any success, either.</p>\n\n<p>I've reinstalled Microsoft Office (both x32-bit and x64-bit), reinstalled Solver multiple times, completely closed and reopened Excel with each Solver reinstall.</p>\n\n<p>If it should help, I'm using an updated version of Microsoft Excel 2016 (now x64-bit) and running Windows 10 (also x64-bit, of course). The file path for Solver is MicrosoftOffice\\root\\Office16\\Library\\Solver. I've tried linking the files while Excel is open as well as when it is closed.</p>\n\n<p>I've tried switching gears and using Solver Foundations instead (for which I can successfully create a reference), but there doesn't seem to be a compatible command for my project (or at least one I can wrap my head around; I'm looking for the equivalent of 'SolverOK.'</p>\n\n<p>Any help here would be greatly appreciated -- starting to lose my mind over this!</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 333, "user_id": 3393081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p0WfA.jpg?s=128&g=1", "display_name": "MrDogme", "link": "https://stackoverflow.com/users/3393081/mrdogme"}, "edited": false, "score": 0, "creation_date": 1520460139, "post_id": 49161852, "comment_id": 85329566, "body": "If I understood well, you wish that cells could contain both a hyperlink formula and a value. Am I correct ?"}, {"owner": {"reputation": 87, "user_id": 6829442, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/n7uwS.jpg?s=128&g=1", "display_name": "Kishanu Bhattacharya", "link": "https://stackoverflow.com/users/6829442/kishanu-bhattacharya"}, "reply_to_user": {"reputation": 333, "user_id": 3393081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p0WfA.jpg?s=128&g=1", "display_name": "MrDogme", "link": "https://stackoverflow.com/users/3393081/mrdogme"}, "edited": false, "score": 0, "creation_date": 1520460292, "post_id": 49161852, "comment_id": 85329629, "body": "Yes, you are right"}, {"owner": {"reputation": 333, "user_id": 3393081, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p0WfA.jpg?s=128&g=1", "display_name": "MrDogme", "link": "https://stackoverflow.com/users/3393081/mrdogme"}, "edited": false, "score": 0, "creation_date": 1520461168, "post_id": 49161852, "comment_id": 85329991, "body": "Well I tought you could not. BUT you can, as long as you can nest the value (or the equation/formula producing this value) into the friendly name. Without quotes."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1520461412, "post_id": 49161852, "comment_id": 85330111, "body": "do you mean something like <code>=HYPERLINK(&quot;#&#39;&quot;&amp;A2&amp;&quot;&#39;!A2&quot;,&quot;Link to &quot;&amp;A2)</code>"}, {"owner": {"reputation": 87, "user_id": 6829442, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/n7uwS.jpg?s=128&g=1", "display_name": "Kishanu Bhattacharya", "link": "https://stackoverflow.com/users/6829442/kishanu-bhattacharya"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 1, "creation_date": 1520461720, "post_id": 49161852, "comment_id": 85330227, "body": "@chrisneilsen Exactly what I ended up doing now. Thanks! Additionally, we have to turn on the iterative calculation from File-&gt;Options-&gt;Formula-&gt;Check the box having label Enable iterative calculation so that it can understand it&#39;s a circular reference."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1520475576, "post_id": 49161852, "comment_id": 85334204, "body": "@chrisneilsen Either you or the OP can post that as answer to guide others that might stumble on this exact same issue :)"}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 1, "last_activity_date": 1520476898, "last_edit_date": 1520476898, "creation_date": 1520476572, "answer_id": 49164479, "question_id": 49161852, "link": "https://stackoverflow.com/questions/49161852/creating-hyperlink-to-a-sheet-using-excel-formulas/49164479#49164479", "title": "Creating hyperlink to a sheet using excel formulas", "body": "<p>Although, I think it is worth considering VBA too (since you included that tag in your original question).</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    On Error GoTo restoreevents\n    Application.EnableEvents = False\n\n    Dim sn As String: Const hf As String = \"=HYPERLINK(\"\"#'{ref}'!A2\"\",\"\"{ref}\"\")\"\n    With Me\n        If Not Intersect(Target, .Range(\"A2:A4\")) Is Nothing _\n        And Len(Target.Value2) &lt;&gt; 0 Then\n            sn = Target.Value2\n            Application.Undo\n            Target.Formula = Replace(hf, \"{ref}\", sn)\n        End If\n    End With\n\nrestoreevents:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n\n<p>Above code will hyperlink using formula once you type the Sheet name on the target ranges.</p>\n"}], "owner": {"reputation": 87, "user_id": 6829442, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/n7uwS.jpg?s=128&g=1", "display_name": "Kishanu Bhattacharya", "link": "https://stackoverflow.com/users/6829442/kishanu-bhattacharya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520476898, "creation_date": 1520459651, "last_edit_date": 1531161705, "question_id": 49161852, "link": "https://stackoverflow.com/questions/49161852/creating-hyperlink-to-a-sheet-using-excel-formulas", "title": "Creating hyperlink to a sheet using excel formulas", "body": "<p>I have a column which has values A, B, and C in a Sheet called <em>Demo</em>. There are other three sheets with the same name as the column values. I want to create a hyperlink using excel formula which would refer to the sheets A, B, and C.\nI tried with this <code>=HYPERLINK(\"#'\"&amp;A2&amp;\"'!A2\",\"Link\")</code>\nBut this would have another column which will have a friendly name as Link.\nIs it possible to refer to the same values without using any other column in Sheet Demo?</p>\n"}, {"tags": ["vba", "checkbox", "ms-word", "userform", "bookmarks"], "answers": [{"tags": [], "owner": {"reputation": 5, "user_id": 9375422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd5d9f2be63e168870fe65ca5c21796?s=128&d=identicon&r=PG&f=1", "display_name": "NewOrleanTaints", "link": "https://stackoverflow.com/users/9375422/neworleantaints"}, "is_accepted": true, "score": 0, "last_activity_date": 1520543679, "last_edit_date": 1520543679, "creation_date": 1520543253, "answer_id": 49182464, "question_id": 49161712, "link": "https://stackoverflow.com/questions/49161712/delete-previous-text-in-bookmark-range-after-userform-update-vba-microsoft-word/49182464#49182464", "title": "Delete previous text in bookmark range after userform update VBA Microsoft Word", "body": "<p>I figured out what I did at the end of my If...Elseif statements the last code that was to nullify the previous text was set as Elseif instead of Else </p>\n\n<p>Below is the code that worked </p>\n\n<pre><code>Dim Bookmark1 As Range\nIf Me.CheckBox1.Value And Me.CheckBox2 And Me.CheckBox3 =.       True Then\nSet Bookmark1 = ActiveDocument.Bookmarks(\"Bookmark1\").Range\nBookmark1.Text = \"You have selected Apples, Oranges, and Bananas.\"\nActiveDocument.Bookmarks.Add \"Bookmark1\", Bookmark1\nElseIf Me.CheckBox1.Value And Me.CheckBox2 = True Then\nSet Bookmark1 = ActiveDocument.Bookmarks(\"Bookmark1\").Range\nBookmark1.Text = \"You have selected Apples and Bananas.\"\nActiveDocument.Bookmarks.Add \"Bookmark1\", Bookmark1\nElse Set Bookmark1 = ActiveDocument.Bookmarks(\"Bookmark1\").Range\nBookmark1.Text = \"\"\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9375422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dd5d9f2be63e168870fe65ca5c21796?s=128&d=identicon&r=PG&f=1", "display_name": "NewOrleanTaints", "link": "https://stackoverflow.com/users/9375422/neworleantaints"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 508, "favorite_count": 1, "accepted_answer_id": 49182464, "answer_count": 1, "score": 0, "last_activity_date": 1593731422, "creation_date": 1520459013, "last_edit_date": 1593731422, "question_id": 49161712, "link": "https://stackoverflow.com/questions/49161712/delete-previous-text-in-bookmark-range-after-userform-update-vba-microsoft-word", "title": "Delete previous text in bookmark range after userform update VBA Microsoft Word", "body": "<p>I am working on a VBA Microsoft Word template. I built a userform with various checkboxes, textboxes, and optionboxes. I have a procedure where after filling out the userform the user can open the userform again to change an option and the new option replaces the previous option. The following code is involving three different checkboxes and depending on the selected combination of boxes a sentence will appear. So far everything is working properly but what I am trying to figure out is if the user deselected all of the checkboxes the template will replace the previous text in the bookmark range with nothing. Below is a sample of the code that goes through the procedure.</p>\n\n<pre><code>Dim Bookmark1 As Range\nIf Me.CheckBox1.Value And Me.CheckBox2 And Me.CheckBox3 = True Then\n    Set Bookmark1 = ActiveDocument.Bookmarks(\"Bookmark1\").Range\n    Bookmark1.Text = \"You have selected Apples, Oranges, and Bananas.\"\n    ActiveDocument.Bookmarks.Add \"Bookmark1\", Bookmark1\nElseIf Me.CheckBox1.Value And Me.CheckBox2 = True Then\n    Set Bookmark1 = ActiveDocument.Bookmarks(\"Bookmark1\").Range\n    Bookmark1.Text = \"You have selected Apples and Bananas.\"\n    ActiveDocument.Bookmarks.Add \"Bookmark1\", Bookmark1\n</code></pre>\n\n<p>ect until every combination is displayed except if the user deselects every checkbox. I've tried the making an if statement if all three boxes are false then txt equals \"\"</p>\n\n<p>I've also tried equals null and still did not work any help is greatly appreciated.</p>\n\n<p>While you're reading this if you happen to know great. \nI want to assign a shortcut key to data entered into a textbox in the userform so that while typing a user can simply select Ctrl Shift C to enter the value of a textbox where their cursor is in the word document. Any help with this would be awesome thank you!</p>\n"}, {"tags": ["excel", "time", "excel-formula", "date-difference", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1520457951, "post_id": 49161434, "comment_id": 85328562, "body": "Do you have your schedule in the spreadsheet?"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 0, "creation_date": 1520458059, "post_id": 49161434, "comment_id": 85328612, "body": "You should search on here before posting - there are several questions about this type of problem already answered..."}, {"owner": {"reputation": 191, "user_id": 1714724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bY74u.gif?s=128&g=1", "display_name": "grahamie", "link": "https://stackoverflow.com/users/1714724/grahamie"}, "edited": false, "score": 0, "creation_date": 1520458163, "post_id": 49161434, "comment_id": 85328677, "body": "Schedule can be in a spreadsheet if needed. Can be on a separate tab"}, {"owner": {"reputation": 191, "user_id": 1714724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bY74u.gif?s=128&g=1", "display_name": "grahamie", "link": "https://stackoverflow.com/users/1714724/grahamie"}, "edited": false, "score": 0, "creation_date": 1520458206, "post_id": 49161434, "comment_id": 85328697, "body": "SOLAR MIKE - i did search. could not find the answer. if you know where it is it would be helpful if you point me there please"}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1520458871, "post_id": 49161434, "comment_id": 85329011, "body": "One : <a href=\"https://stackoverflow.com/q/49108195/4961700\">stackoverflow.com/q/49108195/4961700</a> , Two : <a href=\"https://stackoverflow.com/q/46214721/4961700\">stackoverflow.com/q/46214721/4961700</a> , Three : <a href=\"https://stackoverflow.com/q/21276792/4961700\">stackoverflow.com/q/21276792/4961700</a> , any of these may give you either the answer you need or a hint... Didn&#39;t take long to find..."}, {"owner": {"reputation": 3907, "user_id": 4961700, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f80e4233c80b9ba42b3b39cf704804dc?s=128&d=identicon&r=PG&f=1", "display_name": "Solar Mike", "link": "https://stackoverflow.com/users/4961700/solar-mike"}, "edited": false, "score": 1, "creation_date": 1520458919, "post_id": 49161434, "comment_id": 85329036, "body": "And don&#39;t shout at me..."}, {"owner": {"reputation": 191, "user_id": 1714724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bY74u.gif?s=128&g=1", "display_name": "grahamie", "link": "https://stackoverflow.com/users/1714724/grahamie"}, "edited": false, "score": 0, "creation_date": 1520459354, "post_id": 49161434, "comment_id": 85329232, "body": "Apologies Solar Mike  Shouting unintentional. Although 3 examples are given, not one actually answers my question. I could also give you links to posts that Aren&#39;t the answer."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 4, "creation_date": 1520459491, "post_id": 49161434, "comment_id": 85329293, "body": "you give no data, no code, no formulas, no references to research..... links to post that aren&#39;t the answer would be at least 1 thing."}, {"owner": {"reputation": 191, "user_id": 1714724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bY74u.gif?s=128&g=1", "display_name": "grahamie", "link": "https://stackoverflow.com/users/1714724/grahamie"}, "edited": false, "score": 0, "creation_date": 1520459571, "post_id": 49161434, "comment_id": 85329328, "body": "I don&#39;t have formulas to show (this is the help i am looking for) and the data is in the description"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1520459590, "post_id": 49161434, "comment_id": 85329340, "body": "to which I respond <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>"}, {"owner": {"reputation": 191, "user_id": 1714724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bY74u.gif?s=128&g=1", "display_name": "grahamie", "link": "https://stackoverflow.com/users/1714724/grahamie"}, "edited": false, "score": 0, "creation_date": 1520459718, "post_id": 49161434, "comment_id": 85329386, "body": "to which i respond Thanks....... i&#39;ll  know for next time."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1520460132, "post_id": 49161434, "comment_id": 85329564, "body": "@grahamie - <b>Welcome to <a href=\"https://stackoverflow.com\">Stack Overflow</a>!</b>  You might have the wrong idea about this site; <a href=\"https://stackoverflow.com\">Stack Overflow</a> is a place for professional <i>(or enthusiast)</i> programmers to share advice about <b><i>unique</i></b> software development problems whose solution can&#39;t be found elsewhere. S.O. Questions should have source code in them or at least cover a <b><i>specific programming problem</i></b>, algorithm, or software tool. <b>You&#39;re seeking a beginner&#39;s lesson in basic spreadsheet operation</b>; there are other sites &amp; tutorials online more suited to your need. Please see &quot;<a href=\"https://stackoverflow.com/help/on-topic\">help center</a>&quot; as well as &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot;."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1520460144, "post_id": 49161434, "comment_id": 85329568, "body": "@grahamie Here&#39;s a video tutorial from Microsoft that will help you find the answers that you&#39;re seeking: <a href=\"https://support.office.com/en-us/article/learn-the-basics-of-excel-formulas-with-excelisfun-videos-on-youtube-13e2154a-cec9-42ca-adbc-0d470f6fe3be?CorrelationId=78c2bd7a-2e19-4ee4-9528-76f2b04736c5\" rel=\"nofollow noreferrer\">Learn the basics of Excel formulas with videos on YouTube</a>.  To start your formula off, you can calculate hours between two times like <code>( [End DateTime] - [Start DateTime] ) * 24</code>   <b><i>Good luck!</i></b>"}, {"owner": {"reputation": 191, "user_id": 1714724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bY74u.gif?s=128&g=1", "display_name": "grahamie", "link": "https://stackoverflow.com/users/1714724/grahamie"}, "edited": false, "score": 0, "creation_date": 1520460301, "post_id": 49161434, "comment_id": 85329632, "body": "Thankyou Ashleedawg i will watch and hopefully it will help. i can already calculate the hours between two date/times but need to remove the &quot;out of hours&quot; times. i have searched and searched for an answer to this issue everywhere which is why i have tried to find help here. i dont feel this is a basic spreadsheet operation"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1520460827, "post_id": 49161434, "comment_id": 85329856, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/21276792/calculate-working-days-and-time-between-two-days-in-excel\">Calculate Working days and time between two days in excel</a>"}, {"owner": {"reputation": 191, "user_id": 1714724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bY74u.gif?s=128&g=1", "display_name": "grahamie", "link": "https://stackoverflow.com/users/1714724/grahamie"}, "edited": false, "score": 0, "creation_date": 1520460949, "post_id": 49161434, "comment_id": 85329900, "body": "no quite, i need to include Saturday as a partial work day"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 1, "creation_date": 1520461108, "post_id": 49161434, "comment_id": 85329964, "body": "Then you need to calculate how many whole-Saturdays between the dates, and multiply that by 4 hours.  <a href=\"https://stackoverflow.com/questions/36740329/how-to-calculate-total-fridays-between-two-dates-in-excel-on-weekly-biweekly-an?rq=1\">This may help</a>"}], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 1714724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bY74u.gif?s=128&g=1", "display_name": "grahamie", "link": "https://stackoverflow.com/users/1714724/grahamie"}, "edited": false, "score": 0, "creation_date": 1520461529, "post_id": 49162088, "comment_id": 85330159, "body": "Thank you. This works. I will need to make a tweak or two but this is the job !"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 191, "user_id": 1714724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bY74u.gif?s=128&g=1", "display_name": "grahamie", "link": "https://stackoverflow.com/users/1714724/grahamie"}, "edited": false, "score": 0, "creation_date": 1520542613, "post_id": 49162088, "comment_id": 85370244, "body": "what do you mean it doesn&#39;t work?  wrong value,errors...?"}, {"owner": {"reputation": 191, "user_id": 1714724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bY74u.gif?s=128&g=1", "display_name": "grahamie", "link": "https://stackoverflow.com/users/1714724/grahamie"}, "edited": false, "score": 0, "creation_date": 1520544092, "post_id": 49162088, "comment_id": 85370962, "body": "Sorry - trying to post a picture to show. if i do the first method and sum, I get 3.6 if i do the one liner i get -20.3"}, {"owner": {"reputation": 191, "user_id": 1714724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bY74u.gif?s=128&g=1", "display_name": "grahamie", "link": "https://stackoverflow.com/users/1714724/grahamie"}, "edited": false, "score": 0, "creation_date": 1520544271, "post_id": 49162088, "comment_id": 85371065, "body": "Picture in the original post"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1520547485, "last_edit_date": 1520547485, "creation_date": 1520460939, "answer_id": 49162088, "question_id": 49161434, "link": "https://stackoverflow.com/questions/49161434/how-to-calculate-time-difference-in-excel-working-hours-only/49162088#49162088", "title": "how to calculate time difference in excel working hours only", "body": "<p>You will need a helper column with this formula:</p>\n\n<pre><code>=24*(SUMPRODUCT((TEXT(ROW(INDEX(AAA:AAA,$F$1):INDEX(AAA:AAA,$F$2)),\"dddd\")=A1)*(C1-B1))-IF(TEXT($F$1,\"dddd\")=A1,MOD($F$1,1)-B1,0)-IF(TEXT($F$2,\"dddd\")=A1,C1-MOD($F$2,1),0))\n</code></pre>\n\n<p>Then sum that column.</p>\n\n<p><a href=\"https://i.stack.imgur.com/nNHQq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nNHQq.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Here it is in one formula using NETWORKDAYS.INTL</p>\n\n<pre><code>=IF(DATEDIF(F1,F2,\"d\")&gt;1,NETWORKDAYS.INTL(F1+1,F2-1,\"0000011\")*12+NETWORKDAYS.INTL(F1+1,F2-1,\"1111101\")*4,0)+IF(DATEDIF(F1,F2,\"d\")&gt;0,(MOD(F2,1)-IF(WEEKDAY(F2,2)&lt;6,TIME(7,0,0),TIME(9,0,0)))*24+(IF(WEEKDAY(F1,2)&lt;6,TIME(19,0,0),TIME(13,0,0))-MOD(F1,1))*24,(F2-F1)*24)\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/NFVDO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NFVDO.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 191, "user_id": 1714724, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/bY74u.gif?s=128&g=1", "display_name": "grahamie", "link": "https://stackoverflow.com/users/1714724/grahamie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 958, "favorite_count": 0, "accepted_answer_id": 49162088, "answer_count": 1, "score": -5, "last_activity_date": 1520547485, "creation_date": 1520457781, "last_edit_date": 1531161705, "question_id": 49161434, "link": "https://stackoverflow.com/questions/49161434/how-to-calculate-time-difference-in-excel-working-hours-only", "title": "how to calculate time difference in excel working hours only", "body": "<p>How can I calculate hours worked on a project using specific working hours that aren't the same each day? </p>\n\n<p>So Monday - Friday I work 7 am-7 pm, Saturday 9 am -1 pm and I take Sunday off (lucky me). If i start a project on the 1st March 10 am and finish on the 5th March at 9 am how can I calculate an answer of 27 hours ??</p>\n\n<p>I have two cells date/time start and date/time finish. I have multiple rows to do this to and several time points but this essentially will work the same.</p>\n\n<p>I hope makes sense.</p>\n\n<p>Edit - Solutions tried and opposing results <a href=\"https://i.stack.imgur.com/Jbig1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Jbig1.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1520456669, "post_id": 49161124, "comment_id": 85327924, "body": "&quot;I have an error&quot; is not a valid description of the problem."}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1520456687, "post_id": 49161124, "comment_id": 85327929, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/q/16017403/11683\">Maximum drop-down list/formula length in Excel</a>"}, {"owner": {"reputation": 46, "user_id": 9377599, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QF2icPrdoj0/AAAAAAAAAAI/AAAAAAAAAEw/DwgsN7u90UI/photo.jpg?sz=128", "display_name": "Luis Aguilar", "link": "https://stackoverflow.com/users/9377599/luis-aguilar"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1520457032, "post_id": 49161124, "comment_id": 85328099, "body": "is length from array, not characters (sorry), but i dont understan why happening"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1520457068, "post_id": 49161124, "comment_id": 85328121, "body": "Do you realize that <code>Join</code> creates a single string?"}, {"owner": {"reputation": 46, "user_id": 9377599, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QF2icPrdoj0/AAAAAAAAAAI/AAAAAAAAAEw/DwgsN7u90UI/photo.jpg?sz=128", "display_name": "Luis Aguilar", "link": "https://stackoverflow.com/users/9377599/luis-aguilar"}, "reply_to_user": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 0, "creation_date": 1520457195, "post_id": 49161124, "comment_id": 85328184, "body": "a single?? but I get a list of 26 words not a list of 1 word , I need to make any change?"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "edited": false, "score": 1, "creation_date": 1520457568, "post_id": 49161124, "comment_id": 85328357, "body": "When you call <code>Join(mylist1, &quot;,&quot;)</code>, what do you expect it to produce if not a single string that contains all your 26 values separated with commas? If you don&#39;t expect that to happen, then why do you call <code>Join</code>, and if you do expect it to happen, then why do you wonder that it happens? You create a string from your array, that strings ends up being too long when you add 27th element to the array."}, {"owner": {"reputation": 2840, "user_id": 5135157, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/eITOt.png?s=128&g=1", "display_name": "Absinthe", "link": "https://stackoverflow.com/users/5135157/absinthe"}, "edited": false, "score": 0, "creation_date": 1520460111, "post_id": 49161124, "comment_id": 85329554, "body": "Can you say exactly which line has the error? What does the error message say? Where do you assign the variable ws to a worksheet?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1520463261, "post_id": 49161124, "comment_id": 85330848, "body": "@Luis - further to what Absinthe asked you - you said <code>if change the size to 27 have error after save</code>.  <b>Show us.</b>  Please <a href=\"https://stackoverflow.com/posts/49161124/edit\">edit</a> your question to add a <b>screen shot of your code when it says &quot;27&quot;</b> <i>and</i> a <b>screen shot of the error you are seeing.</b>  Without this we are only guessing about your problem and we cannot help you."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1520463296, "post_id": 49161124, "comment_id": 85330865, "body": "@LuisAguilar - Also, if you feel that language is a barrier in getting your point across, have you tried <a href=\"https://es.stackoverflow.com/\">Stack Overflow en espa&#241;ol</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520500172, "post_id": 49169130, "comment_id": 85343672, "body": "nice approach. Will remember that."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 46, "user_id": 9377599, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QF2icPrdoj0/AAAAAAAAAAI/AAAAAAAAAEw/DwgsN7u90UI/photo.jpg?sz=128", "display_name": "Luis Aguilar", "link": "https://stackoverflow.com/users/9377599/luis-aguilar"}, "edited": false, "score": 0, "creation_date": 1520533252, "post_id": 49169130, "comment_id": 85365278, "body": "@LuisAguilar, you are welcome. if my answer solved your question then please consider marking it as accepted. thank you"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1520499602, "creation_date": 1520499602, "answer_id": 49169130, "question_id": 49161124, "link": "https://stackoverflow.com/questions/49161124/error-in-size-array-vba/49169130#49169130", "title": "Error in Size array VBA", "body": "<p>since the error is likely to be thrown out of too long a string, then you can turn your validation formula to reference the list range and get rid of <code>mylist1</code> array:</p>\n\n<pre><code>Dim nElements As Long\n\nnElements = 26\nWith WS.Range(\"E8\").Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n        Operator:=xlBetween, Formula1:=\"=Helper!$D$6:$D$\" &amp; 6 + nElements-1\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 46, "user_id": 9377599, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QF2icPrdoj0/AAAAAAAAAAI/AAAAAAAAAEw/DwgsN7u90UI/photo.jpg?sz=128", "display_name": "Luis Aguilar", "link": "https://stackoverflow.com/users/9377599/luis-aguilar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 49169130, "answer_count": 1, "score": -2, "last_activity_date": 1520499602, "creation_date": 1520456465, "last_edit_date": 1520456924, "question_id": 49161124, "link": "https://stackoverflow.com/questions/49161124/error-in-size-array-vba", "title": "Error in Size array VBA", "body": "<p>I'm again \nexist a error when i use array</p>\n\n<p>The maximum size that admits me from the array is 26\nWhy is this happening?</p>\n\n<p>the error is in\nModule 3\nfunction listbox\nin this line</p>\n\n<pre><code>Dim mylist1(26) As String\nFor i = 0 To 26\n    mylist1(i) = CStr(Worksheets(\"Helper\").Cells(i + 6, 4).Value)\nNext i\nWith ws.Range(\"E8:E8\").Validation\n    .Delete\n    .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n        Operator:=xlBetween, Formula1:=Join(mylist1, \",\")\nEnd With\n</code></pre>\n\n<p>I get values from a hidden sheet\nif change the size to 27 have error after save\nif you change to 27 save\nand open again, has a error</p>\n\n<p>this is file link</p>\n\n<p><a href=\"https://drive.google.com/open?id=1Uaop86I2AKpeOwORrKYUafGb67b214Bh\" rel=\"nofollow noreferrer\">https://drive.google.com/open?id=1Uaop86I2AKpeOwORrKYUafGb67b214Bh</a></p>\n\n<p>thanks</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1520456580, "post_id": 49161060, "comment_id": 85327879, "body": "You can include your code with inline markup, that will make it easier to help. But from your question it&#39;s not clear &quot;what doesn&#39;t work&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520461137, "post_id": 49161060, "comment_id": 85329977, "body": "there is no End If before End Sub"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520461150, "post_id": 49161060, "comment_id": 85329984, "body": "Also, syntax is If &lt;condition&gt; Then ...Else &lt;Condition&gt; End If . So there is another syntax error by having two lines before the Then that don&#39;t form a valid set of test conditions. And there are no line continuations _ used so I&#39;m afraid there are a lot of corrections to this code to make it run.\\"}], "answers": [{"comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520462245, "post_id": 49162254, "comment_id": 85330460, "body": "Just <a href=\"https://support.office.com/en-gb/article/assign-a-macro-to-a-form-or-a-control-button-d58edd7d-cb04-4964-bead-9c72c843a283\" rel=\"nofollow noreferrer\">Add a Button (Form Control)</a> - there was no request to link to the PivotTable_Update event, especially since running the macro would <i>trigger</i> that event!"}, {"owner": {"reputation": 39, "user_id": 9458920, "user_type": "registered", "profile_image": "https://graph.facebook.com/1278608925574546/picture?type=large", "display_name": "Karol", "link": "https://stackoverflow.com/users/9458920/karol"}, "edited": false, "score": 0, "creation_date": 1520465397, "post_id": 49162254, "comment_id": 85331606, "body": "Wow, works perfectly fine for me! I&#39;ve made button, use it for my propper data and I&#39;m so happy. Thanks!"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 39, "user_id": 9458920, "user_type": "registered", "profile_image": "https://graph.facebook.com/1278608925574546/picture?type=large", "display_name": "Karol", "link": "https://stackoverflow.com/users/9458920/karol"}, "edited": false, "score": 0, "creation_date": 1520495920, "post_id": 49162254, "comment_id": 85341181, "body": "Glad to hear it!  Please don&#39;t forget to click the &quot;Accept answer&quot; button, so that the question is removed from the &quot;unanswered&quot; list"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": true, "score": 0, "last_activity_date": 1520461685, "creation_date": 1520461685, "answer_id": 49162254, "question_id": 49161060, "link": "https://stackoverflow.com/questions/49161060/switch-pivot-table-filter-using-vba-macro-button/49162254#49162254", "title": "Switch pivot table filter using VBA macro (button)", "body": "<p>You need to have the <code>Then</code> on the same line as the <code>If</code>. (You <em>can</em> use <code>_</code> to tell VBA that \"code continues on next line\")</p>\n\n<p>You also don't have your <code>And</code> set up correctly, <strong>and</strong> you are making both \"Black\" and \"White\" visible before you check if they are visible?</p>\n\n<p>Try this:</p>\n\n<pre><code>Sub ToggleColour()\n    With ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"colour\")\n        If .PivotItems(\"white\").Visible=True Then\n            .CurrentPage = \"black\"\n        Else\n            .CurrentPage = \"white\"\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39, "user_id": 9458920, "user_type": "registered", "profile_image": "https://graph.facebook.com/1278608925574546/picture?type=large", "display_name": "Karol", "link": "https://stackoverflow.com/users/9458920/karol"}, "edited": false, "score": 0, "creation_date": 1520465237, "post_id": 49162300, "comment_id": 85331565, "body": "Thanks! Of course, I use slicers day by day, but I also want to start making macro, so that was the point."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1520461874, "creation_date": 1520461874, "answer_id": 49162300, "question_id": 49161060, "link": "https://stackoverflow.com/questions/49161060/switch-pivot-table-filter-using-vba-macro-button/49162300#49162300", "title": "Switch pivot table filter using VBA macro (button)", "body": "<p>This is what slicers are built for.</p>\n\n<p>Put your cursor inside the the pivottable data area. Then goto insert > slicer > and choose <code>colour</code>. You will then have a slicer which will allow you to select either or. I don't know if you can disable multiselect in current excel version so user could press ctrl and select both. But this seems a simple way.</p>\n\n<p>Or you could run code such as the following and then user just types in Black or White in to field and filter is applied:</p>\n\n<pre><code>Sub Test()\n\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim pvt As PivotTable\n\n    Set wb = ThisWorkbook\n    Set ws = wb.Worksheets(\"Sheet3\")\n    Set pvt = ws.PivotTables(\"PivotTable3\")\n\n    Dim pvtField As PivotField\n    Dim item As Long\n    Dim item2 As Long\n\n    Set pvtField = pvt.PivotFields(\"Colour\")\n\n    pvtField.EnableItemSelection = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9458920, "user_type": "registered", "profile_image": "https://graph.facebook.com/1278608925574546/picture?type=large", "display_name": "Karol", "link": "https://stackoverflow.com/users/9458920/karol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1510, "favorite_count": 0, "accepted_answer_id": 49162254, "answer_count": 2, "score": -2, "last_activity_date": 1521400732, "creation_date": 1520456202, "last_edit_date": 1521400732, "question_id": 49161060, "link": "https://stackoverflow.com/questions/49161060/switch-pivot-table-filter-using-vba-macro-button", "title": "Switch pivot table filter using VBA macro (button)", "body": "<p>I need help with some rather easy macro, but I can't do that. So all I want is to switch between filters - I have two possibilities, by example two colours - black and white, and I only want to have one of them in the moment (I want to add button, so it will work as switch). Here is the situation</p>\n\n<p><img src=\"https://i.stack.imgur.com/51Ors.jpg\" alt=\"pivottable\"></p>\n\n<p>I've tried did it with conditional, of course it doesn't work, but hope it will helps you to understand my idea. If one filter is enable, the other one is disabled (so the objects connected with that obviously too).</p>\n\n<pre><code>Sub Makro5()\n\nActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"colour\"). _\n    CurrentPage = \"(All)\"\n\nIf ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"colour\")\n    .PivotItems(\"black\").Visible = False\n    .PivotItems(\"white\").Visible = True\n    Then ActiveSheet.PivotTables(\"PivotTable3\").PivotFields (\"colour\")\n    .PivotItems(\"black\").Visible = True\n    .PivotItems(\"white\").Visible = False\n    Else: ActiveSheet.PivotTables(\"PivotTable3\").PivotFields (\"colour\")\n    .PivotItems(\"black\").Visible = False\n    .PivotItems(\"white\").Visible = True\n\nEnd Sub\n</code></pre>\n\n<p>Something is wrong with If, because it's on red and I get \"Complie error: Syntax error\" info</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1520455343, "post_id": 49160817, "comment_id": 85327229, "body": "<code>Can I insert such a formula?</code> not really, there are some convoluted methods using named ranges. <code>Or create event driven macro for it?</code> Yes."}], "answers": [{"tags": [], "owner": {"reputation": 32374, "user_id": 4, "user_type": "moderator", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/C5gBG.jpg?s=128&g=1", "display_name": "Joel Spolsky", "link": "https://stackoverflow.com/users/4/joel-spolsky"}, "is_accepted": false, "score": 0, "last_activity_date": 1520455944, "creation_date": 1520455944, "answer_id": 49160989, "question_id": 49160817, "link": "https://stackoverflow.com/questions/49160817/loop-through-sheets-and-particular-cells-on-sheets/49160989#49160989", "title": "Loop through sheets and particular cells on sheets", "body": "<p>I would create a macro to iterate through all the sheets and insert appropriate rows in the overview sheet.</p>\n\n<p>Iterate through sheets: <code>For Each s In ActiveWorkbook.Sheets</code></p>\n\n<p>In this loop <code>s.Name</code> will be the sheet name and it should be easy enough to create a row in the overview sheet with a formula which refers to that sheet's D21 value.</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1520456417, "last_edit_date": 1520456417, "creation_date": 1520456101, "answer_id": 49161027, "question_id": 49160817, "link": "https://stackoverflow.com/questions/49160817/loop-through-sheets-and-particular-cells-on-sheets/49161027#49161027", "title": "Loop through sheets and particular cells on sheets", "body": "<p>Put this in the worksheet code of your first sheet.</p>\n\n<pre><code>Private Sub Worksheet_Activate()\nDim i As Long\nMe.Range(\"A2:B1000\").ClearContents\nFor i = 2 To Worksheets.Count\n    Me.Cells(i, 1) = Worksheets(i).Name\n    Me.Cells(i, 2).Formula = \"='\" &amp; Worksheets(i).Name &amp; \"'!D21\"\nNext i\nEnd Sub\n</code></pre>\n\n<p>Now every time the worksheet is activate it will clear and repopulate the list with the correct formula.  It iterates the sheets and fills the cells with the name and the formula pointing at D21.</p>\n"}], "owner": {"reputation": 11451, "user_id": 653379, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f6acb0011b5fdff139c9bc99506811c1?s=128&d=identicon&r=PG", "display_name": "xralf", "link": "https://stackoverflow.com/users/653379/xralf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 49161027, "answer_count": 2, "score": 0, "last_activity_date": 1520515077, "creation_date": 1520455218, "last_edit_date": 1531161705, "question_id": 49160817, "link": "https://stackoverflow.com/questions/49160817/loop-through-sheets-and-particular-cells-on-sheets", "title": "Loop through sheets and particular cells on sheets", "body": "<p>I have an excel sheet with overview (first tab),\nthere are two columns - company_name and price\nand there are about 50 following sheets (named as individual companies).</p>\n\n<p>I'd like to generate the overview automatically.</p>\n\n<p>So when new sheet with company name is added it will be added in the\noverview (first sheet) under its column and when price is added it will\nbe added in the overview under its column. Price is always in the cell\nD21 on sheets identified by company names.</p>\n\n<p>So in the first (overview) sheet, there will be a mapping</p>\n\n<pre><code>company_name | price\nAAA (second sheet name) | secondsheet!D21\nBBB (third sheet name)  | thirdsheet!D21\nCCC (fourth sheet name) | fourthsheet!D21\n... etc.\n</code></pre>\n\n<p>How can I insert such a formula or create event driven macro for it?</p>\n"}, {"tags": ["regex", "vba", "debugging", "vbscript"], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520455790, "post_id": 49160795, "comment_id": 85327463, "body": "Thank you so much for your time. I am reviewing this now."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520456113, "post_id": 49160795, "comment_id": 85327618, "body": "In VBA via Microsoft Access 2016, using &quot;Microsoft VBScript Regular Expressions 5.5&quot; as a referenced library (via menu: [Tools] &gt; [References...]) and selecting &quot;Microsoft VBScript Regular Expressions 5.5&quot; exclusively, and not 1.0. See next comment..."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520456170, "post_id": 49160795, "comment_id": 85327646, "body": "&quot;Ray,&quot; is captured as subgroup 3 for input 3, not &quot;Ray, CFP&quot;... which is actually the main reason I was asking this question, as I want to capture &quot;Ray, CFP&quot; fully in VBA with engine 5.5 via MS Access 2016."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520456338, "post_id": 49160795, "comment_id": 85327735, "body": "Also, thank you for the great resource &quot;Regular Expressions 101&quot; online Regex evaluator. To get the idea out there, wouldn&#39;t it be cool if this tool or one like it automatically produced a line-item breakdown of the given RegEx like the breakdown you&#39;ve given? Also, it would be great if this tool or one like it showed the results for various languages using various engines under various conditions, and perhaps ran them all at once."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520456389, "post_id": 49160795, "comment_id": 85327767, "body": "Primary response/question: &quot;Ray,&quot; is captured as subgroup 3 for input 3, not &quot;Ray, CFP&quot;... which is actually the main reason I was asking this question, as I want to capture &quot;Ray, CFP&quot; fully in VBA with engine 5.5 via MS Access 2016. How do I capture &quot;Ray, CFP&quot; as the 3rd subgroup for the 3rd input?"}, {"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "reply_to_user": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520456401, "post_id": 49160795, "comment_id": 85327773, "body": "@blueuser can you post your (working) code up on <a href=\"https://tio.run/#vb-core\" rel=\"nofollow noreferrer\">tio.run</a> so that this may be tested? Also, regex101 does include that in the top-right corner under <i>Explanation</i>"}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520456414, "post_id": 49160795, "comment_id": 85327783, "body": "Primary response/question: &quot;Ray,&quot; is captured as subgroup 3 for input 3, not &quot;Ray, CFP&quot;... which is actually the main reason I was asking this question, as I want to capture &quot;Ray, CFP&quot; fully in VBA with engine 5.5 via MS Access 2016. How do I capture &quot;Ray, CFP&quot; as the 3rd subgroup for the 3rd input?"}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520456465, "post_id": 49160795, "comment_id": 85327812, "body": "oh cool, that&#39;s amazing thanks. I will get some modified code put together that doesn&#39;t require the database input and put it up on tio.run within 30 minutes (by 3:45 CST)."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520456607, "post_id": 49160795, "comment_id": 85327891, "body": "Visual Basic for Applications (VBA) and/or VBScript is not supported by tio.run . I&#39;ll look for an alternative. Can you suggest one?"}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 1, "creation_date": 1520456658, "post_id": 49160795, "comment_id": 85327916, "body": "ctwheels @ctwheels i&#39;ll try putting the code into <a href=\"http://rextester.com/l/vb\" rel=\"nofollow noreferrer\">rextester.com/l/vb</a> . Please give me until 3:50PM CST."}, {"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "reply_to_user": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520456692, "post_id": 49160795, "comment_id": 85327931, "body": "@blueuser the internet is amazing isn&#39;t it haha"}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520458342, "post_id": 49160795, "comment_id": 85328758, "body": "There is no working VBScript online editor/compiler, like JSFiddle for Javascript or tio.run. Making one, it will only run in Internet Explorer though as I don&#39;t wish to build a server backend. Should take under 3 hours."}, {"owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "reply_to_user": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520458727, "post_id": 49160795, "comment_id": 85328930, "body": "@blueuser no worries then, just thought about it now, but are there any newline characters in your <code>Ray, CFP</code> string? Maybe try replacing <code>(.*)</code> with <code>([\\s\\S]*)</code>"}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520651094, "post_id": 49160795, "comment_id": 85415098, "body": "ctwheels @ctwheels Ok, I haven&#39;t had a chance to get back to this until now. My online VBScript interpreter is now active at <a href=\"http://VBFiddle.net\" rel=\"nofollow noreferrer\">VBFiddle.net</a> . Please try it out using the latest Microsoft Internet Explorer (yes MS IE is required to use it since it&#39;s VBScript) and see if it works on your P.C. If it does (or doesn&#39;t) you were my first beta tester. I&#39;ve also worked on the VBScript that uses the built-in RegEx engine of MS IE VBscript, which I imagine has the same quarks as the VBA VBScript engine in Microsoft Access that I&#39;m using. When I&#39;m done with that I&#39;ll let you know..."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520878205, "post_id": 49160795, "comment_id": 85487270, "body": "ctwheels To see your suggested RegEx code in action as interpretted by VBScript in MS Internet Explorer, go to <a href=\"https://jsfiddle.net/hcwjhmg9/\" rel=\"nofollow noreferrer\">jsfiddle.net/hcwjhmg9</a> and select all of the HTML/Vbscript in the HTML pane (Ctrl+A), then copy it (Ctrl+C), then go to <a href=\"http://vbfiddle.net\" rel=\"nofollow noreferrer\">vbfiddle.net</a> in the latest Microsoft Internet Explorer, and clear the code panel on the left ([Ctrl+A] then [Backspace]), then paste in the HTML/VBScript copied from the provided jsfiddle.net link (Ctrl+V), then press the [Run] button or F8 on your keyboard. The output on the left will show the output of your code."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520878310, "post_id": 49160795, "comment_id": 85487323, "body": "ctwheels The output of your code when run under VBScript using MS IE 10+ is CORRECT for the use cases given in that environment, and you answered my question by providing a RegEx valid in working VBScript, so I am awarding you the Accepted Answer, even though I will be using Ryan Wildrey&#39;s solution for my use case."}], "tags": [], "owner": {"reputation": 19159, "user_id": 3600709, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/731c8c4c0029d3414563333de16b8977?s=128&d=identicon&r=PG&f=1", "display_name": "ctwheels", "link": "https://stackoverflow.com/users/3600709/ctwheels"}, "is_accepted": true, "score": 1, "last_activity_date": 1520455107, "creation_date": 1520455107, "answer_id": 49160795, "question_id": 49160720, "link": "https://stackoverflow.com/questions/49160720/specific-vba-vbscript-regex-related-issue-ms-access/49160795#49160795", "title": "Specific VBA / VBScript regex related issue (MS Access)", "body": "<p><a href=\"https://regex101.com/r/ER2G8u/1/\" rel=\"nofollow noreferrer\">See regex in use here</a></p>\n\n<pre><code>^([^(]+?)\\s*\\(\\s*([^)]*?)\\s*\\)\\s*(.*)\n</code></pre>\n\n<ul>\n<li><code>^</code> Assert position at the start of the line</li>\n<li><code>([^(]+?)</code> Capture any character except <code>(</code> one or more times, but as few as possible, into capture group 1</li>\n<li><code>\\s*</code> Match any number of whitespace characters</li>\n<li><code>\\(</code> Match <code>(</code> literally</li>\n<li><code>\\s*</code> Match any number of whitespace characters</li>\n<li><code>([^)]*?)</code> Capture any character except <code>)</code> one or more times, but as few as possible, into capture group 2</li>\n<li><code>\\s*</code> Match any number of whitespace characters</li>\n<li><code>\\(</code> Match <code>(</code> literally</li>\n<li><code>\\s*</code> Match any number of whitespace characters</li>\n<li><code>(.*)</code> Capture the rest of the line into capture group 3</li>\n</ul>\n\n<p>Results in:</p>\n\n<pre><code>[\"Lawrence N.\", \"Larry\", \"Solomon\"]\n[\"James\", \"Jim\", \"Alleman\"]\n[\"G.L.\", \"Pete\", \"Ray, CFP\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520869449, "post_id": 49161103, "comment_id": 85481924, "body": "Fails on the 3rd line/example."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520869483, "post_id": 49161103, "comment_id": 85481954, "body": "... in Microsoft Access 2016 VBA VbScript, RegEx engine I believe 5.5."}], "tags": [], "owner": {"reputation": 3034, "user_id": 6101071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b1da77c00202a8477bee1a68950824f?s=128&d=identicon&r=PG&f=1", "display_name": "Srdjan M.", "link": "https://stackoverflow.com/users/6101071/srdjan-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1520456391, "creation_date": 1520456391, "answer_id": 49161103, "question_id": 49160720, "link": "https://stackoverflow.com/questions/49160720/specific-vba-vbscript-regex-related-issue-ms-access/49161103#49161103", "title": "Specific VBA / VBScript regex related issue (MS Access)", "body": "<p><strong>Regex</strong>: <a href=\"https://regex101.com/r/6mCCyY/1\" rel=\"nofollow noreferrer\"><code>\\s*[()]\\s*</code></a></p>\n\n<p>Details:</p>\n\n<ul>\n<li><code>\\s*</code> matches any whitespace character zero and unlimited times</li>\n<li><code>[()]</code> Match a single character present in the list <code>(</code> or <code>)</code></li>\n</ul>\n\n<p><strong>VBA code</strong>:</p>\n\n<pre><code>Dim str As String\nstr = \"Lawrence N. (Larry) Solomon\"\n\nSet re = CreateObject(\"VBScript.RegExp\")\nre.Global = True\nre.Pattern = \"\\s*[()]\\s*\"\nre.MultiLine = True\n\nDim arr As Variant\narr = Strings.Split(re.Replace(str, vbNullChar), vbNullChar)\n\nFor Each Match In arr\n    Debug.Print (Match)\nNext\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Lawrence N.\nLarry\nSolomon\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520542776, "post_id": 49164387, "comment_id": 85370326, "body": "Yes, I had considered the approach of using split, but I thought it a bit complicated to split the string twice on &quot;)&quot; and &quot;(&quot; separately, then recombine the resulting strings. I like your approach, using replace -- very elegant. If I could accept two answers, I would accept yours and the one via RegEx. If the respondent with the RegEx answer satisfies my concerns with specifically the VBScript RegEx (for which his RegEx doesn&#39;t handle the hardest and main case I was looking to solve for VBScript RegEx), then I will award you the Accepted Answer. If he does solve it within the next..."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520542866, "post_id": 49164387, "comment_id": 85370371, "body": "... 3 days (and I&#39;ve created an online VBScript webpage similar to jsfiddle.net which I will be calling vbfiddle.net, which should allow him to get his RegEx working in VBScript 5.5) then I will award him the Accepted Answer, and upvote you. Thank you graciously for your time and effort."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520543042, "post_id": 49164387, "comment_id": 85370462, "body": "Also, I&#39;m trying to learn RegEx and its quirks in different flavors since RegExes are a weak point for me in software development, and there are many (more complicated) use cases in which understanding RegEx very well will be valuable."}, {"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "reply_to_user": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520544811, "post_id": 49164387, "comment_id": 85371331, "body": "@blueuser yup, I hear ya with Regex&#39;s. They are a powerful tool for sure, but can be overused. Sometimes it&#39;s hard to know when to use a regex, vs just handrolling something. If a small function can be written like this, I&#39;d lean on the side of avoiding Regex."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520878504, "post_id": 49164387, "comment_id": 85487433, "body": "Ryan, @ctwheels answer worked when I created vbfiddle.net and tested his solution, for the use cases I provided. See the last comments on his proposed solution if you&#39;d like to try out his solution yourself in MS IE 10+ running VBScript. However, there appears to be a big in either VBA or the RegEx engine 5.5 used by Microsoft Access 2016 which causes his RegEx to only return &quot;Ray,&quot; for the 3rd subgroup for the 3rd line of test data, when run in that environment, even though it should return &quot;Ray, CFP&quot; for the 3rd subgroup, and does so when using vbfiddle.net."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520878702, "post_id": 49164387, "comment_id": 85487547, "body": "So I&#39;ve determined that there is a bug in either VBA or the RegEx 5.5 engine used by VBScript in Microsoft Access 2016. Given that this bug is not @ctwheels fault, and ctwheels answered the question with a RegEx as I requested, ..."}, {"owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "edited": false, "score": 0, "creation_date": 1520878713, "post_id": 49164387, "comment_id": 85487553, "body": "... I believe he wins the &quot;Accepted Answer&quot; on an ever slight technicality. I will be using a modified version of your code however in my production version, and I appreciate your help. I have upvoted your answer. Thanks again.."}], "tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": false, "score": 1, "last_activity_date": 1520475973, "creation_date": 1520475973, "answer_id": 49164387, "question_id": 49160720, "link": "https://stackoverflow.com/questions/49160720/specific-vba-vbscript-regex-related-issue-ms-access/49164387#49164387", "title": "Specific VBA / VBScript regex related issue (MS Access)", "body": "<p>You should be able to avoid using Regex, if that's your thing.</p>\n\n<p>I made some assumptions about the test data that the nickname is contained within \"()\". Other than that the code should be straightforward, I hope. If not, feel free to ask a question. There is a Test routine called <code>Test</code> included too.</p>\n\n<pre><code>Public Function ParseString(InputString As String) As String\n    On Error GoTo ErrorHandler:\n\n    Dim OutputArray   As Variant\n    Const DoubleQuote As String = \"\"\"\"\n\n    'Quick exit, if () aren't found, then just return original text\n    If InStr(1, InputString, \"(\") = 0 Or InStr(1, InputString, \")\") = 0 Then\n        ParseString = InputString\n        Exit Function\n    End If\n\n    'Replace the ) with (, then do a split\n    OutputArray = Split(Replace(InputString, \")\", \"(\"), \"(\")\n\n    'Check the array bounds and output accordingly\n    'If there can only ever be 3 (0 - 2) elements, then you can change this if statement\n    If UBound(OutputArray) = 2 Then\n        ParseString = DoubleQuote &amp; Trim$(OutputArray(0)) &amp; DoubleQuote &amp; \", \" &amp; _\n                      DoubleQuote &amp; Trim$(OutputArray(1)) &amp; DoubleQuote &amp; \", \" &amp; _\n                      DoubleQuote &amp; Trim$(OutputArray(2)) &amp; DoubleQuote\n    ElseIf UBound(OutputArray) = 1 Then\n        ParseString = DoubleQuote &amp; Trim$(OutputArray(0)) &amp; DoubleQuote &amp; \", \" &amp; _\n                      DoubleQuote &amp; Trim$(OutputArray(1)) &amp; DoubleQuote\n    Else\n        ParseString = DoubleQuote &amp; Trim$(OutputArray(LBound(OutputArray))) &amp; DoubleQuote\n    End If\n\nCleanExit:\n    Exit Function\n\nErrorHandler:\n    ParseString = InputString\n    Resume CleanExit\nEnd Function\n\nSub Test()\n    Dim Arr() As Variant: Arr = Array(\"Lawrence N. (Larry) Solomon\", \"James ( Jim ) Alleman\", \"G.L. (Pete) Ray, CFP\")\n\n    For i = LBound(Arr) To UBound(Arr)\n        Debug.Print ParseString(CStr(Arr(i)))\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong>Results</strong></p>\n\n<pre><code>\"Lawrence N.\", \"Larry\", \"Solomon\"\n\"James\", \"Jim\", \"Alleman\"\n\"G.L.\", \"Pete\", \"Ray, CFP\"\n</code></pre>\n"}], "owner": {"reputation": 141, "user_id": 1978547, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/6d740229269cb0b935ddc41f8a1d7467?s=128&d=identicon&r=PG", "display_name": "blueuser", "link": "https://stackoverflow.com/users/1978547/blueuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 1, "accepted_answer_id": 49160795, "answer_count": 3, "score": 2, "last_activity_date": 1520881397, "creation_date": 1520454788, "last_edit_date": 1520881397, "question_id": 49160720, "link": "https://stackoverflow.com/questions/49160720/specific-vba-vbscript-regex-related-issue-ms-access", "title": "Specific VBA / VBScript regex related issue (MS Access)", "body": "<hr>\n\n<h2>UPDATE: March 12, 2018 1:44pm CST</h2>\n\n<p>After creating a website called <a href=\"http://vbfiddle.net\" rel=\"nofollow noreferrer\">http://vbfiddle.net</a> to implement and test @ctwheel's VBScript solution in a browser (MS IE 10+ with Security set to \"Medium\", instructions on that website for how to set it up for you to play with should you want -- get the code to copy &amp; paste into vbfiddle.net from this link at jsfiddle.net: <a href=\"https://jsfiddle.net/hcwjhmg9/\" rel=\"nofollow noreferrer\">https://jsfiddle.net/hcwjhmg9/</a> [<strong>vbfiddle.net does not currently have a \"save\" feature</strong>] ), I found that @ctwheel's VBScript RegEx ran successfully, even for the 3rd example line I gave, but when @ctwheel's VBScript RegEx is used in VBScript for VBA for Microsoft Access 2016 against a record read from a database with the \"same\" value, the third subgroup only returns \"Ray,\" for the 3rd example line I gave, when it should return \"Ray, CFP\" like it does in vbfiddle.net.</p>\n\n<p>It finally occurred to me to iterate through every character of the string value returned by the database (in VBA in Microsoft Access), and compare it to an iteration of every character of the visually-equivalent string value I type directly into the code (in VBA in Microsoft Access). I get the following results:</p>\n\n<pre><code>First Name and Last Name: \"G.L. (Pete) Ray, CFP\"\n--- 1st Text chars: \"71 46 76 46 32 40 80 101 116 101 41 32 82 97 121 44\" \n(Read value from database, appears same as below when Debug.Print is called on it)\n--- 2nd Text chars: \"71 46 76 46 32 40 80 101 116 101 41 32 82 97 121 44 32 67 70 80\" (Typed by keyboard into a string within the code)\n'G.L. (Pete) Ray,'\n    strProperName&gt;objSubMatch: \"G.L.\"\n    strProperName&gt;objSubMatch: \"Pete\"\n    strProperName&gt;objSubMatch: \"Ray,\"\n Matching record(s): 3 of 1132 record(s).\n</code></pre>\n\n<p>The RegEx I'm running is running against the \"<code>1st Text Chars</code>\" example, and returns \"Ray,\" for the 3rd subgroup of the previously given 3rd example line: \"<code>G.L. (Pete) Ray, CFP</code>\". However, if I run the RegEx against the 2nd -- typed directly into code -- \"<code>2nd Text chars</code>\" example, the 3rd subgroup returns \"Ray, CFP\" as expected in VBA for Microsoft Access 2016.</p>\n\n<p>I'm now using the RegEx that @ctwheels provided:</p>\n\n<pre><code>^([^(]+?)\\s*\\(\\s*([^)]*?)\\s*\\)\\s*(.*)\n</code></pre>\n\n<p>Can someone explain what's going on here? 1) Why are the characters returned from the database different from the characters returned from typing the string using a keyboard by reading and copying it visually? 2) How do I make a RegEx that works on the \"<code>1st Text Chars</code>\" sequence of characters / string return the correct 3rd subgroup: \"<code>Ray, CFP</code>\" when the value is read directly from the database?</p>\n\n<hr>\n\n<p><strong>ORIGINAL QUESTION</strong> (updated question above):</p>\n\n<p>I'm having problems in VBA using Microsoft Access 2016 with Regex Engine I believe 5.5 for VBScript.</p>\n\n<p>This is the regex expression I'm currently using:</p>\n\n<pre><code>\"(.*)\\((.*)(\\))(.*)\"\n</code></pre>\n\n<p>I'm trying to parse the strings (respectively on each new line):</p>\n\n<pre><code>Lawrence N. (Larry) Solomon\nJames ( Jim ) Alleman\nG.L. (Pete) Ray, CFP\n</code></pre>\n\n<p>Into:</p>\n\n<pre><code>\"Lawrence N.\", \"Larry\", \")\", \"Solomon\"\n\"James\", \"Jim\", \")\", \"Alleman\"\n\"G.L.\", \"Pete\", \")\", \"Ray, CFP\"\n</code></pre>\n\n<p>Or alternatively (and preferably) into:</p>\n\n<pre><code>\"Lawrence N.\", \"Larry\", \"Solomon\"\n\"James\", \"Jim\", \"Alleman\"\n\"G.L.\", \"Pete\", \"Ray, CFP\"\n</code></pre>\n\n<p>where the parts within the quotes, separated by commas, are those returned in the submatches (without quotes)</p>\n\n<p>I am using the following code:</p>\n\n<pre><code>           ' For Proper Name (strProperName):\n            With objRegex\n                .Global = False\n                .MultiLine = False\n                .IgnoreCase = True\n                .Pattern = \"(.*)\\((.*)(\\))(.*)\"\n\n                    '([\\s|\\S]*) work around to match every character?\n\n                        '\".*\\(([^\\s]*)[\\s]*\\(\" '_\n                        ''&amp; \"[\\\"\n                        '[\\(][\\s]*([.|^\\w]*)[\\s]*\\)\"\n                    ' \"[\\s]*(.*)[\\s]*\\(\"\n                        ' does same as below except matches any or no whitespace preceding any characters,\n                        ' and returns the following characters up to an opening parenthesis (\"(\") but excluding it,\n                        ' as the first subgroup\n                    ' \"(.*)[\\s]*\\(\"\n                        ' does same as below except matches any whitespace or no whitespace at all followed by an opening parenthesis (\"(\")\n                        ' and returns the preceding characters as the first subgroup\n                    ' \"(.*)\\(\"\n                        ' matches all characters in a row that end with an open parenthesis, and returns all of these characters in a row\n                        ' excluding the following open parenthesis as the first subgroup\n                    ' \"(.*?\\(\\s)\"\n                    ' \"[^\\(]*\"\n                        ' this pattern returns every character that isn't an opening parenthesis (\"(\"), and when\n                        ' it matches an open parenthesis, it does not return it or any characters after it\n                    ' \"[\\(\\s](.*)\\)\"\n                        ' this pattern extracts everything between parenthesis in a line as its first submatch\n                    ' \"(?&lt;=\\().*\"\n                    ' \"[^[^\\(]*][.*]\"\n                    ' \"(\\(.*?\\))\"\n                    ' \"(\\(.*?\\))*([^\\(].*[^\\)])\"\n            End With\n\n            If objRegex.Test(strFirstNameTrimmed) Then\n                'Set strsMatches = objRegex.Execute(rs.Fields(\"First Name\"))\n                Set strsMatches = objRegex.Execute(strFirstNameTrimmed)\n\n\n\n                Debug.Print \"2:'\" &amp; strsMatches(0).Value &amp; \"'\"\n\n                If strsMatches(0).SubMatches.Count &gt; 0 Then\n\n                    For Each objSubMatch In strsMatches(0).SubMatches\n\n                        Debug.Print \"    strProperName&gt;objSubMatch: \"\"\" &amp; objSubMatch &amp; \"\"\"\" 'Result: 000, 643, 888\"\n\n                        strProperName = objSubMatch\n\n                    Next objSubMatch\n\n                End If\n            Else\n                strProperName = \"*Not Matched*\"\n            End If\n</code></pre>\n\n<p>Produces the following output in the debug window / \"Immediate Window\" as it's known in VBA, brought up by (Ctrl+G):</p>\n\n<pre><code>------------------------\nFirst Name and Last Name: \"Lawrence N. (Larry) Solomon\"\n2:'Lawrence N. (Larry)'\n    strProperName&gt;objSubMatch: \"Lawrence N. \"\n    strProperName&gt;objSubMatch: \"Larry\"\n    strProperName&gt;objSubMatch: \")\"\n    strProperName&gt;objSubMatch: \"\"\nExtracted Nick Name: \"Larry\"\nExtracted Proper Name: \"\"\nFirst Name and Last Name: \"James ( Jim ) Alleman\"\n2:'James ( Jim )'\n    strProperName&gt;objSubMatch: \"James \"\n    strProperName&gt;objSubMatch: \" Jim \"\n    strProperName&gt;objSubMatch: \")\"\n    strProperName&gt;objSubMatch: \"\"\nExtracted Nick Name: \"Jim\"\nExtracted Proper Name: \"\"\nFirst Name and Last Name: \"G.L. (Pete) Ray, CFP\"\n2:'G.L. (Pete) Ray,'\n    strProperName&gt;objSubMatch: \"G.L. \"\n    strProperName&gt;objSubMatch: \"Pete\"\n    strProperName&gt;objSubMatch: \")\"\n    strProperName&gt;objSubMatch: \" Ray,\"\nExtracted Nick Name: \"Pete\"\nExtracted Proper Name: \" Ray,\"\nMatching record(s): 3 of 1132 record(s).\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 9458879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9S4yg.png?s=128&g=1", "display_name": "QFarley", "link": "https://stackoverflow.com/users/9458879/qfarley"}, "edited": false, "score": 0, "creation_date": 1520455207, "post_id": 49160745, "comment_id": 85327159, "body": "Worked like a charm. Thank you very much @DavidZemens!"}], "tags": [], "owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "is_accepted": true, "score": 2, "last_activity_date": 1520454902, "creation_date": 1520454902, "answer_id": 49160745, "question_id": 49160680, "link": "https://stackoverflow.com/questions/49160680/excel-vba-snippet-causing-run-time-error-438/49160745#49160745", "title": "Excel VBA snippet causing Run-Time Error &#39;438&#39;", "body": "<p><code>Paste</code> is not a method available to the <a href=\"https://msdn.microsoft.com/en-us/library/bb225606(v=office.12).aspx\" rel=\"nofollow noreferrer\"><code>Range</code> object</a>. <code>Cells</code> is a <code>Range</code> object. Ergo, \"Object does not support this property or method\" :)</p>\n\n<p>You could try:</p>\n\n<pre><code>Cells(i, 50).PasteSpecial xlPasteAll\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1520502427, "creation_date": 1520502427, "answer_id": 49170026, "question_id": 49160680, "link": "https://stackoverflow.com/questions/49160680/excel-vba-snippet-causing-run-time-error-438/49170026#49170026", "title": "Excel VBA snippet causing Run-Time Error &#39;438&#39;", "body": "<p>As @DavidZemens said, you missed the proper method name</p>\n\n<p>furthermore your code seems to do unnecessary work where:</p>\n\n<ul>\n<li><p>it first does something in current <code>i</code> row should <code>If Cells(i, 12).Value = \"ERROR\"</code> check return True</p></li>\n<li><p>then it would delete the same i row should subsequent <code>If Cells(i, 21).Value = \"ERROR\" Then</code> return True again</p></li>\n</ul>\n\n<p>Finally you're not using any <code>PasteSpecial</code> feature so you may want to use plain <code>Copy</code> one</p>\n\n<p>Hence I'd refactor it as follows</p>\n\n<pre><code>Dim lrow As Long, i As Long\n\nlrow = Cells(Rows.Count, \"L\").End(xlUp).Row\n\nFor i = lrow To 4 Step -1\n    If Cells(i, 21).value = \"ERROR\" Then\n        Rows(i).Delete\n    ElseIf Cells(i, 12).value = \"ERROR\" Then\n        Range(\"L\" &amp; i &amp; \":M\" &amp; i).Copy Destination:=Cells(i, 50)\n        Range(\"L\" &amp; i &amp; \":M\" &amp; i).ClearContents\n    End If\nNext i\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 9458879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9S4yg.png?s=128&g=1", "display_name": "QFarley", "link": "https://stackoverflow.com/users/9458879/qfarley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 49160745, "answer_count": 2, "score": 1, "last_activity_date": 1520502427, "creation_date": 1520454602, "question_id": 49160680, "link": "https://stackoverflow.com/questions/49160680/excel-vba-snippet-causing-run-time-error-438", "title": "Excel VBA snippet causing Run-Time Error &#39;438&#39;", "body": "<p>1st time poster.</p>\n\n<p>The following VBA script breaks a work macro everytime. I've tried different syntaxes to fix, but getting the same result.</p>\n\n<p>The code is supposed to look through all data cells in column L, looking for the string, \"ERROR\". If found, copy that cell and the one to the right over to the correct column \"AX\" and clear the text in L and M.</p>\n\n<p>The step it breaks at every time is the \"Cells(i, 50).Paste\" line.</p>\n\n<pre><code>Set rng = Application.Range(\"L4:M\" &amp; lrow)\nFor i = rng.Rows.Count To 4 Step -1\n    If Cells(i, 12).Value = \"ERROR\" Then\n        Range(\"L\" &amp; i &amp; \":M\" &amp; i).Copy\n        Cells(i, 50).Paste\n        Range(\"L\" &amp; i &amp; \":M\" &amp; i).ClearContents\n    End If\n    If Cells(i, 21).Value = \"ERROR\" Then\n        Rows(i).Delete\n    End If\nNext I\n</code></pre>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1520452817, "post_id": 49160229, "comment_id": 85325912, "body": "Just to make sure that they are only text strings <code>&quot;Monday&quot;</code> and not a date formatted <code>dddd</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5316, "user_id": 139794, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b9710024f56d35631fb6260e13c76586?s=128&d=identicon&r=PG", "display_name": "Darryl", "link": "https://stackoverflow.com/users/139794/darryl"}, "edited": false, "score": 1, "creation_date": 1520453837, "post_id": 49160344, "comment_id": 85326441, "body": "And if it <i>is</i> a date formatted with &quot;dddd&quot;, try <code>=TEXT(WEEKDAY(A1)-1,&quot;dddd&quot;)</code>"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 2, "last_activity_date": 1520454710, "last_edit_date": 1520454710, "creation_date": 1520453100, "answer_id": 49160344, "question_id": 49160229, "link": "https://stackoverflow.com/questions/49160229/create-an-excel-formula-where-monday-1-sunday/49160344#49160344", "title": "Create an excel formula where (&quot;Monday&quot; - 1) = &quot;Sunday&quot;", "body": "<p>If they are just text strings and not a date formatted <code>dddd</code> then use this formula:</p>\n\n<pre><code>=TEXT(MATCH(A1,{\"Monday\",\"Tuesday\",\"Wednesday\",\"Thursday\",\"Friday\",\"Saturday\",\"Sunday\"},0),\"dddd\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/HONB2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HONB2.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>Found a shorter formula:</p>\n\n<pre><code>=TEXT(SUMPRODUCT((ROW($1:$7))*(TEXT(ROW($2:$8),\"dddd\")=A1)),\"dddd\")\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MG9xP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MG9xP.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 85, "user_id": 9355397, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1f409a95833a3e26e151bf5e7883f86d?s=128&d=identicon&r=PG&f=1", "display_name": "papacoolaid666", "link": "https://stackoverflow.com/users/9355397/papacoolaid666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 1, "accepted_answer_id": 49160344, "answer_count": 1, "score": 1, "last_activity_date": 1520454710, "creation_date": 1520452642, "last_edit_date": 1531164843, "question_id": 49160229, "link": "https://stackoverflow.com/questions/49160229/create-an-excel-formula-where-monday-1-sunday", "title": "Create an excel formula where (&quot;Monday&quot; - 1) = &quot;Sunday&quot;", "body": "<p>Lets say in Column A there are days of the week (\"Monday\") and in the B Column I want a formula to output the day before (\"Sunday\"). Does anyone know which formula could make this possible short of creating a nested If function that asks for lists each day of the week? </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "ms-word", "screen-scraping"], "answers": [{"tags": [], "owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "is_accepted": false, "score": 0, "last_activity_date": 1520456370, "creation_date": 1520456370, "answer_id": 49161098, "question_id": 49160202, "link": "https://stackoverflow.com/questions/49160202/how-can-i-make-sure-my-ie-tab-name-is-correct/49161098#49161098", "title": "How can I make sure my IE tab name is correct?", "body": "<p>The tab is just another window.  You can use the GetWebPage function below to loop through the windows and get the URL you are looking for.</p>\n\n<p>References are\nMicrosoft Internet Controls\nMicrosoft Shell Controls and Automation</p>\n\n<pre><code>Sub Example()\nDim ieWin As InternetExplorer\n\nSet ieWin = CreateObject(\"InternetExplorer.Application\")\n\n    With ieWin\n        .Navigate \"https://www.google.com/\"\n        .Visible = True\n        .Silent = True\n    End With\n\n    Set ieWin = GetWebPage(\"https://www.google.com/\")\n\nEnd Sub\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'Desc: The Function gets the Internet Explorer window that has the current\n'   URL from the sURL Parameter.  The Function Timesout after 30 seconds\n'Input parameters:\n    'String sURL - The URL to look for\n'Output parameters:\n    'InternetExplorer ie - the Internet Explorer window holding the webpage\n'Result: returns the the Internet Explorer window holding the webpage\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\nPublic Function GetWebPage(sUrl As String) As InternetExplorer\nDim winShell As Shell\nDim dt As Date\ndt = DateAdd(\"s\", 300, DateTime.Now)\n\nDim ie As InternetExplorer\n\nDo While dt &gt; DateTime.Now\n    Set winShell = New Shell\n    'loop through the windows and check the internet explorer windows\n    For Each ie In winShell.Windows\n        If ie.LocationURL = sUrl Then\n            Set GetWebPage = ie\n            Do While ie.Busy\n                DoEvents\n            Loop\n            Exit Do\n\n        Set winShell = Nothing\n        End If\n    Next ie\n    Set winShell = Nothing\n    DoEvents\nLoop\nEnd Function\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "is_accepted": true, "score": 0, "last_activity_date": 1520480325, "last_edit_date": 1520480325, "creation_date": 1520477712, "answer_id": 49164622, "question_id": 49160202, "link": "https://stackoverflow.com/questions/49160202/how-can-i-make-sure-my-ie-tab-name-is-correct/49164622#49164622", "title": "How can I make sure my IE tab name is correct?", "body": "<p>Here is some code that should find a reference to the open Internet Explorer tab. It does this by looping through the <code>Shell.Application.Windows</code> collection. The function supports looking for just the WindowName, the URL and WindowName, and supports specifying the compare method or if you want to do a like match. I kept this code late bound, to avoid needing references.</p>\n\n<p>The code is commented, somewhat, let me know if there are questions.</p>\n\n<p><strong>Code</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Function GetIEWindow(WindowName As String, _\n                             ExactMatch As Boolean, _\n                             Optional CompareMethod As VbCompareMethod = vbTextCompare, _\n                             Optional URL As String) As Object\n\n    Dim Window  As Object\n    Dim Windows As Object: Set Windows = CreateObject(\"Shell.Application\").Windows\n\n    For Each Window In Windows\n        'Make sure the app is Internet Explorer. Shell Windows can include other apps\n        If InStr(1, Window.FullName, \"IEXPLORE.EXE\", vbTextCompare) &gt; 0 Then\n            'Perform exact matches, where the title or url and title match exactly\n            If ExactMatch Then\n                If Len(URL) = 0 Then\n                    If Window.LocationName = WindowName Then\n                        Set GetIEWindow = Window\n                        Exit Function\n                    End If\n                Else\n                    If Window.LocationName = WindowName And Window.LocationUrl = URL Then\n                        Set GetIEWindow = Window\n                        Exit Function\n                    End If\n                End If\n            Else\n            'Otherwise do a In String match\n                If Len(URL) = 0 Then\n                    If InStr(1, Window.LocationName, WindowName, CompareMethod) &gt; 0 Then\n                        Set GetIEWindow = Window\n                        Exit Function\n                    End If\n                Else\n                    If InStr(1, Window.LocationName, WindowName, CompareMethod) &gt; 0 And InStr(1, Window.LocationUrl, URL, CompareMethod) &gt; 0 Then\n                        Set GetIEWindow = Window\n                        Exit Function\n                    End If\n                End If\n            End If\n        End If\n\n    Next\n\nEnd Function\n\nSub ExampleUsage()\n    Dim IE As Object: Set IE = GetIEWindow(\"exe\", True)\n\n    If Not IE Is Nothing Then\n        Debug.Print \"I found the IE window\"\n    Else\n        Debug.Print \"I didn't find the IE window\"\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 49164622, "answer_count": 2, "score": 0, "last_activity_date": 1522089042, "creation_date": 1520452552, "last_edit_date": 1522089042, "question_id": 49160202, "link": "https://stackoverflow.com/questions/49160202/how-can-i-make-sure-my-ie-tab-name-is-correct", "title": "How can I make sure my IE tab name is correct?", "body": "<p>I'm using this code to grab the instance of Internet Explorer from word VBA and scraping some values from a webpage. I'm looping through 4 items (just in case, sometimes I've accidentally grabbed something called \"Windows Explorer\", which I have no idea what that is) to grab Internet Explorer. But before I begin scraping values, I want to make sure my tab name is \"Overview - City\". How can I test against the tab names?</p>\n\n<pre><code>Dim shellWins As ShellWindows, IE As InternetExplorer\nDim i As Long\n\nSet shellWins = New ShellWindows\n\n'Find Internet Explorer - if it can't find it, close the program\nIf shellWins.Count &gt; 0 Then\n    For i = 0 To 3\n        On Error Resume Next\n            If shellWins.Item(i).Name = \"Internet Explorer\" Then\n                Set IE = shellWins.Item(i)\n                Exit For\n            End If\n        On Error GoTo 0\n\n        If i = 3 Then\n            MsgBox \"Could not find Internet Explorer.\", vbExclamation, \"Error\"\n            Exit Sub\n        End If\n    Next i\nElse\n    MsgBox \"Could not find Internet Explorer.\", vbExclamation, \"Error\"\n    Exit Sub\nEnd If\n</code></pre>\n\n<p>I tried following the guide <a href=\"http://www.vbaexpress.com/forum/showthread.php?41253-Find-active-IE-tab\" rel=\"nofollow noreferrer\">here</a> and used this bit to try and <code>Debug.Print</code> all the active tab names in IE once I had found it:</p>\n\n<pre><code>Dim IE_Tab As SHDocVw.InternetExplorer\nDim SH_Win As SHDocVw.ShellWindows\n\nFor each IE_Tab in SH_Win\n    Debug.Print IE_Tab.Name 'This returns nothing?\nNext IE_Tab\n</code></pre>\n\n<p>But the immediate window returns blank with no error. What am I doing wrong?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "edited": false, "score": 0, "creation_date": 1520456985, "post_id": 49159765, "comment_id": 85328080, "body": "This looks ok <code>objIE.document.getElementById(&quot;esn-input&quot;).Value</code>, but this won&#39;t work <code>objIE.document.getElementById(&quot;ui button uppercase check-device-btn&quot;).Click</code> as I don&#39;t see anything that says &quot;ID&quot;. It says it&#39;s a class as is this one <code>For Each aEle In objIE.document.getElementsByClassName(&quot;header center table-child-vertical-center short-desc-header&quot;)</code>. Inspect the element again, but look further back in the code, but in the same &lt;div&gt; to locate the ID&#39;s for the elements you are looking for. I would need to see a lot more of the code to help."}], "owner": {"reputation": 11, "user_id": 9458468, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-sWCyN_vyv7A/AAAAAAAAAAI/AAAAAAAAE9Y/GbKkcbV_tww/photo.jpg?sz=128", "display_name": "keith walters", "link": "https://stackoverflow.com/users/9458468/keith-walters"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 28, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1520450658, "creation_date": 1520450658, "last_edit_date": 1531161705, "question_id": 49159765, "link": "https://stackoverflow.com/questions/49159765/web-form-response-recording", "title": "web form response recording", "body": "<p>I'm trying to use a macro inside of Excel in conjunction with a web form that is only available on my Intranet. I need it to pull info from an excel file table, input into the web form, click the submit button, return the confirmation to the excel doc, click the restart button and repeat the process until the 20 items have been confirmed. I have set up my file but it is not accepting my getelementbyID or getelementbyClass. I need help identifying the correct element to replace in my code... Any help would be great appreciated.</p>\n\n<p>---input field---</p>\n\n<pre><code>&lt;input _ngcontent-c3=\"\" class=\"text-input ng-pristine ng-valid ng-touched\" id=\"esn-input\" placeholder=\"Enter Device ID\" type=\"text\"&gt;\n</code></pre>\n\n<p>---submit button---</p>\n\n<pre><code>&lt;button _ngcontent-c3=\"\" class=\"ui button uppercase check-device-btn\"&gt;\n\n            &lt;!----&gt;Check Device\n\n            &lt;!----&gt;\n\n            &lt;!----&gt;\n\n\n\n\n\n\n\n          &lt;/button&gt;\n</code></pre>\n\n<p>---confirmation message that needs to return to excel---</p>\n\n<pre><code>&lt;div _ngcontent-c6=\"\" class=\"header center table-child-vertical-center short-desc-header\"&gt;\n            Confirmed\n          &lt;/div&gt;\n</code></pre>\n\n<p>----Restart button---</p>\n\n<pre><code>&lt;button _ngcontent-c6=\"\" class=\"massive ui circular icon button margin-left-right-30 relative restart\"&gt;\n      &lt;i _ngcontent-c6=\"\" class=\"icon refresh\"&gt;&lt;/i&gt;\n      &lt;span _ngcontent-c6=\"\" class=\"round-button-bottom-label\"&gt;Startover&lt;/span&gt;\n      &lt;!----&gt;\n    &lt;/button&gt;\n</code></pre>\n\n<p>This is my code so far...</p>\n\n<pre><code>Sub IntranetQuery()\n\n    Dim objIE As InternetExplorer\n    Dim aEle As HTMLLinkElement\n    Dim y As Integer\n    Dim result As String\n\n    Set objIE = New InternetExplorer\n\n    objIE.Visible = True\n\n    objIE.navigate \"intranetpage\"\n\n\n        Application.Wait (Now + TimeValue(\"00:00:02\"))\n\n\n    objIE.document.getElementById(\"esn-input\").Value = _\n      Sheets(\"Sheet1\").Range(\"A2\").Value &amp; \" in \" &amp; Sheets(\"Sheet1\").Range(\"C1\").Value\n\n    objIE.document.getElementById(\"ui button uppercase check-device-btn\").Click\n\n    Do While objIE.Busy = True Or objIE.readyState &lt;&gt; 4: DoEvents: Loop\n\n    y = 2\n\n    For Each aEle In objIE.document.getElementsByClassName(\"header center table-child-vertical-center short-desc-header\")\n\n        result = aEle\n        Sheets(\"Sheet1\").Range(\"C\" &amp; y).Value = result\n\n        Sheets(\"Sheet1\").Range(\"D\" &amp; y).Value = aEle.innerText\n        Debug.Print aEle.innerText\n\n        End If\n\n        y = y + 1\n\n    Next\n\n    Sheets(\"Sheet1\").Range(\"B1\").Value = _\n      Application.WorksheetFunction.Sum(Sheets(\"Sheet1\").Range(\"B2:B100\"))\n\n    objIE.document.getElementById(\"massive ui circular icon button margin-left-right-30 relative restart\").Click\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "cmd", "vba", "ms-access-reports"], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1520457152, "creation_date": 1520457152, "answer_id": 49161275, "question_id": 49159425, "link": "https://stackoverflow.com/questions/49159425/access-do-cmd-openreport-is-only-printing/49161275#49161275", "title": "Access Do.Cmd OpenReport is only printing?", "body": "<p>If you wish to preview:</p>\n\n<pre><code>DoCmd.OpenReport \"rptAllTime\", acViewPreview\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5517940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f48a414ef3c3813d90649f4265f3d6a?s=128&d=identicon&r=PG&f=1", "display_name": "grayv", "link": "https://stackoverflow.com/users/5517940/grayv"}, "is_accepted": false, "score": 0, "last_activity_date": 1520459076, "creation_date": 1520459076, "answer_id": 49161727, "question_id": 49159425, "link": "https://stackoverflow.com/questions/49159425/access-do-cmd-openreport-is-only-printing/49161727#49161727", "title": "Access Do.Cmd OpenReport is only printing?", "body": "<p>I just want to see it in the report view and not preview. I wrote the line again (like the 5th time today after restarting my machine) and I got this to work:</p>\n\n<pre><code>DoCmd.OpenReport \"RptAllTime\", acViewReport\n</code></pre>\n\n<p>I have no idea why it worked after trying so many times. Ugh, Microsoft....</p>\n"}], "owner": {"reputation": 1, "user_id": 5517940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f48a414ef3c3813d90649f4265f3d6a?s=128&d=identicon&r=PG&f=1", "display_name": "grayv", "link": "https://stackoverflow.com/users/5517940/grayv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 559, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1594636948, "creation_date": 1520449344, "last_edit_date": 1594636948, "question_id": 49159425, "link": "https://stackoverflow.com/questions/49159425/access-do-cmd-openreport-is-only-printing", "title": "Access Do.Cmd OpenReport is only printing?", "body": "<p>Access 2010 - OpenReport in vba is only printing.</p>\n\n<p>I have a simple modal form where the user selects a date range and the report opens. If the query results are 0, a message pops up saying there are no values, else the report opens and modal form closes. However, every time I run this it will not open in the report view it will only print. I can change it to design and print preview and those all work just not view.</p>\n\n<p>I have been trying to figure this out with no avail and its driving me nuts. What am I missing?</p>\n\n<pre><code>Private Sub Command5_Click()\nIf DCount(\"*\", \"qryalltime_filtered\") = 0 Then\nMsgBox \"No records to display based on the date parameter provided\"\n\nElse: DoCmd.OpenReport \"rptAllTime\", acViewReport\nDoCmd.Close acForm, \"frmAdmin-Employee\"\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "oracle", "connection", "ado", "ole"], "comments": [{"owner": {"reputation": 71, "user_id": 6261248, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cbd6aa914c036b6b28945e6e5a1c4980?s=128&d=identicon&r=PG&f=1", "display_name": "jp3nyc", "link": "https://stackoverflow.com/users/6261248/jp3nyc"}, "edited": false, "score": 0, "creation_date": 1520449274, "post_id": 49159381, "comment_id": 85323908, "body": "Sorry, the Error message I get is RunTime Error &#39;424&#39; object required"}, {"owner": {"reputation": 71, "user_id": 6261248, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cbd6aa914c036b6b28945e6e5a1c4980?s=128&d=identicon&r=PG&f=1", "display_name": "jp3nyc", "link": "https://stackoverflow.com/users/6261248/jp3nyc"}, "edited": false, "score": 0, "creation_date": 1520449810, "post_id": 49159381, "comment_id": 85324214, "body": "In addition below are the Library References I have selected ... if that helps  Visual Basic for Applications Microsof Excel 15.0 Object Library OLE Automation Microsoft Office 15.0 Object Library Microsoft ActiveX Data Objects 6.1 Library Microsoft ActiveX Data Objects Recordset 6.0 Library Microsoft DAO 3.6 Library"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1520458571, "post_id": 49159381, "comment_id": 85328862, "body": "Don&#39;t you have to put the IP of the server into the code.  Something the following or you are pulling it from the spreadsheet?"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1520458613, "post_id": 49159381, "comment_id": 85328879, "body": "ServerShare = &quot;\\\\175.27.18.189\\Divisions\\Directional\\Motors&quot;"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1520458724, "post_id": 49159381, "comment_id": 85328929, "body": "Set NetworkObject = CreateObject(&quot;WScript.Network&quot;)"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1520458735, "post_id": 49159381, "comment_id": 85328935, "body": "NetworkObject.MapNetworkDrive &quot;&quot;, ServerShare, False, UserName, Password"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1520459287, "post_id": 49159381, "comment_id": 85329205, "body": "Did you install an Oracle Client?"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1520459510, "post_id": 49159381, "comment_id": 85329302, "body": "@Wookies-Will-Code, the code in question is VBA, your comments are VBScript. They are different and not related to the problem."}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1520459737, "post_id": 49159381, "comment_id": 85329392, "body": "What are the values for <code>DBNAME$</code> and <code>sourcedb</code>? Seems to be redundant and possibly wrong. Most likely <code>sourcedb &amp; &quot;:&quot; &amp; ORACLE_PORT$ &amp; &quot;:&quot; &amp; DBNAME$</code> result in wrong data source, see <a href=\"https://www.orafaq.com/wiki/EZCONNECT\" rel=\"nofollow noreferrer\">orafaq.com/wiki/EZCONNECT</a>"}, {"owner": {"reputation": 71, "user_id": 6261248, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cbd6aa914c036b6b28945e6e5a1c4980?s=128&d=identicon&r=PG&f=1", "display_name": "jp3nyc", "link": "https://stackoverflow.com/users/6261248/jp3nyc"}, "edited": false, "score": 0, "creation_date": 1520477118, "post_id": 49159381, "comment_id": 85334601, "body": "Server Name:\tcoloplast-stg-rdb.cloud.modeln.com Database Name:\tCPHSTG Oracle Port:\t4004 Oracle User Name:\tjpathil Oracle Password:\tJean1121 Data Source:\tcoloplast-stg-rdb.cloud.modeln.com Thank you WernFried"}, {"owner": {"reputation": 71, "user_id": 6261248, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cbd6aa914c036b6b28945e6e5a1c4980?s=128&d=identicon&r=PG&f=1", "display_name": "jp3nyc", "link": "https://stackoverflow.com/users/6261248/jp3nyc"}, "edited": false, "score": 0, "creation_date": 1520477129, "post_id": 49159381, "comment_id": 85334605, "body": "I did actually install the oracle client 12."}, {"owner": {"reputation": 71, "user_id": 6261248, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cbd6aa914c036b6b28945e6e5a1c4980?s=128&d=identicon&r=PG&f=1", "display_name": "jp3nyc", "link": "https://stackoverflow.com/users/6261248/jp3nyc"}, "edited": false, "score": 0, "creation_date": 1520477248, "post_id": 49159381, "comment_id": 85334632, "body": "What is most strange is that I can connect via SQL Dev.  In this case I have the parameters in a spreadsheet and I am feeding from the ranges into the variables.  Then I am putting the variables into the connection string"}, {"owner": {"reputation": 71, "user_id": 6261248, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cbd6aa914c036b6b28945e6e5a1c4980?s=128&d=identicon&r=PG&f=1", "display_name": "jp3nyc", "link": "https://stackoverflow.com/users/6261248/jp3nyc"}, "edited": false, "score": 0, "creation_date": 1520477283, "post_id": 49159381, "comment_id": 85334638, "body": "Either way, thank you for trying to help Wernfried"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1520494628, "post_id": 49159381, "comment_id": 85340538, "body": "SQL Developer is Java based and uses JDBC driver - which does not require any further client installation. Did you install Oracle Instant Client? The Instant Client does not include the OLE DB providers, you have to download and install it separately from <a href=\"http://www.oracle.com/technetwork/topics/dotnet/downloads/net-downloads-160392.html\" rel=\"nofollow noreferrer\">oracle.com/technetwork/topics/dotnet/downloads/&hellip;</a>"}, {"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 0, "creation_date": 1520494756, "post_id": 49159381, "comment_id": 85340597, "body": "Data Source should be <code>HOST$ &amp; &quot;:&quot; &amp; ORACLE_PORT$ &amp; &quot;&#47;&quot; &amp; DBNAME$</code>"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1520523080, "post_id": 49159381, "comment_id": 85358785, "body": "I that code not VBA? It is from an excel worksheet, piping to a database on server."}], "owner": {"reputation": 71, "user_id": 6261248, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/cbd6aa914c036b6b28945e6e5a1c4980?s=128&d=identicon&r=PG&f=1", "display_name": "jp3nyc", "link": "https://stackoverflow.com/users/6261248/jp3nyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1023, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520449187, "creation_date": 1520449187, "question_id": 49159381, "link": "https://stackoverflow.com/questions/49159381/connecting-to-oracle-via-vba", "title": "Connecting to Oracle via VBA", "body": "<p>All,</p>\n\n<p>I am trying to connect to an oracle database via the Cloud through VBA.  Below is my code.  When I debug print my VBA after the variable \"strConOracle\" is set, the variable prints as below</p>\n\n<p><strong><em>strConOracle</em></strong>\nProvider=OraOLEDB.Oracle;Dat<code>enter code here</code>a Source=coloplast-stg-rdb.cloud.modeln.com:4004:CPHSTG; User ID=jpathil;Password=Jean1121;</p>\n\n<p>This seems ok since my database credentials that I connect with via SQL Dev are below</p>\n\n<p>username: jpathil\nPassword: Jean1121\nhostname: coloplast-stg-rdb.cloud.modeln.com\nPort: 4004\nService Name: CPHSTG</p>\n\n<p>What could be wrong with the code below?  It fails at the last line \"oConOracle.Open strConOracle\"</p>\n\n<pre><code>Sub QueryConstructOracle()\nDim QueryVar As String\nDim db As Database\nDim rs As Recordset\nHOST$ = Sheets(\"Connection Setup\").Range(\"Server\")\nDBNAME$ = Sheets(\"Connection Setup\").Range(\"Database\")\nORACLE_USER_NAME$ = Sheets(\"Connection Setup\").Range(\"User\")\nORACLE_PASSWORD$ = Sheets(\"Connection Setup\").Range(\"Password\")\nORACLE_PORT$ = Sheets(\"Connection Setup\").Range(\"Port\")\nsourcedb = Sheets(\"Connection Setup\").Range(\"DataSource\")\nDim strConOracle As String\nDim oConOracle, oRsOracle\nDim strSQL As String\nOn Error GoTo errHandler\n\nApplication.Calculation = xlManual\nApplication.ScreenUpdating = False\n\n\n' Set connections\nstrConOracle = \"Provider=OraOLEDB.Oracle;Data Source=\" &amp; sourcedb &amp; \":\" &amp; ORACLE_PORT$ &amp; \":\" &amp; DBNAME$ &amp; \"; User ID=\" &amp; ORACLE_USER_NAME$ &amp; \";Password=\" &amp; ORACLE_PASSWORD$ &amp; \";\"\nSet oConOracle = CreateObject(\"ADODB.Connection\")\noConOracle.Open strConOracle\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1, "user_id": 9458282, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YKWYG1j85Dc/AAAAAAAAAAI/AAAAAAAAAHY/LUDFwGMiB68/photo.jpg?sz=128", "display_name": "Vraj Vaidya", "link": "https://stackoverflow.com/users/9458282/vraj-vaidya"}, "edited": false, "score": 0, "creation_date": 1520445590, "post_id": 49158362, "comment_id": 85321747, "body": "Refer to: <a href=\"https://stackoverflow.com/questions/12174723/run-time-error-1004-method-range-of-object-global-failed\" title=\"run time error 1004 method range of object global failed\">stackoverflow.com/questions/12174723/&hellip;</a>"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1520445637, "post_id": 49158362, "comment_id": 85321781, "body": "Which line? It should be <code>Anchor:=linkToSpot</code>."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1520445640, "post_id": 49158362, "comment_id": 85321782, "body": "If you start off at the top with <code>Dim linkToSpot as Range</code>, then you should (I think) just be able to do <code>...Anchor:=linkToSpot, _ ...</code>.  But you may even be able to do that now, without declaring <code>linkToSpot as Range</code>, but it&#39;s best practice to always declare your variables.  OR, if you want (for whatever reason) to keep it with <code>Range()</code>, do this instead: <code>Anchor:=Range(linkToSpot.Address), _ ...</code>."}, {"owner": {"reputation": 153, "user_id": 4543962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1200d5e6f2313efc2141e9e43bef3793?s=128&d=identicon&r=PG", "display_name": "Mauricio Andr&#233;s", "link": "https://stackoverflow.com/users/4543962/mauricio-andr%c3%a9s"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520448437, "post_id": 49158362, "comment_id": 85323408, "body": "@BruceWayne thanks, this worked, but now this hole block <code>Worksheets(&quot;MMS-Locations&quot;).Hyperlinks.Add _                                 Anchor:=Range(linkToSpot.Adress), _                                 Address:=&quot;http:&#47;&#47;example.microsoft.com&quot;, _                                 ScreenTip:=&quot;Microsoft Web Site&quot;, _                                 TextToDisplay:=&quot;Microsoft&quot;</code> Shows an error &quot;Object Doesn&#39;t Support This Property or Method&quot;"}, {"owner": {"reputation": 153, "user_id": 4543962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1200d5e6f2313efc2141e9e43bef3793?s=128&d=identicon&r=PG", "display_name": "Mauricio Andr&#233;s", "link": "https://stackoverflow.com/users/4543962/mauricio-andr%c3%a9s"}, "edited": false, "score": 0, "creation_date": 1520448645, "post_id": 49158362, "comment_id": 85323514, "body": "And Even by adding the variable at the top, shows the same error as before"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520449007, "post_id": 49158362, "comment_id": 85323735, "body": "With just <code>Anchor:=Range(linkToSpot)</code> make sure to add the worksheet <code>linkToSpot</code>&#39;s range is coming from. I.e. <code>Anchor = Worksheets(&quot;MMS-Locations&quot;).Range(linkToSpot.Address)</code>.  Also while you&#39;re troubleshooting, I&#39;d put that whole thing on one line.  Does this still throw an error?"}], "answers": [{"tags": [], "owner": {"reputation": 522, "user_id": 7793894, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/yXNpu.jpg?s=128&g=1", "display_name": "Mitch", "link": "https://stackoverflow.com/users/7793894/mitch"}, "is_accepted": false, "score": 0, "last_activity_date": 1520459637, "creation_date": 1520459637, "answer_id": 49161849, "question_id": 49158362, "link": "https://stackoverflow.com/questions/49158362/how-to-set-a-different-link-in-each-cell-in-a-range/49161849#49161849", "title": "How to set a different link in each cell in a range?", "body": "<p>Just for reference, here is what I use to convert a phone number to an email for texting..setting it as a hyperlink in the current cell.</p>\n\n<pre><code>ActiveCell.Value = myNumbr \nSet myRange = ActiveCell \nActiveSheet.Hyperlinks.Add anchor:=myRange, Address:=\"mailto:\" &amp; myRange.Value, TextToDisplay:=myRange.Value`\n</code></pre>\n\n<p>Keep your code simple to start with, until you find a working script, then add other items. Make good use of the F8 key to step through your code to find out exactly where an error occurs.</p>\n"}], "owner": {"reputation": 153, "user_id": 4543962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1200d5e6f2313efc2141e9e43bef3793?s=128&d=identicon&r=PG", "display_name": "Mauricio Andr&#233;s", "link": "https://stackoverflow.com/users/4543962/mauricio-andr%c3%a9s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520459637, "creation_date": 1520445201, "last_edit_date": 1520446887, "question_id": 49158362, "link": "https://stackoverflow.com/questions/49158362/how-to-set-a-different-link-in-each-cell-in-a-range", "title": "How to set a different link in each cell in a range?", "body": "<p>I'm programming a Macro in VB for Excel 2013 that search for coincidences in different worksheets, and add a link to the cells that match.</p>\n\n<p>I'm havin torubles to insert the link in the cell, since the link must be different for a range of cells, I need help here.</p>\n\n<p>Here is my code</p>\n\n<pre><code>Dim bufferDetails As String\nDim tmpCell As String\nDim spot As String\nDim cell As Variant\nDim cellSpots As Variant\n\nFor Each cell In Worksheets(\"MMS-Locations\").Range(\"D2:D1833\")\n    If (cell.Value2 = \"NULL\") Then\n        cell.Value2 = \"NULL\"\n    Else\n        tmpCell = cell.Text\n        'A62\n        If (Left(tmpCell, 3) = \"A62\") Then\n            spot = spotName(tmpCell)\n            For Each cellSpots In Worksheets(\"DetailedMap\").Range(\"G60:CF123\")\n                If (cellSpots.Value2 = spot) Then\n                    For Each linkToSpot In Worksheets(\"MMS-Locations\").Range(\"H2:H1833\")\n                        Worksheets(\"MMS-Locations\").Hyperlinks.Add _\n                            Anchor:=Range(linkToSpot), _\n                            Address:=\"http://example.microsoft.com\", _\n                            ScreenTip:=\"Microsoft Web Site\", _\n                            TextToDisplay:=\"Microsoft\"\n\n                    Next linkToSpot\n                    Debug.Print (\"Encontrado \" + cellSpots)\n                End If\n            Next cellSpots\n        End If \n    End If\nNext cell\n\nEnd Sub\n\nFunction spotName(fullName As String) As String\n\nDim realSpot As String\nDim lenght As Integer\n\nlenght = Len(fullName) - 3\nrealSpot = Right(fullName, lenght)\n\nspotName = realSpot\n\nEnd Function\n</code></pre>\n\n<p>As I was thinking the linkToSpot variable contains the actual cell in the range, so I can move my selection of the sell, but my code fails in there with this error:</p>\n\n<p>Error in the Range method of the '_Global' object,</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1520444280, "post_id": 49157916, "comment_id": 85320954, "body": "What is your question?"}, {"owner": {"reputation": 11, "user_id": 5467752, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/GS6uE.jpg?s=128&g=1", "display_name": "Roxie", "link": "https://stackoverflow.com/users/5467752/roxie"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1520444510, "post_id": 49157916, "comment_id": 85321100, "body": "I would like to have my code also create this master Workbook creating Spreadsheet in the workbook for each Query result."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1520445232, "post_id": 49157916, "comment_id": 85321537, "body": "Why are you repeating code? And how does it <i>create 6 separate spreadsheets</i> when each line points to same workbook name. Look into <a href=\"https://msdn.microsoft.com/en-us/vba/access-vba/articles/docmd-transferspreadsheet-method-access\" rel=\"nofollow noreferrer\">DoCmd.TransferSpreadsheet</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1520584564, "creation_date": 1520584564, "answer_id": 49189594, "question_id": 49157916, "link": "https://stackoverflow.com/questions/49157916/save-multiple-access-query-resuts-to-separate-sheets-in-single-excel-workbook/49189594#49189594", "title": "Save multiple Access Query resuts to separate sheets in single Excel workbook", "body": "<p>The example below creates a <strong>new</strong> workbook with 6 sheets and through a helper method copies the queries to each sheet using the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-copyfromrecordset-method-excel\" rel=\"nofollow noreferrer\">Range.CopyFromRecordset</a> Method of Excel.</p>\n\n<p>For simplicity, I've assumed the queries have sequential names i.e. <em>MyTable1</em>, <em>MyTable2</em>, <em>MyTable3</em> etc. as shown in your example. If that's not the case, this will have to amended.</p>\n\n<pre><code>Sub ExportToExcel()\n\n    Dim rs As DAO.Recordset\n    Dim objApp As Object, objBook As Object, objSheet As Object\n    Dim idx As Long\n\n    Set objApp = CreateObject(\"Excel.Application\")\n        objApp.Visible = True\n    Set objBook = objApp.Workbooks.Add()\n\n    For idx = 1 To 6\n        With objBook\n            Set rs = CurrentDb().QueryDefs(\"MyTable\" &amp; idx).OpenRecordset()\n\n            'add sheet if needed\n            If .Sheets.Count &lt; idx Then .Sheets.Add After:=.Sheets(.Sheets.Count)\n            Set objSheet = objBook.Worksheets(idx)\n\n            'call helper\n            CopyFromRecordsetWithHeader rs, objSheet\n            rs.Close\n        End With\n    Next\nEnd Sub\n\nPrivate Sub CopyFromRecordsetWithHeader(rs As DAO.Recordset, objSheet As Object)\n\n    Dim idx As Long\n\n    'Create headers\n    For idx = 0 To rs.Fields.Count - 1\n        objSheet.Cells(1, idx + 1).Value = rs.Fields(idx).Name\n    Next\n\n    'Copy data\n    With objSheet\n        .Range(.Cells(1, 1), .Cells(1, rs.Fields.Count)).Font.Bold = True\n        .Range(\"A2\").CopyFromRecordset rs\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 5467752, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/GS6uE.jpg?s=128&g=1", "display_name": "Roxie", "link": "https://stackoverflow.com/users/5467752/roxie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1520584564, "creation_date": 1520443729, "last_edit_date": 1520581715, "question_id": 49157916, "link": "https://stackoverflow.com/questions/49157916/save-multiple-access-query-resuts-to-separate-sheets-in-single-excel-workbook", "title": "Save multiple Access Query resuts to separate sheets in single Excel workbook", "body": "<p>I have queries that pull data and create a workbook for each query. The workbooks are written to local drive.</p>\n\n<p>I manually add each tab/sheet to a Master workbook. I would like to have my code create this master Workbook with a sheet for each query result.</p>\n\n<p>This Code creates 6 separate spreadsheets;</p>\n\n<pre><code>Function PROC_WithoutRACF()\nOn Error GoTo WithoutRACF_Err\n\n    DoCmd.OutputTo acOutputQuery, \"MyTable1\", \"Excel97-Excel2003Workbook(*.xls)\", \"MyFileLocation.xls\", False, \"\", , acExportQualityPrint\n    DoCmd.OutputTo acOutputQuery, \"MyTable2\", \"Excel97-Excel2003Workbook(*.xls)\", \"MyFileLocation.xls\", False, \"\", , acExportQualityPrint\n    DoCmd.OutputTo acOutputQuery, \"MyTable3\", \"Excel97-Excel2003Workbook(*.xls)\", \"MyFileLocation.xls\", False, \"\", , acExportQualityPrint\n    DoCmd.OutputTo acOutputQuery, \"MyTable4\", \"Excel97-Excel2003Workbook(*.xls)\", \"MyFileLocation.xls\", False, \"\", , acExportQualityPrint\n    DoCmd.OutputTo acOutputQuery, \"MyTable5\", \"Excel97-Excel2003Workbook(*.xls)\", \"MyFileLocation.xls\", False, \"\", , acExportQualityPrint\n    DoCmd.OutputTo acOutputQuery, \"MyTable1\", \"Excel97-Excel2003Workbook(*.xls)\", \"MyFileLocation.xls\", False, \"\", , acExportQualityPrint\n\n\nWithoutRACF_Exit:\n    Exit Function\n\nWithoutRACF_Err:\n    MsgBox Error$\n    Resume WithoutRACF_Exit\n\nEnd Function\n</code></pre>\n\n<p>This code doesn't work </p>\n\n<pre><code>Function Proc_WithoutRACF_MySpreadsheet()\nOn Error GoTo WithoutRACF_Err\n\n    DoCmd.OutputTo acOutputQuery, \"MyTable1\", \"Excel97-Excel2003Workbook(*.xls)\", \"MyFileLocation.xls\", False, acExport, acSpreadsheetTypeExcel9, \"MyTable1\"\n    DoCmd.OutputTo acOutputQuery, \"MyTable2\", \"Excel97-Excel2003Workbook(*.xls)\", \"MyFileLocation.xls\", False, acExport, acSpreadsheetTypeExcel9, \"MyTable2\"\n    DoCmd.OutputTo acOutputQuery, \"MyTable3\", \"Excel97-Excel2003Workbook(*.xls)\", \"MyFileLocation.xls\", False, acExport, acSpreadsheetTypeExcel9, \"MyTable3\"\n    DoCmd.OutputTo acOutputQuery, \"MyTable4\", \"Excel97-Excel2003Workbook(*.xls)\", \"MyFileLocation.xls\", False, acExport, acSpreadsheetTypeExcel9, \"MyTable4\"\n    DoCmd.OutputTo acOutputQuery, \"MyTable5\", \"Excel97-Excel2003Workbook(*.xls)\", \"MyFileLocation.xls\", False, acExport, acSpreadsheetTypeExcel9, \"MyTable5\"\n    DoCmd.OutputTo acOutputQuery, \"MyTable6\", \"Excel97-Excel2003Workbook(*.xls)\", \"MyFileLocation.xls\", False, acExport, acSpreadsheetTypeExcel9, \"MyTable6\"\n\nWithoutRACF_Exit:\n    Exit Function\n\nWithoutRACF_Err:\n    MsgBox Error$\n    Resume WithoutRACF_Exit\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520453362, "post_id": 49157904, "comment_id": 85326182, "body": "ra is returning first match. ra.EntireRow that whole row. ra.CurrentRegion contiguous region around that cell (i.e. upto white space). You can use resize on ra with .EntireRow to get a specified number of rows."}, {"owner": {"reputation": 1, "user_id": 9458043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25842e71487b1fec887021d0d4756da5?s=128&d=identicon&r=PG&f=1", "display_name": "bin", "link": "https://stackoverflow.com/users/9458043/bin"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520454604, "post_id": 49157904, "comment_id": 85326839, "body": "I got a workaround by specify a large number of columns, say 100."}, {"owner": {"reputation": 1, "user_id": 9458043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25842e71487b1fec887021d0d4756da5?s=128&d=identicon&r=PG&f=1", "display_name": "bin", "link": "https://stackoverflow.com/users/9458043/bin"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520454646, "post_id": 49157904, "comment_id": 85326867, "body": "But I still don&#39;t know how to do the entire rows yet."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520457737, "post_id": 49157904, "comment_id": 85328450, "body": ".EntireRow is how you get the entire row. Range(&quot;A1&quot;).EntireRow is entire row so if find returns A1 put .EntireRow on the end of the variable you assign the find result to."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9458043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25842e71487b1fec887021d0d4756da5?s=128&d=identicon&r=PG&f=1", "display_name": "bin", "link": "https://stackoverflow.com/users/9458043/bin"}, "edited": false, "score": 0, "creation_date": 1520452103, "post_id": 49158164, "comment_id": 85325531, "body": "Range(ActiveCell, ActiveCell.End(xlDown)).EntireRow.Select selected rows at sheet1 where I run script."}], "tags": [], "owner": {"reputation": 32374, "user_id": 4, "user_type": "moderator", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/C5gBG.jpg?s=128&g=1", "display_name": "Joel Spolsky", "link": "https://stackoverflow.com/users/4/joel-spolsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1520444599, "creation_date": 1520444599, "answer_id": 49158164, "question_id": 49157904, "link": "https://stackoverflow.com/questions/49157904/copy-rows-not-currentregion-from-activecell-until-blank/49158164#49158164", "title": "Copy Rows (Not CurrentRegion) from Activecell Until Blank", "body": "<p>I'm not sure exactly if this is what you're trying to accomplish, but:</p>\n\n<ul>\n<li><code>ActiveCell</code> is the current cell  </li>\n<li><code>ActiveCell.End(xlDown)</code> is the cell you would go to if you pressed End Down, meaning, the last occupied cell below the current cell</li>\n<li><code>Range(ActiveCell, ActiveCell.End(xlDown))</code> is the range between those</li>\n</ul>\n\n<p>Since you said you want entire rows you need</p>\n\n<pre><code>  Range(ActiveCell, ActiveCell.End(xlDown)).EntireRow\n</code></pre>\n\n<p>Try</p>\n\n<pre><code>  Range(ActiveCell, ActiveCell.End(xlDown)).EntireRow.Select\n</code></pre>\n\n<p>to see if this is actually what you want; if so, replace the <code>.Select</code> with <code>.Copy</code></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9458043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25842e71487b1fec887021d0d4756da5?s=128&d=identicon&r=PG&f=1", "display_name": "bin", "link": "https://stackoverflow.com/users/9458043/bin"}, "edited": false, "score": 0, "creation_date": 1520452386, "post_id": 49158593, "comment_id": 85325684, "body": "Thanks! Rows(StartRow &amp; &quot;:&quot; &amp; StartRow + RegionRowCount - 1).Copy copied info from the sheet where I ran script. I need to find out how to refer to the rows i want to copy from. There are three sheets in the script."}, {"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "reply_to_user": {"reputation": 1, "user_id": 9458043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25842e71487b1fec887021d0d4756da5?s=128&d=identicon&r=PG&f=1", "display_name": "bin", "link": "https://stackoverflow.com/users/9458043/bin"}, "edited": false, "score": 0, "creation_date": 1520457522, "post_id": 49158593, "comment_id": 85328339, "body": "See edit to answer.  Added your xlSheet reference to rows().copy"}], "tags": [], "owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "is_accepted": false, "score": 0, "last_activity_date": 1520457478, "last_edit_date": 1520457478, "creation_date": 1520446092, "answer_id": 49158593, "question_id": 49157904, "link": "https://stackoverflow.com/questions/49157904/copy-rows-not-currentregion-from-activecell-until-blank/49158593#49158593", "title": "Copy Rows (Not CurrentRegion) from Activecell Until Blank", "body": "<p>CurrentRegion returns a Range object that represents a set of contiguous data. As long as the data is surrounded by one empty row and one empty column.\nThis should get you what you need.</p>\n\n<pre><code>Sub findRange(valueToFind)\n\nDim ra As Range\nDim xlSheet As Worksheet\nDim DestSheet As Worksheet\nDim lastRow As Long\n\nSet xlSheet = ActiveWorkbook.Worksheets(\"Sheet2\")\nSet DestSheet = Sheets(\"Sheet3\")\n\nSet ra = xlSheet.Cells.Find(What:=valueToFind, After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\nTrue, SearchFormat:=False)\n\nlastRow = DestSheet.Cells(DestSheet.Rows.Count, \"B\").End(xlUp).Row\n\nStartRow = ra.CurrentRegion.Rows(1).Row 'gets the starting row of you current region\nRegionRowCount = ra.CurrentRegion.Rows.Count 'counts the number of rows in your current region\n    'StartRow + RegionRowCount - 1 is used to get the last row of the CurrentRegion, -1 is because we counted the first row\nxlSheet.Rows(StartRow &amp; \":\" &amp; StartRow + RegionRowCount - 1).Copy _\nDestination:=DestSheet.Range(\"A\" &amp; lastRow + 1)\nEnd sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9458043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25842e71487b1fec887021d0d4756da5?s=128&d=identicon&r=PG&f=1", "display_name": "bin", "link": "https://stackoverflow.com/users/9458043/bin"}, "edited": false, "score": 0, "creation_date": 1520462906, "post_id": 49162474, "comment_id": 85330707, "body": "It works. but not the direct answer to the original question"}], "tags": [], "owner": {"reputation": 1, "user_id": 9458043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25842e71487b1fec887021d0d4756da5?s=128&d=identicon&r=PG&f=1", "display_name": "bin", "link": "https://stackoverflow.com/users/9458043/bin"}, "is_accepted": false, "score": 0, "last_activity_date": 1520462874, "last_edit_date": 1520462874, "creation_date": 1520462735, "answer_id": 49162474, "question_id": 49157904, "link": "https://stackoverflow.com/questions/49157904/copy-rows-not-currentregion-from-activecell-until-blank/49162474#49162474", "title": "Copy Rows (Not CurrentRegion) from Activecell Until Blank", "body": "<p>Really appreciate all the help!!! Never used VBA before. It gave me confidence to continue. Thanks very much.</p>\n\n<p>There must be several ways to solve the problem. I am ok with currentregion-offset-resize.</p>\n\n<pre><code>Sub findRange(valueToFind)\n\nDim ra As Range\nDim xlSheet As Worksheet\nDim DestSheet As Worksheet\nDim lastRow As Long\nDim StartRow As Long, RegionRowCount As Long\n\nApplication.ScreenUpdating = False\n\nSet xlSheet = ActiveWorkbook.Worksheets(\"Sheet2\")\nSet DestSheet = Sheets(\"Sheet3\")\n\nlastRow = DestSheet.Cells(DestSheet.Rows.Count, \"B\").End(xlUp).Row\n\nSet ra = xlSheet.Cells.Find(What:=valueToFind, After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\nTrue, SearchFormat:=False)\n\nra.CurrentRegion.Resize(, 100).Copy _\nDestination:=DestSheet.Range(\"A\" &amp; lastRow + 1)\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9458043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/25842e71487b1fec887021d0d4756da5?s=128&d=identicon&r=PG&f=1", "display_name": "bin", "link": "https://stackoverflow.com/users/9458043/bin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1520462874, "creation_date": 1520443685, "last_edit_date": 1520449130, "question_id": 49157904, "link": "https://stackoverflow.com/questions/49157904/copy-rows-not-currentregion-from-activecell-until-blank", "title": "Copy Rows (Not CurrentRegion) from Activecell Until Blank", "body": "<p>I tried to find activecell and copy current region. But I need to copy entire rows instead. </p>\n\n<p><img src=\"https://i.stack.imgur.com/NfrRp.png\" alt=\"Picture(Target)\"></p>\n\n<p>Existing code:</p>\n\n<pre><code>Sub findRange(valueToFind)\n\n    Dim ra As Range\n    Dim xlSheet As Worksheet\n    Dim DestSheet As Worksheet\n    Dim lastRow As Long\n\n    Set xlSheet = ActiveWorkbook.Worksheets(\"Sheet2\")\n    Set DestSheet = Sheets(\"Sheet3\")\n\n    Set ra = xlSheet.Cells.Find(What:=valueToFind, After:=ActiveCell, LookIn:=xlFormulas, LookAt _\n    :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _\n    True, SearchFormat:=False)\n\n    lastRow = DestSheet.Cells(DestSheet.Rows.Count, \"B\").End(xlUp).Row\n\n    ra.CurrentRegion.Copy _\n    Destination:=DestSheet.Range(\"A\" &amp; lastRow + 1)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520444589, "post_id": 49157860, "comment_id": 85321150, "body": "Could you please attach the relevant codes from the macros and/or buttons?"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 1, "creation_date": 1520461221, "post_id": 49157860, "comment_id": 85330023, "body": "A network failure could cause Excel to hang or fail to load."}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520461520, "post_id": 49157860, "comment_id": 85330157, "body": "@Mistella Not a problem! I&#39;ve added it to the post.   HackSlash, that&#39;s possible. We are accessing it through a network. But it consistently works as soon as we open the problem workbook and save it again. Any idea what would cause a network error?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520470737, "post_id": 49157860, "comment_id": 85333070, "body": "Have you tried to cause the freezing issue (via the saving order you mention) while stepping through the code? If so, do you have any idea which line(s) may be problematic? Or does the freezing only happen while the macro is running freely?"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1520482959, "post_id": 49157860, "comment_id": 85336047, "body": "Your code seems to be missing bits. Where is <code>Err:</code> ?"}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520516012, "post_id": 49157860, "comment_id": 85353629, "body": "@Mistella I have. When I trigger the line that opens the workbook it does open (the name shows up on the title bar), but that&#39;s when it gets stuck. AJD, I removed some of the code to declutter it, but I missed that piece. <code>Err:</code> displays a msgbox, then turns EnableEvents and ScreenUpdating back on."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520519353, "post_id": 49157860, "comment_id": 85356026, "body": "And the value of the variable <code>FileName</code> is the actual name of an existing file when that happens? Another thing to check: when I&#39;m stepping past a <code>Workbook.Open</code>, for some reason the macro sometimes starts running freely instead of stopping on the next line. Have you tried putting a breakpoint at <code>Set IWBI = IWB.Sheets(&quot;Invoice&quot;)</code> before stepping into the <code>Workbook.Open</code> line? This could help verify that it&#39;s the <code>Workbook.Open</code> line that&#39;s causing an issue, and not some code later in the sub."}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "edited": false, "score": 0, "creation_date": 1520520618, "post_id": 49157860, "comment_id": 85356977, "body": "Yes, <code>FileName</code> matches the actual name of the file. And when I step through it stops exactly at the <code>Workbook.Open</code> line. I put a break there, and as soon as I execute that line it acts like it&#39;s opening the file, and it displays the name up top, but it just hangs. 2 other notes: (1) This macro worked fine for several months, but started causing issues after a recent system overhaul. (2) It works most of the time. The <i>only</i> time it hangs is when I save it in the sequence mentioned earlier."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520522373, "post_id": 49157860, "comment_id": 85358297, "body": "@qctjulian When opening the workbooks: Is it the same workbook that the code always freezes on opening, or does it freeze regardless of which workbook it&#39;s trying to open? Do any of the workbooks you&#39;re opening have any macros of their own, triggered by being opened?"}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520524581, "post_id": 49157860, "comment_id": 85359824, "body": "@Mistella Yes. It will consistently lock up on the same file. Opening it and re-saving that file using the <i>same macro</i> fixes the problem, but that&#39;s a pain when you&#39;re dealing with 6-8 files per job. Oh, and it has to be closed, then opened and re-saved to fix it. Just running the macro again won&#39;t fix it. The problem is duplicable; we run 2 machines and it happens on both.  The workbooks that are being opened do have macros that run when opened, but I&#39;ve tried running it with <code>Application.EnableEvents</code> both <code>True</code> and <code>False</code> and neither helps."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520526649, "post_id": 49157860, "comment_id": 85361319, "body": "@qctjulian I know, with userforms, that sometimes when the vba is busy for a long time, that can cause excel to stop responding. A fix to that is to add a <code>DoEvents</code> line before the <code>Next item</code> line in <code>For</code> loops; or before the <code>Wend</code> line in <code>While</code> loops. <b>Maybe</b> if you put <code>DoEvents</code> right after the <code>Workbook.Open</code> line, and inside other code loops in the other macros (particularly in the trouble workbook), it would help prevent Excel from freezing."}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520527889, "post_id": 49157860, "comment_id": 85362079, "body": "@Mistella Another good point. I ran across the <code>DoEvents</code> option yesterday, but no luck there either. The length of the macro doesn&#39;t seem to affect when it locks up. I can have anywhere from 2 to 6 workbooks, and the same one will lock it up regardless where it is in sequence. It seems to be something with how the workbook is saved, but I have yet to find any consistent cause."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520531423, "post_id": 49157860, "comment_id": 85364256, "body": "@qctjulian Could it be a file size issue? Is the trouble workbook significantly larger than the other workbooks?"}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "edited": false, "score": 0, "creation_date": 1520532594, "post_id": 49157860, "comment_id": 85364876, "body": "Not significantly. I tested it on 2 workbooks, and the first one (which worked fine with the compile macro) was 210kb. The second one (which didn&#39;t work) was 211kb. When I opened the second one and re-saved it the file size dropped to 204kb. Then the macro worked, no problem. Do you think something is going on there?"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520541384, "post_id": 49157860, "comment_id": 85369619, "body": "Since the issue is just related to the one specific workbook, I&#39;m starting to suspect that there might be an issue with one of the macro&#39;s within that workbook. <i>(I am assuming that when that workbook is opened via the code, that it&#39;s macro(s) are kicked-off.)</i> Would you be able to post any of that code?"}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "edited": false, "score": 0, "creation_date": 1520542637, "post_id": 49157860, "comment_id": 85370259, "body": "Sorry, I hope I didn&#39;t confuse the issue with that last comment. The 2 workbooks I tested were from the same template. The only difference between them is a few small bits of info. I&#39;d be glad to post more code for the workbook, but it has quite a bit in it. Is there something specific you&#39;re looking for?"}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "edited": false, "score": 0, "creation_date": 1520543038, "post_id": 49157860, "comment_id": 85370460, "body": "I just tried stepping through the <code>Workbooks.Open</code> portion with the workbook that works, and nothing is triggered (at least nothing that shows up in the VBA window) when I open the workbook. It goes from the <code>Workbooks.Open</code> line straight to the <code>Set IWBI</code> line. For what that&#39;s worth..."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520543594, "post_id": 49157860, "comment_id": 85370722, "body": "Where does the compile macro fit into the code flow?. The other two you posted, you mentioned are activated by a button. Are they activated any other way? What activates the compile macro? Is it in the same workbooks, or a different one?"}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "edited": false, "score": 1, "creation_date": 1520543807, "post_id": 49157860, "comment_id": 85370817, "body": "The compile macro resides in a third workbook, which contains basic information about the job and customer and is used to create prefilled workbooks from templates. The compile macro is triggered by a button within that workbook. None of the three are activated any way other than a button press."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520544525, "post_id": 49157860, "comment_id": 85371189, "body": "You said the issue only happens when you do the save/reset and then the save/save as macros. You also said it only happens with one specific workbook. Is that specific workbook the only one in which you&#39;ve used the saving macros in that order? Or have you tested the macro order with a different workbook? Also, does the trouble workbook always have issues, or only after using the saving macros in the issue-triggering order?"}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "edited": false, "score": 0, "creation_date": 1520545210, "post_id": 49157860, "comment_id": 85371577, "body": "As in, we have one template. We fill it out, and hit &quot;Save &amp; Reset&quot;. We fill another, and hit &quot;Save.&quot; Now we have 2 workbooks from the same template. The first one works fine with the compile macro, but the second one causes the issue. Any other that we create after the second one will have the same issue until we open it and re-save (using the same macro that we used to save it in the first place). It&#39;s maddening... If we create 6, #2-6 will all freeze the compile macro. #1 works, #2 freezes. Re-save #2, and #3 will freeze it."}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "edited": false, "score": 0, "creation_date": 1520545248, "post_id": 49157860, "comment_id": 85371597, "body": "Also, this is the only workbook we use that both saves and resets in the same macro, but we use the same basic macro in several other workbooks. Thanks for your help in trying to resolve this thing!"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520546278, "post_id": 49157860, "comment_id": 85372134, "body": "Clarification question: #1 (<i>works fine</i>) is from <code>ThisWorkbook.SaveAs &quot;\\\\qctnas\\Google Drive\\Production\\&quot; &amp; FldrName &amp; &quot;\\&quot; &amp;  ThisFile &amp; &quot;.xlsm&quot;, 52</code> and #2 (<i>problematic</i>) is from <code>ThisWorkbook.SaveAs &quot;\\\\qctnas\\Google Drive\\Production\\- IP Proposal\\QCT Proposal &quot; &amp; _  &quot;.xlsm&quot;, 52</code>?"}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "edited": false, "score": 0, "creation_date": 1520546852, "post_id": 49157860, "comment_id": 85372399, "body": "<code>ThisWorkbook.SaveAs &quot;\\\\qctnas\\Google Drive\\Production\\- IP Proposal\\QCT Proposal &quot; &amp; _ &quot;.xlsm&quot;, 52</code> saves it as an intermediary file. It saves as that one to protect #1 after it&#39;s completed. We don&#39;t want to clear the values on the original lest it gets saved after it&#39;s cleared and that one gets overwritten. So that one happens between #1 and #2. Each workbook being referenced in the compile macro (where the issue happens) has been saved using the <code>ThisWorkbook.SaveAs &quot;\\\\qctnas\\Google Drive\\Production\\&quot; &amp; FldrName &amp; &quot;\\&quot; &amp; ThisFile &amp; &quot;.xlsm&quot;, 52</code> line."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520548642, "post_id": 49157860, "comment_id": 85373180, "body": "Is this a typo from you posting the code or is this line actually missing the underline space at the line break: <code>ThisWorkbook.SaveAs &quot;\\\\qctnas\\Google Drive\\Production\\&quot; &amp; FldrName &amp; &quot;\\&quot; &amp;  ThisFile &amp; &quot;.xlsm&quot;, 52</code>   vs: <code>ThisWorkbook.SaveAs &quot;\\\\qctnas\\Google Drive\\Production\\&quot; &amp; FldrName &amp; &quot;\\&quot; &amp; _ ThisFile &amp; &quot;.xlsm&quot;, 52</code>"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520548812, "post_id": 49157860, "comment_id": 85373242, "body": "Wasn&#39;t sure that was clear. Just in case you&#39;re unaware, when vba code wraps around to the line below, it needs to be indicated by including: &quot; _&quot; at the end of every line except the last physical line of the code line/block (without the quotation marks) Similar to what was done with the intermediate saving."}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "edited": false, "score": 0, "creation_date": 1520602621, "post_id": 49157860, "comment_id": 85394707, "body": "Ah, yes. That&#39;s a typo here. In the workbook it&#39;s all on one line."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1520625343, "post_id": 49157860, "comment_id": 85407519, "body": "Have you tried commenting-out the <code>On Error Resume Next</code> lines, then running through the macro order? If it is an issue with the saving, it&#39;s possible that the <code>Resume Next</code> line is masking any other error messages that may be helpful."}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "edited": false, "score": 0, "creation_date": 1521034954, "post_id": 49157860, "comment_id": 85561173, "body": "I have, yes. The <code>On Error Resume Next</code> line just jumps it down if the workbook already exists. The <code>SaveAs</code> line throws an error if a file with that name already exists in that location, so the next line saves it instead. I thought the fact that it saves it the second time might be the reason why it works after re-opening it and saving it, but that cycle only works if the workbook is closed as well. Just re-saving it won&#39;t fix it."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1521467470, "post_id": 49157860, "comment_id": 85729547, "body": "That&#39;s interesting. I have <b>Excel 2016</b>, and the <code>.SaveAs</code> does not throw an error. It opens a message box warning about the file already existing <i>unless</i> the <code>Application.DisplayAlerts = False</code>. If the warning is suppressed, then the <code>SaveAs</code> simply overwrites the existing file. I have been unable to get to a situation (with or without the <code>On Error Resume Next</code>) where this <code>If ThisWorkbook.Saved = False</code> is true and leads to the <code>ThisWokbook.Save</code> line. What version of Excel do you have?"}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "edited": false, "score": 0, "creation_date": 1521561081, "post_id": 49157860, "comment_id": 85778874, "body": "Excel 365. I tried it without the <code>Resume Next</code> line and it saved fine like you said. It&#39;s been a while since I wrote that part, so it may have been an oversight at that point. I&#39;ve learned most of what I know within the last year, and I must have written that code before I started using <code>Application.DisplayAlerts = False</code>. I updated the code in my workbook. Cleaner is always better! I&#39;ll report back on whether or not that helps our problem."}, {"owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1525186347, "post_id": 49157860, "comment_id": 87254628, "body": "Just following up on this one. Changing the <code>Save As</code> section seemed to fix the problem. It now simply turns off <code>Application.DisplayAlerts</code> before saving. I&#39;m not sure why that would have caused the problem, but apparently it did. But it&#39;s working smoothly now, and has been for about a month. Thanks for your help @Mistella!"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1525190648, "post_id": 49157860, "comment_id": 87256974, "body": "@qctjulian I&#39;m glad I could help. I would also like to explain that since we hope such questions will be useful for future coders, generally instead of editing the question to contain the corrected code; it is encouraged to post an answer (an accept it?). This also indicates to the rest of the community that this question has been answered."}], "answers": [{"comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1525190815, "post_id": 50119838, "comment_id": 87257053, "body": "Unfortunately, I do not have the reputation to roll the question back (to before-corrected problematic code), so that this answer makes sense."}], "tags": [], "owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "is_accepted": true, "score": 0, "last_activity_date": 1525190737, "creation_date": 1525190737, "answer_id": 50119838, "question_id": 49157860, "link": "https://stackoverflow.com/questions/49157860/excel-freezes-when-using-vba-to-open-a-workbook-from-network/50119838#50119838", "title": "Excel freezes when using VBA to open a workbook from network", "body": "<p>Cleaning the below code fixed the issue. Not sure why.</p>\n\n<p><em>Changed this:</em></p>\n\n<pre><code>On Error Resume Next\nThisWorkbook.SaveAs \"\\\\qctnas\\Google Drive\\Production\\\" &amp; FldrName &amp; \"\\\" &amp; _\nThisFile &amp; \".xlsm\", 52\nIf ThisWorkbook.Saved = False Then ThisWorkbook.Save\nOn Error GoTo 0\n</code></pre>\n\n<p><em>to this:</em></p>\n\n<pre><code>ThisWorkbook.SaveAs \"\\\\qctnas\\Google Drive\\Production\\\" &amp; FldrName &amp; \"\\\" &amp; _\nThisFile &amp; \".xlsm\", 52\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9457783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a27d9b22c773fcca1386b3c1a7635088?s=128&d=identicon&r=PG&f=1", "display_name": "qctjulian", "link": "https://stackoverflow.com/users/9457783/qctjulian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 0, "accepted_answer_id": 50119838, "answer_count": 1, "score": 0, "last_activity_date": 1525190737, "creation_date": 1520443546, "last_edit_date": 1521561219, "question_id": 49157860, "link": "https://stackoverflow.com/questions/49157860/excel-freezes-when-using-vba-to-open-a-workbook-from-network", "title": "Excel freezes when using VBA to open a workbook from network", "body": "<p>I have an odd problem. The cabinetry business I work for uses an Excel workbook for pricing. We price the job in sections which are saved in multiple workbooks, and after we're done we have a macro which compiles the prices into one file. All our files are stored on a NAS which is accessed through the network.</p>\n\n<p>Here's where it gets strange. Occasionally, when compiling the prices, the macro will freeze while opening the source workbook. No error, it just gets stuck loading. I can tell by walking through the code that it does open the workbook, but it instantly gets stuck. I've tried it with and without Application.EnableEvents enabled, and neither one works. It's being opened as read-only, with update links turned off.</p>\n\n<p>On our pricing worksheet we have 2 buttons, one which names and saves the file, the other which does the same plus resetting the workbook for the next section of the job. The save portions of both macros are nearly identical, the main difference being the reset portion. The problem I described <em>only</em> happens when I first use the \"Save &amp; Reset\" button, then reprice it and use the \"Save/Save As\" button. The first workbook works fine during compilation, the second freezes it. If I open the problem workbook and re-save it the problem goes away. I've been hammering my head against this one all morning and I have yet to figure out what's going on. Any direction would be greatly appreciated!</p>\n\n<p><strong>Code</strong></p>\n\n<p>Save/Save As macro</p>\n\n<pre><code>Dim FldrName, ThisFile As String\n\nThisFile = Sheet3.Range(\"FileName\")\nFldrName = Sheet3.Range(\"FolderName\")\n\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\n\nThisWorkbook.SaveAs \"\\\\qctnas\\Google Drive\\Production\\\" &amp; FldrName &amp; \"\\\" &amp; _\nThisFile &amp; \".xlsm\", 52\n\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\n</code></pre>\n\n<p>Save and Reset macro</p>\n\n<pre><code>Dim FldrName, ThisFile As String\nDim Ans As Integer\n\n'This section is identical to the previous macro\n\nThisFile = Sheet3.Range(\"FileName\")\nFldrName = Sheet3.Range(\"FolderName\")\n\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\n\nThisWorkbook.SaveAs \"\\\\qctnas\\Google Drive\\Production\\\" &amp; FldrName &amp; \"\\\" &amp; _\nThisFile &amp; \".xlsm\", 52\n\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\n\n\nBefore  'A simple sub which turns off EnableEvents, ScreenUpdating, and DisplayAlerts\n\nThisWorkbook.SaveAs \"\\\\qctnas\\Google Drive\\Production\\- IP Proposal\\QCT Proposal\" &amp; _ \n\".xlsm\", 52  'Saves as a copy to keep the original from being changed\n\n'This portion resets the values on the workbook\n\nAns = MsgBox(\"Reset Specs?\", vbYesNo + vbQuestion)\n\nIf Ans = 6 Then\n    With Sheet3\n        .Range(\"ChangeToNA\").Value = \"Not applicable\"\n        .Range(\"ChangeToChooseFinish\").Value = \"CHOOSE FINISH\"\n        .Range(\"ChangeToYes\").Value = \"Yes\"\n        .Range(\"ChangeToNo\").Value = \"No\"\n        .Range(\"ChangeToStandard\").Value = \"Standard\"\n        .Range(\"JIEmptyThese\").Value = \"\"\n        .Range(\"CMAP\").Value = 50\n    End With\nElse\n    Sheet3.Range(\"JIEmptyWhenNotReset\").Value = \"\"\nEnd If\n\nWith Sheet11\n    .Range(\"DCEmptyThese\").Value = \"\"\n    .Range(\"ChangeTo1\").Value = \"1\"\n    .Range(\"ChangeTo4\").Value = \"4\"\"\"\n    .Range(\"MiscCrown\").Value = \"(Misc. Crown)\"\n    .Range(\"MiscMolding\").Value = \"(Misc. Molding)\"\n    .Range(\"ChangeToShipV\").Value = \"(Ship/V)\"\n    .Range(\"ChangeTo8Dollars\").Value = 8\nEnd With\n\nWith Sheet2\n    .Range(\"IEmptyThese\").Value = \"\"\n    .Range(\"DeleteValidationInThese\").Validation.Delete\nEnd With\n\nSheet2.Unprotect\nApplication.Goto Sheet2.Range(\"a68\"), True\nSheet2.Range(\"b82\").Select\n\nApplication.Goto Sheet11.Range(\"a1\"), True\nSheet11.Range(\"b4\").Select\n\nSheet3.Unprotect\nApplication.Goto Sheet3.Range(\"DelDrop\").Offset(-1, -2), True\nSheet3.Range(\"DelDrop\").Select\n\nAfter  'Mirrors the Before sub\n</code></pre>\n\n<p>Compilation Macro</p>\n\n<pre><code>Dim IWB As Workbook\nDim IWBJ, IWBI As Worksheet\nDim FldrName, JobFldr, FileName As String\n\nBefore\n\nJobFldr = Sheet1.Range(\"FolderName\")\nFldrName = \"\\\\qctnas\\Google Drive\\Production\\\" &amp; JobFldr &amp; \"\\\"\n\nFileName = Dir(FldrName &amp; \"*QCT Proposal*.xlsm\")\n\nDo While FileName &lt;&gt; \"\"\n    Set IWB = Workbooks.Open(FldrName &amp; FileName, False, True)\n    Set IWBI = IWB.Sheets(\"Invoice\")\n    Set IWBJ = IWB.Sheets(\"Job Info\")\n\n    'Copy info\n\n    FileName = Dir()\nLoop\n\nAfter\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1520445520, "post_id": 49157813, "comment_id": 85321708, "body": "Where on the form is the data getting populated to?  A listbox or something?"}, {"owner": {"reputation": 145, "user_id": 7468987, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e631c71d841a754cac8af47e0ff55b65?s=128&d=identicon&r=PG&f=1", "display_name": "mabanger", "link": "https://stackoverflow.com/users/7468987/mabanger"}, "reply_to_user": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 0, "creation_date": 1520446261, "post_id": 49157813, "comment_id": 85322135, "body": "Yes, at least, this is what I would like to achieve"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1520446748, "post_id": 49157813, "comment_id": 85322397, "body": "Range.Show just scrolls the window, in short, it behaves like goto that cell.   You don&#39;t show anywhere in your example where you try and load the contents of your range into a textbox, listbox another combobox ect on your form. If you are loading it into a listbox combobox then just loop though the cells and <code>.AddItem CellValue</code>"}], "answers": [{"tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": true, "score": 1, "last_activity_date": 1520447745, "last_edit_date": 1520447745, "creation_date": 1520447345, "answer_id": 49158926, "question_id": 49157813, "link": "https://stackoverflow.com/questions/49157813/userform-listbox-to-show-values-from-a-range/49158926#49158926", "title": "Userform listbox to show values from a range", "body": "<p>Here's one way to do it:</p>\n\n<p><strong>1. Add some named ranges to your worksheet</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/0BTOo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0BTOo.png\" alt=\"enter image description here\"></a></p>\n\n<p>The range <code>B2:C3</code> has been assigned to a named range called <code>Name1</code>. The range <code>E2:F3</code> assigned to <code>Name2</code>, etc.</p>\n\n<hr>\n\n<p><strong>2. Create a userform with a <code>ComboBox</code> and a <code>ListBox</code></strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/lXUbX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lXUbX.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p><strong>3. Place the following code in the relevant modules:<br/></strong></p>\n\n<p><em>Userform1 module</em></p>\n\n<pre><code>Private Sub UserForm_Initialize()\n    ComboBox1.List = Array(\"Name1\", \"Name2\", \"Name3\", \"Name4\")\nEnd Sub\n\nPrivate Sub ComboBox1_Change()\n    Dim n As Name\n    Set n = ThisWorkbook.Names(ComboBox1.Value)\n\n    If Not n Is Nothing Then\n        ListBox1.RowSource = n.RefersToRange.Address\n        ListBox1.ColumnCount = n.RefersToRange.Columns.Count\n    End If\nEnd Sub\n</code></pre>\n\n<p><em>Any standard module</em></p>\n\n<pre><code>Public Sub ShowUserform()\n    With New UserForm1\n        .Show vbModal\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><strong>4. Run the <code>ShowUserform</code> sub from the standard module and select a name!</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/cgX4y.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/cgX4y.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 145, "user_id": 7468987, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e631c71d841a754cac8af47e0ff55b65?s=128&d=identicon&r=PG&f=1", "display_name": "mabanger", "link": "https://stackoverflow.com/users/7468987/mabanger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3382, "favorite_count": 0, "accepted_answer_id": 49158926, "answer_count": 1, "score": 3, "last_activity_date": 1520449143, "creation_date": 1520443392, "last_edit_date": 1520449143, "question_id": 49157813, "link": "https://stackoverflow.com/questions/49157813/userform-listbox-to-show-values-from-a-range", "title": "Userform listbox to show values from a range", "body": "<p>I'm trying to create a Userform in Excel, where I have one ComboBox and based on the value chosen, values from a range of cells are to be shown in a listbox on the Userform.</p>\n\n<p>So far I have this.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\nWith ComboBox1()\n   .AddItem \"Item1\"\n   .AddItem \"Item2\"\n   .AddItem \"Item3\"\n   .AddItem \"Item4\"\n   .AddItem \"Item5\"\n   .AddItem \"Item6\"\n   .AddItem \"Item7\"\nEnd With\n\nEnd Sub\n\n\nSub ComboBox1_Change()\n\n    If ComboBox1.ListIndex = Outlook Then\n        Range(\"A3:B11\").Show\n    Else\n        If ComboBox1.ListIndex = NoNetwork Then\n            Range(\"C3:D11\").Show\n        End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>If I change <code>Range(\"A3:B11\").Show</code> to <code>Range(\"A3:B11\").Select</code> it will select this range.</p>\n\n<p>How do I instead show the data from this range on the UserForm?</p>\n"}, {"tags": ["excel", "vba", "replace"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520443941, "post_id": 49157688, "comment_id": 85320768, "body": "Okay? Do you get an error? Does it not give an error, but produces an unexpected outcome? What&#39;s the question?"}, {"owner": {"reputation": 9, "user_id": 7692312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658ea867cf94ef67d5cf9d1138030d45?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob MF", "link": "https://stackoverflow.com/users/7692312/jacob-mf"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520444355, "post_id": 49157688, "comment_id": 85320999, "body": "Sorry, thre was no error. The picture shows the outcome of running the replace. My intention was to replace with the formatting with MM/DD/YY H:MM AM/PM"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 7692312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658ea867cf94ef67d5cf9d1138030d45?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob MF", "link": "https://stackoverflow.com/users/7692312/jacob-mf"}, "edited": false, "score": 0, "creation_date": 1520449505, "post_id": 49158402, "comment_id": 85324046, "body": "Thanks Mr.Wayne. This appear to work, however, I have this inside of a loop where the formatting between each loop instance."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 9, "user_id": 7692312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658ea867cf94ef67d5cf9d1138030d45?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob MF", "link": "https://stackoverflow.com/users/7692312/jacob-mf"}, "edited": false, "score": 0, "creation_date": 1520449575, "post_id": 49158402, "comment_id": 85324078, "body": "@JacobMF - Then you can just do that format once, or perhaps create a list of formatting? In any case, that sounds like it would be a new question altogether."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 9, "user_id": 7692312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658ea867cf94ef67d5cf9d1138030d45?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob MF", "link": "https://stackoverflow.com/users/7692312/jacob-mf"}, "edited": false, "score": 0, "creation_date": 1520555211, "post_id": 49158402, "comment_id": 85375236, "body": "@JacobMF - Did this answer work for you? If so, you can flag as the answer by clicking the check mark left of the post, and it removes this post from the Unanswered queue."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1520445335, "creation_date": 1520445335, "answer_id": 49158402, "question_id": 49157688, "link": "https://stackoverflow.com/questions/49157688/excel-cell-replace-issue/49158402#49158402", "title": "Excel Cell.Replace issue", "body": "<p>You can use find/replace, and use a specified format when replacing.  Add this line above the <code>Cells.Replace...</code> line:</p>\n\n<pre><code>Application.ReplaceFormat.NumberFormat = \"MM/DD/YYYY H:MM AM/PM\"\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 7692312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/658ea867cf94ef67d5cf9d1138030d45?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob MF", "link": "https://stackoverflow.com/users/7692312/jacob-mf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1520449161, "creation_date": 1520442957, "last_edit_date": 1520449161, "question_id": 49157688, "link": "https://stackoverflow.com/questions/49157688/excel-cell-replace-issue", "title": "Excel Cell.Replace issue", "body": "<p>When I'm using Cell.Replace to replace a variable with a date excel changes my date formatting. (See picture)</p>\n\n<p>I've tried changing the ReplaceFormat option to True... see below</p>\n\n<pre><code>Cells.Replace What:=VariableName, Replacement:=VariableValue, LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=True\n</code></pre>\n\n<p><a href=\"https://photos.app.goo.gl/JswS61eYiKEC6EUt2\" rel=\"nofollow noreferrer\">https://photos.app.goo.gl/JswS61eYiKEC6EUt2</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5283, "user_id": 485674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720c6f1a3dead1c68d0f42776633d4d?s=128&d=identicon&r=PG", "display_name": "Jon Peltier", "link": "https://stackoverflow.com/users/485674/jon-peltier"}, "edited": false, "score": 0, "creation_date": 1520909502, "post_id": 49157459, "comment_id": 85498773, "body": "What code are you using which isn&#39;t working as you&#39;d like? Did you select the range and use <code>Selection.CopyPicture  Appearance:=xlScreen, Format:=xlBitmap</code>? Alternatively <code>Worksheets(&quot;SheetName&quot;),Range(&quot;A1:J20&quot;).CopyPicture  Appearance:=xlScreen, Format:=xlBitmap</code>"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 9457910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "JCo", "link": "https://stackoverflow.com/users/9457910/jco"}, "is_accepted": false, "score": 1, "last_activity_date": 1520961912, "creation_date": 1520961912, "answer_id": 49262286, "question_id": 49157459, "link": "https://stackoverflow.com/questions/49157459/how-to-copy-excel-range-including-the-charts-and-graphs-and-paste-it-as-a-single/49262286#49262286", "title": "How to copy Excel range including the charts and graphs and paste it as a single image?", "body": "<p>The lines of code posted below worked for me. I was trying to create an auto-mailer for a report that my team sends every hour. To decrease their time spent on running, copying, and pasting the report on Outlook, I automated most of the processes involved in the report. The question that I posted here on stackoverflow (thanks @Levon for the edit) was the problem I ran into. It's incredible what you can learn by running the Record Macro function in Excel. I recorded the actions from range selection, copying, and pasting as picture on Excel and that's how I got the necessary codes needed to solve the problem.</p>\n\n<pre><code>Dim xOutlook As Object, _\n    xEmail As Object, _\n    xInspector As Object, _\n    wEditor As Object, _\n    lastRow As Long, _\n    pic As Picture\n\nSheets(\"Report\").Select\n\nlastRow = Cells(Rows.Count, \"F\").End(xlUp).Row\n\nRange(Cells(1, 6), Cells(lastRow, 23)).Select\nSelection.Copy\nSheets(\"Report\").Range(\"AJ1\").Select\nSheets(\"Report\").Pictures.Paste.Select\n\nSet pic = Selection\n\npic.ShapeRange.LockAspectRatio = msoTrue\npic.ShapeRange.ScaleWidth 0.9, msoTrue\npic.Copy\n\nSet xOutlook = CreateObject(\"Outlook.Application\")\nSet xEmail = xOutlook.CreateItem(olMailItem)\nSet xInspector = xEmail.GetInspector\nSet wEditor = xInspector.WordEditor\n\nWith xEmail\n    .Display\n    .To = \"\"\n    .CC = \"\"\n    .BCC = \"\"\n    .Subject = \"Test\"\n    .Body = \"\" &amp; vbCrLf\n    wEditor.Application.Selection.Start = Len(.Body)\n    wEditor.Application.Selection.End = wEditor.Application.Selection.Start\n    wEditor.Application.Selection.Paste\n    pic.Delete\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9457910, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "JCo", "link": "https://stackoverflow.com/users/9457910/jco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1845, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520961912, "creation_date": 1520442118, "last_edit_date": 1531164843, "question_id": 49157459, "link": "https://stackoverflow.com/questions/49157459/how-to-copy-excel-range-including-the-charts-and-graphs-and-paste-it-as-a-single", "title": "How to copy Excel range including the charts and graphs and paste it as a single image?", "body": "<p>Using VBA, I can copy and paste an Excel range to outlook as an image or as an HTML table. I can also copy and paste a single chart/graph from Excel into Outlook as an image. Now, I have this Excel sheet that has multiple tables and charts. I would like to be able to copy and paste all tables and charts from the excel sheet into Outlook as a single image using VBA. Is there a way to do that? It would be like copying everything that's on the selected range including the charts and graphs overlaid on top of it into outlook using VBA.</p>\n"}, {"tags": ["vba", "outlook", "excel-2010"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1520441997, "post_id": 49157370, "comment_id": 85319567, "body": "Have you added reference to the Outlook object model? If not, <code>Outlook.MailItem</code> declaration will raise that sort of error."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1520442056, "post_id": 49157370, "comment_id": 85319612, "body": "<a href=\"https://stackoverflow.com/questions/5349580/compiler-error-user-defined-types-not-defined\" title=\"compiler error user defined types not defined\">stackoverflow.com/questions/5349580/&hellip;</a>"}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1520442065, "post_id": 49157370, "comment_id": 85319617, "body": "<a href=\"https://stackoverflow.com/questions/3119207/sending-http-requests-with-vba-from-word\" title=\"sending http requests with vba from word\">stackoverflow.com/questions/3119207/&hellip;</a>"}, {"owner": {"reputation": 9, "user_id": 9457784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba5873bd3562d8c29dde5707e53cf91?s=128&d=identicon&r=PG&f=1", "display_name": "SCJ10", "link": "https://stackoverflow.com/users/9457784/scj10"}, "reply_to_user": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1520443089, "post_id": 49157370, "comment_id": 85320247, "body": "@DavidZemens I added the Outlook reference but it is just giving me the &quot;complete&quot; box but is not actually sending the emails."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1520443547, "post_id": 49157370, "comment_id": 85320544, "body": "you&#39;re going to need to actually use an instance of Outlook. please look for other similar questions here, and revise your question with SPECIFIC problem (s) since the scope has changed from your initial ask."}, {"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 0, "creation_date": 1520443722, "post_id": 49157370, "comment_id": 85320651, "body": "See <a href=\"https://stackoverflow.com/questions/17973549/ms-access-vba-sending-an-email-through-outlook/17975507#17975507\">this</a> for example. You need to use <code>Outlook.Application</code> class <i>in addition to</i> the <code>Outlook.MailItem</code>."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1520516395, "post_id": 49157370, "comment_id": 85353930, "body": "You cannot use the same string for both the text and Html bodies. A text body will use linefeeds to space out the text. An Html body will ignore linefeeds.  More correctly it will treat any sequence of whitespace characters (spaces, carriage returns, linefeeds and so on) as a single space.  If &#182; represents linefeed, the text body might be: &quot;Dear John&#182;&#182;Please see attached.&#182;&#182;Regards Jane&quot; while the Html body might be: &quot;&lt;p&gt;Dear John&lt;/p&gt;&lt;p&gt;Please see attached.&lt;/p&gt;&lt;p&gt;Regards Jane&lt;/p&gt;&quot;. You need to decide which you have."}], "owner": {"reputation": 9, "user_id": 9457784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba5873bd3562d8c29dde5707e53cf91?s=128&d=identicon&r=PG&f=1", "display_name": "SCJ10", "link": "https://stackoverflow.com/users/9457784/scj10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 212, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593041251, "creation_date": 1520441800, "last_edit_date": 1593041251, "question_id": 49157370, "link": "https://stackoverflow.com/questions/49157370/sending-emails-through-outlook-from-excel-2010", "title": "Sending Emails Through Outlook from Excel 2010", "body": "<p>I was provided an existing VBA code when I first started a new job that was created by the employee before me. Unfortunately, it would not run when I first attempted to run it and the previous employee is unreachable. </p>\n\n<p>My goal is to take information from an existing Excel spreadsheet and send a mass email to those on the spreadsheet. </p>\n\n<p>I have attempted to edit the code several times and have taken it to the IT department at a local university, but it will not run once I get to my work computer. Currently, the error code reads: </p>\n\n<blockquote>\n  <p>\"Compile error: user-defined type not defined\"</p>\n</blockquote>\n\n<p>Any assistance on this matter would be greatly appreciated. I have copied the code below: </p>\n\n<pre><code>Sub SendEmail(what_address As String, subject_line As String, mail_body As String)\n\n    Dim olApp As Outlook.MailItem\n    Set olApp = olApp.createitem(olMailItem)\n\n    olMail.To = what_address\n    olMail.CC = \"someone@nogo.net\"\n    olMail.Subject = subject_line\n    olMail.bodyformat = olFormatHTML\n    olMail.htmlbody = mail_body\n    olMail.attachments.Add (\"C:\\Users\\129020\\Desktop\\90DayNotice\\RecertWorkshopFlyerFY17\")\n    olMail.attachments.Add (\"C:\\Users\\129020\\Desktop\\90DayNotice\\RecertApplicationFY17.pdf\")\n    olMail.body = mail_body\n\n    olMail.Send\n\nEnd Sub\n\nSub SendMassEmail()\n\n    row_number = 1\n\n    Do\n    DoEvents\n        row_number = row_number + 1\n        Dim mail_body_message As String\n        Dim full_name As String\n        Dim Company_Name As String\n\n        mail_body_message = Sheet8.Range(\"I2\")\n        full_name = Sheet8.Range(\"B\" &amp; row_number)\n        Company_Name = Sheet8.Range(\"C\" &amp; row_number)\n        mail_body_message = Replace(mail_body_message, \"replace_name_here\", full_name)\n        mail_body_message = Replace(mail_body_message, \"replace_company_here\", Company_Name)\n\n\n         'MegBox (Sheet.Range(\"J3\"))\n          Call SendEmail(Sheet8.Range(\"D\" &amp; row_number), \"RECERTIFICATION APPLICATION 90 DAY NOTICE\", mail_body_message)\n    Loop Until row_number = 18\n\nMsgBox \"Complete\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1520441290, "post_id": 49157056, "comment_id": 85319092, "body": "That error means that either the workbook or the sheets in that workbook do not exist.  check spelling and ensure there are not spaces or other non printable characters in the sheet names."}, {"owner": {"reputation": 32374, "user_id": 4, "user_type": "moderator", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/C5gBG.jpg?s=128&g=1", "display_name": "Joel Spolsky", "link": "https://stackoverflow.com/users/4/joel-spolsky"}, "edited": false, "score": 0, "creation_date": 1520446205, "post_id": 49157056, "comment_id": 85322095, "body": "Try debugging this by using Sheets() with a number, 1 for the first sheet and 2 for the second sheet etc."}, {"owner": {"reputation": 156, "user_id": 8782422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05771bf72a7e3341ebf2fd205c5020f1?s=128&d=identicon&r=PG&f=1", "display_name": "Afiq Rosli", "link": "https://stackoverflow.com/users/8782422/afiq-rosli"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1520473972, "post_id": 49157056, "comment_id": 85333840, "body": "@ScottCraner I&#39;ve check and certain there is no spelling error, everything is as posted :("}, {"owner": {"reputation": 156, "user_id": 8782422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05771bf72a7e3341ebf2fd205c5020f1?s=128&d=identicon&r=PG&f=1", "display_name": "Afiq Rosli", "link": "https://stackoverflow.com/users/8782422/afiq-rosli"}, "reply_to_user": {"reputation": 32374, "user_id": 4, "user_type": "moderator", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/C5gBG.jpg?s=128&g=1", "display_name": "Joel Spolsky", "link": "https://stackoverflow.com/users/4/joel-spolsky"}, "edited": false, "score": 0, "creation_date": 1520473977, "post_id": 49157056, "comment_id": 85333841, "body": "@JoelSpolsky I&#39;m really new in VBA programming, and I don&#39;t even know how to debug using Sheets(). Is it the one that &quot;step in&quot; (F8)?"}, {"owner": {"reputation": 132, "user_id": 8988624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c37c08fab3084b272ef09fdfe48d72a3?s=128&d=identicon&r=PG", "display_name": "prextor", "link": "https://stackoverflow.com/users/8988624/prextor"}, "reply_to_user": {"reputation": 32374, "user_id": 4, "user_type": "moderator", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/C5gBG.jpg?s=128&g=1", "display_name": "Joel Spolsky", "link": "https://stackoverflow.com/users/4/joel-spolsky"}, "edited": false, "score": 0, "creation_date": 1520493144, "post_id": 49157056, "comment_id": 85339811, "body": "@AfiqRosli: Debugging works with F8 (Step in). With that procedure you execute every single line &quot;by hand&quot; via clicking F8. Using index numbers for the sheets (mentioned by @JoelSpolsky) instead of &quot;Calculation&quot; or &quot;Charts&quot;. The error &quot;Subscript out range&quot; usually derives from the fact, that either the called workbook or the called sheet could not be found. You can also identify this kind of error using F8."}], "answers": [{"comments": [{"owner": {"reputation": 156, "user_id": 8782422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05771bf72a7e3341ebf2fd205c5020f1?s=128&d=identicon&r=PG&f=1", "display_name": "Afiq Rosli", "link": "https://stackoverflow.com/users/8782422/afiq-rosli"}, "edited": false, "score": 0, "creation_date": 1520474124, "post_id": 49160668, "comment_id": 85333875, "body": "Appreciate the answer, but I would like it to open the other workbook if either one of the file is closed, hence the use of &quot;Workbooks.Open&quot;"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 156, "user_id": 8782422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05771bf72a7e3341ebf2fd205c5020f1?s=128&d=identicon&r=PG&f=1", "display_name": "Afiq Rosli", "link": "https://stackoverflow.com/users/8782422/afiq-rosli"}, "edited": false, "score": 1, "creation_date": 1520481415, "post_id": 49160668, "comment_id": 85335615, "body": "I understood from your question that you wanted to move from workbook to workbook, which implies that both workbooks will be open after you open the stage2 workbook. If you are going to have the macro in your stage1 workbook it needs to be open."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 1, "last_activity_date": 1520454558, "creation_date": 1520454558, "answer_id": 49160668, "question_id": 49157056, "link": "https://stackoverflow.com/questions/49157056/opening-another-workbook-specific-sheet-run-time-error-9-subscript-out-of/49160668#49160668", "title": "Opening another workbook, specific sheet | Run-time error &#39;9&#39;: Subscript out of range", "body": "<p>Remove all your workbooks.open lines of code \nYou only need to open the \"stage2\" workbook once. The \"stage1\" workbook is already open. You can use a button to open the \"stage2\" workbook or in a regular module.</p>\n\n<p>Create these macros in your stage1 workbook</p>\n\n<pre><code>Sub Open_stage1_Menu()\n    Workbooks(\"stage1.xlsm\").Sheets(\"Menu\").Activate\nEnd Sub\n\nSub Open_stage1_Data()\n    Workbooks(\"stage1.xlsm\").Sheets(\"Data\").Activate\nEnd Sub\n\nSub Open_stage2_Calculation()\n    Workbooks(\"stage2.xlsm\").Sheets(\"Calculation\").Activate\nEnd Sub\n\nSub Open_stage2_Charts()\n    Workbooks(\"stage2.xlsm\").Sheets(\"Charts\").Activate\nEnd Sub\n</code></pre>\n\n<p>Add a new button to your stage1 workbook, sheet \"Menu\" and select \"Open_stage2_Calculation\"</p>\n\n<p>Add another button to your stage1 workbook, sheet \"Menu\" and select \"Open_stage2_Charts\"</p>\n\n<p>You can also add these 2 buttons to the other worksheet \"Data\"</p>\n\n<p>Go to your stage2 workbook;</p>\n\n<p>Add a new button to your stage2 workbook, sheet \"Calculation\"; in the \"Assign Macro use the \"Macros in: drop-down to select \"stage1\" workbook and select \"Open_stage1_Menu\"</p>\n\n<p>Add another button to your stage2 workbook, sheet \"Calculation\" ; in the \"Assign Macro use the \"Macros in: drop-down to select \"stage1\" workbook and select \"Open_stage1_Data\"</p>\n\n<p>You can also add these 2 buttons to the other stage2 worksheet \"Charts\"</p>\n"}], "owner": {"reputation": 156, "user_id": 8782422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/05771bf72a7e3341ebf2fd205c5020f1?s=128&d=identicon&r=PG&f=1", "display_name": "Afiq Rosli", "link": "https://stackoverflow.com/users/8782422/afiq-rosli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520454558, "creation_date": 1520440883, "question_id": 49157056, "link": "https://stackoverflow.com/questions/49157056/opening-another-workbook-specific-sheet-run-time-error-9-subscript-out-of", "title": "Opening another workbook, specific sheet | Run-time error &#39;9&#39;: Subscript out of range", "body": "<p>I have 2 excel files</p>\n\n<ol>\n<li>stage1\n\n<ol>\n<li>Menu</li>\n<li>Data</li>\n</ol></li>\n<li>stage2\n\n<ol>\n<li>Calculation</li>\n<li>Charts</li>\n</ol></li>\n</ol>\n\n<p>I am trying to jump back and forth from these two files linking to certain sheet of the workbook its jumping to.</p>\n\n<pre><code>Option Explicit\n\nDim stage1 As Workbook\nDim stage2 As Workbook\n\nSub Open_stage1_Menu()\n\n    Set stage1 = Workbooks.Open(ActiveWorkbook.Path &amp; \"\\stage1.xlsm\")\n    stage1.Sheets(\"Menu\").Activate\n\nEnd Sub\n\nSub Open_stage1_Data()\n\n    Set stage1 = Workbooks.Open(ActiveWorkbook.Path &amp; \"\\stage1.xlsm\")\n    stage1.Sheets(\"Data\").Activate\n\nEnd Sub\n\nSub Open_stage2_Calculation()\n\n    Set stage2 = Workbooks.Open(ActiveWorkbook.Path &amp; \"\\stage2.xlsm\")\n    stage2.Sheets(\"Calculation\").Activate\n\nEnd Sub\n\nSub Open_stage2_Charts()\n\n    Set stage2 = Workbooks.Open(ActiveWorkbook.Path &amp; \"\\stage2.xlsm\")\n    stage2.Sheets(\"Charts\").Activate\n\nEnd Sub\n</code></pre>\n\n<p>All of the Macros are stored in the stage1 workbook. I've implemented buttons to navigate through sheets, but jumping to stage2 cause error (Subscript out of range) but not towards stage1. </p>\n"}, {"tags": ["sql", "vba", "ms-access", "combobox", "listbox"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "edited": false, "score": 0, "creation_date": 1520441779, "post_id": 49156992, "comment_id": 85319400, "body": "I am sorry, I am a little new to Access, how do I call the requery? Where do I put that code? In the button click area? Thank you very much for your help!"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "edited": false, "score": 0, "creation_date": 1520441854, "post_id": 49156992, "comment_id": 85319474, "body": "Anywhere you want. I&#39;d put it in all sections you&#39;ve previously had code (after update on the combo boxes and the search box). But that depends on your preference, you might just want it on the search button."}, {"owner": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "edited": false, "score": 0, "creation_date": 1520442162, "post_id": 49156992, "comment_id": 85319685, "body": "Any chance you could show me exactly how it would look if I attached it to the button? Thank you!"}, {"owner": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "edited": false, "score": 0, "creation_date": 1520442993, "post_id": 49156992, "comment_id": 85320199, "body": "I keep getting a Compile error: Wrong number of arguments or invalid property assignment"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "edited": false, "score": 0, "creation_date": 1520443115, "post_id": 49156992, "comment_id": 85320261, "body": "I&#39;ve made some minor changes. Please be specific: where do you get that error (which line, when doing what)?"}, {"owner": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "edited": false, "score": 0, "creation_date": 1520443208, "post_id": 49156992, "comment_id": 85320320, "body": "Error on: Private Sub CboCompany_AfterUpdate()    when I click on the button"}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "edited": false, "score": 0, "creation_date": 1520443248, "post_id": 49156992, "comment_id": 85320345, "body": "Please share that code. I haven&#39;t included it in my answer. The button should be unrelated to an after update event..."}, {"owner": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "edited": false, "score": 0, "creation_date": 1520443503, "post_id": 49156992, "comment_id": 85320521, "body": "Private Sub cboCompany_AfterUpdate() Private Sub RequerylstResume()    Dim SQL As String      (then rest of code provided above) I just am having trouble understanding where the above code would go or if it would just supplant my old code? - also I said button before but meant combobox, sorry! Thank you for all your help!"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1520443585, "last_edit_date": 1520443585, "creation_date": 1520440667, "answer_id": 49156992, "question_id": 49156680, "link": "https://stackoverflow.com/questions/49156680/multiple-combo-boxes-to-filter-a-listbox/49156992#49156992", "title": "Multiple Combo Boxes to filter a listbox", "body": "<p>You can refactor this code pretty easily to the following, if you could use the <code>.Value</code> property or <code>.Column</code> collection instead of <code>.Text</code>:</p>\n\n<pre><code>Private Sub RequerylstResume()\n   Dim SQL As String\n   SQL = \"SELECT qryResume.ID, qryResume.Company, qryResume.Job, qryResume.LastUpdated \" _\n    &amp; \"FROM qryResume \" _\n    &amp; \"WHERE 1=1 \"\n    If cboJob.Value &amp; \"\" &lt;&gt; \"\" Then\n        SQL = SQL &amp;  \" AND qryResume.Job = '\" &amp; cboJob.Value &amp; \"'\"\n    End If\n    If cboCompany.Value &amp; \"\" &lt;&gt; \"\" Then\n        SQL = SQL &amp; \" AND qryResume.Company = '\" &amp; cboCompany.Value &amp; \"'\"\n    End If\n    If Me.TextKeyWords.Value &amp; \"\" &lt;&gt; \"\" Then \n        SQL = SQL &amp; \" AND (Company LIKE '*\" &amp; Me.txtKeywords &amp; \"*' \" _\n        &amp; \" OR Job LIKE '*\" &amp; Me.txtKeywords.Value &amp; \"*') \"\n    End If\n    SQL = SQL &amp; \" ORDER BY qryResume.Company\" \n    Me.lstResume.RowSource = SQL\n    Me.lstResume.Requery\nEnd Sub\n</code></pre>\n\n<p>Then, whenever you want to execute a search, just call <code>RequerylstResume</code>.</p>\n\n<p>You call a sub like this:</p>\n\n<pre><code>Private Sub cboJob_AfterUpdate()\n    RequerylstResume\nEnd Sub\n</code></pre>\n\n<p>And put the sub you want to call in the same module, outside of any other sub</p>\n"}], "owner": {"reputation": 35, "user_id": 9457736, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/9457736/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 0, "accepted_answer_id": 49156992, "answer_count": 1, "score": 1, "last_activity_date": 1520443585, "creation_date": 1520439686, "last_edit_date": 1520439876, "question_id": 49156680, "link": "https://stackoverflow.com/questions/49156680/multiple-combo-boxes-to-filter-a-listbox", "title": "Multiple Combo Boxes to filter a listbox", "body": "<p>I have a form with 2 combo boxes and 1 listbox. The listbox is populated when I search using a button and a text box. Each combo box independently filters the listbox, but I can not figure out how to get them to layer. i.e. if I have chosen selections in both combo boxes, I would like both of the filters to apply to the listbox.</p>\n\n<p>I would like to do one of the following:\na) Get the filters to layer dynamically based\nor\nb) Have the filters apply when the search button is clicked</p>\n\n<p>My current layout is:</p>\n\n<p>Combo Boxes: cboJob, cboCompany\nListBox: lstResume\nTextbox for searching: txtKeywords\nSearch Button: btnSearch\ndata is drawn from qryResume\nAll data is text</p>\n\n<p>Current Code:</p>\n\n<pre><code>Private Sub btnSearch_Click()\nDim SQL As String\nSQL = \"SELECT qryResume.ID, qryResume.Company, qryResume.Job, qryResume.LastUpdated \" _\n    &amp; \"FROM qryResume \" _\n    &amp; \"Where Company LIKE '*\" &amp; Me.txtKeywords &amp; \"*' \" _\n    &amp; \" OR Job LIKE '*\" &amp; Me.txtKeywords &amp; \"*' \" _\n    &amp; \"ORDER BY qryResume.Company \"\n    Me.lstResume.RowSource = SQL\n    Me.lstResume.Requery\n\nEnd Sub\n\nPrivate Sub cboCompany_AfterUpdate()\nDim SQL As String\nSQL = \"SELECT qryResume.ID, qryResume.Company, qryResume.Job, qryResume.LastUpdated \" _\n    &amp; \"FROM qryResume \" _\n    &amp; \"WHERE qryResume.Company = '\" &amp; cboCompany.Text &amp; \"'\" _\n    &amp; \"ORDER BY qryResume.Company\"\n    Me.lstResume.RowSource = SQL\n    Me.lstResume.Requery\n\nEnd Sub\n\nPrivate Sub cboJob_AfterUpdate()\nDim SQL As String\nSQL = \"SELECT qryResume.ID, qryResume.Company, qryResume.Job, qryResume.LastUpdated \" _\n    &amp; \"FROM qryResume \" _\n    &amp; \"WHERE qryResume.Job = '\" &amp; cboJob.Text &amp; \"'\" _\n    &amp; \"ORDER BY qryResume.Company\"\n    Me.lstResume.RowSource = SQL\n    Me.lstResume.Requery\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "updates", "userform"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520439762, "post_id": 49156641, "comment_id": 85318076, "body": "You should consider using Access for this."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1520440028, "post_id": 49156641, "comment_id": 85318250, "body": "What is the question anyway"}, {"owner": {"reputation": 3, "user_id": 9398520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec9ae713a6bfbdf5fc41ea9af5eca69?s=128&d=identicon&r=PG&f=1", "display_name": "user9398520", "link": "https://stackoverflow.com/users/9398520/user9398520"}, "edited": false, "score": 0, "creation_date": 1520440629, "post_id": 49156641, "comment_id": 85318642, "body": "I am only using Excel 2016."}, {"owner": {"reputation": 3, "user_id": 9398520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec9ae713a6bfbdf5fc41ea9af5eca69?s=128&d=identicon&r=PG&f=1", "display_name": "user9398520", "link": "https://stackoverflow.com/users/9398520/user9398520"}, "edited": false, "score": 0, "creation_date": 1520441047, "post_id": 49156641, "comment_id": 85318930, "body": "To simplify the question-&quot;How do you select a specific row buy matching a users input with a value in a column (e.g select row 2 after ID 12 is input by user)&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9398520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec9ae713a6bfbdf5fc41ea9af5eca69?s=128&d=identicon&r=PG&f=1", "display_name": "user9398520", "link": "https://stackoverflow.com/users/9398520/user9398520"}, "edited": false, "score": 0, "creation_date": 1520446631, "post_id": 49157270, "comment_id": 85322340, "body": "Thank you, that is close to what I am looking for, however what would the code look like if you replace the Inputbox with a Textbox within a userform?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 9398520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec9ae713a6bfbdf5fc41ea9af5eca69?s=128&d=identicon&r=PG&f=1", "display_name": "user9398520", "link": "https://stackoverflow.com/users/9398520/user9398520"}, "edited": false, "score": 0, "creation_date": 1520447627, "post_id": 49157270, "comment_id": 85322932, "body": "@user9398520 I believe just <code>lookup=Me.whateverbox.value</code>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 3, "user_id": 9398520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec9ae713a6bfbdf5fc41ea9af5eca69?s=128&d=identicon&r=PG&f=1", "display_name": "user9398520", "link": "https://stackoverflow.com/users/9398520/user9398520"}, "edited": false, "score": 0, "creation_date": 1520555252, "post_id": 49157270, "comment_id": 85375249, "body": "@user9398520 - Did this answer do the trick for you? If so, you can flag as The Answer (click the check left of the post, below the down arrow). This will remove the question from the unanswered question queue."}, {"owner": {"reputation": 3, "user_id": 9398520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec9ae713a6bfbdf5fc41ea9af5eca69?s=128&d=identicon&r=PG&f=1", "display_name": "user9398520", "link": "https://stackoverflow.com/users/9398520/user9398520"}, "edited": false, "score": 0, "creation_date": 1520872626, "post_id": 49157270, "comment_id": 85484079, "body": "Thank you for the help, however I was looking for how to link an ID number inputted by the user through a Userform, not an Inputbox. Would the code look similar but with:     lookup = Trim(Application.IDNumberBox_AfterUpdate.Value"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 1, "last_activity_date": 1520441527, "creation_date": 1520441527, "answer_id": 49157270, "question_id": 49156641, "link": "https://stackoverflow.com/questions/49156641/input-new-data-based-off-user-input-on-userform-vba/49157270#49157270", "title": "Input new data based off user input on userform VBA", "body": "<p>If you simply need a user to input a value, and you want to use that row, you can use:</p>\n\n<pre><code>Dim findRng As Range\nDim lookup As String\nlookup = Trim(Application.InputBox(\"What ID do you want to find?\"))\nSet findRng = Range(\"A:A\").Find(what:=lookup)\n' Do whatever you need now.\n\nIf Not findRng Is Nothing Then\n    Debug.Print \"The row to use is: \" &amp; findRng.Row\nElse\n    MsgBox (lookup &amp; \" was not found in column A!\")\nEnd If\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 9398520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec9ae713a6bfbdf5fc41ea9af5eca69?s=128&d=identicon&r=PG&f=1", "display_name": "user9398520", "link": "https://stackoverflow.com/users/9398520/user9398520"}, "is_accepted": true, "score": 0, "last_activity_date": 1523312785, "last_edit_date": 1523312785, "creation_date": 1522679369, "answer_id": 49613165, "question_id": 49156641, "link": "https://stackoverflow.com/questions/49156641/input-new-data-based-off-user-input-on-userform-vba/49613165#49613165", "title": "Input new data based off user input on userform VBA", "body": "<p>I found code that searches for an ID number, brings up client information and allows you to edit and/or input new information for the row of data corresponding to clients ID number.</p>\n\n<pre><code>Dim currentrow As Long\n\nPrivate Sub CommandButton2_Click()\nDim lastrow\nDim myfname As String\nDim ws As Sheet11\nlastrow = Sheet11.Range(\"A\" &amp; Rows.Count).End(xlUp).row\nmyfname = Me.Reg8.Value\nFor currentrow = 2 To lastrow\nIf ws.Cells(currentrow, 1).Text = myfname Then\nws.Cells(currentrow, 68).Value = Me.Reg10.Value\nws.Cells(currentrow, 69).Value = Me.Reg11.Value\nws.Cells(currentrow, 10).Value = Me.Reg5.Value\nws.Cells(currentrow, 9).Value = Me.Reg6.Value\nws.Cells(currentrow, 70).Value = Me.Reg7.Value\nEnd If\nNext\nMsgBox \"Information has\" &amp; vbNewLine &amp; \"been updated\"\nEnd Sub\n\n Private Sub Reg8_AfterUpdate()\n'Checks to see if ID number exists\n  If WorksheetFunction.CountIf(Sheet11.Range(\"A:A\"), Me.Reg8.Value) = 0 Then\n  MsgBox \"ID Not Found\" &amp; vbNewLine &amp; \"Please enter new Mentee informantion and submit\"\nExit Sub\nEnd If\n'Lookup values based on ID number\n With Me\n.Reg1 = Application.WorksheetFunction.VLookup(CLng(Me.Reg8), Sheet11.Range(\"IDRangeTest\"), 2, 0)\n.Reg2 = Application.WorksheetFunction.VLookup(CLng(Me.Reg8), Sheet11.Range(\"IDRangeTest\"), 3, 0)\n.Reg3 = Application.WorksheetFunction.VLookup(CLng(Me.Reg8), Sheet11.Range(\"IDRangeTest\"), 5, 0)\n.Reg4 = Application.WorksheetFunction.VLookup(CLng(Me.Reg8), Sheet11.Range(\"IDRangeTest\"), 7, 0)\n .Reg5 = Application.WorksheetFunction.VLookup(CLng(Me.Reg8), Sheet11.Range(\"IDRangeTest\"), 10, 0)\n .Reg6 = Application.WorksheetFunction.VLookup(CLng(Me.Reg8), Sheet11.Range(\"IDRangeTest\"), 9, 0)\n .Reg7 = Application.WorksheetFunction.VLookup(CLng(Me.Reg8), Sheet11.Range(\"IDRangeTest\"), 70, 0)\n .Reg9 = Application.WorksheetFunction.VLookup(CLng(Me.Reg8), Sheet11.Range(\"IDRangeTest\"), 45, 0)\n .Reg10 = Application.WorksheetFunction.VLookup(CLng(Me.Reg8), Sheet11.Range(\"IDRangeTest\"), 68, 0)\n End With\n End Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9398520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ec9ae713a6bfbdf5fc41ea9af5eca69?s=128&d=identicon&r=PG&f=1", "display_name": "user9398520", "link": "https://stackoverflow.com/users/9398520/user9398520"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 982, "favorite_count": 0, "accepted_answer_id": 49613165, "answer_count": 2, "score": -1, "last_activity_date": 1523312785, "creation_date": 1520439574, "last_edit_date": 1520439677, "question_id": 49156641, "link": "https://stackoverflow.com/questions/49156641/input-new-data-based-off-user-input-on-userform-vba", "title": "Input new data based off user input on userform VBA", "body": "<p>I am currently working a project (a userform in Excel 2016) that is intended to input new client information each month. I would like the user to search for each client with an ID number. After the user inputs an ID number through the userform (ID nubmer is also located in A:A on next sheet titled \"Updates\"). The code then loops though data on next sheet in A:A to locate the ID number.</p>\n\n<p>I would like the new client information to update the row corresponding with the ID number input (e.g. user inputs ID number 12, 12 = Jon Doe in Row 2, so any new information entered by the user (after imputing ID number 12) will be pasted in Row 2).</p>\n\n<p><a href=\"https://i.stack.imgur.com/2KAnH.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2KAnH.jpg\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/RzqVk.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RzqVk.jpg\" alt=\"enter image description here\"></a></p>\n\n<pre><code>'This sub locates the ID number corresponding to the name\n'This section of code works well\nPrivate Sub IDNumberBox_AfterUpdate()\n'Checks to see if ID number exists\n    If WorksheetFunction.CountIf(Sheet1.Range(\"A:A\"), Me.IDNumberBox.Value) = 0 \n    Then\nMsgBox \"ID Not Found\" &amp; vbNewLine &amp; \"Please enter different ID\"\n    End If\n'Lookup names based on ID number\n    With Me\n.txtfirstname = Application.WorksheetFunction.VLookup(CLng(Me.IDNumberBox), \nSheet1.Range(\"IDandNAMES\"), 2, 0)\n.textlastname = Application.WorksheetFunction.VLookup(CLng(Me.IDNumberBox), \nSheet1.Range(\"IDandNAMES\"), 3, 0)\n   End With\n   End Sub\n\n\n'This is the input button\n'This code does not input any new data\nPrivate Sub inputbutton_Click()\nDim currentrow As Long\nDim ws As Worksheet\nSet ws = Worksheets(\"Updates\")\nlrow = ws.Cells(Rows.Count, 4).End(xlToRight).Select\n   With ws\n   If WorksheetFunction.CountIf(Sheet1.Range(\"A:A\"), Me.IDNumberBox.Value) = True Then\n    .Cells(1row, 4).Value = Me.txtupdate.Value\n   '^this line of code should input data from textbox(\"txtupdate\") in column D and in the row corresponding with the ID number input by user\n    .Cells(lrow, 5).Value = Me.cmbfinancial.Value\n    .Cells(lrow, 6).Value = Me.txtwcfin.Value\n    .Cells(lrow, 7).Value = Me.cmbeducation.Value\n    .Cells(lrow, 8).Value = Me.txtwcedu.Value\n    .Cells(lrow, 9).Value = Me.cmbemploy.Value\n</code></pre>\n\n<p>I am new to VBA and any help would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "range", "copy-paste", "type-mismatch"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520439256, "post_id": 49156519, "comment_id": 85317721, "body": "Try just <code>ws0.rng1.Value = ws1.rng0.Value</code>.  I think the issue is how you&#39;re setting the ranges, and then calling them.  The way you&#39;re doing it, the variables should be strings, but you are actually using <code>Range</code> variables, so you can just use them directly."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520439686, "post_id": 49156519, "comment_id": 85318019, "body": "Also if you did <code>Set wb0 = ActiveWorkbook &#47;&#47; set ws0 = wb0.Sheets(&quot;SheetX&quot;)</code>, then I assume you want to do <code>Set rng0 = ws0.Range(&quot;B9:B159&quot;)</code> (and do same with <code>ws1 &#47; rng1</code>). Then you can just do <code>rng1.Value = rng2.Value</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1520439708, "post_id": 49156519, "comment_id": 85318039, "body": "locate any worksheet errors with F5, special, errors."}, {"owner": {"reputation": 27, "user_id": 9194216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd285dad63e044dc9591e0923fa02e1?s=128&d=identicon&r=PG&f=1", "display_name": "User789", "link": "https://stackoverflow.com/users/9194216/user789"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520443568, "post_id": 49156519, "comment_id": 85320566, "body": "@BruceWayne, I commented out the old line and put your suggested one in instead. Now I have the error: &quot;Run-time error &#39;438&#39;: Object doesn&#39;t support this property or method&quot; on that line. From quick research, I&#39;m thinking this has to do with the range object not being applicable in this way - however I don&#39;t really know what I&#39;m talkin about here. Even so, this really leaves me no better off than when I originally posted. I took your second suggestion: putting actual ranges (those I mentioned in my original post &quot;A9:A159&quot;), instead of Range variables, but that also didn&#39;t make a difference..."}, {"owner": {"reputation": 27, "user_id": 9194216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd285dad63e044dc9591e0923fa02e1?s=128&d=identicon&r=PG&f=1", "display_name": "User789", "link": "https://stackoverflow.com/users/9194216/user789"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520444154, "post_id": 49156519, "comment_id": 85320881, "body": "@BruceWayne, and regarding your &quot;Also...&quot; second post, I did this too - it seems to make good sense, but I get another error: &quot;Run-time error 244: Object Required&quot; on this new line... not sure why it is throwing this error if the range objects have workbooks assigned to them. I&#39;m going to assume setting range = wb.ws.range(abc123) does not work for this purpose?"}, {"owner": {"reputation": 27, "user_id": 9194216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd285dad63e044dc9591e0923fa02e1?s=128&d=identicon&r=PG&f=1", "display_name": "User789", "link": "https://stackoverflow.com/users/9194216/user789"}, "edited": false, "score": 0, "creation_date": 1520444276, "post_id": 49156519, "comment_id": 85320949, "body": "@Jeeped, This just brings me to the line I&#39;m getting the error on originally, saying the same thing. I&#39;ve stepped through the code using F8, but still arrive back at the same spot, without any new insights."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520445203, "post_id": 49156519, "comment_id": 85321522, "body": "@User789 - Have you tried HackSlash&#39;s answer below?"}, {"owner": {"reputation": 27, "user_id": 9194216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd285dad63e044dc9591e0923fa02e1?s=128&d=identicon&r=PG&f=1", "display_name": "User789", "link": "https://stackoverflow.com/users/9194216/user789"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520519642, "post_id": 49156519, "comment_id": 85356204, "body": "@BruceWayne, yes! It worked! Thank you for the suggestions earlier - they made me rethink how to qualify objects."}], "answers": [{"tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": true, "score": 2, "last_activity_date": 1520441541, "creation_date": 1520441541, "answer_id": 49157275, "question_id": 49156519, "link": "https://stackoverflow.com/questions/49156519/type-mismatch-copy-range-from-one-workbook-to-another/49157275#49157275", "title": "Type Mismatch - Copy range from one workbook to another", "body": "<p>This seems to be a misunderstanding of objects. The error occurs because you are passing the objects in to a string field which results in \"type mismatch\". The objects can be called directly and they are fully qualified as declared. You don't need to stack them like that.</p>\n\n<pre><code>Sub ImportT12Accounts()\n    '\n    ' ImportT12Accounts Macro\n    ' Pulls in the list of account numbers from a report of the user's choice.\n    '\n    '\n\n    Dim fileChoice As Integer\n    Dim filePath As String\n    Dim sheetName As Variant\n    Dim ws0 As Worksheet                         'this workbook's 2nd tab\n    Dim ws1 As Worksheet                         'the opened workbook's 2nd tab\n    'Dim wb0 As Workbook                          'this workbook (the log)\n    Dim wb1 As Workbook                          'the opened T12 sheet\n    Dim rng0 As Range                            'the range of cells in this workbook's 2nd sheet to be copied to\n    Dim rng1 As Range                            'the range of cells from the openeed workbook to be copied from\n\n\n    'Set wb0 = ActiveWorkbook\n    Set ws0 = ActiveSheet\n    Set rng0 = ws0.Range(\"B9:B159\")\n\n    'Find the desired T12 workbook filepath\n    'only allow the user to select one file\n    Application.FileDialog(msoFileDialogOpen).AllowMultiSelect = False\n    'make the file dialog visible to the user\n    fileChoice = Application.FileDialog(msoFileDialogOpen).Show\n    'determine what choice the user made\n    If fileChoice &lt;&gt; 0 Then\n        'get the file path selected by the user\n        filePath = Application.FileDialog(msoFileDialogOpen).SelectedItems(1)\n    End If\n\n    'Set variables using the newly-opened workbook\n    Set wb1 = Workbooks.Open(filePath)\n    Set ws1 = ActiveSheet\n    Set rng1 = ws1.Range(\"A9:A159\")\n\n    'Use the filepath selected by User in formulas to pull the account numbers into this book, in Sheet 2\n    rng1.Value = rng0.Value\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9194216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdd285dad63e044dc9591e0923fa02e1?s=128&d=identicon&r=PG&f=1", "display_name": "User789", "link": "https://stackoverflow.com/users/9194216/user789"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 49157275, "answer_count": 1, "score": 2, "last_activity_date": 1520459478, "creation_date": 1520439153, "last_edit_date": 1520459478, "question_id": 49156519, "link": "https://stackoverflow.com/questions/49156519/type-mismatch-copy-range-from-one-workbook-to-another", "title": "Type Mismatch - Copy range from one workbook to another", "body": "<p>I am trying to copy a range from one workbook to another, using the code below. The other posts similar to this issue on here and elsewhere seem to be confined to specific syntax errors which aren't relevant (as far as I'm aware) to my specific case (last line of my code). For anyone generally trying to copy and paste a given range (hard-coded) between workbooks, this may be relevant:</p>\n\n<pre><code>Sub ImportT12Accounts()\n'\n' ImportT12Accounts Macro\n' Pulls in the list of account numbers from a report of the user's choice. \n'\n'\n\nDim fileChoice As Integer\nDim filePath As String\nDim sheetName As Variant\nDim ws0 As Worksheet 'this workbook's 2nd tab\nDim ws1 As Worksheet 'the opened workbook's 2nd tab\nDim wb0 As Workbook 'this workbook (the log)\nDim wb1 As Workbook 'the opened T12 sheet\nDim rng0 As Range 'the range of cells in this workbook's 2nd sheet to be copied to\nDim rng1 As Range 'the range of cells from the openeed workbook to be copied from\n\n\nSet ws0 = ActiveSheet\nSet wb0 = ActiveWorkbook\nSet rng0 = Range(\"B9:B159\")\n\n'Find the desired T12 workbook filepath\n  'only allow the user to select one file\n  Application.FileDialog(msoFileDialogOpen).AllowMultiSelect = False\n  'make the file dialog visible to the user\n  fileChoice = Application.FileDialog(msoFileDialogOpen).Show\n  'determine what choice the user made\n  If fileChoice &lt;&gt; 0 Then\n      'get the file path selected by the user\n      filePath = Application.FileDialog(msoFileDialogOpen).SelectedItems(1)\n  End If\n\n'Set variables using the newly-opened workbook\nSet wb1 = Workbooks.Open(filePath)\nSet ws1 = ActiveSheet\nSet rng1 = Range(\"A9:A159\")\n\n'Use the filepath selected by User in formulas to pull the account numbers into this book, in Sheet 2\nWorkbooks(wb0).Worksheets(ws0).Range(rng1).Value = _\nWorkbooks(wb1).Worksheets(ws1).Range(rng0).Value\n\nEnd Sub\n</code></pre>\n\n<p>When run, it throws the <code>\"Run-time error '13': Type mismatch\"</code> error on the last line, <code>\"Workbooks(wb0)...Range(rng0).Value\"</code>.</p>\n\n<p>I have tried subbing out this copy-paste method for a few others, without avail. For example, I have tried subbing out the range variables <code>.Range(rng0)</code> and <code>.Range(rng1)</code> with/for <code>.Range(\"A9:A159\")</code> and <code>.Range(\"B9:B159\")</code> directly, but get the same error. </p>\n\n<p>Another example of a method I tried is: </p>\n\n<pre><code>Workbooks(wb1).Worksheets(ws1).Range(rng1).Copy \nDestination:=Workbooks(wb0).Worksheets(ws0).Range(rng0)\n</code></pre>\n\n<p>But this gave me the same error.</p>\n\n<p>I have a feeling the mismatch is being caused by one of the workbook or worksheet variables, however, I can't figure out why this would be the case. From what I can tell, it is fine to pass workbook, worksheet, and range variables into their respective methods.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520439082, "post_id": 49156464, "comment_id": 85317608, "body": "Where&#39;s the rest of the code, mainly the closing <code>End If &#47;&#47; Next Oo</code>?"}, {"owner": {"reputation": 17, "user_id": 9256279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc7e5dba802931ce21789ad40307717e?s=128&d=identicon&r=PG&f=1", "display_name": "chefman179", "link": "https://stackoverflow.com/users/9256279/chefman179"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520439114, "post_id": 49156464, "comment_id": 85317629, "body": "Comments ruined the paste, the rest of the code is copying and pasting the cells from &quot;InputPaste&quot; into a template in another sheet. Cut down to side to save people eyes."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520439425, "post_id": 49156464, "comment_id": 85317828, "body": "Please read <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a> You need to tell us what is going wrong, where you got errors or stuck exactly and what you expect instead of the actual behavior. Also you should correct your code (especially your comments, which should start with an <code>&#39;</code> instead of <code>&#47;&#47;</code>). You might also read how to provide an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Also a screenshot might help us."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1520442407, "post_id": 49156464, "comment_id": 85319843, "body": "@peh The question is extremely clear &quot;how to prevent excel from splitting paragraphed text?&quot; It&#39;s a common problem."}, {"owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "edited": false, "score": 0, "creation_date": 1520442473, "post_id": 49156464, "comment_id": 85319878, "body": "Basically the text you&#39;re copying has CRLF in the string and you want to avoid Excel interpreting that as multiple cells."}], "answers": [{"tags": [], "owner": {"reputation": 5002, "user_id": 2559297, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/lxuup.jpg?s=128&g=1", "display_name": "D_Bester", "link": "https://stackoverflow.com/users/2559297/d-bester"}, "is_accepted": false, "score": 1, "last_activity_date": 1520944685, "last_edit_date": 1520944685, "creation_date": 1520442755, "answer_id": 49157633, "question_id": 49156464, "link": "https://stackoverflow.com/questions/49156464/copy-word-table-to-excel-without-splitting-cells/49157633#49157633", "title": "Copy Word table to Excel without splitting cells", "body": "<p>The text you're copying has CRLF in the string and you want to avoid Excel interpreting that as multiple cells.</p>\n\n<p>Just avoid using Paste and use Range.Value instead. Problem solved. </p>\n\n<pre><code>'Search for the embedded Word document\nFor Each Oo In Worksheets(\"Input\").OLEObjects\nIf InStr(1, Oo.progID, \"Word.Document\", vbTextCompare) &gt; 0 Then\n    'Open the embedded document\n    Oo.Verb xlVerbPrimary\n    'Get the document inside\n    Set wDoc = Oo.Object\n\n    'Copy the contents to cell A1\n    Worksheets(\"Paste\").Range(\"A1\").value = wDoc.Content\n</code></pre>\n\n<p>This will put the entire wDoc.content into one cell. That's not what you really want though. You really need to loop through the table in Word and use <code>.Value</code> to insert the data into Excel. </p>\n"}], "owner": {"reputation": 17, "user_id": 9256279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc7e5dba802931ce21789ad40307717e?s=128&d=identicon&r=PG&f=1", "display_name": "chefman179", "link": "https://stackoverflow.com/users/9256279/chefman179"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1206, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1520944685, "creation_date": 1520438971, "last_edit_date": 1520943108, "question_id": 49156464, "link": "https://stackoverflow.com/questions/49156464/copy-word-table-to-excel-without-splitting-cells", "title": "Copy Word table to Excel without splitting cells", "body": "<p>I'm struggling to paste a word table into excel without the deliminator splitting out by paragraph, as I want to grabs those paragraphs and paste into excel later.</p>\n\n<p>Does anyone know how to prevent excel from splitting paragraphed text when it is pasted into excel from a word table?</p>\n\n<pre><code>Sub InputDoc()\n  Dim Oo As OLEObject\n  Dim wDoc As Object 'Word.Document\n\n  'Search for the embedded Word document\n  For Each Oo In Worksheets(\"Input\").OLEObjects\n      If InStr(1, Oo.progID, \"Word.Document\", vbTextCompare) &gt; 0 Then\n          'Open the embedded document\n          Oo.Verb xlVerbPrimary\n          'Get the document inside\n          Set wDoc = Oo.Object\n\n          'Copy the contents to cell A1\n          wDoc.Content.Copy\n          Worksheets(\"Paste\").Range(\"A1\").PasteSpecial Paste:=xlPasteFormats\n</code></pre>\n"}, {"tags": ["excel", "vb.net", "vba"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1520439925, "post_id": 49156442, "comment_id": 85318185, "body": "It is easy to write VB.NET code that manipulates large amounts of Excel data but never puts enough pressure on the GC heap to cause the garbage collector to run.  Diagnose by using the .NET performance counters in perfmon.exe.  <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/debug-trace-profile/performance-counters#memory\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/framework/debug-trace-profil&zwnj;&#8203;e/&hellip;</a>  Fix by calling GC.Collect() after moving enough data around.  Or writing the code you intended to write."}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "edited": false, "score": 0, "creation_date": 1520442091, "post_id": 49156442, "comment_id": 85319639, "body": "You are loading the VB.NET stack on top of Excel and VBA. It would naturally use more resources."}, {"owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "edited": false, "score": 0, "creation_date": 1520442546, "post_id": 49156442, "comment_id": 85319929, "body": "The memory usage goes from 250MB to 1.6GB in a single line of code. In the diagnostics tool I can see that the GC is activated sometimes. Also, after the single line, the memory immediately goes back to 250MB. I can imagine that VB.NET requires more resources, but I find it strange that with VBA the memory hardly moves. Also it takes about 20 seconds to copy the data when using VB.NET, but it takes 1 second to do exactly the same manually or with VBA."}, {"owner": {"reputation": 10761, "user_id": 2592875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4abcf57451cf62e63e8e191421c6709e?s=128&d=identicon&r=PG", "display_name": "TnTinMn", "link": "https://stackoverflow.com/users/2592875/tntinmn"}, "edited": false, "score": 1, "creation_date": 1520444585, "post_id": 49156442, "comment_id": 85321148, "body": "If I counted correctly, that single line creates 5 Range references and one String.   Those references are highly unlikely to account for memory consumption you claim is caused on statement execution.    Or is that memory consumption of that statement being executed an unspecified number of times in a loop.  It is also strange that you are assigning a formula to every column in a worksheet row."}], "owner": {"reputation": 1209, "user_id": 3927703, "user_type": "registered", "accept_rate": 20, "profile_image": "https://graph.facebook.com/1058356120/picture?type=large", "display_name": "Alex de Jong", "link": "https://stackoverflow.com/users/3927703/alex-de-jong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520438901, "creation_date": 1520438901, "question_id": 49156442, "link": "https://stackoverflow.com/questions/49156442/large-amount-of-memory-needed-with-vb-net-but-not-with-vba", "title": "Large amount of Memory needed with VB.NET but not with VBA", "body": "<p>I'm having issues with my application regarding memory usage and I can't seem to find the solution.\nI started with a VBA macro which copies data from one sheet to another in different workbooks. For multiple reasons, I have copied the code in a VB.NET application.</p>\n\n<p>The VBA code is able to copy thousands of cells with data at once, using this line:</p>\n\n<pre><code>ws.Range(ws.Cells(j - 1, 1), ws.Cells(j + rij.Rows.Count - 2, 1)).EntireRow.Formula = rij.Formula\n</code></pre>\n\n<p>In this case, the variable \"rij\" is a range.</p>\n\n<p>In my VB.NET application, I use exactly the same line of code. In some cases, it needs 1.5GB of memory. When using 32 bits Excel, this often causes a System.outofmemoryexception error.</p>\n\n<p>Does any of you know why VB.NET needs to use a lot of memory, while VBA doesn't? And more important, is there a way to use VB.NET without the large amount of memory?</p>\n\n<p>I really hope you can help me!</p>\n"}, {"tags": ["vba", "excel", "for-loop"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520438812, "post_id": 49156368, "comment_id": 85317416, "body": "change the bits which say Sheets(&quot;Sheet2&quot;) or  Sheets(&quot;Sheet1&quot;)  to use a sheet variable and pass that variable to the With myVar..."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520438843, "post_id": 49156368, "comment_id": 85317439, "body": "Loop an array of sheet variables if you want to pass multiple different sheets  <a href=\"https://stackoverflow.com/questions/40268377/loop-to-set-variables-as-worksheet\" title=\"loop to set variables as worksheet\">stackoverflow.com/questions/40268377/&hellip;</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 2, "creation_date": 1520439190, "post_id": 49156368, "comment_id": 85317684, "body": "You also need to properly link your <code>With</code> statement to the ranges you use. For example, you have <code>With Sheets(&quot;Sheet2&quot;)</code> but them don&#39;t link the <code>lastRow2 = Cells().Row</code> to it.  Do this for all such instances: <code>LastRow2 = .Cells(.Rows.Count,Col2).End(xlUp).Row</code>.  Otherwise, any use of a range will occur on the ActiveSheet, whatever that may be."}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1520439223, "post_id": 49156368, "comment_id": 85317706, "body": "<code>Qualify</code> your sheets (just do a search for <code>qualify sheets in vba</code>). Further more, when qualifying sheets, please don&#39;t use Selected sheet or active sheet"}, {"owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "edited": false, "score": 0, "creation_date": 1520439785, "post_id": 49156368, "comment_id": 85318096, "body": "A couple things: <b>With</b> loops aren&#39;t a thing; you&#39;re actually working with <b>For</b> loops. <b>With</b> simply, <i>&quot;Executes a series of statements on a single object...&quot;</i>. <i>X</i> isn&#39;t declared, and <i>LastRow</i> actually seems to be used as <i>LastRow2</i>. With that being said, can you show us your data set? That&#39;ll help us be able to recreate your problem."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1520445908, "post_id": 49156368, "comment_id": 85321915, "body": "Replace <code>If InStr(1, Cells(R, Col2).Value, &quot;RX04F.029.038&quot;) &gt; 0 Then</code> witth <code>If InStr(1, .Cells(R, Col2).Value, &quot;RX04F.029.038&quot;) &gt; 0 Then</code>. Spot the difference?"}], "answers": [{"tags": [], "owner": {"reputation": 16, "user_id": 9447119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10e75279594a7f534a11a37e36c1bc82?s=128&d=identicon&r=PG&f=1", "display_name": "BrownPaperBag", "link": "https://stackoverflow.com/users/9447119/brownpaperbag"}, "is_accepted": false, "score": 0, "last_activity_date": 1520444155, "last_edit_date": 1520444155, "creation_date": 1520439054, "answer_id": 49156491, "question_id": 49156368, "link": "https://stackoverflow.com/questions/49156368/vba-for-loop-will-only-work-on-specific-sheet/49156491#49156491", "title": "VBA For Loop will only work on specific sheet", "body": "<p>You can change the sheet names to what you want. </p>\n\n<p>Or you can swap:</p>\n\n<pre><code>With Sheets(\"Sheet1\")\n</code></pre>\n\n<p>for </p>\n\n<pre><code>With ActiveSheet\n</code></pre>\n\n<p>if you want to run the loops on the active sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 670, "user_id": 7286051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bce9ea1a1327b531e720dbbcd01714a3?s=128&d=identicon&r=PG&f=1", "display_name": "adam Wadsworth", "link": "https://stackoverflow.com/users/7286051/adam-wadsworth"}, "is_accepted": true, "score": 0, "last_activity_date": 1520439582, "creation_date": 1520439582, "answer_id": 49156642, "question_id": 49156368, "link": "https://stackoverflow.com/questions/49156368/vba-for-loop-will-only-work-on-specific-sheet/49156642#49156642", "title": "VBA For Loop will only work on specific sheet", "body": "<p>You also need to properly link your With statement to the ranges you use. For example, you have With <code>Sheets(\"Sheet2\")</code> but them don't link the <code>lastRow2 = Cells().Row</code> to it. Do this for all such instances: <code>LastRow2 = .Cells(.Rows.Count,Col2).End(xlUp).Row.</code> Otherwise, any use of a range will occur on the ActiveSheet, whatever that may be. \u2013 BruceWayne 3 mins ago </p>\n\n<p>Edit: BruceWayne gave me the answer I need in the comments but cant mark it as an answer so this is the best I could do. Thank you</p>\n"}], "owner": {"reputation": 670, "user_id": 7286051, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/bce9ea1a1327b531e720dbbcd01714a3?s=128&d=identicon&r=PG&f=1", "display_name": "adam Wadsworth", "link": "https://stackoverflow.com/users/7286051/adam-wadsworth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 49156642, "answer_count": 2, "score": 0, "last_activity_date": 1520445926, "creation_date": 1520438698, "last_edit_date": 1520445926, "question_id": 49156368, "link": "https://stackoverflow.com/questions/49156368/vba-for-loop-will-only-work-on-specific-sheet", "title": "VBA For Loop will only work on specific sheet", "body": "<p>I have the below code that pulls out specific data from the spreadsheet and formats it into a table. Both <em>for loops</em> work, however the first one will only work if I'm on <code>Sheet1</code> and the second one will only work if I'm on <code>Sheet2</code>.</p>\n\n<p>I can't work out how to rewrite it to make both sections of code work anywhere in the spreadsheet. Preferably from <code>Sheet1</code> if it had to be. </p>\n\n<pre><code>Sub MakeMyTable()\n\nDim Col As Variant\nDim Col2 As Variant\nDim LastRow As Long\nDim R As Long\nDim StartRow As Long\n\nCol = \"D\"\nCol2 = \"A\"\nStartRow = 1\nX = 3    \n\n'This with pulls the formatted data into totals into Sheet2\n\nWith Sheets(\"Sheet1\")\n    LastRow2 = Cells(Rows.Count, Col).End(xlUp).Row\n    For R = StartRow + 1 To LastRow2 + 1 Step 1\n        If .Cells(R, Col) = \"\" Then\n        Sheets(\"Sheet2\").Cells(1, \"A\").Value = \"Project Cost Centers Costs At \" &amp; Date\n        Sheets(\"Sheet2\").Cells(X, \"A\").Value = .Cells(R - 1, Col).Value\n        Sheets(\"Sheet2\").Cells(X, \"B\").Value = .Cells(R - 1, \"F\").Value\n        Sheets(\"Sheet2\").Cells(X, \"C\").Value = .Cells(R, \"P\").Value\n        Sheets(\"Sheet2\").Cells(X, \"C\").NumberFormat = \"$#,##0.00\"\n        X = X + 1\n        End If\n    Next R\nEnd With\n\n' This with finds any cell that has \"RX04F.029.038\" in it and moves it to the \n' bottom of the table.\n\nWith Sheets(\"Sheet2\")\n    LastRow2 = Cells(Rows.Count, Col2).End(xlUp).Row\n    For R = LastRow2 To StartRow + 2 Step -1\n            If InStr(1, Cells(R, Col2).Value, \"RX04F.029.038\") &gt; 0 Then\n            Rows(R).Cut\n            Rows(LastRow2 + 1).Insert Shift:=xlDown\n            R = R + 1\n            LastRow2 = LastRow2 - 1             \n        End If\n    Next R\nEnd With\n\n\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "logic", "logical-operators", "autofilter"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1520440307, "post_id": 49156068, "comment_id": 85318440, "body": "Simply reverse <a href=\"https://stackoverflow.com/questions/19497659/excel-vba-autofilter-all-but-three/35120033?s=1|66.1409#35120033\">this</a>"}, {"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1520440483, "post_id": 49156068, "comment_id": 85318550, "body": "@Jeeped: What exactly do you mean by &quot;simply reverse&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1520440656, "post_id": 49156068, "comment_id": 85318655, "body": "Given the prompt reply I gather that you didn&#39;t bother reading the post behind the link or if you did, you didn&#39;t absorb it."}, {"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1520441005, "post_id": 49156068, "comment_id": 85318906, "body": "@Jeeped: Sorry my fault. I didn&#39;t see the link. I will check it out, thanks :)"}, {"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1520517645, "post_id": 49156068, "comment_id": 85354802, "body": "@Jeeped: Okay I have checked it but I still don&#39;t see what you mean by &quot;simply reverse&quot; it? This Problem is for only one column, mine is for three different. Can you please explain it to me? :)"}], "answers": [{"tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1520442814, "creation_date": 1520442814, "answer_id": 49157653, "question_id": 49156068, "link": "https://stackoverflow.com/questions/49156068/autofilter-connect-with-and-or/49157653#49157653", "title": "AutoFilter connect with and/or", "body": "<p><strong>Sort-of</strong>.\nFiltering by <code>AND</code> across columns is easy, but filtering by <code>OR</code> is <em>only</em> possible within a single column...  <em>unless</em> you add a \"calculation\" column and filter on that instead.</p>\n\n<p>To expand:  Create a new column, something like \"High Revenue or Market Value\", and give it a formula which is <code>TRUE</code> when [Market Value]>= 300 millon <code>OR</code> [Revenue] >= 100 millon or <code>FALSE</code> otherwise, then filter on that column for <code>TRUE</code>. (i.e. if \"Market Value\" is column B, and \"Revenues\" is column C, then the formula for row 2 would be <code>=OR(B2&gt;=300000000,C2&gt;=100000000)</code></p>\n"}], "owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520442814, "creation_date": 1520437897, "last_edit_date": 1520439249, "question_id": 49156068, "link": "https://stackoverflow.com/questions/49156068/autofilter-connect-with-and-or", "title": "AutoFilter connect with and/or", "body": "<p>I have a huge data sheet which I want to \"AutoFilter\" by three different criteria which are in three different columns. </p>\n\n<p>Is it possible in Excel VBA to connect three AutoFilters with a logic like: </p>\n\n<p>Criteria 1 <strong>AND</strong> (Criteria2 <strong>AND/OR</strong> Criteria3)</p>\n\n<p>For example, I am analiyzing football teams by league, market value, revenue.\nTherefore, I want to filter my data by following criterias: </p>\n\n<p>Criteria 1: They have to play in the highest league in their country\n<strong>AND</strong>\n(Criteria 2: Market Value most be >= 300 Mio \n<strong>AND/OR</strong>\nCriteria 3: Revenue most be >= 100 Mio )</p>\n\n<p>Thank you :) </p>\n"}, {"tags": ["excel", "vba", "validation"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1520437810, "post_id": 49155802, "comment_id": 85316654, "body": "Since you have separate columns for men&#39;s items and other for women&#39;s, just have the Data Validation for the applicable sizes in each appropriate column, why do you need an error check?"}, {"owner": {"reputation": 11, "user_id": 9457003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35c50179b0f74dc716fa8a37113ca6?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/9457003/elixir"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1520439524, "post_id": 49155802, "comment_id": 85317908, "body": "I just want to ensure I only get one pair of data"}, {"owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "edited": false, "score": 1, "creation_date": 1520440147, "post_id": 49155802, "comment_id": 85318330, "body": "So basically you only want the user to be able to fill either the Men&#39;s Size or the Women&#39;s size, but not both?  Why not change your order form to have a drop down for sex (M/F) -&gt; drop down for clothing type (Trousers, Coat) -&gt; drop down for size (appropriate sizes based on sex and clothing type, can use data validation if necessary).  This ensures that they can only select a single sex per line item on the order form."}, {"owner": {"reputation": 11, "user_id": 9457003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35c50179b0f74dc716fa8a37113ca6?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/9457003/elixir"}, "edited": false, "score": 0, "creation_date": 1520442023, "post_id": 49155802, "comment_id": 85319587, "body": "Would that be called a dependent list? Sorry, I&#39;m new to all this."}, {"owner": {"reputation": 369, "user_id": 5477223, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zEaP8.jpg?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/5477223/jan"}, "edited": false, "score": 0, "creation_date": 1520453656, "post_id": 49155802, "comment_id": 85326349, "body": "In the data validation list formula you can use nested if&#39;s to select values in another range.  It would be simpler as tigeravatar suggested to have one column for gender, another column for coat/trousers.  This formula is based on that concept. =IF(B2&amp;LEFT(C2,1)=&quot;MC&quot;,$I$2:$I$4,IF(B2&amp;LEFT(C2,1)=&quot;MT&quot;,$I$5:&zwnj;&#8203;$I$7,IF(B2&amp;LEFT(C2,1&zwnj;&#8203;)=&quot;FC&quot;,$I$8:$I$10,$I&zwnj;&#8203;$11:$I$13)))    Gender is in column B, Coat Trouser is in column C (with their own validation) and the valid values are in column I, with three options for each validation."}], "owner": {"reputation": 11, "user_id": 9457003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b35c50179b0f74dc716fa8a37113ca6?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/9457003/elixir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1325, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1520448641, "creation_date": 1520437124, "last_edit_date": 1520448641, "question_id": 49155802, "link": "https://stackoverflow.com/questions/49155802/combine-list-and-custom-formula-data-validation-in-one-cell", "title": "combine list and custom formula data validation in one cell", "body": "<p>I am working on a spreadsheet that will be used to order uniforms. </p>\n\n<p>All the sizes are contained on a separate sheet.</p>\n\n<p>I am trying to use data validation to ensure that whomever inputs a size, only selects from available sizes chosen from a list.</p>\n\n<p><strong>AND</strong></p>\n\n<p>that if they have selected a size for one sex, that they cannot input a size from another.</p>\n\n<p><br><br>\n<a href=\"https://i.stack.imgur.com/B29AB.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/B29AB.png\" alt=\"example\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/xOd1T.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xOd1T.png\" alt=\"example2\"></a></p>\n\n<p>The issue I'm having is that I can only choose between having a dropdown list or using my custom formula that performs the appropriate checks I need.</p>\n\n<p><strong>Is there a way to have more than one Data Validation setting per cell or to combine settings?</strong></p>\n\n<p>My custom formula: <code>=AND((SYSVAR!$G$3:$G$45), ISBLANK(J9))</code></p>\n"}, {"tags": ["vba", "outlook", "savefiledialog"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520437323, "post_id": 49155756, "comment_id": 85316304, "body": "for one thing.. do you need to specify the type of application rather than just   Application"}, {"owner": {"reputation": 159, "user_id": 6450586, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20eed796d8d3400c9e498e4d6d2dd185?s=128&d=identicon&r=PG&f=1", "display_name": "DGP", "link": "https://stackoverflow.com/users/6450586/dgp"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520437450, "post_id": 49155756, "comment_id": 85316390, "body": "In &quot;Save3&quot;, I used Excel and I think I did specify the Application as Excel, however I could be mistaken."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520438591, "post_id": 49155756, "comment_id": 85317260, "body": "My bad. You did above."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1520443410, "post_id": 49155756, "comment_id": 85320448, "body": "What type of file are you trying to save? Extension?"}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 6450586, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20eed796d8d3400c9e498e4d6d2dd185?s=128&d=identicon&r=PG&f=1", "display_name": "DGP", "link": "https://stackoverflow.com/users/6450586/dgp"}, "edited": false, "score": 0, "creation_date": 1520444506, "post_id": 49157648, "comment_id": 85321097, "body": "Sorry if I was not clear.  My attempt to be concise probably failed.  I am trying to write an OUTLOOK macro, but Outlook does not support FileDialogs, so I need to invoke EXCEL and use Excel to open a FileDialog.  The problem is that I can successfully open a FileDialog this way IF I open it as FilePicker (msoFileDialogOpen).  I cannot figure out how to open the FileDialog for SAVING (msoFileDialogSaveAs).  The FileDialog has me completely confused because I just cannot figure out how to use it in these various applications??"}, {"owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "reply_to_user": {"reputation": 159, "user_id": 6450586, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20eed796d8d3400c9e498e4d6d2dd185?s=128&d=identicon&r=PG&f=1", "display_name": "DGP", "link": "https://stackoverflow.com/users/6450586/dgp"}, "edited": false, "score": 0, "creation_date": 1520457144, "post_id": 49157648, "comment_id": 85328161, "body": "What are you saving?"}], "tags": [], "owner": {"reputation": 2987, "user_id": 8173870, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xoZ3j.jpg?s=128&g=1", "display_name": "HackSlash", "link": "https://stackoverflow.com/users/8173870/hackslash"}, "is_accepted": false, "score": 0, "last_activity_date": 1520442783, "creation_date": 1520442783, "answer_id": 49157648, "question_id": 49155756, "link": "https://stackoverflow.com/questions/49155756/how-to-launch-save-as-filedialog/49157648#49157648", "title": "How to launch SAVE AS FileDialog", "body": "<p>This function will return the filename selected. It won't actually save something. It's not clear what you are trying to do.</p>\n\n<pre><code>Public Function fnOpenFileDialog(strStartingPath As String) As String\n    Dim strStartingPath As String\n    strStartingPath = Date\n    Dim xlobj As Excel.Application\n    Set xlobj = New Excel.Application\n    fnOpenFileDialog = xlobj.GetSaveAsFilename(InitialFileName:=strStartingPath, fileFilter:=\"Excel Files (*.xls), *.xls\")\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 6450586, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20eed796d8d3400c9e498e4d6d2dd185?s=128&d=identicon&r=PG&f=1", "display_name": "DGP", "link": "https://stackoverflow.com/users/6450586/dgp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 583, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593041277, "creation_date": 1520436974, "last_edit_date": 1593041277, "question_id": 49155756, "link": "https://stackoverflow.com/questions/49155756/how-to-launch-save-as-filedialog", "title": "How to launch SAVE AS FileDialog", "body": "<p>I have previously written vba to open a File Dialog as a File Picker by referencing Excel <code>(because I understand that Outlook does not support the FileDialog object)</code>.  However, I am having great difficulty doing something very similar but for SAVING.</p>\n\n<p>My requirement is to build a macro that will open a Save As File Dialog, with:</p>\n\n<p>1) Opening at a specific folder</p>\n\n<p>2) <code>Pre-Populate</code> the File Name with a <code>DateTime</code> Stamp (and allow the User to complete the rest of the name)</p>\n\n<p>For the sake of explanation, I have trimmed the function code below (and I call it from a simple Testing Sub)</p>\n\n<p>I am a longtime Access VBA develop[er, but am struggling as I try to write vba in Outlook and Word, so any guidance would be appreciated.</p>\n\n<hr>\n\n<p>THIS WORKS:</p>\n\n<pre><code>Public Function fnOpenFileDialog_Save2(strStartingPath As String)\nOn Error GoTo HandleErr\n\n    'Launch File Browser\n    'NOTE:  Outlook actually does NOT support the FileDialog, so you need to hack a solution and use another Office app instead\n    'This uses Excel to open the FileDialog\n\n   Dim xlobj As Excel.Application\n   Set xlobj = New Excel.Application\n        With xlobj.FileDialog(msoFileDialogOpen)\n\n            .InitialFileName = strStartingPath\n            .Title = \"msoFileDialogOpen WORKS!\"\n            .Show\n            'I have removed the code to select and Open Item/File as it DOES work\n        End With\n    xlobj.Quit\n    Set xlobj = Nothing\n\nExitHere:\n    Exit Function\nHandleErr:    \n    MsgBox \"Error during fnOpenFileDialog_Save2 - \" &amp; Err.Description\n    GoTo ExitHere\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>If I try to change to a SaveAs FileDialog, I cannot get anything to work.  Examples of my failures below:</p>\n\n<pre><code>Public Function fnOpenFileDialog_Save3(strStartingPath As String)\nOn Error GoTo HandleErr\n\n   Dim xlobj As Excel.Application\n   Set xlobj = New Excel.Application\n        With xlobj.FileDialog(msoFileDialogSaveAs) 'Throws an ERROR HERE:  \"Automation Error.  The remote procedure call failed\"\n\n            .InitialFileName = strStartingPath\n            .Title = \"msoFileDialogSaveAs does NOT work!\"\n            .Show\n            'I have removed the code to select and Open Item/File as it DOES work\n        End With\n    xlobj.Quit\n    Set xlobj = Nothing\n\nExitHere:\n    Exit Function\n\n    Public Function fnOpenFileDialog_Save4(strStartingPath As String)\n    On Error GoTo HandleErr\n\n    Dim xlobj As Application\n\n       Set xlobj = New Application\n            With xlobj.FileDialog(msoFileDialogSaveAs) 'Throws an ERROR HERE:  \"Object doesn't support this property or method\"\n\n                .InitialFileName = strStartingPath\n                .Title = \"msoFileDialogSaveAs does NOT work!\"\n                .Show\n\n            End With\n        xlobj.Quit\n        Set xlobj = Nothing\n\n    ExitHere:\n        Exit Function\n\nPublic Function fnOpenFileDialog_Save5(strStartingPath As String)\nOn Error GoTo HandleErr\n\nDim objDialog As Object\nSet objDialog = Application.FileDialog(msoFileDialogSaveAs)\n\n        With objDialog 'Throws an ERROR HERE:  \"Object doesn't support this property or method\"\n\n            .InitialFileName = strStartingPath\n            .Title = \"msoFileDialogSaveAs does NOT work!\"\n            .Show\n    End With\n    objDialog.Quit\n    Set objDialog = Nothing\n\nExitHere:\n    Exit Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1520438421, "post_id": 49155690, "comment_id": 85317109, "body": "Use google and you will probably find the answers"}], "answers": [{"tags": [], "owner": {"reputation": 83, "user_id": 4038083, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-cs9T1UhhtYE/AAAAAAAAAAI/AAAAAAAAACY/NsAaEphv0s4/photo.jpg?sz=128", "display_name": "John Tesmer", "link": "https://stackoverflow.com/users/4038083/john-tesmer"}, "is_accepted": true, "score": 1, "last_activity_date": 1520445377, "creation_date": 1520445377, "answer_id": 49158413, "question_id": 49155690, "link": "https://stackoverflow.com/questions/49155690/how-to-make-excel-completely-full-screen-hiding-the-title-bar-of-window-the-w/49158413#49158413", "title": "How to make Excel completely Full screen, hiding the Title-bar of Window &amp; the Windows Taskbar?", "body": "<p>Unfortunately this cannot be done with VBA, as the VBA interpreter runs AFTER Excel has loaded.</p>\n\n<p>You need to use a command line switch to start Excel.</p>\n\n<p>Here is Microsoft's solution: start Excel with the <code>/e</code> option.</p>\n\n<p><a href=\"https://support.microsoft.com/en-us/help/291288/description-of-the-startup-switches-for-excel\" rel=\"nofollow noreferrer\">https://support.microsoft.com/en-us/help/291288/description-of-the-startup-switches-for-excel</a></p>\n"}], "owner": {"reputation": 365, "user_id": 9393184, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eVIhBhcNQ8Q/AAAAAAAAAAI/AAAAAAAAmmg/KIgV06D6Mtg/photo.jpg?sz=128", "display_name": "Rahilkhan Pathan", "link": "https://stackoverflow.com/users/9393184/rahilkhan-pathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4020, "favorite_count": 1, "accepted_answer_id": 49158413, "answer_count": 1, "score": 0, "last_activity_date": 1520445377, "creation_date": 1520436774, "last_edit_date": 1520445087, "question_id": 49155690, "link": "https://stackoverflow.com/questions/49155690/how-to-make-excel-completely-full-screen-hiding-the-title-bar-of-window-the-w", "title": "How to make Excel completely Full screen, hiding the Title-bar of Window &amp; the Windows Taskbar?", "body": "<p>My current code allows me to go to full screen without any problem, but still, I need complete immersive mode by-</p>\n\n<blockquote>\n  <ol>\n  <li>Hiding the Title bar of Excel</li>\n  <li>Stopping the Excel Flash screen on startup </li>\n  <li>Hiding the Windows Taskbar.</li>\n  </ol>\n</blockquote>\n\n<p>Is there a VBA Code for that? Please help. \nThanks in advance :)</p>\n\n<pre><code> Private Sub Workbook_Open()\n\nActiveWindow.DisplayHeadings = False\nActiveWindow.DisplayWorkbookTabs = False\nApplication.DisplayFormulaBar = False\nActiveWindow.DisplayGridlines = False\nApplication.DisplayFullScreen = True\nApplication.Windows(ThisWorkbook.Name).WindowState = xlMaximized\nApplication.WindowState = xlMaximized 'maximize Excel\nActiveWindow.WindowState = xlMaximized 'maximize the workbook in Excel\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1520438189, "post_id": 49155379, "comment_id": 85316940, "body": "Instead of copying, try <code>Sourcesheet.Range(&quot;A1:D10&quot;).Value = DestinationSheet.Range(&quot;A1:D10&quot;).Value</code> (make sure both ranges are the same size). That should help with the formatting issue."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1520443503, "post_id": 49155379, "comment_id": 85320520, "body": "You are better off editing your question."}, {"owner": {"reputation": 49, "user_id": 4758543, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4f491cd72c052401f6e36b3a4997858e?s=128&d=identicon&r=PG&f=1", "display_name": "Zatin Dharmapuri", "link": "https://stackoverflow.com/users/4758543/zatin-dharmapuri"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1520445610, "post_id": 49155379, "comment_id": 85321761, "body": "I edited the Code in my Question with what you suggested. But as I said it throws a Runtime Error : Object Required. Probably, I did not understand how to place your suggestion in my code."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1520445977, "post_id": 49155379, "comment_id": 85321956, "body": "Change <code>With Sourcesheet.Range(&quot;A5:J104&quot;).Value = DestinationSheet.Range(&quot;A5:J104&quot;).Value &#47;&#47; End With</code> with <code>Sourcesheet.Range(&quot;A5:J104&quot;).Value = DestinationSheet.Range(&quot;A5:J104&quot;).Value</code> (no need for <code>with</code>)"}, {"owner": {"reputation": 49, "user_id": 4758543, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4f491cd72c052401f6e36b3a4997858e?s=128&d=identicon&r=PG&f=1", "display_name": "Zatin Dharmapuri", "link": "https://stackoverflow.com/users/4758543/zatin-dharmapuri"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1520451822, "post_id": 49155379, "comment_id": 85325385, "body": "Nice, Thanks for this. Looks like it did the magic. Formatting issue is out of way. Hope you crack the Empty row data issue too. Thanks again."}], "owner": {"reputation": 49, "user_id": 4758543, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4f491cd72c052401f6e36b3a4997858e?s=128&d=identicon&r=PG&f=1", "display_name": "Zatin Dharmapuri", "link": "https://stackoverflow.com/users/4758543/zatin-dharmapuri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1520587462, "creation_date": 1520435938, "last_edit_date": 1531161705, "question_id": 49155379, "link": "https://stackoverflow.com/questions/49155379/exclude-empty-rows-retain-destination-formatting-while-merging-multiple-workbo", "title": "Exclude Empty Rows &amp; Retain Destination Formatting while Merging Multiple Workbooks", "body": "<p>I customized Merging multiple Sheets of Data code from this site. I achieve a result with critical issues. </p>\n\n<ol>\n<li><p>Empty Rows from the defined Range are being copied too. Tried avoiding them by tweaking RDB_Last function.</p></li>\n<li><p>Unable to retain the Destination Formatting. Trying to use <code>If PasteAsValues = True Then</code>.</p></li>\n</ol>\n\n<p><strong>Below is the Code</strong></p>\n\n<pre><code>Sub MergeAllWorkbooks()\nDim FirstCell As String\nDim MyPath As String, FilesInPath As String\nDim myFiles() As String\nDim SourceRcount As Long, FNum As Long\nDim mybook As Workbook, BaseWks As Worksheet\nDim sourceRange As Range, destrange As Range\nDim rnum As Long, CalcMode As Long\n\n' Change this to the path\\folder location of your files.\nMyPath = \"C:\\Users\\zatin.dharmapuri\\Desktop\\3. 2018\\Raw Data Month wise\\Jan-2018\"\n\n' Add a slash at the end of the path if needed.\nIf Right(MyPath, 1) &lt;&gt; \"\\\" Then\n    MyPath = MyPath &amp; \"\\\"\nEnd If\n\n' If there are no Excel files in the folder, exit.\nFilesInPath = Dir(MyPath &amp; \"*.xl*\")\nIf FilesInPath = \"\" Then\n    MsgBox \"No files found\"\n    Exit Sub\nEnd If\n\n' Fill the myFiles array with the list of Excel files\n' in the search folder.\nFNum = 0\nDo While FilesInPath &lt;&gt; \"\"\n    FNum = FNum + 1\n    ReDim Preserve myFiles(1 To FNum)\n    myFiles(FNum) = FilesInPath\n    FilesInPath = Dir()\nLoop\n\n' Set various application properties.\nWith Application\n    CalcMode = .Calculation\n    .Calculation = xlCalculationManual\n    .ScreenUpdating = False\n    .EnableEvents = False\nEnd With\n\n' Set the sheet name for the data to be copied to.\nSet BaseWks = ThisWorkbook.Sheets(\"Sheet3\")\nrnum = 1\n\n' Loop through all files in the myFiles array.\nIf FNum &gt; 0 Then\n    For FNum = LBound(myFiles) To UBound(myFiles)\n        Set mybook = Nothing\n        On Error Resume Next\n        Set mybook = Workbooks.Open(MyPath &amp; myFiles(FNum))\n        On Error GoTo 0\n\n        If Not mybook Is Nothing Then\n            On Error Resume Next\n\n            'Change this range to fit your own needs.\n            With mybook.Worksheets(\"Defect Analysis Reports\")\n               Set sourceRange = .Range(\"A5:J104\")\n            End With\n\n                'FirstCell = \"A5\"\n                'Set sourceRange = .Range(FirstCell &amp; \":\" &amp; RDB_Last(1, .Row))\n                ' Test if the row of the last cell is equal to or greater than the row of the first cell.\n                'If RDB_Last(1, .Row) &lt; .Range(FirstCell).Row Then\n                 '       Set sourceRange = Nothing\n                  '  End If\n                'End With\n\n            If Err.Number &gt; 0 Then\n                Err.Clear\n                Set sourceRange = Nothing\n            Else\n                ' If source range uses all columns then\n                ' skip this file.\n                If sourceRange.Columns.Count &gt;= BaseWks.Columns.Count Then\n                    Set sourceRange = Nothing\n                End If\n            End If\n            On Error GoTo 0\n\n            If Not sourceRange Is Nothing Then\n\n                SourceRcount = sourceRange.Rows.Count\n\n                If rnum + SourceRcount &gt;= BaseWks.Rows.Count Then\n                    MsgBox \"There are not enough rows in the target worksheet.\"\n                    BaseWks.Columns.AutoFit\n                    mybook.Close savechanges:=False\n                    GoTo ExitTheSub\n                Else\n\n                    ' Copy the file name in column A.\n                    With sourceRange\n                        BaseWks.Cells(rnum, \"A\"). _\n                                Resize(.Rows.Count).Value = myFiles(FNum)\n                    End With\n\n                    ' Set the destination range.\n                    Set destrange = BaseWks.Range(\"B\" &amp; rnum)\n\n                    ' Copy the values from the source range\n                    ' to the destination range.\n                    With Sourcesheet.Range(\"A5:J104\").Value = \n                    DestinationSheet.Range(\"A5:J104\").Value\n                    End With\n                    destrange.Value = sourceRange.Value\n\n                    rnum = rnum + SourceRcount\n                End If\n            End If\n            mybook.Close savechanges:=False\n        End If\n\n    Next FNum\n    BaseWks.Columns.AutoFit\nEnd If\nExitTheSub:\n' Restore the application properties.\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n    .Calculation = CalcMode\nEnd With\nMsgBox \"All Data has been merged successfully\"\nEnd Sub\n</code></pre>\n\n<p>I'm a beginner in VBA.</p>\n"}, {"tags": ["c#", "excel", "excel-interop", "vba"], "owner": {"reputation": 31353, "user_id": 1179880, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/02d09848db9f59fa45d61d9c4100e779?s=128&d=identicon&r=PG", "display_name": "whytheq", "link": "https://stackoverflow.com/users/1179880/whytheq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1520962433, "creation_date": 1520435860, "last_edit_date": 1531161705, "question_id": 49155357, "link": "https://stackoverflow.com/questions/49155357/xlsm-file-being-added-to-a-disabled-list", "title": "xlsm file being added to a disabled list", "body": "<p>I have a C# console application that runs many Excel macros.</p>\n\n<p>Each macro makes use of a shared read-only xlsm file that contains many helper functions \"helperroutinesnetwork.xlsm\". It is effectively a factory for lots of shared <code>vba</code> functionality.</p>\n\n<p>If the C# console crashes irretrievably, when a workbook plus helperroutinesnetwork are open we are finding that the helper workbook gets effectively blacklisted and added to Excel's disabled books.</p>\n\n<p>What this means is that any subsequent macros that need the helper book cannot find or use it until we manually move it out of the Disable list like so:</p>\n\n<p><a href=\"https://i.stack.imgur.com/EutUM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/EutUM.png\" alt=\"enter image description here\"></a></p>\n\n<p>Is it possible to either:</p>\n\n<ol>\n<li>Write a script that detects if it has been added to the disabled list and even to enable it?</li>\n<li>Ensure it is always protected and never allowed to be added to the Disabled add-ins list?</li>\n</ol>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 7533, "user_id": 5414798, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/XuD6Q.png?s=128&g=1", "display_name": "Nathan_Sav", "link": "https://stackoverflow.com/users/5414798/nathan-sav"}, "is_accepted": false, "score": 0, "last_activity_date": 1520437324, "creation_date": 1520437324, "answer_id": 49155878, "question_id": 49155014, "link": "https://stackoverflow.com/questions/49155014/how-to-use-cell-range-in-sql/49155878#49155878", "title": "How to use cell range in SQL", "body": "<p>Something like this will do </p>\n\n<p><code>\"'\" &amp; join(application.transpose(worksheets(\"Sheet1\").range(\"a1:a10\").value),\"','\") &amp; \"'\"</code>  for text values</p>\n\n<p>or <code>join(application.transpose(worksheets(\"Sheet1\").range(\"a1:a10\").value),\",\")</code> for numeric</p>\n"}], "owner": {"reputation": 1, "user_id": 9457370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/add52cbe4bae78eb45c360facbf01852?s=128&d=identicon&r=PG&f=1", "display_name": "JSalyers", "link": "https://stackoverflow.com/users/9457370/jsalyers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520437324, "creation_date": 1520434957, "last_edit_date": 1520435162, "question_id": 49155014, "link": "https://stackoverflow.com/questions/49155014/how-to-use-cell-range-in-sql", "title": "How to use cell range in SQL", "body": "<p>I am attempting to remove the need to manually look up values, I receive a list with case numbers that need to be matched with IDs.  Right now I am pulling the IDs and adding with a vlookup.\nThe query I use in SQL is super basic</p>\n\n<pre><code>Select Case_Number, ID from Table where Case_Numbber in ();\n</code></pre>\n\n<p>I need to figure out who to run the query inside a macro where it uses the cell range.  So something like this </p>\n\n<pre><code>Select Case_Number, ID from Table where Case_Numbber in (Sheet1!A1:A10);\n</code></pre>\n"}, {"tags": ["vba", "error-handling", "copy-paste"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 9355397, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1f409a95833a3e26e151bf5e7883f86d?s=128&d=identicon&r=PG&f=1", "display_name": "papacoolaid666", "link": "https://stackoverflow.com/users/9355397/papacoolaid666"}, "edited": false, "score": 0, "creation_date": 1520449931, "post_id": 49155205, "comment_id": 85324278, "body": "I was still getting errors with it even on a clean sheet. I ended up changing the formula in cells inputted into CJ and just copy and pasting the entire column and now it works great. Thank you though!"}], "tags": [], "owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "is_accepted": false, "score": 0, "last_activity_date": 1520435469, "creation_date": 1520435469, "answer_id": 49155205, "question_id": 49154950, "link": "https://stackoverflow.com/questions/49154950/copy-paste-error-action-cant-work-on-multiple-sections/49155205#49155205", "title": "Copy &amp; Paste error &quot;Action can&#39;t work on multiple sections&quot;", "body": "<p>Your code looks fine. I tested it and it gave the result I think you expect. The problem I think you are having is that some cells might be merged. Try it on a clean sheet.</p>\n"}], "owner": {"reputation": 85, "user_id": 9355397, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1f409a95833a3e26e151bf5e7883f86d?s=128&d=identicon&r=PG&f=1", "display_name": "papacoolaid666", "link": "https://stackoverflow.com/users/9355397/papacoolaid666"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1520435469, "creation_date": 1520434772, "question_id": 49154950, "link": "https://stackoverflow.com/questions/49154950/copy-paste-error-action-cant-work-on-multiple-sections", "title": "Copy &amp; Paste error &quot;Action can&#39;t work on multiple sections&quot;", "body": "<p>I am trying to paste the filtered results another column in the corresponding cells. When I try to paste I get the error \"Action can't work on multiple sections\". Any idea how to fix the code? </p>\n\n<pre><code>LRow = Ws1.Range(\"CJ\" &amp; Rows.Count).End(xlUp).Row\nSet PasteRng = Ws1.Range(\"F1:F\" &amp; LRow).SpecialCells(xlCellTypeVisible)\nWs1.Range(\"CJ1:CJ\" &amp; LRow).SpecialCells(xlCellTypeVisible).Copy\nPasteRng.PasteSpecial xlPasteValues\nApplication.CutCopyMode = False\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "visual-studio"], "comments": [{"owner": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 1, "creation_date": 1520435632, "post_id": 49154749, "comment_id": 85314991, "body": "This code is vba, but you are testing it at a vb.net website.  By the way, your vba code runs fine!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6050386"}, "reply_to_user": {"reputation": 6522, "user_id": 5162073, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/njEl9.png?s=128&g=1", "display_name": "Brian M Stafford", "link": "https://stackoverflow.com/users/5162073/brian-m-stafford"}, "edited": false, "score": 0, "creation_date": 1520435833, "post_id": 49154749, "comment_id": 85315160, "body": "@BrianMStafford oh..didn&#39;t realise that. Thanks for the affirmation."}], "owner": {"user_type": "does_not_exist", "display_name": "user6050386"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520434247, "creation_date": 1520434247, "question_id": 49154749, "link": "https://stackoverflow.com/questions/49154749/cube-of-a-number-using-visual-basic-using-for-next", "title": "Cube of a number using Visual Basic using For..Next", "body": "<p>This is what I've come up with but it doesn't seem to compile. <a href=\"http://rextester.com/live/AHLL27136\" rel=\"nofollow noreferrer\">http://rextester.com/live/AHLL27136</a></p>\n\n<pre><code>dim n, var As integer\nFor var = 1 to 10\nn=InputBox(\"enter\")\nmsgbox \"The cube of number is\" &amp; n^3\nNext var\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1520433351, "post_id": 49154419, "comment_id": 85313301, "body": "You already have Column E?"}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1520433372, "post_id": 49154419, "comment_id": 85313319, "body": "Yes I am looking to now get column F"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1520433665, "post_id": 49154515, "comment_id": 85313530, "body": "Hi, in cell F2 I am getting 0 when using this formula."}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1520433686, "post_id": 49154515, "comment_id": 85313536, "body": "I would prefer to use vba as that&#39;s what I have used throughout if possible"}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1520433799, "post_id": 49154515, "comment_id": 85313618, "body": "please review the image I have just attached showing the 0 in F2."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1520433840, "post_id": 49154515, "comment_id": 85313643, "body": "Well 1) your test data shows <code>,</code> as the deliniator.  Change the <code>&quot;,&quot;</code> to <code>&quot;;&quot;</code>.  2) if you want vba you will need to show what you have tried"}, {"owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "edited": false, "score": 0, "creation_date": 1520434114, "post_id": 49154515, "comment_id": 85313837, "body": "I am going to just use the formula thanks for your help I will accept your answer"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1520433913, "last_edit_date": 1520433913, "creation_date": 1520433525, "answer_id": 49154515, "question_id": 49154419, "link": "https://stackoverflow.com/questions/49154419/checking-and-summing-a-value-in-a-delimitted-list/49154515#49154515", "title": "checking and summing a value in a delimitted list", "body": "<p>Use this SUMPRODUCT:</p>\n\n<pre><code>=SUMPRODUCT((ISNUMBER(FIND(\",\" &amp; E2 &amp; \",\" , \",\" &amp; $D$2:$D$4 &amp; \",\")))*($C$2:$C$4))\n</code></pre>\n\n<p>Based on your photo that is different than your test data:</p>\n\n<pre><code>=SUMPRODUCT((ISNUMBER(FIND(\";\" &amp; E2 &amp; \";\" , \";\" &amp; $D$2:$D$4 &amp; \";\")))*($C$2:$C$4))\n</code></pre>\n\n<p>The <code>\",\" &amp; ... &amp; \",\"</code> on both the search and criterion make it so <code>11</code> does not return on <code>112</code> or <code>111</code>, or <code>0</code> is found in <code>101</code> or <code>110</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/FoIUu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FoIUu.png\" alt=\"enter image description here\"></a></p>\n\n<hr>\n\n<p>If your codes are always three digits then you can use a wild card SUMIFS()</p>\n\n<pre><code>=SUMIFS(C:C,B:B,\"*\" &amp; E2 &amp; \"*\")\n</code></pre>\n\n<p>But this will find partial matches.  <code>0</code> would be found in <code>101</code> and <code>110</code> and could return false positives.</p>\n"}], "owner": {"reputation": 27, "user_id": 9395775, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ec32efec16a67710fc4133c9db7e31a7?s=128&d=identicon&r=PG&f=1", "display_name": "George H", "link": "https://stackoverflow.com/users/9395775/george-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 49154515, "answer_count": 1, "score": -2, "last_activity_date": 1520433913, "creation_date": 1520433218, "last_edit_date": 1531164843, "question_id": 49154419, "link": "https://stackoverflow.com/questions/49154419/checking-and-summing-a-value-in-a-delimitted-list", "title": "checking and summing a value in a delimitted list", "body": "<p>I am checking for a value in Column D and populating this as a summary list in column E. I currently do not have the total in Column F which would be a summed up value from column C as shown below in the test data.</p>\n\n<p>Test Data</p>\n\n<pre><code>Sheet Name: Transactions Expected Result\nColumn A Column B Column C Column D    Column E       Column F\nID         Name      Amount   BID      BIDSummary    Total Amount\n123        John        100    0,111       111            400\n456        Bill        200    122,0       122            200\n789        Tony        300    0,111\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/LpZKu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LpZKu.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 4, "creation_date": 1520433006, "post_id": 49154314, "comment_id": 85313057, "body": "if the next cell is blank <code>End(xlToRight)</code> will go to either the next cell that has a value or the last column depending on which comes first."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9457200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63e1e29b50d492fa7e4f626439019ab0?s=128&d=identicon&r=PG&f=1", "display_name": "Michael1964", "link": "https://stackoverflow.com/users/9457200/michael1964"}, "edited": false, "score": 0, "creation_date": 1520434188, "post_id": 49154442, "comment_id": 85313876, "body": "We have a winner.  Thank you for your prompt attention."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 9457200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63e1e29b50d492fa7e4f626439019ab0?s=128&d=identicon&r=PG&f=1", "display_name": "Michael1964", "link": "https://stackoverflow.com/users/9457200/michael1964"}, "edited": false, "score": 3, "creation_date": 1520434438, "post_id": 49154442, "comment_id": 85314042, "body": "@Michael1964 please mark as correct by clicking the check mark by the answer.  It will remove this from the unanswered queue."}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 3, "last_activity_date": 1520434043, "last_edit_date": 1520434043, "creation_date": 1520433284, "answer_id": 49154442, "question_id": 49154314, "link": "https://stackoverflow.com/questions/49154314/endxltoright-sends-me-to-the-last-colum-xfd-i-want-to-go-to-the-next-column/49154442#49154442", "title": "End(xlToRight) sends me to the last colum--XFD i want to go to the next column, not the last column", "body": "<p>if the next cell is blank <code>End(xlToRight)</code> will go to either the next cell that has a value or the last column depending on which comes first.</p>\n\n<p>come in from the last column instead:</p>\n\n<pre><code>cells(thiscell1.row,columns.count).End(xltoLeft).offset(,1) = Range(\"B4\")\n</code></pre>\n\n<p>This will find the last occupied cell in that row and move over one.</p>\n\n<p>One more note:</p>\n\n<p>Get in the practice of assigning the parent sheet to <strong>All</strong> Range Objects</p>\n\n<pre><code>With Worksheets(\"Sheet1\") 'Change to your sheet.\n    .cells(thiscell1.row,.columns.count).End(xltoLeft).offset(,1) = .Range(\"B4\")\nEnd with\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9457200, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63e1e29b50d492fa7e4f626439019ab0?s=128&d=identicon&r=PG&f=1", "display_name": "Michael1964", "link": "https://stackoverflow.com/users/9457200/michael1964"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 0, "accepted_answer_id": 49154442, "answer_count": 1, "score": 0, "last_activity_date": 1520434043, "creation_date": 1520432915, "last_edit_date": 1531161705, "question_id": 49154314, "link": "https://stackoverflow.com/questions/49154314/endxltoright-sends-me-to-the-last-colum-xfd-i-want-to-go-to-the-next-column", "title": "End(xlToRight) sends me to the last colum--XFD i want to go to the next column, not the last column", "body": "<p>In Excel VBA I am comparing two columns.  If the the value in column H appears in column B I want to past a value in the next blank cell to right of column H.</p>\n\n<pre><code>For Each ThisCell1 In Range(\"H5:H\" &amp; Cells(Rows.Count, \"H\").End(xlUp).Row)\n    'This is the range of cells to check\n        For Each ThisCell2 In Range(\"B5:B\" &amp; Cells(Rows.Count, \"B\").End(xlUp).Row)\n        'This is the range of cells to compare\n    If ThisCell1.Value = ThisCell2.Value Then\n            ThisCell1.End(xlToRight).Value = Range(\"B4\")\n</code></pre>\n\n<p>My code puts B4 in column XFD, but I want it in column I, J or K.  What am I doing wrong.</p>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1520432427, "post_id": 49154096, "comment_id": 85312694, "body": "what is <code>NACECode</code> ? And &quot;<i>does not execute</i>&quot; does not describe what happens."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520432726, "post_id": 49154096, "comment_id": 85312879, "body": "did you try to use <code>, Operator:=xlFilterValues</code>?  Like <code>Bereich.Autofilter Field:=21, Criteria1:=&quot;=&quot; &amp; IndustryCode, Operator:=xlFilterValues</code>"}, {"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520432805, "post_id": 49154096, "comment_id": 85312928, "body": "@PEH: &quot;does not execute&quot; means, when I try to run the macro it does not work and shows &quot;Run-Time error &#39;13&#39;: Typen unvertr&#228;glich"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1520432883, "post_id": 49154096, "comment_id": 85312970, "body": "Error message without telling in which line it occurs is usless in most cases. So in which line do you get the error?"}, {"owner": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "edited": false, "score": 1, "creation_date": 1520432932, "post_id": 49154096, "comment_id": 85312997, "body": "You need to use loop to select each value in range B:B. Autofilter cant select all the values at a time"}, {"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1520432973, "post_id": 49154096, "comment_id": 85313036, "body": "@PEH: Sorry my fault. It occours in Bereich.Autofilter Field:=21, Criteria1:=&quot;=&quot; &amp; IndustryCode"}, {"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "reply_to_user": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "edited": false, "score": 0, "creation_date": 1520433189, "post_id": 49154096, "comment_id": 85313187, "body": "@Deepak: Thanks for your advice. How would you code that in my case? :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 429, "user_id": 8841973, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/315b8fe679afc0bdbed1296760210350?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak", "link": "https://stackoverflow.com/users/8841973/deepak"}, "edited": false, "score": 0, "creation_date": 1520433653, "post_id": 49154096, "comment_id": 85313519, "body": "@Deepak No loop needed, you just need to transform the matrix ;) making a 1 dimenional array out of a 2 dimensional one and use this as criteria (see my answer)."}, {"owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1520434378, "post_id": 49154096, "comment_id": 85314004, "body": "Note, that this solution can only work for non-numeric filter values because <code>Variant</code> is most likely to assume <code>String</code> values. So, if you are storing numbers as string into an array and then filter by that array then the filter will be a string filter (on a possibly numeric column)."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "edited": false, "score": 0, "creation_date": 1520437250, "post_id": 49154096, "comment_id": 85316255, "body": "@Ralph The <code>Variant</code> is only that the variable can contain an array but inside that array the items of that array still can be of type <code>Double</code> (when your read numbers from a range then <code>vartype(IndustryCode(1))</code> is Double if the first entry is a number even if <code>IndustryCode</code> is Variant). And that fact finally causes the issue that it fails filtering on true numbers. If they were strings then filtering would work. Excel is kinda odd with filtering and true numbers in VBA but <a href=\"https://stackoverflow.com/a/42932732/3219613\">this answer</a> illustrates it."}], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1520438058, "last_edit_date": 1520438058, "creation_date": 1520433586, "answer_id": 49154531, "question_id": 49154096, "link": "https://stackoverflow.com/questions/49154096/excel-vba-autofilter-codes/49154531#49154531", "title": "Excel VBA AutoFilter Codes", "body": "<p>You need to transpose the <code>IndustryCode</code> because this</p>\n\n<pre><code>IndustryCode = Tabelle3.Range(\"B:B\").Value2\n</code></pre>\n\n<p>results in a 2 dimensional <code>array(1 to 1048576, 1 to 1)</code> but the criteria awaits a 1 dimensional array.</p>\n\n<p>So after</p>\n\n<pre><code>IndustryCode = Application.WorksheetFunction.Transpose(IndustryCode)\n</code></pre>\n\n<p>you get a 1 dimensional <code>array(1 to 65536)</code> which you can use as <code>Criteria1</code> together with <code>Operator:=xlFilterValues</code>.</p>\n\n<pre><code>Sub aaa()\n    Dim Bereich As Range\n    Dim IndustryCode As Variant\n\n    Set Bereich = Tabelle1.UsedRange\n    IndustryCode = Tabelle3.Range(\"B:B\").Value2\n    IndustryCode = Application.WorksheetFunction.Transpose(IndustryCode)\n\n    Bereich.AutoFilter Field:=21, Criteria1:=IndustryCode, Operator:=xlFilterValues\nEnd Sub\n</code></pre>\n\n<p>Note that it is not very elegant to use the whole column because the array has <code>65536</code> entries which means most are empty. A better way would be using only the range as array that is filled with data:</p>\n\n<pre><code>IndustryCode = Tabelle3.Range(\"B1\", Tabelle3.Cells(Cells.Rows.Count, \"B\").End(xlUp)).Value2\n</code></pre>\n\n<p>This will reduce the array to the used part of column B only.</p>\n\n<hr>\n\n<p>Also note that if <code>IndustryCode</code> (column B) contains true numbers they need to be converted into strings with a loop over the array.</p>\n\n<pre><code>ary(i) = CStr(ary(i))\n</code></pre>\n\n<p>as illustrated in <a href=\"https://stackoverflow.com/a/42932732/3219613\">this answer</a>.</p>\n"}], "owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 49154531, "answer_count": 1, "score": 1, "last_activity_date": 1539696011, "creation_date": 1520432309, "last_edit_date": 1520432502, "question_id": 49154096, "link": "https://stackoverflow.com/questions/49154096/excel-vba-autofilter-codes", "title": "Excel VBA AutoFilter Codes", "body": "<p>I want to filter a list of industries by using their industry code (e.g. C10.3, H53.1 etc.)as criteria. At the end, I want my sheet just showing those industries.</p>\n\n<p>The data I want to filter is in Tabelle1 Column 21. Furthermore, I have stated my industry codes on Tabelle3 Column B. However, the following code does not execute.</p>\n\n<p>Does anyone know why and how I can adjust it to my needs? </p>\n\n<pre><code>Sub Autofilter()    \n    Dim Bereich As Range\n    Dim IndustryCode As Variant\n\n    Set Bereich = Tabelle1.UsedRange\n    IndustryCode = Tabelle3.Range(\"B:B\").Value2\n\n    Bereich.Autofilter Field:=21, Criteria1:=\"=\" &amp; IndustryCode  \nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 3, "creation_date": 1520431303, "post_id": 49153726, "comment_id": 85311909, "body": "If <b>what</b> substring is within <b>what</b> string? Please read the docs for <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/instr-function\" rel=\"nofollow noreferrer\">instr</a>."}, {"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1520431344, "post_id": 49153726, "comment_id": 85311938, "body": "inStr takes at least 2 arguments (comma separated) and you only have 1. Hence &quot;expected list separator&quot; error."}, {"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520431526, "post_id": 49153726, "comment_id": 85312067, "body": "Hi, I have added the code snippet can you please advise alternatives for what I could use to perform same task?"}, {"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 0, "creation_date": 1520431543, "post_id": 49153726, "comment_id": 85312085, "body": "Why would you need an alternative? You just need to use the function correctly."}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1520431687, "post_id": 49153726, "comment_id": 85312192, "body": "In third line of your code, you use <code>InStr</code> correctly, giving 2 parameters. However, inside your loop, you pass only one parameter."}, {"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520431772, "post_id": 49153726, "comment_id": 85312243, "body": "I have now changed to: If InStr(workcell.Value, &quot;;&quot; &amp; Trim(str(r)) &amp; &quot;;&quot;) &lt; 1 Then"}, {"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520431852, "post_id": 49153726, "comment_id": 85312309, "body": "compile error: invalid next control variable reference"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520432537, "post_id": 49153726, "comment_id": 85312761, "body": "you are missing an End If and your Next workcell but also, you should specify the start position of InStr e.g. InStr(1, &quot;;&quot; &amp; Trim(Str(r)) &amp; &quot;;&quot;) &lt; 1  but why are you adding ; to str(r) ? The logic of these bits seems off especially as the first If inStr(&quot;;&quot; &amp; Trim(str(r)) &amp; &quot;;&quot;) &lt; 1 won&#39;t do anything you can&#39;t achieve with the next Instr"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 2, "creation_date": 1520432582, "post_id": 49153726, "comment_id": 85312797, "body": "Indent your code, then you can see that you totally mixed your if- and for-statements"}, {"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520436787, "post_id": 49153726, "comment_id": 85315928, "body": "Its ok now thanks everyone:)"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1520438216, "post_id": 49153726, "comment_id": 85316959, "body": "<code>If inStr(output, &quot;;&quot; &amp; Trim(str(r)) &amp; &quot;;&quot;) &lt; 1 Then</code>  :P"}], "owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2265, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1578811433, "creation_date": 1520431144, "last_edit_date": 1578811433, "question_id": 49153726, "link": "https://stackoverflow.com/questions/49153726/compile-error-expected-list-separator-vba", "title": "Compile error: expected list separator vba", "body": "<p>I am having a compile error when running a vba macro. The error is on line:</p>\n\n<pre><code> If inStr(\";\" &amp; Trim(str(r)) &amp; \";\") &lt; 1 Then\n</code></pre>\n\n<p>variables:</p>\n\n<pre><code> Dim str() As String 'string array\n Dim r As Long '\n</code></pre>\n\n<p>Code: </p>\n\n<pre><code> For Each workcell In Intersect(ws.UsedRange, ws.Columns(4)) 'Go down the   \n cells in Column D\n If InStr(workcell.Value, \";\") &gt; 0 Then 'split\n str = Split(workcell.Value, \";\")\n For r = LBound(str) To UBound(str)\n If inStr(\";\" &amp; Trim(str(r)) &amp; \";\") &lt; 1 Then\n if instr(\";\" &amp; trim(str(r)) &amp; \";\") = 0 then\n output = output &amp; Trim(str(r)) &amp; \";\" 'Add the number and \";\" to the end of the string\n End If\n Next r\n Erase str 'Tidy up array, ready to recycle\n End If\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 108, "user_id": 9223132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09db1f97b8961d9ee4e8b9ef110ee2fa?s=128&d=identicon&r=PG&f=1", "display_name": "aberforth", "link": "https://stackoverflow.com/users/9223132/aberforth"}, "edited": false, "score": 0, "creation_date": 1520500144, "post_id": 49154635, "comment_id": 85343654, "body": "Is there anyway I can list my parameters in <code>VBA</code>? It looks like <code>MS Access</code> takes the parameter but the query comes blank. When I put my WC Date manually I got the correct result."}, {"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "reply_to_user": {"reputation": 108, "user_id": 9223132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09db1f97b8961d9ee4e8b9ef110ee2fa?s=128&d=identicon&r=PG&f=1", "display_name": "aberforth", "link": "https://stackoverflow.com/users/9223132/aberforth"}, "edited": false, "score": 0, "creation_date": 1520500317, "post_id": 49154635, "comment_id": 85343764, "body": "Not using a report. Using a <code>QueryDef</code>, you can iterate through all parameters. You might need to include brackets around the parameter name like this: <code>DoCmd.SetParameter &quot;[WC Date]&quot;, wcDate</code>. I honestly never use parameters with spaces in the name."}, {"owner": {"reputation": 108, "user_id": 9223132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09db1f97b8961d9ee4e8b9ef110ee2fa?s=128&d=identicon&r=PG&f=1", "display_name": "aberforth", "link": "https://stackoverflow.com/users/9223132/aberforth"}, "edited": false, "score": 0, "creation_date": 1520502118, "post_id": 49154635, "comment_id": 85344925, "body": "Change the parameter name to &quot;WCDate&quot; and query to reflect the change but still the query comes blank..."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 1, "last_activity_date": 1520433912, "creation_date": 1520433912, "answer_id": 49154635, "question_id": 49153698, "link": "https://stackoverflow.com/questions/49153698/passing-value-to-ms-access-parameter/49154635#49154635", "title": "Passing value to MS Access parameter", "body": "<p>Use <code>DoCmd.SetParameter</code> to set the parameter just before opening the report</p>\n\n<pre><code>Public Function SendReport()\n    Dim reportName As String, path As String\n    Dim wcDate As Date\n    reportName = \"Geofence_Analysis\"\n    wcDate = Date - Weekday(Date, vbSunday) + 1 - 7\n    path = \"C:\\users\\\" &amp; Environ(\"USERNAME\") &amp; \"\\desktop\\\" &amp; reportName &amp; \"_\" &amp; Format(wcDate, \"dd-mm-yyyy\") &amp; \".pdf\"\n    DoCmd.SetParameter \"WC Date\", wcDate\n    DoCmd.OpenReport reportName, acViewPreview, , , acWindowNormal\n    DoCmd.OutputTo acOutputReport, reportName, acFormatPDF, path\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 108, "user_id": 9223132, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09db1f97b8961d9ee4e8b9ef110ee2fa?s=128&d=identicon&r=PG&f=1", "display_name": "aberforth", "link": "https://stackoverflow.com/users/9223132/aberforth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594636968, "creation_date": 1520431077, "last_edit_date": 1594636968, "question_id": 49153698, "link": "https://stackoverflow.com/questions/49153698/passing-value-to-ms-access-parameter", "title": "Passing value to MS Access parameter", "body": "<p>I have a little issue with passing value to <code>Query Parameter</code>.</p>\n\n<p>I want to pass a value using <code>VBA</code>. This is how my query goes:</p>\n\n<pre><code>PARAMETERS [WC Date] DateTime;\nSELECT g1.Site_ID, g1.Site_Name, g1.Visits, g1.[Planned Turn], g1.[Avg Planned Turn], g1.[Actual Turn], g1.[Avg Act Turn], g1.[Arrival Variance], g1.[Departure Variance], g1.Week1, g1.Week2, g1.Week3, g1.Week4\nFROM (SELECT geo.Site_ID, geo.Site_Name, Count(geo.Site_ID) AS Visits, Sum(DateDiff(\"n\",[Planned_Arrival],[Planned_Departure])) AS [Planned Turn], Round([Planned Turn]/[Visits],2) AS [Avg Planned Turn], Sum(DateDiff(\"n\",[Actual_Arrival],[Actual_Departure])) AS [Actual Turn], Round([Actual Turn]/[Visits],2) AS [Avg Act Turn], Round(Avg(DateDiff(\"n\",[Planned_Arrival],[Actual_Arrival])),2) AS [Arrival Variance], Round(Avg(DateDiff(\"n\",[Planned_Departure],[Actual_Departure])),2) AS [Departure Variance], wk1.Week1, wk2.Week2, wk3.Week3, wk4.Week4\nFROM (((T_Geo AS geo LEFT JOIN (SELECT \n                        w1.Site_ID, w1.Site_Name, \n                        Count(w1.Site_ID) AS Visits, \n                        Sum(DateDiff(\"n\",[Actual_Arrival],[Actual_Departure])) AS [Actual Turn], \n                        Round([Actual Turn]/[Visits],2) AS Week1\n                    FROM T_Geo w1\n                    WHERE (((Int([Planned_Arrival]))&gt;=[WC Date]-28 And (Int([Planned_Arrival]))&lt;[WC Date]-21))\n                    GROUP BY w1.Site_ID, w1.Site_Name\n                    )  AS wk1 ON geo.Site_ID = wk1.Site_ID) LEFT JOIN (SELECT \n                    w2.Site_ID, w2.Site_Name, \n                    Count(w2.Site_ID) AS Visits, \n                    Sum(DateDiff(\"n\",[Actual_Arrival],[Actual_Departure])) AS [Actual Turn], \n                    Round([Actual Turn]/[Visits],2) AS Week2\n                FROM T_Geo w2\n                WHERE (((Int([Planned_Arrival]))&gt;=[WC Date]-21 And (Int([Planned_Arrival]))&lt;[WC Date]-14))\n                GROUP BY w2.Site_ID, w2.Site_Name\n                )  AS wk2 ON geo.Site_ID = wk2.Site_ID) LEFT JOIN (SELECT \n                w3.Site_ID, w3.Site_Name, \n                Count(w3.Site_ID) AS Visits, \n                Sum(DateDiff(\"n\",[Actual_Arrival],[Actual_Departure])) AS [Actual Turn], \n                Round([Actual Turn]/[Visits],2) AS Week3\n            FROM T_Geo w3\n            WHERE (((Int([Planned_Arrival]))&gt;=[WC Date]-14 And (Int([Planned_Arrival]))&lt;[WC Date]-7))\n            GROUP BY w3.Site_ID, w3.Site_Name\n            )  AS wk3 ON geo.Site_ID = wk3.Site_ID) LEFT JOIN (SELECT \n        w4.Site_ID, w4.Site_Name, \n        Count(w4.Site_ID) AS Visits, \n        Sum(DateDiff(\"n\",[Actual_Arrival],[Actual_Departure])) AS [Actual Turn], \n        Round([Actual Turn]/[Visits],2) AS Week4\n    FROM T_Geo w4\n    WHERE (((Int([Planned_Arrival]))&gt;=[WC Date]-7 And (Int([Planned_Arrival]))&lt;[WC Date]))\n    GROUP BY w4.Site_ID, w4.Site_Name\n    )  AS wk4 ON geo.Site_ID = wk4.Site_ID\nWHERE (Int([Planned_Arrival])&gt;=[WC Date] And Int([Planned_Arrival])&lt;=[WC Date]+6) AND IsNumeric(geo.Site_ID) = True\nGROUP BY geo.Site_ID, geo.Site_Name, wk1.Week1, wk2.Week2, wk3.Week3, wk4.Week4\n)  AS g1\nGROUP BY g1.Site_ID, g1.Site_Name, g1.Visits, g1.[Planned Turn], g1.[Avg Planned Turn], g1.[Actual Turn], g1.[Avg Act Turn], g1.[Arrival Variance], g1.[Departure Variance], g1.Week1, g1.Week2, g1.Week3, g1.Week4\nORDER BY g1.[Avg Act Turn] DESC;\n</code></pre>\n\n<p>I tried to use the following code:</p>\n\n<pre><code>Public Function SendReport()\n\n    Dim reportName As String, path As String\n    Dim wcDate As Date\n\n    reportName = \"Geofence_Analysis\"\n    wcDate = Date - Weekday(Date, vbSunday) + 1 - 7\n    path = \"C:\\users\\\" &amp; Environ(\"USERNAME\") &amp; \"\\desktop\\\" &amp; reportName &amp; \"_\" &amp; Format(wcDate, \"dd-mm-yyyy\") &amp; \".pdf\"\n    DoCmd.OpenReport reportName, acViewPreview, , , acWindowNormal, [WC Date] = wcDate\n    DoCmd.OutputTo acOutputReport, reportName, acFormatPDF, path\n\nEnd Function\n</code></pre>\n\n<p>But it's throwing an error as <code>[WC Date]</code> is not recognizable field in my query.</p>\n\n<p>I know I can get the same result setting up the form and having a parameter there and just reference the form field to my query but I would like to achieve that from the code...</p>\n\n<p>Any ideas?</p>\n\n<p>Thanks\nPiotr</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1520431660, "post_id": 49153451, "comment_id": 85312170, "body": "How was the file created?  <code>Input #</code> is designed to read files that were created by <code>Write #</code>.  Can you upload a sample file that demonstrates the problem?"}, {"owner": {"reputation": 1585, "user_id": 2197403, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ff4016163d27669ef08cc4d71f85bb5?s=128&d=identicon&r=PG", "display_name": "CoSpringsGuy", "link": "https://stackoverflow.com/users/2197403/cospringsguy"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1520431843, "post_id": 49153451, "comment_id": 85312301, "body": "It looks like it is going to be an issue with quotes which identify a date... here is what the line looks like. The date is field 21 then I showed 2 fields after. ,8/18/2014,1,194 I don&#39;t know how thie file was created but I doubt it was using Write #"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1520432978, "post_id": 49153451, "comment_id": 85313040, "body": "I cannot reproduce your problem with the limited information you have presented.  If I <code>Write</code> a file that includes a date field, I can <code>Input</code> the file without corruption. It may be that your file is not properly formatted, or that there is something elsewhere in your code that is causing the problem. But you have not provided any of that information."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1520433264, "post_id": 49153451, "comment_id": 85313232, "body": "Likely you will need a different tool to read that file. The date, within the file itself (eg if you open it with <code>NotePad</code>), should look like <code>#2014-08-18#</code>"}, {"owner": {"reputation": 1585, "user_id": 2197403, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ff4016163d27669ef08cc4d71f85bb5?s=128&d=identicon&r=PG", "display_name": "CoSpringsGuy", "link": "https://stackoverflow.com/users/2197403/cospringsguy"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1520433961, "post_id": 49153451, "comment_id": 85313722, "body": "@RonRosenfeld Thank you very much for your help! What I pasted above was how the date look in notepad and it does not contain #&#39;s. I believe you are right and the answer to my question is a formatting issue and I will need to read the data using something other than &quot;input&quot;. Line Input works well I just need to reconsider my original methodology. Thanks for your help!"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1520434194, "post_id": 49153451, "comment_id": 85313883, "body": "If your data contains a lot of commas within text fields, and the fields are not qualified by text identifiers (eg <code>&quot;</code>), you will need to do considerable clean-up to be able to process the data.  It can be almost impossible to determine if a comma is within a field, vs being used as a field separator, without those text qualifiers, depending on the actual data."}], "owner": {"reputation": 1585, "user_id": 2197403, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ff4016163d27669ef08cc4d71f85bb5?s=128&d=identicon&r=PG", "display_name": "CoSpringsGuy", "link": "https://stackoverflow.com/users/2197403/cospringsguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 24, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520430686, "creation_date": 1520430347, "last_edit_date": 1531161705, "question_id": 49153451, "link": "https://stackoverflow.com/questions/49153451/how-to-read-a-date-using-input", "title": "how to read a date using input #", "body": "<p>I am reading a file using input # format.</p>\n\n<pre><code>For read = 0 To 42\n     Input #1, iData4\n     If read = 21 Then Debug.Print iData4\nNext read\n</code></pre>\n\n<p>the 21st field in the line is a date in format mm/dd/yyyy but it appears this method only reads mm.</p>\n\n<p>So for example if the value in the original file is 10/12/2017 it reads in 10.</p>\n\n<p>Almost like it is reading / as a delimiter. \nAny thoughts on this?\nChanging 21 to 22 shows me that it reads the next column correctly. This only happens on columns with mm/dd/yyyy dates. I have another text field in the file that has a \"/\" that does not seem to affect the output. </p>\n\n<p>I originally used \"line input\" instead of \"input\" for this project but I had data that contained a lot of commas which was throwing everything off when trying to split the line into variables.</p>\n"}, {"tags": ["vba", "excel", "vlookup"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1520429922, "post_id": 49153071, "comment_id": 85310981, "body": "Is the missing ByVal Target As Range in Private Sub Worksheet_Change(ByVal Target As Range) a copy &quot;mistake&quot;? Also disable events in order to prevent the code to run multiple times."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1520430341, "post_id": 49153071, "comment_id": 85311250, "body": "And why did you declare Target in the Sub itself?"}, {"owner": {"reputation": 331, "user_id": 8172122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1aff57ccf9ac82110ad73090fbe53a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Srpic", "link": "https://stackoverflow.com/users/8172122/srpic"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1520430488, "post_id": 49153071, "comment_id": 85311355, "body": "I just didnt know, that I should declare it inside of brackets"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1520430628, "post_id": 49153071, "comment_id": 85311459, "body": "If you use it like that it cannot work unless the sub is not in the sheet module. You will get a compiler error."}, {"owner": {"reputation": 331, "user_id": 8172122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1aff57ccf9ac82110ad73090fbe53a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Srpic", "link": "https://stackoverflow.com/users/8172122/srpic"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1520431003, "post_id": 49153071, "comment_id": 85311690, "body": "I have the code in Microsoft Excel Objects - Sheet1 and it works, until I want to remove two or more cells together. If I want to remove cell by cell, then it works without any issues."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1520431318, "post_id": 49153071, "comment_id": 85311920, "body": "No as said if the code is the same as you posted it cannot work. You will get a compiler error!"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520429872, "post_id": 49153150, "comment_id": 85310953, "body": "@Jeeped That&#39;ll learn me for rushing. Have I got the enable events right?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1520430035, "post_id": 49153150, "comment_id": 85311060, "body": "IMO not quite because in case Target.value is not of type long the code will run into an error and events will not be enabled again."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1520430473, "post_id": 49153150, "comment_id": 85311349, "body": "@Storax i feel like i have been heavy handed with the enableevents"}, {"owner": {"reputation": 331, "user_id": 8172122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1aff57ccf9ac82110ad73090fbe53a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Srpic", "link": "https://stackoverflow.com/users/8172122/srpic"}, "edited": false, "score": 0, "creation_date": 1520430533, "post_id": 49153150, "comment_id": 85311385, "body": "Thanks guys! Unfortunately, it is still the same :("}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 1, "creation_date": 1520430797, "post_id": 49153150, "comment_id": 85311569, "body": "But it is working if you select a value from the list? Your original code cannot have worked at all!"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520430841, "post_id": 49153150, "comment_id": 85311593, "body": "why data type is selectedNa btw?"}, {"owner": {"reputation": 331, "user_id": 8172122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1aff57ccf9ac82110ad73090fbe53a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Srpic", "link": "https://stackoverflow.com/users/8172122/srpic"}, "edited": false, "score": 0, "creation_date": 1520431107, "post_id": 49153150, "comment_id": 85311755, "body": "It is, but my code works as well. There are no differents at the end of the day . I mean, that the vlookup works for both, but removing does not."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1520432159, "last_edit_date": 1520432159, "creation_date": 1520429346, "answer_id": 49153150, "question_id": 49153071, "link": "https://stackoverflow.com/questions/49153071/when-i-remove-data-code-will-stuck/49153150#49153150", "title": "When I remove data, code will stuck", "body": "<p>Try the following:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change(ByVal Target As Range)\n\n Dim selectedNa As Long, selectedNum As Variant\n\n If Target.Column = 10 And Not IsEmpty(Target) Then  'selectedNa &lt;&gt; vbNullString Then '\n\n    Application.EnableEvents = False\n\n    On Error GoTo errhand\n\n    selectedNa = Target.Value\n\n    selectedNum = Application.VLookup(selectedNa, ActiveSheet.Range(\"dropdown\"), 2, False)\n\n     If Not IsError(selectedNum) Then\n\n         Target.Value = selectedNum\n\n     End If\n\n     Application.EnableEvents = True\n\n End If\n\n Exit Sub\n\nerrhand:\nIf Err.Number &lt;&gt; 0 Then\n    Application.EnableEvents = True\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1520431893, "post_id": 49153695, "comment_id": 85312332, "body": "selectedNum  has to a variant if you intend to catch no-match errors with iserror."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1520432024, "post_id": 49153695, "comment_id": 85312414, "body": "I just took the TO&#39;s code, removed the unneccessary Exit Subs and added  simple arror handling in order to get at the original problem. But the TO keeps telling that his code is working fine although it cannot even compile :-("}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1520432172, "post_id": 49153695, "comment_id": 85312519, "body": "Yeah, we either aren&#39;t getting all the code or something else is going on. <code>selectedNa = target.Value</code> doesn&#39;t seem to work as an integer looking at the op&#39;s image either."}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 0, "last_activity_date": 1520431075, "creation_date": 1520431075, "answer_id": 49153695, "question_id": 49153071, "link": "https://stackoverflow.com/questions/49153071/when-i-remove-data-code-will-stuck/49153695#49153695", "title": "When I remove data, code will stuck", "body": "<p>Change your posted code to</p>\n\n<pre><code>Option Explicit\nPrivate Sub Worksheet_Change(ByVal target As Range)\n\nDim selectedNa As Integer, selectedNum As Integer\n\n    On Error GoTo EH\n\n    Application.EnableEvents = False\n\n    selectedNa = target.Value\n\n    If target.Column = 10 Then\n        selectedNum = Application.VLookup(selectedNa, ActiveSheet.Range(\"dropdown\"), 2, False)\n        If Not IsError(selectedNum) Then\n            target.Value = selectedNum\n        End If\n    End If\n\nEH:\n    Application.EnableEvents = True\n    Debug.Print Err.Number, Err.Description\nEnd Sub\n</code></pre>\n\n<p>The code HAS TO be put into the sheet module. \nHave a look at the immediate window after you have changed or deleted a value in your sheet.</p>\n"}, {"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1520436015, "creation_date": 1520436015, "answer_id": 49155409, "question_id": 49153071, "link": "https://stackoverflow.com/questions/49153071/when-i-remove-data-code-will-stuck/49155409#49155409", "title": "When I remove data, code will stuck", "body": "<p>It <em>looks</em> like this is what you want, based on the information provided:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim CheckCells As Range\n    Dim ChangedCell As Range\n\n    Set CheckCells = Intersect(Me.Columns(10), Target)\n\n    Application.EnableEvents = False\n\n    If Not CheckCells Is Nothing Then\n        For Each ChangedCell In CheckCells.Cells\n            If Len(ChangedCell.Value) &gt; 0 And WorksheetFunction.CountIf(Me.Range(\"dropdown\"), ChangedCell.Value) &gt; 0 Then\n                ChangedCell.Value = WorksheetFunction.VLookup(ChangedCell.Value, Me.Range(\"dropdown\").Resize(, 2), 2, False)\n            End If\n        Next ChangedCell\n    End If\n\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 331, "user_id": 8172122, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1aff57ccf9ac82110ad73090fbe53a0f?s=128&d=identicon&r=PG&f=1", "display_name": "Srpic", "link": "https://stackoverflow.com/users/8172122/srpic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1520436015, "creation_date": 1520429110, "last_edit_date": 1520429582, "question_id": 49153071, "link": "https://stackoverflow.com/questions/49153071/when-i-remove-data-code-will-stuck", "title": "When I remove data, code will stuck", "body": "<p>I have excel sheet with dropdown list and when I choose anything from the list\n<a href=\"https://i.stack.imgur.com/tEjzL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tEjzL.png\" alt=\"enter image description here\"></a></p>\n\n<p>macro will vlookup for requested value. But when I want to remove values from those cells, that I select them and press delete, it will show me \"#N/A\" and the excel is frozen, I cant do anything. Could you advise me, how can I avoid it, please?\n<a href=\"https://i.stack.imgur.com/Jws4Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Jws4Z.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nPrivate Sub Worksheet_Change()\n    Dim Target As Range\n    Dim selectedNa As Integer, selectedNum As Integer\n\n    selectedNa = Target.Value\n    If Target.Column = 10 Then\n        selectedNum = Application.VLookup(selectedNa, ActiveSheet.Range(\"dropdown\"), 2, False)\n        If Not IsError(selectedNum) Then\n            Target.Value = selectedNum\n        Else: Exit Sub\n        End If\n    Else: Exit Sub\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "sap-gui"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 9229776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f1327c8451f51ae1f916ca03468c00?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/9229776/madalina"}, "edited": false, "score": 0, "creation_date": 1521017491, "post_id": 49250907, "comment_id": 85549052, "body": "Unfortunately, it does not work either manually. But IT WORKS if I save the file on &quot;C:\\Users\\UserName&quot; and then cut it to shared path &quot;S\\BC...&quot;. So I&#39;ve implemented code that saves the file in a path and then copy it to another path and then I deleted it from the first path (such that user never knows that I copy the file in other destination than desired destination). Thank you and best regards!"}, {"owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "reply_to_user": {"reputation": 51, "user_id": 9229776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f1327c8451f51ae1f916ca03468c00?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/9229776/madalina"}, "edited": false, "score": 0, "creation_date": 1521020024, "post_id": 49250907, "comment_id": 85550613, "body": "Many roads lead to Rome. ;-)"}, {"owner": {"reputation": 8896, "user_id": 9150270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e89ef7ec2f93f949e76081bd9d1749?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra Rossi", "link": "https://stackoverflow.com/users/9150270/sandra-rossi"}, "reply_to_user": {"reputation": 51, "user_id": 9229776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f1327c8451f51ae1f916ca03468c00?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/9229776/madalina"}, "edited": false, "score": 0, "creation_date": 1610185510, "post_id": 49250907, "comment_id": 116056142, "body": "@Madalina As what you proposed is a solution, please post it as a separate answer. Thank you. (and I will remove the copy I did for helping future visitors)"}], "tags": [], "owner": {"reputation": 1232, "user_id": 4523059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/746b7a7ef7efcf8482b6fcab8595714d?s=128&d=identicon&r=PG&f=1", "display_name": "ScriptMan", "link": "https://stackoverflow.com/users/4523059/scriptman"}, "is_accepted": false, "score": 1, "last_activity_date": 1520931321, "last_edit_date": 1520931321, "creation_date": 1520927677, "answer_id": 49250907, "question_id": 49153053, "link": "https://stackoverflow.com/questions/49153053/print-button-didnt-save-the-pdf-file-at-a-shared-path-and-no-error-logged/49250907#49250907", "title": "Print button didn&#39;t save the PDF file at a shared path, and no error logged", "body": "<p>A VBA macro only does what you are allowed to do manually. Can you manually save the file in the shared path without the macro? </p>\n\n<p>Is the common path really \\S\\BC...\\ or \\ \\S\\BC...\\ ?</p>\n\n<p>Regards,\nScriptMan</p>\n"}, {"tags": [], "owner": {"reputation": 8896, "user_id": 9150270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e89ef7ec2f93f949e76081bd9d1749?s=128&d=identicon&r=PG&f=1", "display_name": "Sandra Rossi", "link": "https://stackoverflow.com/users/9150270/sandra-rossi"}, "is_accepted": false, "score": 0, "last_activity_date": 1610185422, "creation_date": 1610185422, "answer_id": 65641217, "question_id": 49153053, "link": "https://stackoverflow.com/questions/49153053/print-button-didnt-save-the-pdf-file-at-a-shared-path-and-no-error-logged/65641217#65641217", "title": "Print button didn&#39;t save the PDF file at a shared path, and no error logged", "body": "<p>Solution proposed by the OP in this <a href=\"https://stackoverflow.com/questions/49153053/print-button-didnt-save-the-pdf-file-at-a-shared-path-and-no-error-logged#comment85549052_49250907\">comment</a>:</p>\n<blockquote>\n<p>IT WORKS if I save the file on &quot;C:\\Users\\UserName&quot; and then cut it to shared path &quot;S\\BC...&quot;. So I've implemented code that saves the file in a path and then copy it to another path and then I deleted it from the first path (such that user never knows that I copy the file in other destination than desired destination).</p>\n</blockquote>\n"}], "owner": {"reputation": 51, "user_id": 9229776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/66f1327c8451f51ae1f916ca03468c00?s=128&d=identicon&r=PG&f=1", "display_name": "Madalina", "link": "https://stackoverflow.com/users/9229776/madalina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 531, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1610185422, "creation_date": 1520429053, "last_edit_date": 1610185333, "question_id": 49153053, "link": "https://stackoverflow.com/questions/49153053/print-button-didnt-save-the-pdf-file-at-a-shared-path-and-no-error-logged", "title": "Print button didn&#39;t save the PDF file at a shared path, and no error logged", "body": "<p>I have an Excel macro that uses SAP for printing data in pdf format.\nSteps:</p>\n\n<ul>\n<li>it access the SAP transaction which provides a table with the necessary information </li>\n<li>it press Print button (from the Menu Bar of SAP)</li>\n<li>then Print window appears (from here it is selected Microsoft Print To PDF option and then it is pressed OK button)</li>\n<li>Save As window appears (complete the path and filename: \\S\\BC....\\outputName)</li>\n<li><p>then Save button it is pressed</p></li>\n<li><p>then no error happens</p></li>\n</ul>\n\n<p>But if I access the path folder \"\\S\\BC....\", nothing happen, there is no file saved. BUT, if we look in \"Date modified\" property of the folder, it is modified in accordance with the last saving time. </p>\n\n<p>Also, I mention that if I'm trying to write the pdf file on local folders, not network shared folders (example: a desktop folder: C:\\Users\\mariah\\Test), macro works.</p>\n\n<p>Also, I mention that user can Read&amp;Write at the shared path \\S\\BC....\\</p>\n\n<p>Please help me to find the cause of this issue.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "edited": false, "score": 0, "creation_date": 1520430577, "post_id": 49153007, "comment_id": 85311414, "body": "What happens after you run it for the first time? Does it start refreshing the query? Can you see &quot;Running background query&quot; in your statusbar? If yes, then maybe problem is in the fact that it takes some time to perform the refresh and while excel is busy getting the data you macro continues to run so it doesnt fill down anything, because at that time it still has the same number of lines as before."}, {"owner": {"reputation": 11, "user_id": 5922766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sH4CK.jpg?s=128&g=1", "display_name": "Duthreal", "link": "https://stackoverflow.com/users/5922766/duthreal"}, "reply_to_user": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "edited": false, "score": 0, "creation_date": 1520624283, "post_id": 49153007, "comment_id": 85407035, "body": "It refreshes the query and it fills down, but it doesnt refresh the pivot table unless I run the macro twice, I tried an application wait command and it just waited and still did not update the pivot table until the second time running the macro."}, {"owner": {"reputation": 1210, "user_id": 3858621, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4tbid.jpg?s=128&g=1", "display_name": "Pavel_V", "link": "https://stackoverflow.com/users/3858621/pavel-v"}, "edited": false, "score": 0, "creation_date": 1520929702, "post_id": 49153007, "comment_id": 85506098, "body": "maybe check the accepted answer here <a href=\"https://stackoverflow.com/questions/16222091/refresh-both-the-external-data-source-and-pivot-tables-together-within-a-time-sc\" title=\"refresh both the external data source and pivot tables together within a time sc\">stackoverflow.com/questions/16222091/&hellip;</a>"}], "owner": {"reputation": 11, "user_id": 5922766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sH4CK.jpg?s=128&g=1", "display_name": "Duthreal", "link": "https://stackoverflow.com/users/5922766/duthreal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 630, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520428901, "creation_date": 1520428901, "last_edit_date": 1531161705, "question_id": 49153007, "link": "https://stackoverflow.com/questions/49153007/having-to-run-macro-twice-to-get-results", "title": "Having to Run Macro Twice to Get Results", "body": "<p>I have my report set to refresh a Query, then filldown a column that already exists with a formula that is already at the beginning of the column, then refresh the pivot table that references the query table. </p>\n\n<p>For some reason, I have to run the Macro Twice (Which I have in the form of a button) and I really don't want to run it twice.</p>\n\n<pre><code>Sub Runthrough()\n'\n' Runthrough Macro\n'\n\n'\n    ActiveWorkbook.Connections(\"Query - Purchasereceipt\").Refresh\n    Range(\"Purchasereceipt[[Grade]]\").FillDown\n    Sheets(\"Pivot Table\").PivotTables(\"PivotTable1\").PivotCache.Refresh\n\nEnd Sub\n</code></pre>\n\n<p>Thoughts?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 9456695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ePWGV.jpg?s=128&g=1", "display_name": "TMC", "link": "https://stackoverflow.com/users/9456695/tmc"}, "is_accepted": true, "score": 0, "last_activity_date": 1520511537, "creation_date": 1520511537, "answer_id": 49172941, "question_id": 49152942, "link": "https://stackoverflow.com/questions/49152942/if-else-statement-with-three-conditions-using-application-match-to-find-row-numb/49172941#49172941", "title": "If else statement with three conditions using Application.Match to find row number", "body": "<p>Okay I figured it out by myself. Actually it was pretty simple.\nSince the code was working with one condition very well, I just concatenated the conditions to one. I concatenated the string in columns <code>C</code>, <code>B</code> and <code>A</code> in a new column <code>E</code> (--> C &amp; B &amp; A). </p>\n\n<pre><code>Range(\"E\" &amp; LastRow).FormulaR1C1 = fso.GetBaseName(Left(oFolder, InStrRev(oFolder, \"\\\"))) _\n                                    &amp; fso.GetBaseName(oFolder) _\n                                    &amp; fso.GetBaseName(FileName)\n</code></pre>\n\n<p>I used this column to look for my concatenated criteria like this:</p>\n\n<pre><code> If Not IsError(Application.Match(criteria, Columns(\"E:E\"), 0)) Then\n\n    ' Do nothing because file was already imported\n\n Else\n\n    'import code\n</code></pre>\n\n<p>That was it.</p>\n\n<p>Best TMC</p>\n"}], "owner": {"reputation": 11, "user_id": 9456695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ePWGV.jpg?s=128&g=1", "display_name": "TMC", "link": "https://stackoverflow.com/users/9456695/tmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 49172941, "answer_count": 1, "score": 0, "last_activity_date": 1520511537, "creation_date": 1520428673, "last_edit_date": 1531164843, "question_id": 49152942, "link": "https://stackoverflow.com/questions/49152942/if-else-statement-with-three-conditions-using-application-match-to-find-row-numb", "title": "If else statement with three conditions using Application.Match to find row number", "body": "<p>I'm writing a macro which imports a lot of .csv files from a folder with many subfolders. This is working so far. \nNow I want to implement that if a file was already imported it should not be imported a second time. There I get into an issue.</p>\n\n<p>I really tried to find a solution with the search function, but I only could find \"If else statement with two conditions\" but it didn't get my code working.</p>\n\n<p>I need to write an if else statement with three conditions. </p>\n\n<p>Conditions: Only if the file name (column C) the folder name (column B) and the parent folder name (Column A) are an exact match, the file is NOT to be imported.</p>\n\n<p>For one Condition it is working fine.</p>\n\n<p>This is my code snippet for finding the file name in column C:</p>\n\n<pre><code> ' Check if file was already imported should return Row Number --&gt; SearchColumn\n\nIf Not IsError(Application.Match(fso.GetBaseName(oFile.name), Columns(\"C:C\"), 0)) Then\n   SearchColumn = Application.Match(fso.GetBaseName(oFile.name), Columns(\"C:C\"), 0)\nEnd If\n</code></pre>\n\n<p>The variable <code>SearchColumn</code> tells my where it found the file name, if it is in the list. I want to use this variable to check if in the same row in column B and column A are matching to the names of the file.</p>\n\n<p>I thought it would be something like this:</p>\n\n<pre><code>' Check if file was already imported should return Row Number --&gt; SearchColumn\n\nIf Not IsError(Application.Match(fso.GetBaseName(oFile.name), Columns(\"C:C\"), 0)) Then\n   SearchColumn = Application.Match(fso.GetBaseName(oFile.name), Columns(\"C:C\"), 0)\nEnd If\n\nIf Not IsError(Application.Match(fso.GetBaseName(oFile.name), Columns(\"C:C\"), 0)) _\n   And Not IsError(Application.Match(fso.GetBaseName(oFolder), \"B1:B\" &amp; SearchColumn, 0)) _\n   And Not IsError(Application.Match(fso.GetBaseName(folderName), \"A1:A\" &amp; SearchColumn, 0)) Then\n\n' Do nothing because file was already imported\n\nElse\n\n' import file / copy content\n\nSet wbkCS = Workbooks.Open(oFile.path)\n  'some more macro code\n</code></pre>\n\n<p>But somehow it ignores both of the other conditions. Where am I mistaken?</p>\n\n<p>Best TMC</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520429032, "post_id": 49152869, "comment_id": 85310375, "body": "What you describe would be (in one line) <code>Worksheets(&quot;source&quot;).Range(&quot;B5:L16&quot;).Copy Worksheets(&quot;destination&quot;).Range(&quot;C3:M14&quot;)</code> So there are several possibilities (a) that is what you were looking for (b) your description of your issue is too bad (c) It&#39;s very unclear what you are trying to do with that code. Please <a href=\"https://stackoverflow.com/posts/49152869/edit\">edit</a> and improve your question, ask a clear question, describe what actually happens and what you expected instead. Much more information is needed."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7444699"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520429508, "post_id": 49152869, "comment_id": 85310710, "body": "I have some data in Sheet 1 and I have to select some particular amount as the data present in cell range from <code>B5:L16</code> and I have to paste that data in a different worksheet in <code>C3:M14</code>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520429581, "post_id": 49152869, "comment_id": 85310755, "body": "You are just repeating yourself. The code I posted in my first comment does exactly that. You just need to change the worksheet names."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7444699"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520430337, "post_id": 49152869, "comment_id": 85311246, "body": "Getting error9 subscription out of range"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520430416, "post_id": 49152869, "comment_id": 85311314, "body": "With your variables <code>wksImportedWorksheet.Range(&quot;B5:L16&quot;).Copy: wksMasterWorksheet.Range(&quot;C3:M14&quot;).PasteSpecial Paste:=xlPasteValues</code> is all you need to copy"}], "owner": {"user_type": "does_not_exist", "display_name": "user7444699"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520429970, "creation_date": 1520428473, "last_edit_date": 1531161705, "question_id": 49152869, "link": "https://stackoverflow.com/questions/49152869/i-have-to-copy-some-particular-data-in-excel-using-macro", "title": "I have to copy some particular data in excel using macro", "body": "<p>I have to copy data in excel from <code>B5:L16</code>  and paste it in another worksheet on <code>C3:M14</code>. I have the below code which copies the entire sheet. I am not able to identify the correct cell number.</p>\n\n<pre><code>Set wkbImportedWorkbook = ActiveWorkbook\nSet wksImportedWorksheet = wkbImportedWorkbook.Sheets(\"Summary\")\n\n\nSet rngImportCopyRange = Range(wksImportedWorksheet.Cells(1, 1), Cells(5000, 1)).EntireRow\nrngImportCopyRange.Copy wksMasterWorksheet.Cells(1, 1)\n\n\nrngImportCopyRange.Copy\nwksMasterWorksheet.Cells(1, 1).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\n\nwkbMasterWorkbook.Activate\nApplication.DisplayAlerts = False\nwkbImportedWorkbook.Close SaveChanges:=False\nApplication.DisplayAlerts = True\n\nwksMasterWorksheet.Activate\nwksMasterWorksheet.Cells(1, 1).Select\n\nApplication.ScreenUpdating = True\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-formula", "numerical-methods", "numerical-computing"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1520428064, "post_id": 49152674, "comment_id": 85309731, "body": "Have you tried data type <code>decimal</code> instead of <code>double</code>?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1520428110, "post_id": 49152674, "comment_id": 85309755, "body": "@FunThomas, I think <code>Decimal</code> is a VB.Net data type, not VBA"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1520428155, "post_id": 49152674, "comment_id": 85309792, "body": "@Job, I presume you mean <b>data</b> rather than <i>date</i> from multiple trials?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520428460, "post_id": 49152674, "comment_id": 85310007, "body": "And when you say fail what do you mean? Can you describe and give example with outputs that don&#39;t work and ones that do?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520429224, "post_id": 49152674, "comment_id": 85310507, "body": "more examples would help identify if this is a truncation/precision problem"}, {"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1520430025, "post_id": 49152674, "comment_id": 85311054, "body": "@CallumDA: You can use <code>decimal</code> by declaring a var as <code>variant</code> and convert a number using <code>CDec</code> - but I have to admit I never used this."}, {"owner": {"reputation": 33, "user_id": 4677708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffdbe43c4c590c570cf5cd942d87d940?s=128&d=identicon&r=PG&f=1", "display_name": "Job", "link": "https://stackoverflow.com/users/4677708/job"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520431120, "post_id": 49152674, "comment_id": 85311765, "body": "@Qharr I have added an example where the code doesn&#39;t work"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1520436602, "post_id": 49152674, "comment_id": 85315790, "body": "Not quite sure what this question is asking...  Are you just trying to find <i>n</i> for given/known values of <i>A</i>, <i>B</i> and <i>C</i> such that <code>A = B^n - C^n</code>?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1520440530, "post_id": 49152674, "comment_id": 85318579, "body": "Checking the code, it seems that that is exactly what you are doing, so 2 questions:  <b>1)</b> Why not use a Binary Search for approximation?  <b>2)</b>  Your example of <i>A</i> =23, <i>B</i> =100, <i>C</i> =333 can&#39;t work, since <i>B</i> &lt; <i>C</i> and <i>A</i> &gt;0"}, {"owner": {"reputation": 33, "user_id": 4677708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffdbe43c4c590c570cf5cd942d87d940?s=128&d=identicon&r=PG&f=1", "display_name": "Job", "link": "https://stackoverflow.com/users/4677708/job"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1520463192, "post_id": 49152674, "comment_id": 85330821, "body": "Sorry, I am trying to approximate n given values A, B and C. And i realise now my mistake @chronocidal . How would i use a Binary search?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1520464705, "post_id": 49152674, "comment_id": 85331394, "body": "<a href=\"https://en.wikipedia.org/wiki/Bisection_method\" rel=\"nofollow noreferrer\">Details are here</a>, but as a summary:  Set your upper and lower bounds as 0.5 and 1.0, then try 0.75 first.  If the number is larger than A, next try 0.625 - if it was less than A, try 0.875 - and keep splitting the difference to close the gap."}, {"owner": {"reputation": 131, "user_id": 11031050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b13c364b267b8da870b9b0ebfd670761?s=128&d=identicon&r=PG&f=1", "display_name": "MTwem", "link": "https://stackoverflow.com/users/11031050/mtwem"}, "edited": false, "score": 0, "creation_date": 1614722577, "post_id": 49152674, "comment_id": 117471316, "body": "If you have the values of A,B &amp; C, you can rearrange the equation to yield n without any macros. <code>A=B^n - C^n</code> becomes <code>n root A = B-C</code>. Evaluate B-C to get the number (I&#39;ll call it D). Finally <code>log of A with base D gives n</code>"}], "owner": {"reputation": 33, "user_id": 4677708, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffdbe43c4c590c570cf5cd942d87d940?s=128&d=identicon&r=PG&f=1", "display_name": "Job", "link": "https://stackoverflow.com/users/4677708/job"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1520463443, "creation_date": 1520427814, "last_edit_date": 1520463443, "question_id": 49152674, "link": "https://stackoverflow.com/questions/49152674/a-bn-cn-excel-vba-numerical-methods", "title": "A = B^n - C^n (Excel VBA: Numerical Methods)", "body": "<p>I have date from multiple trials for <strong>A</strong>, <strong>B</strong> and <strong>C</strong>. I have been given the equation: </p>\n\n<p><strong>A = B^{n} - C^{n}</strong></p>\n\n<p><strong>A,B,C => 0</strong></p>\n\n<p><strong>B>C</strong></p>\n\n<p>From the Values of <strong>A</strong>, <strong>B</strong> and <strong>C</strong> I wish to calculate <strong>n</strong></p>\n\n<p>I have attempted to create a VBA function that calculates n using numerical methods. </p>\n\n<p>Note: I am told that <strong>0.5 &lt;= n &lt;= 1</strong></p>\n\n<pre><code>Option Explicit\n\nPrivate Const mdblEPSILON As Double = 0.00000001\n\n\n\nPublic Function IsEqual(ByVal dblA As Double, ByVal dblB As Double) As Boolean\n    IsEqual = Abs(dblA - dblB) &lt; mdblEPSILON\nEnd Function\n\nPublic Function IsGreaterThan(ByVal dblA As Double, ByVal dblB As Double) As Boolean\n    IsGreaterThan = (dblA &gt; dblB) And IsEqual(dblA, dblB) = False\nEnd Function\n\nFunction nfinder(dblConstant As Double, dblPR As Double, dblPP As Double, dblDP As Double)\n\nDim i As Double\nDim j As Double\nDim k As Double\nDim n(1 To 11) As Double\nDim ratiodifference(1 To 11) As Double\n\n\nDim dblA As Double\nDim dblB As Double\nDim Temporary As Double\n\nDim ValueLB As Double\nDim ValueUB As Double\n\n    'This part calculates the ratiodifference for n= 0.5,0.6,...,1\n    'The ratio is:\n    ' 1. A / (B^{n} - C^{n}) is calculated for each n\n    ' 2. This difference between this value and 1 is calculated\n    ' 3. I am assuming if A = B^{truevalue.n} - C^{truevaluen} then the ratiodifference will = 0 as the ratio should = 1\n\nFor i = 1 To 6\n    n(i) = 0.1 * i + 0.4\n    ratiodifference(i) = Abs(1 - dblConstant / (dblPR ^ n(i) - dblPP ^ n(i)))\nNext i\n\n'I could have used redim here but i was lazy\nFor i = 7 To 11\n    n(i) = 100\n    ratiodifference(i) = 999999999999999#\nNext i\n\n' This part orders using bubble sort in order of ratiodifference\nFor j = 1 To 6\n    For i = 1 To 5\n\n        dblA = ratiodifference(i)\n        dblB = ratiodifference(i + 1)\n\n        If IsGreaterThan(dblA, dblB) = True Then\n\n            Temporary = ratiodifference(i)\n            ratiodifference(i) = ratiodifference(i + 1)\n            ratiodifference(i + 1) = Temporary\n\n            Temporary = n(i)\n            n(i) = n(i + 1)\n            n(i + 1) = Temporary\n\n        End If\n\n    Next i\nNext j\n\n'This part selects the smaller n of the 2 smallest ratio difference and sets this as the LowerBound\nIf IsGreaterThan(n(1), n(2)) Then\n    Temporary = ratiodifference(1)\n    ratiodifference(1) = ratiodifference(2)\n    ratiodifference(2) = Temporary\n\n    Temporary = n(1)\n    n(1) = n(2)\n    n(2) = Temporary\nEnd If\nValueLB = n(1)\n\n\n\n'Using loops the above process is repeated up to a desired amount of decimal places\nFor k = 2 To dblDP + 1\n\n'Starting at the lower bound go through the decimal incriments\n    For i = 1 To 10\n        n(i) = ValueLB + (i - 1) * 0.1 ^ k\n        ratiodifference(i) = Abs(1 - dblConstant / (dblPR ^ n(i) - dblPP ^ n(i)))\n    Next i\n\n    For j = 1 To 11\n        For i = 1 To 10\n            dblA = ratiodifference(i)\n            dblB = ratiodifference(i + 1)\n\n            If IsGreaterThan(dblA, dblB) = True Then\n                Temporary = ratiodifference(i)\n                ratiodifference(i) = ratiodifference(i + 1)\n                ratiodifference(i + 1) = Temporary\n\n                Temporary = n(i)\n                n(i) = n(i + 1)\n                n(i + 1) = Temporary\n            End If\n        Next i\n    Next j\n\n    If IsGreaterThan(n(1), n(2)) Then\n        Temporary = ratiodifference(1)\n        ratiodifference(1) = ratiodifference(2)\n        ratiodifference(2) = Temporary\n\n        Temporary = n(1)\n        n(1) = n(2)\n        n(2) = Temporary\n    End If\n    ValueLB = n(1)\nNext k\n\n\nnfinder = Round(ValueLB, dblDP)\n\n\nEnd Function\n</code></pre>\n\n<p>Are there any scenarios in which this code wouldn't work or are there any changes that are needed.</p>\n\n<p>Any improvements or other solutions would be appriciated!\nThanks,\nJ</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1367, "user_id": 3343071, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4a7e01c427c8d9daa8d944e9cd1d1410?s=128&d=identicon&r=PG&f=1", "display_name": "MiguelH", "link": "https://stackoverflow.com/users/3343071/miguelh"}, "edited": false, "score": 0, "creation_date": 1520427373, "post_id": 49152441, "comment_id": 85309205, "body": "Possibly unrelated, but <code>Next c</code>?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520427376, "post_id": 49152441, "comment_id": 85309208, "body": "and an isempty test"}], "answers": [{"comments": [{"owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "edited": false, "score": 0, "creation_date": 1520428110, "post_id": 49152618, "comment_id": 85309753, "body": "Awesome. Yes, this is what I looked for. Many thanks!"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1520428181, "last_edit_date": 1520428181, "creation_date": 1520427648, "answer_id": 49152618, "question_id": 49152441, "link": "https://stackoverflow.com/questions/49152441/conditional-formatting-cell-error/49152618#49152618", "title": "Conditional formatting cell error", "body": "<p>Like?</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nSet wb = Excel.ActiveWorkbook\nSet aRec = wb.Worksheets(1)\nSet bRec = wb.Worksheets(2)\n\nApplication.ScreenUpdating = False\n\nFor a = 2 To aRec.Cells(Rows.Count, \"A\").End(xlUp).Row\n    Match = Application.Match(aRec.Cells(a, 1).Value, bRec.Columns(2), 0)\n\n    If IsError(Match) And Not IsEmpty(aRec.Cells(a, 1)) Then\n        aRec.Cells(a, 1).Interior.Color = RGB(255, 0, 0)\n\n    Else\n        aRec.Cells(a, 1).Interior.Color = RGB(255, 255, 255)\n\n    End If\n\nNext a\n\nEnd Sub\n</code></pre>\n\n<p>With correct loop variable, Option Explicit, type declarations and switching screenupdating back on</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n\nDim wb As Workbook\nDim aRec As Worksheet\nDim bRec As Worksheet\nDim a As Long\nDim Match As Variant\n\nSet wb = ActiveWorkbook\nSet aRec = wb.Worksheets(1)\nSet bRec = wb.Worksheets(2)\n\nApplication.ScreenUpdating = False\n\nFor a = 2 To aRec.Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    Match = Application.Match(aRec.Cells(a, 1).Value, bRec.Columns(2), 0)\n\n    If IsError(Match) And Not IsEmpty(aRec.Cells(a, 1)) Then\n        aRec.Cells(a, 1).Interior.Color = RGB(255, 0, 0)\n    Else\n       aRec.Cells(a, 1).Interior.Color = RGB(255, 255, 255)\n    End If\n\nNext a\n\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 9167485, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a3e9b292e1271d971bc2542a5642984d?s=128&d=identicon&r=PG&f=1", "display_name": "alex2002", "link": "https://stackoverflow.com/users/9167485/alex2002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 49152618, "answer_count": 1, "score": 0, "last_activity_date": 1520428181, "creation_date": 1520427126, "question_id": 49152441, "link": "https://stackoverflow.com/questions/49152441/conditional-formatting-cell-error", "title": "Conditional formatting cell error", "body": "<p>The code I have below is checking two worksheets in order to see if the values inserted in the specific column are similar. For example, it looks to see if the values inserted in <em>column A from sheet1</em> are the same as the values inserted in <em>sheet2 column B</em>. If yes, then the cells in <em>sheet1 column A</em> remain '<strong>white</strong>' otherwise, they turn '<strong>red</strong>'.  The code works without any problems and really fast.</p>\n\n<p>My problem is the following. Lets say:</p>\n\n<ul>\n<li>I need to insert a value in <em>sheet1 - Column A</em>, cell A2 to A5 that match the ones from <em>sheet2 Column B</em>.</li>\n<li><em>sheet2 column B</em> has the following values: <em>car, house, garden, city, country.</em></li>\n<li>If in A2 I write <strong>car</strong>, A3 I <strong>leave empty</strong>, A4 <strong>country</strong> and A5 <strong>car</strong>, then A2, A4 and A5 will remain '<strong>white</strong>' because those values are in <em>sheet2 - Column B</em>. However, <strong>A3 turns red</strong> even though the cell is empty - this my problem. How can I make the code to not take into consideration if that cell is empty? It should not turn red because I left the cell empty and it is not comparing anything...</li>\n</ul>\n\n<p>I hope I explain myself somehow. Thanks for your help!</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nSet wb = Excel.ActiveWorkbook\nSet aRec = wb.Worksheets(1)\nSet bRec = wb.Worksheets(2)\n\nApplication.ScreenUpdating = False\n\nFor a = 2 To aRec.Cells(Rows.Count, \"A\").End(xlUp).Row\n    match = Application.match(aRec.Cells(c, 1).Value, bRec.Columns(2), 0)\n\nIf IsError(match) Then\n     aRec.Cells(c, 1).Interior.Color = RGB(255, 0, 0)\n\nElse\n    aRec.Cells(c, 1).Interior.Color = RGB(255, 255, 255)\n\nEnd If\n\n    Next c\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1520426979, "post_id": 49152333, "comment_id": 85308932, "body": "You probably require a worksheet_change that applies the correct custom number format depending on the time of day. Of course, you could always just use real time and then you wouldn&#39;t have to worry about minutes in base 10."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1520427418, "post_id": 49152333, "comment_id": 85309248, "body": "With your format applied, is better to work in 24 hour format"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1520427571, "post_id": 49152333, "comment_id": 85309370, "body": "There is a standard time format for it (AM/PM with 24h format entered), why use a custom one?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1520428148, "post_id": 49152333, "comment_id": 85309787, "body": "@UGP - <i>&#39;In order to allow for quick time entry,...&#39;</i>"}, {"owner": {"reputation": 11, "user_id": 2896898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6473eaf9d45b892d2a1d6d2c15aeb1e7?s=128&d=identicon&r=PG&f=1", "display_name": "PookieJunk", "link": "https://stackoverflow.com/users/2896898/pookiejunk"}, "edited": false, "score": 0, "creation_date": 1520429236, "post_id": 49152333, "comment_id": 85310517, "body": "@Jeeped Yes I&#39;ll resort to using real time if necessary, just didn&#39;t know if there was an easy way to fix this AM/PM problem. The exact time to the minute matters in my case, but it isn&#39;t necessarily entered in real time is the problem."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1520429383, "creation_date": 1520429383, "answer_id": 49153170, "question_id": 49152333, "link": "https://stackoverflow.com/questions/49152333/how-to-add-an-am-pm-option-at-the-end-of-a-custom-cell-format/49153170#49153170", "title": "How to add an AM/PM option at the end of a custom cell format?", "body": "<p>Say we are entering values in column <strong>A</strong>.  If we enter:</p>\n\n<pre><code>516\n</code></pre>\n\n<p>in <strong>A1</strong> and it is morning when we make the entry, we want Excel to convert the value to:</p>\n\n<pre><code>5:16 AM\n</code></pre>\n\n<p>If it is afternoon when the entry is made, we want the value to convert to <code>5:16 PM</code></p>\n\n<p>Place the following event macro in the worksheet code area:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim trail As String, v As String\n    With Target\n        If Intersect(Range(\"A:A\"), Target) Is Nothing Then Exit Sub\n        If .Value = \"\" Then\n            Application.EnableEvents = False\n                .Clear\n            Application.EnableEvents = True\n            Exit Sub\n        End If\n\n        trail = Right(CStr(Now()), 2)\n        v = .Text\n        mins = Right(v, 2)\n        hrs = Mid(v, 1, Len(v) - 2)\n        If trail = \"PM\" Then hrs = hrs + 12\n\n        Application.EnableEvents = False\n            .Clear\n            .Value = TimeSerial(hrs, mins, 0)\n            .NumberFormat = \"[$-en-US]h:mm AM/PM;@\"\n        Application.EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>This will result in true Excel time values with the correct format.</p>\n"}], "owner": {"reputation": 11, "user_id": 2896898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6473eaf9d45b892d2a1d6d2c15aeb1e7?s=128&d=identicon&r=PG&f=1", "display_name": "PookieJunk", "link": "https://stackoverflow.com/users/2896898/pookiejunk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 279, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1520429383, "creation_date": 1520426791, "question_id": 49152333, "link": "https://stackoverflow.com/questions/49152333/how-to-add-an-am-pm-option-at-the-end-of-a-custom-cell-format", "title": "How to add an AM/PM option at the end of a custom cell format?", "body": "<p>In order to allow for quick time entry, I have a custom format of</p>\n\n<p>0\":\"00</p>\n\n<p>so that entering 516 will result in 5:16. This works fine but I'd like to add whether it is in AM or PM.</p>\n\n<p>I've tried adding AM/PM to the end of this custom format</p>\n\n<p>0\":00 AM/PM</p>\n\n<p>so ideally, it would display as 5:16 PM if the cell was filled in in the PM. Unfortunately, it only ever shows AM, regardless of what time it was entered.</p>\n\n<p>Does anyone know how I can get this functionality? Maybe a custom format isn't the option I'm looking for?</p>\n"}, {"tags": ["vba", "date", "datetime", "outlook", "datetime-format"], "comments": [{"owner": {"reputation": 9569, "user_id": 8422953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CHPGb.jpg?s=128&g=1", "display_name": "braX", "link": "https://stackoverflow.com/users/8422953/brax"}, "edited": false, "score": 0, "creation_date": 1520426748, "post_id": 49152241, "comment_id": 85308757, "body": "<a href=\"https://www.techonthenet.com/excel/formulas/dateadd.php\" rel=\"nofollow noreferrer\">techonthenet.com/excel/formulas/dateadd.php</a>"}], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 3129427, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9041a046fc48b19f9aa5119fe482942?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Bartlett", "link": "https://stackoverflow.com/users/3129427/matt-bartlett"}, "edited": false, "score": 0, "creation_date": 1520432284, "post_id": 49152530, "comment_id": 85312591, "body": "Thanks Ashleedawg. I didn&#39;t think that the DateAdd function would work to add hours/mins when there was no hour/min component to the date currently held."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 4, "last_activity_date": 1520429459, "last_edit_date": 1520429459, "creation_date": 1520427363, "answer_id": 49152530, "question_id": 49152241, "link": "https://stackoverflow.com/questions/49152241/changing-or-add-the-time-to-a-date-in-vba/49152530#49152530", "title": "Changing or add the time to a Date in VBA", "body": "<p>There are a ton of ways to add dates and times together.</p>\n\n<p>Here's a few off the top of my head:</p>\n\n<pre><code>Sub examples()\n\n    'store an example date\n    Dim dt As Date\n    dt = CDate(\"March 7, 2018\")\n\n    'now to add 9 hours:\n    Debug.Print dt + (9 / 24)\n\n    'or, using DateAdd:\n    Debug.Print DateAdd(\"h\", 9, dt)\n\n    'or, add a time:\n    Dim tm As Date\n    tm = CDate(\"9:00 am\")\n    Debug.Print dt + tm\n\n    'or, as text:\n    Dim str As String\n    str = Format(dt, \"mmm d, yyyy\")\n    str = str &amp; \" 9:00 am\"\n    Debug.Print CDate(str)\n\n    'or, with TimeValue:\n    Debug.Print dt + TimeValue(\"9:00\")\n\n    'or, get extract the date from a datettime and add a different time:\n    Debug.Print DateValue(Now()) + TimeValue(\"9:00\")\n\nEnd Sub\n</code></pre>\n\n<p>Which method is best depends on what exactly you're trying to do with it.</p>\n\n<hr>\n\n<h2>Dates are just numbers</h2>\n\n<p>In Excel and VBA, dates (or DateTimes) are <strong>just numbers</strong> starting at:</p>\n\n<blockquote>\n  <p><strong>Midnight on \"January 0, 1900\"</strong></p>\n</blockquote>\n\n<p>...and increasing by <strong><code>1 per day</code></strong>.</p>\n\n<pre><code>1 = January 1, 1900, 00:00:00 (00:00 = midnight)\n2 = January 2, 1900, 00:00:00\n\n43166 = March 7, 2018\n</code></pre>\n\n<p>Need to make it 9:00 AM on Jan 2, 1900?</p>\n\n<ul>\n<li><p>1 hour is <sup>1</sup>/<sub>24</sub>th of a day.</p></li>\n<li><p>\u2234 <code>9:00 am</code> = <code>(9 \u00f7 24)</code> = <code>0.375</code></p></li>\n<li><p>\u2234 <code>2.375</code> = <code>January 2, 1900 9:00 am</code></p></li>\n</ul>\n\n<p>Similarly:</p>\n\n<ul>\n<li><p>\u2234 <code>9:00 pm</code> = <code>(18 \u00f7 24)</code> = <code>0.875</code></p></li>\n<li><p>\u2234 <code>2.875</code> = <code>January 2, 1900 9:00 pm</code></p>\n\n<p>6:00am    =   0.25   (\u00bc day)\nNOON      =   0.5    (\u00bd day)\n6:00pm    =   0.75   (\u00be day)</p>\n\n<p>1 hour    \u2248   0.417\n1 minute  \u2248   0.000695\n1 second  \u2248   0.000011574</p></li>\n</ul>\n\n<p>How many days until Summer?</p>\n\n<pre><code>Today          =   43166  (March 7, 2018)\nSummer begins  =   43272  (June 21, 2018)  [Northern Hemisphere]\n\n43272 - 43166  =   106 days\n</code></pre>\n\n<p>How many hours until Summer?</p>\n\n<pre><code>106 \u00d7 24       =   2544 hours\n</code></pre>\n\n<p><em>...you get the picture.</em>  \u263a</p>\n\n<hr>\n\n<p><strong>Maximum time possible in Excel</strong>:</p>\n\n<pre><code>Friday, December 31, 9999 23:59:59  =  2958465.99998843\n</code></pre>\n\n<p>(...so don't make any plans for that weekend.)</p>\n\n<hr>\n\n<h1>More Information:</h1>\n\n<ul>\n<li><p>Microsoft.com : <a href=\"https://support.microsoft.com/en-ca/help/214094/how-to-use-dates-and-times-in-excel\" rel=\"nofollow noreferrer\">How to use dates and times in Excel</a></p></li>\n<li><p><a href=\"https://www.exceltactics.com/definitive-guide-using-dates-times-excel/\" rel=\"nofollow noreferrer\">The Definitive Guide to Using Dates and Times in Excel</a></p></li>\n<li><p>Office.com : <a href=\"https://support.office.com/en-us/article/date-and-time-functions-reference-fd1b5961-c1ae-4677-be58-074152f97b81\" rel=\"nofollow noreferrer\">Date and time functions (reference)</a></p></li>\n<li><p>Stack Overflow/MSDN : <a href=\"https://stackoverflow.com/questions/39155117/rounding-date-and-time-in-vba\">Rounding Date &amp; Time in Excel</a></p></li>\n</ul>\n"}], "owner": {"reputation": 307, "user_id": 3129427, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9041a046fc48b19f9aa5119fe482942?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Bartlett", "link": "https://stackoverflow.com/users/3129427/matt-bartlett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7346, "favorite_count": 1, "accepted_answer_id": 49152530, "answer_count": 1, "score": 1, "last_activity_date": 1520429459, "creation_date": 1520426497, "question_id": 49152241, "link": "https://stackoverflow.com/questions/49152241/changing-or-add-the-time-to-a-date-in-vba", "title": "Changing or add the time to a Date in VBA", "body": "<p>I am working with a VBA project for Outlook. The project is looking at Calendar appointments and comparing them to dates pulled out of an SQL database and stored in a Date variable.</p>\n\n<p>Currently when the dates come out of the SQL database they not have any Time component to them but I would like to add one to it.</p>\n\n<p>For example out of the SQL query comes \"07/03/2018\" and I would like to be able to set this as \"07/03/2018 09:00:00\" and various other times of the day.</p>\n\n<p>Is there a way of doing this without converting the date variable to a string and just adding the time on at the end? This is because I would like to be able to use Date based functions such as DateAdd etc. on the variable later in the program.</p>\n"}, {"tags": ["excel", "save-as", "vba"], "comments": [{"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1520426125, "post_id": 49151464, "comment_id": 85308353, "body": "Take a look at <a href=\"https://stackoverflow.com/a/18901226/7938503\">this</a>."}], "answers": [{"comments": [{"owner": {"reputation": 100, "user_id": 6791681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6f96af1619cb0506a772720e1b7e13?s=128&d=identicon&r=PG&f=1", "display_name": "JakeyG", "link": "https://stackoverflow.com/users/6791681/jakeyg"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1520430249, "post_id": 49151831, "comment_id": 85311189, "body": "That&#39;s completely false. Create a workbook and save it as .xlsx. Open the VB editor and paste this (replace with your username):      Sub Test()          ThisWorkbook.SaveCopyAs (&quot;C:\\Users&#91;username]\\Desktop\\Test.csv&quot;)      End Sub   Run it and see what happens... It will save it as a CSV"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1520430616, "post_id": 49151831, "comment_id": 85311447, "body": "I know what you want to do, but with this method its not a real file conversion, just the extension is renamed, which leads to the file being corrupted. Excel is still able to open it, but that does not work with every fileformat and is not a good way of doing it."}, {"owner": {"reputation": 100, "user_id": 6791681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6f96af1619cb0506a772720e1b7e13?s=128&d=identicon&r=PG&f=1", "display_name": "JakeyG", "link": "https://stackoverflow.com/users/6791681/jakeyg"}, "reply_to_user": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1520430798, "post_id": 49151831, "comment_id": 85311570, "body": "The question wasn&#39;t about a universal solution, it was explicitly about sending a &quot;simple Excel sheet&quot; as a CSV. So the solution does that, using the fact that within the Excel environment, this will work."}, {"owner": {"reputation": 21, "user_id": 7953561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9795ca4a151b93497eb80dae385e3eb?s=128&d=identicon&r=PG&f=1", "display_name": "larjon", "link": "https://stackoverflow.com/users/7953561/larjon"}, "edited": false, "score": 0, "creation_date": 1520457526, "post_id": 49151831, "comment_id": 85328343, "body": "ThisWorkbook.SaveCopyAs (&quot;C:\\Users[username]\\Desktop\\Test.csv&quot;) does not work. It creates a copy, although the file extension is .csv, it is still an Excel file. It is a almost an identical copy of the original Excel file. I need it to be a comma separated file that can later be read by a non-Excel program."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1520510632, "post_id": 49151831, "comment_id": 85350142, "body": "JakeyG, your solution is basically suggesting an Excel file renamed to look like a CSV file <b><i>is</i></b> a CSV file..?"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1520510696, "post_id": 49151831, "comment_id": 85350178, "body": "Later versions of Excel also really dislike files where the filetype and the filename suffix don&#39;t match."}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "reply_to_user": {"reputation": 21, "user_id": 7953561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9795ca4a151b93497eb80dae385e3eb?s=128&d=identicon&r=PG&f=1", "display_name": "larjon", "link": "https://stackoverflow.com/users/7953561/larjon"}, "edited": false, "score": 0, "creation_date": 1520590066, "post_id": 49151831, "comment_id": 85387449, "body": "@larjon as i already said, it just renames the file extension and kind of breaks it, look at this <a href=\"https://stackoverflow.com/a/18901226/7938503\">link</a>"}], "tags": [], "owner": {"reputation": 100, "user_id": 6791681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6f96af1619cb0506a772720e1b7e13?s=128&d=identicon&r=PG&f=1", "display_name": "JakeyG", "link": "https://stackoverflow.com/users/6791681/jakeyg"}, "is_accepted": false, "score": -2, "last_activity_date": 1520430664, "last_edit_date": 1520430664, "creation_date": 1520425251, "answer_id": 49151831, "question_id": 49151464, "link": "https://stackoverflow.com/questions/49151464/excel-vba-saveas-csv-return-to-xlsx/49151831#49151831", "title": "Excel VBA SaveAs csv return to xlsx", "body": "<p>Use the SaveCopyAs method:\n<a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-savecopyas-method-excel\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-savecopyas-method-excel</a></p>\n\n<p>The SaveCopyAs method allows you to specify the full file path and therefore file type, so start with that.</p>\n\n<p>When you're doing the Outlook bit and you use the attach file to mailitem method, you specify that same full file path and it will attach it to send.</p>\n\n<p>In that fashion, the initial workbook remains the active workbook throughout and you don't need to re-open it. </p>\n\n<p>In your current approach, the .Close will terminate Excel because the active workbook is the one that is open at that time...</p>\n"}], "owner": {"reputation": 21, "user_id": 7953561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9795ca4a151b93497eb80dae385e3eb?s=128&d=identicon&r=PG&f=1", "display_name": "larjon", "link": "https://stackoverflow.com/users/7953561/larjon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 476, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1520430664, "creation_date": 1520424119, "last_edit_date": 1531164843, "question_id": 49151464, "link": "https://stackoverflow.com/questions/49151464/excel-vba-saveas-csv-return-to-xlsx", "title": "Excel VBA SaveAs csv return to xlsx", "body": "<p>I have a simple Excel sheet that I want to save as a CSV-file (and then send as an attachment using Outlook).\nWhen done, I want the original Excel sheet to be active and close the CSV-file.</p>\n\n<p>This part works, except I can not seem to close the CSV-file. If I try, Excel terminates.</p>\n\n<p>Sub Save()</p>\n\n<pre><code>Dim ActBook As Workbook\nDim CurrentFile As String\nDim NewFile As String\n\nCurrentFile = ThisWorkbook.FullName\nNewFile = Application.DefaultFilePath &amp; \"\\new.csv\"\n\nApplication.DisplayAlerts = False\nActiveWorkbook.SaveAs Filename:=NewFile, FileFormat:=xlTextWindows\nApplication.DisplayAlerts = True\n\nSet ActBook = ActiveWorkbook\nWorkbooks.Open CurrentFile          ' Make original file active\n'   ActBook.Close                   ' This does not work, Excel terminates\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["html", "vba", "excel", "internet-explorer", "web-scraping"], "comments": [{"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1520423678, "post_id": 49151158, "comment_id": 85306745, "body": "To locate the tab, you can play with <code>GetElementByTag(&quot;span&quot;)</code> and the property <code>InnerText</code> to locate the tab which InnerText is <code>Inserimento Giustificativi</code>. And then, maybe a Click would work?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1520425945, "post_id": 49151158, "comment_id": 85308230, "body": "I feel like this could be an <i><a href=\"https://meta.stackexchange.com/a/66378/370758\"><code>X-Y Problem</code></a></i>.   <b>Backing up</b> a bit, could you explain more about what you&#39;re <i>actually</i> trying to do, as in, <i>the <b>&quot;End Goal&quot;</i></b>?"}, {"owner": {"reputation": 1, "user_id": 9456236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd25047bc0a87a83277d4b3cc6005890?s=128&d=identicon&r=PG&f=1", "display_name": "Riuzaky", "link": "https://stackoverflow.com/users/9456236/riuzaky"}, "edited": false, "score": 0, "creation_date": 1520427422, "post_id": 49151158, "comment_id": 85309252, "body": "First Thank you for your answers. foxfire i tried the tip you gave me like this:               Set ele = objIE.document.getElementsByTagName(&quot;span&quot;)          For Each span In ele         If ele.innerText = &quot;Inserimento Giustificativi&quot; Then         ele.Click         End If     Next       but it gives me the error that the action is not supported, did i write something wrong?"}, {"owner": {"reputation": 1, "user_id": 9456236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd25047bc0a87a83277d4b3cc6005890?s=128&d=identicon&r=PG&f=1", "display_name": "Riuzaky", "link": "https://stackoverflow.com/users/9456236/riuzaky"}, "edited": false, "score": 0, "creation_date": 1520427900, "post_id": 49151158, "comment_id": 85309594, "body": "Ty for your answer ashleedawng. Im not sure what problem you&#39;re reffering to but the end goal of the routine is to to select some names (that would appear in the tab that i cant figure out how to select) and for those name i need to fill out some boxes with data that i get from another excel file (for example when he came to work es:08:00 and how many hours he stayed at work es: 04:00) and then i would have to click another button to validate the datas inserted in the boxes."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9456236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd25047bc0a87a83277d4b3cc6005890?s=128&d=identicon&r=PG&f=1", "display_name": "Riuzaky", "link": "https://stackoverflow.com/users/9456236/riuzaky"}, "is_accepted": false, "score": 0, "last_activity_date": 1584645839, "last_edit_date": 1584645839, "creation_date": 1520929409, "answer_id": 49251383, "question_id": 49151158, "link": "https://stackoverflow.com/questions/49151158/how-to-access-a-documentvirtual-document-in-vbaexcel-2007/49251383#49251383", "title": "How to access a #document(virtual document) in VBA(excel 2007)", "body": "<p>I managed to solve the issue.\nTo be able to access the data under #document it seems that all i had to do was to login and then navigate to the site a line above it, that is: <a href=\"https://sia.comdata.it/opera/GestioneOperativo/Giustificativi.aspx\" rel=\"nofollow noreferrer\">https://sia.comdata.it/opera/GestioneOperativo/Giustificativi.aspx</a> , after that everything went smoothly.</p>\n"}], "owner": {"reputation": 1, "user_id": 9456236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd25047bc0a87a83277d4b3cc6005890?s=128&d=identicon&r=PG&f=1", "display_name": "Riuzaky", "link": "https://stackoverflow.com/users/9456236/riuzaky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 144, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1584645839, "creation_date": 1520423163, "last_edit_date": 1520833803, "question_id": 49151158, "link": "https://stackoverflow.com/questions/49151158/how-to-access-a-documentvirtual-document-in-vbaexcel-2007", "title": "How to access a #document(virtual document) in VBA(excel 2007)", "body": "<p>I just started to use vba automation in IE and at the moment i am trying to make a routine to make my job easier at work. For that i have to complete every morning a site. Until now i managed to log in the site and click some buttons and i am stuck when i need to select a tab; there are 3 tabs and one of them gets selected automatically, the third one actually, and i need to select the second one (Inserimento Giustificativi):</p>\n\n<p><a href=\"https://i.stack.imgur.com/fbLOl.png\" rel=\"nofollow noreferrer\">the 3 tabs i'm talking about</a></p>\n\n<p>Next i will give you the code of the tabs:</p>\n\n<pre><code>&lt;div id=\"TabContainer1_header\" class=\"ajax__tab_header\"&gt;\n            &lt;span id=\"TabContainer1_TabPanel3_tab\" class=\"\"&gt;\n             &lt;span class=\"ajax__tab_outer\"&gt;\n              &lt;span class=\"ajax__tab_inner\"&gt;\n               &lt;span id=\"__tab_TabContainer1_TabPanel3\" class=\"ajax__tab_tab\"&gt;Console Operativa&lt;/span&gt;\n              &lt;/span&gt;\n             &lt;/span&gt;\n            &lt;/span&gt;\n            &lt;span id=\"TabContainer1_TabPanel1_tab\" class=\"\"&gt;\n             &lt;span class=\"ajax__tab_outer\"&gt;\n              &lt;span class=\"ajax__tab_inner\"&gt;\n               &lt;span id=\"__tab_TabContainer1_TabPanel1\" class=\"ajax__tab_tab\"&gt;Inserimento Giustificativi&lt;/span&gt;\n             &lt;/span&gt;\n            &lt;/span&gt;\n           &lt;/span&gt;\n           &lt;span id=\"TabContainer1_TabPanel2_tab\" class=\"ajax__tab_active\"&gt;\n            &lt;span class=\"ajax__tab_outer\"&gt;\n             &lt;span class=\"ajax__tab_inner\"&gt;\n              &lt;span id=\"__tab_TabContainer1_TabPanel2\" class=\"ajax__tab_tab\"&gt;Giustificativi Generici&lt;/span&gt;\n             &lt;/span&gt;\n            &lt;/span&gt;\n           &lt;/span&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And here is the code i made until now (pretty basic really):</p>\n\n<pre><code>Sub SearchBot()\n\n    Dim objIE As InternetExplorer\n    Dim ele As Object\n\n    Set objIE = Nothing\n\n    Set objIE = New InternetExplorer\n\n    objIE.Visible = True\n\n    objIE.navigate \"sia.comdata.it/opera\"\n\n    Application.Wait (Now + TimeValue(\"00:00:05\"))\n\n    objIE.document.getElementById(\"UserName\").Value = \"username\"\n\n    objIE.document.getElementById(\"Password\").Value = \"$password\"\n\n    objIE.document.getElementById(\"LoginButton\").Click\n\n    Application.Wait (Now + TimeValue(\"00:00:05\"))\n\n    objIE.document.getElementById(\"palla\").Click\n\n    Application.Wait (Now + TimeValue(\"00:00:02\"))\n\n    objIE.document.getElementById(\"content_GestioneOperativo\").getElementsByTagName(\"a\")(2).Click\n\n    Application.Wait (Now + TimeValue(\"00:00:30\"))\n\nEnd Sub\n</code></pre>\n\n<p>I tried all the methods above and habe been searching on internet for a week for a solution but nothing, all the time i get the error run-time error 91 or that the action is not supported.</p>\n\n<p>Also i noticed that when click manually one of the tabs the ClassName \"ajax__tab_active\" moves itself to the class of the tag i selected and the ClassName that was populated with \"ajax__tab_active\" remains blank i don't know if it helps, just that i found it strange.</p>\n\n<p>Any tips would be helpful since i am a begginer and i really have no idea what else to try since i'm writting here,</p>\n\n<p>Thank you.</p>\n\n<p>*I'm editing my question since, doing a lot more tries, i noticed that i can't access a part of the source code. At some point in the source code there is a tag named iframe and immediately after it is #document, it seems that i can't access anything under #document in any way, googling it i understand it is a virtual document embedded in the source code, but i still have no idea how to access it: </p>\n\n<p><a href=\"https://i.stack.imgur.com/MPRd8.jpg\" rel=\"nofollow noreferrer\">Virtual document</a></p>\n\n<p>That's how the source code look and the line selected is what i need to get,</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["arrays", "vba", "excel", "sorting"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520422897, "post_id": 49150996, "comment_id": 85306246, "body": "loop the array and add to a dictionary?"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 7705143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJZcY.jpg?s=128&g=1", "display_name": "J.O.P.P.", "link": "https://stackoverflow.com/users/7705143/j-o-p-p"}, "edited": false, "score": 0, "creation_date": 1520425879, "post_id": 49151185, "comment_id": 85308194, "body": "Hi @QHarr, Thanks for helping, but when I run the code, I get the following msg:   &quot;Run-time error&#39;429&#39;:  ActiveX component can&#39;t create object&quot;  Any idea how to prevent this error?"}, {"owner": {"reputation": 107, "user_id": 7705143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJZcY.jpg?s=128&g=1", "display_name": "J.O.P.P.", "link": "https://stackoverflow.com/users/7705143/j-o-p-p"}, "edited": false, "score": 1, "creation_date": 1520428530, "post_id": 49151185, "comment_id": 85310052, "body": "Thanks for your Help @Qharr"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1520426204, "last_edit_date": 1520426204, "creation_date": 1520423228, "answer_id": 49151185, "question_id": 49150996, "link": "https://stackoverflow.com/questions/49150996/implanting-an-extra-variable-to-count-the-number-of-times-an-unique-item-is-fo/49151185#49151185", "title": "Implanting an extra variable to count the number of times an &quot;unique&quot; item is found in an array.", "body": "<p>Use a dictionary to store the count? This demonstrates the principle. Note in your example I think you may only be adding one column G so I don't know of you intended more?</p>\n\n<pre><code>Sub test()\n\nDim myArray()\n\nmyArray = ActiveSheet.Range(\"A1\").CurrentRegion.Value\n\nDim dict As Object\n\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\nDim i As Long\n\nFor i = LBound(myArray, 1) To UBound(myArray, 1) 'Depending on column of interest. Loop that\n\n    If Not dict.Exists(myArray(i, 1)) Then\n        dict.Add myArray(i, 1), 1\n    Else\n       dict(myArray(i, 1)) = dict(myArray(i, 1)) + 1\n    End If\n\nNext i\n\nDim key As Variant\n\nFor Each key In dict.keys\n    Debug.Print key &amp; \"(\" &amp; dict(key) &amp; \")\"\nNext key\n\nEnd Sub\n</code></pre>\n\n<p>Your example might be something like (can't test dictionary on a mac I'm afraid so coding in my head)</p>\n\n<pre><code>Sub test()\n\n    Dim aData()\n    Dim ws As Worksheet\n    Dim targetRange As Range\n    Dim lastRow As Long\n\n    Set ws = ActiveSheet\n    lastRow = ws.Cells(ws.Rows.Count, \"G\").End(xlUp).Row\n\n   If lastRow = 1 Then Exit Sub\n\n    Set targetRange = ws.Range(\"G2:G\" &amp; lastRow)\n\n    If targetRange.Cells.Count = 1 Then\n        ReDim aData(1 To 1, 1 To 1)\n        aData(1, 1) = targetRange.Value\n   Else\n       aData = targetRange.Value2\n   End If\n\n    Dim dictUnq As Object\n\n    Set dictUnq = CreateObject(\"Scripting.Dictionary\")\n\n    Dim i As Long\n\n    For i = LBound(aData, 1) To UBound(aData, 1) 'Depending on column of interest. Loop that\n\n        If Not dictUnq.Exists(aData(i, 1)) Then\n            dictUnq.Add aData(i, 1), 1\n        Else\n           dictUnq(aData(i, 1)) = dictUnq(aData(i, 1)) + 1\n        End If\n\n    Next i\n\n    Dim key As Variant\n\n    For Each key In dictUnq.keys\n        Debug.Print key &amp; \"(\" &amp; dictUnq(key) &amp; \")\"\n    Next key\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 7705143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJZcY.jpg?s=128&g=1", "display_name": "J.O.P.P.", "link": "https://stackoverflow.com/users/7705143/j-o-p-p"}, "edited": false, "score": 0, "creation_date": 1520429319, "post_id": 49152043, "comment_id": 85310570, "body": "Is there a posibility to print the data as listed in the list in an new sheet so i can print them on paper?"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1520425874, "creation_date": 1520425874, "answer_id": 49152043, "question_id": 49150996, "link": "https://stackoverflow.com/questions/49150996/implanting-an-extra-variable-to-count-the-number-of-times-an-unique-item-is-fo/49152043#49152043", "title": "Implanting an extra variable to count the number of times an &quot;unique&quot; item is found in an array.", "body": "<p>another possibility</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton5_Click()\n    Dim dictUnq As Object\n    Set dictUnq = CreateObject(\"Scripting.Dictionary\")\n\n    Dim cell As Range\n    With ActiveWorkbook.Sheets(\"Sheet3\")\n        For Each cell In .Range(\"G2\", .Cells(.Rows.Count, \"G\").End(xlUp))\n            dictUnq(cell.Value) = dictUnq(cell.Value) + 1\n        Next\n    End With\n\n    If dictUnq.Count = 0 Then Exit Sub\n\n    Dim key As Variant\n    With SBI_Omschrijving.ListBox1\n        .Clear\n        .ColumnCount = 2\n        For Each key In dictUnq.keys\n            .AddItem key\n            .List(.ListCount - 1, 1) = dictUnq(key)\n        Next\n    End With\n\n    MsgBox \"Unique findings:  \" &amp; dictUnq.Count\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 7705143, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zJZcY.jpg?s=128&g=1", "display_name": "J.O.P.P.", "link": "https://stackoverflow.com/users/7705143/j-o-p-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 49151185, "answer_count": 2, "score": 0, "last_activity_date": 1520426204, "creation_date": 1520422705, "last_edit_date": 1531164843, "question_id": 49150996, "link": "https://stackoverflow.com/questions/49150996/implanting-an-extra-variable-to-count-the-number-of-times-an-unique-item-is-fo", "title": "Implanting an extra variable to count the number of times an &quot;unique&quot; item is found in an array.", "body": "<p>I've got a sub representing a commandbutton of my userform, this userform has the perpose of listing (in a listbox) all unique items found in a column of a two-dimensional array. At frst I would like to implant an extra variable to hold and thus represent the number of times the unique item appears in the array. Secondly I would like the (Unique) items listed as:</p>\n\n<p><em>Unique item 1</em> (<em>number of appearances</em>). </p>\n\n<p>Example 1 (23) </p>\n\n<p>Example 2 (39)</p>\n\n<p>Example 3 (101)</p>\n\n<p>Example 4 (9)</p>\n\n<p>...</p>\n\n<p>Example n (#)</p>\n\n<p>Here is the code, can some body help me out?</p>\n\n<pre><code>Private Sub CommandButton5_Click()\nDim ws As Worksheet\nDim dictUnq As Object\nDim UnqList() As String\nDim aData As Variant\nDim vData As Variant\nDim pData As Variant\nDim i As Variant\nDim PrintString1() As String\ni = 1\n\nSet ws = ActiveWorkbook.Sheets(\"Sheet3\")\nSet dictUnq = CreateObject(\"Scripting.Dictionary\")\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nWith ws.Range(\"G2\", ws.Cells(ws.Rows.Count, \"G\").End(xlUp))\n    If .Row &lt; 2 Then Exit Sub   'No data\n    If .Cells.Count = 1 Then\n        ReDim aData(1 To 1, 1 To 1)\n        aData(1, 1) = .Value\n    Else\n        aData = .Value\n    End If\nEnd With\n\nSBI_Omschrijving.ListBox1.Clear\n\nFor Each vData In aData\n    If Len(vData) &gt; 0 Then\n        If Not dictUnq.exists(vData) Then dictUnq.Add vData, vData\n    End If\nNext vData\n\nDebug.Print dictUnq(vData)\n\nSBI_Omschrijving.ListBox1.List = dictUnq.keys\nMsgBox \"Unique findings:  \" &amp; dictUnq.Count\n\n\nApplication.ScreenUpdating = True\nApplication.EnableEvents = True\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["ms-access", "parameters", "vba"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1520423318, "post_id": 49150834, "comment_id": 85306509, "body": "Setting the date criteria of the query to <code>Date()</code> and <code>DateAdd(&quot;y&quot;, 14, Date())</code> perhaps?"}, {"owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1520423856, "post_id": 49150834, "comment_id": 85306840, "body": "@KostasK.  So do you mean don&#39;t try to pass just the dates to the existing source, supply the whole record source with the amended criteria?  I&#39;d not thought of that option, thank you.  However, it&#39;s a large number of reports, so the coding to supply the amended record source for each of the possible reports means it would probably be easier just to duplicate the reports and have one set that works with the form, and one that has parameters to work with the auto generation/email process. I was hoping to find a way to solve this without duplicating the reports."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1520424591, "post_id": 49150834, "comment_id": 85307351, "body": "No, I mean the report&#39;s underlying query. Instead of passing the dates as parameters to the query, let the query figured them out. That is of course if you need the report dates to always default to today and today +14."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1520424766, "post_id": 49150834, "comment_id": 85307462, "body": "Something like <code>SELECT * FROM T WHERE [Field] BETWEEN Date() And DateAdd(&quot;y&quot;, 14, Date());</code>"}, {"owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1520425205, "post_id": 49150834, "comment_id": 85307755, "body": "thanks @KostasK.  Unfortunately the dates are only today and today + 14 when we run them for email on a Monday morning.  When users run the report from the current selection form they can select any start or end date, or leave one or both dates blank."}], "answers": [{"tags": [], "owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "is_accepted": false, "score": 0, "last_activity_date": 1520437623, "creation_date": 1520437623, "answer_id": 49155979, "question_id": 49150834, "link": "https://stackoverflow.com/questions/49150834/is-it-possible-to-pass-values-to-an-access-report-from-both-vba-and-from-a-form/49155979#49155979", "title": "is it possible to pass values to an access report from both vba and from a form?", "body": "<p>I have reached a working solution for this, it may not be the most elegant but it allows me to use a single report in the two scenarios of opening automatically for a specific date range, or opening at the users request with user specified dates.<br>\nI have amended the reports so their default record source uses Date() and Date()+14 for the report date range.\nWhen the report is opened by a user from the \"Report Selection\" form, \"User\" is passed through via OpenArgs.  The OnOpen event of the form checks the value of OpenArgs and if it is set to \"User\", changes both the report's record source and the controls that display the report date range to use the dates entered by the user on the selection form.<br>\n@kostasK. thank you for all your input, you helped me get to this solution.  </p>\n"}], "owner": {"reputation": 86, "user_id": 7008757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3916e74c7724d1a7abd05da3285d5c0f?s=128&d=identicon&r=PG&f=1", "display_name": "JennyW", "link": "https://stackoverflow.com/users/7008757/jennyw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520437623, "creation_date": 1520422219, "question_id": 49150834, "link": "https://stackoverflow.com/questions/49150834/is-it-possible-to-pass-values-to-an-access-report-from-both-vba-and-from-a-form", "title": "is it possible to pass values to an access report from both vba and from a form?", "body": "<p>I have a set of reports than currently run from a 'Select Report' form.  Users select the report name and the start and/or end dates they want to view, and the query underlying the chosen report looks at the controls on the form to filter the report to the selected dates. </p>\n\n<p>We now want to automatically run some of these reports every Monday morning, to send out via email.  The start and end dates for the reports will be Date() and Date()+14.  I know how to code to run the report and attach it to email, but I can't work out how to programmatically pass dates to the form's underlying query, instead of it looking to the form controls.  </p>\n\n<p>I've searched for the answer but can only find answers explaining how to do one or the other, but not if it's possible to do both using the same report. \nI've tried to use parameters in the report's underlying query instead, but then I get prompt boxes for the date paramaters when I open the report from the form, even though dates have been selected on the form and are passed through to the report as expected. </p>\n\n<p>I've also tried to pass the dates via openargs instead of looking directly to the form controls, but then I can't work out how to pass those openarg values into the query, only to controls on the report.  That means the displayed start and end dates are correct, but the date filtering isn't applying to the report.  From stepping through it, the report loads the data before the OnLoad code runs which sets the controls to the openargs values, so they are null at the point the data is filtered. </p>\n\n<p>Any help is much appreciated, I'm a bit stumped on the best approach from here. Thanks.  </p>\n"}, {"tags": ["vba", "excel", "percentage", "autofilter"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1520421092, "post_id": 49150458, "comment_id": 85305174, "body": "Try <code>Variable = Tabelle2.Range(&quot;B3&quot;).Text</code>"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1520423098, "post_id": 49150458, "comment_id": 85306367, "body": "<code>Tabelle2.Range(&quot;B3&quot;).Value</code> What is actual value of this cell? <code>0.1</code>, <code>10</code>, <code>10%</code>? Are values in 10-th field strings or numbers?"}, {"owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "edited": false, "score": 0, "creation_date": 1520424163, "post_id": 49150458, "comment_id": 85307045, "body": "When I use Variable = Tabelle2.Range(&quot;B3&quot;).Text it shows &quot;Laufzeitfehler &#39;13&#39;&quot;.   The actual Value of Tablle2.Range(&quot;B3&quot;) is 10% and the values in 10-th field are also shown as percentages, e.g. 19% etc."}], "answers": [{"tags": [], "owner": {"reputation": 18, "user_id": 9426140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2b537f3d6ad2a028817ae9144dd3c8e?s=128&d=identicon&r=PG&f=1", "display_name": "TheChatty", "link": "https://stackoverflow.com/users/9426140/thechatty"}, "is_accepted": true, "score": 0, "last_activity_date": 1520424610, "creation_date": 1520424610, "answer_id": 49151618, "question_id": 49150458, "link": "https://stackoverflow.com/questions/49150458/excel-vba-autofilter-percentages/49151618#49151618", "title": "Excel VBA AutoFilter Percentages", "body": "<p>Your variable needs to be at least float if not double, because e.g. <code>12%</code> equals <code>0.12</code>.</p>\n\n<p>And .AutoFilter property seems to always expect 'en-US' locale values thus the following code should work:</p>\n\n<pre><code>Sub AutoFilter()\n    Dim Bereich As Range, Variable As Double\n\n    Set Bereich = Tabelle1.UsedRange\n    Variable = Tabelle2.Range(\"B3\").Value\n\n    Bereich.AutoFilter Field:=10, Criteria1:=\"&gt;=\" &amp; Replace(Variable, \",\", \".\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 9456216, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ba5693829f4c7340e117d99a258fb421?s=128&d=identicon&r=PG&f=1", "display_name": "HPM", "link": "https://stackoverflow.com/users/9456216/hpm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 49151618, "answer_count": 1, "score": 0, "last_activity_date": 1520424610, "creation_date": 1520420973, "last_edit_date": 1520421564, "question_id": 49150458, "link": "https://stackoverflow.com/questions/49150458/excel-vba-autofilter-percentages", "title": "Excel VBA AutoFilter Percentages", "body": "<p>I want to filter a list of industries by using their growth rate as criteria. \nAt the end, I want my sheet just showing industries growing >= 10%. </p>\n\n<p>The data I want to filter is in Tabelle1 Column 10 and is shown as percentage. Furthermore, I have stated my criteria 10% (Which should stay variable) on Tabelle2 Cell B3. However, after exectuing the follwing code it is showing me all industries with a growth rate >= 0%. </p>\n\n<p>Does anyone know why and how I can adjust it to my needs? </p>\n\n<hr>\n\n<pre><code>Sub AutoFilter()\nDim Bereich As Range\nDim Variable As Long\n\nSet Bereich = Tabelle1.UsedRange\nVariable = Tabelle2.Range(\"B3\").Value\n\nBereich.AutoFilter Field:=10, Criteria1:=\"&gt;=\" &amp; Variable\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Thank you :) </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1520420284, "post_id": 49150055, "comment_id": 85304630, "body": "Dont count rows, count cells of one column <code>rCount = Range(&quot;A2:N&quot; &amp; Sheets(&quot;FullInvoice&quot;).Cells(Rows.count, &quot;A&quot;).End(xlUp).Row).SpecialCells(xlCellTypeVisible).Columns(&zwnj;&#8203;&quot;A&quot;).Cells.Count</code>"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1520420411, "post_id": 49150055, "comment_id": 85304716, "body": "You&#39;re building your filter on <code>Sheets(&quot;FullInvoice&quot;).Range(&quot;A1:N&quot; &amp; lRow)</code> but you&#39;re counting rows based upon <code>Range(&quot;A2:N&quot; &amp; Sheets(&quot;FullInvoice&quot;).Cells(Rows.count, &quot;A&quot;).End(xlUp).Row)</code> - I&#39;d suggest choosing one of these for both."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1520420669, "post_id": 49150055, "comment_id": 85304908, "body": "@CLR He doesn&#39;t need to count headers, <code>lRow</code> (I hope I&#39;m not mistaken) is basicly the same as <code>Sheets(&quot;FullInvoice&quot;).Cells(Rows.count, &quot;A&quot;).End(xlUp).Row</code> so this part of code is out of the question."}, {"owner": {"reputation": 2926, "user_id": 954093, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a329dc7bfdaf20e9f46ea64db314292c?s=128&d=identicon&r=PG", "display_name": "Sandeep Thomas", "link": "https://stackoverflow.com/users/954093/sandeep-thomas"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1520420811, "post_id": 49150055, "comment_id": 85305007, "body": "@AntiDrondert That is also 22"}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1520421324, "post_id": 49150055, "comment_id": 85305311, "body": "My comment was based on a guess that the filter is not extending fully down the data, which would make sense if the two row counts were different. Hence if you stick to one or the other, you are <i>more likely</i> (it is just a guess - we can&#39;t see the sheet) to get the same row count"}, {"owner": {"reputation": 2926, "user_id": 954093, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a329dc7bfdaf20e9f46ea64db314292c?s=128&d=identicon&r=PG", "display_name": "Sandeep Thomas", "link": "https://stackoverflow.com/users/954093/sandeep-thomas"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1520421556, "post_id": 49150055, "comment_id": 85305439, "body": "@CLR The lRow is taking the full used range and its 10020 which is correct according to used range.. So for a try when we do a select on that range, its selects the whole rows. So the filter is being applied to the full rows."}, {"owner": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1520422010, "post_id": 49150055, "comment_id": 85305688, "body": "In that case it may help if you include the piece of code that sets <code>lRow</code>. If that is the case though, why don&#39;t you use <code>lRow</code> in your <code>rCount</code> line instead of finding the <code>xlUp</code> row value?"}, {"owner": {"reputation": 2926, "user_id": 954093, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a329dc7bfdaf20e9f46ea64db314292c?s=128&d=identicon&r=PG", "display_name": "Sandeep Thomas", "link": "https://stackoverflow.com/users/954093/sandeep-thomas"}, "reply_to_user": {"reputation": 8119, "user_id": 7446760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NTSFF.jpg?s=128&g=1", "display_name": "CLR", "link": "https://stackoverflow.com/users/7446760/clr"}, "edited": false, "score": 0, "creation_date": 1520422226, "post_id": 49150055, "comment_id": 85305818, "body": "@CLR That is 100% true. I changed it to lRow. But still its sticked with the 22"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1520422422, "post_id": 49150055, "comment_id": 85305924, "body": "There are 22 rows in the first <b>Area</b>."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 1, "creation_date": 1520422465, "post_id": 49150055, "comment_id": 85305956, "body": "@SandeepThomas Try looping through <b>Areas</b> as in <code>Dim rngArea As Range : For Each rngArea In Range(&quot;A2:N&quot; &amp; Sheets(&quot;FullInvoice&quot;).Cells(Rows.count, &quot;A&quot;).End(xlUp).Row).SpecialCells(xlCellTypeVisible).Areas : rCount = rCount + rngArea.Rows.Count : Next</code>"}, {"owner": {"reputation": 2926, "user_id": 954093, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a329dc7bfdaf20e9f46ea64db314292c?s=128&d=identicon&r=PG", "display_name": "Sandeep Thomas", "link": "https://stackoverflow.com/users/954093/sandeep-thomas"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1520422535, "post_id": 49150055, "comment_id": 85306002, "body": "@AntiDrondert Yea.. that is something I guess as a solution too... since its keeps weird value.. Thanks"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520422625, "post_id": 49150055, "comment_id": 85306065, "body": "and if N has the same number of rows as F you get the expected result I think."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1520422663, "post_id": 49150055, "comment_id": 85306091, "body": "@SandeepThomas It realy IS weird, because &quot;count cells instead of rows&quot; solution worked fine for me in the past. Anyway, looping through areas might be slower but at least it is reliable."}], "owner": {"reputation": 2926, "user_id": 954093, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a329dc7bfdaf20e9f46ea64db314292c?s=128&d=identicon&r=PG", "display_name": "Sandeep Thomas", "link": "https://stackoverflow.com/users/954093/sandeep-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520419760, "creation_date": 1520419760, "last_edit_date": 1531164843, "question_id": 49150055, "link": "https://stackoverflow.com/questions/49150055/visible-cells-row-count-calculates-as-very-low-even-there-are-more-rows-showing", "title": "Visible cells row count calculates as very low even there are more rows showing after filtering", "body": "<p>I have an excel sheet where Im doing some filtering. After filtering according to excel status bar 95 filtered from 10000+ records and we can obviously see the 95 records only visible in the filtered list. But when I try to take the number of visible rows or filtered rows using this code following, it returns a very low value (Only 22). Didnt understand why its so low.</p>\n\n<p>Here is the code</p>\n\n<pre><code>With Sheets(\"FullInvoice\").Range(\"A1:N\" &amp; lRow)\n    .Cells(1, 1).Select\n    .AutoFilter\n    .AutoFilter Field:=6, Criteria1:=\"&gt;=\" &amp; fD, Criteria2:=\"&lt;=\" &amp; lD\n    .AutoFilter Field:=2, Criteria1:=selectedSOW, Criteria2:=\"&lt;&gt;0\"\n    '.AutoFilter Field:=2, Criteria1:=\"&lt;&gt;0\", Operator:=xlAnd\n    'Set xRange = .SpecialCells(xlCellTypeVisible)\nEnd With\nrCount = Range(\"A2:N\" &amp; Sheets(\"FullInvoice\").Cells(Rows.count, \"A\").End(xlUp).Row).SpecialCells(xlCellTypeVisible).Rows.count\n</code></pre>\n\n<p>Here after all the autofilter there is clearly 95 rows. But in rCount only returns 22.. Didnt understand why</p>\n\n<p>If we simply include this line of code</p>\n\n<pre><code>Range(\"A2:A10409\").SpecialCells(xlCellTypeVisible).select\n</code></pre>\n\n<p>its clearly selecting 95 rows. Even then when we try </p>\n\n<pre><code>Range(\"A2:A10409\").SpecialCells(xlCellTypeVisible).rows.count\n</code></pre>\n\n<p>it says <strong>22</strong>. Really got stucked</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1520419899, "post_id": 49150018, "comment_id": 85304388, "body": "Welcome to Stack Overflow. If you want to do that in VBA you would need to start something on your own first. This is a question/answer based site where you can ask questions related on code you have written on your own, and got stuck or got errors. People will kindly help you to fix your issues in your code yourself but they wont write all the code for you. Also it is too broad to ask for a general guidance or teaching here. You might take a <a href=\"https://stackoverflow.com/tour\">tour</a> or read <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> to improve your question (and you need to ask one at least)."}, {"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520420408, "post_id": 49150018, "comment_id": 85304714, "body": "Appologies, I have added the code I have used, I am having trouble getting the summary part the split is ok."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520420600, "post_id": 49150018, "comment_id": 85304856, "body": "I suggest to use <code>Option Explicit</code> to avoid any trouble with variable naming. Your biggest issue is that you once use <code>cel</code> and on the other hand you use <code>cell</code>. Also have a look at the formula solution below where you don&#39;t need VBA at all."}, {"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520425044, "post_id": 49150018, "comment_id": 85307669, "body": "I would like to use vba to automate the process"}], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520421845, "post_id": 49150496, "comment_id": 85305599, "body": "Hi, subscript out of range &quot;for r = lbound (str) to ubound(str)"}, {"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520422314, "post_id": 49150496, "comment_id": 85305862, "body": "Hi, thank you for this. How do I include the unique Id&#39;s in the next column? as per my expected result shown in the question description. Also if there are many 0s and not just one then the formula does not work is there a way to do this for all 0&#39;s? Ie 100,0,0,0,0,0,0,0 would return 100."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520422573, "post_id": 49150496, "comment_id": 85306024, "body": "@GLH Updated - I dyked too much of your existing code out when adapting it.  Sorry!"}, {"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520422610, "post_id": 49150496, "comment_id": 85306057, "body": "appreciate the help on this"}, {"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520424650, "post_id": 49150496, "comment_id": 85307396, "body": "Could you advise? please can you check my expected result"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520428098, "post_id": 49150496, "comment_id": 85309750, "body": "@GLH Ah, I had misread the question as removing the &quot;0&quot; items from each row in turn.  I have updated the answer to list unique non-zero items from column 4 in column 5."}, {"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520430567, "post_id": 49150496, "comment_id": 85311407, "body": "I get a compile error: Expected: List Separator on line:  If inStr(&quot;;&quot; &amp; Trim(str(r)) &amp; &quot;;&quot;) &lt; 1 Then"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520432044, "post_id": 49150496, "comment_id": 85312427, "body": "Corrected and tested."}, {"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520432266, "post_id": 49150496, "comment_id": 85312579, "body": "Thank you this is now working I have accepted your answer"}], "tags": [], "owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "is_accepted": false, "score": 0, "last_activity_date": 1520431711, "last_edit_date": 1520431711, "creation_date": 1520421086, "answer_id": 49150496, "question_id": 49150018, "link": "https://stackoverflow.com/questions/49150018/splitting-a-value-that-is-delimitted/49150496#49150496", "title": "Splitting a value that is delimitted", "body": "<p>So, you want to concatenate non-0 values into a string, then put that in the next cell?</p>\n\n<pre><code>Sub SplitRange()\n    Dim workcell As Range\n    Dim str() As String 'string array\n    Dim r As Long 'VBA automatically stores Integers as Longs, so there is no Memory saved by not using Long\n    Dim output As String\n    output = \";\" 'Start with a single delimiter\n\n    For Each workcell In Intersect(ActiveSheet.UsedRange,ActiveSheet.Columns(4)) 'Go down the cells in Column D\n        If InStr(workcell.Value, \";\") &gt; 0 Then 'split\n            str = Split(workcell.Value,\";\")\n            For r = LBound(str) To UBound(str)\n                If inStr(output, \";\" &amp; Trim(str(r)) &amp; \";\") &lt; 1 Then 'If number is not already in output\n                    output = output &amp; Trim(str(r)) &amp; \";\" 'Add the number and \";\" to the end of the string\n                End If\n            Next r\n            Erase str 'Tidy up array, ready to recycle\n        End If\n    Next workcell\n    'We now have a unique list of all items, starting/ending/delimited with \";\"\n    output = Replace(output,\";0;\",\";\") 'Remove the item \";0;\" if it exists\n    If Len(output) &gt; 2 Then 'output contains at least 1 non-zero number\n        output= Mid(output,2,len(output)-2) 'Remove \";\" from the start and end\n        str = Split(output,\";\") 'Split the list of unique values into an array\n        For r = lbound(str) To ubound(str)\n            ActiveSheet.Cells(r+2-lbound(str),5).Value = str(r) 'List the values in column 5, starting from row 2\n        Next r\n        Erase str 'Tidy up array\n    End If\nEnd Sub\n</code></pre>\n\n<p>To remove \"0\"s from a single row as an Excel formula, try this:</p>\n\n<pre><code>=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(\"|;\" &amp; A1 &amp; \";|\", \";0;\",\";\"),\";|\",\"\"),\"|;\",\"\")\n</code></pre>\n\n<p>From the inside-out:</p>\n\n<blockquote>\n  <p><code>SUBSTITUTE(\"|;\" &amp; A1 &amp; \";|\", \";0;\",\";\")</code> Sandwich our values in wrappers (<code>\"|;0;240;0;|\"</code>) and replace any \";0;\" with \";\" (<code>\"|;240;|\"</code>)</p>\n</blockquote>\n\n<p>.</p>\n\n<blockquote>\n  <p><code>SUBSTITUTE(PREV,\";|\",\"\")</code> Remove \";|\" (<code>\"|;240\"</code>)</p>\n</blockquote>\n\n<p>.</p>\n\n<blockquote>\n  <p><code>SUBSTITUTE(PREV,\"|;\",\"\")</code> Remove \"|;\" (<code>\"240\"</code>)</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520423097, "post_id": 49151037, "comment_id": 85306365, "body": "Hi, this produces a compile error at row 1 I have done for i = 1 to 10000"}, {"owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1520423988, "post_id": 49151037, "comment_id": 85306927, "body": "can you please advise?"}, {"owner": {"reputation": 100, "user_id": 6791681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6f96af1619cb0506a772720e1b7e13?s=128&d=identicon&r=PG&f=1", "display_name": "JakeyG", "link": "https://stackoverflow.com/users/6791681/jakeyg"}, "reply_to_user": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1521560135, "post_id": 49151037, "comment_id": 85778182, "body": "Sorry the first TempArray needs brackets i.e.     Dim TempArray() as String I have edited in the above."}, {"owner": {"reputation": 100, "user_id": 6791681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6f96af1619cb0506a772720e1b7e13?s=128&d=identicon&r=PG&f=1", "display_name": "JakeyG", "link": "https://stackoverflow.com/users/6791681/jakeyg"}, "reply_to_user": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "edited": false, "score": 0, "creation_date": 1521645730, "post_id": 49151037, "comment_id": 85821985, "body": "Hi GLH - if that&#39;s all clear now, please upvote and mark it as a solution by clicking the tick."}], "tags": [], "owner": {"reputation": 100, "user_id": 6791681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6f96af1619cb0506a772720e1b7e13?s=128&d=identicon&r=PG&f=1", "display_name": "JakeyG", "link": "https://stackoverflow.com/users/6791681/jakeyg"}, "is_accepted": true, "score": 0, "last_activity_date": 1521560188, "last_edit_date": 1521560188, "creation_date": 1520422823, "answer_id": 49151037, "question_id": 49150018, "link": "https://stackoverflow.com/questions/49150018/splitting-a-value-that-is-delimitted/49151037#49151037", "title": "Splitting a value that is delimitted", "body": "<p>Morning,</p>\n\n<p>What you need here is to split the entry into an array and then check the values of the array as you loop the array:</p>\n\n<pre><code>Sub SplitString()\n\nDim TempArray() As String\nDim i as Integer\nDim j As Integer\n\n\nFor i = 1 To 10\n\n    TempArray = Split(Worksheets(\"Sheet1\").Cells(i,4).Value,\";\")\n\n    For j = 0 to UBound(TempArray)\n\n        If CDbl(TempArray(j)) &lt;&gt; 0 Then\n\n              [Output value]\n\n        End if\n\n    Next j\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Create a more useful loop than 1 = 1 to 10 but you get the idea...</p>\n\n<p>Note in the above:\n- The CDbl is to ensure that the check reads it as a number and not a text string.</p>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 1, "last_activity_date": 1520428484, "last_edit_date": 1520428484, "creation_date": 1520427527, "answer_id": 49152578, "question_id": 49150018, "link": "https://stackoverflow.com/questions/49150018/splitting-a-value-that-is-delimitted/49152578#49152578", "title": "Splitting a value that is delimitted", "body": "<p>At first we should not loop through all used cells but only the row where these ID2 are that we need, which is a lot faster.</p>\n\n<p>The easiest way would be just to remove all <code>;0</code> and <code>0;</code> then only the value remains. The following will work if there is always only one real value that is not <code>0</code> e.g <code>0;124;0</code>.</p>\n\n<pre><code>Public Sub FindValueRangeInColumn()\n    Const Col As Long = 4   'the column where the ID2 is in\n\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.ActiveSheet\n\n    Dim lRow As Long\n    lRow = ws.Cells(ws.Rows.Count, Col).End(xlUp).Row 'find last used row in column\n\n    Dim iRow As Long\n    For iRow = 2 To lRow 'loop throug rows from 2 to last used row\n        Dim strSource As String\n        strSource = ws.Cells(iRow, Col) 'read value\n\n        strSource = Replace(ws.Cells(iRow, Col), \";0\", \"\") 'remove all ;0\n        If Left$(strSource, 2) = \"0;\" Then strSource = Right$(strSource, Len(strSource) - 2) 'remove 0; from the beginnning\n\n        ws.Cells(iRow, Col + 1).Value = strSource 'write value\n    Next iRow\nEnd Sub\n</code></pre>\n\n<p>If there can be more than 1 non-zero value like <code>0;124;0;222;0;0;144</code> then replace</p>\n\n<pre><code>ws.Cells(iRow, Col + 1).Value = strSource 'write value\n</code></pre>\n\n<p>with a splitting alternative \u2026</p>\n\n<pre><code>    If InStr(1, strSource, \";\") &gt; 1 Then\n        Dim SplitValues As Variant\n        SplitValues = Split(strSource, \";\")\n        Dim iValue As Long\n        For iValue = LBound(SplitValues) To UBound(SplitValues)\n            ws.Cells(iRow, Col + 1 + iValue).Value = SplitValues(iValue) 'write value\n        Next iValue\n    Else\n        ws.Cells(iRow, Col + 1).Value = strSource 'write value\n    End If\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 9456173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cb61e6e6dfc8d67f45daa719e497a69?s=128&d=identicon&r=PG&f=1", "display_name": "GLH", "link": "https://stackoverflow.com/users/9456173/glh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 49151037, "answer_count": 3, "score": 0, "last_activity_date": 1521560188, "creation_date": 1520419626, "last_edit_date": 1531164843, "question_id": 49150018, "link": "https://stackoverflow.com/questions/49150018/splitting-a-value-that-is-delimitted", "title": "Splitting a value that is delimitted", "body": "<p>transactions sheet</p>\n\n<pre><code> ID1  Name Amount ID2 \n 123   A     1   0;124;0 \n 456   B     2   124;0;0  \n 789   C     3   456;0;0\n</code></pre>\n\n<p>transactions sheet (Expected Result)</p>\n\n<pre><code> ID1  Name Amount ID2   Summary\n 123   A     1   0;124;0  124\n 456   B     2   124;0;0  456\n 789   C     3   456;0;0\n</code></pre>\n\n<p>I have tried text to columns but I am unsure on how to ignore all the 0's and only display the value if its >0 in column D. I am new to vba so would appreciate some advice on this so I can learn.</p>\n\n<p>Code:</p>\n\n<pre><code>  Sub SplitRange()\n  Dim cell As Range\n  Dim str As Variant    'string array\n  Dim r   As Integer\n  For Each cel In ActiveSheet.UsedRange\n   If InStr(cell.Value, \";\") &gt; 0 Then 'split\n   str = Split(cell.Value, \";\")\n   For r = LBound(str) To UBound(str)\n   cel.Offset(r).Value = Trim(str(r))\n   If r &lt; UBound(str) Then cell.Offset(r + 1).EntireRow.Insert\n   Next r\n   End If\n  Next cell \n  End Sub\n</code></pre>\n"}, {"tags": ["sql", "vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "edited": false, "score": 1, "creation_date": 1520420028, "post_id": 49149900, "comment_id": 85304470, "body": "Thanks PEH.  Seems obvious now!  I used single quotes though as it was neater - <code>&quot;VALUES (&#39;&quot; &amp; .Cells(1, 1) &amp; &quot;&#39;)&quot;</code>, as per Jeeped&#39;s answer.  Will mark this as correct though."}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 2, "last_activity_date": 1520419316, "creation_date": 1520419316, "answer_id": 49149900, "question_id": 49149776, "link": "https://stackoverflow.com/questions/49149776/number-with-dash-keeps-subtracting-in-transfer/49149900#49149900", "title": "Number with Dash Keeps Subtracting in Transfer", "body": "<p>Because for <code>.Cells(1, 1)</code> beeing <code>1-123456789</code> </p>\n\n<pre><code>conn.Execute \"INSERT INTO dbo.A_MyNos ([No])\" &amp; \"VALUES (\" &amp; .Cells(1, 1) &amp; \")\"\n</code></pre>\n\n<p>evaluates to </p>\n\n<pre><code>INSERT INTO dbo.A_MyNos ([No]) VALUES (1-123456789)\n</code></pre>\n\n<p>so it starts calculating in SQL.</p>\n\n<p>If you want to insert it as a string then the value should be within <code>\"\"</code> like:</p>\n\n<pre><code>INSERT INTO dbo.A_MyNos ([No]) VALUES (\"1-123456789\")\n</code></pre>\n\n<p>Therefore you need to add double <code>\"\"</code> in VBA</p>\n\n<pre><code>conn.Execute \"INSERT INTO dbo.A_MyNos ([No])\" &amp; \"VALUES (\"\"\" &amp; .Cells(1, 1) &amp; \"\"\")\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "edited": false, "score": 0, "creation_date": 1520419862, "post_id": 49149921, "comment_id": 85304367, "body": "Thanks @Jeeped.  The one thing that hadn&#39;t occurred to me!  I haven&#39;t used VBA in ages.  I used the single quotes but the .text property wasn&#39;t necessary.  Upvoted, but marking PEH&#39;s answer as correct for the additional background info, hope you don&#39;t mind."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "edited": false, "score": 0, "creation_date": 1520419989, "post_id": 49149921, "comment_id": 85304445, "body": "No worries. I think he even beat me to the submit button by ~30 seconds as well!"}, {"owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "edited": false, "score": 0, "creation_date": 1520420068, "post_id": 49149921, "comment_id": 85304501, "body": "Well, you were both crazy quick and I appreciate the help."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "edited": false, "score": 2, "creation_date": 1520420070, "post_id": 49149921, "comment_id": 85304503, "body": "btw, the .Text property was just in case custom number formatting was involved for future viewers."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1520419371, "creation_date": 1520419371, "answer_id": 49149921, "question_id": 49149776, "link": "https://stackoverflow.com/questions/49149776/number-with-dash-keeps-subtracting-in-transfer/49149921#49149921", "title": "Number with Dash Keeps Subtracting in Transfer", "body": "<p>Wrap the value in single quotes and use the cell's Text property..</p>\n\n<pre><code>With Sheets(\"Sheet1\")\nconn.Execute \"INSERT INTO dbo.A_MyNos ([No])\" &amp; _\n             \"VALUES ('\" &amp; .Cells(1, 1).Text &amp; \"')\"\nEnd With\n</code></pre>\n\n<p>The [No] fiels should be nvarchar or equivalent.</p>\n"}], "owner": {"reputation": 548, "user_id": 5218153, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/ab284013f377868cf316f69eeb3edae2?s=128&d=identicon&r=PG", "display_name": "Jamsandwich", "link": "https://stackoverflow.com/users/5218153/jamsandwich"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 49149900, "answer_count": 2, "score": 2, "last_activity_date": 1520427763, "creation_date": 1520418956, "last_edit_date": 1520427763, "question_id": 49149776, "link": "https://stackoverflow.com/questions/49149776/number-with-dash-keeps-subtracting-in-transfer", "title": "Number with Dash Keeps Subtracting in Transfer", "body": "<p>I have a sheet in Excel with numbers formatted as text like this -</p>\n\n<blockquote>\n  <p>1-123456789</p>\n</blockquote>\n\n<p>I have written some VBA to transfer this number into an SQL database table as below -</p>\n\n<pre><code>With Sheets(\"Sheet1\")\nconn.Execute \"INSERT INTO dbo.A_MyNos ([No])\" &amp; _\n             \"VALUES (\" &amp; .Cells(1, 1) &amp; \")\"\nEnd With\n</code></pre>\n\n<p>Unfortunately, the number keeps getting inserted into the table as -123456788!  It appears to be running it through as a subtraction formula and I have no idea why.</p>\n\n<p>Could anybody guide me on the correct method to avoid this?</p>\n\n<p>I've also tried changing the cell format and using <code>CStr(.Cells...)</code> in the VBA without success.</p>\n\n<p>Think I'll try to enter the cell as 3 separate strings and concatenate them in the SQL but that seems awkward.</p>\n"}, {"tags": ["vba", "catia"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 9455965, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Diego Blanco", "link": "https://stackoverflow.com/users/9455965/diego-blanco"}, "edited": false, "score": 0, "creation_date": 1520587045, "post_id": 49179171, "comment_id": 85385636, "body": "Thanks! I don&#39;t know how I didn&#39;t find that function before!"}], "tags": [], "owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "is_accepted": true, "score": 0, "last_activity_date": 1520530532, "creation_date": 1520530532, "answer_id": 49179171, "question_id": 49149721, "link": "https://stackoverflow.com/questions/49149721/selecting-partially-bolded-drawingtext-in-catia-drawing-workbench/49179171#49179171", "title": "Selecting partially bolded DrawingText in Catia Drawing workbench", "body": "<p>aText.GetParameterOnSubString(catBold,startPos,numChars)</p>\n\n<p>will return 1 if all the characters in the specifed substring are <strong>Bold</strong>, 0 otherwise. </p>\n\n<p>So first check if your sub-string is in the text by using InStr(aText.Text,subString). and if it is, use this test to see if is in Bold. </p>\n"}], "owner": {"reputation": 105, "user_id": 9455965, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Diego Blanco", "link": "https://stackoverflow.com/users/9455965/diego-blanco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 49179171, "answer_count": 1, "score": 0, "last_activity_date": 1520585891, "creation_date": 1520418791, "last_edit_date": 1520585891, "question_id": 49149721, "link": "https://stackoverflow.com/questions/49149721/selecting-partially-bolded-drawingtext-in-catia-drawing-workbench", "title": "Selecting partially bolded DrawingText in Catia Drawing workbench", "body": "<p>I'm currently developing a Catia vba script to look for specific texts in a plan, within the Drawing workbench.</p>\n\n<p>For this particular macro, I need to search <strong>bold</strong> text. But the thing is I know that the DrawingText object has an attributed called <em>bold</em> that evaluates to True if ALL the text is bolded, but not if just a word is bolded.</p>\n\n<p>Example:</p>\n\n<ul>\n<li><strong>This is my text</strong> -> True</li>\n<li><strong>This</strong> is my text -> False</li>\n</ul>\n\n<p>What would be a good way to indentify this partially bolded DrawingText objects?</p>\n"}, {"tags": ["vba", "csv", "oledb"], "owner": {"reputation": 11, "user_id": 9455888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98c8ca2d7053939f1df890af553763e?s=128&d=identicon&r=PG&f=1", "display_name": "Monika", "link": "https://stackoverflow.com/users/9455888/monika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 379, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1520418259, "creation_date": 1520417859, "last_edit_date": 1520418259, "question_id": 49149381, "link": "https://stackoverflow.com/questions/49149381/vba-provider-microsoft-ace-oldedb-12-0-for-csv-file-and-sum-of-values-in-column", "title": "VBA Provider Microsoft.ACE.OLDEDB.12.0 for CSV file and sum of values in column doesn&#39;t work", "body": "<p>I have problem with sql query for some columns. \nIn VBA I use this code for opening database:</p>\n\n<pre><code> db.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;\" &amp; \"Data Source=\" &amp; Dirname(Name) &amp; \";\" &amp; \"Extended Properties=\"\"text;HDR=YES;FMT=CSVDelimited;MaxScanRows=0\"\"\"\n</code></pre>\n\n<p>And in sql query I want to sum column <em>mv</em> according to <em>group</em> (AFS or HTM) with corresponding <em>time</em> - and it works.</p>\n\n<p>But for column <em>sold</em> it doesn't work - probably this column looks like string column instead of value/double because in first aproximately 1000 rows nothing or zero is. I tried to solve it with different ways, e.g. MaxScanRows=0 or IMEX=1, or schema.ini but it doesn't work...</p>\n\n<p>Example of csv file:\n<a href=\"https://i.stack.imgur.com/zSozX.jpg\" rel=\"nofollow noreferrer\"></a></p>\n\n<p>Thanks in advance for any advice</p>\n"}, {"tags": ["arrays", "vba", "loops", "select"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 9434411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997f6ad445d73ca952e97965a8afe8f2?s=128&d=identicon&r=PG&f=1", "display_name": "karen", "link": "https://stackoverflow.com/users/9434411/karen"}, "edited": false, "score": 0, "creation_date": 1520503550, "post_id": 49150106, "comment_id": 85345864, "body": "Haha, I spent so many hours and tried so many things, except this simple line. Thank you so much!"}, {"owner": {"reputation": 377, "user_id": 8249645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ce2465fde8b4c0779205788997b91f?s=128&d=identicon&r=PG", "display_name": "sporc", "link": "https://stackoverflow.com/users/8249645/sporc"}, "reply_to_user": {"reputation": 5, "user_id": 9434411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997f6ad445d73ca952e97965a8afe8f2?s=128&d=identicon&r=PG&f=1", "display_name": "karen", "link": "https://stackoverflow.com/users/9434411/karen"}, "edited": false, "score": 0, "creation_date": 1520504155, "post_id": 49150106, "comment_id": 85346235, "body": "If it helped you, please consider to accept this as the answer. <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>"}], "tags": [], "owner": {"reputation": 377, "user_id": 8249645, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83ce2465fde8b4c0779205788997b91f?s=128&d=identicon&r=PG", "display_name": "sporc", "link": "https://stackoverflow.com/users/8249645/sporc"}, "is_accepted": true, "score": 0, "last_activity_date": 1520419921, "creation_date": 1520419921, "answer_id": 49150106, "question_id": 49149337, "link": "https://stackoverflow.com/questions/49149337/keep-selection-through-all-loops-vba/49150106#49150106", "title": "Keep selection through all loops vba", "body": "<p>You can use the Slides.Range Method with your Array. The following example selects the slides 1, 4 and 5:</p>\n\n<pre><code>Sub SlideRangeExample()\n\n    Dim SlideArray(3) As Integer\n\n    SlideArray(1) = 5\n    SlideArray(2) = 1\n    SlideArray(3) = 4\n\n    ActivePresentation.Slides.Range(SlideArray).Select\n\nEnd Sub\n</code></pre>\n\n<p>So in your case just replace the <code>SlideArray</code> with your array <code>arr</code>:</p>\n\n<pre><code>ActivePresentation.Slides.Range(arr).Select\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9434411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997f6ad445d73ca952e97965a8afe8f2?s=128&d=identicon&r=PG&f=1", "display_name": "karen", "link": "https://stackoverflow.com/users/9434411/karen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 49150106, "answer_count": 1, "score": 0, "last_activity_date": 1520419921, "creation_date": 1520417734, "question_id": 49149337, "link": "https://stackoverflow.com/questions/49149337/keep-selection-through-all-loops-vba", "title": "Keep selection through all loops vba", "body": "<p>How can I select all slides whose ranges are stored in an array? With a loop it begins all over so only one slide is selected at once. How can I select several specified slides (i.e. the ones with the ranges from the array) with a code? Thank you so much!</p>\n\n<pre><code>ReDim arr(1 To 1) As Long    \nDim b As Long    \nFor b = LBound(arr) To UBound(arr)\nActivePresentaiton.Slides.Range(arr(b)).Select\nNext\n</code></pre>\n"}, {"tags": ["vba", "excel-formula", "countif"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 1, "creation_date": 1520415680, "post_id": 49148466, "comment_id": 85301614, "body": "can you please show us your code?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1520418467, "post_id": 49148466, "comment_id": 85303405, "body": "I&#39;ll show you how to do this quickly (the easy way, without VBA) but I need to know, what happens if the value is <code>5</code>?  <b>Should it be counted a <code>0 to 5</code> or <code>5 to 10</code>, or <i>both</i></b>?  If you require an answer with VBA, it&#39;s important that you show the code you&#39;ve tried so far.  (See &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; as well as &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot; and also <a href=\"https://codeblog.jonskeet.uk/2010/08/29/writing-the-perfect-question/\" rel=\"nofollow noreferrer\">these tips</a>.)"}], "answers": [{"tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1520422021, "last_edit_date": 1520422021, "creation_date": 1520420114, "answer_id": 49150170, "question_id": 49148466, "link": "https://stackoverflow.com/questions/49148466/how-to-connect-the-code-in-excel-sheet/49150170#49150170", "title": "How to connect the code in excel sheet", "body": "<p><sup>(See below to download sample file.)</sup></p>\n\n<p>You could do it easier without VBA like this:  </p>\n\n<p><a href=\"https://i.stack.imgur.com/u1Rg6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u1Rg6.png\" alt=\"screenshot example\"></a></p>\n\n<h2>The formula in <code>E4</code> is:</h2>\n\n<pre><code>=COUNTIFS($A$1:$A$15,\"=\"&amp;$D4,$B$1:$B$15,\"&gt;=\" &amp;E$2,$B$1:$B$15,\"&lt;=\"&amp;E$3)\n</code></pre>\n\n<p>...but if you <em>need</em> to do this in VBA for some reason, you can do basically the same thing with a few syntax changes:</p>\n\n<p>This would give the same value as <code>E4</code>:</p>\n\n<pre><code>MsgBox Application.WorksheetFunction.CountIfs(Range(\"A1:A15\"), Range(\"D4\"), _\n    Range(\"B1:B15\"), \"&gt;=\" &amp; Range(\"E2\"), Range(\"B1:B15\"), \"&lt;=\" &amp; Range(\"E3\"))\n</code></pre>\n\n<hr>\n\n<p>Or, instead of specifying the ranges directly in the formula (like if you were planning on looping through the cells or specifying individuals):</p>\n\n<pre><code>Sub test()\n    Dim ws As Worksheet\n    Dim lowerLimit As Range, upperLimit As Range, findName As Range\n    Dim rangeNames As Range, rangeValues As Range\n\n    Set ws = Worksheets(\"Sheet1\")\n    Set lowerLimit = ws.Range(\"E2\") 'or specify actual values instead of \"Range\"'s\n    Set upperLimit = ws.Range(\"E3\")\n    Set findName = ws.Range(\"D4\")\n    Set rangeNames = ws.Range(\"A1:A15\")\n    Set rangeValues = ws.Range(\"B1:B15\")\n    MsgBox Application.WorksheetFunction.CountIfs(rangeNames, findName, rangeValues, _\n        \"&gt;=\" &amp; lowerLimit, rangeValues, \"&lt;=\" &amp; upperLimit)\nEnd Sub\n</code></pre>\n\n<hr>\n\n<h1>Download Sample File:</h1>\n\n<ul>\n<li><p>You <em>can</em> view sample file used above on <a href=\"http://jmp.sh/KUMKaYV\" rel=\"nofollow noreferrer\">JumpShare here</a>, but <code>COUNTIFS</code> and VBA is not supported in the online viewer.</p></li>\n<li><p>The Jumpshare page also has a download link, or <a href=\"https://storage.jumpshare.com/dl/dWIIQW68ArubfzlBMybl5Z9QqM-Y-bA510tJslmIBbVIeyCYq4mLadTX_wdjQsozKz5CftbsKuZk2J6ZyMoHWA?s=7973783efa82beac9728704c89d88fe9ca5c3dc0&amp;dl=1\" rel=\"nofollow noreferrer\">direct link here</a>.  Note that the file contains VBA so you may get an \"unknown code\" (etc) warning.</p></li>\n</ul>\n\n<hr>\n\n<h1>More Information:</h1>\n\n<ul>\n<li><p>Office.com : <strong><a href=\"https://support.office.com/en-us/article/countifs-function-dda3dc6e-f74e-4aee-88bc-aa8c2a866842\" rel=\"nofollow noreferrer\">COUNTIFS Function (Excel)</a></strong></p></li>\n<li><p>Excejet : <strong><a href=\"https://exceljet.net/excel-functions/excel-countifs-function\" rel=\"nofollow noreferrer\">Excel COUNTIFS Function</a></strong></p></li>\n<li><p>MSDN : <strong><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-countifs-method-excel\" rel=\"nofollow noreferrer\">WorksheetFunction.CountIfs Method (Excel/VBA)</a></strong></p></li>\n<li><p>Stack Overflow : <strong><a href=\"https://stackoverflow.com/a/18588144/8112776\">Count unique values in a column in Excel</a></strong></p></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 9455752, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3lU-53KdS8w/AAAAAAAAAAI/AAAAAAAAIXI/uouO_qJeKk8/photo.jpg?sz=128", "display_name": "Anil Kumar", "link": "https://stackoverflow.com/users/9455752/anil-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1520502971, "creation_date": 1520415250, "last_edit_date": 1520418065, "question_id": 49148466, "link": "https://stackoverflow.com/questions/49148466/how-to-connect-the-code-in-excel-sheet", "title": "How to connect the code in excel sheet", "body": "<p>Can anybody help me, I'm trying to find out the age band of listed codes, using the VBA <code>CountIfs</code> function with the data shown below? .</p>\n\n<p><strong>Age band of the codes:</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/aAjkH.png\" alt=\"Age band of the codes\"></p>\n"}, {"tags": ["vba", "excel", "dynamic", "excel-r1c1-notation"], "comments": [{"owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 3, "creation_date": 1520415401, "post_id": 49148411, "comment_id": 85301426, "body": "you can use Pivot table also to achieve this"}, {"owner": {"reputation": 174, "user_id": 4879852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/745c8cc78511116e32f0fb509deabb6c?s=128&d=identicon&r=PG", "display_name": "Aliakbar Ahmadi", "link": "https://stackoverflow.com/users/4879852/aliakbar-ahmadi"}, "reply_to_user": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 0, "creation_date": 1520415734, "post_id": 49148411, "comment_id": 85301650, "body": "Thanks! That worked fine - still it would be interesting to know a VBA dynamic code :)"}, {"owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "edited": false, "score": 1, "creation_date": 1520416100, "post_id": 49148411, "comment_id": 85301875, "body": "Could you not use <code>AVERAGEIF</code> to do this?"}, {"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "reply_to_user": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "edited": false, "score": 1, "creation_date": 1520416812, "post_id": 49148411, "comment_id": 85302355, "body": "As a solution to what you are looking for, I would go with @Maddy and @Tom suggestions. On the other hand if you want to do this just so that you can get some practice on VBA.. it&#39;s a good start. Here are some pointer: I would use a <code>FOR</code> loop instead of a <code>DO</code> loop. Search on how you can get the last row in a sheet (there are plenty of examples). Also, your <code>IF</code> statement inside the loop can use <code>Offset</code>. Good luck"}], "answers": [{"tags": [], "owner": {"reputation": 721, "user_id": 7889129, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0oYIA.jpg?s=128&g=1", "display_name": "Maddy", "link": "https://stackoverflow.com/users/7889129/maddy"}, "is_accepted": false, "score": 0, "last_activity_date": 1520417958, "last_edit_date": 1520417958, "creation_date": 1520417612, "answer_id": 49149291, "question_id": 49148411, "link": "https://stackoverflow.com/questions/49148411/dynamic-range-selection-with-a-relative-reference-r1c1-in-a-loop/49149291#49149291", "title": "Dynamic Range Selection with a relative reference (R1C1) in a Loop", "body": "<p>If you still want to do this in VBA, then</p>\n\n<p>1.Copy column A unique values in new column</p>\n\n<p>2.then use AVERAGEIF formula to calculate</p>\n\n<p>For example:\nBelow code copies unique dates from column <code>A</code> and paste it in column <code>G</code> and calculate avg using <code>AVERAGEIF</code> formula in column <code>H</code></p>\n\n<pre><code>    Sub getAvg()\n    Set ws = ThisWorkbook.Sheets(\"Sheet1\")\n    lastRow = ws.Range(\"A60000\").End(xlUp).Row ' Last Row number in Column A\n    'ws.Range(\"G1\").Value = \"Dates\"\n    ws.Range(\"H1\").Value = \"Avg\"\n    ws.Range(\"A1:A\" &amp; lastRow).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=ws.Range(\"G1\"), Unique:=True ' copy unique values using AdvancedFilter \n    lastRowNewTble = ws.Range(\"G60000\").End(xlUp).Row ' Last Row number in Column G\n    ws.Range(\"H2:H\" &amp; lastRowNewTble).Formula = \"=AVERAGEIF(A2:A\" &amp; lastRow &amp; \",G2,E2:E\" &amp; lastRow &amp; \")\" ' write formula in column G\n    End Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9435009, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/67a62eb2404fc9efc665303ec3f6fbe2?s=128&d=identicon&r=PG", "display_name": "user9435009", "link": "https://stackoverflow.com/users/9435009/user9435009"}, "is_accepted": false, "score": 0, "last_activity_date": 1520430244, "creation_date": 1520430244, "answer_id": 49153408, "question_id": 49148411, "link": "https://stackoverflow.com/questions/49148411/dynamic-range-selection-with-a-relative-reference-r1c1-in-a-loop/49153408#49153408", "title": "Dynamic Range Selection with a relative reference (R1C1) in a Loop", "body": "<p>If you don't want to use filters, you can try with loops. This code will calculate averages for the ranges and put them in F column:</p>\n\n<pre><code>Dim unqDateDict As Scripting.Dictionary\nDim lastRow As Integer\nDim i As Integer\nDim count As Integer\nDim currDate As String\n\nSet unqDateDict = New Scripting.Dictionary\n\nlastRow = Cells.SpecialCells(xlCellTypeLastCell).Row\ncount = -1\n\n'Fill dictionary with unique dates\nFor i = 1 To lastRow\n    currDate = Range(\"A\" &amp; i).Value\n    If Not unqDateDict.Exists(currDate) Then\n        unqDateDict.Add currDate, count\n        count = count + 1\n    End If\nNext\n\n'Calculate averages\nDim tempSum As Integer\nDim keyIndex As Integer\nDim loopIndex As Integer\nDim loopCounter As Integer\nDim Key\nloopIndex = 1\nkeyIndex = 1\nloopCounter = 0\nFor Each Key In unqDateDict.Keys\n    For i = loopIndex To lastRow\n        If CStr(Range(\"A\" &amp; loopIndex).Value) = Key Then\n            tempSum = tempSum + Range(\"E\" &amp; loopIndex).Value\n            loopIndex = loopIndex + 1\n            loopCounter = loopCounter + 1\n        Else\n            Range(\"F\" &amp; keyIndex) = tempSum / loopCounter\n            loopCounter = 0\n            tempSum = 0\n            keyIndex = keyIndex + 1\n            Exit For\n        End If\n    Next\n\nNext Key\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 174, "user_id": 4879852, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/745c8cc78511116e32f0fb509deabb6c?s=128&d=identicon&r=PG", "display_name": "Aliakbar Ahmadi", "link": "https://stackoverflow.com/users/4879852/aliakbar-ahmadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1060, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1520430244, "creation_date": 1520415093, "last_edit_date": 1520415516, "question_id": 49148411, "link": "https://stackoverflow.com/questions/49148411/dynamic-range-selection-with-a-relative-reference-r1c1-in-a-loop", "title": "Dynamic Range Selection with a relative reference (R1C1) in a Loop", "body": "<p>I have an excel sheet (examplary extract below) and would like to achieve following with my VBA code (I am a total newbie to VBA).</p>\n\n<ul>\n<li>Go through all rows in coloumn A</li>\n<li>Calculate Average value for range in column E with identical dates (column A)</li>\n<li>generate a new table with rows: dates; col: average values and create table in a new worksheet.</li>\n</ul>\n\n<p><strong>Important Note:</strong></p>\n\n<ul>\n<li>Ranges can have different number of rows depending on the number of values (E) for a date (A)</li>\n</ul>\n\n<p>As a starting point I have following VBA Code:</p>\n\n<pre><code>1 Sub GotoNewState()\n\n3 Dim i As Integer\n4 Dim startRange As Integer\n5 i = 0\n\n7 Do\n8     i = i + 1\n9     If Cells(ActiveCell.Row + i, ActiveCell.Column).Value &lt;&gt; ActiveCell.Value Then\n10         Cells(ActiveCell.Row + i, ActiveCell.Column).Select\n11        startRange = -(i - 1)\n12         'MsgBox startRange\n13        ActiveCell.Offset(-1, 5).FormulaR1C1 = \"=AVERAGE(\"R[\" &amp; startRange &amp; \"]C[-1]\":RC[-1])\"\n14         Exit Do\n15    End If\n16 Loop\n\n18 End Sub\n</code></pre>\n\n<p>However I have problems with the syntax for R1C1 notation as the argument I want to pass to R[argument] returns an error.</p>\n\n<p>I would be happy about other solutions to my described intention above.</p>\n\n<p>Extract from Excel:</p>\n\n<pre><code>A          B C   D    E\n13.03.2015 1 300 5.00 0\n13.03.2015 2 300 5.00 40\n13.03.2015 3 300 5.00 4\n13.03.2015 4 300 5.00 2\n13.03.2015 5 300 5.00 2\n13.03.2015 6 300 5.00 22\n20.03.2015 6 300 5.00 0\n20.03.2015 5 300 5.00 14\n20.03.2015 1 300 5.00 1\n20.03.2015 2 300 5.00 0\n20.03.2015 3 300 5.00 0\n20.03.2015 4 300 5.00 0\n27.03.2015 3 300 5.00 0\n27.03.2015 4 300 5.00 3\n27.03.2015 2 300 5.00 15\n27.03.2015 6 300 5.00 147\n27.03.2015 5 300 5.00 14\n27.03.2015 1 300 5.00 0\n02.04.2015 1 300 5.00 8\n02.04.2015 2 300 5.00 0\n02.04.2015 3 300 5.00 63\n02.04.2015 4 300 5.00 0\n02.04.2015 5 300 5.00 0\n02.04.2015 6 300 5.00 3\n17.04.2015 1 300 5.00 7\n17.04.2015 2 300 5.00 1\n17.04.2015 3 300 5.00 19\n17.04.2015 4 300 5.00 0\n17.04.2015 5 300 5.00 159\n17.04.2015 6 300 5.00 84\n30.04.2015 1 300 5.00 0\n30.04.2015 2 300 5.00 0\n30.04.2015 3 300 5.00 2\n30.04.2015 3 300 5.00 2\n30.04.2015 4 300 5.00 0\n30.04.2015 5 300 5.00 182\n30.04.2015 6 300 5.00 2\n... \n</code></pre>\n"}, {"tags": ["sql", "sql-server", "vba", "parameters"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "edited": false, "score": 0, "creation_date": 1520414711, "post_id": 49148125, "comment_id": 85300999, "body": "I agree at the moment it is. I, unfortunately, do not have access to the DB...so I am forced to try to improve the above and place input checks in the s/s plus lock the VBA code. Not ideal...but I have no choice."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "edited": false, "score": 0, "creation_date": 1520415216, "post_id": 49148125, "comment_id": 85301313, "body": "how do I parametrise this above properly? I have been searching the net and only really come up with <a href=\"https://www.mssqltips.com/sqlservertip/2981/using-parameters-for-sql-server-queries-and-stored-procedures/\" rel=\"nofollow noreferrer\">mssqltips.com/sqlservertip/2981/&hellip;</a> but that doesn&#39;t help me beyond what I already know."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "edited": false, "score": 0, "creation_date": 1520416231, "post_id": 49148125, "comment_id": 85301958, "body": "perhaps I need a  Parameter Object?"}, {"owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "edited": false, "score": 1, "creation_date": 1520416389, "post_id": 49148125, "comment_id": 85302059, "body": "Declare the parameter in vba, then your sql string would be sp_executesql([function],[parameters])"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "edited": false, "score": 0, "creation_date": 1520416588, "post_id": 49148125, "comment_id": 85302215, "body": "sorry to be tedious, do you have an example?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "edited": false, "score": 0, "creation_date": 1520417235, "post_id": 49148125, "comment_id": 85302607, "body": "<a href=\"https://www.sqlskills.com/blogs/kimberly/exec-and-sp_executesql-how-are-they-different/\" rel=\"nofollow noreferrer\">sqlskills.com/blogs/kimberly/&hellip;</a> a good site"}], "tags": [], "owner": {"reputation": 1112, "user_id": 7354796, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7efd450f69bda421b8348f3f694ae621?s=128&d=identicon&r=PG&f=1", "display_name": "OwlsSleeping", "link": "https://stackoverflow.com/users/7354796/owlssleeping"}, "is_accepted": false, "score": 0, "last_activity_date": 1520414306, "creation_date": 1520414306, "answer_id": 49148125, "question_id": 49147506, "link": "https://stackoverflow.com/questions/49147506/query-db-from-vba-with-parameterisation/49148125#49148125", "title": "Query DB from VBA with parameterisation", "body": "<p>The best way is to build the stored procedure on the server, then pass the parameters. It's definitely open to injection as-is.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "edited": false, "score": 0, "creation_date": 1520423301, "post_id": 49150986, "comment_id": 85306493, "body": "Cheers Dan. Appreciated"}], "tags": [], "owner": {"reputation": 34977, "user_id": 3711162, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7XKVx.png?s=128&g=1", "display_name": "Dan Guzman", "link": "https://stackoverflow.com/users/3711162/dan-guzman"}, "is_accepted": true, "score": 1, "last_activity_date": 1520422679, "creation_date": 1520422679, "answer_id": 49150986, "question_id": 49147506, "link": "https://stackoverflow.com/questions/49147506/query-db-from-vba-with-parameterisation/49150986#49150986", "title": "Query DB from VBA with parameterisation", "body": "<p>First, parameterize the query string by using ? parameter tokens (for OLE DB and ODBC drivers) instead of string literals. Note parameter values within the query string are not enclosed in quotes. I enclosed the <code>group</code> column name in square brackets because it is a reserved SQL keyword and doesn't conform to the rules for identifiers. </p>\n\n<pre><code> strSql = \"SELECT MIN([results].run_id) \" &amp; _\n         \"FROM [results] \" &amp; _\n         \"inner join [official_run_table] on ([results].run_id=[official_run_table].run_id and [official_run_table].run_type_id='1' )\" &amp; _\n         \" WHERE Info = ?\" &amp; _\n         \" AND two = ?\" &amp; _\n         \" AND [group] = ?\" &amp; _\n         \" AND [results].date between ? and ?;\"\n</code></pre>\n\n<p>The example below uses a ADODB.Command object and adds parameters to the query. I guessed at your actual data types so change the parameter types and lengths to match your actual table schema. This is one of many ways to accomplish this task but should get you started. See the <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/command-object-ado\" rel=\"nofollow noreferrer\">ADODB Command reference</a> for more information and examples.</p>\n\n<pre><code>Set parmInfo = command.CreateParameter(\"@Info\", adVarChar, adParamInput, 10, strinfo)\nSet parmInfoTwo = command.CreateParameter(\"@InfoTwo\", adVarChar, adParamInput, 10, strinfotwo)\nSet parmGroup = command.CreateParameter(\"@Group\", adVarChar, adParamInput, 10, strgroup)\nSet parmMinDate = command.CreateParameter(\"@MinDate\", adDBTimeStamp, adParamInput, , strDate)\nSet parmMaxDate = command.CreateParameter(\"@MaxDate\", adDBTimeStamp, adParamInput, , strDatetwo)\n\ncommand.Parameters.Append(parmInfo)\ncommand.Parameters.Append(parmInfoTwo)\ncommand.Parameters.Append(parmGroup)\ncommand.Parameters.Append(parmMinDate)\ncommand.Parameters.Append(parmMaxDate)\n\nSet rst = command.Execute()\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6089076"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 49150986, "answer_count": 2, "score": 1, "last_activity_date": 1520422679, "creation_date": 1520412291, "last_edit_date": 1520413918, "question_id": 49147506, "link": "https://stackoverflow.com/questions/49147506/query-db-from-vba-with-parameterisation", "title": "Query DB from VBA with parameterisation", "body": "<p>I am attempting to query a DB from VBA, in order to avoid such issues a SQL injection I have been told I should parametrise the SQL string of code. The code I have at the moment, which returns no error, but no result either (!) is:</p>\n\n<pre><code>Sub ImportData_Click()\n\n\nDim strSql As String\nDim strDate As String\nDim StrDatetwo As String\nDim strinfo As String\nDim strinfotwo As String\nDim strgroup As String\nDim objConn As ADODB.Connection\nSet objConn = New ADODB.Connection\nDim rst As New ADODB.Recordset\nDim ConnectionString As String\n\n'Parameters\nstrDate = Format(Range(\"Date\"), \"DDMMMYY\")\nStrDatetwo = Format(Range(\"Datetwo\"), \"DDMMMYY\")\nstrinfo = \"someinfo\"\nstrinfotwo = \"total\"\nstrgroup = \"total\"\n\n'open connection\nConnectionString = \"Provider=name ;Data Source=name;Initial Catalog=name;Integrated Security=SSPI\"\nobjConn.Open ConnectionString\n\n'SQL string\n strSql = \"Declare @mindate date,\" &amp; _\n                  \"@maxdate date \" &amp; _\n         \"set @mindate ='\" &amp; strDate &amp; _\n         \"'; set @maxdate ='\" &amp; StrDatetwo &amp; _\n         \"'; SELECT MIN([results].run_id) \" &amp; _\n         \"FROM [results] \" &amp; _\n         \"inner join [official_run_table] on ([results].run_id=[official_run_table].run_id and [official_run_table].run_type_id='1' )\" &amp; _\n         \" WHERE Info ='\" &amp; strinfo &amp; _\n         \"' and two ='\" &amp; strinfotwo &amp; _\n         \"' and group= '\" &amp; strgroup &amp; _\n         \"' AND [results].date between @mindate and @maxdate\"\n\n'MsgBox strSQL '- to check data\n\nrst.Open strSql, objConn\n\n\nIf Not rst.EOF Then\nWorksheets(\"Reference\").Range(\"E2\").CopyFromRecordset rst\nrst.Close\nElse\nMsgBox \"Error: No records returned.\", vbCritical\nEnd If\n\n\n'Clean up\n objConn.Close\n Set objConn = Nothing\n Set rst = Nothing\n\n End Sub \n</code></pre>\n\n<p>No error but no result would imply no values exist in the DB for this query, but I know otherwise!\nIt is my intention to a parametrise strinfo, strinfotwo, strgroup as well, but first I would like to get the above working. How am I getting this wrong? Thanks in advance</p>\n"}, {"tags": ["vba", "excel", "userform", "date-formatting"], "comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1520411530, "post_id": 49147239, "comment_id": 85299166, "body": "Does this occur to all cells or only those in columns <code>N, O</code>?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520411702, "post_id": 49147239, "comment_id": 85299260, "body": "Generally formatting is best done in the sheet I believe with dates. You could try ws.Cells(MyNR, 14) = Format$(TextBox1.value,&quot;dd/mm/yyyy&quot;)? The unambiguous date format to use is yyyy-mm-dd"}, {"owner": {"reputation": 27, "user_id": 9378654, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Diego Ali", "link": "https://stackoverflow.com/users/9378654/diego-ali"}, "edited": false, "score": 0, "creation_date": 1520411952, "post_id": 49147239, "comment_id": 85299384, "body": "Those are the only columns containing dates. Changed it so it saves the data in other columns and the same happens."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520412204, "post_id": 49147239, "comment_id": 85299518, "body": "Have you formatted the columns with the desired date format?"}, {"owner": {"reputation": 27, "user_id": 9378654, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Diego Ali", "link": "https://stackoverflow.com/users/9378654/diego-ali"}, "edited": false, "score": 0, "creation_date": 1520412461, "post_id": 49147239, "comment_id": 85299666, "body": "Yes, the problem is that it also changes the month value as day and day as month, so it doesn&#39;t matter with format I chose."}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1520412679, "post_id": 49147239, "comment_id": 85299791, "body": "@DiegoAli Did you try <code>ws.Cells(MyNR, 14) = CDate(TextBox1.Value)</code>?"}, {"owner": {"reputation": 27, "user_id": 9378654, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Diego Ali", "link": "https://stackoverflow.com/users/9378654/diego-ali"}, "edited": false, "score": 0, "creation_date": 1520412965, "post_id": 49147239, "comment_id": 85299959, "body": "Sorry I made a mistake, it didn&#39;t actually change the format it took the day values as month and vice versa."}, {"owner": {"reputation": 27, "user_id": 9378654, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Diego Ali", "link": "https://stackoverflow.com/users/9378654/diego-ali"}, "edited": false, "score": 0, "creation_date": 1520413092, "post_id": 49147239, "comment_id": 85300035, "body": "ws.Cells(MyNR, 14) = CDate(TextBox1.Value) worked perfectly! Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520412956, "post_id": 49147603, "comment_id": 85299954, "body": "I find CDate can also still output US format at times unless what goes in is unambiguous as yyyy-mm-dd. Or have I got that wrong?"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1520413041, "post_id": 49147603, "comment_id": 85300005, "body": "@QHarr CDate uses your regional settings. Unless you have those set to US format, I have never seen it do what you describe."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520413073, "post_id": 49147603, "comment_id": 85300027, "body": "Ah.. it is entirely possible my IT dept has it set as US. We get frequent installs that don&#39;t always align."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520413246, "post_id": 49147603, "comment_id": 85300129, "body": "#note2selfadded"}], "tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": true, "score": 0, "last_activity_date": 1520412668, "creation_date": 1520412668, "answer_id": 49147603, "question_id": 49147239, "link": "https://stackoverflow.com/questions/49147239/vba-userform-error-date-values-change-months-as-days-and-days-as-months/49147603#49147603", "title": "VBA: Userform Error date values change - months as days and days as months", "body": "<p>Use <code>CDate</code> to convert the text to a real date value:</p>\n\n<pre><code>ws.Cells(MyNR, 14).Value = CDate(TextBox1.value)\nws.Cells(MyNR, 15).Value = CDate(TextBox2.value)\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 9378654, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Diego Ali", "link": "https://stackoverflow.com/users/9378654/diego-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "accepted_answer_id": 49147603, "answer_count": 1, "score": 1, "last_activity_date": 1520412858, "creation_date": 1520411279, "last_edit_date": 1531164843, "question_id": 49147239, "link": "https://stackoverflow.com/questions/49147239/vba-userform-error-date-values-change-months-as-days-and-days-as-months", "title": "VBA: Userform Error date values change - months as days and days as months", "body": "<p>I'm using this <a href=\"https://sites.google.com/site/e90e50/calendar-control-class\" rel=\"nofollow noreferrer\">calendar</a> in my userform to enter dates in Textbox1. It works fine within the userform (format \"dd/mm/yyyy\") - no problem either filling dates directly to an active cell.</p>\n\n<p>The problem comes when passing the data from the userform to the worksheet. The date format stays \"dd/mm/yyyy\" but Changing the day value as month and month as day ( March 1 becomes january 3).</p>\n\n<pre><code>ws.Cells(MyNR, 1) = tbFi.Value\nws.Cells(MyNR, 2) = tbNh.Value\nws.Cells(MyNR, 3) = tbTh.Value\nws.Cells(MyNR, 4) = cbN1.Value\nws.Cells(MyNR, 5) = cbPoc.Value\nws.Cells(MyNR, 6) = cbNa1.Value\nws.Cells(MyNR, 7) = cbPoca1.Value\nws.Cells(MyNR, 8) = cbNa2.Value\nws.Cells(MyNR, 9) = cbPoca2.Value\nws.Cells(MyNR, 10) = cbNa3.Value\nws.Cells(MyNR, 11) = cbPoca3.Value\nws.Cells(MyNR, 12) = cbNa4.Value\nws.Cells(MyNR, 13) = cbPoca4.Value\nws.Cells(MyNR, 14) = TextBox1.value\n   'ws.Cells(mynr, 14).NumberFormat = \"dd/mm/yyyy\" not working\nws.Cells(MyNR, 15) = TextBox2.value\n    'ws.Cells(mynr, 15).NumberFormat = \"dd/mm/yyyy\"\nws.Cells(MyNR, 16) = cbQac.Value\n</code></pre>\n"}, {"tags": ["vba", "excel", "adodb", "recordset"], "comments": [{"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1520425443, "post_id": 49147066, "comment_id": 85307894, "body": "Missing spaces in the SQL, e.g you end up with <code>tblManhoursWHERE</code> although I would not think that would raise that specific error."}, {"owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1520425587, "post_id": 49147066, "comment_id": 85307997, "body": "You are using late binding (CreateObject) so unless you have added a reference to the ADODB library all enums like adUseClient don&#39;t have the correct values.  Consider early binding &amp; option explicit."}, {"owner": {"reputation": 57, "user_id": 9384311, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aimee", "link": "https://stackoverflow.com/users/9384311/aimee"}, "reply_to_user": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "edited": false, "score": 0, "creation_date": 1520478639, "post_id": 49147066, "comment_id": 85334946, "body": "Thanks @AlexK. I think it might be caused by a combination of errors. It works after I changed it to early binding, change my sql statements to &quot;SELECT * FROM tblManhours WHERE [Dept No] in (&#39;OPS&#39;, &#39;FIN&#39;)&quot; and define the rs cursor properties. Although I&#39;m not completely sure of the reasoning behind it."}], "owner": {"reputation": 57, "user_id": 9384311, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Aimee", "link": "https://stackoverflow.com/users/9384311/aimee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 591, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1520425745, "creation_date": 1520410563, "last_edit_date": 1531164843, "question_id": 49147066, "link": "https://stackoverflow.com/questions/49147066/automation-error-vba", "title": "Automation error (vba)", "body": "<p>I have an issue with Automation error when I try to run my code in VBA. My ADODB connection is declared as public in a module so that I could use the same connection for several SQL statements.</p>\n\n<p>My 1st SQL statement and recordset('rs1') works fine but my 2nd recordset('mainRS') gave me an Automation error and I'm not sure which part went wrong.</p>\n\n<p>Can anyone help, please? Thank you!!</p>\n\n<pre><code>Public Sub MainConDef(DBPath As String)                  'DBPath as global\n    Set dsConnect = CreateObject(\"ADODB.Connection\")     'dsConnect, cmdCommand, rs declared as global\n    Set cmdCommand = CreateObject(\"ADODB.Command\")\n    Set rs1 = CreateObject(\"ADODB.Recordset\")\n\n    dsConnect.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; DBPath &amp; _\n      \";JET OLEDB:Database Password=xxxxxxxxxxxx\" &amp; \";Mode=Read|Write\"\n\n    dsConnect.CursorLocation = adUseClient\n\n    dsConnect.Open\n\n    With cmdCommand\n        .ActiveConnection = dsConnect\n        .CommandText = \"SELECT * FROM tblManhours;\"\n        .CommandType = adCmdText\n    End With\n\n    With rs1\n        .CursorType = adOpenStatic\n        .CursorLocation = adUseClient\n        .LockType = adLockOptimistic\n        .Open cmdCommand\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Private Sub Workbook_Open()\n    Dim i, j, k As Integer\n\n    DBPath = \"D:\\DbManHours.accdb\"\n    MainConDef (DBPath)\n\n    Sheet1.Range(\"A2\").CopyFromRecordset rs1\n\n    OverallData (DBPath)\n\n    Sheets(\"Sheet2\").Activate\n    Sheet2.Range(\"B2\").CopyFromRecordset mainRS\n\n    mainRS.Close\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Public Sub OverallData(DBPath As String)\n    Dim cmd1 As Object\n\n    Set cmd1 = CreateObject(\"ADODB.Command\")\n    Set mainRS = CreateObject(\"ADODB.Recordset\")       'mainRS declared as global\n\n    dsConnect.CursorLocation = adUseClient\n\n    If Not (dsConnect Is Nothing) Then\n        If (dsConnect.State = adStateClosed) Then dsConnect.Open\n    End If\n\n    cmd1.ActiveConnection = dsConnect\n    cmd1.CommandText = \"SELECT * FROM tblManhours\" &amp; _\n        \"WHERE tblManhours[Dept No]=OPS\" &amp; _\n        \"AND tblManhours[Dept No]=FIN\" &amp; _\n        \"AND (tblManhours[Type]) NOT IN ('F', 'N')\"\n\n   Set mainRS = cmd1.Execute    '&lt;-- Automation error occurs here\n\n   Sheet2.Range(\"B2\").CopyFromRecordset mainRS\n\n   mainRS.Close\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "ms-word"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 1, "creation_date": 1520413845, "post_id": 49147054, "comment_id": 85300456, "body": "What you haven&#39;t said is what&#39;s the problem? You mention that you have a problem with body of the email, what&#39;s the actual problem?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1520414795, "post_id": 49147054, "comment_id": 85301045, "body": "Always try to describe your issue as detailed as possible. Tell in which line something goes wrong, if there are errors. Tell what your code actually does and what you expect instead."}, {"owner": {"reputation": 11, "user_id": 9455422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c56059bcf4ff8c1eb7e6bcc9a350d53?s=128&d=identicon&r=PG&f=1", "display_name": "Xaver", "link": "https://stackoverflow.com/users/9455422/xaver"}, "edited": false, "score": 0, "creation_date": 1520429082, "post_id": 49147054, "comment_id": 85310408, "body": "Hi guys, thanks for your comments. My problem is that my VBA doesn&#39;t paste the text stored in strTemp into the body of the emails."}, {"owner": {"reputation": 11, "user_id": 9455422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c56059bcf4ff8c1eb7e6bcc9a350d53?s=128&d=identicon&r=PG&f=1", "display_name": "Xaver", "link": "https://stackoverflow.com/users/9455422/xaver"}, "edited": false, "score": 0, "creation_date": 1520429178, "post_id": 49147054, "comment_id": 85310482, "body": "So the error probably has to be in the .HTMLBody line"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1520430417, "post_id": 49147054, "comment_id": 85311316, "body": "This line of code makes no sense: ` strbody = ActiveSheet.Paste` What are you trying to do with this? Have you checked in Debug what <code>strbody</code> contains?"}, {"owner": {"reputation": 11, "user_id": 9455422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c56059bcf4ff8c1eb7e6bcc9a350d53?s=128&d=identicon&r=PG&f=1", "display_name": "Xaver", "link": "https://stackoverflow.com/users/9455422/xaver"}, "edited": false, "score": 0, "creation_date": 1520430763, "post_id": 49147054, "comment_id": 85311547, "body": "Hello Cindy, thank you for your response. I&#39; trying to copy the text from a word document (including formatting) into a temporary storage plact to later paste it into the body of the Emails."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9455422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c56059bcf4ff8c1eb7e6bcc9a350d53?s=128&d=identicon&r=PG&f=1", "display_name": "Xaver", "link": "https://stackoverflow.com/users/9455422/xaver"}, "edited": false, "score": 1, "creation_date": 1520581822, "post_id": 49182385, "comment_id": 85383046, "body": "Hi 0m3r, thank you very much for your help. This code works very well, except of 2 problems. Maybe you can help me solve them. First of all, the text loses his formatting. Is there any chance to keep the formatting as is in the word document? Second, the Email doesn&#39;t include a Signature. Is there any chance to solve this issue as well? Thanks very much in advance!"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 1, "last_activity_date": 1520713962, "last_edit_date": 1520713962, "creation_date": 1520542952, "answer_id": 49182385, "question_id": 49147054, "link": "https://stackoverflow.com/questions/49147054/excel-vba-add-email-body-as-text-from-a-word-document/49182385#49182385", "title": "Excel VBA add Email body as text from a word document", "body": "<p><em>Here is quick example that will copy whole Word document and add it to the email body using <code>strbody</code></em> </p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim sh As Worksheet\n    Dim cell As Range\n    Dim rng As Range\n    Dim Word As New Word.Application\n    Dim WordDoc As New Word.Document\n    Dim Doc As String\n    Dim strbody As String\n\n    Doc = Range(\"E37\").Text\n    Set WordDoc = Word.Documents.Open(Doc, ReadOnly:=True)\n        Word.Selection.WholeStory\n        strbody = Word.Selection\n\n    Debug.Print strbody\n\n    WordDoc.Close\n    Word.Quit\n\n    Set sh = Sheets(\"Daten\")\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    For Each cell In sh.Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n        Set rng = sh.Cells(cell.Row, 1).Range(\"C1:Z1\")\n\n        If cell.Value Like \"?*@?*.?*\" And _\n            Application.WorksheetFunction.CountA(rng) &gt; 0 Then\n            Set OutMail = OutApp.CreateItem(0)\n\n            With OutMail\n                .To = cell.Value\n                .CC = \"\"\n                .Subject = Range(\"F1\").Value\n                .HTMLBody = \"&lt;br&gt;\" &amp; Range(\"A45\").Value &amp; _\n                            \"&lt;br&gt;\" &amp; strbody &amp; \"&lt;br&gt;\" &amp; .HTMLBody\n\n                .Display 'here\n            End With\n        End If\n    Next 'cell\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p><em>To keep the formatting and signature try following example</em></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim sh As Worksheet\n    Dim cell As Range\n    Dim rng As Range\n    Dim Word As New Word.Application\n    Dim WordDoc As Word.Document\n    Dim wdDoc As Word.Document\n    Dim Doc As String\n    Dim strbody As Variant ' String\n\n    Doc = Range(\"E37\").Text\n    Set WordDoc = Word.Documents.Open(Doc, ReadOnly:=True)\n\n    Word.Selection.WholeStory\n    Word.Selection.Copy\n\n    WordDoc.Close\n    Word.Quit\n\n    Set sh = Sheets(\"Daten\")\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    For Each cell In sh.Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n        Set rng = sh.Cells(cell.Row, 1).Range(\"C1:Z1\")\n\n        If cell.Value Like \"?*@?*.?*\" And _\n            Application.WorksheetFunction.CountA(rng) &gt; 0 Then\n            Set OutMail = OutApp.CreateItem(0)\n            Set WordDoc = OutMail.GetInspector.WordEditor\n\n            With OutMail\n                .To = cell.Value\n                .CC = \"\"\n                .Subject = Range(\"F1\").Value\n                .Display 'here\n\n                 WordDoc.Paragraphs(1).Range. _\n                         InsertBefore sh.Range(\"A45\").Value\n\n                 WordDoc.Paragraphs(2).Range. _\n                         PasteAndFormat Type:=wdFormatOriginalFormatting\n            End With\n        End If\n    Next 'cell\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9455422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c56059bcf4ff8c1eb7e6bcc9a350d53?s=128&d=identicon&r=PG&f=1", "display_name": "Xaver", "link": "https://stackoverflow.com/users/9455422/xaver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3214, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1592984655, "creation_date": 1520410524, "last_edit_date": 1592984655, "question_id": 49147054, "link": "https://stackoverflow.com/questions/49147054/excel-vba-add-email-body-as-text-from-a-word-document", "title": "Excel VBA add Email body as text from a word document", "body": "<p>How do I send Emails to various people attaching individualized documents and setting parts of the Email body as text from a word document (Individualized Addressing, then the Body from Word and then my signature). </p>\n\n<p>Right now everything works except of the body for the Emails.\nI'd really appreciate your help.</p>\n\n<pre><code>Sub Send_Files()\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim sh As Worksheet\n    Dim cell As Range\n    Dim FileCell As Range\n    Dim rng As Range\n    Dim html, name, address, age, department\n    Dim Word As New Word.Application\n    Dim WordDoc As New Word.Document\n    Dim Doc As String\n    Dim wb1 As Workbook\n    Dim Fname1 As String\n    Dim strbody As String\n\n    Doc = Range(\"E37\").Value\n    Set WordDoc = Word.Documents.Open(Doc, ReadOnly:=True)\n    Word.Selection.WholeStory\n    Word.Selection.Copy\n    strbody = ActiveSheet.Paste\n    WordDoc.Close\n    Word.Quit\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set sh = Sheets(\"Daten\")\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n\n    For Each cell In sh.Columns(\"B\").Cells.SpecialCells(xlCellTypeConstants)\n\n        Set rng = sh.Cells(cell.Row, 1).Range(\"C1:Z1\")\n\n        If cell.Value Like \"?*@?*.?*\" And _\n           Application.WorksheetFunction.CountA(rng) &gt; 0 Then\n            Set OutMail = OutApp.CreateItem(0)\n\n            With OutMail\n            '.Display 'here\n\n                .To = cell.Value\n                .CC = Range(\"Input!E4\").Value\n                .Subject = Range(\"F1\").Value\n                .HTMLBody = \"&lt;br&gt;\" &amp; Range(\"A45\").Value &amp; \"&lt;br&gt;\" &amp; strTemp &amp; \"&lt;br&gt;\" &amp; .HTMLBody\n\n                For Each FileCell In rng.SpecialCells(xlCellTypeConstants)\n                    If Trim(FileCell) &lt;&gt; \"\" Then\n                        If Dir(FileCell.Value) &lt;&gt; \"\" Then\n                            .Attachments.Add FileCell.Value\n                        End If\n                    End If\n                Next FileCell\n\n            .Display 'here\n\n            End With\n\n            Set OutMail = Nothing\n        End If\n    Next cell\n\n    Set OutApp = Nothing\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2013"], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 9335838, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O7emd.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/9335838/mike"}, "is_accepted": false, "score": 0, "last_activity_date": 1521000702, "creation_date": 1521000702, "answer_id": 49269660, "question_id": 49146737, "link": "https://stackoverflow.com/questions/49146737/vba-sql-sum-operation-in-form/49269660#49269660", "title": "VBA SQL Sum Operation in Form", "body": "<p>Change this line</p>\n\n<pre><code>Set rst = db.OpenRecordset(strSQL, dbForwardOnly)\n</code></pre>\n\n<p>to this</p>\n\n<pre><code>Set rst = db.OpenRecordset(strSQL, dbOpenSnapshot)\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 7629757, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/301916739531a1c2a0a0c0dbe7820fa6?s=128&d=identicon&r=PG&f=1", "display_name": "keko", "link": "https://stackoverflow.com/users/7629757/keko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 658, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1594636724, "creation_date": 1520409200, "last_edit_date": 1594636724, "question_id": 49146737, "link": "https://stackoverflow.com/questions/49146737/vba-sql-sum-operation-in-form", "title": "VBA SQL Sum Operation in Form", "body": "<p>In my <code>form</code> i want to use a <code>sum</code> on row <code>SWS</code> from <code>tblKurse</code> used in the <code>query</code> for the <code>form</code>. On a Button Click event i want to <code>sum</code> the values in that row whenever the criterion in my <code>where</code> is met. Problem is i get an <code>invalid argument</code> error whenever i run it. I just cant find my mistake. Maybe someone can help.</p>\n\n<p>Heres the function that i call after the button click event:</p>\n\n<pre><code>Public Function chkSWS() As Integer\n\n    Dim db As Database\n    Dim rst As DAO.Recordset\n    Dim strSQL As String\n\n    Set db = CurrentDb\n\n    strSQL = \"SELECT SUM(tblKurse.SWS) As Stunden \" _\n    &amp; \"FROM tblKurse \" _\n    &amp; \"WHERE tblKurse.Dozent_ID = \" &amp; Me.cmbKursDOzent\n\n    Debug.Print strSQL\n    Debug.Print Me.Dozent_ID\n    Set rst = db.OpenRecordset(strSQL, dbForwardOnly)\n\n    chkSWS = rst![Stunden]\n\n    Set rst = Nothing\n    Set db = Nothing\n\nEnd Function\n</code></pre>\n\n<p>Error points on the \"Set rst\" line, so it might been a bad <code>Select</code> statement?</p>\n\n<p>printed SQL Statement:</p>\n\n<pre><code>SELECT SUM(tblKurse.SWS) As Stunden FROM tblKurse WHERE tblKurse.Dozent_ID = 1\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520408049, "post_id": 49146402, "comment_id": 85297492, "body": "1) Will all sheets be protected? 2) Will they all have the same protection? 3) Will they all use the same password?"}, {"owner": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "edited": false, "score": 2, "creation_date": 1520408072, "post_id": 49146402, "comment_id": 85297501, "body": "Use the <code>Workbook_NewSheet</code> procedure"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "edited": false, "score": 0, "creation_date": 1520408217, "post_id": 49146402, "comment_id": 85297569, "body": "^^Getting to that @Fratyx :-) Yes though would help to know the answers to the other questions. I was gonna to suggest the same thing <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/workbook-newsheet-event-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a>"}, {"owner": {"reputation": 125, "user_id": 9300766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37366daa070f1f528c752d083bb307e3?s=128&d=identicon&r=PG&f=1", "display_name": "Klaudiusz Rolnik", "link": "https://stackoverflow.com/users/9300766/klaudiusz-rolnik"}, "edited": false, "score": 0, "creation_date": 1520410433, "post_id": 49146402, "comment_id": 85298594, "body": "1) yes, 2) all new, yes 3) yes.  My code need to be always at start executed.  l How do i make that with that procedure? I can only make other code that protect all cells that will be in real time filled out.       Example: &quot;Call Tabelle1.auto_Mes2&quot;"}], "owner": {"reputation": 125, "user_id": 9300766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37366daa070f1f528c752d083bb307e3?s=128&d=identicon&r=PG&f=1", "display_name": "Klaudiusz Rolnik", "link": "https://stackoverflow.com/users/9300766/klaudiusz-rolnik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520407838, "creation_date": 1520407838, "question_id": 49146402, "link": "https://stackoverflow.com/questions/49146402/defined-vba-protection-for-new-sheets", "title": "Defined VBA protection for new sheets", "body": "<p>I use some kind of check list with few Worksheets. Each Worksheet has protection with other restrictions. All have that same main code, only restrictions are others.</p>\n\n<p>I use that VBA code to protect each sheet of my excel individually, each code is with new start executed. It allows to use empty cells, but all others cells with text stay protected.\nIt works perfectly, but it need to be programmed for each sheet.</p>\n\n<p>My problem is that, if someone decides, that he need one more sheet. It won't be protected at all...</p>\n\n<p>Have someone any Idea, how to make one Makro that protect all <B>new sheets</b> without overwriting restrictions on others and naturally without my participation in it each time?</p>\n\n<p>It should work in similar way too, all empty cells = not protected, all with text = protected</p>\n\n<pre><code>Public Sub Mes2()\n  Dim strPassword As String\n  strPassword = \"Athens\"\n  With Sheets(\"Pool Processing\")\n\n    .Unprotect Password:=strPassword\n    .Cells.Locked = True\n\n    On Error Resume Next\n    .Range(\"A:AA\").SpecialCells(xlCellTypeBlanks).Locked = False\n    On Error GoTo 0\n    .Protect Password:=strPassword, UserInterfaceOnly:=True, AllowFormattingCells:=True, AllowFormattingRows:=True, AllowFormattingColumns:=True\n\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1520408570, "post_id": 49146019, "comment_id": 85297702, "body": "VBA has an object model. You could write code to target the object. Is the object a textbox shape?"}], "answers": [{"comments": [{"owner": {"reputation": 1187, "user_id": 7485394, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/02281b61f7ba8d610f2a8072aacf326d?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Straten", "link": "https://stackoverflow.com/users/7485394/henk-straten"}, "edited": false, "score": 0, "creation_date": 1520414951, "post_id": 49146617, "comment_id": 85301131, "body": "thanks. I just did it. Its working, however I only get the option to initiate the macro when the file is in presentation modus... Any thoughts on how I can use in normal modus?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1187, "user_id": 7485394, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/02281b61f7ba8d610f2a8072aacf326d?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Straten", "link": "https://stackoverflow.com/users/7485394/henk-straten"}, "edited": false, "score": 0, "creation_date": 1520415239, "post_id": 49146617, "comment_id": 85301323, "body": "I don&#39;t whether that is possible without trying a class. Ppt, i think, needs to be in presentation mode for things like Action links, hyperlinks to work. @steverindsberg is the guru on this <a href=\"https://stackoverflow.com/users/1667023/steve-rindsberg\">stackoverflow.com/users/1667023/steve-rindsberg</a>"}, {"owner": {"reputation": 1187, "user_id": 7485394, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/02281b61f7ba8d610f2a8072aacf326d?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Straten", "link": "https://stackoverflow.com/users/7485394/henk-straten"}, "edited": false, "score": 0, "creation_date": 1520430068, "post_id": 49146617, "comment_id": 85311079, "body": "@steverindsberg: any thoughts on this issue?"}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1520574092, "post_id": 49146617, "comment_id": 85379831, "body": "@QHarr is correct about needing to be in slideshow view for action settings to work (though the guru part is open to debate).  You&#39;ll need to set up an event trap, trap selection change events, determine whether the currently selected object is one that should trigger an action.  Google &quot;pptfaq.com events&quot; and &quot;officeone.com events&quot; (w/o the quotes) for info on setting up event traps"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1520409845, "last_edit_date": 1520409845, "creation_date": 1520408719, "answer_id": 49146617, "question_id": 49146019, "link": "https://stackoverflow.com/questions/49146019/trigger-a-function-when-clicking-an-element-in-powerpoint/49146617#49146617", "title": "Trigger a function when clicking an element in powerpoint", "body": "<p>Should be able to select your shape and do:</p>\n\n<p>Insert -> Links -> Action and select Run Macro (Your macro) </p>\n\n<p>Not sure if that is just for action buttons as can't test at present.</p>\n\n<p>Alternative is writing a class to detect the selection of the shape.</p>\n\n<p>Action buttons info:</p>\n\n<p><a href=\"https://support.office.com/en-us/article/Add-commands-to-your-presentation-with-action-buttons-7db2c0f8-5424-4780-93cb-8ac2b6b5f6ce\" rel=\"nofollow noreferrer\">Add commands to your presentation with action buttons</a></p>\n\n<p>Video demo here of adding an action to an ordinary shape (So seems may be possible)</p>\n\n<p><a href=\"https://www.youtube.com/watch?v=xF1bIiYx2mA\" rel=\"nofollow noreferrer\">Tutorial 2 - Assign Macro to a Shape</a></p>\n"}], "owner": {"reputation": 1187, "user_id": 7485394, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/02281b61f7ba8d610f2a8072aacf326d?s=128&d=identicon&r=PG&f=1", "display_name": "Henk Straten", "link": "https://stackoverflow.com/users/7485394/henk-straten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 901, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520409845, "creation_date": 1520406325, "question_id": 49146019, "link": "https://stackoverflow.com/questions/49146019/trigger-a-function-when-clicking-an-element-in-powerpoint", "title": "Trigger a function when clicking an element in powerpoint", "body": "<p>I have the following code creates a simple graph on a powerpoint. </p>\n\n<pre><code>Sub test()\n\n    Dim myTextBox As Shape\n\n    'Set element 1\n    With ActivePresentation.Slides(1)\n        Set myTextBox = .Shapes.AddShape(msoShapeRectangle, 15, 10, 20, 30)\n        myTextBox.Fill.BackColor.RGB = RGB(170, 170, 170)\n        Set myTextBox1 = .Shapes.AddTextbox(msoTextOrientationVertical, 10, 50, 20, 60)\n        myTextBox1.TextFrame.TextRange.Text = \"JAN\"\n    End With\n\n    With ActivePresentation.Slides(1)\n        Set myTextBox = .Shapes.AddShape(msoShapeRectangle, 40, 20, 20, 20)\n        myTextBox.Fill.BackColor.RGB = RGB(170, 170, 170)\n        Set myTextBox1 = .Shapes.AddTextbox(msoTextOrientationVertical, 35, 50, 20, 60)\n        myTextBox1.TextFrame.TextRange.Text = \"FEB\"\n    End With\n</code></pre>\n\n<p>This all works fine. However I want this method to be triggered when somebody is clicking a text element.</p>\n\n<p>So lets say I have an element called \"Rechthoek 43\". How should I adjust my code so that the test() method is called when clicking \"Rechthoek 43\"</p>\n"}, {"tags": ["oracle", "excel", "plsql", "vba"], "comments": [{"owner": {"reputation": 38299, "user_id": 3027266, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3249486ec6096e443cb8e93489fe0a09?s=128&d=identicon&r=PG&f=1", "display_name": "Wernfried Domscheit", "link": "https://stackoverflow.com/users/3027266/wernfried-domscheit"}, "edited": false, "score": 2, "creation_date": 1520405625, "post_id": 49144861, "comment_id": 85296405, "body": "You could write a Java program which does all these operations. Then you can call the Java program from Oracle, see <a href=\"https://docs.oracle.com/cd/B19306_01/java.102/b14187/chthree.htm\" rel=\"nofollow noreferrer\">Calling Java Methods in Oracle Database</a>. Or check this one <a href=\"https://docs.oracle.com/en/database/oracle/oracle-database/12.2/ntqrf/about-building-external-procedures.html#GUID-DB15FD29-A121-4B3F-B422-1C8BF3FB696D\" rel=\"nofollow noreferrer\">About Building External Procedures</a>"}, {"owner": {"reputation": 136706, "user_id": 146325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09939a1d3bd9c1af199a948bdc68cb71?s=128&d=identicon&r=PG", "display_name": "APC", "link": "https://stackoverflow.com/users/146325/apc"}, "edited": false, "score": 1, "creation_date": 1520408468, "post_id": 49144861, "comment_id": 85297668, "body": "This is a tricky - and highly unusual - requirement which demands some pretty low-level coding. Your starting point should be Anton Scheffer&#39;s excellent <code>as_xlsx</code> package; <a href=\"https://technology.amis.nl/2011/02/19/create-an-excel-file-with-plsql/\" rel=\"nofollow noreferrer\">find it here</a>. That package will handle your <i>write</i> requirement. It should be easy enough to extend it to handing the <i>read</i> requirement. Triggering <i>a VBA function</i> might be tough. It depends how you run the function in Excel: I mean, it is gonna be hard to simulate pressing <code>[F5]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 13026, "user_id": 23669, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9f6b4d78bc77193a4130c4bbbcc1760a?s=128&d=identicon&r=PG", "display_name": "eaolson", "link": "https://stackoverflow.com/users/23669/eaolson"}, "is_accepted": false, "score": 1, "last_activity_date": 1520816041, "creation_date": 1520816041, "answer_id": 49226726, "question_id": 49144861, "link": "https://stackoverflow.com/questions/49144861/trigger-excel-vba-read-and-write-to-excel-from-an-oracle-procedure/49226726#49226726", "title": "Trigger Excel VBA, read and write to Excel from an Oracle Procedure", "body": "<p>#1 and #3 can be done using the <a href=\"https://github.com/mortenbra/alexandria-plsql-utils\" rel=\"nofollow noreferrer\">Alexandria PL/SQL Utils</a> library. It's great and I use it for this sort of thing all the time.</p>\n\n<p>#2 is never going to happen. You'd essentially have to write a VBA engine inside PL/SQL. A better question is, why is this a requirement? What are you trying to do?</p>\n"}], "owner": {"reputation": 7586, "user_id": 1151269, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/5eoVa.jpg?s=128&g=1", "display_name": "Rachcha", "link": "https://stackoverflow.com/users/1151269/rachcha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520816041, "creation_date": 1520401102, "last_edit_date": 1531161705, "question_id": 49144861, "link": "https://stackoverflow.com/questions/49144861/trigger-excel-vba-read-and-write-to-excel-from-an-oracle-procedure", "title": "Trigger Excel VBA, read and write to Excel from an Oracle Procedure", "body": "<p>I have an Excel file stored at a file system location. I have the path in my Oracle procedure. I, however, can't find any resource online that would guide me in-</p>\n\n<ul>\n<li>Write data to a particular sheet in the Excel file</li>\n<li>Run a particular VBA function</li>\n<li>Read data from a particular sheet in the Excel file</li>\n</ul>\n\n<p>Reinforce- I need to achieve all three of these through an Oracle procedure.</p>\n\n<p>Any resources would be helpful.</p>\n\n<p><strong>Note:</strong> I am not trying to call an Oracle query or function through Excel. I am quite able to do that using ODBC. I am asking for something that's the exact opposite.</p>\n"}, {"tags": ["vba"], "answers": [{"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1520405938, "last_edit_date": 1520405938, "creation_date": 1520405584, "answer_id": 49145868, "question_id": 49144476, "link": "https://stackoverflow.com/questions/49144476/insert-image-from-image-control-to-excel-as-icon-with-link-using-vba/49145868#49145868", "title": "Insert Image from Image control to excel as Icon with Link using VBA", "body": "<p>assuming \"Image1\" is the name of the <code>Image</code> control in your UserForm, and concentrating on the specific task you need to accomplish, then you may want to consider the following code</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub btnSave_Click()\n    Dim myCell As Range\n\n    With Worksheets(\"SafetyReport\")\n        Set myCell = .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0)\n        If Me.Tag &lt;&gt; \"\" Then ' if any path has been stored in userform 'Tag' property\n            With .Pictures.Insert(Me.Tag)\n                With .ShapeRange\n                    .LockAspectRatio = msoTrue\n                    .Width = myCell.Width\n                    .Height = myCell.Height\n                End With\n                .Left = myCell.Left\n                .Top = myCell.Top\n                .Placement = 1\n            End With\n            Me.Tag = \"\" ' clear 'Tag' property for subsequent uses\n        End If\n    End With\nEnd Sub\n\nPrivate Sub Image1_Click()\n    Dim PicPath As Variant\n\n    PicPath = Application.GetOpenFilename\n    If PicPath = False Then\n        MsgBox \"No files selected\"\n    Else\n        Me.Image1.Picture = LoadPicture(PicPath)\n        Me.Repaint\n        Me.Tag = PicPath ' store the picture path in Userform 'Tag' property\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9454619, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c65bdaa7d2dbdfefed9904a1466d276?s=128&d=identicon&r=PG&f=1", "display_name": "Murari", "link": "https://stackoverflow.com/users/9454619/murari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 602, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520405938, "creation_date": 1520398918, "last_edit_date": 1520404424, "question_id": 49144476, "link": "https://stackoverflow.com/questions/49144476/insert-image-from-image-control-to-excel-as-icon-with-link-using-vba", "title": "Insert Image from Image control to excel as Icon with Link using VBA", "body": "<p>I am a beginner in Excel VBA.I have Image control in vba form. An image is displayed selecting from folder. What I want is to insert and save the same image to Cell D.Here is code</p>\n\n<pre><code>Private Sub btnSave_Click()\n    Dim irow As Long\n    Dim ws As Worksheet\n    Dim PictDir As String, PictType As String\n    Dim SNo As Long\n    Dim Image As Object\n    Set ws = Worksheets(\"SafetyReport\")\n    SNo = ws.Range(\"A1\", ws.Range(\"A1\").End(xlDown)).Rows.Count\n\n    If SNo = 1048576 Then\n       SNo = 1\n    End If\n\n\n    irow = ws.Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n    With ws\n     .Range(\"D\" &amp; irow) = Me.Image.Picture\nEnd Sub\n\nPrivate Sub Image_Click()\n    Dim PictFileName As String\n    Dim PicPath As String\n    PictFileName = Application.GetOpenFilename\n    PicPath = PictFileName\n\n    If Len(Dir(PicPath)) = 0 Then\n        MsgBox PicPath &amp; \" does not exist.\"\n    Else\n        Me.Image.Picture = LoadPicture(PicPath)\n        Me.Repaint\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "file-extension", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1520394388, "post_id": 49143700, "comment_id": 85292824, "body": "A workbook with macros saved has to be <code>.xlsm</code> (or sometimes <code>.xlsb</code>), what do you mean a macro saved in any format?  Edit: Are you asking how to run macros you have saved somewhere, on any file you open?"}, {"owner": {"reputation": 703, "user_id": 2249207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce472ab3cd59cefb4f602092a9ab82c4?s=128&d=identicon&r=PG", "display_name": "DAIRAV", "link": "https://stackoverflow.com/users/2249207/dairav"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1520395082, "post_id": 49143700, "comment_id": 85292988, "body": "Actually i was trying to find out, is it possible to save an excel file in &quot;.xlsx&quot; format with macros. Also whether macros will be available after saving .xlsx format on re-opening the file?"}, {"owner": {"reputation": 96653, "user_id": 259769, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/0iE2z.jpg?s=128&g=1", "display_name": "Enigmativity", "link": "https://stackoverflow.com/users/259769/enigmativity"}, "edited": false, "score": 0, "creation_date": 1520395357, "post_id": 49143700, "comment_id": 85293039, "body": "It is a security feature that prevents an <code>.xlsx</code> from containing macros. This is by design. &quot;Excel cannot open the file &#39;Book1.xlsx&#39; because the file format or file extension is not valid. Verify that the file has not been corrupted and that the file extension matches the format of the file. &quot;"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1520395900, "post_id": 49143700, "comment_id": 85293207, "body": "@user2249207 - No and emphatically <b>No</b>. Are you not receiving the warning dialog I added to my response below when you try?"}, {"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 1, "creation_date": 1520395902, "post_id": 49143700, "comment_id": 85293208, "body": "Save it as <code>.xlsm</code> or <code>xls</code> or move your macros to <code>PERSONAL.XLSB</code> and run it on any <code>Active-workbook or Sheet</code>"}, {"owner": {"reputation": 1580, "user_id": 7938503, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OYvg2.jpg?s=128&g=1", "display_name": "Plagon", "link": "https://stackoverflow.com/users/7938503/plagon"}, "edited": false, "score": 0, "creation_date": 1520405222, "post_id": 49143700, "comment_id": 85296227, "body": "Or you can make an <code>add-in</code>."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 7, "last_activity_date": 1520394636, "creation_date": 1520394636, "answer_id": 49143801, "question_id": 49143700, "link": "https://stackoverflow.com/questions/49143700/how-to-run-macros-in-excel-irrespective-of-the-file-extension-it-is-saved/49143801#49143801", "title": "How to run macros in excel irrespective of the file extension it is saved", "body": "<p>A workbook saved as an .xlsx <strong>cannot</strong> contain a VBA project.</p>\n\n<p><a href=\"https://i.stack.imgur.com/PCxwp.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/PCxwp.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 703, "user_id": 2249207, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ce472ab3cd59cefb4f602092a9ab82c4?s=128&d=identicon&r=PG", "display_name": "DAIRAV", "link": "https://stackoverflow.com/users/2249207/dairav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 1, "closed_date": 1520412000, "accepted_answer_id": 49143801, "answer_count": 1, "score": -2, "last_activity_date": 1520409874, "creation_date": 1520393822, "last_edit_date": 1531161705, "question_id": 49143700, "link": "https://stackoverflow.com/questions/49143700/how-to-run-macros-in-excel-irrespective-of-the-file-extension-it-is-saved", "closed_reason": "Needs more focus", "title": "How to run macros in excel irrespective of the file extension it is saved", "body": "<p>I would like to know,if the excel file with macro/vba code saved in any format (.xls, .xlsx ..etc), still the macros can run?</p>\n\n<p>Or is there a way to run macros irrespective of the file extension format.</p>\n"}, {"tags": ["database", "excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 1, "last_activity_date": 1520415071, "last_edit_date": 1520415071, "creation_date": 1520394344, "answer_id": 49143764, "question_id": 49143559, "link": "https://stackoverflow.com/questions/49143559/delete-rows-and-shift-up-for-with-multiple-words/49143764#49143764", "title": "Delete rows and shift up for with multiple words", "body": "<p>Use an array of words for AutoFilter criteria.</p>\n\n<pre><code>dim crit as variant\ncrit = array(\"GT\", \"ST\", \"Food\")\nwith worksheets(\"sheet1\")\n    if .autofiltermode then .autofiltermode = false\n    with .cells(1, 1).currentregion\n        .autofilter field:=1, criteria1:=crit, operator:=xlfiltervalues\n        with .resize(.rows.count-1, .columns.count).offset(1, 0)\n            if cbool(application.subtotal(103, .cells)) then\n                .specialcells(xlcelltypevisible).entirerow.delete\n            end if\n        end with\n    end with\n    if .autofiltermode then .autofiltermode = false\nend with\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 8316930, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5b7iAOMn1kE/AAAAAAAAAAI/AAAAAAAAAT8/Z6C60rQ1tHk/photo.jpg?sz=128", "display_name": "user8316930", "link": "https://stackoverflow.com/users/8316930/user8316930"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "closed_date": 1520411260, "accepted_answer_id": 49143764, "answer_count": 1, "score": -1, "last_activity_date": 1520415071, "creation_date": 1520392810, "last_edit_date": 1520395568, "question_id": 49143559, "link": "https://stackoverflow.com/questions/49143559/delete-rows-and-shift-up-for-with-multiple-words", "closed_reason": "Needs more focus", "title": "Delete rows and shift up for with multiple words", "body": "<p>I am trying to come up with a way to delete all rows and shift cells up. </p>\n\n<p>The column contains various words. Among them I would like to delete few words (such as \"GT\", \"ST\", \"Food\" - altogether 10 different words). I appreciate your suggestions.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1520393036, "post_id": 49143318, "comment_id": 85292489, "body": "what&#39;s the actual error message you receive?"}, {"owner": {"reputation": 635, "user_id": 3673022, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QcJAy.jpg?s=128&g=1", "display_name": "pfych", "link": "https://stackoverflow.com/users/3673022/pfych"}, "reply_to_user": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1520398592, "post_id": 49143318, "comment_id": 85293971, "body": "I edited the question with the error"}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 0, "creation_date": 1520417214, "post_id": 49143318, "comment_id": 85302596, "body": "What is the value of <code>SignName</code> when you get the error? Make sure the value <b>does not contain</b> any special character prohibited to name files like / \\ * etc."}, {"owner": {"reputation": 26571, "user_id": 1569536, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/74e73f52165e9b74723a8a5ac446d71b?s=128&d=identicon&r=PG", "display_name": "Scott Holtzman", "link": "https://stackoverflow.com/users/1569536/scott-holtzman"}, "edited": false, "score": 0, "creation_date": 1520434476, "post_id": 49143318, "comment_id": 85314068, "body": "get rid of this line <code>Application.Workbooks.Open (ThisWorkbook.FullName)</code> It&#39;s not needed and will only serve to wack out your process. You can probably get rid of this line too <code>ThisWorkbook.Save</code> or move it to the very end. There&#39;s no need to save it after every iteration."}, {"owner": {"reputation": 635, "user_id": 3673022, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QcJAy.jpg?s=128&g=1", "display_name": "pfych", "link": "https://stackoverflow.com/users/3673022/pfych"}, "edited": false, "score": 0, "creation_date": 1520482641, "post_id": 49143318, "comment_id": 85335939, "body": "The value of <code>SignName</code> is just the persons name and only contains english characters"}], "owner": {"reputation": 635, "user_id": 3673022, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QcJAy.jpg?s=128&g=1", "display_name": "pfych", "link": "https://stackoverflow.com/users/3673022/pfych"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520398577, "creation_date": 1520390987, "last_edit_date": 1520398577, "question_id": 49143318, "link": "https://stackoverflow.com/questions/49143318/excel-mass-export-to-individual-pdf-run-time-error-1004", "title": "Excel mass export to individual PDF &quot;Run time error 1004&quot;", "body": "<p>I have an excel spreadsheet with 254 entries and I want to export each row as an individual PDF. This code works, I have two spreadsheets. One called dataSheet and one called pdfSheet, It copies the data from dataSheet, pastes it into pdfSheet and then exports pdfSheet as a pdf. The file is then saved into a folder.</p>\n\n<p>However, I get \"Run time error 1004\" on the 18th time running through (It works perfectly beforhand), every time. I have shuffled the data to make sure thats not a problem but I cant figure out why It would just stop working. I stepped through it in the debugger and on the 18th loop I get the error at:</p>\n\n<pre><code>pdfSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=\"S:\\Exports\\\" &amp; \"Export\" &amp; \"\\\" &amp; SignName &amp; \"\\\" &amp; \"Export.pdf\"\n</code></pre>\n\n<p>Here is the full code:</p>\n\n<pre><code>Sub ExportPDF()\nDim wholeBook As Workbook\nDim pdfSheet As Worksheet\nDim dataSheet As Worksheet\nDim path As String\nSet pdfSheet = ThisWorkbook.Worksheets(2)\nSet dataSheet = ThisWorkbook.Worksheets(1)\nSet wholeBook = ThisWorkbook\npath = wholeBook.FullName\nApplication.ScreenUpdating = False\nFor i = 2 To 254\n    SignName = dataSheet.Cells(i, 4)\n    Category = dataSheet.Cells(i, 3)\n    DOB = dataSheet.Cells(i, 5)\n    Address = dataSheet.Cells(i, 6)\n    Phone = dataSheet.Cells(i, 7)\n    Email = dataSheet.Cells(i, 8)\n    Instagram = dataSheet.Cells(i, 9)\n    Facebook = dataSheet.Cells(i, 10)\n    Twitter = dataSheet.Cells(i, 11)\n    ECD = dataSheet.Cells(i, 13)\n    BOOTP = dataSheet.Cells(i, 14)\n    WINRTTP = dataSheet.Cells(i, 15)\n    PDOA = dataSheet.Cells(i, 16)\n    AGOTP = dataSheet.Cells(i, 17)\n    PATISU = dataSheet.Cells(i, 18)\n    DACYP = dataSheet.Cells(i, 19)\n    PRPFP = dataSheet.Cells(i, 20)\n    GGAFTFO = dataSheet.Cells(i, 21)\n    AROAFF = dataSheet.Cells(i, 22)\n    BS = dataSheet.Cells(i, 23)\n    UNISS = dataSheet.Cells(i, 24)\n    WPSGA = dataSheet.Cells(i, 25)\n\n    pdfSheet.Cells(3, 1).Value = SignName\n    pdfSheet.Cells(5, 1).Value = Category\n    pdfSheet.Cells(7, 1).Value = DOB\n    pdfSheet.Cells(9, 1).Value = Address\n    pdfSheet.Cells(11, 1).Value = Phone\n    pdfSheet.Cells(13, 1).Value = Email\n    pdfSheet.Cells(15, 1).Value = Instagram\n    pdfSheet.Cells(17, 1).Value = Facebook\n    pdfSheet.Cells(19, 1).Value = Twitter\n    pdfSheet.Cells(21, 1).Value = ECD\n    pdfSheet.Cells(23, 1).Value = BOOTP\n    pdfSheet.Cells(25, 1).Value = WINRTTP\n    pdfSheet.Cells(27, 1).Value = PDOA\n    pdfSheet.Cells(29, 1).Value = AGOTP\n    pdfSheet.Cells(31, 1).Value = PATISU\n    pdfSheet.Cells(33, 1).Value = DACYP\n    pdfSheet.Cells(35, 1).Value = PRPFP\n    pdfSheet.Cells(37, 1).Value = GGAFTFO\n    pdfSheet.Cells(39, 1).Value = AROAFF\n    pdfSheet.Cells(41, 1).Value = BS\n    pdfSheet.Cells(43, 1).Value = UNISS\n    pdfSheet.Cells(44, 1).Value = WPSGA\n    If Len(Dir(\"S:\\Exports\\\" &amp; \"Export\" &amp; \"\\\" &amp; SignName, vbDirectory)) = 0 Then\n        MkDir \"S:\\Exports\\\" &amp; \"Export\" &amp; \"\\\" &amp; SignName\n    End If\n    pdfSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:=\"S:\\Exports\\\" &amp; \"Export\" &amp; \"\\\" &amp; SignName &amp; \"\\\" &amp; \"Export.pdf\"\n    ThisWorkbook.Save\n    Application.Workbooks.Open (ThisWorkbook.FullName)\n    Next i\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>The full error is</p>\n\n<pre><code>Run-time-error '1004':\nApplication-defnied or object-defined error\n</code></pre>\n"}, {"tags": ["string", "excel", "replace", "string-length", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1520387428, "post_id": 49142666, "comment_id": 85291263, "body": "These appear to find the first occurrence, not the last occurrence within the left-most 999 characters. Maybe I read the post wrong."}], "tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": false, "score": 1, "last_activity_date": 1520386413, "last_edit_date": 1520386413, "creation_date": 1520385664, "answer_id": 49142666, "question_id": 49142570, "link": "https://stackoverflow.com/questions/49142570/delete-all-text-to-right-of-variable-character-position-based-on-variable-string/49142666#49142666", "title": "Delete all text to right of variable character position based on variable string length", "body": "<p>Try this demo (may help you)</p>\n\n<pre><code>Sub Demo()\nDim s As String\nDim p As Integer\n\ns = \"ab:cde,fghij Hello world, thanks a lot , for everything and \"\n\np = InStr(10, s, \",\")\nDebug.Print p\n\ns = Mid(s, 1, p - 1) &amp; \"...\"\nDebug.Print s\nEnd Sub\n</code></pre>\n\n<p>Another demo if you will deal with more options (comma / period / semicolon)</p>\n\n<pre><code>Sub Demo2()\nDim a As Variant\nDim s As String\nDim p As Integer\nDim p1 As Integer\nDim p2 As Integer\nDim p3 As Integer\n\ns = \"ab:cde,fghij Hello ; world, thanks. a lot , for everything and \"\n\np1 = InStr(10, s, \",\")\np2 = InStr(10, s, \";\")\np3 = InStr(10, s, \".\")\n\na = Array(p1, p2, p3)\np = Evaluate(\"MIN(IF({\" &amp; Join(a, \";\") &amp; \"}&gt;0,{\" &amp; Join(a, \";\") &amp; \"}))\")\nDebug.Print p\n\ns = Mid(s, 1, p - 1) &amp; \"...\"\nDebug.Print s\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1520387915, "post_id": 49142843, "comment_id": 85291377, "body": "This is what I thought at first :)"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1520388299, "last_edit_date": 1520388299, "creation_date": 1520387208, "answer_id": 49142843, "question_id": 49142570, "link": "https://stackoverflow.com/questions/49142570/delete-all-text-to-right-of-variable-character-position-based-on-variable-string/49142843#49142843", "title": "Delete all text to right of variable character position based on variable string length", "body": "<p>The position of the last eligible punctuation within the left-most 1000 characters can be located with InStrRev.</p>\n\n<pre><code>dim str as string, p as long\nfor i=2 to lr\n    str = cells(i, \"B\").value2\n    if len(str) &gt; 1000 then\n        p = application.max(instrrev(str, chr(44), 998), _\n                            instrrev(str, chr(46), 998), _\n                            instrrev(str, chr(58), 998), _\n                            instrrev(str, chr(59), 998))\n        cells(i, \"B\") = left(str, p-1) &amp; string(3, chr(46))\n    end if\nnext i\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 2, "last_activity_date": 1520387752, "creation_date": 1520387752, "answer_id": 49142909, "question_id": 49142570, "link": "https://stackoverflow.com/questions/49142570/delete-all-text-to-right-of-variable-character-position-based-on-variable-string/49142909#49142909", "title": "Delete all text to right of variable character position based on variable string length", "body": "<p>Try this to check first occurrence of any punctuation <code>. , ; :</code> after 998 characters.</p>\n\n<pre><code>Dim teststring As String, firstcut As String, extension As String\n\nteststring = String$(1000, \"a\") &amp; _\n    \"Lorem ipsum dolor sit amet, consectetur adipiscing elit. \" &amp; _\n    \"In malesuada non enim nec posuere. Praesent placerat nulla enim, \" &amp; _\n    \"at porta justo pharetra ac.\"\n\nIf Len(teststring) &gt; 999 Then\n    firstcut = Left$(teststring, 998)\n\n    extension = Right(teststring, Len(teststring) - 998)\n    extension = Replace(Replace(Replace(extension, \",\", \".\"), \";\", \".\"), \":\", \".\")\n    extension = Left$(extension, InStr(1, extension, \".\") - 1) &amp; \"...\"\n\n    Debug.Print extension\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 7437870, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/0f903b883d4cb80edfc0f0da24cfa96d?s=128&d=identicon&r=PG&f=1", "display_name": "Scott", "link": "https://stackoverflow.com/users/7437870/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 561, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1520388299, "creation_date": 1520384868, "last_edit_date": 1531161705, "question_id": 49142570, "link": "https://stackoverflow.com/questions/49142570/delete-all-text-to-right-of-variable-character-position-based-on-variable-string", "title": "Delete all text to right of variable character position based on variable string length", "body": "<p>Problem: I have a column where each cell has varying lengths and varying sentence structure. If any cell exceeds 1000 characters in length, find the first occurrence of either a [period], [comma], [semi-colon], [colon] to the <strong>right</strong> of the 998th character in the string and replace that character with [3 periods](application alternative to an ellipsis). Finally truncate all remaining text after the 3 periods.  </p>\n\n<p>Example-</p>\n\n<p>Current Data:\n[[900 previous characters]]. Visual Basic for Applications enables building user-defined functions (UDFs), automating processes and accessing Windows API and other low-level functionality through dynamic-link libraries (DLLs).</p>\n\n<p>Expected Output:\n[[900 previous characters]]. Visual Basic for Applications enables building user-defined functions (UDFs)...</p>\n\n<p>In 'Current Data', the length = 1098 characters. The 998th character is the second 's' in \"proces<strong>S</strong>\". The first occurrence of one of the desired punctuation marks to the right is the [comma] after (UDFs). That is replaced with [3 periods] and the rest of the string is removed.</p>\n\n<p>Currently this is what I have. I have not figured out how to include the various conditions to find or how to truncate text after the 3 periods. Also, there might be a cleaner way to do all this.</p>\n\n<pre><code>For i = 2 To LR\n\n\nIf Len(Cells(i, 2).Value) &gt; 1000 Then\n\n    Cells(i, 2).Value = Left(Cells(i, 2), 998)\n    Cells(i, 2).Value = StrReverse(Replace(StrReverse(Cells(i, 2).Value), StrReverse(\".\"), StrReverse(\"...\"), Count:=1))\n\n\nEnd If\nNext i\n</code></pre>\n\n<p>Hopefully I've provided plenty of information about what I am attempting.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1520384145, "post_id": 49142421, "comment_id": 85290492, "body": "Are there any errors (e.g. #N/A, #VALUE!, etc) in that table?"}, {"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 1, "creation_date": 1520407148, "post_id": 49142421, "comment_id": 85297066, "body": "<code>.Formula</code> is not valid property for <code>Sheet</code> object, as far as I remember. You should use <code>Sheets(&quot;Sheet1&quot;).Range(AddressString).Formula</code>"}], "owner": {"reputation": 11, "user_id": 5922766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sH4CK.jpg?s=128&g=1", "display_name": "Duthreal", "link": "https://stackoverflow.com/users/5922766/duthreal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 135, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520388632, "creation_date": 1520383949, "last_edit_date": 1531161705, "question_id": 49142421, "link": "https://stackoverflow.com/questions/49142421/receiving-subscript-out-of-range-error", "title": "Receiving Subscript out of Range Error", "body": "<p>I have this Macro and the</p>\n\n<pre><code>Sheets(\"Query[Difference in date]\").Formula = \"=[Posting Date]-[Expected Receipt Date]\" \n</code></pre>\n\n<p>and </p>\n\n<pre><code>Sheets(\"Query[Grade]\").Formula = _\n\"=IF([Difference in date]&lt;2,\"\"A\"\",IF([Difference in date]=2,\"\"B\"\",IF([Difference in date]=3,\"\"C\"\",IF([Difference in date]=4,\"\"D\"\",\"\"F\"\"))))\"\n</code></pre>\n\n<p>are giving me an </p>\n\n<blockquote>\n  <p>Error 9 - Subscript out of Range error.  </p>\n</blockquote>\n\n<p>Any suggestions?</p>\n\n<pre><code>Sheets(\"Query\").Select\nSelection.ListObject.QueryTable.Refresh BackgroundQuery:=False\nRange(\"K2\").Select\nActiveCell.FormulaR1C1 = \"Difference in date\"\nRange(\"K3\").Select\nSheets(\"Query[Difference in date]\").Formula = \"=[Posting Date]-[Expected Receipt Date]\"\nRange(\"L2\").Select\nActiveCell.FormulaR1C1 = \"Grade\"\nRange(\"L3\").Select\nSheets(\"Query[Grade]\").Formula = \"=IF([Difference in date]&lt;2,\"\"A\"\",IF([Difference in date]=2,\"\"B\"\",IF([Difference in date]=3,\"\"C\"\",IF([Difference in date]=4,\"\"D\"\",\"\"F\"\"))))\"\nSheets(\"Pivot Table\").Select\nActiveSheet.PivotTables(\"PivotTable1\").PivotCache.Refresh\n</code></pre>\n\n<p>This Macro refreshes a Query Table, then adds two columns to the right with formulas, then it refreshes the Pivot Table that References the Query table.</p>\n"}, {"tags": ["vba", "excel", "ftp"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1520388878, "post_id": 49142058, "comment_id": 85291631, "body": "So your specific issue is the part where you execute the <code>Shell</code> command? The rest of the code is working perfectly?"}, {"owner": {"reputation": 599, "user_id": 1422252, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a0754a5356995ba9b91a3cbf43f91c4?s=128&d=identicon&r=PG", "display_name": "PhillipOReilly", "link": "https://stackoverflow.com/users/1422252/philliporeilly"}, "reply_to_user": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1520396300, "post_id": 49142058, "comment_id": 85293317, "body": "Appears to be. VBA provides no log when it runs Shell. I will try your suggestion below. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 599, "user_id": 1422252, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a0754a5356995ba9b91a3cbf43f91c4?s=128&d=identicon&r=PG", "display_name": "PhillipOReilly", "link": "https://stackoverflow.com/users/1422252/philliporeilly"}, "edited": false, "score": 0, "creation_date": 1520454059, "post_id": 49143218, "comment_id": 85326559, "body": "That worked! I never would have thought of starting another Shell to get the original shell to work! Thanks!"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": true, "score": 0, "last_activity_date": 1520390211, "creation_date": 1520390211, "answer_id": 49143218, "question_id": 49142058, "link": "https://stackoverflow.com/questions/49142058/vba-code-does-not-execute-ftp-download-or-write-log-when-call-shell/49143218#49143218", "title": "VBA Code Does Not Execute FTP Download or Write Log when call Shell", "body": "<p>If the <code>Shell</code> part is the only problem, what you can do is to create a batch file which will execute your FTP command. Something like:</p>\n\n<pre><code>Dim ff As Integer\n\nff = FreeFile()\nOpen \"runFTP.bat\" For Output As #ff\nPrint #ff, fullshellcommand '/* what you generated in your code */\nClose #ff\n\nShell \"runFTP.bat\"\n</code></pre>\n"}], "owner": {"reputation": 599, "user_id": 1422252, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3a0754a5356995ba9b91a3cbf43f91c4?s=128&d=identicon&r=PG", "display_name": "PhillipOReilly", "link": "https://stackoverflow.com/users/1422252/philliporeilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 49143218, "answer_count": 1, "score": 0, "last_activity_date": 1520454171, "creation_date": 1520381235, "last_edit_date": 1531164843, "question_id": 49142058, "link": "https://stackoverflow.com/questions/49142058/vba-code-does-not-execute-ftp-download-or-write-log-when-call-shell", "title": "VBA Code Does Not Execute FTP Download or Write Log when call Shell", "body": "<p>I used <a href=\"https://stackoverflow.com/a/7196612/1422252\">ray's</a> answer to develop a procedure that writes a script file to a directory and then runs the script in a Shell. </p>\n\n<p>The code throws no errors but does not download the file or write the FTP log to the text file I specify. </p>\n\n<p>At first the problem was that I tried to specify a directory for the target file and ftp log as pointed out <a href=\"https://stackoverflow.com/a/19824472/1422252\">here by jacouh</a>, so the script would not run in DOS. </p>\n\n<p>I corrected that error, I believe, and can now run the script in a DOS window using the exact command line that is used in the Shell command. However, it still does not run in VBA.</p>\n\n<p>Two questions: </p>\n\n<ol>\n<li>Is there a way to see the log file in VBA? </li>\n<li>Anyone see something obvious I might have done wrong?</li>\n</ol>\n\n<p>Here is the code:</p>\n\n<pre><code>Function getFilesViaFTP(fileToGet As String, fileToWrite As String) As Boolean\nDim rc As Integer\nDim iFreeFile As Integer\nDim sFTPUserID As String\nDim sFTPPassWord As String\nDim sWorkingDirectory As String\nDim sFtpLogFile As String\n\nDim myCurrentDirectory As String\n\nConst FTP_BATCH_FILE_NAME = \"myFTPscript.txt\"\nConst INCREASED_BUFFER_SIZE = 20480\n\nDim fileNameForDownload As String\nfileNameForDownload = fileToWrite\n\nDim fullGetCommand As String\nDim fullShellCommand As String\n\nmyCurrentDirectory = CurDir()\n\ngetFilesViaFTP = False\n\nsWorkingDirectory = \"K:\\Users\\WWTP Computer\\Documents\\DMR's\\ftpDownloads\\\"\n\nsFtpLogFile = \"ftp_Log\" &amp; \"_\" &amp; year(Date) &amp; \"_\" &amp; month(Date) &amp; \"_\" &amp; day(Date) &amp; \".txt\"\n\n\nOn Error GoTo EncounteredErrorInProc\n\n'Kill FTP process file if it exists\nIf Dir(sWorkingDirectory &amp; FTP_BATCH_FILE_NAME) &lt;&gt; \"\" Then\n    Kill sWorkingDirectory &amp; FTP_BATCH_FILE_NAME\nEnd If\n\nIf Dir(sWorkingDirectory &amp; sFtpLogFile) &lt;&gt; \"\" Then\n    Kill (sWorkingDirectory &amp; sFtpLogFile)\nEnd If\n\nDim i As Integer\nDim whereIsDot As Integer\ni = 1\n\n'Change target file name if one already exists\nDo While Dir(sWorkingDirectory &amp; fileNameForDownload) &lt;&gt; \"\"\n    whereIsDot = InStr(fileToWrite, \".\")\n    fileNameForDownload = Left(fileToWrite, whereIsDot - 1) &amp; \"_\" &amp; i &amp; \".txt\"\n    Debug.Print fileNameForDownload\nLoop\n\nfullGetCommand = \"get \" &amp; fileToGet &amp; \" \" &amp; fileNameForDownload\n\nDebug.Print fullGetCommand\nDebug.Print sFtpLogFile\n\n'Create FTP process file\niFreeFile = FreeFile\nOpen sWorkingDirectory &amp; FTP_BATCH_FILE_NAME For Output As #iFreeFile\nPrint #iFreeFile, \"open \" &amp; FTP_ADDRESS\nPrint #iFreeFile, FTP_USERID\nPrint #iFreeFile, FTP_PASSWORD\nPrint #iFreeFile, \"lcd \" &amp; sWorkingDirectory\nPrint #iFreeFile, fullGetCommand\nPrint #iFreeFile, \"quit\"\nClose #iFreeFile\n\n'Shell command the FTP file to the server\nChDir sWorkingDirectory\nDebug.Print \"Current Directory = \" &amp; CurDir()\nfullShellCommand = \"ftp -i -w:20480 -s:\" &amp; FTP_BATCH_FILE_NAME &amp; \"&gt;\" &amp; sFtpLogFile\nDebug.Print fullShellCommand\n\nShell fullShellCommand\n\ngetFilesViaFTP = True\nChDir myCurrentDirectory\nDebug.Print \"New Current Directory = \" &amp; CurDir()\n\nGoTo NoErrorsInProc\n\nEncounteredErrorInProc:\n    MsgBox \"Err\", Err.Name\n\n NoErrorsInProc:\n\nExit Function\nEnd Function\n</code></pre>\n\n<p>Thanks. </p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1520392449, "post_id": 49142029, "comment_id": 85292352, "body": "Are you trying to access the selected items in Outlook? <a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/application-activeexplorer-method-outlook\" rel=\"nofollow noreferrer\"><code>ActiveExplorer.Selection</code></a>"}, {"owner": {"reputation": 157, "user_id": 9324260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f251ad2125b209a1fd1d4b4f2073c4d3?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/9324260/daniel-williams"}, "edited": false, "score": 0, "creation_date": 1520474373, "post_id": 49142029, "comment_id": 85333935, "body": "I&#39;m trying to have a script run through each selected mail (or mail in a folder) and then forward it to an address."}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9324260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f251ad2125b209a1fd1d4b4f2073c4d3?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/9324260/daniel-williams"}, "edited": false, "score": 1, "creation_date": 1521061916, "post_id": 49227329, "comment_id": 85578404, "body": "Was able to take this and run with it. Thanks!"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1534262490, "last_edit_date": 1534262490, "creation_date": 1520821546, "answer_id": 49227329, "question_id": 49142029, "link": "https://stackoverflow.com/questions/49142029/iterating-through-multiple-selection-folder-items/49227329#49227329", "title": "Iterating through multiple Selection / Folder items", "body": "<p><em>To loop through selection items use <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/for-each-next-statement\" rel=\"nofollow noreferrer\">For...Next Statement Loop [MSDN]</a></em></p>\n\n<hr>\n\n<p><em>Syntax</em></p>\n\n<blockquote>\n  <p><code>For counter = initial_value To end_value [Step step-counter]</code></p>\n</blockquote>\n\n<p><strong><em><a href=\"https://msdn.microsoft.com/en-us/vba/outlook-vba/articles/application-activeexplorer-method-outlook\" rel=\"nofollow noreferrer\">Example on Selection Items</a></em></strong></p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim Item As Outlook.mailitem\n    Dim i As Long\n\n    For i = ActiveExplorer.Selection.Count To 1 Step -1\n    Set Item = ActiveExplorer.Selection.Item(i)\n        Debug.Print Item.Subject\n        ' Call Sub\n    Next\nEnd Sub\n</code></pre>\n\n<p>Example on Folder Items</p>\n\n<pre><code>Option Explicit\nPublic Sub Example()\n    Dim Inbox As Outlook.folder\n    Set Inbox = Application.Session.GetDefaultFolder( _\n                                    olFolderInbox _\n                                    )\n\n\n    Dim Items As Outlook.Items\n    Set Items = Inbox.Items\n\n    Dim i As Long\n    For i = Items.Count To 1 Step -1\n        DoEvents\n        Debug.Print Items(i) 'Print on Immediate Window\n    Next\nEnd Sub\n</code></pre>\n\n<p><strong><em><a href=\"https://msdn.microsoft.com/en-us/library/aa262728(v=vs.60).aspx\" rel=\"nofollow noreferrer\">DoEvents MSDN</a> &amp; <a href=\"https://stackoverflow.com/questions/2916287/where-does-vba-debug-print-log-to\">Debug.Print SO Link</a></em></strong></p>\n\n<hr>\n\n<blockquote>\n  <p><sub> <strong>Description</strong><br>\n  <em>loop executes a given number of times, as determined by a loop counter. To use the For...Next loop, you must assign a numeric value to a counter variable. This counter is either incremented or decremented automatically with each iteration of the loop. In For statement, you specify the value that is to be assigned to the counter initially and the maximum value the counter will reach for the block of code to be executed. The Next statement marks the end of the block of code that is to execute repeatedly, and also serves as a kind of flag that indicates the counter variable is to be modified.</em></sub></p>\n  \n  <hr>\n</blockquote>\n\n<p><strong><em><a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office-2003/aa211818(v=office.11)\" rel=\"nofollow noreferrer\">CurrentFolder Property</a></em></strong></p>\n\n<blockquote>\n  <p><sub>Returns or sets a MAPIFolder object that represents the current folder displayed in the explorer. Use this property to change the folder the user is viewing.</sub></p>\n</blockquote>\n"}], "owner": {"reputation": 157, "user_id": 9324260, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f251ad2125b209a1fd1d4b4f2073c4d3?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Williams", "link": "https://stackoverflow.com/users/9324260/daniel-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 49227329, "answer_count": 1, "score": 1, "last_activity_date": 1592993015, "creation_date": 1520380966, "last_edit_date": 1592993015, "question_id": 49142029, "link": "https://stackoverflow.com/questions/49142029/iterating-through-multiple-selection-folder-items", "title": "Iterating through multiple Selection / Folder items", "body": "<p>I took at a look at <code>MailItem</code> and didn't see anything that would indicate that I could shift select items. </p>\n\n<p>I have code that functions however, the <code>Set objItem = GetCurrentItem()</code> line only takes one mail. </p>\n\n<p>I'm looking to either <code>ForEach</code> through a folder, or <code>ForEach</code> through a selection. </p>\n\n<p>I tried something like </p>\n\n<pre><code>Sub ListMailsInFolder()\nDim objNS As Outlook.NameSpace\nDim objFolder As Outlook.MAPIFolder\n\nSet objNS = GetNamespace(\"MAPI\")\nSet objFolder = objNS.Folders.GetFirst ' folders of your current account\nSet objFolder = objFolder.Folders(\"Foldername\").Folders(\"Subfoldername\")\n\nFor Each Item In objFolder.Items\n</code></pre>\n\n<p>I don't have any idea what I'm doing.</p>\n\n<p>Here is the code I'm trying to execute on multiple emails:</p>\n\n<pre><code>Sub HelpdeskNewTicket()\nDim helpdeskaddress As String\nDim objMail As Outlook.MailItem\nDim strbody As String\nDim oldmsg As String\nDim senderaddress As String\nDim addresstype As Integer\n\n' Set this variable as your helpdesk e-mail address\nhelpdeskaddress = \"danielbelamiinc@gmail.com\"\n\nSet objItem = GetCurrentItem()\nSet objMail = objItem.Forward\n\n' Sender E=mail Address\nsenderaddress = objItem.SenderEmailAddress\n\nstrbody = objItem.Body\n\nobjMail.To = helpdeskaddress\nobjMail.Subject = objItem.Subject\nobjMail.Body = strbody\n\n'Automatically Send the ticket\nobjMail.Send\n\nSet objItem = Nothing\nSet objMail = Nothing\nEnd Sub\n\n\nFunction GetCurrentItem() As Object\nDim objApp As Outlook.Application\nSet objApp = Application\nOn Error Resume Next\nSelect Case TypeName(objApp.ActiveWindow)\nCase \"Explorer\"\nSet GetCurrentItem = _\nobjApp.ActiveExplorer.Selection.Item(1)\nCase \"Inspector\"\nSet GetCurrentItem = _\nobjApp.ActiveInspector.CurrentItem\nCase Else\nEnd Select\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "reference", "office-2016"], "answers": [{"comments": [{"owner": {"reputation": 100, "user_id": 6791681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6f96af1619cb0506a772720e1b7e13?s=128&d=identicon&r=PG&f=1", "display_name": "JakeyG", "link": "https://stackoverflow.com/users/6791681/jakeyg"}, "edited": false, "score": 0, "creation_date": 1520421874, "post_id": 49146195, "comment_id": 85305615, "body": "I have heard the terms &quot;early binding&quot; and &quot;late binding&quot; and never known what it related to or bothered to look it up - thanks! Problem solved and learned something new :-)"}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1520407052, "creation_date": 1520407052, "answer_id": 49146195, "question_id": 49141959, "link": "https://stackoverflow.com/questions/49141959/vba-reference-changed-version-automatically/49146195#49146195", "title": "VBA reference changed version automatically", "body": "<p>This is standard behaviour. </p>\n\n<p>You need to move from Early to Late binding. Remove the Outlook reference in VBE and declare the outlook application as <code>Object</code> in code.</p>\n\n<pre><code>Dim olApp As Object\nSet olApp = CreateObject(\"Outlook.Application\")\n</code></pre>\n\n<p>Bare in mind by doing so you will lose intellisense and you may have to change some constants to their numeric values, e.g. <code>olMailItem</code> to <code>0</code>.</p>\n\n<p>Make sure you have <code>Option Explicit</code> at the very top of your module(s), as this will highlight compilation errors.</p>\n"}], "owner": {"reputation": 100, "user_id": 6791681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bf6f96af1619cb0506a772720e1b7e13?s=128&d=identicon&r=PG&f=1", "display_name": "JakeyG", "link": "https://stackoverflow.com/users/6791681/jakeyg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520407052, "creation_date": 1520380498, "question_id": 49141959, "link": "https://stackoverflow.com/questions/49141959/vba-reference-changed-version-automatically", "title": "VBA reference changed version automatically", "body": "<p>I wrote some VBA in Excel 2013 which references Outlook and is now used on a virtual machine. My laptop was upgraded to Office 2016 last week, I made some changes in this tool and then it failed to run on the VM.</p>\n\n<p>Turns out the VBA Outlook reference in the file changed to v16.0 (Office 2016) and so when the VM tried to run the code (on 2013), it couldn't find this reference.</p>\n\n<p>There was also the generic Office reference which stayed as v15.0 though.</p>\n\n<p>I haven't been able to find any documentation on this - is this standard behaviour and if so, any ideas on how I can make further changes to this file without the reference messing up every time?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1520379819, "post_id": 49141789, "comment_id": 85289186, "body": "Try r.value*-1. Any difference?"}, {"owner": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "edited": false, "score": 0, "creation_date": 1520379854, "post_id": 49141789, "comment_id": 85289193, "body": "Do you have the same problem if instead of r.Value = -r.Value, you have r.Value = r.Value * -1?"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1520379909, "post_id": 49141789, "comment_id": 85289208, "body": "@CallumDA gave that a shot just now - does not work.  it&#39;ll work with any number that is positive in the original file but none of the ones that are negative in the original file"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "edited": false, "score": 0, "creation_date": 1520379959, "post_id": 49141789, "comment_id": 85289228, "body": "@thursdaysgeek yes I do have the same issue.  it will give me the same results where if the number in the original file is positive, it&#39;ll work as intended.  if the number in the original file is negative, it will stay negative still"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 7220, "user_id": 22523, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/3ea8bec1de7ea63d2c0161c7a9a02ac2?s=128&d=identicon&r=PG", "display_name": "thursdaysgeek", "link": "https://stackoverflow.com/users/22523/thursdaysgeek"}, "edited": false, "score": 0, "creation_date": 1520380233, "post_id": 49141789, "comment_id": 85289305, "body": "@thursdaysgeek I just figured it out - I have the line &quot;If c.Value &gt; 0 then ...&quot; which is why the negatives aren&#39;t being pulled in.  Do you know how I can change this to be &quot;if c.Value has any numerical value at all then...&quot;?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1520380315, "post_id": 49141789, "comment_id": 85289335, "body": "Try the IsNumeric() function"}, {"owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "reply_to_user": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1520380840, "post_id": 49141789, "comment_id": 85289491, "body": "@CallumDA That works!  Thank you!!!!"}], "owner": {"reputation": 65, "user_id": 9226292, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d3e330dd3e73989c0297a31bed9d7b72?s=128&d=identicon&r=PG&f=1", "display_name": "J Doe", "link": "https://stackoverflow.com/users/9226292/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1520379374, "creation_date": 1520379374, "question_id": 49141789, "link": "https://stackoverflow.com/questions/49141789/excel-vba-flipping-numerical-sign", "title": "Excel VBA - Flipping Numerical Sign", "body": "<p>I have some code that copies data from one tab and pastes it into another tab then flips the numerical sign on an entire column.  Example, -1 in original tab turns to 1 while 1 in original tab turns to -1.  </p>\n\n<p>For some reason, if the number in the original tab is a negative, it will not turn positive.  If the number in the original tab is a positive, it will turn negative just fine.  Any ideas of what might be causing this? </p>\n\n<p>The last 3 lines of code is what ultimately flips the signs but I pasted my entire sub in case there's something elsewhere causing the issue.  Thank you in advance!</p>\n\n<pre><code>Sub prep()\n\nDim c As Range\nDim IRow As Long, lastrow As Long\nDim rSource As Range\nDim wsI As Worksheet, wsO As Worksheet\nDim d As Range\nDim dSource As Range\nDim LR As Long\n\n\n\nOn Error GoTo Whoa\n\n\nSet wsI = ThisWorkbook.Sheets(\"Ben\")\n\nSet wsO = ThisWorkbook.Sheets(\"Upload\")\n\nApplication.ScreenUpdating = False\n\n\nwsO.Range(\"P14\", \"AB10000\").ClearContents\n\nendrow = wsO.Cells(Rows.Count, \"T\").End(xlUp).Row + 1\n\nWith wsI\n\n    If Application.WorksheetFunction.CountA(.Cells) &lt;&gt; 0 Then\n\n\n        lastrow = .Columns(\"O:R\").Find(What:=\"*\", _\n                      After:=.Range(\"O1\"), _\n                      Lookat:=xlPart, _\n                      LookIn:=xlFormulas, _\n                      SearchOrder:=xlByRows, _\n                      SearchDirection:=xlPrevious, _\n                      MatchCase:=False).Row\n    Else\n        lastrow = 1\n    End If\n\n\n    Set rSource = .Range(\"R1:R\" &amp; lastrow)\n\n\n\n    For Each c In rSource\n\n\n        Debug.Print c.Value\n\n\n        If IsNumeric(c.Value) Then\n            If c.Value &gt; 0 Then\n                wsO.Cells(14 + IRow, 20).Resize(1, 4).Value = _\n                     .Range(\"O\" &amp; c.Row &amp; \":R\" &amp; c.Row).Value\n\n                wsO.Cells(14 + IRow, 25).Value = \"XXXXXX\" &amp; .Range(\"J\" &amp; c.Row).Value\n\n                wsO.Cells(14 + IRow, 28).Value = .Range(\"N\" &amp; c.Row).Value\n\n                wsO.Cells(14 + IRow, 16).Value = \"470\"\n\n                wsO.Cells(14 + IRow, 17).Value = \"I\"\n\n                wsO.Cells(14 + IRow, 18).Value = \"80\"\n\n                wsO.Cells(14 + IRow, 19).Value = \"A\"\n\n                IRow = IRow + 1\n            End If\n        End If\n\n\n    Next\n\nEnd With\n\n\nFor Each r In Range(\"W14\", Range(\"W\" &amp; Rows.Count).End(xlUp))\n            r.Value = -r.Value\nNext r\n</code></pre>\n"}, {"tags": ["c#", ".net", "vba", "com"], "comments": [{"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1520381666, "post_id": 49141775, "comment_id": 85289752, "body": "Your VBA code makes the C# object eligible for garbage collection.  Which, if that happens, also finalizes the RCWs that it uses to talk to the 3rd party component.  The &quot;if that happens&quot; clause is the rub, the garbage collector only runs when it needs to.  You&#39;d have to help with, say, another C# object that exposes a method that calls GC.Collect()."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1520382032, "post_id": 49141775, "comment_id": 85289865, "body": "There is a desperado approach in <a href=\"https://stackoverflow.com/a/6905172/17034\">this answer</a>, no real idea how much trouble that could cause.  The typical problem doing this is that it is hard to find all interface references and missing just one of them is an undebuggable fail whale.  Otherwise the reason why GC.Collect is better than Marshal.ReleaseComObject."}, {"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1520550336, "post_id": 49141775, "comment_id": 85373803, "body": "Thank you for your input Hans. Have been reading up on this issue including the article your suggested  (and articles related) for a day or two now, and my head is buzzing. A lot of their content is above for my expertise level. However, from you first comment I got that a destructor (finalizer) is not called when an object is dereferenced in VBA  - and that that is up to the GC. That does not solve my problem but gives me confidence I am not completely crazy. I will stick to my requierement of explicitly &#39;closing&#39; objects after use for now."}], "answers": [{"comments": [{"owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "edited": false, "score": 0, "creation_date": 1520424773, "post_id": 49142119, "comment_id": 85307466, "body": "I am confident I implemented the Dispose pattern properly. Thanks for the other suggestions, but they are not an option in the scenario I am trying to develop."}], "tags": [], "owner": {"reputation": 1404, "user_id": 643342, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/BAdMW.png?s=128&g=1", "display_name": "this", "link": "https://stackoverflow.com/users/643342/this"}, "is_accepted": false, "score": -1, "last_activity_date": 1520382625, "last_edit_date": 1520382625, "creation_date": 1520381669, "answer_id": 49142119, "question_id": 49141775, "link": "https://stackoverflow.com/questions/49141775/make-com-visible-net-assembly-release-com-reference/49142119#49142119", "title": "Make COM-visible .NET assembly release COM reference", "body": "<p>You say you implemented the disposal pattern but did you implement the full pattern, not just the public <code>Dispose</code> method, in particular the one with the finalizer, e.g. something similar to below?</p>\n\n<pre><code>~ComplexResourceHolder(){  \n    Dispose(false);  \n}\n</code></pre>\n\n<p><a href=\"https://docs.microsoft.com/en-us/dotnet/standard/design-guidelines/dispose-pattern\" rel=\"nofollow noreferrer\">Dispose pattern</a></p>\n\n<p>Please note that this is still non-deterministic; the finalizer may run much much later than the point when VBA consumers sets it to <code>Nothing</code>, but at least it will eventually release the object. If you MUST have a deterministic release, then we need to rethink the approach.</p>\n\n<p>One possible but simplistic option that may simplify the operation is to only take reference to the 3rd party COM component within each of your public method and release it at the end. That might work as long the typical usage don't normally call several methods on same object in succession.</p>\n\n<p>The other simple option is to allow the VBA consumer assign the 3rd party COM object to the managed object so VBA can then manage the lifetime of that component, rather than the .NET. </p>\n\n<p>There may be other options but they will be quite challenging to implement and won't be as foolproof.</p>\n"}], "owner": {"reputation": 610, "user_id": 1471828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bb14b50e9aac56f1d4bbbc7cb1a7734?s=128&d=identicon&r=PG", "display_name": "Rno", "link": "https://stackoverflow.com/users/1471828/rno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520382625, "creation_date": 1520379275, "question_id": 49141775, "link": "https://stackoverflow.com/questions/49141775/make-com-visible-net-assembly-release-com-reference", "title": "Make COM-visible .NET assembly release COM reference", "body": "<p>I have a C# assembly that is COM-visible. It in turn communicates with a 3rd-party COM application. My problem is that when I release the reference to my C# assembly from VBA, the C# assembly keeps the 3-rd party application open.</p>\n\n<pre><code>' Call assembly from VBA\nDim asm : Set asm = CreateObject(\"MyCSharpAssembly\") \n\n' Get a managed object exposed by the assembly\n' managedObject communicates with a 3-rd party COM application\nDim managedObject : Set managedObject = asm.GetManagedObject()\n\n' When I release managedObject from VBA, the 3rd party application stays open.\nSet managedObject = Nothing\n</code></pre>\n\n<p>I have tried implementing the IDisposable pattern in the managedObject and explicitly release the COM object. That works, but I still have to explicitly call the Dispose method from VBA. Just setting the reference to managedObject to Nothing is not enough. This is easily forgotten by VBA coders, who may assume setting the object to Nothing is enough.</p>\n\n<p>Is there any way I can code around that from the C# perspective, or do I have to stick with the explicit Dispose?</p>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 3412495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A1nLe.png?s=128&g=1", "display_name": "CiViCChiC79", "link": "https://stackoverflow.com/users/3412495/civicchic79"}, "edited": false, "score": 0, "creation_date": 1520435033, "post_id": 49141601, "comment_id": 85314493, "body": "Please re-read my post, this does not answer my question.  But I have already found a solution.  Thanks!"}, {"owner": {"reputation": 5814, "user_id": 4408538, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/cPoEu.jpg?s=128&g=1", "display_name": "Joseph Wood", "link": "https://stackoverflow.com/users/4408538/joseph-wood"}, "edited": false, "score": 1, "creation_date": 1520437683, "post_id": 49141601, "comment_id": 85316577, "body": "The OP is asking about a userform closing not a workbook (<i>&quot;the original Workbook remains open, however, the vbModeless UserForm that was previously visible has been killed&quot;</i>).  Also, I think it is evident that the OP understands how <code>Application.Quit</code> or <code>ThisWorkbook.Close</code> works."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1520378272, "creation_date": 1520378272, "answer_id": 49141601, "question_id": 49141556, "link": "https://stackoverflow.com/questions/49141556/why-does-macro-enabled-excel-workbook-kill-userform-in-another-macro-enabled-exc/49141601#49141601", "title": "Why does Macro Enabled Excel Workbook kill UserForm in another Macro Enabled Excel Workbook when closed?", "body": "<p>This is what is happening:</p>\n\n<ul>\n<li><p>Assuming that both workbooks are in the same Excel Application, <code>Application.Quit</code> would close them both.</p></li>\n<li><p><code>ThisWorkbook.Close</code> will close the workbook, in which the code is present.</p></li>\n</ul>\n\n<p>Thus, concerning your question - you are not closing the second workbook with <code>ThisWorkbook.Close</code>, but you are closing the workbook, which has the <code>btnExit</code> button, on which you have clicked. I guess that both the workbooks are quite similar and you are mistaken which one you are closing?</p>\n"}, {"comments": [{"owner": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 1, "creation_date": 1520408081, "post_id": 49141669, "comment_id": 85297507, "body": "You might want to expand your answer."}, {"owner": {"reputation": 31, "user_id": 3412495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A1nLe.png?s=128&g=1", "display_name": "CiViCChiC79", "link": "https://stackoverflow.com/users/3412495/civicchic79"}, "reply_to_user": {"reputation": 1118, "user_id": 8282232, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/775ef4ecf830083680ae6dbae8da395c?s=128&d=identicon&r=PG&f=1", "display_name": "AntiDrondert", "link": "https://stackoverflow.com/users/8282232/antidrondert"}, "edited": false, "score": 0, "creation_date": 1520435371, "post_id": 49141669, "comment_id": 85314769, "body": "The form in the first workbook was modeless and the form in the second workbook was modal.  I changed the second form to modeless and the problem was corrected.  Meaning when I closed the second workbook using the Exit button, the UserForm displayed in the first workbook was not killed."}], "tags": [], "owner": {"reputation": 31, "user_id": 3412495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A1nLe.png?s=128&g=1", "display_name": "CiViCChiC79", "link": "https://stackoverflow.com/users/3412495/civicchic79"}, "is_accepted": false, "score": -1, "last_activity_date": 1520378675, "creation_date": 1520378675, "answer_id": 49141669, "question_id": 49141556, "link": "https://stackoverflow.com/questions/49141556/why-does-macro-enabled-excel-workbook-kill-userform-in-another-macro-enabled-exc/49141669#49141669", "title": "Why does Macro Enabled Excel Workbook kill UserForm in another Macro Enabled Excel Workbook when closed?", "body": "<p>Changing the second Workbook's form containing the Exit button to vbModeless fixed the problem!!!! Yay!!!!!</p>\n"}], "owner": {"reputation": 31, "user_id": 3412495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A1nLe.png?s=128&g=1", "display_name": "CiViCChiC79", "link": "https://stackoverflow.com/users/3412495/civicchic79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1520378675, "creation_date": 1520377928, "question_id": 49141556, "link": "https://stackoverflow.com/questions/49141556/why-does-macro-enabled-excel-workbook-kill-userform-in-another-macro-enabled-exc", "title": "Why does Macro Enabled Excel Workbook kill UserForm in another Macro Enabled Excel Workbook when closed?", "body": "<p>Scenario:\nUser is running a macro-enabled Excel Workbook.  User clicks a link on a UserForm that launches another macro-enabled Excel Workbook that also has user forms.  The second Workbook is then closed using the following code:</p>\n\n<pre><code>Private Sub btnExit_Click()\n\n'Check if other Excel files are open before quitting the application\nIf Workbooks.Count = 1 Then\n    Application.Quit\nElse\n    ThisWorkbook.Close\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>and...</p>\n\n<pre><code>Private Sub Workbook_BeforeClose(Cancel As Boolean)\n\nDim intResponse As Integer\n\nIf MsgBox(\"Are you sure you would like to exit the calculator?\", vbYesNo + vbQuestion) = vbNo Then\n    Cancel = True\nEnd If\n\nThisWorkbook.Saved = True\n\nEnd Sub\n</code></pre>\n\n<p>Upon closing of the second Workbook (ThisWorkbook.Close), the original Workbook remains open, however, the vbModeless UserForm that was previously visible has been killed.  It might also be pertinent to mention that the second Workbook's forms are Modal.</p>\n\n<p>If the second Workbook is closed using the Excel exit button in the upper right corner, this problem does not occur.</p>\n\n<p>Does anyone know why this is happening?  Is it because code execution for Excel.Application is ceased when the Workbook is closed programmatically?  Could it be due to the difference in form modes?  Is there a work-around other than putting a button on the original Workbook in a Sheet to re-launch the UserForm?</p>\n\n<p>Many thanks for any assistance with this issue!!\nCiViCChiC79</p>\n"}, {"tags": ["excel", "ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9403427, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5e68680111e855e1448c16a6e7b88129?s=128&d=identicon&r=PG&f=1", "display_name": "Accexcessel", "link": "https://stackoverflow.com/users/9403427/accexcessel"}, "edited": false, "score": 0, "creation_date": 1520383294, "post_id": 49141422, "comment_id": 85290223, "body": "Thanks for your answer, but I would like to have that arrow in the upper cells that says: &quot;Sort A-Z, Sort Z-A, Find..&quot; and those things like in Pivot Tables or in Access. How can I do that?"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 1, "last_activity_date": 1520377133, "creation_date": 1520377133, "answer_id": 49141422, "question_id": 49141200, "link": "https://stackoverflow.com/questions/49141200/format-when-exporting-data-from-access-to-excel/49141422#49141422", "title": "Format when exporting data from Access to Excel", "body": "<p>Add the following</p>\n\n<pre><code>With TargetRange.Resize(,rs.Fields.Count)\n    .Interior.Color = vbBlack\n    .Font.Color = vbBlack\n    .EntireColumn.AutoFit\nEnd with\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 9403427, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5e68680111e855e1448c16a6e7b88129?s=128&d=identicon&r=PG&f=1", "display_name": "Accexcessel", "link": "https://stackoverflow.com/users/9403427/accexcessel"}, "edited": false, "score": 0, "creation_date": 1520383287, "post_id": 49141428, "comment_id": 85290219, "body": "Thanks for your answer, but I would like to have that arrow in the upper cells that says: &quot;Sort A-Z, Sort Z-A, Find..&quot; and those things like in Pivot Tables or in Access. How can I do that?"}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": false, "score": 2, "last_activity_date": 1520377173, "creation_date": 1520377173, "answer_id": 49141428, "question_id": 49141200, "link": "https://stackoverflow.com/questions/49141200/format-when-exporting-data-from-access-to-excel/49141428#49141428", "title": "Format when exporting data from Access to Excel", "body": "<p>You can use the following code to import from Excel.</p>\n\n<pre><code>Dim i As Long\nFor i = 0 To rs.Fields.Count - 1\n    TargetRange.Offset(0, i).Value = rs.Fields(i).NAME\n    TargetRange.Offset(0, i).Columns.AutoFit 'Autosize column\nNext\nWith Application.ActiveSheet.ListObjects.Add(1, TargetRange.CurrentRegion, , , 1) 'xlSrcRange, xlYes\n    .Name = \"MyTable\"\n    .TableStyle = \"TableStyleLight1\"\nEnd With\n</code></pre>\n\n<p>This formats as a table (with those dropdown arrows) and autoresizes.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8909964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1df420517363b09ff99c2070fdcab962?s=128&d=identicon&r=PG", "display_name": "freeflyz", "link": "https://stackoverflow.com/users/8909964/freeflyz"}, "is_accepted": false, "score": 0, "last_activity_date": 1520454438, "creation_date": 1520454438, "answer_id": 49160647, "question_id": 49141200, "link": "https://stackoverflow.com/questions/49141200/format-when-exporting-data-from-access-to-excel/49160647#49160647", "title": "Format when exporting data from Access to Excel", "body": "<p>When you mention arrows in the upper cells, I think you're talking about adding a filter. Is this what you had in mind?</p>\n\n<pre><code> TargetRange.AutoFilter\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9403427, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/5e68680111e855e1448c16a6e7b88129?s=128&d=identicon&r=PG&f=1", "display_name": "Accexcessel", "link": "https://stackoverflow.com/users/9403427/accexcessel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1520454438, "creation_date": 1520375885, "last_edit_date": 1520377124, "question_id": 49141200, "link": "https://stackoverflow.com/questions/49141200/format-when-exporting-data-from-access-to-excel", "title": "Format when exporting data from Access to Excel", "body": "<p>I created a code that copies the data of an Access table and pastes it on an Excel spreadsheet, but I need the first row to be in a different format (with an extensible option menu like in Access). </p>\n\n<p>I mean, this is my first row:\n<img src=\"https://i.stack.imgur.com/i0PEX.jpg\" alt=\"this\"></p>\n\n<p>And this is what I would like it to be: \n<img src=\"https://i.stack.imgur.com/4v3zY.jpg\" alt=\"this\"></p>\n\n<p>The objects are created with:</p>\n\n<pre><code>Set cn = CreateObject(\"ADODB.Connection\")\n\ncn.Open \"Provider=Microsoft.Jet.OLEDB.4.0; Data Source=\" &amp; DBFullName &amp; \";\" \n\nSet rs = CreateObject(\"ADODB.Recordset\")\n\nrs.Open \"SELECT * FROM Table1\", cn, , , adCmdText\n</code></pre>\n\n<p>This is the part of the code where I paste the headers:</p>\n\n<pre><code>For intColIndex = 0 To (rs.Fields.Count - 1) \n\n    TargetRange.Offset(0, intColIndex).Value = rs.Fields(intColIndex).Name \n\nNext\n</code></pre>\n\n<p>And then I paste the data with:</p>\n\n<pre><code>TargetRange.Offset(1, 0).CopyFromRecordset rs\n</code></pre>\n\n<hr>\n\n<p>Another thing I would also like to change is the width of the cells, because when I paste the Access data all the cells are of the same width and it looks awful. How can I do that?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 2, "creation_date": 1520374867, "post_id": 49140926, "comment_id": 85287329, "body": "Maybe try using a site like <a href=\"https://regex101.com\" rel=\"nofollow noreferrer\">regex101.com</a> where you or others can play with the regex pattern."}, {"owner": {"reputation": 23, "user_id": 9453668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca7835f3ed01dc25711c9a60d584507?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Viczian", "link": "https://stackoverflow.com/users/9453668/martin-viczian"}, "reply_to_user": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 0, "creation_date": 1520374939, "post_id": 49140926, "comment_id": 85287356, "body": "as I said, the regexpattern is not a problem, the problem is the datatype."}, {"owner": {"reputation": 40086, "user_id": 499581, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1ba2cebc4582467916f2ddd6128447f4?s=128&d=identicon&r=PG", "display_name": "l&#39;L&#39;l", "link": "https://stackoverflow.com/users/499581/lll"}, "edited": false, "score": 1, "creation_date": 1520374990, "post_id": 49140926, "comment_id": 85287377, "body": "Posting images of your pattern is not helpful to others \u2014 that is what I am explaining."}, {"owner": {"reputation": 23, "user_id": 9453668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca7835f3ed01dc25711c9a60d584507?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Viczian", "link": "https://stackoverflow.com/users/9453668/martin-viczian"}, "edited": false, "score": 0, "creation_date": 1520375112, "post_id": 49140926, "comment_id": 85287431, "body": "Yes. Actually, the M char and the x char are not being recognized. I just don&#39;t know, how to analyze them"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9453668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca7835f3ed01dc25711c9a60d584507?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Viczian", "link": "https://stackoverflow.com/users/9453668/martin-viczian"}, "edited": false, "score": 1, "creation_date": 1520545542, "post_id": 49141554, "comment_id": 85371761, "body": "awesome , my solution to it wasn&#39;t quite as neat, as this one. Didn&#39;t even know that you could access Unicode in regex like that! Thanks so much!"}], "tags": [], "owner": {"reputation": 3034, "user_id": 6101071, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b1da77c00202a8477bee1a68950824f?s=128&d=identicon&r=PG&f=1", "display_name": "Srdjan M.", "link": "https://stackoverflow.com/users/6101071/srdjan-m"}, "is_accepted": true, "score": 1, "last_activity_date": 1520377925, "creation_date": 1520377925, "answer_id": 49141554, "question_id": 49140926, "link": "https://stackoverflow.com/questions/49140926/type-of-text-blocks-regex-function/49141554#49141554", "title": "Type? of text blocks regEx function", "body": "<p>Two chars <a href=\"https://unicode-table.com/de/041C/\" rel=\"nofollow noreferrer\"><code>M</code></a> and <a href=\"https://unicode-table.com/de/0445/\" rel=\"nofollow noreferrer\"><code>x</code></a> are part of Cyrillic letters and they are represented in regex as <code>\\u041C</code> (<code>M</code>) and <code>\\u0445</code> (<code>x</code>).</p>\n\n<p><a href=\"https://regex101.com/r/zEfj1P/1\" rel=\"nofollow noreferrer\">Regex demo</a></p>\n\n<p><strong>VBA code</strong>:</p>\n\n<pre><code>Set re = CreateObject(\"VBScript.RegExp\")\nre.Global = True\n\nre.Pattern = \"\\u041C?\\d+\\u0445\\d+\"\nFor Each Match In re.Execute(\"Screw \u041c4\u044520 , DIN7985\")\n    Debug.Print (Match)\nNext\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\u041c4\u044520\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 9453668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca7835f3ed01dc25711c9a60d584507?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Viczian", "link": "https://stackoverflow.com/users/9453668/martin-viczian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 49141554, "answer_count": 1, "score": 2, "last_activity_date": 1520464479, "creation_date": 1520374705, "last_edit_date": 1531164843, "question_id": 49140926, "link": "https://stackoverflow.com/questions/49140926/type-of-text-blocks-regex-function", "title": "Type? of text blocks regEx function", "body": "<p>I have recently started to use <code>regEx</code> for work and have now found a rather peculiar problem which I apparently can't solve myself...</p>\n\n<p>Problem: I receive data from customers (from all over the world) and have to analyze it. The data this time has some specialties.</p>\n\n<p>e.g. for raw data:</p>\n\n<p><code>Screw \u041c4\u044520 , DIN7985</code>           - This is the original text <strong>with</strong> the problem</p>\n\n<p><code>Screw M4x20 , DIN7985</code>           - This is manual written text, which gives me \n                                perfect results</p>\n\n<p>If I now try to pick out the dimension \"M4x20\" with following <code>regEx</code>:</p>\n\n<pre><code>(\\b[M]?\\d+x\\d+\\b)\n</code></pre>\n\n<p>it yields me no results... neither in Excel, nor in websites like <code>regExr</code>:</p>\n\n<p><a href=\"https://regex101.com/r/ka9jHv/1/\" rel=\"nofollow noreferrer\">Regex demo</a></p>\n\n<p>If I delete the <code>M4x20</code> and write it a new, I do get <a href=\"https://regex101.com/r/ka9jHv/2\" rel=\"nofollow noreferrer\"><strong>results</strong></a>.</p>\n\n<p>I have absolutely no idea where the problem lies, except that <strong>it is caused by the M char and the x char</strong> - for reference: the rest of the text/letters (a-z) also doesn't work. The numbers are working ok.</p>\n\n<p>Is there some way to analyze it?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>There is and I just found out: The letters are <a href=\"https://unicode-table.com/de/041C/\" rel=\"nofollow noreferrer\">Cyrillic letters</a> which are not being recognized.\nThough they can apparently be changed to latin letters quite easily.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1520375307, "post_id": 49140916, "comment_id": 85287507, "body": "Check out: <a href=\"https://stackoverflow.com/questions/26072295/average-if-greater-than-zero-vba\" title=\"average if greater than zero vba\">stackoverflow.com/questions/26072295/&hellip;</a>"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1520375384, "post_id": 49140916, "comment_id": 85287534, "body": "<code>Averageifs()?</code>  What have you tried"}], "answers": [{"tags": [], "owner": {"reputation": 839, "user_id": 6478363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/222535f9bbc7882d4d6d49fe6054a8a6?s=128&d=identicon&r=PG&f=1", "display_name": "TotsieMae", "link": "https://stackoverflow.com/users/6478363/totsiemae"}, "is_accepted": false, "score": 0, "last_activity_date": 1520375752, "creation_date": 1520375752, "answer_id": 49141166, "question_id": 49140916, "link": "https://stackoverflow.com/questions/49140916/find-average-of-all-non-zero-values-in-an-array/49141166#49141166", "title": "find average of all non-zero values in an array", "body": "<p>Try this (<strong>note:</strong> I didn't use the <em>varIncome</em> variable as it didn't seem necessary in order to get a result):</p>\n\n<pre><code>Sub avgNonZeroNumbers()\n'Declare:\nDim rng As Range\n\n'Initialize:\nSet rng = Sheet3.Range(\"B3:B7\") 'Change Sheet3 to your actual sheet's code name\n\n'   Print result to the Immediate window\n    Debug.Print WorksheetFunction.AverageIf(rng, \"&lt;&gt;0\")\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 293, "user_id": 5366091, "user_type": "registered", "accept_rate": 77, "profile_image": "https://graph.facebook.com/1029941630378984/picture?type=large", "display_name": "Robert Kendall", "link": "https://stackoverflow.com/users/5366091/robert-kendall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520375752, "creation_date": 1520374646, "last_edit_date": 1531161705, "question_id": 49140916, "link": "https://stackoverflow.com/questions/49140916/find-average-of-all-non-zero-values-in-an-array", "title": "find average of all non-zero values in an array", "body": "<p>I have populated an array with five values. The values were pulled from cells elsewhere in the spreadsheet. How do I find the average of all nonzero values? \nI tried a for-next loop, but couldn't skip the zero values without another conditional statement.  I assume there is a dedicated command for it.  Thanks in advance!</p>\n\n<pre><code>Dim varIncome as variant\nvarIncome = Application.Transpose(Range(\"B3:B7\").Value)\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1520374549, "post_id": 49140883, "comment_id": 85287176, "body": "Can you use Remove Duplicates that&#39;s on the data tab?"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 1, "creation_date": 1520375209, "post_id": 49140883, "comment_id": 85287466, "body": "You write &quot;data came in is present in column C&quot; but your code is referencing column B: where&#39;s the truth? And also show an example of your data before and after desired code behavior"}, {"owner": {"reputation": 1, "user_id": 9453693, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WpK_bI3VyIk/AAAAAAAAAAI/AAAAAAAAABc/Rtl7ZOyVZV4/photo.jpg?sz=128", "display_name": "Haider Imam", "link": "https://stackoverflow.com/users/9453693/haider-imam"}, "edited": false, "score": 0, "creation_date": 1520375853, "post_id": 49140883, "comment_id": 85287745, "body": "I don&#39;t think I was very clear with this. The entries aren&#39;t duplicate, all we want is to make sure we get one entry per week. So the entry before lets say todays entry, we should have gotten at least 7 days ago"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9453693, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WpK_bI3VyIk/AAAAAAAAAAI/AAAAAAAAABc/Rtl7ZOyVZV4/photo.jpg?sz=128", "display_name": "Haider Imam", "link": "https://stackoverflow.com/users/9453693/haider-imam"}, "edited": false, "score": 0, "creation_date": 1520375681, "post_id": 49140981, "comment_id": 85287659, "body": "The duplicates are within the same week but not on the same date, so I don&#39;t think excel will be able to pick up that they are repeated"}, {"owner": {"reputation": 1355, "user_id": 3097559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvowV.jpg?s=128&g=1", "display_name": "tysonwright", "link": "https://stackoverflow.com/users/3097559/tysonwright"}, "reply_to_user": {"reputation": 1, "user_id": 9453693, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WpK_bI3VyIk/AAAAAAAAAAI/AAAAAAAAABc/Rtl7ZOyVZV4/photo.jpg?sz=128", "display_name": "Haider Imam", "link": "https://stackoverflow.com/users/9453693/haider-imam"}, "edited": false, "score": 0, "creation_date": 1520376288, "post_id": 49140981, "comment_id": 85287933, "body": "If the day of the week is in Column A, and the potentially duplicate data is in column B, then the code is:  <code>ActiveSheet.Range(&quot;$A$1:$B$4&quot;).RemoveDuplicates Columns:=2, Header:=xlNo</code>"}, {"owner": {"reputation": 1355, "user_id": 3097559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvowV.jpg?s=128&g=1", "display_name": "tysonwright", "link": "https://stackoverflow.com/users/3097559/tysonwright"}, "reply_to_user": {"reputation": 1, "user_id": 9453693, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WpK_bI3VyIk/AAAAAAAAAAI/AAAAAAAAABc/Rtl7ZOyVZV4/photo.jpg?sz=128", "display_name": "Haider Imam", "link": "https://stackoverflow.com/users/9453693/haider-imam"}, "edited": false, "score": 1, "creation_date": 1520376323, "post_id": 49140981, "comment_id": 85287952, "body": "That will remove both column A and B when there is a duplicate in B."}], "tags": [], "owner": {"reputation": 1355, "user_id": 3097559, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lvowV.jpg?s=128&g=1", "display_name": "tysonwright", "link": "https://stackoverflow.com/users/3097559/tysonwright"}, "is_accepted": false, "score": 0, "last_activity_date": 1520374964, "creation_date": 1520374964, "answer_id": 49140981, "question_id": 49140883, "link": "https://stackoverflow.com/questions/49140883/delete-multiple-weekly-entries-in-vba/49140981#49140981", "title": "Delete multiple weekly entries in VBA", "body": "<p>The RemoveDuplicates method can be called in VBA, something like this:</p>\n\n<pre><code>ActiveSheet.Range(\"$A$1:$A$8\").RemoveDuplicates Columns:=1, Header:=xlNo\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9453693, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WpK_bI3VyIk/AAAAAAAAAAI/AAAAAAAAABc/Rtl7ZOyVZV4/photo.jpg?sz=128", "display_name": "Haider Imam", "link": "https://stackoverflow.com/users/9453693/haider-imam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520374964, "creation_date": 1520374435, "last_edit_date": 1520374462, "question_id": 49140883, "link": "https://stackoverflow.com/questions/49140883/delete-multiple-weekly-entries-in-vba", "title": "Delete multiple weekly entries in VBA", "body": "<p>I have a large number of data on excel and the date when the data came in is present in column C. I am trying to come up with a way to delete double entries in any week. I tried the following VBA code but it didn't work. Would really appreciate if I can get some help. </p>\n\n<pre><code>Sub deltrial()\n\nSheets(\"Sheet2\").Select\nDim rng1 As Range\nDim rng2 As Range\nDim i As Range\n\nDim j As Range\n\n\nSet rng1 = Range(\"B2:B58\")\nSet rng2 = Range(\"B3:B59\")\n\nFor Each i In rng1\nFor Each j In rng2\n\nIf j.Value - i.Value &lt; 6 Then\n\nj.ClearContents\nEnd If\n\nNext\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1520374210, "post_id": 49140680, "comment_id": 85287025, "body": "You need to explain a bit more. Do you mean if B2 on sheet 01 of workbook 1 is changed you want the date and time put in B2 of sheet 01t of workbook 2, and similarly for column C? You probably need to use the Workbook_SheetChange event to avoid having to repeat same code in all 31 sheets."}, {"owner": {"reputation": 13, "user_id": 2620128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccea719be085581c730e9ce48266d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr M", "link": "https://stackoverflow.com/users/2620128/mr-m"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1520433663, "post_id": 49140680, "comment_id": 85313529, "body": "Hi SJR, Thats Exatly what i mean, i also need it to work column E, F,H,I,K,L etc  and if the cell change is on Cell B2 on sheet 02 then place the timestamp in B2 on Sheet 02t etc"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 2620128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccea719be085581c730e9ce48266d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr M", "link": "https://stackoverflow.com/users/2620128/mr-m"}, "edited": false, "score": 0, "creation_date": 1520629041, "post_id": 49157319, "comment_id": 85409317, "body": "Hi SJR, I have tried the suggested code and it looks like the Sh.Name part is not working, If i place a Breakpoint on the End Select the r.Address is populated but the Sh.Name is not."}, {"owner": {"reputation": 13, "user_id": 2620128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccea719be085581c730e9ce48266d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr M", "link": "https://stackoverflow.com/users/2620128/mr-m"}, "edited": false, "score": 1, "creation_date": 1520631393, "post_id": 49157319, "comment_id": 85410315, "body": "I managed to get this to work, I ended up decalring a variable PS as a string and passing the Sh.Name to it. Now just working on updating the cells on Workbook2 while the file remains closed. Thank You for your Help SJR ! :)"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 13, "user_id": 2620128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccea719be085581c730e9ce48266d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr M", "link": "https://stackoverflow.com/users/2620128/mr-m"}, "edited": false, "score": 0, "creation_date": 1520867545, "post_id": 49157319, "comment_id": 85480482, "body": "Glad it worked. <code>Sheets(Cstr(Sh.Name &amp; &quot;t&quot;))</code> might work too."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1520441662, "creation_date": 1520441662, "answer_id": 49157319, "question_id": 49140680, "link": "https://stackoverflow.com/questions/49140680/timestamp-on-one-sheet-from-updated-cell-on-another-vba-excel/49157319#49157319", "title": "Timestamp on one sheet from updated cell on another VBA excel", "body": "<p>Try this. The code needs to go in the ThisWorkbook module of workbook 1 and you need to add the name of workbook 2.</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n\nDim r As Range\n\nOn Error GoTo safe_exit\nApplication.EnableEvents = False\n\nFor Each r In Target\n    Select Case r.Column\n        Case 2, 3, 5, 6, 8, 9, 11, 12 'b c e f h i k l\n            Workbooks(\"name of workbook2\").Sheets(Sh.Name &amp; \"t\").Range(r.Address).Value = Now()\n    End Select\nNext r\n\nsafe_exit:\nApplication.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 2620128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ccea719be085581c730e9ce48266d7a?s=128&d=identicon&r=PG&f=1", "display_name": "Mr M", "link": "https://stackoverflow.com/users/2620128/mr-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 49157319, "answer_count": 1, "score": 0, "last_activity_date": 1520441662, "creation_date": 1520373509, "last_edit_date": 1520378396, "question_id": 49140680, "link": "https://stackoverflow.com/questions/49140680/timestamp-on-one-sheet-from-updated-cell-on-another-vba-excel", "title": "Timestamp on one sheet from updated cell on another VBA excel", "body": "<p>I have a workbook with upto 31 sheets,(named (01),(02) etc, Each with the same format as per the screenshot below \n<img src=\"https://i.stack.imgur.com/JT8Zw.png\" alt=\"Workbook1\"> </p>\n\n<p>I wish to use the following code which I have found(with help from this forum :) ) to place a timestamp in a mirror file (WorkBook2) that will work out the difference from when column B and Column C in workbook 1 is changed.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Range(\"B:B, C:C\"), Target) Is Nothing Then 'add Columns that will be changed to BA:BA and BB:BB\n        'add error control\n        On Error GoTo safe_exit\n        'don't do anything until you know something has to be done\n        Dim r As Range\n        Application.EnableEvents = False\n        For Each r In Intersect(Range(\"B:B, C:C\"), Target) 'i know this would only work on the same sheet\n            r.Offset(0, 1).Value = Now()   'Need to get this section to populate workbook2\n        Next r\n    End If\nsafe_exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/EFl8b.png\" alt=\"Workbook2\"></p>\n\n<p>I know people have asked similar questions and im sorry if this is a duplicate but I really am lost on trying to get this to work. </p>\n\n<p>Edit - Workbook two sheets are named in the same way with just a \"t\" after ie (01t), (02t) etc </p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1520372871, "post_id": 49140428, "comment_id": 85286320, "body": "Start by \u201csetting\u201d worksheet object : set wsTop = Workbook.Sheets(&quot;Top-20&quot;) /  Set wsSub = Workbook.Sheets(&quot;Top US Sub-IG&quot;)"}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1520373031, "post_id": 49140428, "comment_id": 85286400, "body": "Explicitly \u201cDim\u201d all variables otherwise not explicitly declared values will be taken as of Variant type: Dim topAR As Range, topExp As Range, subAR As Range, subExp As Range"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1520374516, "post_id": 49140746, "comment_id": 85287163, "body": "Thank you for your suggestions. I tried running the code step-by-step but received an error message at &#39; Set wsTop = Workbook.Sheets(&quot;Top-20&quot;)&#39; stating &#39;Object required&#39;. Do you think this is because I need to name the range first within Excel?"}, {"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1520375416, "post_id": 49140746, "comment_id": 85287549, "body": "It now gives &#39;Subscript out of range&#39;. Do you think this is because Excel is having trouble recognizing because I have 10+ worksheets within the workbook?"}, {"owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1520435901, "post_id": 49140746, "comment_id": 85315225, "body": "It is throwing the error in Set wsTop = ActiveWorkbook.Sheets(&quot;Top-20&quot;)."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "edited": false, "score": 0, "creation_date": 1520441944, "post_id": 49140746, "comment_id": 85319527, "body": "then it means that the Active Workbook has not any sheet named after &quot;Top-20&quot;. If you are working with more than one workbook you&#39;d better explicitly reference the name of the Workbook, like for instance <code>Set wsTop = WorkBooks(&quot;MyWorkbookName&quot;).Sheets(&quot;myWorkSheetName&quot;)</code>"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1520374942, "last_edit_date": 1520374942, "creation_date": 1520373785, "answer_id": 49140746, "question_id": 49140428, "link": "https://stackoverflow.com/questions/49140428/vba-find-replace-based-on-cell-values/49140746#49140746", "title": "VBA Find Replace Based on Cell Values", "body": "<p>You have to adopt proper syntax for referencing Range objects</p>\n\n<p>May be this is what you\u2019re after</p>\n\n<pre><code>Sub FindReplace()\n\n    Dim topAR As Range, topExp As Range, subAR As Range, subExp As Range\n    Dim topFind As Variant, topReplace As Variant\n    Dim subFind As Variant, subReplace As Variant\n    Dim wsTop As Worksheet, wsSub As Worksheet\n\n    Set wsTop = ActiveWorkbook.Sheets(\"Top-20\")\n    Set wsSub = ActiveWorkbook.Sheets(\"Top US Sub-IG\")\n\n    Set topAR = wsTop.Range(\"C8:E28\")\n    Set topExp = wsTop.Range(\"M8:O28\")\n    Set subAR = wsSub.Range(\"D7:F22\")\n    Set subExp = wsSub.Range(\"L7:N22\")\n\n    Set topFind = wsTop.Range(\"H2\")\n    Set topReplace = wsTop.Range(\"I2\")\n    Set subFind = wsSub.Range(\"H2\")\n    Set subReplace = wsSub.Range(\"I2\")\n\n    topAR.Replace What:=topFind.Value, Replacement:=topReplace.Value, LookAt:= _\nxlPart, SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n    subAR.Replace What:=subFind.Value, Replacement:=subReplace.Value, LookAt:= _\nxlPart, SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6707353, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f2f3c0edc84474e9e5b3acaa26f9e00?s=128&d=identicon&r=PG&f=1", "display_name": "J.Woe", "link": "https://stackoverflow.com/users/6707353/j-woe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1864, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520374942, "creation_date": 1520372432, "last_edit_date": 1531164843, "question_id": 49140428, "link": "https://stackoverflow.com/questions/49140428/vba-find-replace-based-on-cell-values", "title": "VBA Find Replace Based on Cell Values", "body": "<p>I do not know what's wrong with my code below and am looking for a solution or any tips. </p>\n\n<p>The goal is to name 8 separate ranges in 2 separate worksheets, and create a Find &amp; Replace function. </p>\n\n<ul>\n<li>4 of the ranges are part of an Excel chart that uses an index match formula and thus needs a Find &amp; Replace function to update its values. </li>\n<li>The remaining 4 ranges are simply 4 cells I am using to reference what to Find in the formula and replace it with (topFind, topReplace, subFind and subReplace). </li>\n</ul>\n\n<p>The worksheets are also named but I am receiving an error when it comes to referencing the first 4 Excel ranges (topAR, topExp, subAR and subExp) and can't get down to the Find &amp; Replace function. </p>\n\n<p>I welcome any help you can provide. Thank you in advance!</p>\n\n<pre><code>Sub FindReplace()\n\nDim topAR, topExp, subAR, subExp As Range\nDim topFind As Variant, topReplace As Variant\nDim subFind As Variant, subReplace As Variant\nDim wsTop As Worksheet, wsSub As Worksheet\n\nwsTop = Workbook.Sheets(\"Top-20\")\nwsSub = Workbook.Sheets(\"Top US Sub-IG\")\n\nSet topAR = wsTop.Range.Cells(\"C8:E28\")\nSet topExp = wsTop.Range.Cells(\"M8:O28\")\nSet subAR = wsSub.Range.Cells(\"D7:F22\")\nSet subExp = wsSub.Range.Cells(\"L7:N22\")\n\ntopFind = wsTop.cell.Location(\"H2\")\ntopReplace = wsTop.cell.Location(\"I2\")\nsubFind = wsSub.cell.Location(\"H2\")\nsubReplace = wsSub.cell.Location(\"I2\")\n\nRange.topAR.Replace What:=\"topFind\", Replacement:=\"topReplace\", LookAt:= _\n    xlPart, SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False\n\n\n\nRange.topAR.Replace What:=\"subFind\", Replacement:=\"subReplace\", LookAt:= _\n    xlPart, SearchOrder:=xlByColumns, MatchCase:=False, SearchFormat:=False, \nReplaceFormat:=False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "email", "outlook", "format"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1520373238, "post_id": 49140209, "comment_id": 85286524, "body": "RangeToHtml uses Excel&#39;s PublishObjects to convert the range to an Html document. That document is full of poor quality CSS. Does PublishObjects not process this format correctly?  Finding a number that has not been formatted to your requirement within the Html document would be a nightmare. I believe it would be easier to create your own RangeToHtml function. This answer of mine may give you some ideas: <a href=\"https://stackoverflow.com/a/48896589/973283\">VBA Excel to Outlook font formatting</a>"}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1520374016, "post_id": 49140209, "comment_id": 85286918, "body": "@TonyDallimore.....Thanks for the reply.  The custom formatting is only red and green on an arrow that is up or down depending whether the value in the last column is a positive or negative number.  I was hoping for something quick and easy.  If it&#39;s not the end users are going to have to do without the arrows.  This is really a nice to have and not something that I&#39;m going to spend a great deal of time on.  thanks for your help......"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1520427571, "post_id": 49140209, "comment_id": 85309369, "body": "@Shaves  I do not understand. If the custom format you specify was used as a <code>NumberFormat</code> it would give different appearances for a numeric value depending on the value being postive, negative, zero or non-numeric. Such a format can be used to change the colour but you do not use this functionality. To change the colour of an arrow depending on the value of a different cell would require use of conditional formatting. My understanding is that PublishObjects handles conditional formatting."}, {"owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "edited": false, "score": 0, "creation_date": 1520433068, "post_id": 49140209, "comment_id": 85313099, "body": "@TonyDallimore............Thanks for the info.  I hadn&#39;t even considered conditional formatting.  I looked at the original document a little further and the red / green arrows are a result of conditional formatting.  I&#39;ll research some more and see if I can get the conditional formatting to carry over to the body of the e-mail.  Thanks again........"}], "owner": {"reputation": 774, "user_id": 3827115, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/K6s85.jpg?s=128&g=1", "display_name": "Shaves", "link": "https://stackoverflow.com/users/3827115/shaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 315, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593041117, "creation_date": 1520371531, "last_edit_date": 1593041117, "question_id": 49140209, "link": "https://stackoverflow.com/questions/49140209/paste-excel-range-to-outlook-email-body-with-custom-format", "title": "Paste Excel range to Outlook email body with custom format", "body": "<p>I'm developing a macro to paste a range (from Excel) into an Outlook email.  I'm using the \"Function RangetoHTML(rng As Range)\".  It works and pastes the range into the email with one exception. </p>\n\n<p>The range has a custom format and I would like to carry that format to the body of the email.</p>\n\n<p>This is the custom format:  </p>\n\n<blockquote>\n  <p><code>(* #,##0_);_(* (#,##0);_(* \"-\"??_);_(@_)</code></p>\n</blockquote>\n\n<p>This seems to be the applicable section of the function but I'm not sure how to incorporate the custom format in this code.</p>\n\n<pre><code>With TempWB.Sheets(1)\n\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n\n        Application.CutCopyMode = False\n\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n\n    End With\n</code></pre>\n\n<p>Any help would be greatly appreciated.  Thanks for taking the time to look at this.........</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 167, "user_id": 5363723, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f5d2ed5edfdceded20322aba47eaf9eb?s=128&d=identicon&r=PG&f=1", "display_name": "Malcolm Farrelle", "link": "https://stackoverflow.com/users/5363723/malcolm-farrelle"}, "edited": false, "score": 0, "creation_date": 1520371892, "post_id": 49139900, "comment_id": 85285839, "body": "I&#39;m  not near a computer just now but would recommend you consider ado recordsets. Search populating same from excel and the copyfromrecordset method to write the results back into excel. Just hints, sorry I can&#39;t offer more just now."}, {"owner": {"reputation": 733, "user_id": 552845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2894173d28c441a6d5f6ea7d3fea5ec1?s=128&d=identicon&r=PG", "display_name": "nemmy", "link": "https://stackoverflow.com/users/552845/nemmy"}, "edited": false, "score": 2, "creation_date": 1520372157, "post_id": 49139900, "comment_id": 85285965, "body": "Turn off Automatic Calculations, store the range values in variables, put the variable into the ranges, and turn automatic calculations back on when your loop is done."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 1, "creation_date": 1520372604, "post_id": 49139900, "comment_id": 85286189, "body": "What is this &quot;&amp;quot;A&amp;quot;&quot;?"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1520373202, "post_id": 49139900, "comment_id": 85286501, "body": "Consider change the FormulaR1C1 instead. <code>Range(&quot;L&quot; &amp; i).Resize(,6).FormulaR1C1 = &quot;=RC+R[1]C&quot;</code>, and do pause the auto calculation."}, {"owner": {"reputation": 796, "user_id": 514120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb4a74b8313b9bcfd2a7bdc37816a708?s=128&d=identicon&r=PG", "display_name": "Charles Byrne", "link": "https://stackoverflow.com/users/514120/charles-byrne"}, "edited": false, "score": 0, "creation_date": 1520435599, "post_id": 49139900, "comment_id": 85314958, "body": "Turn off Calculations (like nemmy).  Are the contents of the cells text?   Are you adding values (Sum?) to an existing number?  You&#39;d be better off using Cell.Offset or ActiveCell.Offset(i+1,11)  instead of Range(&quot;L&quot; &amp; i + 1) assuming A1 is starting point.  I would store the number in the row above into a variable add the row below then assign the value into the destination.  Your logic only accounts for 1 and only 1 duplicate key in Column B (sorted).  If B2, B3, B4 all had a value of 2 then in your loop B3 would be deleted, but B4 and B2 would remain because it would go down 1 after delete."}], "answers": [{"comments": [{"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1520399526, "post_id": 49144252, "comment_id": 85294247, "body": "This feels like a kludge, and the <code>.Value = .Value</code> statements seem odd, although I understand they are used to convert formulas into values. A better way would be with one statement like  <code>Range(&quot;L1&quot;).Resize(1,10).Value = Range(&quot;L1&quot;).Resize(1,10).Value</code>. Also I find the use of string math of addressing very error prone and difficult to maintain. The VBA gods gave us <code>.Offset()</code> and <code>.Resize()</code> for a reason."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 1, "creation_date": 1520436751, "post_id": 49144252, "comment_id": 85315902, "body": "@ja72 good input, resize makes a lot of sense. I will start using it,"}, {"owner": {"reputation": 3, "user_id": 9453423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a81472b8ca4809337438ed8d56ffbd1?s=128&d=identicon&r=PG&f=1", "display_name": "Marco C", "link": "https://stackoverflow.com/users/9453423/marco-c"}, "edited": false, "score": 0, "creation_date": 1521021009, "post_id": 49144252, "comment_id": 85551276, "body": "@Gmalc thank you, I tried the code but it just deletes everything except for the first row"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "reply_to_user": {"reputation": 3, "user_id": 9453423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a81472b8ca4809337438ed8d56ffbd1?s=128&d=identicon&r=PG&f=1", "display_name": "Marco C", "link": "https://stackoverflow.com/users/9453423/marco-c"}, "edited": false, "score": 0, "creation_date": 1521034745, "post_id": 49144252, "comment_id": 85560983, "body": "@MarcoC, I tested the code you provided and your code added each row to the row above it and then deletes the row you just added <code>r.Offset(1, 0).EntireRow.Delete</code>, keeping the total in the first row. My code sums each column in the first row and then deletes all the rows below."}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1520437636, "last_edit_date": 1520437636, "creation_date": 1520397589, "answer_id": 49144252, "question_id": 49139900, "link": "https://stackoverflow.com/questions/49139900/slow-vba-code-optimisation/49144252#49144252", "title": "Slow VBA Code optimisation", "body": "<p>This does what your code does; i tested with 1k rows of data and it was faster then your code.  (Updated with ja72's input)</p>\n\n<pre><code>Dim i As Long\nDim LastRow As Long\n\n    If Range(\"B1\") = Range(\"B2\") Then\n        Rows(1).Copy\n        Rows(1).Insert Shift:=xlDown\n        LastRow = Cells(Rows.Count, 1).End(xlUp).Row\n        Cells(1, 12).Formula = \"=SUM(L2:L\" &amp; LastRow &amp; \")\"\n        Cells(1, 12).Resize(, 5).FillRight\n    End If\n\n    Range(\"L1\").Resize(1,10).Value = Range(\"L1\").Resize(1,10).Value\n\n    Rows(2 &amp; \":\" &amp; Rows.Count).Delete\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1520408391, "post_id": 49144989, "comment_id": 85297644, "body": "both your codes have flaws: the first misses rows when deleting them. the second lets <code>l</code> variable exceed <code>LastRow </code> in the <code>While  Wend</code> loop. I&#39;m down voting it andI&#39;ll up vote it should you edit and amend your codes. (BTW this latter is quite an obsolete way of iterating and people prefer <code>Do While ...Loop</code> or <code>Do... Loop While</code> constructs.)"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1520429279, "post_id": 49144989, "comment_id": 85310549, "body": "@DisplayName - It is not going past the last row because ` x(i, 2) = x(l, 2)` would return false. Unless the last cell in the &quot;B&quot; column is empty. For the first answer, I did testing and didn&#39;t see the flaw. Can you explain please? I have made edits to the code."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1520515416, "post_id": 49144989, "comment_id": 85353230, "body": "@DisplayName - Yes, but I made up the data so there might be assumptions I did which don&#39;t apply."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1520515554, "post_id": 49144989, "comment_id": 85353323, "body": "in first code: when <code>If r.value = r.Offset(1, 0).value Then</code> finds a match, <code>r.Offset(1, 0).EntireRow.Delete</code> will delete the row below <i>AND</i> <code>Set r = r.Offset(1, 0)</code> will skip to the next one. While this latter shouldn&#39;t happen as there could be more than one consecutive cell below the <i>current</i> one and matching it."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1520515902, "post_id": 49144989, "comment_id": 85353563, "body": "in second code: the <code>Do While l &lt;= LastRow And x(i, 2) = x(l, 2)</code> loop condition errors out when <code>l</code> assumes <code>LastRow+1</code> value because the <code>And</code> operator brings along the evaluation of both condtions, i.e. also <code>And x(i, 2) = x(l, 2)</code> is evaluated and errors out when <code>l</code> value is <code>LastRow+1</code> after the last <code>l = l + 1</code>"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1520515926, "post_id": 49144989, "comment_id": 85353577, "body": "@DisplayName - Case: Three rows all matching in the &quot;B&quot; column - <code>r</code> points to the first row. After the matching and the adding of values, the 2nd row is deleted and the 3rd row becomes the 2nd row. Finally <code>r</code> advances to the next row (which was originally the 3rd) and since there is a match it will do more adding and deleting. And so on, until there isn&#39;t a match anymore."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1520516009, "post_id": 49144989, "comment_id": 85353627, "body": "@DisplayName - You are right. I need an exit condition before I check for matching. let me think about it."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "edited": false, "score": 0, "creation_date": 1520516681, "post_id": 49144989, "comment_id": 85354109, "body": "@DisplayName - Ok fixed <code>DW2()</code>. Thanks for the input."}, {"owner": {"reputation": 3, "user_id": 9453423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a81472b8ca4809337438ed8d56ffbd1?s=128&d=identicon&r=PG&f=1", "display_name": "Marco C", "link": "https://stackoverflow.com/users/9453423/marco-c"}, "edited": false, "score": 0, "creation_date": 1521020699, "post_id": 49144989, "comment_id": 85551062, "body": "@ja72 thank you so much for the input, I&#180;m slowly getting there but it&#180;s still not 100% right.  The problem with the first one ist that it doesn&#180;t consider more that two values in a row because it skips the deleted row . The second one has the right amount of rows but the sum seems not to be working. Gonna try figure out how to solve that, but in the meantime thank you so much"}, {"owner": {"reputation": 3, "user_id": 9453423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a81472b8ca4809337438ed8d56ffbd1?s=128&d=identicon&r=PG&f=1", "display_name": "Marco C", "link": "https://stackoverflow.com/users/9453423/marco-c"}, "edited": false, "score": 0, "creation_date": 1521021962, "post_id": 49144989, "comment_id": 85551967, "body": "@ja72 I found a workaround for the first one, I had to put &#39;Else&#39; instead of &#39;End If&#39; and the &#39;End If&#39; after &#39;Set r = r.Offset(1, 0)&#39; , so in case the row was deleted it still would check the same row with the new values. altough it works better than mine it&#180;s very near (timeconsuming), the second one has more potential I think so I&#180;m gonna try work on that"}, {"owner": {"reputation": 3, "user_id": 9453423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a81472b8ca4809337438ed8d56ffbd1?s=128&d=identicon&r=PG&f=1", "display_name": "Marco C", "link": "https://stackoverflow.com/users/9453423/marco-c"}, "edited": false, "score": 0, "creation_date": 1521024483, "post_id": 49144989, "comment_id": 85553745, "body": "@ja72 the second one actually works very good, it just skips the very last row"}, {"owner": {"reputation": 3, "user_id": 9453423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a81472b8ca4809337438ed8d56ffbd1?s=128&d=identicon&r=PG&f=1", "display_name": "Marco C", "link": "https://stackoverflow.com/users/9453423/marco-c"}, "edited": false, "score": 1, "creation_date": 1521027160, "post_id": 49144989, "comment_id": 85555668, "body": "@ja72 the second fix was as simple as taking out the = in &#39;If i_next &gt;= LastRow&#39; thank you so much"}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 0, "last_activity_date": 1520516651, "last_edit_date": 1520516651, "creation_date": 1520401796, "answer_id": 49144989, "question_id": 49139900, "link": "https://stackoverflow.com/questions/49139900/slow-vba-code-optimisation/49144989#49144989", "title": "Slow VBA Code optimisation", "body": "<p>The code below first addresses the issue of string math for the range picking. Instead of <code>.Range(\"A\" &amp; i)</code> it best to use <code>.Offset()</code> or <code>.Cells()</code> instead. Additionally it makes it explicit that we are dealing with values and not ranges when the math takes place. It is recommended to always type <code>.Value</code> where it is implied.</p>\n\n<pre><code>Sub DW()\n    Application.ScreenUpdating = False\n    Application.DisplayStatusBar = False\n    Dim i As Long\n    Dim LastRow As Long\n    LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    Dim r As Range, g As Range\n    ' Set the start of the optimization loop\n    Set r = Range(\"B1\")\n    ' While still inside the data\n    Do While r.Row &lt;= LastRow\n        ' Check this value with value of next row\n        If r.Value = r.Offset(1, 0).Value Then\n            Set g = r.Offset(0, 10) ' Pick column \"L\" of same row as r\n            Go from \"L\" to \"Q\"\n            For i = 1 To 6\n                'Add values one by one with row below\n                g.Offset(0, i - 1).Value = _\n                    g.Offset(0, i - 1).Value + g.Offset(1, i - 1).Value\n            Next i\n            r.Offset(1, 0).EntireRow.Delete\n            LastRow = LastRow - 1\n        End If\n        ' Move to next row\n        Set r = r.Offset(1, 0)\n    Loop\n    Application.ScreenUpdating = True\n    Application.DisplayStatusBar = True\nEnd Sub\n</code></pre>\n\n<p>Depending on the total amount of data, it will be way faster to load all the data into memory and process it with VBA arrays only to be returned back in the end to the worksheet.</p>\n\n<p><strong>The following code should be orders of magnitude faster.</strong></p>\n\n<pre><code>Sub DW2()\n\n    Dim i As Long, j As Long, i_out As Long, i_next As Long\n\n    Dim LastRow As Long, ValCol As Long, LastCol As Long\n    LastRow = Cells(Rows.Count, \"A\").End(xlUp).Row\n    ValCol = Cells(, \"L\").Column\n    LastCol = Cells(, \"Q\").Column\n\n    Dim r_data As Range\n    ' Reference all the data (filled rows, and 17 columns \"A:Q\")\n    Set r_data = Range(\"A1\").Resize(LastRow, LastCol)\n\n    ' x is input data, y as output data\n    Dim x() As Variant, y() As Variant\n\n    ' Copy all the table cells into memory\n    x = r_data.Value\n\n    ' Create an empty array at least the same size\n    ReDim y(1 To LastRow, 1 To LastCol)\n    ' i_out is index for output\n    i_out = 1\n    ' i is index for input\n    For i = 1 To LastRow\n        ' Debug.Print \"Row\"; i, \"into Row:\"; i_out\n        'Copy all values first from current row\n        For j = 1 To LastCol\n            y(i_out, j) = x(i, j)\n        Next j\n        ' Index i_next peeks at the next row\n        i_next = i + 1\n        If i_next &gt;= LastRow Then\n            ' Advance i_out\n            i_out = i_out + 1\n            Exit For\n        End If\n        ' Check with value match on 2nd column \"B\"\n        Do While x(i, 2) = x(i_next, 2)\n            'Add up values in columns 11 through 17\n            For j = ValCol To LastCol\n                y(i_out, j) = y(i_out, j) + x(i_next, j)\n            Next j\n            ' Peek at subsequent rows also\n            i_next = i_next + 1\n            If i_next &gt;= LastRow Then\n            ' Advance i_out\n                i_out = i_out + 1\n                Exit For\n            End If\n        Loop\n        ' Advance i if rows were skipped\n        i = i_next - 1\n        ' Advance i_out\n        i_out = i_out + 1\n    Next i\n\n    ' Clear all table cells\n    r_data.ClearContents\n    ' Overwrite with the optimized values\n    r_data.Resize(i_out - 1, LastCol).Value = y\nEnd Sub\n</code></pre>\n\n<p><sub>Edit: Now tested for robustness when matching rows exist in the end of the data</sub></p>\n"}], "owner": {"reputation": 3, "user_id": 9453423, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a81472b8ca4809337438ed8d56ffbd1?s=128&d=identicon&r=PG&f=1", "display_name": "Marco C", "link": "https://stackoverflow.com/users/9453423/marco-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1520516651, "creation_date": 1520370227, "last_edit_date": 1531164843, "question_id": 49139900, "link": "https://stackoverflow.com/questions/49139900/slow-vba-code-optimisation", "title": "Slow VBA Code optimisation", "body": "<p>I\u00b4m pretty new to VBA and since it\u00b4s making my job so much easier I try to write some codes from time to time and everything works fine except for this one, I already tried with the Screen Updating and the Status Bar method but it\u00b4s still very slow. Any ideas on how it coul be improved? Thnak you</p>\n\n<pre><code>    Sub DW()\n    Application.ScreenUpdating = False\n    Application.DisplayStatusBar = False\n    Dim i As Long\n    Dim LastRow As Long\n    LastRow = Cells(Rows.Count, &amp;quot;A&amp;quot;).End(xlUp).Row\n\n    i = 1\n    Do Until i &gt; LastRow\n    If Range(\"B\" &amp; i) = Range(B &amp; i + 1) Then\n    Range(\"L\" &amp; i) = Range(\"L\" &amp; i) + Range(\"L\" &amp; i + 1)\n    Range(\"M\" &amp; i) = Range(\"M\" &amp; i) + Range(\"M\" &amp; i + 1)\n    Range(\"N\" &amp; i) = Range(\"N\" &amp; i) + Range(\"N\" &amp; i + 1)\n    Range(\"O\" &amp; i) = Range(\"O\" &amp; i) + Range(\"O\" &amp; i + 1)\n    Range(\"P\" &amp; i) = Range(\"P\" &amp; i) + Range(\"P\" &amp; i + 1)\n    Range(\"Q\" &amp; i) = Range(\"Q\" &amp; i) + Range(\"Q\" &amp; i + 1)\n    Range(\"A\" &amp; i + 1).EntireRow.Delete\n    LastRow = LastRow - 1\n\n    Else\n    i = i + 1\n    End If\n    Loop\n    Application.ScreenUpdating = True\n    Application.DisplayStatusBar = True\n    End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 8748745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e16e100a152ab4504c783bcdf780be?s=128&d=identicon&r=PG&f=1", "display_name": "EngineeringJunkie", "link": "https://stackoverflow.com/users/8748745/engineeringjunkie"}, "edited": false, "score": 0, "creation_date": 1520379084, "post_id": 49139837, "comment_id": 85288930, "body": "Thanks, this nearly accomplishes my goal. I see it does assign the name in the spreadsheet under Name Manager. But I must be missing something (probably obvious)... I get a run-time error 13 &quot;type mismatch&quot; on the MsgBox output when attempting either syntax. I tried with and without the Explicit option... same error. What am I missing?"}, {"owner": {"reputation": 32374, "user_id": 4, "user_type": "moderator", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/C5gBG.jpg?s=128&g=1", "display_name": "Joel Spolsky", "link": "https://stackoverflow.com/users/4/joel-spolsky"}, "reply_to_user": {"reputation": 25, "user_id": 8748745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e16e100a152ab4504c783bcdf780be?s=128&d=identicon&r=PG&f=1", "display_name": "EngineeringJunkie", "link": "https://stackoverflow.com/users/8748745/engineeringjunkie"}, "edited": false, "score": 0, "creation_date": 1520438665, "post_id": 49139837, "comment_id": 85317313, "body": "That could mean anything but probably means that the name is not defined. This is probably an interaction with something else in your worksheet, or maybe the active worksheet is not what you think it is."}, {"owner": {"reputation": 25, "user_id": 8748745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e16e100a152ab4504c783bcdf780be?s=128&d=identicon&r=PG&f=1", "display_name": "EngineeringJunkie", "link": "https://stackoverflow.com/users/8748745/engineeringjunkie"}, "edited": false, "score": 1, "creation_date": 1520443343, "post_id": 49139837, "comment_id": 85320398, "body": "I found the problem: I was applying it to a range that had 3 columns (name column, value column, units column) and hence the value assigned to the name was an array of the value and units.  What I have (and does not work), it thus:  A named ranged &quot;Foo&quot; like this:  one\t1\tft two\t2\tft^2 three\t3\tft^3  ...and some code like this:  Sub Testing()          Dim arr As Variant     Set arr = Range(&quot;Foo&quot;)     arr.CreateNames Left:=True     MsgBox [one]      End Sub"}, {"owner": {"reputation": 25, "user_id": 8748745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e16e100a152ab4504c783bcdf780be?s=128&d=identicon&r=PG&f=1", "display_name": "EngineeringJunkie", "link": "https://stackoverflow.com/users/8748745/engineeringjunkie"}, "edited": false, "score": 0, "creation_date": 1520443948, "post_id": 49139837, "comment_id": 85320774, "body": "My apologies for the messy reply--I am inexperienced in the formatting technique here."}, {"owner": {"reputation": 25, "user_id": 8748745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e16e100a152ab4504c783bcdf780be?s=128&d=identicon&r=PG&f=1", "display_name": "EngineeringJunkie", "link": "https://stackoverflow.com/users/8748745/engineeringjunkie"}, "edited": false, "score": 0, "creation_date": 1520469845, "post_id": 49139837, "comment_id": 85332817, "body": "Just as confirmation, your method does work for my original question with only minor spreadsheet adjustments and can be used in conjunction with other named arrays and such. Something I found to watch out for is--of course--to avoid names that already exist in VBA; these cause inconsistent handling with code compiling or running."}], "tags": [], "owner": {"reputation": 32374, "user_id": 4, "user_type": "moderator", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/C5gBG.jpg?s=128&g=1", "display_name": "Joel Spolsky", "link": "https://stackoverflow.com/users/4/joel-spolsky"}, "is_accepted": true, "score": 3, "last_activity_date": 1520369939, "creation_date": 1520369939, "answer_id": 49139837, "question_id": 49139728, "link": "https://stackoverflow.com/questions/49139728/is-it-possible-to-declare-a-user-input-string-to-be-a-variable-in-vba/49139837#49139837", "title": "Is it possible to declare a user input string to be a variable in VBA?", "body": "<p>One easy shortcut is to use the <code>CreateNames</code> method on the <code>Range</code> object. Although this doesn't create a VBA variable, it does create a new name on the worksheet which can be accessed through <code>Evaluate</code> or square brackets.</p>\n\n<p>Example:</p>\n\n<p>If the selection contains</p>\n\n<pre><code>  one    1  \n  two    2  \n  three  3  \n</code></pre>\n\n<p>the following VBA code</p>\n\n<pre><code>  Selection.CreateNames Left:=True\n  MsgBox [one]\n</code></pre>\n\n<p>will display 1. You can also use <code>Evaluate(\"one\")</code> instead of <code>[one]</code> if you have <code>one</code> in a string variable.</p>\n"}], "owner": {"reputation": 25, "user_id": 8748745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75e16e100a152ab4504c783bcdf780be?s=128&d=identicon&r=PG&f=1", "display_name": "EngineeringJunkie", "link": "https://stackoverflow.com/users/8748745/engineeringjunkie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 49139837, "answer_count": 1, "score": 2, "last_activity_date": 1520369939, "creation_date": 1520369471, "last_edit_date": 1531164843, "question_id": 49139728, "link": "https://stackoverflow.com/questions/49139728/is-it-possible-to-declare-a-user-input-string-to-be-a-variable-in-vba", "title": "Is it possible to declare a user input string to be a variable in VBA?", "body": "<p>In VBA for Excel, is it possible to declare user input or cell value as a variable? </p>\n\n<p>I am creating a spreadsheet where there is a long list (~150) of variable names and a user will enter values in the column adjacent to the name. I am looking for a way--if there is one--for the code to read in and declare each of those variables from the Range and then assign the respective user-input value without having to declare each variable name in the code manually. </p>\n\n<p>Is this \"possible\"?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1520370221, "last_edit_date": 1520370221, "creation_date": 1520369283, "answer_id": 49139673, "question_id": 49139539, "link": "https://stackoverflow.com/questions/49139539/else-statement-causing-run-time-error/49139673#49139673", "title": "Else statement causing run-time error", "body": "<p>Your Else goes into a continuous retrigger loop. Disable events when you write to the same worksheet via worksheet_change event.</p>\n\n<pre><code>'Set Sub Contractor Section to Option 3\nPrivate Sub worksheet_change(ByVal Sub_Contractor_Target As Range)\n    On Error GoTo safe_exit\n    SC_Option3 = Worksheets(\"Options\").Range(\"D27\").Value\n    'MsgBox (Sub_Contractor_Target)\n    Application.EnableEvents = False\n    If Sub_Contractor_Target.Value = \"No\" Then\n\n       Worksheets(\"Menu\").Range(\"C55\") = SC_Option3\n       Worksheets(\"Menu\").Range(\"C56\") = \"Low\"\n\n    Else\n       Worksheets(\"Menu\").Range(\"C55,C56\").Value = \"Other\"\n    End If\nsafe_exit:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3, "user_id": 9453366, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uTtau9Cm-h0/AAAAAAAAAAI/AAAAAAAAC5M/BpClowTOALA/photo.jpg?sz=128", "display_name": "Michael Amati", "link": "https://stackoverflow.com/users/9453366/michael-amati"}, "edited": false, "score": 0, "creation_date": 1520856295, "post_id": 49141312, "comment_id": 85472625, "body": "Great!  Thank you.  I had figured out that I had a lot of extra code.  It was the Application.EnableEvents piece I was missing that really made a difference."}, {"owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "reply_to_user": {"reputation": 3, "user_id": 9453366, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uTtau9Cm-h0/AAAAAAAAAAI/AAAAAAAAC5M/BpClowTOALA/photo.jpg?sz=128", "display_name": "Michael Amati", "link": "https://stackoverflow.com/users/9453366/michael-amati"}, "edited": false, "score": 0, "creation_date": 1520873565, "post_id": 49141312, "comment_id": 85484645, "body": "@MichaelAmati, you are welcome. If my answer solved your question then please consider marking it as accepted. Thank you"}], "tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": true, "score": 0, "last_activity_date": 1520376429, "creation_date": 1520376429, "answer_id": 49141312, "question_id": 49139539, "link": "https://stackoverflow.com/questions/49139539/else-statement-causing-run-time-error/49141312#49141312", "title": "Else statement causing run-time error", "body": "<p>I think you don't need most of your code (Public variables, SetTarget sub)</p>\n\n<p>Try putting the following only in your \"Menu\" worksheet code pane</p>\n\n<pre><code>Option Explicit\nPrivate Sub worksheet_change(ByVal Target as Range)\n    If Target.Address &lt;&gt; \"$C$15\" Then Exit Sub\n    On Error GoTo ExitSub\n    Application.EnableEvents = False\n    If Range(\"C15\").Value = \"No\" Then\n        Range(\"C55\") = Worksheets(\"Options\").Range(\"D27\").Value\n        Range(\"C56\") = \"Low\"\n    Else\n        Range(\"C55,C56\").Value = \"Other\"\n    End If\nExitSub:\n    Application.EnableEvents = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9453366, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-uTtau9Cm-h0/AAAAAAAAAAI/AAAAAAAAC5M/BpClowTOALA/photo.jpg?sz=128", "display_name": "Michael Amati", "link": "https://stackoverflow.com/users/9453366/michael-amati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 49141312, "answer_count": 2, "score": 0, "last_activity_date": 1520376429, "creation_date": 1520368636, "last_edit_date": 1520368989, "question_id": 49139539, "link": "https://stackoverflow.com/questions/49139539/else-statement-causing-run-time-error", "title": "Else statement causing run-time error", "body": "<p>I'm writing my first VBA code and getting an odd error I can't track. </p>\n\n<p>I'm simply trying to assign a value to certain cells if another cell (C15) is equal to \"No\" and set the values of these cells to \"Other\" if C15 has any other value.</p>\n\n<p><strong>It works if I comment out the else section</strong>, but fails and says</p>\n\n<blockquote>\n  <p>\"Method 'Range' of object '_Worksheet' failed.\"</p>\n</blockquote>\n\n<p>Then Excel crashes.</p>\n\n<p>Any help is greatly appreciated.  </p>\n\n<pre><code>Option Explicit\nPublic Sub_Contractor_Target As Range\nPublic Sub_Contractor_Target_Value As String\nPublic SC_Option3 As String\n\n\nSub SetTarget()\n    Set Sub_Contractor_Target = Worksheets(\"Menu\").Range(\"C15\")\n    Set Sub_Contractor_Target_Value = Sub_Contractor_Target.Value\nEnd Sub\n\n\n\n\n'Set Sub Contractor Section to Option 3\nPrivate Sub worksheet_change(ByVal Sub_Contractor_Target As Range)\nSC_Option3 = Worksheets(\"Options\").Range(\"D27\").Value\n'MsgBox (Sub_Contractor_Target)\nIf Sub_Contractor_Target.Value = \"No\" Then\n\n   Worksheets(\"Menu\").Range(\"C55\") = SC_Option3\n   Worksheets(\"Menu\").Range(\"C56\") = \"Low\"\n\nElse\n   Worksheets(\"Menu\").Range(\"C55,C56\").Value = \"Other\"\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "internet-explorer"], "answers": [{"tags": [], "owner": {"reputation": 4770, "user_id": 2216449, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qokRz.jpg?s=128&g=1", "display_name": "Fabien TheSolution", "link": "https://stackoverflow.com/users/2216449/fabien-thesolution"}, "is_accepted": false, "score": 1, "last_activity_date": 1580854744, "creation_date": 1580854744, "answer_id": 60066369, "question_id": 49139140, "link": "https://stackoverflow.com/questions/49139140/filename-from-frame-notification-bar/60066369#60066369", "title": "Filename from Frame Notification Bar", "body": "<p>I know it's a old question but since there is no answer and that I found a way to get it, I think it's good to share it.</p>\n\n<p>The element you are looking for is <code>Notification bar Text</code></p>\n\n<p>I based my solution on this tutorial :</p>\n\n<p><a href=\"https://www.mrexcel.com/board/threads/using-uiautomationclient-to-automate-the-save-as-file-download-in-ie11.1086615/\" rel=\"nofollow noreferrer\">https://www.mrexcel.com/board/threads/using-uiautomationclient-to-automate-the-save-as-file-download-in-ie11.1086615/</a></p>\n\n<p>Add those declarations :</p>\n\n<pre><code>        Dim iCnd2 As IUIAutomationCondition\n        Dim iCnd3 As IUIAutomationCondition\n        Dim iCnd2and3 As IUIAutomationCondition\n        Dim NotificationBarText As IUIAutomationElement\n</code></pre>\n\n<p>And after <code>Set e = o.ElementFromHandle(ByVal h)</code> add this :</p>\n\n<pre><code>        Set iCnd2 = o.CreatePropertyCondition(UIA_NamePropertyId, \"Notification bar Text\")\n        Set iCnd3 = o.CreatePropertyCondition(UIA_ControlTypePropertyId, UIA_TextControlTypeId)\n        Set iCnd2and3 = o.CreateAndCondition(iCnd2, iCnd3)\n        Set NotificationBarText = e.FindFirst(TreeScope_Descendants, iCnd2and3)\n        NotificationBarTextString = NotificationBarText.GetCurrentPropertyValue(UIA_ValueValuePropertyId)\n        baseUrl = Mid(Mid(IE.LocationURL, InStr(IE.LocationURL, \"//\") + 2), 1, InStr(Mid(IE.LocationURL, InStr(IE.LocationURL, \"//\") + 2), \"/\") - 1)\n        FileName = Replace(Replace(NotificationBarTextString, \"Do you want to open or save \", \"\"), \" from \" &amp; baseUrl &amp; \"?\", \"\")\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4166832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8f2c1305bd1ddc84a8ca0ef22d37e87?s=128&d=identicon&r=PG&f=1", "display_name": "Jay777", "link": "https://stackoverflow.com/users/4166832/jay777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1580854744, "creation_date": 1520366839, "last_edit_date": 1520366928, "question_id": 49139140, "link": "https://stackoverflow.com/questions/49139140/filename-from-frame-notification-bar", "title": "Filename from Frame Notification Bar", "body": "<p>Does anyone know if there is a method to pull the filename from the \"Frame Notification Bar\" in IE11 using hwnd?  The code below works great but I am trying to find a better method of finding the file (its dynamically named) then pulling the most recent file from the download folder.  Thanks in advance! </p>\n\n<pre><code>Sub SaveFile(IE As InternetExplorerMedium)\nDim o As IUIAutomation, buffer As String, length As Long, result As Long, e      As IUIAutomationElement, h As Long\nSet o = New CUIAutomation\nh = IE.hWnd\nh = FindWindowEx(h, 0, \"Frame Notification Bar\", vbNullString)\nIf h = 0 Then Exit Sub\nSet e = o.ElementFromHandle(ByVal h)\nDim iCnd As IUIAutomationCondition\nSet iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, \"Save\")\nDim Button As IUIAutomationElement\nSet Button = e.FindFirst(TreeScope_Subtree, iCnd)\nDim InvokePattern As IUIAutomationInvokePattern\nSet InvokePattern = Button.GetCurrentPattern(UIA_InvokePatternId)\nInvokePattern.Invoke\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "drop-down-menu"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1520367553, "post_id": 49138832, "comment_id": 85283760, "body": "<i>&quot;Do you have an idea what I&#39;m missing?&quot;</i> ... Yes. Your html code."}, {"owner": {"reputation": 1, "user_id": 3959931, "user_type": "registered", "profile_image": "https://graph.facebook.com/1227624278/picture?type=large", "display_name": "Lyubomir Klyambarski", "link": "https://stackoverflow.com/users/3959931/lyubomir-klyambarski"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1520368333, "post_id": 49138832, "comment_id": 85284173, "body": "This is the web page: <a href=\"https://www.dzs.hr/app/kalendar/RPSByCode.aspx\" rel=\"nofollow noreferrer\">dzs.hr/app/kalendar/RPSByCode.aspx</a>  .This code for the first field (01487434) results in more than 1 options for the drop down menu."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3959931, "user_type": "registered", "profile_image": "https://graph.facebook.com/1227624278/picture?type=large", "display_name": "Lyubomir Klyambarski", "link": "https://stackoverflow.com/users/3959931/lyubomir-klyambarski"}, "is_accepted": false, "score": 0, "last_activity_date": 1520436994, "creation_date": 1520436994, "answer_id": 49155758, "question_id": 49138832, "link": "https://stackoverflow.com/questions/49138832/select-from-a-drop-down-menu/49155758#49155758", "title": "Select from a drop down menu", "body": "<p>I found the problem. This row didn't work properly:  <em>IE.Document.getElementById(\"DropDownList1\").selectedIndex = opt.Index</em> </p>\n\n<p>I don't know why buth the object dd1 loses its elements after FireEvent or form submit. Using <em>IE.Document.getElementById(\"DropDownList1\").Value=string_from_previously_assigned_array</em> and re-submitting the form resulted in working code.</p>\n"}], "owner": {"reputation": 1, "user_id": 3959931, "user_type": "registered", "profile_image": "https://graph.facebook.com/1227624278/picture?type=large", "display_name": "Lyubomir Klyambarski", "link": "https://stackoverflow.com/users/3959931/lyubomir-klyambarski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1520436994, "creation_date": 1520365599, "last_edit_date": 1520370078, "question_id": 49138832, "link": "https://stackoverflow.com/questions/49138832/select-from-a-drop-down-menu", "title": "Select from a drop down menu", "body": "<p>I'm trying to run a set of queries in a web page. The initial query defines if the DropDownList1 has more than one option. Selecting additional option reloads the web form. \nWhen I run the following part nothing in the drop down list get changed. If I skip the ...FireEvent... line the values of the drop down menu are changing during the loop, but the web form is not reloading and the initial values are returned for all the list elements. </p>\n\n<pre><code>Set dd1 = doc.getElementById(\"DropDownList1\")\nIf dd1.Options.Length &gt; 1 Then\n  For Each opt In dd1.Options\n    doc.getElementById(\"DropDownList1\").Focus\n    doc.getElementById(\"DropDownList1\").selectedIndex = opt.Index\n    doc.getElementById(\"DropDownList1\").FireEvent (\"onchange\")\n\n    ''copy the elements' values in excel sheet\n  next opt\nend if\n</code></pre>\n\n<p>Do you have an idea what I'm missing?</p>\n\n<p>This is the whole code:</p>\n\n<pre><code>Sub addresses()\n\nDim evt As Object\nDim doc As Object\nDim IE As Object\nDim Form As Object\nDim ID As Object\nDim Name As Object\nDim address As Object\nDim CForm As Object\nDim Code As Object\nDim Activity As Object\nDim NKD_2007 As Object\nDim NKD_2002 As Object\nDim dd1 As Object\nDim i, j As Integer\nDim sh, exp As String\n\nsh = \"Sheet6\" ''read sheet\nexp = \"Sheet7\" ''export sheet\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.Navigate \"https://www.dzs.hr/app/kalendar/RPSByCode.aspx\"\nWhile IE.Busy Or IE.ReadyState &lt;&gt; 4\n DoEvents\nWend\nj = 2\n Set doc = IE.Document\n Set Form = doc.forms(\"form1\")\n Set ID = doc.getElementById(\"TextBox1\")\n ID.Value = \"01487434\" ''ID VALUE\n Form.submit\n While IE.Busy Or IE.ReadyState &lt;&gt; 4\n  DoEvents\n Wend\n On Error Resume Next\n Set Name = doc.getElementById(\"DataList1_ctl01_NazivLbl\")\n Set address = doc.getElementById(\"DataList1_ctl01_AdresaLbl\")\n Set CForm = doc.getElementById(\"DataList1_ctl01_PUONazivLbl\")\n Set Code = doc.getElementById(\"DataList1_ctl01_Label1\")\n Set Activity = doc.getElementById(\"DataList1_ctl01_Label2\")\n Set NKD_2007 = doc.getElementById(\"DataList1_ctl01_Label3\")\n Set NKD_2002 = doc.getElementById(\"DataList1_ctl01_Label4\")\n Set dd1 = doc.getElementById(\"DropDownList1\")\n\n ''filling the table\n Sheets(exp).Cells(j, 2) = Name.innertext\n Sheets(exp).Cells(j, 3) = address.innertext\n Sheets(exp).Cells(j, 4) = CForm.innertext\n Sheets(exp).Cells(j, 5) = Code.innertext\n Sheets(exp).Cells(j, 6) = Activity.innertext\n Sheets(exp).Cells(j, 7) = NKD_2007.innertext\n Sheets(exp).Cells(j, 8) = NKD_2002.innertext\n\n j = j + 1\n\n If dd1.Options.Length &gt; 1 Then\n  For Each opt In dd1.Options\n     On Error Resume Next         \n     IE.Document.getElementById(\"DropDownList1\").selectedIndex = opt.Index\n     IE.Document.getElementById(\"DropDownList1\").FireEvent (\"onchange\")\n\n     Set Name = IE.Document.getElementById(\"DataList2_ctl01_NazivLbl\")\n     Set address = doc.getElementById(\"DataList2_ctl01_AdresaLbl\")\n     Set Activity = doc.getElementById(\"DataList2_ctl01_Label2\")\n     Set NKD_2007 = doc.getElementById(\"DataList2_ctl01_Label3\")\n     Set NKD_2002 = doc.getElementById(\"DataList2_ctl01_Label4\")\n\n     Sheets(exp).Cells(j, 2) = Name.innertext\n     Sheets(exp).Cells(j, 3) = address.innertext\n     Sheets(exp).Cells(j, 4) = CForm.innertext\n     Sheets(exp).Cells(j, 5) = Code.innertext\n     Sheets(exp).Cells(j, 6) = Activity.innertext\n     Sheets(exp).Cells(j, 7) = NKD_2007.innertext\n     Sheets(exp).Cells(j, 8) = NKD_2002.innertext\n\n     j = j + 1\n  Next opt\n End If\n\n Set doc = Nothing\n Set Form = Nothing\n Set Name = Nothing\n Set address = Nothing\n Set CForm = Nothing\n Set Code = Nothing\n Set Activity = Nothing\n Set NKD_2007 = Nothing\n Set NKD_2002 = Nothing\n\nIE.Quit\nSet IE = Nothing\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1941, "user_id": 1267370, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/32MVo.jpg?s=128&g=1", "display_name": "mooseman", "link": "https://stackoverflow.com/users/1267370/mooseman"}, "edited": false, "score": 0, "creation_date": 1520364111, "post_id": 49138333, "comment_id": 85281959, "body": "The value of a date in Excel is a number, not text.  See this SO post for a possible solution. <a href=\"https://stackoverflow.com/questions/36507562/converting-a-date-to-text-in-vba\" title=\"converting a date to text in vba\">stackoverflow.com/questions/36507562/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 8162409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/410cfa5a02bcde46c916341a4ede658f?s=128&d=identicon&r=PG&f=1", "display_name": "Eric D.", "link": "https://stackoverflow.com/users/8162409/eric-d"}, "edited": false, "score": 0, "creation_date": 1520365053, "post_id": 49138459, "comment_id": 85282417, "body": "I totally forgot to include the wildcard in there! It should be &quot;*.txt.&quot; That&#39;ll still work, right?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 91, "user_id": 8162409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/410cfa5a02bcde46c916341a4ede658f?s=128&d=identicon&r=PG&f=1", "display_name": "Eric D.", "link": "https://stackoverflow.com/users/8162409/eric-d"}, "edited": false, "score": 0, "creation_date": 1520365192, "post_id": 49138459, "comment_id": 85282476, "body": "Is FileName a variable? You can use a wildcard after currentdate to find but not for opening. Note using Format$ as a typed function is more efficient. What if more than one match?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 91, "user_id": 8162409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/410cfa5a02bcde46c916341a4ede658f?s=128&d=identicon&r=PG&f=1", "display_name": "Eric D.", "link": "https://stackoverflow.com/users/8162409/eric-d"}, "edited": false, "score": 0, "creation_date": 1520365376, "post_id": 49138459, "comment_id": 85282574, "body": "Do you mean currentPath &amp; &quot;-&quot; &amp; currentDate &amp; &quot;-&quot;  &amp; &quot;*.txt&quot;"}, {"owner": {"reputation": 91, "user_id": 8162409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/410cfa5a02bcde46c916341a4ede658f?s=128&d=identicon&r=PG&f=1", "display_name": "Eric D.", "link": "https://stackoverflow.com/users/8162409/eric-d"}, "edited": false, "score": 0, "creation_date": 1520371866, "post_id": 49138459, "comment_id": 85285824, "body": "I don&#39;t need the hyphens. I have now as currentPath &amp; currentDate &amp; &quot;*.txt&quot; and it works."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 91, "user_id": 8162409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/410cfa5a02bcde46c916341a4ede658f?s=128&d=identicon&r=PG&f=1", "display_name": "Eric D.", "link": "https://stackoverflow.com/users/8162409/eric-d"}, "edited": false, "score": 0, "creation_date": 1520372818, "post_id": 49138459, "comment_id": 85286294, "body": "No worries. I was reproducing the string you gave."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1520364526, "last_edit_date": 1520364526, "creation_date": 1520364132, "answer_id": 49138459, "question_id": 49138333, "link": "https://stackoverflow.com/questions/49138333/use-cell-value-date-to-import-text-file/49138459#49138459", "title": "Use cell value (date) to import text file", "body": "<p>Try </p>\n\n<pre><code>Format$(Sheet1.Range(\"A1\").Value,\"yyyy-mm-dd\")\n</code></pre>\n\n<p>Although, according to your example should there be a -FILENAME bit in your code?</p>\n\n<p>You want</p>\n\n<pre><code>2018-03-06-FILENAME.txt\n</code></pre>\n\n<p>But give only:</p>\n\n<pre><code>currentPath &amp; currentDate &amp; \".txt\"\n</code></pre>\n\n<p>So, need   <code>currentPath &amp; \"-\" &amp; currentDate &amp; \"-\" &amp; FILENAME &amp; \".txt\"</code></p>\n\n<p>Assuming FILENAME is a variable.</p>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 5034724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1dae312dc35e5b816b924342d4463ca5?s=128&d=identicon&r=PG&f=1", "display_name": "Middle", "link": "https://stackoverflow.com/users/5034724/middle"}, "is_accepted": true, "score": 0, "last_activity_date": 1520365098, "last_edit_date": 1520365098, "creation_date": 1520364498, "answer_id": 49138565, "question_id": 49138333, "link": "https://stackoverflow.com/questions/49138333/use-cell-value-date-to-import-text-file/49138565#49138565", "title": "Use cell value (date) to import text file", "body": "<p><code>currentDate = Sheet1.Range(\"A1\").Value</code> would indeed give the sequential date Excel uses to store dates I.E.(43261)</p>\n\n<p>Use <code>currentDate = Format(Sheet1.Range(\"A1\").text, \"YYYY-MM-DD\") &amp; \"FILENAME.txt\"</code> instead.</p>\n\n<p>You can also check what is stored in the variable by using <code>debug.print currentdate</code>, then using <code>Ctrl+G</code> for console to show printed values after macro executes.</p>\n\n<p>I strongly recommend using <code>instr</code> function to find the dates within the filename instead of comparing them directly, unless your file dates aren't unique. Also remember to use TextCompare mode for none-case sensitive comparisons.</p>\n\n<p>Example:  <code>If instr(1, CURRENT FILENAME STRING, currentDate, vbTextCompare) then\n              'if filename is found then code goes here.\n          end if</code></p>\n"}], "owner": {"reputation": 91, "user_id": 8162409, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/410cfa5a02bcde46c916341a4ede658f?s=128&d=identicon&r=PG&f=1", "display_name": "Eric D.", "link": "https://stackoverflow.com/users/8162409/eric-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 49138565, "answer_count": 2, "score": 2, "last_activity_date": 1520365192, "creation_date": 1520363594, "last_edit_date": 1520365192, "question_id": 49138333, "link": "https://stackoverflow.com/questions/49138333/use-cell-value-date-to-import-text-file", "title": "Use cell value (date) to import text file", "body": "<p>I'm trying to import a text file into an Excel workbook using a cell value to determine which text file to import. The directory that houses the text file will have other text files with the date prepended to the filename. (e.g. \"2018-03-06-FILENAME.txt\")</p>\n\n<p>I want the user to be able to enter a date into a predefined cell, and be able to run a macro that checks the value of that cell and then imports the file that matches that value. I think I'm running into a problem with my code where it sees the date code, and not the value that the filenames have. Not sure how to get around that? (The user must be able to enter the date in a human-friendly way, not \"43164\".)</p>\n\n<pre><code>Sub Import()\n\nDim currentPath As String\nDim newPath As String\nDim currentFile As String\nDim currentDate As String\n\ncurrentPath = \"\\\\network\\folder\\\"\nnewPath = \"\\\\network\\folder\\Processed\\\"\n\n' Get the first file\n\n    currentDate = Sheet1.Range(\"A1\").Value\n    currentFile = Dir(currentPath &amp; currentDate &amp; \"*.txt\")\n    Do While currentFile &lt;&gt; \"\"\n\n' Clear previous data\n\n    Sheet2.Activate\n    ActiveSheet.UsedRange.Clear\n    Range(\"A1\").Select\n\n' Process text file\n\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; currentPath &amp; currentFile, _\n        Destination:=Range(\"$A$1\"))\n        .Name = \"Data\"\n        .FieldNames = True\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = True\n        .TextFileColumnDataTypes = Array(3, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)\n        .Refresh BackgroundQuery:=False\n    End With\n\n    ActiveSheet.QueryTables(1).Delete\n\n' Move file into Processed folder\n\n    Name currentPath &amp; currentFile As newPath &amp; currentFile\n\n' Get the next file\n\n    currentFile = Dir\n    Loop\n\nEnd Sub\n</code></pre>\n"}]