[{"tags": ["vba", "excel", "command-prompt", "pdf-conversion"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1537398329, "post_id": 52415265, "comment_id": 91774238, "body": "Check <a href=\"https://www.google.com/search?q=site:stackoverflow.com+vba+download+file\" rel=\"nofollow noreferrer\">this answers</a>. When you succeed with single file downloading, just wrap the code into a loop to download all of them."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537401803, "post_id": 52415265, "comment_id": 91774885, "body": "It&#39;s not clear exactly what you need to do.  Are you trying to automate downloading a bunch of PDF&#39;s ?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 10220687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ekPY6M31Zrc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pFVZGfgAkTntD_qY88Kz0-yXY61w/mo/photo.jpg?sz=128", "display_name": "paaskanama", "link": "https://stackoverflow.com/users/10220687/paaskanama"}, "edited": false, "score": 0, "creation_date": 1537416139, "post_id": 52416269, "comment_id": 91777907, "body": "Thanks for the input! I have tried this script several times and am routinely met with File Not Found errors. Suspecting this might have to do with spaces in the URL, I subbed &quot;%20&quot; for the spaces and still received errors. I have removed the &quot;http://&quot; prefix and still am not having any success with this script...Ideas?"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "reply_to_user": {"reputation": 31, "user_id": 10220687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ekPY6M31Zrc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pFVZGfgAkTntD_qY88Kz0-yXY61w/mo/photo.jpg?sz=128", "display_name": "paaskanama", "link": "https://stackoverflow.com/users/10220687/paaskanama"}, "edited": false, "score": 0, "creation_date": 1537420157, "post_id": 52416269, "comment_id": 91778964, "body": "As I mentioned already - &quot;if the internal website (sharepoint) requires forced login/password then this code might need modifications.&quot;"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "reply_to_user": {"reputation": 31, "user_id": 10220687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ekPY6M31Zrc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pFVZGfgAkTntD_qY88Kz0-yXY61w/mo/photo.jpg?sz=128", "display_name": "paaskanama", "link": "https://stackoverflow.com/users/10220687/paaskanama"}, "edited": false, "score": 0, "creation_date": 1537420202, "post_id": 52416269, "comment_id": 91778983, "body": "To check this - Try opening the PDF link in incognito mode and if that gives the login screen then the code needs modification."}, {"owner": {"reputation": 31, "user_id": 10220687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ekPY6M31Zrc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pFVZGfgAkTntD_qY88Kz0-yXY61w/mo/photo.jpg?sz=128", "display_name": "paaskanama", "link": "https://stackoverflow.com/users/10220687/paaskanama"}, "edited": false, "score": 0, "creation_date": 1537448708, "post_id": 52416269, "comment_id": 91794643, "body": "I&#39;ve tried opening the PDFs with and without validating the login screen, and using incognito mode and not."}], "tags": [], "owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "is_accepted": false, "score": 1, "last_activity_date": 1537407095, "creation_date": 1537407095, "answer_id": 52416269, "question_id": 52415265, "link": "https://stackoverflow.com/questions/52415265/create-pdf-from-address-in-excel-cell/52416269#52416269", "title": "Create PDF from address in Excel cell", "body": "<p>I am assuming that you have a list of 2000+ links in Column A of Sheet1. The code below will also mark whether a PDF file exists or not (URL validation) and record it in adjacent column B. </p>\n\n<p>Also, if the internal website (sharepoint) requires forced login/password then this code might need modifications.</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nSub Download_PDF()\n    Dim i As Long\n    Dim FileNum As Long\n    Dim FileData() As Byte\n    Dim MyFile As String\n    Dim wHttp As Object\n    Dim TempFile As String\n    Dim strDownloadDirectory As String\n    Dim rngSource As Range\n    Dim rng As Range\n\n    On Error Resume Next\n        Set wHttp = CreateObject(\"WinHTTP.WinHTTPrequest.5\")\n        If Err.Number &lt;&gt; 0 Then\n            Set wHttp = CreateObject(\"WinHTTP.WinHTTPrequest.5.1\")\n        End If\n    On Error GoTo 0\n\n    On Error Resume Next\n    'Provide destination directory\n    strDownloadDirectory = \"C:\\MyDownloads\"\n    'Provide source range of list of hyperlinks\n    Set rngSource = Worksheets(\"Sheet1\").Range(\"A2:A\" &amp; Worksheets(\"Sheet1\").Range(\"A\" &amp; Application.Rows.Count).End(xlUp).Row)\n\n    'If Download Directory (Destination) doesn't exist then create it.\n    If Dir(strDownloadDirectory, vbDirectory) = Empty Then MkDir strDownloadDirectory\n\n    'If there is no url then no point in continuing\n    If rngSource.Cells.Count &lt;= 0 Then Exit Sub\n\n    For Each rng In rngSource.Cells\n        MyFile = rng.Text\n        If CheckURL(MyFile) Then\n            FileNum = FreeFile\n            rng.Offset(0, 1).Value = \"Downloading ...\"\n            TempFile = Right(MyFile, InStr(1, StrReverse(MyFile), \"/\") - 1)\n            wHttp.Open \"GET\", MyFile, False\n            wHttp.Send\n            FileData = wHttp.ResponseBody\n            FileNum = FreeFile\n            Open \"C:\\MyDownloads\\\" &amp; TempFile For Binary Access Write As #FileNum\n                Put #FileNum, 1, FileData\n            Close #FileNum\n            If Err.Number &lt;&gt; 0 Then\n                rng.Offset(0, 1).Value = \"Error while Downloading : \" &amp; Err.Description\n                Err.Clear\n            Else\n                rng.Offset(0, 1).Value = \"Download Successful!\"\n            End If\n        Else\n            rng.Offset(0, 1).Value = \"File not found !!\"\n            Err.Clear\n        End If\n    Next\n    Set wHttp = Nothing\n    MsgBox \"Open the folder [ \" &amp; strDownloadDirectory &amp; \" ] for the downloaded files...\"\nEnd Sub\n</code></pre>\n\n<hr>\n\n<pre><code>'Validate the given URL (Hyperlinks)\nFunction CheckURL(URL) As Boolean\n    Dim wHttp As Object\n    On Error Resume Next\n        Set wHttp = CreateObject(\"winhttp.winhttprequest.5\")\n        If Err.Number &lt;&gt; 0 Then\n            Set wHttp = CreateObject(\"winhttp.winhttprequest.5.1\")\n        End If\n    On Error GoTo 0\n\n    On Error Resume Next\n    wHttp.Open \"HEAD\", URL, False\n    wHttp.Send\n    If wHttp.Status = 200 Then\n        CheckURL = True\n    Else\n        CheckURL = False\n    End If\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 10220687, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-ekPY6M31Zrc/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7pFVZGfgAkTntD_qY88Kz0-yXY61w/mo/photo.jpg?sz=128", "display_name": "paaskanama", "link": "https://stackoverflow.com/users/10220687/paaskanama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1537407095, "creation_date": 1537398123, "question_id": 52415265, "link": "https://stackoverflow.com/questions/52415265/create-pdf-from-address-in-excel-cell", "title": "Create PDF from address in Excel cell", "body": "<p>I have been hunting for hours and not come across a solution yet. I have a list of 2,000+ PDF files which hyperlink to an internal Sharepoint drive. My aim is to create a local copy of the PDFs either using VBA or Command Prompt, but so far I have not come across a sequence that has proved fruitful.</p>\n\n<p>Is it possible to render PDFs simply from a list of http addresses?<br>\nCan this be accomplished using VBA?<br>\nIf so, how?</p>\n\n<p>Thanks in advance for reading.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537398601, "post_id": 52414799, "comment_id": 91774305, "body": "according to the code you are trying to get the name from a non working formula till you get the name and replace."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537398715, "post_id": 52414799, "comment_id": 91774325, "body": "in what row is the name and in what row is the formula going?"}], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1537398867, "creation_date": 1537398867, "answer_id": 52415368, "question_id": 52414799, "link": "https://stackoverflow.com/questions/52414799/worksheet-loop-how-to-retrieve-name-of-the-worksheet-and-put-it-into-formula/52415368#52415368", "title": "Worksheet loop - How to retrieve name of the worksheet and put it into formula", "body": "<p>This looks in row 2 for the sheet name and puts the formula in row 3.</p>\n\n<p>There is no need for the replace, just concatenate in place.</p>\n\n<p>FormulaArray will make the formula an array formula you want just Formula.</p>\n\n<p>The code you were using is to get around FormulaArrays limit of 255 characters.  It is not needed for simple formulas.</p>\n\n<pre><code>Dim i As Long\nFor i = 1 To 60\n    strName = wsmain.Cells(2, 11 + i).Value\n    wsmain.Cells(3, 11 + i).Formula = \"=IF(priceFlag, '[SP60-Sub-Index.xlsm]\" &amp; strName &amp; \"'!F2, '[SP60-Sub-Index.xlsm]\" &amp; strName &amp; \"'!E2)\"    \nNext i\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10382480, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d32f181bc02ce5e6a606a4d94b2735e5?s=128&d=identicon&r=PG&f=1", "display_name": "user10382480", "link": "https://stackoverflow.com/users/10382480/user10382480"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 52415368, "answer_count": 1, "score": 1, "last_activity_date": 1594024687, "creation_date": 1537394654, "last_edit_date": 1594024687, "question_id": 52414799, "link": "https://stackoverflow.com/questions/52414799/worksheet-loop-how-to-retrieve-name-of-the-worksheet-and-put-it-into-formula", "title": "Worksheet loop - How to retrieve name of the worksheet and put it into formula", "body": "<p>For each column in the worksheet, I was trying to grab information from another worksheet based on the header of the column (where the first row in the column would have the same name as the worksheet).</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Dim i As Integer\nFor i = 1 To 60\n    wsmain.Cells(2, 11 + i).FormulaArray = \"=IF(priceFlag, '[SP60-Sub-Index.xlsm]wsName'!F2, '[SP60-Sub-Index.xlsm]wsName'!E2)\"\n\n    strName = wsmain.Cells(2, 11 + i).Value\n    With wsmain.Cells(2, 11 + i)\n        .Replace \"wsName\", strName, xlPart\n    End With\nNext i\n</code></pre>\n\n<p>I have defined <code>strName</code> as a string, but it does not work.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["json", "excel", "vba", "parsing"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537394747, "post_id": 52414592, "comment_id": 91773325, "body": "If you need to work with JSON in VBA then I would recommend using this library: <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">github.com/VBA-tools/VBA-JSON</a>"}, {"owner": {"reputation": 7361, "user_id": 3607273, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/6cdb2fe7b9c6b5d10eaed35e2f16fa67?s=128&d=identicon&r=PG&f=1", "display_name": "S Meaden", "link": "https://stackoverflow.com/users/3607273/s-meaden"}, "edited": false, "score": 0, "creation_date": 1537395611, "post_id": 52414592, "comment_id": 91773582, "body": "Your can use the ScriptControl and download a well used javascript library to it <a href=\"http://exceldevelopmentplatform.blogspot.com/2018/01/vba-parsed-json-as-application-state.html\" rel=\"nofollow noreferrer\">exceldevelopmentplatform.blogspot.com/2018/01/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 65, "user_id": 10250845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18994fe5c242b4e9263d670e55f680d?s=128&d=identicon&r=PG&f=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/10250845/brett"}, "edited": false, "score": 0, "creation_date": 1537395473, "post_id": 52414854, "comment_id": 91773543, "body": "When I try to run that code it says ParseJson is not defined. Do I need to reference something?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 65, "user_id": 10250845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18994fe5c242b4e9263d670e55f680d?s=128&d=identicon&r=PG&f=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/10250845/brett"}, "edited": false, "score": 0, "creation_date": 1537395679, "post_id": 52414854, "comment_id": 91773599, "body": "You need to download the linked library."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1537395658, "last_edit_date": 1537395658, "creation_date": 1537395031, "answer_id": 52414854, "question_id": 52414592, "link": "https://stackoverflow.com/questions/52414592/how-to-set-a-variable-equal-to-a-json-value-from-another-variable-excel-vba/52414854#52414854", "title": "How to set a variable equal to a json value from another variable excel vba", "body": "<p>If you need to work with JSON in VBA then I would recommend using this library: </p>\n\n<p><a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">https://github.com/VBA-tools/VBA-JSON</a></p>\n\n<p>A simple example using that library:</p>\n\n<pre><code>Public Sub Tester()\n\n    Dim http As Object, JSON As Object, d\n    Set http = CreateObject(\"MSXML2.XMLHTTP\")\n\n    http.Open \"GET\", \"https://reqres.in/api/users?page=2\", False\n    http.SetRequestHeader \"Content-Type\", \"application/json\"\n    http.Send\n    Set JSON = ParseJson(http.responseText)\n\n    For Each d In JSON(\"data\")\n        Debug.Print d(\"id\"), d(\"first_name\")\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "is_accepted": false, "score": 1, "last_activity_date": 1578009367, "last_edit_date": 1578009367, "creation_date": 1537397840, "answer_id": 52415231, "question_id": 52414592, "link": "https://stackoverflow.com/questions/52414592/how-to-set-a-variable-equal-to-a-json-value-from-another-variable-excel-vba/52415231#52415231", "title": "How to set a variable equal to a json value from another variable excel vba", "body": "<p>Here is VBA example showing how that values could be retrieved. <strong>Import <a href=\"https://github.com/omegastripes/VBA-JSON-parser\" rel=\"nofollow noreferrer\">JSON.bas</a> module into the VBA project for JSON processing.</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n\nSub Test()\n\n    Dim sJSONString As String\n    Dim vJSON\n    Dim sState As String\n    Dim aItems\n    Dim firstName As String\n    Dim oItem\n    Dim i As Long\n    Dim aData()\n    Dim aHeader()\n\n    ' Retrieve JSON content\n    With CreateObject(\"MSXML2.XMLHTTP\")\n        .Open \"GET\", \"https://reqres.in/api/users?page=2\", True\n        .send\n        Do Until .readyState = 4: DoEvents: Loop\n        sJSONString = .responseText\n    End With\n    ' Parse JSON sample\n    JSON.Parse sJSONString, vJSON, sState\n    If sState = \"Error\" Then\n        MsgBox \"Invalid JSON\"\n        End\n    End If\n    ' Process objects in array\n    ' Get 'data' array of objects, there is no Set keyword for arrays\n    aItems = vJSON(\"data\")\n    ' Access specific item 'first_name' property\n    firstName = aItems(0)(\"first_name\")\n    Debug.Print firstName\n    ' Access each item 'first_name' property\n    For Each oItem In aItems\n        firstName = oItem(\"first_name\")\n        Debug.Print firstName\n    Next\n    ' Convert array of objects to 2d array\n    JSON.ToArray aItems, aData, aHeader\n    ' Access each item element with index 1, which corresponds to 'first_name' property\n    For i = 0 To UBound(aData, 1)\n        firstName = aData(i, 1)\n        Debug.Print firstName\n    Next\n    ' Output 2d array to first worksheet\n    With ThisWorkbook.Sheets(1)\n        .Cells.Delete\n        .Cells.WrapText = False\n        OutputArray .Cells(1, 1), aHeader\n        Output2DArray .Cells(2, 1), aData\n        .Columns.AutoFit\n    End With\n    MsgBox \"Completed\"\n\nEnd Sub\n\nSub OutputArray(oDstRng As Range, aCells As Variant)\n\n    With oDstRng\n        .Parent.Select\n        With .Resize(1, UBound(aCells) - LBound(aCells) + 1)\n            .NumberFormat = \"@\"\n            .Value = aCells\n        End With\n    End With\n\nEnd Sub\n\nSub Output2DArray(oDstRng As Range, aCells As Variant)\n\n    With oDstRng\n        .Parent.Select\n        With .Resize( _\n                UBound(aCells, 1) - LBound(aCells, 1) + 1, _\n                UBound(aCells, 2) - LBound(aCells, 2) + 1)\n            .NumberFormat = \"@\"\n            .Value = aCells\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>BTW, the similar approach applied <a href=\"https://stackoverflow.com/search?tab=newest&amp;q=user%3a2165759%20is%3aanswer%20json.bas\">in other answers</a>.</p>\n"}], "owner": {"reputation": 65, "user_id": 10250845, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18994fe5c242b4e9263d670e55f680d?s=128&d=identicon&r=PG&f=1", "display_name": "Brett", "link": "https://stackoverflow.com/users/10250845/brett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1233, "favorite_count": 0, "accepted_answer_id": 52414854, "answer_count": 2, "score": 1, "last_activity_date": 1578009367, "creation_date": 1537393503, "question_id": 52414592, "link": "https://stackoverflow.com/questions/52414592/how-to-set-a-variable-equal-to-a-json-value-from-another-variable-excel-vba", "title": "How to set a variable equal to a json value from another variable excel vba", "body": "<p>The json I am parsing is at this URL <a href=\"https://reqres.in/api/users?page=2\" rel=\"nofollow noreferrer\">https://reqres.in/api/users?page=2</a>. I am using the following code to parse it.</p>\n\n<pre><code>Option Explicit\n\nSub Test_LateBinding()\n\nDim objRequest As Object\nDim strUrl As String\nDim blnAsync As Boolean\nDim strResponse As String\n\nSet objRequest = CreateObject(\"MSXML2.XMLHTTP\")\nstrUrl = \"https://reqres.in/api/users?page=2\"\nblnAsync = True\n\nWith objRequest\n    .Open \"GET\", strUrl, blnAsync\n    .SetRequestHeader \"Content-Type\", \"application/json\"\n    .Send\n    'spin wheels whilst waiting for response\n    While objRequest.readyState &lt;&gt; 4\n        DoEvents\n    Wend\n    strResponse = .ResponseText\nEnd With\n\nDebug.Print strResponse\n\nEnd Sub\n</code></pre>\n\n<p>I can successfully get the json into the strResponse variable. But lets say I want a variable that is equal to \"Eve\" which is under first name in the json string. How can I set a variable firstName = \"Eve\" from that json string.</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1537395542, "post_id": 52414575, "comment_id": 91773569, "body": "You never close <code>rs2</code>. You really shouldn&#39;t need to assign that to a recordset anyway."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537395862, "post_id": 52414575, "comment_id": 91773650, "body": "Exactly where is the error?"}, {"owner": {"reputation": 21, "user_id": 10388103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb8656aeba75773e4ebe0aa8e440a89?s=128&d=identicon&r=PG&f=1", "display_name": "ladytr0uble", "link": "https://stackoverflow.com/users/10388103/ladytr0uble"}, "edited": false, "score": 0, "creation_date": 1537405598, "post_id": 52414575, "comment_id": 91775660, "body": "I get the error at : rs1.MoveFirst  The if statement right above that was just my pathetic attempt to troubleshoot it."}, {"owner": {"reputation": 21, "user_id": 10388103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb8656aeba75773e4ebe0aa8e440a89?s=128&d=identicon&r=PG&f=1", "display_name": "ladytr0uble", "link": "https://stackoverflow.com/users/10388103/ladytr0uble"}, "edited": false, "score": 0, "creation_date": 1538158417, "post_id": 52414575, "comment_id": 92059960, "body": "I don&#39;t think Excel likes vw_Days_Worked_AJ , which is a query in Access.  I tried to run: strSQL = &quot;Select VisitDate, PatientName, CaregiverCode, CaregiverName, CoordinatorName, AdmissionID &quot; _         &amp; &quot;From tbl_Prebilling_Review_AJ Where AdmissionID like &#39;AJH*&#39;;&quot; and got the dame problem: 0 records.    So I ran:  strSQL = &quot;Select VisitDate, PatientName, CaregiverCode, CaregiverName, CoordinatorName, AdmissionID &quot; _         &amp; &quot;From tbl_Prebilling_Review_AJ;&quot; No issues: it gave me the correct number of records. I need the Where portion of the query; how do I remedy my filter?"}, {"owner": {"reputation": 21, "user_id": 10388103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb8656aeba75773e4ebe0aa8e440a89?s=128&d=identicon&r=PG&f=1", "display_name": "ladytr0uble", "link": "https://stackoverflow.com/users/10388103/ladytr0uble"}, "edited": false, "score": 0, "creation_date": 1538158441, "post_id": 52414575, "comment_id": 92059969, "body": "So sorry, I can&#39;t seem to get the format right in my comment!"}, {"owner": {"reputation": 21, "user_id": 10388103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb8656aeba75773e4ebe0aa8e440a89?s=128&d=identicon&r=PG&f=1", "display_name": "ladytr0uble", "link": "https://stackoverflow.com/users/10388103/ladytr0uble"}, "edited": false, "score": 0, "creation_date": 1538771628, "post_id": 52414575, "comment_id": 92275597, "body": "In case someone stumbles upon this thread with a similar issue... turns out that Excel didn&#39;t like the asterisk I used for a wildcard.  I replaced the asterisk with a % and it works fine now."}], "owner": {"reputation": 21, "user_id": 10388103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb8656aeba75773e4ebe0aa8e440a89?s=128&d=identicon&r=PG&f=1", "display_name": "ladytr0uble", "link": "https://stackoverflow.com/users/10388103/ladytr0uble"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 139, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1593955329, "creation_date": 1537393399, "last_edit_date": 1593955329, "question_id": 52414575, "link": "https://stackoverflow.com/questions/52414575/eof-bof-error-in-excel-but-sql-statement-returns-records-in-access", "title": "EOF/BOF error in Excel but SQL statement returns records in Access", "body": "<p>Newbie here.\nI use Excel as a front end and Access as a back end to store data.  I am trying to take a query and write the values to an Access table using VBA in Excel. I get an Either BOF or EOF is True error, and when I run the SQL statement in Access, I get records.<br>\nAny feedback would be very much appreciated.  Thank you in advance.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>Sub Write_Timesheet_AJ()\n'**********************************************JGT**********************************************\n'Transpose Data for HCS\n'2018.09.17\n'**********************************************JGT**********************************************\nstrPath1 = \"C:\\Reports\\Timesheets\\\"\nstrFile1 = \"Timesheets.accdb\"\nstrDB = strPath1 &amp; strFile1\n\nConn.ConnectionString = \"Provider=Microsoft.ACE.OLEDB.12.0; Data Source=\" &amp; strDB &amp; \"; Persist Security Info=False;\"\n    Conn.Open strDB\n    Conn.CursorLocation = adUseClient\n\n'Clear table\nstrSQL = \"Delete * From tbl_Timesheet_AJ;\"\n    Set rs2 = Conn.Execute(strSQL)\n\n'Transpose Data\nstrSQL = \"Select VisitDate As VisitDt, PatientName, vw_Days_Worked_AJ.CaregiverCode As CaregiverCode, CaregiverName as AideName, CoordinatorName As Coordinator, \" _\n        &amp; \"Street_1 As Street1, Street_2 As Street2, City1 As City, State1 as State, Zip, [Language] as L1 \" _\n        &amp; \"From vw_Days_Worked_AJ Left Join vw_Caregiver_Info_AJ On vw_Days_Worked_AJ.CaregiverCode = vw_Caregiver_Info_AJ.CaregiverCode;\"\n\nSet rs1 = Conn.Execute(strSQL)\n\nIf rs1.RecordCount = 0 Then    'Record count check\n    Debug.Print strSQL\n    Debug.Print rs1.BOF\n    Debug.Print rs1.EOF\n\n    rs1.Close\n    Set rs1 = Nothing\n    Conn.Close\n'    MsgBox \"There are no records; please check data.\"\nElse\n    rs1.MoveFirst\n    rsCount1 = rs1.RecordCount\n    ReDim arrData1(rsCount1)\n\n    For loopX = 1 To rsCount1\n    With arrData1(loopX)\n        .VisitDt = Format(rs1.Fields(\"VisitDt\"), \"m/dd\")\n        .WkEndDt = Get_Fri_Dt(CDate(rs1.Fields(\"VisitDt\")))\n        .DayOfWk = Left(Get_Day_of_Wk(CDate(rs1.Fields(\"VisitDt\"))), 3)\n        .PatientName = rs1.Fields(\"PatientName\")\n        .CaregiverCode = rs1.Fields(\"CaregiverCode\")\n        .AideName = rs1.Fields(\"AideName\")\n        .Coordinator = rs1.Fields(\"Coordinator\")\n        If IsNull(rs1.Fields(\"Street1\")) Then .Street1 = \" \" Else .Street1 = rs1.Fields(\"Street1\")\n        If IsNull(rs1.Fields(\"Street2\")) Then .Street2 = \" \" Else .Street2 = rs1.Fields(\"Street2\")\n        If IsNull(rs1.Fields(\"City\")) Then .City = \" \" Else .City = rs1.Fields(\"City\")\n        If IsNull(rs1.Fields(\"State\")) Then .State = \" \" Else .State = rs1.Fields(\"State\")\n        If IsNull(rs1.Fields(\"Zip\")) Then .Zip = \" \" Else .Zip = rs1.Fields(\"Zip\")\n        If IsNull(rs1.Fields(\"L1\")) Then .L1 = \" \" Else .L1 = rs1.Fields(\"L1\")\n\n    strInsert = \"Insert Into tbl_Timesheet_AJ \" _\n            &amp; \"(WkEndDt, PatientName, CaregiverCode, AideName, Coordinator, \" &amp; .DayOfWk &amp; \", \" _\n            &amp; \"AideName2, CaregiverCode2, Street1, Street2, City, State, Zip, L1) \" _\n            &amp; \"Values (#\" &amp; .WkEndDt &amp; \"#, '\" &amp; .PatientName &amp; \"', '\" &amp; .CaregiverCode &amp; \"', \" _\n            &amp; \"'\" &amp; .AideName &amp; \"', '\" &amp; .Coordinator &amp; \"', '\" &amp; .VisitDt &amp; \"', '\" &amp; .AideName &amp; \"', \" _\n            &amp; \"'\" &amp; .CaregiverCode &amp; \"', '\" &amp; .Street1 &amp; \"', '\" &amp; .Street2 &amp; \"', '\" &amp; .City &amp; \"', \" _\n            &amp; \"'\" &amp; .State &amp; \"', '\" &amp; .Zip &amp; \"', '\" &amp; .L1 &amp; \"');\"\n    Set rs2 = Conn.Execute(strInsert)\n\n        rs1.MoveNext\n        End With\n\n        Next loopX\n\n        rs1.Close\n        Set rs1 = Nothing\n        Conn.Close\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "here-api"], "comments": [{"owner": {"reputation": 1923, "user_id": 3143339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04c9eddec9e044b2b10e27b1cc089e88?s=128&d=identicon&r=PG&f=1", "display_name": "donPablo", "link": "https://stackoverflow.com/users/3143339/donpablo"}, "edited": false, "score": 1, "creation_date": 1537402439, "post_id": 52414093, "comment_id": 91775007, "body": "I suggest you look at  their site  <a href=\"https://developer.here.com/documentation/routing/topics/request-constructing.html\" rel=\"nofollow noreferrer\">developer.here.com/documentation/routing/topics/&hellip;</a>   which shows what the outbound message looks like."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1537441671, "post_id": 52414093, "comment_id": 91790263, "body": "Added Here API tag. Removed opinion / irrelevant information. Removed pointers to other services to avoid opinion based answers. Changed structure of alineae to make question clearer."}, {"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1537441703, "post_id": 52414093, "comment_id": 91790280, "body": "It is advisable to add a code sample - What have you tried so far and where did you get stuck?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10387948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d46da38d1a5723db0932aa9ece95e3?s=128&d=identicon&r=PG&f=1", "display_name": "user10387948", "link": "https://stackoverflow.com/users/10387948/user10387948"}, "edited": false, "score": 0, "creation_date": 1537636344, "post_id": 52444859, "comment_id": 91860154, "body": "OK, I have the App ID and App Code from Here. As I examine the code examples at &lt;<a href=\"https://developer.here.com/documentation/routing/topics/request-constructing.html\" rel=\"nofollow noreferrer\">developer.here.com/documentation/routing/topics/&hellip;</a>&gt; (Thanks donPablo), I see they are expecting gps coordinates. My data as all street addresses."}, {"owner": {"reputation": 6669, "user_id": 3505695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ni0YL.png?s=128&g=1", "display_name": "HERE Developer Support", "link": "https://stackoverflow.com/users/3505695/here-developer-support"}, "reply_to_user": {"reputation": 1, "user_id": 10387948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d46da38d1a5723db0932aa9ece95e3?s=128&d=identicon&r=PG&f=1", "display_name": "user10387948", "link": "https://stackoverflow.com/users/10387948/user10387948"}, "edited": false, "score": 0, "creation_date": 1538127986, "post_id": 52444859, "comment_id": 92043944, "body": "You can use the geocoder api to get gps coordinates out of street addresses."}], "tags": [], "owner": {"reputation": 6669, "user_id": 3505695, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ni0YL.png?s=128&g=1", "display_name": "HERE Developer Support", "link": "https://stackoverflow.com/users/3505695/here-developer-support"}, "is_accepted": false, "score": 0, "last_activity_date": 1537536684, "creation_date": 1537536684, "answer_id": 52444859, "question_id": 52414093, "link": "https://stackoverflow.com/questions/52414093/microsoft-access-vba-assistance-for-here-api/52444859#52444859", "title": "Microsoft Access VBA assistance for Here API", "body": "<p>You can use the Routing Api for getting distance, travel time and numerous other information for a given mode of transport. You can call the routing rest api from your macro (VBA).  </p>\n"}], "owner": {"reputation": 1, "user_id": 10387948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d46da38d1a5723db0932aa9ece95e3?s=128&d=identicon&r=PG&f=1", "display_name": "user10387948", "link": "https://stackoverflow.com/users/10387948/user10387948"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 454, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594628722, "creation_date": 1537390501, "last_edit_date": 1594628722, "question_id": 52414093, "link": "https://stackoverflow.com/questions/52414093/microsoft-access-vba-assistance-for-here-api", "title": "Microsoft Access VBA assistance for Here API", "body": "<p>For years I used google maps to calculate travel time and distance for sales routes. Using MS Access database table for locations and a little form that a user could select addresses and number a route sequence. </p>\n\n<p>However, this data is not freely accessible anymore.</p>\n\n<p>I used to send google maps a simple string that contained a starting address and an ending address and I would get back a data string that would, among other things, contain the travel time and distance.</p>\n\n<p>I would like to obtain a similar result with Here.</p>\n\n<p>What I don't see at the Here site is any VBA guidance so I can write a callable module, in Access, that returns simple travel time and distance.</p>\n\n<p>Thanks for any guidance for this project.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537392165, "post_id": 52414092, "comment_id": 91772486, "body": "Is <code>wsO</code> the <code>ActiveSheet</code>? Try putting <code>wsO.Activate</code> before the <code>.Select</code> call."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1537392993, "post_id": 52414092, "comment_id": 91772758, "body": "@MathieuGuindon - I&#39;d instead recommend that OP <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using <code>.Select</code>/<code>.Activate</code> altogether</a>.  Also a personal thought, those worksheet/workbook variable names could be a little better/more specific/explicit."}, {"owner": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537392997, "post_id": 52414092, "comment_id": 91772764, "body": "@MathieuGuindon Thanks for your comment. I tried this (pasting Range instead of selecting it) before, although I get &amp;amp;amp;quot;Compile error: Named argument not found&amp;amp;amp;quot; while Format:= is highlighted"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 1, "creation_date": 1537393969, "post_id": 52414092, "comment_id": 91773083, "body": "<code>Format</code> is not an option with <code>PasteSpecial</code>.  Nothing after <code>PasteSpecial</code> is valid.  Try replacing all 3 arguments with <code>xlPasteAll</code>"}, {"owner": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1537394300, "post_id": 52414092, "comment_id": 91773196, "body": "@DarrellH When doing this, it pastes the previosly pasted data (Range(&quot;D39:BR97)) but not the textbox and the chart..."}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1537394556, "post_id": 52414092, "comment_id": 91773272, "body": "Delete the line that has <code>wsO.Range(&quot;G31&quot;).Select</code> and make the next line <code>wsO.Range(&quot;G31&quot;).PasteSpecial xlPasteAll</code>.  You did selection.copy, then selected again."}, {"owner": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1537394796, "post_id": 52414092, "comment_id": 91773344, "body": "@DarrellH that I did. As I mentioned before the previously pasted data is pasted again, but not the chart nor the textbox. Thanks!"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "edited": false, "score": 0, "creation_date": 1537448993, "post_id": 52414092, "comment_id": 91794829, "body": "@DarrellH OP is using <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.pastespecial\" rel=\"nofollow noreferrer\"><code>Worksheet.PasteSpecial</code></a>, which does have a <code>Format</code>  argument"}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "edited": false, "score": 0, "creation_date": 1537466300, "post_id": 52415239, "comment_id": 91805114, "body": "Thanks for your answer. Although no error is reported,  nothing gets pasted in the new workbook!"}, {"owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "reply_to_user": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "edited": false, "score": 0, "creation_date": 1537472693, "post_id": 52415239, "comment_id": 91808129, "body": "That&#39;s strange.  I tested it and it worked.  I&#39;ve used in previous code."}, {"owner": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "edited": false, "score": 0, "creation_date": 1537472778, "post_id": 52415239, "comment_id": 91808173, "body": "Now, if I paste in a sheet in the current workbook and save that sheet as a new workbook all works fine..."}], "tags": [], "owner": {"reputation": 1548, "user_id": 6466694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/828581c05a0412f2360afd492a5a37af?s=128&d=identicon&r=PG&f=1", "display_name": "Darrell H", "link": "https://stackoverflow.com/users/6466694/darrell-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1537397938, "creation_date": 1537397938, "answer_id": 52415239, "question_id": 52414092, "link": "https://stackoverflow.com/questions/52414092/pasting-objects-to-new-workbook/52415239#52415239", "title": "Pasting Objects to New Workbook", "body": "<p>Okay, here is a working solution starting from where your problem starts</p>\n\n<pre><code>wsI.Shapes.Range(Array(\"Chart 29\", \"TextBox 30\")).Select\nSelection.CopyPicture xlScreen, xlPicture\n\nwsO.Paste\nSelection.Name = \"NewShape\"\nWith wsO.Shapes(\"NewShape\")\n    .Top = wsO.Range(\"G31\").Top\n    .Left = wsO.Range(\"G31\").Left\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 3487128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acfe3fd0cb3891282e9a229586b42c?s=128&d=identicon&r=PG&f=1", "display_name": "user3487128", "link": "https://stackoverflow.com/users/3487128/user3487128"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537397938, "creation_date": 1537390501, "last_edit_date": 1537393119, "question_id": 52414092, "link": "https://stackoverflow.com/questions/52414092/pasting-objects-to-new-workbook", "title": "Pasting Objects to New Workbook", "body": "<p>I would like to copy some textboxes and charts that are on a sheet and paste them on a newly created workbook for a report. So far I've been trying to modify a piece of code I found here. This is what I have so far:</p>\n\n<pre><code>Sub SampleIndividualReport()\n    Dim wbI As Workbook, wbO As Workbook\n    Dim wsI As Worksheet, wsO As Worksheet\n\n\n    Set wbI = ThisWorkbook\n    Set wsI = Sheet7\n\n    Set wbO = Workbooks.Add\n\n    With wbO\n        Set wsO = wbO.Sheets(\"Sheet1\")\n        ActiveWindow.DisplayHeadings = False\n        Application.DisplayFormulaBar = False\n        ActiveWindow.DisplayGridlines = False\n\n        .SaveAs ThisWorkbook.Path &amp; \"\\\" &amp; GetSelectedSlicerItems(\"Slicer_Teacher\") &amp; \".xlsx\"\n\n        wsI.Range(\"D39:BR97\").Copy\n\n        wsO.Range(\"D7\").PasteSpecial Paste:=xlPasteAllUsingSourceTheme, Operation:=xlNone _\n        , SkipBlanks:=False, Transpose:=False\n\n        wsO.Range(\"D7\").PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n\n\n        wsI.Shapes.Range(Array(\"Chart 29\", \"TextBox 30\")).Select\n        Selection.Copy\n\n        wsO.Range(\"G31\").Select\n        wsO.PasteSpecial Format:=\"Picture (Enhanced Metafile)\", Link:=False _\n        , DisplayAsIcon:=False\n\n        .Save\n\n   End With\nEnd Sub\n</code></pre>\n\n<p>That last PasteSpecial gives me: Run-time error '1004': Method 'PasteSpecial' of object '_Worksheet' failed.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537389433, "post_id": 52413704, "comment_id": 91771427, "body": "A bit confused - why don&#39;t you flip the logic around? Check if the criteria is not met, if so make the required change, otherwise proceed to <code>PushTo95Button</code>. In other words, I&#39;m not sure why <code>PushTo95Button</code> is within the <code>If</code>."}, {"owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537390821, "post_id": 52413704, "comment_id": 91772006, "body": "Wow, you pointed out the most obvious solution and I was so caught up in thinking it another way. I actually just ran this code first &quot;Range(&quot;LoanAmount&quot;).Value = Worksheets(&quot;Closing Costs&quot;).Range(&quot;I3&quot;)&quot; that calculates the true LTV and then do the evaluation and it worked like a charm. I had my logic all screwed up"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1537391019, "post_id": 52413704, "comment_id": 91772079, "body": "You can post an answer to your own question, if you want."}], "answers": [{"tags": [], "owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "is_accepted": false, "score": 0, "last_activity_date": 1537419714, "creation_date": 1537419714, "answer_id": 52417913, "question_id": 52413704, "link": "https://stackoverflow.com/questions/52413704/how-do-i-re-evaluate-a-range/52417913#52417913", "title": "How do I re-evaluate a range", "body": "<p>Thanks to BigBen I rethought the logic and rearranged the code to where the criteria is checked first:</p>\n\n<pre><code>Sub PushTo105Button()\nRange(\"D22\").Value = 0\nRange(\"LoanAmount\").Value = Worksheets(\"Closing Costs\").Range(\"I3\")\nRange(\"LoanAmount\").Value = Worksheets(\"Closing Costs\").Range(\"I3\")\nCall Calc_MI\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 6625232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0c73ea7fdce6867dddac6e36ed0e5cf?s=128&d=identicon&r=PG&f=1", "display_name": "MEC", "link": "https://stackoverflow.com/users/6625232/mec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547794868, "creation_date": 1537388688, "last_edit_date": 1547794868, "question_id": 52413704, "link": "https://stackoverflow.com/questions/52413704/how-do-i-re-evaluate-a-range", "title": "How do I re-evaluate a range", "body": "<p>I have a routine that runs one of 2 pieces of code depending on the value of a named range (LTV).</p>\n\n<p>The issue is that at the time of the evaluation of the named range (LTV) is made it does not meet the criteria to trigger the PushTo95Button routine but after the code in the \"else\" is executed the criteria is now met to call the first routine (PushTo95Button). I have to run the macro twice to get the desired result.</p>\n\n<p>How I can evaluate the named range (LTV) after the first pass?</p>\n\n<pre><code>Sub PushTo105Button()\nRange(\"D22\").Value = 0\nIf Range(\"PropertyType\").Value = \"Condo\" And Range(\"LTV\").Value &gt; 0.95 Then\n   Call PushTo95Button\nElse\n   Range(\"LoanAmount\").Value = Worksheets(\"Closing Costs\").Range(\"I3\")\nEnd If\nCall Calc_MI\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1537388818, "post_id": 52413486, "comment_id": 91771161, "body": "Did you just update the <code>Range</code> assignments, or did you update all the magic numbers for the columns too?  Note that you have a single column assignment with <code>Set dataRangeB = Range(&quot;C:C&quot;)</code> and then index outside of that column later with <code>dataRangeB(i, 2)</code>. I suspect you&#39;ll need to step through everything with the debugger to make get the indexing correct again. Not much anyone here can do without a lot more information about the data."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1537389677, "post_id": 52413486, "comment_id": 91771540, "body": "I recommend using a variable and number system to define the columns, rows for that matter, you can make your changes at the top of the code and not have to chase it through the module.  I know that is a pain, but a pain that is well worth it."}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1537389865, "post_id": 52413486, "comment_id": 91771619, "body": "If you never want to go through this again and you know the headers of the columns you want, write a little script that assigns the col number in a simple loop upon a instr &gt; 0 condition.  I have had to do this on a few occasions, where I am actually inserting new columns (adding months to financial sheets), you can run the script whenever you want as many times as you want, especially if you are inserting or deleting, same things for particular rows of course."}, {"owner": {"reputation": 69, "user_id": 3614131, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/h0uO5.png?s=128&g=1", "display_name": "Obie_One", "link": "https://stackoverflow.com/users/3614131/obie-one"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1537422394, "post_id": 52413486, "comment_id": 91779814, "body": "@Comintern, you were right. I changed that dataRangeB(i, 2) to dataRangeB(i,1) and EUREKA!. I don&#39;t understand how my eyes missed that. You are correct I was out of index."}], "owner": {"reputation": 69, "user_id": 3614131, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/h0uO5.png?s=128&g=1", "display_name": "Obie_One", "link": "https://stackoverflow.com/users/3614131/obie-one"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537387748, "creation_date": 1537387748, "question_id": 52413486, "link": "https://stackoverflow.com/questions/52413486/after-adding-a-new-row-to-the-left-affects-my-datarange-in-my-excel-macro", "title": "After adding a new row to the left affects my DataRange in my Excel Macro", "body": "<p>I created an excel spreadsheet with a macro. The code worked fine until the end user added a column. I then modified the code to account for the shift in columns. Everything worked except for the Data Range Object. I changed the Range to one column and now it is reading the column to the right of it. \nThey used to be columns A, B, I. They now read columns C, D, K. Has anyone had this problem before? \nHere is my Macro Code as of now and after the new column:</p>\n\n<pre><code>Sub Transfer2NewWorkbook()\nDim currentsheet As String\nDim newsheet As String\nDim analysisDate As String\nDim initial As String\nDim aInitial() As String      \nDim analystInit As String\nDim aBatch() As String\nDim batch As String\nDim batchNo As String\nDim key As Variant\nDim ikey As Variant\n\nDim SrowN As String\nDim rowN As Integer\nDim rowD As String\nDim mKey As String\nDim wb As Object\nDim dataRangeN As Range, dataRangeB As Range, dataRangeI As Range\nDim dataN As Object\nSet dataN = CreateObject(\"Scripting.Dictionary\")\nDim dataB As Object\nSet dataB = CreateObject(\"Scripting.Dictionary\")\nDim dataT As Object\nSet dataT = CreateObject(\"Scripting.Dictionary\")\nDim dataI As Object\nSet dataI = CreateObject(\"Scripting.Dictionary\")\nDim teststring As String\n\n\n\n' Grab and Create filenames\ncurrentsheet = ActiveWorkbook.Name\nIf Right$(currentsheet, 1) = \"s\" Then\n    currentsheet = Left(currentsheet, Len(currentsheet) - 4)\nElse\n    currentsheet = Left(currentsheet, Len(currentsheet) - 5)\nEnd If\n\nnewsheet = currentsheet &amp; \"-\" &amp; \"uploadable\"\n\n' Grab data from original spreadsheet\nanalysisDate = ActiveWorkbook.Sheets(1).Cells(1, 10).Value\n\ninitial = ActiveWorkbook.Sheets(1).Cells(1, 3).Value\naInitial = Split(initial, \"/\")\nanalystInit = aInitial(1)\n\nbatch = ActiveWorkbook.Sheets(1).Cells(1, 5).Value\naBatch = Split(batch, \":\")\nbatchNo = aBatch(1)\n\nSet dataRangeN = Range(\"B:B\")\nSet dataRangeB = Range(\"C:C\")\nSet dataRangeI = Range(\"J:J\")\n\n\nFor i = 4 To dataRangeB.Rows.Count\n    If Not IsEmpty(dataRangeB(i, 2)) Then\n        If StrComp(ActiveWorkbook.Sheets(1).Cells(i, 3).Value, \"End\") = 0 Then\n            Exit For\n        ElseIf StrComp(ActiveWorkbook.Sheets(1).Cells(i, 3).Value, \"Blank\") = 0 Then\n             If StrComp(ActiveWorkbook.Sheets(1).Cells(i, 2).Value, \"Unseeded\") = 0 Or StrComp(ActiveWorkbook.Sheets(1).Cells(i, 2).Value, \"Seeded\") = 0 Then\n                If Not IsEmpty(dataRangeI(i, 1)) Then\n                    dataN.Add i, ActiveWorkbook.Sheets(1).Cells(i, 2).Value\n                    dataB.Add i, ActiveWorkbook.Sheets(1).Cells(i, 3).Value\n                    dataI.Add i, ActiveWorkbook.Sheets(1).Cells(i, 10).Value\n                End If\n             End If\n        ElseIf StrComp(ActiveWorkbook.Sheets(1).Cells(i, 3).Value, \"Check\") = 0 Then\n            If StrComp(ActiveWorkbook.Sheets(1).Cells(i, 2).Value, \"Std\") = 0 Then\n                If Not IsEmpty(dataRangeI(i, 1)) Then\n                    dataN.Add i, ActiveWorkbook.Sheets(1).Cells(i, 2).Value\n                    dataB.Add i, ActiveWorkbook.Sheets(1).Cells(i, 3).Value\n                    dataI.Add i, ActiveWorkbook.Sheets(1).Cells(i, 10).Value\n                End If\n            End If\n        ElseIf StrComp(ActiveWorkbook.Sheets(1).Cells(i, 3).Value, \"DUP\") = 0 Then\n            rowD = dataB.Keys()(dataB.Count - 1)\n            If StrComp(ActiveWorkbook.Sheets(1).Cells(i - 1, 2).Value, \"CBOD\") = 0 Then\n                dataN.Add rowD, \"DUP-CBOD\"\n            ElseIf StrComp(ActiveWorkbook.Sheets(1).Cells(i - 1, 2).Value, \"BOD\") = 0 Then\n                dataN.Add rowD, \"DUP-BOD\"\n            End If\n        Else\n            If Len(ActiveWorkbook.Sheets(1).Cells(i, 3).Value) = 16 Then\n                    dataT.Add i, ActiveWorkbook.Sheets(1).Cells(i + 1, 2).Value\n                    dataB.Add i, ActiveWorkbook.Sheets(1).Cells(i, 3).Value\n                    dataI.Add i, ActiveWorkbook.Sheets(1).Cells(i, 10).Value\n            End If\n        End If\n    Else\n        If StrComp(ActiveWorkbook.Sheets(1).Cells(i, 2).Value, \"DUP\") = 0 Then\n            If ActiveWorkbook.Sheets(1).Cells(i, 3).Value &lt;&gt; \"\" Then\n                rowD = dataB.Keys()(dataB.Count - 1)\n                If StrComp(ActiveWorkbook.Sheets(1).Cells(i - 1, 2).Value, \"CBOD\") = 0 Then\n                    dataN.Add rowD, \"DUP-CBOD\"\n                ElseIf StrComp(ActiveWorkbook.Sheets(1).Cells(i - 1, 2).Value, \"BOD\") = 0 Then\n                    dataN.Add rowD, \"DUP-BOD\"\n                End If\n            End If\n        End If\n    End If\nNext i\n\n' Open new spreadsheet\nSet wb = \n Workbooks.Add(\"\\\\******\\ops\\envcom\\exec\\envcom\\LAB\\BOD\\uploadtemp.xlsx\")\n\nActiveWorkbook.Sheets(1).Cells(2, 1).Value = analysisDate\nActiveWorkbook.Sheets(1).Cells(2, 2).Value = analystInit\nActiveWorkbook.Sheets(1).Cells(2, 4).Value = batchNo\n\nrowN = 4\nFor Each key In dataB.Keys\n    mKey = key\n    If dataI.Exists(key) Then\n        SrowN = CStr(rowN)\n        If dataN.Exists(key) Or dataN.Exists(mKey) Then\n            If dataN(key) = \"\" Then\n                ActiveWorkbook.Sheets(1).Cells(SrowN, 1).Value = dataN(mKey)\n            Else\n                ActiveWorkbook.Sheets(1).Cells(SrowN, 1).Value = dataN(key)\n            End If\n        End If\n        ActiveWorkbook.Sheets(1).Cells(SrowN, 2).Value = dataB(key)\n        ActiveWorkbook.Sheets(1).Cells(SrowN, 3).Value = dataT(key)\n        ActiveWorkbook.Sheets(1).Cells(SrowN, 4).Value = dataI(key)\n        rowN = CInt(SrowN)\n        rowN = rowN + 1\n    End If\nNext\n\nActiveWorkbook.SaveAs \n(\"\\\\******\\ops\\envcom\\exec\\envcom\\LAB\\BOD\\Uploadables\\\" &amp; newsheet &amp; \".xlsx\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "csv"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1537387145, "post_id": 52413299, "comment_id": 91770496, "body": "Is everything in one or in multiple columns? i.e. is &quot;angeb* 12 16 18 70&quot; all in one column or is &quot;angeb*&quot; in one column, &quot;12&quot; in the next column, &quot;16&quot; in the next one and so forth?"}, {"owner": {"reputation": 35, "user_id": 9401063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017b024f94889dc2b778473ad0ab53db?s=128&d=identicon&r=PG&f=1", "display_name": "TSpinde", "link": "https://stackoverflow.com/users/9401063/tspinde"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1537387216, "post_id": 52413299, "comment_id": 91770525, "body": "All in different columns: angeb* -- 12 -- 16 -- 18 ... Thank you, gonna edit the question!"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1537387778, "post_id": 52413299, "comment_id": 91770749, "body": "@TSpinde Do the numbers have to be going lowest to highest, left to right?"}, {"owner": {"reputation": 35, "user_id": 9401063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017b024f94889dc2b778473ad0ab53db?s=128&d=identicon&r=PG&f=1", "display_name": "TSpinde", "link": "https://stackoverflow.com/users/9401063/tspinde"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537387846, "post_id": 52413299, "comment_id": 91770776, "body": "@dwirony, no, order of the numbers is not relevant."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537387885, "post_id": 52413299, "comment_id": 91770790, "body": "@TSpinde Also are those wildcards in your strings, or are those the literal strings? Do you want anything that begins with <code>angeb</code> to be put in the same line?"}, {"owner": {"reputation": 35, "user_id": 9401063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017b024f94889dc2b778473ad0ab53db?s=128&d=identicon&r=PG&f=1", "display_name": "TSpinde", "link": "https://stackoverflow.com/users/9401063/tspinde"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537388021, "post_id": 52413299, "comment_id": 91770841, "body": "@dwirony They are wildcards, but only the literal strings should be compared, also including the *. There are different words starting with <code>angeb</code> included, but only the exact same ones should be concatenated, so only <code>angeb*</code> and <code>angeb*</code>."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9401063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017b024f94889dc2b778473ad0ab53db?s=128&d=identicon&r=PG&f=1", "display_name": "TSpinde", "link": "https://stackoverflow.com/users/9401063/tspinde"}, "edited": false, "score": 0, "creation_date": 1537539534, "post_id": 52414205, "comment_id": 91834146, "body": "Worked like a charm! Really nice solution, I didn&#180;t even have to extend a lot, just small things. Really, thank you! Even if with the video - one of the best almost &quot;tutorials&quot; i&#180;ve seen here."}, {"owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "reply_to_user": {"reputation": 35, "user_id": 9401063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017b024f94889dc2b778473ad0ab53db?s=128&d=identicon&r=PG&f=1", "display_name": "TSpinde", "link": "https://stackoverflow.com/users/9401063/tspinde"}, "edited": false, "score": 0, "creation_date": 1537623417, "post_id": 52414205, "comment_id": 91856590, "body": "Thank you! And thank you for looking at Brotato&#39;s answer too. I knew there would be a good VBA routine, but this is a difficult data structure to deal with. I have had to solve similar problems manually, so that is why I presented my solution here :D"}], "tags": [], "owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "is_accepted": true, "score": 0, "last_activity_date": 1537391055, "creation_date": 1537391055, "answer_id": 52414205, "question_id": 52413299, "link": "https://stackoverflow.com/questions/52413299/concatenate-excel-rows-based-on-common-cell-including-different-columns/52414205#52414205", "title": "Concatenate (Excel) rows based on common cell, including different columns", "body": "<p><a href=\"https://i.stack.imgur.com/vbVJT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vbVJT.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have written and color-coded each part of what I did, but here is the general method:</p>\n\n<ol>\n<li>Sort all data A-Z</li>\n<li>Use a CountIf statement to count how many times a particular data row shows up. </li>\n<li>Assuming 3 columns of data, find MAX() of MaxRows, multiply (here, 3 columns x 2 Rows maximum observed = 6 data max).</li>\n<li>Copy the labels, remove duplicates [Green] so you have a condensed table.</li>\n<li>Use IndexMatch equations, coupled with IF and IFERROR statements to re-sort the data. Note the +1 for Columns P-Q)</li>\n</ol>\n\n<p>Problem - you can still get a gap, but it's all in the same rows now!</p>\n\n<p>Here's a quick Youtube video on how I did it.\n<a href=\"https://youtu.be/eWOJz_RcVuk\" rel=\"nofollow noreferrer\">TSpinde Answer 1</a></p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 9401063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017b024f94889dc2b778473ad0ab53db?s=128&d=identicon&r=PG&f=1", "display_name": "TSpinde", "link": "https://stackoverflow.com/users/9401063/tspinde"}, "edited": false, "score": 0, "creation_date": 1537525760, "post_id": 52415665, "comment_id": 91826126, "body": "Thanks a lot for this very helpful answer! It does work very well, however, it does not scale well when there are quite a lot rows included. I&#180;m gonna try to improve that and also have a look at the above answer :). Maybe you have an spontanous idea upon how make it scale up to like max. 10.000 rows?"}, {"owner": {"reputation": 35, "user_id": 9401063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017b024f94889dc2b778473ad0ab53db?s=128&d=identicon&r=PG&f=1", "display_name": "TSpinde", "link": "https://stackoverflow.com/users/9401063/tspinde"}, "edited": false, "score": 0, "creation_date": 1537539603, "post_id": 52415665, "comment_id": 91834187, "body": "Maybe suited better for smaller solution - @C.A.R.s solutions worked just fine :). Thank you a lot! Learned quite much about VBA while adapting and trying out this :)."}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "reply_to_user": {"reputation": 35, "user_id": 9401063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017b024f94889dc2b778473ad0ab53db?s=128&d=identicon&r=PG&f=1", "display_name": "TSpinde", "link": "https://stackoverflow.com/users/9401063/tspinde"}, "edited": false, "score": 0, "creation_date": 1537545233, "post_id": 52415665, "comment_id": 91837361, "body": "No worries, glad you found the right solution for yourself"}], "tags": [], "owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "is_accepted": false, "score": 0, "last_activity_date": 1537401264, "creation_date": 1537401264, "answer_id": 52415665, "question_id": 52413299, "link": "https://stackoverflow.com/questions/52413299/concatenate-excel-rows-based-on-common-cell-including-different-columns/52415665#52415665", "title": "Concatenate (Excel) rows based on common cell, including different columns", "body": "<p>I was a little confused by your question so I only concatenated names that were exactly the same. </p>\n\n<p>So the way my code works is it makes an array of tags and when it runs into one that it already has it looks for the next empty slot in the original row. It then adds the value in and does this until it hits an empty cell in the new row. There's a bit of funny business with decreasing the lastrow value and changing the row it's on, but its necessary for it to move to the correct row of data in the next cycle.</p>\n\n<p>This macro assumes that all possible data entries are side by side, for example there wont be a value in C2 and E2 if D2 is empty. </p>\n\n<pre><code>Sub macro()\n\nDim LastRow As Long\nDim LastCol As Long\nDim TagArray() As String\nDim count As Long\nDim i As Long\nDim j As Long\nDim PreExisting As Boolean\nDim Targetrow As Long\n\nReDim TagArray(1 To 1)\nLastRow = Worksheets(1).Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\nLastCol = Worksheets(1).Cells.Find(\"*\", SearchOrder:=xlByColumns, SearchDirection:=xlPrevious).Column\nTagArray(1) = Worksheets(1).Range(\"A1\").Value\n\nFor i = 2 To LastRow\n    PreExisting = False\n\n    For j = 1 To UBound(TagArray)\n        If Worksheets(1).Cells(i, 1) = TagArray(j) Then\n            PreExisting = True\n            Targetrow = j\n            Exit For\n        End If\n    Next j\n\n    If PreExisting Then\n        For j = 2 To LastCol\n            If Not IsEmpty(Worksheets(1).Cells(i, j)) Then\n                For count = 1 To LastCol\n                    If IsEmpty(Worksheets(1).Cells(Targetrow, count)) Then\n                        Worksheets(1).Cells(Targetrow, count) = Worksheets(1).Cells(i, j)\n                        Exit For\n                    Else\n                        If count = LastCol Then\n                            LastCol = LastCol + 1\n                            Worksheets(1).Cells(Targetrow, LastCol) = Worksheets(1).Cells(i, j).Value\n                        End If\n                    End If\n                Next count\n            Else\n                Exit For\n            End If\n        Next j\n        Worksheets(1).Rows(i).Delete\n        LastRow = LastRow - 1\n        i = i - 1\n    Else\n        ReDim Preserve TagArray(1 To UBound(TagArray) + 1)\n        TagArray(UBound(TagArray)) = Worksheets(1).Cells(i, 1)\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n\n<p>Hopefully, you find this useful if you wanted to use it in VBA instead of worksheet functions.</p>\n"}], "owner": {"reputation": 35, "user_id": 9401063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017b024f94889dc2b778473ad0ab53db?s=128&d=identicon&r=PG&f=1", "display_name": "TSpinde", "link": "https://stackoverflow.com/users/9401063/tspinde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 52414205, "answer_count": 2, "score": 1, "last_activity_date": 1537525816, "creation_date": 1537386717, "last_edit_date": 1537525816, "question_id": 52413299, "link": "https://stackoverflow.com/questions/52413299/concatenate-excel-rows-based-on-common-cell-including-different-columns", "title": "Concatenate (Excel) rows based on common cell, including different columns", "body": "<p>I've been searching for a way to concatenate my Excel (or any other tool/software handling tables) rows based on common cells. As an example: </p>\n\n<p>I have this tab-stop divided table. Each of the values is in a separate row:</p>\n\n<pre><code>angeb*    12      16      18    \nzyste*        60      61        \nzynisch*      12            \nzyste*        60            \nabstreit*     70            \nanflunker*    70            \nangeb*    70    \n</code></pre>\n\n<p>I want to concatenate the rows in a way that the result would be:</p>\n\n<pre><code>angeb*    12      16      18      70\nzyste*        60      61        \nzynisch*      12                    \nabstreit*     70            \nanflunker*    70\n</code></pre>\n\n<p>It does work by doing as proposed in <a href=\"https://www.extendoffice.com/documents/excel/3153-excel-concatenate-if-same-value.html\" rel=\"nofollow noreferrer\">this tutorial</a>, but it only concatenates single cell values into another single cell. I also tried going the path basically proposed by <a href=\"https://stackoverflow.com/questions/10938626/excel-merge-rows-based-on-column-values\">this so question</a> and finally leading me to VLOOKUP (<a href=\"http://sulprobil.com/Get_it_done/IT/Excel_Fun/Excel_VBA/LOOKUP-Variants/lookup-variants.html\" rel=\"nofollow noreferrer\">description</a>). But they all concatenate in cells. </p>\n\n<p>Basically pretty simple, I need to merge cells with the same Column 1, but keep the columns, just concatenate beyond. The second row can then be deleted, once it is added to the first one. I tried adapting the above scripts, but I could not make it work in one step, just with then converting comma separated values into cells and copying them to new columns. I am not an expert with VBA, but this seems like a very simple functionality, I might as well be missing something. Any help is greatly appreciated. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 3, "creation_date": 1537386324, "post_id": 52413165, "comment_id": 91770085, "body": "Can you please post the code you have? Also, use the Macro Recorder.  Turn it on, then do <code>=SUM(B2:B8)</code> in <code>B11</code>.  Then stop the recorder, view the code and you should have an idea as to how to add this via VBA."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1537386449, "post_id": 52413165, "comment_id": 91770155, "body": "<code>ActiveSheet.Range(&quot;B11:D11&quot;).Formula = &quot;=SUM(B2:B10)&quot;</code>"}], "owner": {"reputation": 11, "user_id": 10387730, "user_type": "registered", "profile_image": "https://graph.facebook.com/2156995587705893/picture?type=large", "display_name": "Emma", "link": "https://stackoverflow.com/users/10387730/emma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 70, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537387223, "creation_date": 1537386112, "last_edit_date": 1537387223, "question_id": 52413165, "link": "https://stackoverflow.com/questions/52413165/how-to-sum-a-specific-range-excel-vba", "title": "How to sum a specific range excel VBA", "body": "<p>I'm new to VBA and was wondering how I could code my macro to give me a \"totals\" row. I have already written a code to get it to display the word \"totals\" at the start of the line, but I am stuck on how to write a code to get it to display the sum of column B, C, and D in the totals row (row 11). </p>\n\n<p><img src=\"https://i.stack.imgur.com/AJCle.png\" alt=\"enter image description here\"></p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 11, "user_id": 10364651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb60c87430faed0e95b8ce1ee951de9b?s=128&d=identicon&r=PG&f=1", "display_name": "cbuerm", "link": "https://stackoverflow.com/users/10364651/cbuerm"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537387050, "post_id": 52413093, "comment_id": 91770458, "body": "That doesn&#39;t address what I&#39;m looking for. I can delete cells based on color and content. I need it to instead analyze what cells have the property of the yellow color, the 255,255,0 I mentioned above, then copy the row and column titles based on its location."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537387187, "post_id": 52413093, "comment_id": 91770514, "body": "You&#39;re struggling with how to copy a cell from one sheet to the next then? A) please <a href=\"https://stackoverflow.com/posts/52413093/edit\">edit</a> your post to make that much more clear. B) Post the code you&#39;ve tried, someone will point you in the right direction."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1537387203, "post_id": 52413093, "comment_id": 91770516, "body": "What have you tried - post any code? If you are basically searching for yellow cells use the Find method and set the SearchFormat parameter."}, {"owner": {"reputation": 11, "user_id": 10364651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb60c87430faed0e95b8ce1ee951de9b?s=128&d=identicon&r=PG&f=1", "display_name": "cbuerm", "link": "https://stackoverflow.com/users/10364651/cbuerm"}, "edited": false, "score": 0, "creation_date": 1537388293, "post_id": 52413093, "comment_id": 91770949, "body": "Added the code which clears cells with any other color than yellow, or ones that are yellow with a date. The ones I need to keep in that range are the yellow ones with no dates. From there I need to get the corresponding row and column titles for the Training and Name. Hopefully the image helps."}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537401437, "post_id": 52413853, "comment_id": 91774830, "body": "This wasn&#39;t an easy one. Some feed back would be appreciated"}, {"owner": {"reputation": 11, "user_id": 10364651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb60c87430faed0e95b8ce1ee951de9b?s=128&d=identicon&r=PG&f=1", "display_name": "cbuerm", "link": "https://stackoverflow.com/users/10364651/cbuerm"}, "edited": false, "score": 0, "creation_date": 1537455521, "post_id": 52413853, "comment_id": 91799399, "body": "I had not attempted anything with Union and this is working great. I will be able to test it with the full sheet tomorrow. I tried it with a new excel file and filled in the appropriate cells and it works great. The only issue I see is when a column contains no blank+yellow cells, it outputs an empty column on Sheet2. I&#39;m unsure of the VBA syntax but I think I should be able to figure out another loop to scan through sheet 2 for empty cells in row 1 and delete the column if so. I can&#39;t express my gratitude enough, this is amazing, thank you!"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "reply_to_user": {"reputation": 11, "user_id": 10364651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb60c87430faed0e95b8ce1ee951de9b?s=128&d=identicon&r=PG&f=1", "display_name": "cbuerm", "link": "https://stackoverflow.com/users/10364651/cbuerm"}, "edited": false, "score": 0, "creation_date": 1537455754, "post_id": 52413853, "comment_id": 91799576, "body": "I left a comment on where that needs to happen (It&#39;s at the bottom next to <code>If Not myUnion is Nothing Then</code>"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1537393622, "last_edit_date": 1537393622, "creation_date": 1537389481, "answer_id": 52413853, "question_id": 52413093, "link": "https://stackoverflow.com/questions/52413093/excel-vba-outputting-cell-row-and-column-titles-if-cell-is-colored/52413853#52413853", "title": "Excel VBA: Outputting cell row and column titles if cell is colored", "body": "<p>This will not clear the non-numeric cells. I am assuming that is already done.</p>\n\n<p>Any cell that is blank <strong>and</strong> highlighted yellow will be moved to a table on <code>Sheet2</code> with corresponding name.  </p>\n\n<p>You need to update the 3rd and 4th line of code to reflect your actual sheet names (make sure to leave the quotes of course). <code>Sheet1</code> reflects your \"starting sheet\" in photo and <code>Sheet2</code> reflects your desired output. </p>\n\n<p>This is dynamic by rows and columns. Last row (<code>lRow</code>) is determined by <code>Column A</code> and last column (<code>lCol</code>) is determined by <code>Row 1</code>. Photo of the starting point and output produced by the below macro. </p>\n\n<p><a href=\"https://i.stack.imgur.com/MA21h.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MA21h.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/fLRtU.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fLRtU.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n\nDim ws1 As Worksheet: Set ws1 = ThisWorkbook.Sheets(\"Sheet1\")\nDim ws2 As Worksheet: Set ws2 = ThisWorkbook.Sheets(\"Sheet2\")\n\nDim lCol As Long: lCol = ws1.Cells(1, ws1.Columns.Count).End(xlToLeft).Column\nDim lRow As Long: lRow = ws1.Range(\"A\" &amp; ws1.Rows.Count).End(xlUp).Row\n\nDim myRange As Range, myCell As Range, myUnion As Range\nDim i as Long\n\nFor i = 3 To lCol 'Open column loop\nSet myRange = ws1.Range(ws1.Cells(4, i), ws1.Cells(lRow, i))\n    For Each myCell In myRange 'Open row loop\n        If myCell = \"\" And myCell.Interior.Color = 65535 Then\n            If myUnion Is Nothing Then\n                Set myUnion = myCell.Offset(0, -i + 1)\n            Else\n                Set myUnion = Union(myUnion, myCell.Offset(0, -i + 1))\n            End If\n        End If\n    Next myCell 'Next Row\n\n    If Not myUnion Is Nothing Then 'This will need some updating to dynamically paste in first available column\n        ws2.Cells(1, i - 2).Value = ws1.Cells(1, i).Value\n        myUnion.Copy\n        ws2.Cells(2, i - 2).PasteSpecial xlPasteValues\n        Set myUnion = Nothing\n    End If\n\nNext i 'Next Column\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10364651, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb60c87430faed0e95b8ce1ee951de9b?s=128&d=identicon&r=PG&f=1", "display_name": "cbuerm", "link": "https://stackoverflow.com/users/10364651/cbuerm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 1, "closed_date": 1537429543, "accepted_answer_id": 52413853, "answer_count": 1, "score": -1, "last_activity_date": 1537393622, "creation_date": 1537385789, "last_edit_date": 1537388333, "question_id": 52413093, "link": "https://stackoverflow.com/questions/52413093/excel-vba-outputting-cell-row-and-column-titles-if-cell-is-colored", "closed_reason": "Duplicate", "title": "Excel VBA: Outputting cell row and column titles if cell is colored", "body": "<p>I'm fairly new to VBA and I've been struggling over this problem for a couple weeks.</p>\n\n<p>Every time a name has passed a training, the corresponding name/training title cell is filled with the date, and the background is filled in yellow RGB(255,255,0). When IN training they are filled with a yellow background and no date. (There are also some that are red or grey for out of date, but I think I have already worked those out.)</p>\n\n<p>The end goal is to have a separate output sheet within the same file. This sheet will only contain the necessary Training Titles at the top, and all of the names under it if they are the blank yellow cells (No date + yellow). Eventually I would like to be able to email this list to certain people, but I think there are enough resources to figure that out myself.</p>\n\n<p>Currently, I have code to find the max/min of the column/rows, and code that deletes all cells containing dates. My plan was to have it scan the remaining cells for any that were yellow, then paste the training titles/names on a new sheet, but I cannot figure out how to that in VBA. </p>\n\n<p>I'm sure there has to be an easier way to do this as it is several hundred columns wide and rows long.</p>\n\n<p>Thanks for any input!</p>\n\n<p>EDIT: This is the code I am currently using. This scans the range of name vs training and clears the cell data if it is any other color than yellow, or if it is yellow with a date.</p>\n\n<p>I attached an image to help explain more clearly. The important cells are the ones that are yellow with no date. From those cells I need to paste the Training Title in Row 1, and the Name of the person in Column A on a new sheet in the way you can see in the picture.</p>\n\n<pre><code>Sub ClearCellMacro()\n\nDim myLastCell As Range\nDim cell As Range\n\nApplication.ScreenUpdating = False\n\n'Find last cell\nSet myLastCell = Range(\"C4\").SpecialCells(xlLastCell)\n\n'Make sure last cell is outside of first row and column (or else exit)\nIf myLastCell.Row = 1 Or myLastCell.Column = 1 Then Exit Sub\n\n'Loop through entire range removing cell contents if value is not numeric\nFor Each cell In Range(\"C4:\" &amp; myLastCell.Address)\n    If Not IsNumeric(cell) Then cell.Clear\nNext cell\n\nFor Each cell In Range(\"C4:\" &amp; myLastCell.Address)\n    If cell.Interior.Color &lt;&gt; RGB(255, 255, 0) Then cell.Clear\nNext cell\n\nApplication.ScreenUpdating = True\n\nMsgBox \"Non-Yellow + Blank Cells Removed.\"\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/RNCVP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RNCVP.png\" alt=\"Main Sheet + Desired Output\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1537384621, "post_id": 52412768, "comment_id": 91769265, "body": "You can&#39;t use non-contiguous ranges to write to an array in this way."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1537384716, "post_id": 52412768, "comment_id": 91769307, "body": "This is a surprisingly similar question to <a href=\"https://stackoverflow.com/q/52408217/9245853\">this question asked earlier today</a> - even the column letters are the same, although the row numbers are different."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 1, "creation_date": 1537384731, "post_id": 52412768, "comment_id": 91769312, "body": "Looks like you&#39;ll have to loop on the areas of the union and just redim the array to include the new data with something like <code>For each &lt;range&gt; in myrange.Areas</code>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537384818, "post_id": 52412768, "comment_id": 91769353, "body": "@BigBen is this a conspiracy?? <i>xfiles music plays</i>"}, {"owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537386534, "post_id": 52412768, "comment_id": 91770194, "body": "@BigBen I was actually trying to come up with my own solution to that problem, but I ran into this when I was trying to solve it. I was wondering if there was an explanation as to why I couldn&#39;t do this, but it seems like I just can&#39;t. Thanks for the help everyone, I&#39;ll refer to the other question for an answer."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1537386640, "post_id": 52412768, "comment_id": 91770253, "body": "That explains a lot - I was sure it couldn&#39;t be a coincidence. That said, the answer there is a good approach."}], "owner": {"reputation": 865, "user_id": 10361731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b8873db235bacaa9d53de9c31a0b8cb?s=128&d=identicon&r=PG&f=1", "display_name": "Jchang43", "link": "https://stackoverflow.com/users/10361731/jchang43"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "closed_date": 1537386542, "answer_count": 0, "score": 2, "last_activity_date": 1537384291, "creation_date": 1537384291, "question_id": 52412768, "link": "https://stackoverflow.com/questions/52412768/why-does-storing-the-value-of-a-unionized-range-in-an-array-only-store-the-first", "closed_reason": "Duplicate", "title": "Why does storing the value of a unionized range in an array only store the first range&#39;s value?", "body": "<p>I was attempting to use the union property to join a range of cells and take their values all at once, but after going through the code I noticed that myarray only retains the first ranges values( i.e C2:C12).</p>\n\n<pre><code>Sub macro()\n    Dim myarray() As Variant\n    Dim myrange As Range\n\n    With Worksheets(1)\n        Set myrange = Application.Union(.Range(\"C2:C12\"), .Range(\"G2:G12\"), _\n        .Range(\"J2:J12\"), .Range(\"T2:T12\"))\n    End With\n\n    myarray = myrange.Value\n\nEnd Sub\n</code></pre>\n\n<p>When I set the values to a range in a worksheet it works just fine, which leads me to believe it can access the values as an array. Is there a reason why this isn't working as I intended? Is there a better way to do this sort of operation? </p>\n"}, {"tags": ["html", "excel", "vba", "download"], "comments": [{"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1537385238, "post_id": 52412750, "comment_id": 91769553, "body": "Does using <code>Links.Click</code> bring up a download dialog for each link? I think your best bet is to create a list of all links, then use some other method to download them. It might be difficult depending on how the security/login works on that site though."}, {"owner": {"reputation": 1, "user_id": 10380514, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217625480886528/picture?type=large", "display_name": "Felipe Soares", "link": "https://stackoverflow.com/users/10380514/felipe-soares"}, "reply_to_user": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1537390658, "post_id": 52412750, "comment_id": 91771946, "body": "It&#180;s not feasible because the documents for download are not the same... they are upgraded periocally by the company. So what i need is a routine to go to that page and download every available files."}, {"owner": {"reputation": 1, "user_id": 10380514, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217625480886528/picture?type=large", "display_name": "Felipe Soares", "link": "https://stackoverflow.com/users/10380514/felipe-soares"}, "reply_to_user": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1537391093, "post_id": 52412750, "comment_id": 91772103, "body": "And no, it does not open any dialog. the code just stops there. May it be because there are several links that attends the criteria?"}, {"owner": {"reputation": 3934, "user_id": 212869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/376b87d1def88c60fc6a8712eb585354?s=128&d=identicon&r=PG", "display_name": "NickSlash", "link": "https://stackoverflow.com/users/212869/nickslash"}, "edited": false, "score": 0, "creation_date": 1537437486, "post_id": 52412750, "comment_id": 91787771, "body": "I was suggesting you create a list every time to pass off to something to handle the downloading. <a href=\"https://stackoverflow.com/a/22113944/212869\">stackoverflow.com/a/22113944/212869</a> for example, you would need to figure out how the login is handled to use it though."}], "owner": {"reputation": 1, "user_id": 10380514, "user_type": "registered", "profile_image": "https://graph.facebook.com/10217625480886528/picture?type=large", "display_name": "Felipe Soares", "link": "https://stackoverflow.com/users/10380514/felipe-soares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593679291, "creation_date": 1537384241, "last_edit_date": 1593679291, "question_id": 52412750, "link": "https://stackoverflow.com/questions/52412750/download-every-files-csv-pdf-from-webpage-vba", "title": "download every files (CSV/PDF) from webpage vba", "body": "<p>I need help to get to a web page, download and save all the avaiable files (CSV and PDF). For now I can only make login in the website and click on the right link. Now i need help to download and save the files. </p>\n\n<p>My code for now:</p>\n\n<pre><code>    Sub login()\n\n    Const Url$ = \"https://www.hapvida.com.br/pls/webhap/webNewTrocaArquivo.login\"\n\n    Dim UserName As String, Password As String, LoginData As Worksheet\n    Set LoginData = ThisWorkbook.Worksheets(\"1\")\n\n    UserName = LoginData.Cells(2, \"B\").Value\n    Password = LoginData.Cells(3, \"B\").Value\n\n    Dim ie As InternetExplorer\n\n    Set ie = CreateObject(\"InternetExplorer.Application\")\n\n    With ie\n\n        .Navigate Url\n        ieBusy ie\n        .Visible = True\n\n        Dim oLogin As Object, oPassword As Object, oCodigo As Object\n\n\n        Set oLogin = .Document.getElementsByName(\"pCpf\")(0)\n        Set oPassword = .Document.getElementsByName(\"pSenha\")(0)\n\n        oLogin.Value = UserName\n        oPassword.Value = Password\n        .Document.forms(0).submit\n\n   ieBusy ie\n\n   Set alllinks = ie.Document.getElementsByTagName(\"a\")\n   For Each Link In alllinks\n   If Link.innerText = \"BAIXAR ARQUIVOS - DOWNLOAD\" Then\n   Link.Click\n   Exit For\n   End If\n   Next\n\n    ieBusy ie\n\n\n'Problematic part\n   Set fulllinks = ie.Document.getElementsByTagName(\"a\")\n   For Each Links In fulllinks\n   If Right(Links.innerText, 3) = \"PDF\" Then\n   Links.Click\n   Exit For\n   End If\n   Next\n\n     ieBusy ie\n\n     End With\n\nEnd Sub\n\n\nSub ieBusy(ie As Object)\n    Do While ie.Busy Or ie.ReadyState &lt; 4\n        DoEvents\n    Loop\nEnd Sub\n</code></pre>\n\n<p>The page i need to get the files from:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YN32I.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n"}, {"tags": ["sql", "vba", "group-by", "sum", "decimal"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1537384309, "post_id": 52412395, "comment_id": 91769134, "body": "please include your code and is a pivottable not an option? Is this Excel?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537384957, "post_id": 52412395, "comment_id": 91769418, "body": "Do you need to adjust the number formatting in Excel to display additional decimal digits?"}, {"owner": {"reputation": 21, "user_id": 6545446, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-6KjcSU2Ynxw/AAAAAAAAAAI/AAAAAAAAABc/E-7IY8fxR64/photo.jpg?sz=128", "display_name": "Richard Li", "link": "https://stackoverflow.com/users/6545446/richard-li"}, "edited": false, "score": 0, "creation_date": 1537385229, "post_id": 52412395, "comment_id": 91769548, "body": "My psudo code is shown above. The data file is csv and this new file that I am trying to compile is xlsx, could this be the reason?"}, {"owner": {"reputation": 21, "user_id": 6545446, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-6KjcSU2Ynxw/AAAAAAAAAAI/AAAAAAAAABc/E-7IY8fxR64/photo.jpg?sz=128", "display_name": "Richard Li", "link": "https://stackoverflow.com/users/6545446/richard-li"}, "edited": false, "score": 0, "creation_date": 1537385382, "post_id": 52412395, "comment_id": 91769632, "body": "Could you explain more regarding the number formatting? The data file that contains 3 digits demical is csv and I am trying to create a new xlsx file using SUM - group by statement.  Thank you!"}], "owner": {"reputation": 21, "user_id": 6545446, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-6KjcSU2Ynxw/AAAAAAAAAAI/AAAAAAAAABc/E-7IY8fxR64/photo.jpg?sz=128", "display_name": "Richard Li", "link": "https://stackoverflow.com/users/6545446/richard-li"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537385907, "creation_date": 1537382776, "last_edit_date": 1537385907, "question_id": 52412395, "link": "https://stackoverflow.com/questions/52412395/vba-sql-sum-group-by-statement-only-takes-up-to-two-digit-decimalvalue", "title": "VBA SQL Sum- group by statement only takes up to two digit decimalvalue", "body": "<p>I am having issue with SQL statement within VBA.</p>\n\n<p>I have a dataset that has one column with value up to 3 digit decimal, like this:</p>\n\n<pre><code>Name    Value  \n---------------\nA       0.004  \nB       0.005  \nA       0.123  \nC       0.533\n</code></pre>\n\n<p>I want to write a SQL statement in VBA that sum up <strong>Value</strong> based on <strong>Name</strong></p>\n\n<p>like this:</p>\n\n<pre><code>sql = select name, sum(value) from data.csv group by name\n</code></pre>\n\n<p>Right now my problem is that when I do the sum up, excel only seems to take up to 2 digits <strong>to sum</strong>, meaning A 0.004 would be 0 and A 0.123 would be 0.12. The result is that I have missed some value in the summation process :</p>\n\n<p>My desired result would be  </p>\n\n<pre><code>A  0.127  (0.003 + 0.124)  \nB  0.005  \nC  0.533\n</code></pre>\n\n<p>But instead now I am getting</p>\n\n<pre><code>A  0.12  (0 + 0.12)  \nB  0  \nC  0.53\n</code></pre>\n\n<p>What should I do in this situation to fix the issue?</p>\n\n<p>I have tried sum(cdbl(value)) but it did not work.</p>\n\n<p>Thank you so much!</p>\n\n<p>EDIT: My specific code is as follow:</p>\n\n<pre><code>Sub Createnewfile()\n\nDim cn As ADODB.Connection, rs As ADODB.Recordset\nSet cn = New ADODB.Connection\nSet rs = New ADODB.Recordset\nDim sql As String\n\nFName = \"\\new file.xlsx\"\nFPath = ThisWorkbook.Path &amp; FName\n\nIf Not Dir(FPath, vbDirectory) = vbNullString Then Kill FPath\n\nWorkbooks.Add\nActiveWorkbook.SaveAs Filename:=FPath\nSet wsData = ActiveWorkbook.Sheets(\"Sheet1\")\n\ncn.Provider = \"Microsoft.ACE.OLEDB.12.0\"\ncn.ConnectionString = \"Data Source=\" &amp; ThisWorkbook.Path &amp; \";\" &amp; \"Extended Properties=\"\"text;HDR=Yes;FMT=Delimited;\"\"\"\ncn.Open\n\nsql = \"SELECT Name, sum(cbdl(value)) as value \" &amp; _\n      \"FROM data.csv \" &amp; _\n      \"GROUP BY Name \"\n\nrs.Open sql, cn\nFor c = 0 To rs.Fields.count - 1\n    wsData.Cells(1, c + 1).Value = rs.Fields(c).Name\nNext\n\nrs.MoveFirst\nr = wsData.UsedRange.Rows.count + 1\nwsData.Cells(r, 1).CopyFromRecordset rs\nrs.Close\ncn.Close\n\nApplication.DisplayAlerts = False\nWith Workbooks(\"new file.xlsx\")\n    .Save\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["mysql", "sql", "regex", "excel", "vba"], "comments": [{"owner": {"reputation": 2334, "user_id": 7948962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b64557f8a617effccaf4426f16e9035?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob H", "link": "https://stackoverflow.com/users/7948962/jacob-h"}, "edited": false, "score": 2, "creation_date": 1537383253, "post_id": 52412195, "comment_id": 91768652, "body": "There&#39;s no way for a computer to tell that <code>Clash</code> is equal to <code>Clash of Clans</code> without a human developing the logic. Even then, how does the computer know that <code>Clash</code> isn&#39;t <code>Clash Royale</code> instead of <code>Clash of Clans</code>? Unfortunately, you aren&#39;t going to be able to automate this without error. If this is a one-off task, I would recommend just dumping to Excel and fix by hand. Writing an algorithm to fix this data is frankly, impossible. It would be difficult enough to find a way to split up your names by game successfully... you have no common delimiter so any <code>and</code> could be data... or not."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1537383292, "post_id": 52412195, "comment_id": 91768672, "body": "If you have columns indicating the question being asked, then you can start creating sheets or columns with responses per question.  In doing so, you would then try and use INSTR() or other functions to find similar/related responses per sheet/columns.  This will be a mostly manual process to find your heavy hitters, though can help collect the data after the fact with the functions."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537384331, "post_id": 52412195, "comment_id": 91769138, "body": "You might be able to use <code>&quot;Fuzzy Lookup&quot;</code> to match up similar entries but it&#39;d still take a lot of work <a href=\"https://www.microsoft.com/en-us/download/details.aspx?id=15011\" rel=\"nofollow noreferrer\">microsoft.com/en-us/download/details.aspx?id=15011</a>"}], "owner": {"reputation": 37, "user_id": 6159232, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3391d43277ebfa5e913bef23e9546efb?s=128&d=identicon&r=PG&f=1", "display_name": "d.tang", "link": "https://stackoverflow.com/users/6159232/d-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594055125, "creation_date": 1537381971, "last_edit_date": 1594055125, "question_id": 52412195, "link": "https://stackoverflow.com/questions/52412195/how-to-clean-survey-data-with-sql-or-excel", "title": "How to clean survey data with SQL or Excel", "body": "<p>I'm currently trying to help our market research team prepare/clean some very messy survey data. I was given a  CSV file (plan to import into db table) with around 2000 people's responses to 30 questions. </p>\n\n<p>The survey asked questions like \"what is your favorite tv show?\" or \"what 3 mobile games do you play regularly?\". Respondents were able to answer the questions however they wanted, so as you can imagine, the data is extremely messy. </p>\n\n<p>So in the case of the mobile games question, responses often varied like this:</p>\n\n<pre><code>1. Candy Crush and Clash of Clans\n2. Candy Crush Saga, Clash, Bejeweled Blitz\n3. BEJEWELED\n4. Pac-man\n5. PACMAN\netc etc \n</code></pre>\n\n<p>What approach should i take  cleaning and unifying this data via SQL and or Excel? Obviously not trying to get everything, but as much as possible. </p>\n"}, {"tags": ["excel", "vba", "api", "catia"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1537381419, "post_id": 52411890, "comment_id": 91767821, "body": "a) Are you in an <a href=\"https://i.stack.imgur.com/xyVrl.gif\" rel=\"nofollow noreferrer\">Option Explicit</a> environment? b) Do you have the VBE&#39;s Tools, References, Smarteam libraries all set?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1537381524, "post_id": 52411890, "comment_id": 91767870, "body": "What&#39;s <code>CATIA</code> exactly? If it&#39;s <code>Nothing</code>, that&#39;s why it&#39;s blowing up."}, {"owner": {"reputation": 1, "user_id": 10387302, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K4NJwXNaMa8/AAAAAAAAAAI/AAAAAAAAACg/_1vDf96EIDA/photo.jpg?sz=128", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/10387302/nicolas"}, "edited": false, "score": 0, "creation_date": 1537381880, "post_id": 52411890, "comment_id": 91768033, "body": "I looked up Option Explicit, and I believe this is not the environment. There are other working modules that had this work:      Dim FoundObj As ISmObject     Set SmEngine = CreateObject(&quot;SmApplic.SmFreeThreadedEngine&quot;)     SmEngine.Init &quot;SmTeam32&quot;     Set SmSession = CreateObject(&quot;SmApplic.SmSession&quot;)     SmSession.Init SmEngine, &quot;MySession&quot;, &quot;SmTeam32&quot; ... ...     CatiaConnect                                &#39;launch Catia V5     CatIntgConnect                              &#39;connect to ST using ST CATIA integration  CatIntgConnect starts with line CATEngine = GetItem(&quot;CAIEngine&quot;)"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537382032, "post_id": 52411890, "comment_id": 91768094, "body": "If <code>Option Explicit</code> isn&#39;t at the top of the module, then VBA will happily compile pretty much anything you throw at it. Always use Option Explicit. Debug &gt; Compile VBAProject. Does it compile? Is <code>CATIA</code> defined or the VBE is saying it&#39;s an undeclared variable? Help us out here..."}, {"owner": {"reputation": 1, "user_id": 10387302, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K4NJwXNaMa8/AAAAAAAAAAI/AAAAAAAAACg/_1vDf96EIDA/photo.jpg?sz=128", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/10387302/nicolas"}, "edited": false, "score": 0, "creation_date": 1537382410, "post_id": 52411890, "comment_id": 91768277, "body": "Sorry the comments were sent before finishing and it took me a while to edit the full content... new user blurrgh.  it does compile, with the CATIA application and Smarteam application opened, running this CATIA.GetItem appeared to have no problem for other modules, and is what the previous maintainer of this script said as the necessary set up."}, {"owner": {"reputation": 1, "user_id": 10387302, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K4NJwXNaMa8/AAAAAAAAAAI/AAAAAAAAACg/_1vDf96EIDA/photo.jpg?sz=128", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/10387302/nicolas"}, "edited": false, "score": 0, "creation_date": 1537382834, "post_id": 52411890, "comment_id": 91768468, "body": "ok the edit on first comment still looked horrible...  A lot of the SmEngine and SmSession are dealing with Smarteam (CATIA bonded database), with CATIA open, it is connected to Smarteam, and therefore able to update life cycle through CATIA, it is viable in manual operations in CATIA. So trying to automate these tasks in CATIA through VBA script using CATIA API, I was told the environment would just require CATIA application to be opened while running script, in regular module mode, and correct CATIA API syntax."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537383269, "post_id": 52411890, "comment_id": 91768663, "body": "Dont edit your comments, <a href=\"https://stackoverflow.com/posts/52411890/edit\">edit</a> your post!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537383481, "post_id": 52411890, "comment_id": 91768752, "body": "<code>CATEngine = GetItem(&quot;CAIEngine&quot;)</code> isn&#39;t the same as <code>Set CATEngine = CATIA.GetItem(&quot;CAIEngine&quot;)</code>. Put a breakpoint on that line of code (F9), then run it. When the breakpoint is hit, press Ctrl+G then type <code>?CATIA Is Nothing</code> if the word <code>True</code> gets printed out, you need to <code>Set CATIA</code>  to a valid object reference."}, {"owner": {"reputation": 1, "user_id": 10387302, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K4NJwXNaMa8/AAAAAAAAAAI/AAAAAAAAACg/_1vDf96EIDA/photo.jpg?sz=128", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/10387302/nicolas"}, "edited": false, "score": 0, "creation_date": 1537384290, "post_id": 52411890, "comment_id": 91769127, "body": "Yes it did return true! and what is an example of valid object reference? sorry I just have not seen Set CATIA in any other sections of the code"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537384500, "post_id": 52411890, "comment_id": 91769211, "body": "I can&#39;t know that, but this looks like a job for <a href=\"http://rubberduckvba.com\" rel=\"nofollow noreferrer\">Rubberduck</a>. Parse the project (click the &quot;Pending&quot; button in the Rubberduck command bar), right-click <code>CATIA</code> from the <code>checkUUID</code> procedure, on the line that says <code>CATIA.DisplayFileAlerts = False</code>, select &quot;find all references&quot; from the Rubberduck context menu; a toolwindow will pop up showing all the places this <code>CATIA</code> is used - if the &quot;working code&quot; indeed works, then one of the references will be a <code>Set</code> statement. See what it does, replicate accordingly."}, {"owner": {"reputation": 1, "user_id": 10387302, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K4NJwXNaMa8/AAAAAAAAAAI/AAAAAAAAACg/_1vDf96EIDA/photo.jpg?sz=128", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/10387302/nicolas"}, "edited": false, "score": 0, "creation_date": 1537386852, "post_id": 52411890, "comment_id": 91770355, "body": "i&#39;ve prompt using it to the IT guys, it will probably take a while for them to get back to me"}, {"owner": {"reputation": 1, "user_id": 10387302, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K4NJwXNaMa8/AAAAAAAAAAI/AAAAAAAAACg/_1vDf96EIDA/photo.jpg?sz=128", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/10387302/nicolas"}, "edited": false, "score": 0, "creation_date": 1537395541, "post_id": 52411890, "comment_id": 91773568, "body": "ok i finally got rubberduck, and yes somewhere in a script there is a line: Set CATIA = GetObject(, &quot;CATIA.Application&quot;),  after adding this definition the line works! Great helps, and great plugin!"}], "owner": {"reputation": 1, "user_id": 10387302, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-K4NJwXNaMa8/AAAAAAAAAAI/AAAAAAAAACg/_1vDf96EIDA/photo.jpg?sz=128", "display_name": "Nicolas", "link": "https://stackoverflow.com/users/10387302/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 273, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537384077, "creation_date": 1537380660, "last_edit_date": 1537384077, "question_id": 52411890, "link": "https://stackoverflow.com/questions/52411890/error-91-vba-excel-catia-api-variable-not-set", "title": "Error 91, VBA Excel, CATIA API: variable not set", "body": "<p>I'm trying to access CATIA functions in updating document life cycle in Smarteam in excel macro, the following lines</p>\n\n<pre><code>Dim CATEngine As StiEngine\n\nSet CATEngine = CATIA.GetItem(\"CAIEngine\")\n</code></pre>\n\n<p>keeps returning <code>error 91: variable not set</code> issue.</p>\n\n<p>From this link I'm not why a simple command like this is returning this error\n<a href=\"http://catiadoc.free.fr/online/interfaces/interface_StiEngine.htm\" rel=\"nofollow noreferrer\">http://catiadoc.free.fr/online/interfaces/interface_StiEngine.htm</a></p>\n\n<p>perhaps I'm not loading certain libraries/ integrations properly? all insights welcome</p>\n\n<p>This is the code from other module that worked, non option explicit and non global definitions (i've tried global define CATIAEngine, but it returns ambiguity error):</p>\n\n<pre><code>Sub checkUUID()\n\n    Dim FoundObj As ISmObject\n    Dim wbNew As Workbook, wsNew As Worksheet\n    Dim checkDOCUUID As Document\n    Dim Products As Products\n    Set wbNew = ActiveWorkbook\n    Set wsNew = wbNew.Sheets(1)\n    Set SmEngine = CreateObject(\"SmApplic.SmFreeThreadedEngine\")\n    SmEngine.Init \"SmTeam32\"\n    Set SmSession = CreateObject(\"SmApplic.SmSession\")\n    SmSession.Init SmEngine, \"MySession\", \"SmTeam32\"\n    wsNew.Activate\n    Dim childList() As String\n\n    Set SmDatabase = SmEngine.Databases(0)\n    ID = SmDatabase.Alias           'Provider=SQLOLEDB.1;Persis Security Info=False;User ID=SMARTUSER;Initial Catalog=Smarteam;Data Source=ST2008SQL\\SQLSMARTEAM\n    Pass = SmDatabase.Password      'ProvidSMARTEAM_7kikX/GtJNG6d7BcYeTi8cf4IuVCgWjDrvo/Oo4xdZgHjg+fDpzdEEll7tcGT96tcB7pP8krz1hw6pDgzXchTrwfm1t0FKGsDK6C7EvQW7+grVLwZamcVpnmz6ibMWAogHWcLM+H6ID87NIXwBLXNaJxm3tKg6eZ84nzNSkCGFc=\n    Call SmSession.OpenDatabaseConnection(ID, Pass, True)\n\n    If SmSession.IsServiceEnabled(\"SmGUISrv.SmCommonGUI\", Reason) Then\n        Set GUIServices = SmSession.GetService(\"SmGUISrv.SmCommonGUI\")\n    End If\n\n    GUIServices.Dialogs.ExecuteLogin\n\n    Set FSO = CreateObject(\"Scripting.filesystemobject\")\n\n\n    tempFolderName = \"C:\\ST Temp\\UUID\\\"\n    If Len(Dir(\"C:\\ST Temp\\\", vbDirectory)) = 0 Then\n        MkDir \"C:\\ST Temp\\\"\n    End If\n\n    If Len(Dir(\"C:\\ST Temp\\UUID\\\", vbDirectory)) = 0 Then\n        MkDir tempFolderName\n    End If\n\n    CatiaConnect                                'launch Catia V5\n    CatIntgConnect                              'connect to ST using ST CATIA integration\n    CATIA.DisplayFileAlerts = False             'disable all the warning's and disables all the user interaction\n\n\n\n\n\nCatIntgConnect\n\nSub CatIntgConnect()\n\n    Set CATEngine = CATIA.GetItem(\"CAIEngine\")\n\n    ' -----------------------------------------------------------\n    ' CATIA V5 Operations are performed in the background\n    ' -----------------------------------------------------------\n    Dim BooleanUI As Boolean\n    If (CATEngine.UseGraphicalUI) = True Then\n            CATEngine.UseGraphicalUI = True\n            BooleanUI = True\n    End If\n    ' -----------------------------------------------------------\n    ' Connect to the SmarTeam database (if not already connected)\n    ' -----------------------------------------------------------\n    Dim BoolConnect As Boolean\n    BoolConnect = False\n    If Not CATEngine.IsConnected() = True Then\n             CATEngine.Connect \"\", \"\"             'to perform automation via CATIA SMARTEAM integration, must type in the userid and password\n             BoolConnect = True\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "immediate-window"], "answers": [{"tags": [], "owner": {"reputation": 848, "user_id": 1483546, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/bc95ebb691893198b40182569ba1afd1?s=128&d=identicon&r=PG", "display_name": "satoukum", "link": "https://stackoverflow.com/users/1483546/satoukum"}, "is_accepted": true, "score": 3, "last_activity_date": 1537377444, "creation_date": 1537377444, "answer_id": 52411144, "question_id": 52411143, "link": "https://stackoverflow.com/questions/52411143/execute-multiple-lines-in-the-immediate-window-of-an-excel-vba-workbook/52411144#52411144", "title": "Execute Multiple Lines in the Immediate Window of an Excel VBA workbook", "body": "<p>Use the colon <code>:</code> key to concatenate multiple statements together. (ex: <code>MsgBox \"msgBox1\" : MsgBox \"msgBox2\"</code> will display two alert message boxes. </p>\n"}], "owner": {"reputation": 848, "user_id": 1483546, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/bc95ebb691893198b40182569ba1afd1?s=128&d=identicon&r=PG", "display_name": "satoukum", "link": "https://stackoverflow.com/users/1483546/satoukum"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1174, "favorite_count": 0, "accepted_answer_id": 52411144, "answer_count": 1, "score": 2, "last_activity_date": 1537377444, "creation_date": 1537377444, "question_id": 52411143, "link": "https://stackoverflow.com/questions/52411143/execute-multiple-lines-in-the-immediate-window-of-an-excel-vba-workbook", "title": "Execute Multiple Lines in the Immediate Window of an Excel VBA workbook", "body": "<p>Am I limited to execute only 1 command in the Excel VBA Immediate Window. Is there a way to execute multiple statements?</p>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 2, "creation_date": 1537379422, "post_id": 52411103, "comment_id": 91766812, "body": "If you&#39;re using <code>PrintArea</code>, then each comma you use to separate ranges will put those ranges onto a separate page. You can either hide the ranges you don&#39;t want while you print or copy the ranges to a temporary sheet, print, and delete the sheet like so <a href=\"https://www.rondebruin.nl/win/s9/win008.htm\" rel=\"nofollow noreferrer\">rondebruin.nl/win/s9/win008.htm</a>"}, {"owner": {"reputation": 45, "user_id": 8676006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1418109648308368/picture?type=large", "display_name": "Luis Eduardo", "link": "https://stackoverflow.com/users/8676006/luis-eduardo"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537379626, "post_id": 52411103, "comment_id": 91766902, "body": "Hadn&#39;t thought of those alternatives, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537379552, "post_id": 52411508, "comment_id": 91766869, "body": "Your answer could use more... answer. Maybe give a small example of vba that will hide the ranges that OP mentioned in their initial post"}, {"owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537380017, "post_id": 52411508, "comment_id": 91767107, "body": "I cannot give example because in this method you must hide rows in printing macro, not in this one posted above. I am pretty sure that the author know how to hide rows &quot;Sheet7.Rows(&quot;33:55&quot;).EntireRow.Hidden = True&quot;"}], "tags": [], "owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1537379877, "last_edit_date": 1537379877, "creation_date": 1537379060, "answer_id": 52411508, "question_id": 52411103, "link": "https://stackoverflow.com/questions/52411103/pagesetup-printarea-for-multiple-ranges-that-are-separated/52411508#52411508", "title": "PageSetup.PrintArea for multiple ranges that are separated", "body": "<p>The simplest way is to hide unnecesarry rows if it's possible for a moment before print to PDF. In this way you should make sure after macro all rows are visible (additional you can use On Error GoTo and unhide just in case) </p>\n"}], "owner": {"reputation": 45, "user_id": 8676006, "user_type": "registered", "profile_image": "https://graph.facebook.com/1418109648308368/picture?type=large", "display_name": "Luis Eduardo", "link": "https://stackoverflow.com/users/8676006/luis-eduardo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "accepted_answer_id": 52411508, "answer_count": 1, "score": 0, "last_activity_date": 1537379877, "creation_date": 1537377290, "question_id": 52411103, "link": "https://stackoverflow.com/questions/52411103/pagesetup-printarea-for-multiple-ranges-that-are-separated", "title": "PageSetup.PrintArea for multiple ranges that are separated", "body": "<p>I have the following code that exports the selected range in the worksheet as .pdf file:</p>\n\n<pre><code>    'More coding above\n    With Sheet7\n        If (CheckBox1.Value = True And CheckBox2.Value = True) Then\n            .PageSetup.PrintArea = \"A8:M80\"\n        ElseIf (CheckBox1.Value = True And CheckBox2.Value = False) Then\n            .PageSetup.PrintArea = \"A8:M55\"\n        ElseIf (CheckBox1.Value = False And CheckBox2.Value = True) Then\n            .PageSetup.PrintArea = \"A8:M32, A56:M80\"\n        Else\n            MsgBox 'At least one option must be selected!'\n            Exit Sub\n        End If\n     End With\n     'More coding below\n</code></pre>\n\n<p>However, when only <code>CheckBox2</code> is checked, the file is generated selecting only the areas as set by <code>If/Else</code>, but still showing the <code>A33:M55</code> gap between ranges.</p>\n\n<p>Is there anyway I could suppress this gap? I want the code to print both ranges as if they were one.</p>\n\n<p>I tried the <code>Union</code> method, but it gives me the same result. </p>\n\n<p>Any help will be greatly appreciated!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537377370, "post_id": 52411074, "comment_id": 91765832, "body": "Do you want to append the data or overwrite the existing table?"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537379618, "post_id": 52411074, "comment_id": 91766899, "body": "You&#39;re missing an endquote for the line you set <code>sFound</code> in"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537379767, "post_id": 52411074, "comment_id": 91766977, "body": "<a href=\"https://stackoverflow.com/questions/20437455/excel-vba-copy-range-into-table\" title=\"excel vba copy range into table\">stackoverflow.com/questions/20437455/&hellip;</a>"}, {"owner": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "edited": false, "score": 0, "creation_date": 1537384165, "post_id": 52411074, "comment_id": 91769067, "body": "In the beginning of the code I clear all the data from the table except the header and 1 row exists after the header with no data. So my goal is just to get it to paste into the fresh table which always Starts at A2, but I was hoping to use the Table object.                                                        Sorry I am typing on mobile. The code seems to run now, but it takes a long time. Still pasting into a non table is faster for some reason. I can provide more code if needed. Thanks for the link Marucciboy2. I will try to utilize that."}, {"owner": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "edited": false, "score": 0, "creation_date": 1537384941, "post_id": 52411074, "comment_id": 91769408, "body": "All the tables and pivots are generated from the imported data and the reference tables existing within the Workbook. I will post shortly. But it really takes a while and it seems to hang for a while. One thing I was missing was initializing the lrow variable. Thank you for the replied so far and further help would be greatly appreciated."}], "owner": {"reputation": 106, "user_id": 9475909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a1803e2fc029dd7d276794975ce8be6?s=128&d=identicon&r=PG&f=1", "display_name": "MonkeyMonkey", "link": "https://stackoverflow.com/users/9475909/monkeymonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 454, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593676395, "creation_date": 1537377168, "last_edit_date": 1593676395, "question_id": 52411074, "link": "https://stackoverflow.com/questions/52411074/copy-data-from-one-workbook-into-existing-table-in-another-workbook", "title": "Copy Data From One Workbook Into Existing Table in Another Workbook", "body": "<p>I am able to read another workbook and copy the contents, but when I try to paste into the existing Table - Excel hangs and freezes. If I copy the data into another sheet with no existing Table, then it works fine.</p>\n\n<p>I am using this:</p>\n\n<pre><code>Dim sFound as String\nDim lRow as Long\nDim data_sheet As Worksheet\nDim wb as Workbook\nDim wb_data as Workbook\n\nSet wb = ThisWorkbook\n\nsFound =  Dir(ActiveWorkbook.Path &amp; \"\\data*.csv)\nIf sFound &lt;&gt; \"\" Then\nWorkbooks.Open Filename:=ActiveWorkbook.Path &amp; \"\\\" &amp; sFound\n\nEnd If\nSet wb_data = ActiveWorkbook\nSet data_sheet = Sheets(\"raw data\")\n\nlRow=data_sheet.Cells(data_sheet.Rows.Count,2).End(xlUp).Row\ndata_sheet.Range(\"A10:V\" &amp; lRow).Copy\n\nwb.Sheets(\"Data\").Range(\"Data[Code]\").PasteSpecial\nApplication.CutCopyMode = False\nwb_data.Close\n</code></pre>\n\n<p>Any assistance in why the paste is causing the hang up in the table would be greatly appreciated.</p>\n\n<p>2018-09-21 Update\nI managed to fix the freezing and hanging through a combination of Marucciboy2's post and my own research. I stored the entire raw data set I was copying into a variant variable. Then, I resized the new table I was copying to to be the same length as the raw data. Then I just set that entire data range value the same as the variant variable. I will update this with the code. </p>\n\n<p>I am still having one issue with is figuring out how to copy one particular column or certain range of columns of one table into another table. I can resize the new table just fine. I just don't know how to set one column into a variant variable or if I need to do something else. Then, I don't know how to set the new table column to that variant variable. Again, will have to post code tomorrow.</p>\n"}, {"tags": ["vba", "ms-access", "outlook"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1537377089, "post_id": 52411022, "comment_id": 91765713, "body": "Sounds like you need <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.htmlbody\" rel=\"nofollow noreferrer\"><code>MailItem.HTMLBody</code></a>"}, {"owner": {"reputation": 658, "user_id": 2395238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/298d6e416185634312b9a2524d2066a6?s=128&d=identicon&r=PG", "display_name": "user2395238", "link": "https://stackoverflow.com/users/2395238/user2395238"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537379236, "post_id": 52411022, "comment_id": 91766724, "body": "Yes, thanks. It&#39;s almost the right solution. I edited the question."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1537379389, "post_id": 52411022, "comment_id": 91766796, "body": "Why do you have <code>oMail.Body</code> in the second <code>Sub</code>?"}, {"owner": {"reputation": 658, "user_id": 2395238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/298d6e416185634312b9a2524d2066a6?s=128&d=identicon&r=PG", "display_name": "user2395238", "link": "https://stackoverflow.com/users/2395238/user2395238"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1537379510, "post_id": 52411022, "comment_id": 91766844, "body": "Lol, you&#39;re right. it should be <code>oMail.HTMLBody</code> works perfect now. thanks."}, {"owner": {"reputation": 658, "user_id": 2395238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/298d6e416185634312b9a2524d2066a6?s=128&d=identicon&r=PG", "display_name": "user2395238", "link": "https://stackoverflow.com/users/2395238/user2395238"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537379541, "post_id": 52411022, "comment_id": 91766865, "body": "post the answer i&#39;ll give you correct answer"}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1537379913, "creation_date": 1537379913, "answer_id": 52411692, "question_id": 52411022, "link": "https://stackoverflow.com/questions/52411022/how-to-save-formatted-ms-outlook-email-body-with-html-elements-into-ms-access-ta/52411692#52411692", "title": "How to save formatted MS Outlook email body with HTML elements into MS Access table?", "body": "<p>Use the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.htmlbody\" rel=\"nofollow noreferrer\"><code>MailItem.HTMLBody</code> property</a>, as opposed to the <a href=\"https://docs.microsoft.com/en-us/office/vba/api/outlook.mailitem.body\" rel=\"nofollow noreferrer\"><code>MailItem.Body</code> property</a>.</p>\n\n<blockquote>\n  <p>[The <code>HTMLBody</code> property] returns or sets a String representing the HTML body of the specified item. [It is both] read/write.</p>\n</blockquote>\n"}], "owner": {"reputation": 658, "user_id": 2395238, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/298d6e416185634312b9a2524d2066a6?s=128&d=identicon&r=PG", "display_name": "user2395238", "link": "https://stackoverflow.com/users/2395238/user2395238"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 52411692, "answer_count": 1, "score": 0, "last_activity_date": 1537379913, "creation_date": 1537376954, "last_edit_date": 1537379183, "question_id": 52411022, "link": "https://stackoverflow.com/questions/52411022/how-to-save-formatted-ms-outlook-email-body-with-html-elements-into-ms-access-ta", "title": "How to save formatted MS Outlook email body with HTML elements into MS Access table?", "body": "<p>I tried this simple code:    </p>\n\n<pre><code>Sub sendOutlookEmail()\nDim oApp As Outlook.Application\nDim oMail As MailItem\nSet oApp = CreateObject(\"Outlook.application\")\n\nSet oMail = oApp.ActiveExplorer.Selection.Item(1)\n\nDim HTMLBody As String\nHTMLBody = oMail.HTMLBody\n\nHTMLBody = Replace(HTMLBody, Chr(34), Chr(34) &amp; Chr(34), 1)\n\nDim sql As String\nsql = \"UPDATE email_body set email_body = \" &amp; Chr(34) &amp; HTMLBody &amp; Chr(34)\n\nDebug.Print sql\nCurrentDb.Execute sql\n\nSet oMail = Nothing\nSet oApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>This simple code saves the body of the email to my MS Access table with all HTML elements. Later on, I want to run this code:</p>\n\n<pre><code>Sub sendOutlookEmail()\nDim oApp As Outlook.Application\nDim oMail As MailItem\nSet oApp = CreateObject(\"Outlook.application\")\n\nSet oMail = oApp.CreateItem(olMailItem)\n\nDim sql As String\nsql = \"Select email_body from email_body\"\n\nDim rs As DAO.Recordset\nSet rs = CurrentDb.OpenRecordset(sql)\n\noMail.Body = rs(\"email_body\")\noMail.Subject = \"email sent from ms access using vba 2\"\noMail.To = \"receiver@somthing.com\"\n\noMail.Display\n\nSet oMail = Nothing\nSet oApp = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>That code should take whatever was stored in my MS Access table and create a new email. What it does though, it copies the literal HTML code into the body of the email which is obviously not what I want. Is there a way to get it displayed the proper way?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1537376475, "creation_date": 1537376475, "answer_id": 52410893, "question_id": 52410797, "link": "https://stackoverflow.com/questions/52410797/how-to-display-text-on-textbox-depending-on-the-combobox-selection/52410893#52410893", "title": "How to Display Text on Textbox depending on the Combobox Selection", "body": "<p>One way is to use VLOOKUP on the combobox value and put this code in the combo box change event so that it runs whenever it is changed. Or you could assign it to a button.</p>\n\n<p>Amend control names as necessary.</p>\n\n<pre><code>Private Sub ComboBox1_Change()\n    Me.TextBox1.Value = Application.VLookup(Me.ComboBox1.Value, Worksheets(\"Sheet1\").Range(\"A1\").CurrentRegion, 2, 0)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10387002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f0570c7bfb129885d8a1cfe0bc5dfe5?s=128&d=identicon&r=PG&f=1", "display_name": "Eddy M.", "link": "https://stackoverflow.com/users/10387002/eddy-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593679325, "creation_date": 1537376046, "last_edit_date": 1593679325, "question_id": 52410797, "link": "https://stackoverflow.com/questions/52410797/how-to-display-text-on-textbox-depending-on-the-combobox-selection", "title": "How to Display Text on Textbox depending on the Combobox Selection", "body": "<p>I am very new to VBA. I have two columns:</p>\n\n<p>Column 1\na\nb\nc</p>\n\n<p>Column 2\n1\n2\n3</p>\n\n<p>So in if I select a from the combo box - I wanted to text box to show 1.</p>\n\n<p>I have been trying to figure it out through the other posts here but could not get it to work.</p>\n\n<p>If you could explain it to me that would be great!</p>\n\n<pre><code>  Private Sub UserForm_Initialize()\n With Worksheets(\"Sheet1\")\n        ComboBox1.List = .Range(\"A2:A\" &amp; .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row).Value\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1537374607, "post_id": 52410421, "comment_id": 91764559, "body": "Please <a href=\"https://stackoverflow.com/posts/52410421/edit\">edit</a> your question with the looping portion, and it&#39;ll probably be clearer what else you&#39;re missing."}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1537426630, "post_id": 52410421, "comment_id": 91781729, "body": "If you post the code you already have, it will be easier for us to help you."}], "answers": [{"comments": [{"owner": {"reputation": 36, "user_id": 6738971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24431bba62f3e61d4cc2b4c966cd59f8?s=128&d=identicon&r=PG&f=1", "display_name": "KMAX", "link": "https://stackoverflow.com/users/6738971/kmax"}, "reply_to_user": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1537385540, "post_id": 52410754, "comment_id": 91769713, "body": "I have made the change. You can change the &#39;i&#39; and &#39;1&#39; to the desired destinations."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1537386370, "post_id": 52410754, "comment_id": 91770113, "body": "Are you able to not use all the  select &#39;s in your code?"}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1537445509, "post_id": 52410754, "comment_id": 91792480, "body": "For example, this one line would take care of 7 lines of your code.  <code>Sheets(Sheet_List_String).Range(&quot;B3:C3&quot;).Copy Sheets(&quot;Master&quot;).Cells(i, 1)</code>"}], "tags": [], "owner": {"reputation": 36, "user_id": 6738971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24431bba62f3e61d4cc2b4c966cd59f8?s=128&d=identicon&r=PG&f=1", "display_name": "KMAX", "link": "https://stackoverflow.com/users/6738971/kmax"}, "is_accepted": false, "score": 0, "last_activity_date": 1537466532, "last_edit_date": 1537466532, "creation_date": 1537375880, "answer_id": 52410754, "question_id": 52410421, "link": "https://stackoverflow.com/questions/52410421/excel-vba-looping-worksheets/52410754#52410754", "title": "Excel VBA Looping Worksheets", "body": "<p>Here is how I would do it.</p>\n\n<ol>\n<li>Create a new sheet (lets call it Back_End). </li>\n<li>In this sheet, create a named range (ctrl-F3) of all the sheet names whose data you want to paste. Lets call it \"Sheets_List\"</li>\n<li>Copy paste the data using the code (seen below)</li>\n</ol>\n\n<p>VBA Code:</p>\n\n<pre><code>Option Explicit\n\nSub Copy_Paste_Sheets()\n\nDim i\nDim Sheet_List As Range\nDim Sheet_List_String As String\n\nFor i = 1 To 250 'number of sheets\n\nSet Sheet_List = Range(\"Sheets_List\")\nSheet_List_String = Sheet_List.Cells(i, 1)\n\n'Range 1\nSheets(Sheet_List_String).Range(\"B3:C3\").Copy Sheets(\"Master\").Cells(i,1) 'Destination 1 (i=row, 1=column)\nApplication.CutCopyMode = False\n\n'Range 2\nSheets(Sheet_List_String).Range(\"E4\").Copy Sheets(\"Master\").Cells(i,1) 'Destination 2 (i=row, 1=column)\nApplication.CutCopyMode = False\n\n'Range 3\nSheets(Sheet_List_String).Range(\"B15:C20\").Copy Sheets(\"Master\").Cells(i,1) 'Destination 3 (i=row, 1=column)\nApplication.CutCopyMode = False\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10386785, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c6765c3013b702bf129c0fd7d1013ea?s=128&d=identicon&r=PG&f=1", "display_name": "J Ren", "link": "https://stackoverflow.com/users/10386785/j-ren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1593676490, "creation_date": 1537374526, "last_edit_date": 1593676490, "question_id": 52410421, "link": "https://stackoverflow.com/questions/52410421/excel-vba-looping-worksheets", "title": "Excel VBA Looping Worksheets", "body": "<p>VBA newbie here. I am struggling with writing a script to pull data from specific cells in multiple (~250) worksheets into a master worksheet. Example:\nI want the script to pull data from cells B3:C3, E4, B15:C20 in the worksheet titled Cand 4, Cand 5, Cand 6, etc.</p>\n\n<p>I think I've got the looping portion working correctly, but am missing something else. Help!\nAnyone have a guess at what the script would look like? Thanks!</p>\n"}, {"tags": ["vba", "excel", "loops"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 2, "creation_date": 1537374201, "post_id": 52410236, "comment_id": 91764297, "body": "First code line inside the loop should be <code>ws.Activate</code> or <code>ws.Select</code> not <code>ws.Cells.Activate</code>. fwiw, neither actually looks necessary if you change <code>ActiveSheet.FilterMode</code> and <code>ActiveSheet.ShowAllData</code> to <code>ws.FilterMode</code> and <code>ws.ShowAllData</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1537375030, "post_id": 52410236, "comment_id": 91764774, "body": "What about ListObject tables? They could be filtered."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10386803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94059c9b59f2b58e393e4d0775031dbc?s=128&d=identicon&r=PG", "display_name": "Myth03", "link": "https://stackoverflow.com/users/10386803/myth03"}, "edited": false, "score": 0, "creation_date": 1537380232, "post_id": 52410460, "comment_id": 91767222, "body": "Worked like a charm! Thank you -- it&#39;s much more streamlined now too!"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1537387461, "post_id": 52410460, "comment_id": 91770630, "body": "The code works - but how does it solve the OP question? This is a &quot;code only&quot; answer."}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": false, "score": 2, "last_activity_date": 1537374652, "creation_date": 1537374652, "answer_id": 52410460, "question_id": 52410236, "link": "https://stackoverflow.com/questions/52410236/excel-for-each-ws-not-going-to-next-ws/52410460#52410460", "title": "Excel For Each ws not going to next ws", "body": "<p>Try the following:</p>\n\n<pre><code>Sub Macro1\n    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets\n        ws.Cells.EntireColumn.Hidden = False\n        ws.Cells.EntireRow.Hidden = False\n        If ws.FilterMode Then ws.ShowAllData\n        ws.UsedRange.Value = ws.UsedRange.Value\n    Next ws\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10386803, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94059c9b59f2b58e393e4d0775031dbc?s=128&d=identicon&r=PG", "display_name": "Myth03", "link": "https://stackoverflow.com/users/10386803/myth03"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537374652, "creation_date": 1537373792, "last_edit_date": 1537374103, "question_id": 52410236, "link": "https://stackoverflow.com/questions/52410236/excel-for-each-ws-not-going-to-next-ws", "title": "Excel For Each ws not going to next ws", "body": "<p>Background -- I am working with a workbook with a whole bunch of sheets and a lot of data that is compromised of formulas. I am wanting to accomplish a few steps with this code:</p>\n\n<ul>\n<li>Unhide all hidden rows/columns</li>\n<li>Paste all data with ONLY values/formatting.</li>\n</ul>\n\n<p>I am able to successfully complete these tasks on ONE worksheet, but it will not continue on -- it tries to continue repeating the same action on the same worksheet over and over.</p>\n\n<pre><code>Sub Macro1\n    Dim ws As Worksheet\n\n    For Each ws In ActiveWorkbook.Worksheets\n        'Have also tried \"For Each ws In ThisWorkbook.Worksheets at other users suggestions.\n        ws.Cells.Activate\n        ws.Cells.EntireColumn.Hidden = False\n        ws.Cells.EntireRow.Hidden = False\n        If ActiveSheet.FilterMode Then\n            ActiveSheet.ShowAllData\n        End If\n        ws.Cells.Activate\n        ws.Cells.Copy\n        ws.Cells.PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False\n\n        'I put these in here thinking that it might be related to the copying/pasting\n        'action that was prohibiting it from changing sheets.\n\n        Application.CutCopyMode = False\n        ws.Cells(1, 1).Select  \n    Next ws\n\nEnd Sub\n</code></pre>\n\n<p>Greatly appreciate any help!!! I've been pulling hair out of my head (literally) for almost a week trying to troubleshoot this... I'm getting desperate! Thanks!</p>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 5, "creation_date": 1537374539, "post_id": 52410064, "comment_id": 91764510, "body": "That <code>o</code> prefix is useless, wrong, and actively harmful. If you haven&#39;t read <a href=\"https://www.joelonsoftware.com/2005/05/11/making-wrong-code-look-wrong/\" rel=\"nofollow noreferrer\">this excellent article</a> from the author of the VBA language specifications (and CEO of Stack Overflow), I&#39;d warmly recommend it. That prefixing habit is called <i>Systems Hungarian</i>, and it was nothing more than a big huge stupid misunderstanding - the inventor of <i>Hungarian Notation</i> / <i>Apps Hungarian</i> never intended for anyone to encode the data type of a variable in its name. Would be nice if SO answers stopped propagating it."}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537374755, "post_id": 52410064, "comment_id": 91764632, "body": "@MathieuGuindon  Thanks Mathieu, I&#39;ll read the article as soon as I get a chance.   Cheers!"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1537385839, "post_id": 52410064, "comment_id": 91769844, "body": "@MathieuGuindon Very interesting article.  I wasn&#39;t aware of the history behind that sort of notation.  And so I&#39;ve now edited my post.  Thank you very much for pointed it out to me.  I really appreciate it.  Cheers!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537386066, "post_id": 52410064, "comment_id": 91769948, "body": "First time I read it, it was an eye opener - felt like I had been robbed of so many years.. all these CS teachers perpetuating the lie.. I must have linked to that article a thousand times, very few come back and thank me for it! Cheers!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1537387761, "post_id": 52410064, "comment_id": 91770742, "body": "I&#39;ve taken the liberty to rename the disemvoweled identifiers and <a href=\"https://blog.codinghorror.com/flattening-arrow-code/\" rel=\"nofollow noreferrer\">flatten the arrow code</a> - feel free to rollback if you don&#39;t agree with the edit =)"}, {"owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537396538, "post_id": 52410064, "comment_id": 91773809, "body": "@MathieuGuindon Thanks for renaming the identifiers.  It makes things very clear.  Also, thanks for flattening the arrow code. It makes it easier to follow.  And thanks for another interesting article.  I really appreciate it.  Cheers!"}], "tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": false, "score": 1, "last_activity_date": 1537387761, "last_edit_date": 1537387761, "creation_date": 1537373185, "answer_id": 52410064, "question_id": 52409647, "link": "https://stackoverflow.com/questions/52409647/how-to-apply-vba-code-to-all-powerpoint-slides/52410064#52410064", "title": "How to apply VBA code to all Powerpoint slides", "body": "<p>The following macro will loop through each slide within the active presentation.  Then, for each slide, it will loop through each shape within the slide until it finds a table, and then it formats the table.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub ResizeAlignPresentation()\n    Dim currentSlide As Slide\n    For Each currentSlide In ActivePresentation.Slides\n        ResizeAlignSlide currentSlide\n    Next\nEnd Sub\n\nPrivate Sub ResizeAlignSlide(ByVal target As Slide)\n    Dim currentShape As Shape\n    For Each currentShape In target.Shapes\n        If currentShape.Type = msoTable Then\n            ResizeAlignTable currentShape\n            Exit For\n        End If\n    Next\nEnd Sub\n\nPrivate Sub ResizeAlignTable(ByVal table As Shape)\n    With table\n        Debug.Assert .Type = msoTable 'if code breaks here, we have a bug!\n        .Height = 216\n        .Width = 864\n        .Left = 48\n        .Top = 198\n        .ZOrder msoSendToBack\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12518373, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156533684450636/picture?type=large", "display_name": "Hans Kristian Eide", "link": "https://stackoverflow.com/users/12518373/hans-kristian-eide"}, "is_accepted": false, "score": 0, "last_activity_date": 1576068299, "creation_date": 1576068299, "answer_id": 59286139, "question_id": 52409647, "link": "https://stackoverflow.com/questions/52409647/how-to-apply-vba-code-to-all-powerpoint-slides/59286139#59286139", "title": "How to apply VBA code to all Powerpoint slides", "body": "<p>I have upped the last answer with this code I created (in need). I needed to run through all SlideMasters, all slides, all textboxes and put them on top. So they will always be in front of pictures etc.</p>\n\n<pre><code>Sub SetInFront()\nDim m, s, t, ma, sl, te\n\nSet ma = ActivePresentation.Designs\nFor Each m In ma\n    Set sl = m.SlideMaster.CustomLayouts\n    For Each s In sl\n        Set te = s.Shapes\n        For Each t In te\n            If t.HasTextFrame Then\n                t.ZOrder 0\n            End If\n        Next t\n    Next s\nNext m\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10386649, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-zx9idx_-Szg/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOKC_xrTpeYslmBUNTw348TDntMrA/mo/photo.jpg?sz=128", "display_name": "LauRl", "link": "https://stackoverflow.com/users/10386649/laurl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 257, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593677830, "creation_date": 1537371744, "last_edit_date": 1593677830, "question_id": 52409647, "link": "https://stackoverflow.com/questions/52409647/how-to-apply-vba-code-to-all-powerpoint-slides", "title": "How to apply VBA code to all Powerpoint slides", "body": "<p>I am interested in applying the following VBA code to all slides in my powerpoint presentation. The code below resizes my table to the exact specifications I need. Do you have any advice on how to make this apply throughout my presentation? Thanks in advance. </p>\n\n<pre><code>Sub ResizeAlign()\n    With ActiveWindow.Selection.ShapeRange\n    .Height = 216\n    .Width = 864\n    .Left = 48\n    .Top = 198\n        ActiveWindow.Selection.ShapeRange.ZOrder msoSendToBack\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 1, "creation_date": 1537371261, "post_id": 52409241, "comment_id": 91762642, "body": "A code sample would come in handy."}, {"owner": {"reputation": 23, "user_id": 3666376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dw5Vu.jpg?s=128&g=1", "display_name": "GuiWeb", "link": "https://stackoverflow.com/users/3666376/guiweb"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1537371487, "post_id": 52409241, "comment_id": 91762774, "body": "It&#39;s more about the Property. Some of the simplest codes that run after the click is: <code>Private Sub Label5_Click() ActiveWindow.ScrollColumn = 108     ActiveWindow.ScrollRow = 1 End Sub  Private Sub Label6_Click() UserForm1.Show  End Sub  Private Sub Label7_Click()     ActiveWindow.ScrollRow = 21 End Sub</code>"}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 2, "creation_date": 1537371553, "post_id": 52409241, "comment_id": 91762815, "body": "What kind of label?   A cell comment, a chart label, a callout shape?  Could you <i>edit</i> your question with any new info please - edit button is just under the tags."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1537372035, "post_id": 52409241, "comment_id": 91763085, "body": "Why does it have to be a label? From the screenshot I don&#39;t see why it couldn&#39;t be just a texbox <code>Shape</code> assigned to a macro."}, {"owner": {"reputation": 23, "user_id": 3666376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dw5Vu.jpg?s=128&g=1", "display_name": "GuiWeb", "link": "https://stackoverflow.com/users/3666376/guiweb"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537372195, "post_id": 52409241, "comment_id": 91763170, "body": "@MathieuGuindon to be honest, I didn&#39;t know about it.... But right now it&#39;s kind of impossible to redo it, it&#39;s so many labels in the entire project =("}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 23, "user_id": 3666376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dw5Vu.jpg?s=128&g=1", "display_name": "GuiWeb", "link": "https://stackoverflow.com/users/3666376/guiweb"}, "edited": false, "score": 0, "creation_date": 1537372875, "post_id": 52409868, "comment_id": 91763574, "body": "@GuiWeb as a bonus you get to be able to rotate the shape to match the tilting of the panels, <i>and</i> you get the &quot;hand&quot; cursor for free =)"}, {"owner": {"reputation": 23, "user_id": 3666376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dw5Vu.jpg?s=128&g=1", "display_name": "GuiWeb", "link": "https://stackoverflow.com/users/3666376/guiweb"}, "edited": false, "score": 0, "creation_date": 1537373374, "post_id": 52409868, "comment_id": 91763846, "body": "I wish I asked that in the beginning lol. I done the replace of Private Sub to Public Sub and will be just 176 shapes to change #PanicMode kkkkkkk but, yeah, I must agree: the hand cursor is a really great bonus"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 1, "last_activity_date": 1537372494, "creation_date": 1537372494, "answer_id": 52409868, "question_id": 52409241, "link": "https://stackoverflow.com/questions/52409241/label-change-color-when-clicked/52409868#52409868", "title": "Label change color when clicked", "body": "<p>Don't use an ActiveX control for this. Any <code>Shape</code> can be assigned to a macro, so instead of having <code>Click</code> event handlers for ActiveX labels like so:</p>\n\n<pre><code>Private Sub Label2_Click()\n    'do stuff\nEnd Sub\n</code></pre>\n\n<p>Make the handlers public, give them a meaningful name:</p>\n\n<pre><code>Public Sub BuscaPorPalavraChave()\n    'do stuff\nEnd Sub\n</code></pre>\n\n<p>Replace the labels with <code>TextBox</code> shapes - make the shape fill and border transparent, right-click the shape, and select \"assign macro\" - then pick <code>BuscaPorPalavraChavre</code>. Done!</p>\n\n<p><img src=\"https://i.stack.imgur.com/Rvdoc.png\" alt=\"textbox shape made to look just like a label\"></p>\n\n<p><em>Rinse &amp; Repeat</em> for every label. I know, painful - but worth it!</p>\n\n<p>That navigation UI looks very nice BTW =)</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 5828444, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63b298a5717f6ad1c0d3ae5879a2bdba?s=128&d=identicon&r=PG&f=1", "display_name": "zegers11", "link": "https://stackoverflow.com/users/5828444/zegers11"}, "is_accepted": false, "score": 0, "last_activity_date": 1589661169, "creation_date": 1589661169, "answer_id": 61843175, "question_id": 52409241, "link": "https://stackoverflow.com/questions/52409241/label-change-color-when-clicked/61843175#61843175", "title": "Label change color when clicked", "body": "<p>I came up with a different solution in case you have faced a related problem, like the transparency/opaque problem when executing a macro hovering over a transparent label but that becomes opaque when clicking on it.</p>\n\n<p>The workaround consists basically in changing the visibility status when hovering in and out. It might be counterintuitive at first (Because you are making disappear the same label you are using to execute the macro) but it works really well. Let's assume we have two Active X labels overlap. Label1 is the bigger one and label2 is the smaller one, completely contained in Label1. The code I used is like:</p>\n\n<pre><code>Private Sub Label2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n\nApplication.ScreenUpdating = False \nLabel2.Visible = False \nLabel1.Visible = True\n### Put your code in here\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Then as you hover out label2, and assuming the labels are correctly overlap, you will hover over Label 1, now visible because you \"activated it\", and the following code is executed</p>\n\n<pre><code>Private Sub Label1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n\nApplication.ScreenUpdating = False \nLabel2.Visible = True\nLabel1.Visible = False\n### Put your code in here\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Please bear in mind that you need to have a figure or button in between the two Active x labels, otherwise you will get a strange result because in the exact moment you hover over Label 2, it will disappear, leaving Label 1 beneath it which will also disappear as soon as you move, makin Label 2 appear again and ... you get the idea. This will not break the excel file but will make it make strange things like blinking or delaying the mouse movement. To prevent thus. I recommend to have that shape as a safe zone. </p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 23, "user_id": 3666376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dw5Vu.jpg?s=128&g=1", "display_name": "GuiWeb", "link": "https://stackoverflow.com/users/3666376/guiweb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1306, "favorite_count": 1, "accepted_answer_id": 52409868, "answer_count": 2, "score": 1, "last_activity_date": 1589661169, "creation_date": 1537370419, "last_edit_date": 1537371956, "question_id": 52409241, "link": "https://stackoverflow.com/questions/52409241/label-change-color-when-clicked", "title": "Label change color when clicked", "body": "<p>I have a VBA/Excel that user clicks on labels (Active X - Text Label) to perform some actions. The label property is BackStyle Transparent, but when the user click, the label keep opaque, like white or whatever the BackColor property is set.</p>\n\n<p>How can I keep transparent when user click on the label?</p>\n\n<p><img src=\"https://i.stack.imgur.com/Vv7vg.jpg\" alt=\"One example of this label\"></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1537370068, "post_id": 52409027, "comment_id": 91761899, "body": "&quot;Appears to not want to run&quot; is vague. Is there a specific error message?"}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537370142, "post_id": 52409027, "comment_id": 91761940, "body": "Sidenote - <code>Dim lastRow, i, erow As Integer</code> is declaring <code>lastRow</code> as <code>Variant</code> and <code>i</code> as <code>Variant</code>. You want to write that as <code>Dim lastRow As Integer, i as Integer, erow as Integer</code>."}, {"owner": {"reputation": 3, "user_id": 10386355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d8cd29b2acb115aa888df322a149d9?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin.D", "link": "https://stackoverflow.com/users/10386355/kevin-d"}, "edited": false, "score": 0, "creation_date": 1537517788, "post_id": 52409027, "comment_id": 91821641, "body": "My bad. I will ensure to include the error messages next time and thanks for the note on declaring. Honestly, I just saw this done on another bit of code I &#39;borrowed&#39;. Figuring it was just a neater way of declaring, I did the same thing."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10386355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d8cd29b2acb115aa888df322a149d9?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin.D", "link": "https://stackoverflow.com/users/10386355/kevin-d"}, "edited": false, "score": 0, "creation_date": 1537519949, "post_id": 52409205, "comment_id": 91822760, "body": "Thank you very much, works like a charm. While it makes more sense to use that method when coping small amounts of data, when would it make more sense to use the loop?"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 0, "last_activity_date": 1537370607, "last_edit_date": 1537370607, "creation_date": 1537370283, "answer_id": 52409205, "question_id": 52409027, "link": "https://stackoverflow.com/questions/52409027/trying-to-pull-a-specific-range-of-cells-from-another-work-book/52409205#52409205", "title": "Trying to Pull a specific range of cells from another work book", "body": "<p>You are not specifing the parent on the copy range.</p>\n\n<pre><code>Range(Cells(i, \"A\"), Cells(i, \"B\")).Select\n</code></pre>\n\n<p>Change to:</p>\n\n<pre><code>sws.Range(sws.Cells(i, \"A\"), sws.Cells(i, \"B\")).Copy\n</code></pre>\n\n<p>and remove the <code>Selection.Copy</code> line</p>\n\n<p>But you can speed thing up a little and remove the loop by assigning the values directly:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim lastRow As Long, erow As Long\nDim filename As String\nDim fname As Variant\nDim dwbk As Workbook, swbk As Workbook\nDim sws As Worksheet, dws As Worksheet\nDim r1 As Range\n\n    Set dwbk = ThisWorkbook\n    Set dws = dwbk.Sheets(\"Call OFF\")\n\n    'On Error GoTo ErrHandling\n\n    'Application.ScreenUpdating = False\n\n    FileArray = Application.GetOpenFilename(Title:=\"Select file(s)\", MultiSelect:=True)\n\n    For Each fname In FileArray\n\n        Set swbk = Workbooks.Open(fname)\n        Set sws = swbk.Sheets(\"Allocations\")\n        lastRow = sws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n        erow = dws.Cells(dws.Rows.Count, 2).End(xlUp).Offset(1, 0).Row\n        dws.Cells(erow, 2).Resize(lastRow - 1, 2).Value = sws.Range(sws.Cells(2, 1), sws.Cells(lastRow, 2)).Value\n    Next fname\n\n\n\n\n    'Application.ScreenUpdating = True\n'        End If\n\n'Done:\n'    Exit Sub\n'\n'ErrHandling:\n'            MsgBox \"No file selected\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10386355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55d8cd29b2acb115aa888df322a149d9?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin.D", "link": "https://stackoverflow.com/users/10386355/kevin-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 52409205, "answer_count": 1, "score": 0, "last_activity_date": 1537370607, "creation_date": 1537369750, "question_id": 52409027, "link": "https://stackoverflow.com/questions/52409027/trying-to-pull-a-specific-range-of-cells-from-another-work-book", "title": "Trying to Pull a specific range of cells from another work book", "body": "<p>first timer here, so go easy on me :)\nOnly been using VBA for a few months on work projects and I have hit a wall with what I can google, figured Id post the problem here.</p>\n\n<p>I have a button that will open a source workbook and copy a specific range of cells from the source workbook to the destination workbook. This range of cells to be copied is determined by a for loop that starts at row 2 and loops to the last row of data. I have this code working in another project, but it appears to not want to run when its targeted at a different workbook.\nAppreciate the help and any advice on the code in general would be welcome :)</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim lastRow, i, erow As Integer\nDim filename As String\nDim fname As Variant\nDim dwbk, swbk As Workbook\nDim sws, dws As Worksheet\nDim r1 As Range\n\n    Set dwbk = ThisWorkbook\n    Set dws = dwbk.Sheets(\"Call OFF\")\n\n    'On Error GoTo ErrHandling\n\n    'Application.ScreenUpdating = False\n\n    FileArray = Application.GetOpenFilename(Title:=\"Select file(s)\", MultiSelect:=True)\n\n            For Each fname In FileArray\n\n                Set swbk = Workbooks.Open(fname)\n                Set sws = swbk.Sheets(\"Allocations\")\n                lastRow = sws.Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n                For i = 2 To lastRow\n\n                    Range(Cells(i, \"A\"), Cells(i, \"B\")).Select\n                    Selection.Copy\n\n                    dwbk.Sheets(\"CALL OFF\").Activate\n                    erow = Worksheets(\"CALL OFF\").Cells(Rows.Count, 2).End(xlUp).Offset(1, 0).Row\n                    Worksheets(\"CALL OFF\").Cells(erow, 2).PasteSpecial xlPasteValues\n\n                    swbk.Activate\n\n                Next i\n            Next\n\n    'Application.ScreenUpdating = True\n'        End If\n\n'Done:\n'    Exit Sub\n'\n'ErrHandling:\n'            MsgBox \"No file selected\"\n\nEnd Sub\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba", "pivot-table", "division"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537368195, "post_id": 52408340, "comment_id": 91760654, "body": "Wrap the original AFC_pct formula with the <code>Iferror</code> - something like <code>=Iferror(AFC_hrs&#47; &#39;Daily_SchdsHrsWrk&#39;, 0)</code>"}, {"owner": {"reputation": 67, "user_id": 10044303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6dWrBS5Uho4/AAAAAAAAAAI/AAAAAAAAAAo/Zlv8_rhbnnU/photo.jpg?sz=128", "display_name": "Jenna Terral", "link": "https://stackoverflow.com/users/10044303/jenna-terral"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537371402, "post_id": 52408340, "comment_id": 91762720, "body": "That worked, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": false, "score": 0, "last_activity_date": 1537370616, "creation_date": 1537370616, "answer_id": 52409293, "question_id": 52408340, "link": "https://stackoverflow.com/questions/52408340/div-0-in-calculated-field-vba-pivot-table/52409293#52409293", "title": "Div/0 in Calculated Field VBA Pivot Table", "body": "<p>Just hide the errors in the PT properties.</p>\n\n<p>Pivot Table Options > Layout &amp; Format > For Error Values Show</p>\n\n<p>Check the box and leave the value blank, or enter the value you want to display.</p>\n\n<p><a href=\"https://i.stack.imgur.com/1JSab.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1JSab.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 67, "user_id": 10044303, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-6dWrBS5Uho4/AAAAAAAAAAI/AAAAAAAAAAo/Zlv8_rhbnnU/photo.jpg?sz=128", "display_name": "Jenna Terral", "link": "https://stackoverflow.com/users/10044303/jenna-terral"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 268, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537370616, "creation_date": 1537367652, "last_edit_date": 1537369247, "question_id": 52408340, "link": "https://stackoverflow.com/questions/52408340/div-0-in-calculated-field-vba-pivot-table", "title": "Div/0 in Calculated Field VBA Pivot Table", "body": "<p>I am trying to remove my 'Div/0' error on my outputted Excel Sheet using my VBA Code. </p>\n\n<p>My calculated field \"AFC_pct\" is causing the Div/0 error. I am unable to use the =IfError function because I keep getting a compile error</p>\n\n<pre><code>.CalculatedFields.Add \"ACD_hrs\", \"=ACDTime/3600\"\n.CalculatedFields.Add \"AuxOut_hrs\", \"=AuxOut/3600\"\n.CalculatedFields.Add \"Avail_hrs\", \"=Avail/3600\"\n.CalculatedFields.Add \"Other_hrs\", \"=Other/3600\"\n.CalculatedFields.Add \"AFC_hrs\", \"=AFC_Time/3600\"\n.CalculatedFields.Add \"AFC_pct\", \"=AFC_hrs/ 'Daily_SchdHrsWrk'\"\n=IfError(\"AFC_pct\",0)\n</code></pre>\n"}, {"tags": ["jquery", "vba", "msxml", "winhttp"], "comments": [{"owner": {"reputation": 1311, "user_id": 5591211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dq1iO.jpg?s=128&g=1", "display_name": "Rich", "link": "https://stackoverflow.com/users/5591211/rich"}, "edited": false, "score": 1, "creation_date": 1537369168, "post_id": 52408322, "comment_id": 91761287, "body": "Please read this <a href=\"https://stackoverflow.com/help/how-to-ask\">stackoverflow.com/help/how-to-ask</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1537369199, "post_id": 52408322, "comment_id": 91761303, "body": "Please include the relevant HTML and your code. See <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> for help. Remember when providing HTML to use the snippet tool available via <a href=\"https://stackoverflow.com/posts/52408322/edit\">edit</a>."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1537382079, "post_id": 52408322, "comment_id": 91768110, "body": "Not logged response means that you have not provide cookies within request header. WinHTTP doesn&#39;t handle cookies, so the code should receive, store and send them. You may use MSXML2.XMLHTTP that supports cookies processing, and automatically adds the necessary cookies to requests, even they was received in IE. Check <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/hh227298(v=vs.85).aspx\" rel=\"nofollow noreferrer\">WinINet vs. WinHTTP</a>."}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1537384134, "post_id": 52408322, "comment_id": 91769044, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52382880/vba-how-to-read-and-store-ltpa\">vba how to read and store LTPA?</a>"}, {"owner": {"reputation": 1, "user_id": 10345862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0ef992b15fd40e70da60433062af187?s=128&d=identicon&r=PG&f=1", "display_name": "Mao", "link": "https://stackoverflow.com/users/10345862/mao"}, "edited": false, "score": 0, "creation_date": 1537429342, "post_id": 52408322, "comment_id": 91783159, "body": "Well, i&#39;m trying a different approach to the same problem...maybe it&#39;s not a cookies..maybe a non correct http code o maybe something else"}], "owner": {"reputation": 1, "user_id": 10345862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0ef992b15fd40e70da60433062af187?s=128&d=identicon&r=PG&f=1", "display_name": "Mao", "link": "https://stackoverflow.com/users/10345862/mao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537429964, "creation_date": 1537367602, "last_edit_date": 1537429964, "question_id": 52408322, "link": "https://stackoverflow.com/questions/52408322/jquery-and-winhttp-msxml2-request", "title": "Jquery and winhttp msxml2 request", "body": "<p>I just compile a source code to login in intranet login page, navigate trough page, scrape data and so on using internet application and vba starting from a Excel form. So, i would like to do the same thing using silently connection. I am be able to login, and navigate through some pages but not in the one which I have to reach clicking on a hyperlink text such as\n<code>\n&lt;a href=/home/webservlet&gt;info&lt;/a&gt;\n</code> If I go direct mode to the url  i.e. http as winhttp object so <code>\nhttp.open(\"get\", http:// homeserver/home/webservlet)</code> </p>\n\n<p>The response is \"not logged\u2026\"or something else. I see that in the html code there is jquery, so i think that sending through winhttp the right parameter to the jquery. Is it a bad idea? and how to do it?</p>\n\n<p>************addedd html code page. in bold the href i want to reach****** **</p>\n\n<pre><code>this is the link that i want        \n                &lt;li class=\"el_link\"&gt;&lt;a href=\"/S*****Uffici/S*****WebServlet\"&gt;Informazioni Generalizzate&lt;/a&gt;\n                &lt;/li&gt;****\n</code></pre>\n\n<p> </p>\n\n<p></p>\n\n<pre><code>&lt;HEAD&gt;\n\n&lt;META name=\"GENERATOR\" content=\"IBM Software Development Platform\"&gt;\n&lt;META http-equiv=\"Content-Type\" content=\"text/html; charset=ISO-8859-1\"&gt;\n&lt;META http-equiv=\"Cache-Control\" content=\"no-cache,no-store,must-revalidate\"&gt;\n&lt;META http-equiv=\"Expires\" content=\"-1\"&gt;\n&lt;META http-equiv=\"Pragma\" content=\"no-cache\"&gt;\n&lt;!--  includo CSS Base --&gt;\n&lt;LINK REL=STYLESHEET TYPE=\"text/css\" HREF=\"/S*****Static/home/css/S*****Home.css\"&gt;\n\n&lt;LINK REL=STYLESHEET TYPE=\"text/css\" HREF=\"/S*****Static/home/css/jquery-ui-1.8.10.custom.css\"&gt;\n\n\n\n&lt;!--  includo i JS di Servizio dinamicamente --&gt;\n&lt;script type=\"text/javascript\" src=\"/S*****Static/home/js/jquery.js\"&gt;&lt;/script&gt;\n\n&lt;script type=\"text/javascript\" src=\"/S*****Static/home/js/toggleHome.js\"&gt;&lt;/script&gt;\n\n\n\n&lt;!--  includo il titolo dinamicamente --&gt;\n&lt;TITLE&gt;\nServizi di ********.\n\n&lt;/TITLE&gt;\n\n&lt;/HEAD&gt;\n&lt;BODY&gt;\n\n&lt;div class=\"contenitore\"&gt;\n\n\n\n\n&lt;div id=\"testata\"&gt;\n        &lt;div id=\"testata_fondo_i\"&gt;\n            &lt;div id=\"testata_sx\"&gt;&lt;a href=\"http://www.a*****.it/\" title=\"Vai al sito [Link a sito esterno]\" target=\"_agenziaWindow\"&gt;&lt;img\n    src=\"/S*****Static/home/immagini/logo.gif\" alt=\"Sito *********\"&gt;&lt;/a&gt;\n    &lt;/div&gt;\n            &lt;div id=\"testata_centro_i\"&gt;&lt;/div&gt;\n            &lt;div id=\"testata_dx_i\"&gt;&lt;/div&gt;\n\n        &lt;/div&gt;\n&lt;/div&gt;  \n\n\n\n\n\n\n\n\n\n\n                    &lt;LINK REL=STYLESHEET TYPE=\"text/css\" HREF=\"/S*****Static/home/css/menu_dropDown.css\"&gt;\n&lt;!--[If lt IE 9]&gt;\n     &lt;LINK REL=STYLESHEET TYPE=\"text/css\" HREF=\"/S*****Static/home/css/menu_dropDown_IElt9.css\"&gt;\n&lt;![endif]--&gt; \n&lt;!--[If IE 9]&gt;\n     &lt;LINK REL=STYLESHEET TYPE=\"text/css\" HREF=\"/S*****Static/home/css/menu_dropDown_IE9.css\"&gt;\n&lt;![endif]--&gt; \n&lt;div class=\"menu_orizzontale\"&gt;\n&lt;div class=\"menu\"&gt;\n   &lt;ul class=\"blockeasing\"&gt;\n        &lt;li class=\"main\"&gt;\n                 &lt;a href=\"/S*****Home\"&gt; Home SERVIZI&lt;/a&gt;\n        &lt;/li&gt;\n        &lt;li class=\"main\"&gt;\n             &lt;a href=\"#\"&gt;Consultazioni&lt;/a&gt;\n                 &lt;ul class=\"subnav0\"&gt;\n                      &lt;li&gt;&lt;a href=\"/S*****Uffici/S*****WebServlet\"&gt;Informazioni Generalizzate&lt;/a&gt;&lt;/li&gt;\n                      &lt;li&gt;&lt;a href=\"/CollegamentoTerritorioWeb/TerritorioServlet\"&gt;Catasto e Conservatorie&lt;/a&gt;&lt;/li&gt;\n                 &lt;/ul&gt;\n        &lt;/li&gt;\n        &lt;li class=\"main\"&gt;\n             &lt;a href=\"#\"&gt;Consultazioni Dati non A.T.&lt;/a&gt;\n                 &lt;ul class=\"subnav1\"&gt;\n                      &lt;li&gt;&lt;a href=\"/CciaaConsultazioneWeb/CCIAAServlet\"&gt;Camera di Commercio&lt;/a&gt;&lt;/li&gt;\n                      &lt;li&gt;&lt;a href=\"/Conto/E*****Servlet\"&gt;Estratto Conto &lt;/a&gt;&lt;/li&gt;\n                 &lt;/ul&gt;\n        &lt;/li&gt;\n   &lt;/ul&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;div class=\"esci\"&gt;\n        &lt;a href=\"/S*****Home/CloseSession\"&gt; Esci&lt;/a&gt;\n&lt;/div&gt;\n&lt;div class=\"user\"&gt;\n           Utente connesso &lt;i&gt;&lt;b&gt;P*************R&lt;/b&gt;&lt;/i&gt;\n&lt;/div&gt;\n&lt;script type=\"text/javascript\" src=\"/S*****Static/home/js/jquery-ui-1.8.24.custom.min.js\"&gt;&lt;/script&gt;\n&lt;script type=\"text/javascript\"&gt;\n    $(document).ready(function() {\n      $(\"ul.blockeasing li.main\").mouseover(function(){ \n         $(this).find('.subnav0').stop().animate({height: '59px', opacity:'1'},{queue:false, duration:1500, easing: 'easeOutElastic'})\n         $(this).find('.subnav1').stop().animate({height: '59px', opacity:'1'},{queue:false, duration:1500, easing: 'easeOutElastic'})\n         $(this).find('.subnav2').stop().animate({height: '11px', opacity:'1'},{queue:false, duration:1500, easing: 'easeOutElastic'})\n    });\n      $(\"ul.blockeasing li.main\").mouseout(function(){ \n         $(this).find('.subnav0').stop().animate({height:'0px', opacity:'0'},{queue:false, duration:1600, easing: 'easeOutElastic'})\n         $(this).find('.subnav1').stop().animate({height:'0px', opacity:'0'},{queue:false, duration:1600, easing: 'easeOutElastic'})\n         $(this).find('.subnav2').stop().animate({height:'0px', opacity:'0'},{queue:false, duration:1600, easing: 'easeOutElastic'})\n    });\n    $(\"ul.blockeasing li\").hover(function() {\n            $(this).stop().animate({ backgroundColor: \"#F7F7F7\"}, 600);},\n            function() {\n            $(this).stop().animate({ backgroundColor: \"#FDAF7B\"}, 600);\n    });\n  });\n&lt;/script&gt;\n\n\n\n\n\n&lt;div class=\"vociMenu\"&gt;\n\n\n\n\n&lt;!-- script per la corretta visualizzazione delle colonne --&gt;\n\n\n\n\n\n        &lt;!-- Link al servizio composto da sottomenu --&gt;\n\n            &lt;h2 class=\"trigger\"&gt;&lt;a href=\"#\"&gt;Consultazioni&lt;/a&gt;&lt;/h2&gt;\n            &lt;div class=\"datiMenu2\"&gt;\n                &lt;ul class=\"menu_ul\"&gt;\n\n\n**\u2018 this is the link that i want        \n            &lt;li class=\"el_link\"&gt;&lt;a href=\"/S*****Uffici/S*****WebServlet\"&gt;Informazioni Generalizzate&lt;/a&gt;\n            &lt;/li&gt;**\n\n\n\n\n            &lt;li class=\"el_link\"&gt;&lt;a href=\"/CollegamentoTerritorioWeb/TerritorioServlet\"&gt;Catasto e Conservatorie&lt;/a&gt;\n            &lt;/li&gt;\n\n\n\n            &lt;li class=\"el_end\"&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/div&gt;\n\n\n\n        &lt;!-- Link al servizio composto da sottomenu --&gt;\n\n            &lt;h2 class=\"trigger\"&gt;&lt;a href=\"#\"&gt;Consultazioni&lt;br&gt;Dati non A.T.&lt;/a&gt;&lt;/h2&gt;\n            &lt;div class=\"datiMenu2\"&gt;\n                &lt;ul class=\"menu_ul\"&gt;\n\n\n\n            &lt;li class=\"el_link\"&gt;&lt;a href=\"/CciaaConsultazioneWeb/CCIAAServlet\"&gt;Camera di Commercio&lt;/a&gt;\n            &lt;/li&gt;\n\n\n\n\n            &lt;li class=\"el_link\"&gt;&lt;a href=\"/ContoEquitalia/EquitaliaServlet\"&gt;Estratto Conto AdER&lt;/a&gt;\n            &lt;/li&gt;\n\n\n\n            &lt;li class=\"el_end\"&gt;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/div&gt;\n\n\n\n\n\n\n\n\n\n&lt;/div&gt;\n\n&lt;!-- \n&lt;div class=\"validator\"&gt;\n     &lt;p&gt;\n        &lt;a href=\"http://validator.w3.org/check?uri=referer\"&gt;&lt;img\n         src=\"http://www.w3.org/Icons/valid-html401\" alt=\"Valid HTML 4.01 Transitional\" height=\"31\" width=\"88\"&gt;&lt;/a&gt;\n    &lt;/p&gt;\n\n&lt;/div&gt;\n --&gt;\n&lt;div class=\"footer\"&gt;\n    &lt;div class=\"destra\"&gt;\n         &lt;img src=\"/S*****Static/home/immagini/Sogei.gif\" alt=\"logo Sogei\"&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n&lt;/div&gt;\n&lt;/BODY&gt;\n&lt;/HTML&gt;\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1537367367, "post_id": 52408217, "comment_id": 91760166, "body": "Put them into 4 different arrays.  If you want to then loop them and put them in one array."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537367549, "post_id": 52408217, "comment_id": 91760289, "body": "Simple and efficient indeed."}, {"owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537367821, "post_id": 52408217, "comment_id": 91760456, "body": "@ScottCraner Can you make it an answer ?"}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537367944, "post_id": 52408217, "comment_id": 91760514, "body": "In a meeting, on my phone.  I like jeeped&#39;s answer better anyways."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537464520, "post_id": 52408217, "comment_id": 91804197, "body": "@ScottCraner I gotchu my man, added one with the type of answer you were thinking of"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 2, "last_activity_date": 1537367731, "creation_date": 1537367731, "answer_id": 52408366, "question_id": 52408217, "link": "https://stackoverflow.com/questions/52408217/several-non-contiguous-columns-into-array/52408366#52408366", "title": "several non contiguous columns into array", "body": "<p>ReDim with Preserve will only allow you to modify the last rank but you could shift the array elements' values first.</p>\n\n<pre><code>dim ar as variant, i as long\n\nar = sheet1.Range(\"C2:T2681\").value\n\nfor i=lbound(ar, 1) to ubound(ar, 1)\n    ar(i, 2) = ar(i, 5)   'move column G to 2nd\n    ar(i, 3) = ar(i, 8)   'move column J to 3rd\n    ar(i, 4) = ar(i, 18)  'move column T to 4th\nnext i\n\nredim preserve ar(lbound(ar, 1) to ubound(ar, 1), lbound(ar, 2) to 4)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": true, "score": 2, "last_activity_date": 1542927400, "last_edit_date": 1542927400, "creation_date": 1537463258, "answer_id": 52430064, "question_id": 52408217, "link": "https://stackoverflow.com/questions/52408217/several-non-contiguous-columns-into-array/52430064#52430064", "title": "several non contiguous columns into array", "body": "<p>You could always store those columns within a <a href=\"https://stackoverflow.com/a/9436309/2727437\">jagged array</a>, an array of arrays. The syntax is actually pretty easy in VBA; you can store all the <code>.Value</code>s of a range (in the form of an array) inside of another (previously dimmed) array. </p>\n\n<p>When you're working with a range that includes several sub-ranges (contiguous or not), you can access them separately by looping on that range's <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.areas\" rel=\"nofollow noreferrer\"><code>.Areas</code> property</a>.</p>\n\n<p>The only thing that you have to be careful about is the indices because the syntax is a little funky and in your particular example you don't start with the first row.</p>\n\n<pre><code>Option Explicit\n\nSub NonContiguousRanges()\n\n    Dim rng As Range\n    Set rng = Range(\"C2:C20, G2:G20, J2:J20, T2:T20\")\n\n    Dim jagged As Variant\n    ReDim jagged(1 To rng.areas.count)\n\n    Dim i As Long\n    For i = 1 To rng.areas.count\n        jagged(i) = rng.areas(i).Value2\n    Next i\n\n\n    '=-~ examples of accessing the values ~-='\n\n    'first value, C2\n    MsgBox jagged(1)(1, 1)\n\n    'last  value, T20\n    MsgBox jagged(4)(19, 1)\n    MsgBox jagged(UBound(jagged))(UBound(jagged(UBound(jagged))), 1)\n\nEnd Sub\n</code></pre>\n\n<p>I mean just look at all those <code>UBound</code>s... gave me a bit of a headache just getting it right!</p>\n"}], "owner": {"reputation": 22957, "user_id": 78522, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/3facb4a672d9fbeb9f2ed6b5acc65633?s=128&d=identicon&r=PG", "display_name": "Patrick Honorez", "link": "https://stackoverflow.com/users/78522/patrick-honorez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 1, "accepted_answer_id": 52430064, "answer_count": 2, "score": 1, "last_activity_date": 1542927400, "creation_date": 1537367260, "question_id": 52408217, "link": "https://stackoverflow.com/questions/52408217/several-non-contiguous-columns-into-array", "title": "several non contiguous columns into array", "body": "<p>I try to load as efficiently as possible 4 columns to an array.<br>\nI tried  </p>\n\n<pre><code>dim ar\nar = sheet1.Range(\"C2:C2681,G2:G2681,J2:J2681,T2:T2681\")\n</code></pre>\n\n<p>but only the first column is loaded into the array.<br>\nI also tried  </p>\n\n<pre><code>    ar = .Range(\"C2:T\" &amp; lastRow)\n    ar = Application.Index(ar, , Array(1, 5, 19))\n</code></pre>\n\n<p>but that gives me a type mismatch error.</p>\n\n<p>Any clever trick for this purpose ?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1537372453, "post_id": 52407177, "comment_id": 91763326, "body": "What is the exact error you are getting?"}, {"owner": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "reply_to_user": {"reputation": 2518, "user_id": 3411058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bCrM6.png?s=128&g=1", "display_name": "Rik Sportel", "link": "https://stackoverflow.com/users/3411058/rik-sportel"}, "edited": false, "score": 0, "creation_date": 1537378647, "post_id": 52407177, "comment_id": 91766468, "body": "@RikSportel updated the post."}], "answers": [{"comments": [{"owner": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "edited": false, "score": 0, "creation_date": 1537379577, "post_id": 52407649, "comment_id": 91766880, "body": "It seems like <code>wbk.Worksheets(1)</code> is the solution... why doesn&#39;t my version of this seem to work? My value for namesheet is &quot;Weights&quot;, which is a sheet that exists in my workbook."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "edited": false, "score": 0, "creation_date": 1537380069, "post_id": 52407649, "comment_id": 91767140, "body": "@&#201;varisteGalois - no idea. In general, the code lacks explicit declarations of variables and uses a lot of Active and Select, thus probably the error is somewhere there... See the 2 links in the answer, they are quite useful."}, {"owner": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "edited": false, "score": 0, "creation_date": 1537391883, "post_id": 52407649, "comment_id": 91772395, "body": "I added some updated code where I adhere to the idea of explicitly declaring variables. It seems like I still get the same error, could it be because my workbook uses Activate? How would I replace that in the context of my function?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "edited": false, "score": 0, "creation_date": 1537429071, "post_id": 52407649, "comment_id": 91783003, "body": "@&#201;varisteGalois - the error is from the range variable <code>nameRange</code>. See the code in the answer."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 1, "last_activity_date": 1537429028, "last_edit_date": 1537429028, "creation_date": 1537365504, "answer_id": 52407649, "question_id": 52407177, "link": "https://stackoverflow.com/questions/52407177/vba-method-add-of-chart-objects-failed/52407649#52407649", "title": "VBA - Method &quot;add&quot; of Chart objects failed", "body": "<p>The variables are not explicitly declared. Although it should not be a problem here, as the <code>newChart</code> should be considered <code>Variant</code>, try to write <code>Dim newChart as ChartObject</code> on the line before <code>wbk.Activate</code>.</p>\n\n<p>Then calling separately something as small as this one:</p>\n\n<pre><code>Sub TestMe()\n    Dim newChart As ChartObject\n    Set newChart = Worksheets(1).ChartObjects.Add(100, 100, 100, 100)\nEnd Sub\n</code></pre>\n\n<p>And then start adding <code>Plage.Left, Plage.Top, Plage.Width, Plage.Height</code> instead of the hardcoded arguments (100). Then add <code>wbk.Worksheets(Namesheet)</code> as well and see whether it works.</p>\n\n<hr>\n\n<p>Not declaring variables is really a bad practice. This works, if you declare all. In this specific small example, the problem is the <code>nameRange</code> variable:</p>\n\n<pre><code>Option Explicit\n\nSub TestMe()\n    Debug.Print PictureToHTML(ThisWorkbook, \"Sheet1\", Range(\"A1:E20\"), \"probably.png\")\nEnd Sub\n\nFunction PictureToHTML(wbk As Workbook, Namesheet As String, _\n                        nameRange As Range, imgFile As String) As String\n\n    Dim WeightsSheet As Worksheet\n    Dim newChart As ChartObject\n    Dim Plage As Range\n    Dim tempFilePath As String\n\n    Set WeightsSheet = wbk.Worksheets(Namesheet)\n\n    Set Plage = wbk.Worksheets(Namesheet).Range(nameRange.Address)\n    Plage.CopyPicture\n\n    tempFilePath = Environ$(\"temp\") &amp; \"\\\" &amp; imgFile\n    Set newChart = WeightsSheet.ChartObjects.Add( _\n                        Plage.Left, Plage.Top, Plage.Width, Plage.Height)\n\n    With newChart\n        .Chart.Parent.Border.LineStyle = 0\n        .Chart.Paste\n        .Chart.Export tempFilePath, \"PNG\"\n    End With\n\n    WeightsSheet.ChartObjects(WeightsSheet.ChartObjects.Count).Delete\n    PictureToHTML = \"&lt;br&gt;&lt;B&gt;\" &amp; Namesheet &amp; \":&lt;/B&gt;&lt;br&gt;\" &amp; \"&lt;img src='cid:\" &amp; imgFile &amp; \"'&gt;\"\n\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>As a next step, consider reading the documentation for Option Explicit:</p>\n\n<ul>\n<li><p><a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-explicit-statement\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-explicit-statement</a></p></li>\n<li><p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p></li>\n</ul>\n"}], "owner": {"reputation": 845, "user_id": 3911832, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/myepU.jpg?s=128&g=1", "display_name": "&#201;variste Galois", "link": "https://stackoverflow.com/users/3911832/%c3%89variste-galois"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1245, "favorite_count": 0, "accepted_answer_id": 52407649, "answer_count": 1, "score": 1, "last_activity_date": 1537429028, "creation_date": 1537364115, "last_edit_date": 1537391826, "question_id": 52407177, "link": "https://stackoverflow.com/questions/52407177/vba-method-add-of-chart-objects-failed", "title": "VBA - Method &quot;add&quot; of Chart objects failed", "body": "<p>I'm attempting to create a function that will email a portion of a sheet, with the code below:</p>\n\n<pre><code>Function PictureToHTML(wbk, Namesheet, nameRange, imgFile)\n\n    wbk.Activate\n    Worksheets(Namesheet).Activate\n\n    nameRange = \"C7:C10\"\n\n    Set Plage = wbk.Worksheets(Namesheet).Range(nameRange)\n    Plage.CopyPicture\n\n    TempFilePath = Environ$(\"temp\") &amp; \"\\\" &amp; imgFile\n\n    Set newchart = wbk.Worksheets(Namesheet).ChartObjects.Add(Plage.Left, Plage.Top, Plage.Width, Plage.Height)\n\n    With newchart\n        .Activate\n        .Chart.parent.Border.LineStyle = 0\n        .Chart.Paste\n        .Chart.Export TempFilePath, \"PNG\"\n    End With\n    Worksheets(Namesheet).ChartObjects(Worksheets(Namesheet).ChartObjects.Count).Delete\n    Set Plage = Nothing\n\n    PictureToHTML = \"&lt;br&gt;&lt;B&gt;\" &amp; Namesheet &amp; \":&lt;/B&gt;&lt;br&gt;\" _\n                &amp; \"&lt;img src='cid:\" &amp; imgFile &amp; \"'&gt;\"\n\nEnd Function\n</code></pre>\n\n<p>I've temporarily hardcoded the range I want to cut (even though it shouldn't be an issue...), and I get the error on this line:</p>\n\n<pre><code>Set newchart = wbk.Worksheets(Namesheet).ChartObjects.Add(Plage.Left, Plage.Top, Plage.Width, Plage.Height)\n</code></pre>\n\n<p>Full error:</p>\n\n<blockquote>\n  <p>Run-time error'-2147417878 (80010108)':\n      Method 'Add' of object 'ChartObjects' failed</p>\n</blockquote>\n\n<p>Could anyone tell me where my mistake is?\nUpdated code:</p>\n\n<pre><code>Function PictureToHTML(wbk, Namesheet, nameRange, imgFile)\n\n    Dim WeightsSheet As Worksheet\n    Dim newChart As ChartObject\n    wbk.Activate\n\n    Set WeightsSheet = wbk.Worksheets(Namesheet)\n\n    Set Plage = wbk.Worksheets(Namesheet).Range(nameRange)\n    Plage.CopyPicture\n\n    TempFilePath = Environ$(\"temp\") &amp; \"\\\" &amp; imgFile\n    Set newChart = WeightsSheet.ChartObjects.Add(Plage.Left, Plage.Top, Plage.Width, Plage.Height)\n\n    With newChart\n        .Activate\n        .Chart.parent.Border.LineStyle = 0\n        .Chart.Paste\n        .Chart.Export TempFilePath, \"PNG\"\n    End With\n    WeightsSheet.ChartObjects(WeightsSheet.ChartObjects.Count).Delete\n    Set Plage = Nothing\n\n    PictureToHTML = \"&lt;br&gt;&lt;B&gt;\" &amp; Namesheet &amp; \":&lt;/B&gt;&lt;br&gt;\" _\n                &amp; \"&lt;img src='cid:\" &amp; imgFile &amp; \"'&gt;\"\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 3, "creation_date": 1537363697, "post_id": 52407014, "comment_id": 91757701, "body": "You can&#39;t do that. Consider using an array or a dictionary instead."}, {"owner": {"reputation": 423, "user_id": 9617806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213e6ed6dec56e82c94c39c004939579?s=128&d=identicon&r=PG&f=1", "display_name": "K-Doe", "link": "https://stackoverflow.com/users/9617806/k-doe"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1537363755, "post_id": 52407014, "comment_id": 91757743, "body": "That are the ways I know. So It seems that there is no way without them."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1537368790, "post_id": 52407109, "comment_id": 91761029, "body": "&quot;Generally when folks start thinking this way the answer is&quot; - I was fully expecting &quot;use PHP&quot; there ;-)"}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1537368936, "post_id": 52407109, "comment_id": 91761131, "body": "@MathieuGuindon omgno <a href=\"http://php.net/manual/en/language.variables.variable.php\" rel=\"nofollow noreferrer\">variable variables</a> The shame. THE HORROR!"}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": true, "score": 7, "last_activity_date": 1537364636, "last_edit_date": 1537364636, "creation_date": 1537363913, "answer_id": 52407109, "question_id": 52407014, "link": "https://stackoverflow.com/questions/52407014/want-to-access-variable-by-its-name-with-string-value/52407109#52407109", "title": "Want to Access variable by its name with string value", "body": "<p>You can't reference a variable dynamically like that. It's against the law. Generally when folks start thinking this way the answer is \"Use an Array\". Instead, given your example, a dictionary would be best:</p>\n\n<p>Example using a dictionary:</p>\n\n<pre><code>Dim dict As Object\nSet dict = CreateObject(\"Scripting.Dictionary\")\n\ndict.Add \"TA\", 1\ndict.Add \"TB\", 2\ndict.Add \"TC\", 3\nb=2\n\nMessageBox.Show(B*(dict(\"T\" &amp; \"B\")))\n</code></pre>\n\n<p>That <code>\"T\" &amp; \"B\"</code> gets concatenated together to be <code>\"TB\"</code> and then it fetches the <code>value</code> at <code>key</code> <code>\"TB\"</code> in your dictionary <code>dict</code> which is <code>2</code> and does the math.</p>\n\n<p>The <code>Dictionary</code> is good to learn because it's crazy powerful. You can store anything in a dictionary (including other dictionaries), not just numeric and string values.</p>\n\n<p>Lastly, this example uses late-binding for the dictionary object which is nice, but you don't get code hints when you are writing your code and learning this from scratch without code hints is kind of garbagey.</p>\n\n<p>Instead go to Tools>>References and check the <em>Microsoft Scripting Runtime</em> box in the list. Then you can use your dictionary as if it were native:</p>\n\n<pre><code>Dim dict As Dictionary\nSet dict = New Dictionary\n\ndict.Add \"TA\", 1\n....\n</code></pre>\n\n<hr>\n\n<p>As for a solution with an array. Generally folks are asking something like:</p>\n\n<p>\"Why doesn't this work?\"</p>\n\n<pre><code>Dim var1, var2, var3, var4\nvar1=\"hi \"\nvar2=\"there \"\nvar3=\"what's \"\nvar4=\"up.\"\n\nFor i=1 to 4\n    output=output &amp; (var &amp; i)\nNext\n\nMsgBox(output)\n</code></pre>\n\n<p>Which is very similar to the question here. Instead of \"Dynamic variable\" we can use an array:</p>\n\n<pre><code>Dim arrayVar(1 to 4) As String\narrayVar(1)=\"hi \"\narrayVar(2)=\"there \"\narrayVar(3)=\"what's \"\narrayVar(4)=\"up.\"\n\nFor i=1 to 4\n    output=output &amp; arrayVar(i)\nNext\n\nMsgBox(output)\n</code></pre>\n"}], "owner": {"reputation": 423, "user_id": 9617806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213e6ed6dec56e82c94c39c004939579?s=128&d=identicon&r=PG&f=1", "display_name": "K-Doe", "link": "https://stackoverflow.com/users/9617806/k-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 52407109, "answer_count": 1, "score": 0, "last_activity_date": 1537364636, "creation_date": 1537363645, "question_id": 52407014, "link": "https://stackoverflow.com/questions/52407014/want-to-access-variable-by-its-name-with-string-value", "title": "Want to Access variable by its name with string value", "body": "<p>I want to get the value of a variable by constructing its name with two different strings. </p>\n\n<p>To break it down to the minimum:</p>\n\n<pre><code>TA = 1\nTB = 2\nTC = 3\nB = 2\n\nMessagebox.Show(B*(\"T\"+\"B\"))\n</code></pre>\n\n<p>I know this is minimal, and I don't want to use it in a complex code. I also know there are ways to do that, but I am working in an environment with minimal functions.  </p>\n\n<p>So is there an basic way to do this? </p>\n"}, {"tags": ["vba", "ms-word", "pdf-generation"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537362605, "post_id": 52406546, "comment_id": 91756992, "body": "Where is this option (&quot;Create bookmarks using:&quot;) found in Word?"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1537362623, "post_id": 52406546, "comment_id": 91757001, "body": "Have you tried recording the steps (whatever they are) as a macro?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537362772, "post_id": 52406546, "comment_id": 91757094, "body": "I think you&#39;re talking about an option that comes with  the <b>&quot;Microsoft PDF Add-In&quot;</b> (which appears to be no longer available, from Microsoft anyway).  Do you have this add-in?"}, {"owner": {"reputation": 2684, "user_id": 172467, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1786dd1f0387d28fddd675299f77c2df?s=128&d=identicon&r=PG", "display_name": "Iraklis", "link": "https://stackoverflow.com/users/172467/iraklis"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537363047, "post_id": 52406546, "comment_id": 91757269, "body": "@ashleedawg File -&gt; Save As -&gt; PDF (*.pdf) -&gt; More options.. -&gt; Options"}, {"owner": {"reputation": 2684, "user_id": 172467, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1786dd1f0387d28fddd675299f77c2df?s=128&d=identicon&r=PG", "display_name": "Iraklis", "link": "https://stackoverflow.com/users/172467/iraklis"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1537363214, "post_id": 52406546, "comment_id": 91757369, "body": "@CindyMeister yes have tried that, these option changes are not captured by the macro recording process."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1537399791, "post_id": 52406546, "comment_id": 91774515, "body": "Have you looked for it in the registry?"}, {"owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1537421620, "post_id": 52406546, "comment_id": 91779482, "body": "Which version of Microsoft Word do you use?"}, {"owner": {"reputation": 2684, "user_id": 172467, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1786dd1f0387d28fddd675299f77c2df?s=128&d=identicon&r=PG", "display_name": "Iraklis", "link": "https://stackoverflow.com/users/172467/iraklis"}, "reply_to_user": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "edited": false, "score": 0, "creation_date": 1537442713, "post_id": 52406546, "comment_id": 91790799, "body": "@BrunoBieri Word 2016"}], "answers": [{"tags": [], "owner": {"reputation": 7637, "user_id": 1306012, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/5a309f07bf7f23a6f176b8d57c22cc65?s=128&d=identicon&r=PG", "display_name": "Bruno Bieri", "link": "https://stackoverflow.com/users/1306012/bruno-bieri"}, "is_accepted": true, "score": 0, "last_activity_date": 1537970100, "last_edit_date": 1537970100, "creation_date": 1537444172, "answer_id": 52424521, "question_id": 52406546, "link": "https://stackoverflow.com/questions/52406546/how-to-use-vba-to-change-the-default-ms-word-2016-options-so-that-when-you-save/52424521#52424521", "title": "How to use VBA to change the default MS Word 2016 options so that when you save as PDF the headings are included as bookmarks?", "body": "<p>Since it's not reachable by VBA at the point of save a file as PDF I do not see it as possible to change that PDF saving option using only VBA.</p>\n\n<p>The only way I see you can reach the behavior you seek is as follow but need some special effort. You need to either create a VTSO addin or be able to have an extra marco file in the Microsoft Word Startup-Path so it will be loaded at Microsoft Word Startup.</p>\n\n<ul>\n<li>Re-implement your own \"Save\" behavior by overriding the Save functionality (<code>BeforeSave</code>) of Microsoft Word and provide it via your own Save-Button in the Microsoft Word-Menu described <a href=\"https://stackoverflow.com/questions/1887368/how-to-customize-save-behaviour-in-word-using-vsto\">here</a></li>\n</ul>\n"}], "owner": {"reputation": 2684, "user_id": 172467, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1786dd1f0387d28fddd675299f77c2df?s=128&d=identicon&r=PG", "display_name": "Iraklis", "link": "https://stackoverflow.com/users/172467/iraklis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 52424521, "answer_count": 1, "score": 0, "last_activity_date": 1537970100, "creation_date": 1537362244, "last_edit_date": 1537443292, "question_id": 52406546, "link": "https://stackoverflow.com/questions/52406546/how-to-use-vba-to-change-the-default-ms-word-2016-options-so-that-when-you-save", "title": "How to use VBA to change the default MS Word 2016 options so that when you save as PDF the headings are included as bookmarks?", "body": "<p>I'm using Microsoft Word 2016 and looking for a way to run a vba macro that will change the default option to <code>Create bookmarks using: Headings</code> when I save a document as PDF when I click on</p>\n\n<ol>\n<li>File -></li>\n<li>Save As -></li>\n<li>PDF (*.pdf) -></li>\n<li>More options.. -></li>\n<li>Options</li>\n</ol>\n\n<p><a href=\"https://i.stack.imgur.com/mtCSk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mtCSk.png\" alt=\"Create bookmarks using\"></a></p>\n\n<p>Note: The option is only available if you have a table of contents in the document.</p>\n\n<p><strong>The goal is that if a user chooses to save as PDF that option will be already checked.</strong></p>\n\n<hr>\n\n<p>I'm not asking how to do this manually, like in this <a href=\"https://superuser.com/questions/95222/from-word-to-pdf-including-bookmarks\">question</a></p>\n\n<p><strong><em>nor</em></strong> programmaticaly save to PDF using vba like <a href=\"http://www.msofficeforums.com/word-vba/32224-save-pdf-bookmarks.html\" rel=\"nofollow noreferrer\">here</a> or <a href=\"http://www.vbaexpress.com/forum/showthread.php?54602-Vba-code-to-save-document-as-pdf-using-document-property-text-and-rename-folder\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1537361799, "post_id": 52406352, "comment_id": 91756481, "body": "get rid of the <code>wbSource</code> in front of <code>shCurrency</code>. <code>shCurrency</code> already refers to a <code>Sheet</code> in <code>wbSource</code>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537362029, "post_id": 52406352, "comment_id": 91756647, "body": "Neither way will work if the workbook isn&#39;t <b>open</b>.  A clue is that the filename does not have a path... but even still this method won&#39;t work a closed workbook.  See: <a href=\"https://stackoverflow.com/a/27914490/8112776\">stackoverflow.com/a/27914490/8112776</a>"}, {"owner": {"reputation": 13, "user_id": 10329681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdea8bb4ada7d132c630ca51a99afaa6?s=128&d=identicon&r=PG&f=1", "display_name": "Cabouse", "link": "https://stackoverflow.com/users/10329681/cabouse"}, "edited": false, "score": 0, "creation_date": 1537362633, "post_id": 52406352, "comment_id": 91757005, "body": "Thank you BigBen ! it&#39;s been two hours since I was stuck on it."}], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1537363005, "creation_date": 1537363005, "answer_id": 52406772, "question_id": 52406352, "link": "https://stackoverflow.com/questions/52406352/change-a-cell-of-a-different-workbook/52406772#52406772", "title": "Change a cell of a different workbook", "body": "<p>Get rid of the <code>wbSource</code> in front of <code>shCurrency</code>. <code>shCurrency</code> already refers to a <code>Sheet</code> in <code>wbSource</code>. </p>\n\n<pre><code>Sub test()\n    Dim wbSource As Workbook\n    Dim shCurrency As Worksheet\n    Set wbSource = Workbooks(\"BP19.xls\")\n    Set shCurrency = wbSource.Sheets(\"KPI\") \n\n    shCurrency.Range(\"A6\") = \"LC\" \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10329681, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdea8bb4ada7d132c630ca51a99afaa6?s=128&d=identicon&r=PG&f=1", "display_name": "Cabouse", "link": "https://stackoverflow.com/users/10329681/cabouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 52406772, "answer_count": 1, "score": 1, "last_activity_date": 1549396978, "creation_date": 1537361612, "last_edit_date": 1549396978, "question_id": 52406352, "link": "https://stackoverflow.com/questions/52406352/change-a-cell-of-a-different-workbook", "title": "Change a cell of a different workbook", "body": "<p>I try to change the cell \"A6\" of a different workbook, so I wrote this code but it doesn't work I don't know why, I tried different code but it still doesn't work, do you know why ?</p>\n\n<p>Thank you</p>\n\n<pre><code> Sub test()\n    Dim wbSource As Workbook\n    Dim shCurrency As Worksheet\n    Set wbSource = Workbooks(\"BP19.xls\")\n    Set shCurrency = wbSource.Sheets(\"KPI\")\n\n       wbSource.shCurrency.Range(\"A6\") = \"LC\"\n\nEnd Sub\n</code></pre>\n\n<p>But it work when I put this </p>\n\n<pre><code> Workbooks(\"BP19.xls\").Worksheets(\"KPI\").Range(\"A6\") = \"EUR\"\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 71, "user_id": 2275083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f151a60e7bc28fc2d91c20234caa7780?s=128&d=identicon&r=PG", "display_name": "Manuel Isern", "link": "https://stackoverflow.com/users/2275083/manuel-isern"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537362239, "post_id": 52406282, "comment_id": 91756802, "body": "Maybe there&#39;s nothing wrong with my code, but I want to make sure."}, {"owner": {"reputation": 71, "user_id": 2275083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f151a60e7bc28fc2d91c20234caa7780?s=128&d=identicon&r=PG", "display_name": "Manuel Isern", "link": "https://stackoverflow.com/users/2275083/manuel-isern"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537362298, "post_id": 52406282, "comment_id": 91756835, "body": "I cannot use rules for that mailbox and my macros are used by several support agents."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1537375590, "post_id": 52406282, "comment_id": 91765001, "body": "No hint of code to delete mail here. Put in a breakpoint and see if other code runs."}, {"owner": {"reputation": 71, "user_id": 2275083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f151a60e7bc28fc2d91c20234caa7780?s=128&d=identicon&r=PG", "display_name": "Manuel Isern", "link": "https://stackoverflow.com/users/2275083/manuel-isern"}, "reply_to_user": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1537381746, "post_id": 52406282, "comment_id": 91767971, "body": "We tried with another co-worker. In his Outlook, it creates copy and move it to the REQUESTS folder and keep the original tagged in the Inbox. Mine, instead of keeping a copy in the Inbox, it sends the original to the deleted folder. What it should do is to move the item to the REQUESTS folder without leaving a copy anywhere."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1537443820, "post_id": 52406282, "comment_id": 91791474, "body": "I notice you use <code>On Error Resume Next</code> without checking <code>Err.Num</code>.  Used like this it means: &quot;Don&#39;t bother telling me about any errors because I like obscure failure.&quot;"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1537444073, "post_id": 52406282, "comment_id": 91791623, "body": "If <code>ObjFolder Is Nothing</code>, you do not exit so later code will attempt to move the item to <code>Nothing</code>.  Perhaps you should investigate the effect of this particularly since you like ignoring errors."}], "answers": [{"tags": [], "owner": {"reputation": 828, "user_id": 10252988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047bac7a125b9725dc9a257f8f0e0266?s=128&d=identicon&r=PG&f=1", "display_name": "Alina Li", "link": "https://stackoverflow.com/users/10252988/alina-li"}, "is_accepted": false, "score": 1, "last_activity_date": 1537435846, "creation_date": 1537435846, "answer_id": 52421853, "question_id": 52406282, "link": "https://stackoverflow.com/questions/52406282/outlook-macro-to-move-emails-sends-a-copy-to-the-delete-folder/52421853#52421853", "title": "Outlook Macro to move emails sends a copy to the delete folder", "body": "<p>1.You could check your mail Rules and have a look whether rules been deleted or not.</p>\n\n<p><a href=\"https://i.stack.imgur.com/Q7AKd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Q7AKd.png\" alt=\"enter image description here\"></a></p>\n\n<p>2.You could check Outlook add-in and have a look whether email add-ins has been deleted.</p>\n\n<p><a href=\"https://i.stack.imgur.com/K9MtP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K9MtP.png\" alt=\"enter image description here\"></a></p>\n\n<p>3.You can switch account and check for same situation happened on other accounts.</p>\n"}], "owner": {"reputation": 71, "user_id": 2275083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f151a60e7bc28fc2d91c20234caa7780?s=128&d=identicon&r=PG", "display_name": "Manuel Isern", "link": "https://stackoverflow.com/users/2275083/manuel-isern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592942336, "creation_date": 1537361408, "last_edit_date": 1592942336, "question_id": 52406282, "link": "https://stackoverflow.com/questions/52406282/outlook-macro-to-move-emails-sends-a-copy-to-the-delete-folder", "title": "Outlook Macro to move emails sends a copy to the delete folder", "body": "<p>I created a series of macros in Outlook to handle emails we receive from our support clients.\nBasically, there are 3 macros:</p>\n\n<ol>\n<li>Called Incident that simply tags the email with my initials and paste the ticket number I created from the clipboard</li>\n<li>Called Request that tags the email with my initials between brackets and move it to a folder named Requests</li>\n<li>Called Update to requests that tags the email with the text  $UPDATE TO REQUEST$ plus my initials: $UPDATE TO REQUEST$ (DR) -</li>\n</ol>\n\n<p>All were working fine but since a few weeks, a copy is also sent to the delete folder and in some cases, it goes straight to that delete folder without a copy to the intended one.</p>\n\n<p>The mailbox the macros work with is a IMAP mailbox we have in Outlook in addition to our personal mailbox using Exchange server.\nI don't understand why is doing that suddenly.</p>\n\n<pre><code>Option Explicit\n\nSub AddFileNumber()\n    'add initials to the email header\n    Dim myolApp As Outlook.Application\n    Dim aItem As Object\n\n    Set myolApp = CreateObject(\"Outlook.Application\")\n    Set aItem = myolApp.ActiveExplorer.Selection.Item(1)\n\n    Dim iItemsUpdated As Integer\n    Dim strTemp As String\n    Dim strFilenum As Variant\n\n    strFilenum = \"(DR) - \"\n    If strFilenum = False Then Exit Sub\n    If strFilenum = \"\" Then Exit Sub\n\n    strTemp = \"\" &amp; strFilenum &amp; \"\" &amp; aItem.Subject\n    aItem.Subject = strTemp\n    aItem.Save\nEnd Sub\n\nFunction GetCurrentItem() As Object\n    Dim objApp As Outlook.Application\n    Set objApp = Application\n    On Error Resume Next\n    Select Case TypeName(objApp.ActiveWindow)\n    Case \"Explorer\"\n        Set GetCurrentItem = _\n        objApp.ActiveExplorer.Selection.Item(1)\n    Case \"Inspector\"\n        Set GetCurrentItem = _\n        objApp.ActiveInspector.CurrentItem\n    Case Else\n    End Select\nEnd Function\n\nSub MasterMacro()\n    'add the initials and move the email to the selected folder\n    Call Request.AddFileNumber\n    Call Request.MoveSelectedMessagesToFolder\nEnd Sub\n\nOption Explicit\n\nSub UpdateRequest()\n    ' adds $UPDATE TO REQUEST$ and initials to the email header\n    Dim myolApp As Outlook.Application\n    Dim aItem As Object\n\n    Set myolApp = CreateObject(\"Outlook.Application\")\n    Set aItem = myolApp.ActiveExplorer.Selection.Item(1)\n\n    Dim iItemsUpdated As Integer\n    Dim strTemp As String\n    Dim strFilenum As Variant\n\n    strFilenum = \"$UPDATE TO REQUEST$ (DR) - \"\n    If strFilenum = False Then Exit Sub\n    If strFilenum = \"\" Then Exit Sub\n\n    strTemp = \"\" &amp; strFilenum &amp; \"\" &amp; aItem.Subject\n    aItem.Subject = strTemp\n    aItem.Save\nEnd Sub\n\nOption Explicit\n\nSub MoveSelectedMessagesToFolder()\n\n    On Error Resume Next\n    Dim objFolder As Outlook.MAPIFolder, objInbox As Outlook.MAPIFolder\n    Dim objNS As Outlook.NameSpace, objItem As Outlook.MailItem\n\n    Set objNS = Application.GetNamespace(\"MAPI\")\n    Set objInbox = objNS.GetDefaultFolder(olFolderInbox)\n    Set objFolder = objNS.Folders.Item(\"DOJ Helpdesk\") _\n        .Folders.Item(\"Inbox\").Folders.Item(\"REQUESTS\")\n\n    If objFolder Is Nothing Then\n        MsgBox \"This folder doesn't exist!\", vbOKOnly _\n            + vbExclamation, \"INVALID FOLDER\"\n    End If\n\n    If Application.ActiveExplorer.Selection.Count = 0 Then\n\n        Exit Sub\n    End If\n    For Each objItem In Application.ActiveExplorer.Selection\n        If objFolder.DefaultItemType = olMailItem Then\n            If objItem.Class = olMail Then\n                objItem.Move objFolder\n                objItem.UnRead = True\n                objItem.Save\n            End If\n        End If\n    Next\n\nEnd Sub\n\nSub MasterUpdate()\n    ' call both modules above\n    Call Request.UpdateRequest\n    Call Request.MoveSelectedMessagesToFolder\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1537361729, "post_id": 52406275, "comment_id": 91756429, "body": "Is there more than one worksheet open? Try  ThisWorkbook.Sheets(&quot;temp&quot;).Hpagebreaks.count"}, {"owner": {"reputation": 23, "user_id": 8927632, "user_type": "registered", "profile_image": "https://graph.facebook.com/1336331346476033/picture?type=large", "display_name": "Fox Feng", "link": "https://stackoverflow.com/users/8927632/fox-feng"}, "reply_to_user": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 0, "creation_date": 1537362730, "post_id": 52406275, "comment_id": 91757067, "body": "Hi Harassed Dad, no there&#39;s only one workbook opened. I&#39;ve tried using &quot;ThisWorkbook.&quot;, but same error comes up."}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 8927632, "user_type": "registered", "profile_image": "https://graph.facebook.com/1336331346476033/picture?type=large", "display_name": "Fox Feng", "link": "https://stackoverflow.com/users/8927632/fox-feng"}, "is_accepted": false, "score": 0, "last_activity_date": 1537444713, "creation_date": 1537444713, "answer_id": 52424687, "question_id": 52406275, "link": "https://stackoverflow.com/questions/52406275/method-count-of-object-hpagebreaks-failed/52424687#52424687", "title": "Method &#39;Count&#39; of object &#39;HPageBreaks&#39; failed", "body": "<p>The question is now resolved by activate other sheet and re-active sheets(\"Temp\") before every HPageBreaks.Count will make the error gone.\nApplication.ScreenUpdate must be set to False</p>\n"}], "owner": {"reputation": 23, "user_id": 8927632, "user_type": "registered", "profile_image": "https://graph.facebook.com/1336331346476033/picture?type=large", "display_name": "Fox Feng", "link": "https://stackoverflow.com/users/8927632/fox-feng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594051046, "creation_date": 1537361394, "last_edit_date": 1594051046, "question_id": 52406275, "link": "https://stackoverflow.com/questions/52406275/method-count-of-object-hpagebreaks-failed", "title": "Method &#39;Count&#39; of object &#39;HPageBreaks&#39; failed", "body": "<p>I am having a problem with MS Excel VBA on HPageBreaks.\nThe Sheets(\"Temp\").HPagesBreaks.Count works fine when I run the code line by line in testing. But when I tried to run the full code, my Excel gets frozen and an error message pops up when I tried to close Excel.</p>\n\n<p>There was a similar question a couple years back, by suggesting activate Sheets(\"Temp\") before count method. \nI've tried Sheets(\"Temp\").Activate before HPageBreaks.Count, but it doesn't work in my scenario.</p>\n\n<p>Here's part of my code, and the error message.\nI want to resize all shapes in the sheet, until they are all fit into one page.\nPrint Settings are pre-set.\nDoes anyone know what caused it?\n<a href=\"https://i.stack.imgur.com/iSP6m.jpg\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<pre><code>Do Until ((xWMax &gt; 600 And xWMax &lt;= 680) Or xH &gt; 600) And Sheets(\"Temp\").HPageBreaks.Count = 0\nIf Sheets(\"Temp\").HPageBreaks.Count &gt; 0 Then\n    ....\nEnd If\n</code></pre>\n\n<p>Loop</p>\n"}, {"tags": ["excel", "vba", "boolean", "array-formulas"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1537361313, "post_id": 52406053, "comment_id": 91756140, "body": "I&#39;d suggest that before implementing this formula is VBA, you get it working on the worksheet. (<code>=SUMPRODUCT(IFERROR(FIND(tblDescriptionFilters[Description Filters], OFFSET($D$2, SUM(ROW())-2, 0)), 0))&gt;0</code>)  Since it&#39;s not being changed in any way by VBA it should work as-is on the worksheet, which is does not. One issue, <code>IFERROR</code> does not have a &quot;value if error&quot;. (Maybe your brackets aren&#39;t lined up properly?)"}, {"owner": {"reputation": 53, "user_id": 5194761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4VLXN.jpg?s=128&g=1", "display_name": "Felix_Dragonhammer", "link": "https://stackoverflow.com/users/5194761/felix-dragonhammer"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537361493, "post_id": 52406053, "comment_id": 91756254, "body": "When I first developed it, I developed it in the worksheet first, then implemented it with vba. Also as I mentioned, when I use the fill handle to duplicate the formula in the adjacent column, it works perfectly."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537361644, "post_id": 52406053, "comment_id": 91756374, "body": "If the formula doesn&#39;t work even without VBA (directly on the worksheet) then <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a> isn&#39;t the issue ,and this is an <a href=\"https://stackoverflow.com/questions/tagged/excel-formula\">excel-formula</a> question, right? (So the question is tagged incorrectly). In order to help with the formula, it would be helpful to see some sample data... but the first step should be <i>simplifying</i> the formula. For example, get just the <code>FIND</code> portion working first."}, {"owner": {"reputation": 53, "user_id": 5194761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4VLXN.jpg?s=128&g=1", "display_name": "Felix_Dragonhammer", "link": "https://stackoverflow.com/users/5194761/felix-dragonhammer"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537362221, "post_id": 52406053, "comment_id": 91756788, "body": "... But I just said the formula works perfectly when I duplicate/fill handle/copy &amp; paste the formula from the column generated by vba into an adjacent column."}, {"owner": {"reputation": 53, "user_id": 5194761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4VLXN.jpg?s=128&g=1", "display_name": "Felix_Dragonhammer", "link": "https://stackoverflow.com/users/5194761/felix-dragonhammer"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537363764, "post_id": 52406053, "comment_id": 91757754, "body": "I&#39;ve added a values only version for the formula. As I&#39;ve pointed out, when generated by vba it will evaluate correctly. I will work on creating a jpg that shows the formula evaluation for both the vba and non vba formulas to demonstrate I&#39;m not crazy."}, {"owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "edited": false, "score": 1, "creation_date": 1537373684, "post_id": 52406053, "comment_id": 91764022, "body": "One thing that will cause problems if you&#39;re not putting the VBA formula onto the activesheet is that <code>.Range</code> and <code>.UsedRange</code> is looking at the sheet referenced in the <code>With</code> statement, but <code>Cells</code> is only looking at the activesheet (there&#39;s no <code>.</code>)."}], "owner": {"reputation": 53, "user_id": 5194761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4VLXN.jpg?s=128&g=1", "display_name": "Felix_Dragonhammer", "link": "https://stackoverflow.com/users/5194761/felix-dragonhammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537363694, "creation_date": 1537360656, "last_edit_date": 1537363694, "question_id": 52406053, "link": "https://stackoverflow.com/questions/52406053/boolean-logic-not-working-in-array-formula-created-with-vba", "title": "Boolean logic not working in array formula created with vba", "body": "<p>I have a line of code in a vba script that creates an array formula in a column:<br/></p>\n\n<pre><code>.Range(Cells(2, .UsedRange.Columns.Count + 1), Cells( _\n    .UsedRange.Rows.Count, .UsedRange.Columns.Count + 1)) _\n    .FormulaArray = \"=SUMPRODUCT(IFERROR(FIND(tblDescriptionFilters\" &amp; _\n    \"[Description Filters], OFFSET($D$2, SUM(ROW())-2, 0)), 0))&gt;0\"\n</code></pre>\n\n<p>Example formula with values:</p>\n\n<pre><code>{=SUMPRODUCT( _\nIFERROR(FIND({\"DS\",\"DISCO\",\"DOTCOM\"}, \"[Redacted Stuff]DS [Redacted Stuff]\"), 0))&gt;0}\n</code></pre>\n\n<p>(Interestingly enough, when I use vba to input the values formula, it evaluates correctly).</p>\n\n<p>The problem is that the formula is always returning false, even when it shouldn't. Case in point, by using the formula evaluation tool I observed an instance in which 4>0 returned false. When I used the fill handle to copy the formula into the adjacent column, the formula evaluates correctly (ie 4>0 returns true).</p>\n\n<p>Besides that the one column was entered with vba, the only discernible difference is that when I try to make changes to one of the formulas in the vba range, I get the error message \"You can't change part of an array.\"</p>\n\n<p>I'm using Excel 2016. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 23, "user_id": 10385592, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s0Zz1PUWTRs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOY8H0cFX8v3hm5OyYFsZUYPHDvCA/mo/photo.jpg?sz=128", "display_name": "Elesmera", "link": "https://stackoverflow.com/users/10385592/elesmera"}, "edited": false, "score": 0, "creation_date": 1537360476, "post_id": 52405947, "comment_id": 91755665, "body": "Sorry I forgot to add: On Error GoTo ErrorHandler1 does not seem to work"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 2, "creation_date": 1537360705, "post_id": 52405947, "comment_id": 91755813, "body": "It&#39;s difficult or impossible to troubleshoot an issue without all of the related code (and example data, usually). I don&#39;t know which line you&#39;re getting the error on, what&#39;s in any of the cells, or the values of the variables -- all of which could be clues at to where your bug lies.  If I had to guess based on common mistakes, I&#39;d guess that <code>i</code> is zero when this loop starts, and if so, you should set it to a starting value (ie, <code>i=1</code>) before the loop starts (since there is no &quot;row zero&#39;.)"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537361350, "post_id": 52405947, "comment_id": 91756166, "body": "Don&#39;t worry. As soon as you have fool-proof code, they&#39;ll invent a better fool!"}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1537361903, "post_id": 52405947, "comment_id": 91756563, "body": "I see <code>On Error GoTo ResumeReporting</code>. Where is <code>ResumeReporting</code> in your code? With error handling in VBA, you have to have a <code>Resume</code> statement before the code will start &quot;catching&quot; errors again, instead of breaking."}, {"owner": {"reputation": 23, "user_id": 10385592, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s0Zz1PUWTRs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOY8H0cFX8v3hm5OyYFsZUYPHDvCA/mo/photo.jpg?sz=128", "display_name": "Elesmera", "link": "https://stackoverflow.com/users/10385592/elesmera"}, "edited": false, "score": 0, "creation_date": 1537362790, "post_id": 52405947, "comment_id": 91757104, "body": "The <code>On Error GoTo resumeReporting</code> is not necessary, sorry I posted the wrong bit of code, I am trying to get it to work."}], "answers": [{"tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": false, "score": 0, "last_activity_date": 1537364013, "creation_date": 1537364013, "answer_id": 52407139, "question_id": 52405947, "link": "https://stackoverflow.com/questions/52405947/skip-loop-when-vba/52407139#52407139", "title": "Skip loop when VBA", "body": "<p>Put this in a comment first but had more to say than comment would allow.</p>\n\n<p>Are you sure you mean <code>.SpecialCells(xlCellTypeConstants, xlErrors)</code> and not <code>.SpecialCells(xlCellTypeFormulas, xlErrors)</code> ?  Also might simply want to check to make sure the specialcell intersect is not nothing before attempting to delete it.</p>\n\n<p>I get 1004 error with <code>xlCelltypeConstants</code> but <code>xlCellTypeFormulas</code> works for me if I put <code>=na()</code> in one of the intersecting cells.</p>\n\n<pre><code>If Not Intersect(Columns(\"A\"), ActiveSheet.UsedRange).SpecialCells(xlCellTypeFormulas, xlErrors) Is Nothing Then\n    Intersect(Columns(\"A\"), ActiveSheet.UsedRange).SpecialCells(xlCellTypeFormulas, xlErrors).EntireRow.Delete\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10385592, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-s0Zz1PUWTRs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOY8H0cFX8v3hm5OyYFsZUYPHDvCA/mo/photo.jpg?sz=128", "display_name": "Elesmera", "link": "https://stackoverflow.com/users/10385592/elesmera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537957480, "creation_date": 1537360317, "last_edit_date": 1537957480, "question_id": 52405947, "link": "https://stackoverflow.com/questions/52405947/skip-loop-when-vba", "title": "Skip loop when VBA", "body": "<p>I am trying to make a fool-proof tool to report results at my place of work. In order to do this the macro needs to accept .csv files which will be processed by the macro. No problems so far. I got it working as I intended, maybe not completely according to VBA programmers' standards, but working. </p>\n\n<p>However there is one point I struggle with at the moment. Column A and E need to be aligned as this will subsequent processing of results easier for colleagues when using the macro. </p>\n\n<p>There are 3 different scenarios possible of which i got two working.</p>\n\n<ol>\n<li>2 sets of results need to be aligned on the same row (column A and E are (partially filled) (Macro working)</li>\n<li>1 set of results alignment not needed as only column A is filled (Macro working)</li>\n<li>1 set of results alignment not needed as only column E should be filled (Macro not working)</li>\n</ol>\n\n<p>Column A and E are fixed for the specific results I want to allocate to those columns.</p>\n\n<p>I get a runtime error 1004 'no cells were found', please see below the code I have been using.</p>\n\n<pre><code>Sub Report()\n\n\nDim csvFileName As Variant\nDim destCell As Range\nDim rdata As Worksheet\nDim Test1Test2reportxl As Workbook\nDim tTest2 As Worksheet\nDim tTest1 As Worksheet\n\nFor Each aSheet In Worksheets\n\nSet Test1Test2reportxl = ThisWorkbook\n'Hide sheet\n' Set Generate = Sheets(\"Generate\")\n' Generate.Visible = False\n\n\n'Delete previous sheets with same name\nSelect Case aSheet.Name\n\n    Case \"rdata\"\n        Application.DisplayAlerts = False\n        aSheet.Delete\n        Application.DisplayAlerts = True\n\n    Case \"Test1Test2report\"\n        Application.DisplayAlerts = False\n        aSheet.Delete\n        Application.DisplayAlerts = True\n\n    Case \"tTest2\"\n        Application.DisplayAlerts = False\n        aSheet.Delete\n        Application.DisplayAlerts = True\n\n    Case \"tTest1\"\n        Application.DisplayAlerts = False\n        aSheet.Delete\n        Application.DisplayAlerts = True\n\n\n\n    Case \"TitlePage\"\n        Application.DisplayAlerts = False\n        aSheet.Delete\n        Application.DisplayAlerts = True\n\nEnd Select\n\nApplication.ScreenUpdating = False\n\n\n'Add new Test1Test2report and rdata sheet\n\nNext\n\nDim wb12 As Workbook\nDim ws12 As Worksheet, wsNEW As Worksheet\nDim Test1Test2report As String\n\n'checking if sheet already exists in workbook\nSet wb12 = ActiveWorkbook\n\nFor Each ws12 In wb12.Worksheets\n    If ws12.Name = \"Test1Test2report\" Then\n        Exit Sub\n    End If\nNext ws12\n\nSheets(\"Template\").Visible = True\n\nWorksheets(\"Template\").Copy After:=Worksheets(Worksheets.Count) 'move to end\n\nSet wsNEW = ActiveSheet\n\nwsNEW.Name = \"Test1Test2report\"\n\nSheets(\"Template\").Visible = False\n\n'MsgBox (\"Working so far!\")\n'new sheet required\n\n\n\nSheets.Add(After:=Sheets(Sheets.Count)).Name = \"rdata\"\nSheets.Add(After:=Sheets(Sheets.Count)).Name = \"tTest2\"\nSheets.Add(After:=Sheets(Sheets.Count)).Name = \"tTest1\"\n\n 'Import .csv file data\n\nSet destCell = Worksheets(\"rdata\").Cells(Rows.Count, \n\"A\").End(xlUp).Offset(1)      'CHANGE SHEET NAME\nChDrive \"H:\\\"\n    ChDir \"H:\\Virology Shared Documents\\Artus Test1 PCR results\\CSV \n Test1Test2 PCR\"\ncsvFileName = Application.GetOpenFilename(fileFilter:=\"CSV Files \n(*.csv),*.csv\", Title:=\"Select a CSV File\", MultiSelect:=False)\n    If csvFileName = False Then\n\n\n    Application.DisplayAlerts = False\n    Worksheets(\"rdata\").Delete\n    Worksheets(\"tTest2\").Delete\n    Worksheets(\"tTest1\").Delete\n    Worksheets(\"Test1Test2report\").Delete\n    Application.DisplayAlerts = True\n\n    MsgBox \"File select was stopped, because you did not select the right \n    file type :-(, please select the right CSV file to proceed!\"\n\n    Exit Sub\n\nEnd If\n\nWith destCell.Parent.QueryTables.Add(Connection:=\"TEXT;\" &amp; csvFileName, \nDestination:=destCell)\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited\n    .TextFileCommaDelimiter = True\n    .Refresh BackgroundQuery:=False\nEnd With\n\ndestCell.Parent.QueryTables(1).Delete\n\n' Hide columns in rdata sheet\n\nSet rdata = Sheets(\"rdata\")\n\nRange(\"D:D, H:L\").EntireColumn.Hidden = True\nrdata.Visible = True\n\n' Add headers to Test1Test2report sheet\n\nSheets(\"Generate\").Range(\"A1:D1\").Copy Sheets(\"tTest1\").Range(\"A1:D1\")\nSheets(\"Generate\").Range(\"A2:D2\").Copy Sheets(\"tTest2\").Range(\"A1:D1\")\nSheets(\"Generate\").Range(\"A4:I4\").Copy \nSheets(\"Test1Test2report\").Range(\"A1:I1\")\n\n    'Test1 data selection and copy to tTest1 sheet\n\nSheets(\"rdata\").Select\n\nOn Error GoTo Test2\n\nIf Cells.Find(What:=\"range test 1)\", _\nAfter:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\nxlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n, SearchFormat:=False).Activate Then\n\nActiveCell.Offset(3, 1).Select\n\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nSheets(\"tTest1\").Select\nRange(\"A2\").Select\nActiveSheet.Paste\n\nSheets(\"rdata\").Select\nSelection.Offset(0, 1).Select\nSelection.Copy\nSheets(\"tTest1\").Select\nRange(\"D2\").Select\nActiveSheet.Paste\n\nEnd If\n\nSheets(\"rdata\").Select\n\nOn Error GoTo Test2\n\nIf Cells.Find(What:=\"2nd range test 1)\", _\nAfter:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\nxlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n, SearchFormat:=False).Activate Then\n\nActiveCell.Offset(3, 1).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Offset(0, 1).Select\nSelection.Copy\nSheets(\"tTest1\").Select\nRange(\"C2\").Select\nActiveSheet.Paste\n\nSheets(\"rdata\").Select\nSelection.Offset(0, 3).Select\nSelection.Copy\nSheets(\"tTest1\").Select\nRange(\"B2\").Select\nActiveSheet.Paste\n\n\n\nEnd If\n\n 'Test2 data selection and copy to tTest2 sheet\n\n\nSheets(\"rdata\").Select\n\n   Test2:\n\nOn Error GoTo SheetSelect\n\nIf Cells.Find(What:=\"range test 2)\", _\nAfter:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\nxlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n, SearchFormat:=False).Activate Then\n\nActiveCell.Offset(3, 1).Select\n\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nSheets(\"tTest2\").Select\nRange(\"A2\").Select\nActiveSheet.Paste\n\nSheets(\"rdata\").Select\nSelection.Offset(0, 1).Select\nSelection.Copy\nSheets(\"tTest2\").Select\nRange(\"D2\").Select\nActiveSheet.Paste\n\nEnd If\n\n\nSheets(\"rdata\").Select\n\nOn Error GoTo SheetSelect\n\nIf Cells.Find(What:=2nd range test 2)\", _\nAfter:=ActiveCell, LookIn:=xlFormulas, LookAt:= _\nxlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _\n, SearchFormat:=False).Activate Then\n\nActiveCell.Offset(3, 1).Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Offset(0, 1).Select\nSelection.Copy\nSheets(\"tTest2\").Select\nRange(\"C2\").Select\nActiveSheet.Paste\n\nSheets(\"rdata\").Select\nSelection.Offset(0, 3).Select\nSelection.Copy\nSheets(\"tTest2\").Select\nRange(\"B2\").Select\nActiveSheet.Paste\n\nEnd If\n\nIf Err.Number &lt;&gt; 0 Then\n\n    Application.DisplayAlerts = False\n    Worksheets(\"rdata\").Delete\n    Worksheets(\"tTest2\").Delete\n    Worksheets(\"tTest1\").Delete\n    Worksheets(\"Test1Test2report\").Delete\n    Application.DisplayAlerts = True\n\n    MsgBox \"You did not select a Test1/Test2 PCR .csv file, please try \n    again!\"\n\nEnd If\n\nResume\n\n    ' Select data tTest1/tTest2 and copy to Test1Test2report sheet\n\nSheetSelect:\n\nSheets(\"tTest1\").Select\n\nWith Worksheets(\"tTest1\")\nlastrow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n.Range(\"A2:D\" &amp; lastrow).Select\n\nSelection.Copy\n\nSheets(\"Test1Test2report\").Select\nRange(\"A2\").Select\nActiveSheet.Paste\n\nEnd With\n\nSheets(\"tTest2\").Select\n\nWith Worksheets(\"tTest2\")\nlastrow = .Cells(Rows.Count, \"A\").End(xlUp).Row\n.Range(\"A2:D\" &amp; lastrow).Select\n\nSelection.Copy\n\nSheets(\"Test1Test2report\").Select\nRange(\"E2\").Select\nActiveSheet.Paste\n\nEnd With\n\n 'Hide data sheets\n\n'Application.DisplayAlerts = False\n\n'Set tTest1 = Sheets(\"tTest1\")\n'tTest1.Visible = False\n\n'Set tTest2 = Sheets(\"tTest2\")\n'tTest2.Visible = False\n\n'Set rdata = Sheets(\"rdata\")\n'rdata.Visible = False\n\n'Application.DisplayAlerts = True\n\n'Summary:   Align codes in columns C and D removing all D values not in C\nDim i As Long, lr As Long\n\nApplication.ScreenUpdating = False\n\n     'Last row with data in column F\nlr = Range(\"F\" &amp; Rows.Count).End(xlUp).Row\n\n    'Sort both section so numbers are ascending in E and F\nColumns(\"A:D\").Sort Key1:=Range(\"A2\"), Order1:=xlAscending, _\n    Header:=xlYes, OrderCustom:=1, MatchCase:=False, _\n    Orientation:=xlTopToBottom, DataOption1:=xlSortNormal\nColumns(\"E:H\").Sort Key1:=Range(\"E2\"), Order1:=xlAscending, _\n    Header:=xlYes, OrderCustom:=1, MatchCase:=False, _\n    Orientation:=xlTopToBottom, DataOption1:=xlSortNormal\n\n  'line up remaining items so A lines up with E\n\ni = 2\nDo\n    If Cells(i, \"A\") &gt; Cells(i, \"E\") And Cells(i, \"E\") &gt; \"\" Then\n        Cells(i, \"A\").Resize(1, 4).Insert xlShiftDown\n    ElseIf Cells(i, \"A\") &lt; Cells(i, \"E\") And Cells(i, \"A\") &gt; \"\" Then\n        Cells(i, \"E\").Resize(1, 4).Insert xlShiftDown\n    End If\n    i = i + 1\nLoop Until Cells(i, \"A\") = \"\" And Cells(i, \"E\") = \"\"\n    With Intersect(Columns(\"A\"), ActiveSheet.UsedRange)\n    .Replace \"QS*\", \"#N/A\", xlPart\n    On Error Resume Next\n    .SpecialCells(xlCellTypeConstants, xlErrors).EntireRow.Delete\n    On Error GoTo 0\n\n    End With\n</code></pre>\n\n<p><code>.SpecialCells(xlConstants, xlErrors).EntireRow.Delete</code> is causing the error and Google has not been so kind so far to help me to work out an appropriate answer for this. </p>\n"}, {"tags": ["excel", "vba", "for-loop", "controls"], "comments": [{"owner": {"reputation": 1914, "user_id": 5545882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0cfddb5635f1eaceb45a3b048860728a?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/5545882/zac"}, "edited": false, "score": 0, "creation_date": 1537359172, "post_id": 52405443, "comment_id": 91754913, "body": "Any particular reason why you would want them in <code>an order of reading</code>? Also, not sure what you mean by <code>an order of reading</code>?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 2, "creation_date": 1537359580, "post_id": 52405443, "comment_id": 91755153, "body": "I think it&#39;s about the sequence. AFAIK the <code>For each loop</code> just goes through the controls as they were added and you can&#39;t change that."}, {"owner": {"reputation": 81, "user_id": 4907523, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7015c21fd09c8e71d3ba0734c583da44?s=128&d=identicon&r=PG&f=1", "display_name": "ArnaudTheDevelopper", "link": "https://stackoverflow.com/users/4907523/arnaudthedevelopper"}, "edited": false, "score": 0, "creation_date": 1537360305, "post_id": 52405443, "comment_id": 91755541, "body": "Thanks for the response, Indeed it&#39;s about the sequence"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 1, "creation_date": 1537360622, "post_id": 52405443, "comment_id": 91755755, "body": "If you really need to process them in a specific order, you could make a dictionary in your <code>For Each</code> loop, sort the dictionary, then do the processing in dictionary sorted order."}], "answers": [{"tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": true, "score": 3, "last_activity_date": 1537368073, "creation_date": 1537368073, "answer_id": 52408480, "question_id": 52405443, "link": "https://stackoverflow.com/questions/52405443/display-controls-with-order-during-for-next-loop-vba/52408480#52408480", "title": "Display controls with order during For-Next loop vba", "body": "<p>One way to do this is to sort them by the TabIndex property. Set the tab indices to the desired order, then use this:</p>\n\n<pre><code>Private Sub test()\n\n    Dim cCont As Control\n    Dim i As Integer\n    Dim maxIndex As Integer\n    Dim controls As Object\n    Dim key As Variant\n\n    Set controls = CreateObject(\"Scripting.Dictionary\")\n\n    'Add controls to dictionary, key by tabindex property\n    For Each cCont In Me.controls\n        maxIndex = IIf(maxIndex &lt; cCont.TabIndex, cCont.TabIndex, maxIndex)\n        controls.Add cCont.TabIndex, cCont\n    Next cCont\n\n    'Get controls in order\n    For i = 0 To maxIndex\n        If controls.exists(i) Then\n            MsgBox controls(i).Name\n        End If\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 4907523, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/7015c21fd09c8e71d3ba0734c583da44?s=128&d=identicon&r=PG&f=1", "display_name": "ArnaudTheDevelopper", "link": "https://stackoverflow.com/users/4907523/arnaudthedevelopper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 1, "accepted_answer_id": 52408480, "answer_count": 1, "score": 1, "last_activity_date": 1537368073, "creation_date": 1537358586, "question_id": 52405443, "link": "https://stackoverflow.com/questions/52405443/display-controls-with-order-during-for-next-loop-vba", "title": "Display controls with order during For-Next loop vba", "body": "<p>I have a VBA application with a lot of controls.\nI would like accessing the controls with an order of reading during For-Next loop.</p>\n\n<pre><code>' Parcours des contr\u00f4les de l'userform\nFor Each cCont In Me.Controls\n\n   ' TypeName(cCont)\n    MsgBox (cCont.Name)\n\nNext cCont\n</code></pre>\n\n<p>Actually, I think I am accessing with creation date...</p>\n\n<p>Do you know if I could configure the order of reading ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1537357120, "post_id": 52404970, "comment_id": 91753707, "body": "Show your work so far and ask a specific programming question."}, {"owner": {"reputation": 81, "user_id": 9580425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DtGSwIfKFNY/AAAAAAAAAAI/AAAAAAAACV0/E8Ub_vcSMv8/photo.jpg?sz=128", "display_name": "Matt Williams", "link": "https://stackoverflow.com/users/9580425/matt-williams"}, "edited": false, "score": 0, "creation_date": 1537365217, "post_id": 52404970, "comment_id": 91758733, "body": "@Jeeped So far i&#39;ve used the inbuilt Excel function to consolidate the fields based on a concatenated cell H2:H100000. I&#39;ve concatenated Column A,C,D,E,F and then used the consolidate function on H2:I100000 and that has given me the consolidated results I desire. I&#39;m looking for a VBA version of the excel function though so I can automate it as it&#39;s running extremely slow at the moment and is prone to not handing the 100K rows very well. In most cases not consolidating any data at all.If I try the consolidate feature with up to 20K rows it works fine."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1537365829, "post_id": 52404970, "comment_id": 91759133, "body": "Is the data at least sorted on all 5 columns to group duplicates together? What is the most minor deviation from 5 exact matches?"}, {"owner": {"reputation": 81, "user_id": 9580425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DtGSwIfKFNY/AAAAAAAAAAI/AAAAAAAACV0/E8Ub_vcSMv8/photo.jpg?sz=128", "display_name": "Matt Williams", "link": "https://stackoverflow.com/users/9580425/matt-williams"}, "edited": false, "score": 0, "creation_date": 1537366033, "post_id": 52404970, "comment_id": 91759258, "body": "Hi Jeeped, The only difference between the rows would be the value in the last column. it would be determined to be a duplicate based on the values in the 5 columns being the exact same but the value for each row would be different. It should determine that the rows are therefore duplicates and sum the values for both of those rows. The data is sorted by reference ascending. The duplicate rows may not be together row. For the example provided the first instance of overtime was 3 lines before the second line of overtime so there&#39;s no pattern. Hope this helps but please ask more questions"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1537366391, "post_id": 52404970, "comment_id": 91759493, "body": "... and the PayrollRef would be some sort of unique employee id used by the payroll dept? That is, out of 100K records, you only need to look for duplicates within the contiguous group of a single PayrollRef?"}, {"owner": {"reputation": 81, "user_id": 9580425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DtGSwIfKFNY/AAAAAAAAAAI/AAAAAAAACV0/E8Ub_vcSMv8/photo.jpg?sz=128", "display_name": "Matt Williams", "link": "https://stackoverflow.com/users/9580425/matt-williams"}, "edited": false, "score": 0, "creation_date": 1537366506, "post_id": 52404970, "comment_id": 91759570, "body": "Exactly, apologies for being so vague. The employee ref is unique to the particular employee and i&#39;m only concerned with duplicates whereby the reference number is the same. So if employee X has 2 rows the same Sum those rows but even if employee Y has the same row as employee X it is treated as a new group based on the reference number"}], "answers": [{"tags": [], "owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "is_accepted": false, "score": 0, "last_activity_date": 1537357821, "creation_date": 1537357821, "answer_id": 52405205, "question_id": 52404970, "link": "https://stackoverflow.com/questions/52404970/vba-consolidating-duplicate-rows-and-sum-a-column-with-multiple-criteria/52405205#52405205", "title": "VBA Consolidating duplicate rows and Sum a column with multiple criteria", "body": "<p>I believe a Pivot Table would do the trick, you won't need to remove duplicates and all the duplicates will get its value summed, counted or whatever you need. That way you can have the same table as you have now with the values you want without running even macros.</p>\n\n<p>I'd recommend to put a named range to get the source of the pivot table like that:</p>\n\n<pre><code>=OFFSET(*NameOfTheSourceSheet*!$A$1;0;0;COUNTA(*NameOfTheSourceSheet*!$A:$A);COUNTA(*NameOfTheSourceSheet*!$1:$1))\n</code></pre>\n\n<p>This way when your source table gets bigger, your pivot table will get all the new rows.</p>\n\n<p>Hope it helps</p>\n"}, {"tags": [], "owner": {"reputation": 81, "user_id": 9580425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DtGSwIfKFNY/AAAAAAAAAAI/AAAAAAAACV0/E8Ub_vcSMv8/photo.jpg?sz=128", "display_name": "Matt Williams", "link": "https://stackoverflow.com/users/9580425/matt-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1537436816, "creation_date": 1537436816, "answer_id": 52422183, "question_id": 52404970, "link": "https://stackoverflow.com/questions/52404970/vba-consolidating-duplicate-rows-and-sum-a-column-with-multiple-criteria/52422183#52422183", "title": "VBA Consolidating duplicate rows and Sum a column with multiple criteria", "body": "<p>Thanks for the help Damian but I figured out another way using VBA.</p>\n\n<p>Once I'd concatenated the columns into 1 column I ran the below code against the values column and it produced the merged duplicate sums in 2 columns to the right</p>\n\n<pre><code>Sub ConsolidateFirst60K()\n'\n' ConsolidateFirst50K Macro\n' Consolidate first row to 50K\n'\n\n'\nRange(\"K1\").Select\nSelection.Consolidate Sources:= _\n    \"'\\\\Filepath Of File \\[WorkbookName]Sheet1'!R1C8:R60000C9\" _\n    , Function:=xlSum, TopRow:=True, LeftColumn:=True, CreateLinks:=False\nActiveWindow.SmallScroll Down:=-24\nEnd Sub\n</code></pre>\n\n<p>It's a bit crude but it does the trick and I can refine it as I go along </p>\n\n<p>I did find that using R1C1 syntax doesn't work over the 65K rows Excel versions sometimes have trouble with. Whether that problem isn't an issue with the more up to date versions I'm not sure. It didn't work in 2013 and therefore I had to duplicate the macro and change the ranges to be 60k-120k for the second half of the data</p>\n\n<p>Regards,</p>\n\n<p>Matt</p>\n"}], "owner": {"reputation": 81, "user_id": 9580425, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-DtGSwIfKFNY/AAAAAAAAAAI/AAAAAAAACV0/E8Ub_vcSMv8/photo.jpg?sz=128", "display_name": "Matt Williams", "link": "https://stackoverflow.com/users/9580425/matt-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 473, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1537436816, "creation_date": 1537356971, "last_edit_date": 1537366246, "question_id": 52404970, "link": "https://stackoverflow.com/questions/52404970/vba-consolidating-duplicate-rows-and-sum-a-column-with-multiple-criteria", "title": "VBA Consolidating duplicate rows and Sum a column with multiple criteria", "body": "<p>I've had a look at multiple answers on the forum with how to merge duplicate rows in sheets and then sum the values of the duplicates together to leave 1 row with a unique combination of cells and the last cell as a sum of the duplicate values. Unfortunately I haven't managed to find something that works using a combination of multiple columns to determine if it's a duplicate that needs merging &amp; summing.</p>\n\n<p>As an example I've got 3 sheets - PreviousMonth,CurrentMonth and Difference that contain salary information relevant to the previous month and current month. The difference sheet needs to merge all the data from both the Previous and Current month without duplicates(I already have a macro that does this) but my Macro also removes all duplicate rows in both sheets before hand so if an employee claims more than 1 instance of overtime, my current Macro will delete any overtime rows after the first one.</p>\n\n<p>An example is\nHeadings</p>\n\n<pre><code>Credit/Debit|Cost Code|Element|Surname|Forename|PayrollRef|Value\n</code></pre>\n\n<p>And the values in those headings</p>\n\n<pre><code>Debit|XXXX.XXXX.XXX|147 - R.Day x 1.5.|Williams|Matt|X|200\nDebit|XXXX.XXXX.XXX|147 - R.Day x 1.5.|Williams|Matt|X|200\n</code></pre>\n\n<p>What I'd like to happen before my copy and paste and remove duplicates macro takes effect is to loop through each of the sheets, it can be separate or one after another and identify any duplicate lines for each of the employees in each sheet and merge the rows together but sum the value column. This is to handle the multiple overtime claims that employees can have in a month. Once it's done it there should only be one row of overtime per employee such as :</p>\n\n<pre><code>Credit/Debit|Cost Code|Element|Surname|Forename|PayrollRef|Value\nDebit|XXXX.XXXX.XXX|147 - R.Day x 1.5.|Williams|Matt|X|400   \n</code></pre>\n\n<p>Any help would be greatly appreciated and if you need more information to assist please don't hesitate to ask me as I can provide my other Macro's if they would be of use or more dummy data in the correct format. Unfortunately I can't provide the actual data in the spreadsheets though but what I've provided above is the same format of the headings and data.</p>\n\n<p>(I know that there's a lot of similar questions and I've had a look at quite a few of them so if there's an already answered question that would do what I want/need already answered I'll happily go read that if you can point me in the right direction)</p>\n\n<p>Edit:</p>\n\n<p>The code i've found and trying to get to work on a concatenated column H is :</p>\n\n<pre><code>Sub Consolidate()\nDim ConsolidateRangeArray as Variant\nConsolidateRangeArray = Array(\"Sheet1R2C8:R98936C9\")\nWorksheets(Sheet1).Range(\"K\").Consolidate _\nSources:=ConsolidateRangeArray, _\nFunction:xlSum, TopRow:=True, LeftColumn:=True, CreateLinks:=False\nEnd Sub\n</code></pre>\n\n<p>When I use this code those it comes up Runtime 1004 error \"Application-Defined or object defined error\"</p>\n\n<p>Regards,</p>\n\n<p>Matt</p>\n"}, {"tags": ["vba", "arguments", "user-defined-functions", "quotation-marks"], "comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1537357185, "post_id": 52404853, "comment_id": 91753742, "body": "I am quite sure you can&#39;t unless it is for examle a defined name in the sheet where you use the UDF. And I am also quite sure you can&#39;t use a text without quotation marks in a &quot;standard&quot; UDF."}], "answers": [{"comments": [{"owner": {"reputation": 480, "user_id": 8916210, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210550406820032/picture?type=large", "display_name": "Viktor Ilyenko", "link": "https://stackoverflow.com/users/8916210/viktor-ilyenko"}, "edited": false, "score": 0, "creation_date": 1537363246, "post_id": 52406505, "comment_id": 91757387, "body": "Hi, thank you for your answer. I&#39;m writing a function, in which user can write a name of currency, than my function will ask via API rate from a bank site and after all function will return rate. I&#39;d like that userside of my function will be in a such way: <code>=myFunc(CAD)</code>, not <code>=myFunc(&quot;CAD&quot;)</code>. If I write a name of a currence in a separate cell, than it will work: <code>=myFunc(A1)</code>"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1537382283, "post_id": 52406505, "comment_id": 91768204, "body": "Are you not listening? That&#39;s what Sama and I are writing. If it is a named range then it&#39;s okay and A1 is the name for the cell in row 1 and column 1. But you can&#39;t write <code>func(CAD)</code> because Excel cannot interpret <code>CAD</code> as a string. Try to use <code>Find</code> in the same way as you want to use your UDF. I am afraid but what you want it is just not possible."}, {"owner": {"reputation": 480, "user_id": 8916210, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210550406820032/picture?type=large", "display_name": "Viktor Ilyenko", "link": "https://stackoverflow.com/users/8916210/viktor-ilyenko"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1537532403, "post_id": 52406505, "comment_id": 91829959, "body": "Dear @Storax, please, do not agry on me - new answer from Rafa\u0142 B. showed, that it IS possible. Unfortunatly, I do not have enough reputation, to vote Rafal&#39;s answer.Can you, please, vote  his answer?"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1537533071, "post_id": 52406505, "comment_id": 91830317, "body": "Why should I be angry? If you need something like that and Rafal implemented it, go ahead. I did not think of it. @Rafal B.: Very good but as you wrote <i>I also don&#39;t know why one would need something like that</i>"}], "tags": [], "owner": {"reputation": 81, "user_id": 5467038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d9a00b37650ee367d006d1daebb007?s=128&d=identicon&r=PG&f=1", "display_name": "Sama Tori", "link": "https://stackoverflow.com/users/5467038/sama-tori"}, "is_accepted": false, "score": 1, "last_activity_date": 1537362118, "creation_date": 1537362118, "answer_id": 52406505, "question_id": 52404853, "link": "https://stackoverflow.com/questions/52404853/vba-string-arguments-in-udf-that-does-not-have-quotation-marks-how-to-access/52406505#52406505", "title": "VBA, string arguments in UDF that does not have quotation marks - how to access their value?", "body": "<p>If you use it without quotes, excel is expecting a named range. If what you want is to get the contents from another cell, you should define the argument as <code>myfunction(a as Range)</code> and then get its value using <code>a.Value2</code> or <code>a.Text</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1537536107, "post_id": 52427408, "comment_id": 91832112, "body": "@Viktor: If Rafal&#39;s solution fixed your issue you also should give him the <a href=\"https://stackoverflow.com/help/someone-answers\">credits</a>"}], "tags": [], "owner": {"reputation": 442, "user_id": 4929971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OZqaq.jpg?s=128&g=1", "display_name": "Rafa\u0142 B.", "link": "https://stackoverflow.com/users/4929971/rafa%c5%82-b"}, "is_accepted": true, "score": 2, "last_activity_date": 1537459923, "last_edit_date": 1537459923, "creation_date": 1537453518, "answer_id": 52427408, "question_id": 52404853, "link": "https://stackoverflow.com/questions/52404853/vba-string-arguments-in-udf-that-does-not-have-quotation-marks-how-to-access/52427408#52427408", "title": "VBA, string arguments in UDF that does not have quotation marks - how to access their value?", "body": "<p>I don't know why do you need something like that. <strong>But it is possible</strong>! Read about Application.Caller - it's rng where UDF is running. </p>\n\n<pre><code> Private Function myFuncCalc(ByVal xstr As String)\n ' it is your main function to calculate what you want\n ' just sample code to test below\n   If xstr = \"USD\" Then\n    myFuncCalc = \"yes it's american dollar!\"\n   Else\n    myFuncCalc = \"it's no american dollar\"\n   End If\n End Function\n\n Function myFunc(a)\n ' function just to be available in worksheet\n ' and extracting currency letter codes from formula between brackets\n   bra1 = InStr(Application.Caller.Formula, \"(\")\n   bra2 = InStr(Application.Caller.Formula, \")\")\n   x = Mid(Application.Caller.Formula, bra1 + 1, bra2 - bra1 - 1)\n   myFunc = myFuncCalc(x)\n End Function\n</code></pre>\n\n<p>Voila!</p>\n"}], "owner": {"reputation": 480, "user_id": 8916210, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210550406820032/picture?type=large", "display_name": "Viktor Ilyenko", "link": "https://stackoverflow.com/users/8916210/viktor-ilyenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 52427408, "answer_count": 2, "score": 0, "last_activity_date": 1537533436, "creation_date": 1537356547, "last_edit_date": 1537533436, "question_id": 52404853, "link": "https://stackoverflow.com/questions/52404853/vba-string-arguments-in-udf-that-does-not-have-quotation-marks-how-to-access", "title": "VBA, string arguments in UDF that does not have quotation marks - how to access their value?", "body": "<p>My function in a VBA is:</p>\n\n<pre><code>Function myFunc(a)\n    myFunc = a    \nEnd Function\n</code></pre>\n\n<p>When I use this function in Excel sheet in this way <code>=myFunc(\"abc\")</code>, it is working, but when I use formula without pair of quotating marks <code>=myFunc(abc)</code>, then I'm receiving error <code>#NAME?</code>. </p>\n\n<p>Trying change argument from <code>Function myFunc(a)</code> to <code>Function myFunc(chr(34) &amp; a &amp; chr (34) )</code> leads to error <code>Expected: )</code>.</p>\n\n<p>How can I access a value that was typed without quotation marks in a UDF ( user defined function )?</p>\n\n<p>Update: I need it to simplify usage of UDF for end user.</p>\n"}, {"tags": ["excel", "vba", "metaprogramming", "breakpoints", "vbe"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 4, "creation_date": 1537355142, "post_id": 52404306, "comment_id": 91752506, "body": "How do you &#39;update&#39; a public <b>constant</b>?"}, {"owner": {"reputation": 69, "user_id": 9545198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0db66489c5bb04c1ea15cb79a24a2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Prince ", "link": "https://stackoverflow.com/users/9545198/prince"}, "edited": false, "score": 0, "creation_date": 1537356032, "post_id": 52404306, "comment_id": 91752998, "body": "Using this, I am changing the declared public constant  Application.VBE.ActiveVBProject.VBComponents.Item(&quot;mod00Admi&zwnj;&#8203;n&quot;).CodeModule.Repla&zwnj;&#8203;ceLine 2, &quot;Public Const QuoteDB = &quot;&quot;A:\\1.0 Projects\\P0445 Ireland Commercial Raters\\02 Analysis\\05 Rate Assessor\\ROI Fleet Rater\\Quote Database\\Quote DB June 18.accdb&quot;&quot;&quot;"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 2, "creation_date": 1537356062, "post_id": 52404306, "comment_id": 91753019, "body": "You&#39;re trying to use the program modify a line that cannot be modified while the program is running:  If you tried doing this manually while stepping through with F8 then it would tell you that it required resetting the project.  The only way I can see to do this would be from a different application - you <i>might</i> be able to do it from a macro in a different DB, but I am doubtful"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 2, "creation_date": 1537356579, "post_id": 52404306, "comment_id": 91753368, "body": "Overall, I would suggest that if this is expected to be a regular thing then you should instead store the data in a &quot;Settings&quot; table and retrieve from there at runtime."}, {"owner": {"reputation": 5701, "user_id": 9199828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-UAYJV4Qkm7s/AAAAAAAAAAI/AAAAAAAAAD0/K2l8qCDDfVc/photo.jpg?sz=128", "display_name": "Foxfire And Burns And Burns", "link": "https://stackoverflow.com/users/9199828/foxfire-and-burns-and-burns"}, "edited": false, "score": 2, "creation_date": 1537364723, "post_id": 52404306, "comment_id": 91758390, "body": "First of all, if you want to change the value of that <i>constant</i>, then, <b>it is not a constant</b>. Second, the error could be caused because you need to set an option in Excel. make sure you check in Excel Options-&gt;Trusted Sites-&gt;Settings of Trusted Sites-&gt; Macros Setting-&gt; Check Trust access to Visual Basic Edito"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537408726, "post_id": 52404306, "comment_id": 91776320, "body": "@Jeeped I&#39;ve taken the liberty to edit the post to clarify."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1537443218, "post_id": 52404306, "comment_id": 91791139, "body": "Side note: no need to use <code>Call</code>"}], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 2, "last_activity_date": 1537409190, "last_edit_date": 1537409190, "creation_date": 1537404965, "answer_id": 52416016, "question_id": 52404306, "link": "https://stackoverflow.com/questions/52404306/cant-enter-break-mode-at-this-time-error/52416016#52416016", "title": "Can&#39;t Enter Break Mode at this time Error", "body": "<p>As mentioned in the comments, you need to use global variable or property instead of a \"constant\".  The reason you're getting the \"Can't Enter Break Mode at this time\" message is because you are modifying the <code>VBProject</code> <em>that is currently running</em>. Basically what is happening is that you are changing the source code while the <strong><em>already compiled code</em></strong> is still executing. A <code>Const</code> is \"hard coded\" into the executing procedure, so changing it won't do anything until the project is recompiled. In fact, the VBA language specification has no runtime semantics for <a href=\"https://msdn.microsoft.com/en-us/library/ee200326.aspx\" rel=\"nofollow noreferrer\">Const Declarations</a> (why would it?).  For example...</p>\n\n<pre><code>Public Const EXAMPLE = \"Foo\"\n\nPublic Sub Test()\n    Application.VBE.ActiveVBProject.VBComponents.Item(\"Module1\").CodeModule.ReplaceLine 1, _\n        \"Public Const EXAMPLE = \"\"Bar\"\"\"\n    Debug.Print EXAMPLE   '&lt;-- prints Foo\nEnd Sub\n</code></pre>\n\n<p>If you attempt to step through this with the debugger, you'll get the same message because the code in the VBE no longer matches what is being executed in the context of the debugger. Consider the following code:</p>\n\n<pre><code>'Module1\nPublic Const EXAMPLE = \"Bar\"\n\nPublic Sub Test()\n    With Application.VBE.ActiveVBProject.VBComponents.Item(\"Module1\").CodeModule\n        .DeleteLines 1, .CountOfLines\n    End With\n    Debug.Print \"Where am I?\"  '&lt;-- this will still execute.\nEnd Sub\n</code></pre>\n\n<p>If you step through this using <kbd>F8</kbd>, what line is the debugger supposed to highlight after you delete all of the code?</p>\n\n<p>So, the <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">X to your Y</a> is to simply not attempt to run self modifying code. A string that needs to change is not a constant - it is a variable. My recommendation would be to make it a property, give it a default value, and set it at run-time as needed:</p>\n\n<pre><code>'mod00Admin\nPrivate Const DEFAULT_DB As String = \"C:\\Foo\\Bar.accdb\"\nPrivate activeQuoteDB As String\n\nPublic Property Let QuoteDB(rhs As String)\n    activeQuoteDB = rhs\nEnd Property\n\nPublic Property Get QuoteDB() As String\n    If activeQuoteDB = vbNullString Then\n        QuoteDB = DEFAULT_DB\n    Else\n        QuoteDB = activeQuoteDB\n    End If\nEnd Property\n\n'...\n\nPublic Sub AB()\n    LoadQuoteDetails2.Automation\n    mod00Admin.QuoteDB = \"A:\\1.0 Projects\\P0445 Ireland Commercial Raters\\02 Analysis\\05 Rate Assessor\\ROI Fleet Rater\\Quote Database\\Quote DB June 18.accdb\"\n    CalcTariffPrem\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 9545198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0db66489c5bb04c1ea15cb79a24a2e14?s=128&d=identicon&r=PG&f=1", "display_name": "Prince ", "link": "https://stackoverflow.com/users/9545198/prince"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1038, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1537409190, "creation_date": 1537354709, "last_edit_date": 1537408621, "question_id": 52404306, "link": "https://stackoverflow.com/questions/52404306/cant-enter-break-mode-at-this-time-error", "title": "Can&#39;t Enter Break Mode at this time Error", "body": "<p>I am trying to do the following in one module:</p>\n\n<ol>\n<li>Replace a <code>Public Const</code> in another module, at run-time.</li>\n<li>Invoke a procedure that uses the updated public constant</li>\n</ol>\n\n<p>However, it throws an error:</p>\n\n<blockquote>\n  <p><em>Can't enter break mode at this time</em></p>\n</blockquote>\n\n<p>Although, it <em>does</em> update the public constant.</p>\n\n<p>I tried pressing <kbd>F5</kbd> to resume execution, but it did not help. Any suggestions?</p>\n\n<pre><code>Sub AB()\n\n    Call LoadQuoteDetails2.Automation\n\n    Application.VBE _\n               .ActiveVBProject _\n               .VBComponents _\n               .Item(\"mod00Admin\") _\n               .CodeModule _\n               .ReplaceLine 2, \"Public Const QuoteDB = \"\"A:\\1.0 Projects\\P0445 Ireland Commercial Raters\\02 Analysis\\05 Rate Assessor\\ROI Fleet Rater\\Quote Database\\Quote DB June 18.accdb\"\"\"\n\n    Call CalcTariffPrem\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "dynamic"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 0, "last_activity_date": 1537354802, "creation_date": 1537354802, "answer_id": 52404338, "question_id": 52404272, "link": "https://stackoverflow.com/questions/52404272/vba-copy-filtered-range-without-select/52404338#52404338", "title": "VBA - copy filtered range without select", "body": "<p>You already have your lastrow set in a variable. Try,</p>\n\n<pre><code>with worksheets(\"sheet1\").Range(\"A1:AW\" &amp; Lastrow)\n    .AutoFilter field:=1, Criteria1:=filter\n    .Copy Destination:=Sheet2.Range(\"A1\")\nend with\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 10385247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2dc868c20a2e04477354781177a2b054?s=128&d=identicon&r=PG&f=1", "display_name": "Hana", "link": "https://stackoverflow.com/users/10385247/hana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 0, "accepted_answer_id": 52404338, "answer_count": 1, "score": 1, "last_activity_date": 1537354802, "creation_date": 1537354595, "question_id": 52404272, "link": "https://stackoverflow.com/questions/52404272/vba-copy-filtered-range-without-select", "title": "VBA - copy filtered range without select", "body": "<p>I have a range of data and I want to filter by specific criteria and then copy the filtered data to another sheet.</p>\n\n<p>This is my code:</p>\n\n<pre><code>           'filter and Lastrow are variables previously declared    \n            Sheet1.Activate\n            Sheet1.Range(\"$A$1:$AW$\" &amp; Lastrow).AutoFilter field:=1, Criteria1:=filter\n            Sheet1.Range(\"A1\").Select\n\n            Range(Selection, Selection.End(xlDown)).Select\n            Range(Selection, Selection.End(xlToRight)).Select\n            Selection.Copy Destination:=Sheet2.Range(\"A1\")\n</code></pre>\n\n<p>The problem is that this requires selecting and selecting requires the relevant sheet to be active.\nIs there a way to do it without first selecting (Sheet1.Range(\"A1\").select)?\nNote, that my filtered range is not a table.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["html", "vba", "excel", "web-scraping"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1537354186, "post_id": 52403947, "comment_id": 91751940, "body": "What are you after from the new url? <a href=\"https://finance.yahoo.com/quote/AAPL/key-statistics?p=AAPL\" rel=\"nofollow noreferrer\">finance.yahoo.com/quote/AAPL/key-statistics?p=AAPL</a>  All the tables?"}, {"owner": {"reputation": 57, "user_id": 10300038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fdWbCfHD6R4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTsW6JTIrS_HXLwUveOen6u319tQ/mo/photo.jpg?sz=128", "display_name": "KSASteve", "link": "https://stackoverflow.com/users/10300038/ksasteve"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1537355353, "post_id": 52403947, "comment_id": 91752595, "body": "All the tables would be amazing! If do\u2019able. I\u2019ve tried with different references using the original code but I\u2019m missing something?"}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 10300038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fdWbCfHD6R4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTsW6JTIrS_HXLwUveOen6u319tQ/mo/photo.jpg?sz=128", "display_name": "KSASteve", "link": "https://stackoverflow.com/users/10300038/ksasteve"}, "edited": false, "score": 0, "creation_date": 1537360330, "post_id": 52405182, "comment_id": 91755561, "body": "Hey man - that&#39;s great! It creates a list in a column down from B3, unlike the original which populates the row 3 along from cell A3, then gets next value from A4 etcetera. Is that the intention with your code - or perhaps that&#39;s what I asked for!! I was looking for values for a list of tickers similar to the original, with values populating the corresponding row. If that is too much for all this info, I could create a different sheet for each and populate that accordingly? Is the previous method an option at all? Thank you."}, {"owner": {"reputation": 57, "user_id": 10300038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fdWbCfHD6R4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTsW6JTIrS_HXLwUveOen6u319tQ/mo/photo.jpg?sz=128", "display_name": "KSASteve", "link": "https://stackoverflow.com/users/10300038/ksasteve"}, "edited": false, "score": 0, "creation_date": 1537360743, "post_id": 52405182, "comment_id": 91755830, "body": "&#39;A little tidier&#39; looks great. Putting all the data on to another sheet. I have populated cells A3-A9 with tickers and sheet 2 is opulated with the data for all 6. 75 rows for each, 450 rows all told. Just need to either work out a way to isolate the data for each ticker, or maybe create a new sheet for each, with the ticker as the sheet name. It is very much what i used to use before Yahoo took away the previous method of gathering information."}, {"owner": {"reputation": 57, "user_id": 10300038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fdWbCfHD6R4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTsW6JTIrS_HXLwUveOen6u319tQ/mo/photo.jpg?sz=128", "display_name": "KSASteve", "link": "https://stackoverflow.com/users/10300038/ksasteve"}, "edited": false, "score": 0, "creation_date": 1537368172, "post_id": 52405182, "comment_id": 91760637, "body": "I tried replacing the code and trying it against 6 tickers in column A. It places the headers in row 2, but fails in gathering the data across each ticker row for the ticker. Perhaps I am doing something wrong - am I to simply copy the code and voila? Thank you."}, {"owner": {"reputation": 57, "user_id": 10300038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fdWbCfHD6R4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTsW6JTIrS_HXLwUveOen6u319tQ/mo/photo.jpg?sz=128", "display_name": "KSASteve", "link": "https://stackoverflow.com/users/10300038/ksasteve"}, "edited": false, "score": 0, "creation_date": 1537369265, "post_id": 52405182, "comment_id": 91761340, "body": "The six I am currently using as a test are:AAPL AAT AAV AB ABB ABBV"}, {"owner": {"reputation": 57, "user_id": 10300038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fdWbCfHD6R4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTsW6JTIrS_HXLwUveOen6u319tQ/mo/photo.jpg?sz=128", "display_name": "KSASteve", "link": "https://stackoverflow.com/users/10300038/ksasteve"}, "edited": false, "score": 0, "creation_date": 1537370243, "post_id": 52405182, "comment_id": 91762013, "body": "I have yes - it&#39;s obviously something I&#39;m doing as it&#39;s not populating the cells. I have the following References enabled - Visual Basic for Applications, MS Ex 16.0 Object Library, MS Office 16.0 Object Library, OLE Automation &amp; MS HTML Object Library.."}, {"owner": {"reputation": 57, "user_id": 10300038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fdWbCfHD6R4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTsW6JTIrS_HXLwUveOen6u319tQ/mo/photo.jpg?sz=128", "display_name": "KSASteve", "link": "https://stackoverflow.com/users/10300038/ksasteve"}, "edited": false, "score": 0, "creation_date": 1537370846, "post_id": 52405182, "comment_id": 91762393, "body": "That works perfectly? I&#39;ve saved it and it&#39;s saved as an Excel Binary Workbook as opposed to a Macro Enabled? Any reason that might be. My original file appears to be identical? Thanks again."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 57, "user_id": 10300038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fdWbCfHD6R4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTsW6JTIrS_HXLwUveOen6u319tQ/mo/photo.jpg?sz=128", "display_name": "KSASteve", "link": "https://stackoverflow.com/users/10300038/ksasteve"}, "edited": false, "score": 0, "creation_date": 1537370901, "post_id": 52405182, "comment_id": 91762431, "body": "xlsb format are smaller so preferable to .xlsm. They both run macros. It was tested and ran fine. Be aware that if there is formatting for example left in the sheet, the end row may not be what you think it is and you will find the results much lower down the worksheet."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 57, "user_id": 10300038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fdWbCfHD6R4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTsW6JTIrS_HXLwUveOen6u319tQ/mo/photo.jpg?sz=128", "display_name": "KSASteve", "link": "https://stackoverflow.com/users/10300038/ksasteve"}, "edited": false, "score": 0, "creation_date": 1537371350, "post_id": 52405182, "comment_id": 91762696, "body": "I edited a line in the above code to the following:  .Cells(ticker + 2, counter) = tables(i).innerText   to avoid problems with formatting interfering."}, {"owner": {"reputation": 57, "user_id": 10300038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fdWbCfHD6R4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTsW6JTIrS_HXLwUveOen6u319tQ/mo/photo.jpg?sz=128", "display_name": "KSASteve", "link": "https://stackoverflow.com/users/10300038/ksasteve"}, "edited": false, "score": 1, "creation_date": 1537372587, "post_id": 52405182, "comment_id": 91763405, "body": "That\u2019s really quite remarkable. Can\u2019t thank you enough. Have a great day \ud83d\udc4d"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 3, "last_activity_date": 1537389798, "last_edit_date": 1537389798, "creation_date": 1537357756, "answer_id": 52405182, "question_id": 52403947, "link": "https://stackoverflow.com/questions/52403947/excel-vba-code-amend-to-pick-up-other-tables-in-different-page/52405182#52405182", "title": "Excel VBA code - Amend to pick up other tables in different page?", "body": "<p>Try the following:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub GetYahooInfo()\n    Dim tickers(), ticker As Long, lastRow As Long, headers()\n    Dim wsSource As Worksheet, http As Object, html As New HTMLDocument\n    headers = Array(\"Previous Close\", \"Open\", \"Bid\", \"Ask\", \"Day's Range\", \"52 Week Range\", \"Volume\", \"Avg. Volume\", \"Market Cap\", _\n                    \"Beta\", \"PE Ratio (TTM)\", \"EPS (TTM)\", \"Earnings Date\", \"Forward Dividend &amp; Yield\", \"Ex-Dividend Date\", \"1y Target Est\", _\n                    \"Market Cap (intraday)\", \"Enterprise Value\", \"Trailing P/E\", \"Forward P/E\", \"PEG Ratio (5 yr expected)\", \"Price/Sales (ttm)\", _\n                    \"Price/Book (mrq)\", \"Enterprise Value/Revenue\", \"Enterprise Value/EBITDA\", \"Fiscal Year Ends\", \"Most Recent Quarter (mrq)\", _\n                    \"Profit Margin\", \"Operating Margin (ttm)\", \"Return on Assets (ttm)\", \"Return on Equity (ttm)\", \"Revenue (ttm)\", \"Revenue Per Share (ttm)\", _\n                    \"Quarterly Revenue Growth (yoy)\", \"Gross Profit (ttm)\", \"EBITDA\", \"Net Income Avi to Common (ttm)\", \"Diluted EPS (ttm)\", _\n                    \"Quarterly Earnings Growth (yoy)\", \"Total Cash (mrq)\", \"Total Cash Per Share (mrq)\", \"Total Debt (mrq)\", _\n                    \"Total Debt/Equity (mrq)\", \"Current Ratio (mrq)\", \"Book Value Per Share (mrq)\", \"Operating Cash Flow (ttm)\", _\n                    \"Levered Free Cash Flow (ttm)\", \"Beta\", \"52-Week Change\", \"S&amp;P500 52-Week Change\", \"52 Week High\", \"52 Week Low\", _\n                    \"50-Day Moving Average\", \"200-Day Moving Average\", \"Avg Vol (3 month)\", \"Avg Vol (10 day)\", _\n                    \"Shares Outstanding\", \"Float\", \"% Held by Insiders\", \"% Held by Institutions\", \"Shares Short (Aug 31, 2018)\", _\n                    \"Short Ratio (Aug 31, 2018)\", \"Short % of Float (Aug 31, 2018)\", \"Short % of Shares Outstanding (Aug 31, 2018)\", _\n                    \"Shares Short (prior month Jul 31, 2018)\", \"Forward Annual Dividend Rate\", \"Forward Annual Dividend Yield\", _\n                    \"Trailing Annual Dividend Rate\", \"Trailing Annual Dividend Yield\", \"5 Year Average Dividend Yield\", \"Payout Ratio\", _\n                    \"Dividend Date\", \"Ex-Dividend Date\", \"Last Split Factor (new per old)\", \"Last Split Date\")\n    Application.ScreenUpdating = False\n\n    Set wsSource = ThisWorkbook.Worksheets(\"Sheet1\") '&lt;== Change as appropriate to sheet containing the tickers\n\n    With wsSource\n        lastRow = GetLastRow(wsSource, 1)\n        Select Case lastRow\n        Case Is &lt; 3\n            Exit Sub\n        Case 3\n            ReDim tickers(1, 1): tickers(1, 1) = .Range(\"A3\").Value\n        Case Is &gt; 3\n            tickers = .Range(\"A3:A\" &amp; lastRow).Value\n        End Select\n\n        Dim i As Long, sResponse As String\n        Set http = CreateObject(\"MSXML2.XMLHTTP\")\n\n        For ticker = LBound(tickers, 1) To UBound(tickers, 1)\n            With Worksheets(\"Sheet1\")\n                If Not IsEmpty(tickers(ticker, 1)) Then\n                    With http\n                        .Open \"GET\", \"https://finance.yahoo.com/quote/\" &amp; tickers(ticker, 1) &amp; \"/key-statistics?p=\" &amp; tickers(ticker, 1), False\n                        .setRequestHeader \"If-Modified-Since\", \"Sat, 1 Jan 2000 00:00:00 GMT\"\n                        .send\n                        sResponse = StrConv(.responseBody, vbUnicode)\n                    End With\n\n                    sResponse = Mid$(sResponse, InStr(1, sResponse, \"&lt;!DOCTYPE \"))   \n                    html.body.innerHTML = sResponse\n\n                    Dim tables As Object, destLastRow As Long\n                    Dim counter As Long: counter = 2\n\n                    Set tables = html.querySelectorAll(\"tbody td\")             \n                    .Cells(2, 2).Resize(1, UBound(headers) + 1) = headers\n\n                    For i = 1 To tables.Length - 1 Step 2\n                        .Cells(ticker + 2, counter) = tables(i).innerText\n                        If InStr(tables(i).innerText, \"Last Split Date\") &gt; 0 Or InStr(tables(i + 1).innerText, \"Last Split Date\") &gt; 0 Then\n                            Exit For\n                        End If\n                        counter = counter + 1\n                    Next\n                    Set html = Nothing: Set tables = Nothing\n                Else\n                    .Cells(2 + ticker, 2) = \"N/A\"\n                End If\n            End With\n        Next\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n\nPublic Function GetLastRow(ByVal ws As Worksheet, Optional ByVal columnNumber As Long = 1) As Long\n    With ws\n        GetLastRow = .Cells(.Rows.Count, columnNumber).End(xlUp).Row\n    End With\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>Sample results:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/juq3Z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/juq3Z.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 57, "user_id": 10300038, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fdWbCfHD6R4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPTsW6JTIrS_HXLwUveOen6u319tQ/mo/photo.jpg?sz=128", "display_name": "KSASteve", "link": "https://stackoverflow.com/users/10300038/ksasteve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 2, "accepted_answer_id": 52405182, "answer_count": 1, "score": 3, "last_activity_date": 1537389798, "creation_date": 1537353562, "last_edit_date": 1537372756, "question_id": 52403947, "link": "https://stackoverflow.com/questions/52403947/excel-vba-code-amend-to-pick-up-other-tables-in-different-page", "title": "Excel VBA code - Amend to pick up other tables in different page?", "body": "<p>A quick question about the amending of a piece of code to pick up other web page table contents. I had some great guidance on here about how to pick up certain table contents based on the title and it works great - thanks again to <a href=\"https://stackoverflow.com/users/6241235/qharr\">'QHarr'</a> who was so helpful.</p>\n\n<p>The URL I was wanting the table details from was:</p>\n\n<p><a href=\"https://finance.yahoo.com/quote/AAPL/?p=AAPL\" rel=\"nofollow noreferrer\">https://finance.yahoo.com/quote/AAPL/?p=AAPL</a></p>\n\n<p>This is the piece of code which took the data I wanted:</p>\n\n<pre><code>Sub GetYahooInfo100()\nDim tickers(), ticker As Long, lastRow As Long, headers()\nDim wsSource As Worksheet, http As clsHTTP, html As HTMLDocument\n\nApplication.ScreenUpdating = False\n\nSet wsSource = ThisWorkbook.Worksheets(\"100\")\nSet http = New clsHTTP\n\nheaders = Array(\"Ticker\", \"Previous Close\", \"Open\", \"Bid\", \"Ask\", \"Day's Range\", \"52 Week Range\", \"Volume\", \"Avg. Volume\", \"Market Cap\", \"Beta\", \"PE Ratio (TTM)\", \"EPS (TTM)\", _\n                \"Earnings Date\", \"Forward Dividend &amp; Yield\", \"Ex-Dividend Date\", \"1y Target Est\")\n\nWith wsSource\n    lastRow = GetLastRow(wsSource, 1)\n    Select Case lastRow\n    Case Is &lt; 3\n        Exit Sub\n    Case 3\n        ReDim tickers(1, 1): tickers(1, 1) = .Range(\"A3\").Value\n    Case Is &gt; 3\n        tickers = .Range(\"A3:A\" &amp; lastRow).Value\n    End Select\n\n    ReDim Results(0 To UBound(tickers, 1) - 1)\n    Dim i As Long, endPoint As Long\n    endPoint = UBound(headers)\n\n    For ticker = LBound(tickers, 1) To UBound(tickers, 1)\n        If Not IsEmpty(tickers(ticker, 1)) Then\n            Set html = http.GetHTMLDoc(\"https://finance.yahoo.com/quote/\" &amp; tickers(ticker, 1) &amp; \"/?p=\" &amp; tickers(ticker, 1))\n            Results(ticker - 1) = http.GetInfo(html, endPoint)\n            On Error Resume Next\n            Set html = Nothing\n        Else\n            Results(ticker) = vbNullString\n        End If\n    Next\n\n    .Cells(2, 1).Resize(1, UBound(headers) + 1) = headers\n    For i = LBound(Results) To UBound(Results)\n        .Cells(3 + i, 2).Resize(1, endPoint - 1) = Results(i)\n    Next\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>With a further piece below:</p>\n\n<pre><code>Public Function GetLastRow(ByVal ws As Worksheet, Optional ByVal columnNumber As Long = 1) As Long\nWith ws\n    GetLastRow = .Cells(.Rows.Count, columnNumber).End(xlUp).Row\nEnd With\n</code></pre>\n\n<p>End Function</p>\n\n<p>Like I say one of the members on here was very helpful in identifying how to do that. I have tried in vein to amend the piece of code to pick up another set of data from the statistics page, as follows:</p>\n\n<p><a href=\"https://finance.yahoo.com/quote/AAPL/key-statistics?p=AAPL\" rel=\"nofollow noreferrer\">https://finance.yahoo.com/quote/AAPL/key-statistics?p=AAPL</a></p>\n\n<p>but I must be missing something. Unless my references are incorrect for the tables then I'm at a loss. I am looking to see if I can capture all the data fields in each of the tables, not just one which is where I may be going wrong.</p>\n\n<p>Was hoping someone may be able to assist.</p>\n\n<p>With forward thanks. </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "edited": false, "score": 1, "creation_date": 1537357514, "post_id": 52403917, "comment_id": 91753949, "body": "Hi welcome to stack overflow. Could you post what you have tried so far ?"}, {"owner": {"reputation": 1, "user_id": 10385147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31086f50ee80ac0868e818645fc5cb0?s=128&d=identicon&r=PG&f=1", "display_name": "MaraBiz", "link": "https://stackoverflow.com/users/10385147/marabiz"}, "reply_to_user": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "edited": false, "score": 0, "creation_date": 1537365692, "post_id": 52403917, "comment_id": 91759032, "body": "I have tried in excel with formulas to extract from a single column the informations but it steel doesn&#39;t look like the final result that i want to have so that&#39;s why i have asked for help"}, {"owner": {"reputation": 2332, "user_id": 7013419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RXUhu.png?s=128&g=1", "display_name": "PilouPili", "link": "https://stackoverflow.com/users/7013419/piloupili"}, "edited": false, "score": 0, "creation_date": 1537365859, "post_id": 52403917, "comment_id": 91759154, "body": "That is why I was suggesting you paste your VBA code. Because your question contains insufficient elements. You have to give us all the lements to reproduce your problem."}], "owner": {"reputation": 1, "user_id": 10385147, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d31086f50ee80ac0868e818645fc5cb0?s=128&d=identicon&r=PG&f=1", "display_name": "MaraBiz", "link": "https://stackoverflow.com/users/10385147/marabiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593702590, "creation_date": 1537353474, "last_edit_date": 1593702590, "question_id": 52403917, "link": "https://stackoverflow.com/questions/52403917/vba-to-extract-in-excel-from-a-word-informations", "title": "VBA to extract in excel from a word informations", "body": "<p>I have a swift message saved in word and i want to extract in excel some certain informations from the swift message </p>\n\n<p>For example part of the swift message:</p>\n\n<pre><code>97A - Safekeeping Account:\nQualifier : SAFE\nAccount Number: 223323\n17B - Flag:\nQualifier: ACTI\nFlag : Y\n17B - Flag:\nQualifier: CONS\nFlag : N\n16S - End Block GENL:\nGENL\n16R - Start Block SUBSAFE(Sequence B Sub-safekeeping Account):\nSUBSAFE\n16R - Start Block FIN(Sequence B1 Financial Instrument):\nFIN\n35B - Ident. of the Financial Instr.:\nIdentification of Security: ISIN HHHGDJKKKK\nDescription of Security : bjjsdhaskhd\nREGISTERED SHARES\n93B - Balance:\nQualifier : AGGR\nQuantity Type Code: UNIT\nBalance : 8300, (8.300,00)\n16R - Start Block SUBBAL(Subsequence B1b Sub-Balance):\nSUBBAL\n</code></pre>\n\n<p>I want to extract in excel in 3 columns:</p>\n\n<pre><code>97A_Account Number  35B_ Identification of Security 93B_Balance\n223323               ISIN HHHGDJKKKK                    8.300,00\n</code></pre>\n\n<p>And then to loop into the word file for the next <code>97A Account Number, 35B IDenfication of Security and 93B Balance</code> until the end of the document</p>\n\n<p>Can you help with a VBA for this?</p>\n"}, {"tags": ["arrays", "excel", "vba", "matrix", "reference"], "comments": [{"owner": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 0, "creation_date": 1537351649, "post_id": 52403117, "comment_id": 91750312, "body": "Range is not a global function, you either have to call it on the worksheet or activate the worksheet <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range(object)\" rel=\"nofollow noreferrer\">source</a>.  In Word VBA, I&#39;m also able to do something like <code>With Worksheet(..)  ... End With</code>.  Search that link I gave you for <code>With wsTarget</code> to see what I mean.  Maybe you can say <code>With ActiveSheet</code>"}, {"owner": {"reputation": 13, "user_id": 10384878, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155863607542336/picture?type=large", "display_name": "Andy", "link": "https://stackoverflow.com/users/10384878/andy"}, "reply_to_user": {"reputation": 2059, "user_id": 7949696, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206392642867400/picture?type=large", "display_name": "James Poag", "link": "https://stackoverflow.com/users/7949696/james-poag"}, "edited": false, "score": 0, "creation_date": 1537357995, "post_id": 52403117, "comment_id": 91754241, "body": "I do not have a source of data for my purpose, as I generate a Matrix table using randomly generated variables for a Monte Carlo simulation. What i could do is to declare a string variable for &quot;Matrix(&quot; and &quot;, c)&quot; and have a variable fill in the 1,2,3....... Still, isn&#39;t there a way to do this with a range?"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 0, "creation_date": 1537359108, "post_id": 52403117, "comment_id": 91754879, "body": "Why do you prefer the second method? And why not just simply add the values instead of falling back to a worksheet.function?"}, {"owner": {"reputation": 13, "user_id": 10384878, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155863607542336/picture?type=large", "display_name": "Andy", "link": "https://stackoverflow.com/users/10384878/andy"}, "edited": false, "score": 0, "creation_date": 1537365170, "post_id": 52403117, "comment_id": 91758696, "body": "Because if the matrix turns out to be 50 rows by 50 columns, then i would prefer not to add every cell that needs to be added one by one, therefore 50 difference Matrix(row 1,2,3,...,c)."}, {"owner": {"reputation": 439, "user_id": 8221156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0630c5eb8859be4063f55d8389373460?s=128&d=identicon&r=PG&f=1", "display_name": "Gene", "link": "https://stackoverflow.com/users/8221156/gene"}, "edited": false, "score": 0, "creation_date": 1537400747, "post_id": 52403117, "comment_id": 91774687, "body": "@Andy You&#39;ve said <i>&quot;then i would prefer not to add every cell that needs to be added one by one, therefore 50 difference Matrix(row 1,2,3,...,c)&quot;</i>. Well, nobody would, true. You should investigate the concept of nested loops! Then even a 100000 x 100000 matrix will be an easy thing to handle, yes."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10384878, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155863607542336/picture?type=large", "display_name": "Andy", "link": "https://stackoverflow.com/users/10384878/andy"}, "edited": false, "score": 0, "creation_date": 1537535949, "post_id": 52410970, "comment_id": 91832014, "body": "Thanks for the help Jamie Ris. I then assume that the pasting of the matrix into excel and using actual cell references are mandatory for this to work and avoid the repetition of 1000x same code. Thanks I will incorporate the pasting. In case there is an easier way (like with the range, or using full column ), I will be more than happy to learn about this.  Thank you!!!"}], "tags": [], "owner": {"reputation": 361, "user_id": 8172841, "user_type": "registered", "profile_image": "https://graph.facebook.com/10213855898812088/picture?type=large", "display_name": "Jamie Riis", "link": "https://stackoverflow.com/users/8172841/jamie-riis"}, "is_accepted": true, "score": 1, "last_activity_date": 1537376766, "creation_date": 1537376766, "answer_id": 52410970, "question_id": 52403117, "link": "https://stackoverflow.com/questions/52403117/how-to-refer-to-an-entire-column-or-row-in-a-variable-matrix-in-vba/52410970#52410970", "title": "How to refer to an entire column or row in a variable matrix in VBA?", "body": "<p>As James Poag said, range is not a global function and must be called in association with a worksheet.  If you want to use the <code>WorksheetFunction.Sum</code> then you will have to copy your matrix to a worksheet.  In the example below:</p>\n\n<ol>\n<li>Create a 4 x 10 matrix of random numbers, </li>\n<li>Create a new work sheet,</li>\n<li>Copy the matrix to the worksheet,</li>\n<li>Use the <code>WorksheetFunction.Sum</code> to add rows of the range, and </li>\n<li><p>Delete the worksheet added by the VBA macro </p>\n\n<pre><code>Option Explicit\n\nPublic Sub Matrixer()\n    Dim x As Long\n    x = 10\n    Dim matrix() As Double\n    ReDim matrix(1 To 4, 1 To x)\n\n    'Generate the matrix\n    Dim rowNDX As Long\n    Dim colNDX As Long\n    For rowNDX = 1 To UBound(matrix, 1)\n        For colNDX = 1 To UBound(matrix, 2)\n            Randomize\n            matrix(rowNDX, colNDX) = Rnd\n        Next colNDX\n    Next rowNDX\n\n    'Write the maxtrix to a sheet\n    'First add a worksheet to do the calculation\n    Dim wb As Workbook: Set wb = ActiveWorkbook\n    Dim strName As String: strName = \"MATRIXCALC\"\n\n    Dim ws As Worksheet\n    Set ws = wb.Worksheets.Add(Type:=xlWorksheet)\n    With ws\n        .Name = strName\n    End With\n\n    'Write the maxtrix to the sheet\n    'This code was provide/adapted from Chip Pearson's blog at\n    'http://www.cpearson.com/excel/ArraysAndRanges.aspx\n    Dim Destination As Range\n    Set Destination = ws.Range(\"A1\")\n    Destination.Resize(UBound(matrix, 1), UBound(matrix, 2)).Value = matrix\n\n    'Use the worksheet function to Sum the range\n    Dim RowSum(4) As Double\n    Dim rngSum As Range\n    For rowNDX = 1 To 4\n        Set rngSum = ws.Range(\"A\" &amp; Trim(CStr(rowNDX)) &amp; \":A\" &amp; Trim(CStr(UBound(matrix, 2))))\n        RowSum(rowNDX) = WorksheetFunction.Sum(rngSum)\n\n    Next rowNDX\n\n    'Delete the worksheet added by the macro\n    'Prevent asking user if it's ok to delete worksheet\n    Application.DisplayAlerts = False\n    ws.Delete\n    'Turn application display alerts back on.\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 13, "user_id": 10384878, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155863607542336/picture?type=large", "display_name": "Andy", "link": "https://stackoverflow.com/users/10384878/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 899, "favorite_count": 0, "accepted_answer_id": 52410970, "answer_count": 1, "score": 0, "last_activity_date": 1537376766, "creation_date": 1537350961, "last_edit_date": 1537358717, "question_id": 52403117, "link": "https://stackoverflow.com/questions/52403117/how-to-refer-to-an-entire-column-or-row-in-a-variable-matrix-in-vba", "title": "How to refer to an entire column or row in a variable matrix in VBA?", "body": "<p>I've spent a lot of time looking for a way how I can refer to a range (column or row) in a matrix that I have created in VBA.</p>\n\n<p>A simple example is to loop through 4th row of a 4 by x Matrix to sum columns 1 to 3 for column x. </p>\n\n<p>The below code is the long way to do it:</p>\n\n<pre><code>x = 10\n\nDim Matrix() As Variant\nReDim Matrix(1 to 4, 1 to x)\n\nFor c = 1 to x\n\n   Matrix(4, c) = Application.WorksheetFunction.Sum(Matrix(1, c), Matrix(2, c), Matrix(3, c))\n\nNext\n</code></pre>\n\n<p>I am looking for a way to do it like this without an error:</p>\n\n<pre><code>For c = 1 to x\n\n   Matrix(4, c) = Application.WorksheetFunction.Sum(Range(Matrix(1, c), Matrix(3, c)))\n\nNext\n</code></pre>\n\n<p>The following error pops up when I try to run it:</p>\n\n<p><code>*Run-time error '1004':\nMethod 'range' of object '_Global' failed*</code></p>\n\n<p>Can you please help to fix this, as other workarounds seem to be rather time consuming.</p>\n\n<p>Thanks!</p>\n\n<p>Andy</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2776, "user_id": 137948, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/69ede0d2d1b8ef65b841c031a7bac2e5?s=128&d=identicon&r=PG", "display_name": "Will Sheppard", "link": "https://stackoverflow.com/users/137948/will-sheppard"}, "edited": false, "score": 0, "creation_date": 1537350320, "post_id": 52402643, "comment_id": 91749482, "body": "Welcome to Stack Overflow. You may get better responses if you are more specific in your question. What <i>exactly</i> is not working? Which part of the code are you referring to? What happens instead? See: <a href=\"https://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "edited": false, "score": 0, "creation_date": 1537361282, "post_id": 52402643, "comment_id": 91756123, "body": "Thank you for helping with the edit, did not realise I had left my email in."}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1537364882, "post_id": 52402643, "comment_id": 91758497, "body": "You did not define &quot;Last&quot;; you probably need something like...  <code>Last = Cells(1, Columns.Count).End(xlToLeft).Column</code>"}, {"owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "reply_to_user": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1537369364, "post_id": 52402643, "comment_id": 91761416, "body": "@GMalc Where would I include this in my VBA? I do apologise if its a bit of an obvious question as I&#39;m new to this. Thanks!"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1537381666, "post_id": 52402643, "comment_id": 91767940, "body": "I would place it below this line; <code>DestSh.Name = &quot;RDBMergeSheet&quot;</code>, and ensure that it references the correct worksheet, e.g. <code>Last = DestSh.Cells(1, Columns.Count).End(xlToLeft).Column</code>. Also, since you know the number of columns that you are going to copy, i would Remove &quot;CopyRng.Columns.Count&quot;, and change it to <code>If Last + 7 &gt; DestSh.Columns.Count Then</code>"}], "owner": {"reputation": 95, "user_id": 10358101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d60e9e6ac30ec05b48e43401e89ef076?s=128&d=identicon&r=PG&f=1", "display_name": "NHure92", "link": "https://stackoverflow.com/users/10358101/nhure92"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537361214, "creation_date": 1537349525, "last_edit_date": 1537361214, "question_id": 52402643, "link": "https://stackoverflow.com/questions/52402643/excel-vba-save-to-master-worksheet", "title": "Excel VBA save to master worksheet", "body": "<p>I currently have a VBA code which attaches daily trading activity into the body of an email, attaches the workbook as an email and sends it out to the relevant groups. I've tried to incorporate VBA code which will also automatically store data from separate worksheets on to one master worksheet, however I cannot seem to get this to work.</p>\n\n<p>The code is as follows:</p>\n\n<pre><code>Sub Mail_Sheet_Outlook_Body()\n\n    Dim rng As Range\n    Dim OutApp As Object\n    Dim OutMail As Object\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set rng = Nothing\n    Set rng = ActiveSheet.UsedRange\n    rng.Offset(, rng.Columns.Count).Resize(, 1) = Date\n    Set rng = rng.Resize(, rng.Columns.Count + 1)\n    'You can also use a sheet name\n    'Set rng = Sheets(\"YourSheet\").UsedRange\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    On Error Resume Next\n    With OutMail\n        .to = \"some@mail.addr\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Today's Trades\" &amp; Date\n        .HTMLBody = RangetoHTML(rng)\n        .Attachments.Add ActiveWorkbook.FullName\n        .Send                                    'or use .Display\n    End With\n    On Error GoTo 0\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n\nFunction RangetoHTML(rng As Range)\n' Changed by Ron de Bruin 28-Oct-2006\n' Working in Office 2000-2016\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    'Copy the range and create a new workbook to past the data in\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n    'Publish the sheet to a htm file\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n\n    'Read all data from the htm file into RangetoHTML\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.readall\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                          \"align=left x:publishsource=\")\n\n    'Close TempWB\n    TempWB.Close savechanges:=False\n\n    'Delete the htm file we used in this function\n    Kill TempFile\n\n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\nEnd Function\n\nSub AppendDataAfterLastColumn()\n    Dim sh As Worksheet\n    Dim DestSh As Worksheet\n    Dim Last As Long\n    Dim CopyRng As Range\n\n    With Application\n        .ScreenUpdating = False\n        .EnableEvents = False\n    End With\n\n    'Delete the sheet \"RDBMergeSheet\" if it exist\n    Application.DisplayAlerts = False\n    On Error Resume Next\n    ActiveWorkbook.Worksheets(\"RDBMergeSheet\").Delete\n    On Error GoTo 0\n    Application.DisplayAlerts = True\n\n    'Add a worksheet with the name \"RDBMergeSheet\"\n    Set DestSh = ActiveWorkbook.Worksheets.Add\n    DestSh.Name = \"RDBMergeSheet\"\n\n    'loop through all worksheets and copy the data to the DestSh\n    For Each sh In ActiveWorkbook.Worksheets\n        If sh.Name &lt;&gt; DestSh.Name Then\n\n            'Fill in the column(s) that you want to copy\n            Set CopyRng = sh.Range(\"A:G\")\n\n            'Test if there enough rows in the DestSh to copy all the data\n            If Last + CopyRng.Columns.Count &gt; DestSh.Columns.Count Then\n                MsgBox \"There are not enough columns in the Destsh\"\n                GoTo ExitTheSub\n            End If\n\n            'This example copies values/formats and Column width\n            CopyRng.Copy\n            With DestSh.Cells(1, Last + 1)\n                .PasteSpecial 8    ' Column width\n                .PasteSpecial xlPasteValues\n                .PasteSpecial xlPasteFormats\n                Application.CutCopyMode = False\n            End With\n\n        End If\n    Next\n\nExitTheSub:\n\n    Application.Goto DestSh.Cells(1)\n\n    With Application\n        .ScreenUpdating = True\n        .EnableEvents = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>Apologies for the length of the code, however any suggestions on how I should structure the VBA in order to get it to work would be greatly appreciated.</p>\n"}, {"tags": ["excel", "vba", "formula", "bloomberg"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1537348188, "post_id": 52402066, "comment_id": 91748146, "body": "What cell or cells do you want to put this formula into?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1537348318, "post_id": 52402066, "comment_id": 91748221, "body": "Given the complex nature of the formula, it might have been a good idea to show us what it was intended to look like."}, {"owner": {"reputation": 25, "user_id": 7574665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AK5EzhYHHcs/AAAAAAAAAAI/AAAAAAAAAA8/zl7manpWlM8/photo.jpg?sz=128", "display_name": "hicham kortbi", "link": "https://stackoverflow.com/users/7574665/hicham-kortbi"}, "edited": false, "score": 0, "creation_date": 1537348595, "post_id": 52402066, "comment_id": 91748389, "body": "Yes sorry, I juste delete the cells in the first formula beaucse it was too long but I know the error is not coming from here 100% sure, it was intended to look like the 3rd formula I gave or =BDH(R[-3]C[1];&quot;PX_LAST&quot;;&quot;ED-&quot; &amp; 5 &amp; &quot;AYA&quot;;; &quot;per=d&quot;; &quot;fx=EUR&quot;;&quot;Days=W&quot;;&quot;Fill=P&quot;;&quot;cols=2&quot;)"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1537348932, "post_id": 52402066, "comment_id": 91748606, "body": "@hichamkortbi does this formula work in excel ?"}, {"owner": {"reputation": 25, "user_id": 7574665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AK5EzhYHHcs/AAAAAAAAAAI/AAAAAAAAAA8/zl7manpWlM8/photo.jpg?sz=128", "display_name": "hicham kortbi", "link": "https://stackoverflow.com/users/7574665/hicham-kortbi"}, "edited": false, "score": 0, "creation_date": 1537349149, "post_id": 52402066, "comment_id": 91748740, "body": "yes, it&#39;s working, the only thing that change from the others is the way of d and EUR are writing, it&#39;s just a problem of quoted but I don&#39;t know how to fix it"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1537349483, "post_id": 52402066, "comment_id": 91748937, "body": "You can select the cell in which you&#39;ve written this formula and open immediate window and write     ?Replace(selection.formular1c1, &quot;&quot;&quot;&quot;, &quot;&quot;&quot;&quot;&quot;&quot;) whatever you get in there you can directly use it in VBA."}, {"owner": {"reputation": 25, "user_id": 7574665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AK5EzhYHHcs/AAAAAAAAAAI/AAAAAAAAAA8/zl7manpWlM8/photo.jpg?sz=128", "display_name": "hicham kortbi", "link": "https://stackoverflow.com/users/7574665/hicham-kortbi"}, "edited": false, "score": 0, "creation_date": 1537349638, "post_id": 52402066, "comment_id": 91749019, "body": "I tried but it still not working"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1537349734, "post_id": 52402066, "comment_id": 91749080, "body": "@hichamkortbi did you put the result  inside &quot; &quot; in vba ?"}, {"owner": {"reputation": 25, "user_id": 7574665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AK5EzhYHHcs/AAAAAAAAAAI/AAAAAAAAAA8/zl7manpWlM8/photo.jpg?sz=128", "display_name": "hicham kortbi", "link": "https://stackoverflow.com/users/7574665/hicham-kortbi"}, "edited": false, "score": 0, "creation_date": 1537349914, "post_id": 52402066, "comment_id": 91749193, "body": "yes of course, it gives me this: =BDH(B2,&quot;&quot;PX_LAST&quot;&quot;,&quot;&quot;ED-&quot;&quot; &amp; 5 &amp; &quot;&quot;AYA&quot;&quot;,, &quot;&quot;per=&quot;&quot; &amp; d, &quot;&quot;fx=&quot;&quot; &amp; EUR,&quot;&quot;Days=W&quot;&quot;,&quot;&quot;Fill=P&quot;&quot;,&quot;&quot;cols=2&quot;&quot;)"}, {"owner": {"reputation": 25, "user_id": 7574665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AK5EzhYHHcs/AAAAAAAAAAI/AAAAAAAAAA8/zl7manpWlM8/photo.jpg?sz=128", "display_name": "hicham kortbi", "link": "https://stackoverflow.com/users/7574665/hicham-kortbi"}, "edited": false, "score": 0, "creation_date": 1537349939, "post_id": 52402066, "comment_id": 91749209, "body": "d and EUR are still not quoted"}, {"owner": {"reputation": 1674, "user_id": 5272396, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p7ke4.jpg?s=128&g=1", "display_name": "Imran Malek", "link": "https://stackoverflow.com/users/5272396/imran-malek"}, "edited": false, "score": 0, "creation_date": 1537350199, "post_id": 52402066, "comment_id": 91749397, "body": "@hichamkortbi strange ! It gives me correct result."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7574665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AK5EzhYHHcs/AAAAAAAAAAI/AAAAAAAAAA8/zl7manpWlM8/photo.jpg?sz=128", "display_name": "hicham kortbi", "link": "https://stackoverflow.com/users/7574665/hicham-kortbi"}, "edited": false, "score": 0, "creation_date": 1537350170, "post_id": 52402730, "comment_id": 91749374, "body": "Thank you so much, it works, I see now I put too much quotes"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1537349791, "creation_date": 1537349791, "answer_id": 52402730, "question_id": 52402066, "link": "https://stackoverflow.com/questions/52402066/vba-bloomberg-formula/52402730#52402730", "title": "VBA Bloomberg Formula", "body": "<p>I brought some of the string concatenations together where there didn't seem any reason to separate them.</p>\n\n<pre><code>workSheets(\"Data - Backtest\").Cells(5, linCompteur - 1).FormulaR1C1 = _\n  \"=BDH(R[-3]C[1], \"\"PX_LAST\"\", \"\"ED-\" &amp; .Cells(6, 5).Value &amp; \"AYA\"\", \" &amp; .Cells(7, 5).Value &amp; \", \"\"per=\" &amp; .Cells(9, 6).Value &amp; \"\"\" , \"\"fx=\" &amp; .Cells(8, 5).Value &amp; \"\"\" , \"\"Days=W\"\", \"\"Fill=P\"\", \"\"cols=2\"\")\"\n</code></pre>\n\n<p>This is the result on the worksheet.</p>\n\n<pre><code>=BDH(R[-3]C[1], \"PX_LAST\", \"ED-5AYA\", , \"per=d\" , \"fx=EUR\" , \"Days=W\", \"Fill=P\", \"cols=2\")\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7574665, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-AK5EzhYHHcs/AAAAAAAAAAI/AAAAAAAAAA8/zl7manpWlM8/photo.jpg?sz=128", "display_name": "hicham kortbi", "link": "https://stackoverflow.com/users/7574665/hicham-kortbi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 677, "favorite_count": 0, "accepted_answer_id": 52402730, "answer_count": 1, "score": 1, "last_activity_date": 1537349931, "creation_date": 1537347844, "last_edit_date": 1537349931, "question_id": 52402066, "link": "https://stackoverflow.com/questions/52402066/vba-bloomberg-formula", "title": "VBA Bloomberg Formula", "body": "<p>I have a problem with my code, here it is:</p>\n\n<pre><code>Sheets(\"Data - Backtest\").Cells(5, linCompteur - 1).FormulaR1C1 = _\n  \"=BDH(R[-3]C[1],\"\"PX_LAST\"\",\"\"ED-\"\" &amp; \" &amp; .Cells(6, 5).Value &amp; \" &amp; \"\"AYA\"\",\" &amp; .Cells(7, 5).Value &amp; \", **\"\"per=\"\" &amp; \" &amp; .Cells(9, 6).Value &amp; \"** , **\"\"fx=\"\" &amp; \" &amp; .Cells(8, 5).Value &amp; \"** ,\"\"Days=W\"\",\"\"Fill=P\"\",\"\"cols=2\"\")\"\n</code></pre>\n\n<p>In the Excel it gives this, </p>\n\n<pre><code>=BDH(R[-3]C[1];\"PX_LAST\";\"ED-\" &amp; 5 &amp; \"AYA\";; **\"per=\" &amp; d**; **\"fx=\" &amp; EUR**;\"Days=W\";\"Fill=P\";\"cols=2\")\n</code></pre>\n\n<p>I see where is the problem, it's d and EUR, it should be this:</p>\n\n<pre><code>=BDH(R[-3]C[1];\"PX_LAST\";\"ED-\" &amp; 5 &amp; \"AYA\";;**\"per=\" &amp; \"d\"**;**\"fx=\" &amp; \"EUR\"**;\"Days=W\";\"Fill=P\";\"cols=2\";\"cols=2;rows=1305\")\n</code></pre>\n\n<p>but I don't know how to do this for the equivalent in VBA.</p>\n"}, {"tags": ["excel", "vba", "range"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1537346310, "post_id": 52401537, "comment_id": 91747026, "body": "Level 1 is BCDE, not ABCD?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1537346375, "post_id": 52401537, "comment_id": 91747071, "body": "merged cells are a pest and should be avoided. Don&#39;t merge cells. Put the data into each row. You can use conditional formatting to make the thing still look nice."}, {"owner": {"reputation": 373, "user_id": 7785589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qzrscUmw13U/AAAAAAAAAAI/AAAAAAAAACA/2vFMzupxY4g/photo.jpg?sz=128", "display_name": "Luk&#225;\u0161 V&#225;clavek", "link": "https://stackoverflow.com/users/7785589/luk%c3%a1%c5%a1-v%c3%a1clavek"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1537346480, "post_id": 52401537, "comment_id": 91747143, "body": "@FunThomas yeah my mistake forgot to mention I have also level 0. Will edit this."}, {"owner": {"reputation": 373, "user_id": 7785589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qzrscUmw13U/AAAAAAAAAAI/AAAAAAAAACA/2vFMzupxY4g/photo.jpg?sz=128", "display_name": "Luk&#225;\u0161 V&#225;clavek", "link": "https://stackoverflow.com/users/7785589/luk%c3%a1%c5%a1-v%c3%a1clavek"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1537346597, "post_id": 52401537, "comment_id": 91747204, "body": "@teylyn Yes I agree, however this is huge Excel file which is used by many people, so I can&#39;t really change this, sadly."}, {"owner": {"reputation": 43423, "user_id": 1011724, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/2JAXi.jpg?s=128&g=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/1011724/dan"}, "edited": false, "score": 0, "creation_date": 1537346793, "post_id": 52401537, "comment_id": 91747320, "body": "Use <a href=\"https://exceljet.net/lessons/how-to-use-center-across-selection-in-excel\" rel=\"nofollow noreferrer\">centre across selection</a> instead of merged cells. If the sheet is really too large to change manually, you can change it using VBA (in a once-off script)."}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1537347031, "post_id": 52401537, "comment_id": 91747466, "body": "Funny, it&#39;s possible to manually select one of the columns (by clicking the column header), but when trying to do it via VBA <code>Columns(2).Select</code> it extends the selection to all joined columns..."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1537530553, "post_id": 52401537, "comment_id": 91828903, "body": "@Luk&#225;\u0161V&#225;clavek, edited an improved solution to your post using MergeCells and MergeArea property to select the wanted levels and would appreciate a short feed back if you could try my solution :-)"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1541610158, "post_id": 52401537, "comment_id": 93277310, "body": "Allow me a remark: You got two valid answers - it&#39;s good use and also helpful for other readers to mark one of them as accepted if you found it helpful (acceptance is indicated by a colored checkmark next to the answer). C.f. <a href=\"https://stackoverflow.com/help/someone-answers\">&quot;Someone answers&quot;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1537530445, "last_edit_date": 1537530445, "creation_date": 1537354847, "answer_id": 52404359, "question_id": 52401537, "link": "https://stackoverflow.com/questions/52401537/select-only-merged-cells-which-contain-specified-columns/52404359#52404359", "title": "Select only (merged) cells which contain specified column(s)", "body": "<p><strong>Select defined levels</strong></p>\n\n<blockquote>\n  <p><em>\"... So i.e <strong>level 0</strong> is <code>ABCDE</code>, <strong>level 1</strong> contains cell which merges columns <code>BCDE</code>, <strong>level 2</strong> merges only <code>CDE</code>, <strong>level 3</strong> <code>DE</code> and <strong>level 4</strong> is only <code>E</code>.\"</em> </p>\n</blockquote>\n\n<p>This approach selects all items of a given <code>Level</code> (<em>as defined above</em>) using the <code>MergeCells</code> and <code>MergeArea</code> properties to check for merged cells at the defined <code>Level</code> via helper function <code>bIsLevel()</code>.</p>\n\n<p><strong>Applied method</strong></p>\n\n<p>Basically it </p>\n\n<ol>\n<li>checks each cell <code>c</code> in a defined range *) whether it belongs to a merged cells range (<code>If c.MergeCells Then ...</code>),</li>\n<li>gets the resulting <code>c.MergeArea.Address</code>,</li>\n<li>checks found addresses against the wanted level x address via helper function <code>bIsLevel()</code></li>\n</ol>\n\n<p><strong>Note to recent Edit in 1st loop condition</strong></p>\n\n<p>*) As <code>MergeArea.Addresses</code> only show the first included range (top/left cell in merge range), it is possible to narrow the search range from e.g. <code>.UsedRange</code> to the column therein corresponding to <code>Level + 1</code>; therefore I edited <code>For Each c In Intersect(.UsedRange, .Columns(Level + 1))</code> as new loop condition instead.</p>\n\n<p><strong>Calling the main procedure <code>SelectLevel</code></strong></p>\n\n<p>Procedure <code>SelectLevel</code> has two optional parameters: (1) the wanted Level as defined by OP, (2) the qualified worksheet name. It can be called by the following example statement (<em>Note:</em> if you don't assign the <em>1st argument</em>, <strong>level</strong> <code>0</code> is assumed by default, the <em>2nd argument</em> defaults to a <em>worksheet name</em> of your choice and should be changed to your a current sheet name).  </p>\n\n<pre><code>     SelectLevel 1     ' e.g. level 1 selects all merged cells of columns B:E\n</code></pre>\n\n<p><strong>Main procedure <code>SelectLevel</code></strong> </p>\n\n<pre><code>Sub SelectLevel(Optional Level&amp; = 0, Optional ByVal SheetName$ = \"MySheet\")\nDim c As Range, rng As Range, i&amp;\nWith ThisWorkbook.Worksheets(SheetName)\n    For Each c In Intersect(.UsedRange, .Columns(Level + 1))\n        If c.MergeCells Then\n           If c.Address = Left(c.MergeArea.Address, Len(c.Address)) Then\n              If bIsLevel(c, Level) Then\n                 If rng Is Nothing Then\n                    Set rng = c\n                 Else\n                    Set rng = Application.Union(rng, c)\n                 End If\n              End If\n           End If\n        End If\n    Next\nEnd With\n' Execute selection of wanted level\nIf Not rng Is Nothing Then\n       rng.Select\nElse\n       MsgBox \"Found no LEVEL\" &amp; Level &amp; \" items.\", vbExclamation, \"No Selection\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>Helper function <code>bIsLevel()</code></strong></p>\n\n<pre><code>Function bIsLevel(currCell As Range, ByVal lvl&amp;) As Boolean\nDim LevelAddress$, CellAddress$\nDim arr(): arr = Array(\"A\", \"B\", \"C\", \"D\", \"E\")\nLevelAddress = arr(lvl) &amp; \":\" &amp; arr(UBound(arr))    ' define Level columns due to OP\nCellAddress = Split(currCell.MergeArea.Address, \"$\")(1) &amp; \":\" &amp; _\n              Split(currCell.MergeArea.Address, \"$\")(3)\nbIsLevel = (LevelAddress = CellAddress)\n\n'If bIsLevel Then Debug.Print \"cell \" &amp; currCell.Address &amp; \" in currcell.MergeArea \" &amp; currCell.MergeArea.Address &amp; _\n                         \" (\" &amp; CellAddress &amp; \" equ./LEVEL\" &amp; lvl &amp; \" \" &amp; LevelAddress &amp; \")\"\n\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1537530959, "post_id": 52412595, "comment_id": 91829153, "body": "Good point to narrow the search range and to count columns in the <code>MergeArea</code> <i>(BTW your example uses the last level column and would allow not merged cells for Level 4 as well)</i> +1. - <i>Side note to the last code line: suggest to check if <code>oSelectRange Is Nothing</code> just in case there are no found cells.</i>"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "reply_to_user": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 1, "creation_date": 1537533295, "post_id": 52412595, "comment_id": 91830438, "body": "Thanks for the feedback T.M., I&#39;ve tried it with all levels and it seems to run properly even for Level 4 (Merged Cell count for an unmerged cell is 1).  I added the optional ability to show the level of each line, to test all levels, and an image to show its results. I also updated the final line as you suggested to prevent an error in the event no cells were found."}], "tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": true, "score": 2, "last_activity_date": 1537534021, "last_edit_date": 1537534021, "creation_date": 1537383619, "answer_id": 52412595, "question_id": 52401537, "link": "https://stackoverflow.com/questions/52401537/select-only-merged-cells-which-contain-specified-columns/52412595#52412595", "title": "Select only (merged) cells which contain specified column(s)", "body": "<p>This procedure lets you chose any given range, and the level you want to select.  It determines the row's level by taking the count of columns in the given range as the number of columns required for \"Level 0\", and subtracts from it the number of columns in the merge range of the last column.</p>\n\n<p><a href=\"https://i.stack.imgur.com/BDN9Y.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BDN9Y.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>To help illustrate how it works I added an optional variable to write out the level of each row (two columns after the selected range). By default the option is to not show the levels.</p>\n\n<p>T.M.'s Suggestion to check for oSelectRange being nothing to prevent a crash when doing the selection was also added.  Thanks :)</p>\n\n<pre><code>Sub Test()\n   Call GetRowLevel(Sheet1.Range(\"A1:E8\"), 4, True)\nEnd Sub\n\nPrivate Sub GetRowLevel(ByVal SearchRange As Range, ByVal Level As Integer, Optional ShowLevel As Boolean = False)\n\n    Dim oLevel0 As Integer      ' Number of columns in Level 0\n    oLevel0 = SearchRange.Columns.Count\n\n    Dim oRowCounter As Long\n    Dim oSelectRange As Range\n    Set oSelectRange = Nothing\n\n    For oRowCounter = 1 To SearchRange.Rows.Count\n        If oLevel0 - SearchRange.Cells(oRowCounter, SearchRange.Columns.Count).MergeArea.Columns.Count = Level Then\n\n            If oSelectRange Is Nothing Then\n                Set oSelectRange = SearchRange.Cells(oRowCounter, SearchRange.Columns.Count).MergeArea\n            Else\n                Set oSelectRange = Application.Union(oSelectRange, SearchRange.Cells(oRowCounter, SearchRange.Columns.Count).MergeArea)\n            End If\n        End If\n\n        'Testing: Show Levels\n        If ShowLevel Then\n            Sheet1.Cells(oRowCounter, SearchRange.Columns.Count + 2).Value = oLevel0 - SearchRange.Cells(oRowCounter, SearchRange.Columns.Count).MergeArea.Columns.Count\n        End If\n    Next\n\n    If Not oSelectRange Is Nothing Then oSelectRange.Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 7785589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qzrscUmw13U/AAAAAAAAAAI/AAAAAAAAACA/2vFMzupxY4g/photo.jpg?sz=128", "display_name": "Luk&#225;\u0161 V&#225;clavek", "link": "https://stackoverflow.com/users/7785589/luk%c3%a1%c5%a1-v%c3%a1clavek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 52412595, "answer_count": 2, "score": 0, "last_activity_date": 1537534021, "creation_date": 1537345972, "last_edit_date": 1537407579, "question_id": 52401537, "link": "https://stackoverflow.com/questions/52401537/select-only-merged-cells-which-contain-specified-columns", "title": "Select only (merged) cells which contain specified column(s)", "body": "<p>So right now I'm developing VBA macro which will be able to select only cells which meet specified conditions. The problem is I have nested list with multiple level cells. Each level is determined by amount of <strong>columns merged</strong>. So i.e <strong>level</strong> <strong>0</strong> is <code>ABCDE</code>, level <strong>1</strong> contains cell which merges columns <code>BCDE</code>, level <strong>2</strong> merges only <code>CDE</code>, level <strong>3</strong> <code>DE</code> and level <strong>4</strong> is only <code>E</code>. Please see attached image for better visualization <a href=\"https://i.stack.imgur.com/rpYFi.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rpYFi.jpg\" alt=\"enter image description here\"></a>. The problem is i cannot just select columns as it would select all levels at once.</p>\n\n<p>So let's say I want to select only <strong>level 1</strong> cells (so cell which is merged from columns <code>BCDE</code> *) - <em>how can I do that in VBA?</em> </p>\n\n<p>Thank you</p>\n\n<p>*) <em><code>ABCD</code> in original post (c.f. comment)</em></p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1537357248, "post_id": 52401097, "comment_id": 91753781, "body": "<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.PasteSpecial\" rel=\"nofollow noreferrer\"><code>Range.PasteSpecial</code></a> and <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.worksheet.PasteSpecial\" rel=\"nofollow noreferrer\"><code>Worksheet.PasteSpecial</code></a> are <i>completely</i> different actions, and cannot be swapped as easily as <code>Range.Paste</code> and <code>Worksheet.Paste</code> can."}], "answers": [{"comments": [{"owner": {"reputation": 513, "user_id": 7760065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664b02c10f8e6947e912bdfe62b18bdb?s=128&d=identicon&r=PG&f=1", "display_name": "J.Mapz", "link": "https://stackoverflow.com/users/7760065/j-mapz"}, "reply_to_user": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 1, "creation_date": 1537349097, "post_id": 52401269, "comment_id": 91748712, "body": "Have you tried <code>Selection.PasteSpecial Paste:=xlPasteValues</code> instead?"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537357594, "post_id": 52401269, "comment_id": 91754000, "body": "@Peter <i>How</i> does it &quot;not work&quot;?  Does it give an error message?  Paste the wrong data?  Paste data in the wrong place? Crash your computer?  Summon Cthulhu?  Have you tried stepping through with <code>F8</code> to see on which line it stops working as expected?"}, {"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537361514, "post_id": 52401269, "comment_id": 91756270, "body": "I am sorry. It says &quot;Run-time error &#39;424&#39; Object required&quot;. Any ideas? I google it myself but just cannot figure out a solution."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 1, "creation_date": 1537435819, "post_id": 52401269, "comment_id": 91786734, "body": "@Peter The sounds like your <code>Selection</code> is not valid for Pasting to.  Fully Qualified ranges should be able to avoid this, e.g. <code>Sheets(&quot;ZSM&quot;).Range(&quot;B5&quot;).PasteSpecial Paste:=xlPasteValues</code>"}], "tags": [], "owner": {"reputation": 513, "user_id": 7760065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/664b02c10f8e6947e912bdfe62b18bdb?s=128&d=identicon&r=PG&f=1", "display_name": "J.Mapz", "link": "https://stackoverflow.com/users/7760065/j-mapz"}, "is_accepted": false, "score": 3, "last_activity_date": 1537349049, "last_edit_date": 1537349049, "creation_date": 1537345093, "answer_id": 52401269, "question_id": 52401097, "link": "https://stackoverflow.com/questions/52401097/paste-values-instead-of-formulas-with-pastespecial-vbanewbie/52401269#52401269", "title": "Paste Values instead of formulas with PasteSpecial - VBANewbie", "body": "<p>You can try replacing those <code>Activesheet.PasteSpecial</code> as:</p>\n\n<pre><code>Selection.PasteSpecial Paste:=xlPasteValues\n</code></pre>\n\n<p>This will paste your selected range as just values.</p>\n"}, {"comments": [{"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537346601, "post_id": 52401314, "comment_id": 91747208, "body": "That does work, but only for my first &quot;Select part&quot; because the first paste-Part always starts at B5. The second paste part from my tab &quot;Bonds&quot; does not start at a certain cell because it depends on the size of the table from tab &quot;Equities&quot;. Any ideas how I can format my formula after                                    ActiveCell.Offset(1, 1).Select     // ActiveSheet.PasteSpecial           ###here"}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "reply_to_user": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537347355, "post_id": 52401314, "comment_id": 91747647, "body": "You should find the last row in a more dynamic way. Here is a great article on how you could do it: <a href=\"https://www.thespreadsheetguru.com/blog/2014/7/7/5-different-ways-to-find-the-last-row-or-last-column-using-vba\" rel=\"nofollow noreferrer\">thespreadsheetguru.com/blog/2014/7/7/&hellip;</a>"}, {"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537348785, "post_id": 52401314, "comment_id": 91748521, "body": "Selection.End(xlDown).Select //     Selection.End(xlToRight).Select //     LasActiveCell.Offset(1, 1).Select //     Range(&quot;???&quot;).PasteSpecial xlPasteValues   //              I read the article. I figured out how to find the last row in a dynamic way (see first code lines). But I do not know how to pass the last dynamic row/column as a range to my Methode &quot;???&quot;. Any ideas?            End Sub"}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "reply_to_user": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537349079, "post_id": 52401314, "comment_id": 91748700, "body": "You should hold it in a variable of type long. Something like: Dim lastRow as Long Please check Jeeped answer - he did all the work for you :)"}], "tags": [], "owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "is_accepted": false, "score": 3, "last_activity_date": 1537345264, "creation_date": 1537345264, "answer_id": 52401314, "question_id": 52401097, "link": "https://stackoverflow.com/questions/52401097/paste-values-instead-of-formulas-with-pastespecial-vbanewbie/52401314#52401314", "title": "Paste Values instead of formulas with PasteSpecial - VBANewbie", "body": "<p>You should use <code>xlPasteValues</code>. Example:</p>\n\n<pre><code>Range(\"B5\").PasteSpecial xlPasteValues\n</code></pre>\n\n<p>If you prefer formulas you could use <code>xlPasteFormulas</code>.</p>\n\n<p><strong>I strongly advise to read this article</strong> on how to avoid using <code>Select</code>:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a></p>\n"}, {"comments": [{"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537354087, "post_id": 52401962, "comment_id": 91751881, "body": "It cannot be combined because I have other programmes runnig which forbid a combination. Unfortunately, that does not work. Not all rows get transfered and not all values get transferred...Any idea how I can show you what your code with my values does?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 1, "creation_date": 1537366067, "post_id": 52401962, "comment_id": 91759282, "body": "I don&#39;t often ask for screenshots but it would help to see a limited amount of data (particularly troublesome areas) and expected results. I honestly cannot determine what is wrong from your narrative of your problem nor your your code."}, {"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537366937, "post_id": 52401962, "comment_id": 91759866, "body": "yeah sure. How can I send you screenshots? :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 1, "creation_date": 1537367003, "post_id": 52401962, "comment_id": 91759903, "body": "You can edit your question and upload them to be visible there."}, {"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537368062, "post_id": 52401962, "comment_id": 91760575, "body": "Done. Does that help? Thanks a lot for your time. I really appreciate it!"}, {"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537371768, "post_id": 52401962, "comment_id": 91762936, "body": "Thank you very much! You helped me a lot. I am also curious what you have exactly done. As I said I am new to vba and want to understand the logic behnd it. Can you explain the code a bit and why you chose the following approach to solve it @Jeeped ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 1, "creation_date": 1537372437, "post_id": 52401962, "comment_id": 91763317, "body": "a) Avoid Select whenever possible. b) Avoid the clipboard whenever possible. c) Define a range by referencing two opposite corners, not by extending the current Selection. d) Looking from the bottom up and from the extreme right up and left is less prone to errors than looking down and to the right."}, {"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537374884, "post_id": 52401962, "comment_id": 91764701, "body": "Thanks a lot!! What do mean by clipboard? The recording?? Any good websites or tutorials I could use to pick vba up fast? :)"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 2, "creation_date": 1537435713, "post_id": 52401962, "comment_id": 91786665, "body": "@Peter By &quot;Avoid the clipboard&quot; Jeeped means it&#39;s better to use <code>DestRange = SourceRange.Value</code> or <code>SourceRange.Copy Destination:=DestRange</code> to move the data directly, instead of <code>SourceRange.Copy: DestRange.Paste</code> to Copy it to the Clipboard and then Paste it"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 5, "last_activity_date": 1537370627, "last_edit_date": 1537370627, "creation_date": 1537347406, "answer_id": 52401962, "question_id": 52401097, "link": "https://stackoverflow.com/questions/52401097/paste-values-instead-of-formulas-with-pastespecial-vbanewbie/52401962#52401962", "title": "Paste Values instead of formulas with PasteSpecial - VBANewbie", "body": "<p>Using the direct value transfer methods described in your <a href=\"https://stackoverflow.com/questions/52389836\">last question</a>, I've come up with this.</p>\n\n<p>Each part of the transfer is labelled so you can split the individual routines apart as needed.</p>\n\n<pre><code>Option Explicit\n\nSub AllesAufEinmal()\n\n    Dim tws As Worksheet\n\n    Set tws = Worksheets(\"ZSM\")\n\n    Call Spalten(tws)\n    'Call Wertpapiere(tws)\n    'Call Daten(tws)\n\nEnd Sub\n\nSub Spalten(zsm As Worksheet)\n' Spalten Macro\n\n    'headers, ISIN and data from from Equities\n    With Worksheets(\"Equities\")\n        With .Range(.Cells(.Rows.Count, \"A\").End(xlUp), .Cells(4, .Columns.Count).End(xlToLeft))\n            zsm.Cells(4, \"A\").Resize(.Rows.Count, .Columns.Count) = .Value\n        End With\n    End With\n\n    'headers from Bonds\n    With Worksheets(\"Bonds\")\n        With .Range(.Cells(4, \"B\"), .Cells(4, .Columns.Count).End(xlToLeft))\n            zsm.Cells(4, zsm.Columns.Count).End(xlToLeft).Offset(0, 1).Resize(.Rows.Count, .Columns.Count) = .Value\n        End With\n    End With\n\n    'ISIN from Bonds\n    With Worksheets(\"Bonds\")\n        With .Range(.Cells(5, \"A\"), .Cells(.Rows.Count, \"A\").End(xlUp))\n            zsm.Cells(zsm.Rows.Count, \"A\").End(xlUp).Offset(1, 0).Resize(.Rows.Count, .Columns.Count) = .Value\n        End With\n    End With\n\n    'data from Bonds\n    With Worksheets(\"Bonds\")\n        With .Range(.Cells(.Rows.Count, \"B\").End(xlUp), .Cells(5, .Columns.Count).End(xlToLeft))\n            zsm.Cells(zsm.Cells(zsm.Rows.Count, \"B\").End(xlUp).Row, _\n                      zsm.Cells(5, zsm.Columns.Count).End(xlToLeft).Column). _\n                Offset(1, 1).Resize(.Rows.Count, .Columns.Count) = .Value\n        End With\n    End With\n\nEnd Sub\n</code></pre>\n\n<p>'Best practice' dictates that you should <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid Select</a> and provide proper parent worksheet references. To this end, I've passed the target worksheet reference to each 'helper' sub procedure as a parameter.</p>\n"}], "owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 52401962, "answer_count": 3, "score": 1, "last_activity_date": 1537370627, "creation_date": 1537344489, "last_edit_date": 1537368034, "question_id": 52401097, "link": "https://stackoverflow.com/questions/52401097/paste-values-instead-of-formulas-with-pastespecial-vbanewbie", "title": "Paste Values instead of formulas with PasteSpecial - VBANewbie", "body": "<p>I am absolutely new to vba. I want to copy certain values in cells from two tabs (\"Equities\", \"Bonds\") into a third one (\"ZSM\") with the following code.</p>\n\n<pre><code>Sub AllesAufEinmal()\n\n    Call Spalten\n    Call Wertpapiere\n    Call Daten\n\nEnd Sub\n\nSub Spalten()\n'\n' Spalten Macro\n'\n    Sheets(\"Equities\").Select\n    Range(\"A4\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(\"ZSM\").Select\n    Range(\"A4\").Select\n    ActiveSheet.Paste\n    Range(\"A4\").Select\n    Sheets(\"Bonds\").Select\n    Range(\"B4\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"ZSM\").Select\n    Selection.End(xlToRight).Select\n    ActiveCell.Offset(0, 1).Select\n    ActiveSheet.Paste\n    Range(\"A4\").Select\nEnd Sub\n\nSub Wertpapiere()\n'\n' Wertpapiere Macro\n'\n\n'\n    Sheets(\"Equities\").Select\n    Range(\"A5\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"ZSM\").Select\n    Range(\"A5\").Select\n    ActiveSheet.Paste\n    Range(\"A5\").Select\n    Sheets(\"Bonds\").Select\n    Range(\"A5\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"ZSM\").Select\n    Selection.End(xlDown).Select\n    ActiveCell.Offset(1, 0).Select\n    ActiveSheet.Paste\n    Range(\"A5\").Select\nEnd Sub\n\nSub Daten()\n'\n' Daten Macro\n'\n\n'\n    Sheets(\"Equities\").Select\n    Range(\"B5\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(\"ZSM\").Select\n    Range(\"B5\").Select\n    ActiveSheet.Paste\n    Sheets(\"Bonds\").Select\n    Range(\"B5\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(\"ZSM\").Select\n    Range(\"B5\").Select\n    Selection.End(xlDown).Select\n    Selection.End(xlToRight).Select\n    ActiveCell.Offset(1, 1).Select\n    ActiveSheet.Paste\n\n\nEnd Sub\n</code></pre>\n\n<p>That works fine until I wanted to modify the code in a way so that my vba code copies the values from my formulas in the two tabs (\"Equities, Bonds\") into my third tab (\"ZSM\"). I really only want the value the formula gives back from formulas like \"= J5*K24\" to be copied. That did not work even though I modified the code the following way (changes marked with \"###here\"):</p>\n\n<pre><code>Sub AllesAufEinmal()\n\n    Call Spalten\n    Call Wertpapiere\n    Call Daten\n\nEnd Sub\n\nSub Spalten()\n'\n' Spalten Macro\n'\n    Sheets(\"Equities\").Select\n    Range(\"A4\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(\"ZSM\").Select\n    Range(\"A4\").Select\n    ActiveSheet.Paste\n    Range(\"A4\").Select\n    Sheets(\"Bonds\").Select\n    Range(\"B4\").Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Sheets(\"ZSM\").Select\n    Selection.End(xlToRight).Select\n    ActiveCell.Offset(0, 1).Select\n    ActiveSheet.Paste\n    Range(\"A4\").Select\nEnd Sub\n\nSub Wertpapiere()\n'\n' Wertpapiere Macro\n'\n\n'\n    Sheets(\"Equities\").Select\n    Range(\"A5\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"ZSM\").Select\n    Range(\"A5\").Select\n    ActiveSheet.Paste\n    Range(\"A5\").Select\n    Sheets(\"Bonds\").Select\n    Range(\"A5\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.Copy\n    Sheets(\"ZSM\").Select\n    Selection.End(xlDown).Select\n    ActiveCell.Offset(1, 0).Select\n    ActiveSheet.Paste\n    Range(\"A5\").Select\nEnd Sub\n\nSub Daten()\n'\n' Daten Macro\n'\n\n'\n    Sheets(\"Equities\").Select\n    Range(\"B5\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(\"ZSM\").Select\n    Range(\"B5\").Select\n    ActiveSheet.PasteSpecial                ###here\n    Sheets(\"Bonds\").Select\n    Range(\"B5\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(\"ZSM\").Select\n    Range(\"B5\").Select\n    Selection.End(xlDown).Select\n    Selection.End(xlToRight).Select\n    ActiveCell.Offset(1, 1).Select\n    ActiveSheet.PasteSpecial           ###here\n\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas? I read a bit about the PasteSpecial Methode but could not apply it to my problem at this stage.</p>\n\n<p>Thank your for your help! I would really appreciate your support.</p>\n\n<p>EDIT: Screenshots as requested\nAttention: The column ISIN should only be there once in tab \"ZSM\". It should be possible to extend columns and rows.\n<a href=\"https://i.stack.imgur.com/NxSI9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NxSI9.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "macos", "runtime"], "comments": [{"owner": {"reputation": 2954, "user_id": 6387479, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MU0ok.jpg?s=128&g=1", "display_name": "Glitch_Doctor", "link": "https://stackoverflow.com/users/6387479/glitch-doctor"}, "edited": false, "score": 0, "creation_date": 1537344449, "post_id": 52400907, "comment_id": 91745962, "body": "<code>ActiveSheet.Range(&quot;G5&quot;)</code> is a cell reference, use <code>ActiveSheet.Range(&quot;G5&quot;).Value</code> to get it&#39;s value. It might help to use <code>Option Explicit</code> at the start of the module and defining all variables like <code>Dim pdfName As String</code>, it will help when it comes to line by line debugging with F8... You should be able to use the string you defined later on: <code>FileSaveName = pdfName</code>"}, {"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 1, "creation_date": 1537345513, "post_id": 52400907, "comment_id": 91746552, "body": "If you are using Excel 2016, the colon is not the right path separator. You should replace the <code>&quot;:&quot;</code> with <code>application.pathseparator</code> anyway."}], "owner": {"reputation": 1, "user_id": 10384339, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155506724106244/picture?type=large", "display_name": "Ramo", "link": "https://stackoverflow.com/users/10384339/ramo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593592589, "creation_date": 1537343860, "last_edit_date": 1593592589, "question_id": 52400907, "link": "https://stackoverflow.com/questions/52400907/excel-mac-macro", "title": "Excel Mac macro", "body": "<p>Newbie just trying to make Excel (Mac) save a sheet as a PDF, which also saves the filename as a cell name. I have got it to work in my Windows Excel, but runtime error within Mac. Please help.</p>\n\n<pre><code>Sub CommandButton1_Click()\n    pdfName = ActiveSheet.Range(\"G5\") 'PDF name\n    ChDir ActiveWorkbook.Path &amp; \":\" 'Use the files directory\n    FileSaveName = ActiveSheet.Range(\"G5\") 'Name the PDF file\n\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _\n    FileSaveName, Quality:=xlQualityStandard, IncludeDocProperties:=True, OpenAfterPublish:=False\n\n    MsgBox \"File Saved as \" &amp; \" \" &amp; FileSaveName\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9506, "user_id": 2312614, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ra7Jm.jpg?s=128&g=1", "display_name": "Subodh Tiwari sktneer", "link": "https://stackoverflow.com/users/2312614/subodh-tiwari-sktneer"}, "edited": false, "score": 0, "creation_date": 1537338791, "post_id": 52399465, "comment_id": 91743006, "body": "Is Sheet2 a variable which holds the Sheet Name? Otherwise it should be surrounded with double quotes like this: <code>Workbooks(&quot;Published Articles Tracker v3.0.xlsm&quot;).Sheets(&quot;Sheet2&quot;).Activate</code>"}, {"owner": {"reputation": 3812, "user_id": 1481116, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7d0c940ad90baf5f93d7ab07933d2e17?s=128&d=identicon&r=PG", "display_name": "Luuklag", "link": "https://stackoverflow.com/users/1481116/luuklag"}, "edited": false, "score": 1, "creation_date": 1537339426, "post_id": 52399465, "comment_id": 91743329, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>"}, {"owner": {"reputation": 1629, "user_id": 5379555, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PrDxe.jpg?s=128&g=1", "display_name": "Pawel Czyz", "link": "https://stackoverflow.com/users/5379555/pawel-czyz"}, "edited": false, "score": 2, "creation_date": 1537343195, "post_id": 52399465, "comment_id": 91745307, "body": "What is the error message?"}], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 0, "last_activity_date": 1537362740, "creation_date": 1537362740, "answer_id": 52406689, "question_id": 52399465, "link": "https://stackoverflow.com/questions/52399465/reference-workbooks-with-a-workbook-that-has-spaces-in-between-its-file-name/52406689#52406689", "title": "reference workbooks() with a workbook that has spaces in between its file name", "body": "<p>Use variables to point to your workbooks, and your sheets - it's faster, easier to read, and less of a pain to change if the name has to alter.</p>\n\n<pre><code>Global ThatWorkbook as Workbook\n'NB ThisWorkbook is predefined by VB to refer to whichever \n 'workbook is hosting the code\n\n\nSub Disambiguate()\ndim wb as workbook\n\nfor each wb in workbooks\n    if wb.name =\"\"Published Articles Tracker v3.0.xlsm\" then\n         Set ThatWorkbook = wb\n         Exit For\n     End If\n Next ws\n If ThatWorkbook is Nothing then \n    MSGBOX \"File Not Found\",vbOkOnly,\"No Workbook\"\n End IF\n End sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10340114, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2HXFzbDU9PA/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaP33TTvvQn79WZCAh1PaqxCEPiENA/mo/photo.jpg?sz=128", "display_name": "Vba_Build05", "link": "https://stackoverflow.com/users/10340114/vba-build05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 383, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1537362740, "creation_date": 1537338482, "question_id": 52399465, "link": "https://stackoverflow.com/questions/52399465/reference-workbooks-with-a-workbook-that-has-spaces-in-between-its-file-name", "title": "reference workbooks() with a workbook that has spaces in between its file name", "body": "<p>I work with multiple workbooks open at the same time to track articles that I write. Both workbooks has respective macros and user forms that edit its data, one of which has a modeless userform. How can I make sure that the modeless userform do changes on the right workbook. I've tried referencing, Workbooks(\"Published Articles Tracker v3.0.xlsm\").Sheets(Sheet2).Activate, but it always return an error. I would like to keep referencing my workbook using workbooks() method but I think the problem is the format of my filename, but if possible I'd like to keep it this way. Any thoughts? </p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1537338065, "post_id": 52399106, "comment_id": 91742670, "body": "In order to create folders on the go, you need VBA to handle all inbound emails from a Rule. But note this way only works when Outlook is running."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537339257, "post_id": 52399106, "comment_id": 91743238, "body": "Other than the <i>creation</i> of folders, you can do all of that without VBA, using Rules. (<a href=\"https://www.slipstick.com/outlook/rules/create-rules-that-apply-to-an-entire-domain/\" rel=\"nofollow noreferrer\">rules for domains</a> as well as <a href=\"https://stackoverflow.com/q/5098893/8112776\">Create folder based on email</a>)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1537339269, "post_id": 52399106, "comment_id": 91743249, "body": "Note that you may need to re-enable the &quot;run a script&quot; option in Rule actions, which was removed by Microsoft at some point for security reasons. See <a href=\"https://support.microsoft.com/en-us/help/306108/how-to-create-a-script-for-the-rules-wizard-in-outlook\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://www.msoutlook.info/question/run-a-script-rule-action-is-no-longer-working-or-available\" rel=\"nofollow noreferrer\">this</a>.  Also - welcome! Be sure to check out the <a href=\"https://stackoverflow.com/tour\">tour</a> (you&#39;ll earn your first badge!)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10383835, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155787774638848/picture?type=large", "display_name": "Michael Ohlsson", "link": "https://stackoverflow.com/users/10383835/michael-ohlsson"}, "edited": false, "score": 0, "creation_date": 1537430126, "post_id": 52416971, "comment_id": 91783540, "body": "Thanks for the above code, I have that code running and it works ok, not the full way. It Creates the senders folder, wich is correct, but It didnt create the &quot;senders domain&quot; folder frist and in the senders domain folder create the senders name.  I really appreciate the effort, but it didnt work the full way:( If some1 can modify the above code so that it does the following Create &quot;senders&quot; domain name as a folder(has to be checked ofcourse) and in the domain create a folder with Senders Name, and then move the msg into the senders names folder wich is in the domain name folder."}], "tags": [], "owner": {"reputation": 293, "user_id": 10025039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4c1e4aa063ea5bcc59fcb59286fb08?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Li", "link": "https://stackoverflow.com/users/10025039/simon-li"}, "is_accepted": false, "score": 0, "last_activity_date": 1537412733, "creation_date": 1537412733, "answer_id": 52416971, "question_id": 52399106, "link": "https://stackoverflow.com/questions/52399106/create-a-folder-based-on-domain-and-in-that-folder-create-a-folder-based-on-send/52416971#52416971", "title": "Create a folder based on domain and in that folder create a folder based on sender name", "body": "<p>Please refer to this code, however, you may need to change something as your special request.</p>\n\n<pre><code>Private WithEvents Items As Outlook.Items\n\nPrivate Sub Application_Startup()\nDim olApp As Outlook.Application\nDim objNS As Outlook.NameSpace\n\n  ' set object reference to default Inbox\n  Set olApp = Outlook.Application\n  Set objNS = olApp.GetNamespace(\"MAPI\")\n  Set Items = objNS.GetDefaultFolder(olFolderInbox).Items\nEnd Sub\n\nPrivate Sub Items_ItemAdd(ByVal item As Object)\n' fires when new item added to default Inbox\n' (per Application_Startup)\n\n  On Error GoTo ErrorHandler\n\n  Dim Msg As Outlook.MailItem\n  Dim olApp As Outlook.Application\n  Dim objNS As Outlook.NameSpace\n  Dim targetFolder As Outlook.MAPIFolder\n  Dim senderName As String\n\n  ' don't do anything for non-Mailitems\n  If TypeName(item) &lt;&gt; \"MailItem\" Then GoTo ProgramExit\n\n  Set Msg = item\n\n  ' move received email to target folder based on sender name\n  senderName = Msg.senderName\n\n  If CheckForFolder(senderName) = False Then  ' Folder doesn't exist\n    Set targetFolder = CreateSubFolder(senderName)\n  Else\n    Set olApp = Outlook.Application\n    Set objNS = olApp.GetNamespace(\"MAPI\")\n    Set targetFolder = _\n    objNS.GetDefaultFolder(olFolderInbox).Folders(senderName)\n  End If\n\n  Msg.Move targetFolder\n\nProgramExit:\n  Exit Sub\nErrorHandler:\n  MsgBox Err.Number &amp; \" - \" &amp; Err.Description\n  Resume ProgramExit\nEnd Sub\n\nFunction CheckForFolder(strFolder As String) As Boolean\n' looks for subfolder of specified folder, returns TRUE if folder exists.\nDim olApp As Outlook.Application\nDim olNS As Outlook.Namespace\nDim olInbox As Outlook.MAPIFolder\nDim FolderToCheck As Outlook.MAPIFolder\n\nSet olApp = Outlook.Application\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet olInbox = olNS.GetDefaultFolder(olFolderInbox)\n\n' try to set an object reference to specified folder\nOn Error Resume Next\nSet FolderToCheck = olInbox.Folders(strFolder)\nOn Error Goto 0\n\nIf Not FolderTocheck Is Nothing Then\n  CheckForFolder = True\nEnd If\n\nExitProc:\nSet FolderToCheck = Nothing\nSet olInbox = Nothing\nSet olNS = Nothing\nSet olApp = Nothing\nEnd Function\n\nFunction CreateSubFolder(strFolder As String) As Outlook.MAPIFolder\n' assumes folder doesn't exist, so only call if calling sub knows that\n' the folder doesn't exist; returns a folder object to calling sub\nDim olApp As Outlook.Application\nDim olNS As Outlook.Namespace\nDim olInbox As Outlook.MAPIFolder\n\nSet olApp = Outlook.Application\nSet olNS = olApp.GetNamespace(\"MAPI\")\nSet olInbox = olNS.GetDefaultFolder(olFolderInbox)\n\nSet CreateSubFolder = olInbox.Folders.Add(strFolder)\n\nExitProc:\nSet olInbox = Nothing\nSet olNS = Nothing\nSet olApp = Nothing\nEnd Function\n</code></pre>\n\n<p>More information, please see, </p>\n\n<p><a href=\"https://superuser.com/questions/489124/create-new-folder-for-new-sender-name-and-move-message-into-new-folder\">Create new folder for new sender name and move message into new folder</a></p>\n"}], "owner": {"reputation": 1, "user_id": 10383835, "user_type": "registered", "profile_image": "https://graph.facebook.com/10155787774638848/picture?type=large", "display_name": "Michael Ohlsson", "link": "https://stackoverflow.com/users/10383835/michael-ohlsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 296, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1611870149, "creation_date": 1537336819, "last_edit_date": 1543157392, "question_id": 52399106, "link": "https://stackoverflow.com/questions/52399106/create-a-folder-based-on-domain-and-in-that-folder-create-a-folder-based-on-send", "title": "Create a folder based on domain and in that folder create a folder based on sender name", "body": "<p>I want a macro/rule/code that creates a folder in Outlook based on the sender's domain, after that I want it to create a folder based on the sender's name in the sender's domain folder, and then move the mail to that folder.</p>\n\n<p>I am thinking of a folder layout like this:</p>\n\n<blockquote>\n  <p>Inbox\\@senders domain\\@Senders name\\Email.msg</p>\n</blockquote>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 10383703, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MFMQgfAVsUI/AAAAAAAAAAI/AAAAAAAABFc/_Z5kGcBDkgU/photo.jpg?sz=128", "display_name": "Bilal", "link": "https://stackoverflow.com/users/10383703/bilal"}, "edited": false, "score": 0, "creation_date": 1537340044, "post_id": 52399093, "comment_id": 91743653, "body": "Thankyou... Worked"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1537336779, "creation_date": 1537336779, "answer_id": 52399093, "question_id": 52398701, "link": "https://stackoverflow.com/questions/52398701/sending-specific-sheet-in-workbook-to-specified-email-stored-in-a-sheet/52399093#52399093", "title": "Sending specific sheet in Workbook to Specified email stored in a sheet", "body": "<p>If the code you are showing is complete, <code>i</code> does not have a value is is defaulting to 0. Any ranges you state referencing <code>i</code> will error out since there is no row or column index equal to 0. </p>\n\n<p>You need to give <code>i</code> a value larger than 0</p>\n"}], "owner": {"reputation": 15, "user_id": 10383703, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-MFMQgfAVsUI/AAAAAAAAAAI/AAAAAAAABFc/_Z5kGcBDkgU/photo.jpg?sz=128", "display_name": "Bilal", "link": "https://stackoverflow.com/users/10383703/bilal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 52399093, "answer_count": 1, "score": 0, "last_activity_date": 1593702602, "creation_date": 1537334925, "last_edit_date": 1593702602, "question_id": 52398701, "link": "https://stackoverflow.com/questions/52398701/sending-specific-sheet-in-workbook-to-specified-email-stored-in-a-sheet", "title": "Sending specific sheet in Workbook to Specified email stored in a sheet", "body": "<p>I have written a code for sending emails stored in sheet5 with an attachment, any one sheet of the workbook . When name of sheet matches with value in column A, it should select email from Column B and attach the sheet with same Name.</p>\n\n<pre><code>For Each sh In ThisWorkbook.Worksheets\n\n    Dim i As Integer\n\n    While (Sheet5.Cells(1, i) &lt;&gt; vbNullString)\n\n    If (sh.Name = Sheet5.Range(\"a\" &amp; i).Value) Then\n        sh.Copy\n        Set wb = ActiveWorkbook\n\n        TempFileName = \"Sheet \" &amp; sh.Name &amp; \" of \" _\n                     &amp; ThisWorkbook.Name &amp; \" \" &amp; Format(Now, \"dd-mmm-yy h-mm-ss\")\n\n        Set OutMail = OutApp.CreateItem(0)\n\n        With wb\n            .SaveAs TempFilePath &amp; TempFileName &amp; FileExtStr, FileFormat:=FileFormatNum\n\n            On Error Resume Next\n            With OutMail\n                .To = Sheet5.Range(\"b\" &amp; i).Value\n                .CC = Sheet5.Range(\"c\" &amp; i).Value\n                .BCC = \"\"\n                .Subject = \"This is the Subject line\"\n                .Body = \"Hi there\"\n                .Attachments.Add wb.FullName\n                .Display\n            End With\n            On Error GoTo 0\n\n            .Close savechanges:=False\n        End With\n\n        Set OutMail = Nothing\n\n        Kill TempFilePath &amp; TempFileName &amp; FileExtStr\nEnd If\n\nWend\n\nNext sh\n</code></pre>\n\n<blockquote>\n  <p>' i am getting error at while loop \"While (Sheet5.Cells(1, i) &lt;>\n  vbNullString)\" and at If statement \"If (sh.Name = Sheet5.Range(\"a\" &amp;\n  i).Value) Then\"</p>\n</blockquote>\n\n<p>Please guide   </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537336020, "post_id": 52398364, "comment_id": 91741752, "body": "does the order matter? It will be easiest to just go from 1 to the end"}, {"owner": {"reputation": 3, "user_id": 10383613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1fa4caf694b854ed236e1e029773028?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson Privett", "link": "https://stackoverflow.com/users/10383613/jackson-privett"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537337519, "post_id": 52398364, "comment_id": 91742411, "body": "Not at all, I&#39;m just not sure of the code to write it. I need a print out for each individual value though as vlookup code will interact with each value differently"}], "answers": [{"tags": [], "owner": {"reputation": 5737, "user_id": 6585761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76d1d8bce62ffccde07f6515e0a12f56?s=128&d=identicon&r=PG&f=1", "display_name": "Domenic", "link": "https://stackoverflow.com/users/6585761/domenic"}, "is_accepted": false, "score": 0, "last_activity_date": 1537365469, "creation_date": 1537365469, "answer_id": 52407636, "question_id": 52398364, "link": "https://stackoverflow.com/questions/52398364/vba-code-to-cycle-through-listbox-values-copy-to-cell-and-print/52407636#52407636", "title": "vba code to cycle through listbox values, copy to cell and print?", "body": "<p>The following code will loop through each item within your listbox.  For each item, the value is entered in C8 and the worksheet is printed...</p>\n\n<pre><code>Dim vOrigVal As Variant\nDim ws As Worksheet\nDim i As Long\n\nSet ws = ThisWorkbook.Worksheets(\"Gym Weekly Template\")\n\nvOrigVal = ws.Range(\"C8\").Value\n\nWith Me.ListBox1\n    For i = 0 To .ListCount - 1\n        ws.Range(\"C8\").Value = .List(i)\n        ws.PrintOut\n    Next i\nEnd With\n\nws.Range(\"C8\").Value = vOrigVal\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10383613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1fa4caf694b854ed236e1e029773028?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson Privett", "link": "https://stackoverflow.com/users/10383613/jackson-privett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 391, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537365469, "creation_date": 1537333073, "last_edit_date": 1537333669, "question_id": 52398364, "link": "https://stackoverflow.com/questions/52398364/vba-code-to-cycle-through-listbox-values-copy-to-cell-and-print", "title": "vba code to cycle through listbox values, copy to cell and print?", "body": "<p>I need a code that will copy the first value in my ListBox2 to cell C8 in sheet called \"Gym Weekly Template\" (which is Sheet1), print the sheet and then loop to the next value and repeat the same process, repeating until all the values in the ListBox2 has been copied and printed, in which I want the sheet to reset to how it appeared prior to the code running.</p>\n\n<p>Is anyone able to help with that?</p>\n\n<p>Thank you!</p>\n\n<p>Jackson</p>\n\n<p>I currently have written the following code for selecting the first value</p>\n\n<pre><code>Dim i As Long\n    For i = ListBox1.ListCount - 1 To 0 Step -1\n        ListBox2.ListIndex = I\n    Next i\n</code></pre>\n"}, {"tags": ["excel", "vba", "scatter-plot"], "answers": [{"tags": [], "owner": {"reputation": 383, "user_id": 9452116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SB6xg.jpg?s=128&g=1", "display_name": "TempleGuard527", "link": "https://stackoverflow.com/users/9452116/templeguard527"}, "is_accepted": false, "score": 0, "last_activity_date": 1537367649, "creation_date": 1537367649, "answer_id": 52408338, "question_id": 52398314, "link": "https://stackoverflow.com/questions/52398314/changing-the-shape-of-the-specific-dots-in-scatter-plot-excel-based-on-values/52408338#52408338", "title": "Changing the shape of the specific dots in scatter plot excel based on values", "body": "<p>Something like this should work.  I actually learned a bit in researching the answer.  I didn't know how to use <code>Select Case</code>.  Thanks for asking the question!</p>\n\n<p>If you'd like to add more shape options, see this article:\n<a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.series.markerstyle\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.series.markerstyle</a></p>\n\n<p>My example data and result:\n<a href=\"https://i.stack.imgur.com/Cpw37.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Cpw37.png\" alt=\"Example Chart\"></a></p>\n\n<pre><code>Sub ColorScatterPoints3()\n    Dim cht As Chart\n    Dim srs As Series\n    Dim pt As Point\n    Dim p As Long\n    Dim Vals$, lTrim#, rTrim#\n    Dim valRange As Range, cl As Range\n    Dim myColor As Long\n    Dim myShape As String\n\n    Set cht = ActiveSheet.ChartObjects(1).Chart\n    Set srs = cht.SeriesCollection(1)\n\n   '## Get the series Y-Values range address:\n    lTrim = InStrRev(srs.Formula, \",\", InStrRev(srs.Formula, \",\") - 1, vbBinaryCompare) + 1\n    rTrim = InStrRev(srs.Formula, \",\")\n    Vals = Mid(srs.Formula, lTrim, rTrim - lTrim)\n    Set valRange = Range(Vals)\n\n    For p = 1 To srs.Points.Count\n        Set pt = srs.Points(p)\n        Set cl = valRange(p).Offset(0, 1) '## assume color is in the next column.\n        Set shp = valRange(p).Offset(0, 2) '## assume shape is in column next to color.\n\n        'Color Change\n        With pt.Format.Fill\n            .Visible = msoTrue\n            '.Solid  'I commented this out, but you can un-comment and it should still work\n            '## Assign Long color value based on the cell value\n            '## Add additional cases as needed.\n            Select Case LCase(cl)\n                Case \"red\"\n                    myColor = RGB(255, 0, 0)\n                Case \"blue\"\n                    myColor = RGB(0, 0, 255)\n                Case \"green\"\n                    myColor = RGB(0, 255, 0)\n                    Case \"yellow\"\n                    myColor = RGB(255, 192, 50)\n\n            End Select\n\n            .ForeColor.RGB = myColor\n\n        End With\n\n        'Shape Change\n        With pt\n            '## Assign shape value based on the cell value\n            '## Add additional cases as needed.\n            Select Case LCase(shp)\n                Case \"square\"\n                    myShape = xlMarkerStyleSquare\n                Case \"triangle\"\n                    myShape = xlMarkerStyleTriangle\n                Case \"circle\"\n                    myShape = xlMarkerStyleCircle\n                Case \"x\"\n                    myShape = xlMarkerStyleX\n                Case \"+\"\n                    myShape = xlMarkerStylePlus\n\n            End Select\n\n            .MarkerStyle = myShape\n\n        End With\n\n    Next\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10383611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c7375bfe640e0ba9bb77e5a0d0696f2?s=128&d=identicon&r=PG&f=1", "display_name": "the_billsfan", "link": "https://stackoverflow.com/users/10383611/the-billsfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2057, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594055134, "creation_date": 1537332793, "last_edit_date": 1594055134, "question_id": 52398314, "link": "https://stackoverflow.com/questions/52398314/changing-the-shape-of-the-specific-dots-in-scatter-plot-excel-based-on-values", "title": "Changing the shape of the specific dots in scatter plot excel based on values", "body": "<p>I need a scatter chart to adjust the color and shape of the markers based on different values. I found the code below and works great to change the color, is it possible to adjust this code or a new one to change the marker to have circles, triangles, squares, etc based on a different column value?</p>\n\n<p>Tnx!</p>\n\n<pre><code>Sub ColorScatterPoints3()\n    Dim cht As Chart\n    Dim srs As Series\n    Dim pt As Point\n    Dim p As Long\n    Dim Vals$, lTrim#, rTrim#\n    Dim valRange As Range, cl As Range\n    Dim myColor As Long\n\n    Set cht = ActiveSheet.ChartObjects(1).Chart\n    Set srs = cht.SeriesCollection(1)\n\n   '## Get the series Y-Values range address:\n    lTrim = InStrRev(srs.Formula, \",\", InStrRev(srs.Formula, \",\") - 1, vbBinaryCompare) + 1\n    rTrim = InStrRev(srs.Formula, \",\")\n    Vals = Mid(srs.Formula, lTrim, rTrim - lTrim)\n    Set valRange = Range(Vals)\n\n    For p = 1 To srs.Points.Count\n        Set pt = srs.Points(p)\n        Set cl = valRange(p).Offset(0, 1) '## assume color is in the next column.\n\n        With pt.Format.Fill\n            .Visible = msoTrue\n            '.Solid  'I commented this out, but you can un-comment and it should still work\n            '## Assign Long color value based on the cell value\n            '## Add additional cases as needed.\n            Select Case LCase(cl)\n                Case \"red\"\n                    myColor = RGB(255, 0, 0)\n                Case \"blue\"\n                    myColor = RGB(0, 0, 255)\n                Case \"green\"\n                    myColor = RGB(0, 255, 0)\n                    Case \"yellow\"\n                    myColor = RGB(255, 192, 50)\n\n            End Select\n\n            .ForeColor.RGB = myColor\n\n        End With\n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537332776, "post_id": 52397990, "comment_id": 91740703, "body": "It&#39;s possible someone set up one or more rules which call the code.  It would be helpful to show at least the first few lines of the code."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1537355106, "post_id": 52397990, "comment_id": 91752494, "body": "If you have access to the code for the Macro, you could add a break point (e.g. add the line <code>Stop</code> at the end) - that way when it <i>does</i> get called you could step through with F8 until it steps out of the Macro and into any Macro that called it?  Of course, this only works if it <i>is</i> another Macro that calls it..."}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1537356787, "post_id": 52397990, "comment_id": 91753508, "body": "The name of the folder will likely be in the code that processes it."}], "owner": {"reputation": 2926, "user_id": 954093, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a329dc7bfdaf20e9f46ea64db314292c?s=128&d=identicon&r=PG", "display_name": "Sandeep Thomas", "link": "https://stackoverflow.com/users/954093/sandeep-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1592942374, "creation_date": 1537330798, "last_edit_date": 1592942374, "question_id": 52397990, "link": "https://stackoverflow.com/questions/52397990/how-to-find-what-is-invoking-a-macro-function-in-outlook-vba", "title": "How to find what is invoking a macro (Function) in Outlook vba", "body": "<p>I am facing a challenge in modifying an outlook VBA application which does some processing on mails in a specific folder. It all works fine. But there a major function to Process the files which itself shows in the macros list in outlook. But Im not able to find from where the function is being called or how its invoked. There is a task showing in Tasks list, but in that Task I am not able  to find if its invoking some function or does something.</p>\n\n<p>Please help me to find who is actually invoking this Process function. Or in another way, how to identify the invoker of a function.</p>\n"}, {"tags": ["vba", "selenium", "window", "selenium-chromedriver", "new-window"], "answers": [{"comments": [{"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1593052438, "post_id": 52399698, "comment_id": 110646552, "body": "How can I switch back to default window after I chose <code>.SwitchToNextWindow</code>? I tried using <code>.SwitchToDefaultWindow</code> but vba couldn&#39;t recognize that command @QHarr."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1593066882, "post_id": 52399698, "comment_id": 110650116, "body": "You know this one. @MITHU. Switchtodefaultcontent"}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1593067663, "post_id": 52399698, "comment_id": 110650429, "body": "That was my first try. I suppose that specific command is for iframe. May be I&#39;m wrong. However, using <code>.Switchtodefaultcontent</code> or <code>SwitchToDefaultWindow</code> leads to this <a href=\"https://imgur.com/a/ReJUSYW\" rel=\"nofollow noreferrer\">error</a>."}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1593067876, "post_id": 52399698, "comment_id": 110650536, "body": "I used this link <code>https:&#47;&#47;www.pinterest.com&#47;</code> then clicked on <code>log in</code> and then used <code>Continue with Google</code> option. After logging in using google, I used another link to see whether I&#39;m logged in <code>https:&#47;&#47;www.google.com&#47;retail&#47;solutions&#47;merchant-center&#47;</code>. Thanks."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1593067925, "post_id": 52399698, "comment_id": 110650566, "body": "Afraid I can&#39;t test behind login or with vba. I may be able to later today. Once again, you do ask the most interesting questions. I assume that the handle for the prior window is gone so not available."}, {"owner": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 1, "creation_date": 1593067992, "post_id": 52399698, "comment_id": 110650597, "body": "Yeah, I know that. You mentioned it few days back."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 207, "user_id": 7180194, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/tnExZ.jpg?s=128&g=1", "display_name": "MITHU", "link": "https://stackoverflow.com/users/7180194/mithu"}, "edited": false, "score": 0, "creation_date": 1593068032, "post_id": 52399698, "comment_id": 110650611, "body": "I may try an install later today or over next few days. Seems some people can use selenium basic with windows 10 so maybe that is not the problem."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 4, "last_activity_date": 1537340779, "last_edit_date": 1537340779, "creation_date": 1537339433, "answer_id": 52399698, "question_id": 52397268, "link": "https://stackoverflow.com/questions/52397268/how-do-i-switch-focus-to-a-new-window-using-selenium-vba/52399698#52399698", "title": "How do I switch focus to a new window using Selenium VBA?", "body": "<p>Explicitly with </p>\n\n<pre><code>bot.SwitchToWindowByTitle \"Title\"  '&lt;==Make sure it is the actual Title you are using of the Window\n</code></pre>\n\n<p>If it has just popped up you may also try</p>\n\n<pre><code>bot.SwitchToNextWindow\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 7459246, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-WInwOIbKchQ/AAAAAAAAAAI/AAAAAAAAAXo/7G6_CMkd3TQ/photo.jpg?sz=128", "display_name": "John", "link": "https://stackoverflow.com/users/7459246/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1756, "favorite_count": 0, "accepted_answer_id": 52399698, "answer_count": 1, "score": 0, "last_activity_date": 1537340779, "creation_date": 1537325040, "question_id": 52397268, "link": "https://stackoverflow.com/questions/52397268/how-do-i-switch-focus-to-a-new-window-using-selenium-vba", "title": "How do I switch focus to a new window using Selenium VBA?", "body": "<p>So, I know how to find the name of the active window</p>\n\n<pre><code>currentWindow = bot.Send(\"GET\", \"/window_handle\")\nbot.SwitchToWindowByName currentWindow\n</code></pre>\n\n<p>Is there a way to get the name of the inactive window that I just popped up?</p>\n\n<p>I tried going to console and typing window.name and got \"\"\nAlso tried using window.document.name and got \"download.phtml\", but </p>\n\n<pre><code>bot.SwitchToWindowByName download.phtml\n</code></pre>\n\n<p>gave me a Runtime 424 Object Required error.</p>\n\n<p><a href=\"https://i.stack.imgur.com/02TjO.png\" rel=\"nofollow noreferrer\">Picture of the new window (on the right)</a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537322431, "post_id": 52396906, "comment_id": 91738477, "body": "What are you trying to do with your code exactly?"}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "edited": false, "score": 0, "creation_date": 1537322680, "post_id": 52396906, "comment_id": 91738535, "body": "Are you trying to change the range that the loop runs on, or just replace values in column U, or replace values in column U of the selected range? Can you provide same data, expected result?"}, {"owner": {"reputation": 169, "user_id": 2258740, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/045d40d455b9ca7443a3c91c33960447?s=128&d=identicon&r=PG", "display_name": "user2258740", "link": "https://stackoverflow.com/users/2258740/user2258740"}, "edited": false, "score": 0, "creation_date": 1537325762, "post_id": 52396906, "comment_id": 91739173, "body": "The macro is finds and replaces data in a workbook. The source is <a href=\"https://old.reddit.com/r/excelevator/comments/5ftnha/vba_macro_replace_values_in_cells_from_list_of/\" rel=\"nofollow noreferrer\">here.</a> And, I&#39;m looking for a way to make it replace data in just the U column--rather than the whole document or a selected range."}], "answers": [{"tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": false, "score": 2, "last_activity_date": 1537322355, "creation_date": 1537322355, "answer_id": 52396951, "question_id": 52396906, "link": "https://stackoverflow.com/questions/52396906/can-i-modify-this-macro-to-run-just-on-one-column/52396951#52396951", "title": "Can I modify this macro to run just on one column?", "body": "<pre><code> Range(\"U:U\").Replace What:=wTxt, Replacement:=rTxt, LookAt:=xlPart\n</code></pre>\n"}], "owner": {"reputation": 169, "user_id": 2258740, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/045d40d455b9ca7443a3c91c33960447?s=128&d=identicon&r=PG", "display_name": "user2258740", "link": "https://stackoverflow.com/users/2258740/user2258740"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1537322373, "creation_date": 1537322066, "last_edit_date": 1537322373, "question_id": 52396906, "link": "https://stackoverflow.com/questions/52396906/can-i-modify-this-macro-to-run-just-on-one-column", "title": "Can I modify this macro to run just on one column?", "body": "<p>I'm using this to find and replace values, and it works fine for the entire sheet I have open:</p>\n\n<pre><code>Sub replaceStringInCells()\nDim wTxt As String\nDim rTxt As String\nDim rNum As Integer\nrNum = 0\nFor Each Row In Range(\"swapvalues\").Rows  '&lt;== change the wordlist Name here as required\n    wTxt = Row.Cells(1).Value\n    rTxt = Row.Cells(2).Value\n        Selection.Replace What:=wTxt, Replacement:=rTxt, LookAt:=xlPart, _\n            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n            ReplaceFormat:=False\n            rNum = rNum + 1\nNext\nEnd Sub\n</code></pre>\n\n<p>I'd like to edit it so that I runs just on Column U--instead of the full sheet.</p>\n\n<p>I've seen other folks try to solve this using lines like <code>Set rng = Range(\"U:U\")</code> but I'm not sure where to add that in the code above or if this is the best approach.</p>\n\n<p>If anyone has a suggestion, I'd appreciate it. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1537321994, "post_id": 52396812, "comment_id": 91738400, "body": "Why wouldn&#39;t you simply use a countif formula?"}], "answers": [{"tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": false, "score": 1, "last_activity_date": 1537325315, "last_edit_date": 1537325315, "creation_date": 1537323578, "answer_id": 52397099, "question_id": 52396812, "link": "https://stackoverflow.com/questions/52396812/make-excel-auto-generate-number-based-on-cell-value/52397099#52397099", "title": "make excel auto generate number based on cell value", "body": "<p>This seems like an XY problem. But I think you are trying to index the first instance of each distinct value in Column C, maybe its a pivot table?</p>\n\n<p>Put this formula in Cell A1 and copy down:</p>\n\n<p><code>=IF(B1&lt;&gt;\"\",COUNTA(B$1:B1)+1,\"\")</code></p>\n"}], "owner": {"reputation": 75, "user_id": 10189458, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1cbfb99e9cc10c16f4b2f21300b01a34?s=128&d=identicon&r=PG&f=1", "display_name": "Lim", "link": "https://stackoverflow.com/users/10189458/lim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537325315, "creation_date": 1537321256, "question_id": 52396812, "link": "https://stackoverflow.com/questions/52396812/make-excel-auto-generate-number-based-on-cell-value", "title": "make excel auto generate number based on cell value", "body": "<p>i would like excel to generate row number based on the value in the cell.</p>\n\n<pre><code> For example:(output) Columns  : A         B         C\n                                 1         xx        xx\n                                                     xx \n                                 2         yy        yy\n                                                     yy\n                                 3         zz        zz\n                                                     zz\n                                                     zz\n</code></pre>\n\n<p>In the event, i delete number 2, the 3 will become 2. </p>\n\n<p>This is my existing code</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Target.Column = 2 Then\nIf Target.Offset(0, -1).Value = \"\" Then\nTarget.Offset(0, -1).Value = Application.WorksheetFunction.Max(Columns(\"A\")) + 1\nElse\nTarget.Offset(0, -1).Value = Application.WorksheetFunction.Max(Columns(\"A\")) - 1\nEnd If\nEnd If\n\nEnd Sub\n\nFunction Max_Each_Column(Data_Range As Range) As Integer\n    Dim TempArray() As Double, i As Long\n        If Data_Range Is Nothing Then Exit Function\n        With Data_Range\n        ReDim TempArray(1 To .Columns.Count)\n        For i = 1 To .Columns.Count\n            TempArray(i) = Application.Max(.Columns(i))\n        Next\n    End With\n        Max_Each_Column = TempArray\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1537322208, "post_id": 52396772, "comment_id": 91738427, "body": "What&#39;s the name of the worksheet these formulas are going into?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10383062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a54c40e0f75c72a794d608305b4382?s=128&d=identicon&r=PG&f=1", "display_name": "aaaaa", "link": "https://stackoverflow.com/users/10383062/aaaaa"}, "edited": false, "score": 0, "creation_date": 1537340262, "post_id": 52397055, "comment_id": 91743781, "body": "I didn&#39;t write the codes. I used the &quot;record macro function&quot; and just performed what I would like to do.  So where do I insert your code? I can guess what the macro says, but i don&#39;t konw the structure at all.  Thanks"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "reply_to_user": {"reputation": 1, "user_id": 10383062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a54c40e0f75c72a794d608305b4382?s=128&d=identicon&r=PG&f=1", "display_name": "aaaaa", "link": "https://stackoverflow.com/users/10383062/aaaaa"}, "edited": false, "score": 0, "creation_date": 1537340365, "post_id": 52397055, "comment_id": 91743831, "body": "Well, it seems like you did each formula twice. You might want to look into that."}, {"owner": {"reputation": 1, "user_id": 10383062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a54c40e0f75c72a794d608305b4382?s=128&d=identicon&r=PG&f=1", "display_name": "aaaaa", "link": "https://stackoverflow.com/users/10383062/aaaaa"}, "edited": false, "score": 0, "creation_date": 1537340528, "post_id": 52397055, "comment_id": 91743912, "body": "Yeah i did, cause there are 2 cells that i want the formula, but it&#39;ll index different cells.  one of them I was when i edited the formula to put the $ in to lock the formula."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1537323211, "creation_date": 1537323211, "answer_id": 52397055, "question_id": 52396772, "link": "https://stackoverflow.com/questions/52396772/copying-formulas-to-last-row-of-data/52397055#52397055", "title": "Copying formulas to last row of data", "body": "<p>You seem to be overwriting some of the formulas with different relative/absolute references. It really doesn't seem to matter which is used as far as relative/absolute addressing is concerned but you have two distinct formulas for column E which reference two different cells on the data worksheet. I'll use the latter of the two.</p>\n\n<p>Put all of the formulas into all of the cells at once. AutoFill is overrated and functionally redundant in this case.</p>\n\n<p>The formulas for column C seem to be using a relative reference to a cell in column F. You can use that column to determine the last row to put formulas into.</p>\n\n<pre><code>sub buildFormulas()\n\n    dim lr as long\n\n    with worksheets(\"data\")\n\n        lr = .cells(.rows.count, \"F\").end(xlup).row\n\n        .range(.cells(2, \"C\"), .cells(lr, \"C\")).formular1c1 = _\n          \"=INDEX('Account codes'!C2, MATCH(RC7, 'Account codes'!C1, 0))\"\n\n        .range(.cells(2, \"E\"), .cells(lr, \"E\")).formular1c1 = _\n          \"=INDEX('Account codes'!C2, MATCH(RC8, 'Account codes'!C1, 0))\"\n\n    end with\n\nend sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10383062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59a54c40e0f75c72a794d608305b4382?s=128&d=identicon&r=PG&f=1", "display_name": "aaaaa", "link": "https://stackoverflow.com/users/10383062/aaaaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537342735, "creation_date": 1537320948, "last_edit_date": 1537342735, "question_id": 52396772, "link": "https://stackoverflow.com/questions/52396772/copying-formulas-to-last-row-of-data", "title": "Copying formulas to last row of data", "body": "<p>I can see the question has been asked a couple of times in the forum, but as someone who doesn't really know macro, I cannot implement the code provided in the answers.</p>\n\n<p>So I have recorded the below macro. </p>\n\n<pre><code>Macro6 Macro\n'\n\n'\n\n\n Range(\"C2\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=INDEX('Account codes'!C[-1],MATCH(DATA!RC[4],'Account codes'!C[-2],0))\"\n    Range(\"C2\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=INDEX('Account codes'!C2,MATCH(DATA!RC[4],'Account codes'!C1,0))\"\n    Range(\"C2\").Select\n    Selection.Copy\n    Range(\"E2\").Select\n    ActiveSheet.Paste\n    Application.CutCopyMode = False\n    ActiveCell.FormulaR1C1 = _\n        \"=INDEX('Account codes'!C2,MATCH(DATA!RC[4],'Account codes'!C1,0))\"\n    Range(\"E2\").Select\n    ActiveCell.FormulaR1C1 = _\n        \"=INDEX('Account codes'!C2,MATCH(DATA!RC[3],'Account codes'!C1,0))\"\n    Range(\"E2\").Select\n    Selection.AutoFill Destination:=Range(\"E2:E4\")\n    Range(\"E2:E4\").Select\n    Range(\"C2\").Select\n    Selection.AutoFill Destination:=Range(\"C2:C4\")\n    Range(\"C2:C4\").Select\n\nEnd Sub\n</code></pre>\n\n<p>In simple terms, I want <code>Selection.AutoFill Destination:=Range(\"E2:E4\")</code> to fill down to the last row of data, and not just to E4. That is because the data can change in size.</p>\n\n<p>How do I do this?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1537323719, "post_id": 52396711, "comment_id": 91738774, "body": "so in your results table, every entry withe the same category name would wind up having the same pass and fail counts?  Subsequent entries of the same category name are just additional criteria that also have to be met for a pass?  ie you want a count of catergory A that has S1 &gt;= 3 and S2&gt;= 4?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1537324069, "post_id": 52396711, "comment_id": 91738851, "body": "is the maximum occurance of a category 2?  Ie there is aonly S1 and S2?  Will that table always be sorted so that A S2 is on the line below A S1?  Can the layout of your first table be modified slightly?"}, {"owner": {"reputation": 173, "user_id": 7050774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-DvAWuFV41lw/AAAAAAAAAAI/AAAAAAAAARY/KjJTI7LMXNQ/photo.jpg?sz=128", "display_name": "Connor", "link": "https://stackoverflow.com/users/7050774/connor"}, "reply_to_user": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 0, "creation_date": 1537324130, "post_id": 52396711, "comment_id": 91738863, "body": "That is correct @ForwardEd. I want the count of all entries in <b>iTable</b> that match all the criteria. for Category A that would be S1 &gt;= 3 and S2&gt;= 4."}, {"owner": {"reputation": 173, "user_id": 7050774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-DvAWuFV41lw/AAAAAAAAAAI/AAAAAAAAARY/KjJTI7LMXNQ/photo.jpg?sz=128", "display_name": "Connor", "link": "https://stackoverflow.com/users/7050774/connor"}, "edited": false, "score": 0, "creation_date": 1537324242, "post_id": 52396711, "comment_id": 91738888, "body": "The layout can be modified, but the categories are unkown. For the sake of this example, I have 2. In reality I have 6, but this is a variable and I cannot make this assumption. I also cannot guarantee order, because the client wants the freedom to sort this however he desires."}], "answers": [{"comments": [{"owner": {"reputation": 173, "user_id": 7050774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-DvAWuFV41lw/AAAAAAAAAAI/AAAAAAAAARY/KjJTI7LMXNQ/photo.jpg?sz=128", "display_name": "Connor", "link": "https://stackoverflow.com/users/7050774/connor"}, "edited": false, "score": 0, "creation_date": 1537325804, "post_id": 52397242, "comment_id": 91739185, "body": "This is beautiful, but I need it to work for a variable number of filters. Category A may have 6 filters and category B may share 2 filters with A and then have another of its own. Once I make this spreadsheet I will give it away and not touch it again, so any dragging of formulas that might need to be done for maintenance is not an option for me. Is there a way to take exactly what you have done such an amazing job with and make it accept variable filters?"}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "reply_to_user": {"reputation": 173, "user_id": 7050774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-DvAWuFV41lw/AAAAAAAAAAI/AAAAAAAAARY/KjJTI7LMXNQ/photo.jpg?sz=128", "display_name": "Connor", "link": "https://stackoverflow.com/users/7050774/connor"}, "edited": false, "score": 0, "creation_date": 1537326124, "post_id": 52397242, "comment_id": 91739250, "body": "Create the 10 columns, if the criteria are not use it wont matter. as long as it also remains blank in the second table.  However this may still not be an option for you.  It can be done via VBA but VBA is not my strong suit."}, {"owner": {"reputation": 173, "user_id": 7050774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-DvAWuFV41lw/AAAAAAAAAAI/AAAAAAAAARY/KjJTI7LMXNQ/photo.jpg?sz=128", "display_name": "Connor", "link": "https://stackoverflow.com/users/7050774/connor"}, "edited": false, "score": 0, "creation_date": 1537329892, "post_id": 52397242, "comment_id": 91739938, "body": "I am marking this as the answer because it was what I ended up using. It isn&#39;t perfect, but given that the filters won&#39;t change that much it will work. I just didn&#39;t want to have to do maintenance on this thing later, but ..."}], "tags": [], "owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "is_accepted": true, "score": 1, "last_activity_date": 1537324873, "creation_date": 1537324873, "answer_id": 52397242, "question_id": 52396711, "link": "https://stackoverflow.com/questions/52396711/filter-filter-criteria-and-then-apply-in-countif-statement-in-excel/52397242#52397242", "title": "Filter filter criteria and then apply in countif statement in Excel", "body": "<p>Looking at an alternative layout for you spec criteria.  Expand you columns to suit your need.</p>\n\n<p><a href=\"https://i.stack.imgur.com/o9JGX.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/o9JGX.png\" alt=\"Alt Table 1 Layout\"></a></p>\n\n<p>With each spec criteria being its own column life gets really easy.  You just need to adjust your formula to match the number of criteria you have.</p>\n\n<p>Based on the table at the end for layout, place the following formula in D3 and copy down as required.</p>\n\n<pre><code>=SUMPRODUCT(($G$2:$G$6=A3)*($H$2:$H$6&gt;=B3)*($I$2:$I$6&gt;=C3))\n</code></pre>\n\n<p>That will give you a count of passing all criteria.  Its also a function that performs array like calcs.  It could be repeated in the next column but in order to reduce dependency on array calculation and potentially speed things up depending on the amount of data to check, place the following in the top of the fail column and copy down as required:</p>\n\n<pre><code>=COUNTIF($G$2:$G$6,A3)-D3\n</code></pre>\n\n<p>Basically it subtracts the passes from the total count.  This assumes you can only have PASS and FAIL as options.</p>\n\n<p><a href=\"https://i.stack.imgur.com/HexG5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HexG5.png\" alt=\"POC\"></a></p>\n"}], "owner": {"reputation": 173, "user_id": 7050774, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-DvAWuFV41lw/AAAAAAAAAAI/AAAAAAAAARY/KjJTI7LMXNQ/photo.jpg?sz=128", "display_name": "Connor", "link": "https://stackoverflow.com/users/7050774/connor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 52397242, "answer_count": 1, "score": 0, "last_activity_date": 1594055152, "creation_date": 1537320434, "last_edit_date": 1594055152, "question_id": 52396711, "link": "https://stackoverflow.com/questions/52396711/filter-filter-criteria-and-then-apply-in-countif-statement-in-excel", "title": "Filter filter criteria and then apply in countif statement in Excel", "body": "<p>I have a table of filter criteria like this:</p>\n\n<pre>\n+----------+----------+------+------+------+\n| Category | SpecName | Spec | Pass | Fail |\n+----------+----------+------+------+------+\n| A        | S1       |    3 |      |      |\n| A        | S2       |    4 |      |      |\n| B        | S1       |    5 |      |      |\n| C        | S1       |    2 |      |      |\n+----------+----------+------+------+------+\n</pre>\n\n<p>I have a table I want to apply the filter criteria to like this:</p>\n\n<pre>\n+----------+----+----+\n| Category | S1 | S2 |\n+----------+----+----+\n| A        |  5 |  3 |\n| B        |  4 |    |\n| A        |  5 |  5 |\n| C        |  2 |    |\n| A        |  2 |  6 |\n+----------+----+----+\n</pre>\n\n<p>I want to fill the Pass and Fail columns in the filter criteria table with a count of items in second table with values >= the corresponding spec, like so.</p>\n\n<pre>\n+----------+----------+------+------+------+\n| Category | SpecName | Spec | Pass | Fail |\n+----------+----------+------+------+------+\n| A        | S1       |    3 |    1 |    2 |\n| A        | S2       |    4 |    1 |    2 |\n| B        | S1       |    5 |    0 |    1 |\n| C        | S1       |    2 |    1 |    0 |\n+----------+----------+------+------+------+\n</pre>\n\n<p>Here are steps for how I might do it in a scripting language:</p>\n\n<ol>\n<li>Filter first table to get all spec filter criteria for the Category on that row, as follows for the first row.</li>\n</ol>\n\n<pre>\n+----------+----------+------+\n| Category | SpecName | Spec |\n+----------+----------+------+\n| A        | S1       |    3 |\n| A        | S2       |    4 |\n+----------+----------+------+\n</pre>\n\n<ol start=\"2\">\n<li>Copy table 2 to a variable <strong>iTable</strong></li>\n</ol>\n\n<pre>\n+----------+----+----+\n| Category | S1 | S2 |\n+----------+----+----+\n| A        |  5 |  3 |\n| B        |  4 |    |\n| A        |  5 |  5 |\n| C        |  2 |    |\n| A        |  2 |  6 |\n+----------+----+----+\n</pre>\n\n<ol start=\"3\">\n<li>For each spec name:\n   Find column in iTable with spec name\n   Filter spec name column in <strong>iTable</strong> by spec</li>\n<li>After all filters applied, we would have:</li>\n</ol>\n\n<pre>\n+----------+----+----+\n| Category | S1 | S2 |\n+----------+----+----+\n| A        |  5 |  5 |\n+----------+----+----+\n</pre>\n\n<ol start=\"5\">\n<li>Then just count the rows in <strong>iTable</strong> and assign to the cell in <strong>Pass</strong> column of the criteria table</li>\n</ol>\n\n<p>Is this possible with Excel formulas?</p>\n\n<p>If not, does anyone know how to do it with VBA?</p>\n"}, {"tags": ["regex", "vba"], "comments": [{"owner": {"reputation": 117699, "user_id": 62576, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/15264f7bf48e10ce32dfa4865a13763c?s=128&d=identicon&r=PG", "display_name": "Ken White", "link": "https://stackoverflow.com/users/62576/ken-white"}, "edited": false, "score": 1, "creation_date": 1537320118, "post_id": 52396547, "comment_id": 91737996, "body": "Please <a href=\"https://stackoverflow.com/posts/52396547/edit\">edit</a> your question title to contain something more than just a repetition of the tag information. Your title should describe the problem you&#39;re having or question you&#39;re asking in a way that will be useful to future users here who see it in a list of search results. Thanks."}], "answers": [{"tags": [], "owner": {"reputation": 430, "user_id": 6519348, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0LOC.jpg?s=128&g=1", "display_name": "E. Sun", "link": "https://stackoverflow.com/users/6519348/e-sun"}, "is_accepted": false, "score": 0, "last_activity_date": 1537323066, "creation_date": 1537323066, "answer_id": 52397038, "question_id": 52396547, "link": "https://stackoverflow.com/questions/52396547/vba-excel-and-regex/52397038#52397038", "title": "vba excel and regex", "body": "<p>put <code>$</code> at the end of your regex pattern so it knows it must be the end of the string. For more syntax like this try looking at:</p>\n\n<p><a href=\"https://www.mikesdotnetting.com/article/44/vbscript-regular-expressions-cheat-sheet\" rel=\"nofollow noreferrer\">https://www.mikesdotnetting.com/article/44/vbscript-regular-expressions-cheat-sheet</a></p>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 10382965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc7aa18ddaeb4a75e5cb8dab9f7fdccf?s=128&d=identicon&r=PG&f=1", "display_name": "mitaithecat", "link": "https://stackoverflow.com/users/10382965/mitaithecat"}, "edited": false, "score": 0, "creation_date": 1537368245, "post_id": 52397083, "comment_id": 91760681, "body": "This kind of works but it takes out the spaces between the words.  Although it fixes the Howdy-1 and realizes that it isnt Howdy, on other ones that are replacing words like &quot;The ball is green&quot;   search for ball replace with Truck it is returning &quot;TheTruckis green&quot;"}, {"owner": {"reputation": 2806, "user_id": 884561, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/26262f09f8ab613b167886a5d8b558ec?s=128&d=identicon&r=PG", "display_name": "Kenneth K.", "link": "https://stackoverflow.com/users/884561/kenneth-k"}, "reply_to_user": {"reputation": 11, "user_id": 10382965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc7aa18ddaeb4a75e5cb8dab9f7fdccf?s=128&d=identicon&r=PG&f=1", "display_name": "mitaithecat", "link": "https://stackoverflow.com/users/10382965/mitaithecat"}, "edited": false, "score": 0, "creation_date": 1537368776, "post_id": 52397083, "comment_id": 91761022, "body": "In your replacement, you can refer to capture groups 1 and 2, which are enabled by the use of parentheses above. I&#39;ll update the answer."}, {"owner": {"reputation": 11, "user_id": 10382965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc7aa18ddaeb4a75e5cb8dab9f7fdccf?s=128&d=identicon&r=PG&f=1", "display_name": "mitaithecat", "link": "https://stackoverflow.com/users/10382965/mitaithecat"}, "edited": false, "score": 0, "creation_date": 1537369107, "post_id": 52397083, "comment_id": 91761246, "body": "Actually i found a way where this works, just added the spaces back in on my replace and trimmed it if it was at the beginning or end of the string.  Great answer"}], "tags": [], "owner": {"reputation": 2806, "user_id": 884561, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/26262f09f8ab613b167886a5d8b558ec?s=128&d=identicon&r=PG", "display_name": "Kenneth K.", "link": "https://stackoverflow.com/users/884561/kenneth-k"}, "is_accepted": false, "score": 1, "last_activity_date": 1537368960, "last_edit_date": 1537368960, "creation_date": 1537323460, "answer_id": 52397083, "question_id": 52396547, "link": "https://stackoverflow.com/questions/52396547/vba-excel-and-regex/52397083#52397083", "title": "vba excel and regex", "body": "<p>Your problem is that <code>\\b</code> matches a \"word boundary,\" which is any place where either a letter, number, or underscore adjoins a character that is not one of the aforementioned--or where it adjoins an anchor like <code>$</code> (end of string). The <code>Howdy-1</code> has a word boundary between the <code>y</code> and the <code>-</code>, which is why your pattern matches there. If you want to match on the whole word, then you'd need to modify your pattern to include a space as well as anchors:</p>\n\n<pre><code>re.Pattern = \"(^| )\" &amp; strFind &amp; \"( |$)\"\n</code></pre>\n\n<p>The alternation (<code>|</code>) will allow you to look for your word where it either is at the beginning of the string (<code>^</code>) with a trailing space, or is at the end of the string (<code>$</code>) with a leading space, or is in the middle of the string with a space on either side of it.</p>\n\n<p>Since the spaces are captured via the capture groups (i.e. parentheses), you can include them in your replacement operation to ensure that they are preserved:</p>\n\n<pre><code>RegExpReplaceWord = re.Replace(strSource, \"$1\" &amp; strReplace &amp; \"$2\")\n</code></pre>\n\n<p><code>$1</code> refers to capture group 1, which is the first set of parentheses (reading right to left), and <code>$2</code> refers to capture group 2, which is the second set of parentheses. If a space is captured by either group, then it will be appended in the replacement, respectively. If start-of-string or end-of-string is \"captured\" by either group, then effectively empty string is captured, and that is what will be appended in the replacement.</p>\n"}], "owner": {"reputation": 11, "user_id": 10382965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc7aa18ddaeb4a75e5cb8dab9f7fdccf?s=128&d=identicon&r=PG&f=1", "display_name": "mitaithecat", "link": "https://stackoverflow.com/users/10382965/mitaithecat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1537368960, "creation_date": 1537319112, "question_id": 52396547, "link": "https://stackoverflow.com/questions/52396547/vba-excel-and-regex", "title": "vba excel and regex", "body": "<p>i have some code (shown below) that i got of a site, it allows me to pass in a string, findstring and replace string and it will replace only a full word if it is found. the issue i am having is i have words that have a minus sign behind it and it is treating it like a seperate word.</p>\n\n<p>for example</p>\n\n<p>Howdy\nHowdy-1</p>\n\n<p>When i tell it to replace Howdy with doodie, it replaces both Howdy and Howdy-1 with doodie and doodie-1 respectively.  I want it to replace the one word but not the one that has -1 or any other symbol behind the word like Howdy#1</p>\n\n<p>Is this possible.  In my code howdy and doodie are coming from cells in a spreadsheet</p>\n\n<p>function that is doing the replace</p>\n\n<pre><code>Public Function RegExpReplaceWord(ByVal strSource As String, ByVal strFind As String, ByVal strReplace As String) As String\n' Purpose   : replace [strFind] with [strReplace] in [strSource] '\n' Comment   : [strFind] can be plain text or a regexp pattern; '\n'             all occurences of [strFind] are replaced '\n    'requires reference to Microsoft VBScript Regular Expressions '\n    'Dim re As RegExp '\n    'Set re = New RegExp '\n    'late binding; no reference needed '\n    Dim re As Object\n    Set re = CreateObject(\"VBScript.RegExp\")\n\n    re.Global = True\n    re.IgnoreCase = True ' &lt;-- case insensitve\n    re.Pattern = \"\\b\" &amp; strFind &amp; \"\\b\"\n    RegExpReplaceWord = re.Replace(strSource, strReplace)\n    Set re = Nothing\n\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 6518744, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/840281c7cc453cf81ea4b8b7d62ee85c?s=128&d=identicon&r=PG&f=1", "display_name": "Aus Mazin", "link": "https://stackoverflow.com/users/6518744/aus-mazin"}, "edited": false, "score": 0, "creation_date": 1537319656, "post_id": 52396518, "comment_id": 91737902, "body": "I totally forgot about the Sort command, I recorded a macro with me doing the sort way and worked perfectly. Thanks"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1537318819, "creation_date": 1537318819, "answer_id": 52396518, "question_id": 52396448, "link": "https://stackoverflow.com/questions/52396448/organize-in-sequence-cell-with-same-value-vba/52396518#52396518", "title": "Organize in sequence cell with same value vba", "body": "<pre><code>Range(\"A:A\").Sort Range(\"A1\"), xlAscending\n</code></pre>\n\n<p>You can find info on how to tweak the <code>Range.Sort</code> method to fit the needs of your actual data <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.sort\" rel=\"nofollow noreferrer\">here</a>. You will need to code for the size (Column Span) of the used range, header, etc. </p>\n\n<hr>\n"}], "owner": {"reputation": 25, "user_id": 6518744, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/840281c7cc453cf81ea4b8b7d62ee85c?s=128&d=identicon&r=PG&f=1", "display_name": "Aus Mazin", "link": "https://stackoverflow.com/users/6518744/aus-mazin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19, "favorite_count": 0, "accepted_answer_id": 52396518, "answer_count": 1, "score": 0, "last_activity_date": 1593702612, "creation_date": 1537318235, "last_edit_date": 1593702612, "question_id": 52396448, "link": "https://stackoverflow.com/questions/52396448/organize-in-sequence-cell-with-same-value-vba", "title": "Organize in sequence cell with same value vba", "body": "<p>Hi I am trying to make a code in VBA to group in sequence cells with the same value (string), for exemple I have a giant workbook with 4 costumers in a random order and want to group them (as the image), I am trying but don't even know how to start the logical sequence. It will be between 8 and 10 costumers.</p>\n\n<p>Before - <a href=\"https://i.stack.imgur.com/GmDqs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/GmDqs.png\" alt=\"example before\"></a></p>\n\n<p>After - <a href=\"https://i.stack.imgur.com/qtrg8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qtrg8.png\" alt=\"Example after\"></a></p>\n"}, {"tags": ["vba", "excel", "intersect"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537317348, "post_id": 52396343, "comment_id": 91737457, "body": "Always helps to post your actual code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1537317424, "post_id": 52396343, "comment_id": 91737474, "body": "If <b>NOT</b> Intersect( ... ) Is Nothing Then"}, {"owner": {"reputation": 11, "user_id": 10382886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee9de46c4d92465b02866a85985b495?s=128&d=identicon&r=PG&f=1", "display_name": "icantcode", "link": "https://stackoverflow.com/users/10382886/icantcode"}, "edited": false, "score": 0, "creation_date": 1537318285, "post_id": 52396343, "comment_id": 91737644, "body": "thanks, I&#39;ve added the rest of my code and I&#39;ve also tried using the If Not Intersect but got the same error"}, {"owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "edited": false, "score": 0, "creation_date": 1537318311, "post_id": 52396343, "comment_id": 91737650, "body": "At Cells(12,j-1),  if j is 1 code occur error."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1537343220, "post_id": 52396343, "comment_id": 91745324, "body": "Where is <code>j</code> defined?  You say it is, but it must be done in a different block of code...  Can you use <code>Debug.Print</code> to check that it hasn&#39;t been reset back to 1 or 0 or something silly like that."}, {"owner": {"reputation": 11, "user_id": 10382886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee9de46c4d92465b02866a85985b495?s=128&d=identicon&r=PG&f=1", "display_name": "icantcode", "link": "https://stackoverflow.com/users/10382886/icantcode"}, "edited": false, "score": 0, "creation_date": 1537489443, "post_id": 52396343, "comment_id": 91813441, "body": "yes, I think you are right, the error must be with the j. What I am trying to do is create a form that auto populates. j would be defined in the previous question that asks the number of dogs you have. if you have 5 dogs, then j=6, if you have 1 then j=2. This would explain why the error only really pops up when I try to start from scratch"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10382886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee9de46c4d92465b02866a85985b495?s=128&d=identicon&r=PG&f=1", "display_name": "icantcode", "link": "https://stackoverflow.com/users/10382886/icantcode"}, "edited": false, "score": 0, "creation_date": 1537489747, "post_id": 52396504, "comment_id": 91813492, "body": "Thanks, but I think I have worked out the cause of the error. it is because, j does not get defined until another question is answered, so when I run the spreadsheet from scratch it does not know what j is. If you knew how I could work my way around this, it would be great!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 1, "last_activity_date": 1537318744, "creation_date": 1537318744, "answer_id": 52396504, "question_id": 52396343, "link": "https://stackoverflow.com/questions/52396343/vbas-worksheet-change-function-using-the-intersect-method-with-cells-as-the-ran/52396504#52396504", "title": "VBA&#39;s Worksheet_Change function using the Intersect method with Cells as the Range definer", "body": "<p>After using Intersect to determine that at least one cell in your range has been changed, you need to iterate through the matching cells.</p>\n\n<p>Turn off event handling or the Worksheet_Change will run on top of itself when you start changing values on the worksheet.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    If not Intersect(Target, Range(Cells(12, 2), Cells(12, 11))) Is Nothing Then\n        on error goto safe_exit\n        application.enableevents = false\n        dim t as range\n        for each t in Intersect(Target, Range(Cells(12, 2), Cells(12, 11)))\n            If IsEmpty(t) Then\n                t.Interior.ColorIndex = 19\n            Else\n                If Range(\"$A$13\").Value = \"\" Then\n                    Range(\"$A$13\").Value = \"Care Type\"\n                    Range(\"$A$13\").Font.Bold = True\n                End If\n                t.Interior.ColorIndex = xlNone\n                t.Offset(1, 0).Interior.ColorIndex = 19\n                t.Offset(2, 0).Value = Application.WorksheetFunction. _\n                    VLookup(Target, Sheets(\"Sheet2\").Range(\"$E$3:$F$6\"), 2)\n                t.Offset(2, 0).Font.Bold = True\n\n                i = 2\n                'I really don't know what the following code is intended to do\n                'probably better as a conditional formatting rule\n                Do Until IsEmpty(Cells(11, i))\n                    If Cells(11, i).Value &lt;= ChildCount Then\n                        Cells(12, i).Interior.ColorIndex = 19\n                    End If\n                i = i + 1\n                Loop\n            End If\n        next t\n    End If\n\nsafe_exit:\n    application.enableevents = true\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10382886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ee9de46c4d92465b02866a85985b495?s=128&d=identicon&r=PG&f=1", "display_name": "icantcode", "link": "https://stackoverflow.com/users/10382886/icantcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1981, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537319749, "creation_date": 1537317303, "last_edit_date": 1537319749, "question_id": 52396343, "link": "https://stackoverflow.com/questions/52396343/vbas-worksheet-change-function-using-the-intersect-method-with-cells-as-the-ran", "title": "VBA&#39;s Worksheet_Change function using the Intersect method with Cells as the Range definer", "body": "<p>I am trying to make my spreadsheet autofill the corresponding cell when one of the related cells have been changed.\nI have previous just defined the target as:</p>\n\n<pre><code> If Target.Address = \"$A$5\" then\n</code></pre>\n\n<p>and had no issues.\nHowever, now my target can be one of many cells and I read that the intersect method should be able to work for this but when I input my code as:</p>\n\n<pre><code>If Intersect(Target, Range(Cells(12,2), Cells(12,j-1))) Is Nothing Then\n</code></pre>\n\n<p>(I am trying to change the cells below the target, with the target being any of the cells between 12B and 12(j-1) with j being previously defined)\nI get the following error:\n\"Run-time error '1004': Application-defined or object-defined error\"\nBut from I can tell, my code is exactly the same as all the examples around.</p>\n\n<p>My full code is (although there may be an unrelated error with my vlookup as well)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nIf Intersect(Target, Range(Cells(12, 2), Cells(12, j-1))) Is Nothing Then\n    If IsEmpty(Target) Then\n        Target.Interior.ColorIndex = 19\n    Else:\n        If Range(\"$A$13\").Value = \"\" Then\n            Range(\"$A$13\").Value = \"Care Type\"\n            Range(\"$A$13\").Font.Bold = True\n        End If\n        Target.Interior.ColorIndex = xlNone\n        Target.Offset(1, 0).Interior.ColorIndex = 19\n        Target.Offset(2, 0).Value = Application.WorksheetFunction. _\n            VLookup(Target, Sheets(\"Sheet2\").Range(\"$E$3:$F$6\"), 2)\n        Target.Offset(2, 0).Font.Bold = True\n\n        i = 2\n        Do Until IsEmpty(Cells(11, i))\n            If Cells(11, i).Value &lt;= ChildCount Then\n                Cells(12, i).Interior.ColorIndex = 19\n            End If\n        i = i + 1\n        Loop\n    End If\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula", "cell"], "comments": [{"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1537323404, "post_id": 52396318, "comment_id": 91738698, "body": "<i>Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example</a>.</i>"}, {"owner": {"reputation": 82953, "user_id": 608639, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/aPIhh.jpg?s=128&g=1", "display_name": "jww", "link": "https://stackoverflow.com/users/608639/jww"}, "edited": false, "score": 0, "creation_date": 1537323452, "post_id": 52396318, "comment_id": 91738710, "body": "If you are simply asking about an Excel spreadsheet formula then you might have better luck at <a href=\"http://superuser.com/\">Super User</a>."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1537342895, "post_id": 52396318, "comment_id": 91745143, "body": "1) You need to use <code>.Formula</code> instead of <code>.Value</code>, 2) You need to double-up your double-quotes to escape them, <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/string-data-type\" rel=\"nofollow noreferrer\">as detailed here</a>, and 3) Why not use <code>AND</code> : <code>=IF(AND(B1&lt;&gt;&quot;&quot;,B4=B5),&quot;Completed&quot;,&quot;&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1537342576, "post_id": 52397199, "comment_id": 91744975, "body": "<code>Range(&quot;B2:B16&quot;).formula</code> should work without a circular reference, because Excel will automatically move the references down as it fills down (so in B6 you will have <code>=IF(B5=&quot;&quot;,&quot;&quot;,IF(B8=B9,&quot;Completed&quot;,&quot;&quot;))</code>)"}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1537361472, "post_id": 52397199, "comment_id": 91756239, "body": "I updated my answer to include the alternate line with range B2:B16. More info is needed from the OP though."}], "tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": true, "score": 1, "last_activity_date": 1537361295, "last_edit_date": 1537361295, "creation_date": 1537324513, "answer_id": 52397199, "question_id": 52396318, "link": "https://stackoverflow.com/questions/52396318/range-value-if-in-excel/52397199#52397199", "title": "Range().value=&quot;=(if) ... &quot; in Excel", "body": "<p>Its really not clear what the intended formula is, but this would be valid if you are trying to put the formula in B2 and B16:</p>\n\n<pre><code>Union(Range(\"B2\"),Range(\"B16\")).formula = \"=IF(B1=\"\"\"\",\"\"\"\",IF(B4=B5,\"\"Completed\"\",\"\"\"\"))\"\n</code></pre>\n\n<p>If you are trying to put the formula in B2:B16 then:</p>\n\n<pre><code>Range(\"B2:B16\").formula = \"=IF(B1=\"\"\"\",\"\"\"\",IF(B4=B5,\"\"Completed\"\",\"\"\"\"))\"\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 10382884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37861a480f51a1f0f154a7e47327381?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/10382884/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1537325524, "accepted_answer_id": 52397199, "answer_count": 1, "score": -3, "last_activity_date": 1537361295, "creation_date": 1537317120, "last_edit_date": 1537323287, "question_id": 52396318, "link": "https://stackoverflow.com/questions/52396318/range-value-if-in-excel", "closed_reason": "Not suitable for this site", "title": "Range().value=&quot;=(if) ... &quot; in Excel", "body": "<p>I'm a beginner. Can you please help me with the below code?</p>\n\n<pre><code>Range (\"B2\",\"B16\").value=\"=if(B1=\"\",\"\",if(B4=B5,\"Completed\",\"\"))\n</code></pre>\n\n<p>It doesn't work.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537313461, "post_id": 52395794, "comment_id": 91736744, "body": "I used this WrdArray() = Split(Mid(fileName, 1, 30), &quot;.&quot;)"}, {"owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537314176, "post_id": 52395794, "comment_id": 91736875, "body": "It worked for me. I&#39;ll modify the question"}], "answers": [{"comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1537314107, "post_id": 52395953, "comment_id": 91736862, "body": "Not sure why you are using an array for this"}], "tags": [], "owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "is_accepted": true, "score": 0, "last_activity_date": 1537313975, "creation_date": 1537313975, "answer_id": 52395953, "question_id": 52395794, "link": "https://stackoverflow.com/questions/52395794/consolidating-sheets-in-a-workbook-char-limit/52395953#52395953", "title": "Consolidating sheets in a workbook - Char limit", "body": "<p>You can just grab the first 30 characters when the string length is greater than 30 with this</p>\n\n<pre><code>If Len(Split(filename, \".\")) &gt; 30 Then\n    WrdArray() = Left(filename, 30)\nElse\n    WrdArray() = Split(filename, \".\")\nEnd if\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 9494250, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b5cc9d89159bcb0796ac3d917069d025?s=128&d=identicon&r=PG&f=1", "display_name": "Majid", "link": "https://stackoverflow.com/users/9494250/majid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 52395953, "answer_count": 1, "score": 0, "last_activity_date": 1537313975, "creation_date": 1537312548, "question_id": 52395794, "link": "https://stackoverflow.com/questions/52395794/consolidating-sheets-in-a-workbook-char-limit", "title": "Consolidating sheets in a workbook - Char limit", "body": "<p>I am using the below code to add the data from different workbooks in a single sheet. One of my file names is 33 chars, it isn't being added to my consolidated sheet, as the char limit on sheet name is 30.</p>\n\n<p>How do I modify the below code to accommodate the first sheet in the combined workbook? </p>\n\n<pre><code>Sub GetSheets()\n\nDim directory As String, fileName As String, sheet As Worksheet, total As Integer\nDim WrdArray() As String\n\nApplication.ScreenUpdating = False\nApplication.DisplayAlerts = False\n\ndirectory = Application.ActiveWorkbook.path &amp; \"\\\"\n\nfileName = Dir(directory &amp; \"*.xlsx\")\n\nDo While fileName &lt;&gt; \"\"\n    Workbooks.Open (directory &amp; fileName)\n        WrdArray() = Split(fileName, \".\")\n        For Each sheet In Workbooks(fileName).Worksheets\n        Workbooks(fileName).ActiveSheet.Name = WrdArray(0)\n            total = Workbooks(\"Template.xls\").Worksheets.Count\n            Workbooks(fileName).Worksheets(sheet.Name).Copy After:=Workbooks(\"Template.xls\").Worksheets(total)\n\n            GoTo exitFor:\n\n        Next sheet\n\nexitFor:\n    Workbooks(fileName).Close\n    fileName = Dir()\nLoop\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "charts"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1537312336, "post_id": 52395713, "comment_id": 91736514, "body": "Use the object browser to view the details of the chart object. Its no longer supported in newer versions of access (so my research suggests). The best way to see what it thinks it ought to be receiving is the object browser."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1537346892, "post_id": 52395713, "comment_id": 91747383, "body": "I can&#39;t get past &#39;Method or data member not found&#39; compile error for .ChartValues."}, {"owner": {"reputation": 53, "user_id": 9065292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd12740bdb0c873c31a362ec43a6fec9?s=128&d=identicon&r=PG&f=1", "display_name": "alexpbell", "link": "https://stackoverflow.com/users/9065292/alexpbell"}, "edited": false, "score": 0, "creation_date": 1537353852, "post_id": 52395713, "comment_id": 91751722, "body": "Thanks Doug, very helpful. .ChartValues appears to accept a String. I have got a chart working with .RowSource as a table name, .ChartAxis as a table field name, and .ChartValues as another table field name. But there doesn&#39;t seem to be a way to stop it treating the ChartAxis field as a category to group over and using a sum function for the group operation. Ideally one could populate the chart directly but I can&#39;t see how to do that either."}], "answers": [{"tags": [], "owner": {"reputation": 53, "user_id": 9065292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd12740bdb0c873c31a362ec43a6fec9?s=128&d=identicon&r=PG&f=1", "display_name": "alexpbell", "link": "https://stackoverflow.com/users/9065292/alexpbell"}, "is_accepted": true, "score": 1, "last_activity_date": 1537396654, "creation_date": 1537396654, "answer_id": 52415081, "question_id": 52395713, "link": "https://stackoverflow.com/questions/52395713/charts-graphs-in-access-vba/52415081#52415081", "title": "Charts/graphs in Access VBA", "body": "<p>This is one way to do it. First, create a new table and add some data:</p>\n\n<pre><code>Private Sub Form_Load()\n\n  Dim db As DAO.Database\n  Dim rec As Recordset\n  Dim tbl As DAO.TableDef\n\n  Set db = CurrentDb\n  Set tbl = db.CreateTableDef(\"tbl\")\n\n  With tbl\n    .Fields.Append .CreateField(\"first\", dbInteger)\n    .Fields.Append .CreateField(\"second\", dbInteger)\n  End With\n\n  db.TableDefs.Append tbl\n  db.TableDefs.Refresh\n\n  Set rec = db.OpenRecordset(\"tbl\")\n\n  rec.AddNew\n  rec(\"first\").Value = 0\n  rec(\"second\").Value = 2\n  rec.Update\n\n  rec.AddNew\n  rec(\"first\").Value = 1\n  rec(\"second\").Value = 2\n  rec.Update\n\n  rec.AddNew\n  rec(\"first\").Value = 2\n  rec(\"second\").Value = 2\n  rec.Update\n\n  rec.AddNew\n  rec(\"first\").Value = 3\n  rec(\"second\").Value = 2\n  rec.Update\n\n  Set rec = Nothing\n  Set db = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Second, graph that data by referencing the new table:</p>\n\n<pre><code>Private Sub command0_click()\n\n  Dim objchart As Chart\n  Set objchart = Me.Chart1\n\n  With objchart\n    .ChartTitle = \"tbl: second ~ first\"\n    .RowSource = \"tbl\"\n    .ChartAxis = \"first\"\n    .ChartValues = \"second\"\n  End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 9065292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd12740bdb0c873c31a362ec43a6fec9?s=128&d=identicon&r=PG&f=1", "display_name": "alexpbell", "link": "https://stackoverflow.com/users/9065292/alexpbell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2929, "favorite_count": 0, "accepted_answer_id": 52415081, "answer_count": 1, "score": 0, "last_activity_date": 1537396654, "creation_date": 1537311878, "question_id": 52395713, "link": "https://stackoverflow.com/questions/52395713/charts-graphs-in-access-vba", "title": "Charts/graphs in Access VBA", "body": "<p>How to initialize a chart with data in MS Access VBA? Eventually I found a suggestion <a href=\"http://www.utteraccess.com/forum/create-chart-vba-t1530514.html\" rel=\"nofollow noreferrer\">here</a> which with a bit of modification kept intellisense happy and resulted in this code:</p>\n\n<pre><code>Dim objchart As Chart\n\nDim arrData(3, 1) As Double\n\narrData(0, 0) = 1\narrData(1, 0) = 1\narrData(2, 0) = 1\narrData(3, 0) = 1\n\narrData(0, 1) = 1\narrData(1, 1) = 1\narrData(2, 1) = 1\narrData(3, 1) = 1\n\nSet objchart = Me.Chart1\n\nWith objchart\n    .ChartTitle = \"test\"\n    .ChartType = acChartLine\n    .ChartValues = arrData\nEnd With\n</code></pre>\n\n<p>But this throws </p>\n\n<blockquote>\n  <p>Compile error: Type mismatch</p>\n</blockquote>\n\n<p>on the line</p>\n\n<pre><code>    .ChartValues = arrData\n</code></pre>\n\n<p>I have tried it as \"row-first\" (arrData(1, 3)) and also just passing in a single array (arrData(3)). These both result in the same type mismatch error. While the intellisense is telling me that Chart1 exists, and that .ChartValues is a valid field, it doesn't tell me what kind of object it is expecting. I have googled extensively on this and come up empty. The best references I could find for Access VBA were <a href=\"https://rads.stackoverflow.com/amzn/click/com/0615927114\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">Building VBA Apps</a> and <a href=\"http://www.mvps.org/access/\" rel=\"nofollow noreferrer\">this</a> but neither go into detail on Charts or ChartObjects. </p>\n\n<p>Obviously I'd like to get past this type mismatch error. Even better would be if someone can give me some general advice on how to go about this when the closest thing to a language <a href=\"https://docs.microsoft.com/en-us/office/vba/api/overview/access\" rel=\"nofollow noreferrer\">reference</a> is silent on the part of the language you need.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2276, "user_id": 4925121, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3TTcs.jpg?s=128&g=1", "display_name": "d219", "link": "https://stackoverflow.com/users/4925121/d219"}, "edited": false, "score": 0, "creation_date": 1537314152, "post_id": 52395572, "comment_id": 91736870, "body": "Why have you typed &quot;jvcghjokjhvcdf...&quot; at the end of this?"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1537316879, "post_id": 52395572, "comment_id": 91737368, "body": "What&#39;s with <code>Cells(2, f)</code>? Firstly, <code>f</code> is not defined anywhere in your code. Appears you would be wanting <code>Cells(2, &quot;F&quot;)</code>. Next, you do understand that you are updating only 1 cell: 1.) this line isn&#39;t within your loop, 2.) even if it was, you are using the same cell address anyway."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 10246459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mg2qqYL_goI/AAAAAAAAAAI/AAAAAAAAACc/neH9MDdufP4/photo.jpg?sz=128", "display_name": "Joel Ortiz", "link": "https://stackoverflow.com/users/10246459/joel-ortiz"}, "edited": false, "score": 0, "creation_date": 1537485920, "post_id": 52396354, "comment_id": 91812725, "body": "thanks, i added a loop to proccess a column of addresses, but times out after 17?"}, {"owner": {"reputation": 25, "user_id": 10246459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mg2qqYL_goI/AAAAAAAAAAI/AAAAAAAAACc/neH9MDdufP4/photo.jpg?sz=128", "display_name": "Joel Ortiz", "link": "https://stackoverflow.com/users/10246459/joel-ortiz"}, "edited": false, "score": 0, "creation_date": 1538000788, "post_id": 52396354, "comment_id": 91993385, "body": "I now get a problem when there is no address I tried this, but dd not work"}, {"owner": {"reputation": 25, "user_id": 10246459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mg2qqYL_goI/AAAAAAAAAAI/AAAAAAAAACc/neH9MDdufP4/photo.jpg?sz=128", "display_name": "Joel Ortiz", "link": "https://stackoverflow.com/users/10246459/joel-ortiz"}, "edited": false, "score": 0, "creation_date": 1538161411, "post_id": 52396354, "comment_id": 92061141, "body": "can you help with next question"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "reply_to_user": {"reputation": 25, "user_id": 10246459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mg2qqYL_goI/AAAAAAAAAAI/AAAAAAAAACc/neH9MDdufP4/photo.jpg?sz=128", "display_name": "Joel Ortiz", "link": "https://stackoverflow.com/users/10246459/joel-ortiz"}, "edited": false, "score": 0, "creation_date": 1538161543, "post_id": 52396354, "comment_id": 92061192, "body": "Sorry, the way StackOverflow works is that you can only ask one question per post. Unfortunately that means you will have to <a href=\"https://stackoverflow.com/questions/ask\">ask a new one</a>. If you want to post the link here to your new question then I will take a look at it when I have a chance (end of month is busy time for me at work, so someone else may be able to help before I get a chance). Thanks!"}], "tags": [], "owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "is_accepted": true, "score": 0, "last_activity_date": 1537318162, "last_edit_date": 1537318162, "creation_date": 1537317391, "answer_id": 52396354, "question_id": 52395572, "link": "https://stackoverflow.com/questions/52395572/cant-assign-text-to-cell-with-excel-vba/52396354#52396354", "title": "Can&#39;t assign text to cell with Excel VBA", "body": "<p>Couple of things. First and foremost, your loop is unnecessary. I ran your code, and there's nothing to loop. Even if it was necessary, it's being used improperly.</p>\n\n<p>So, in assuming that you in fact do not need a <code>For...Next</code> loop, then you can use the <strong>index</strong> number of <code>0</code> for your collection of <code>IE.Document.getElementsbyClassName(\"desktop-title-subcontent\")</code>, then set your cell reference equal to the <code>innerText</code> property of that collection item.</p>\n\n<p>This brings me to the next issue, your cell reference. <code>Cells(2, f)</code>, the <code>f</code> is not a declared variable. If you where actually wanting to use the column \"F\", then you need to enclose 'F' in double quotes:<br>\n<code>Cells(2, \"F\")</code> or use the column's index of <code>6</code>, <code>Cells(2, 6)</code></p>\n\n<p>So, replace this entire portion:</p>\n\n<pre><code>Set adds = IE.Document.getElementsbyClassName(\"desktop-title-subcontent\")\n\n    For Each add In adds\n\n        Debug.Print add.innertext\n    Next\n\n    Cells(2, f).Value = add.innertext\n</code></pre>\n\n<p>with this:</p>\n\n<pre><code>Cells(2, \"F\").Value = IE.Document.getElementsByClassName _\n            (\"desktop-title-subcontent\")(0).innerText\n</code></pre>\n\n<hr>\n\n<h2>OPTIONAL</h2>\n\n<p>And lastly, I would look into using <a href=\"https://support.microsoft.com/en-us/help/245115/using-early-binding-and-late-binding-in-automation\" rel=\"nofollow noreferrer\">Early Binding over late binding</a>. It has many advantages, with a possible notable speed improvement.</p>\n\n<p>You would need to set a reference to <code>Microsoft Internet Controls</code> and declare <code>IE</code> as type <code>InternetExplorer</code> vs <code>Object</code>. But that's not going to make or break your code.</p>\n"}], "owner": {"reputation": 25, "user_id": 10246459, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-mg2qqYL_goI/AAAAAAAAAAI/AAAAAAAAACc/neH9MDdufP4/photo.jpg?sz=128", "display_name": "Joel Ortiz", "link": "https://stackoverflow.com/users/10246459/joel-ortiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 52396354, "answer_count": 1, "score": 1, "last_activity_date": 1538001051, "creation_date": 1537310674, "last_edit_date": 1537316455, "question_id": 52395572, "link": "https://stackoverflow.com/questions/52395572/cant-assign-text-to-cell-with-excel-vba", "title": "Can&#39;t assign text to cell with Excel VBA", "body": "<p>I'm trying to scrape zip codes from Google. I've been trying to put <code>innertext</code> into a cell, but I think I may be getting a variable mismatch on 2nd to last line.</p>\n\n<pre><code>'This Must go at the top of your module. It's used to set IE as the active window\n\nSub Automate_IE_Enter_Data()\n'This will load a webpage in IE\n    Dim i As Long\n    Dim URL As String\n    Dim IE As Object\n    Dim objElement As Object\n    Dim objCollection As Object\n    Dim HWNDSrc As Long\n    Dim adds As Variant, add As Variant\n    Dim addt As String\n\n\n    'Create InternetExplorer Object\n    Set IE = CreateObject(\"InternetExplorer.Application\")\n\n    'Set IE.Visible = True to make IE visible, or False for IE to run in the background\n    IE.Visible = True\n\n    'Define URL\n    URL = \"https://www.google.com/search?ei=djKhW7nELYqs8AO96baoAw&amp;q=1000 Westover Rd kansas city, Mo\"\n\n    'Navigate to URL\n    IE.Navigate URL\n\n    ' Statusbar let's user know website is loading\n    Application.StatusBar = URL &amp; \" is loading. Please wait...\"\n\n    ' Wait while IE loading...\n    'IE ReadyState = 4 signifies the webpage has loaded (the first loop is set to avoid inadvertantly skipping over the second loop)\n    Do While IE.ReadyState = 4: DoEvents: Loop\n    Do Until IE.ReadyState = 4: DoEvents: Loop\n\n    'Webpage Loaded\n    Application.StatusBar = URL &amp; \" Loaded\"\n\n    'Get Window ID for IE so we can set it as activate window\n    HWNDSrc = IE.Hwnd\n    'Set IE as Active Window\n    'SetForegroundWindow HWNDSrc\n\n    Debug.Print \"ihgc\"\n\n    'Unload IE\nendmacro:\n    Set adds = IE.Document.getElementsbyClassName(\"desktop-title-subcontent\")\n\n        For Each add In adds\n\n            Debug.Print add.innertext\n        Next\n\n        Cells(2, f).Value = add.innertext\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-formula"], "answers": [{"tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 0, "last_activity_date": 1537330558, "creation_date": 1537330558, "answer_id": 52397945, "question_id": 52395361, "link": "https://stackoverflow.com/questions/52395361/copying-row-from-existing-sheet-based-on-date-range/52397945#52397945", "title": "Copying Row from existing sheet based on date range", "body": "<p>Just use <code>Range(\"L:L\")</code>. Also, I would suggest you use <code>With ActiveSheet</code> or better yet <code>With Worksheet(\"sheetname\")</code> </p>\n\n<pre><code>Application.ScreenUpdating = False\nDim LastRow As Long\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nWith Worksheets(\"Sheet1\")\n    Range(\"L:L\").AutoFilter Field:=1, Criteria1:=\"&lt;=\" &amp; Date\n\n    Intersect(Rows(\"2:\" &amp; LastRow), _\n    Range(\"A:A,F:H,K:L,R:R,U:U\").SpecialCells(xlCellTypeVisible)).Copy _\n    Sheets(\"Sheet2\").Cells(3, 1)\n\n    Range(\"L1\").AutoFilter\nEnd With\nApplication.ScreenUpdating = True\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 8228735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/151540b300a471f21fda3a31ac5f3da5?s=128&d=identicon&r=PG&f=1", "display_name": "Hakan", "link": "https://stackoverflow.com/users/8228735/hakan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594055141, "creation_date": 1537309260, "last_edit_date": 1594055141, "question_id": 52395361, "link": "https://stackoverflow.com/questions/52395361/copying-row-from-existing-sheet-based-on-date-range", "title": "Copying Row from existing sheet based on date range", "body": "<p>Below code helps me out, if on sheet1, specific date on column L is less than or equal to today's date, from sheet1 copy specific rows to sheet2 starting with A3 and do it for the whole list.</p>\n\n<p>I have two follow up questions; </p>\n\n<p>1) I want copied cells on sheet2 to be inserted on a newly created row ( need to incorporate End(xlUp) ) . Couldn't figure out yet</p>\n\n<p>2) For some reason code doesn't work if my first sheet have filters on... I have to remove filters for the code. Not sure why it is not working regardless of filters on or off.</p>\n\n<pre><code>     Sub CopyRange()\nApplication.ScreenUpdating = False\nDim LastRow As Long\nLastRow = Cells.Find(\"*\", SearchOrder:=xlByRows, \n     SearchDirection:=xlPrevious).Row\nRange(\"L1:L\" &amp; LastRow).AutoFilter Field:=1, Criteria1:=\"&lt;=\" &amp; Date\nIntersect(Rows(\"2:\" &amp; LastRow), \n     Range(\"A:A,F:H,K:L,R:R,U:U\").SpecialCells(xlCellTypeVisible)).Copy \n     Sheets(\"Sheet2\").Cells(3, 1)\n     Range(\"L1\").AutoFilter\n   Application.ScreenUpdating = True\n End Sub\n</code></pre>\n"}, {"tags": ["vba", "colors", "formula"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1537308960, "post_id": 52395093, "comment_id": 91735670, "body": "If you put a breakpoint on the <code>For...</code> line and wait a couple of seconds before proceeding does it work as expected?  You might be better off using Conditional Formatting so the color always matches the formula result."}], "owner": {"reputation": 11, "user_id": 10344293, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_T35IZhk78g/AAAAAAAAAAI/AAAAAAAADS4/xfCCGfsG1VY/photo.jpg?sz=128", "display_name": "Kevin Connolly", "link": "https://stackoverflow.com/users/10344293/kevin-connolly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1537307545, "creation_date": 1537307545, "question_id": 52395093, "link": "https://stackoverflow.com/questions/52395093/vba-to-apply-formula-to-column-and-then-color-cells-based-on-formula-results", "title": "VBA to apply formula to column and then color cells based on formula results", "body": "<p>So I have a program that loops through all the excel files in a folder and applies a formula to a cell. That works. I also want to color all the cells yellow if the formula comes back true. That works. When I put them together all the cells return False and are shaded Red. But when I run the color code standalone it works. My guess is that the formula isn't applied by the time it does the coloring loop.</p>\n\n<p>Any ideas on how to make sure that the formula is applied before the For Loop?</p>\n\n<pre><code>    lastRow = wb.Worksheets(1).Cells(Rows.Count, \"A\").End(xlUp).Row\n\n        wb.Worksheets(1).Range(\"H2\").Select\n        ActiveCell.FormulaR1C1 = \"=NOT(ISNA(MATCH(RC[-6],'\\\\netdrv00\\pcps\\PlannerReports\\BSO Planners\\New Automation Line\\[_MyDataFilePrep.xlsm]CarrierDB'!C5:C5,0)))\"\n        Range(\"H2\").Select\n        Selection.AutoFill Destination:=Range(\"H2:H\" &amp; lastRow), Type:=xlFillDefault\n\n    For j = wb.Worksheets(1).Cells(Rows.Count, \"A\").End(xlUp).Row To 2 Step -1\n        If wb.Worksheets(1).Cells(j, \"H\") = True Then\n            wb.Worksheets(1).Cells(j, \"H\").Interior.ColorIndex = 6\n            Else: wb.Worksheets(1).Cells(j, \"H\").Interior.ColorIndex = 3\n                End If\n\n    Next j\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1537333920, "post_id": 52395091, "comment_id": 91741054, "body": "Because you are looping through the worksheet collection (bypassing the named sheets), your loop will finish once all sheets have been processed. The loop will then exit naturally. In other words, the loop you have will do what you want - unless you have some other problem that you have not described."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10296107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f8b5adc885d2911658d2ff35244c20?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica E.", "link": "https://stackoverflow.com/users/10296107/jessica-e"}, "edited": false, "score": 0, "creation_date": 1537307730, "post_id": 52395114, "comment_id": 91735318, "body": "Sorry, I was trying to add the format so that the code looked like it does now!  I&#39;ll try it out and let you know.  Thank you!"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 13, "user_id": 10296107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f8b5adc885d2911658d2ff35244c20?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica E.", "link": "https://stackoverflow.com/users/10296107/jessica-e"}, "edited": false, "score": 0, "creation_date": 1537321638, "post_id": 52395114, "comment_id": 91738324, "body": "@JessicaE. A big caveat is that &quot;Tech&quot; better be the last sheet or you will exit the loop early. If you really want that to exit on whatever the last sheet is, I suggest doing instead <code>If ws.index = thisworkbook.worksheets.count then exit for</code>. (I&#39;m on mobile but am almost positive that would do it, I&#39;m pretty sure the sheet indices start at 1 and not 0)"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 0, "last_activity_date": 1537307652, "creation_date": 1537307652, "answer_id": 52395114, "question_id": 52395091, "link": "https://stackoverflow.com/questions/52395091/vba-macro-stuck-in-loop/52395114#52395114", "title": "VBA macro stuck in loop", "body": "<p>I think you'd just need to add:</p>\n\n<pre><code>For Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Group Key\" And ws.Name &lt;&gt; \"AUX Key\" And ws.Name &lt;&gt; \"Start\" And ws.Name &lt;&gt; \"SSummary\" And ws.Name &lt;&gt; \"TSummary\" Then\n           'code omitted, but it essentially is adding a date column and a numbered row column in each worksheet/basic formatting     \n    End If\n    If ws.Name = \"Tech\" Then Exit For '' THIS LINE\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10296107, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77f8b5adc885d2911658d2ff35244c20?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica E.", "link": "https://stackoverflow.com/users/10296107/jessica-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 52395114, "answer_count": 1, "score": -1, "last_activity_date": 1537307652, "creation_date": 1537307534, "last_edit_date": 1537307601, "question_id": 52395091, "link": "https://stackoverflow.com/questions/52395091/vba-macro-stuck-in-loop", "title": "VBA macro stuck in loop", "body": "<p>I have coded a (what I thought was simple) macro to repeat the same actions across 44 sheets of my workbook (while excluding the first 5).</p>\n\n<p>Here is the code: </p>\n\n<pre><code>Sub LoopThroughSheets()\nDim ws As Worksheet\nDim Lastrow As Long\nDim i As Long\nDim rng As Range\n\n\nFor Each ws In ActiveWorkbook.Worksheets\n    If ws.Name &lt;&gt; \"Group Key\" And ws.Name &lt;&gt; \"AUX Key\" And ws.Name &lt;&gt; \"Start\" And ws.Name &lt;&gt; \"SSummary\" And ws.Name &lt;&gt; \"TSummary\" Then\n           'code omitted, but it essentially is adding a date column and a numbered row column in each worksheet/basic formatting     \n    End If\n\nNext ws\n\nEnd Sub\n</code></pre>\n\n<p>How would I add a snippet of code that ends the loop once the last sheet (named \"Tech\") has been formatted?</p>\n"}, {"tags": ["excel", "vba", "excel-formula"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1537307563, "post_id": 52395038, "comment_id": 91735256, "body": "What have you tried? You&#39;ll need to loop through each character in each cell and check the case, and apply formatting from there."}, {"owner": {"reputation": 8830, "user_id": 5336948, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/YqCFK.jpg?s=128&g=1", "display_name": "Forward Ed", "link": "https://stackoverflow.com/users/5336948/forward-ed"}, "edited": false, "score": 1, "creation_date": 1537310318, "post_id": 52395038, "comment_id": 91736030, "body": "cant do partial colouring of text with formulas.  You can do an all or nothing approach with Conditional formatting."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1537331094, "post_id": 52395038, "comment_id": 91740247, "body": "Is doable with VBA though, don\u2019t get the wrong idea"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 2, "creation_date": 1537354377, "post_id": 52395038, "comment_id": 91752076, "body": "Using VBA, change the formula to a text string; then use the <code>.Characters</code> property of the <code>Range</code> object to test each character, and format according to your tests."}], "answers": [{"tags": [], "owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "is_accepted": false, "score": 0, "last_activity_date": 1537899119, "last_edit_date": 1537899119, "creation_date": 1537898013, "answer_id": 52504134, "question_id": 52395038, "link": "https://stackoverflow.com/questions/52395038/formatting-only-lower-case-letters/52504134#52504134", "title": "Formatting only lower case letters", "body": "<p><code>\"... OR do you have suggestion for ... code to made only lower case letters red\"</code></p>\n\n<p>Yeah, that would be this, but it's not incredibly efficient</p>\n\n<pre><code>Option Explicit\n\nSub LowercaseToRed()\n\n    SpeedUp True\n    On Error GoTo ErrClose\n\n    Dim cell As Range\n    For Each cell In Range(\"A1:D10\")\n\n        Dim i As Long\n        For i = 1 To cell.Characters.count\n            If 97 &lt;= Asc(Mid(cell.Value2, i, 1)) And Asc(Mid(cell.Value2, i, 1)) &lt;= 122 Then\n                cell.Characters(i, 1).Font.color = vbRed\n            End If\n        Next i\n\n    Next cell\n\nErrClose:\n    SpeedUp False\n\nEnd Sub\n\nSub SpeedUp(ByVal toggleOn As Boolean)\n\n    With Application\n        .Calculation = IIf(toggleOn, xlCalculationManual, xlCalculationAutomatic)\n        .ScreenUpdating = Not toggleOn\n        .DisplayStatusBar = Not toggleOn\n        .EnableEvents = Not toggleOn\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10382541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3503cb06a9f6f4d30302c700fd4a222?s=128&d=identicon&r=PG&f=1", "display_name": "Caitlin D", "link": "https://stackoverflow.com/users/10382541/caitlin-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1556949243, "creation_date": 1537307276, "last_edit_date": 1556949243, "question_id": 52395038, "link": "https://stackoverflow.com/questions/52395038/formatting-only-lower-case-letters", "title": "Formatting only lower case letters", "body": "<p>I'm trying to format cells where only the lower case letters would be red, all other upper case letters and all numbers would be black.</p>\n\n<p>The cells are the result of a formula, referencing to another page. The cell which it is referenced to is comprised of other formulas within that page.</p>\n\n<p>How do I get my font's formatting to travel with formulas (it would be easy to color the lower case letters red in this instance because I have extracted them into their own cell along the way) OR do you have a suggestion for conditional formatting or code to made only lower case letters red?</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 1, "last_activity_date": 1537301390, "creation_date": 1537301390, "answer_id": 52393936, "question_id": 52393891, "link": "https://stackoverflow.com/questions/52393891/toggle-highlight-on-for-specific-cells-macro/52393936#52393936", "title": "Toggle highlight on for Specific cells Macro", "body": "<pre><code>Sub Macro7()\n'\n' Macro7 Macro\n'\n\n'\n\n\n    With ActiveSheet.Range(\"E4:S4\")    \n        If .Interior.Color = 65535 Then\n            .Interior.Color = xlNone\n        Else\n            .Interior.Color = 65535\n        End If\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10382289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8acae70d2c5817aae1fb8716b79c88e1?s=128&d=identicon&r=PG&f=1", "display_name": "QwerkyGeek", "link": "https://stackoverflow.com/users/10382289/qwerkygeek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1593730402, "creation_date": 1537301202, "last_edit_date": 1593730402, "question_id": 52393891, "link": "https://stackoverflow.com/questions/52393891/toggle-highlight-on-for-specific-cells-macro", "title": "Toggle highlight on for Specific cells Macro", "body": "<p>So I have a spreadsheet that I want a button where when I click it E4:S4 are highlighted and when it is clicked a second time E4:S4 are unhighlighted.</p>\n\n<p>Here is what I have:</p>\n\n<pre><code>Sub Macro7()\n'\n' Macro7 Macro\n'\n\n'\n    Range(\"E4:S4\").Select\n\n    With Selection.Interior.Color = 65535\n\n    End With\n    If Selection.Interior.Color = 65535 Then\n        Selection.Interior.Pattern = xlNone\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537347173, "post_id": 52395221, "comment_id": 91747535, "body": "Have checked via OutlookSpy, and <code>PR_EXTENDED_RULE_CONDITION</code> is not there, here is part of the list, and please bare in mind this is OL365:  <code>PR_CONVERSATION_TOPIC\tPT_STRING8\tJunk E-mail Rule  PR_CREATION_TIME\tPT_SYSTIME\t07:10, 17-09-2018 PR_DEPTH\tPT_LONG\t0   PR_DISPLAY_NAME\tPT_STRING8\tMAPI_E_NOT_FOUND   PR_DOTSTUFF_STATE\tPT_LONG\tMAPI_E_NOT_FOUND   PR_ENTRYID\tPT_BINARY\tcb:24, lpb: EF 00 00 00 41 71 66 A6 6D E1 E8 47 85 FD 29 4E 17 46 55 7C 28 31 10 00   PR_HASATTACH\tPT_BOOLEAN\tfalse   PR_ICON_INDEX\tPT_LONG\tMAPI_E_NOT_FOUND</code>"}, {"owner": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537347597, "post_id": 52395221, "comment_id": 91747787, "body": "What about the proptag for Safe Senders, can anyone provide the correct one?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537366559, "post_id": 52395221, "comment_id": 91759611, "body": "Is that an Exchange or a PST store? Does the script above work in OutlookSpy (click Script, past the script, click Run)?"}, {"owner": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537368497, "post_id": 52395221, "comment_id": 91760853, "body": "It\u2019s an Exchange (in the cloud) store. The \u201cscript\u201d is pure vba code from within OL"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537372635, "post_id": 52395221, "comment_id": 91763435, "body": "I meant the test script in my reply."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537372708, "post_id": 52395221, "comment_id": 91763485, "body": "Keep in mind that the data can be stored in both the Exchange rule and in a profile section (registry)."}, {"owner": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537437732, "post_id": 52395221, "comment_id": 91787905, "body": "I don&#39;t see any scripts from you in your reply - where did you put it? I&#39;m fully aware it can be both places, but I don&#39;t find it anywhere using OutlookSpy. Do you not know of these proptags/schemas?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537454616, "post_id": 52395221, "comment_id": 91798825, "body": "The script is in my reply - it creates an instance of the Redemption.RDOSession object and logs the trusted senders:      set Session = CreateObject(&quot;Redemption.RDOSession&quot;)     Session.MAPIOBJECT = Application.Session.MAPIOBJECT     set JunkOptions = Session.JunkEmailOptions     for each vAddress in JunkOptions.TrustedSenders       Debug.Print vAddress     next"}, {"owner": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537457984, "post_id": 52395221, "comment_id": 91800921, "body": "I get this error: <code>OutlookSpy Script Error X Error executing script: DISP_E_EXCEPTION Microsoft VBScript runtime error ActiveX component can&#39;t create object: Redemption.RDOSession&#39; Line 1, Column 1 OK</code> I don&#39;t have &quot;Redemption&quot; installed."}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537458820, "post_id": 52395221, "comment_id": 91801426, "body": "Yes, you need to download and install Redemption from <a href=\"http://www.dimastr.com/redemption/download.htm\" rel=\"nofollow noreferrer\">dimastr.com/redemption/download.htm</a>"}, {"owner": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537533528, "post_id": 52395221, "comment_id": 91830577, "body": "As I expected this worked just perfect, but is not what I needed, as I need to avoid any add-in&#39;s, and make it work as it already does with the Blocked Senders just using proptags/schemas."}, {"owner": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537534258, "post_id": 52395221, "comment_id": 91830993, "body": "Dmitry can you (or who can) provide that schema? Can Redemption provide this kind of information?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537538119, "post_id": 52395221, "comment_id": 91833284, "body": "The data is stored in a profile section, and it is only accessible with Extended MAPI (or Redemption)."}, {"owner": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537539609, "post_id": 52395221, "comment_id": 91834189, "body": "Why and how can I get Blocked Senders then? Aren\u2019t they coming from same Store?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "edited": false, "score": 0, "creation_date": 1537545211, "post_id": 52395221, "comment_id": 91837351, "body": "Again, for an Exchange mailbox, the data is in the rule itself (see the updated answer above). For all other stores, the data is in the profile section stored in the registry."}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1537545201, "last_edit_date": 1537545201, "creation_date": 1537308430, "answer_id": 52395221, "question_id": 52393658, "link": "https://stackoverflow.com/questions/52393658/pr-spam-trusted-senders-w-and-pr-spam-blocked-senders/52395221#52395221", "title": "PR_SPAM_TRUSTED_SENDERS_W and PR_SPAM_BLOCKED_SENDERS", "body": "<p>The data is stored inside the <code>PR_EXTENDED_RULE_CONDITION</code> binary property - take a look at the rule with <a href=\"http://www.dimastr.com/outspy\" rel=\"nofollow noreferrer\">OutlookSpy</a> - go to the Inbox folder, click IMAPIFolder button, find the rule hidden message on the \"Associated Contents\" tab, open the message. Select the PR_EXTENDED_RULE_CONDITION property - OutlookSpy will parse it and display its data. You can also take a look at the IMAPIFolder | PR_RULES_TABLE tab.</p>\n\n<p>You can either parse that property, or use <a href=\"http://www.dimastr.com/redemption\" rel=\"nofollow noreferrer\">Redemption</a> - it exposes the <a href=\"http://www.dimastr.com/redemption/rdojunkemailoptions.htm\" rel=\"nofollow noreferrer\">RDOJunkEmailOptions</a> object:</p>\n\n<pre><code>set Session = CreateObject(\"Redemption.RDOSession\")\nSession.MAPIOBJECT = Application.Session.MAPIOBJECT\nset JunkOptions = Session.JunkEmailOptions\nfor each vAddress in JunkOptions.TrustedSenders\n  Debug.Print vAddress\nnext\n</code></pre>\n\n<p>In case of an Exchange mailbox, here is how the rule looks like:</p>\n\n<pre><code>rt : RES_AND\n  cRes : 2\n  lpRes : \n    rt : RES_OR\n      cRes : 2\n      lpRes : \n        rt : RES_OR\n          cRes : 1\n          lpRes : \n            rt : RES_CONTENT\n            resContent : \n              ulFuzzyLevel : FL_FULLSTRING FL_IGNORECASE\n              ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n              lpProp :\n                ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                Value : blocked.sender@demo.com\n\n        rt : RES_AND\n          cRes : 2\n          lpRes : \n            rt : RES_OR\n              cRes : 2\n              lpRes : \n                rt : RES_AND\n                  cRes : 2\n                  lpRes : \n                    rt : RES_EXIST\n                    res.resExist :\n                      ulPropTag : PR_CONTENT_FILTER_SCL (0x40760003)\n\n                    rt : RES_PROPERTY\n                    res.resProperty :\n                      relop : RELOP_GT\n                      ulPropTag : PR_CONTENT_FILTER_SCL (0x40760003)\n                      lpProp :\n                        ulPropTag : PR_CONTENT_FILTER_SCL (0x40760003)\n                        Value : -1\n\n                rt : RES_OR\n                  cRes : 0\n                  lpRes : \n\n            rt : RES_NOT\n            res.resNot :\n              lpRes : \n                rt : RES_OR\n                  cRes : 2\n                  lpRes : \n                    rt : RES_OR\n                      cRes : 1\n                      lpRes : \n                        rt : RES_CONTENT\n                        resContent : \n                          ulFuzzyLevel : FL_SUBSTRING FL_IGNORECASE\n                          ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                          lpProp :\n                            ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                            Value : @safe.sender.domain.com\n\n                    rt : RES_SUBRESTRICTION\n                    resSub : \n                      ulSubObject : PR_MESSAGE_RECIPIENTS\n                      lpRes :     rt : RES_OR\n                          cRes : 0\n                          lpRes : \n\n    rt : RES_NOT\n    res.resNot :\n      lpRes : \n        rt : RES_OR\n          cRes : 3\n          lpRes : \n            rt : RES_OR\n              cRes : 5\n              lpRes : \n                rt : RES_CONTENT\n                resContent : \n                  ulFuzzyLevel : FL_FULLSTRING FL_IGNORECASE\n                  ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                  lpProp :\n                    ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                    Value : safe.sender.1@demo.com\n\n                rt : RES_CONTENT\n                resContent : \n                  ulFuzzyLevel : FL_FULLSTRING FL_IGNORECASE\n                  ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                  lpProp :\n                    ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                    Value : safe.sender.2@demo.com\n\n                rt : RES_CONTENT\n                resContent : \n                  ulFuzzyLevel : FL_FULLSTRING FL_IGNORECASE\n                  ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                  lpProp :\n                    ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                    Value : safe.sender.3@demo.com\n\n                rt : RES_CONTENT\n                resContent : \n                  ulFuzzyLevel : FL_FULLSTRING FL_IGNORECASE\n                  ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                  lpProp :\n                    ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                    Value : safe.sender.4@demo.com\n\n                rt : RES_CONTENT\n                resContent : \n                  ulFuzzyLevel : FL_FULLSTRING FL_IGNORECASE\n                  ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                  lpProp :\n                    ulPropTag : PR_SENDER_EMAIL_ADDRESS_W (0x0C1F001F)\n                    Value : safe.sender.5@demo.com\n\n            rt : RES_SUBRESTRICTION\n            resSub : \n              ulSubObject : PR_MESSAGE_RECIPIENTS\n              lpRes :     rt : RES_OR\n                  cRes : 0\n                  lpRes : \n\n            rt : RES_OR\n              cRes : 0\n              lpRes : \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10382183, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-dRmvvxqw4QA/AAAAAAAAAAI/AAAAAAAARuY/Zswp4rFfcQk/photo.jpg?sz=128", "display_name": "Bjarne Dein", "link": "https://stackoverflow.com/users/10382183/bjarne-dein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537545201, "creation_date": 1537300246, "question_id": 52393658, "link": "https://stackoverflow.com/questions/52393658/pr-spam-trusted-senders-w-and-pr-spam-blocked-senders", "title": "PR_SPAM_TRUSTED_SENDERS_W and PR_SPAM_BLOCKED_SENDERS", "body": "<p>I've played quite a bit with \"PR_SPAM_BLOCKED_SENDERS\" (\"<a href=\"http://schemas.microsoft.com/mapi/proptag/0x6106001F\" rel=\"nofollow noreferrer\">http://schemas.microsoft.com/mapi/proptag/0x6106001F</a>\") and using VBA to manipulate/update my Spam list in real time in OL (o365), and it works just great.\nI long forgot how and where I got hold of the proptag for it, but I did somehow, and now I need to get hold of the safe list (PR_SPAM_TRUSTED_SENDERS_W) as well, but the only proptag (\"<a href=\"http://schemas.microsoft.com/mapi/proptag/0x001f0418\" rel=\"nofollow noreferrer\">http://schemas.microsoft.com/mapi/proptag/0x001f0418</a>\") I've found so far fails:-(</p>\n\n<p>Can you help me out here - what is the correct proptag?</p>\n\n<p>Here is some base code that work great for the blocked (PR_SPAM_BLOCKED_SENDERS), but not the safe (PR_SPAM_TRUSTED_SENDERS_W):</p>\n\n<pre><code>  Const PR_SPAM_TRUSTED_SENDERS_W = \"http://schemas.microsoft.com/mapi/proptag/0x001f0418\"\n  Const PR_SPAM_BLOCKED_SENDERS = \"http://schemas.microsoft.com/mapi/proptag/0x6106001F\"\n\n  Set oStorage = oInbox.GetStorage(\"Junk E-mail Rule\", olIdentifyBySubject)\n  Set oPropAcc = oStorage.propertyAccessor\n  sBlockedSenders = oPropAcc.GetProperty(PR_SPAM_BLOCKED_SENDERS)\n  Debug.Print sBlockedSenders \n</code></pre>\n\n<p>Many thanks in advance!</p>\n\n<p>Best Regards,</p>\n\n<p>Bjarne Dein</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537300609, "post_id": 52393603, "comment_id": 91732650, "body": "&quot;Please check this link...to check all the related code.&quot; - Instead, can you please post an <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> here, so we know exactly what you&#39;re using and trying to do?  I (and I assume most others) don&#39;t have time to wade through a ton of misc. code, especially without any idea as to what is causing your issue. Otherwise, this in way too broad and hard to help troubleshoot."}, {"owner": {"reputation": 5090, "user_id": 4509268, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/J0Lem.jpg?s=128&g=1", "display_name": "Jad Chahine", "link": "https://stackoverflow.com/users/4509268/jad-chahine"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537301067, "post_id": 52393603, "comment_id": 91732808, "body": "@BruceWayne thank you, I edited the answer can you check it please? your response will be highly appreciated"}, {"owner": {"reputation": 5090, "user_id": 4509268, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/J0Lem.jpg?s=128&g=1", "display_name": "Jad Chahine", "link": "https://stackoverflow.com/users/4509268/jad-chahine"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537333592, "post_id": 52393603, "comment_id": 91740939, "body": "@BruceWayne do you have any idea about that?"}], "answers": [{"comments": [{"owner": {"reputation": 5090, "user_id": 4509268, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/J0Lem.jpg?s=128&g=1", "display_name": "Jad Chahine", "link": "https://stackoverflow.com/users/4509268/jad-chahine"}, "edited": false, "score": 0, "creation_date": 1537341773, "post_id": 52398524, "comment_id": 91744545, "body": "Great, this answer suits my requirements although i use it to add a new row (instead of column) as I switch my sheet to rows orientation instead of columns, thank you!"}], "tags": [], "owner": {"reputation": 36, "user_id": 10305053, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-20FmAO5JSvo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaMCRyHo6lTVn-gWAbATBo5V_29WbQ/mo/photo.jpg?sz=128", "display_name": "Walton Surratt", "link": "https://stackoverflow.com/users/10305053/walton-surratt"}, "is_accepted": true, "score": 2, "last_activity_date": 1537335001, "last_edit_date": 1537335001, "creation_date": 1537333960, "answer_id": 52398524, "question_id": 52393603, "link": "https://stackoverflow.com/questions/52393603/add-dynamic-form-into-excel-on-button-click-using-vba/52398524#52398524", "title": "Add dynamic form into excel on button click using VBA", "body": "<p>It appears the XML Generator you are using already has a function to dynamically search for values until it reaches the last column.</p>\n\n<p>Assuming we only have to modify the first row, it would be as simple as adding a new header to the <strong>last empty column</strong></p>\n\n<p>Here are two macros as an example:</p>\n\n<pre><code>Sub ButtonClick()\n    Call Add_XML_Header(\"/student/mark\")\nEnd Sub\n\n\n\nSub Add_XML_Header(Header As String)\n    Dim LastColumn As Integer\n    LastColumn = ActiveSheet.Cells(1, Columns.Count).End(xlToLeft).Column\n\n    ActiveSheet.Cells(1, LastColumn + 1).Value = Header\nEnd Sub\n</code></pre>\n\n<p>Assign the first one titled <em>ButtonClick</em> to the button being used in your form.</p>\n\n<p>This will result in an output like this:\n<a href=\"https://i.stack.imgur.com/YQLis.jpg\" rel=\"nofollow noreferrer\">Example1</a></p>\n\n<p>If you wish to go with second option of 2 headers, simply modify the ButtonClick sub like so:</p>\n\n<pre><code>Sub ButtonClick()\n    Call Add_XML_Header(\"/student/material/name\")\n    Call Add_XML_Header(\"/student/material/mark\")\nEnd Sub\n</code></pre>\n\n<p>However, this will slightly differ from your posted example. It will add both columns to the first row horizontally like the other headers rather than vertically as you had shown.</p>\n\n<p>Here's what it would look like:\n<a href=\"https://i.stack.imgur.com/nsMey.jpg\" rel=\"nofollow noreferrer\">Example2</a></p>\n"}], "owner": {"reputation": 5090, "user_id": 4509268, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/J0Lem.jpg?s=128&g=1", "display_name": "Jad Chahine", "link": "https://stackoverflow.com/users/4509268/jad-chahine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 1, "accepted_answer_id": 52398524, "answer_count": 1, "score": 0, "last_activity_date": 1537335001, "creation_date": 1537299965, "last_edit_date": 1537301015, "question_id": 52393603, "link": "https://stackoverflow.com/questions/52393603/add-dynamic-form-into-excel-on-button-click-using-vba", "title": "Add dynamic form into excel on button click using VBA", "body": "<p>I am trying to create a vba program in excel that exports the user entered data to XML format, so far I have the following:</p>\n\n<p>Below image shows 4 columns</p>\n\n<ul>\n<li>Student Id</li>\n<li>Student Name</li>\n<li>Student Age</li>\n<li>Student Mark</li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/S9qJP.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/S9qJP.png\" alt=\"enter image description here\"></a></p>\n\n<p>The <strong>Export</strong> button opens a popup that let the user choose the location of the output xml file with a <strong>Convert</strong> button</p>\n\n<p><a href=\"https://i.stack.imgur.com/PhfP7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/PhfP7.png\" alt=\"enter image description here\"></a></p>\n\n<p>Once the user clicked on the <strong>Convert</strong> button, the below xml data is generated into the <strong>default.xml</strong> file</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;data&gt;\n  &lt;student&gt;&lt;id&gt;1&lt;/id&gt;\n    &lt;name&gt;Jad&lt;/name&gt;\n    &lt;age&gt;25&lt;/age&gt;\n    &lt;mark&gt;17&lt;/mark&gt;\n  &lt;/student&gt;\n&lt;/data&gt;\n</code></pre>\n\n<p>The output seems fine to me so far, but I am looking to add more functionalities, I am trying to add a \"Mark\" column dynamically on user button click as shown below</p>\n\n<p><a href=\"https://i.stack.imgur.com/1CodT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1CodT.png\" alt=\"enter image description here\"></a></p>\n\n<p>Once the user clicks on <strong>Add Mark</strong>, a new column will appear in order to let the user enter a new grade, or it is better if we can place the new column in a separate form, for example we may add an additional field named <strong>Material Name</strong>, so on each button click 2 fields will appear <strong>Material Name</strong> and <strong>Material Mark</strong>), the expected excel sheet may be something like the below</p>\n\n<p><a href=\"https://i.stack.imgur.com/wwlsL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wwlsL.png\" alt=\"enter image description here\"></a></p>\n\n<p>the expected output of the xml file may be something like the below</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;data&gt;\n&lt;student&gt;&lt;id&gt;1&lt;/id&gt;\n    &lt;name&gt;Jad&lt;/name&gt;\n    &lt;age&gt;25&lt;/age&gt;\n    &lt;materials&gt;\n        &lt;material&gt;\n            &lt;name&gt;Maths&lt;/name&gt;\n            &lt;mark&gt;17&lt;/marks&gt;\n        &lt;/material&gt;\n        &lt;material&gt;\n            &lt;name&gt;Physics&lt;/name&gt;\n            &lt;mark&gt;18&lt;/marks&gt;\n        &lt;/material&gt;\n    &lt;/materials&gt;\n&lt;/student&gt;\n&lt;/data&gt;\n</code></pre>\n\n<p>The function I am used to generate XML file is shown below</p>\n\n<pre><code>Function fGenerateXML(rngData As Range, rootNodeName As String) As String\n\n'===============================================================\n'   XML Tags\n    '   Table\n\n    Const HEADER                As String = \"&lt;?xml version=\"\"1.0\"\"?&gt;\"\n    Dim TAG_BEGIN  As String\n    Dim TAG_END  As String\n    Const NODE_DELIMITER        As String = \"/\"\n\n\n'===============================================================\n\n    Dim intColCount As Integer\n    Dim intRowCount As Integer\n    Dim intColCounter As Integer\n    Dim intRowCounter As Integer\n\n\n    Dim rngCell As Range\n\n\n    Dim strXML As String\n\n\n\n    '   Initial table tag...\n\n\n   TAG_BEGIN = vbCrLf &amp; \"&lt;\" &amp; rootNodeName &amp; \"&gt;\"\n   TAG_END = vbCrLf &amp; \"&lt;/\" &amp; rootNodeName &amp; \"&gt;\"\n\n    strXML = HEADER\n    strXML = strXML &amp; TAG_BEGIN\n\n    With rngData\n\n        '   Discover dimensions of the data we\n        '   will be dealing with...\n        intColCount = .Columns.Count\n\n        intRowCount = .Rows.Count\n\n        Dim strColNames() As String\n\n        ReDim strColNames(intColCount)\n\n\n        ' First Row is the Field/Tag names\n        If intRowCount &gt;= 1 Then\n\n            '   Loop accross columns...\n            For intColCounter = 1 To intColCount\n\n                '   Mark the cell under current scrutiny by setting\n                '   an object variable...\n                Set rngCell = .Cells(1, intColCounter)\n\n\n\n                '   Is the cell merged?..\n                If Not rngCell.MergeArea.Address = _\n                                            rngCell.Address Then\n\n                      MsgBox (\"!! Cell Merged ... Invalid format\")\n                      Exit Function\n\n\n                End If\n\n                 strColNames(intColCounter) = rngCell.Text\n            Next\n\n        End If\n\n        Dim Nodes() As String\n        Dim NodeStack() As String\n\n\n        '   Loop down the table's rows\n        For intRowCounter = 2 To intRowCount\n\n\n            strXML = strXML &amp; vbCrLf &amp; TABLE_ROW\n            ReDim NodeStack(0)\n            '   Loop accross columns...\n            For intColCounter = 1 To intColCount\n\n                '   Mark the cell under current scrutiny by setting\n                '   an object variable...\n                Set rngCell = .Cells(intRowCounter, intColCounter)\n\n\n                '   Is the cell merged?..\n                If Not rngCell.MergeArea.Address = _\n                                            rngCell.Address Then\n\n                      MsgBox (\"!! Cell Merged ... Invalid format\")\n                      Exit Function\n\n                End If\n\n                If Left(strColNames(intColCounter), 1) = NODE_DELIMITER Then\n\n                      Nodes = Split(strColNames(intColCounter), NODE_DELIMITER)\n                          ' check whether we are starting a new node or not\n                          Dim i As Integer\n\n                          Dim MatchAll As Boolean\n                          MatchAll = True\n\n                          For i = 1 To UBound(Nodes)\n\n                              If i &lt;= UBound(NodeStack) Then\n\n                                  If Trim(Nodes(i)) &lt;&gt; Trim(NodeStack(i)) Then\n                                      'not match\n                                      'MsgBox (Nodes(i) &amp; \",\" &amp; NodeStack(i))\n                                      MatchAll = False\n                                      Exit For\n\n                                  End If\n                              Else\n                                MatchAll = False\n                                Exit For\n                              End If\n\n\n\n                          Next\n\n                          ' add close tags to those not used afterwards\n\n\n                         ' don't count it when no content\n                         If Trim(rngCell.Text) &lt;&gt; \"\" Then\n\n                            If MatchAll Then\n                              strXML = strXML &amp; \"&lt;/\" &amp; NodeStack(UBound(NodeStack)) &amp; \"&gt;\" &amp; vbCrLf\n                            Else\n                              For t = UBound(NodeStack) To i Step -1\n                                strXML = strXML &amp; \"&lt;/\" &amp; NodeStack(t) &amp; \"&gt;\" &amp; vbCrLf\n                              Next\n                            End If\n\n                            If i &lt; UBound(Nodes) Then\n                                For t = i To UBound(Nodes)\n                                    ' add to the xml\n                                    strXML = strXML &amp; \"&lt;\" &amp; Nodes(t) &amp; \"&gt;\"\n                                    If t = UBound(Nodes) Then\n\n                                            strXML = strXML &amp; Trim(rngCell.Text)\n\n                                    End If\n\n                                Next\n                              Else\n                                  t = UBound(Nodes)\n                                  ' add to the xml\n                                  strXML = strXML &amp; \"&lt;\" &amp; Nodes(t) &amp; \"&gt;\"\n                                  strXML = strXML &amp; Trim(rngCell.Text)\n\n                              End If\n\n                              NodeStack = Nodes\n\n                          Else\n\n                            ' since its a blank field, so no need to handle if field name repeated\n                            If Not MatchAll Then\n                              For t = UBound(NodeStack) To i Step -1\n                                strXML = strXML &amp; \"&lt;/\" &amp; Trim(NodeStack(t)) &amp; \"&gt;\" &amp; vbCrLf\n                              Next\n                            End If\n\n                            ReDim Preserve NodeStack(i - 1)\n                          End If\n\n\n                          ' the last column\n                          If intColCounter = intColCount Then\n                           ' add close tags to those not used afterwards\n                              If UBound(NodeStack) &lt;&gt; 0 Then\n                               For t = UBound(NodeStack) To 1 Step -1\n\n                              strXML = strXML &amp; \"&lt;/\" &amp; Trim(NodeStack(t)) &amp; \"&gt;\" &amp; vbCrLf\n\n                              Next\n                              End If\n                          End If\n\n                 Else\n                      ' add close tags to those not used afterwards\n                      If UBound(NodeStack) &lt;&gt; 0 Then\n                          For t = UBound(NodeStack) To 1 Step -1\n\n                           strXML = strXML &amp; \"&lt;/\" &amp; Trim(NodeStack(t)) &amp; \"&gt;\" &amp; vbCrLf\n\n                          Next\n                      End If\n                      ReDim NodeStack(0)\n\n                        ' skip if no content\n                      If Trim(rngCell.Text) &lt;&gt; \"\" Then\n                        strXML = strXML &amp; \"&lt;\" &amp; Trim(strColNames(intColCounter)) &amp; \"&gt;\" &amp; Trim(rngCell.Text) &amp; \"&lt;/\" &amp; Trim(strColNames(intColCounter)) &amp; \"&gt;\" &amp; vbCrLf\n                      End If\n\n                  End If\n\n            Next\n\n        Next\n    End With\n\n    strXML = strXML &amp; TAG_END\n\n    '   Return the HTML string...\n    fGenerateXML = strXML\n\nEnd Function\n</code></pre>\n\n<p>For more info you can refer to this link <a href=\"https://www.codeproject.com/Articles/6950/Export-Excel-to-XML-in-VBA\" rel=\"nofollow noreferrer\">https://www.codeproject.com/Articles/6950/Export-Excel-to-XML-in-VBA</a></p>\n\n<p>Please let me know if you have any suggestions.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1537303545, "post_id": 52393594, "comment_id": 91733835, "body": "try this;     <code>Dim Output As Integer     If Output = 1 Then Sheets(&quot;Calculation Tool&quot;).Range(&quot;N4&quot;).Clear</code>"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1537303733, "post_id": 52393594, "comment_id": 91733894, "body": "You don&#39;t need the () around your two If/Or ranges"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537313984, "post_id": 52393594, "comment_id": 91736850, "body": "Is &quot;Calculation Tool&quot; the name of the sheet containing this code?"}, {"owner": {"reputation": 37, "user_id": 9811274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab383e5c46650376559c896c25a9e44b?s=128&d=identicon&r=PG&f=1", "display_name": "Sayanthan", "link": "https://stackoverflow.com/users/9811274/sayanthan"}, "edited": false, "score": 0, "creation_date": 1537348636, "post_id": 52393594, "comment_id": 91748415, "body": "Yes, it is name of the sheet containing this code."}, {"owner": {"reputation": 37, "user_id": 9811274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab383e5c46650376559c896c25a9e44b?s=128&d=identicon&r=PG&f=1", "display_name": "Sayanthan", "link": "https://stackoverflow.com/users/9811274/sayanthan"}, "edited": false, "score": 0, "creation_date": 1537348996, "post_id": 52393594, "comment_id": 91748638, "body": "What action should be done to set the variable &quot;output&quot; = 1 in the above suggested code please? or should I need to just assign the value &quot;1&quot; to the variable &quot;output&quot; after the &quot;msgbox&quot; statement?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537365547, "post_id": 52393594, "comment_id": 91758939, "body": "If this code is in the <code>Calculation Tool</code> sheet module, then you&#39;ll need to disable / re-enable events - <a href=\"https://stackoverflow.com/questions/15761530/vba-worksheet-change-event-bypass\" title=\"vba worksheet change event bypass\">stackoverflow.com/questions/15761530/&hellip;</a>"}, {"owner": {"reputation": 37, "user_id": 9811274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab383e5c46650376559c896c25a9e44b?s=128&d=identicon&r=PG&f=1", "display_name": "Sayanthan", "link": "https://stackoverflow.com/users/9811274/sayanthan"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537386787, "post_id": 52393594, "comment_id": 91770331, "body": "Hi @BigBen should this enable/disable events be written inside the Worksheet_Change sub or should it be written as a separate sub? Can you able to help me on this please?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537387008, "post_id": 52393594, "comment_id": 91770434, "body": "Within - See <a href=\"https://stackoverflow.com/questions/13860894/why-ms-excel-crashes-and-closes-during-worksheet-change-sub-procedure\">here</a>"}, {"owner": {"reputation": 37, "user_id": 9811274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab383e5c46650376559c896c25a9e44b?s=128&d=identicon&r=PG&f=1", "display_name": "Sayanthan", "link": "https://stackoverflow.com/users/9811274/sayanthan"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537389076, "post_id": 52393594, "comment_id": 91771275, "body": "Hi @BigBen Thanks for the input.. I will get this tried and get back to you if I encounter any issues while implementing the same."}], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 7333790, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6iL7U.jpg?s=128&g=1", "display_name": "mll", "link": "https://stackoverflow.com/users/7333790/mll"}, "is_accepted": false, "score": 0, "last_activity_date": 1545167515, "creation_date": 1545167515, "answer_id": 53841132, "question_id": 52393594, "link": "https://stackoverflow.com/questions/52393594/getting-method-range-of-object-worksheet-failed-while-trying-to-clear-the-conte/53841132#53841132", "title": "Getting method, range of object worksheet failed while trying to clear the content in a cell", "body": "<p><em>I wanted to tell @BigBen that <a href=\"https://stackoverflow.com/questions/52393594/getting-method-range-of-object-worksheet-failed-while-trying-to-clear-the-conte#comment91758939_52393594\">his suggestion</a> worked for me, but my low rep won't allow me to comment. The answer field is the only way of expression for me!\nSo I might as well formulate a valid answer, here it goes. :)</em></p>\n\n<p>So I had the same problem within a Worksheet_Change event macro, in this casual event macro:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim RangeToCheck As Range\n\n    Set RangeToCheck = ActiveSheet.Range(\"O3:O32\")\n</code></pre>\n\n<p>(above is the line that triggered randomly that Run time error '-2147417848(80010108)' you encountered; on with the script)</p>\n\n<pre><code>    If Not Application.Intersect(Target, RangeToCheck) Is Nothing Then\n        Target.Value = VBA.Replace(Target.Value, \".\", \",\")\n        Debug.Print Target.Address, Target.Value\n    Else\n        Debug.Print \"Not in RangeToCheck\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>Following BigBen's link, I found that the following code works fine :</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nDim RangeToCheck As Range\n\nOn Error GoTo enableEventsOn:\n    Application.EnableEvents = False\n    Set RangeToCheck = ActiveSheet.Range(\"O3:O32\")\n    Application.EnableEvents = True\nOn Error GoTo 0\n\n    If Not Application.Intersect(Target, RangeToCheck) Is Nothing Then\n        Target.Value = VBA.Replace(Target.Value, \".\", \",\")\n        Debug.Print Target.Address, Target.Value\n    Else\n        Debug.Print \"Not in RangeToCheck\"\n    End If\n\nenableEventsOn:\n    Application.EnableEvents = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9811274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab383e5c46650376559c896c25a9e44b?s=128&d=identicon&r=PG&f=1", "display_name": "Sayanthan", "link": "https://stackoverflow.com/users/9811274/sayanthan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1547911882, "creation_date": 1537299917, "last_edit_date": 1547911882, "question_id": 52393594, "link": "https://stackoverflow.com/questions/52393594/getting-method-range-of-object-worksheet-failed-while-trying-to-clear-the-conte", "title": "Getting method, range of object worksheet failed while trying to clear the content in a cell", "body": "<p>I want to clear the contents of the cell after clicking the ok button in a message pop up window.</p>\n\n<p>When the pop up window disappears, after clicking ok button umpteen times, the script terminates by throwing the below error</p>\n\n<blockquote>\n  <p>Run time error '-2147417848(80010108)':<br>\n  Method 'Range of object'_Worksheet'Failed</p>\n</blockquote>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim KeyCells As Range\nSet KeyCells = Range(\"N4:O4\")\nIf Not Intersect(KeyCells, Range(Target.Address)) Is Nothing Then\n    If (Range(\"E9\") = \"\" Or Range(\"F9\") = \"\") Then\n    MsgBox \"Reopen Date and Closed Date should not be populated before calculating the Benefit Begin Date and Maximum Benefit Date\"\n    Sheets(\"Calculation Tool\").Range(\"N4\").Clear -----&gt;Code written to clear the cells\n   Else\n      If (Range(\"N4\") = \"\" Or Range(\"O4\") = \"\") Then\n         Set b1 = Sheets(\"Calculation Tool\").CommandButton22\n         b1.Enabled = False\n      Else\n         Set b1 = Sheets(\"Calculation Tool\").CommandButton22\n         b1.Enabled = True\n      End If\n  End If\nEnd If\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 9067858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a90bd042faf617df76e243ef113df16a?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan R", "link": "https://stackoverflow.com/users/9067858/ryan-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1537302520, "last_edit_date": 1537302520, "creation_date": 1537301282, "answer_id": 52393910, "question_id": 52393463, "link": "https://stackoverflow.com/questions/52393463/remove-row-if-value-in-one-cell-of-the-row-is-duplicated-in-the-same-column-in-t/52393910#52393910", "title": "Remove row if value in one cell of the row is duplicated in the same column in the next row", "body": "<p>I think the below could work, this is testing if the cell in front has the same value as the current cell, if so then it would delete it. I would copy the dataset into another sheet before running a macro which deletes rows. The only problem with the below code is if you have two \"Topic\" cells right next to each other, for example if \"Topic\" tags were in rows 3 and 4 then row 3 would be deleted.    </p>\n\n<pre><code>Sub test()\n\n\nColumns(\"A:A\").Insert Shift:=xlToRight\nlast = Cells(Rows.Count, 3).End(xlUp).Row\n\n\nFor Each Cell In Range(\"C2:C\" &amp; last)\n    If (Cell = Cells(Cell.Row + 1, 3)) = True Then\n        Range(\"A\" &amp; Cell.Row).Value = True\n    Else:\n        Range(\"A\" &amp; Cell.Row).Value = False\n    End If\nNext Cell\n\nFor x = 2 To last:\n    If Cells(x, 1) = True Then\n        Rows(x).Delete\n        x = x - 1\n    End If\nNext x\n\nColumns(\"A:A\").Delete\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10382108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5146b750e197a5c6f1d1dfd95c80f77d?s=128&d=identicon&r=PG&f=1", "display_name": "Qualler", "link": "https://stackoverflow.com/users/10382108/qualler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537302520, "creation_date": 1537299121, "last_edit_date": 1537299678, "question_id": 52393463, "link": "https://stackoverflow.com/questions/52393463/remove-row-if-value-in-one-cell-of-the-row-is-duplicated-in-the-same-column-in-t", "title": "Remove row if value in one cell of the row is duplicated in the same column in the next row", "body": "<p>I have a data sheet where column B is a list of data types. The only value I care about is if the value is SIS. </p>\n\n<p>If row 2 has the value SIS in column B and row 3 has the value SIS in column B, then delete row 2.  If row 3 contained instead a value of Topic, then keep row 2, ignore row 3, and look at row 4. </p>\n\n<p>The attached image shows the sample data with a column called VBA Instructions. Any help is appreciated.</p>\n\n<p><img src=\"https://i.stack.imgur.com/YboxB.png\" alt=\"\"></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1537299300, "post_id": 52393461, "comment_id": 91732101, "body": "so you are telling me that I have been missing formula on the range that I have selected. What about storing the formatting also in the variable."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1537299378, "post_id": 52393461, "comment_id": 91732133, "body": "How should I know? You did not post any code so I am just guessing."}, {"owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 0, "creation_date": 1537300790, "post_id": 52393461, "comment_id": 91732723, "body": "Storax thanks the above worked, how would you take the formatting such as coloured cells and store it in a variable. Why is it you can not declare your variable as range but a variant"}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "reply_to_user": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "edited": false, "score": 1, "creation_date": 1537336957, "post_id": 52393461, "comment_id": 91742139, "body": "The variable is declared as variant because that&#39;s what you wanted to <i>Hi everyone is there a way of storing range 1000 cells of formulas into declared variable which is variant.</i> I suggest to read <a href=\"https://excelmacromastery.com/excel-vba-range-cells/#Reading_a_Range_of_Cells_to_an_Array\" rel=\"nofollow noreferrer\">this</a>. Regarding storing information about the format of a cell you need to try something on your own and maybe open  a new question because that might be more complicated. And please be more <a href=\"https://stackoverflow.com/help/how-to-ask\">specific and concise</a> othwerwise your question will be voted down"}], "tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1537299118, "creation_date": 1537299118, "answer_id": 52393461, "question_id": 52393396, "link": "https://stackoverflow.com/questions/52393396/storing-1000-cells-of-formulas-into-a-variable-vba/52393461#52393461", "title": "Storing 1000 cells of formulas into a variable VBA", "body": "<p>You do it just as the same as with values for example</p>\n\n<pre><code>Dim v As Variant\nv = Range(\"B1:B3\").Formula\n</code></pre>\n\n<p>This wll give you the fornulas as string in an array. </p>\n\n<p>At least that's how I understand your question.</p>\n"}], "owner": {"reputation": 45, "user_id": 3287522, "user_type": "registered", "accept_rate": 7, "profile_image": "https://www.gravatar.com/avatar/14588ff29e6498a56e4e242195a57966?s=128&d=identicon&r=PG&f=1", "display_name": "user3287522", "link": "https://stackoverflow.com/users/3287522/user3287522"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1593730410, "creation_date": 1537298863, "last_edit_date": 1593730410, "question_id": 52393396, "link": "https://stackoverflow.com/questions/52393396/storing-1000-cells-of-formulas-into-a-variable-vba", "title": "Storing 1000 cells of formulas into a variable VBA", "body": "<p>Hi everyone is there a way of storing range 1000 cells of formulas into declared variable which is variant. Whilst I have been able store 1000 cells which are values into a variable. I am keen to know how you can do this with formulas and formating, large range of formulas using VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "edited": false, "score": 0, "creation_date": 1537299537, "post_id": 52393339, "comment_id": 91732217, "body": "dear op, on your if clause, you can also check for the next cell&#39;s day. If next cell is also smaller than endDate, you shouldn&#39;t do anything. But if next cell is higher than endDate, it means current cell is the last one. So you should add the new row there."}, {"owner": {"reputation": 53, "user_id": 7492099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a5d6751c54f8139883d9f8afb541997?s=128&d=identicon&r=PG&f=1", "display_name": "H.Tang", "link": "https://stackoverflow.com/users/7492099/h-tang"}, "reply_to_user": {"reputation": 562, "user_id": 5950214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d16094911aa0666d7cc19d29f361fe3c?s=128&d=identicon&r=PG", "display_name": "ali srn", "link": "https://stackoverflow.com/users/5950214/ali-srn"}, "edited": false, "score": 0, "creation_date": 1539003322, "post_id": 52393339, "comment_id": 92332074, "body": "Thank you for your response! I apologize for the late reply. I was unable to get this to work using your suggestion. I believe the problem with my code is that I am looping through each date and setting the beg and end dates so it will always return true. Since endDate will always be the endDate for the given dates in Column E, it will not work. I will keep trying and post an update if I am able to figure it out."}], "owner": {"reputation": 53, "user_id": 7492099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a5d6751c54f8139883d9f8afb541997?s=128&d=identicon&r=PG&f=1", "display_name": "H.Tang", "link": "https://stackoverflow.com/users/7492099/h-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537300913, "creation_date": 1537298609, "last_edit_date": 1537300913, "question_id": 52393339, "link": "https://stackoverflow.com/questions/52393339/excel-select-all-dates-in-column-between-start-and-end-of-a-week-and-insert-ro", "title": "excel - Select all dates in column between start and end of a week and insert row below each set of dates", "body": "<p>I have looked through a lot of resources to get the code below working for a part of what I need accomplished but cannot find any information on how to get the next part to work.</p>\n\n<p>Data Set: Starts on Row 4</p>\n\n<p>Column E</p>\n\n<p>10/08/2016</p>\n\n<p>10/10/2016</p>\n\n<p>10/11/2016</p>\n\n<p>10/12/2016</p>\n\n<p>10/13/2016</p>\n\n<p>10/14/2016</p>\n\n<p>10/18/2016</p>\n\n<p>10/21/2016</p>\n\n<p>The code below looks at each date and finds out what the start date and the end date of the week is. i.e 10/08/2016 would have a beginning week date of 10/06/2016 and end week date of 10/12/2016. Our business week is Thursday to Wednesday.</p>\n\n<p>I'm trying to figure out a way to have the code look through Column E, select all dates between each business week and insert a row below the last selected date in the business week. So, a row would be inserted below 10/12/2016, 10/18/2016, and 10/21/2018.</p>\n\n<p>I added the MsgBox so I could verify it was showing the correct start and end date, which it is.</p>\n\n<p>Any guidance would be greatly appreciated! </p>\n\n<pre><code>Sub Test()\n\nDim ws As Worksheet\nDim begDate, endDate As Date\nDim dtmDate As Date\nDim dtmString As String\nDim i As Long\nDim lRow As Long\n\nlRow = Cells(Rows.Count, 5).End(xlUp).Row\n\nFor i = 4 To lRow\n    dtmString = Cells(i, \"E\").Value\n    dtmDate = CDate(dtmString)\n\n    begDate = ReturnDate(dtmDate, 1)\n    endDate = ReturnDate(dtmDate, 7)\n\n    If Cells(i, 5).Value &gt;= begDate &amp; Cells(i, 5).Value &lt;= endDate Then\n        MsgBox begDate\n        MsgBox endDate\n    Else\n        End If\nNext i\n\nEnd Sub\n\nFunction ReturnDate(DateRange As Date, Optional DayInWeek = 1) As Date\n    ReturnDate = DateRange - Weekday(DateRange, vbThursday) + DayInWeek\nEnd Function\n</code></pre>\n"}, {"tags": ["sql", "ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1537300029, "post_id": 52392700, "comment_id": 91732399, "body": "<i>Nothing seems to work</i> ... is not helpful for us. Tell us the specific error or undesired result of your code."}, {"owner": {"reputation": 37, "user_id": 3958234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hqxw7.jpg?s=128&g=1", "display_name": "Tiny1127", "link": "https://stackoverflow.com/users/3958234/tiny1127"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1537311282, "post_id": 52392700, "comment_id": 91736278, "body": "There is no error. It just inserts all of my fields except the rich text field. It is just empty. However, when I do a Debug.Print in the Immediate window, I am capturing the text, it is just not making it to the table."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1537378917, "post_id": 52392700, "comment_id": 91766585, "body": "What is the data type of <i>RTField</i>? Long or short text?"}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 4006015, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lBuK3.jpg?s=128&g=1", "display_name": "DeFlanko", "link": "https://stackoverflow.com/users/4006015/deflanko"}, "is_accepted": false, "score": -1, "last_activity_date": 1607109301, "last_edit_date": 1607109301, "creation_date": 1537297162, "answer_id": 52393012, "question_id": 52392700, "link": "https://stackoverflow.com/questions/52392700/using-insert-into-with-rich-text/52393012#52393012", "title": "Using INSERT INTO with Rich Text", "body": "<p>Does this work for you?</p>\n<pre><code>StrSQL = &quot;INSERT INTO MyTbl (RTField) VALUES ('''' &amp; RT &amp; '''');&quot;  -- Quad Ticks for a single tick. (i believe)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 498, "user_id": 4175929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b7fda691816cbdf05d24dd2149beeee?s=128&d=identicon&r=PG", "display_name": "Jeffrey", "link": "https://stackoverflow.com/users/4175929/jeffrey"}, "is_accepted": false, "score": 1, "last_activity_date": 1537299398, "last_edit_date": 1537299398, "creation_date": 1537299097, "answer_id": 52393454, "question_id": 52392700, "link": "https://stackoverflow.com/questions/52392700/using-insert-into-with-rich-text/52393454#52393454", "title": "Using INSERT INTO with Rich Text", "body": "<pre><code>RT = Me.RTBox\n</code></pre>\n\n<p>Sets the entire control to the RT variable\nYou want just the value that is in the control, try</p>\n\n<pre><code>RT = Me.RTBox.Value\n</code></pre>\n\n<p>P.S. Consider using</p>\n\n<pre><code>Option Explicit\n</code></pre>\n\n<p>At the top of your modules to ensure type compatibility. Using this would catch the error when you compile your code.</p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1537340318, "creation_date": 1537340318, "answer_id": 52399925, "question_id": 52392700, "link": "https://stackoverflow.com/questions/52392700/using-insert-into-with-rich-text/52399925#52399925", "title": "Using INSERT INTO with Rich Text", "body": "<p>Try with <em>DAO</em>:</p>\n\n<pre><code>Dim rs As DAO.Recordset    \nDim RT As String\n\nSet rs = CurrentDb.OpenRecordset(\"Select RTField From MyTbl\")\nRT = Me!RTBox.Value\n\nrs.AddNew\n    rs!RTField.Value = RT\n    ' or simply:\n    ' rs!RTField.Value = Me!RTBox.Value\nrs.Update\nrs.Close\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 3958234, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hqxw7.jpg?s=128&g=1", "display_name": "Tiny1127", "link": "https://stackoverflow.com/users/3958234/tiny1127"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1607109301, "creation_date": 1537295727, "last_edit_date": 1594628843, "question_id": 52392700, "link": "https://stackoverflow.com/questions/52392700/using-insert-into-with-rich-text", "title": "Using INSERT INTO with Rich Text", "body": "<p>I have a from with a Rich Text box and a table with a rich Text field. I am trying use INSERT INTO to copy the text in the form to the table. All of my fields work great except the Rich Text file. I am not sure how to format the INSERT INTO string. Here is what I have tried.</p>\n\n<pre><code>DIM RT as String\nRT = Me.RTBox\nStrSQL = \"INSERT INTO MyTbl (RTField) VALUES (\"\"\" &amp; RT &amp; \"\"\");\" 'Tried triple quotes\nStrSQL = \"INSERT INTO MyTbl (RTField) VALUES ('\" &amp; RT &amp; \"');\" 'Tried string quotes\n</code></pre>\n\n<p>Nothing seems to work. Please can someone tell me how I should be bracketing the variable. I have several field that I am inserting as well. Date, time and other non Rich Text fields. The other all work fine.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 3, "creation_date": 1537295064, "post_id": 52392500, "comment_id": 91730158, "body": "Did you try <code>Range(&quot;A1&quot;).Value = Range(&quot;A1&quot;).Text</code>?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537295222, "post_id": 52392500, "comment_id": 91730234, "body": "@ScottCraner - I did, it keeps the same.  Which is odd, because I could have sworn that&#39;s what the answer would be.  Even tried a middle-man string variable:  <code>Set rng = Range(&quot;G4&quot;) &#47;&#47; str = rng.text &#47;&#47; rng.Value = str</code>  This keeps the actual value as <code>04&#47;01&#47;2014</code> oddly enough.  <b>But</b> <code>str</code> is correctly set to <code>04&#47;2014</code>.  So that&#39;s definitely the right path."}, {"owner": {"reputation": 4067, "user_id": 2970789, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd4ed57e10989bdb3f3ac58326b7354?s=128&d=identicon&r=PG&f=1", "display_name": "Ambie", "link": "https://stackoverflow.com/users/2970789/ambie"}, "edited": false, "score": 0, "creation_date": 1537337820, "post_id": 52392500, "comment_id": 91742552, "body": "There&#39;s also the <code>PasteSpecial Paste:=xlPasteValuesAndNumberFormats</code> method."}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537295277, "post_id": 52392543, "comment_id": 91730264, "body": "Unfortunately, doesn&#39;t work.  Using <code>Range(&quot;A1&quot;)</code> as my visible <code>04&#47;2014</code>, that still keeps the actual value as <code>04&#47;01&#47;2014</code> :/"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537295353, "post_id": 52392543, "comment_id": 91730303, "body": "BRB going to play with this until i figure it out"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537295671, "post_id": 52392543, "comment_id": 91730447, "body": "Haha, yeah me too :D"}], "tags": [], "owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "is_accepted": false, "score": 3, "last_activity_date": 1537295014, "creation_date": 1537295014, "answer_id": 52392543, "question_id": 52392500, "link": "https://stackoverflow.com/questions/52392500/paste-a-value-in-excel-exactly-as-is-visible/52392543#52392543", "title": "Paste a value in Excel exactly as is visible", "body": "<pre><code> Range(\"A1\").Value = Format(yourdate, \"mm/yyyy\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 3, "creation_date": 1537295549, "post_id": 52392633, "comment_id": 91730383, "body": "beat me to it. I just finished forcing the text format in vba and i see this :("}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1537295632, "post_id": 52392633, "comment_id": 91730427, "body": "Haha, beat me to it also, nice thinking and thanks so much!  I think the issue was indeed setting number format before the <code>Value</code>. Cheers Scott!"}], "tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": true, "score": 7, "last_activity_date": 1537295723, "last_edit_date": 1537295723, "creation_date": 1537295446, "answer_id": 52392633, "question_id": 52392500, "link": "https://stackoverflow.com/questions/52392500/paste-a-value-in-excel-exactly-as-is-visible/52392633#52392633", "title": "Paste a value in Excel exactly as is visible", "body": "<p>save the value and the format then set the cell as text and assign the formatted value:</p>\n\n<pre><code>Sub test()\n    Dim t As Variant\n    t = Range(\"A1\").Value2\n\n    Dim x As String\n    x = Range(\"A1\").NumberFormat\n\n    Range(\"A1\").NumberFormat = \"@\"\n    Range(\"A1\").Value = Format(t, x)\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>This also works</p>\n\n<pre><code>Sub test()\n    Dim t As String\n    t = Range(\"A1\").Text\n\n    Range(\"A1\").NumberFormat = \"@\"\n    Range(\"A1\").Value = t\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 52392633, "answer_count": 2, "score": 3, "last_activity_date": 1537295723, "creation_date": 1537294789, "question_id": 52392500, "link": "https://stackoverflow.com/questions/52392500/paste-a-value-in-excel-exactly-as-is-visible", "title": "Paste a value in Excel exactly as is visible", "body": "<p>I have a simple request, to paste the data exactly as <em>visible</em> in Excel.</p>\n\n<p>I have a list of dates in <code>mm/yyyy</code> format, but Excel keeps adding <code>mm/dd/yyyy</code> which is throwing off my analysis.  It's formatted to show simply <code>mm/yyyy</code> but the actual cell value keeps getting set to <code>mm/01/yyyy</code>.</p>\n\n<p>How can I simply copy/paste the value to be <code>mm/yyyy</code>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ooMxG.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ooMxG.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I've tried <code>Range(\"A1\").Value = Range(\"A1\").Value</code>, but of course that just keeps the same info.  </p>\n\n<p><sub>Yes, in my case since it's dates, I can do a kludgy function that takes the left three characters, and combines with the rightmost four.  However, that really just gets the date number returned. I tried on <code>G4</code> and get <code>4171730</code>.  Plus, I'd like to know how to do this with other types of cell values too (strings, numbers, etc.).</sub></p>\n"}, {"tags": ["vba", "excel", "excel-2013"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1537294775, "post_id": 52392381, "comment_id": 91729991, "body": "worksheet odule or regular module? (dumb question iknow but have to ask)"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 2, "creation_date": 1537294843, "post_id": 52392381, "comment_id": 91730042, "body": "also if its supposed to go to another sheet maybe its not qualified fully?"}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "edited": false, "score": 1, "creation_date": 1537297946, "post_id": 52392381, "comment_id": 91731462, "body": "I was able to reproduce the error when the sheet is protected if &quot;AL6&quot; is locked. Is there any other related code that may be unlocking the sheet during this edit, which may not be functioning properly?"}, {"owner": {"reputation": 41, "user_id": 10161636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9157c7d3f10c6dacf7e7d7995050609d?s=128&d=identicon&r=PG&f=1", "display_name": "BetO", "link": "https://stackoverflow.com/users/10161636/beto"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1537298608, "post_id": 52392381, "comment_id": 91731738, "body": "@DougCoats, I use a module (regular?) for the protected sheet to collect all the users data, this error is occurring on a ThisWorkBook sheet set of code if that makes sense? It&#39;s been working with zero trouble for a good two years, unless sheets can become unqualified themselves, I don&#39;t know if that would be the issue outside an update."}, {"owner": {"reputation": 41, "user_id": 10161636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9157c7d3f10c6dacf7e7d7995050609d?s=128&d=identicon&r=PG&f=1", "display_name": "BetO", "link": "https://stackoverflow.com/users/10161636/beto"}, "reply_to_user": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "edited": false, "score": 0, "creation_date": 1537299040, "post_id": 52392381, "comment_id": 91731949, "body": "@ValonMiller  I&#39;m not the only person who has access to his sheet, many people do. Could unlocking the cell and leaving it create the error problem? Nothing in the code references this cell beyond the code section that contains the error."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1537300418, "post_id": 52392381, "comment_id": 91732571, "body": "you need to unlock the sheet, edit the range and then relock sheet. Simple solution :D. Also FULLY QUALIFY EVERYTHING i.e. thisworkbook.sheets(&quot;blahblahblah&quot;).Range(&quot;yaddayaddaYadda&quot;)&zwnj;&#8203;.value=&quot;BLERG&quot;"}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "edited": false, "score": 0, "creation_date": 1537300449, "post_id": 52392381, "comment_id": 91732588, "body": "It&#39;s hard to speculate on the why, but it seems to be caused by the sheet locking. You might try implementing more explicit locking logic via the Workbook_Open event, so that even if someone changes it, it switches back. Also you can lock only the user interface, which would allow the vba to run unencumbered by the sheet protection: <a href=\"https://stackoverflow.com/questions/125449/protecting-cells-in-excel-but-allow-these-to-be-modified-by-vba-script\" title=\"protecting cells in excel but allow these to be modified by vba script\">stackoverflow.com/questions/125449/&hellip;</a>"}, {"owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "edited": false, "score": 0, "creation_date": 1537300556, "post_id": 52392381, "comment_id": 91732630, "body": "Echoing what others have said, you should fully qualify the range reference. You can do this by pre-pending <code>sh</code>, for example: <code>sh.Range(&quot;AL6&quot;)</code> since sh is the context in which the change occurred."}], "answers": [{"tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": true, "score": 1, "last_activity_date": 1537300783, "creation_date": 1537300783, "answer_id": 52393793, "question_id": 52392381, "link": "https://stackoverflow.com/questions/52392381/vba-run-time-error-1004-in-a-routine-that-has-worked-flawlessly/52393793#52393793", "title": "VBA Run-time error &#39;1004&#39; in a routine that has worked flawlessly", "body": "<p>The issue appears to be related to sheet protection.</p>\n\n<p>You could either set the cell \"AL6\" to locked = false, or you can use the Workbook_Open event to apply user interface only locking, which will allow VBA to run as if it is unlocked:</p>\n\n<p>For example:</p>\n\n<pre><code>Private Sub Workbook_Open()\n\n    Thisworkbook.sheets(\"&lt;put your sheet name here&gt;\").Protect \"Password\", UserInterfaceOnly := True\n\nEnd Sub\n</code></pre>\n\n<p>More info on UserInterfaceOnly: <a href=\"https://stackoverflow.com/questions/125449/protecting-cells-in-excel-but-allow-these-to-be-modified-by-vba-script\">Protecting cells in Excel but allow these to be modified by VBA script</a></p>\n"}], "owner": {"reputation": 41, "user_id": 10161636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9157c7d3f10c6dacf7e7d7995050609d?s=128&d=identicon&r=PG&f=1", "display_name": "BetO", "link": "https://stackoverflow.com/users/10161636/beto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 52393793, "answer_count": 1, "score": 0, "last_activity_date": 1537300783, "creation_date": 1537294243, "question_id": 52392381, "link": "https://stackoverflow.com/questions/52392381/vba-run-time-error-1004-in-a-routine-that-has-worked-flawlessly", "title": "VBA Run-time error &#39;1004&#39; in a routine that has worked flawlessly", "body": "<p>I have a protected form that organizes user input from open cells onto another excel sheet and emails it to specific people. This form has worked flawlessly for years, but suddenly yesterday it's throwing a <strong>Run-time error '1004': Application-defined or object-defined error</strong>. When I enter anything into the form, the error appears immediately, and the debugger highlights the following line of code. </p>\n\n<pre><code>Range(\"AL6\").Font.Color = vbWhite\n</code></pre>\n\n<p>On the form where a user adds their information, the cells that are open to users range from AF6-AK6 and auto-populate tomorrows date. AL6 is outside this and protected. There is nothing in cell 'AL6' and nor should there be. This is the code block in which the error dwells.</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n       If Time &gt; 15 / 24 And Range(\"AF6\") = Application.WorksheetFunction.WorkDay(Date, 0) Then\n           Range(\"AL6\").Font.Color = vbRed\n       Else\n           Range(\"AL6\").Font.Color = vbWhite\n       End If\n\n End Sub\n</code></pre>\n\n<p>The form is also saved regularly, so I don't think it's a matter of duplicating itself and becoming corrupted. I also cannot rule that possibility out. Any thoughts? </p>\n"}, {"tags": ["excel", "vba", "csv", "text"], "comments": [{"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 1, "creation_date": 1537295323, "post_id": 52392334, "comment_id": 91730288, "body": "1. this could be simplified by looping through the worksheets. 2) This method would be further enhanced by using arrays instead of manipulating the object that much - it runs super slow doesnt it? If you know what the end result ought to be you can easily get at that by more efficient means"}, {"owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1537298335, "post_id": 52392334, "comment_id": 91731628, "body": "@DougCoats It would be more efficient to use an array, which is why Tim gave me this answer: <a href=\"https://stackoverflow.com/a/52284928/5725420\">stackoverflow.com/a/52284928/5725420</a>. However, his method doesn&#39;t open the CSVs in a way that preserves the base text. Turn out that even this 40-line code runs faster than Tim&#39;s b/c Tim&#39;s opens a book - this does not."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1537310362, "post_id": 52392334, "comment_id": 91736042, "body": "There are really only 3 variables here: the source file, the destination range, and the array of field types.  You could wrap this code in a sub with those 3 parameters and it should work fine.  The only challenge is determining the exact field types for each file (assuming that&#39;s important here)"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 0, "creation_date": 1537375161, "post_id": 52395675, "comment_id": 91764828, "body": "Where do I store the array/collection of the 3 variables? I see the <code>Sub Tester()</code> section at the top, but how do I read a new CSV, a new range, and a new array into the <code>Tester</code> sub 29 more times?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 0, "creation_date": 1537384172, "post_id": 52395675, "comment_id": 91769073, "body": "You could store each file as a line in a worksheet table: store the array as (e.g.) &quot;2|2|2|2|2|2|2&quot; and then use <code>Split(arrayStringHere, &quot;|&quot;)</code> to convert it to an array when calling <code>ImportFromText</code>   See my edit above"}, {"owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "edited": false, "score": 0, "creation_date": 1537387150, "post_id": 52395675, "comment_id": 91770498, "body": "Huzzah! That second one makes so much more sense. I will try this!"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1537384374, "last_edit_date": 1537384374, "creation_date": 1537311490, "answer_id": 52395675, "question_id": 52392334, "link": "https://stackoverflow.com/questions/52392334/excel-vba-import-text-array-definition-problem/52395675#52395675", "title": "Excel VBA Import Text Array Definition problem", "body": "<p>There are really only 3 variables here: the source file, the destination range, and the array of field types. </p>\n\n<p>You could wrap this code in a sub with those 3 parameters and it should work fine. The only challenge is determining the exact field types for each file (assuming that's important here) </p>\n\n<pre><code>Sub Tester()\n    'eg - call directly\n    ImportFromText ThisWorkbook.Sheets(\"test\").Range(\"A7\"), _\n                    ThisWorkbook.Path &amp; \"\\test.csv\", _\n                    Array(2, 2, 2, 2, 2, 2, 2, 2, 2)\n\n    '...or from a worksheet table\n    Dim rw As Range\n    For Each rw in ThisWorkbook.Sheets(\"Files\").Range(\"A2:C32\").Rows \n\n        ImportFromText ThisWorkbook.Sheets(rw.Cells(1).Value).Range(\"A7\"), _\n                    ThisWorkbook.Path &amp; \"\\\" &amp; rw.Cells(2).Value, _\n                    Split(rw.Cells(3).Value, \"|\")\n\n    Next rw\n\n\nEnd Sub\n\n\nSub ImportFromText(DestRange As Range, filePath As String, arrFieldTypes)\n\n    Dim sht As Worksheet, qt As QueryTable\n\n    Set sht = DestRange.Worksheet\n\n    'clear any previous....\n    Do While sht.QueryTables.Count &gt; 0\n        sht.QueryTables(1).Delete\n    Loop\n    sht.UsedRange.Clear\n\n    Set qt = sht.QueryTables.Add(Connection:=\"TEXT;\" &amp; filePath, Destination:=DestRange)\n\n    With qt\n        '.CommandType = 0\n        .Name = \"sheet_alpha\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 437\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = False\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = True\n        .TextFileSpaceDelimiter = False\n        .TextFileColumnDataTypes = arrFieldTypes\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\n\n    DestRange.EntireRow.Delete Shift:=xlUp 'and now remove the useless header line\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 5725420, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/017faecd3978c1585fe0ca21a2b76f40?s=128&d=identicon&r=PG&f=1", "display_name": "C.A.R.", "link": "https://stackoverflow.com/users/5725420/c-a-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 579, "favorite_count": 0, "accepted_answer_id": 52395675, "answer_count": 1, "score": 0, "last_activity_date": 1537384374, "creation_date": 1537294011, "question_id": 52392334, "link": "https://stackoverflow.com/questions/52392334/excel-vba-import-text-array-definition-problem", "title": "Excel VBA Import Text Array Definition problem", "body": "<p>I have a workbook with 30 tabs of data that all follow the same process:</p>\n\n<ol>\n<li>Go to a tab in the template workbook</li>\n<li>Use the Data Import routine to spit out a CSV's data, dumping values on line 7 to start.</li>\n<li>Delete line 7 when finished (it's useless headers we don't need)</li>\n</ol>\n\n<p>The problem arises from the Import Text File routine, that needs an array for every single sheet. I end up with 40 lines of code for every sheet and no way to variablize the routine. Here's the first section of a 30-part sub (all have similar structure):</p>\n\n<pre><code>    'Use the Get Data routine to dump the csv onto the sheet as text/dates where appropriate, then delete line 7\nSheets(\"Sheet Alpha info\").Select                 'explicitly declare which sheet to dump onto\nApplication.CutCopyMode = False                 'this is good programming\n\n    'this code section is the Get Data routine run in the UI, turned into VBA\nWith ActiveSheet.QueryTables.Add(Connection:= _\n    \"TEXT;\" &amp; ThisWorkbook.Path &amp; \"\\sheet_alpha.CSV\", _\n    Destination:=Range(\"$A$7\"))                 'important on every tab!\n    '.CommandType = 0                           'this is only needed when you use the UI to do the routine, so currently commented out.\n    .Name = \"sheet_alpha\"                       'could variablize this routine, but signficance of .Name is unknown in Import routine.\n    .FieldNames = True\n    .RowNumbers = False\n    .FillAdjacentFormulas = False\n    .PreserveFormatting = True\n    .RefreshOnFileOpen = False\n    .RefreshStyle = xlInsertDeleteCells\n    .SavePassword = False\n    .SaveData = True\n    .AdjustColumnWidth = True\n    .RefreshPeriod = 0\n    .TextFilePromptOnRefresh = False\n    .TextFilePlatform = 437                     'no idea what this actually is. encoding for UTF-8?\n    .TextFileStartRow = 1\n    .TextFileParseType = xlDelimited            'not set width\n    .TextFileTextQualifier = xlTextQualifierDoubleQuote              'yes, well-behaved CSV.\n    .TextFileConsecutiveDelimiter = False\n    .TextFileTabDelimiter = False\n    .TextFileSemicolonDelimiter = False\n    .TextFileCommaDelimiter = True              'yes, well-behaved CSV.\n    .TextFileSpaceDelimiter = False\n    .TextFileColumnDataTypes = Array(2, 2, 2, 2, 2, 2, 2, 2, 2) 'this damn array is why we repeat the code. Need a new array for each sheet.\n    .TextFileTrailingMinusNumbers = True\n    .Refresh BackgroundQuery:=False\nEnd With\n\n    'and now remove the useless header line\nRows(\"7:7\").Select\nSelection.Delete Shift:=xlUp\n</code></pre>\n\n<p>So question is: How can I variablize this routine and make it a single FOR loop that also defines each TextFileColumnDataType array as a text-only array (so, Array() filled with 2s each time)? </p>\n\n<p>Extension: If I wanted the array to read other data types (so an array might be Array(1, 2, 2, 3, 2, 2, 2)), how do I do that?</p>\n"}, {"tags": ["vba", "input", "fetch"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10381745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f7286d2a8e6c2b748e19396e2734e7f?s=128&d=identicon&r=PG&f=1", "display_name": "Junaid", "link": "https://stackoverflow.com/users/10381745/junaid"}, "edited": false, "score": 0, "creation_date": 1537298861, "post_id": 52393189, "comment_id": 91731858, "body": "Thanks but my question was about to manipulate the webpage, on webpage it&#39;s not populating according to the date I&#39;m giving, it&#39;s showing the same one month data."}, {"owner": {"reputation": 29, "user_id": 10381745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f7286d2a8e6c2b748e19396e2734e7f?s=128&d=identicon&r=PG&f=1", "display_name": "Junaid", "link": "https://stackoverflow.com/users/10381745/junaid"}, "edited": false, "score": 0, "creation_date": 1537302144, "post_id": 52393189, "comment_id": 91733276, "body": "Still not fetching data according to the dates , still same dates in table from Aug 29, 2018 to See 18, 2018"}, {"owner": {"reputation": 29, "user_id": 10381745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f7286d2a8e6c2b748e19396e2734e7f?s=128&d=identicon&r=PG&f=1", "display_name": "Junaid", "link": "https://stackoverflow.com/users/10381745/junaid"}, "edited": false, "score": 0, "creation_date": 1537537433, "post_id": 52393189, "comment_id": 91832851, "body": "Even I have also tried selenium for this , but no use."}, {"owner": {"reputation": 29, "user_id": 10381745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f7286d2a8e6c2b748e19396e2734e7f?s=128&d=identicon&r=PG&f=1", "display_name": "Junaid", "link": "https://stackoverflow.com/users/10381745/junaid"}, "edited": false, "score": 0, "creation_date": 1537686168, "post_id": 52393189, "comment_id": 91869475, "body": "You awesome \ud83d\ude02 that really worked this time , but where did you get that class name for element? &quot;Ui-datepicker-current-date?!"}, {"owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "reply_to_user": {"reputation": 29, "user_id": 10381745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f7286d2a8e6c2b748e19396e2734e7f?s=128&d=identicon&r=PG&f=1", "display_name": "Junaid", "link": "https://stackoverflow.com/users/10381745/junaid"}, "edited": false, "score": 0, "creation_date": 1537885775, "post_id": 52393189, "comment_id": 91941768, "body": "Chrome developer mode. You can turn it on by hitting F12, then you can see the whole page code"}], "tags": [], "owner": {"reputation": 366, "user_id": 6370648, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gTPiL.png?s=128&g=1", "display_name": "Dawid SA Tokyo", "link": "https://stackoverflow.com/users/6370648/dawid-sa-tokyo"}, "is_accepted": true, "score": 0, "last_activity_date": 1537550081, "last_edit_date": 1537550081, "creation_date": 1537297937, "answer_id": 52393189, "question_id": 52392191, "link": "https://stackoverflow.com/questions/52392191/auto-populate-table-with-date-with-date/52393189#52393189", "title": "Auto populate table with date With Date", "body": "<p>I found that the #from and #to fields aren't accepting manual inputs.\nTo work around, just open the 'datepicker' after setting the dates and click on it to execute table update.\nThe code below works well for me, please try:</p>\n\n<pre><code>Set obj = objie.document.getElementById(\"to\")\nobj.Value = eddate\nobj.Focus\nobj.Click\n\nSet elements = objie.document.getElementsByClassName(\"ui-datepicker-current-day\")\n\nFor Each oElement In elements\n    oElement.Click\nNext oElement\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 10381745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f7286d2a8e6c2b748e19396e2734e7f?s=128&d=identicon&r=PG&f=1", "display_name": "Junaid", "link": "https://stackoverflow.com/users/10381745/junaid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 52393189, "answer_count": 1, "score": 0, "last_activity_date": 1537550081, "creation_date": 1537293379, "question_id": 52392191, "link": "https://stackoverflow.com/questions/52392191/auto-populate-table-with-date-with-date", "title": "Auto populate table with date With Date", "body": "<p>I am Trying to scape a web table through vba In excel, But the table isn't populating, i would appreciate if someone helps. Thanks.\nBelow is my code:</p>\n\n<pre><code>Dim strdate As String\nDim eddate As String\nDim obj As Object\n\nSet objie = New InternetExplorer\nobjie.Visible = True\nobjie.navigate \"https://www.khistocks.com/company-information/company-profile/ABOT.html\"\n\nDo While objie.Busy = True Or objie.readyState &lt;&gt; 4: DoEvents: Loop\n\nstrdate = Range(\"B1\").Value\neddate = Range(\"C1\").Value\nSet obj = objie.Document.getElementById(\"from\")\nobj.Value = strdate\nobj.Click\n\nSet obj = objie.Document.getElementById(\"to\")\nobj.Value = eddate\nobj.Click\n\n\nApplication.Wait Now + TimeValue(\"00:00:03\")\n\nobjie.Quit\nEnd Sub\n</code></pre>\n\n<p>Below is the website Link</p>\n\n<p>[WebsiteLink] <a href=\"https://www.khistocks.com/company-information/company-profile/ABOT.html\" rel=\"nofollow noreferrer\">https://www.khistocks.com/company-information/company-profile/ABOT.html</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 2, "creation_date": 1537293072, "post_id": 52392054, "comment_id": 91729226, "body": "Multiplying 0 by -1 keeps it at 0, so I don&#39;t see the point of the check. Also, I think that you could benefit from reading <a href=\"https://stackoverflow.com/q/10714251/4996248\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 2868, "user_id": 2582968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BKlgI.png?s=128&g=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/2582968/jan"}, "edited": false, "score": 0, "creation_date": 1537293099, "post_id": 52392054, "comment_id": 91729244, "body": "The for-loop is missing a &quot;next i&quot;. I would also not use active cell but Cells(i,j).Value = Cells(i,j)*-1  where j is the column number (can be fixed value)"}], "answers": [{"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "reply_to_user": {"reputation": 1, "user_id": 9453693, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WpK_bI3VyIk/AAAAAAAAAAI/AAAAAAAAABc/Rtl7ZOyVZV4/photo.jpg?sz=128", "display_name": "Haider Imam", "link": "https://stackoverflow.com/users/9453693/haider-imam"}, "edited": false, "score": 0, "creation_date": 1537295932, "post_id": 52392125, "comment_id": 91730564, "body": "@HaiderImam please mark the one that helped you the most, or the one you used as correct by clicking the check mark by the answer that you choose.  It will remove the question from the unanswered Queue and reward the person who gave the correct answer.  Do not go by the votes, but by which you see as the correct answer.  It is something only the person posing the question can do.  You can also only select one."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 3, "last_activity_date": 1537293053, "creation_date": 1537293053, "answer_id": 52392125, "question_id": 52392054, "link": "https://stackoverflow.com/questions/52392054/changing-the-signs-of-values-in-a-column-by-multiplying-it-by-1-in-vba/52392125#52392125", "title": "Changing the signs of values in a column by multiplying it by -1 in VBA", "body": "<p>You can just loop through a range and monkey with the cell in each iteration:</p>\n\n<pre><code>Sub macro64()\n    Dim rngCell as Range\n\n    For Each rngCell in Range(\"Q3:Q67\").Cells\n        rngCell.Value = -1 * rngCell.Value\n    Next rngCell\nEnd Sub\n</code></pre>\n\n<p>This way you aren't having to worry about Activating or Selecting a cell. And you don't have to monkey with offset and all that. Just a quick loop and you are done.</p>\n"}, {"tags": [], "owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "is_accepted": false, "score": 4, "last_activity_date": 1537294154, "last_edit_date": 1537294154, "creation_date": 1537293236, "answer_id": 52392165, "question_id": 52392054, "link": "https://stackoverflow.com/questions/52392054/changing-the-signs-of-values-in-a-column-by-multiplying-it-by-1-in-vba/52392165#52392165", "title": "Changing the signs of values in a column by multiplying it by -1 in VBA", "body": "<p>We can use Evaluate and eliminate the need for a loop:</p>\n\n<pre><code>Sub macro4()\n    With ThisWorkbook.Worksheets(\"Output - Trad NP reformatted\")\n        With .Range(\"Q3\", .Cells(.Rows.Count, \"Q\").End(xlUp))\n            .Value = .Parent.Evaluate(\"INDEX(-1 * \" &amp; .Address(0, 0) &amp; \",)\")\n        End With\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>If you want to loop, loop a variant array.</p>\n\n<p>Load the values into an array do your math and put the array values back:</p>\n\n<pre><code>Sub macro4()\n    With ThisWorkbook.Worksheets(\"Output - Trad NP reformatted\")\n        With .Range(\"Q3\", .Cells(.Rows.Count, \"Q\").End(xlUp))\n            Dim rng As Variant\n            rng = .Value\n            Dim i As Long\n            For i = LBound(rng, 1) To UBound(rng, 1)\n                rng(i, 1) = -1 * rng(i, 1)\n            Next i\n            .Value = rng\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1537294002, "creation_date": 1537294002, "answer_id": 52392331, "question_id": 52392054, "link": "https://stackoverflow.com/questions/52392054/changing-the-signs-of-values-in-a-column-by-multiplying-it-by-1-in-vba/52392331#52392331", "title": "Changing the signs of values in a column by multiplying it by -1 in VBA", "body": "<p>If you have a spare column you could do it like that</p>\n\n<pre><code>Range(\"R3:R67\").Formula = \"=-RC[-1]\"\nRange(\"Q3:Q67\").value = Range(\"R3:R67\").value\nRange(\"R3:R67\").clear\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 1, "creation_date": 1537294556, "post_id": 52392422, "comment_id": 91729901, "body": "I guess I did not need the <code>INDEX</code> part, habit i guess."}], "tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 3, "last_activity_date": 1537294402, "creation_date": 1537294402, "answer_id": 52392422, "question_id": 52392054, "link": "https://stackoverflow.com/questions/52392054/changing-the-signs-of-values-in-a-column-by-multiplying-it-by-1-in-vba/52392422#52392422", "title": "Changing the signs of values in a column by multiplying it by -1 in VBA", "body": "<p>My 2 cents.</p>\n\n<pre><code>Sub ReverseValues()\n\n    Dim rng As Range\n\n    Set rng = Range(\"Q3:Q\" &amp; Cells(Rows.Count, \"Q\").End(xlUp).Row)\n    rng = Evaluate(rng.Address &amp; \"*-1\")\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9453693, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-WpK_bI3VyIk/AAAAAAAAAAI/AAAAAAAAABc/Rtl7ZOyVZV4/photo.jpg?sz=128", "display_name": "Haider Imam", "link": "https://stackoverflow.com/users/9453693/haider-imam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1537294402, "creation_date": 1537292747, "last_edit_date": 1537292844, "question_id": 52392054, "link": "https://stackoverflow.com/questions/52392054/changing-the-signs-of-values-in-a-column-by-multiplying-it-by-1-in-vba", "title": "Changing the signs of values in a column by multiplying it by -1 in VBA", "body": "<p>i.e. column Q in a worksheet where values start in Q3 and they can at different rows in the column. I want to take the positive values in the column and flip them to negative values and take negative values and flip them to positive. I was thinking of using an If statement here. </p>\n\n<pre><code>sub macro4()\n\nwith thisworkbook\n     Set uftrad = .Worksheets(\"Output - Trad NP reformatted\")\nEnd With\n\nuftrad.Activate\nRange(\"q3\").Activate\n\nFor i = 0 To 64\n\nIf ActiveCell.Value &lt;&gt; 0 Then\nActiveCell.Value * - 1\nElse\n    ActiveCell.Offset(i, 0).Select\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>The above is not working (and I am sure the reasons would be glaringly obvious to most of you here) can you guys help me? </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1537292053, "post_id": 52391866, "comment_id": 91728763, "body": "Look like Excel will limit itself to the used range, typing something (anything) in line 21 will extend it. and the blank cells in rows 18-20 should now be filled in"}, {"owner": {"reputation": 37, "user_id": 8935823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5728fe714d2f06c514fb50dfed53c3?s=128&d=identicon&r=PG&f=1", "display_name": "H Foucault", "link": "https://stackoverflow.com/users/8935823/h-foucault"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1537309763, "post_id": 52391866, "comment_id": 91735901, "body": "Yes, it appears that it does limit itself to &quot;used rows&quot;, which is strange because it says it will find all instances in the Range object you give it. Back to cell by cell , like below."}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 8935823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5728fe714d2f06c514fb50dfed53c3?s=128&d=identicon&r=PG&f=1", "display_name": "H Foucault", "link": "https://stackoverflow.com/users/8935823/h-foucault"}, "edited": false, "score": 0, "creation_date": 1537309871, "post_id": 52391950, "comment_id": 91735924, "body": "Yes, that is the code I used to tell that the cells were in fact blank. However, I was trying to use specialcells as it will work on a range all at once, and it is supposed to be faster that cell by cell."}], "tags": [], "owner": {"reputation": 28228, "user_id": 7132550, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1063981417044495/picture?type=large", "display_name": "Micha\u0142 Turczyn", "link": "https://stackoverflow.com/users/7132550/micha%c5%82-turczyn"}, "is_accepted": false, "score": 1, "last_activity_date": 1537336633, "last_edit_date": 1537336633, "creation_date": 1537292330, "answer_id": 52391950, "question_id": 52391866, "link": "https://stackoverflow.com/questions/52391866/excel-finding-blanks-cells/52391950#52391950", "title": "Excel finding blanks cells", "body": "<p>Try this simple code:</p>\n\n<pre><code>Sub HighlightBlanks1()\n    Dim c\n    For Each c In Range(\"B1:B20\")\n        If IsEmpty(c) Then\n            c.Interior.ColorIndex = 3\n        End If\n    Next\nEnd Sub\n'or using your approach\nSub HighlightBlanks2()\n    Range(\"B1:B20\").SpecialCells(xlCellTypeBlanks).Interior.ColorIndex = 3\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8935823, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be5728fe714d2f06c514fb50dfed53c3?s=128&d=identicon&r=PG&f=1", "display_name": "H Foucault", "link": "https://stackoverflow.com/users/8935823/h-foucault"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537336633, "creation_date": 1537291929, "last_edit_date": 1537292379, "question_id": 52391866, "link": "https://stackoverflow.com/questions/52391866/excel-finding-blanks-cells", "title": "Excel finding blanks cells", "body": "<p>I have tried using the GUI and VBA to find and fill in blanks.</p>\n\n<p>Unfortunately, both do not find the last set of blanks.</p>\n\n<p>Example:</p>\n\n<p><a href=\"https://i.stack.imgur.com/jWOTC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jWOTC.jpg\" alt=\"Example\"></a></p>\n\n<p>If I highlight cells 1 through 20, and use the GUI ( Find -> Goto -> Blanks....) \nit only highlights items above the done line. Similar with this code </p>\n\n<pre><code>With Range(\"B1:B20\").SpecialCells(xlCellTypeBlanks)\n</code></pre>\n\n<p>If I highlight from 17 to 20, and use the GUI, it does find/highlight the last blank cells. The cells <strong>do not</strong> contain data ( I have checked ). What can I get to get Excel to not stop at line 17</p>\n\n<p>Thanks</p>\n"}, {"tags": ["powershell", "ms-access", "vba"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537292853, "post_id": 52391752, "comment_id": 91729118, "body": "<code>Shell(pscmd, vbNormalFocus)</code> is what&#39;s executing the PowerShell script and storing the result into <code>RetVal</code> which I presume is some local variable you&#39;re then testing for an error code to know if the script succeeded or not. Without a <code>Shell</code> statement, it can&#39;t &quot;run fine&quot; - without a <code>Shell</code> statement all you&#39;re doing is assigning some string variable with some string literal value."}, {"owner": {"reputation": 21, "user_id": 10381599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6e0c19fe8bbb591b08c8913a0d5490?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/10381599/sam"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537293915, "post_id": 52391752, "comment_id": 91729607, "body": "The Shell() statement does in fact execute when assigned to a variable. [pscmd = &quot;PowerShell.exe &#39;asdas&#39; &gt; thisisatest.txt&quot;] does create the file as expected. If I remove the assignment and change the code to Shell(pscmd), I still encounter the same issue. The assignment is required when using vbNormalFocus"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537294112, "post_id": 52391752, "comment_id": 91729710, "body": "The parens wouldn&#39;t be needed if you&#39;re not capturing the return value. <code>pscmd = &quot;foobar&quot;</code> does not create or execute anything, it&#39;s just assigning a string literal. This is getting very confusing. Can you please <a href=\"https://stackoverflow.com/posts/52391752/edit\">edit</a> your question to clarify exactly what the code is that doesn&#39;t work?"}, {"owner": {"reputation": 21, "user_id": 10381599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6e0c19fe8bbb591b08c8913a0d5490?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/10381599/sam"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537294898, "post_id": 52391752, "comment_id": 91730075, "body": "Just updated it - I don&#39;t believe there&#39;s anything wrong with the Shell call as I have tested it with other statements (parens don&#39;t make a difference). I&#39;m pretty sure the problem lies within the PowerShell command itself"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537295736, "post_id": 52391752, "comment_id": 91730476, "body": "FYI the parens don&#39;t make a difference because there&#39;s only one argument involved. If you look at the actual code in the VBE it&#39;s <code>Shell (pscmd)</code> not <code>Shell(pscmd)</code> (note the space) - that&#39;s the VBE telling you that the parens aren&#39;t part of the argument list, rather that the expression inside them is going to be evaluated as a value, and then that value will be passed <code>ByVal</code> to the invoked procedure - so yeah, it works. But no, it&#39;s not <i>doing nothing</i>, and it can introduce hard-to-diagnose bugs and, with multiple arguments, compile errors. Avoid extraneous parens in procedure calls."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537295850, "post_id": 52391752, "comment_id": 91730528, "body": "I&#39;d think you need to wrap the argument to the <code>PowerShell.exe</code> cmd call inside double-quotes, and double them up since this is a string literal as far as VBA is concerned, so <code>pscmd = &quot;PowerShell.exe &quot;&quot;(new-object -com shell.application).windows() ...&quot;&quot;&quot;</code> - otherwise you&#39;re literally just inlining a whole powershell script as a cmd argument.. Alternatively, save the script in a .ps1 file, and pass the filename as an argument. Thanks for editing, it&#39;s much clearer now"}, {"owner": {"reputation": 21, "user_id": 10381599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6e0c19fe8bbb591b08c8913a0d5490?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/10381599/sam"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537296343, "post_id": 52391752, "comment_id": 91730729, "body": "I changed my code to the following:  pscmd = &quot;PowerShell.exe &quot;&quot;(new-object -com shell.application).windows() | where {$_.Type  -eq &quot;&quot;HTML Document&quot;&quot; -and $_.LocationURL -match &quot;&quot;$locationurmatch&quot;&quot;} | select -last 1 &gt; test918.txt&quot;&quot;&quot;  but I am still not getting an output file. I tried creating a .ps1 file but unfortunately I am on a work computer and do not have the proper rights to run it"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10381599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6e0c19fe8bbb591b08c8913a0d5490?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/10381599/sam"}, "edited": false, "score": 0, "creation_date": 1537299994, "post_id": 52393243, "comment_id": 91732383, "body": "Good catch, thanks. Unfortunately, this did not solve my problem"}], "tags": [], "owner": {"reputation": 1179, "user_id": 4687466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ce36551a4b92edd40ac7b0c353a4e22?s=128&d=identicon&r=PG&f=1", "display_name": "Mike Makarov", "link": "https://stackoverflow.com/users/4687466/mike-makarov"}, "is_accepted": false, "score": 0, "last_activity_date": 1537298181, "creation_date": 1537298181, "answer_id": 52393243, "question_id": 52391752, "link": "https://stackoverflow.com/questions/52391752/how-do-i-call-a-powershell-command-in-vba/52393243#52393243", "title": "How do I call a PowerShell command in VBA?", "body": "<p>Don't mix PS and cmd. Replace <code>&gt; test918.txt</code> with <code>| Out-File test918.txt</code></p>\n"}], "owner": {"reputation": 21, "user_id": 10381599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba6e0c19fe8bbb591b08c8913a0d5490?s=128&d=identicon&r=PG&f=1", "display_name": "sam", "link": "https://stackoverflow.com/users/10381599/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 880, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1594628873, "creation_date": 1537291463, "last_edit_date": 1594628873, "question_id": 52391752, "link": "https://stackoverflow.com/questions/52391752/how-do-i-call-a-powershell-command-in-vba", "title": "How do I call a PowerShell command in VBA?", "body": "<p>I have the following command which is tested and working in PowerShell:</p>\n\n<pre><code>(new-object -com shell.application).windows() \n    | where {$_.Type  -eq \"\"HTML Document\"\" -and $_.LocationURL -match \"\"$locationurmatch\"\"} \n    | select -last 1 &gt; test918.txt\n</code></pre>\n\n<p>In Microsoft Access, I have the following VBA code where I am trying to execute this PowerShell command, but it does NOT create the text file as hoped:</p>\n\n<pre><code>pscmd = \"PowerShell.exe (new-object -com shell.application).windows() | where {$_.Type  -eq \"\"HTML Document\"\" -and $_.LocationURL -match \"\"$locationurmatch\"\"} | select -last 1 &gt; test918.txt\"\nShell(pscmd)\n</code></pre>\n\n<p>However, the following code does create the output file with the printed text:</p>\n\n<pre><code>pscmd = \"PowerShell.exe 'test' &gt; thisisatest.txt\"\nShell(pscmd)\n</code></pre>\n\n<p>I have printed 'pscmd' to the debugger and copied and pasted the result to PowerShell, and it executes without error. This leads me to believe that the PowerShell command may not be formatted properly for VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537291075, "post_id": 52391625, "comment_id": 91728344, "body": "How are you using the Function, from a sub or the worksheet?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 2, "creation_date": 1537291091, "post_id": 52391625, "comment_id": 91728348, "body": "You can&#39;t use <code>Selection.Replace</code> in a UDF."}, {"owner": {"reputation": 169, "user_id": 2258740, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/045d40d455b9ca7443a3c91c33960447?s=128&d=identicon&r=PG", "display_name": "user2258740", "link": "https://stackoverflow.com/users/2258740/user2258740"}, "reply_to_user": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 0, "creation_date": 1537291361, "post_id": 52391625, "comment_id": 91728484, "body": "@Scott-Craner - I&#39;m trying to run the Function from a worksheet."}, {"owner": {"reputation": 169, "user_id": 2258740, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/045d40d455b9ca7443a3c91c33960447?s=128&d=identicon&r=PG", "display_name": "user2258740", "link": "https://stackoverflow.com/users/2258740/user2258740"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1537291481, "post_id": 52391625, "comment_id": 91728540, "body": "@Comintern - Do you know of a workaround for Selection.Replace that would work in a UDF?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1537291768, "post_id": 52391625, "comment_id": 91728659, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10032322/excel-2007-vba-converting-accented-characters-to-regular\">Excel 2007 VBA Converting Accented Characters to Regular</a>.  Also see <a href=\"https://www.extendoffice.com/documents/excel/707-excel-replace-accented-characters.html\" rel=\"nofollow noreferrer\">this page</a>, and for fun a <a href=\"https://codereview.stackexchange.com/q/123820/92133\">CodeReview thread</a>."}, {"owner": {"reputation": 127100, "user_id": 4851590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9xlEi.jpg?s=128&g=1", "display_name": "Scott Craner", "link": "https://stackoverflow.com/users/4851590/scott-craner"}, "edited": false, "score": 2, "creation_date": 1537292258, "post_id": 52391625, "comment_id": 91728836, "body": "A function called from the work sheet can not change the value of any cell but the one calling the function."}, {"owner": {"reputation": 169, "user_id": 2258740, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/045d40d455b9ca7443a3c91c33960447?s=128&d=identicon&r=PG", "display_name": "user2258740", "link": "https://stackoverflow.com/users/2258740/user2258740"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537292537, "post_id": 52391625, "comment_id": 91728964, "body": "@BruceWayne I&#39;ve seen the code in the link you provided. It&#39;s actually the one with which I started. But, it doesn&#39;t work for certain accented characters--like \u012c or \u0128 for example. (When you paste those into a module, they appear as ? or I.) If you know a way around that, I&#39;d be curious."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537293997, "post_id": 52391625, "comment_id": 91729649, "body": "@user2258740 - You&#39;re looking to convert the strings to ASCII Characters. Does <a href=\"https://stackoverflow.com/q/37024107/4650297\">this thread</a> help?"}, {"owner": {"reputation": 169, "user_id": 2258740, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/045d40d455b9ca7443a3c91c33960447?s=128&d=identicon&r=PG", "display_name": "user2258740", "link": "https://stackoverflow.com/users/2258740/user2258740"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537296697, "post_id": 52391625, "comment_id": 91730900, "body": "@BruceWayne - In theory, the top answer on the link you provided should work for me. But, in practice, it just returns the same value as the original cell. I tried changing it from a private function to a public one, but that made no difference. Is there anything else that might keep it from working as is?"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537296968, "post_id": 52391625, "comment_id": 91731024, "body": "Step through the code with <code>F8</code> (put a break on one of the lines so when the function fires, it stops at that line).  You should see the string actually get edited, I would suspect the issue is near the end where it tries to output the new text.  As you go along with <code>F8</code>, do the variables correctly update (you can hover the mouse over a variable, and it&#39;ll show what it is currently set to).  Also, do you have some sample data you can show so we can try too?"}], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 2258740, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/045d40d455b9ca7443a3c91c33960447?s=128&d=identicon&r=PG", "display_name": "user2258740", "link": "https://stackoverflow.com/users/2258740/user2258740"}, "edited": false, "score": 0, "creation_date": 1537292841, "post_id": 52391812, "comment_id": 91729109, "body": "Thanks for the suggestion. If I&#39;m correct, you&#39;re suggesting <a href=\"https://codereview.stackexchange.com/questions/123820/replacing-accented-letters-with-regular-letters-in-a-spreadsheet\">something like this.</a> But, it doesn&#39;t work for certain accented characters--like \u012c or \u0128 for example. (When you paste those into a module, they appear as ? or I.) If you know a way around that, I&#39;d be curious."}, {"owner": {"reputation": 81, "user_id": 5467038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d9a00b37650ee367d006d1daebb007?s=128&d=identicon&r=PG&f=1", "display_name": "Sama Tori", "link": "https://stackoverflow.com/users/5467038/sama-tori"}, "reply_to_user": {"reputation": 169, "user_id": 2258740, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/045d40d455b9ca7443a3c91c33960447?s=128&d=identicon&r=PG", "display_name": "user2258740", "link": "https://stackoverflow.com/users/2258740/user2258740"}, "edited": false, "score": 0, "creation_date": 1537343701, "post_id": 52391812, "comment_id": 91745578, "body": "That&#39;s because in the function you mention they are not included. Just make sure all the accented characters you need to be substituted are included in AccChars, and add the substitution in RegChars, making sure you follow the same order."}, {"owner": {"reputation": 81, "user_id": 5467038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d9a00b37650ee367d006d1daebb007?s=128&d=identicon&r=PG&f=1", "display_name": "Sama Tori", "link": "https://stackoverflow.com/users/5467038/sama-tori"}, "reply_to_user": {"reputation": 169, "user_id": 2258740, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/045d40d455b9ca7443a3c91c33960447?s=128&d=identicon&r=PG", "display_name": "user2258740", "link": "https://stackoverflow.com/users/2258740/user2258740"}, "edited": false, "score": 0, "creation_date": 1537345594, "post_id": 52391812, "comment_id": 91746595, "body": "Sorry, I didn&#39;t get your point. I see the editor is not showing the characters you mention. I think you could re-write the function by using vba functions ascw and charw. Ascw gets the number of the character you provide (ex: &quot;&#255;&quot; yields 255) and charw does the opposite. So you can loop through the text and assign the letters by reading with ascw and returning with charw. Check the <a href=\"https://en.wikipedia.org/wiki/List_of_Unicode_characters\" rel=\"nofollow noreferrer\">UTF-8 list</a>"}, {"owner": {"reputation": 81, "user_id": 5467038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d9a00b37650ee367d006d1daebb007?s=128&d=identicon&r=PG&f=1", "display_name": "Sama Tori", "link": "https://stackoverflow.com/users/5467038/sama-tori"}, "reply_to_user": {"reputation": 169, "user_id": 2258740, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/045d40d455b9ca7443a3c91c33960447?s=128&d=identicon&r=PG", "display_name": "user2258740", "link": "https://stackoverflow.com/users/2258740/user2258740"}, "edited": false, "score": 0, "creation_date": 1537346117, "post_id": 52391812, "comment_id": 91746910, "body": "For example, you can do a select case stating that if 191&lt;ascw(letter)&lt;198, then the output letter should be &quot;A&quot;, and so on. Probably a dictionary would be a better option, but I&#39;m not vey familiar with dictionaries in VBA."}, {"owner": {"reputation": 169, "user_id": 2258740, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/045d40d455b9ca7443a3c91c33960447?s=128&d=identicon&r=PG", "display_name": "user2258740", "link": "https://stackoverflow.com/users/2258740/user2258740"}, "edited": false, "score": 0, "creation_date": 1537495007, "post_id": 52391812, "comment_id": 91814549, "body": "Thanks for circling back to this. I&#39;ve created a variation of the code that replaces the most common accented characters--as the ones that I can&#39;t replace don&#39;t appear often enough to warrant creating an entirely new macro."}], "tags": [], "owner": {"reputation": 81, "user_id": 5467038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9d9a00b37650ee367d006d1daebb007?s=128&d=identicon&r=PG&f=1", "display_name": "Sama Tori", "link": "https://stackoverflow.com/users/5467038/sama-tori"}, "is_accepted": false, "score": 1, "last_activity_date": 1537291697, "creation_date": 1537291697, "answer_id": 52391812, "question_id": 52391625, "link": "https://stackoverflow.com/questions/52391625/can-this-sub-macro-be-re-written-as-a-function/52391812#52391812", "title": "Can this Sub Macro be re-written as a Function?", "body": "<p>That happens because the function returns exactly the input value. What do you want the input 'thestring' for?</p>\n\n<p>A function returns a value, it's not designed to act as a procedure, so it will only change the cell where it's invoked.</p>\n\n<p>If you want to replace accents (as the name of your function suggests), you should put a reference to a range as an argument (thestring as Range) and then iterate the letters of the string in order to replace \u00e1 with a, \u00fc with u and so on. This is a more common use of a function. Then, in the spreadsheet you would use it as a regular function just referencing the cell you want to take out the accents from (if that's the purpose).</p>\n\n<p>Hope this helps in any way.</p>\n"}], "owner": {"reputation": 169, "user_id": 2258740, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/045d40d455b9ca7443a3c91c33960447?s=128&d=identicon&r=PG", "display_name": "user2258740", "link": "https://stackoverflow.com/users/2258740/user2258740"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1537291697, "creation_date": 1537290953, "question_id": 52391625, "link": "https://stackoverflow.com/questions/52391625/can-this-sub-macro-be-re-written-as-a-function", "title": "Can this Sub Macro be re-written as a Function?", "body": "<p>I'm using this macro--which works fine in Sub format:</p>\n\n<pre><code>Sub replaceStringInCells()\nDim wTxt As String\nDim rTxt As String\nDim rNum As Integer\nrNum = 0\nFor Each Row In Range(\"swapvalues\").Rows  '&lt;== change the wordlist Name here as required\n    wTxt = Row.Cells(1).Value\n    rTxt = Row.Cells(2).Value\n        Selection.Replace What:=wTxt, Replacement:=rTxt, LookAt:=xlPart, _\n            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n            ReplaceFormat:=False\n            rNum = rNum + 1\nNext\nEnd Sub\n</code></pre>\n\n<p>I've tried to change it to a function--by changing Sub to Function, updating the Function name, and adding string parameters:</p>\n\n<pre><code>Function replaceaccents(thestring As String)\nDim wTxt As String\nDim rTxt As String\nDim rNum As Integer\nrNum = 0\nFor Each Row In Range(\"swapvalues\").Rows  '&lt;== change the wordlist Name here as required\n    wTxt = Row.Cells(1).Value\n    rTxt = Row.Cells(2).Value\n        Selection.Replace What:=wTxt, Replacement:=rTxt, LookAt:=xlPart, _\n            SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n            ReplaceFormat:=False\n            rNum = rNum + 1\nNext\nreplaceaccents = thestring\nEnd Function\n</code></pre>\n\n<p>But, this just outputs the original cell.</p>\n\n<p>Is there a way I can make this work as a function?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba", "duplicates"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537296616, "post_id": 52391522, "comment_id": 91730856, "body": "What have you tried so far / where are you stuck?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537297437, "post_id": 52391522, "comment_id": 91731241, "body": "Is the data on the &quot;Data&quot; tab formatted as a table (i.e. with Ctrl-T), or not? Are there headers?"}, {"owner": {"reputation": 1, "user_id": 10381618, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MTM1qSYGub0/AAAAAAAAAAI/AAAAAAAAAFM/YbODigpfP5w/photo.jpg?sz=128", "display_name": "Michael Penokie", "link": "https://stackoverflow.com/users/10381618/michael-penokie"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537297678, "post_id": 52391522, "comment_id": 91731341, "body": "@ BigBen. Yes, the data is in a table on &quot;Data.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10381618, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MTM1qSYGub0/AAAAAAAAAAI/AAAAAAAAAFM/YbODigpfP5w/photo.jpg?sz=128", "display_name": "Michael Penokie", "link": "https://stackoverflow.com/users/10381618/michael-penokie"}, "edited": false, "score": 0, "creation_date": 1537317647, "post_id": 52394487, "comment_id": 91737527, "body": "thank you so much for your response! I am excited to test out this proposed solution in the morning. I\u2019m very thankful for your assistance and willingness to help!"}, {"owner": {"reputation": 1, "user_id": 10381618, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MTM1qSYGub0/AAAAAAAAAAI/AAAAAAAAAFM/YbODigpfP5w/photo.jpg?sz=128", "display_name": "Michael Penokie", "link": "https://stackoverflow.com/users/10381618/michael-penokie"}, "edited": false, "score": 0, "creation_date": 1537356948, "post_id": 52394487, "comment_id": 91753602, "body": "your code worked brilliantly! Thank you SO much!! I hope you have a wonderful day!"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 1, "last_activity_date": 1537304209, "creation_date": 1537304209, "answer_id": 52394487, "question_id": 52391522, "link": "https://stackoverflow.com/questions/52391522/delete-entire-row-based-on-duplicates-in-column-y-and-keep-the-last-record/52394487#52394487", "title": "Delete entire row based on duplicates in Column Y and keep the last record", "body": "<p>Based on your comment that the data is in a table (<code>ListObject</code>), something like this could work. This loops from the first to last row, deleting the row if a <code>CountIf</code> on the column, using the current row's value, is greater than 1.</p>\n\n<pre><code>Sub DedupeZipCodes()\n    Dim tbl As ListObject: Set tbl = ThisWorkbook.Sheets(\"Data\").ListObjects(\"Table1\")\n    Dim zipCol As ListColumn: Set zipCol = tbl.ListColumns(\"Zip Code\")\n    Dim currentRow As Long, lastRow As Long\n\n    With zipCol\n        currentRow = 1\n        lastRow = .DataBodyRange.Rows.Count\n\n        Do While currentRow &lt; lastRow\n            If Application.CountIf(.DataBodyRange, .DataBodyRange(currentRow).Value) &gt; 1 Then\n                .DataBodyRange(currentRow).EntireRow.Delete\n                lastRow = .DataBodyRange.Rows.Count\n            Else\n                currentRow = currentRow + 1\n            End If\n        Loop\n\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10381618, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MTM1qSYGub0/AAAAAAAAAAI/AAAAAAAAAFM/YbODigpfP5w/photo.jpg?sz=128", "display_name": "Michael Penokie", "link": "https://stackoverflow.com/users/10381618/michael-penokie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1537304209, "creation_date": 1537290443, "last_edit_date": 1537298325, "question_id": 52391522, "link": "https://stackoverflow.com/questions/52391522/delete-entire-row-based-on-duplicates-in-column-y-and-keep-the-last-record", "title": "Delete entire row based on duplicates in Column Y and keep the last record", "body": "<p>I am working with a dataset that is refreshed when a sharepoint survey is completed, and the responses to that survey are then exported to a table in Excel. I want to be able to delete an entire row(s) if the ZIP code (string) of the facility reviewed (Column Y) is the same, but I want to keep the most-recent survey response, or that which appears in the higher row value.</p>\n\n<p>For example, row 38 contains a survey response with a ZIP code string of \"33138.\" Row 52 (survey completed more-recently), was also completed for ZIP code \"33138.\" I want to delete row 38, and retain row 52.</p>\n\n<p>Looking for a VBA solution.</p>\n\n<p>@BigBen I've tried this code, which I found on a few discussion boards. Also note, I plan run this from a button on \"Dashboard\" tab for records on the \"data\" tab.</p>\n\n<pre><code>Sub deduplicate()\nDim Rng As Range, Dn As Range, n As Long\nDim Lst As Long, nRng As Range\nLst = Range(\"Y\" &amp; Rows.Count).End(xlUp).Row\n    With CreateObject(\"scripting.dictionary\")\n        .CompareMode = vbTextCompare\nFor n = Lst To 1 Step -1\n    If Not .Exists(Range(\"Y\" &amp; n).Value) Then\n        .Add Range(\"Y\" &amp; n).Value, Nothing\n    Else\n        If nRng Is Nothing Then\n            Set nRng = Range(\"Y\" &amp; n)\n        Else\n            Set nRng = Union(nRng, Range(\"Y\" &amp; n))\n        End If\nEnd If\nNext n\nIf Not nRng Is Nothing Then nRng.EntireRow.Delete\nEnd With\nEnd Sub\n</code></pre>\n\n<p>@BigBen, as part of a longer script, I also tried the following code. It sort of worked, but only removed the first instance of a duplicate, and not all duplicate rows.</p>\n\n<pre><code>Worksheets(\"Data\").Activate\nDim lrow As Long\n\nFor lrow = Cells(Rows.Count, \"Y\").End(xlUp).Row To 2 Step -1\n    If Cells(lrow, \"Y\") = Cells(lrow, \"Y\").Offset(-1, 0) Then\n       Cells(lrow, \"Y\").Offset(-1, 0).EntireRow.Delete\n    End If\n\nNext lrow\n</code></pre>\n"}, {"tags": ["vba", "outlook", "ms-word"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1537474507, "post_id": 52391026, "comment_id": 91808979, "body": "<a href=\"https://stackoverflow.com/a/49182385/4539709\">stackoverflow.com/a/49182385/4539709</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10381422, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YPGBuQR7B3s/AAAAAAAAAAI/AAAAAAAABKM/un3-SRLHP8g/photo.jpg?sz=128", "display_name": "Brett B.", "link": "https://stackoverflow.com/users/10381422/brett-b"}, "edited": false, "score": 0, "creation_date": 1537816021, "post_id": 52453571, "comment_id": 91913023, "body": "That did the trick. Thank you! It sure beats the temporary workaround I implemented with SendKeys."}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": false, "score": 0, "last_activity_date": 1537591501, "creation_date": 1537591501, "answer_id": 52453571, "question_id": 52391026, "link": "https://stackoverflow.com/questions/52391026/insert-the-contents-of-a-word-document-into-an-email-and-include-the-default-sig/52453571#52453571", "title": "Insert the contents of a Word Document into an email and include the default signature using VBA", "body": "<p>You might use:</p>\n\n<pre><code>Sub emailFromDoc()\n    Dim wd As Object, editor As Object\n    Dim doc As Object\n    Dim Rng As Object\n    Dim oMail As MailItem\n\n    Set wd = CreateObject(\"Word.Application\")\n    Set doc = wd.documents.Open(...path to your doc...)\n    doc.Content.Copy\n    doc.Close\n    Set wd = Nothing\n\n    Set oMail = Application.CreateItem(olMailItem)\n    With oMail\n        .BodyFormat = olFormatRichText\n        Set editor = .GetInspector.WordEditor\n        Set Rng = editor.Content\n        Rng.Collapse 1\n        Rng.Paste\n        .Display\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 10381422, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YPGBuQR7B3s/AAAAAAAAAAI/AAAAAAAABKM/un3-SRLHP8g/photo.jpg?sz=128", "display_name": "Brett B.", "link": "https://stackoverflow.com/users/10381422/brett-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592942431, "creation_date": 1537288332, "last_edit_date": 1592942431, "question_id": 52391026, "link": "https://stackoverflow.com/questions/52391026/insert-the-contents-of-a-word-document-into-an-email-and-include-the-default-sig", "title": "Insert the contents of a Word Document into an email and include the default signature using VBA", "body": "<p>I used the code provided by Patrick Wynne in <a href=\"https://stackoverflow.com/questions/35609112/how-to-send-a-word-document-as-body-of-an-email-with-vba/35610600#35610600?newreg=e67ff8c3dc434db1a3aa97807c67a847\">How to send a Word document as body of an email with VBA</a>, but it overwrites the signature. Is there a way to change the code to leave the default signature in place when pasting the contents of the word document?</p>\n\n<p>Here is the code:</p>\n\n<pre><code>Sub emailFromDoc()\n    Dim wd As Object, editor As Object\n    Dim doc As Object\n    Dim oMail As MailItem\n\n    Set wd = CreateObject(\"Word.Application\")\n    Set doc = wd.documents.Open(...path to your doc...)\n    doc.Content.Copy\n    doc.Close\n    set wd = Nothing\n\n    Set oMail = Application.CreateItem(olMailItem)\n    With oMail\n        .BodyFormat = olFormatRichText\n        Set editor = .GetInspector.WordEditor\n        editor.Content.Paste\n        .Display\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "excel", "vba"], "comments": [{"owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "edited": false, "score": 0, "creation_date": 1537287214, "post_id": 52390661, "comment_id": 91726496, "body": "the case when  is for assign proper date range in between ??&#39;"}, {"owner": {"reputation": 1737, "user_id": 8261341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eyDTc.jpg?s=128&g=1", "display_name": "Ivan Kaloyanov", "link": "https://stackoverflow.com/users/8261341/ivan-kaloyanov"}, "edited": false, "score": 2, "creation_date": 1537287217, "post_id": 52390661, "comment_id": 91726498, "body": "Why do you want to put them in &#39;WHERE&#39; clause? That&#39;s just wrong. Drop down the entire query and I will rewrite it for you xD"}, {"owner": {"reputation": 31386, "user_id": 9661424, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rnnvz.png?s=128&g=1", "display_name": "sticky bit", "link": "https://stackoverflow.com/users/9661424/sticky-bit"}, "edited": false, "score": 1, "creation_date": 1537288042, "post_id": 52390661, "comment_id": 91726913, "body": "You have <code>WHEN</code>s but I cannot spot any corresponding  <code>THEN</code>s..."}, {"owner": {"reputation": 731, "user_id": 5613367, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-ZDZV06Q_DNI/AAAAAAAAAAI/AAAAAAAAAH8/yz_JRBIXnoM/photo.jpg?sz=128", "display_name": "Pat Jones", "link": "https://stackoverflow.com/users/5613367/pat-jones"}, "edited": false, "score": 2, "creation_date": 1537289753, "post_id": 52390661, "comment_id": 91727760, "body": "It&#39;s also worth pointing out that the CASE construct may not be available for use. Excel and Access&#39; version of SQL omits many of the more robust features of T-SQL."}, {"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1537290928, "post_id": 52390661, "comment_id": 91728288, "body": "Ivan Kaloyanov, do you have another recommendation?"}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1537292530, "post_id": 52390661, "comment_id": 91728960, "body": "Use the ACE SQL Engine&#39;s <a href=\"https://support.office.com/en-us/article/iif-function-32436ecf-c629-48a3-9900-647539c764e3\" rel=\"nofollow noreferrer\">IIF()</a> in place of <code>CASE</code> statements. Also, why are you writing SQL in VBA? Is this an Excel sub calling an Access query?"}, {"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1537292718, "post_id": 52390661, "comment_id": 91729053, "body": "I just found that I would have to use the <code>IIF()</code> functionality instead of <code>CASE</code> in Excel. Regarding your question, yes, I am using the SQL query in an Excel macro to pull data from an Access database into an Excel Workbook. Thank you for the response."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 1, "creation_date": 1537292821, "post_id": 52390661, "comment_id": 91729101, "body": "Then you should NOT be writing this query in VBA. It should be a saved query in MS Access that Excel references. Saved queries are more efficient than coded queries as the engine caches and saves stats on best execution plan. Especially true due to all the <code>JOINs</code>."}, {"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1537295276, "post_id": 52390661, "comment_id": 91730262, "body": "I don&#39;t have write access to the database that the data comes from, otherwise I would just create the query there. It would make my life so much easier to do the query in Access rather than in Excel VBA."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1537288748, "post_id": 52390743, "comment_id": 91727297, "body": "Here is what I am using: <code>&quot; WHERE tblretirements.ApplicationCancelled = &#39;No&#39; &quot; &amp; _     &quot; AND (tblretirements.ReceiptDate IS NULL OR tblretirements.ReceiptDate BETWEEN (CASE WHEN MONTH(getdate()) &lt; 7 THEN DATEFROMPARTS(YEAR(getdate())-1,7,1) &quot; &amp; _     &quot; ELSE DATEFROMPARTS(YEAR(getdate()),7,1) End ) AND  (CASE WHEN MONTH(getdate()) &lt; 7 THEN DATEFROMPARTS(YEAR(getdate()),6,30) &quot; &amp; _     &quot; ELSE DATEFROMPARTS(YEAR(getdate())+1,6,30)End )  &quot;</code>                                      I am getting a notice that the  <code>WHEN</code> statement is an unrecognized keyword when I try to run it."}, {"owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "reply_to_user": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1537288806, "post_id": 52390743, "comment_id": 91727329, "body": "i don&#39;t uderstand your comment  ... have you error?   .. explain better"}, {"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1537289048, "post_id": 52390743, "comment_id": 91727444, "body": "Yes, I am getting a runtime error. <code>-2147467259(80004005)</code> is the error. To clarify, I am using this SQL code in VBA code in Excel."}, {"owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "reply_to_user": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1537289355, "post_id": 52390743, "comment_id": 91727585, "body": "answer  updated  .. add  closing ) at the End  .. . . End ) )  and not End )"}, {"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1537289571, "post_id": 52390743, "comment_id": 91727679, "body": "I updated the code so you can see the entire <code>SELECT</code> statement that&#39;s in my macro. Hopefully this helps."}, {"owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "reply_to_user": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1537290006, "post_id": 52390743, "comment_id": 91727872, "body": "... seems a bit to complex  .. you should try using  case for a small  part  ..  you should know that SO is not a code or debugging service .. so you should check only  if  the suggestion is right  .."}, {"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1537290499, "post_id": 52390743, "comment_id": 91728109, "body": "The code works when I remove the date criteria component of the WHERE clause. I don&#39;t need assistance with debugging the rest of the code, I just needed assistance with implementing the date criteria component. With all due respect, I am not trying to get someone to code this for me, I am trying to get assistance with the code that I have. If that&#39;s not what SO is for, then why is it here?"}, {"owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "reply_to_user": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1537294080, "post_id": 52390743, "comment_id": 91729688, "body": "you can easly test the where clause just selecting form tblretirements tables"}], "tags": [], "owner": {"reputation": 124613, "user_id": 3522312, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5b53060bf7f71994265a9ef7c17cc5?s=128&d=identicon&r=PG", "display_name": "scaisEdge", "link": "https://stackoverflow.com/users/3522312/scaisedge"}, "is_accepted": false, "score": 1, "last_activity_date": 1537289314, "last_edit_date": 1537289314, "creation_date": 1537287330, "answer_id": 52390743, "question_id": 52390661, "link": "https://stackoverflow.com/questions/52390661/case-in-where-clause-sql-vba-excel/52390743#52390743", "title": "CASE in WHERE Clause SQL VBA Excel", "body": "<p>IS not clear why you are using case in where but if you want use in between should be </p>\n\n<pre><code>    \" WHERE tblretirements.ApplicationCancelled = 'No' \n      AND (tblretirements.ReceiptDate IS NULL OR tblretirements.ReceiptDate BETWEEN \n      ( CASE WHEN MONTH(getdate()) &lt; 7 THEN DATEFROMPARTS(YEAR(getdate())-1,7,1)\n           ELSE DATEFROMPARTS(YEAR(getdate()),7,1)\n    End )\n     AND  (\n    CASE\n           WHEN MONTH(getdate()) &lt; 7 THEN DATEFROMPARTS(YEAR(getdate()),6,30)\n           ELSE DATEFROMPARTS(YEAR(getdate())+1,6,30)\n    End ) )   \"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "edited": false, "score": 0, "creation_date": 1537297901, "post_id": 52392505, "comment_id": 91731442, "body": "I got write access to the database to create the query in Access. This works out perfectly. I also wanted to thank you for the information regarding the various methods and types of SQL, it&#39;s very helpful for my understanding."}], "tags": [], "owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "is_accepted": true, "score": 1, "last_activity_date": 1537294799, "creation_date": 1537294799, "answer_id": 52392505, "question_id": 52390661, "link": "https://stackoverflow.com/questions/52390661/case-in-where-clause-sql-vba-excel/52392505#52392505", "title": "CASE in WHERE Clause SQL VBA Excel", "body": "<p>Several issues need attention here:</p>\n\n<ol>\n<li><p>For complex queries of many joins, do not build SQL on the fly during application code. Save it as stored object in MS Access so the engine can save best execution plan. Then have application, here being Excel, reference the query by name. You can even pass values as parameters to a saved query.</p></li>\n<li><p>Use table aliases to avoid writing out the long table names for a more readable and maintainable, and less lengthy query.</p></li>\n<li><p>No two SQL dialects are the same. Even under the same vendor, here being Microsoft. The JET/ACE SQL (Windows .dll files) dialect that MS Access uses is <em>different</em> than the T-SQL dialect that SQL Server uses. Interestingly, another database, Sybase, also uses T-SQL with a history to why. </p>\n\n<p>But like all other dialects (e.g., Oracle, Postgres) though, both share most traditional ANSI SQL functions which is the standard of the language.   Therefore, SQL Server's <code>CASE</code>, <code>DATEFROMPARTS()</code>, and <code>GETDATE()</code> must be replaced for Access' <code>IIF()</code>, <code>DATESERIAL()</code>, and <code>DATE()</code>. Interestingly though, <code>CASE</code> is an ANSI method.</p></li>\n</ol>\n\n<p>Consider the following re-write of your query and specifically the <code>WHERE</code> clause to be saved in MS Access as a stored object.</p>\n\n<p><strong>SQL</strong></p>\n\n\n\n<pre class=\"lang-sql prettyprint-override\"><code>SELECT r.retirementid             AS `RetirementID`, \n       r.inputby                  AS `Input By`, \n       r.receiptdate              AS `Date Received`, \n       r.firstname                AS `First Name`, \n       r.lastname                 AS `Last Name`, \n       r.dateofbirth              AS `DOB`, \n       r.dateofretirement         AS `Retirement Date`, \n       bp.retirementdescription   AS `Retirement Type`, \n       r.memberpin                AS `Pin`, \n       cr.currentplan             AS `Current Plan`, \n       r.servicecredits           AS `Service Crdits w/o PS/AC`, \n       r.multipleplans            AS `Multiple Plans/Tiers?`, \n       r.confirmationlettermailed AS `Mailed Confirm Letter`, \n       r.workbooksetup            AS `Set Up Excel Workbook`, \n       ct.calcteam                AS `Calculation Team`, \n       co.name                    AS `Assigned Staff`, \n       r.reviewdate               AS`Review Date`, \n       bs.statusreported          AS`BoardStatusID`, \n       r.reciprocityid            AS `Reciprocity?`, \n       r.employercodeid           AS `Employer`, \n       d.departmentname           AS `Department`, \n       r.pendingpurchase          AS `Pending Purchase(s)?`, \n       j.joinder                  AS `Joinder or Pending DRO?`, \n       dp.agendadisability        AS `DisabilityID`, \n       ry.reciprocalstatus, \n       o.orientationstatus        AS `Orientation Elected?`, \n       r.orientationdate          AS `Orientation Date`, \n       rp.reviewername            AS `Designated Reviewer`, \n       r.filesetupapproved        AS `File Set-Up Approved`, \n       r.agendaapplication        AS `Agenda Application`, \n       r.estimatetoreviewer       AS `Estimate to Reviewer`, \n       r.estimatetosupervisor     AS `Estimate to Supervisor`, \n       r.estimateapproved         AS `Estimate Approved`, \n       r.finalpaycheck            AS `Final Paycheck Date`, \n       r.finalservice             AS `Final Service with PS/AC`, \n       r.finaltoreviewer          AS `Final Calc to Reviewer`, \n       r.finaltosupervisor        AS `Final Calc to Supervisor`, \n       r.finalapproved            AS `Final Calc Approved`, \n       r.applicationcancelled     AS `App Cancelled by Member?`, \n       r.retelectiondistributed   AS `Retirement Election Distributed`, \n       r.retelectionreturned      AS `Retirement Election Returned`, \n       p.agendaoption             AS `Option/Payment Selected`, \n       r.tempannuityid            AS `Age Request for Temp Annuity`, \n       r.finalallowance           AS `Final Allowance Calculation`, \n       r.continuance              AS `Continuance`, \n       r.payrollformsstaff        AS `Payroll Forms Completed (Staff)`, \n       r.agendapayment            AS `Option-Payment`, \n       r.payrollformssupervisor   AS `Payroll Forms Reviewed (Supv)`, \n       r.cboapprovedallowance     AS `Allowance Approved (CBO)`, \n       r.allowanceestimated       AS `Allowance Estimated?`, \n       r.allowenteredinpayroll    AS `Allowance Entered In Payroll`, \n       r.distributioncycleid      AS `Distribution Cycle for 1st Payment`, \n       r.firstpaydate             AS `Distribution Date for 1st Payment`, \n       r.allowancefinalized       AS `Allowance Finalized`, \n       r.fileimaged               AS `Retirement File Imaged` \nFROM   ((((((((((((tblretirements r \n                   LEFT JOIN tblcalculationpersonnel cp \n                          ON r.coordinatorid = co.coordinatorid) \n                  LEFT JOIN tblcurrentplan cr \n                         ON r.currentplanid = cr.currentplanid) \n                 LEFT JOIN tblbenefitinprocress bp \n                        ON r.benefitinprocess = bp.retirementtypeid) \n                LEFT JOIN tblpaymentoption p \n                       ON r.optionid = p.optionid) \n               LEFT JOIN tblreviewpersonnel rp \n                      ON r.reviewerid = rp.reviewerid) \n              LEFT JOIN tblorientationstatus o \n                     ON r.orientationid = o.orientationid) \n             LEFT JOIN tbldisabilitypending dp \n                    ON r.disabilityid = dp.disabilityid) \n            LEFT JOIN tbljoinder j \n                   ON r.joinderid = j.joinderid) \n           LEFT JOIN tbldepartment dt \n                  ON r.departmentid = d.departmentid) \n          LEFT JOIN tblemployercode e \n                 ON r.employercodeid = e.employercodeid) \n         LEFT JOIN tblreciprocity ry \n                ON r.reciprocityid = ry.reciprocityid) \n        LEFT JOIN tblcalculationteam ct \n               ON r.calculationteamid = ct.calculationteamid) \n       LEFT JOIN tblboardstatus bs \n              ON r.boardstatusid = bs.boardstatusid \n</code></pre>\n\n<p><strong>WHERE</strong> clause</p>\n\n<pre class=\"lang-sql prettyprint-override\"><code>WHERE r.applicationcancelled = 'No' \n  AND r.receiptdate IS NULL \n   OR r.receiptdate BETWEEN (\n                             IIF(MONTH(DATE()) &lt; 7, \n                                 DATESERIAL(YEAR(DATE()) - 1, 7, 1), \n                                 DATESERIAL(YEAR(DATE()), 7, 1)) \n                            )\n                        AND (\n                             IIF(MONTH(DATE()) &lt; 7, \n                                 DATESERIAL(YEAR(DATE()), 6, 30), \n                                 DATESERIAL(YEAR(DATE()) + 1, 6, 30)) \n                            )\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 3137443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98f19d757ff1f11eace394ee29bc245a?s=128&d=identicon&r=PG&f=1", "display_name": "JosephD", "link": "https://stackoverflow.com/users/3137443/josephd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 817, "favorite_count": 0, "accepted_answer_id": 52392505, "answer_count": 2, "score": 1, "last_activity_date": 1537294799, "creation_date": 1537286976, "last_edit_date": 1537291749, "question_id": 52390661, "link": "https://stackoverflow.com/questions/52390661/case-in-where-clause-sql-vba-excel", "title": "CASE in WHERE Clause SQL VBA Excel", "body": "<p>I am trying to add a filter criteria for the current fiscal year in a <code>WHERE</code> statement in my code. However, I don't know how to integrate the <code>CASE</code> statement in my <code>WHERE</code> clause in VBA. Here's the code that I am working on:</p>\n\n<pre><code> Source = \"SELECT tblretirements.retirementID As `RetirementID`,tblretirements.InputBy As `Input By`, tblretirements.ReceiptDate As `Date Received` , tblretirements.FirstName As `First Name`, tblretirements.LastName As `Last Name`, tblretirements.DateOfBirth As `DOB`, tblretirements.DateOfRetirement As `Retirement Date`, tblBenefitInProcress.RetirementDescription As `Retirement Type`, tblretirements.MemberPIN As `Pin`, tblcurrentplan.CurrentPlan As `Current Plan`, tblretirements.ServiceCredits As `Service Crdits w/o PS/AC`, tblretirements.MultiplePlans As `Multiple Plans/Tiers?`, \" &amp; _\n    \" tblretirements.ConfirmationLetterMailed As `Mailed Confirm Letter`, tblretirements.WorkbookSetup As `Set Up Excel Workbook`, tblCalculationTeam.CalcTeam As `Calculation Team`, tblCalculationPersonnel.Name As `Assigned Staff`, tblretirements.ReviewDate As`Review Date`, tblBoardStatus.StatusReported As`BoardStatusID`, tblretirements.ReciprocityID As `Reciprocity?`, tblretirements.EmployerCodeID As `Employer`, \" &amp; _\n    \" tblDepartment.DepartmentName As `Department`, tblretirements.PendingPurchase As `Pending Purchase(s)?`, tblJoinder.Joinder As `Joinder or Pending DRO?`, tblDisabilityPending.AgendaDisability As `DisabilityID`, tblReciprocity.ReciprocalStatus, tblOrientationStatus.OrientationStatus As `Orientation Elected?`,tblretirements.OrientationDate As `Orientation Date`, tblReviewPersonnel.ReviewerName As `Designated Reviewer`, tblretirements.FileSetupApproved As `File Set-Up Approved`, tblretirements.AgendaApplication As `Agenda Application`, tblretirements.EstimateToReviewer As `Estimate to Reviewer`, tblretirements.EstimateToSupervisor As `Estimate to Supervisor`, \" &amp; _\n    \" tblretirements.EstimateApproved As `Estimate Approved`, tblretirements.FinalPaycheck As `Final Paycheck Date`, tblretirements.FinalService As `Final Service with PS/AC`, tblretirements.FinalToReviewer As `Final Calc to Reviewer`, tblretirements.FinalToSupervisor As `Final Calc to Supervisor`, tblretirements.FinalApproved As `Final Calc Approved`, tblretirements.ApplicationCancelled As `App Cancelled by Member?`, tblretirements.RetElectionDistributed As `Retirement Election Distributed`, tblretirements.RetElectionReturned As `Retirement Election Returned`, tblPaymentOption.AgendaOption As `Option/Payment Selected`, \" &amp; _\n    \" tblretirements.TempAnnuityID As `Age Request for Temp Annuity`, tblretirements.FinalAllowance As `Final Allowance Calculation`, tblretirements.Continuance As `Continuance`, tblretirements.PayrollFormsStaff As `Payroll Forms Completed (Staff)`, tblretirements.AgendaPayment As `Option-Payment`, tblretirements.PayrollFormsSupervisor As `Payroll Forms Reviewed (Supv)`, \" &amp; _\n    \" tblretirements.CboApprovedAllowance As `Allowance Approved (CBO)`, tblretirements.AllowanceEstimated As `Allowance Estimated?`, tblretirements.AllowEnteredInPayroll As `Allowance Entered In Payroll`, tblretirements.DistributionCycleID As `Distribution Cycle for 1st Payment`, \" &amp; _\n    \" tblretirements.FirstPayDate As `Distribution Date for 1st Payment`, tblretirements.AllowanceFinalized As `Allowance Finalized`, tblretirements.FileImaged As `Retirement File Imaged`\" &amp; _\n    \" FROM ((((((((((((tblRetirements \" &amp; _\n    \" LEFT JOIN tblCalculationPersonnel On tblRetirements.CoordinatorID=tblCalculationPersonnel.CoordinatorID) \" &amp; _\n    \" LEFT JOIN tblCurrentPlan On tblRetirements.CurrentPlanID=tblCurrentPlan.CurrentPlanID) \" &amp; _\n    \" LEFT JOIN tblBenefitInProcress On tblRetirements.BenefitInProcess=tblBenefitInProcress.RetirementTypeID) \" &amp; _\n    \" LEFT JOIN tblPaymentOption ON tblretirements.OptionID=tblPaymentoption.OptionID) \" &amp; _\n    \" LEFT JOIN tblReviewPersonnel ON tblretirements.ReviewerID=tblReviewPersonnel.ReviewerID) \" &amp; _\n    \" LEFT JOIN tblOrientationStatus ON tblretirements.OrientationID=tblOrientationStatus.OrientationID) \" &amp; _\n    \" LEFT JOIN tblDisabilityPending ON tblretirements.DisabilityID=tblDisabilityPending.DisabilityID) \" &amp; _\n    \" LEFT JOIN tblJoinder ON tblretirements.JoinderID=tblJoinder.JoinderID) \" &amp; _\n    \" LEFT JOIN tblDepartment ON tblretirements.DepartmentID=tblDepartment.DepartmentID) \" &amp; _\n    \" LEFT JOIN tblEmployerCode ON tblretirements.EmployerCodeID=tblEmployerCode.EmployerCodeID) \" &amp; _\n    \" LEFT JOIN tblReciprocity ON tblretirements.ReciprocityID=tblReciprocity.ReciprocityID) \" &amp; _\n    \" LEFT JOIN tblCalculationTeam ON tblretirements.CalculationTeamID=tblCalculationTeam.CalculationTeamID) \" &amp; _\n    \" LEFT JOIN tblBoardStatus ON tblretirements.BoardStatusID=tblBoardStatus.BoardStatusID \" &amp; _\n</code></pre>\n\n<p>This is what I need assistance with:</p>\n\n<pre><code> \" WHERE tblretirements.ApplicationCancelled = 'No' AND (tblretirements.ReceiptDate IS NULL OR tblretirements.ReceiptDate \" &amp; _\n        \" BETWEEN (CASE WHEN MONTH(getdate()) &lt; 7 THEN DATEFROMPARTS(YEAR(getdate())-1,7,1) \" &amp; _\n        \" ELSE DATEFROMPARTS(YEAR(getdate()),7,1) End ) AND  (CASE WHEN MONTH(getdate()) &lt; 7 THEN DATEFROMPARTS(YEAR(getdate()),6,30) \" &amp; _\n        \" ELSE DATEFROMPARTS(YEAR(getdate())+1,6,30)End ))  \"\n</code></pre>\n\n<p>Can someone please help me? Thank you.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5024211, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/O6i3Q.png?s=128&g=1", "display_name": "Developer_World", "link": "https://stackoverflow.com/users/5024211/developer-world"}, "edited": false, "score": 0, "creation_date": 1537286045, "post_id": 52390396, "comment_id": 91725840, "body": "I would like to write the string through VBA."}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "reply_to_user": {"reputation": 63, "user_id": 5024211, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/O6i3Q.png?s=128&g=1", "display_name": "Developer_World", "link": "https://stackoverflow.com/users/5024211/developer-world"}, "edited": false, "score": 3, "creation_date": 1537286213, "post_id": 52390396, "comment_id": 91725950, "body": "@Developer_World - That is VBA?"}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 2, "last_activity_date": 1537285978, "creation_date": 1537285978, "answer_id": 52390396, "question_id": 52390364, "link": "https://stackoverflow.com/questions/52390364/how-to-write-5e9-in-excel-through-vba/52390396#52390396", "title": "How to write 5E9 in Excel through VBA", "body": "<p>The quickest way is to \"escape\" the string so Excel reads it literally, using <code>'</code> at the start:</p>\n\n<pre><code>ThisWorkbook.ActiveSheet.Range(\"A1\")= \"'5E9\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9217, "user_id": 3042759, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/4a528d813fb985c39165d14a55e5449d?s=128&d=identicon&r=PG&f=1", "display_name": "Tom", "link": "https://stackoverflow.com/users/3042759/tom"}, "is_accepted": true, "score": 3, "last_activity_date": 1537286131, "creation_date": 1537286131, "answer_id": 52390446, "question_id": 52390364, "link": "https://stackoverflow.com/questions/52390364/how-to-write-5e9-in-excel-through-vba/52390446#52390446", "title": "How to write 5E9 in Excel through VBA", "body": "<p>Try setting the <code>NumberFormat</code> to <code>Text</code></p>\n\n<pre><code>With ThisWorkbook.ActiveSheet.Range(\"A1\")\n    .NumberFormat = \"@\"\n    .Value2 = \"5E9\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5024211, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/O6i3Q.png?s=128&g=1", "display_name": "Developer_World", "link": "https://stackoverflow.com/users/5024211/developer-world"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 52390446, "answer_count": 2, "score": -2, "last_activity_date": 1594055158, "creation_date": 1537285879, "last_edit_date": 1594055158, "question_id": 52390364, "link": "https://stackoverflow.com/questions/52390364/how-to-write-5e9-in-excel-through-vba", "title": "How to write 5E9 in Excel through VBA", "body": "<p>I am writing a program and storing \"5E9\" in to excel and its storing as exponent value in excel.</p>\n\n<pre><code>ThisWorkbook.ActiveSheet.Range(\"A1\")= \"5E9\"\n</code></pre>\n\n<p>Output showing like this 5.00E+09</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 1, "creation_date": 1537285660, "post_id": 52390267, "comment_id": 91725551, "body": "What&#39;s the point of sending it to the clipboard and doing <code>.GetText</code>? Why not just use <code>Range(...).Values</code>?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1537286638, "post_id": 52390267, "comment_id": 91726202, "body": "<code>Dim .... As New</code> is declaring an auto-instantiated object, which means <code>DataObj</code> can&#39;t really be destroyed (try <code>Set DataObj = Nothing</code> and then <code>Debug.Print DataObj Is Nothing</code>). I&#39;d start by <code>Set</code>ting it on a separate instruction."}, {"owner": {"reputation": 185, "user_id": 8709224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e51c529abdf6b96d639f2b31f9a5755?s=128&d=identicon&r=PG&f=1", "display_name": "Matschek", "link": "https://stackoverflow.com/users/8709224/matschek"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1537287094, "post_id": 52390267, "comment_id": 91726452, "body": "@BruceWayne: <code>Range..Values</code> gives a 2D array, which is almost impossible to work with then trying to make a string out of it. All of my attempts result in very (very) large runtimes when looping over the structure. And <code>Join</code> only works with 1D arrays."}, {"owner": {"reputation": 185, "user_id": 8709224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e51c529abdf6b96d639f2b31f9a5755?s=128&d=identicon&r=PG&f=1", "display_name": "Matschek", "link": "https://stackoverflow.com/users/8709224/matschek"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537287424, "post_id": 52390267, "comment_id": 91726589, "body": "@MathieuGuindon: Interesting point. What exactly do you mean with &quot;setting it on a separate instruction&quot;? I just tried to dim DataObj in the global scope to force reusage, but this leads to another error (DataObject:GetText Data in clipboard is invalid)"}, {"owner": {"reputation": 1529, "user_id": 8422565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c5b35d27f031eb1bf9dfe43e27fef08?s=128&d=identicon&r=PG&f=1", "display_name": "Kubie", "link": "https://stackoverflow.com/users/8422565/kubie"}, "edited": false, "score": 0, "creation_date": 1537287588, "post_id": 52390267, "comment_id": 91726681, "body": "if the range is a set range (not changing)... a naive solution would be to just create 25 variables to hold 10,000 lines each and add them individually to your POST, or 5 of 50k or so lol"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537287615, "post_id": 52390267, "comment_id": 91726700, "body": "I never said to widen its scope... Just <code>Dim</code> and <code>Set</code> separately; <code>Dim . As New</code> is a recipe for unexpected behavior, esp. wrt memory management."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1537288208, "post_id": 52390267, "comment_id": 91726998, "body": "VBA isn&#39;t garbage-collected, it&#39;s reference-counted. Note that <code>Dim</code> statements are NOT executable (you can&#39;t place a breakpoint on them), but <code>Set</code> statements are. So <code>Dim DataObj As MSForms.DataObject</code> and on the next line <code>Set DataObj = New MSForms.DataObject</code>, is all I meant. That said the problem might be elsewhere, but <code>Dim ..As New</code> can&#39;t possibly be helping."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537290121, "post_id": 52390267, "comment_id": 91727914, "body": "Just a thought: assuming 50 characters per cell, 2 bytes per character, we&#39;re looking at <code>22*250000*50*2&#47;1024&#47;1024&#47;1024</code> ~= half a gigabyte being transmitted over an HTTP POST request. Since this is an internal intranet solution, wouldn&#39;t it be a better idea to have the file on a network share, and then having some SSIS package grab the content and <code>SqlBulkInsert</code> it directly to a database? VBA can do lots of things, but sometimes VBA <i>isn&#39;t</i> the ideal solution. That said, 80MB would be about 7-8 characters per cell, and half of that would be 3-4 characters. Are you sure about your numbers?"}, {"owner": {"reputation": 185, "user_id": 8709224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e51c529abdf6b96d639f2b31f9a5755?s=128&d=identicon&r=PG&f=1", "display_name": "Matschek", "link": "https://stackoverflow.com/users/8709224/matschek"}, "edited": false, "score": 0, "creation_date": 1537345998, "post_id": 52390267, "comment_id": 91746841, "body": "I tried with dim/set, same result. I replaced the assignment <code>data = DataObj.GetText</code> with a <code>call DataObj.GetText</code> and still get the growing memory effect, so the MSForms.DataObject should be the real problem, not the string. I&#39;ll search into that direction."}, {"owner": {"reputation": 185, "user_id": 8709224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e51c529abdf6b96d639f2b31f9a5755?s=128&d=identicon&r=PG&f=1", "display_name": "Matschek", "link": "https://stackoverflow.com/users/8709224/matschek"}, "edited": false, "score": 0, "creation_date": 1537346204, "post_id": 52390267, "comment_id": 91746967, "body": "About the data size: 1 byte per character and ~ 10 almost empty columns lead to ~ 40MB of data, this value is correct. I&#39;m comparing different ways within/without VBA. The current implementation exports a CSV and triggers a PHP script on the Server which reads it into a MySQL database. The last time I investigated alternative solutions for importing the XLSX file on the server I got stuck on other problems (ODBC import did not \u201cguess\u201d some cell formats correctly, PHP XLSX libraries failed to handle the large amount of data\u2026) but that\u2019s another topic and maybe worth another thread."}, {"owner": {"reputation": 185, "user_id": 8709224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e51c529abdf6b96d639f2b31f9a5755?s=128&d=identicon&r=PG&f=1", "display_name": "Matschek", "link": "https://stackoverflow.com/users/8709224/matschek"}, "edited": false, "score": 0, "creation_date": 1537347903, "post_id": 52390267, "comment_id": 91747977, "body": "I implemented the clipboard access via API. The runtime of the copy increases from 2.5s to 3.3s, but this is fine here. The memory consumption grows by 140MB but drops down again after the work is done. Maybe a better API implementation can even be more efficently, I copied from <a href=\"http://access.mvps.org/access/api/api0049.htm\" rel=\"nofollow noreferrer\">access.mvps.org/access/api/api0049.htm</a>"}], "answers": [{"tags": [], "owner": {"reputation": 185, "user_id": 8709224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e51c529abdf6b96d639f2b31f9a5755?s=128&d=identicon&r=PG&f=1", "display_name": "Matschek", "link": "https://stackoverflow.com/users/8709224/matschek"}, "is_accepted": false, "score": 0, "last_activity_date": 1537348766, "creation_date": 1537348766, "answer_id": 52402374, "question_id": 52390267, "link": "https://stackoverflow.com/questions/52390267/workaround-for-memory-leak-when-using-large-string/52402374#52402374", "title": "Workaround for Memory Leak when using large string", "body": "<p>The root cause is not the handling of large strings. The problem is the call of the <code>MSForms.DataObj.GetText</code> method which does not free memory correctly.\nThe clipboard access can alternatively be done via native Windows APIs. This site <a href=\"http://access.mvps.org/access/api/api0049.htm\" rel=\"nofollow noreferrer\">http://access.mvps.org/access/api/api0049.htm</a> shows an example implementation which works fine in my tests, even if it is ~ 30% slower than the method provided by MSForms.</p>\n"}], "owner": {"reputation": 185, "user_id": 8709224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e51c529abdf6b96d639f2b31f9a5755?s=128&d=identicon&r=PG&f=1", "display_name": "Matschek", "link": "https://stackoverflow.com/users/8709224/matschek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 121, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1537348766, "creation_date": 1537285511, "question_id": 52390267, "link": "https://stackoverflow.com/questions/52390267/workaround-for-memory-leak-when-using-large-string", "title": "Workaround for Memory Leak when using large string", "body": "<p>The following simple code copies some cells into the clipboard and gets it back as text data. Later this data will be POSTed to an internal webservice, but this is commented out at this point of time.\nEvery time I run the script the used memory of the Excel grows by about 80MB (twice the size of the string). I have no clue where/why the garbage collector fails and what I can do againt this.</p>\n\n<pre><code>Sub memory_leak()\n    Dim DataObj As New MSForms.DataObject\n    Dim data As String\n\n    'Copy Data Range ~ the first 250.000 rows / 22 columns\n    Range(Cells(9, 1), Cells(250000, 22)).Copy\n\n    DataObj.GetFromClipboard\n    data = DataObj.GetText\n\n    ' Call postToURL(\"http://intranet/API.php?action=test\", data)\n\n    'Try to free memory...\n    Application.CutCopyMode = False\n    DataObj.Clear\n    data = \"\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 4, "creation_date": 1537284259, "post_id": 52389836, "comment_id": 91724762, "body": "Not an answer to your question, but please please please read <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba?s=1|259.1623\">How to avoid Select in VBA</a>."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1537284374, "post_id": 52389836, "comment_id": 91724832, "body": "For example, you can use <code>Sheets(&quot;Equities&quot;).Range(&quot;B5&quot;).Copy &#47;&#47; Sheets(&quot;ZSM&quot;).Range(&quot;B5&quot;).PasteSpecial xlValues</code> or even quicker the one-line <code>Sheets(&quot;ZSM&quot;).Range(&quot;B5&quot;).value=Sheets(&quot;Equities&quot;).Range(&quot;B5&zwnj;&#8203;&quot;).value</code>."}, {"owner": {"reputation": 9829, "user_id": 3961708, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9fcd3fc0eae3e7b0e1f4f120f1326bcd?s=128&d=identicon&r=PG&f=1", "display_name": "cyboashu", "link": "https://stackoverflow.com/users/3961708/cyboashu"}, "edited": false, "score": 0, "creation_date": 1537284465, "post_id": 52389836, "comment_id": 91724895, "body": "<code>xlPasteValues</code> Here&#39;s the list of available options <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlpastetype\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/office/vba/api/excel.xlpastetype</a>"}, {"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537285703, "post_id": 52389836, "comment_id": 91725580, "body": "Now I edited my post. I hope that clarifies the problem. Thank you :)"}, {"owner": {"reputation": 952, "user_id": 5548598, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/46ca4f3bb8b45761077cbfd9a6e9d0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Taelsin", "link": "https://stackoverflow.com/users/5548598/taelsin"}, "edited": false, "score": 0, "creation_date": 1537285929, "post_id": 52389836, "comment_id": 91725750, "body": "SJR&#39;s initial comment cannot be overstated. Please avoid the use of <code>Select</code> in VBA. It can lead to weird behaviour that is not easy to debug."}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1537284888, "post_id": 52390032, "comment_id": 91725116, "body": "I was wondering the same thing about the (1,1) offset... Seems kind of strange."}, {"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537285227, "post_id": 52390032, "comment_id": 91725301, "body": "yeah it is strange because I did not show you my whole code. I am sorry about that."}, {"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537285656, "post_id": 52390032, "comment_id": 91725549, "body": "Now I edited the question. I hope that helps. Thank you very much! :)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1537286003, "post_id": 52390032, "comment_id": 91725803, "body": "Now you&#39;re just overwriting almost all the data in ZSM you got from Equities with the values from Bonds. In addition, you&#39;ve rendered this response completely invalid."}, {"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "edited": false, "score": 0, "creation_date": 1537286213, "post_id": 52390032, "comment_id": 91725949, "body": "Yeah thats what this response does. I wanted to show you why I have to use offset(1,1). As I said, I am really knew to this and do not know how I have to behave in stackoverflow. I apologize for the inconveniences. Hope that someone can hepl"}, {"owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1537344620, "post_id": 52390032, "comment_id": 91746067, "body": "@dwirony I now edited the post back to the normal question. Thank you for your help. For my problem I posted a new question: <a href=\"https://stackoverflow.com/questions/52401097/paste-values-instead-of-formulas-with-pastespecial-vbanewbie\" title=\"paste values instead of formulas with pastespecial vbanewbie\">stackoverflow.com/questions/52401097/&hellip;</a>    I would really appreciate your support. Thank you!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 4, "last_activity_date": 1537284829, "last_edit_date": 1537284829, "creation_date": 1537284656, "answer_id": 52390032, "question_id": 52389836, "link": "https://stackoverflow.com/questions/52389836/paste-values-instead-of-formulas/52390032#52390032", "title": "Paste values instead of formulas", "body": "<p>Forget the PasteSpecial xlValues and perform a direct value transfer hereby bypassing the clipboard altogether.</p>\n\n<pre><code>dim zsm as worksheet\n\nset zsm = workSheets(\"ZSM\")\n\nwith workSheets(\"Equities\")\n    with .Range(.range(.cells(5, \"B\"), .cells(.rows.count, \"B\").end(xlup)), _\n                .range(.cells(5, \"B\"), .cells(5, .columns.count).end(xltoleft)))\n        zsm.cells(5, \"B\").resize(.rows.count, .columns.count) = .value\n    end with\nend with\n\nwith workSheets(\"Bonds\")\n    with .Range(.range(.cells(5, \"B\"), .cells(.rows.count, \"B\").end(xlup)), _\n                .range(.cells(5, \"B\"), .cells(5, .columns.count).end(xltoleft)))\n        zsm.cells(zsm.rows.count, \"B\").end(xlup).offset(1, 1).resize(.rows.count, .columns.count) = .value\n    end with\nend with\n</code></pre>\n\n<p>Are you sure that last offset should be offset(1, 1) and not offset(1, 0)?</p>\n"}], "owner": {"reputation": 163, "user_id": 9783152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2498bbac99a259f6298acdb29e9e1641?s=128&d=identicon&r=PG&f=1", "display_name": "Peter", "link": "https://stackoverflow.com/users/9783152/peter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 493, "favorite_count": 0, "accepted_answer_id": 52390032, "answer_count": 1, "score": 2, "last_activity_date": 1613466450, "creation_date": 1537283905, "last_edit_date": 1613466450, "question_id": 52389836, "link": "https://stackoverflow.com/questions/52389836/paste-values-instead-of-formulas", "title": "Paste values instead of formulas", "body": "<p>I want to copy certain values in cells from one tab into another.</p>\n<pre class=\"lang-vb prettyprint-override\"><code>    Sheets(&quot;Equities&quot;).Select\n    Range(&quot;B5&quot;).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(&quot;ZSM&quot;).Select\n    Range(&quot;B5&quot;).Select\n    ActiveSheet.Paste\n    Sheets(&quot;Bonds&quot;).Select\n    Range(&quot;B5&quot;).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(&quot;ZSM&quot;).Select\n    Range(&quot;B5&quot;).Select\n    Selection.End(xlDown).Select\n    Selection.End(xlToRight).Select\n    ActiveCell.Offset(1, 1).Select\n    ActiveSheet.Paste\n</code></pre>\n<p>I want to modify the code to also copy the values (I only want the value the formula gives back) from formulas (e.g. &quot;= J5*K24&quot;).</p>\n<p>I modified the code the following way:</p>\n<pre class=\"lang-vb prettyprint-override\"><code>    Sheets(&quot;Equities&quot;).Select\n    Range(&quot;B5&quot;).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(&quot;ZSM&quot;).Select\n    Range(&quot;B5&quot;).Select\n    ActiveSheet.PasteSpecial               ###here\n    Sheets(&quot;Bonds&quot;).Select\n    Range(&quot;B5&quot;).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToRight)).Select\n    Selection.Copy\n    Sheets(&quot;ZSM&quot;).Select\n    Range(&quot;B5&quot;).Select\n    Selection.End(xlDown).Select\n    Selection.End(xlToRight).Select\n    ActiveCell.Offset(1, 1).Select\n    ActiveSheet.PasteSpecial                  ##here\n</code></pre>\n<p>I read a bit about the PasteSpecial method but could not apply it.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1537284434, "post_id": 52389833, "comment_id": 91724873, "body": "You can&#39;t nest a function in a sub (if that&#39;s what you&#39;re doing)."}, {"owner": {"reputation": 27, "user_id": 7959876, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wr-nZgjklNY/AAAAAAAAAAI/AAAAAAAANCI/BXNUVdBHXuU/photo.jpg?sz=128", "display_name": "Josh Hudson", "link": "https://stackoverflow.com/users/7959876/josh-hudson"}, "edited": false, "score": 0, "creation_date": 1537284694, "post_id": 52389833, "comment_id": 91725012, "body": "This worked fine without the &amp;quot;access&amp;quot; code. In the sub is called using      Report.cells(i,22) = BAUAging(i)"}, {"owner": {"reputation": 2802, "user_id": 5030088, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42b4cbf19eede28c5a89c26349b15b02?s=128&d=identicon&r=PG&f=1", "display_name": "xidgel", "link": "https://stackoverflow.com/users/5030088/xidgel"}, "edited": false, "score": 0, "creation_date": 1537290530, "post_id": 52389833, "comment_id": 91728120, "body": "Which line of your code is throwing the error?"}], "answers": [{"tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1537286796, "creation_date": 1537286796, "answer_id": 52390619, "question_id": 52389833, "link": "https://stackoverflow.com/questions/52389833/application-defined-or-object-defined-error-in-function/52390619#52390619", "title": "Application defined or object defined error in function", "body": "<p>You need to change your function to take <code>x</code> as an argument, otherwise it will have no value and you'll get <code>1004</code> error:</p>\n\n<pre><code>Function BAUAgeing(i As Long, x as long)\n</code></pre>\n\n<p>And in your code above, also change the argument:</p>\n\n<pre><code>' Add BAU Ageing\nreport.Cells(i, 22) = BAUAgeing(i, x)\n</code></pre>\n\n<p>Additionally, you really should add <code>Option Explicit</code> to the top of your module and declare <strong>all</strong> of your variables. You declare <code>i</code>,  but not <code>t</code>, <code>x</code>, <code>S</code>... leaves a lot of room for mistakes.</p>\n"}], "owner": {"reputation": 27, "user_id": 7959876, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Wr-nZgjklNY/AAAAAAAAAAI/AAAAAAAANCI/BXNUVdBHXuU/photo.jpg?sz=128", "display_name": "Josh Hudson", "link": "https://stackoverflow.com/users/7959876/josh-hudson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 52390619, "answer_count": 1, "score": -2, "last_activity_date": 1579281460, "creation_date": 1537283888, "last_edit_date": 1579281460, "question_id": 52389833, "link": "https://stackoverflow.com/questions/52389833/application-defined-or-object-defined-error-in-function", "title": "Application defined or object defined error in function", "body": "<p>I am getting the Run-Time error 1004 application-defined or object defined error which I updated the function below to include the \"access\" code. I cant seem to find where my issue is.</p>\n\n<pre><code>Dim Access As Worksheet\nDim report As Worksheet\nDim complete As Worksheet\n\nSub finalOverlay()\n\n    Application.ScreenUpdating = False\n\n    Set Access = ActiveWorkbook.Worksheets(\"Access\")\n    Set report = ActiveWorkbook.Worksheets(\"Report\")\n    Set complete = ActiveWorkbook.Worksheets(\"Implementation Complete\")\n\n    Dim i As Long\n\n    For x = 2 To Access.UsedRange.Rows.Count\n        For i = 2 To report.UsedRange.Rows.Count\n\n\n            getRemainingControls (i)\n\n            ' update completed list if no more actions outstanding\n            If report.Cells(i, 17) = 0 Then                    \n                 t = setComplete(report.Cells(i, 1), i)\n            End If\n\n            S = getComplete(report.Cells(i, 1), i)\n\n            ' Add BAU Ageing\n            report.Cells(i, 22) = BAUAgeing(i)\n\n            ' Disposition Date past\n            If report.Cells(i, 34) &lt;&gt; \"\" Then\n                If CDate(report.Cells(i, 34)) &lt; Date Then\n                    report.Cells(i, 34).Interior.ColorIndex = 3\n                End If\n            End If\n\n\n            ' Proposed Status for too long\n            If report.Cells(i, 4) = \"Proposed\" Then\n                report.Cells(i, 18) = CInt(Date - CDate(report.Cells(i, 38)))\n                If report.Cells(i, 18) &gt; 30 Then\n                    report.Cells(i, 18).Interior.ColorIndex = 3\n               End If\n            End If\n\n\n        Next i\n    Next x\n\n    For n = 2 To report.UsedRange.Rows.Count\n        If report.Cells(n, 19) &lt;&gt; \" \" And _\n           report.Cells(n, 19) &gt; 305 And _\n           report.Cells(n, 23) = \"Yes\" And _\n           report.Cells(n, 3) &lt;&gt; \"LOW\" And _\n           report.Cells(n, 39) &lt;&gt; \"NO\" Then\n              report.Cells(n, 19).Interior.ColorIndex = 45\n        End If\n\n        If report.Cells(n, 19) &lt;&gt; \" \" And _\n           report.Cells(n, 19) &gt; 60 And _\n           report.Cells(n, 24) &lt;&gt; \"Complete\" And _\n           report.Cells(n, 24) &lt;&gt; \"\" And _\n           report.Cells(n, 23) = \"Yes\" And _\n           report.Cells(n, 3) &lt;&gt; \"LOW\" And _\n           report.Cells(n, 39) &lt;&gt; \"NO\" Then\n               report.Cells(n, 19).Interior.ColorIndex = 3\n        End If\n\n        If report.Cells(n, 20) &gt; 305 And _\n           report.Cells(n, 20) &lt; 364 And _\n           report.Cells(n, 29) = \"Complete\" And _\n           report.Cells(n, 23) = \"Yes\" And _\n           report.Cells(n, 3) &lt;&gt; \"LOW\" And _\n           report.Cells(n, 39) &lt;&gt; \"NO\" Then\n               report.Cells(n, 20).Interior.ColorIndex = 45\n        End If\n\n        If report.Cells(n, 20) &gt; 60 And _\n           report.Cells(n, 29) &lt;&gt; \"Complete\" And _\n           report.Cells(n, 23) = \"Yes\" And _\n           report.Cells(n, 3) &lt;&gt; \"LOW\" And _\n           report.Cells(n, 39) &lt;&gt; \"NO\" Then\n               report.Cells(n, 20).Interior.ColorIndex = 3\n        End If\n\n    Next n\n\n    Application.ScreenUpdating = True\n\nEnd Sub\n\nFunction BAUAgeing(i As Long)\n\n    If report.Cells(i, 17) &gt; 0 And _\n       report.Cells(i, 6) &lt;&gt; \"\" And _\n       report.Cells(i, 23) = \"No\" Then\n           BAUAgeing = Date - CDate(report.Cells(i, 6))\n\n    Else\n    End If\n\n    If report.Cells(i, 4) = \"Newly Disclosed\" And Access.Cells(x, 35) = \"\" Then\n        BAUAgeing = Date - CDate(report.Cells(i, 38))\n    Else\n        BAUAgeing = Date - CDate(Mid(Access.Cells(x, 35), 16, 10))\n    End If\n\n    If report.Cells(i, 4) = \"Proposed\" And Access.Cells(x, 35) = \"\" Then\n        BAUAgeing = Date - CDate(report.Cells(i, 38))\n    Else\n        BAUAgeing = Date - CDate(Mid(Access.Cells(x, 35), 16, 10))\n    End If\n\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 1633895, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/46f9b64706e97f5a4682f713b346ee02?s=128&d=identicon&r=PG", "display_name": "Caynadian", "link": "https://stackoverflow.com/users/1633895/caynadian"}, "edited": false, "score": 0, "creation_date": 1537360932, "post_id": 52399142, "comment_id": 91755942, "body": "Testing to see if the text box equals vbCr worked great, thanks!"}], "tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 1, "last_activity_date": 1537337010, "creation_date": 1537337010, "answer_id": 52399142, "question_id": 52389609, "link": "https://stackoverflow.com/questions/52389609/check-for-an-empty-text-box/52399142#52399142", "title": "Check for an empty Text Box", "body": "<p>There is always a paragraph break in an otherwise empty textbox. Accordingly, you could use something along the lines of:</p>\n\n<pre><code>Private Sub Document_Open()\n  With ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).Shapes(\"Text Box 2\")\n    If Not .TextFrame Is Nothing Then\n      If Trim(.TextFrame.TextRange.Text) = vbCr Then\n        MsgBox \"Empty Text Range\"\n      End If\n    Else\n      MsgBox \"No Text Range\"\n    End If\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 715, "user_id": 1633895, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/46f9b64706e97f5a4682f713b346ee02?s=128&d=identicon&r=PG", "display_name": "Caynadian", "link": "https://stackoverflow.com/users/1633895/caynadian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 419, "favorite_count": 0, "accepted_answer_id": 52399142, "answer_count": 1, "score": 0, "last_activity_date": 1593160050, "creation_date": 1537283191, "last_edit_date": 1593160050, "question_id": 52389609, "link": "https://stackoverflow.com/questions/52389609/check-for-an-empty-text-box", "title": "Check for an empty Text Box", "body": "<p>I have a text box in a Word 2016 document.  This is not a TextBox form object but a normal Text Box that you insert from the Insert tab here:</p>\n\n<p><a href=\"https://i.stack.imgur.com/xPeZx.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xPeZx.jpg\" alt=\"Insert Menu\"></a></p>\n\n<p>I am trying to check if it is empty when the document is opened.  For the life of me I cannot figure out how to do this.  I have tried all of the following:</p>\n\n<pre><code>If (Len(ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).Shapes(\"Text Box 2\").TextFrame.TextRange.Text &amp; vbNullString) = 0) Then\nIf (IsNull(ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).Shapes(\"Text Box 2\").TextFrame.TextRange.Text)) Then\nIf (LTrim(RTrim(ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).Shapes(\"Text Box 2\").TextFrame.TextRange.Text)) = \"\") Then\nIf (ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).Shapes(\"Text Box 2\").TextFrame.TextRange.Text = \"\") Then\n</code></pre>\n\n<p>None of these return true when the text box is empty?  This is the text box:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ustPW.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ustPW.jpg\" alt=\"Text Box\"></a></p>\n\n<p>It seems that the text box always contains a paragraph marker (which I can't delete).  This is what the VBA watch shows:</p>\n\n<pre><code>Watch :   : ActiveDocument.Sections(1).Headers(wdHeaderFooterPrimary).Shapes(\"Text Box 2\").TextFrame.TextRange.Text : \"\n\" : String : ThisDocument.Document_Open\n</code></pre>\n\n<p>Note that the watch is two separate lines which makes me think that there's CRLF or something in there?</p>\n"}, {"tags": ["vba", "http", "file-upload"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 0, "creation_date": 1537283038, "post_id": 52389091, "comment_id": 91723947, "body": "You should upload a binary content read from stream, but not concatenated string."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2261597"}, "edited": false, "score": 0, "creation_date": 1537283080, "post_id": 52389091, "comment_id": 91723974, "body": "My first thought was encoding, just as you suspect. Change all characters to include only US ASCII, value 0-127 as a test. Does it work then?"}, {"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1537283432, "post_id": 52389091, "comment_id": 91724212, "body": "Check <a href=\"https://stackoverflow.com/a/37446402/2165759\">this example</a>."}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "edited": false, "score": 0, "creation_date": 1537283563, "post_id": 52389091, "comment_id": 91724299, "body": "@ omegastripes: When I objStream.Type = 1 and use &quot;Read&quot; instead of ReadText the result is &quot;Http-Status: 500 - Internal Server Error&quot;"}, {"owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "reply_to_user": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 1, "creation_date": 1537284469, "post_id": 52389091, "comment_id": 91724897, "body": "@omegastripes: Thank you a lot! Your example helped me to solve this. Ill post the working code as an answer!"}], "answers": [{"tags": [], "owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "is_accepted": true, "score": 2, "last_activity_date": 1537343820, "last_edit_date": 1537343820, "creation_date": 1537285236, "answer_id": 52390187, "question_id": 52389091, "link": "https://stackoverflow.com/questions/52389091/upload-pdf-via-multipart-html-post-does-change-file/52390187#52390187", "title": "Upload pdf via multipart-HTML-Post does change file", "body": "<p>With the help of user omegastripes and his hint to this example: <a href=\"https://stackoverflow.com/questions/37436516/file-updload-in-post-form-in-vbs/37446402#37446402\">File updload in post form in VBS</a> I solved my problem.</p>\n\n<p>The content of the file has to be read and sent to the host binary (not as a string as I did)</p>\n\n<p>This code works for me:</p>\n\n<pre><code>Public Function sap_addTest(ByVal par_objectID As String, ByVal par_description As String, ByVal par_filename As String) As Integer\n\n  Dim ls_param As String\n  Dim text As String\n  Dim line As String\n  Dim url As String\n  Dim web As MSXML2.XMLHTTP60\n  url = \"http://someurl.xml\"\n\n\n  Set web = CreateObject(\"MSXML2.XMLHTTP\")\n\n\n  Call web.Open(\"POST\", url, False)\n  Const Boundary As String = \"AaB03x\"\n  Call web.setRequestHeader(\"content-type\", \"multipart/form-data;boundary=\" &amp; Boundary)\n  Call web.setRequestHeader(\"ws-callingapplication\", sys_db)\n  Call web.setRequestHeader(\"Connection\", \"Keep-Alive\")\n  Call web.setRequestHeader(\"cache-control\", \"no-cache\")\n\n\n  Dim baBuffer() As Byte\n\n  Dim bytData\n  Dim bytPayLoad\n\n  With CreateObject(\"ADODB.Stream\")\n       .Type = 1\n       .Mode = 3\n       .Open\n       .LoadFromFile par_filename\n       bytData = .Read\n   End With\n\n   With CreateObject(\"ADODB.Stream\")\n      .Mode = 3\n      .Charset = \"Windows-1252\"\n      .Open\n      .Type = 2\n      .WriteText vbNewLine &amp; \"--\" &amp; Boundary &amp; vbNewLine &amp; \"Content-Disposition: form-data; name=\"\"object_id\"\"\" &amp; vbNewLine &amp; vbNewLine &amp; par_objectID\n      .WriteText vbNewLine &amp; \"--\" &amp; Boundary &amp; vbNewLine &amp; \"Content-Disposition: form-data; name=\"\"description\"\"\" &amp; vbNewLine &amp; vbNewLine &amp; par_description\n      .WriteText vbNewLine &amp; \"--\" &amp; Boundary &amp; vbNewLine &amp; \"Content-Disposition: form-data; name=\"\"file\"\"; filename=\"\"\" &amp; par_filename &amp; \"\"\"\" &amp; vbNewLine\n      .WriteText vbNewLine\n      .Position = 0\n      .Type = 1\n      .Position = .Size\n      .Write bytData\n      .Position = 0\n      .Type = 2\n      .Position = .Size\n      .WriteText vbNewLine &amp; vbNewLine &amp; \"--\" &amp; Boundary &amp; \"--\" &amp; vbNewLine\n      .Position = 0\n      .Type = 1\n      bytPayLoad = .Read\n  End With\n\n\n  Call web.Send(bytPayLoad)\n\n  'Debug.Print web.status\n  'Debug.Print web.responseText\n\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 848, "user_id": 9930052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b31bc4725aa5b89c228cb8e64fe2c4a?s=128&d=identicon&r=PG&f=1", "display_name": "Gener4tor", "link": "https://stackoverflow.com/users/9930052/gener4tor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 825, "favorite_count": 1, "accepted_answer_id": 52390187, "answer_count": 1, "score": 1, "last_activity_date": 1537346007, "creation_date": 1537281594, "last_edit_date": 1537346007, "question_id": 52389091, "link": "https://stackoverflow.com/questions/52389091/upload-pdf-via-multipart-html-post-does-change-file", "title": "Upload pdf via multipart-HTML-Post does change file", "body": "<p>I try to upload a pdf via multipart with vba using this code:</p>\n\n<pre><code>Public Function sap_upload(ByVal par_objectID As String, ByVal par_description As String, ByVal par_filename As String) As Integer\n\n    Dim ls_param As String\n    Dim text As String\n    Dim line As String\n    Dim url As String\n    Dim web As MSXML2.XMLHTTP60\n    url = \"http://someurl.xml\"\n\n\n    Set web = CreateObject(\"MSXML2.XMLHTTP\")\n\n\n    Call web.Open(\"POST\", url, False)\n    Const Boundary As String = \"AaB03x\"\n    Call web.setRequestHeader(\"content-type\", \"multipart/form-data;boundary=\" &amp; Boundary)\n    Call web.setRequestHeader(\"Connection\", \"Keep-Alive\")\n    Call web.setRequestHeader(\"cache-control\", \"no-cache\")\n\n\n    Dim objStream, strData\n\n    Set objStream = CreateObject(\"ADODB.Stream\")\n\n    objStream.Charset = \"utf-8\"\n    objStream.Open\n    objStream.LoadFromFile (par_filename)\n\n    strData = objStream.ReadText()\n\n    Dim getFileResult\n    getFileResult = GetFile(par_filename)\n\n    ls_param = vbNewLine &amp; \"--\" &amp; Boundary &amp; vbNewLine &amp; \"Content-Disposition: form-data; name=\"\"object_id\"\"\" &amp; vbNewLine &amp; vbNewLine &amp; par_objectID &amp; _\n             vbNewLine &amp; \"--\" &amp; Boundary &amp; vbNewLine &amp; \"Content-Disposition: form-data; name=\"\"description\"\"\" &amp; vbNewLine &amp; vbNewLine &amp; par_description &amp; _\n             vbNewLine &amp; \"--\" &amp; Boundary &amp; vbNewLine &amp; \"Content-Disposition: form-data; name=\"\"file\"\"; filename=\"\"\" &amp; par_filename &amp; \"\"\"\" &amp; vbNewLine &amp; _\n             vbNewLine &amp; strData &amp; vbNewLine &amp; vbNewLine &amp; \"--\" &amp; Boundary &amp; \"--\" &amp; vbNewLine\n\n    Call web.Send(ls_param)\n\nend function\n</code></pre>\n\n<p>everything seems fine, but when I try to open the uploaded file, the pdf-reader tells me the file has a password. When I compare the files with notepad++ I can see that there is a difference. The \"text part\" seems to be identical but the \"data\"-part seems to have changed.</p>\n\n<p>So this are the first few lines of the original:</p>\n\n<pre><code>%PDF-1.6\n%\u00e2\u00e3\u00cf\u00d3\n37 0 obj &lt;&lt;/Linearized 1/L 20597/O 40/E 14115/N 1/T 19795/H [ 1005 215]&gt;&gt;\nendobj\n</code></pre>\n\n<p>and this is the file which was uploaded:</p>\n\n<pre><code>%PDF-1.6\n%\ufffd\ufffd\ufffd\ufffd\n37 0 obj &lt;&lt;/Linearized 1/L 20597/O 40/E 14115/N 1/T 19795/H [ 1005 215]&gt;&gt;\nendobj\n</code></pre>\n\n<p>The second line is different. And the same happens with all of the content which is no text. Another example from a line in the center of the file:</p>\n\n<p>Original:</p>\n\n<pre><code>s\u2020f\u0178\u00ab\u00b8\"$ \u00ba\u0192\u017844}2\u0161\u00d4@Y\u2022\u00a8\u00d7\u00c7,(\u0152A-$\u00c8\u00c7\u00dd\u0160\u00eb\u00e2\u00d3\u02c6ea\u2030,\u00d2s&lt;W\u00b2\u00ab\u00e4\u00d2v{ r8\u00b8 o*=\u00cb\u00ee\u00c1\u2014\u0153   5\u00b4x\u00ce&amp;:\u2018\u0160\u201a2b\u00c1nu:\u00c2\u02dc\u00b2\u00ba\u00fa/n\u00e2\u00bc\u00e6\u00b7ig\u2013\u00a3\u2018\u00b1\u00c5\u00f43]E\n</code></pre>\n\n<p>file which was uploaded:</p>\n\n<pre><code>s\ufffdf\ufffd\ufffd\ufffd\"$ \ufffd\ufffd\ufffd44}2\ufffd\ufffd@Y\ufffd\ufffd\ufffd\ufffd,(\ufffdA-$\ufffd\ufffd\u074a\ufffd\ufffd\u04c8ea\ufffd,\ufffds&lt;W\ufffd\ufffd\ufffd\ufffdv{ r8\ufffd o*=\ufffd\ufffd\ufffd\ufffd\ufffd 5\ufffdx\ufffd&amp;:\ufffd\ufffd\ufffd2b\ufffdnu:\ufffd\ufffd\ufffd/n\ufffd\ufffd\ufffdig\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd3]E\n</code></pre>\n\n<p>So: What im doing wrong? Something releated with the encoding I suppose.    </p>\n"}, {"tags": ["vba", "outlook", "office365"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1537298823, "post_id": 52389029, "comment_id": 91731839, "body": "40-50 objects appears to be insignificant but try <code>Set objVariant = Nothing</code> before each of the <code>Next</code> statements."}, {"owner": {"reputation": 293, "user_id": 10025039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f4c1e4aa063ea5bcc59fcb59286fb08?s=128&d=identicon&r=PG&f=1", "display_name": "Simon Li", "link": "https://stackoverflow.com/users/10025039/simon-li"}, "edited": false, "score": 0, "creation_date": 1537359438, "post_id": 52389029, "comment_id": 91755064, "body": "You could use the VBA code analyzer tool to check the memory issue. However, if you reduce the loops and emails which such problems still exist? I&#39;m not sure if it&#39;s the shared folder. In short, try to improve your code and refer to this link: <a href=\"https://stackoverflow.com/questions/14396998/how-to-clear-memory-to-prevent-out-of-memory-error-in-excel-vba\" title=\"how to clear memory to prevent out of memory error in excel vba\">stackoverflow.com/questions/14396998/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 4371860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9141937b66e4f7e143917aade3bc4fea?s=128&d=identicon&r=PG&f=1", "display_name": "BusinessMonkey", "link": "https://stackoverflow.com/users/4371860/businessmonkey"}, "edited": false, "score": 0, "creation_date": 1537366392, "post_id": 52389029, "comment_id": 91759496, "body": "I added the Set ObjVariant = Nothing Line to the end of the loop, but still the same error. It actually fails at the &quot;objVariant.SaveAs spath &amp; sName, olMSG&quot; line (where the first save of the email is attempted). So the memory issue occurs during an attempt to save. Since this didn&#39;t occur before going to Office 365 it must be caused by the way the program is attempting to perform the save. I have no idea...."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4371860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9141937b66e4f7e143917aade3bc4fea?s=128&d=identicon&r=PG&f=1", "display_name": "BusinessMonkey", "link": "https://stackoverflow.com/users/4371860/businessmonkey"}, "edited": false, "score": 0, "creation_date": 1537814549, "post_id": 52417920, "comment_id": 91912414, "body": "Tried to run with this edit and got the same error... do i need to declare the vItems variable at the beginning of my code? If so, what variable type should be used?"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 4371860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9141937b66e4f7e143917aade3bc4fea?s=128&d=identicon&r=PG&f=1", "display_name": "BusinessMonkey", "link": "https://stackoverflow.com/users/4371860/businessmonkey"}, "edited": false, "score": 0, "creation_date": 1537837808, "post_id": 52417920, "comment_id": 91919552, "body": "Yes, if you are using &quot;Option explicit&quot;. Please show the rest of your code. Make sure you are not using multiple dot notation inside the loop."}, {"owner": {"reputation": 1, "user_id": 4371860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9141937b66e4f7e143917aade3bc4fea?s=128&d=identicon&r=PG&f=1", "display_name": "BusinessMonkey", "link": "https://stackoverflow.com/users/4371860/businessmonkey"}, "edited": false, "score": 0, "creation_date": 1537871262, "post_id": 52417920, "comment_id": 91932327, "body": "Tried declaring the variable as &quot;Variant&quot;. Still getting the same error. And I&#39;ve posted every line of my code in the original post. What exactly do you mean by using &quot;option explicit&quot; is there some other piece of code I need to &quot;enable&quot; this option? (that&#39;s probably an incorrect understanding of what that actually means isn&#39;t it? Sorry, not up to snuff on coding language)"}, {"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "reply_to_user": {"reputation": 1, "user_id": 4371860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9141937b66e4f7e143917aade3bc4fea?s=128&d=identicon&r=PG&f=1", "display_name": "BusinessMonkey", "link": "https://stackoverflow.com/users/4371860/businessmonkey"}, "edited": false, "score": 0, "creation_date": 1537893675, "post_id": 52417920, "comment_id": 91946606, "body": "Please edit your post to show your latest code. VBA allows to use undeclared variables unless &quot;Option explicit&quot; is specified - <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/statements/option-explicit-statement\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/dotnet/visual-basic/language-refere&zwnj;&#8203;nce/&hellip;</a>"}], "tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1537419784, "creation_date": 1537419784, "answer_id": 52417920, "question_id": 52389029, "link": "https://stackoverflow.com/questions/52389029/out-of-free-memory-while-running-archiver-code-in-outlook-vba-office-365/52417920#52417920", "title": "Out of free memory while running archiver code in Outlook VBA. Office 365", "body": "<p>You are using multiple dot notation, which means the compiler creates implicit variables that you cannot explicitly release:</p>\n\n<pre><code> For intCount = objSourceFolder.Items.Count To 1 Step -1\n   Set objVariant = objSourceFolder.Items.Item(intCount) \n</code></pre>\n\n<p>You code needs to be</p>\n\n<pre><code>set vItems = objSourceFolder.Items\nFor intCount = vItems.Count To 1 Step -1\n  Set objVariant = vItems.Item(intCount)\n  ...\n  set objVariant = Nothing\nnext\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4371860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9141937b66e4f7e143917aade3bc4fea?s=128&d=identicon&r=PG&f=1", "display_name": "BusinessMonkey", "link": "https://stackoverflow.com/users/4371860/businessmonkey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537419784, "creation_date": 1537281391, "question_id": 52389029, "link": "https://stackoverflow.com/questions/52389029/out-of-free-memory-while-running-archiver-code-in-outlook-vba-office-365", "title": "Out of free memory while running archiver code in Outlook VBA. Office 365", "body": "<p>I have written a simple email archiver code to save emails from my outlook inbox that are more than 45 days old. Many of my coworkers and I use this code because our company disables the autoarchive functions of outlook. It may be important to note that I DID NOT receive this error prior to our company transitioning to Microsoft Office 365. Now when running my archiver code I get the following error message:</p>\n\n<p>\"Run-time error '-2147024882 (8007000e)': There is not enough free memory to run this program. Quit one or more programs, and then try again.\"</p>\n\n<p>An important thing to note is that the code will run through 40-50 iterations (save 40-50 emails) and THEN throw this error message. My thinking after doing a little research is that one of the objects is building in size with each loop, but I can't figure out how that could be occurring. I also can't figure out a way to clear the free memory (I am not a very experienced coder). Once the error message has appeared the first time, subsequent runs of code throw the error immediately. The only remedy I have found is to restart the computer. After a restart it seems that the \"free memory\" has been cleared and this allows the code to run through another 40-50 cycles before again throwing the error. I assume I could put something in each loop to clear this free memory or eliminate the source of whatever variable is \"building\" with each iteration, but I am having a hard time understanding what that is with my research as many of the code examples are much more complex than mine. Sorry if I'm asking something that has already been answered but, as I said, my lack of experience with coding is making this research very difficult. Thanks! </p>\n\n<p>Here is my full code:</p>\n\n<pre><code> Sub SaveAgedMailMaster()\n\n\n\nDim objOutlook As Outlook.Application\n Dim objNamespace As Outlook.NameSpace\n Dim objSourceFolder As Outlook.MAPIFolder\n Dim objSubfolder As Outlook.MAPIFolder\n Dim objSubSubFolder As Outlook.MAPIFolder\n Dim objVariant As Variant\n Dim lngMovedItems As Long\n Dim intCount As Integer\n Dim intDateDiff As Integer\n Dim strDestFolder As String\n Dim sName As String\n Dim enviro As String\n Dim ernum As Integer\n Dim Nogood As Integer\n Dim Needmsg As Integer\n Dim ItemCount As Integer\n Dim Filepath As String\n\n\n\n\n enviro = CStr(Environ(\"USERPROFILE\"))\n ernum = 0\n Needmsg = 0\n ItemCount = 0\n\n Set objOutlook = Application\n Set objNamespace = objOutlook.GetNamespace(\"MAPI\")\n Set objSourceFolder = objNamespace.GetDefaultFolder(olFolderInbox)\n\n\n\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'saving inbox folder items\n\nenviro = CStr(Environ(\"USERPROFILE\"))\n ernum = 0\n Needmsg = 0\n ItemCount = 0\n\n Set objOutlook = Application\n Set objNamespace = objOutlook.GetNamespace(\"MAPI\")\n Set objSourceFolder = objNamespace.GetDefaultFolder(olFolderInbox)\n\n 'set this to the directory of your choice\n spath = \"C:\\Users\\djgatli\\OneDrive - Duke Energy\\Desktop\\Email Archive\\\"\n spath2 = \"\\\\nucvrnpfile\\rnpdata\\Engineering\\Reactor\\Gatlin, David\\Email Archive\\\"\n\n\n For intCount = objSourceFolder.Items.Count To 1 Step -1\n Set objVariant = objSourceFolder.Items.Item(intCount)\n DoEvents\n\n 'Comment the next line out so that all inbox items are archived. Otherwise all the calender events stay\n If objVariant.Class = olMail Then\n\n\n intDateDiff = DateDiff(\"d\", objVariant.SentOn, Now)\n ' I'm using 45 days, adjust as needed.\n If intDateDiff &gt; 45 Then\n\n Nogood = 1\n sName = objVariant.Subject\n ReplaceCharsForFileName sName, \"_\"\n dtDate = objVariant.ReceivedTime\n sName = Format(dtDate, \"yyyymmdd\", vbUseSystemDayOfWeek, _\n     vbUseSystem) &amp; Format(dtDate, \"-hhnnss\", _\n     vbUseSystemDayOfWeek, vbUseSystem) &amp; \"-\" &amp; sName &amp; \".msg\"\n\n\n\n\n On Error GoTo Erhandle\n objVariant.SaveAs spath &amp; sName, olMSG\n objVariant.SaveAs spath2 &amp; sName, olMSG\n objVariant.Delete\n Nogood = 0\n ItemCount = ItemCount + 1\n\nErhandle:\n  If Nogood = 1 Then\n    Needmsg = 1\n    ermsg = ermsg &amp; \", \" &amp; sName\n  End If\n\n End If\n End If\n Next\n\n 'comment out next IF block if no msgbox is wanted\nIf Needmsg = 1 Then\n\nMsgBox (\"Could not save backups of \" &amp; ermsg)\nMsgBox (ItemCount &amp; \" Mailbox items were successfully archived in \" &amp; spath &amp; \" and \" &amp; spath2)\n\nElse\n\nMsgBox (ItemCount &amp; \" Mailbox items were successfully archived in \" &amp; spath &amp; \" and \" &amp; spath2)\n\nEnd If\n\n\n\n''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n'Saving SENT mail folder\n\n\n enviro = CStr(Environ(\"USERPROFILE\"))\n ernum = 0\n Needmsg = 0\n ItemCount = 0\n\n Set objOutlook = Application\n Set objNamespace = objOutlook.GetNamespace(\"MAPI\")\n Set objSourceFolder = objNamespace.GetDefaultFolder(olFolderSentMail)\n\n 'set this to the directory of your choice\n spath = \"C:\\Users\\djgatli\\OneDrive - Duke Energy\\Desktop\\Email Archive\\Sent\\\"\n spath2 = \"\\\\nucvrnpfile\\rnpdata\\Engineering\\Reactor\\Gatlin, David\\Email Archive\\Sent\\\"\n\n\n For intCount = objSourceFolder.Items.Count To 1 Step -1\n Set objVariant = objSourceFolder.Items.Item(intCount)\n DoEvents\n\n 'Commented the next line out so that all inbox items are archived. Otherwise all the calender events stay\n If objVariant.Class = olMail Then\n\n\n intDateDiff = DateDiff(\"d\", objVariant.SentOn, Now)\n ' I'm using 45 days, adjust as needed.\n If intDateDiff &gt; 45 Then\n\n Nogood = 1\n sName = objVariant.Subject\n ReplaceCharsForFileName sName, \"_\"\n dtDate = objVariant.ReceivedTime\n sName = Format(dtDate, \"yyyymmdd\", vbUseSystemDayOfWeek, _\n     vbUseSystem) &amp; Format(dtDate, \"-hhnnss\", _\n     vbUseSystemDayOfWeek, vbUseSystem) &amp; \"-\" &amp; sName &amp; \".msg\"\n\n\n\n\n On Error GoTo Erhandle2\n objVariant.SaveAs spath &amp; sName, olMSG\n objVariant.SaveAs spath2 &amp; sName, olMSG\n objVariant.Delete\n Nogood = 0\n ItemCount = ItemCount + 1\n\nErhandle2:\n  If Nogood = 1 Then\n    Needmsg = 1\n    ermsg = ermsg &amp; \", \" &amp; sName\n  End If\n\n End If\n End If\n Next\n'comment out next if block if no msgbox is wanted\nIf Needmsg = 1 Then\n\nMsgBox (\"Could not save backups of \" &amp; ermsg)\nMsgBox (ItemCount &amp; \" Mailbox items were successfully archived in \" &amp; spath &amp; \" and \" &amp; spath2)\n\nElse\n\nMsgBox (ItemCount &amp; \" Mailbox items were successfully archived in \" &amp; spath &amp; \" and \" &amp; spath2)\n\nEnd If\n\n End Sub\n\n\n\n Private Sub ReplaceCharsForFileName(sName As String, _\n   sChr As String _\n )\n   sName = Replace(sName, \"/\", sChr)\n   sName = Replace(sName, \"\\\", sChr)\n   sName = Replace(sName, \":\", sChr)\n   sName = Replace(sName, \"?\", sChr)\n   sName = Replace(sName, Chr(34), sChr)\n   sName = Replace(sName, \"&lt;\", sChr)\n   sName = Replace(sName, \"&gt;\", sChr)\n   sName = Replace(sName, \"|\", sChr)\n   sName = Replace(sName, \".\", sChr)\n   sName = Replace(sName, \" \", sChr)\n   sName = Replace(sName, \"*\", sChr)\n   sName = Replace(sName, Chr(9), sChr)\n   sName = Replace(sName, Chr(10), sChr)\n   sName = Replace(sName, Chr(11), sChr)\n   sName = Replace(sName, Chr(12), sChr)\n   sName = Replace(sName, Chr(13), sChr)\n\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "powerquery"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537288937, "post_id": 52388861, "comment_id": 91727381, "body": "When building up the formula, <code>import_path</code> should not fall inside the quotation marks (before <code>Kilde=...</code> and after <code>...true),</code>). You need to concatenate with <code>&amp;</code>."}, {"owner": {"reputation": 366, "user_id": 3445357, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/854395133/picture?type=large", "display_name": "Stian St&#248;rstfeskar Andersen", "link": "https://stackoverflow.com/users/3445357/stian-st%c3%b8rstfeskar-andersen"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1537341138, "post_id": 52388861, "comment_id": 91744212, "body": "<code>Kilde = Excel.Workbook(File.Contents(&amp;import_path), null, true)</code> Like this? get error on that"}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 1, "creation_date": 1537343681, "post_id": 52388861, "comment_id": 91745564, "body": "Why use VBA? You can use a named range to capture the filename, then your query can reference that named range - so the user just has to enter the file name, then refresh the existing query."}, {"owner": {"reputation": 366, "user_id": 3445357, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/854395133/picture?type=large", "display_name": "Stian St&#248;rstfeskar Andersen", "link": "https://stackoverflow.com/users/3445357/stian-st%c3%b8rstfeskar-andersen"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1537896209, "post_id": 52388861, "comment_id": 91947889, "body": "@Olly Do you have an example of this? Link or something, Cant find correct words in google."}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1537945602, "post_id": 52388861, "comment_id": 91963468, "body": "<a href=\"https://www.google.com/search?q=power+query+named+range\" rel=\"nofollow noreferrer\">google.com/search?q=power+query+named+range</a>"}], "owner": {"reputation": 366, "user_id": 3445357, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/854395133/picture?type=large", "display_name": "Stian St&#248;rstfeskar Andersen", "link": "https://stackoverflow.com/users/3445357/stian-st%c3%b8rstfeskar-andersen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593730421, "creation_date": 1537280913, "last_edit_date": 1593730421, "question_id": 52388861, "link": "https://stackoverflow.com/questions/52388861/importing-xls-sheet-with-custom-source-file", "title": "Importing xls sheet with custom source file", "body": "<p>Im trying to create a vba importing sheet from a different xls. I want the user of main xlsm to have access to change the location for the import file from a cell.(not editing the vba) </p>\n\n<p>I used the macro recorder to get this file and there is something in this code that is not working. I guess its something here: <code>(File.Contents( import_path ), null, true)</code></p>\n\n<pre><code>    'Source importfile\n    import_path = Sheets(\"dagsbud\").Range(\"q14\")\n\n    ActiveWorkbook.Queries.Add Name:=\"page\", Formula:= _\n        \"let\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    Kilde = Excel.Workbook(File.Contents( import_path ), null, true),\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    page_Sheet = Kilde{[Item=\"\"page\"\",Kind=\"\"Sheet\"\"]}[Data],\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Endret type\"\" = Table.TransformColumnTypes(page_Sheet,{{\"\"Column1\"\", Int64.Type}, {\"\"Column2\"\", type any}, {\"\"Column3\"\", type\" &amp; _\n        \" any}, {\"\"Column4\"\", type any}, {\"\"Column5\"\", type any}, {\"\"Column6\"\", type any}, {\"\"Column7\"\", type any}, {\"\"Column8\"\", type any}, {\"\"Column9\"\", type any}, {\"\"Column10\"\", type any}, {\"\"Column11\"\", type any}, {\"\"Column12\"\", type any}, {\"\"Column13\"\", type any}, {\"\"Column14\"\", type any}})\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"in\" &amp; Chr(13) &amp; \"\" &amp; Chr(10) &amp; \"    #\"\"Endret type\"\"\"\n    ActiveWorkbook.Worksheets.Add\n    With ActiveSheet.ListObjects.Add(SourceType:=0, Source:= _\n        \"OLEDB;Provider=Microsoft.Mashup.OleDb.1;Data Source=$Workbook$;Location=page;Extended Properties=\"\"\"\"\" _\n        , Destination:=Range(\"$A$1\")).QueryTable\n        .CommandType = xlCmdSql\n        .CommandText = Array(\"SELECT * FROM [page]\")\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .BackgroundQuery = True\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .PreserveColumnInfo = True\n        .ListObject.DisplayName = \"page\"\n        .Refresh BackgroundQuery:=False\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1537280915, "post_id": 52388691, "comment_id": 91722491, "body": "Possible duplicate - Review <a href=\"https://stackoverflow.com/questions/44433888/excel-vba-loop-over-files-in-folder-copy-range-paste-in-this-workbook\">this SO question</a>"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 1, "creation_date": 1537281538, "post_id": 52388691, "comment_id": 91722958, "body": "You can&#39;t avoid naming it - your macro needs to know what file to process. Or would you be fine with your macro just going to a random workbook and processing it? How could you tell it did the right thing afterwards? How would you even know what file it processed, if you don&#39;t tell it? The only option you have is to come up with a way to reliably <i>generate</i> the correct file name. (Or have the user select the file in question each time the macro is run.)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 3, "creation_date": 1537281589, "post_id": 52388691, "comment_id": 91722994, "body": "You can use a file dialog and pick which files to import"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1537281935, "post_id": 52388691, "comment_id": 91723234, "body": "Who&#39;s opening the file? The user? Or the macro? Make it be the macro, that way you&#39;ll have a reference to the <code>Workbook</code> object, without needing to care for its name."}, {"owner": {"reputation": 13, "user_id": 9870990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a055d8e38d74582d8f165b0b1a103e?s=128&d=identicon&r=PG&f=1", "display_name": "adzad", "link": "https://stackoverflow.com/users/9870990/adzad"}, "reply_to_user": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1537283409, "post_id": 52388691, "comment_id": 91724199, "body": "@Inarion I was thinking that maybe I can run a macro that can complete the same task regardless of which workbook I have open since I need to copy the same columns each time into the master workbook."}, {"owner": {"reputation": 13, "user_id": 9870990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a055d8e38d74582d8f165b0b1a103e?s=128&d=identicon&r=PG&f=1", "display_name": "adzad", "link": "https://stackoverflow.com/users/9870990/adzad"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1537283481, "post_id": 52388691, "comment_id": 91724248, "body": "@MathieuGuindon how would i go about referencing the workbook object in my code? any reference questions you can lead me to? Thx!"}, {"owner": {"reputation": 558, "user_id": 7778672, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/2LGnC.jpg?s=128&g=1", "display_name": "Inarion", "link": "https://stackoverflow.com/users/7778672/inarion"}, "edited": false, "score": 0, "creation_date": 1537284396, "post_id": 52388691, "comment_id": 91724844, "body": "This would be the <code>ActiveWorkbook</code> object then. I wasn&#39;t aware you&#39;d open them one by one and then execute the macro. In this case, it&#39;s actually possible to not have to name it explicitly, due to the implicit reference Excel provides to it."}], "answers": [{"tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": false, "score": 1, "last_activity_date": 1537283384, "creation_date": 1537283384, "answer_id": 52389677, "question_id": 52388691, "link": "https://stackoverflow.com/questions/52388691/how-do-i-copy-a-range-from-one-workbook-to-another-in-excel-without-having-to-na/52389677#52389677", "title": "How do I copy a range from one workbook to another in excel WITHOUT having to name it in VBA?", "body": "<p>Here's two solutions.  One to scan an Directory for files, and the other to select files. I see they've both been suggested in the comments already.  :p</p>\n\n<pre><code>Sub Test()\n    ' If you want to scan an \"unprocessed files\" directory\n    'Call ScanDir(\"C:\\Test\\\")\n\n    ' If you want to select files to process\n    Call SelectFiles\nEnd Sub\n\nPrivate Sub ScanDir(ByVal DirPath As String)\n    Dim oCurFile As String\n    oCurFile = Dir(DirPath)\n    Do While oCurFile &lt;&gt; \"\"\n        ' Add the work to the file here\n        ' Filename: DirPath &amp; oCurFile\n\n        oCurFile = Dir()\n    Loop\nEnd Sub\n\nPrivate Sub SelectFiles()\n    Dim oFileDialog As FileDialog\n    Set oFileDialog = Application.FileDialog(msoFileDialogFilePicker)\n    oFileDialog.AllowMultiSelect = True\n\n    If oFileDialog.Show = -1 Then\n        Dim oFile As Variant\n\n        For Each oFile In oFileDialog.SelectedItems\n            ' Add the work to the file here\n            ' Filename: oFile\n        Next\n    End If\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1156, "user_id": 10315836, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hZjRU.png?s=128&g=1", "display_name": "Valon Miller", "link": "https://stackoverflow.com/users/10315836/valon-miller"}, "is_accepted": false, "score": 0, "last_activity_date": 1537283713, "creation_date": 1537283713, "answer_id": 52389776, "question_id": 52388691, "link": "https://stackoverflow.com/questions/52388691/how-do-i-copy-a-range-from-one-workbook-to-another-in-excel-without-having-to-na/52389776#52389776", "title": "How do I copy a range from one workbook to another in excel WITHOUT having to name it in VBA?", "body": "<p>This will do it, you just need to supply the sheet name and ranges where noted:</p>\n\n<pre><code>Sub copyRange()\n\n    'File system variables\n    Dim objFSO As Object\n    Dim objFolder As Object\n    Dim objFile As Object\n    Dim myDir As String\n    Dim Mask As String\n\n    'Workbook variables\n    Dim wb As Workbook\n    Dim sh As Worksheet\n\n    myDir = \"C:\\Users\\Guest\\Desktop\" 'Insert the path where your incoming files are stored.\n\n    Mask = \"*.xl??\" 'This makes it so it only looks at Excel files.\n\n    Set objFSO = CreateObject(\"Scripting.FileSystemObject\")\n    Set objFolder = objFSO.getFolder(myDir)\n\n    For Each objFile In objFolder.Files\n\n        If LCase(objFile.Name) Like LCase(Mask) Then\n\n            Set wb = Workbooks.Open(myDir &amp; \"\\\" &amp; objFile.Name, , True) 'This is set to open in read only, to avoid issues with the file already being open\n\n            'The ranges you are copying/pasting are vague, supply the sheet names and ranges below\n\n            'Get Copy range with dynamic number of rows.\n            With wb.Sheets(\"Sheet1\").Range(\"A2:B2\") '&lt;---- Specify Sheet/Range\n                Set copyRange = .Resize(.End(xlDown).Row, 2)\n            End With\n\n            'Get next available row in paste range.\n            With ThisWorkbook.Sheets(\"Sheet1\").Range(\"G:H\") '&lt;---- Specify Sheet/Range\n                Set pasteRange = .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0)\n            End With\n\n            copyRange.Copy pasteRange\n\n            wb.Close False\n\n        End If\n\n    Next objFile\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15966, "user_id": 4677305, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/3S4Yq.jpg?s=128&g=1", "display_name": "Darren Bartrup-Cook", "link": "https://stackoverflow.com/users/4677305/darren-bartrup-cook"}, "is_accepted": true, "score": 0, "last_activity_date": 1537284000, "creation_date": 1537284000, "answer_id": 52389861, "question_id": 52388691, "link": "https://stackoverflow.com/questions/52388691/how-do-i-copy-a-range-from-one-workbook-to-another-in-excel-without-having-to-na/52389861#52389861", "title": "How do I copy a range from one workbook to another in excel WITHOUT having to name it in VBA?", "body": "<p>By the looks of it you have all the workbooks open when you run the code - there are ways to have the code open each workbook in a certain folder, or ask the user to select them.<br>\n  While writing this other answers have given the code for selecting files from folders.</p>\n\n<p>Each workbook in the Excel Application is held in a collection of workbooks.  The good thing about collections is you can step through them without know the specifics before you get there.  </p>\n\n<p>The code below will print the name of each workbook you have open into the immediate window.  Note - these are in the same instance of Excel.  If you open Excel a second time then any workbooks in that application will be in a different collection.<br>\nYou don't <em>really</em> need the <code>Application</code> but I left it in to make things a bit clearer.  </p>\n\n<pre><code>Sub Test()\n\n    Dim bk As Workbook\n\n    For Each bk In Application.Workbooks\n        Debug.Print bk.Name\n    Next bk\n\nEnd Sub  \n</code></pre>\n\n<p>This is the full code - note that nothing is <code>Select</code>ed.  </p>\n\n<pre><code>Sub Test()\n\n    Dim bk As Workbook\n    Dim Master As Workbook\n    Dim LastCell As Range\n\n    Set Master = Workbooks(\"Master Sheet.xlsm\")\n\n    For Each bk In Application.Workbooks\n        'Checks the middle part of the file name - should be a number.\n        'Better ways to check the file name are available.\n        If IsNumeric(Mid(bk.Name, 3, 8)) Then\n\n            'Copy date from Sheet1.  It's assumed each row in\n            'column B is populated and figures out the last cell from there.\n            With bk.Worksheets(\"Sheet1\")\n                Set LastCell = .Cells(.Rows.Count, 2).End(xlUp)\n                .Range(\"A1\", LastCell).Copy\n            End With\n\n            'Pastes the results to Sheet1 in the Master workbook.\n            'The last cell containing data in column A is found and\n            'then offset by 1 row.\n            With Master.Worksheets(\"Sheet1\")\n                .Range(\"A\" &amp; .Rows.Count).End(xlUp).Offset(1).PasteSpecial Paste:=xlPasteValues\n            End With\n\n        End If\n    Next bk\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9870990, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67a055d8e38d74582d8f165b0b1a103e?s=128&d=identicon&r=PG&f=1", "display_name": "adzad", "link": "https://stackoverflow.com/users/9870990/adzad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 52389861, "answer_count": 3, "score": 1, "last_activity_date": 1537284000, "creation_date": 1537280408, "last_edit_date": 1537281801, "question_id": 52388691, "link": "https://stackoverflow.com/questions/52388691/how-do-i-copy-a-range-from-one-workbook-to-another-in-excel-without-having-to-na", "title": "How do I copy a range from one workbook to another in excel WITHOUT having to name it in VBA?", "body": "<p>I'm looking for assistance regarding how to write a VBA command that allows me to copy a range of cells from different workbooks onto one master sheet. Let me explain further.</p>\n\n<p>Everyday I receive a new excel document from my clients named based on the date it was uploaded ie. September 18, 2018 file would be called A20180918.</p>\n\n<p>Once i've received a week's worth of excel files (A20180918-A20180921), I then have to copy certain information from the original uploaded file to a master tracking sheet.</p>\n\n<p>So, my hurdle is such that each time I record my actions into a macro, the code includes the file name which then creates a subscript error when it's run on the next day's file.</p>\n\n<p>So here's an example below of the code I have this far:</p>\n\n<pre><code>Sub CopyRange()\n\nCopyRange Macro\n\n'This is the line of the code that's causing problems given it's a specified workbook name \n'and when I try to open tomorrow's workbook i'll run into the subscript error.\nWindows(\"A20180914.xls\").Activate\n\nRange(\"A2:B2\").Select\nRange(Selection, Selection.End(xlDown)).Select\nSelection.Copy\nWindows(\"Master Sheet.xlsm\").Activate\nSelection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n    :=False, Transpose:=False\nEnd Sub\n</code></pre>\n\n<p>Thank you!</p>\n"}]