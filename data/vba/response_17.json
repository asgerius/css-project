[{"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 520, "user_id": 2253067, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zQzsZ.jpg?s=128&g=1", "display_name": "Martin F", "link": "https://stackoverflow.com/users/2253067/martin-f"}, "edited": false, "score": 1, "creation_date": 1431038595, "post_id": 30089615, "comment_id": 48336679, "body": "Worked on first attempt! Maybe you want to edit <i>this</i> into your answer: <code>Me.Loc_cbo.Value = DLookup(&quot;ID&quot;, &quot;Sites&quot;, &quot;Loc= &#39;&quot; &amp; Me.Loc_txt.Value &amp; &quot;&#39;&quot;)</code>"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 520, "user_id": 2253067, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zQzsZ.jpg?s=128&g=1", "display_name": "Martin F", "link": "https://stackoverflow.com/users/2253067/martin-f"}, "edited": false, "score": 0, "creation_date": 1431039313, "post_id": 30089615, "comment_id": 48336938, "body": "Well done, Sir!  Please feel free to edit my description if you can make it easier to understand."}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1431039499, "last_edit_date": 1431039499, "creation_date": 1430956361, "answer_id": 30089615, "question_id": 30089248, "link": "https://stackoverflow.com/questions/30089248/synchronizing-record-navigation-control-and-record-selection-combo-box/30089615#30089615", "title": "Synchronizing record navigation control and record selection combo box", "body": "<p>Assign to the combo's <code>.Value</code> property to change its selection.  For <code>.Value</code>, you don't need to <code>SetFocus</code>.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Current()\n    Me.Loc_cbo.Value = Me.Loc_txt.Value\nEnd Sub\n</code></pre>\n\n<p>Note this suggestion assumes the combo's <code>.Value</code> is what you want to match to  the text box value.  Check to confirm you want the match between the combo and text box to be based on the combo's <code>.Value</code> instead of another of the combo's columns.</p>\n\n<p><strong>Post mortem</strong>:</p>\n\n<p>The content of the text box was intended to match one of the combo's columns.  However, since the combo's <em>Bound Column</em> contains numbers associated with that other column, Martin used a <code>DLookup</code> expression to fetch the number which corresponds to the text box content and assigned that number to the combo's <code>.Value</code> property:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Me.Loc_cbo.Value = DLookup(\"ID\", \"Sites\", \"Loc= '\" &amp; Me.Loc_txt.Value &amp; \"'\")\n</code></pre>\n\n<p>Note a combo's <code>.Value</code> is the value in the <em>Bound Column</em> of its selected row.</p>\n"}], "owner": {"reputation": 520, "user_id": 2253067, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zQzsZ.jpg?s=128&g=1", "display_name": "Martin F", "link": "https://stackoverflow.com/users/2253067/martin-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1329, "favorite_count": 0, "accepted_answer_id": 30089615, "answer_count": 1, "score": 2, "last_activity_date": 1431039499, "creation_date": 1430954066, "last_edit_date": 1431031657, "question_id": 30089248, "link": "https://stackoverflow.com/questions/30089248/synchronizing-record-navigation-control-and-record-selection-combo-box", "title": "Synchronizing record navigation control and record selection combo box", "body": "<p>I have a form bound to a query, with controls bound to fields of the query.\nI also have an unbound combobox, whose <code>Row Source</code> is the same query, used to select the current form record via its <code>After Update</code> event handler:</p>\n\n<pre><code>Private Sub Loc_cbo_AfterUpdate()\n    DoCmd.SearchForRecord , \"\", acFirst, \"ID = \" &amp; Str(Nz(Loc_cbo, 0))\nEnd Sub\n</code></pre>\n\n<p>The combobox has three columns: </p>\n\n<ol>\n<li>the <code>Bound Column</code>, an invisible ID, </li>\n<li>a location code, </li>\n<li>a location name. </li>\n</ol>\n\n<p>The combo's <code>Row Source</code> is <code>SELECT * FROM Sites ORDER BY Loc DESC</code>. (Originally, it was just <code>Sites</code> but since I have the form's <code>Order By</code> as <code>Site.Loc DESC</code>, I wanted the order to match.)</p>\n\n<p>It works fine.\nOf course, I can <em>also</em> navigate through the form\u2019s records via its navigation control (First, Previous, Next, Last).\nThat, too, works.\nHowever, I\u2019d like the combobox to be synchronized with the current record as it changes via the navigation control.</p>\n\n<p>I\u2019ve tried to do it via the form\u2019s <code>Current</code> event handler, three different ways.\nFirst, to set the combobox\u2019s Text value to match that of the corresponding textbox control</p>\n\n<pre><code>Private Sub Form_Current()\n    Loc_cbo.SetFocus\n    Loc_cbo.Text = Loc_txt \u2018 ERROR\nEnd Sub\n</code></pre>\n\n<p>but I get</p>\n\n<blockquote>\n  <p>Run-time error \u20182101\u2019: The setting you entered isn\u2019t valid for this\n  property.</p>\n</blockquote>\n\n<p>Second, to set the combobox\u2019s ListIndex value relative to the current record</p>\n\n<pre><code>Private Sub Form_Current()\n    Loc_cbo.SetFocus\n    Loc_cbo.ListIndex = CurrentRecord - 1 \u2018 ERROR\nEnd Sub\n</code></pre>\n\n<p>but I get either the same Run-time error \u20182101\u2019 or </p>\n\n<blockquote>\n  <p>Run-time error \u20187777\u2019: You\u2019ve used the ListIndex property incorrectly.</p>\n</blockquote>\n\n<p>in the same place.</p>\n\n<p>Third, (thanks to HansUp's early answer) to set the combobox\u2019s Value property:</p>\n\n<pre><code>Private Sub Form_Current()\n    Loc_cbo.Value = Loc_txt.Value \nEnd Sub\n</code></pre>\n\n<p>This \"works\" in so far as there is no error message and, according to debug.prints, the value of <code>Loc_cbo</code> does change to match that of <code>Loc_txt</code>. However, the visible textbox-like portion of the combobox now appears to be empty/blank (nothing in it) always. </p>\n\n<p>How can I get the record selector combobox to agree with the current record when the latter has been changed via the record navigator? \nI cannot believe users will be happy having the two out of synch.\nI also cannot believe I haven't found this problem described anywhere else!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 1, "last_activity_date": 1430953712, "creation_date": 1430953712, "answer_id": 30089188, "question_id": 30089114, "link": "https://stackoverflow.com/questions/30089114/concatenate-variable-in-printarea/30089188#30089188", "title": "Concatenate variable in PrintArea", "body": "<p>Only include the range of cells; do not include the sheet name. For example: </p>\n\n<pre><code>ActiveSheet.PageSetup.PrintArea = \"A14:O\" &amp; numCountRows \n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 2920339, "user_type": "registered", "accept_rate": 56, "profile_image": "https://graph.facebook.com/561485725/picture?type=large", "display_name": "exceldude2001", "link": "https://stackoverflow.com/users/2920339/exceldude2001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 30089188, "answer_count": 1, "score": 0, "last_activity_date": 1430955304, "creation_date": 1430953215, "last_edit_date": 1531164843, "question_id": 30089114, "link": "https://stackoverflow.com/questions/30089114/concatenate-variable-in-printarea", "title": "Concatenate variable in PrintArea", "body": "<p>This should be really simple.  But having difficulty.  I created a variable call <code>numCountRows</code>, which will count number of rows in a range and then adds 13.  I tried the following line of code, but this results in run-time error 1004. The text you entered is not a valid reference or defined name.</p>\n\n<pre><code>ActiveSheet.PageSetup.PrintArea = \"ActiveSheet.Range(\"\"\" &amp; \"A14:O\" &amp; numCountRows &amp; \")\"\n</code></pre>\n\n<p>If <code>numCountRows = 1</code>, the line of code would read like this:</p>\n\n<pre><code>ActiveSheet.PageSetup.PrintArea = ActiveSheet.Range(\"A14:O14\")\n</code></pre>\n\n<p>What I am doing wrong?</p>\n"}, {"tags": ["excel", "increment", "next", "vba"], "answers": [{"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 0, "last_activity_date": 1430953642, "creation_date": 1430953642, "answer_id": 30089178, "question_id": 30089037, "link": "https://stackoverflow.com/questions/30089037/looping-code-while-changing-row-reference-incrementally/30089178#30089178", "title": "Looping code while changing row reference incrementally", "body": "<p>If I understand correctly what you are after, there isn't any need to loop through cells - <code>Target</code> will always be the cell that changed.  All you should need is a simple test to see if the adjacent cell matches:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n    Dim matching As Boolean\n\n    If Target.Column = 4 Then\n        matching = (Target.Value = Target.Offset(0, 1).Value)\n    ElseIf Target.Column = 5 Then\n        matching = (Target.Value = Target.Offset(0, -1).Value)\n    End If\n\n    If matching Then\n         Application.EnableEvents = False\n         Target.ClearContents\n         Application.EnableEvents = True\n         MsgBox \"Only one entry allowed. Please select either Blanket or User Specific.\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>If you need to limit it to specific rows, just wrap the whole thing in another If that tests to see if <code>Target.Row</code> is one you care about. </p>\n"}], "owner": {"reputation": 21, "user_id": 4854686, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e2b4cc697c0c25a8c8a25e5246d753?s=128&d=identicon&r=PG&f=1", "display_name": "Felicia", "link": "https://stackoverflow.com/users/4854686/felicia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1430954158, "creation_date": 1430952731, "last_edit_date": 1531164843, "question_id": 30089037, "link": "https://stackoverflow.com/questions/30089037/looping-code-while-changing-row-reference-incrementally", "title": "Looping code while changing row reference incrementally", "body": "<p>I have a spreadsheet where I want 2 adjacent cells to be exclusive, meaning you can only enter a value in one of the 2 cells. I got the code to work properly when reference a specific cell range.</p>\n\n<p>However i have this logic repeating every 4 rows within the spreadsheet. I tried to create an integer value to incrementally increase the row reference but the action with message box are not being applied to the \"next\" integer.</p>\n\n<p>Any help would be appreciate. below is what i tried with declaring J as my row reference via integer data type. Right now i have j set to 34-146. If i put an \"x\" in D34 and then put an \"X\" in E34 i get the message and the value entered in E34 is cleared- which is what i want. When i do the same in D38 and E38, i do not get any message and the data entry remains in both cells.</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\n  Dim j As Integer\n  For j = 34 To 146 Step 4\n\n  Dim rLook As Range\n  Set rLook = Range(\"D\" &amp; j &amp; \":E\" &amp; j)\n  Dim wf As WorksheetFunction\n  Set wf = Application.WorksheetFunction\n\n  If Intersect(Target, rLook) Is Nothing Then Exit Sub\n\n  If wf.CountA(rLook) &lt; 2 Then Exit Sub\n\n  Application.EnableEvents = False\n    Target.ClearContents\n    MsgBox (\"Only one entry allowed. Please select either Blanket or User Specific.\")\n\n  Application.EnableEvents = True\n\n  Next j\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["arrays", "excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 4746657, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fcc3db2e9a8206813d5ff622e5d8c7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Ortiz", "link": "https://stackoverflow.com/users/4746657/miguel-ortiz"}, "edited": false, "score": 0, "creation_date": 1431003865, "post_id": 30089314, "comment_id": 48315119, "body": "Of course! How could I miss that? ;) - Thank you for your help, and for the added advice on option explicit and declaring I as a variable."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1430954517, "creation_date": 1430954517, "answer_id": 30089314, "question_id": 30088661, "link": "https://stackoverflow.com/questions/30088661/how-can-i-convert-multi-dimensional-array-into-a-date-variableand-use-month-func/30089314#30089314", "title": "How can I convert multi-dimensional array into a date variableand use month function?", "body": "<p>The fact that <code>month</code> isn't capitalized is a dead give-away.  You have a naming collision between your input parameter and the VBA function name. </p>\n\n<p>Either change your parameter name:</p>\n\n<pre><code>Function sumByAcct(monthNum As Integer, acct As String) As Long\n</code></pre>\n\n<p>Or explicitly reference the Month function:</p>\n\n<pre><code>func_month = VBA.Month(CDate(func_date))\n</code></pre>\n\n<p>You should probably also toss an <code>Option Explicit</code> at the top of your module and then follow up with <code>Dim i As Long</code>.</p>\n\n<p>The line <code>func_date = CDate((array_data(i, 1)))</code> is fine assuming that all of the values it finds in column A are dates.  I'd either check the data itself or test the value before trying to cast it.</p>\n"}], "owner": {"reputation": 87, "user_id": 4746657, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/fcc3db2e9a8206813d5ff622e5d8c7c1?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel Ortiz", "link": "https://stackoverflow.com/users/4746657/miguel-ortiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 30089314, "answer_count": 1, "score": 1, "last_activity_date": 1430954517, "creation_date": 1430950740, "last_edit_date": 1531164843, "question_id": 30088661, "link": "https://stackoverflow.com/questions/30088661/how-can-i-convert-multi-dimensional-array-into-a-date-variableand-use-month-func", "title": "How can I convert multi-dimensional array into a date variableand use month function?", "body": "<p>I have included in my comments where the program fails. Your help would be greatly appreciated! Thank you!</p>\n\n<pre><code>Function sumByAcct(month As Integer, acct As String) As Long\n    Dim array_length As Integer\n\n    array_length = Application.WorksheetFunction.Count(Sheets(\"Transactions\").Range(\"A:A\")) + 1\n\n    ReDim array_data(array_length, 3) As Variant\n    For i = 0 To (array_length)\n        array_data(i, 1) = Sheets(\"Transactions\").Range(\"A\" &amp; i + 2) '=&gt; Dates\n        array_data(i, 2) = Sheets(\"Transactions\").Range(\"E\" &amp; i + 2) '=&gt; Amounts\n        array_data(i, 3) = Sheets(\"Transactions\").Range(\"H\" &amp; i + 2) '=&gt; Bank Account\n\n        Dim func_date As Date\n        Dim func_month As Integer\n        func_date = CDate((array_data(i, 1))) 'program doesn't run this code\n        func_month = month(CDate(func_date)) 'program doesn't run this code\n\n        MsgBox (func_date)\n    Next\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "formula", "dax", "udf"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 0, "creation_date": 1430949997, "post_id": 30088243, "comment_id": 48290051, "body": "I got your point but not entirely. A sample data with expected results depending on your scenarios would be of great help."}], "answers": [{"tags": [], "owner": {"reputation": 106, "user_id": 4414902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e011ee95fb7b7d9f7629fedd735db62e?s=128&d=identicon&r=PG", "display_name": "David Hager", "link": "https://stackoverflow.com/users/4414902/david-hager"}, "is_accepted": false, "score": 0, "last_activity_date": 1430968495, "last_edit_date": 1430968495, "creation_date": 1430958639, "answer_id": 30089930, "question_id": 30088243, "link": "https://stackoverflow.com/questions/30088243/creating-an-excel-master-formula/30089930#30089930", "title": "Creating an Excel &quot;master formula&quot;", "body": "<p>Use the CHOOSE function to change your definition. A simple number will toggle your defined name formulas. See <a href=\"http://j-walk.com/ss/excel/eee/eee002.txt\" rel=\"nofollow\">http://j-walk.com/ss/excel/eee/eee002.txt</a> for an example.</p>\n"}, {"tags": [], "owner": {"reputation": 5277, "user_id": 156648, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dc62782d79a90b829e96f36f48fe164?s=128&d=identicon&r=PG", "display_name": "guitarthrower", "link": "https://stackoverflow.com/users/156648/guitarthrower"}, "is_accepted": false, "score": 0, "last_activity_date": 1431099859, "creation_date": 1431099859, "answer_id": 30127814, "question_id": 30088243, "link": "https://stackoverflow.com/questions/30088243/creating-an-excel-master-formula/30127814#30127814", "title": "Creating an Excel &quot;master formula&quot;", "body": "<p>You could create a single sheet that performs all the calculations. Then you can provide a drop-down allowing the user to choose the metric they wish to seek, and use a formula to lookup the result of that metric on the calculation sheet.</p>\n"}], "owner": {"reputation": 21, "user_id": 3516026, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/845b21755b38d92d8df624701c8ddd36?s=128&d=identicon&r=PG&f=1", "display_name": "user3516026", "link": "https://stackoverflow.com/users/3516026/user3516026"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 336, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1431099859, "creation_date": 1430948968, "question_id": 30088243, "link": "https://stackoverflow.com/questions/30088243/creating-an-excel-master-formula", "title": "Creating an Excel &quot;master formula&quot;", "body": "<p>We have certain key metrics we would like to calculate on over 100 data entry forms. The metric calculations change from time to time. We would like to define one way to calculate the metric and have all data entry forms use that single definition. eg. Metric was QuarterlyExp/QuarterlySales =M5/M6, changed to Last4QuartersExp/Last4QuartersSales =SUM(J5:M5)/SUM(J6:M6)</p>\n\n<p>I could use VBA User Defined Functions or PowerPivot DAX formulas, but my users would not be able to maintain these. Defined Names are on the edge of being acceptable, but it seems like the formulas would likely be worse than VBA!</p>\n\n<p>Any ideas on how I could give them \"one formula to rule them all\"? All data entry forms will have the same logical values in the same cell locations.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1430950158, "post_id": 30087851, "comment_id": 48290115, "body": "I am confused, where is your code?"}, {"owner": {"reputation": 859, "user_id": 1189757, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c97160cecb39f53ef283d032b0507e0a?s=128&d=identicon&r=PG", "display_name": "Yevgeniy", "link": "https://stackoverflow.com/users/1189757/yevgeniy"}, "reply_to_user": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1430952858, "post_id": 30087851, "comment_id": 48291122, "body": "There is no code. I am asking if such customization is possible. The VBA could be something like <a href=\"http://www.word.mvps.org/FAQs/InterDev/SendMail.htm\" rel=\"nofollow noreferrer\">word.mvps.org/FAQs/InterDev/SendMail.htm</a>, but how can I override the Send To Mail Recipient behavior?"}], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 1189757, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c97160cecb39f53ef283d032b0507e0a?s=128&d=identicon&r=PG", "display_name": "Yevgeniy", "link": "https://stackoverflow.com/users/1189757/yevgeniy"}, "edited": false, "score": 0, "creation_date": 1431005923, "post_id": 30089097, "comment_id": 48316788, "body": "Thanks. This isn&#39;t what I am referring to though. I&#39;m added screenshot of this in Word 2010."}], "tags": [], "owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "is_accepted": false, "score": 0, "last_activity_date": 1430953109, "creation_date": 1430953109, "answer_id": 30089097, "question_id": 30087851, "link": "https://stackoverflow.com/questions/30087851/microsoft-word-send-to-mail-recipient-custom-subject/30089097#30089097", "title": "Microsoft Word - Send to Mail Recipient - custom subject", "body": "<p>Assuming you are trying to manipulate the hyperlink on email addresses in Word, the only thing you can preset it is the <strong>Subject</strong>.</p>\n\n<p>Right click on the link in Word, click <strong>Edit Hyperlink...</strong>:<br>\n<img src=\"https://i.stack.imgur.com/oSkTq.png\" alt=\"Edit Hyperlink\"></p>\n\n<p>Then type in the customized email <strong>Subject</strong>:<br>\n<img src=\"https://i.stack.imgur.com/h0623.png\" alt=\"custom email subject\"></p>\n\n<p>Now with VBA, you can see the link is now including the subject. This means that you can use VBA to alter all the Hyperlinks.</p>\n\n<pre><code>?activedocument.Hyperlinks.Item(1).Address\nmailto:someone@there.com?subject=Customized%20Subject%20for%20the%20email\n</code></pre>\n\n<p>Note the spaces are now <code>%20</code>, so you may need another function to convert other non-alphabets.</p>\n\n<p>Hope this is what your Native means.</p>\n"}], "owner": {"reputation": 859, "user_id": 1189757, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c97160cecb39f53ef283d032b0507e0a?s=128&d=identicon&r=PG", "display_name": "Yevgeniy", "link": "https://stackoverflow.com/users/1189757/yevgeniy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 697, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1431005712, "creation_date": 1430947574, "last_edit_date": 1431005712, "question_id": 30087851, "link": "https://stackoverflow.com/questions/30087851/microsoft-word-send-to-mail-recipient-custom-subject", "title": "Microsoft Word - Send to Mail Recipient - custom subject", "body": "<p>I want to override the native Send To Mail Recipient behavior in MS Word 2007/2010 to customize the subject of the email message. Is this possible? I can write the VBA macro to replicate the functionality, but is it possible override/customize the native behavior?\n<img src=\"https://i.stack.imgur.com/bIpNA.png\" alt=\"Send To Mail Recipient\"></p>\n"}, {"tags": ["arrays", "excel", "vba", "worksheet"], "comments": [{"owner": {"reputation": 11552, "user_id": 2165759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YvdTT.jpg?s=128&g=1", "display_name": "omegastripes", "link": "https://stackoverflow.com/users/2165759/omegastripes"}, "edited": false, "score": 4, "creation_date": 1430947896, "post_id": 30087836, "comment_id": 48289025, "body": "Replace <code>ReDim ArraySheets(x)</code> with <code>ReDim Preserve ArraySheets(x)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 3746239, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/69e31576d7779c8f7cb6242c16eb5303?s=128&d=identicon&r=PG&f=1", "display_name": "NDubonix", "link": "https://stackoverflow.com/users/3746239/ndubonix"}, "edited": false, "score": 0, "creation_date": 1430948316, "post_id": 30087940, "comment_id": 48289229, "body": "Is there a way to put the array definition (ReDim Preserve ArraySheets(x)) outside of the For loop? When I place it outside of the loop, I get a &quot;Subscript out of range&quot; error."}], "tags": [], "owner": {"reputation": 4010, "user_id": 2570957, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/4FrAD.jpg?s=128&g=1", "display_name": "Soulfire", "link": "https://stackoverflow.com/users/2570957/soulfire"}, "is_accepted": true, "score": 6, "last_activity_date": 1430948275, "last_edit_date": 1430948275, "creation_date": 1430947882, "answer_id": 30087940, "question_id": 30087836, "link": "https://stackoverflow.com/questions/30087836/adding-sheet-names-to-array-in-excel-vba/30087940#30087940", "title": "Adding Sheet Names to Array in Excel VBA", "body": "<p>You should change <code>ReDim ArraySheets(x)</code> to <code>ReDim Preserve ArraySheets(x)</code></p>\n\n<p>When you use just <code>ReDim</code> the contents of the array are not kept, which is why you only get the final sheet name.  Using <code>ReDim Preserve</code> re-sizes the array while keeping the contents.</p>\n"}, {"tags": [], "owner": {"reputation": 52630, "user_id": 641067, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/n6xVq.png?s=128&g=1", "display_name": "brettdj", "link": "https://stackoverflow.com/users/641067/brettdj"}, "is_accepted": false, "score": 2, "last_activity_date": 1430986095, "creation_date": 1430986095, "answer_id": 30095294, "question_id": 30087836, "link": "https://stackoverflow.com/questions/30087836/adding-sheet-names-to-array-in-excel-vba/30095294#30095294", "title": "Adding Sheet Names to Array in Excel VBA", "body": "<p>Without loops</p>\n\n<pre><code>Sub GetNAmes()\nDim strIn As String\nDim X\n\nstrIn = Application.InputBox(\"Search string\", \"Enter string to find\", \"*List*\", , , , , 2)\nIf strIn = \"False\" Then Exit Sub\n\nActiveWorkbook.Names.Add \"shtNames\", \"=RIGHT(GET.WORKBOOK(1),LEN(GET.WORKBOOK(1))-FIND(\"\"]\"\",GET.WORKBOOK(1)))\"\nX = Filter([index(shtNames,)], strIn, True, 1)\n\nSelect Case UBound(X)\n    Case Is &gt; 0\n        strIn = Application.InputBox(Join(X, Chr(10)), \"Multiple matches found - type position to select\", , , , , 1)\n        If strIn = \"False\" Then Exit Sub\n        On Error Resume Next\n        Sheets(CStr(X(strIn))).Activate\n        On Error GoTo 0\n    Case 0\n        Sheets(X(0)).Activate\n    Case Else\n        MsgBox \"No match\"\nEnd Select\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 3746239, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/69e31576d7779c8f7cb6242c16eb5303?s=128&d=identicon&r=PG&f=1", "display_name": "NDubonix", "link": "https://stackoverflow.com/users/3746239/ndubonix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17187, "favorite_count": 1, "accepted_answer_id": 30087940, "answer_count": 2, "score": 2, "last_activity_date": 1430986095, "creation_date": 1430947539, "question_id": 30087836, "link": "https://stackoverflow.com/questions/30087836/adding-sheet-names-to-array-in-excel-vba", "title": "Adding Sheet Names to Array in Excel VBA", "body": "<p>I am trying to add sheet names into an array in Excel VBA using the code below. It is only picking up one value (always the last worksheet name). For example, if I have 2 sheets: List1 and List2, it only picks up List2 and shows a blank value for the first sheet. If I add 4, it only shows the 4th, and so on. I'm not sure why I'm getting blank values.</p>\n\n<pre><code>Dim curSheet As Worksheet\nDim ArraySheets() As String\nDim x As Variant\n\nFor Each curSheet In ActiveWorkbook.Worksheets\n\n    If curSheet.Name Like \"*List*\" Then\n\n        ReDim ArraySheets(x)\n\n        ArraySheets(x) = curSheet.Name\n\n        x = x + 1\n\n    End If\n\nNext curSheet\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4548240, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/080d090ef4d153a1f25c572cf9809ee2?s=128&d=identicon&r=PG&f=1", "display_name": "Freek v. wely", "link": "https://stackoverflow.com/users/4548240/freek-v-wely"}, "edited": false, "score": 0, "creation_date": 1430983687, "post_id": 30088720, "comment_id": 48301239, "body": "Thanks this is what I&#39;am looking for."}, {"owner": {"reputation": 101, "user_id": 4548240, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/080d090ef4d153a1f25c572cf9809ee2?s=128&d=identicon&r=PG&f=1", "display_name": "Freek v. wely", "link": "https://stackoverflow.com/users/4548240/freek-v-wely"}, "edited": false, "score": 0, "creation_date": 1430984210, "post_id": 30088720, "comment_id": 48301566, "body": "Is it also possible to make a macro for switching the color of a shape between RGB(255, 0, 0) and RGB(0, 176, 80)?"}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 0, "last_activity_date": 1430951400, "last_edit_date": 1430951400, "creation_date": 1430950954, "answer_id": 30088720, "question_id": 30087381, "link": "https://stackoverflow.com/questions/30087381/change-color-shape-with-a-macro/30088720#30088720", "title": "Change color shape with a macro", "body": "<p>Try this:</p>\n\n<pre><code>Dim wsh As Worksheet: Set wsh = ActiveSheet\nDim shp As Shape: Set shp = wsh.Shapes(\"Rectangle 20\")\n\nWith shp.Fill\n    .Visible = Not .Visible ' Toggle fill on/off\n    .ForeColor.RGB = RGB(255, 0, 0) ' Set the color\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 101, "user_id": 4548240, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/080d090ef4d153a1f25c572cf9809ee2?s=128&d=identicon&r=PG&f=1", "display_name": "Freek v. wely", "link": "https://stackoverflow.com/users/4548240/freek-v-wely"}, "is_accepted": false, "score": 1, "last_activity_date": 1431038468, "last_edit_date": 1431038468, "creation_date": 1430985555, "answer_id": 30095122, "question_id": 30087381, "link": "https://stackoverflow.com/questions/30087381/change-color-shape-with-a-macro/30095122#30095122", "title": "Change color shape with a macro", "body": "<pre><code>Sub ToggleMe2Colors()\n    Dim sShape As Shape\n    Set sShape = ActiveSheet.Shapes(Application.Caller)\n\n    With sShape.Fill\n        If .ForeColor.RGB = RGB(255, 0, 0) = True Then\n            .ForeColor.RGB = RGB(0, 176, 80)\n        Else\n            .Visible = True\n            .ForeColor.RGB = RGB(255, 0, 0)\n        End If\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4548240, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/080d090ef4d153a1f25c572cf9809ee2?s=128&d=identicon&r=PG&f=1", "display_name": "Freek v. wely", "link": "https://stackoverflow.com/users/4548240/freek-v-wely"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10737, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1431038468, "creation_date": 1430945857, "last_edit_date": 1531164843, "question_id": 30087381, "link": "https://stackoverflow.com/questions/30087381/change-color-shape-with-a-macro", "title": "Change color shape with a macro", "body": "<p>I want change the color of a shape with a macro.</p>\n\n<pre><code>ActiveSheet.Shapes.Range(Array(\"Rectangle 20\")).Select\nIf Selection.ShapeRange.Fill.Visible = msoFalse Then\n    Selection.ShapeRange.Fill.Visible = msoTrue\n    Selection.ShapeRange.Fill.ForeColor.RGB = RGB(255, 0, 0)\n    Selection.ShapeRange.Fill.Transparency = 0\n    Selection.ShapeRange.Fill.Solid\nElse: Selection.ShapeRange.Fill.Visible = msoTrue\nSelection.ShapeRange.Fill.Visible = msoFalse\nEnd If\n\nIf Selection.ShapeRange.Fill.Visible = msoTrue Then\nSelection.ShapeRange.Fill.Visible = msoFalse\nElse: Selection.ShapeRange.Fill.Visible = msoFalse\n    Selection.ShapeRange.Fill.Visible = msoTrue\n    Selection.ShapeRange.Fill.ForeColor.RGB = RGB(255, 0, 0)\n    Selection.ShapeRange.Fill.Transparency = 0\n    Selection.ShapeRange.Fill.Solid\nEnd If\n</code></pre>\n\n<p>Now I want when there is no filling that it gets red and when the filling is red it get no filling.\nCan someone help me?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1430946289, "post_id": 30086908, "comment_id": 48288252, "body": "Many employers block DropBox.  You need to post relevant code in your question."}, {"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 0, "creation_date": 1430975433, "post_id": 30086908, "comment_id": 48297343, "body": "Please don&#39;t use Excel in this way, use a <code>UserForm</code> instead of a sheet ;)."}, {"owner": {"reputation": 31, "user_id": 4872135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1974efd0f2c36d29d5306651417decaa?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh598", "link": "https://stackoverflow.com/users/4872135/leigh598"}, "edited": false, "score": 0, "creation_date": 1431007762, "post_id": 30086908, "comment_id": 48318353, "body": "I can try and post a screen shot but I&#39;m not sure what you mean by relevant code.  I do not know what a UserForm is. I asked my boss what he wanted me to create this in and he specifically said Excel."}], "answers": [{"tags": [], "owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "is_accepted": false, "score": 0, "last_activity_date": 1435869619, "creation_date": 1435869619, "answer_id": 31194252, "question_id": 30086908, "link": "https://stackoverflow.com/questions/30086908/locking-cells-based-on-criteria-in-other-cells/31194252#31194252", "title": "Locking cells based on criteria in other cells", "body": "<p>For reference, a UserForm is a form that VBA can open that works sort of like a lite version of an application. An example of something that is a UserForm (under the covers) is any error prompt that Excel has ever shown you. You can create your own in Excel from the Visual Studio for Applications window.</p>\n\n<p>Before getting to how to do what you're wanting, you mention that you want Column C to be a drop-down that allows user entered values. Excel worksheets do not allow this. It's either a drop down or a user entered value, it can't be both. Given that the list of options might not be sufficient in some cases, you should just make it a user entered cell (i.e. no drop down choices) and then validate the values entered in your macro.</p>\n\n<p>You can use straight macros to do what you are wanting, and given your comment about the variability of what the VBA code should be doing, I'm going to be the heretic and say that's probably the more maintainable approach.</p>\n\n<p>To make this work you'll need to edit the worksheet code to add an event handler, specifically <code>Worksheet_Change</code></p>\n\n<p>From there you should check that the cell that changed was a cell that should cause the macro to run. Based on the details in your question, you'll want to look for cells in Columns B &amp; C, like so</p>\n\n<pre><code>IF LEFT(Target.Address, 3) = \"$B$\" OR LEFT(Target.Address, 3) = \"$C$\" THEN\n</code></pre>\n\n<p>At that point it probably makes sense to just call a different function that actually does the heavy lifting and pass it the row number. Example:</p>\n\n<pre><code>FormatMgmt(RIGHT(Target.Address, LEN(TARGET.Address) - 3), ActiveSheet.Name)\n</code></pre>\n\n<p>Then to give you an example to work off that should give you an idea of how to do all the things you listed</p>\n\n<pre><code>Sub FormatMgmt(rn as long, WSName as String)\n    '\n    Dim ws As Worksheet\n    Set ws = ThisWorkbook.Worksheets(ActiveSheet.Name)\n    Dim CC As Range\n    Set CC = ws.Range(\"C\" &amp; rn) 'I'm using a variable to refer to column C since we'll\n        'need to use this cell quite a bit\n\n    Application.ScreenUpdating 'Prevent Excel from updating what's displayed on your\n        'computer monitor. This lets the macro run faster\n\n    'Determine what's in Column B for the identified row\n    Select Case LCase(ws.Range(\"B\" &amp; rn).Value) 'LCase forces all text to lower case, so\n        'that capitalization doesn't mess up the comparison\n        Case \"single source\"\n            'Protect Columns E-H &amp; P-R\n            ws.Unprotect (\"&lt;whatever_your_password_is&gt;\") 'The password is optional, but\n                'you need to unlock the sheet to change whether cells are protected\n\n            ws.Range(\"E\" &amp; rn &amp; \":H\" &amp; rn).Locked = True\n\n            'Check if column F needs locked. Note, you said if &lt;=50k OR &lt;=100k selected\n            'should do this. Since I'm assuming a user entered value, I have to take the\n            'tigher constraint\n            If CC.Value &lt;= 50000 Then\n                'Lock column F.\n                ws.Range(\"F\" &amp; rn).Locked = True\n            End If\n\n            'Check if L3, L4, L5, A3, A4, or A5 need locked. Note: you're last bullet\n            'says A2 &amp; L2 should never be locked, which contradicts the bullet\n            'immediately prior. I assumed the later bullet took precedence. Also, I\n            'assumed the conditions in the last 5 bullets stacked (i.e. CC &lt; $500k means\n            'A3-A5 &amp; L3-5 should be locked)\n            If CC.Value &lt; 2000000 Then\n                ws.Range(\"L5\").Locked = True\n                ws.Range(\"A5\").Locked = True\n            End If\n\n            If CC.Value &lt; 1000000 Then\n            '...\n            'Fill in the rest of the code here. You should have enough to start\n            '...\n            'NOTE: Be sure to put in appropriate logic to UNDO any of the cell locking\n            'if a cell's value changes as well\n\n        'Relock the sheet\n        WS.Protect\"&lt;whatever_your_password_is&gt;\")\n\n        'At the very end of the macro be sure to turn screen updating back on (no\n        'good doing all this if it doesn't show on the screen)\n        Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>That should be plenty to get you started. If not, do a Google search for a more specific problem and you should come up with an answer pretty quick (that's how I learned VBA, VB.net, C#, SQL, etc.)</p>\n"}], "owner": {"reputation": 31, "user_id": 4872135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1974efd0f2c36d29d5306651417decaa?s=128&d=identicon&r=PG&f=1", "display_name": "Leigh598", "link": "https://stackoverflow.com/users/4872135/leigh598"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3133, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1435869619, "creation_date": 1430944141, "last_edit_date": 1430975349, "question_id": 30086908, "link": "https://stackoverflow.com/questions/30086908/locking-cells-based-on-criteria-in-other-cells", "title": "Locking cells based on criteria in other cells", "body": "<p>I have a spreadsheet which will be used to manage documents and information required for various projects. I would like some of these cells to be colored and locked depending on the information entered in another cell. </p>\n\n<p>Before I go into detail, I should mention that I am completely new to macros and VBA so my knowledge is extremely basic. These columns are subject to change so in addition to a code, I would like to know how I can edit the code to include additional columns or how to remove them. In addition, I will have over 500 rows of data that this will need to apply to, and the final product will be protected.</p>\n\n<p>I have added a link to a document that is similar to the one I am actually working on (due to my company\u2019s security restrictions, I cannot upload the original). He are the conditions I currently need to meet:</p>\n\n<ul>\n<li>If <code>\u201cSingle Source\u201d</code> is selected in column <code>B</code>, columns <code>E-H</code> and <code>P-R</code> need to be locked.</li>\n<li>If <code>\u201c\u2264 $50k\u201d</code> or <code>\u201c\u2264 $100k\u201d</code> are selected in column <code>C</code> in addition to <code>\u201cSingle Source\u201d</code>, then column <code>F</code> would be locked.</li>\n<li>The drop down list in column <code>C</code> may change to an estimated price that is manually entered because the current ranges are subject to change. </li>\n<li>If <code>\u201cBid\u201d</code> is selected in column <code>B</code> and if <code>\u201c\u2264 $50k\u201d</code> or <code>\u201c\u2264 $100k\u201d</code> are selected in column <code>C</code>, the columns <code>P-R</code> &amp; <code>AC</code> need to be locked</li>\n<li>Both <code>L5</code> &amp; <code>A5</code> approvals will be locked if column <code>C</code> is under <code>$2M</code></li>\n<li>Both <code>L4</code> &amp; <code>A4</code> approvals will be locked if column <code>C</code> is under <code>$1M</code></li>\n<li>Both <code>L3</code> &amp; <code>A3</code> approvals will be locked if column <code>C</code> is under <code>$500k</code></li>\n<li>Both <code>L2</code> &amp; <code>A2</code> approvals will be locked if column <code>C</code> is under <code>$50k</code></li>\n<li><code>L2</code> &amp; <code>A2</code> approvals will never be locked. </li>\n</ul>\n\n<p>Any codes I have found online thus far have not worked due to my inability to successfully edit them to meet my needs so any help would be greatly appreciated.</p>\n\n<p><a href=\"https://www.dropbox.com/s/9memoq1hcab2a4e/Document%20Control_Test.xlsm?dl=0\" rel=\"nofollow\">https://www.dropbox.com/s/9memoq1hcab2a4e/Document%20Control_Test.xlsm?dl=0</a></p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 9291, "user_id": 13189, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tKLRf.jpg?s=128&g=1", "display_name": "eckes", "link": "https://stackoverflow.com/users/13189/eckes"}, "edited": false, "score": 2, "creation_date": 1430944590, "post_id": 30086795, "comment_id": 48287332, "body": "Safe it as <code>.xls</code> or use the correct format (<code>FileFormat:=xlOpenXMLWorkbookMacroEnabled</code>). The <code>FileFormat:=xlNormal</code> is not valid for Excel 2007++"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 9291, "user_id": 13189, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tKLRf.jpg?s=128&g=1", "display_name": "eckes", "link": "https://stackoverflow.com/users/13189/eckes"}, "edited": false, "score": 0, "creation_date": 1430944739, "post_id": 30086795, "comment_id": 48287425, "body": "@eckes, make that an answer instead of just a comment. Although, Chris, you&#39;ll want to use <code>FileFormat:=xlOpenXMLWorkbook</code> since you don&#39;t want macros."}], "answers": [{"tags": [], "owner": {"reputation": 9291, "user_id": 13189, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tKLRf.jpg?s=128&g=1", "display_name": "eckes", "link": "https://stackoverflow.com/users/13189/eckes"}, "is_accepted": false, "score": 0, "last_activity_date": 1430945156, "creation_date": 1430945156, "answer_id": 30087209, "question_id": 30086795, "link": "https://stackoverflow.com/questions/30086795/save-results-as-in-corrupted-file-or-invalid-extension/30087209#30087209", "title": "Save results as in &#39;corrupted file or invalid extension&#39;", "body": "<p>The <code>FileFormat:=xlNormal</code> is no longer recognized by Excel 2007 and newer. It safes the file therefore in traditional format, so your have to name it <code>.xls</code>.</p>\n\n<p>According to the Online Help the new Format is called <code>FileFormat:=xlOpenXMLWorkbook</code>(<code>MacroEnabled</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "edited": false, "score": 0, "creation_date": 1430947185, "post_id": 30087339, "comment_id": 48288666, "body": "if the same name already exist at path then it will overwrite, no Alerts will be displayed and no macros will be saved"}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": false, "score": 0, "last_activity_date": 1436997557, "last_edit_date": 1436997557, "creation_date": 1430945653, "answer_id": 30087339, "question_id": 30086795, "link": "https://stackoverflow.com/questions/30086795/save-results-as-in-corrupted-file-or-invalid-extension/30087339#30087339", "title": "Save results as in &#39;corrupted file or invalid extension&#39;", "body": "<p>Try This</p>\n\n<pre><code>Sub Macro1()\nDim Path As String\nDim ReportName As String\n\nPath = \"C:\\Users\\Desktop\\\"\nReportName = \"abc.xlsx\"\n    Application.DisplayAlerts = False\n    ActiveWorkbook.SaveAs Filename:= _\n    Path &amp; ReportName, FileFormat:= _\n    xlOpenXMLWorkbook, CreateBackup:=False\n    Application.DisplayAlerts = True\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": true, "score": 3, "last_activity_date": 1430946206, "creation_date": 1430946206, "answer_id": 30087472, "question_id": 30086795, "link": "https://stackoverflow.com/questions/30086795/save-results-as-in-corrupted-file-or-invalid-extension/30087472#30087472", "title": "Save results as in &#39;corrupted file or invalid extension&#39;", "body": "<p>Since you indicated you do <em>not</em> want the final workbook to be macro enabled, this is what you want:</p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=path &amp; reportname &amp; \".xlsx\", FileFormat:=xlOpenXMLWorkbook\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 4872227, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NTu1d.jpg?s=128&g=1", "display_name": "Chis.Wisselo", "link": "https://stackoverflow.com/users/4872227/chis-wisselo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4262, "favorite_count": 0, "accepted_answer_id": 30087472, "answer_count": 3, "score": 2, "last_activity_date": 1436997557, "creation_date": 1430943752, "last_edit_date": 1436997495, "question_id": 30086795, "link": "https://stackoverflow.com/questions/30086795/save-results-as-in-corrupted-file-or-invalid-extension", "title": "Save results as in &#39;corrupted file or invalid extension&#39;", "body": "<p>I am running a macro to generate a report. Everything is working fine. Macro finishes without any error messages. When I want to open the generated report, it comes up with the (t) error message:</p>\n\n<blockquote>\n  <p>\"Excel cannot open the file 'abc.xlsx' because the file format or file extension is not valid.\"</p>\n</blockquote>\n\n<p>When I save as a <strong><em>.xlsM</em></strong> it does work, but I don't want the macro to be available in the final report (to prevent people running it and avoid data-corruption).</p>\n\n<p>This is the code I am using: </p>\n\n<pre><code>ActiveWorkbook.SaveAs Filename:=path &amp; reportname &amp; \".xlsx\",\n    fileFormat:=xlNormal\n</code></pre>\n\n<p>Any ideas are more then welcome!</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1017, "user_id": 1937588, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bfce49aa3aff0f828547a2c8e88700fe?s=128&d=identicon&r=PG", "display_name": "haosmark", "link": "https://stackoverflow.com/users/1937588/haosmark"}, "edited": false, "score": 0, "creation_date": 1430943958, "post_id": 30086646, "comment_id": 48286961, "body": "Absolutely positive. The strange thing is that I&#39;m able to set Style within regular Subs, but it seems that it does not work within custom functions. I tried to type in Range(&quot;B2:B10&quot;).Find(361656).Style = &quot;Good&quot; in my function and in a new macro. It only worked in a new macro. It looks like the Range is locked for editing."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 1017, "user_id": 1937588, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bfce49aa3aff0f828547a2c8e88700fe?s=128&d=identicon&r=PG", "display_name": "haosmark", "link": "https://stackoverflow.com/users/1937588/haosmark"}, "edited": false, "score": 0, "creation_date": 1430944607, "post_id": 30086646, "comment_id": 48287340, "body": "You&#39;re saying that if you declare <code>Public Sub WoRecR(workOrders As Range)</code> it will work, but if you declare <code>Public Function WoRecR(workOrders As Range)</code> it doesn&#39;t? I&#39;d change it to a <code>Sub</code> in that case, since you&#39;re not returning anything from your function. Also, I believe there is some sort of restriction on what can be changed in a <code>Function</code> vs a <code>Sub</code>."}, {"owner": {"reputation": 1017, "user_id": 1937588, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bfce49aa3aff0f828547a2c8e88700fe?s=128&d=identicon&r=PG", "display_name": "haosmark", "link": "https://stackoverflow.com/users/1937588/haosmark"}, "edited": false, "score": 0, "creation_date": 1430944921, "post_id": 30086646, "comment_id": 48287532, "body": "I want to be able to invoke this as a spreadsheet function, that&#39;s why it&#39;s set up this way. Do you have a reference to those limitations? Or is there a work around?"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 1017, "user_id": 1937588, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bfce49aa3aff0f828547a2c8e88700fe?s=128&d=identicon&r=PG", "display_name": "haosmark", "link": "https://stackoverflow.com/users/1937588/haosmark"}, "edited": false, "score": 0, "creation_date": 1430945155, "post_id": 30086646, "comment_id": 48287649, "body": "A) I&#39;m sorry, I don&#39;t have a list of restrictions, I&#39;ve seen a couple of comments over the last several months that have made mention. Google might be your best buddy there. B) a <code>Function</code> is designed to return something, which your code does not. You would put <code>=WoRecR(A1)</code> in a cell, Excel is expecting you to return some sort of value for it to display in that cell, your code will disappoint. Since you want to do formatting, your best bet is to have a button or possibly an <code>OnChange</code> event trigger it to do the formatting."}, {"owner": {"reputation": 1017, "user_id": 1937588, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bfce49aa3aff0f828547a2c8e88700fe?s=128&d=identicon&r=PG", "display_name": "haosmark", "link": "https://stackoverflow.com/users/1937588/haosmark"}, "edited": false, "score": 0, "creation_date": 1430945466, "post_id": 30086646, "comment_id": 48287825, "body": "I tried to google it, but wasn&#39;t able to find these. I guess I&#39;ll set it up as a Sub then. Thanks."}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1430943210, "creation_date": 1430943210, "answer_id": 30086646, "question_id": 30086578, "link": "https://stackoverflow.com/questions/30086578/vba-excel-setting-a-style-for-result-of-find-is-not-working/30086646#30086646", "title": "(VBA Excel) Setting a style for result of .Find() is not working", "body": "<p>Are you sure you're getting a result from <code>.Find()</code>?  Try this, to be sure:</p>\n\n<pre><code>        While Not results.EOF\n            Set searchResult = workOrders.Find(What:=results.Fields(0).Value)\n            If Not searchResult is Nothing then\n              Debug.Print searchResult.Value\n              searchResult.Style = \"Good\"\n            Else\n              MsgBox (\"nothing found\") 'for debugging purposes only\n            End If\n            results.MoveNext\n        Wend\n</code></pre>\n"}], "owner": {"reputation": 1017, "user_id": 1937588, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/bfce49aa3aff0f828547a2c8e88700fe?s=128&d=identicon&r=PG", "display_name": "haosmark", "link": "https://stackoverflow.com/users/1937588/haosmark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 314, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1430943210, "creation_date": 1430942979, "last_edit_date": 1531164843, "question_id": 30086578, "link": "https://stackoverflow.com/questions/30086578/vba-excel-setting-a-style-for-result-of-find-is-not-working", "title": "(VBA Excel) Setting a style for result of .Find() is not working", "body": "<p>I wrote a function that queries a database for certain records and what I need to do is to be able to filter out the results. I figured the easiest way would be to use .Find method on a range and set the Style of cells, then filter based on the style. The problem that I'm experiencing is that I can't apply any transformation to cells for some reason. I can read the .Find result value though.\nHow do I change the style?</p>\n\n<pre><code>Public Function WoRecR(workOrders As Range)\n    Dim cell As Range\n    Dim cn As Object\n    Dim command As Object\n    Dim results As Object\n    Dim searchResult As Range\n    Dim field As Object\n    Dim criteria As String\n\n    Set cn = New ADODB.Connection\n    Set command = New ADODB.command\n    Set results = New ADODB.Recordset\n    criteria = \"\"\n\n    For Each cell In workOrders\n        If (Not IsEmpty(cell.Value)) Then\n            criteria = \"DOCINDEX1='\" &amp; cell.Value &amp; \"' OR \" &amp; criteria\n        End If\n    Next cell\n    criteria = \"(\" &amp; Left(criteria, Len(criteria) - 4) &amp; \") \"\n    With cn\n        .ConnectionString = \"Provider=SQLOLEDB.1;\" &amp; _\n                            \"Persist Security Info=True;\" &amp; _\n                            \"Data Source=*********;\" &amp; _\n                            \"DATABASE=******;\" &amp; _\n                            \"UID=******;\" &amp; _\n                            \"PWD=******;\"\n        .Open\n    End With\n    On Error GoTo CloseCon\n    command.ActiveConnection = cn\n    command.CommandText = \"SELECT DOCINDEX1 FROM PVDM_DOCS_1_4 WHERE \" &amp; criteria &amp; \" AND DOCINDEX9!='Phone' \" &amp; _\n                          \"AND DATEDIFF(YEAR, GETDATE(), DOCINDEX10) &gt; -2;\"\n    command.CommandType = adCmdText\n    command.Execute\n\n    results.ActiveConnection = cn\n    results.Open command\n\n    While Not results.EOF\n        Set searchResult = workOrders.Find(What:=results.Fields(0).Value)\n        Debug.Print searchResult.Value\n        searchResult.Style = \"Good\"\n        results.MoveNext\n    Wend\n    cn.Close\n\nCloseCon:\n    If Err.Number Then Debug.Print Err.Description\nEnd Function\n</code></pre>\n\n<p>The exact part of code that I'm referring to is this:</p>\n\n<pre><code>            While Not results.EOF\n                Set searchResult = workOrders.Find(What:=results.Fields(0).Value)\n                Debug.Print searchResult.Value\n                searchResult.Style = \"Good\"\n                results.MoveNext\n            Wend\n</code></pre>\n"}, {"tags": ["vba", "excel", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 3543515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15559479666f9cfb545444aabec6d14?s=128&d=identicon&r=PG&f=1", "display_name": "James Beaulieu", "link": "https://stackoverflow.com/users/3543515/james-beaulieu"}, "edited": false, "score": 0, "creation_date": 1431010896, "post_id": 30089470, "comment_id": 48320858, "body": "Thanks so much for the answer, works now! (that part at least, hitting another problem after that :/ )"}], "tags": [], "owner": {"reputation": 118, "user_id": 3943253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2463098f1f7bf809e9cca3aea7b926af?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Schwebs", "link": "https://stackoverflow.com/users/3943253/justin-schwebs"}, "is_accepted": true, "score": 10, "last_activity_date": 1431007835, "last_edit_date": 1431007835, "creation_date": 1430955412, "answer_id": 30089470, "question_id": 30086425, "link": "https://stackoverflow.com/questions/30086425/excel-vba-method-document-of-object-iwebbrowser2-failed/30089470#30089470", "title": "Excel VBA &quot;Method &#39;Document&#39; of object &#39;IWebBrowser2&#39; failed&quot;", "body": "<p>I ran into this same issue a while back. Use internet explorer at a medium integrity level. InternetExplorer defaults to a low integrity level which, if you are doing this over a local intranet at work, sometimes will give the second error message you show above. \nClick <a href=\"http://blogs.msdn.com/b/ieinternals/archive/2011/08/03/internet-explorer-automation-protected-mode-lcie-default-integrity-level-medium.aspx\" rel=\"noreferrer\" title=\"Extra Help\">here</a> for more reading on this. I've modified your code below. Please let me know if that helps.</p>\n\n<pre><code>Sub GoToWebsiteTest()\nDim appIE As InternetExplorerMedium\n'Set appIE = Nothing\nDim objElement As Object\nDim objCollection As Object\n\nSet appIE = New InternetExplorerMedium\nsURL = \"http://example.com\"\nWith appIE\n    .Navigate sURL\n    .Visible = True\nEnd With\n\nDo While appIE.Busy Or appIE.ReadyState &lt;&gt; 4\n    DoEvents\nLoop\n\nSet objCollection = appIE.Document.getElementsByTagName(\"input\")\n\nSet appIE = Nothing\nEnd Sub\n</code></pre>\n\n<p>Remember references for Microsoft Internet Controls, and depending on what you plan on doing further, Microsoft HTML Object Library</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 6499726, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97d476befaec4596d82e8600f72369fb?s=128&d=identicon&r=PG&f=1", "display_name": "Reza Iranpour", "link": "https://stackoverflow.com/users/6499726/reza-iranpour"}, "is_accepted": false, "score": 1, "last_activity_date": 1483558221, "creation_date": 1483558221, "answer_id": 41471828, "question_id": 30086425, "link": "https://stackoverflow.com/questions/30086425/excel-vba-method-document-of-object-iwebbrowser2-failed/41471828#41471828", "title": "Excel VBA &quot;Method &#39;Document&#39; of object &#39;IWebBrowser2&#39; failed&quot;", "body": "<p>Not exactly same as above code but somehow similar , the following code solved my problem:</p>\n\n<pre><code>Do\nLoop Until ie.readystate = 3\nDo\nLoop Until ie.readystate = 4\n</code></pre>\n\n<p>Just put it before the line you want to start working with the contents.\nTo get more information about how does it work you can check <a href=\"https://msdn.microsoft.com/en-us/library/ms534361(v=vs.85).aspx\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 7925410, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/8ae1a7f04c7877da3b8f7983121971ef?s=128&d=identicon&r=PG", "display_name": "Mangesh Vhatkar", "link": "https://stackoverflow.com/users/7925410/mangesh-vhatkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1493209692, "creation_date": 1493209692, "answer_id": 43634232, "question_id": 30086425, "link": "https://stackoverflow.com/questions/30086425/excel-vba-method-document-of-object-iwebbrowser2-failed/43634232#43634232", "title": "Excel VBA &quot;Method &#39;Document&#39; of object &#39;IWebBrowser2&#39; failed&quot;", "body": "<p>The below method solved my problem for this error:\nClose all the explorer instances through 'Task manager' and try to run the code it will work.</p>\n"}], "owner": {"reputation": 55, "user_id": 3543515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d15559479666f9cfb545444aabec6d14?s=128&d=identicon&r=PG&f=1", "display_name": "James Beaulieu", "link": "https://stackoverflow.com/users/3543515/james-beaulieu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36492, "favorite_count": 1, "accepted_answer_id": 30089470, "answer_count": 3, "score": 5, "last_activity_date": 1533046410, "creation_date": 1430942451, "last_edit_date": 1499086306, "question_id": 30086425, "link": "https://stackoverflow.com/questions/30086425/excel-vba-method-document-of-object-iwebbrowser2-failed", "title": "Excel VBA &quot;Method &#39;Document&#39; of object &#39;IWebBrowser2&#39; failed&quot;", "body": "<p>I'm trying to automate a form submission in Excel for work, and In have trouble with the basics. I keep getting the error message:</p>\n\n<blockquote>\n  <p>\"Method 'Document' of object 'IWebBrowser2' failed\"</p>\n</blockquote>\n\n<p>With the code as is, and if I include the Or part in the waiting check, I get the error</p>\n\n<blockquote>\n  <p>\"Automation Error The object invoked has disconnected from its clients.\"</p>\n</blockquote>\n\n<p>I'm not sure what to do here, I've searched all over for solutions. This code is intended to eventually do more than this, but it keeps failing on the first try to <code>getElementsByTagName</code>. </p>\n\n<pre><code>Sub GoToWebsiteTest()\nDim appIE As Object 'Internet Explorer\nSet appIE = Nothing\nDim objElement As Object\nDim objCollection As Object\n\nIf appIE Is Nothing Then Set appIE = CreateObject(\"InternetExplorer.Application\")\nsURL = *link*\nWith appIE\n    .Visible = True\n    .Navigate sURL\nEnd With\n\nDo While appIE.Busy ' Or appIE.ReadyState &lt;&gt; 4\n    DoEvents\nLoop\n\nSet objCollection = appIE.Document.getElementsByTagName(\"input\")\n\nSet appIE = Nothing\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "userform", "ms-project"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1430942312, "post_id": 30086338, "comment_id": 48285902, "body": "If you haven&#39;t already, don&#39;t use &quot;.select&quot; anywhere if possible, that can slow it down."}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 1, "creation_date": 1430942957, "post_id": 30086338, "comment_id": 48286332, "body": "You might consider posting the code at Stack Exchange&#39;s code review for more specific instructions: <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 15122, "user_id": 4519059, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/MBHID.png?s=128&g=1", "display_name": "shA.t", "link": "https://stackoverflow.com/users/4519059/sha-t"}, "edited": false, "score": 1, "creation_date": 1430944441, "post_id": 30086338, "comment_id": 48287250, "body": "I think speeding up a VBA code is based on your: Code &amp; Environment, So please add your code and your environment ;)."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1430952636, "post_id": 30087014, "comment_id": 48291046, "body": "<a href=\"http://blogs.msdn.com/b/ericlippert/archive/2004/04/28/when-are-you-required-to-set-objects-to-nothing.aspx\" rel=\"nofollow noreferrer\">When Are You Required To Set Objects To Nothing?</a>"}, {"owner": {"reputation": 27, "user_id": 4871204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e3360f601c5a4df26583ce5af940aa9?s=128&d=identicon&r=PG&f=1", "display_name": "rey", "link": "https://stackoverflow.com/users/4871204/rey"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430983660, "post_id": 30087014, "comment_id": 48301218, "body": "just to release the memory"}], "tags": [], "owner": {"reputation": 27, "user_id": 4871204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e3360f601c5a4df26583ce5af940aa9?s=128&d=identicon&r=PG&f=1", "display_name": "rey", "link": "https://stackoverflow.com/users/4871204/rey"}, "is_accepted": false, "score": -2, "last_activity_date": 1430983574, "last_edit_date": 1430983574, "creation_date": 1430944515, "answer_id": 30087014, "question_id": 30086338, "link": "https://stackoverflow.com/questions/30086338/how-can-i-speed-up-my-microsoft-project-vba-code/30087014#30087014", "title": "How can I speed up my Microsoft Project VBA code?", "body": "<p>if you have some variables with lot of data like collections think about setting it to nothing and the end of your function</p>\n\n<p>Set TasksCollection=Nothing</p>\n"}, {"tags": [], "owner": {"reputation": 6482, "user_id": 1056632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7TOmD.jpg?s=128&g=1", "display_name": "Rachel Hettinger", "link": "https://stackoverflow.com/users/1056632/rachel-hettinger"}, "is_accepted": true, "score": 2, "last_activity_date": 1431032200, "creation_date": 1431032200, "answer_id": 30111482, "question_id": 30086338, "link": "https://stackoverflow.com/questions/30086338/how-can-i-speed-up-my-microsoft-project-vba-code/30111482#30111482", "title": "How can I speed up my Microsoft Project VBA code?", "body": "<p>Turning off screen updating and setting calculation mode to Manual are the only application settings you can use to improve performance; the rest depends on your algorithm. </p>\n\n<p>Your description of the problem is a bit vague: How large are your projects and how long does the macro take? If your projects are 1,000 tasks and you are making a dozen checks and your code takes more than five minutes, then yes, there is surely room for improvement. But if it's 20,000 tasks and 50 checks and the macro takes two minutes, stop trying to improve it--that's great performance.</p>\n\n<p>Bottom line: it is impossible to tell if there is room for improvement without seeing your code.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4880585, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eUcYK.jpg?s=128&g=1", "display_name": "John Owen", "link": "https://stackoverflow.com/users/4880585/john-owen"}, "is_accepted": false, "score": 0, "last_activity_date": 1431125005, "last_edit_date": 1431125005, "creation_date": 1431120876, "answer_id": 30133206, "question_id": 30086338, "link": "https://stackoverflow.com/questions/30086338/how-can-i-speed-up-my-microsoft-project-vba-code/30133206#30133206", "title": "How can I speed up my Microsoft Project VBA code?", "body": "<p>If you use the same property (e.g. objTask.Start) in several different comparisons in your code then set the property into a local variable once and then perform your comparisons on the local variable.</p>\n\n<p>For example:</p>\n\n<p><strong>Slow code:</strong></p>\n\n<pre><code>If objTask.start &lt; TestDate1 and objTask.Start &gt; TestDate2 then ...\n</code></pre>\n\n<p><strong>Fast code:</strong></p>\n\n<pre><code>Define dteStart as Date \n\ndteStart = objTask.Start\n\nif dteStart &lt; TestDate1 and dteStart &gt; testdate2 then ...\n</code></pre>\n\n<p>Calls to the <code>COM</code> object model are expensive. The second code example will be quite a bit faster (although as noted by Rachel above) it really does depend on the volume of data being processed.</p>\n\n<p>Also, make sure you define your variables with appropriate types as relying on the default Variant data type is very slow.</p>\n"}], "owner": {"reputation": 153, "user_id": 4504918, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6fcbe6855dc7a523bbb1b4e2c14d7cc?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4504918/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1483, "favorite_count": 0, "accepted_answer_id": 30111482, "answer_count": 3, "score": 0, "last_activity_date": 1593560095, "creation_date": 1430942169, "last_edit_date": 1593560095, "question_id": 30086338, "link": "https://stackoverflow.com/questions/30086338/how-can-i-speed-up-my-microsoft-project-vba-code", "title": "How can I speed up my Microsoft Project VBA code?", "body": "<p>I have a macro I use for Microsoft Project that loops through each task in the project, and performs several checks to find any problems with the tasks. These checks include several <code>IF</code> and <code>Select Case</code> statements. When dealing with large projects with more tasks, the macro can get lengthy. Is there anything I can do to improve the speed up the macro? I have already turned off screen updating and manual calculation. </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 3, "creation_date": 1430942265, "post_id": 30086301, "comment_id": 48285871, "body": "Is it possible your array starts at 0, where cells(0,3) cannot be found?"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 2, "creation_date": 1430942442, "post_id": 30086301, "comment_id": 48286001, "body": "Use Option Base 1 in your module to make arrays start at index 1"}, {"owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1430942467, "post_id": 30086301, "comment_id": 48286021, "body": "@Alex Thanks Alex. That was quick and you are right. i+1 works ."}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1430942692, "post_id": 30086301, "comment_id": 48286167, "body": "@Meesha welcome!  You can consider Sorceri&#39;s suggestion - using option base 1, and pay attention on the array&#39;s input."}, {"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "reply_to_user": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1430952938, "post_id": 30086301, "comment_id": 48291148, "body": "@Alex You might want to add that as answer with some other tips in arrays."}], "answers": [{"tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 3, "last_activity_date": 1430953407, "last_edit_date": 1430953407, "creation_date": 1430952893, "answer_id": 30089066, "question_id": 30086301, "link": "https://stackoverflow.com/questions/30086301/filling-a-string-in-to-different-cells/30089066#30089066", "title": "Filling a String in to different cells", "body": "<p>Alex and Sorceri already pointed out that by default, arrays start at index 0.<br> But aside from that, you don't need to loop to pass your array to range.</p>\n\n<pre><code>' 1D Array\nWith Worksheets(\"Sheet1\")\n    .Range(\"C1:C\" &amp; Ubound(Principal) + 1) = Application.Transpose(Principal)\nEnd With\n</code></pre>\n\n<p>Take note of the <code>+ 1</code>. If <code>Option Base = 1</code> then you'll have to remove it.<br>\nAlso take note that if you're passing 1D array to range, you'll need to <code>Transpose</code> the array.</p>\n"}], "owner": {"reputation": 761, "user_id": 4660214, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ffb4a4ec2ddac9c699a57d105aad53a?s=128&d=identicon&r=PG&f=1", "display_name": "Meesha", "link": "https://stackoverflow.com/users/4660214/meesha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1430953407, "creation_date": 1430942055, "question_id": 30086301, "link": "https://stackoverflow.com/questions/30086301/filling-a-string-in-to-different-cells", "title": "Filling a String in to different cells", "body": "<p>I want to fill a series of cells with a Array but I am unable to do it. </p>\n\n<p><strong>1)</strong></p>\n\n<pre><code>Dim Principal() As String\nDim txt As String\n\nFor i = LBound(Principal) To UBound(Principal)\n    txt = txt &amp; Principal(i)  &amp; vbCrLf\nNext i\nMsgBox txt\n</code></pre>\n\n<p><strong>2)</strong> </p>\n\n<pre><code>Dim Principal() As String\nDim txt As String\n\nFor i = LBound(Principal) To UBound(Principal)\n    Worksheets(\"Sheet1\").Cells(i, 3) = Principal(i)\nNext i\n</code></pre>\n\n<p>I can see the output in the first example i.e MsgBox but I get an error when I try to store in to different cells. Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 622, "user_id": 3802937, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0acf84a491a2e9a572eab1e79faaf62e?s=128&d=identicon&r=PG&f=1", "display_name": "bob_1982", "link": "https://stackoverflow.com/users/3802937/bob-1982"}, "reply_to_user": {"reputation": 33, "user_id": 3384931, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95ff7ca72d61b62dfd7ace039dc7f86c?s=128&d=identicon&r=PG&f=1", "display_name": "user3384931", "link": "https://stackoverflow.com/users/3384931/user3384931"}, "edited": false, "score": 0, "creation_date": 1430942678, "post_id": 30085803, "comment_id": 48286150, "body": "you are welcome. its great community to help each other"}], "tags": [], "owner": {"reputation": 622, "user_id": 3802937, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/0acf84a491a2e9a572eab1e79faaf62e?s=128&d=identicon&r=PG&f=1", "display_name": "bob_1982", "link": "https://stackoverflow.com/users/3802937/bob-1982"}, "is_accepted": true, "score": 0, "last_activity_date": 1430940294, "creation_date": 1430940294, "answer_id": 30085803, "question_id": 30085499, "link": "https://stackoverflow.com/questions/30085499/vba-start-at-specific-worksheet-to-link-worksheets-to-list/30085803#30085803", "title": "VBA start at specific worksheet to link worksheets to list", "body": "<pre><code>  dim sh as Worksheet\n  dim cell as Range\n  dim cnt as Integer,idx as integer\n  cnt=ActiveWorkbook.Worksheets.Count\n  idx=2 'any specific worksheet you want to start from\n\n  for idx=2 to cnt\n     set sh=ActiveWorkbook.WorkSheets(idx)\n    'rest of code goes here\n   next\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 3384931, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/95ff7ca72d61b62dfd7ace039dc7f86c?s=128&d=identicon&r=PG&f=1", "display_name": "user3384931", "link": "https://stackoverflow.com/users/3384931/user3384931"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 30085803, "answer_count": 1, "score": 0, "last_activity_date": 1430944513, "creation_date": 1430939182, "last_edit_date": 1430944513, "question_id": 30085499, "link": "https://stackoverflow.com/questions/30085499/vba-start-at-specific-worksheet-to-link-worksheets-to-list", "title": "VBA start at specific worksheet to link worksheets to list", "body": "<p>I found this macro and wanted to tweak it so that it would start at a specific worksheet instead of running through the entire workbook. </p>\n\n<pre><code>Sub CreateLinksToAllSheets()\nDim sh As Worksheet\nDim cell As Range\nFor Each sh In ActiveWorkbook.Worksheets\n    If ActiveSheet.Name &gt; sh.Name Then\n        ActiveCell.Hyperlinks.Add Anchor:=Selection, Address:=\"\", SubAddress:= _\n            \"'\" &amp; sh.Name &amp; \"'\" &amp; \"!A1\", TextToDisplay:=sh.Name\n        ActiveCell.Offset(1, 0).Select\n    End If\nNext sh\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "edited": false, "score": 0, "creation_date": 1430961458, "post_id": 30086852, "comment_id": 48293493, "body": "avoid usage of the <code>select</code> method, this is bad practice"}], "tags": [], "owner": {"reputation": 27, "user_id": 4871204, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e3360f601c5a4df26583ce5af940aa9?s=128&d=identicon&r=PG&f=1", "display_name": "rey", "link": "https://stackoverflow.com/users/4871204/rey"}, "is_accepted": false, "score": 1, "last_activity_date": 1430954241, "last_edit_date": 1430954241, "creation_date": 1430943931, "answer_id": 30086852, "question_id": 30085470, "link": "https://stackoverflow.com/questions/30085470/vba-copy-paste-string-search/30086852#30086852", "title": "VBA Copy Paste string search", "body": "<pre><code>Dim RangeToSearch As Range\nDim ValueToSearch\nDim RangeToCopy As Range\nSet RangeToSearch = ActiveSheet.Range(\"C10:G10\")\nSet RangeToCopy = ActiveSheet.Range(\"A14:A18\")\n\nValueToSearch = ActiveSheet.Cells(10, \"A\").Value\nFor Each cell In RangeToSearch\n    If cell.Value = ValueToSearch Then\n        RangeToCopy.Select\n        Selection.Copy\n        Range(ActiveSheet.Cells(14, cell.Column), _\n            ActiveSheet.Cells(18, cell.Column)).Select\n        ActiveSheet.Paste\n        Application.CutCopyMode = False\n        Exit For\n    End If\nNext cell\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "edited": false, "score": 0, "creation_date": 1431626400, "post_id": 30089309, "comment_id": 48589245, "body": "L42 - How do i get this to work if the find and search values are formulas? ..I&#39;ve tried changing the .Value2 but doesn&#39;t seem to work."}], "tags": [], "owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "is_accepted": false, "score": 2, "last_activity_date": 1431661286, "last_edit_date": 1431661286, "creation_date": 1430954482, "answer_id": 30089309, "question_id": 30085470, "link": "https://stackoverflow.com/questions/30085470/vba-copy-paste-string-search/30089309#30089309", "title": "VBA Copy Paste string search", "body": "<p>Try this:</p>\n\n<pre><code>With Sheets(\"SheetName\") ' Change to your actual sheet name\n    Dim r As Range: Set r = .Range(\"C10:G10\").Find(.Range(\"A10\").Value2, , , xlWhole)\n    If Not r Is Nothing Then r.Offset(4, 0).Resize(5).Value2 = .Range(\"A14:A18\").Value2\nEnd With\n</code></pre>\n\n<p>Range Object have <a href=\"https://msdn.microsoft.com/en-us/library/office/aa195730(v=office.11).aspx\" rel=\"nofollow\"><code>Find Method</code></a> to help you find values within your range.<br>\nThe Range object that matches your search criteria is then returned.<br>\nTo get your values to the correct location, simply use <code>Offset and Resize Method</code>.</p>\n\n<p><strong>Edit1:</strong> To answer OP's comment</p>\n\n<p>To find formulas in Ranges, you need to set <code>LookIn</code> argument to <code>xlFormulas</code>.</p>\n\n<pre><code>Set r = .Range(\"C10:G10\").Find(What:=.Range(\"A10\").Formula, _\n                               LookIn:=xlFormulas, _\n                               LookAt:=xlWhole)\n</code></pre>\n\n<p>Above code find Ranges with exactly the same formula as Cell A10.</p>\n"}, {"tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1430959986, "last_edit_date": 1430959986, "creation_date": 1430958740, "answer_id": 30089941, "question_id": 30085470, "link": "https://stackoverflow.com/questions/30085470/vba-copy-paste-string-search/30089941#30089941", "title": "VBA Copy Paste string search", "body": "<p>another additional variants</p>\n\n<p>1.Using  <code>For each</code> loop</p>\n\n<pre><code>Sub test()\nDim Cl As Range, x&amp;\n\nFor Each Cl In [C10:G10]\n    If Cl.Value = [A10].Value Then\n        x = Cl.Column: Exit For\n    End If\nNext Cl\n\nIf x = 0 Then\n    MsgBox \"'\" &amp; [A10].Value &amp; \"' has not been found in range 'C10:G10'!\"\n    Exit Sub\nEnd If\n\nRange(Cells(14, x), Cells(18, x)).Value = [A14:A18].Value\n\nEnd Sub\n</code></pre>\n\n<p>2.Using <code>Find</code> method (already posted by L42, but a bit different)</p>\n\n<pre><code>Sub test2()\nDim Cl As Range, x&amp;\n\nOn Error Resume Next\n\nx = [C10:G10].Find([A10].Value2, , , xlWhole).Column\n\nIf Err.Number &gt; 0 Then\n    MsgBox \"'\" &amp; [A10].Value2 &amp; \"' has not been found in range 'C10:G10'!\"\n    Exit Sub\nEnd If\n\n[A14:A18].Copy Range(Cells(14, x), Cells(18, x))\n\nEnd Sub\n</code></pre>\n\n<p>3.Using <code>WorksheetFunction.Match</code></p>\n\n<pre><code>Sub test2()\nDim Cl As Range, x&amp;\n\nOn Error Resume Next\n\nx = WorksheetFunction.Match([A10], [C10:G10], 0) + 2\n\nIf Err.Number &gt; 0 Then\n    MsgBox \"'\" &amp; [A10].Value2 &amp; \"' has not been found in range 'C10:G10'!\"\n    Exit Sub\nEnd If\n\n[A14:A18].Copy Range(Cells(14, x), Cells(18, x))\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "is_accepted": false, "score": 0, "last_activity_date": 1430993214, "creation_date": 1430993214, "answer_id": 30097911, "question_id": 30085470, "link": "https://stackoverflow.com/questions/30085470/vba-copy-paste-string-search/30097911#30097911", "title": "VBA Copy Paste string search", "body": "<p>Here you go,</p>\n\n<pre><code>    Sub DoIt()\n    Dim rng As Range, f As Range\n    Dim Fr As Range, Crng As Range\n\n    Set Fr = Range(\"A10\")\n    Set Crng = Range(\"A14:A18\")\n    Set rng = Range(\"C10:G19\")\n    Set f = rng.Find(what:=Fr, lookat:=xlWhole)\n\n    If Not f Is Nothing Then\n        Crng.Copy Cells(14, f.Column)\n    Else: MsgBox \"Not Found\"\n        Exit Sub\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 3512530, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c40f173cb8f935778e156188466477e7?s=128&d=identicon&r=PG&f=1", "display_name": "Elixir", "link": "https://stackoverflow.com/users/3512530/elixir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1859, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1431661286, "creation_date": 1430939104, "last_edit_date": 1430953980, "question_id": 30085470, "link": "https://stackoverflow.com/questions/30085470/vba-copy-paste-string-search", "title": "VBA Copy Paste string search", "body": "<p>I can\u2019t seem to figure out how to write a vba code that search\u2019s through cells C10:G10 to find a match that equals cell A10, once found, copies range A14:A18 to the matched cell but below e.g F14:F18 (See Image)</p>\n\n<p>Macro below</p>\n\n<pre><code>'Copy\nRange(\"A14:A18\").Select\nSelection.Copy\n'Paste\nRange(\"F14:F18\").Select\nActiveSheet.Paste!\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/gx7zA.jpg\" alt=\"Attached image click here\"></p>\n"}, {"tags": ["vba", "excel", "trim"], "comments": [{"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1430941888, "post_id": 30085441, "comment_id": 48285614, "body": "Will you only be looking for the numbers after Total?   Or might you be using some other key words also?"}], "answers": [{"tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": true, "score": 1, "last_activity_date": 1430940517, "last_edit_date": 1430940517, "creation_date": 1430939533, "answer_id": 30085600, "question_id": 30085441, "link": "https://stackoverflow.com/questions/30085441/vba-excel-cut-a-part-from-a-string/30085600#30085600", "title": "VBA, excel cut a part from a string", "body": "<p>Will the two Totals always be the same? If so, you can use this formula (just put this in a cell on the same row as your data, I am assuming your Cell is A1):</p>\n\n<p><code>=TRIM(MID(A2,SEARCH(\"total: \",A2)+LEN(\"total: \"),2))</code></p>\n\n<p>If the GB numbers will ever be larger than two digits, change the \"2\" to \"3\".  Do you have any other example cell data to work off to improve the above?</p>\n\n<p>Edit: If the numbers will be different, you can use this:\n<code>=MID(A1,SEARCH(\"appvg - total: \",A1)+LEN(\"appvg - total: \"),2)&amp;\", \"&amp;MID(A1,SEARCH(\"rootvg - total: \",A1)+LEN(\"rootvg - total: \"),2)</code></p>\n\n<p>edit 2: I am working on the formula so if the GB are greater than two digits, such as 964 GB, to have a way to dynamically pick that out.  This seems to work up to numbers 4 digits long:\n<code>=MID(A4,SEARCH(\"appvg - total: \",A4)+LEN(\"appvg - total: \"),SEARCH(\" G\",A4)-SEARCH(\":\",A4)-2)&amp;\", \"&amp;MID(A4,SEARCH(\"rootvg - total: \",A4)+LEN(\"rootvg - total: \"),SEARCH(\" G\",A4,SEARCH(\" G\",A4)-SEARCH(\":\",A4)-1)-SEARCH(\":\",A4)-2)</code></p>\n"}, {"comments": [{"owner": {"reputation": 1005, "user_id": 185133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7805e415be10bbac68980f707c634b41?s=128&d=identicon&r=PG", "display_name": "rryanp", "link": "https://stackoverflow.com/users/185133/rryanp"}, "edited": false, "score": 0, "creation_date": 1430943719, "post_id": 30086600, "comment_id": 48286824, "body": "I should note though that I usually always try to do a formula solution when possible, so I prefer @user3578951&#39;s answer. But if you need something quick-and-dirty, or something that can handle longer numbers and/or decimals, this could be a starting point."}], "tags": [], "owner": {"reputation": 1005, "user_id": 185133, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7805e415be10bbac68980f707c634b41?s=128&d=identicon&r=PG", "display_name": "rryanp", "link": "https://stackoverflow.com/users/185133/rryanp"}, "is_accepted": false, "score": 0, "last_activity_date": 1430943036, "creation_date": 1430943036, "answer_id": 30086600, "question_id": 30085441, "link": "https://stackoverflow.com/questions/30085441/vba-excel-cut-a-part-from-a-string/30086600#30086600", "title": "VBA, excel cut a part from a string", "body": "<p>If you want a true VBA solution, here's a function to get to at least the first number (and a similar one can be created to get to the second number):</p>\n\n<pre><code>Function first_number(a_string As String) As Double\n    'assumes one space after each \"Total:\" occurrence\n    loc_of_first_total = InStr(1, a_string, \"Total\")\n    end_of_first_number = InStr(loc_of_first_total + 7, a_string, \" \") - 1\n    first_number = CDbl(Mid(a_string, loc_of_first_total + 7, end_of_first_number - loc_of_first_total - 6))\nEnd Function\n</code></pre>\n\n<p>If you're not familiar with InStr, a Google search would probably get to a better explanation than I could provide. All the numbers I used (e.g., 7, 1, 6) are just the math of where the number will be if you assume that \"Total:\" plus one space exists before each number needed. I wasn't sure if decimals could exist, so I returned a Double, but it could be an Integer or Long depending on what you expect in the data.</p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": false, "score": 0, "last_activity_date": 1430943672, "creation_date": 1430943672, "answer_id": 30086769, "question_id": 30085441, "link": "https://stackoverflow.com/questions/30085441/vba-excel-cut-a-part-from-a-string/30086769#30086769", "title": "VBA, excel cut a part from a string", "body": "<p>For the first instance:  (where WordToFind might be \"Total:\"</p>\n\n<pre><code>=LOOKUP(2,1/MID(A1,SEARCH(WordToFind,A1)+LEN(WordToFind)+1,ROW(INDIRECT(\"1:5\"))),MID(A1,SEARCH(WordToFind,A1)+LEN(WordToFind)+1,ROW(INDIRECT(\"1:5\"))))\n</code></pre>\n\n<p>For the 2nd instance:</p>\n\n<pre><code>=LOOKUP(2,1/MID(A1,SEARCH(WordToFind,A1,SEARCH(WordToFind,A1)+1)+LEN(WordToFind)+1,ROW(INDIRECT(\"1:5\"))),MID(A1,SEARCH(WordToFind,A1,SEARCH(WordToFind,A1)+1)+LEN(WordToFind)+1,ROW(INDIRECT(\"1:5\"))))\n</code></pre>\n\n<p>If you need more instances, VBA might be a better option.\nIf your number portion might be longer than 5 characters, change the \"5\" in \"1:5\" </p>\n"}, {"tags": [], "owner": {"reputation": 6237, "user_id": 4892468, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/b9tfr.png?s=128&g=1", "display_name": "EEM", "link": "https://stackoverflow.com/users/4892468/eem"}, "is_accepted": false, "score": 0, "last_activity_date": 1432137678, "last_edit_date": 1432137678, "creation_date": 1432136886, "answer_id": 30354513, "question_id": 30085441, "link": "https://stackoverflow.com/questions/30085441/vba-excel-cut-a-part-from-a-string/30354513#30354513", "title": "VBA, excel cut a part from a string", "body": "<p>I assume that you need the results in two separated cells.\nAlso note that the <em>key string</em> to search for is <strong>\"Total:\"</strong></p>\n\n<p>Cell <strong>A11</strong> has the following value <em>(use different totals as to validate the different results)</em></p>\n\n<p><strong>Appvg - Total: 147 GB - Free:20 Gb; rootvg - Total: 247 -Free: &lt;1 GB></strong></p>\n\n<p><em>Use this formula to obtain the Total: 147</em> (GB)</p>\n\n<pre><code>=LEFT(SUBSTITUTE(A11,LEFT(A11,LEN(\"Total:\")+SEARCH(\"Total:\",A11)),\"\"),\n-1+SEARCH(\" \",SUBSTITUTE(A11,LEFT(A11,LEN(\"Total:\")+SEARCH(\"Total:\",A11)),\"\")))\n</code></pre>\n\n<p><em>Use this formula to obtain the Total: 247</em> (-Free)</p>\n\n<pre><code>=LEFT(SUBSTITUTE(A11,LEFT(A11,\nLEN(\"Total:\")+SEARCH(\"|\",SUBSTITUTE(A11,\"Total:\",\"|\",2))),\"\"),\n-1+SEARCH(\" \",SUBSTITUTE(A11,\nLEFT(A11,LEN(\"Total:\")+SEARCH(\"|\",SUBSTITUTE(A11,\"Total:\",\"|\",2))),\"\")))\n</code></pre>\n\n<p>In case the <em>key string</em> changes, a cell can be use to enter the <em>key strings</em> to search. If this is the case use these formulas:</p>\n\n<p>The <em>key string</em> <strong>\"Total:\"</strong> is entered in cell <strong>A12</strong></p>\n\n<p><em>Use this formula to obtain the Total: 147</em> (GB)</p>\n\n<pre><code>=LEFT(SUBSTITUTE(A11,LEFT(A11,LEN(A12)+SEARCH(A12,A11)),\"\"),\n-1+SEARCH(\" \",SUBSTITUTE(A11,LEFT(A11,LEN(A12)+SEARCH(A12,A11)),\"\")))\n</code></pre>\n\n<p><em>Use this formula to obtain the Total: 247</em> (-Free)</p>\n\n<pre><code>=LEFT(SUBSTITUTE(A11,LEFT(A11,\nLEN(A12)+SEARCH(\"|\",SUBSTITUTE(A11,A12,\"|\",2))),\"\"),\n-1+SEARCH(\" \",SUBSTITUTE(A11,LEFT(A11,\nLEN(A12)+SEARCH(\"|\",SUBSTITUTE(A11,A12,\"|\",2))),\"\")))\n</code></pre>\n\n<p>All formulas work regardless of the length of the numbers</p>\n"}], "owner": {"reputation": 3, "user_id": 4871992, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203751028005677/picture?type=large", "display_name": "Szabina Ozvald", "link": "https://stackoverflow.com/users/4871992/szabina-ozvald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2320, "favorite_count": 0, "accepted_answer_id": 30085600, "answer_count": 4, "score": 0, "last_activity_date": 1432137678, "creation_date": 1430939002, "last_edit_date": 1432033371, "question_id": 30085441, "link": "https://stackoverflow.com/questions/30085441/vba-excel-cut-a-part-from-a-string", "title": "VBA, excel cut a part from a string", "body": "<p>I would like to get a part from a string. Im not familiar with VBA or unusual excel functions, but I think maybe a macro or a VBA code can help me.</p>\n\n<p>I need to cut down everything from the whole string from the cell, except what is after the Total. To clear this, I need the numbers which stand after the total. I dont know any functions in excel which can solve my problem. Is there something like trim or something which recognize the 'total' and give me the number after that?</p>\n\n<p>Example:\nFrom this cell I need the 47 and the other 47</p>\n\n<p>Cell: <strong>Appvg - Total: 47 GB - Free:20 Gb; rootvg - Total: 47 -Free: &lt;1 GB></strong></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1430942118, "creation_date": 1430942118, "answer_id": 30086324, "question_id": 30085270, "link": "https://stackoverflow.com/questions/30085270/excel-visual-basic-to-set-sourcerange/30086324#30086324", "title": "Excel Visual Basic to set SourceRange", "body": "<p>The unqualified <code>Range(\"XFD14\")...</code> refers to a cell on the active sheet, not necessarily the sheet you expected.</p>\n\n<p>Change to</p>\n\n<pre><code>With WorkBk.Sheets(\"Sheet8\")\n     Set SourceRange = .Range(\"B14\", .Range(\"XFD14\").End(XltoLeft).Offset(0,2))\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 4606449, "user_type": "registered", "accept_rate": 52, "profile_image": "https://lh4.googleusercontent.com/-jlHOOlNoBmw/AAAAAAAAAAI/AAAAAAAACCI/lC6qZF8_UJ8/photo.jpg?sz=128", "display_name": "David Redden", "link": "https://stackoverflow.com/users/4606449/david-redden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1713, "favorite_count": 0, "closed_date": 1448277953, "accepted_answer_id": 30086324, "answer_count": 1, "score": 0, "last_activity_date": 1430942118, "creation_date": 1430938473, "last_edit_date": 1531161705, "question_id": 30085270, "link": "https://stackoverflow.com/questions/30085270/excel-visual-basic-to-set-sourcerange", "closed_reason": "Duplicate", "title": "Excel Visual Basic to set SourceRange", "body": "<p>I am getting a run-time error 1004 Application-defined or object-defined error.\nI have some VB in Excel that I am trying to get it to select a range (that possibly may change).. it is erroring out on  </p>\n\n<pre><code> Set SourceRange = WorkBk.Sheets(\"Sheet8\").Range(\"B14\", Range(\"XFD14\").End(XltoLeft).Offset(0,2))\n</code></pre>\n\n<p>Need to be able to have the SourceRange be range B14(always) to the last available cell + 2 to the right (for just in cases) </p>\n\n<p>I have:</p>\n\n<pre><code> Sub MergeData()\n Dim SourceRange as Range\n WorkBk As Workbook\n Dim DestRange as Range\n Dim FolderPath As String\n Dim FileName As String\n Dim NRow As Long\n FolderPath = Sheets(\"Sheet1\").Range(\"D7\")\n NRow = 4\n FileName = DIR(FolderPath &amp; \"*.xlsb\")\n Do While FileName &lt;&gt; \"\"\n Set WorkBk = Workbooks.Open(FolderPath &amp; FileName)\n  WorkBk.Application.Run _\n    \"'\" &amp; FileName &amp; \"'!auto_open\"\n Set SourceRange = WorkBk.Sheets(\"Sheet8\").Range(\"B14\", Range(\"XFD14\").End(XltoLeft).Offset(0,2))\n  Set DestRange = Sheets(\"Sheet2\").Range(\"B\" &amp; NRow)\n    Set DestRange = DestRange.Resize(SourceRange.Rows.Count, _\n       SourceRange.Columns.Count)\n  DestRange.Value = SourceRange.Value \n  NRow = NRow + DestRange.Rows.Count\n WorkBk.Close savechanges:=False\n  Loop\n</code></pre>\n"}, {"tags": ["vba", "excel", "offset"], "comments": [{"owner": {"reputation": 233, "user_id": 4792724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b508493df368e10a82208b9042401b?s=128&d=identicon&r=PG", "display_name": "FairlyLegit", "link": "https://stackoverflow.com/users/4792724/fairlylegit"}, "edited": false, "score": 0, "creation_date": 1430938541, "post_id": 30085075, "comment_id": 48283586, "body": "Don&#39;t have time to write a sample but I would trying using two <code>For</code> loops and the <code>Cells</code> method of selecting ranges."}, {"owner": {"reputation": 103, "user_id": 3466277, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4ed096b5c69986993544c375b39c135c?s=128&d=identicon&r=PG&f=1", "display_name": "Amanda S", "link": "https://stackoverflow.com/users/3466277/amanda-s"}, "reply_to_user": {"reputation": 233, "user_id": 4792724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b508493df368e10a82208b9042401b?s=128&d=identicon&r=PG", "display_name": "FairlyLegit", "link": "https://stackoverflow.com/users/4792724/fairlylegit"}, "edited": false, "score": 0, "creation_date": 1430945205, "post_id": 30085075, "comment_id": 48287668, "body": "Would you please provide a sample when you get time? I am not familiar and confused of how to use loops. Thank you!"}, {"owner": {"reputation": 1592, "user_id": 3221398, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/t15EX.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3221398/alex"}, "edited": false, "score": 0, "creation_date": 1430946823, "post_id": 30085075, "comment_id": 48288489, "body": "Is your number always fits into the squares on the right (i.e. a power of 4)?"}, {"owner": {"reputation": 103, "user_id": 3466277, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4ed096b5c69986993544c375b39c135c?s=128&d=identicon&r=PG&f=1", "display_name": "Amanda S", "link": "https://stackoverflow.com/users/3466277/amanda-s"}, "edited": false, "score": 0, "creation_date": 1431031257, "post_id": 30085075, "comment_id": 48333318, "body": "Each table is 24 x 16 (total 384 values taken from column A, filling from left to right in table, then top to bottom) Total table is 100."}], "answers": [{"tags": [], "owner": {"reputation": 274, "user_id": 4872561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9ed7fc4936f96dd6edfcfdc1d05c24?s=128&d=identicon&r=PG&f=1", "display_name": "Abe", "link": "https://stackoverflow.com/users/4872561/abe"}, "is_accepted": false, "score": 1, "last_activity_date": 1430954571, "creation_date": 1430954571, "answer_id": 30089326, "question_id": 30085075, "link": "https://stackoverflow.com/questions/30085075/how-to-replicate-block-of-codes-in-new-cells-in-vba/30089326#30089326", "title": "How to replicate block of codes in new cells in vba?", "body": "<p>to accomplish this task, you have to use loops. I will share with you a working sample for that with variables that allow you to set parameters for the tables and also shows an example of the command For and one example of the command While. If you have any doubts about some specific part of the code, don't hesitate to ask.</p>\n\n<pre><code>Sub DataToTable()\n\nDim actualDataRow As Long\nDim tablesPerRow As Integer\nDim actualRowTable As Integer\nDim actualRow As Integer\nDim initialTableRow As Integer\nDim initialTableColumn As Integer\n\ntablesPerRow = 3\nactualRow = 0\nactualRowTable = 0\n\ninitialTableRow = 2\ninitialTableColumn = 4\n\nactualDataRow = 1\n\n'Style columns (outside for)\nRange(Columns(initialTableColumn), Columns(initialTableColumn + (tablesPerRow * 4))).ColumnWidth = 4.67\n\nWhile Not IsEmpty(Cells(actualDataRow, 1))\n\n    'Style table\n    Range(Cells(initialTableRow + (actualRow * 4) - 1, initialTableColumn + (actualRowTable * 4) - 1), Cells(initialTableRow + (actualRow * 4) + 1, initialTableColumn + (actualRowTable * 4) + 1)).Borders.LineStyle = xlContinuous\n    Range(Cells(initialTableRow + (actualRow * 4) - 1, initialTableColumn + (actualRowTable * 4) - 1), Cells(initialTableRow + (actualRow * 4) - 1, initialTableColumn + (actualRowTable * 4) + 1)).Interior.ColorIndex = 27\n    Range(Cells(initialTableRow + (actualRow * 4) - 1, initialTableColumn + (actualRowTable * 4) - 1), Cells(initialTableRow + (actualRow * 4) + 1, initialTableColumn + (actualRowTable * 4) - 1)).Interior.ColorIndex = 27\n\n    'Insert table data\n    For x = 0 To 1\n        For y = 0 To 1\n            Cells(initialTableRow + (actualRow * 4) + x, initialTableColumn + (actualRowTable * 4) + y) = Cells(actualDataRow, 1)\n            actualDataRow = actualDataRow + 1\n        Next y\n    Next x\n    If actualRowTable &gt;= tablesPerRow - 1 Then\n        actualRowTable = 0\n        actualRow = actualRow + 1\n    Else\n        actualRowTable = actualRowTable + 1\n    End If\n\nWend\n\nEnd Sub\n</code></pre>\n\n<p>Best regards,</p>\n\n<p>Abe</p>\n"}], "owner": {"reputation": 103, "user_id": 3466277, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4ed096b5c69986993544c375b39c135c?s=128&d=identicon&r=PG&f=1", "display_name": "Amanda S", "link": "https://stackoverflow.com/users/3466277/amanda-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1430954571, "creation_date": 1430937867, "last_edit_date": 1531164843, "question_id": 30085075, "link": "https://stackoverflow.com/questions/30085075/how-to-replicate-block-of-codes-in-new-cells-in-vba", "title": "How to replicate block of codes in new cells in vba?", "body": "<p>My data (number 1 to number 24) is in Column A. I want to create 6 tables to contain my data in a way shown below. I've created codes for the first table. What's the best way to code the remaining 5 tables? My actual product is a much bigger table and needs to replicate 100 times, so hard-coding is not possible. (will offset property help? how?)</p>\n\n<p>Here's code for first table.</p>\n\n<pre><code>Sub DataToTable()\n\nRange(\"C1:E3\").Borders.LineStyle = xlContinuous\nRange(\"C:M\").ColumnWidth = 4.67\nRange(\"C1:E1\").Interior.ColorIndex = 27\nRange(\"C2:C3\").Interior.ColorIndex = 27\n\nRange(\"D2\").Value = Range(\"A1\")\nRange(\"E2\").Value = Range(\"A2\")\nRange(\"D3\").Value = Range(\"A3\")\nRange(\"E3\").Value = Range(\"A4\")\n\nEnd Sub\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/Xurlc.jpg\" alt=\"enter image description here\"></p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 2, "creation_date": 1431009924, "post_id": 30084868, "comment_id": 48320037, "body": "After pasting the shape, try:  [insert usual aircode warnings here]  Set PPShapeRange=PPSlide.Shapes(PPSlide.Shapes.Count)"}, {"owner": {"reputation": 19, "user_id": 4871833, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YZyE_BLYby0/AAAAAAAAAAI/AAAAAAAAAcc/EQVOexA9ZSA/photo.jpg?sz=128", "display_name": "jhomme", "link": "https://stackoverflow.com/users/4871833/jhomme"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1431543980, "post_id": 30084868, "comment_id": 48550370, "body": "That did it.  Thanks!"}, {"owner": {"reputation": 942, "user_id": 1390993, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/e763a4597a641414414909a0504ecad3?s=128&d=identicon&r=PG", "display_name": "sifar", "link": "https://stackoverflow.com/users/1390993/sifar"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1462904553, "post_id": 30084868, "comment_id": 61830377, "body": "@steve rindsberg, by default shp.copy copies the shape to the 1st slide and when i set ppshaperange to a pastespecial object or to the last shape as was shown by you using ppslide.shapes.count, it again copies the same shape. so it results in 2 shapes on the same slide. Any reason for this behaviour and how to rectify it? BTW the shp that i am copying is a grouped shape."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1462975285, "post_id": 30084868, "comment_id": 61865445, "body": "Shp.Copy copies the shape to the clipboard, not to the slide.  It sounds as though you have a different question from the one above.  I&#39;d suggest starting a new thread and including your code so we can see what&#39;s going on."}, {"owner": {"reputation": 1408, "user_id": 2900158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100000652927227/picture?type=large", "display_name": "Patrick Lepelletier", "link": "https://stackoverflow.com/users/2900158/patrick-lepelletier"}, "edited": false, "score": 1, "creation_date": 1466430941, "post_id": 30084868, "comment_id": 63299120, "body": "after <code>.shaperange</code>, you are missing a <code>(1)</code> , like in : <code>PPApp.ActiveWindow.Selection.ShapeRange(1).Height = dHeight</code> . That is because Shaperange is a collection (like an array if you don&#39;t understand)"}], "owner": {"reputation": 19, "user_id": 4871833, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-YZyE_BLYby0/AAAAAAAAAAI/AAAAAAAAAcc/EQVOexA9ZSA/photo.jpg?sz=128", "display_name": "jhomme", "link": "https://stackoverflow.com/users/4871833/jhomme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 538, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1430937202, "creation_date": 1430937202, "question_id": 30084868, "link": "https://stackoverflow.com/questions/30084868/set-powerpoint-shaperange-variable-to-pastespecial-method-in-vba", "title": "Set Powerpoint Shaperange Variable to Pastespecial Method in VBA", "body": "<p>I'm using this code to paste data from Excel into Powerpoint as a picture.</p>\n\n<pre><code>    PPSlide.Shapes.PasteSpecial DataType:=ppPasteMetafilePicture\n    'Where PPSlide is a `PowerPoint.Slide` object that was previously set\n    'For your info, I am using late binding.\n</code></pre>\n\n<p>The issue is that for some reason after the <code>PasteSpecial</code> line above, certain users of the Excel macro are having errors when the Excel code tries to reference the resulting ShapeRange object that should be returned from this code.  The error is appearing on lines such as this:</p>\n\n<pre><code>    PPApp.ActiveWindow.Selection.ShapeRange.Height = dHeight\n    'Where PPApp is a PowerPoint.Application object using late binding\n</code></pre>\n\n<p>When I look back at the PowerPoint slide, I can see that the <code>Shape</code> object that was pasted is not selected.  It only happens to some users.  On my machine, the shape object is selected following the <code>PasteSpecial</code>.  I thought that perhaps I could define a <code>ShapeRange</code> object while doing the <code>PasteSpecial</code> like so:</p>\n\n<pre><code>    Set PPShapeRange = PPSlide.Shapes.PasteSpecial(DataType:=ppPasteMetafilePicture)\n</code></pre>\n\n<p>But this is not working.  I get an error on this line.  Any ideas?</p>\n"}, {"tags": ["vba", "excel", "duplicates", "conditional"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4871872, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z4rCfWc9UrU/AAAAAAAAAAI/AAAAAAAADEk/0zaJaEq8qLA/photo.jpg?sz=128", "display_name": "stusic", "link": "https://stackoverflow.com/users/4871872/stusic"}, "edited": false, "score": 0, "creation_date": 1430939500, "post_id": 30084953, "comment_id": 48284176, "body": "I&#39;d like to work it in with the VBA macro that already runs if possible. I&#39;d also like to avoid helper columns if I can, but if that&#39;s the only way...  <a href=\"https://dl.dropboxusercontent.com/u/24293397/Excel%20Example%2001.xls\" rel=\"nofollow noreferrer\">Here&#39;s a link to the workbook</a>. I&#39;ve just copied the values, so there&#39;s no data connecion, etc."}, {"owner": {"reputation": 13, "user_id": 4871872, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z4rCfWc9UrU/AAAAAAAAAAI/AAAAAAAADEk/0zaJaEq8qLA/photo.jpg?sz=128", "display_name": "stusic", "link": "https://stackoverflow.com/users/4871872/stusic"}, "edited": false, "score": 0, "creation_date": 1430939850, "post_id": 30084953, "comment_id": 48284397, "body": "Sheet3 has the data that should be there after removing the duplicates."}], "tags": [], "owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "is_accepted": false, "score": 0, "last_activity_date": 1430937453, "creation_date": 1430937453, "answer_id": 30084953, "question_id": 30084813, "link": "https://stackoverflow.com/questions/30084813/excel-vba-conditionally-remove-duplicates-by-lookup-value/30084953#30084953", "title": "Excel VBA Conditionally Remove Duplicates By Lookup Value", "body": "<p>Are you looking for a general idea on how to do this, or a VBA macro?  </p>\n\n<p>One way I'm thinking that could get you going is in your second sheet (which, in the end, will have only unique entries) create a 'helper column'.  Let's say Column F is empty.  You can do a simple \"if\" statement that will check for the value on that row, in column A is in that other sheet.  If so, return \"DUPLICATE\" (or some note, \"Duplicate, delete\", etc.).  Then run that down the columns, then sort that whole table by your new column.  This will sort all the duplicate values in one big block, which you can highlight and delete.</p>\n\n<p>It could help if you show a little bit of what the data looks like on your Sheet1 and Sheet2 (can be made up data, doesn't have to be SQL server info).</p>\n"}], "owner": {"reputation": 13, "user_id": 4871872, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-z4rCfWc9UrU/AAAAAAAAAAI/AAAAAAAADEk/0zaJaEq8qLA/photo.jpg?sz=128", "display_name": "stusic", "link": "https://stackoverflow.com/users/4871872/stusic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 263, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430937453, "creation_date": 1430937022, "question_id": 30084813, "link": "https://stackoverflow.com/questions/30084813/excel-vba-conditionally-remove-duplicates-by-lookup-value", "title": "Excel VBA Conditionally Remove Duplicates By Lookup Value", "body": "<p>I wasn't quite sure how to title this question, but it's as concise as I could think of. Sorry if it's junk.</p>\n\n<p>I have a list created on Sheet2 based on info from Sheet1. What I'd like to do is examine ColumnA and remove duplicate rows if the matching value on Sheet1 ColumnB's offset ColumnE doesn't equal \"SUB-ASSY\".</p>\n\n<p>Basically:\nFind the value from Sheet2, ColumnA on Sheet1, ColumnB.\nGet the value from Sheet1, ColumnE\nIf it does NOT match \"SUB-ASSY\", delete any duplicates on Sheet2\nThis should leave one instance of all non-subassembly entries and leave subassemblies alone.</p>\n\n<p>Does this make any sense?</p>\n\n<p>I think I need to do some INDEX/MATCH or VLOOKUP, but I don't know if that'd be the right way to go (or exactly how I'd do it). Does anyone have a good way to do this?</p>\n\n<p>I appreciate any help. I can include the workbook if needed, but it looks up a bunch of stuff on an sql server, so it might not work correctly if you can't connect.</p>\n\n<p>Thanks Again,</p>\n\n<p>-stu</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "is_accepted": false, "score": 0, "last_activity_date": 1430988713, "creation_date": 1430988713, "answer_id": 30096232, "question_id": 30084663, "link": "https://stackoverflow.com/questions/30084663/error-3218-could-not-update-currently-locked/30096232#30096232", "title": "Error 3218: Could not update; currently locked", "body": "<p>Your approach with using <code>Dirty=False</code> is the right thing to do. But you have to apply it to the subform, as this is where the recordlock occurs. If your Code is in the Main form, you need to add this before your code to update the records.</p>\n\n<pre><code>Me.sbfrmQuoteItems.Form.Dirty = False\n</code></pre>\n\n<p>In that line <code>sbfrmQuoteItems</code> is supposed to be the name of the SubForm-<strong>Control</strong> in your main form!</p>\n"}], "owner": {"reputation": 71, "user_id": 4871699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb7bfeaeaf81f24fecde2cdcfe9d896?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis", "link": "https://stackoverflow.com/users/4871699/dennis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1262, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594644703, "creation_date": 1430936486, "last_edit_date": 1594644703, "question_id": 30084663, "link": "https://stackoverflow.com/questions/30084663/error-3218-could-not-update-currently-locked", "title": "Error 3218: Could not update; currently locked", "body": "<p>I've been looking through the other questions related to mine, but most are about multi-user and  <a href=\"https://stackoverflow.com/questions/18331875/unable-to-update-table-through-currentdb-execute\">this one</a> came close but not quite.</p>\n\n<p>System\nMS Access 2013 <br>\nwith Linked Tables to Office 365 Sharepoint</p>\n\n<p>tblQuote - frmQuote <br>\ntblQuoteItems - sbfrmQuoteItems</p>\n\n<p>No Record Locks</p>\n\n<p>I'm attempting to setup a select all/deselect all button that when clicked runs db.Execute Update on the tblQuoteItems where equal to Quote ID and Quote Version.</p>\n\n<p>I have a button on the main form that calls the below process.</p>\n\n<pre><code>Public Sub SelectLineItems(strTable As String, strID As String, _\n                       intID As Integer, bln As Boolean, Optional intVersion As Integer)\n\nDim db As Database\nDim strSQL As String\nDim strVersion As String\n\nSet db = CurrentDb\n\nstrSQL = \"UPDATE \" &amp; strTable &amp; \" SET [Selected] = \"\n\nIf intVersion &gt; 0 Then\n    strVersion = \" AND [QuoteVersion] = \" &amp; intVersion\nElse\n    strVersion = \"\"\nEnd If\n\nIf bln Then\n    strSQL = strSQL + \"False WHERE \" &amp; strID &amp; \" = \" &amp; intID &amp; strVersion &amp; \";\"\nElse\n    strSQL = strSQL + \"True WHERE \" &amp; strID &amp; \" = \" &amp; intID &amp; strVersion &amp; \";\"\nEnd If\n\ndb.Execute strSQL, dbFailOnError\n\ndb.Close\nSet db = Nothing\nExit Sub\n</code></pre>\n\n<p>It's pretty simple, nothing to crazy.  The problem occurs when I try to run this after a record has been modified by the form and it still has focus. Because of the dbFailOnError I get the error message, If I remove dbFailOnError it will update every record except the one that has been modified through the form.</p>\n\n<p>If I modify the record then select a different record manually by clicking with the mouse, the record is no longer locked and the Update works with no errors.</p>\n\n<p>I have tried to replicate the process of clicking on a new record and have put the below code</p>\n\n<pre><code>If Me.Dirty Then Me.Dirty = False\n</code></pre>\n\n<p>In every Event I could think of like:</p>\n\n<p>The subform_Current, subform_Dirty, subform.Control.Dirty/Lost_focus/subform_Before and After Update, The exit event of the subform control on the main form...etc</p>\n\n<p>Placing the code in different areas doesn't make any difference, the first time the code is called it updates the record and I can confirm this in the table, the new value is present.</p>\n\n<p>I've attempted to requery the subform</p>\n\n<p>I've tried</p>\n\n<pre><code>DoCmd.GoToRecord , , acFirst\n</code></pre>\n\n<p>Then setting focus to the first control of the record.</p>\n\n<p>I've even tried changing the update from the db.Execute to using a recordset object</p>\n\n<pre><code>Dim db As Dao.Database\nDim rs As Dao.Recordset\n\nDim strSQL As String\nDim strVersion As String\n\n\n\nIf intVersion &gt; 0 Then\n    strVersion = \" AND [QuoteVersion] = \" &amp; intVersion\nElse\n    strVersion = \"\"\nEnd If\n\nstrSQL = \"SELECT * FROM \" &amp; strTable &amp; \" WHERE \" &amp; strID &amp; \"= \" &amp; intID &amp; strVersion\n\nSet db = CurrentDb\nSet rs = db.OpenRecordset(strSQL, dbOpenDynaset)\n\n    With rs\n        Do Until .EOF\n            .Edit\n            !Selected = bln\n            .Update\n            .MoveNext\n        Loop\n    End With\n\nrs.Close\ndb.Close\nSet rs = Nothing\nSet db = Nothing\n</code></pre>\n\n<p>But again it will cycle through every unlocked record and update, until it gets to the one modified by the form which then throws the same error.</p>\n\n<p>I've tried opening the recordset then closing it then reopening it.  But it doesn't seem to matter it's the form that's holding onto the locked record.</p>\n\n<p>The only solution that has worked for me was to Set the subform recordsource to nothing, then run the update, then reset the recordsource to what it was.</p>\n\n<p>The Selected column is within the QuoteItems table itself, and not in it's own table with reference to the QuoteItems ID</p>\n\n<p>My question is how do I get the form to release the record through code that mimics the action of manually clicking on a new record without resetting the subform's recordsource.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 804, "user_id": 4088106, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/4l9Y0.jpg?s=128&g=1", "display_name": "therebelcoder", "link": "https://stackoverflow.com/users/4088106/therebelcoder"}, "edited": false, "score": 0, "creation_date": 1430936076, "post_id": 30084321, "comment_id": 48282104, "body": "Doing this by head (and from ancient memory). But that &quot;subtotal&quot; seems really out of place? Shouldn&#39;t there be at least a comma behind it?"}, {"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1430938609, "post_id": 30084321, "comment_id": 48283628, "body": "Further reading on avoiding select: <a href=\"http://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\" title=\"how to avoid using select in excel vba macros\">stackoverflow.com/questions/10714251/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 311, "user_id": 4625094, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3668fc2b694b942575f32afdef39da31?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/4625094/rick"}, "edited": false, "score": 0, "creation_date": 1430936537, "post_id": 30084630, "comment_id": 48282370, "body": "When doing that I receive a <code>object doesn&#39;t support this property or method</code> error, and still highlights the same line of code the syntax error popped up at."}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "reply_to_user": {"reputation": 311, "user_id": 4625094, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3668fc2b694b942575f32afdef39da31?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/4625094/rick"}, "edited": false, "score": 0, "creation_date": 1430937241, "post_id": 30084630, "comment_id": 48282826, "body": "I also missed that <code>Selection</code> should not have a <code>.</code> in front of it.  It is not a property of the <code>ActiveSheet</code> so it belongs outside the scope of the <code>With</code>.  See edit."}], "tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1430937250, "last_edit_date": 1430937250, "creation_date": 1430936384, "answer_id": 30084630, "question_id": 30084321, "link": "https://stackoverflow.com/questions/30084321/excel-vba-syntax-error-and-using-other-methods-other-than-select/30084630#30084630", "title": "Excel VBA syntax error and using other methods other than select", "body": "<p>Working code should be:</p>\n\n<pre><code>With ActiveSheet\n.Range(\"A10\").Select\n.Range(Selection, Selection.End(xlToRight)).Select\n.Range(Selection, Selection.End(xlDown)).Select\nSelection.Subtotal GroupBy:=3, Function:=xlSum, TotalList:=Array(8, 10), _\n    Replace:=True, PageBreaks:=False, SummaryBelowData:=True\n.Outline.ShowLevels RowLevels:=2\n\n.Range(\"C8\").Select\nEnd With\n</code></pre>\n\n<p><code>Subtotal</code> is a sub that needs to be called on the <code>Selection</code>.  Therefore it needs a period between the two to make the call.</p>\n\n<p>Also <code>Selection</code> is not a property of the <code>ActiveSheet</code> so the preceding period should be dropped inside the <code>With</code> block.</p>\n"}], "owner": {"reputation": 311, "user_id": 4625094, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/3668fc2b694b942575f32afdef39da31?s=128&d=identicon&r=PG&f=1", "display_name": "Rick", "link": "https://stackoverflow.com/users/4625094/rick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 30084630, "answer_count": 1, "score": 0, "last_activity_date": 1430937250, "creation_date": 1430935316, "question_id": 30084321, "link": "https://stackoverflow.com/questions/30084321/excel-vba-syntax-error-and-using-other-methods-other-than-select", "title": "Excel VBA syntax error and using other methods other than select", "body": "<p>I have a piece of code that is supposed to format a tab of information. I took it from a piece of code previously used and I am modifying it to fit my needs. I am getting a <code>syntax error</code> on the <code>.Selection Subtotal   GroupBy:=3, Function:=xlSum, TotalList:=Array(8, 10), _\n        Replace:=True, PageBreaks:=False, SummaryBelowData:=True</code> line. </p>\n\n<p>VBA isn't exactly a strong point of mine so I would like to figure out a way to perform this properly. I know selection is frowned upon so if anyone has a way around it without me having to redo a bunch of code that would be awesome. </p>\n\n<pre><code>With ActiveSheet\n.Range(\"A10\").Select\n.Range(Selection, Selection.End(xlToRight)).Select\n.Range(Selection, Selection.End(xlDown)).Select\n.Selection Subtotal GroupBy:=3, Function:=xlSum, TotalList:=Array(8, 10), _\n    Replace:=True, PageBreaks:=False, SummaryBelowData:=True\n.Outline.ShowLevels RowLevels:=2\n\n.Range(\"C8\").Select\nEnd With\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2405, "user_id": 3761982, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/u8soe.png?s=128&g=1", "display_name": "CrApHeR", "link": "https://stackoverflow.com/users/3761982/crapher"}, "edited": false, "score": 0, "creation_date": 1430936904, "post_id": 30084251, "comment_id": 48282579, "body": "Why are you using VBA instead of VLookUp?"}, {"owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "reply_to_user": {"reputation": 2405, "user_id": 3761982, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/u8soe.png?s=128&g=1", "display_name": "CrApHeR", "link": "https://stackoverflow.com/users/3761982/crapher"}, "edited": false, "score": 0, "creation_date": 1430937659, "post_id": 30084251, "comment_id": 48283049, "body": "If I was to use lookups by adding IDs in the 1st column, not only would that be extremely lengthy in that there are 15 columns  but there is still the requirement to delete rows with blank costs in column b"}], "answers": [{"tags": [], "owner": {"reputation": 181, "user_id": 4375028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e83219228a0000afcfffd06aefcada1?s=128&d=identicon&r=PG&f=1", "display_name": "AMC08", "link": "https://stackoverflow.com/users/4375028/amc08"}, "is_accepted": false, "score": 0, "last_activity_date": 1430937739, "creation_date": 1430937739, "answer_id": 30085042, "question_id": 30084251, "link": "https://stackoverflow.com/questions/30084251/alternative-to-copy-and-paste-values-based-on-criteria/30085042#30085042", "title": "Alternative to Copy and Paste values based on criteria", "body": "<p>You could use Excel's built in filtering to remove blanks before copying.  It would look something like this:</p>\n\n<pre><code>sheets(\"sh1\").range(\"a1:k50000\").Select\nSelection.AutoFilter\nsheets(\"sh1\").Range(\"$a$1:$k$50000\").AutoFilter Field:=2, Criteria1:=\"=\"\nsheets(\"sh1\").Range(\"$a$1:$k$50000\").Copy\nsheets(\"sh2\").Range(\"$a$1\").PasteSpecial\n</code></pre>\n\n<p>The Criteria1:=\"=\" is the expression for blanks. \"Field:=2\" is Column 2/B to check for blanks. The key here is that the Copy command includes just the filtered cells so you will be pasting just the filtered data.</p>\n\n<p>Also, if you do not have a header row in Range(\"$a$1:$k$50000\") you may need to add one to get reliable results.</p>\n"}], "owner": {"reputation": 693, "user_id": 4859229, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/49cfd1f1a4275533311faafc9920d436?s=128&d=identicon&r=PG&f=1", "display_name": "Krishn", "link": "https://stackoverflow.com/users/4859229/krishn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 630, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430941976, "creation_date": 1430935111, "last_edit_date": 1430935693, "question_id": 30084251, "link": "https://stackoverflow.com/questions/30084251/alternative-to-copy-and-paste-values-based-on-criteria", "title": "Alternative to Copy and Paste values based on criteria", "body": "<p>I'm trying to figure out a efficient alternative to copy and paste vals based on a criteria. For example if column b contain costs, I want the 2nd tab to contain all data where costs are absent in column b. </p>\n\n<p>Currently I have sheets(\"sh2\").range(\"a1:k50000\").value=sheets(\"sh1\").range(\"a1:k50000\").value</p>\n\n<p>and then I delete all rows (using a for selection loop) in sh2 where costs are populated. However with large data sets deleting 1000s of rows can be a lengthy process.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 49589, "user_id": 109122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/11646005668a23c7cb18912713b1235b?s=128&d=identicon&r=PG", "display_name": "RBarryYoung", "link": "https://stackoverflow.com/users/109122/rbarryyoung"}, "edited": false, "score": 0, "creation_date": 1430941271, "post_id": 30083369, "comment_id": 48285225, "body": "From the looks of it, you probably need to disable Screen Updating while this subroutine is running."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 4503159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0057a99e2a1801c3717f7095cfde6d92?s=128&d=identicon&r=PG&f=1", "display_name": "East Coast Techwriter", "link": "https://stackoverflow.com/users/4503159/east-coast-techwriter"}, "edited": false, "score": 0, "creation_date": 1430939202, "post_id": 30084635, "comment_id": 48283978, "body": "Thank you so much ZygD. I greatly appreciate the time you spent in responding. It&#39;s near the end of my workday but I will try your macro tomorrow morning. I also appreciate your &quot;educational&quot; analysis in 1, 2, 3 above. I am trying to get to the point where I can recognize better approaches to take and your comments help me in that long-term effort. I&#39;ll let you know how the changed macro performs. Thank you"}], "tags": [], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "is_accepted": false, "score": 0, "last_activity_date": 1430936402, "creation_date": 1430936402, "answer_id": 30084635, "question_id": 30083369, "link": "https://stackoverflow.com/questions/30083369/making-a-slow-running-macro-run-more-quickly-and-efficiently/30084635#30084635", "title": "Making a slow running macro run more quickly and efficiently", "body": "<p>The following code should be faster, because:</p>\n\n<ol>\n<li><code>Do While</code> was changed with <code>For</code>, this way you count the number of paragraphs once and you never return to the calculation. When you had <code>Do While Not para Is Nothing</code>, in every iteration you had to make sure if <code>Not para Is Nothing</code>.</li>\n<li>Less <code>Set</code>; no <code>Set</code> in the main part which is iterating. These statements add some time burden.</li>\n<li>You do not <code>MyText = \"(U//FOUO) \"</code> in every iteration. Instead, you state it once and forever at the beginning by making it a constant (constants are generally faster than usual strings).</li>\n</ol>\n\n<p><pre>Public Sub InsertFOUObody2()</p>\n\n<code>    'Inserts U//FOUO before all body paragraphs\n    Const MyText As String = \"(U//FOUO) \"\n    Dim i As Long\n    Dim doc As Document\n    Set doc = ActiveDocument\n\n    For i = 1 To doc.Paragraphs.Count\n        With doc.Paragraphs(i)\n            If .Style = doc.Styles(wdStyleBodyText) Then\n                .Range.InsertBefore (MyText)\n            End If\n        End With\n    Next\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 4503159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0057a99e2a1801c3717f7095cfde6d92?s=128&d=identicon&r=PG&f=1", "display_name": "East Coast Techwriter", "link": "https://stackoverflow.com/users/4503159/east-coast-techwriter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1016, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430938536, "creation_date": 1430932420, "last_edit_date": 1430938536, "question_id": 30083369, "link": "https://stackoverflow.com/questions/30083369/making-a-slow-running-macro-run-more-quickly-and-efficiently", "title": "Making a slow running macro run more quickly and efficiently", "body": "<p>I have created a macro that inserts a standard corporate classification that indicates that the information in the document is unclassified but is \"for official use only.\" This is expressed as (U//FOUO) which appears before every body paragraph. I have also created a macro that inserts the same text expression before each level of numbered headings used the book. My book is a large (~665 pages) Microsoft Word file. It is also very \"dense\" with many paragraphs, tables, and illustrations. Although my macros work successfully, they are very slow and take from about 6 to 10 minutes to complete. When the macros complete, a Runtime Error '28' (out of stack space) is displayed. I don't know if the length of time is a result of inefficient coding on my part or a reflection of the density/complexity/length of the book.</p>\n\n<p>Could you suggest changes to the code below to make it run more efficiently? Or maybe just indicate whether the \"delays\" might simply be a natural and expected result of the length of the document? My code is as follows:</p>\n\n<pre><code>Public Sub InsertFOUObody()\n\n    'Inserts U//FOUO before all body paragraphs\n    Dim doc As Document\n    Dim para As Paragraph\n    Dim paraNext As Paragraph\n    Dim MyText As String\n    Set doc = ActiveDocument\n    Set para = doc.Paragraphs.First\n\n    Do While Not para Is Nothing\n        Set paraNext = para.Next\n        MyText = \"(U//FOUO) \"\n        If para.Style = doc.Styles(wdStyleBodyText) Then\n            para.Range.InsertBefore (MyText)\n        End If\n        Set para = paraNext\n    Loop\n\nEnd Sub\n</code></pre>\n\n<p>When I try to debug the code, I get the impression that the offending line is <code>Set paraNext = para.next</code>. However, as a newbie to VBA I can't recognize why this line of code is at fault. The code seems to be generating far more calls than necessary.</p>\n"}, {"tags": ["sql", "vba", "ms-access", "ms-access-2007"], "comments": [{"owner": {"reputation": 233, "user_id": 4792724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b508493df368e10a82208b9042401b?s=128&d=identicon&r=PG", "display_name": "FairlyLegit", "link": "https://stackoverflow.com/users/4792724/fairlylegit"}, "edited": false, "score": 0, "creation_date": 1430931707, "post_id": 30083049, "comment_id": 48279286, "body": "Could you give some sample code or add a small table to your question that demonstrates more visually what you are trying to do? Right now I&#39;m not 100% sure what you are asking."}, {"owner": {"reputation": 55, "user_id": 3449970, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Q4zdI.jpg?s=128&g=1", "display_name": "Ryonite", "link": "https://stackoverflow.com/users/3449970/ryonite"}, "reply_to_user": {"reputation": 233, "user_id": 4792724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b508493df368e10a82208b9042401b?s=128&d=identicon&r=PG", "display_name": "FairlyLegit", "link": "https://stackoverflow.com/users/4792724/fairlylegit"}, "edited": false, "score": 0, "creation_date": 1430932042, "post_id": 30083049, "comment_id": 48279515, "body": "I simply need to modify the value of a check box in a table from a form. This needs to be done from a button and only modify the record that matches a text box on the form. please  let me know if this cleared things up."}, {"owner": {"reputation": 233, "user_id": 4792724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b508493df368e10a82208b9042401b?s=128&d=identicon&r=PG", "display_name": "FairlyLegit", "link": "https://stackoverflow.com/users/4792724/fairlylegit"}, "edited": false, "score": 0, "creation_date": 1430932950, "post_id": 30083049, "comment_id": 48280065, "body": "Do you mean change the label for the checkbox or change its value from unchecked to checked? Also is this in a Userform or on an actual excel worksheet?"}, {"owner": {"reputation": 55, "user_id": 3449970, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Q4zdI.jpg?s=128&g=1", "display_name": "Ryonite", "link": "https://stackoverflow.com/users/3449970/ryonite"}, "reply_to_user": {"reputation": 233, "user_id": 4792724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b508493df368e10a82208b9042401b?s=128&d=identicon&r=PG", "display_name": "FairlyLegit", "link": "https://stackoverflow.com/users/4792724/fairlylegit"}, "edited": false, "score": 0, "creation_date": 1430933042, "post_id": 30083049, "comment_id": 48280115, "body": "Changed its value from check to unchecked. and It is a user form."}], "answers": [{"tags": [], "owner": {"reputation": 233, "user_id": 4792724, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35b508493df368e10a82208b9042401b?s=128&d=identicon&r=PG", "display_name": "FairlyLegit", "link": "https://stackoverflow.com/users/4792724/fairlylegit"}, "is_accepted": true, "score": 1, "last_activity_date": 1430933369, "creation_date": 1430933369, "answer_id": 30083696, "question_id": 30083049, "link": "https://stackoverflow.com/questions/30083049/set-value-of-checkbox-to-false/30083696#30083696", "title": "Set value of checkbox to false", "body": "<p>You can put this code in your userform's <code>CommandButton1_click()</code> event and it should work.</p>\n\n<pre><code>If TextBoxName.Value = \"Value of item you are comparing to\" Then\n    CheckBoxName.Value = False\nEnd If\n</code></pre>\n\n<p>You need to change certain things in this code like adding the name of the text box, name of the check box, and entering the value of the item you want to compare it to.</p>\n"}], "owner": {"reputation": 55, "user_id": 3449970, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Q4zdI.jpg?s=128&g=1", "display_name": "Ryonite", "link": "https://stackoverflow.com/users/3449970/ryonite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 30083696, "answer_count": 1, "score": -3, "last_activity_date": 1430933369, "creation_date": 1430931480, "question_id": 30083049, "link": "https://stackoverflow.com/questions/30083049/set-value-of-checkbox-to-false", "title": "Set value of checkbox to false", "body": "<p>I need to set the value of a checkbox to false where the value of textbox1 is equal to item# in the table I have the checkbox in. I need to do this via a command button click. What is the simplest way to accomplish this?</p>\n"}, {"tags": ["excel", "cmd", "plink", "vba"], "comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1430931412, "post_id": 30082859, "comment_id": 48279088, "body": "have you tried including the full path to <code>plink</code>, instead of relying on it being on the <code>%Path%</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 4829438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3cac2fc1fcecd0e4871554bd5f6dae?s=128&d=identicon&r=PG&f=1", "display_name": "Mikel1256", "link": "https://stackoverflow.com/users/4829438/mikel1256"}, "edited": false, "score": 0, "creation_date": 1430935021, "post_id": 30083160, "comment_id": 48281450, "body": "Adding the path into the batch file fixed it. Odd that it still worked when I just double clicked the BAT file outside of the macro, but it wouldn&#39;t work in the macro without it. Thanks!"}], "tags": [], "owner": {"reputation": 26, "user_id": 4871605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a9a06051a99c6f06f7833fc3185aea6?s=128&d=identicon&r=PG&f=1", "display_name": "Giordano", "link": "https://stackoverflow.com/users/4871605/giordano"}, "is_accepted": true, "score": 0, "last_activity_date": 1430931800, "creation_date": 1430931800, "answer_id": 30083160, "question_id": 30082859, "link": "https://stackoverflow.com/questions/30082859/calling-bat-with-vba-cmd-loads-and-closes-immediately/30083160#30083160", "title": "Calling BAT with VBA - CMD Loads and Closes Immediately", "body": "<p>Either pass the path to plink.exe in the batch file, or make sure that %Path% includes the folder that contains plink.exe. </p>\n"}], "owner": {"reputation": 5, "user_id": 4829438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3cac2fc1fcecd0e4871554bd5f6dae?s=128&d=identicon&r=PG&f=1", "display_name": "Mikel1256", "link": "https://stackoverflow.com/users/4829438/mikel1256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 775, "favorite_count": 0, "accepted_answer_id": 30083160, "answer_count": 1, "score": 0, "last_activity_date": 1430931800, "creation_date": 1430930937, "last_edit_date": 1531164843, "question_id": 30082859, "link": "https://stackoverflow.com/questions/30082859/calling-bat-with-vba-cmd-loads-and-closes-immediately", "title": "Calling BAT with VBA - CMD Loads and Closes Immediately", "body": "<p>I'm using VBA to write a command file and a BAT file which calls PLink to log in to a server and run a script. The Plink portion is now functioning as expected thanks to some help on here. Unfortunately VBA seems to be having some difficulty with opening the cmd and finding plink as a usable command.</p>\n\n<p>I've tried multiple different ways of calling it, but the results are all the same. The cmd prompt opens and then closes immediately giving me an error stating:</p>\n\n<pre><code>\"plink is not recognized as an internal or external command, operable program, or batch file.\"\n</code></pre>\n\n<p>The files generate perfectly, and if I run the bat file outside of VBA, it runs as expected. With the files, I keep a copy of plink.exe on the desktop. I've even tried adding a copy of cmd.exe to the desktop with the links and plink.exe as well, but I get the same problem.</p>\n\n<p>Here are some of the ways I've tried, though modified for my code: <a href=\"https://stackoverflow.com/questions/22380923/executing-batch-file-in-vba-using-shell-commend-is-not-working\">1</a>  <a href=\"https://stackoverflow.com/questions/9403341/running-a-batch-file-in-a-given-directory-using-vba\">2</a>  <a href=\"https://stackoverflow.com/questions/13530371/execute-bat-file-from-excel-vba-macro\">3</a></p>\n\n<p>Here's the most recent code for the macro:</p>\n\n<pre><code>Dim vPath As String\nDim vscript As String\n\nUserID = Range(\"F1\").Value\nPasswd = Range(\"F2\").Value\nServer = Range(\"F3\").Value\nStartDate = Range(\"F4\").Value\nEndDate = Range(\"F5\").Value\n\nSet fso = CreateObject(\"Scripting.FileSystemObject\")\nfso.CopyFile \"C:\\Program Files (x86)\\PuTTY\\plink.exe\", \"C:\\Users\\MikeDesktop\\\"\n'fso.CopyFile \"C:\\Windows\\System32\\cmd.exe\", \"C:\\Users\\Mike\\Desktop\\\"\n\nvPath = \"C:\\Users\\Mike\\Desktop\"\nOpen vPath &amp; \"\\pcmd.txt \" For Output As #1\nPrint #1, \"cd /opt/test/srt\"\nPrint #1, \"./srt.tool \" &amp; StartDate &amp; \" \" &amp; EndDate &amp; \" &gt; /opt/test/srt/test.txt &amp;\"\nPrint #1, \"rm test.txt\"\nPrint #1, \"sleep 60; exit\"\nClose #1\n\nOpen vPath &amp; \"\\Chg.bat\" For Output As #1\nPrint #1, \"plink \" &amp; UserID &amp; \"@\" &amp; Server &amp; \" -pw \" &amp; Passwd &amp; \" &lt; \" &amp; vPath &amp; \"\\pcmd.txt\"\nClose #1\nvscript = vPath &amp; \"\\Chg.bat\"\n\nDim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\nDim waitOnReturn As Boolean: waitOnReturn = True\nDim windowStyle As Integer: windowStyle = 5\n\nwsh.Run vscript, windowStyle, waitOnReturn\n\nApplication.Wait (Now + TimeValue(\"0:01:00\"))\nKill vPath &amp; \"\\Chg.bat\"\nKill vPath &amp; \"\\pcmd.txt\"\nKill vPath &amp; \"\\plink.exe\"\n</code></pre>\n\n<p>If someone can tell me why the cmd isn't recognizing plink as an option, that would be much appreciated</p>\n"}, {"tags": ["excel", "image", "vba", "copy", "paste"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 3758610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d90d8dea7c8f3745a3b1cfd6818d4315?s=128&d=identicon&r=PG&f=1", "display_name": "user3758610", "link": "https://stackoverflow.com/users/3758610/user3758610"}, "edited": false, "score": 0, "creation_date": 1430934656, "post_id": 30083920, "comment_id": 48281206, "body": "Thank you so much. I feel stupid! haha I have stared at this code for 2 days now and overlooked this every time. I duplicated my paste function inadvertently. Thanks again!"}, {"owner": {"reputation": 181, "user_id": 4375028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e83219228a0000afcfffd06aefcada1?s=128&d=identicon&r=PG&f=1", "display_name": "AMC08", "link": "https://stackoverflow.com/users/4375028/amc08"}, "reply_to_user": {"reputation": 15, "user_id": 3758610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d90d8dea7c8f3745a3b1cfd6818d4315?s=128&d=identicon&r=PG&f=1", "display_name": "user3758610", "link": "https://stackoverflow.com/users/3758610/user3758610"}, "edited": false, "score": 0, "creation_date": 1430935196, "post_id": 30083920, "comment_id": 48281562, "body": "No problem.  I&#39;ve stared at simpler code for much longer than 2 days.  Just one of those things......"}, {"owner": {"reputation": 15, "user_id": 3758610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d90d8dea7c8f3745a3b1cfd6818d4315?s=128&d=identicon&r=PG&f=1", "display_name": "user3758610", "link": "https://stackoverflow.com/users/3758610/user3758610"}, "edited": false, "score": 0, "creation_date": 1430938338, "post_id": 30083920, "comment_id": 48283440, "body": "If I wanted to print each worksheet as it gets created/modified where would I place the PDF export code? I am having trouble getting it to work right. Any ideas?"}], "tags": [], "owner": {"reputation": 181, "user_id": 4375028, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e83219228a0000afcfffd06aefcada1?s=128&d=identicon&r=PG&f=1", "display_name": "AMC08", "link": "https://stackoverflow.com/users/4375028/amc08"}, "is_accepted": true, "score": 0, "last_activity_date": 1430934121, "creation_date": 1430934121, "answer_id": 30083920, "question_id": 30082837, "link": "https://stackoverflow.com/questions/30082837/excel-vba-copy-image-from-worksheet1-to-worksheet-2/30083920#30083920", "title": "Excel-VBA Copy image from worksheet1 to worksheet 2", "body": "<p>You have 2 paste operations in your code.  One that you know of:</p>\n\n<p>WshtCrnt.Paste</p>\n\n<p>and one that is part of this range copy statement:</p>\n\n<p>.\n.\nWith WshtSht1\n         .Range(.Cells(1, 1), .Cells(RowSht1DataFirst - 1, ColSht1LastHdr)).Copy_\n                           Destination:=WshtCrnt.Range(\"A1\")\n.\n.</p>\n\n<p>By specifying a \"Destination\" you are requesting a copy AND paste of your range.</p>\n"}], "owner": {"reputation": 15, "user_id": 3758610, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d90d8dea7c8f3745a3b1cfd6818d4315?s=128&d=identicon&r=PG&f=1", "display_name": "user3758610", "link": "https://stackoverflow.com/users/3758610/user3758610"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 30083920, "answer_count": 1, "score": 0, "last_activity_date": 1430934121, "creation_date": 1430930871, "question_id": 30082837, "link": "https://stackoverflow.com/questions/30082837/excel-vba-copy-image-from-worksheet1-to-worksheet-2", "title": "Excel-VBA Copy image from worksheet1 to worksheet 2", "body": "<p>I am having difficulty getting the code in the workbook attached to function as intended. Everything is working but it is copying the photo twice. Any suggestions?</p>\n\n<p>Basically, it looks at the master worksheet then creates a unique sheet for each supplier based on the date entered and copies over all records to the next empty line. What is happening is that it copies the photo over but it pastes it twice. I can't figure out why.</p>\n\n<p>Code is shown in attached workbook.</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>Option Explicit\r\n  Const ColSht1Name As Long = 1\r\n  Const RowSht1DataFirst As Long = 2\r\n  Const ColSht1Date As Date = 3\r\n  Const ColSht1Doc As String = 4\r\n  \r\n  \r\nSub BuildSingleSupplierSheets()\r\n\r\n  ' For each supplier in worksheet Sheet1, create their own worksheet.\r\n  ' Copy each data row for a supplier, including a picure if any, to its own worksheet.\r\n\r\n  Dim ColSht1LastHdr As Long\r\n  Dim ColSht1LastCrnt As Long\r\n  Dim ColShapeTopLeftCell As Long\r\n  Dim Found As Boolean\r\n  Dim HeightShape As Single\r\n  Dim InxShape As Long\r\n'  Dim RowPerPicture() As String\r\n  Dim RngDest As Range\r\n  Dim RowCrntNext As Long\r\n  Dim RowSht1Crnt As Long\r\n  Dim RowSht1Last As Long\r\n  Dim ShapeCrnt As Shape\r\n  Dim WshtSht1 As Worksheet\r\n  Dim WshtCrnt As Worksheet\r\n  Dim WshtNameCrnt As String\r\n  Dim x As String\r\n  Dim bottomL As Integer\r\n  Dim c As Range\r\n  \r\n  Set WshtSht1 = Worksheets(\"Sheet1\")\r\n  \r\n  \r\n  x = InputBox(\"Enter Report Date\")\r\n  \r\n  With Worksheets(\"Sheet1\")\r\n    RowSht1Last = .Cells(Rows.Count, ColSht1Name).End(xlUp).Row\r\n    ColSht1LastHdr = 0\r\n    For RowSht1Crnt = 1 To RowSht1DataFirst - 1\r\n      ColSht1LastCrnt = .Cells(RowSht1Crnt, Columns.Count).End(xlToLeft).Column\r\n      If ColSht1LastHdr &lt; ColSht1LastCrnt Then\r\n        ColSht1LastHdr = ColSht1LastCrnt\r\n      End If\r\n    Next\r\n  End With\r\n  \r\n  ' Copy every row from worksheet Sheet1 to the worksheet for the row's\r\n  ' supplier.  Create and initialise supplier worksheet if it does not\r\n  ' already exist.\r\n  \r\n    \r\n For RowSht1Crnt = RowSht1DataFirst To RowSht1Last\r\n    If WshtSht1.Cells(RowSht1Crnt, ColSht1Date).Value = x And WshtSht1.Cells(RowSht1Crnt, \"B\").Value = \"DR\" Then\r\n    WshtNameCrnt = WshtSht1.Cells(RowSht1Crnt, ColSht1Name).Value\r\n    \r\n    ' Create and initiialise worksheet WshtNameCrnt if it does not already exist\r\n    If Not SheetExists(WshtNameCrnt) Then\r\n      Set WshtCrnt = Worksheets.Add(After:=Worksheets(Worksheets.Count))\r\n       WshtCrnt.Name = WshtNameCrnt\r\n       With WshtSht1\r\n         .Range(.Cells(1, 1), .Cells(RowSht1DataFirst - 1, ColSht1LastHdr)).Copy _\r\n                                                 Destination:=WshtCrnt.Range(\"A1\")\r\n       End With\r\n    Else\r\n      Set WshtCrnt = Worksheets(WshtNameCrnt)\r\n    End If\r\n    \r\n    \r\n    \r\n        \r\n    ' Copy current row of worksheet Sheet1 to the next free row\r\n    ' of the supplier worksheet\r\n    RowCrntNext = LastRow(WshtCrnt) + 1\r\n    With WshtSht1\r\n      ColSht1LastCrnt = .Cells(RowSht1Crnt, Columns.Count).End(xlToLeft).Column\r\n     .Range(.Cells(RowSht1Crnt, 1), .Cells(RowSht1Crnt, ColSht1LastCrnt)).Copy _\r\n                                          Destination:=WshtCrnt.Cells(RowCrntNext, 1)\r\n    End With\r\n    \r\n    ' Ensure columns wide enought for data\r\n    With WshtCrnt\r\n        .Cells.Range(.Cells(1, 1), .Cells(1, ColSht1LastCrnt)).EntireColumn.AutoFit\r\n        .Cells.Range(.Cells(1, 1), .Cells(1, ColSht1LastCrnt)).Borders(xlEdgeBottom).Color = RGB(0, 0, 0)\r\n        .Cells.Range(.Cells(1, 1), .Cells(1, ColSht1LastCrnt)).Borders(xlEdgeTop).Color = RGB(0, 0, 0)\r\n        .Cells.Range(.Cells(1, 1), .Cells(1, ColSht1LastCrnt)).Borders(xlInsideHorizontal).Color = RGB(0, 0, 0)\r\n        .Cells.Range(.Cells(1, 1), .Cells(1, ColSht1LastCrnt)).Borders(xlInsideVertical).Color = RGB(0, 0, 0)\r\n    End With\r\n    \r\n    ' Check Shapes collection to see if there is a picture on this row\r\n    With WshtSht1\r\n      Found = False\r\n      For InxShape = 1 To .Shapes.Count\r\n        With .Shapes(InxShape)\r\n          If .Type = msoPicture Then\r\n            If .TopLeftCell.Row = RowSht1Crnt Then\r\n              Found = True\r\n              Exit For\r\n            End If\r\n          End If\r\n        End With\r\n      Next\r\n    End With\r\n    \r\n    If Found Then\r\n      ' Picture on current row of Sheet1.  Copy to supplier worksheet\r\n      Set ShapeCrnt = WshtSht1.Shapes(InxShape)\r\n      With ShapeCrnt\r\n        ColShapeTopLeftCell = .TopLeftCell.Column\r\n        HeightShape = .Height\r\n      End With\r\n\r\n      ShapeCrnt.Copy\r\n      WshtCrnt.Paste\r\n\r\n      With WshtCrnt\r\n        Set RngDest = .Cells(RowCrntNext, ColShapeTopLeftCell)\r\n        RngDest.RowHeight = HeightShape + 4!\r\n        With .Shapes(.Shapes.Count)\r\n          .Top = RngDest.Top + 2!\r\n          .Left = RngDest.Left + 2!\r\n          Call .ScaleWidth(1!, msoCTrue) '\r\n          Call .ScaleHeight(1!, msoCTrue) '\r\n        End With\r\n      End With\r\n\r\n    End If\r\n  End If\r\n  \r\n  \r\n  \r\n  Next RowSht1Crnt\r\n\r\nEnd Sub\r\n\r\nFunction LastRow(sh As Worksheet)\r\n    On Error Resume Next\r\n    LastRow = sh.Cells.Find(What:=\"*\", _\r\n                            After:=sh.Range(\"A1\"), _\r\n                            Lookat:=xlPart, _\r\n                            LookIn:=xlValues, _\r\n                            SearchOrder:=xlByRows, _\r\n                            SearchDirection:=xlPrevious, _\r\n                            MatchCase:=False).Row\r\n    On Error GoTo 0\r\nEnd Function\r\n\r\n\r\nFunction SheetExists(SName As String, _\r\n                     Optional ByVal WB As Workbook) As Boolean\r\n'Chip Pearson\r\n    On Error Resume Next\r\n    If WB Is Nothing Then Set WB = ThisWorkbook\r\n    SheetExists = CBool(Len(WB.Sheets(SName).Name))\r\nEnd Function</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p><a href=\"http://s000.tinyupload.com/?file_id=20682318589711483014\" rel=\"nofollow\">Workbook Example</a></p>\n"}, {"tags": ["forms", "vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4863747, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e112eebe2bfcaa9fa3c8ef71e252c908?s=128&d=identicon&r=PG&f=1", "display_name": "WUDA", "link": "https://stackoverflow.com/users/4863747/wuda"}, "edited": false, "score": 0, "creation_date": 1430932725, "post_id": 30082909, "comment_id": 48279941, "body": "Sorry, I meant that I&#39;m trying to force the input at the beginning of the field instead of being able to click in the middle of the field.  I have an input mask in a cellphone field, but people can click in the middle of the text, which makes it less than foolproof.  <a href=\"http://i.stack.imgur.com/0sVwN.png\" rel=\"nofollow noreferrer\">i.stack.imgur.com/0sVwN.png</a>  Basically they can click on a middle digit instead of being forced to start at the beginning of the text."}], "tags": [], "owner": {"reputation": 41, "user_id": 4609956, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/n6aMb.jpg?s=128&g=1", "display_name": "clerkinthecloud", "link": "https://stackoverflow.com/users/4609956/clerkinthecloud"}, "is_accepted": false, "score": 0, "last_activity_date": 1430931093, "creation_date": 1430931093, "answer_id": 30082909, "question_id": 30082726, "link": "https://stackoverflow.com/questions/30082726/ms-access-2013-form-force-field-input-to-begin-at-the-start/30082909#30082909", "title": "MS Access 2013 Form: Force field input to begin at the start", "body": "<p>If I understand, you want to make the cursor go to the first input field or to any particular field. If this is what you need, try putting docmd.gotocontrol \"controlName\" on the onOpen event of the form. More about the docmd.gotocontrol.<a href=\"https://msdn.microsoft.com/en-us/library/office/ff192079.aspx\" rel=\"nofollow\">https://msdn.microsoft.com/en-us/library/office/ff192079.aspx</a></p>\n"}, {"comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1431003115, "post_id": 30085953, "comment_id": 48314478, "body": "This seems to only work with On Click, the Got focus event doesn&#39;t seem to work.  Probably due to the Input Mask?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1431008528, "post_id": 30085953, "comment_id": 48318951, "body": "Maybe. How about the OnEnter event?"}, {"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1431009221, "post_id": 30085953, "comment_id": 48319451, "body": "Doesn&#39;t seem to work their either.  I would just assume that it has to do with the order of events."}, {"owner": {"reputation": 13, "user_id": 4863747, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e112eebe2bfcaa9fa3c8ef71e252c908?s=128&d=identicon&r=PG&f=1", "display_name": "WUDA", "link": "https://stackoverflow.com/users/4863747/wuda"}, "edited": false, "score": 0, "creation_date": 1431014781, "post_id": 30085953, "comment_id": 48323840, "body": "Hmmm.  This works, but is it possible to disable it after 1 instance?  So basically if they screw up, they can click anywhere?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1431091017, "post_id": 30085953, "comment_id": 48359226, "body": "Yes, if you can create a rule for when entering is to edit the content or to edit the content ..."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 1, "last_activity_date": 1430940875, "creation_date": 1430940875, "answer_id": 30085953, "question_id": 30082726, "link": "https://stackoverflow.com/questions/30082726/ms-access-2013-form-force-field-input-to-begin-at-the-start/30085953#30085953", "title": "MS Access 2013 Form: Force field input to begin at the start", "body": "<p>You can use in the OnFocus event of the control:</p>\n\n<pre><code>Me!YourControlName.SelStart = 0\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4863747, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e112eebe2bfcaa9fa3c8ef71e252c908?s=128&d=identicon&r=PG&f=1", "display_name": "WUDA", "link": "https://stackoverflow.com/users/4863747/wuda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1430940875, "creation_date": 1430930559, "last_edit_date": 1430932806, "question_id": 30082726, "link": "https://stackoverflow.com/questions/30082726/ms-access-2013-form-force-field-input-to-begin-at-the-start", "title": "MS Access 2013 Form: Force field input to begin at the start", "body": "<p>I have to do intake for new employees, which requires filling out a form.  Normally I'd be able to watch over and clean data as they go, but we often have to intake multiple employees at a time, which is why I need to make the form foolproof.  </p>\n\n<p>Is there a way to force the input to go to the beginning of a field instead of being able to click in the middle of it?</p>\n\n<p><a href=\"http://i.stack.imgur.com/0sVwN.png\" rel=\"nofollow\">http://i.stack.imgur.com/0sVwN.png</a></p>\n"}, {"tags": ["vba", "excel", "calling-convention"], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 2, "creation_date": 1430931768, "post_id": 30082783, "comment_id": 48279326, "body": "To add to Gary&#39;s answer, <code>GoTo</code> requires a label to jump to. A label is an identifier, starting in the first column of text, in the <i>current</i> procedure (<code>Sub</code> or <code>Function</code>), followed by a colon <code>:</code>, for example: <code>Here:</code>, or <code>There:</code>, or <code>Error_Handler:</code>. Generally they are a <i>Bad Idea\u2122</i> as they can lead to difficult to debug code. What you&#39;ve done is write a couple of subroutines (which is <i>excellent</i> and the preferred way of doing things!), but failed to call them correctly. Gary&#39;s answer will do what you want. (Though <code>Call</code> isn&#39;t required in most situations.)"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 2, "last_activity_date": 1430931829, "last_edit_date": 1430931829, "creation_date": 1430930710, "answer_id": 30082783, "question_id": 30082677, "link": "https://stackoverflow.com/questions/30082677/vba-calling-subroutine-using-if-then-goto/30082783#30082783", "title": "VBA Calling subroutine using If-Then - Goto", "body": "<pre><code>Sub Testcopy()\n\nX = MsgBox(\"Press 1 to clear sheet or press 2 to copy\")\n\n    If X = 1 Then Call clearsheet\n    If X = 2 Then Call Copysheet\n\n    'MsgBox (\"Incorrect entry\")\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 4784432, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0621df2c450114df668a602e452ed3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4784432/brian"}, "is_accepted": false, "score": 0, "last_activity_date": 1430932627, "last_edit_date": 1430932627, "creation_date": 1430932273, "answer_id": 30083309, "question_id": 30082677, "link": "https://stackoverflow.com/questions/30082677/vba-calling-subroutine-using-if-then-goto/30083309#30083309", "title": "VBA Calling subroutine using If-Then - Goto", "body": "<pre><code>    Sub expensecopy()\n\n    X = InputBox(\"Press 1 to clear sheet or press 2 to copy\")\n\n        If X = 1 Then Call clearsheet\n        If X = 2 Then Call copysheet\n        If X &lt;&gt; 1 Or 2 Then Call usererrorhandler\n   End Sub\n\n\n\nSub usererrorhandler()\n\n    Z = MsgBox(\"Incorrect entry, Please enter 1 or 2\")\n    End Sub\n\nSub clearsheet()\n\n    sheetclearname = InputBox(\" Enter the sheet you want to clear\")\n    Worksheets(sheetclearname).Select\n    Worksheets(sheetclearname).UsedRange.Clear\n    End Sub\n\n\nSub copysheet()\n    Worksheets(\"Inputs\").Activate\n    Worksheets(\"Inputs\").Range(\"Expenses\").Copy\n\n    Worksheets(\"Sheet3\").Activate\n     ActiveSheet.Range(\"A2\").PasteSpecial Paste:=xlPasteValues\n     ActiveSheet.Range(\"A2\").PasteSpecial Paste:=xlPasteFormats\n\n     End Sub\n</code></pre>\n\n<p>Thanks guys , here is the updated code, it works perfect. Just curious as an add-on question. </p>\n\n<p>I want to send the user if he enter anything other than 1 or 2 , from the routine usererrorhandler back to the option to enter the option 1 or 2 rather than rerun the macro.</p>\n\n<p>Any suggestions ?</p>\n"}], "owner": {"reputation": 31, "user_id": 4784432, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/0621df2c450114df668a602e452ed3c6?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4784432/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4031, "favorite_count": 0, "accepted_answer_id": 30082783, "answer_count": 2, "score": 0, "last_activity_date": 1430932627, "creation_date": 1430930376, "last_edit_date": 1531164843, "question_id": 30082677, "link": "https://stackoverflow.com/questions/30082677/vba-calling-subroutine-using-if-then-goto", "title": "VBA Calling subroutine using If-Then - Goto", "body": "<pre><code>    Sub Testcopy()\n\n    X = MsgBox(\"Press 1 to clear sheet or press 2 to copy\")\n\n        If X = 1 Then GoTo clearsheet\n        If X = 2 Then GoTo Copysheet\n\n        'MsgBox (\"Incorrect entry\")\n    End Sub\n\n    Sub clearsheet()\n\n    sheetclearname = InputBox(\" Enter the sheet you want to clear\")\n    Worksheets(sheetclearname).Select\n    Worksheets(sheetclearname).UsedRange.Clear\n    End Sub\n\n\n    Sub Copysheet()\n    Worksheets(\"Inputs\").Activate\n    Worksheets(\"Inputs\").Range(\"Expenses\").Copy\n\n    Worksheets(\"Sheet3\").Activate\n     ActiveSheet.Range(\"A2\").PasteSpecial Paste:=xlPasteValues\n     ActiveSheet.Range(\"A2\").PasteSpecial Paste:=xlPasteFormats\n\n\nEnd Sub\n</code></pre>\n\n<p>Guys</p>\n\n<p>I am trying to make a main routine which ask the user to enter option 1 or 2\nOption 1 takes to subroutine clearsheet and it clears the sheet chosen</p>\n\n<p>option 2 activates sub routine CopySheet and this copies from tab input range expenses to sheet 3</p>\n\n<p>when I run the macro I get label not defined</p>\n\n<ol>\n<li>What is label not defined here and how to make this works</li>\n</ol>\n\n<p>Thanks</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "reply_to_user": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1430930607, "post_id": 30082607, "comment_id": 48278556, "body": "I will add it in the question itself so the formatting remains readable."}, {"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 0, "creation_date": 1430930622, "post_id": 30082607, "comment_id": 48278572, "body": "The query itself looks ok... but you are querying a Access Query which might expect a parameter?"}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1430931234, "post_id": 30082607, "comment_id": 48278957, "body": "The qryOrder_Model_Operation_Value is in the question itself now."}], "answers": [{"comments": [{"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1430931119, "post_id": 30082842, "comment_id": 48278901, "body": "I get the following error: <a href=\"http://i.imgur.com/4FM3iNj.png\" rel=\"nofollow noreferrer\">i.imgur.com/4FM3iNj.png</a> on dbOpenTable and 13 - Type mismatch on dbOpenSnapshot :/."}, {"owner": {"reputation": 16278, "user_id": 4421474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b931f645dc56015b93aeaa5e20d0b5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4421474/alex"}, "reply_to_user": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1430931250, "post_id": 30082842, "comment_id": 48278969, "body": "that is much better. so tell me what is your database? is it MS Acces? we can remove <code>mysql</code> tag from OP ?"}, {"owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1430931488, "post_id": 30082842, "comment_id": 48279147, "body": "Sorry @Alex, removed the mysql tag now. Indeed my database is MS Access."}], "tags": [], "owner": {"reputation": 16278, "user_id": 4421474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b931f645dc56015b93aeaa5e20d0b5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4421474/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1430930891, "creation_date": 1430930891, "answer_id": 30082842, "question_id": 30082607, "link": "https://stackoverflow.com/questions/30082607/3061-vba-error-sql-query-too-few-parameters-expected-1-simple-query/30082842#30082842", "title": "3061 VBA Error - SQL Query &quot;Too few parameters. Expected 1.&quot; Simple query", "body": "<p>Try this way:</p>\n\n<pre><code>Set rst = db.OpenRecordset(sSQL,dbOpenTable)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Set rst = db.OpenRecordset(sSQL,dbOpenSnapshot)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "edited": false, "score": 0, "creation_date": 1430931770, "post_id": 30083011, "comment_id": 48279328, "body": "You&#39;re welcome.  That didn&#39;t seem like it could be the explanation for error # 3061.  But, when you showed Alex error # <b>3011</b>, that was a dead give away.  :-)"}, {"owner": {"reputation": 16278, "user_id": 4421474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b931f645dc56015b93aeaa5e20d0b5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4421474/alex"}, "edited": false, "score": 0, "creation_date": 1430931885, "post_id": 30083011, "comment_id": 48279402, "body": "the way .net detect number and types of parameters for the mutable functions brings a lot of surprises :-)"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1430932367, "last_edit_date": 1430932367, "creation_date": 1430931376, "answer_id": 30083011, "question_id": 30082607, "link": "https://stackoverflow.com/questions/30082607/3061-vba-error-sql-query-too-few-parameters-expected-1-simple-query/30083011#30083011", "title": "3061 VBA Error - SQL Query &quot;Too few parameters. Expected 1.&quot; Simple query", "body": "<p>Make sure Access understands you want <em>rst</em> to be a <code>DAO.Recordset</code> instead of an <code>ADODB.Recordset</code>:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>'Dim rst As Recordset\nDim rst As DAO.Recordset\n</code></pre>\n\n<p>Both the ADO and DAO object models include <code>Recordset</code> objects.  Although similar in some respects, they can not be used interchangeably.  </p>\n\n<p>When your Access VBA project references include a version of ADO (<em>ActiveX Data Objects</em>) and that reference has a higher priority than the DAO reference, <code>Dim rst As Recordset</code> will give you an <code>ADODB.Recordset</code>.  Avoid unwelcome surprises by always qualifying your <code>Recordset</code> declarations with <code>DAO</code> or <code>ADODB</code> as appropriate.</p>\n"}], "owner": {"reputation": 1030, "user_id": 4712455, "user_type": "registered", "accept_rate": 46, "profile_image": "https://graph.facebook.com/10203606783401336/picture?type=large", "display_name": "emihir0", "link": "https://stackoverflow.com/users/4712455/emihir0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1268, "favorite_count": 1, "accepted_answer_id": 30083011, "answer_count": 2, "score": 3, "last_activity_date": 1430932391, "creation_date": 1430930153, "last_edit_date": 1430932391, "question_id": 30082607, "link": "https://stackoverflow.com/questions/30082607/3061-vba-error-sql-query-too-few-parameters-expected-1-simple-query", "title": "3061 VBA Error - SQL Query &quot;Too few parameters. Expected 1.&quot; Simple query", "body": "<p>I have the following code:</p>\n\n<pre><code>Private Sub lst1Model_Operation_Click()\nDim db As Database\nDim sSQL As String\nDim rst As Recordset\n\nSet db = CurrentDb\n\n    sSQL = \"SELECT * FROM qryOrder_Model_Operation_Value WHERE Model_Operation_ID = \" &amp; CInt(Me![lst1Model_Operation].Value)\n\nDebug.Print sSQL 'when pasted this into a query SQL, it works flawlessly.\n\nSet rst = db.OpenRecordset(sSQL) 'error line\n\n'some code here\n\nrst.Close\nSet db = Nothing\nEnd Sub\n</code></pre>\n\n<p>I'm at loss at what to do. The <code>Debug.Print</code> looks like:</p>\n\n<pre><code>SELECT * FROM qryOrder_Model_Operation_Value WHERE Model_Operation_ID = 748\n</code></pre>\n\n<p>And as I said, if I paste that <code>Debug.Print</code> into a Query in the Access itself, it produces the desired results.</p>\n\n<p>I have tried adding ' ' around the value, but using CInt() I already made sure it is parsed as integer. The Model_Operation_ID also expects to get an integer (otherwise it wouldn't work in a separate query either).</p>\n\n<p>Edit:\nThe qryOder_Model_Operation_Value is as follows:</p>\n\n<pre><code>SELECT tbl1Model_Operation.Model_Operation_ID, tbl1Model_Operation.Model_ID, tbl1Model_Operation.Operation_Value_ID, tbl2Operation_Value.Operation_Name_ID, tbl3OperationsList.Operation_Name, tbl1Order_Model.Quantity AS [Po\u010det p\u00e1rov], tbl1Order_Model.Order_ID\nFROM tbl3OperationsList INNER JOIN (tbl2Operation_Value INNER JOIN (tbl1Model_Operation INNER JOIN tbl1Order_Model ON tbl1Model_Operation.Model_ID = tbl1Order_Model.Model_ID) ON tbl2Operation_Value.Operation_Value_ID = tbl1Model_Operation.Operation_Value_ID) ON tbl3OperationsList.Operation_ID = tbl2Operation_Value.Operation_Name_ID;\n</code></pre>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1430936320, "post_id": 30082035, "comment_id": 48282247, "body": "You can not print on a printer that is not installed at the local computer. Neither in Access nor anywhere else."}, {"owner": {"reputation": 384, "user_id": 557644, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fb1782c8a3269c695cb8d538caea84d0?s=128&d=identicon&r=PG", "display_name": "Matty Brown", "link": "https://stackoverflow.com/users/557644/matty-brown"}, "reply_to_user": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1430984758, "post_id": 30082035, "comment_id": 48301952, "body": "Hi @PhilS.  If I add a connection to a shared printer to my PC, go into the report definition and set the report to print to that specific printer, save the report definition and delete the connection to the shared printer from my PC, I am still able to print the report to that printer.  Even after restarting Access, my report will still print to the specific printer regardless of whether or not the print queue exists on my PC.  Not sure how Access achieves this, but it does."}, {"owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "edited": false, "score": 0, "creation_date": 1430987534, "post_id": 30082035, "comment_id": 48303544, "body": "If you install a printer with driver et. al. and then just remove it in Explorer, this might actually work, as Windows leaves the driver and much of the printer&#39;s settings in place and just hides them from view. But I doubt that you can rely on this working in every case."}], "owner": {"reputation": 384, "user_id": 557644, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fb1782c8a3269c695cb8d538caea84d0?s=128&d=identicon&r=PG", "display_name": "Matty Brown", "link": "https://stackoverflow.com/users/557644/matty-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1467, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594644715, "creation_date": 1430928509, "last_edit_date": 1594644715, "question_id": 30082035, "link": "https://stackoverflow.com/questions/30082035/how-to-programatically-send-report-to-a-specific-printer-in-microsoft-access-201", "title": "How to programatically send report to a specific printer in Microsoft Access 2010?", "body": "<p>I have a couple of reports which I need to print to one of four printers.  Up to now in our old Access 2002 database, we've been getting the printer object from Application.Printers and assigning it to the report's Printer property at runtime.</p>\n\n<pre><code>Dim strPrinter as String\nstrPrinter = \"\\\\server1\\HP 4250 - Sales\"\nReports(\"rptMyReport\").Printer = Application.Printers(strPrinter)\n</code></pre>\n\n<p>Doing things this way means that the printer must be installed on the local PC, but it should be possible to print Access reports to any printer regardless of whether or not a print queue is installed for the logged in user, as long as the \"Specific printer\" is defined for a report, right?</p>\n\n<p>Is there a better way of achieving this in Access 2010?</p>\n"}, {"tags": ["sql", "excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1430929035, "post_id": 30081993, "comment_id": 48277518, "body": "Can you <code>Debug.Print strSQL</code> right above <code>.Execute strSQL</code> to see exactly what the broken INSERT statement says."}, {"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 0, "creation_date": 1430929062, "post_id": 30081993, "comment_id": 48277534, "body": "Perhaps it helps to put the table and column names into <code>[]</code>.. something like   <code>strSQL = &quot;INSERT INTO [&quot; &amp; strTblName &amp; &quot;] (&quot; &amp; _             &quot;[cDate], [Open], [High], [Low], [Last], [cChange], [Settle], [cVolume], [OpenInterest])&quot; &amp; _...</code> ?"}, {"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "reply_to_user": {"reputation": 2148, "user_id": 2836853, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/eGs6K.png?s=128&g=1", "display_name": "Newd", "link": "https://stackoverflow.com/users/2836853/newd"}, "edited": false, "score": 0, "creation_date": 1430929238, "post_id": 30081993, "comment_id": 48277656, "body": "The problem could also be with the values. You do not check if they contain a single quote... so the best would be to see the <code>strSQL</code> as @Newd proposed!"}, {"owner": {"reputation": 449, "user_id": 4871383, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-xJB6PbDDhqA/AAAAAAAAAAI/AAAAAAAAATI/7ITyhhwFoPc/photo.jpg?sz=128", "display_name": "Aaron Soderstrom", "link": "https://stackoverflow.com/users/4871383/aaron-soderstrom"}, "edited": false, "score": 0, "creation_date": 1430931291, "post_id": 30081993, "comment_id": 48279004, "body": "Debug.Print returns:    INSERT INTO CLN2015 (cDate, Open, High, Low, Last, cChange, Settle, cVolume, OpenInterest) VALUES (&#39;5/5/2015&#39; , &#39;60.19&#39; , &#39;62.2&#39; , &#39;59.91&#39; , &#39;58&#39; , &#39;1.34&#39; , &#39;61.5&#39; , &#39;149025&#39; , &#39;249452&#39;) If I run this string in SQL the command works perfectly."}], "answers": [{"comments": [{"owner": {"reputation": 449, "user_id": 4871383, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-xJB6PbDDhqA/AAAAAAAAAAI/AAAAAAAAATI/7ITyhhwFoPc/photo.jpg?sz=128", "display_name": "Aaron Soderstrom", "link": "https://stackoverflow.com/users/4871383/aaron-soderstrom"}, "edited": false, "score": 0, "creation_date": 1430931424, "post_id": 30082366, "comment_id": 48279098, "body": "I will change all the names and report back.. funny I added cDate and not Date to avoid this."}, {"owner": {"reputation": 449, "user_id": 4871383, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-xJB6PbDDhqA/AAAAAAAAAAI/AAAAAAAAATI/7ITyhhwFoPc/photo.jpg?sz=128", "display_name": "Aaron Soderstrom", "link": "https://stackoverflow.com/users/4871383/aaron-soderstrom"}, "edited": false, "score": 0, "creation_date": 1430931705, "post_id": 30082366, "comment_id": 48279284, "body": "You are spot on Added brackets and the code runs fine!! Thank you sir! I learn the best from trail and error!"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1430929495, "creation_date": 1430929495, "answer_id": 30082366, "question_id": 30081993, "link": "https://stackoverflow.com/questions/30081993/ms-excel-to-ms-access-accdb-database-from-vba-sql-syntax-error/30082366#30082366", "title": "MS EXCEL to MS ACCESS .accdb Database from VBA SQL Syntax error", "body": "<p>The problem may be due to field names.  There is a function named <code>CDate</code>.  <code>Open</code> and <code>Last</code> are both Jet reserved words.  See <a href=\"http://allenbrowne.com/AppIssueBadWord.html\" rel=\"nofollow\">Problem names and reserved words in Access</a>.  </p>\n\n<p>Enclose those problem field names in square brackets to avoid confusing the database engine:</p>\n\n<pre><code>\"[cDate], [Open], High, Low, [Last], cChange, Settle, cVolume, OpenInterest)\"\n</code></pre>\n\n<p>The brackets may be enough to get your <code>INSERT</code> working.  However consider renaming the fields if possible.</p>\n\n<p>That linked page also mentions Allen Browne's <a href=\"http://allenbrowne.com/AppIssueChecker.html\" rel=\"nofollow\">Database Issue Checker Utility</a>.  You can download that utility and use it to examine your database for other problem names.  It can also alert you to other issues which may not affect the current <code>INSERT</code> problem, but could cause trouble in other situations.</p>\n"}], "owner": {"reputation": 449, "user_id": 4871383, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh5.googleusercontent.com/-xJB6PbDDhqA/AAAAAAAAAAI/AAAAAAAAATI/7ITyhhwFoPc/photo.jpg?sz=128", "display_name": "Aaron Soderstrom", "link": "https://stackoverflow.com/users/4871383/aaron-soderstrom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4559, "favorite_count": 0, "accepted_answer_id": 30082366, "answer_count": 1, "score": 2, "last_activity_date": 1430929638, "creation_date": 1430928385, "last_edit_date": 1430929638, "question_id": 30081993, "link": "https://stackoverflow.com/questions/30081993/ms-excel-to-ms-access-accdb-database-from-vba-sql-syntax-error", "title": "MS EXCEL to MS ACCESS .accdb Database from VBA SQL Syntax error", "body": "<p>I am completely stuck and pulling out my hair on this one.. </p>\n\n<p>From Excel VBA I have two sets of code: </p>\n\n<p>1- To Create a table is MS Access via a SQL statement</p>\n\n<p>2- Populated newly created table with a For loop, also using SQL</p>\n\n<p>The first set of code works perfectly, so I know that my connection string is working properly. </p>\n\n<p>Here is the first set: </p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Create_Table()\n    'Add Reference to Microsoft ActiveX Data Objects 2.x Library\n    Dim strConnectString        As String\n    Dim objConnection           As ADODB.Connection\n    Dim strDbPath               As String\n    Dim strTblName              As String\n\n\n    Dim wCL                     As Worksheet\n    Dim wCD                     As Worksheet\n\n\n    Set wCL = Worksheets(\"Contract List\")\n    Set wCD = Worksheets(\"Contract Data\")\n\n    'Set database name and DB connection string--------\n    strDbPath = ThisWorkbook.Path &amp; \"\\SpreadPrices.accdb\"\n    '==================================================\n    strTblName = wCL.Range(\"TableName\").Value\n    strConnectString = \"Provider = Microsoft.ACE.OLEDB.12.0; data source=\" &amp; strDbPath &amp; \";\"\n\n    'Connect Database; insert a new table\n    Set objConnection = New ADODB.Connection\n   On Error Resume Next\n    With objConnection\n        .Open strConnectString\n        .Execute \"CREATE TABLE \" &amp; strTblName &amp; \" (\" &amp; _\n                 \"[cDate] text(150), \" &amp; _\n                 \"[Open] text(150), \" &amp; _\n                 \"[High] text(150), \" &amp; _\n                 \"[Low] text(150), \" &amp; _\n                 \"[Last] text(150), \" &amp; _\n                 \"[cChange] text(150), \" &amp; _\n                 \"[Settle] text(150), \" &amp; _\n                 \"[cVolume] text(150), \" &amp; _\n                 \"[OpenInterest] text(150))\"\n\n    End With\n\n    Set objConnection = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>Mentioned before that code works perfectly. The bug is on the following set of code used to populate the table. </p>\n\n<p>Here it is: </p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub InsertSQL()\n\n'Add Reference to Microsoft ActiveX Data Objects 2.x Library\n    Dim strConnectString        As String\n    Dim objConnection           As ADODB.Connection\n    Dim strDbPath               As String\n    Dim strTblName              As String\n    Dim lngRow                  As Long\n    Dim strSQL                  As String\n\n\n    Dim wCL                     As Worksheet\n    Dim wCD                     As Worksheet\n\n\n    Set wCL = Worksheets(\"Contract List\")\n    Set wCD = Worksheets(\"Contract Data\")\n\n    'Set database name and DB connection string--------\n    strDbPath = ThisWorkbook.Path &amp; \"\\SpreadPrices.accdb\"\n    '==================================================\n    strTblName = wCL.Range(\"TableName\").Value\n    strConnectString = \"Provider = Microsoft.ACE.OLEDB.12.0; data source=\" &amp; strDbPath &amp; \";\"\n\n    'Connect Database; insert a new table\n    Set objConnection = New ADODB.Connection\n    'On Error Resume Next\n    With objConnection\n        .Open strConnectString\n\n         For lngRow = 2 To Range(\"NumberRows\").Value\n\n            strSQL = \"INSERT INTO \" &amp; strTblName &amp; \" (\" &amp; _\n            \"cDate, Open, High, Low, Last, cChange, Settle, cVolume, OpenInterest)\" &amp; _\n            \" VALUES ('\" &amp; _\n            wCD.Cells(lngRow, 1) &amp; \"' , '\" &amp; _\n            wCD.Cells(lngRow, 2) &amp; \"' , '\" &amp; _\n            wCD.Cells(lngRow, 3) &amp; \"' , '\" &amp; _\n            wCD.Cells(lngRow, 4) &amp; \"' , '\" &amp; _\n            wCD.Cells(lngRow, 5) &amp; \"' , '\" &amp; _\n            wCD.Cells(lngRow, 6) &amp; \"' , '\" &amp; _\n            wCD.Cells(lngRow, 7) &amp; \"' , '\" &amp; _\n            wCD.Cells(lngRow, 8) &amp; \"' , '\" &amp; _\n            wCD.Cells(lngRow, 9) &amp; \"')\"\n\n         wCL.Range(\"A1\").Value = strSQL\n\n        .Execute strSQL\n        Next lngRow\n\n    End With\n\n    Set objConnection = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>The error I receive is: </p>\n\n<p><em>Run-time error, Syntax error in INSERT INTO statement.</em> </p>\n\n<p>Ok, so at first thought I think there must be a error in my SQL string. So I take the exact SQL string and toss it into Access Query Builder and run the SQL command and it imports into the table just fine. </p>\n\n<p>What am I missing? </p>\n"}, {"tags": ["vba", "excel", "excel-formula"], "comments": [{"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1430947056, "post_id": 30081992, "comment_id": 48288616, "body": "Can you post something about how you tried <code>INDIRECT</code>?  This is one of the more common use cases for <code>INDIRECT</code>, and it usually works well if you name the ranges correctly."}, {"owner": {"reputation": 3, "user_id": 4871265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/273e3d7b4a2cd64a8fc453d1d31e3546?s=128&d=identicon&r=PG&f=1", "display_name": "FarahS", "link": "https://stackoverflow.com/users/4871265/farahs"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1431259229, "post_id": 30081992, "comment_id": 48409619, "body": "Thank you for your responses. The Choose/Match function works well except that I have 427 columns that need to be matched which seems to be too much for data validation."}, {"owner": {"reputation": 3, "user_id": 4871265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/273e3d7b4a2cd64a8fc453d1d31e3546?s=128&d=identicon&r=PG&f=1", "display_name": "FarahS", "link": "https://stackoverflow.com/users/4871265/farahs"}, "reply_to_user": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1431261136, "post_id": 30081992, "comment_id": 48410174, "body": "For Indirect you need to name your ranges however apparently you cannot define names if they start with a number. All my lists are codes that start with numbers."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 1, "last_activity_date": 1430929963, "creation_date": 1430929963, "answer_id": 30082541, "question_id": 30081992, "link": "https://stackoverflow.com/questions/30081992/excel-formula-that-will-let-me-show-a-data-range-in-a-cell-based-on-the-value-in/30082541#30082541", "title": "Excel formula that will let me show a data range in a cell based on the value in another cell", "body": "<p>Here is a very simple example using <em>VBA</em></p>\n\n<p>Place this event macro in the worksheet code area:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    Dim A1 As Range, B1 As Range\n    Set A1 = Range(\"A1\")\n    Set B1 = Range(\"B1\")\n    If Intersect(A1, Target) Is Nothing Then Exit Sub\n    Select Case A1.Value\n        Case \"animals\"\n            Call SetupDV(B1, \"dog,cat,bird\")\n        Case \"days\"\n            Call SetupDV(B1, \"monday,tuesday,wednesday\")\n        Case \"months\"\n            Call SetupDV(B1, \"january,february,march\")\n    End Select\nEnd Sub\n</code></pre>\n\n<p>and place this macro in a standard module:</p>\n\n<pre><code>Sub MAIN()\n    Cells.Validation.Delete\n    Call SetupDV(Range(\"A1\"), \"animals,days,months\")\nEnd Sub\n\nSub SetupDV(MyCells As Range, st As String)\n    With MyCells.Validation\n            .Delete\n            .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, _\n            Operator:=xlBetween, Formula1:=st\n            .IgnoreBlank = True\n            .InCellDropdown = True\n            .InputTitle = \"\"\n            .ErrorTitle = \"\"\n            .InputMessage = \"\"\n            .ErrorMessage = \"\"\n            .ShowInput = True\n            .ShowError = True\n    End With\nEnd Sub\n</code></pre>\n\n<p>Then run <strong><em>MAIN</em></strong></p>\n\n<p>Whenever you make a selection from the pull-down in cell <strong>A1</strong>, the pull-down in cell <strong>B1</strong> will adjust accordingly:</p>\n\n<p><img src=\"https://i.stack.imgur.com/jxx9O.png\" alt=\"enter image description here\"></p>\n"}, {"comments": [{"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1431346552, "post_id": 30088757, "comment_id": 48441034, "body": "This is a very well thought out answer."}], "tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1430951119, "last_edit_date": 1592644375, "creation_date": 1430951119, "answer_id": 30088757, "question_id": 30081992, "link": "https://stackoverflow.com/questions/30081992/excel-formula-that-will-let-me-show-a-data-range-in-a-cell-based-on-the-value-in/30088757#30088757", "title": "Excel formula that will let me show a data range in a cell based on the value in another cell", "body": "<p>There's a solution for this using formulas alone, without VBA code.</p>\n<p>Assuming your data looks like this:</p>\n<p><img src=\"https://i.stack.imgur.com/8BCZV.png\" alt=\"Dynamic validation list\" /></p>\n<ul>\n<li>First column selection list is Catgories, in A2:A4.</li>\n<li>Second column selection list will be chosen as one of C2:C6 | D2:D6 | E2:E6, by the selection of a category.</li>\n<li>In G2:G3 you can select a category.</li>\n<li>H2:H3 will show the list according to the category selected in G respectively.</li>\n</ul>\n<p>The <strong>validation list source</strong> for H2:H3 will be defined with this formula:</p>\n<pre><code>=CHOOSE(MATCH(G2,$C$1:$E$1,0),$C$2:$C$6,$D$2:$D$6,$E$2:$E$6)\n</code></pre>\n<p>Select H2:H3, go to Data Validation, choose List and put this formula in the Source. (The range reference will be updated for H3 automatically).</p>\n<h3>The Formula:</h3>\n<p>The <code>MATCH</code> part returns 1,2 or 3 for the category names in C1:E1.\n<code>CHOOSE</code> returns the range C, D or E respectively, according to the order they are supplied in the function.</p>\n<h3>Remarks:</h3>\n<p>The ranges can reference cells in another sheet by simply stating the sheet name <code>Sheet2!C2:C6</code> in the validation list formula. In earlier versions of Excel you need to name these external ranges for it to work in a validation list.</p>\n"}], "owner": {"reputation": 3, "user_id": 4871265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/273e3d7b4a2cd64a8fc453d1d31e3546?s=128&d=identicon&r=PG&f=1", "display_name": "FarahS", "link": "https://stackoverflow.com/users/4871265/farahs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 30082541, "answer_count": 2, "score": 0, "last_activity_date": 1430951119, "creation_date": 1430928377, "last_edit_date": 1430944594, "question_id": 30081992, "link": "https://stackoverflow.com/questions/30081992/excel-formula-that-will-let-me-show-a-data-range-in-a-cell-based-on-the-value-in", "title": "Excel formula that will let me show a data range in a cell based on the value in another cell", "body": "<p>I am trying to create a form where someone can choose a value from a drop down list and it will create another dropdown list in the next cell based on the first cells value. The next cells dropdown list would need to reference a cell range on a separate worksheet and only show row 4-30 as a dropdown.</p>\n\n<p>Is this possible? I tried using data validation with an indirect formula but I cannot define the cell ranges as the codes start with numbers.</p>\n\n<p>Any suggestions would be helpful?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "edited": false, "score": 2, "creation_date": 1430926922, "post_id": 30081438, "comment_id": 48276133, "body": "You&#39;re missing a <code>Next i</code> before the second <code>End If</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": true, "score": 2, "last_activity_date": 1430926959, "creation_date": 1430926959, "answer_id": 30081507, "question_id": 30081438, "link": "https://stackoverflow.com/questions/30081438/vba-looping-through-multiple-worksheets-getting-end-if-w-o-block-error/30081507#30081507", "title": "VBA Looping through multiple worksheets, getting End If w/o block error", "body": "<p>You're missing a <code>Next</code> statement on your 2nd For loop</p>\n\n<pre><code>For Each ws In Worksheets\n    If ws.Name Like \"Loan *#\" Then\n        For I = 25 To finalRow\n             If Cells(I, 2) &gt;= beginDate And Cells(I, 2) &lt; endDate Then\n                 intPrinc = intPrinc + Cells(I, 3).Value\n            End If\n        Next '***New Line\n    End If\nNext ws\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4871274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d9f88a8cf26809b8b8371e1f53f55fb0?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Nebb", "link": "https://stackoverflow.com/users/4871274/ben-nebb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 30081507, "answer_count": 1, "score": 0, "last_activity_date": 1430929979, "creation_date": 1430926776, "last_edit_date": 1430929979, "question_id": 30081438, "link": "https://stackoverflow.com/questions/30081438/vba-looping-through-multiple-worksheets-getting-end-if-w-o-block-error", "title": "VBA Looping through multiple worksheets, getting End If w/o block error", "body": "<p>I am trying to create a function that loops through 40 worksheets and adds the values in the worksheets that are between two dates. When I run the function I get an \"End If without Block If\" error. When I delete the last End If then I get an \"invalid next control variable reference\" error. Any help would be greatly appreciated. Thanks!</p>\n\n<pre><code>Function addIntPrinc(beginDate, endDate)\n\nDim ws As Worksheet\nDim finalRow As Long, I As Long, intPrinc As Double\nintPrinc = 0\nfinalRow = Cells(Rows.Count, 1).End(xlUp).Row\n\nFor Each ws In Worksheets\n    If ws.Name Like \"Loan *#\" Then\n        For I = 25 To finalRow\n        If Cells(I, 2) &gt;= beginDate And Cells(I, 2) &lt; endDate Then\n            intPrinc = intPrinc + Cells(I, 3).Value\n        End If\n    End If\nNext ws\nEnd Function\n\naddIntPrinc = intPrinc\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "edited": false, "score": 0, "creation_date": 1430927027, "post_id": 30081257, "comment_id": 48276212, "body": "THANK the GODS for you! So I am assuming that the error was produced because .Formula detected the string has an error with regard to being a formula?"}, {"owner": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "edited": false, "score": 0, "creation_date": 1430927040, "post_id": 30081257, "comment_id": 48276228, "body": "also thank you so much for debug.print - any other tips would be great."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "edited": false, "score": 0, "creation_date": 1430927282, "post_id": 30081257, "comment_id": 48276410, "body": "Yes, if you try to put an invalid formula into a cell, it will throw the 1004 error (obviously, this is not the only thing that will throw this error, but if it&#39;s being caused by a line that puts a formula into a cell, this is generally the problem).  Another helpful tip is to put &quot;Option Explicit&quot; at the top of your form or module (outside of any Subs/Functions).  This will force you to declare all variables by alerting you to any undeclared variables.  This will be extremely helpful in case of misspellings."}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "edited": false, "score": 0, "creation_date": 1430927519, "post_id": 30081257, "comment_id": 48276551, "body": "In addition to Freeman&#39;s good suggestion, you could also write the code in an editor that will show you which parentheses match, such as Notepad++ or even writing it directly in Excel before moving it to VBA."}, {"owner": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "edited": false, "score": 0, "creation_date": 1430927784, "post_id": 30081257, "comment_id": 48276721, "body": "this might be a stretch. I REALLY NEED something like Notepad++ but I work at a Financial Institution and I am limited to what I can run. Any suggestions?"}, {"owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "reply_to_user": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "edited": false, "score": 0, "creation_date": 1430928864, "post_id": 30081257, "comment_id": 48277423, "body": "Excel will match parentheses if you put it directly in a cell first.  Otherwise, Freeman&#39;s approach is a great one."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1430928995, "post_id": 30081257, "comment_id": 48277491, "body": "It just occurred to me, and I just tested it out. You <i>can</i> format a function in the cell in Excel (as I did in <a href=\"http://stackoverflow.com/a/30081589/2344413\">my answer</a>). Use <b>Alt-Enter</b> to insert a newline. Now you don&#39;t need Notepad, Notepad++ or anything else!  You&#39;ll need to adjust column width to be able to read the formula when you <b>F2</b> to edit it, but that&#39;s a minor issue."}, {"owner": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "edited": false, "score": 0, "creation_date": 1430967399, "post_id": 30081257, "comment_id": 48294968, "body": "Hi Guys! So work supports Notepad++! It looks like it could be very powerful and i look forward to watching some tutorials. I have known VBA for like 30 days now progressing strong from Stackoverflow community! Does anyone have some important tips and trips? Key lessons you have learned; favorite properties... cells() range()?@? you guys are awesome thank you again."}], "tags": [], "owner": {"reputation": 3145, "user_id": 4560433, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/412786b272a5c096e45967bc79cde0a9?s=128&d=identicon&r=PG&f=1", "display_name": "OpiesDad", "link": "https://stackoverflow.com/users/4560433/opiesdad"}, "is_accepted": true, "score": 1, "last_activity_date": 1430926328, "creation_date": 1430926328, "answer_id": 30081257, "question_id": 30081086, "link": "https://stackoverflow.com/questions/30081086/formula-is-producing-runtime-error-1004-works-for-all-other-strings/30081257#30081257", "title": ".Formula is producing runtime error 1004 - works for all other strings", "body": "<p>You're missing a parenthesis at the end.....I haven't tested it in excel, but I'm guessing that's the problem.  </p>\n\n<p>Note that for issues like this, the easiest way to resolve them is to debug.print the formula and then paste it into an actual cell.  That way, excel will give you clearer error message that you can resolve.</p>\n"}, {"comments": [{"owner": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "edited": false, "score": 0, "creation_date": 1430927818, "post_id": 30081589, "comment_id": 48276750, "body": "thank you! I would upvote you if i had the credits! :)"}], "tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1430927197, "last_edit_date": 1495542513, "creation_date": 1430927197, "answer_id": 30081589, "question_id": 30081086, "link": "https://stackoverflow.com/questions/30081086/formula-is-producing-runtime-error-1004-works-for-all-other-strings/30081589#30081589", "title": ".Formula is producing runtime error 1004 - works for all other strings", "body": "<p>You can improve the readability of that last statement by getting rid of all the concatenation:</p>\n\n<pre><code>kcFormula = \"=IF(\n               OR(Table3[[#This Row],[Status]] = \"\"Rejected\"\",\n                  Table3[[#This Row],[Status]] = \"\"Completed\"\",\n                  Table3[[#This Row],[Status]] = \"\"Not Implemented\"\"\n                 ),\n              \"\" \"\",\n              INDEX('AMLLAST'!$1:$1048576,\n                    MATCH(Table3[[#This Row],[ID]],'AMLLAST'!$E:$E,0\n                         )\n                   ,11\n                   )\"\n                 )  &lt;---- this guy is missing! (put him inside the closing \" mark\n</code></pre>\n\n<p>Also, when typing up those deeply embedded, complex <code>IF</code> statements, I usually paste them into Notepad and break them across multiple lines.\nWhen you do that, you'll notice that you are missing the final closing <code>)</code>, as <a href=\"https://stackoverflow.com/a/30081257/2344413\">OpiesDad</a> pointed out.</p>\n\n<p>Give him the credit for the solution, I just wanted to point out couple of tips for resolving the issue that wouldn't have fit in a comment.</p>\n"}], "owner": {"reputation": 62, "user_id": 2555565, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/d4fdeb4d22c92d9ac94a0296856f2107?s=128&d=identicon&r=PG", "display_name": "user2555565", "link": "https://stackoverflow.com/users/2555565/user2555565"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 30081257, "answer_count": 2, "score": 0, "last_activity_date": 1430927197, "creation_date": 1430925888, "last_edit_date": 1430926472, "question_id": 30081086, "link": "https://stackoverflow.com/questions/30081086/formula-is-producing-runtime-error-1004-works-for-all-other-strings", "title": ".Formula is producing runtime error 1004 - works for all other strings", "body": "<p>Everything works except for the last <code>.Formula</code> for <code>kcFormula</code>. It returns a <code>1004 Runtime Application error</code>. I am thinking maybe I declared the <code>kcFormula</code> as a string and it is too big or I have no idea what I am really doing :D</p>\n\n<p>this is the problem statement: </p>\n\n<p><code>Sheets(\"AML\").Range(myRNG).Formula = kcFormula</code></p>\n\n<pre><code>Sub SharePoint_FormatADDcolS()\nDim myRNG As String\nDim lastROW As Integer\nDim matchFormula As String\nDim kcFormula As String\nmatchFormula = \"=IF(ISNA(Table3[[#This Row],[Status]]=Table3[[#This Row],[Last Status]]),\"\nmatchFormula = matchFormula &amp; \"\"\" Status Changed\"\"\"\nmatchFormula = matchFormula &amp; \",\" &amp; \"IF(Table3[[#This Row],[Status]]&lt;&gt;Table3[[#This Row],[Last Status]],\"\nmatchFormula = matchFormula &amp; \"\"\" Status Changed\"\"\" &amp; \",\" &amp; \"\"\"Status Unchanged\"\"\" &amp; \"))\"\nkcFormula = \"=IF(OR(Table3[[#This Row],[Status]]=\" &amp; \"\"\"Rejected\"\"\" &amp; \",\" &amp; \"Table3[[#This Row],[Status]] =\" &amp; \"\"\"Completed\"\"\" &amp; \",\" &amp; \"Table3[[#This Row],[Status]]=\" &amp; \"\"\"Not Implemented\"\"\" &amp; \"),\" &amp; \"\"\" \"\"\" &amp; \",INDEX('AMLLAST'!$1:$1048576,MATCH(Table3[[#This Row],[ID]],'AMLLAST'!$E:$E,0),11)\"\nlastROW = ActiveSheet.UsedRange.Rows.Count\n\n    With Sheets(\"AML\")\n        .ListObjects(1).Name = \"Table3\"\n    End With\nSheets(\"AML (2)\").Name = \"AMLLAST\"\n\n    With Sheets(\"AML\")\n                Range(\"J1\").Select\n                Range(Selection, Selection.End(xlDown)).Select\n                Selection.Copy\n                Range(\"J1\").Select\n                ActiveSheet.PasteSpecial Format:=3, Link:=1, DisplayAsIcon:=False, _\n                IconFileName:=False\n            Sheets(\"AML\").Range(\"C1\").EntireColumn.Insert\n            Sheets(\"AML\").Range(\"C1\").EntireColumn.Insert\n            Sheets(\"AML\").Range(\"C1\") = \"Last Status\"\n            Sheets(\"AML\").Range(\"D1\") = \"Match\"\n            Sheets(\"AML\").Range(\"K1\").EntireColumn.Insert\n            Sheets(\"AML\").Range(\"K1\") = \"BITOOL - Rating\"\n\n        myRNG = \"C2:\" &amp; \"C\" &amp; lastROW\n                Sheets(\"AML\").Range(myRNG).NumberFormat = \"General\"\n                Sheets(\"AML\").Range(myRNG).Formula = \"=INDEX('AMLLAST'!$1:$1048576,MATCH(Table3[[#This Row],[ID]],'AMLLAST'!$E:$E,0),2)\"\n        myRNG = \"D2:\" &amp; \"D\" &amp; lastROW\n                Sheets(\"AML\").Range(myRNG).NumberFormat = \"General\"\n                Sheets(\"AML\").Range(myRNG).Formula = matchFormula\n        myRNG = \"K2:\" &amp; \"K\" &amp; lastROW\n                Sheets(\"AML\").Range(myRNG).NumberFormat = \"General\"\n                Sheets(\"AML\").Range(myRNG).Formula = kcFormula\n\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook"], "comments": [{"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1430926283, "post_id": 30080970, "comment_id": 48275623, "body": "You&#39;ll need to post your code."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1430932010, "post_id": 30080970, "comment_id": 48279492, "body": "What @Mr.Mascaro said, plus, if you have functioning code, that just needs to be improved for performance, you&#39;d be better served posting at <a href=\"http://codereview.stackexchange.com\">Code Review</a>."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1430934683, "post_id": 30080970, "comment_id": 48281222, "body": "What code do you use? Could you be more specific?"}], "answers": [{"comments": [{"owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "edited": false, "score": 0, "creation_date": 1430943927, "post_id": 30086073, "comment_id": 48286939, "body": "It would still be a good idea to post your code- there are quite a few ways to speed things up even if your folders are cached, e.g. MAPIFolder.GetTable"}], "tags": [], "owner": {"reputation": 63, "user_id": 2827198, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f7fab25e1956779482a574d5e094a334?s=128&d=identicon&r=PG&f=1", "display_name": "DFrancisFan", "link": "https://stackoverflow.com/users/2827198/dfrancisfan"}, "is_accepted": false, "score": 0, "last_activity_date": 1430941249, "creation_date": 1430941249, "answer_id": 30086073, "question_id": 30080970, "link": "https://stackoverflow.com/questions/30080970/ms-excel-vba-reading-outlook-calendar-items-very-slowly/30086073#30086073", "title": "MS Excel VBA Reading Outlook Calendar Items Very Slowly", "body": "<p>I actually managed to fix the problem by enabling the \"Download shared folders\" property in MS Outlook. This reduced program execution time from 45 minutes down to 7 minutes.</p>\n\n<p>Directions on how to enable the \"Download shared folders\" property:\n<a href=\"http://www.msoutlook.info/question/414\" rel=\"nofollow\">http://www.msoutlook.info/question/414</a></p>\n\n<p>Note: To find the Account Settings button in Outlook 2013, you have to navigate to the \"File\" menu.</p>\n"}], "owner": {"reputation": 63, "user_id": 2827198, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f7fab25e1956779482a574d5e094a334?s=128&d=identicon&r=PG&f=1", "display_name": "DFrancisFan", "link": "https://stackoverflow.com/users/2827198/dfrancisfan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 466, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1592699359, "creation_date": 1430925612, "last_edit_date": 1592699359, "question_id": 30080970, "link": "https://stackoverflow.com/questions/30080970/ms-excel-vba-reading-outlook-calendar-items-very-slowly", "title": "MS Excel VBA Reading Outlook Calendar Items Very Slowly", "body": "<p>I'm in the process of writing code to pull my own Outlook calendar, as well as some shared calendars into an MS Excel spreadsheet. However, I'm finding that my script is running very slowly. I've found that it takes about 1-2 minutes to load a months worth of events from my own calendar and about 10-20 minutes to load events from the same time period from a shared calendar.</p>\n\n<p>I've noticed that my script can load my personal calendar both when I'm on and offline. However, I will get a run-time error at the when I call \".GetSharedDefaultFolder\" if I am not connected to the internet. In addition, if I disconnect my internet while looping through items in a shared calendar, I will also get a run-time error. My best guess at the moment is that the majority of my speed issues are due to the fact that Outlook is checking the exchange server for each item, one at a time (I'm pretty sure this is happening).</p>\n\n<p>Does anybody have a good idea of how to solve this problem? I'd like to speed up my code so it doesn't take ~45 minutes to run my script. I have a hard time believing that Outlook does not store the most recent version of a shared calendar on my laptop. I also don't see why I shouldn't be able to call some function to download the entire calendar and then loop through the items without needing to separately request each item from the server.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba"], "owner": {"reputation": 11, "user_id": 4871019, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5965d7674e24dfdb97a176288141127f?s=128&d=identicon&r=PG&f=1", "display_name": "Henry", "link": "https://stackoverflow.com/users/4871019/henry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1430924741, "creation_date": 1430924741, "question_id": 30080611, "link": "https://stackoverflow.com/questions/30080611/vba-code-to-select-a-range-of-dates-for-reservation-spreadsheet", "title": "VBA Code to select a range of dates for Reservation spreadsheet", "body": "<p>I'm new to VBA and I'm trying to adapt what I've found online to meet my needs.  I'm trying to set up a Reservation system.  As I currently have it set up I enter the following information on sheet1 (reservation).  I'm using a different macro to store all of that info on sheet2 (data).<br>\n    Name:<br>\n    Site #<br>\n    Start Date: 1/3/2015<br>\n    End Date:   1/7/2015<br>\n    Pets:   No<br>\n    Club:<br>\n    Phone #:<br>\n    Status:     </p>\n\n<p>What I would like to be able to do is to populate a \"calendar\" of what site is being used on what date. I would like the customer's name to show up in the correct site row on their \"start date\".  I would like their range of dates with me to  be highlighted in the correct color code of their \"status\".               </p>\n\n<p>The code that I'm trying to modify only selected the start date and it puts their \"status\" in that box.  I've included the code below.  Any help would be greatly appreciated. \nthanks,\nHenry</p>\n\n<p>Sub Bookings()</p>\n\n<pre><code>Dim Rm As Range, Dt As Range, Myrng As Range, Sites As Range\nDim endCol As Range, StCol As Range, StRow As Range, endRow As Range\nDim Codei As Range, Col As Range\nDim Dws As Worksheet, Cws As Worksheet\nDim x As Integer\nDim LastRow As Long\nDim aCell As Range, bCell As Range, dCell As Range\n\nSet Cws = Reservation\nSet Dws = Data\nSet StCol = Cws.Range(\"AL3\")\nSet endCol = Cws.Range(\"AN3\")\nSet StRow = Cws.Range(\"AP3\")\nSet endRow = Cws.Range(\"AR3\")\n\nLastRow = Dws.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nSet Myrng = Dws.Range(\"B2:B\" &amp; LastRow)   'data sheet columns\nCws.Range(\"C15:AD83\").ClearContents\nCws.Range(\"C15:AD83\").Interior.ColorIndex = xlNone\n    For x = StRow To endRow\n    Set Sites = Cws.Cells(x, 2)\n            For Each d Cell In Cws.Range(Cells(x, StCol), Cells(x, endCol))\n        If Not dCell Is Nothing Then\n            Set Dt = Cells(11, dCell.Column)\n                            Set aCell = Myrng.Find(What:=Sites, LookIn:=xlValues, _\n                                   LookAt:=xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                                   MatchCase:=False, SearchFormat:=False)\n            If Not aCell Is Nothing Then\n                Set bCell = aCell\n                                    Do\n                    Set aCell = Myrng.FindNext(After:=aCell)\n                    If aCell.Offset(0, 1).Value = Dt.Value Then\n                        Set Codei = aCell.Cells(1, 4)\n                        Set Col = aCell.Cells(1, 3)\n                        dCell.Value = Codei\n                        Select Case Col\n                            Case Cws.Range(\"AJ3\").Value\n                                dCell.Interior.ColorIndex = 27\n                            Case Cws.Range(\"AJ4\").Value\n                                dCell.Interior.ColorIndex = 24\n                            Case Cws.Range(\"AJ5\").Value\n                                dCell.Interior.ColorIndex = 4\n                            Case Cws.Range(\"AJ6\").Value\n                                dCell.Interior.ColorIndex = 38\n                        End Select\n                    End If\n                    If Not aCell Is Nothing Then\n                        If aCell.Address = bCell.Address Then Exit Do\n                    Else\n                        Exit Do\n                    End If\n                Loop\n\n            End If\n        End If\n    Next dCell\n\nNext\n\nOn Error GoTo 0\n</code></pre>\n\n<p>End Sub</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 0, "creation_date": 1430927353, "post_id": 30080549, "comment_id": 48276453, "body": "Possible a <a href=\"http://stackoverflow.com/questions/19351832/vba-copy-from-one-workbook-and-paste-into-another\">duplicate</a>...."}], "answers": [{"tags": [], "owner": {"reputation": 432, "user_id": 661617, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e1b690c0b1fda5b942bec6e97906e406?s=128&d=identicon&r=PG", "display_name": "jamesC", "link": "https://stackoverflow.com/users/661617/jamesc"}, "is_accepted": true, "score": 0, "last_activity_date": 1430928603, "creation_date": 1430928603, "answer_id": 30082072, "question_id": 30080549, "link": "https://stackoverflow.com/questions/30080549/import-a-file-to-current-vba-workbook/30082072#30082072", "title": "Import a file to current VBA workbook", "body": "<p>You were almost there. Here is one way of doing it. It's a bit convoluted and I know there are more slick ways but it will get the job done.</p>\n\n<pre><code>Sub OpenAFile()\n\nDim fd As FileDialog\nDim FileWasChosen As Boolean\n\nDim homeWorkbook As Workbook\nSet homeWorkbook = ActiveWorkbook\n\nDim targetBook As Workbook\nDim targetSheet As Worksheet\n\nApplication.DisplayAlerts = False\n\nSet fd = Application.FileDialog(msoFileDialogOpen)\nfd.Filters.Add \"Any Excel Files\", \"*.xl*\"\n\nFileWasChosen = fd.Show\n\nIf Not FileWasChosen Then\n     MsgBox \"You didn't select a file\"\nExit Sub\nEnd If\n\nfd.Execute\n\nSet targetBook = ActiveWorkbook\nSet targetSheet = targetBook.Worksheets(1)\n\ntargetSheet.Copy After:=homeWorkbook.Sheets(homeWorkbook.Sheets.Count)\ntargetBook.Close\n\nApplication.DisplayAlerts = True\n\nWith homeWorkbook.Sheets(homeWorkbook.Sheets.Count)\n    .Name = \"Import\"\nEnd With\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 4871076, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c073b1e49ff0f110d6b67cb0cd153eac?s=128&d=identicon&r=PG&f=1", "display_name": "Conor", "link": "https://stackoverflow.com/users/4871076/conor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "accepted_answer_id": 30082072, "answer_count": 1, "score": 0, "last_activity_date": 1430928603, "creation_date": 1430924575, "last_edit_date": 1430924722, "question_id": 30080549, "link": "https://stackoverflow.com/questions/30080549/import-a-file-to-current-vba-workbook", "title": "Import a file to current VBA workbook", "body": "<p>I'm trying to build a VBA macro to allow a user to select a file from file Dialog and import Sheet 1 from the file to the Active VBA Workbook and to rename the Sheet as \"Import\". Im new to this and this is as far as I got. This allows me to open file dialog and select a file. But all it does is open up the file which isnt much help.</p>\n\n<pre><code>Sub OpenAFile()\n\nDim fd As FileDialog\nDim FileWasChosen As Boolean\n\nSet fd = Application.FileDialog(msoFileDialogOpen)\n\nfd.Filters.Add \"Any Excel Files\", \"*.xl*\"\n\nFileWasChosen = fd.Show\n\nIf Not FileWasChosen Then\nMsgBox \"You didn't select a file\"\nExit Sub\nEnd If\n\nfd.Execute\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["sql", "sql-server", "vba", "ms-access", "ms-access-2010"], "comments": [{"owner": {"reputation": 100127, "user_id": 67392, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/95e28ac250c4604a6f9d7e34705c3259?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/67392/richard"}, "edited": false, "score": 0, "creation_date": 1430924509, "post_id": 30080472, "comment_id": 48274196, "body": "MS Access has supported Pivot queries for a long time (I was using them 20 years ago)."}], "answers": [{"tags": [], "owner": {"reputation": 2280, "user_id": 1667945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7XzAu.png?s=128&g=1", "display_name": "John Bell", "link": "https://stackoverflow.com/users/1667945/john-bell"}, "is_accepted": false, "score": 0, "last_activity_date": 1430925587, "creation_date": 1430925587, "answer_id": 30080960, "question_id": 30080472, "link": "https://stackoverflow.com/questions/30080472/transpose-rows-to-columns-with-criteria/30080960#30080960", "title": "Transpose rows to columns with criteria", "body": "<p>You can use a recursive <code>CTE</code> to number up the location partitions, and then <code>PIVOT</code> the data:</p>\n\n<pre><code>;WITH CTE AS (\nSELECT NAME, LOCATION, 'EMP' + CAST(ROW_NUMBER() OVER(PARTITION BY LOCATION ORDER BY NAME ASC) AS VARCHAR) AS [EMP]\nFROM TABLE1)\nSELECT LOCATION, [EMP1], [EMP2], [EMP3]\nFROM CTE\nPIVOT(MAX(NAME) FOR [EMP] IN ([EMP1], [EMP2], [EMP3])) PIV\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4863945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c790dbf374042b7eb4822c12dfcd5e4?s=128&d=identicon&r=PG&f=1", "display_name": "csar101", "link": "https://stackoverflow.com/users/4863945/csar101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 279, "favorite_count": 0, "closed_date": 1430934111, "answer_count": 1, "score": -3, "last_activity_date": 1594644719, "creation_date": 1430924396, "last_edit_date": 1594644719, "question_id": 30080472, "link": "https://stackoverflow.com/questions/30080472/transpose-rows-to-columns-with-criteria", "closed_reason": "Duplicate", "title": "Transpose rows to columns with criteria", "body": "<p>I have a table with employees and their location in two columns, I'm looking to only have one occurrence of the location and the employees listed in the columns to the left until there are not more employees at that location. The number of employees change from location to location. </p>\n\n<p>Below is a sample of the table and then what I would like to see</p>\n\n<pre>\nname      location\nMARILIS   ADAMS ST RECREATION CENTER\nEDDIE     ADAMS ST RECREATION CENTER\nCARMAN    DOWNTOWN OFFICE\nDOROTHY   DOWNTOWN OFFICE\nMICHAEL   DOWNTOWN OFFICE\n\n\nlocation                     EMP1     EMP2    EMP3\nADAMS ST RECREATION CENTER   MARILIS  EDDIE\nDOWNTOWN OFFICE              CARMAN   DOROTHY MICHAEL\n</pre>\n\n<p>I've tried to use crosstabs and it clearly doesn't work that way. If someone could help me out that would be fantastic.</p>\n"}, {"tags": ["excel", "oracle", "vba"], "comments": [{"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1430924246, "post_id": 30080248, "comment_id": 48273964, "body": "On which line do you have the error?"}, {"owner": {"reputation": 1, "user_id": 2147813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d31254122229596a46bb8869bb65649?s=128&d=identicon&r=PG", "display_name": "Mohan Raj", "link": "https://stackoverflow.com/users/2147813/mohan-raj"}, "reply_to_user": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1430924384, "post_id": 30080248, "comment_id": 48274070, "body": "i am having error on this line. Set cnn = CreateObject(\u201cADODB.Connection\u201d)"}], "answers": [{"tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": false, "score": 0, "last_activity_date": 1430925544, "creation_date": 1430925544, "answer_id": 30080940, "question_id": 30080248, "link": "https://stackoverflow.com/questions/30080248/cannot-generate-data-using-excel-vbarun-time-error-424/30080940#30080940", "title": "Cannot generate data Using EXCEL VBA(run time error 424)", "body": "<p>Try this :</p>\n\n<pre><code>Dim oConn As New ADODB.Connection\nDim RS As New ADODB.Recordset\n\nSet oConn = New ADODB.Connection\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2147813, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d31254122229596a46bb8869bb65649?s=128&d=identicon&r=PG", "display_name": "Mohan Raj", "link": "https://stackoverflow.com/users/2147813/mohan-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 338, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430984627, "creation_date": 1430923843, "last_edit_date": 1430984627, "question_id": 30080248, "link": "https://stackoverflow.com/questions/30080248/cannot-generate-data-using-excel-vbarun-time-error-424", "title": "Cannot generate data Using EXCEL VBA(run time error 424)", "body": "<p>I am trying to retrieve the Data from Oracle using Excel VBA, but I am getting <code>\"run time error 424. object required\"</code>. PFB source code. I am so new to Excel VBA. I appreciate your help.</p>\n\n<pre><code>Sub Generate_Data()\nDim str As String\nDim UID As String\nDim PWD As String\nDim Server As String\nUID = \"userid\" 'Enter the User ID\nPWD = \"pwd\" 'Enter the password\nServer = \"server\" 'This comes from your TNSNames.ora file\nstr = \"PROVIDER=MSDAORA.Oracle;DATA SOURCE= &amp; Server &amp; ;Persist Security Info=True;USER ID= &amp; UID &amp; ;PASSWORD= &amp; PWD &amp;\"\nSet cnn = CreateObject(\u201cADODB.Connection\u201d)\ncnn.Open str\nSet RS = CreateObject(\u201cADODB.Recordset\u201d)\nRow = 5\ncol = 5\nnumRs = RS.Fields.Count\nnum = 0\nstrSQL = \"SELECT * FROM H1.TRADE_LOT_BASIS WHERE TO_CHAR(BOOK_VALUE_DATE,'YYYY')&gt;=TO_CHAR(SYSDATE,'YYYY')\"\n    RS.Open strSQL, cnn\n    Do Until RS.EOF\n    Do While num &lt; numRs\n    Cells(Row, col + num).Value = RS(num)\n    num = num + 1\n    Loop\n    num = 0\n    Row = Row + 1\n    RS.moveNext\n    Loop\n    RS.Close\n    cnn.Close\n    End Sub\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1430925571, "post_id": 30080226, "comment_id": 48275067, "body": "What do you mean by &#39;dynamic path&#39;?"}], "answers": [{"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 0, "last_activity_date": 1430926281, "creation_date": 1430926281, "answer_id": 30081233, "question_id": 30080226, "link": "https://stackoverflow.com/questions/30080226/select-dymanic-path-prompt-to-save-file-in-excel-vba/30081233#30081233", "title": "select dymanic path &amp; prompt to save file in excel vba", "body": "<ol>\n<li><p>This block of code is good once everything is running properly:<br> <code>Application.DisplayAlerts = False</code><br> <code>Application.EnableEvents = False</code><br> <code>Application.ScreenUpdating = False</code><br>Until your code is completely debugged, though, it will make your life a nightmare. Comment those 3 out until this procedure is running the way you want it.</p></li>\n<li><p>you appear to declare (<code>Dim</code>) some of your variables, but not all. I would strongly recommend adding <code>Option Explicit</code> to the top of all your code modules to force variable declaration prior to use - it helps prevent typos in variable names from messing things up down the road.</p></li>\n<li><p>You assign <code>SelectedFiles</code> the return value from <code>Application.GetOpenFilename</code>, but don't ever use it. When it's assigned, you will have an array of file names that the user selected, and they will include the full path. This may provide the path information you need (the dialog box will allow the user to navigate to the desired folder), but I'm not sure, because...</p></li>\n<li><p>You assign <code>strFilename = Dir(FolderLocation &amp; \"\\*.xls\", vbNormal)</code> which gives you the first <code>*.xls</code> file located in <code>FolderLocation</code>. You then loop through all the <code>*.xls</code> files there.</p></li>\n</ol>\n\n<p>I would suggest that using your existing code, you could pull the path information from <code>SelectedFiles</code> like this:</p>\n\n<pre><code>SelectedFiles = Application.GetOpenFilename( _\n         filefilter:=\"Excel Files (*.xls*), *.xls*\", MultiSelect:=False)\nIf InStrRev(SelectedFiles, \"\\\") &gt; 0 Then\n  FolderLocation = Left(SelectedFiles, InStrRev(SelectedFiles, \"\\\"))\nEnd If\n</code></pre>\n\n<p>Note that I changed <code>Multiselect:=False</code> to allow the user to only select one file - I don't see where you're using this variable anywhere else, so I've modified it to simply use it as a path picker. If that's incorrect, you'll have to make another modification to select the path. Otherwise, <code>FolderLocation</code> will now point to the directory that the user selected and you can continue your looping after that using the folder they selected.</p>\n"}], "owner": {"reputation": 193, "user_id": 4073935, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/13ecac1ecbe32dbaa46774767ca953e4?s=128&d=identicon&r=PG&f=1", "display_name": "Unicorn", "link": "https://stackoverflow.com/users/4073935/unicorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2937, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430926281, "creation_date": 1430923802, "last_edit_date": 1531161705, "question_id": 30080226, "link": "https://stackoverflow.com/questions/30080226/select-dymanic-path-prompt-to-save-file-in-excel-vba", "title": "select dymanic path &amp; prompt to save file in excel vba", "body": "<p>Hi i am looking dynamic path to be taken for uploading excel file and should ask where to save the file. here is my code.`where as i tried but it is taking only static path. Any help would be appreciated.</p>\n\n<p>'To Combine Sheets</p>\n\n<pre><code>Dim WorkbookDestination As Workbook\nDim WorkbookSource As Workbook\nDim WorksheetSource As Worksheet\nDim FolderLocation As String\nDim strFilename As String\n\nApplication.DisplayAlerts = False\nApplication.EnableEvents = False\nApplication.ScreenUpdating = False\n\n'This line will need to be modified depending on location of source folder\nFolderLocation = \"U:\\ECA\"  'file location need to be dynamic\n\n'Set the current directory to the the folder path.\nChDrive FolderLocation\nChDir FolderLocation\n\n'Dialog box to determine which files to use. Use ctrl+a to select all files in folder.\nSelectedFiles = Application.GetOpenFilename( _\nfilefilter:=\"Excel Files (*.xls*), *.xls*\", MultiSelect:=True)\n\n'Create a new workbook\nSet WorkbookDestination = Workbooks.Add(xlWBATWorksheet)\nstrFilename = Dir(FolderLocation &amp; \"\\*.xls\", vbNormal) 'file name should be specified by user input and output file\n\n'Iterate for each file in folder\nIf Len(strFilename) = 0 Then Exit Sub\nDo Until strFilename = \"\"\n\n        Set WorkbookSource = Workbooks.Open(Filename:=FolderLocation &amp; \"\\\" &amp; strFilename)\n        Set WorksheetSource = WorkbookSource.Worksheets(1)\n        WorksheetSource.Copy After:=WorkbookDestination.Worksheets(WorkbookDestination.Worksheets.Count)\n        WorkbookSource.Close False\n    strFilename = Dir()\nLoop\nWorkbookDestination.Worksheets(1).Delete\n\n Application.DisplayAlerts = False\nActiveWorkbook.SaveAs Filename:=FolderLocation\nApplication.DisplayAlerts = True\n\nApplication.DisplayAlerts = True\nApplication.EnableEvents = True\nApplication.ScreenUpdating = True`\n</code></pre>\n"}, {"tags": ["c#", "vba", "internet-explorer", "vbscript"], "comments": [{"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 2, "creation_date": 1430923614, "post_id": 30079969, "comment_id": 48273459, "body": "You can&#39;t loop through each tab and get the <code>ReadyState</code>?  As I&#39;m reading your code, the <code>objExplorer</code> object is just for the current tab."}, {"owner": {"reputation": 544, "user_id": 1797341, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/7vGap.jpg?s=128&g=1", "display_name": "Hugo M. Zuleta", "link": "https://stackoverflow.com/users/1797341/hugo-m-zuleta"}, "reply_to_user": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1430924493, "post_id": 30079969, "comment_id": 48274182, "body": "@Mr.Mascaro Is it possible to have instead different objects for each tab and perform the &quot;is it busy&quot; check asynchronously?"}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1430925357, "post_id": 30079969, "comment_id": 48274884, "body": "That would be perfectly valid."}, {"owner": {"reputation": 544, "user_id": 1797341, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/7vGap.jpg?s=128&g=1", "display_name": "Hugo M. Zuleta", "link": "https://stackoverflow.com/users/1797341/hugo-m-zuleta"}, "reply_to_user": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1431390955, "post_id": 30079969, "comment_id": 48465494, "body": "Apparently, vbscript can&#39;t run processes on multiple threads. My solution (which still doesn&#39;t answer the question) was to have a different object for each different IE window, instead of tabs, and then ask if each one was done loading to proceed to the next one."}], "owner": {"reputation": 544, "user_id": 1797341, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/7vGap.jpg?s=128&g=1", "display_name": "Hugo M. Zuleta", "link": "https://stackoverflow.com/users/1797341/hugo-m-zuleta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 240, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1430924517, "creation_date": 1430923233, "last_edit_date": 1430924517, "question_id": 30079969, "link": "https://stackoverflow.com/questions/30079969/wait-until-ie-loads-every-tab-vbscript", "title": "Wait until IE loads every tab vbscript", "body": "<p>I've been trying to make a vbscript that waits until every tab I open with Internet Explorer has loaded. However, for some reason, it only waits until the last webpage I open finishes loading.\nHere is my code:</p>\n\n<pre><code>Set objExplorer = CreateObject(\"InternetExplorer.Application\")\nWebSite = \"https://www.google.com\"\nwith objExplorer\n.Navigate2 WebSite\n.AddressBar = 1\n.Visible = 1\n.ToolBar = 1\n.StatusBar = 1\nend with\n\n\nWebSite = \"http://www.intel.com\"\nwith objExplorer\n.Navigate2 WebSite, &amp;h800\n.AddressBar = 1\n.Visible = 1\n.ToolBar = 1\n.StatusBar = 1\nend with\n\n\nWebSite = \"http://www.theverge.com\"\nwith objExplorer\n.Navigate2 WebSite, &amp;h800\n.AddressBar = 1\n.Visible = 1\n.ToolBar = 1\n.StatusBar = 1\nend with\n\nDo While objExplorer.ReadyState &lt;&gt; 4 Or objExplorer.Busy\n    WScript.Sleep 10\nLoop\n\nDo While objExplorer.Document.ReadyState &lt;&gt; \"complete\"\n    WScript.Sleep 10\nLoop\n</code></pre>\n\n<p>I load about 7 webpages, each in different tabs.\nAs a bonus, is it possible to do this on C# instead?\nThanks!</p>\n"}, {"tags": ["excel", "filter", "combobox", "userform", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 3996520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b0e80f0effef046b0744293861d8606?s=128&d=identicon&r=PG&f=1", "display_name": "richienrg", "link": "https://stackoverflow.com/users/3996520/richienrg"}, "edited": false, "score": 0, "creation_date": 1430927390, "post_id": 30080100, "comment_id": 48276476, "body": "Ah Ha!   Thank you.   Sometimes you need a fresh set of eyes."}], "tags": [], "owner": {"reputation": 16, "user_id": 4871103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/957e597081426f0b384bffc135772dba?s=128&d=identicon&r=PG&f=1", "display_name": "Lase Lui", "link": "https://stackoverflow.com/users/4871103/lase-lui"}, "is_accepted": true, "score": 0, "last_activity_date": 1430927486, "last_edit_date": 1430927486, "creation_date": 1430923538, "answer_id": 30080100, "question_id": 30079552, "link": "https://stackoverflow.com/questions/30079552/excel-vba-filter-on-combobox-does-not-recognise-first-value/30080100#30080100", "title": "Excel VBA - Filter on ComboBox does not recognise first value", "body": "<pre><code>If ComboBox1.ListIndex &gt; -1 Then ...........\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 3996520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b0e80f0effef046b0744293861d8606?s=128&d=identicon&r=PG&f=1", "display_name": "richienrg", "link": "https://stackoverflow.com/users/3996520/richienrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 30080100, "answer_count": 1, "score": 0, "last_activity_date": 1430927486, "creation_date": 1430922202, "last_edit_date": 1531161705, "question_id": 30079552, "link": "https://stackoverflow.com/questions/30079552/excel-vba-filter-on-combobox-does-not-recognise-first-value", "title": "Excel VBA - Filter on ComboBox does not recognise first value", "body": "<p>I have a userform set up which contains a ComboBox.   The ComboBox is populated with values which are pulled from a range of cells which have been defined in the Name Manager (range of A1:A5 stored in a separate sheet.)   The default caption for ComboBox is \"Select Office\"</p>\n\n<p>On the ComboBox_Change() Sub I have the following code: </p>\n\n<pre><code>Private Sub ComboBox1_Change()\nApplication.ScreenUpdating = False\nWith Sheets(\"wpdata\").UsedRange\n    .AutoFilter\n    If ComboBox1.ListIndex &gt; 0 Then .AutoFilter 5, ComboBox1.Value\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>This works perfectly with options 2, 3, 4 and 5.  </p>\n\n<p>However,  when the first option is selected it does not filter at all and the filter remains on the previously selected item.   I have also tried to select option 1 first and it still doesn't filter.  I have tried re-ordering the ComboBox values but this doesn't have any effect,  the first option is still not recognised.  </p>\n\n<p>Does any one have any solutions?  </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 317, "user_id": 3897155, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e6fc777dbccdd3f1e8fb4380337b4729?s=128&d=identicon&r=PG&f=1", "display_name": "mb1987", "link": "https://stackoverflow.com/users/3897155/mb1987"}, "edited": false, "score": 0, "creation_date": 1430923693, "post_id": 30079793, "comment_id": 48273517, "body": "ok I tried saving it by typing ActiveWorkbook.Save but still no luck"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1430922800, "creation_date": 1430922800, "answer_id": 30079793, "question_id": 30079544, "link": "https://stackoverflow.com/questions/30079544/converting-csv-to-xslx-and-adding-column-to-the-front-with-file-name-values-in-i/30079793#30079793", "title": "converting csv to xslx and adding column to the front with file name values in it using VBA", "body": "<p>Once you <strong>Open</strong> the new workbook, it becomes the ActiveWorkbook.  You save it, and then settup the first column, and then close it without saving it again.</p>\n"}], "owner": {"reputation": 317, "user_id": 3897155, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e6fc777dbccdd3f1e8fb4380337b4729?s=128&d=identicon&r=PG&f=1", "display_name": "mb1987", "link": "https://stackoverflow.com/users/3897155/mb1987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430922800, "creation_date": 1430922177, "question_id": 30079544, "link": "https://stackoverflow.com/questions/30079544/converting-csv-to-xslx-and-adding-column-to-the-front-with-file-name-values-in-i", "title": "converting csv to xslx and adding column to the front with file name values in it using VBA", "body": "<p>I am trying to convert csv files to excel files, and adding column to the front,\nwith newly added column I want to fill it with the file name of that worksheet until the last row where data exist in that worksheet the code I am using is</p>\n\n<pre><code>Sub CSVtoXlsx()\n\n Dim CSVfolder As String\n Dim XlsFolder As String\n Dim fname As String\n Dim wBook As Workbook\n\n lastRow = ActiveSheet.UsedRange.Row - 1 + ActiveSheet.UsedRange.Rows.Count\n strAddress2 = \"A3:A\" &amp; lastRow\n wbName = ActiveWorkbook.Name\n\n CSVfolder = \"C:\\csvfolder\\\"\n XlsFolder = \"C:\\xlsFolder\\\"\n\n fname = Dir(CSVfolder &amp; \"*.csv\")\n\n Do While fname &lt;&gt; \"\"\n    Set wBook = Workbooks.Open(CSVfolder &amp; fname, Format:=6, Delimiter:=\",\")\n    wBook.SaveAs XlsFolder &amp; Replace(fname, \".csv\", \"\"), xlWorkbookDefault\n    ActiveCell.EntireColumn.Insert\n    ActiveWorkbook.Save\n    Range(strAddress2).Value = Left(wbName, InStrRev(wbName, \".\") - 1)\n    wBook.Close False\n fname = Dir\nLoop\n\nEnd Sub\n</code></pre>\n\n<p>this code successfully convert csv file to xslx format and also add a new column to the front of it, but it is not filling the newly added column with the file name.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 1, "creation_date": 1430921778, "post_id": 30079262, "comment_id": 48272042, "body": "Do you have access to use Windows Task scheduler?"}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1430922384, "post_id": 30079262, "comment_id": 48272506, "body": "The absolute best way would be to utilize Powershell and Windows Task Scheduler."}, {"owner": {"reputation": 31, "user_id": 3877643, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/wcdUM.jpg?s=128&g=1", "display_name": "user3877643", "link": "https://stackoverflow.com/users/3877643/user3877643"}, "edited": false, "score": 0, "creation_date": 1430923249, "post_id": 30079262, "comment_id": 48273144, "body": "Yes I have access to Windows Task Scheduler, but how the Task Scheduler will run the VBA code and save the file with current date?"}], "answers": [{"comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1430922280, "post_id": 30079446, "comment_id": 48272410, "body": "If you use the second option, wouldn&#39;t you basically have to open Excel, run the Macro and then Excel would essentially be frozen, waiting for 2300?  Or can you still use Excel while running a macro waiting on that TimeValue?"}, {"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1430922327, "post_id": 30079446, "comment_id": 48272446, "body": "@user3578951, excel will not be frozen."}, {"owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "edited": false, "score": 1, "creation_date": 1430922377, "post_id": 30079446, "comment_id": 48272499, "body": "Nice solution. I don&#39;t see a point in putting this code in <code>BeforeSave</code> in any case."}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1430922978, "post_id": 30079446, "comment_id": 48272944, "body": "@user3578951 just a reminder that you will need to make sure that excel remains open for the <code>application.ontime</code> to work. And also make sure that you run it each time, so consider putting it in the workbook open event or something like that"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "edited": false, "score": 0, "creation_date": 1430923009, "post_id": 30079446, "comment_id": 48272971, "body": "@dePatinkin Thanks. Yeah with this code I would have it at a seperate sub"}, {"owner": {"reputation": 31, "user_id": 3877643, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/wcdUM.jpg?s=128&g=1", "display_name": "user3877643", "link": "https://stackoverflow.com/users/3877643/user3877643"}, "edited": false, "score": 0, "creation_date": 1430923709, "post_id": 30079446, "comment_id": 48273533, "body": "I added the code in workbook open event, I can use the Task Scheduler to open the workbook, the only thing remain the file name, i want to use &quot;hr2015-05-06&quot; format. the date is current date."}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "reply_to_user": {"reputation": 31, "user_id": 3877643, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/wcdUM.jpg?s=128&g=1", "display_name": "user3877643", "link": "https://stackoverflow.com/users/3877643/user3877643"}, "edited": false, "score": 0, "creation_date": 1430924632, "post_id": 30079446, "comment_id": 48274296, "body": "@user3877643 what does the <code>hr</code> stand for? Hour? Or do you just want it to say <code>hr TODAYSDATE</code>. And do you want the brackets in it as well?"}, {"owner": {"reputation": 31, "user_id": 3877643, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/wcdUM.jpg?s=128&g=1", "display_name": "user3877643", "link": "https://stackoverflow.com/users/3877643/user3877643"}, "edited": false, "score": 0, "creation_date": 1430924845, "post_id": 30079446, "comment_id": 48274473, "body": "its a Text, stand for Human Resources. hrYYYY-MM-DD format if possible."}, {"owner": {"reputation": 31, "user_id": 3877643, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/wcdUM.jpg?s=128&g=1", "display_name": "user3877643", "link": "https://stackoverflow.com/users/3877643/user3877643"}, "edited": false, "score": 0, "creation_date": 1430925662, "post_id": 30079446, "comment_id": 48275134, "body": "TempFileName = Sourcewb.Path &amp; &quot;\\hr&quot; &amp; Format(Date, &quot;yyyy-mm-dd&quot;) &amp; &quot;.csv&quot; I changed the file name and change the code as above, its work perfectly."}], "tags": [], "owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "is_accepted": false, "score": 7, "last_activity_date": 1430924907, "last_edit_date": 1430924907, "creation_date": 1430921925, "answer_id": 30079446, "question_id": 30079262, "link": "https://stackoverflow.com/questions/30079262/run-vba-code-on-specific-time/30079446#30079446", "title": "Run VBA code on specific time", "body": "<p>I would do this one of two ways. </p>\n\n<p>One would be through windows task scheduler. Where you will set up a task to open Excel and run it that way. See <a href=\"http://www.mrexcel.com/forum/excel-questions/302970-task-scheduler-vbulletin-script-auto-open-excel.html\" rel=\"nofollow\">http://www.mrexcel.com/forum/excel-questions/302970-task-scheduler-vbulletin-script-auto-open-excel.html</a></p>\n\n<p>Or</p>\n\n<p>Use the code </p>\n\n<p><code>Application.OnTime TimeValue(\"23:00:00\"), SUBNAMEHERE</code></p>\n\n<p>Changing <code>SUBNAMEHERE</code> to the sub where the code is. Not sure if it will run the beforesave part through</p>\n\n<p>EDIT added code to have filename</p>\n\n<p>Change <code>TempFileName = Sourcewb.FullName + \".csv\"</code> to be</p>\n\n<p><code>TempFileName = Sourcewb.FullName &amp; \" hr\" &amp; format(now,\"YYYY-MM-DD\") &amp; \".csv\"</code></p>\n"}], "owner": {"reputation": 31, "user_id": 3877643, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/wcdUM.jpg?s=128&g=1", "display_name": "user3877643", "link": "https://stackoverflow.com/users/3877643/user3877643"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9314, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1430924907, "creation_date": 1430921489, "last_edit_date": 1430923115, "question_id": 30079262, "link": "https://stackoverflow.com/questions/30079262/run-vba-code-on-specific-time", "title": "Run VBA code on specific time", "body": "<p>I found the following code on this web site \"save Excel file as CSV\" is there any way with help of you'll I can auto run this code on specific time (11:00 pm every night), and save file name as current date (hr2015-05-05), any help will be greatly appreciated. Thanks</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)\nDim Sourcewb As Workbook\nDim Destwb As Workbook\nDim TempFileName As String\n\nWith Application\n    .ScreenUpdating = False\n    .EnableEvents = False\n    .DisplayAlerts = False\nEnd With\n\nSet Sourcewb = ActiveWorkbook\nTempFileName = Sourcewb.FullName + \".csv\"\n\n'Copy the sheet to a new workbook\nActiveSheet.Copy\nSet Destwb = ActiveWorkbook\n\n'Save the new workbook and close it\nWith Destwb\n    .SaveAs Filename:=TempFileName, FileFormat:=xlCSV, ConflictResolution:=xlLocalSessionChanges\n    .Close SaveChanges:=False\nEnd With\n\nWith Application\n    .ScreenUpdating = True\n    .EnableEvents = True\n    .DisplayAlerts = True\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Edit fixed tag issue</p>\n"}, {"tags": ["vba", "powerpoint"], "comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430921268, "post_id": 30078960, "comment_id": 48271634, "body": "You can do a random function between 2 and 13 and then check if the numbers are even, if they are then do not use that number. Also what would the purpose of this be?"}, {"owner": {"reputation": 3, "user_id": 2022299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be33d91cb1a6a8ee59b25d27ac9f265?s=128&d=identicon&r=PG", "display_name": "puzznic", "link": "https://stackoverflow.com/users/2022299/puzznic"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1431022362, "post_id": 30078960, "comment_id": 48328285, "body": "The purpose of the requested code is to go to different starting slides each time a game is begun."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 2022299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be33d91cb1a6a8ee59b25d27ac9f265?s=128&d=identicon&r=PG", "display_name": "puzznic", "link": "https://stackoverflow.com/users/2022299/puzznic"}, "edited": false, "score": 0, "creation_date": 1431014494, "post_id": 30079222, "comment_id": 48323647, "body": "thx, I would like to test this code but unable (lack the expertise) to assign it to a button.  Any chance you can make the code a subroutine pls?"}, {"owner": {"reputation": 3, "user_id": 2022299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be33d91cb1a6a8ee59b25d27ac9f265?s=128&d=identicon&r=PG", "display_name": "puzznic", "link": "https://stackoverflow.com/users/2022299/puzznic"}, "edited": false, "score": 0, "creation_date": 1431026539, "post_id": 30079222, "comment_id": 48330634, "body": "Sub go_slide() Function randomSlideNumber() As Integer     Dim index    Dim targetValues(1 To 6) As Integer     targetValues(1) = 3    targetValues(2) = 5    targetValues(3) = 7    targetValues(4) = 9    targetValues(5) = 11    targetValues(6) = 13     index = Int(6 * Rnd + 1)     randomSlideNumber = targetValues(index) ActivePresentation.SlideShowWindow.View.GotoSlide index End Function End Sub"}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "reply_to_user": {"reputation": 3, "user_id": 2022299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be33d91cb1a6a8ee59b25d27ac9f265?s=128&d=identicon&r=PG", "display_name": "puzznic", "link": "https://stackoverflow.com/users/2022299/puzznic"}, "edited": false, "score": 0, "creation_date": 1431096318, "post_id": 30079222, "comment_id": 48362849, "body": "Hi @puzznic sorry I hadn&#39;t been back here. I will be happy to expand on this for you but it will be a bit later today, okay?"}, {"owner": {"reputation": 3, "user_id": 2022299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be33d91cb1a6a8ee59b25d27ac9f265?s=128&d=identicon&r=PG", "display_name": "puzznic", "link": "https://stackoverflow.com/users/2022299/puzznic"}, "edited": false, "score": 0, "creation_date": 1431370944, "post_id": 30079222, "comment_id": 48457225, "body": "thank you David, all help will be very much appreciated"}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "reply_to_user": {"reputation": 3, "user_id": 2022299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be33d91cb1a6a8ee59b25d27ac9f265?s=128&d=identicon&r=PG", "display_name": "puzznic", "link": "https://stackoverflow.com/users/2022299/puzznic"}, "edited": false, "score": 0, "creation_date": 1431483884, "post_id": 30079222, "comment_id": 48514374, "body": "@puzznic - Apologies for the delay in getting back to you!! I&#39;ve modified the solution to incorporate as much help as I could infer you might need along with some screen shots and some detail on how to wire it all up. You may need to read up just a bit on the PowerPoint object model to understand some of it, but either way, I hope this is useful for you!"}, {"owner": {"reputation": 3, "user_id": 2022299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be33d91cb1a6a8ee59b25d27ac9f265?s=128&d=identicon&r=PG", "display_name": "puzznic", "link": "https://stackoverflow.com/users/2022299/puzznic"}, "edited": false, "score": 0, "creation_date": 1431559124, "post_id": 30079222, "comment_id": 48557315, "body": "Thank you David.  I will test this as soon as I can and post results here"}, {"owner": {"reputation": 3, "user_id": 2022299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be33d91cb1a6a8ee59b25d27ac9f265?s=128&d=identicon&r=PG", "display_name": "puzznic", "link": "https://stackoverflow.com/users/2022299/puzznic"}, "edited": false, "score": 0, "creation_date": 1431594866, "post_id": 30079222, "comment_id": 48569397, "body": "David, this code works like a dream, Voila indeed.  I just had to remove the word &#39;private&#39; from the subroutine name to make it appear in the ppt macro list.  I am very very grateful for your help,   Art"}, {"owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "reply_to_user": {"reputation": 3, "user_id": 2022299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be33d91cb1a6a8ee59b25d27ac9f265?s=128&d=identicon&r=PG", "display_name": "puzznic", "link": "https://stackoverflow.com/users/2022299/puzznic"}, "edited": false, "score": 0, "creation_date": 1431600521, "post_id": 30079222, "comment_id": 48572749, "body": "Awesome, @puzznic! If you wouldn&#39;t mind checking this as the answer I&#39;d be most appreciative!"}], "tags": [], "owner": {"reputation": 9812, "user_id": 1345535, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/b62063f3b5bf78c24c71085aca077e2e?s=128&d=identicon&r=PG", "display_name": "David W", "link": "https://stackoverflow.com/users/1345535/david-w"}, "is_accepted": true, "score": 1, "last_activity_date": 1431483789, "last_edit_date": 1431483789, "creation_date": 1430921386, "answer_id": 30079222, "question_id": 30078960, "link": "https://stackoverflow.com/questions/30078960/powerpoint-vba-generate-a-random-number-from-a-specific-set/30079222#30079222", "title": "powerpoint, vba, generate a random number from a specific set", "body": "<p><strong>Edit: Modified to include a more comprehensive solution at request of OP</strong></p>\n\n<p>Objective: Randomly select one of six possible slide numbers to display following the click of a button. </p>\n\n<p><strong>Step 1: Code to randomize slide number selection</strong></p>\n\n<p>Map the target values into an array. Note the number of elements in the resultant array - in this case, 6. Generate a random integer from 1 to 6, and use that value as an index into the array, returning the value at that index position. </p>\n\n<p>Something like the following (untested)</p>\n\n<pre><code>function randomSlideNumber() as Integer\n\n   Dim index \n   Dim targetValues(1 to 6) as Integer\n\n   targetValues(1) = 3\n   targetValues(2) = 5\n   targetValues(3) = 7\n   targetValues(4) = 9\n   targetValues(5) = 11\n   targetValues(6) = 13\n\n   index = Int(6 * Rnd + 1)\n\n   randomSlideNumber = targetValues(index)\n\nend function\n</code></pre>\n\n<p><strong>Step 2: Add slides to a Powerpoint presentation up to the number desired in the random selector</strong></p>\n\n<p>I'm assuming the OP already has at least 13 slides in his presentation :)</p>\n\n<p><strong>Step 3: Add an additional slide to the presentation, and add a CommandButton to it</strong></p>\n\n<ol>\n<li>With the new slide active in Powerpoint, click the 'Developer' tab. </li>\n<li>Select a <code>CommandButton</code> from the Controls toolbar, and draw it onto the new slide.\n<img src=\"https://i.stack.imgur.com/znWAg.png\" alt=\"VBA Controls w/CommandButton highlighted\">\n<img src=\"https://i.stack.imgur.com/4U2Nk.png\" alt=\"PowerPoint slide with VBA CommandButton\"></li>\n<li>Double-click the CommandButton. This should open the VBA editor with a stub Click event handler for the CommandButton, called <code>CommandButton1_Click()</code>.\n<img src=\"https://i.stack.imgur.com/TX6Ra.png\" alt=\"enter image description here\"></li>\n<li>Modify the handler code as follows:</li>\n</ol>\n\n<p>P</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\n    SlideShowWindows(1).View.GotoSlide randomSlideNumber\n\nEnd Sub\n</code></pre>\n\n<p><strong>Step 5: Start the slide show, using the slide with the new CommandButton as the starting point</strong></p>\n\n<ol>\n<li>With the new slide active, select the \"Slide Show\" tab from the ribbon bar</li>\n<li>Click \"From Current Slide\" from the \"Start Slide Show\" bar.</li>\n</ol>\n\n<p><img src=\"https://i.stack.imgur.com/vE52P.png\" alt=\"Start Slide Show with new slide\"></p>\n\n<p><strong>Step 6: Click the CommandButton on the slide, and verify that the active slide changes to one of those returned by the <code>randomSlideNumber()</code> function</strong></p>\n\n<p>Voila! :)</p>\n\n<p><strong>Code Discussion</strong></p>\n\n<p><strong>Note: This involves a little detail about the PowerPoint VBA object model.</strong></p>\n\n<p>Clicking the CommandButton in the slide created in Step 3 fires the <code>CommandButtton1_Click()</code> event handler created in Step 4. The event handler then goes to the current <code>View</code> of the first <code>SlideShowWindow</code> object <code>SlideShowWindow(1).View</code>, and calls the <code>GotoSlide</code> method of the <code>View</code>. The <code>GotoSlide</code> method expects a <em>slide number</em> as a parameter, which is provided by the call to the 'randomSlideNumber' function defined earlier. That function should return one of 3, 5, 7, 9, 11, or 13.</p>\n\n<p>That <em>should</em> do the trick. \n<strong>Caveats: There is obviously no error handling in this code; its addition is left as an exercise. Further, this has <em>not</em> been extensively tested against the very latest version of Powerpoint, but did work in the test shell I created.</strong></p>\n"}], "owner": {"reputation": 3, "user_id": 2022299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6be33d91cb1a6a8ee59b25d27ac9f265?s=128&d=identicon&r=PG", "display_name": "puzznic", "link": "https://stackoverflow.com/users/2022299/puzznic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2850, "favorite_count": 2, "accepted_answer_id": 30079222, "answer_count": 1, "score": -1, "last_activity_date": 1431483789, "creation_date": 1430920672, "question_id": 30078960, "link": "https://stackoverflow.com/questions/30078960/powerpoint-vba-generate-a-random-number-from-a-specific-set", "title": "powerpoint, vba, generate a random number from a specific set", "body": "<p>VBA - how can i generate a random number within the specific set 3,5,7,9,11,13.\nthese numbers represent slide numbers (destinations) which the user will be taken to when a button is clicked.</p>\n"}, {"tags": ["excel", "vbscript", "ado", "vba"], "comments": [{"owner": {"reputation": 44153, "user_id": 109035, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/CrLfp.jpg?s=128&g=1", "display_name": "Raj More", "link": "https://stackoverflow.com/users/109035/raj-more"}, "edited": false, "score": 1, "creation_date": 1430920830, "post_id": 30078636, "comment_id": 48271334, "body": "You can&#39;t join Excel to Oracle in a regular <code>SELECT .. JOIN</code> in PLSQL."}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 3790665, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ba383e98f28781ab6f7a4c3d2df6e40c?s=128&d=identicon&r=PG&f=1", "display_name": "Testers Logic", "link": "https://stackoverflow.com/users/3790665/testers-logic"}, "edited": false, "score": 0, "creation_date": 1430981872, "post_id": 30080717, "comment_id": 48300173, "body": "Yaa thats better for large databases, but I wanted to merge the connections as said above, and it seems its not possible. Thanks for your replies :)"}, {"owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "reply_to_user": {"reputation": 67, "user_id": 3790665, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ba383e98f28781ab6f7a4c3d2df6e40c?s=128&d=identicon&r=PG&f=1", "display_name": "Testers Logic", "link": "https://stackoverflow.com/users/3790665/testers-logic"}, "edited": false, "score": 0, "creation_date": 1430994672, "post_id": 30080717, "comment_id": 48308518, "body": "there are many approaches possible but not that one, could you accept the answer then ?"}], "tags": [], "owner": {"reputation": 40236, "user_id": 923315, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/j6lLI.jpg?s=128&g=1", "display_name": "peter", "link": "https://stackoverflow.com/users/923315/peter"}, "is_accepted": false, "score": 0, "last_activity_date": 1430925028, "creation_date": 1430925028, "answer_id": 30080717, "question_id": 30078636, "link": "https://stackoverflow.com/questions/30078636/connect-two-different-databases-with-single-ado-connection-using-vbscript/30080717#30080717", "title": "Connect two different databases with single ADO connection using vbscript", "body": "<p>I recommend you to do the opposite, read the Excel file into another SQL Developer database table, preferably in the same schema as the other table and perform your sql in your script or database management tool. It is not possible to use different connection parameters like eg the provider in one connectionstring.</p>\n"}], "owner": {"reputation": 67, "user_id": 3790665, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ba383e98f28781ab6f7a4c3d2df6e40c?s=128&d=identicon&r=PG&f=1", "display_name": "Testers Logic", "link": "https://stackoverflow.com/users/3790665/testers-logic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 837, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430925028, "creation_date": 1430919855, "last_edit_date": 1531164843, "question_id": 30078636, "link": "https://stackoverflow.com/questions/30078636/connect-two-different-databases-with-single-ado-connection-using-vbscript", "title": "Connect two different databases with single ADO connection using vbscript", "body": "<p>The source file is an excel file (Sheet1) and the target file is a database (oracle sql developer). My requirement is to compare both the databases and verify whether all the records are matching and do some more logical comparisons between them. So I have copied the records from target database (sql developer) and stored it in the Sheet2 of source file (excel). I wrote a vbscript to connect Excel file using adodb connection strings and written the sql query to compare the records using the join query. <br></p>\n\n<p><b>Sample Query:</b></p>\n\n<pre><code>SELECT srcTbl.Column_SH1_A, trgtTbl.Column_SH2_A, srcTbl.Column_SH1_B,\n       trgtTbl.Column_SH2_B \n  FROM [Sheet1$] srcTbl, [Sheet2$] trgtTbl \n WHERE srcTbl.Column_SH1_A = trgtTbl.Column_SH2_A \n   AND (srcTbl.Column_SH1_B &lt;&gt; trgtTbl.Column_SH2_B)\n</code></pre>\n\n<p>Using the above procedure I can able to compare the records from different databases, but I don't want to move the records from target database to source file (Sheet2 in excel), instead I want to connect Excel file as one connection, SQL developer as another connection and directly use both the databases in the above join query (instead of Sheet1 and Sheet2, I want to use Excel database and SQL Developer database). </p>\n\n<p>Is it possible? If not can you please recommend any other solution.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "is_accepted": false, "score": 0, "last_activity_date": 1430919499, "creation_date": 1430919499, "answer_id": 30078474, "question_id": 30078068, "link": "https://stackoverflow.com/questions/30078068/copy-from-one-workbook-to-another-paste-values-only/30078474#30078474", "title": "Copy from one workbook to another - paste values only", "body": "<p>I'd probably simplify things a bit and do on separate lines:</p>\n\n<p>Cells(TrIdx, 4).Copy</p>\n\n<p>Cells(3, 2).PasteSpecial Paste:=xlPasteValues </p>\n\n<p>seems to work for me and wont copy across the formatting</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 4757106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2825fc7336085d81bfb4a4fca9301a0a?s=128&d=identicon&r=PG&f=1", "display_name": "busdriver12", "link": "https://stackoverflow.com/users/4757106/busdriver12"}, "edited": false, "score": 0, "creation_date": 1430986753, "post_id": 30078593, "comment_id": 48303091, "body": "This has pretty much done it for me. Thanks for that - as I said to JNevill (above) I needed a fresh perspective to solve this minor impasse.  Thanks very much :)"}], "tags": [], "owner": {"reputation": 1595, "user_id": 4837035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdfc11c275ff58678c9c6b7fa93d4119?s=128&d=identicon&r=PG&f=1", "display_name": "Zerk", "link": "https://stackoverflow.com/users/4837035/zerk"}, "is_accepted": false, "score": 0, "last_activity_date": 1430919752, "creation_date": 1430919752, "answer_id": 30078593, "question_id": 30078068, "link": "https://stackoverflow.com/questions/30078068/copy-from-one-workbook-to-another-paste-values-only/30078593#30078593", "title": "Copy from one workbook to another - paste values only", "body": "<p>An alternative would be rather than pasting, just set the values directly.</p>\n\n<pre><code>  If ThisWorkbook.Sheets(\"Stats\").Cells(TrIdx, 4) &lt;&gt; \"\" Then\n    'Depot Induction Sheet\n    ThisWorkbook.Sheets(\"Stats\").Cells(TrIdx, 4).Copy Destination:=.Cells(3, 2) '.PasteSpecial(Paste:=xlPasteValues) 'Trainee Name (Top)\n    ThisWorkbook.Sheets(\"Stats\").Cells(TrIdx, 4).Copy Destination:=.Cells(60, 3) '.PasteSpecial(Paste:=xlPasteValues) 'Trainee Name (Bottom)\n    .PrintOut\n  End If\n</code></pre>\n\n<p>Could become:</p>\n\n<pre><code>  If ThisWorkbook.Sheets(\"Stats\").Cells(TrIdx, 4) &lt;&gt; \"\" Then\n    'Depot Induction Sheet\n    .Cells(3, 2) = ThisWorkbook.Sheets(\"Stats\").Cells(TrIdx, 4)\n    .Cells(60, 3) = ThisWorkbook.Sheets(\"Stats\").Cells(TrIdx, 4)\n    .PrintOut\n  End If\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 4757106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2825fc7336085d81bfb4a4fca9301a0a?s=128&d=identicon&r=PG&f=1", "display_name": "busdriver12", "link": "https://stackoverflow.com/users/4757106/busdriver12"}, "edited": false, "score": 0, "creation_date": 1430986658, "post_id": 30078612, "comment_id": 48303047, "body": "Thanks for the suggestion! This has done the trick for me.   It appears the simplest approach was best in my case. Obviously I couldn&#39;t see the wood for the tree and was good to see this from another angle."}], "tags": [], "owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "is_accepted": false, "score": 0, "last_activity_date": 1430919800, "creation_date": 1430919800, "answer_id": 30078612, "question_id": 30078068, "link": "https://stackoverflow.com/questions/30078068/copy-from-one-workbook-to-another-paste-values-only/30078612#30078612", "title": "Copy from one workbook to another - paste values only", "body": "<p>Instead of hitting the clipboard to do this, you can just set the value of the cell (your paste range) to the value of another cell (your copy range):</p>\n\n<pre><code>Private Sub CommandButton77_Click()\n'Individual Induction forms - Trainee #1\n\nDim wbPrint As Workbook, TrIdx As Integer\nApplication.ScreenUpdating = False\nSet wbPrint = Workbooks.Open(\"c:\\temp\\Drivers Induction Checklist.xlsx\", ReadOnly:=True)\nWith wbPrint.Sheets(\"Induction Depot\")\n  TrIdx = 66 'Index for Trainee #1\n  If ThisWorkbook.Sheets(\"Stats\").Cells(TrIdx, 4) &lt;&gt; \"\" Then\n    'Depot Induction Sheet\n    .Cells(3, 2).Value = ThisWorkbook.Sheets(\"Stats\").Cells(TrIdx, 4).Value 'Trainee Name (Top)\n    .Cells(60, 3).Value = ThisWorkbook.Sheets(\"Stats\").Cells(TrIdx, 4).Value 'Trainee Name (Bottom)\n    .PrintOut\n  End If          \n  wbPrint.Close SaveChanges:=False\nEnd With\n\nApplication.ScreenUpdating = True 'Don't forget to turn this back on :o\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4757106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2825fc7336085d81bfb4a4fca9301a0a?s=128&d=identicon&r=PG&f=1", "display_name": "busdriver12", "link": "https://stackoverflow.com/users/4757106/busdriver12"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1536, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1430919800, "creation_date": 1430918515, "last_edit_date": 1531164843, "question_id": 30078068, "link": "https://stackoverflow.com/questions/30078068/copy-from-one-workbook-to-another-paste-values-only", "title": "Copy from one workbook to another - paste values only", "body": "<p>I have a small problem I am trying to solve copying from one workbook to another. The two lines which perform the copying works, but I want to copy the values only. As it is, it copies the data across but retains the cell format from the source workbook. You'll notice I have commented out the end of the lines when used throws up a run time error 1004 (\"Unable to get the PasteSpecial property of the range class\"). I have looked at similar problems with google search, but cannot find one which fits the bill for me. Am looking to solve this one so I can move on with my project.</p>\n\n<p>TIA.</p>\n\n<p>Here is a snippet of my code:</p>\n\n<pre><code>Private Sub CommandButton77_Click()\n'Individual Induction forms - Trainee #1\n\nDim wbPrint As Workbook, TrIdx As Integer\nApplication.ScreenUpdating = False\nSet wbPrint = Workbooks.Open(\"c:\\temp\\Drivers Induction Checklist.xlsx\", ReadOnly:=True)\nWith wbPrint.Sheets(\"Induction Depot\")\n  TrIdx = 66 'Index for Trainee #1\n  If ThisWorkbook.Sheets(\"Stats\").Cells(TrIdx, 4) &lt;&gt; \"\" Then\n    'Depot Induction Sheet\n    ThisWorkbook.Sheets(\"Stats\").Cells(TrIdx, 4).Copy Destination:=.Cells(3, 2) '.PasteSpecial(Paste:=xlPasteValues) 'Trainee Name (Top)\n    ThisWorkbook.Sheets(\"Stats\").Cells(TrIdx, 4).Copy Destination:=.Cells(60, 3) '.PasteSpecial(Paste:=xlPasteValues) 'Trainee Name (Bottom)\n    .PrintOut\n  End If\n        'Next\n       wbPrint.Close SaveChanges:=False\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "ms-access-2007"], "answers": [{"tags": [], "owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "is_accepted": true, "score": 0, "last_activity_date": 1430917320, "creation_date": 1430917320, "answer_id": 30077600, "question_id": 30077385, "link": "https://stackoverflow.com/questions/30077385/add-character-to-field-depending-on-state-of-check-box/30077600#30077600", "title": "Add Character to field depending on state of check box", "body": "<p>Use <code>&amp;</code> instead of <code>+</code>:</p>\n\n<pre><code>If Me.IsShip_.Value = True Then Me.QshipNum.Value = \"S\" &amp; Me.QuoteID.Value\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 3449970, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Q4zdI.jpg?s=128&g=1", "display_name": "Ryonite", "link": "https://stackoverflow.com/users/3449970/ryonite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23, "favorite_count": 0, "accepted_answer_id": 30077600, "answer_count": 1, "score": 0, "last_activity_date": 1430919124, "creation_date": 1430916815, "last_edit_date": 1430919124, "question_id": 30077385, "link": "https://stackoverflow.com/questions/30077385/add-character-to-field-depending-on-state-of-check-box", "title": "Add Character to field depending on state of check box", "body": "<p>I am using access 2007, on a form I have two text boxes and a check box.</p>\n\n<p>I have a field named Quote ID and Qshipnum and then the check box IsShip?.</p>\n\n<p>I currently have the VBA on the checkbox isship? as follows </p>\n\n<pre><code>Private Sub QshipNum_AfterUpdate()\n\nIf Me.IsShip_.Value = True Then Me.QshipNum.Value = \"S\" + Me.QuoteID.Value\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>I would like to make the value of QshipNum S + whatever the quoteID is if the check mark is true. But currently I can't pull the concatenation of the two fields.</p>\n\n<p>What can I do to pull quote ID as well as the S?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 3664126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8ea657be325430ae51448a136e2aca5?s=128&d=identicon&r=PG&f=1", "display_name": "Dio K.", "link": "https://stackoverflow.com/users/3664126/dio-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1430917903, "creation_date": 1430917903, "answer_id": 30077823, "question_id": 30077045, "link": "https://stackoverflow.com/questions/30077045/how-to-open-a-image-matching-a-field/30077823#30077823", "title": "How to open a image matching a field", "body": "<p>With this \"C:\\Users\\Nick\\Desktop\\Documenti\\Pictures\\DioDiego.jpg\" you are telling to your application to open the <strong><em>DioDiego.jpg</em></strong> as you have hardcoded in the command. Try giving the the image-file-name to the end of the path depending on which image the user clicks on.</p>\n"}], "owner": {"reputation": 25, "user_id": 4110826, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dd3b948fe6310b8696d0835de51cdc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Nicola", "link": "https://stackoverflow.com/users/4110826/nicola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1594644724, "creation_date": 1430916062, "last_edit_date": 1594644724, "question_id": 30077045, "link": "https://stackoverflow.com/questions/30077045/how-to-open-a-image-matching-a-field", "title": "How to open a image matching a field", "body": "<p>I have to create a database with more than ten thousand records. There is a field on which image by clicking the image to be displayed with the default program based on the image on which you clicked. Whit this code:</p>\n\n<pre><code>Private Sub Campo1_Click()\n\nDim L As Long\n\nL = ShellExecute(0, \"Open\", \"\"\"\" &amp; \"C:\\Users\\Nick\\Desktop\\Documenti\\Pictures\\DioDiego.jpg\" &amp; \"\"\"\", vbNullString, vbNullString, 1)\n\nEnd Sub\n</code></pre>\n\n<p>when onClick event happens on the image is displayed the same image regardless of the record on which you clicked. How do I change the code to open the image of the field that was clicked? (I'm a beginner of VBA)</p>\n"}, {"tags": ["excel", "vba", "email", "outlook", "email-attachments"], "comments": [{"owner": {"reputation": 2608, "user_id": 3333511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce6007b9bf81366b10b303599a563ee4?s=128&d=identicon&r=PG&f=1", "display_name": "Mr. Mascaro", "link": "https://stackoverflow.com/users/3333511/mr-mascaro"}, "edited": false, "score": 0, "creation_date": 1430919934, "post_id": 30076534, "comment_id": 48270633, "body": "The big problem I see is that you&#39;re not using <code>For Each</code> loops."}, {"owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "edited": false, "score": 0, "creation_date": 1430920392, "post_id": 30076534, "comment_id": 48271006, "body": "Did you try to debug the code and see the FileName actual value?"}, {"owner": {"reputation": 145, "user_id": 4786410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/969158327194824aae3a978ae5271bef?s=128&d=identicon&r=PG&f=1", "display_name": "redd", "link": "https://stackoverflow.com/users/4786410/redd"}, "edited": false, "score": 0, "creation_date": 1430922246, "post_id": 30076534, "comment_id": 48272376, "body": "How would I build in &#39;For Each&#39; loops? I will try using msgBox to debug the code"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1430923276, "post_id": 30076534, "comment_id": 48273170, "body": "<code>Dim Att as Attachment</code> and <code>For Each Att in .Attachments</code> with <code>Next Att</code> at the end of loop! ;) and in the loop <code>Att.FileName</code>"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "edited": false, "score": 0, "creation_date": 1430923713, "post_id": 30076534, "comment_id": 48273537, "body": "And you should join your If <code>.Attachments.Count = 0 Then</code> and <code>If .Attachments.Count &gt; 0 Then</code> into :     If <code>.Attachments.Count &lt;= 0 Then</code> and <code>Else</code>"}, {"owner": {"reputation": 145, "user_id": 4786410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/969158327194824aae3a978ae5271bef?s=128&d=identicon&r=PG&f=1", "display_name": "redd", "link": "https://stackoverflow.com/users/4786410/redd"}, "edited": false, "score": 0, "creation_date": 1430925338, "post_id": 30076534, "comment_id": 48274867, "body": "Thanks for all your help. I will try and test your advice :)"}], "answers": [{"tags": [], "owner": {"reputation": 145, "user_id": 4786410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/969158327194824aae3a978ae5271bef?s=128&d=identicon&r=PG&f=1", "display_name": "redd", "link": "https://stackoverflow.com/users/4786410/redd"}, "is_accepted": true, "score": 0, "last_activity_date": 1431002221, "creation_date": 1431002221, "answer_id": 30101285, "question_id": 30076534, "link": "https://stackoverflow.com/questions/30076534/report-on-attachments-of-emails-in-outlook/30101285#30101285", "title": "Report on attachments of emails in outlook", "body": "<p>So by just adding 'GoTo' function I was able to answer my own query. Thank you all for leaving comments</p>\n\n<pre><code>    If .Attachments.Count = 0 Then\n    csv_report = \"NO\"\n    pdf_report = \"NO\"\n    xls_report = \"NO\"\n    End If\n\n    If .Attachments.Count &gt; 0 Then\n    For i2 = 1 To .Attachments.Count\n    If LCase(Right(.Attachments(i2).Filename, 4)) = \".csv\" Then\n    csv_report = \"YES\"\n    GoTo CSVyes        'if a .csv file is found, it skips to the PDF attachment checker\n    Else\n    csv_report = \"NO\"\n    End If\n    Next\n\nCSVyes:\n    For i2 = 1 To .Attachments.Count\n    If LCase(Right(.Attachments(i2).Filename, 4)) = \".pdf\" Then\n    pdf_report = \"YES\"\n    GoTo PDFyes        'if a .pdf file is found, it skips to the XLS attachment checker\n    Else\n    pdf_report = \"NO\"\n    End If\n    Next\n\nPDFyes:\n    For i2 = 1 To .Attachments.Count\n    If LCase(Right(.Attachments(i2).Filename, 4)) = \".xls\" Or LCase(Right(.Attachments(i2).Filename, 5)) = \".xlsx\" Or UCase(Right(.Attachments(i2).Filename, 4)) = \".XLS\" Then\n    xls_report = \"YES\"\n    GoTo XLSyes        'if a .xls file is found, it skips to the end of the checks\n    Else\n    xls_report = \"NO\"\n    End If\n    Next\n\nXLSyes:\n    End If\n\n    Sheets(\"Mail Report\").Activate\n    Range(\"C65000\").End(xlUp).Offset(1).Value = csv_report\n    Range(\"D65000\").End(xlUp).Offset(1).Value = pdf_report\n    Range(\"E65000\").End(xlUp).Offset(1).Value = xls_report\n\n    subject_line = mail.Subject\n    Range(\"A65000\").End(xlUp).Offset(1).Value = subject_line\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 4786410, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/969158327194824aae3a978ae5271bef?s=128&d=identicon&r=PG&f=1", "display_name": "redd", "link": "https://stackoverflow.com/users/4786410/redd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 30101285, "answer_count": 1, "score": 0, "last_activity_date": 1431002221, "creation_date": 1430914699, "question_id": 30076534, "link": "https://stackoverflow.com/questions/30076534/report-on-attachments-of-emails-in-outlook", "title": "Report on attachments of emails in outlook", "body": "<p>I am basically trying to create a report for my larger scale macro. The report will show each mail processsed and what attachments are found within the email.</p>\n\n<p>I have the following code working, but does not supply me with the correct results for the .csv files only. Can anyone see any problems that I cannot?</p>\n\n<pre><code>    If .Attachments.Count = 0 Then\n    csv_report = \"NO\"\n    pdf_report = \"NO\"\n    xls_report = \"NO\"\n    End If\n\n    If .Attachments.Count &gt; 0 Then\n    For i2 = 1 To .Attachments.Count\n    If LCase(Right(.Attachments(i2).Filename, 4)) = \".csv\" Then\n    csv_report = \"YES\"\n    Else\n    csv_report = \"NO\"\n    End If\n    If LCase(Right(.Attachments(i2).Filename, 4)) = \".pdf\" Then\n    pdf_report = \"YES\"\n    Else\n    pdf_report = \"NO\"\n    End If\n    If LCase(Right(.Attachments(i2).Filename, 4)) = \".xls\" Or LCase(Right(.Attachments(i2).Filename, 5)) = \".xlsx\" Then\n    xls_report = \"YES\"\n    Else\n    xls_report = \"NO\"\n    End If\n    Next\n    End If\n\n    Sheets(\"Mail Report\").Activate\n    Range(\"C65000\").End(xlUp).Offset(1).Value = csv_report\n    Range(\"D65000\").End(xlUp).Offset(1).Value = pdf_report\n    Range(\"E65000\").End(xlUp).Offset(1).Value = xls_report\n\n    subject_line = mail.Subject\n    Range(\"A65000\").End(xlUp).Offset(1).Value = subject_line\n</code></pre>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "edited": false, "score": 0, "creation_date": 1430915699, "post_id": 30076268, "comment_id": 48267053, "body": "Code works fine with test data, check if your columns are formated"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "edited": false, "score": 0, "creation_date": 1430916233, "post_id": 30076268, "comment_id": 48267438, "body": "@katz I would strongly disagree, see what both Sobigen &amp; I wrote"}, {"owner": {"reputation": 2020, "user_id": 3442153, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/hwsHp.jpg?s=128&g=1", "display_name": "K\u1d00\u03c4\u1d22", "link": "https://stackoverflow.com/users/3442153/k%e1%b4%80%cf%84%e1%b4%a2"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1430916521, "post_id": 30076268, "comment_id": 48267683, "body": "@FreeMan sry you&#39;re right, I activated workbook for debugging so it worked"}], "answers": [{"tags": [], "owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "is_accepted": false, "score": 2, "last_activity_date": 1430915984, "last_edit_date": 1495542607, "creation_date": 1430915984, "answer_id": 30077001, "question_id": 30076268, "link": "https://stackoverflow.com/questions/30076268/not-able-to-get-the-cell-value-in-foreach-loop-using-excel-vba/30077001#30077001", "title": "Not able to get the cell value in foreach loop using excel vba", "body": "<p>When you run this line:</p>\n\n<pre><code>trendsFile.Activate\n</code></pre>\n\n<p>You change the <code>Activesheet</code>, so the 2nd time on the loop you again look at the activesheet</p>\n\n<pre><code>weekMinutes = ActiveSheet.Range(\"G\" &amp; selectedCell.row).Value\n</code></pre>\n\n<p>but the activesheet has changed.  I would change those <code>Activesheet</code> calls to a worksheet object that you assign at the top.  </p>\n\n<p>This is always a good read for those new to VBA programming: <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba-macros\">How to avoid using Select in Excel VBA macros</a></p>\n"}, {"tags": [], "owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "is_accepted": false, "score": 1, "last_activity_date": 1430916150, "creation_date": 1430916150, "answer_id": 30077089, "question_id": 30076268, "link": "https://stackoverflow.com/questions/30076268/not-able-to-get-the-cell-value-in-foreach-loop-using-excel-vba/30077089#30077089", "title": "Not able to get the cell value in foreach loop using excel vba", "body": "<p>The issue is that you're using <code>ActiveSheet</code>, and the active sheet is being changed in your code.</p>\n\n<p>As soon as <code>trendsFile.Activate</code> is executed, these two references will have new meanings <code>ActiveSheet.Range(\"A1:A1000\")</code> and <code>ActiveSheet.Range(\"G\" &amp; selectedCell.row).Value</code>.</p>\n\n<p>You've created workbook &amp; worksheet variables for your <code>Trends</code> file, and use those, you also need to create a worksheet variable for your \"source\" worksheet (not sure how you'd refer to it).</p>\n\n<p>Also, I'd be a bit concerned about this section of code:</p>\n\n<pre><code>If trendsFile Is Nothing Then\n  Set trendsFile = Workbooks.Add()\n  trendsFile.Activate\n  Set trendsSheet = trendsFile.ActiveSheet\nElse\n  ' add a new sheet to the trends workbook\n  trendsFile.Activate\n  Set trendsSheet = Sheets.Add\nEnd If\n</code></pre>\n\n<p>I believe you'll be adding a new sheet every time through the loop.</p>\n\n<p>Try something like this:</p>\n\n<pre><code>Sub UsageWeekTrend()\n\n    Dim customerName As String\n    Dim sheetName As String\n    Dim dataFound As Boolean\n\n    Dim selectedCell As Range\n    Dim rowNumber As Integer\n    Dim weekMinutes As Double\n\n    Dim trendsFile As Workbook\n    Dim trendsSheet As Worksheet\n    Dim SourceSheet as worksheet 'this is the place where  you start, call it what you will \n\n    On Error GoTo errorHandling\n\n    set SourceSheet = activesheet 'this will now always be THIS sheet, and won't change\n    sheetName = SourceSheet.Name\n    customerName = SourceSheet.Range(\"A\" &amp; (ActiveCell.row)).Value\n    dataFound = False\n\n    For Each selectedCell In SourceSheet.Range(\"A1:A1000\")\n     If UCase(selectedCell.Value) = UCase(customerName) Then\n        weekMinutes = SourceSheet.Range(\"G\" &amp; selectedCell.row).Value\n        Debug.Print weekMinutes\n        Debug.Print \"G\" &amp; selectedCell.row\n        If dataFound = False Then\n           If trendsFile Is Nothing Then\n              Set trendsFile = Workbooks.Add()\n              'trendsFile.Activate   - never needed\n              Set trendsSheet = trendsFile.Sheets(\"Sheet1\") 'use the first sheet, since you just created a brand new workbook\n            Else\n              ' add a new sheet to the trends workbook\n              'trendsFile.Activate   -- you never need this when you're working with an object instead of \"Active\"\n      'you'll find that this line will add a new sheet every time you execute the loop\n      'once you've created your \"trendsFile\" workbook. you'll need to do some tweaking here\n      'to prevent you getting one loop worth of data on each sheet\n              Set trendsSheet = Sheets.Add\n           End If\n           dataFound = True\n           rowNumber = 1\n           trendsSheet.Name = Left(customerName, 10) + \" \" + Format(Date, \"MMDD\")\n           trendsSheet.Cells(rowNumber, 1) = \"Users\"\n           trendsSheet.Cells(rowNumber, 2) = \"Minutes\"\n           rowNumber = rowNumber + 1\n        End If\n\n        ' if a sheet has been created, then we have at least one non-zero value so add data\n        If dataFound = True Then\n                trendsSheet.Cells(rowNumber, 1) = customerName\n                trendsSheet.Cells(rowNumber, 2) = weekMinutes\n                rowNumber = rowNumber + 1\n        End If\n     End If\n  Next selectedCell\n\n'The rest of your routine here...    \n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 589, "user_id": 970826, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/523612704a58106842e0a6c36240d986?s=128&d=identicon&r=PG&f=1", "display_name": "AMDI", "link": "https://stackoverflow.com/users/970826/amdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1334, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1430917657, "creation_date": 1430914038, "last_edit_date": 1430915299, "question_id": 30076268, "link": "https://stackoverflow.com/questions/30076268/not-able-to-get-the-cell-value-in-foreach-loop-using-excel-vba", "title": "Not able to get the cell value in foreach loop using excel vba", "body": "<p><img src=\"https://i.stack.imgur.com/i37Di.png\" alt=\"enter image description here\"></p>\n\n<p>Hi, \nI have enclosed the sheet image.\nMy requirement is:\n I want to get all the \"G\" column values for the organization matching to a specific organization name (Ex:360 evaluations).</p>\n\n<p>I am getting null value after first loop for the G Column</p>\n\n<pre><code>Sub UsageWeekTrend()\n\n    Dim customerName As String\n    Dim sheetName As String\n    Dim dataFound As Boolean\n\n    Dim selectedCell As Range\n    Dim rowNumber As Integer\n    Dim weekMinutes As Double\n\n    Dim trendsFile As Workbook\n    Dim trendsSheet As Worksheet\n\n    On Error GoTo errorHandling\n\n    sheetName = ActiveSheet.Name\n    customerName = ActiveSheet.Range(\"A\" &amp; (ActiveCell.row)).Value\n    dataFound = False\n\n    For Each selectedCell In ActiveSheet.Range(\"A1:A1000\")\n     If UCase(selectedCell.Value) = UCase(customerName) Then\n        weekMinutes = ActiveSheet.Range(\"G\" &amp; selectedCell.row).Value\n        Debug.Print weekMinutes\n        Debug.Print \"G\" &amp; selectedCell.row\n\n           If dataFound = False Then\n\n                  If trendsFile Is Nothing Then\n                     Set trendsFile = Workbooks.Add()\n                     trendsFile.Activate\n                     Set trendsSheet = trendsFile.ActiveSheet\n\n                    Else\n                       ' add a new sheet to the trends workbook\n                        trendsFile.Activate\n                        Set trendsSheet = Sheets.Add\n\n                    End If\n\n                dataFound = True\n                rowNumber = 1\n                trendsSheet.Name = Left(customerName, 10) + \" \" + Format(Date, \"MMDD\")\n                trendsSheet.Cells(rowNumber, 1) = \"Users\"\n                trendsSheet.Cells(rowNumber, 2) = \"Minutes\"\n                rowNumber = rowNumber + 1\n\n            End If\n\n             ' if a sheet has been created, then we have at least one non-zero value so add data\n\n             If dataFound = True Then\n                trendsSheet.Cells(rowNumber, 1) = customerName\n                trendsSheet.Cells(rowNumber, 2) = weekMinutes\n                rowNumber = rowNumber + 1\n             End If\n       End If\n\n  Next selectedCell\n\n    ' if we have data, create the chart\n\n    If dataFound = True Then\n\n        ' make sure the trends sheet is active for chart insertion\n\n        trendsSheet.Activate\n\n        Dim chtChart As ChartObject\n        Dim chartName As String\n        Dim endRange As String\n\n        ' define the end of the range for the chart\n\n        endRange = \"C\" &amp; CStr(rowNumber - 1)\n\n        ' add chart to current sheet\n\n        Set chtChart = ActiveSheet.ChartObjects.Add(Left:=200, Top:=200, Width:=900, Height:=400)\n        chtChart.Activate\n        ActiveChart.ChartType = xlLineStacked\n        ActiveChart.SetSourceData Source:=trendsSheet.Range(\"A2\", endRange)\n        ActiveChart.HasTitle = True\n        ActiveChart.ChartTitle.Text = customerName\n        ActiveChart.ApplyLayout (5)\n\n\n    Else\n        MsgBox (\"No usage data found for customer \" + customerName)\n    End If\n\n    Exit Sub\n\nerrorHandling:\n    MsgBox (Err.Description)\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [".net", "wpf", "vba", "api"], "comments": [{"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1430914362, "post_id": 30076158, "comment_id": 48265978, "body": "That&#39;s a very interesting question. It must be possible, because <a href=\"http://usa.autodesk.com/adsk/servlet/index?id=770215&amp;siteID=123112\" rel=\"nofollow noreferrer\">Auto-cad did it</a>, but I have no idea how."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 3, "creation_date": 1430915726, "post_id": 30076158, "comment_id": 48267069, "body": "Project &gt; Add Reference &gt; COM tab &gt; tick Microsoft Visual Basic for Application Extensibility.  Getting pretty long on the tooth, finding docs for it beyond the Offfice usage isn&#39;t so easy."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 1, "creation_date": 1430920269, "post_id": 30076158, "comment_id": 48270905, "body": "I&#39;m not sure that really covers it @HansPassant. AFAIK, the extensibility library doesn&#39;t expose the actual runtime environment. Wouldn&#39;t it really require an reference to <code>VB6EXT.OLB</code>?"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1430920506, "post_id": 30076158, "comment_id": 48271088, "body": "Oh wait. That <i>is</i> the extensibility library...."}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1430934272, "post_id": 30076158, "comment_id": 48280936, "body": "This might help, but I&#39;m finding dismally little information. <a href=\"https://msdn.microsoft.com/en-us/magazine/cc302278.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/magazine/cc302278.aspx</a>"}], "owner": {"reputation": 1990, "user_id": 1927971, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/NntZV.jpg?s=128&g=1", "display_name": "Mefhisto1", "link": "https://stackoverflow.com/users/1927971/mefhisto1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 507, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1430913767, "creation_date": 1430913767, "last_edit_date": 1495540707, "question_id": 30076158, "link": "https://stackoverflow.com/questions/30076158/how-to-embed-vba-into-your-net-application", "title": "How to embed VBA into your .net application", "body": "<p>I have small excel-like app in WPF. I would like to extend it with a possibility of embedding a VBA editor into it and exposing a small api to it. Pretty much the same way as the excel. </p>\n\n<p><a href=\"https://stackoverflow.com/questions/208393/how-to-embed-ironpython-in-a-net-application\">How to embed IronPython in a .NET application</a></p>\n\n<p>Similar as this, but I would rather use VBA and not ironpython if possible.</p>\n"}, {"tags": ["vba", "excel", "userform"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 4067104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QXvCu.jpg?s=128&g=1", "display_name": "JFro777", "link": "https://stackoverflow.com/users/4067104/jfro777"}, "edited": false, "score": 0, "creation_date": 1430924789, "post_id": 30080360, "comment_id": 48274417, "body": "The problem still exists when i try that @R3uK"}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 61, "user_id": 4067104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QXvCu.jpg?s=128&g=1", "display_name": "JFro777", "link": "https://stackoverflow.com/users/4067104/jfro777"}, "edited": false, "score": 0, "creation_date": 1430925254, "post_id": 30080360, "comment_id": 48274794, "body": "Hmmm... My bad, I forgot to switch... :/ See the edit, but you may have tried it already I imagine that you have also tried with a simple <code>ExtractCompareUserForm.Show vbModal</code> ?"}, {"owner": {"reputation": 61, "user_id": 4067104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QXvCu.jpg?s=128&g=1", "display_name": "JFro777", "link": "https://stackoverflow.com/users/4067104/jfro777"}, "edited": false, "score": 0, "creation_date": 1430925913, "post_id": 30080360, "comment_id": 48275335, "body": "AHH Yes! ExtractCompareUserForm.Show vbModal fixed the issue! Thank you very much @R3uK If you would like to adjust the edit above I will except the answer."}, {"owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "reply_to_user": {"reputation": 61, "user_id": 4067104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QXvCu.jpg?s=128&g=1", "display_name": "JFro777", "link": "https://stackoverflow.com/users/4067104/jfro777"}, "edited": false, "score": 0, "creation_date": 1430926604, "post_id": 30080360, "comment_id": 48275876, "body": "Edit done! ;) Did you switch the two lines of <code>ScreenUpdating</code> and <code>Show</code>? It wasn&#39;t enough to make it work in <code>vbModeless</code>?"}, {"owner": {"reputation": 61, "user_id": 4067104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QXvCu.jpg?s=128&g=1", "display_name": "JFro777", "link": "https://stackoverflow.com/users/4067104/jfro777"}, "edited": false, "score": 0, "creation_date": 1430928034, "post_id": 30080360, "comment_id": 48276892, "body": "The way you have it is the way it works! Thank you very much! @R3uK"}], "tags": [], "owner": {"reputation": 13902, "user_id": 4628637, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/LmFJP.jpg?s=128&g=1", "display_name": "R3uK", "link": "https://stackoverflow.com/users/4628637/r3uk"}, "is_accepted": true, "score": 1, "last_activity_date": 1430926500, "last_edit_date": 1430926500, "creation_date": 1430924131, "answer_id": 30080360, "question_id": 30075637, "link": "https://stackoverflow.com/questions/30075637/vba-dialog-box-to-select-range-in-different-workbook-hanging-up/30080360#30080360", "title": "VBA Dialog box to select range in different workbook hanging up", "body": "<p>You have deactivate the screen updating, you need to reactivate it before showing your UserForm, at the end of <code>Sub extractData()</code> :</p>\n\n<p>You have :</p>\n\n<pre><code>    ExtractCompareUserForm.Show vbModeless\nEnd If\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p>Switch to :</p>\n\n<pre><code>    Application.ScreenUpdating = True\n    ExtractCompareUserForm.Show vbModal\nEnd If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 4067104, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QXvCu.jpg?s=128&g=1", "display_name": "JFro777", "link": "https://stackoverflow.com/users/4067104/jfro777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 1, "accepted_answer_id": 30080360, "answer_count": 1, "score": 1, "last_activity_date": 1430926500, "creation_date": 1430912361, "last_edit_date": 1495541196, "question_id": 30075637, "link": "https://stackoverflow.com/questions/30075637/vba-dialog-box-to-select-range-in-different-workbook-hanging-up", "title": "VBA Dialog box to select range in different workbook hanging up", "body": "<p>I used the code that was responded with in the link I have attached below and I am having some problems can you please help me?</p>\n\n<p><a href=\"https://stackoverflow.com/questions/18125650/vba-dialog-box-to-select-range-in-different-workbook\">VBA Dialog box to select range in different workbook</a></p>\n\n<p>When I click on the refedit box to be able to select the range I want to use it is hanging up and I'm getting a sound when I click saying that there is another window open somewhere with higher priority but i cannot find it.</p>\n\n<p>Basically, what I'm trying to do is copy the specified columns from one workbook and paste them into a sheet on my original workbook. I know that my \"copyButton_Click()\" coding isn't right also but I cannot get that far into the debugging to fix it. Here is what I have:</p>\n\n<p>MODULE 1:</p>\n\n<pre><code>  Sub extractData()\n    Dim FName As Variant\n    Dim wb As Workbook\n    Dim destSheet As String\n    '\n    Application.ScreenUpdating = False\n    destSheet = \"NewData\"\n    '\n    'Selects and clears data\n    Sheets(destSheet).Select\n        Range(\"A2:I12000\").Select\n        Selection.delete Shift:=xlUp\n        Range(\"A2\").Select\n    '\n    'Prompts user to select updated ILP file to copy data from:\n    FName = Application.GetOpenFilename(filefilter:=\"Excel Files (*.xls;*.xlsx;*.xlsm), *.xls;*.xlsx;*.xlsm\")\n        If FName &lt;&gt; False Then\n        Set wb = Workbooks.Open(FName)\n    '\n    ExtractCompareUserForm.Show vbModeless\n    '\n        End If\n\n    Application.ScreenUpdating = True\n\n    End Sub\n</code></pre>\n\n<p>USERFORM CODE:</p>\n\n<pre><code>  Private Sub UserForm_Initialize()\n        Dim wb As Workbook\n\n    '~~&gt; Get the name of all the workbooks in the combobox\n        For Each wb In Application.Workbooks\n            ComboBox1.AddItem wb.Name\n        Next\n\n        ComboBox1 = ActiveWorkbook.Name\n    End Sub\n\n    '~~&gt; This lets you toggle between all open workbooks\n    Private Sub Combobox1_Change()\n        If ComboBox1 &lt;&gt; \"\" Then Application.Workbooks(ComboBox1.Text).Activate\n\n        Label1.Caption = \"\": RefEdit1 = \"\"\n    End Sub\n\n    '~~&gt; This lets you choose the relevant range\n    Private Sub RefEdit1_Change()\n        Label1.Caption = \"\"\n\n        If RefEdit1.Value &lt;&gt; \"\" Then _\n        Label1.Caption = \"[\" &amp; ComboBox1 &amp; \"]\" &amp; RefEdit1\n    End Sub\n\n    Private Sub copyButton_Click()\n    Dim addr As String\n    '\n    addr = RefEdit1.Value\n    '\n    'Copy Data:\n        UserForm1.addr = Selection.Address\n        addr.Copy\n\n    End Sub\n\n    Private Sub PasteButton_Click()\n    Dim destSheet As String\n    '\n    Workbooks(2).Close SaveChanges:=False\n    '\n    '       Now, paste to working workbook:\n            Sheets(\"NewData\").Activate\n            Range(\"B2\").Select\n            ActiveSheet.Paste\n            Application.CutCopyMode = False\n        Unload Me\n        '\n    Call CopyData\n\n    End Sub\n</code></pre>\n\n<p>Here is where it's hanging up and doesn't let me click on anything.</p>\n\n<p><img src=\"https://i.stack.imgur.com/Kxzwb.jpg\" alt=\"\"></p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4110826, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dd3b948fe6310b8696d0835de51cdc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Nicola", "link": "https://stackoverflow.com/users/4110826/nicola"}, "edited": false, "score": 0, "creation_date": 1430912254, "post_id": 30075510, "comment_id": 48264437, "body": "I get the error: The project code needs to be updated for use in 64-bit systems. Review and update the instructions and then mark it with the declare attribute.  How do I change?"}, {"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "reply_to_user": {"reputation": 25, "user_id": 4110826, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dd3b948fe6310b8696d0835de51cdc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Nicola", "link": "https://stackoverflow.com/users/4110826/nicola"}, "edited": false, "score": 1, "creation_date": 1430912515, "post_id": 30075510, "comment_id": 48264616, "body": "I&#39;ve edited the answer to be compatible with 64bit... The difference is in the <code>PtrSafe</code> ..."}, {"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "reply_to_user": {"reputation": 25, "user_id": 4110826, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dd3b948fe6310b8696d0835de51cdc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Nicola", "link": "https://stackoverflow.com/users/4110826/nicola"}, "edited": false, "score": 0, "creation_date": 1430912571, "post_id": 30075510, "comment_id": 48264645, "body": "Please review the linked example, because your call to the ShellExecute function is missing a parameter (nShowCmd)..."}, {"owner": {"reputation": 25, "user_id": 4110826, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dd3b948fe6310b8696d0835de51cdc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Nicola", "link": "https://stackoverflow.com/users/4110826/nicola"}, "edited": false, "score": 0, "creation_date": 1430913337, "post_id": 30075510, "comment_id": 48265201, "body": "Thank you, it works. Even if there is another problem for which I will open another post, but shellexecute now works"}], "tags": [], "owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "is_accepted": true, "score": 0, "last_activity_date": 1430912472, "last_edit_date": 1430912472, "creation_date": 1430912008, "answer_id": 30075510, "question_id": 30075429, "link": "https://stackoverflow.com/questions/30075429/shell-execute-dont-work/30075510#30075510", "title": "Shell execute don&#39;t work", "body": "<p>You have to declare the <code>ShellExecute</code> function on top of your module: </p>\n\n<pre><code>#If VBA7 Then\nPrivate Declare PtrSafe Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" _\n    (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String, _ \n    ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long\n#Else\nPrivate Declare Function ShellExecute Lib \"shell32.dll\" Alias \"ShellExecuteA\" _\n    (ByVal hwnd As Long, ByVal lpOperation As String, ByVal lpFile As String, _ \n    ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long\n#End If\n</code></pre>\n\n<p>You can find a full example <a href=\"http://www.suodenjoki.dk/us/productions/articles/vbashellexecute.htm\" rel=\"nofollow\">here</a>...</p>\n"}], "owner": {"reputation": 25, "user_id": 4110826, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/dd3b948fe6310b8696d0835de51cdc9b?s=128&d=identicon&r=PG&f=1", "display_name": "Nicola", "link": "https://stackoverflow.com/users/4110826/nicola"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2557, "favorite_count": 0, "accepted_answer_id": 30075510, "answer_count": 1, "score": 0, "last_activity_date": 1594654589, "creation_date": 1430911785, "last_edit_date": 1594654589, "question_id": 30075429, "link": "https://stackoverflow.com/questions/30075429/shell-execute-dont-work", "title": "Shell execute don&#39;t work", "body": "<p>This code:</p>\n\n<pre><code>ShellExecute(\"C:\\Program Files\\Image Eye\\ImageEye.exe\",\"*.jpg\", \"*.png\"); \n</code></pre>\n\n<p>don't work. The sub shellexecute isn't recognized. Why?</p>\n"}, {"tags": ["vba", "powershell", "outlook"], "comments": [{"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 0, "creation_date": 1430912897, "post_id": 30074823, "comment_id": 48264887, "body": "Have you identified which folder makes problems? Perhaps you can get a clue if you print out the name before the copy operation..."}, {"owner": {"reputation": 174117, "user_id": 1630171, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oIS66.png?s=128&g=1", "display_name": "Ansgar Wiechers", "link": "https://stackoverflow.com/users/1630171/ansgar-wiechers"}, "edited": false, "score": 0, "creation_date": 1430914287, "post_id": 30074823, "comment_id": 48265931, "body": "The error message suggests that you don&#39;t have the required permissions. Did you verify that?"}, {"owner": {"reputation": 24, "user_id": 1949587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fc273fa1a135d2353512866e6808e5?s=128&d=identicon&r=PG", "display_name": "szczeppan", "link": "https://stackoverflow.com/users/1949587/szczeppan"}, "edited": false, "score": 0, "creation_date": 1430917672, "post_id": 30074823, "comment_id": 48268682, "body": "It&#39;s Inbox folder. I just checked this manually (in outlook with drag&#39;n&#39;drop) and this error still exists. I doing this as current user, so I should have full permissions to this user Inbox. But to be sure I added this user as owner to this folder. It didn&#39;t helped"}], "answers": [{"comments": [{"owner": {"reputation": 24, "user_id": 1949587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fc273fa1a135d2353512866e6808e5?s=128&d=identicon&r=PG", "display_name": "szczeppan", "link": "https://stackoverflow.com/users/1949587/szczeppan"}, "edited": false, "score": 0, "creation_date": 1430921724, "post_id": 30078500, "comment_id": 48272005, "body": "Checked, I don&#39;t have this key in registry. This script will be executed on user machine to make local copy of his data. Maybe this info help somehow. And thanks for the tip about releasing resurces"}], "tags": [], "owner": {"reputation": 25937, "user_id": 1603351, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lQ6aZ.jpg?s=128&g=1", "display_name": "Eugene Astafiev", "link": "https://stackoverflow.com/users/1603351/eugene-astafiev"}, "is_accepted": false, "score": 0, "last_activity_date": 1430919554, "creation_date": 1430919554, "answer_id": 30078500, "question_id": 30074823, "link": "https://stackoverflow.com/questions/30074823/powershell-error-during-making-copy-of-outlook-folder/30078500#30078500", "title": "Powershell error during making copy of outlook folder", "body": "<p>Make sure that you don't have the DisableCrossAccountCopy key in the windows registry set. Here is what the <a href=\"https://msdn.microsoft.com/en-us/library/office/ff869482(v=office.15).aspx\" rel=\"nofollow\">CopyTo</a> method description states:</p>\n\n<blockquote>\n  <p>Setting the REG_MULTI_SZ value, DisableCrossAccountCopy, in HKCU\\Software\\Microsoft\\Office\\14.0\\Outlook in the Windows registry has the side effect of disabling this method.</p>\n</blockquote>\n\n<p>Also I'd suggest releasing underlying COM objects in the code instantly. Use <a href=\"https://msdn.microsoft.com/en-us/library/system.runtime.interopservices.marshal.releasecomobject.aspx\" rel=\"nofollow\">System.Runtime.InteropServices.Marshal.ReleaseComObject</a> to release an Outlook object when you have finished using it. This is particularly important if your add-in attempts to enumerate more than 256 Outlook items in a collection that is stored on a Microsoft Exchange Server. Then set a variable to Nothing in Visual Basic (null in C#) to release the reference to the object. Read more about that in the <a href=\"https://msdn.microsoft.com/en-us/library/bb623945%28v=office.12%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow\">Systematically Releasing Objects</a> article.</p>\n"}], "owner": {"reputation": 24, "user_id": 1949587, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2fc273fa1a135d2353512866e6808e5?s=128&d=identicon&r=PG", "display_name": "szczeppan", "link": "https://stackoverflow.com/users/1949587/szczeppan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 569, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430919554, "creation_date": 1430910039, "question_id": 30074823, "link": "https://stackoverflow.com/questions/30074823/powershell-error-during-making-copy-of-outlook-folder", "title": "Powershell error during making copy of outlook folder", "body": "<p>I try to make copy of all folders from user account into pst file. Script works fine for all folders except Inbox. When I try to copy data from inbox at end of copying I have error </p>\n\n<blockquote>\n  <p>Exception calling \"CopyTo\" with \"1\" argument(s): \"Cannot move or copy folders. Cannot copy folder. A top-level folder cannot be copied to one of its subfolders. Or, you may not have appropriate permissions for the folder. To check your permissions for the folder, right-click the folder, and then click Properties on the shortcut menu.\"</p>\n</blockquote>\n\n<p>Script below</p>\n\n<pre><code>$start = Get-Date\n\n#checking if outlook is running\n$isRunning = (@(Get-Process -ea silentlycontinue OUTLOOK).count -gt 0)\n\n#showing dialog to choose direcotry where pst should be saved\n$app = new-object -com Shell.Application\n$folder = $app.BrowseForFolder(0, \"Select Folder\", 0, \"C:\\\")\nif ($folder.Self.Path -ne \"\") {\n    $path = $folder.Self.Path+\"\\\"+$env:USERNAME+\".pst\"\n} else {\n    Write-Host \"directory not selected. Exiting..\"\n    [Environment]::Exit(1)\n}\n\n#reference to outlook\nAdd-Type -Assembly \"Microsoft.Office.Interop.Outlook\" | out-null\n$outlook = New-Object -ComObject outlook.application\n$ns = $outlook.GetNamespace(\"MAPI\")\n\n#adding personal archive file\n$ns.AddStoreEx($path, 1)\nWrite-Host created $path\n$dst = $ns.Folders.GetLast()\nWrite-Host folder name: $dst.Name\n\n#list of directory types to copy. more details https://msdn.microsoft.com/en-us/library/office/ff861868.aspx\n$folderTypes = 9,10,3,16,6,12,4,5,30,13,28\n\n#iterating trough list of directories and for each dir make copy in pst file. next counting of objects in archive and pst\nforeach ($id in $folderTypes) { \n    $src = $ns.GetDefaultFolder($id)\n    $tmp = $src.copyTo($dst)\n    Write-Host copied to $tmp.name \n}\n\n#deattaching personal store from outlook\n$ns.GetType().InvokeMember('RemoveStore',[System.Reflection.BindingFlags]::InvokeMethod, $null, $ns, ($dst))\nWrite-Host $dst.name closed\n\n#if outlook wasn't running on start we must close it\nif (-not $isRunning) {\n    Write-Host closing outlook\n    $outlook.Quit()\n}\n\n$end = Get-Date\n$diff = New-TimeSpan -start $start -end $end\nWrite-Host done\n\"time elapsed {0:g}\" -f $diff\n</code></pre>\n\n<p>Any ideas why this error occurs? \nThanks in advace</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1430912268, "post_id": 30074041, "comment_id": 48264449, "body": "Should be in a regular module, not a worksheet module then it will work for the active sheet."}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1430908361, "creation_date": 1430908361, "answer_id": 30074215, "question_id": 30074041, "link": "https://stackoverflow.com/questions/30074041/cant-change-font-color-in-excel-vba/30074215#30074215", "title": "Can&#39;t change font color in Excel VBA", "body": "<p>There is no error in your code..........the cells are being coloured on <strong>some</strong> worksheet.....the Active worksheet.</p>\n\n<p>Check your sheets and Select the proper sheet before running the code.</p>\n"}], "owner": {"reputation": 146, "user_id": 4823772, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-Kv2h7ZzHQoI/AAAAAAAAAAI/AAAAAAAAAH0/goBzU8dINes/photo.jpg?sz=128", "display_name": "Sithu05", "link": "https://stackoverflow.com/users/4823772/sithu05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2754, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430914070, "creation_date": 1430907864, "last_edit_date": 1531164843, "question_id": 30074041, "link": "https://stackoverflow.com/questions/30074041/cant-change-font-color-in-excel-vba", "title": "Can&#39;t change font color in Excel VBA", "body": "<p>I can trying to change font color in Excel Sheets.</p>\n\n<p>Code is:</p>\n\n<pre><code>Sub sbChangeFontColor()\n\nCells(4, 2).Font.ColorIndex = 3 \n\nRange(\"B4\").Font.ColorIndex = 3\n\nCells(4, 2).Font.Color = RGB(255, 0, 0)\n\nRange(\"B4\").Font.Color = RGB(255, 0, 0)\n\nEnd Sub\n</code></pre>\n\n<p>Already, I used these code in Macros of my Excel Sheet. When I run the Macros code, Excel Sheet Font not changed and also not throwing any error messages. How to solve this problem?</p>\n"}, {"tags": ["excel", "numbers", "extract", "vba"], "comments": [{"owner": {"reputation": 2675, "user_id": 1412819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/289c7fa13efa900be72909995370769e?s=128&d=identicon&r=PG&f=1", "display_name": "mlinth", "link": "https://stackoverflow.com/users/1412819/mlinth"}, "edited": false, "score": 0, "creation_date": 1430909123, "post_id": 30074036, "comment_id": 48262346, "body": "Are you saying that your numbers are all in one row in the text file, or is it one number per row?"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1430909304, "post_id": 30074036, "comment_id": 48262467, "body": "What does &quot;full of 9 digit numbers&quot; look like in the text file? Your bullet point has several 9 digit sets separated by several different characters. Can you post a more comprehensive example as a text file (use a file sharing service and post a link)"}], "answers": [{"tags": [], "owner": {"reputation": 2590, "user_id": 4507417, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a027c3ea839c86e05de0c5f22fc6a7d0?s=128&d=identicon&r=PG&f=1", "display_name": "Marek Stejskal", "link": "https://stackoverflow.com/users/4507417/marek-stejskal"}, "is_accepted": false, "score": 0, "last_activity_date": 1430908079, "creation_date": 1430908079, "answer_id": 30074126, "question_id": 30074036, "link": "https://stackoverflow.com/questions/30074036/excel-give-each-number-in-a-text-string-its-own-cell/30074126#30074126", "title": "Excel: Give each number in a text/string its own cell", "body": "<p>You can use the standard Excel feature for importing data from Text file. Ribbon tab Data -> From Text.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 4804728, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dbd74a96d2c8f3f34c1068867efad35?s=128&d=identicon&r=PG&f=1", "display_name": "m24murray", "link": "https://stackoverflow.com/users/4804728/m24murray"}, "is_accepted": false, "score": 0, "last_activity_date": 1430912362, "last_edit_date": 1430912362, "creation_date": 1430908726, "answer_id": 30074357, "question_id": 30074036, "link": "https://stackoverflow.com/questions/30074036/excel-give-each-number-in-a-text-string-its-own-cell/30074357#30074357", "title": "Excel: Give each number in a text/string its own cell", "body": "<p>From your result, with each cell containing the 9 digit number:</p>\n\n<ol>\n<li><p>Click <strong>Data -> Text to columns</strong></p></li>\n<li><p>Select \"<strong>Fixed Width</strong>\"</p></li>\n<li><p>You will then need to set break lines between each of your nine\ndigits</p></li>\n</ol>\n\n<blockquote>\n  <p><em>Optional: Click \"Next\" to format each of the fields</em></p>\n</blockquote>\n\n<ol start=\"4\">\n<li>Finally, click \"<strong>Finish</strong>\"</li>\n</ol>\n\n<p>You should now see each of the nine digits in a separate column.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 0, "last_activity_date": 1430912427, "last_edit_date": 1430912427, "creation_date": 1430911678, "answer_id": 30075393, "question_id": 30074036, "link": "https://stackoverflow.com/questions/30074036/excel-give-each-number-in-a-text-string-its-own-cell/30075393#30075393", "title": "Excel: Give each number in a text/string its own cell", "body": "<p>Assuming your data is in a single cell, then your task has three parts:</p>\n\n<ul>\n<li>read data from text file</li>\n<li>parse each cell</li>\n<li>store the results in a column</li>\n</ul>\n\n<p>This code addresses only the second part:</p>\n\n<pre><code>Sub ParseData()\n    Dim s1 As String\n    s1 = Range(\"A1\").Text\n    s1 = Replace(s1, \" \", \"|\")\n    s1 = Replace(s1, \"/\", \"|\")\n    s1 = Replace(s1, \"[\", \"|\")\n    s1 = Replace(s1, \"]\", \"|\")\n    s1 = Replace(s1, \",\", \"|\")\n    s1 = CleanUp(s1, \"|\")\n    ary = Split(s1, \"|\")\n\n    i = 1\n    For Each a In ary\n        Cells(i, 2).NumberFormat = \"@\"\n        Cells(i, 2).Value = a\n        i = i + 1\n    Next a\n    End Sub\n\n\nPublic Function CleanUp(sIN As String, sep As String) As String\n    Dim temp As String, temp2 As String, i As Long, CH As String\n    temp = sIN\n    While Left(temp, 1) = sep\n        temp = Mid(temp, 2)\n    Wend\n\n    While Right(temp, 1) = sep\n        temp = Mid(temp, 1, Len(temp) - 1)\n    Wend\n\n    temp2 = \"\"\n    For i = 1 To Len(temp)\n        CH = Mid(temp, i, 1)\n        If temp2 = \"\" Then\n            temp2 = CH\n        ElseIf CH &lt;&gt; sep Then\n            temp2 = temp2 &amp; CH\n        ElseIf Right(temp2, 1) &lt;&gt; sep Then\n            temp2 = temp2 &amp; CH\n        End If\n        Next i\n    CleanUp = temp2\nEnd Function\n</code></pre>\n\n<p><strong>NOTES:</strong></p>\n\n<p>The code replaces the various field separators with a single pipe.  The data is then split using the pipe.  The resulting array is then stored in cells:</p>\n\n<p><img src=\"https://i.stack.imgur.com/2hOJf.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 1, "user_id": 4870103, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92236033685ff2561633c9f9b81311bc?s=128&d=identicon&r=PG&f=1", "display_name": "Max", "link": "https://stackoverflow.com/users/4870103/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1032, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1430913956, "creation_date": 1430907845, "last_edit_date": 1531161705, "question_id": 30074036, "link": "https://stackoverflow.com/questions/30074036/excel-give-each-number-in-a-text-string-its-own-cell", "title": "Excel: Give each number in a text/string its own cell", "body": "<p>I have a text document full of 9 digit numbers. I need Excel to either read the text (<code>.txt</code>) file or a text cell and add each 9 digit number to each cell in a column.<br>\nExample text file:</p>\n\n<pre><code>123456789, 987654321, 213454321 / 987656789, [098752739]\n</code></pre>\n\n<p>Excel result:</p>\n\n<pre><code>123456789\n987654321\n213454321\n987656789\n098752739\n</code></pre>\n\n<p>Any advice?</p>\n"}, {"tags": ["vba", "outlook", "pattern-matching", "sql-like"], "comments": [{"owner": {"reputation": 5595, "user_id": 2832561, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/191d947cf1b55615499091bb17dd2961?s=128&d=identicon&r=PG&f=1", "display_name": "Blackhawk", "link": "https://stackoverflow.com/users/2832561/blackhawk"}, "edited": false, "score": 0, "creation_date": 1430928161, "post_id": 30073935, "comment_id": 48276981, "body": "Would you be interested in a solution that utilizes the RegExp library? Regular expressions are extremely powerful and allow you much more control over what you match and what you don&#39;t.  They are more complex to understand, but the power you gain is worth the investment of time to learn in my opinion."}], "answers": [{"comments": [{"owner": {"reputation": 2113, "user_id": 969113, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/4f54ad6e06546aedf024dfcda9406724?s=128&d=identicon&r=PG", "display_name": "user969113", "link": "https://stackoverflow.com/users/969113/user969113"}, "edited": false, "score": 0, "creation_date": 1430909114, "post_id": 30074311, "comment_id": 48262340, "body": "Thanks Peter. Yes I know that the * are wildcards and that is fine because actually the string XXX and YYY varies slightly"}, {"owner": {"reputation": 2113, "user_id": 969113, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/4f54ad6e06546aedf024dfcda9406724?s=128&d=identicon&r=PG", "display_name": "user969113", "link": "https://stackoverflow.com/users/969113/user969113"}, "edited": false, "score": 0, "creation_date": 1430909850, "post_id": 30074311, "comment_id": 48262815, "body": "Thank you Peter, your solution also works pretty well!"}], "tags": [], "owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "is_accepted": false, "score": 1, "last_activity_date": 1430908618, "creation_date": 1430908618, "answer_id": 30074311, "question_id": 30073935, "link": "https://stackoverflow.com/questions/30073935/vba-like-operator/30074311#30074311", "title": "VBA Like Operator", "body": "<p>Hmm.. you can use </p>\n\n<pre><code>Dim s As String\ns = \"*XXX*YYYY*\"\nIf (InStr(1, s, \"Re:\") = 0) And (InStr(1, s, \"Aw:\") = 0) Then\n   If (s Like \"*XXX*YYYY*\") Then\n        Debug.Print \"Match\"\n   End If\nEnd If\n</code></pre>\n\n<p>Although: The like operator uses wildcharacters... so actually you're matching more than just the string <code>*XXX*YYY*</code>...</p>\n"}, {"tags": [], "owner": {"reputation": 158803, "user_id": 246342, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba0aea3f521082f18dd7c186e7d4c3?s=128&d=identicon&r=PG", "display_name": "Alex K.", "link": "https://stackoverflow.com/users/246342/alex-k"}, "is_accepted": true, "score": 1, "last_activity_date": 1430908641, "creation_date": 1430908641, "answer_id": 30074321, "question_id": 30073935, "link": "https://stackoverflow.com/questions/30073935/vba-like-operator/30074321#30074321", "title": "VBA Like Operator", "body": "<p>Look for the exceptions, then compare with the wildcard:</p>\n\n<pre><code>Select Case UCase$(Left$(subject, 3))\n\n    Case \"RE:\", \"AW:\":\n        '// is reply\n    Case Else\n        If subject Like \"*XXX*YYY*\" Then\n            MsgBox \"Hello\"\n        End If\n\nEnd Select\n</code></pre>\n"}], "owner": {"reputation": 2113, "user_id": 969113, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/4f54ad6e06546aedf024dfcda9406724?s=128&d=identicon&r=PG", "display_name": "user969113", "link": "https://stackoverflow.com/users/969113/user969113"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2651, "favorite_count": 0, "accepted_answer_id": 30074321, "answer_count": 2, "score": 1, "last_activity_date": 1593475752, "creation_date": 1430907629, "last_edit_date": 1593475752, "question_id": 30073935, "link": "https://stackoverflow.com/questions/30073935/vba-like-operator", "title": "VBA Like Operator", "body": "<p>I want to monitor our public e-mail folder for specific new mails to arrive and then use MsgBox to create a pop-up Window. Everything is set up and works prett well apart from the matching part using the <code>Like</code> Operator.</p>\n\n<p>I want to match the following string in the subject of the E-Mail:</p>\n\n<pre><code>*XXX*YYY*\n</code></pre>\n\n<p>which I manage to do by using:</p>\n\n<pre><code>Like \"*XXX*YYY*\"\n</code></pre>\n\n<p>What I am struggeling with is when someone replies to that E-Mail and the subject changes to:</p>\n\n<pre><code>Re:*XXX*YYY* or Aw:*XXX*YYY*\n</code></pre>\n\n<p>If that is the case, I do not want to create a pop-up message since it is an answer to the original E-Mail.</p>\n\n<p>I tried stuff like:</p>\n\n<pre><code>If subject Like \"*[!aw:]*\" &amp; \"*[!re:]*\" Then\n   If subject Like \"*XXX*YYY*\" Then\n</code></pre>\n\n<p>in various combinations but I do not seem to get it working properly.</p>\n\n<p>Can anyone assist?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430906662, "post_id": 30073244, "comment_id": 48260650, "body": "Change <code>Do</code> to <code>Do until validInput = true</code> and take out <code>loop until...</code> and just put <code>loop</code>. Try that"}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1430906914, "post_id": 30073244, "comment_id": 48260819, "body": "Works fine in my Excel 2010. You might want to change the restricted <i>str</i> to something else though. You might want to try <code>GoTo EndSub1</code> in lieu of <code>Exit Sub</code>."}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430907134, "post_id": 30073244, "comment_id": 48260968, "body": "@Sam No, doesn&#39;t work. @user3819867 I use Excel desktop from the Office365 package and it doesn&#39;t work. What should I change <code>str</code> to? I want to have a currency value in the end. I rather not use <code>GoTo</code> and it should work with the code I used, right? Just, that it doesn&#39;t..."}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1430907174, "post_id": 30073244, "comment_id": 48260997, "body": "This code snippet works fine. Maybe you could add some more code where this code snippet is used?"}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1430907461, "post_id": 30073244, "comment_id": 48261193, "body": "Done. Added the complete sub."}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430907795, "post_id": 30073244, "comment_id": 48261452, "body": "Change <code>exit sub</code> to <code>exit do</code>"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430908074, "post_id": 30073244, "comment_id": 48261635, "body": "If you are calling it from another workbook. Wouldn&#39;t the exit sub exit the sub that called this macro. So the loop would still exist due to the being open still. Someone correct me if I am wrong"}, {"owner": {"reputation": 12766, "user_id": 863240, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a2221c5cbaa548f9022616b4f6d6a59a?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Du\u0161ek", "link": "https://stackoverflow.com/users/863240/daniel-du%c5%a1ek"}, "edited": false, "score": 0, "creation_date": 1430908896, "post_id": 30073244, "comment_id": 48262198, "body": "And how exactly are you calling the procedure <code>CurrencyCheck()</code>?"}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430909941, "post_id": 30073244, "comment_id": 48262885, "body": "@Sam Not sure, but as I start a new sub it should exit that sub instead of the sub it was called from, right? @dee Inside another sub, like this <code>Call CurrencyCheck</code>."}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430910266, "post_id": 30073244, "comment_id": 48263124, "body": "TBH I am not totally sure. Couldnt find much online about it. But if it just sends the command to exit sub in what ever sub it is running then it might just close the wrong one down. Try doing <code>Exit Do</code> as this should just exit from the do loop. You can test to see which sub it will exit by adding like a message box after the call in your other workbook. If that message box gets called then it is exiting the right one. If it does not then the sub which calls the other sub is exiting"}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1430910481, "post_id": 30073244, "comment_id": 48263255, "body": "Wow, even changing <code>Exit Sub</code> to <code>Exit Do</code> and then adding <code>If validInput = False Then Exit Sub</code> doesn&#39;t work. Still keeps me in the loop."}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430910562, "post_id": 30073244, "comment_id": 48263309, "body": "This is very very strange. Something is keeping that loop alive some how. I am going to try and replicate it and see if I come accross that problem"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430910776, "post_id": 30073244, "comment_id": 48263455, "body": "How do you call it from the other workbook? Is it <code>application.run</code>?"}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430910926, "post_id": 30073244, "comment_id": 48263551, "body": "@Sam It gets better. I tried a <code>While</code>-loop. Same, didn&#39;t work. THEN I tried to delete the loop. Still the same. Now there isn&#39;t even a loop anymore. Still gives me the input query again after I pressed <code>cancel</code>. To call it from another workbook I use the &quot;Macros&quot;-button in the developer-ribbon."}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 1, "creation_date": 1430911022, "post_id": 30073244, "comment_id": 48263603, "body": "Maybe change the name <code>str</code> as it is a built in function. So not sure how office 365 works. Maybe that is the reason for the conflict as I have tried to replicate it but failed. I have taken just the loop in one workbook. Then used another workbook to call that sub and works fine"}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430911343, "post_id": 30073244, "comment_id": 48263830, "body": "Try exiting the loop with another condition. Like <code>Do Until validInput or failedInput</code> then instead of <code>exit sub</code> put <code>failedInput=true</code> and after the loop put something like if <code>failedInput = true then exit sub</code>"}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1430916160, "post_id": 30073244, "comment_id": 48267388, "body": "Nothing works. This is weird... If I go through the code in debug mode everything works correctly and the sub exits after the <code>Exit Sub</code> line. If I select the macro from the macros menu though and click cancel it just shows me the <code>InputBox</code> again and again and again..."}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "reply_to_user": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430916562, "post_id": 30073244, "comment_id": 48267716, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/77091/discussion-between-moritz-schmitz-v-hulst-and-sam\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430909545, "post_id": 30074021, "comment_id": 48262625, "body": "It would be a <code>vbnullstring</code> if nothing ever gets set to it"}, {"owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "edited": false, "score": 0, "creation_date": 1430909841, "post_id": 30074021, "comment_id": 48262809, "body": "And I am sure it is a <code>vbNullString</code> because the output is correct. As in it shows me the correct <code>MsgBox</code>."}], "tags": [], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "is_accepted": false, "score": 0, "last_activity_date": 1430908933, "last_edit_date": 1430908933, "creation_date": 1430907813, "answer_id": 30074021, "question_id": 30073244, "link": "https://stackoverflow.com/questions/30073244/do-until-loop-in-vba-does-not-break-on-exit-sub/30074021#30074021", "title": "Do Until loop in VBA does not break on Exit Sub", "body": "<p>I don't think is a null string. Try this</p>\n\n<pre><code>If str = vbNullString or str = \"\" Then\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430914879, "post_id": 30076200, "comment_id": 48266374, "body": "They already have their loop to look for numbers. The problem is that the loop does not end if they cancel it..."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 0, "last_activity_date": 1430915163, "last_edit_date": 1430915163, "creation_date": 1430913878, "answer_id": 30076200, "question_id": 30073244, "link": "https://stackoverflow.com/questions/30073244/do-until-loop-in-vba-does-not-break-on-exit-sub/30076200#30076200", "title": "Do Until loop in VBA does not break on Exit Sub", "body": "<p>This will loop until a numeric is entered:</p>\n\n<pre><code>Sub dural()\n    Dim validInput As Boolean\n    Dim strg As String, x As Variant\n    validInput = False\n    Do\n        strg = Application.InputBox(Prompt:=\"enter value\", Type:=2)\n        If strg = \"False\" Then\n        ElseIf IsNumeric(strg) Then\n            x = CCur(strg)\n            validInput = True\n        End If\n    Loop Until validInput\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT#1:</strong></p>\n\n<p>This version will quit the loop if the user touches the <kbd>CANCEL</kbd> button or the red <strong>x</strong> button:</p>\n\n<pre><code>Sub dural()\n    Dim validInput As Boolean\n    Dim strg As String, x As Variant\n    validInput = False\n    Do\n        strg = Application.InputBox(Prompt:=\"enter value\", Type:=2)\n        If strg = \"False\" Or strg = \"\" Then\n            validInput = True\n        ElseIf IsNumeric(strg) Then\n            x = CCur(strg)\n            validInput = True\n        End If\n    Loop Until validInput\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 2191, "user_id": 2591194, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/X4Fbs.jpg?s=128&g=1", "display_name": "Moritz Schmitz v. H&#252;lst", "link": "https://stackoverflow.com/users/2591194/moritz-schmitz-v-h%c3%bclst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 693, "favorite_count": 0, "accepted_answer_id": 30076200, "answer_count": 2, "score": 0, "last_activity_date": 1430918962, "creation_date": 1430905937, "last_edit_date": 1531164843, "question_id": 30073244, "link": "https://stackoverflow.com/questions/30073244/do-until-loop-in-vba-does-not-break-on-exit-sub", "title": "Do Until loop in VBA does not break on Exit Sub", "body": "<p>I wrote the following code in order to ask for an input.</p>\n\n<pre><code>validInput = False\nDo\n    str = InputBox(\"Some text...\")\n    If str = vbNullString Then\n        MsgBox (\"Input canceled\")\n        Exit Sub\n    Else\n        If IsNumeric(str) Then\n            exchange = CCur(str)\n            validInput = True\n        Else\n            MsgBox (\"Input invalid.\")\n        End If\n    End If\nLoop Until validInput\n</code></pre>\n\n<p>However, if I cancel my input it keeps asking me for an input and the loop goes on even though I added the <code>Exit Sub</code> line.</p>\n\n<p>I tried to add <code>validInput = True</code> before <code>Exit Sub</code> but that didn't work either.</p>\n\n<p>What am I missing?</p>\n\n<p><strong>EDIT:</strong>\nHere is the whole sub.</p>\n\n<pre><code>Public Sub CurrencyCheck()\n\nDim ws As Worksheet\nSet ws = ActiveWorkbook.Worksheets(\"Datenbank\")\nDim lastRow As Long\nlastRow = ws.Cells(Rows.Count, 4).End(xlUp).Row\nDim i As Long\nDim j As Long\nDim curSymbol As String\nDim exchange As Currency\nDim str As String\nDim curArr() As String\nDim arrCnt As Integer\narrCnt = 1\nDim curInArr As Boolean\ncurInArr = False\nDim curIndex As Integer\nDim validInput As Boolean\n\nReDim curArr(1 To 2, 1 To arrCnt)\n\nFor i = 1 To lastRow\n    If ws.Cells(i, 4).Value &lt;&gt; \"Price\" And ws.Cells(i, 4).Value &lt;&gt; \"\" Then\n        curSymbol = Get_Currency(ws.Cells(i, 4).text) 'Function that returns currency symbol (\u20ac) or abbreviation (EUR)\n        If curSymbol &lt;&gt; \"\u20ac\" Then\n            For j = LBound(curArr, 2) To UBound(curArr, 2)\n                If curArr(1, j) = curSymbol Then\n                    curInArr = True\n                    curIndex = j\n                End If\n            Next j\n            If Not curInArr Then\n                If curSymbol = \"EUR\" Then\n                    ReDim Preserve curArr(1 To 2, 1 To arrCnt)\n                    curArr(1, arrCnt) = curSymbol\n                    curArr(2, arrCnt) = 1\n                    curIndex = arrCnt\n                    arrCnt = arrCnt + 1\n                Else\n                    validInput = False\n                    Do Until validInput\n                        str = InputBox(\"Some text...\")\n                        If str = vbNullString Then\n                            MsgBox (\"Input canceled.\")\n                            Exit Sub\n                        Else\n                            If IsNumeric(str) Then\n                                exchange = CCur(str)\n                                validInput = True\n                            Else\n                                MsgBox (\"Input invalid.\")\n                            End If\n                        End If\n                    Loop\n                    ReDim Preserve curArr(1 To 2, 1 To arrCnt)\n                    curArr(1, arrCnt) = curSymbol\n                    curArr(2, arrCnt) = exchange\n                    curIndex = arrCnt\n                    arrCnt = arrCnt + 1\n                End If\n            End If\n            ws.Cells(i, 4).Value = StringToCurrency(ws.Cells(i, 4).text)\n            ws.Cells(i, 4).Value = ws.Cells(i, 4).Value * curArr(2, curIndex)\n            ws.Cells(i, 4).NumberFormat = \"#,##0.00 \u20ac\"\n        End If\n    End If\nNext i\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT2:</strong> When I run the input loop as a subroutine by itself it works. The macro is run in another workbook and doing that it fails...</p>\n\n<p><strong>EDIT3:</strong> My bad. The problem is not related to the code but to the positioning of the subroutine. It was called of and over again because it was called in a loop. I have to apologize. Thanks to everyone.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 847, "user_id": 3129263, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/ZaP5t.jpg?s=128&g=1", "display_name": "Soma", "link": "https://stackoverflow.com/users/3129263/soma"}, "edited": false, "score": 0, "creation_date": 1430905169, "post_id": 30072910, "comment_id": 48259673, "body": "Have you even tried yourself? If so, show us your work. If not, well.. try"}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "edited": false, "score": 0, "creation_date": 1430910101, "post_id": 30072910, "comment_id": 48262990, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/26139109/button-for-suggesting-a-new-unique-row-combination-of-values\">Button for suggesting a new unique row combination of values</a>"}], "answers": [{"tags": [], "owner": {"reputation": 600, "user_id": 4842061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c029acc451f8ec880d76203cfa9a17c5?s=128&d=identicon&r=PG&f=1", "display_name": "Trum", "link": "https://stackoverflow.com/users/4842061/trum"}, "is_accepted": false, "score": 0, "last_activity_date": 1430909254, "creation_date": 1430909254, "answer_id": 30074545, "question_id": 30072910, "link": "https://stackoverflow.com/questions/30072910/displaying-list-of-combinations-in-spreadsheet/30074545#30074545", "title": "displaying list of combinations in spreadsheet", "body": "<p>You can accomplish this in a variety of ways, but I would look at the 'For loop' object or would use the 'For i = 1 to' methodology to accomplish this.</p>\n"}], "owner": {"reputation": 1, "user_id": 4869885, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b1ca0fdecc50cba3a011160ef7bac01?s=128&d=identicon&r=PG&f=1", "display_name": "user4869885", "link": "https://stackoverflow.com/users/4869885/user4869885"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1430909254, "creation_date": 1430904963, "last_edit_date": 1531164843, "question_id": 30072910, "link": "https://stackoverflow.com/questions/30072910/displaying-list-of-combinations-in-spreadsheet", "title": "displaying list of combinations in spreadsheet", "body": "<p>I have 5 numbers 1 to 5.  I require assistance on displaying all combinations of those 5 numbers. I do not want to know quantity of combinations these 5 numbers make but only what the combinations are  e.g  12345, 12344, 12432 etc displayed in open office or excel spreadsheet. There are several answers from programming point of view but i require a formula or vba coding in excel or open office.</p>\n"}, {"tags": ["vba", "dom", "mshtml"], "comments": [{"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 0, "creation_date": 1430905166, "post_id": 30072729, "comment_id": 48259671, "body": "The <code>DTTT btn-group</code> is a CSS Style, not a tagname.... probably you should use <code>ie.document.getElementById</code>..."}, {"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 0, "creation_date": 1430905281, "post_id": 30072729, "comment_id": 48259744, "body": "See <a href=\"http://stackoverflow.com/questions/17179872/i-need-to-find-press-a-button-on-a-webpage-using-excel-vba-macro\">here</a>..."}, {"owner": {"reputation": 11, "user_id": 3952773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/826b6f6e4127cfddc91c9a70a4360357?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Mota", "link": "https://stackoverflow.com/users/3952773/rui-mota"}, "reply_to_user": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 0, "creation_date": 1430908699, "post_id": 30072729, "comment_id": 48262052, "body": "I&#39;ve tried it too, but it won&#39;t work anyway."}, {"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 0, "creation_date": 1430909551, "post_id": 30072729, "comment_id": 48262633, "body": "So actually you want to trigger the export button action of the JQuery DataTable via IE Automation..."}, {"owner": {"reputation": 964, "user_id": 4773428, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e4eddffa987cd086aca5b1c562bffd0a?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/4773428/sam"}, "edited": false, "score": 0, "creation_date": 1430909637, "post_id": 30072729, "comment_id": 48262684, "body": "Is the button actually a button or does it call javascript?"}, {"owner": {"reputation": 11, "user_id": 3952773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/826b6f6e4127cfddc91c9a70a4360357?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Mota", "link": "https://stackoverflow.com/users/3952773/rui-mota"}, "edited": false, "score": 0, "creation_date": 1430909924, "post_id": 30072729, "comment_id": 48262877, "body": "I think that is not a button, because i try all the elements, and the method click won&#39;t work in anyone."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 3952773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/826b6f6e4127cfddc91c9a70a4360357?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Mota", "link": "https://stackoverflow.com/users/3952773/rui-mota"}, "edited": false, "score": 0, "creation_date": 1430910397, "post_id": 30074744, "comment_id": 48263215, "body": "I&#39;ve tried it too, but it won&#39;t work . Where can i find that event listeners information?"}, {"owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "reply_to_user": {"reputation": 11, "user_id": 3952773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/826b6f6e4127cfddc91c9a70a4360357?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Mota", "link": "https://stackoverflow.com/users/3952773/rui-mota"}, "edited": false, "score": 0, "creation_date": 1430912704, "post_id": 30074744, "comment_id": 48264747, "body": "You can inspect the elements with Developer Tools in the browser. It&#39;s not full proof but it&#39;s helpful. In Chrome when you inspect an element you have Event Listeners on the right."}, {"owner": {"reputation": 11, "user_id": 3952773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/826b6f6e4127cfddc91c9a70a4360357?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Mota", "link": "https://stackoverflow.com/users/3952773/rui-mota"}, "edited": false, "score": 0, "creation_date": 1430918000, "post_id": 30074744, "comment_id": 48268965, "body": "I cannot inspect the element in internet explorer because that option won&#39;t apear, only some version flash details. What does it mean?"}], "tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1430909817, "creation_date": 1430909817, "answer_id": 30074744, "question_id": 30072729, "link": "https://stackoverflow.com/questions/30072729/cant-click-a-web-page-button-via-vba/30074744#30074744", "title": "Can&#39;t click a web page button via VBA", "body": "<p>Chances are you need to click the <code>&lt;a&gt;</code>. </p>\n\n<pre><code>ie.document.getElementById(\"ToolTables_documentos_0\").click\n</code></pre>\n\n<p>But more information, like event listeners, is required to know for sure.</p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1530304210, "creation_date": 1530304210, "answer_id": 51109004, "question_id": 30072729, "link": "https://stackoverflow.com/questions/30072729/cant-click-a-web-page-button-via-vba/51109004#51109004", "title": "Can&#39;t click a web page button via VBA", "body": "<p>There is no URL and perhaps more HTML is required.</p>\n\n<p>Your initial error is because you are trying to use the method  of a single element on a collection.</p>\n\n<p>This, <code>ie.document.getElementsByTagName(\"DTTT btn-group\")</code>, returns a collection.</p>\n\n<p>You would use an index to specify which element to click on:</p>\n\n<pre><code>ie.document.getElementsByTagName(\"DTTT btn-group\")(0).Click\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 3952773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/826b6f6e4127cfddc91c9a70a4360357?s=128&d=identicon&r=PG&f=1", "display_name": "Rui Mota", "link": "https://stackoverflow.com/users/3952773/rui-mota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1272, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1530304210, "creation_date": 1430904479, "last_edit_date": 1439062837, "question_id": 30072729, "link": "https://stackoverflow.com/questions/30072729/cant-click-a-web-page-button-via-vba", "title": "Can&#39;t click a web page button via VBA", "body": "<p>I'm automation a login to a web page and then exporting data by clicking in a exporting button in the web page.</p>\n\n<p>The problem is that when I call the button:</p>\n\n<p><code>ie.document.getelementsbytagname(\"DTTT btn-group\").click</code> </p>\n\n<p>I get an error message telling that the method don't apply to the object.</p>\n\n<p>The web code when I select the button is:</p>\n\n<pre><code>    &lt;div class=\"DTTT btn-group\"&gt;\n    &lt;a class=\"btn xls_icon_class downLoadIcon_dataTable\"\n\nid=\"ToolTables_documentos_0\" data-original-title=\"\"&gt;\n    &lt;span&gt;&lt;/span&gt;\n    &lt;div style=\"left: 0px; top: 0px; width: 16px; height: 16px; position: \n\nabsolute; z-index: 99;\"&gt;\n    &lt;embed name=\"ZeroClipboard_TableToolsMovie_1\" width=\"16\" height=\"16\" \n\nalign=\"middle\" id=\"ZeroClipboard_TableToolsMovie_1\" pluginspage=\"http://www.macromedia.com/go/getflashplayer\" \n\nsrc=\"/factemipf_static/swf/copy_csv_xls_pdf.swf\" type=\"application/x-\n\nshockwave-flash\" wmode=\"transparent\" flashvars=\"id=1&amp;amp;width=16&amp;\n\namp;height=16\" allowfullscreen=\"false\" allowscriptaccess=\"always\" \n\nbgcolor=\"#ffffff\" quality=\"best\" menu=\"false\" loop=\"false\"&gt;&lt;/div&gt;&lt;/a&gt;&lt;/div&gt;\"\n</code></pre>\n\n<p>Help will be appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1430903926, "post_id": 30071832, "comment_id": 48258751, "body": "I believe it runs into an error (Runtime 1004) when <i>i</i> is empty/zero and doesn&#39;t recover."}, {"owner": {"reputation": 25, "user_id": 4852493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad7c37b5fab5a1ba2d8fdb7c9eb91a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Superman Akrt", "link": "https://stackoverflow.com/users/4852493/superman-akrt"}, "reply_to_user": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1430904846, "post_id": 30071832, "comment_id": 48259449, "body": "@user3819867: Actually it is working fine as the matching column is found. The problem that it is not getting the correct position of the found column, it is always set to 1"}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4852493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad7c37b5fab5a1ba2d8fdb7c9eb91a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Superman Akrt", "link": "https://stackoverflow.com/users/4852493/superman-akrt"}, "edited": false, "score": 0, "creation_date": 1430910302, "post_id": 30073427, "comment_id": 48263149, "body": "Yea you are right, I did it by mistake and didn&#39;t notice until you said."}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": true, "score": 0, "last_activity_date": 1511161552, "last_edit_date": 1511161552, "creation_date": 1430906391, "answer_id": 30073427, "question_id": 30071832, "link": "https://stackoverflow.com/questions/30071832/excel-vba-to-move-data-from-table-to-table-based-on-column-name/30073427#30073427", "title": "Excel VBA to move data from table to table based on column name", "body": "<pre><code>Do While i &lt;= SourceTableColumnCount\nColumnName = sourceTable.HeaderRowRange(i).Value\n                    On Error Resume Next\n                    DestColumnIndex = destTable.Range.Find(ColumnName, MatchCase:=True, SearchFormat:=False, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, LookAt:=xlWhole).Column - destTable.Range.Column + 1 'why would you use .Count?, it is a single cell, its count will always be 1\n                        If Err.Number &lt;&gt; 0 Then\n                            'In case column name in source table is not found in destination table\n                        Else\n                            destTable.DataBodyRange(DestRowIndex + 1, DestColumnIndex).Value = sourceTable.DataBodyRange(r + 1, i).Value\n                        End If\n                    i = i + 1\nLoop\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 4852493, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad7c37b5fab5a1ba2d8fdb7c9eb91a7c?s=128&d=identicon&r=PG&f=1", "display_name": "Superman Akrt", "link": "https://stackoverflow.com/users/4852493/superman-akrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 30073427, "answer_count": 1, "score": 0, "last_activity_date": 1511161552, "creation_date": 1430902159, "question_id": 30071832, "link": "https://stackoverflow.com/questions/30071832/excel-vba-to-move-data-from-table-to-table-based-on-column-name", "title": "Excel VBA to move data from table to table based on column name", "body": "<p>I created a procedure that loops in all header columns of table 1 and search for the same header column in table 2 to update relveant cells based on matched column name.</p>\n\n<p>This is the code for this procedure:</p>\n\n<pre><code>Do While i &lt;= SourceTableColumnCount\nColumnName = sourceTable.HeaderRowRange(i).Value\n                    On Error Resume Next\n                    DestColumnIndex = destTable.Range.Find(ColumnName, MatchCase:= True, SearchFormat:=False, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, LookAt:=xlWhole).Count\n                        If Err.Number &lt;&gt; 0 Then\n                            'In case column name in source table is not found in destination table\n                        Else\n                            destTable.DataBodyRange(DestRowIndex + 1, DestColumnIndex).Value =  sourceTable.DataBodyRange(r + 1, i).Value\n                        End If\n                    i = i + 1\nLoop\n</code></pre>\n\n<p>The problem is DestColumnIndex is always 1. Although column name in destination table is matching column name in source table. It should work like this:</p>\n\n<p>1- Go to first column in table 1 and get it's value\n2- Go to table 2 and search for value from step 1\n3- For the found result, get the range.column (Index of this column)\n4- Set the cell value where range (Row, DestColumnIndex)</p>\n\n<p>my problem is in step 3 where range.column is always 1 so the output of step 4 is always updating cell where column index is 1.</p>\n\n<p>I hope the problem is clear.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1430903045, "post_id": 30071786, "comment_id": 48258176, "body": "If your data are in data tables I can help you by refering to my previous <a href=\"http://stackoverflow.com/a/30024469/3819867\">answer to a similar question</a>. The list objects are subsets of worksheets and worksheets are subsets of workbooks. You need to define them all the way down."}], "answers": [{"tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": false, "score": 0, "last_activity_date": 1430904429, "creation_date": 1430904429, "answer_id": 30072713, "question_id": 30071786, "link": "https://stackoverflow.com/questions/30071786/excel-vba-compare-three-excel-list-and-findout-all-common-parts/30072713#30072713", "title": "Excel VBA Compare Three Excel List and Findout All Common Parts", "body": "<p>Microsoft Query to the rescue (<strong>Data->From Other Sources->Microsoft Query</strong>).</p>\n\n<h2><strong>Example for comparing Sheets A and B</strong></h2>\n\n<p><strong>Step 1</strong>: Add a Row Number column to sheets A and B</p>\n\n<p><strong>Step 2</strong>: Create the query:</p>\n\n<pre><code>SELECT SheetA.A, SheetB.B FROM [SheetA$] as SheetA,\nLEFT OUTER JOIN [SheetB$] as SheetB ON SheetA.A = SheetB.B\n</code></pre>\n\n<h2><strong>What if they are in different files?</strong></h2>\n\n<pre><code>SELECT SheetA.A, SheetB.B FROM `C:\\FileA.xlsx`.`SheetA$` as SheetA,\nLEFT OUTER JOIN `C:\\FileA.xlsx`.`SheetA$` as SheetB ON SheetA.A = SheetB.B\n</code></pre>\n\n<p>As always I recommend using my AddIn to create the queries: <a href=\"http://www.analystcave.com/excel-tools/excel-sql-add-in-free/\" rel=\"nofollow\">link</a> or use the Wizard (Data->From Other Sources->Microsoft Query).</p>\n"}], "owner": {"reputation": 1, "user_id": 4866777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a156f8c7e4e00cd819dc09673a8e29a?s=128&d=identicon&r=PG&f=1", "display_name": "Tero Hokkanen", "link": "https://stackoverflow.com/users/4866777/tero-hokkanen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430904429, "creation_date": 1430902052, "last_edit_date": 1531164843, "question_id": 30071786, "link": "https://stackoverflow.com/questions/30071786/excel-vba-compare-three-excel-list-and-findout-all-common-parts", "title": "Excel VBA Compare Three Excel List and Findout All Common Parts", "body": "<p>I have a three excel files <code>(A, B and C)</code>. And I have to compare <code>A</code> list to other lists to find if <code>B</code> and <code>C</code> list have same parts than <code>A</code>. Then have a separate list of parts that can be found list <code>A</code> and <code>(B or C)</code>. Also it would be good if in the list have info Which one list <code>(b or C)</code> part have found. \nIn the lists column 1 is ID number and column 2 is part name.  </p>\n\n<p>Now I have tried following code:</p>\n\n<pre><code>Sub lookup()\nDim TotalRows As Long\nDim rng As Range\nDim i As Long\n\n'Copy lookup values from sheet1 to sheet3\nSheets(\"Sheet1\").Select\nTotalRows = ActiveSheet.UsedRange.Rows.Count\nRange(\"A1:B\" &amp; TotalRows).Copy Destination:=Sheets(\"Sheet3\").Range(\"A1\")\n\n'Go to the destination sheet\nSheets(\"Sheet3\").Select\n\nFor i = 1 To TotalRows\n    'Search for the value on sheet2\n    Set rng = Sheets(\"Sheet2\").UsedRange.Find(Cells(i, 1), LookAt:=xlWhole)\n    'If it is found put its value on the destination sheet\n    If Not rng Is Nothing Then\n        Cells(i, 4).Value = rng.Value\n    End If\nNext\nEnd Sub\n</code></pre>\n\n<p>But it's not very good for me. Because now I have to copy B and C list in sheet 2 and then this code copies all A list to sheet 3 and next column what are common with sheet2. </p>\n\n<p>And do I have to say there are thousands of parts.\nEven easy way to comparing B to A list would be good.  </p>\n\n<p>So I really need your help.   </p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2007"], "comments": [{"owner": {"reputation": 2322, "user_id": 2140244, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/MIRfV.png?s=128&g=1", "display_name": "Matt Hall", "link": "https://stackoverflow.com/users/2140244/matt-hall"}, "edited": false, "score": 0, "creation_date": 1430901646, "post_id": 30071337, "comment_id": 48257179, "body": "Which line is debug highlighting? I think you should refer to <code>txtwrhIDs</code> differently; perhaps using this convention: <code>Forms!Mainform!ControlName</code> I also don&#39;t think you can get to the caption or visibility properties through <code>Me.Controls(Me.myControl)</code> method."}], "answers": [{"tags": [], "owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "is_accepted": false, "score": 2, "last_activity_date": 1430901543, "creation_date": 1430901543, "answer_id": 30071590, "question_id": 30071337, "link": "https://stackoverflow.com/questions/30071337/can-not-find-the-field-name/30071590#30071590", "title": "Can not find the Field name", "body": "<p>The correct syntax to addres a form control in VBA is either:</p>\n\n<pre><code>Forms![YourFormName]![YourControlName]\n</code></pre>\n\n<p>The brackets are only required if the name contains blanks.</p>\n\n<p>or</p>\n\n<pre><code>Forms(\"YourFormName\").Controls(\"YourControlName\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 355, "user_id": 823584, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8bc25759f4d816b1fa08fcc0709cff0e?s=128&d=identicon&r=PG", "display_name": "emilios", "link": "https://stackoverflow.com/users/823584/emilios"}, "is_accepted": false, "score": 0, "last_activity_date": 1430901971, "creation_date": 1430901971, "answer_id": 30071760, "question_id": 30071337, "link": "https://stackoverflow.com/questions/30071337/can-not-find-the-field-name/30071760#30071760", "title": "Can not find the Field name", "body": "<p>i changed</p>\n\n<pre><code>strlbl = \"Me.lblWarehouse\" &amp; i\nstrlblV = \"Me.lblWarehouse\" &amp; i \n</code></pre>\n\n<p>to :</p>\n\n<pre><code>strlbl = \"lblWarehouse\" &amp; i\nstrlblV = \"lblWarehouse\" &amp; i \n</code></pre>\n\n<p>and is working fine</p>\n"}], "owner": {"reputation": 355, "user_id": 823584, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/8bc25759f4d816b1fa08fcc0709cff0e?s=128&d=identicon&r=PG", "display_name": "emilios", "link": "https://stackoverflow.com/users/823584/emilios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1430901971, "creation_date": 1430900794, "last_edit_date": 1430901556, "question_id": 30071337, "link": "https://stackoverflow.com/questions/30071337/can-not-find-the-field-name", "title": "Can not find the Field name", "body": "<pre><code>strSQL = \" SELECT W.wrhID, \" &amp; _\n         \" W.wrhName AS WName \" &amp; _\n         \" FROM tblWarehouse AS W \" &amp; _\n         \" WHERE W.wrhID IN ( \" &amp; Forms.frmStockControl.Form.txtwrhIDs &amp; \" )\"\nSet rst = CurrentDb.OpenRecordset(strSQL)\n Do Until rst.EOF\n    Dim strlbl$, strlblV$\n    For i = 1 To rst.Fields.count\n        strlbl = \"Me.lblWarehouse\" &amp; i\n        strlblV = \"Me.lblWarehouse\" &amp; i\n        Me.Controls(strlbl).Caption = rst!WName\n        Me.Controls(strlblV).visible = True\n    Next\n    rst.MoveNext\n Loop\n</code></pre>\n\n<p>I am getting error msg <code>2465 - Can not find the Field name</code></p>\n\n<p>but field Name exists in my form.<br>Pls help.</p>\n"}, {"tags": ["sql", "ms-access", "vba", "sql-update"], "comments": [{"owner": {"reputation": 35510, "user_id": 3706016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wqmW0.jpg?s=128&g=1", "display_name": "jarlh", "link": "https://stackoverflow.com/users/3706016/jarlh"}, "edited": false, "score": 1, "creation_date": 1430899189, "post_id": 30070767, "comment_id": 48255656, "body": "Are you sure it&#39;s blank and not NULL?"}, {"owner": {"reputation": 9572, "user_id": 4436237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IOqIu.jpg?s=128&g=1", "display_name": "ughai", "link": "https://stackoverflow.com/users/4436237/ughai"}, "edited": false, "score": 0, "creation_date": 1430899240, "post_id": 30070767, "comment_id": 48255692, "body": "<code>Status</code> is blank or <code>NULL</code>? you can check if you WHERE clause is correct by doing a select <code>SELECT * FROM customer WHERE customer_id = 41308408 AND location IN (&#39;London&#39;,&#39;New York&#39;) AND Status = &#39;&#39;</code>. if no rows are returned change the status check to <code>status is null</code>"}, {"owner": {"reputation": 25, "user_id": 4622730, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a70f1e2c81a5e4e34d7042c224fa1015?s=128&d=identicon&r=PG&f=1", "display_name": "StoilTopalov", "link": "https://stackoverflow.com/users/4622730/stoiltopalov"}, "edited": false, "score": 0, "creation_date": 1430901306, "post_id": 30070767, "comment_id": 48256968, "body": "thank you all, it is indeed null, and now it works fine."}], "answers": [{"tags": [], "owner": {"reputation": 24071, "user_id": 1579182, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/29b8eb1189d3a4ea2fa71ccd069f9ca3?s=128&d=identicon&r=PG", "display_name": "Robert", "link": "https://stackoverflow.com/users/1579182/robert"}, "is_accepted": true, "score": 1, "last_activity_date": 1430899171, "creation_date": 1430899171, "answer_id": 30070813, "question_id": 30070767, "link": "https://stackoverflow.com/questions/30070767/sql-update-table-statement-not-working/30070813#30070813", "title": "sql update table - statement not working", "body": "<p>Maybe <code>status</code> isn't blank, maybe it's null? Try below solution:</p>\n\n<pre><code>UPDATE customer \nSET Status = 'Premier' \nWHERE customer_id = 41308408 \nAND location IN ('London','New York') \nAND Status is null\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 249903, "user_id": 2422776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2353050223ebecb113741c29458de4b2?s=128&d=identicon&r=PG", "display_name": "Mureinik", "link": "https://stackoverflow.com/users/2422776/mureinik"}, "is_accepted": false, "score": 0, "last_activity_date": 1430899212, "creation_date": 1430899212, "answer_id": 30070827, "question_id": 30070767, "link": "https://stackoverflow.com/questions/30070767/sql-update-table-statement-not-working/30070827#30070827", "title": "sql update table - statement not working", "body": "<p>The blank is probably a <code>null</code> in the database. <code>Null</code>s are values - they are the lack thereof. You can't query them with the <code>=</code> operator, you need to treat them explicitly with the <code>is</code> operator:</p>\n\n<pre><code>DoCmd.RunSQL \"UPDATE customer SET Status = 'Premier' WHERE customer_id = 41308408 AND location IN ('London','New York') AND Status IS NULL\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 4865635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/817dc95f894c356aa555e1c9b0802b43?s=128&d=identicon&r=PG&f=1", "display_name": "Swati Joshi", "link": "https://stackoverflow.com/users/4865635/swati-joshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1430901135, "creation_date": 1430901135, "answer_id": 30071439, "question_id": 30070767, "link": "https://stackoverflow.com/questions/30070767/sql-update-table-statement-not-working/30071439#30071439", "title": "sql update table - statement not working", "body": "<p>UPDATE customer SET Status = 'Premier' WHERE customer_id = 41308408 AND location IN ('London','New York') AND ((Status is null) or length(trim(Status)) = 0)</p>\n"}], "owner": {"reputation": 25, "user_id": 4622730, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a70f1e2c81a5e4e34d7042c224fa1015?s=128&d=identicon&r=PG&f=1", "display_name": "StoilTopalov", "link": "https://stackoverflow.com/users/4622730/stoiltopalov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7813, "favorite_count": 0, "accepted_answer_id": 30070813, "answer_count": 3, "score": 2, "last_activity_date": 1594654593, "creation_date": 1430899022, "last_edit_date": 1594654593, "question_id": 30070767, "link": "https://stackoverflow.com/questions/30070767/sql-update-table-statement-not-working", "title": "sql update table - statement not working", "body": "<p>I have the below statement in my VBA:</p>\n\n<pre><code>DoCmd.RunSQL \"UPDATE customer SET Status = 'Premier' WHERE customer_id = 41308408 AND location IN ('London','New York') AND Status = ''\"\n</code></pre>\n\n<p>which is meant to update a table called \"customer\". I can see in my table there are about 20 entries where the customer_id is 41308408 (i.e. if i filter the column for that value), with the location being either London or New York for each entry. The Status column is blank for each of these.</p>\n\n<p>I execute the above code, and it compiles OK, but it says \"You are about to update 0 rows\". I would be expecting that to be 20, as per above. Any ideas?</p>\n"}, {"tags": ["vba", "excel", "duplicates", "records"], "comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1430983457, "post_id": 30070722, "comment_id": 48301103, "body": "Updated my function. Feel free to accpet the answer if it helps you."}], "answers": [{"comments": [{"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "edited": false, "score": 0, "creation_date": 1430948348, "post_id": 30081478, "comment_id": 48289254, "body": "Note to self: It&#39;s even redundant. col(0)-&gt;rng1.Columns etc. 10 needs to be an optional(?) input variable. The ranges can be single cells."}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1430983387, "last_edit_date": 1430983387, "creation_date": 1430926894, "answer_id": 30081478, "question_id": 30070722, "link": "https://stackoverflow.com/questions/30070722/excel-vba-formula-for-checking-duplicate-similar-records-using-multiple-con/30081478#30081478", "title": "Excel - VBA/Formula for checking duplicate (similar*) records using multiple conditions", "body": "<pre><code>Function MATCHER(str1 As Range, rng1 As Range, str2 As String, rng2 As Range, num1 As Long, rng3 As Range, lim1 As Long)\nDim col(2) As Range, ws As Worksheet, rng As Range, str11 As String, FirstRow As Long, LastRow  As Long\nMATCHER = False\nSet ws = rng1.Worksheet                                                              'finds the worksheet of the first range (assumes all three ranges are on the same worksheet)\nFirstRow = str1.Row + 1\nLastRow = ws.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row 'find the last row in the worksheet\nSet rng = ws.Range(\"1:\" &amp; LastRow)                                                   'look down to the last row, inclusive\nSet col(0) = Intersect(rng1.Columns, rng)                                            'apply the above criterion\nSet col(1) = Intersect(rng2.Columns, rng)                                            'apply the above criterion\nSet col(2) = Intersect(rng3.Columns, rng)                                            'apply the above criterion\nFor i = FirstRow To LastRow                                                          'from first to last row\nIf col(0)(i, 1).Value2 = str1.Value2 Then                                            'if the first range variable's first column's value in row equals the first string variable\n    If col(1)(i, 1) = str2 Then                                                      'if the second range variable's first column's value in row equals the second string variable\n        If col(2)(i, 1) &gt;= num1 - lim1 And col(2)(i, 1) &lt;= num1 + lim1 Then          'if the third range variable's first column's value in row equals the lookup value in confidence interval\n            MATCHER = True                                                           'then it is true\n            Exit Function                                                            'and there's no point in looking further\n        End If\n    End If\nEnd If\nNext\nEnd Function\nSub ertdfgcvb()\nx = MATCHER(Range(\"A1\"), Range(\"A1\"), \"B\", Range(\"B1\"), 200, Range(\"C1\"), 10)\nMsgBox x\nEnd Sub\n</code></pre>\n\n<p>For runtime considerations test in live environment. The first n-1 records will have the output <em>TRUE</em> where n = similar records.<br>\nIt is meant to be used on a single recordset.</p>\n"}], "owner": {"reputation": 23, "user_id": 3794445, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/6e7e98f676ef0bbd699521420db5a548?s=128&d=identicon&r=PG&f=1", "display_name": "MasterJedi", "link": "https://stackoverflow.com/users/3794445/masterjedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1005, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430983387, "creation_date": 1430898875, "last_edit_date": 1531164843, "question_id": 30070722, "link": "https://stackoverflow.com/questions/30070722/excel-vba-formula-for-checking-duplicate-similar-records-using-multiple-con", "title": "Excel - VBA/Formula for checking duplicate (similar*) records using multiple conditions", "body": "<p>I'm looking for some help with this one. I need to check an Excel file with approx. 40000 records for similar records, according to multiple conditions. I also need this to be fairly foolproof for someone not entirely IT savvy to do regularly once shown how. Therefore, a macro or formula based solution would be preferred.</p>\n\n<p>It seems easy enough to start with. Data has a header row with one record per row. It's easy enough to use conditional formatting to highlight rows with duplicate data in one or more columns, but I have an added complication. </p>\n\n<p>Problem: I need to find records which have the same data in columns E and F (Surname and DOB), and I need the record to be highlighted as a duplicate if the dates in column K are similar (i.e. within 10 days of each other). Only if all 3 conditions are met would the record be highlighted as a potential duplicate.</p>\n\n<p>Is this possible? I'm open to suggestions. </p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 10622, "user_id": 3467532, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWfq5.jpg?s=128&g=1", "display_name": "daniele3004", "link": "https://stackoverflow.com/users/3467532/daniele3004"}, "edited": false, "score": 0, "creation_date": 1430897222, "post_id": 30070050, "comment_id": 48254418, "body": "No problem. Good luck!"}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": true, "score": 1, "last_activity_date": 1430896857, "creation_date": 1430896857, "answer_id": 30070050, "question_id": 30069848, "link": "https://stackoverflow.com/questions/30069848/how-to-create-excel-table-by-vba-at-runtime/30070050#30070050", "title": "How to create Excel Table by VBA at runtime?", "body": "<p>Like this:</p>\n\n<pre><code>Range(\"A1:I9\").Select\nActiveSheet.ListObjects.Add(xlSrcRange, Range(\"$A$1:$I$9\"), , xlYes).Name = \"Table1\"\nActiveSheet.ListObjects(\"Table1\").ShowTotals = True\nActiveSheet.ListObjects(\"Table1\").ListColumns(\"B\").TotalsCalculation = xlTotalsCalculationSum\nActiveSheet.ListObjects(\"Table1\").ListColumns(\"C\").TotalsCalculation = xlTotalsCalculationSum\n'Repeat row above until column I\n</code></pre>\n\n<p>I got this by recording a VBA Macro. If you are not familiar with Macro recording see link <a href=\"http://www.analystcave.com/tutorials/excel-vba-tutorial/#Excel_VBA_Tutorial_Recording_Macros\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 10622, "user_id": 3467532, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/TWfq5.jpg?s=128&g=1", "display_name": "daniele3004", "link": "https://stackoverflow.com/users/3467532/daniele3004"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 689, "favorite_count": 0, "accepted_answer_id": 30070050, "answer_count": 1, "score": 0, "last_activity_date": 1430896857, "creation_date": 1430896180, "question_id": 30069848, "link": "https://stackoverflow.com/questions/30069848/how-to-create-excel-table-by-vba-at-runtime", "title": "How to create Excel Table by VBA at runtime?", "body": "<p>During execution of macro I reads multiple excel file and creates a new excel file, i build a similar sheet:</p>\n\n<p><img src=\"https://i.stack.imgur.com/fQpMp.png\" alt=\"enter image description here\"></p>\n\n<p>At runtime by VBA I want to set this area and create a table, add Total Row and get the following result:</p>\n\n<p><img src=\"https://i.stack.imgur.com/8dVec.png\" alt=\"enter image description here\"></p>\n\n<p>Thank you :-)</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1430896291, "post_id": 30069642, "comment_id": 48253828, "body": "Do you know about Power Query? It can combine data from different sources, Excel sheets, tables, external data bases, and more. You can massage the data, clean it, create calculated columns and all sorts of things. Maybe that would be an alternative to doing all that with VBA."}, {"owner": {"reputation": 339, "user_id": 3635050, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/624c9048221ee20f622f4b15ad29e4a1?s=128&d=identicon&r=PG&f=1", "display_name": "TAKL", "link": "https://stackoverflow.com/users/3635050/takl"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1430896980, "post_id": 30069642, "comment_id": 48254248, "body": "Thanks for the suggestion. Short answer; We have to use Excel and that&#39;s why I have to use VBA. Sad but true."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1430899490, "post_id": 30069642, "comment_id": 48255854, "body": "Power Query is an add-in for Excel. By Microsoft."}, {"owner": {"reputation": 339, "user_id": 3635050, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/624c9048221ee20f622f4b15ad29e4a1?s=128&d=identicon&r=PG&f=1", "display_name": "TAKL", "link": "https://stackoverflow.com/users/3635050/takl"}, "reply_to_user": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 0, "creation_date": 1430901699, "post_id": 30069642, "comment_id": 48257214, "body": "Sorry for sounding stupid. All I know about Power Query is that it is a COM Add-In and it isn&#39;t installed on our computers. Since I don&#39;t have admin rights, I can&#39;t use it since it can&#39;t be installed."}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1430902128, "post_id": 30069642, "comment_id": 48257526, "body": "I hear you. Power Query is the best thing that has happened to Excel in the last 5 years. The installation barrier can be tackled by convincing your boss that it will make you so much more productive. (I know, I know)"}], "answers": [{"comments": [{"owner": {"reputation": 339, "user_id": 3635050, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/624c9048221ee20f622f4b15ad29e4a1?s=128&d=identicon&r=PG&f=1", "display_name": "TAKL", "link": "https://stackoverflow.com/users/3635050/takl"}, "edited": false, "score": 0, "creation_date": 1430979314, "post_id": 30070561, "comment_id": 48298851, "body": "Good input. However, there are several columns that need to be created (that don&#39;t exist in the tables mentioned). So these will have to be created by code anyways. That&#39;s why I&#39;m simply looking for an easier way to control all data. And that&#39;s why I&#39;m thinking that maybe a collection or a class could work, but I&#39;m still looking for an example of how that should be setup."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 339, "user_id": 3635050, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/624c9048221ee20f622f4b15ad29e4a1?s=128&d=identicon&r=PG&f=1", "display_name": "TAKL", "link": "https://stackoverflow.com/users/3635050/takl"}, "edited": false, "score": 1, "creation_date": 1430985483, "post_id": 30070561, "comment_id": 48302378, "body": "I am not sure what you mean that these columns need to be created. The SQL query can create new columns. New columns can be calculations, formulas, or simply the result of other columns in the referenced tables. The result of an SQL query is a header of columns and the rows - you can manipulate the columns as you like."}, {"owner": {"reputation": 339, "user_id": 3635050, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/624c9048221ee20f622f4b15ad29e4a1?s=128&d=identicon&r=PG&f=1", "display_name": "TAKL", "link": "https://stackoverflow.com/users/3635050/takl"}, "edited": false, "score": 0, "creation_date": 1430991793, "post_id": 30070561, "comment_id": 48306495, "body": "Did not know you could create new columns. Is it also possible to make a case that uses a date to pick a certain column?  Example: 7 columns named &quot;Start monday&quot;, &quot;Start tuesday&quot; etc. If the date I have provided is a monday, I want to pick the column &quot;Start monday&quot;.   Is that case possible to implement in an SQL query?"}, {"owner": {"reputation": 339, "user_id": 3635050, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/624c9048221ee20f622f4b15ad29e4a1?s=128&d=identicon&r=PG&f=1", "display_name": "TAKL", "link": "https://stackoverflow.com/users/3635050/takl"}, "edited": false, "score": 1, "creation_date": 1431003514, "post_id": 30070561, "comment_id": 48314808, "body": "Thanks for your answer. Sidenote: Your script can&#39;t be downloaded, it simply says &quot;No file attached yet&quot;."}, {"owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "reply_to_user": {"reputation": 339, "user_id": 3635050, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/624c9048221ee20f622f4b15ad29e4a1?s=128&d=identicon&r=PG&f=1", "display_name": "TAKL", "link": "https://stackoverflow.com/users/3635050/takl"}, "edited": false, "score": 0, "creation_date": 1431007336, "post_id": 30070561, "comment_id": 48318008, "body": "No problem. Thanks for the heads up! Fixed the issue. You can download the AddIn if needed."}], "tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": true, "score": 1, "last_activity_date": 1430992285, "last_edit_date": 1430992285, "creation_date": 1430898363, "answer_id": 30070561, "question_id": 30069642, "link": "https://stackoverflow.com/questions/30069642/best-way-to-store-rows-columns-from-sheets-tables/30070561#30070561", "title": "Best way to store rows/columns from sheets/tables?", "body": "<p>Yes. <strong>Use Microsoft Query</strong>. It does not require installation of PowerQuery as it is available just like your database link natively from Excel. Below example of transfering data between Worksheets:</p>\n\n<pre><code>SELECT * FROM [Input$] as I INNER JOIN [AnotherWorksheet$] as A ON I.ArtNo = A.ArtNo\n</code></pre>\n\n<p>Then update the Query from VBA:</p>\n\n<pre><code>ActiveSheet.QueryTables(1).Refresh BackgroundQuery:=False\n</code></pre>\n\n<p>You can create a Microsoft Query from the Data ribbon tab (From Other Sources) or using my Add-In (just for creating the query): <a href=\"http://www.analystcave.com/excel-tools/excel-sql-add-in-free/\" rel=\"nofollow\">link</a>.</p>\n\n<p><strong>Here an example of how to use Iif to return different values based on a day of the week:</strong></p>\n\n<pre><code>SELECT Iif( DatePart (\"w\", #05/07/2015#,2) = 1, 1,0) as StartMonday,\nIif( DatePart (\"w\", #05/07/2015#,2) = 2, 1,0) as StartTuesday, \nIif( DatePart (\"w\", #05/07/2015#,2) = 3, 1,0) as StartWednesday,\nIif( DatePart (\"w\", #05/07/2015#,2) = 4, 1,0) as StartThursday,    \nIif( DatePart (\"w\", #05/07/2015#,2) = 5, 1,0) as StartFriday    \n</code></pre>\n\n<p>This will return something like:</p>\n\n<pre><code>StartMonday | StartTuesday | StartWednesday | StartThursday | StartFriday\n0           | 0            | 0              | 1             | 0\n</code></pre>\n"}], "owner": {"reputation": 339, "user_id": 3635050, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/624c9048221ee20f622f4b15ad29e4a1?s=128&d=identicon&r=PG&f=1", "display_name": "TAKL", "link": "https://stackoverflow.com/users/3635050/takl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 30070561, "answer_count": 1, "score": 1, "last_activity_date": 1430992285, "creation_date": 1430895479, "question_id": 30069642, "link": "https://stackoverflow.com/questions/30069642/best-way-to-store-rows-columns-from-sheets-tables", "title": "Best way to store rows/columns from sheets/tables?", "body": "<p>I have a workbook that fetches data from several other worksheets. Usually, the data is stored in a table in each sheet. In this case, one table is a data connection to our database where our orders are stored. </p>\n\n<p>In order to successfully get the correct data from each sheet, I create a 'Data' sub that looks something like this:</p>\n\n<pre><code>Dim Wb(1 To 10) As Workbook\nDim Sh(1 To 10) As Worksheet\nDim Lo(1 To 10) As ListObject\nDim Ii&amp;(1 To 10), Jj&amp;(1 To 10), Kk&amp;(1 To 10)\n\nSub Data()\n    Set Wb(1) = ThisWorkbook\n    Set Sh(1) = Wb(1).Worksheets(\"Input\")\n    Set Lo(1) = Sh(1).ListObjects(\"Input\")\n    With Lo(1)\n        Ii(1) = .ListColumns(\"Date\").Range.Column\n        Ii(2) = .ListColumns(\"ArtNo\").Range.Column\n        Ii(3) = .ListColumns(\"ArtName\").Range.Column\n        Ii(4) = .ListColumns(\"ArtUnits\").Range.Column ' Units in the article\n        Ii(5) = .ListColumns(\"ArtLitres\").Range.Column ' Litres in the article\n        Ii(6) = .ListColumns(\"Quantity\").Range.Column\n        Ii(7) = .ListColumns(\"SumUnits\").Range.Columne ' Units * Quantity\n        Ii(8) = .ListColumns(\"SumLitres\").Range.Columne ' Litres * Quantity\n    End With\n\n    ' Table from Database containing the orders\n    Set Sh(2) = Wb(1).Worksheets(\"Orders\")\n    Set Lo(2) = Sh(2).ListObjects(\"Orders\")\n    With Lo(2)\n        Jj(1) = .ListColumns(\"Date\").Range.Column\n        Jj(2) = .ListColumns(\"ArtNo\").Range.Column\n        Jj(6) = .ListColumns(\"Quantity\").Range.Column\n    End With\n\n    ' Database containing detailed information on the articles\n    Set Sh(3) = Wb(1).Worksheets(\"ArtData\")\n    Set Lo(3) = Sh(3).ListObjects(\"ArtData\")\n    With Lo(3)\n        Kk(2) = .ListColumns(\"ArtNo\").Range.Column\n        Kk(3) = .ListColumns(\"ArtName\").Range.Column\n        Kk(4) = .ListColumns(\"ArtUnits\").Range.Column ' Units in the article\n        Kk(5) = .ListColumns(\"ArtLitres\").Range.Column ' Litres in the article\n    End With\nEnd Sub\n</code></pre>\n\n<p>So, when I've run the Data sub, I know where all the relevant columns are. And I have seen to it that each number represents the same column name. By that I mean that Ii(2), Jj(2) and Kk(2) all equal the column named \"ArtNo\" in each table.</p>\n\n<p>I started using arrays because they are quicker to declare. Instead of declaring separate integers, like \"ArtNo1\", \"ArtNo2\", \"ArtNo3\" or ArtNo(1 to 3), I'd simply know that the digit (1) equals ArtNo in each table, and I'd use one Array (\"Ii\", \"Jj\", \"Kk\") per table. I will only have to know what each digit represents and worst case; I would scroll up to the Data sub and get the answer there.</p>\n\n<p><strong>In order to get data I'd do something like this:</strong></p>\n\n<pre><code>Sub TransferData()\nDim dDate As Date\nDim Str$\nDim Cel As Range\nDim X&amp;, Y&amp;\n    CalcOff\n    Data\n    Wb(1).RefreshAll ' Updates the Order data connection\n    X = Lo(1).DataBodyRange.Row ' Get input row for the data\n    Str = Format(dDate, \"yyyy-mm-dd\", vbMonday, vbFirstFourDays) ' Used for filtering the table\n\n    ' Filtering the order database, showing only the chosen date\n    Lo(2).AutoFilter.ShowAllData\n    Lo(2).Range.AutoFilter Field:=Jj(1), Operator:=xlFilterValues, Criteria2:=Array(2, Str)\n\n    With Sh(1)\n        For Each Cel In Lo(2).ListColumns(Jj(2)).DataBodyRange.SpecialCells(xlCellTypeVisible)\n\n            ' Transferring from the Order database\n            .Cells(X, Ii(1)) = dDate\n            .Cells(X, Ii(2)) = Cel\n            .Cells(X, Ii(6)) = Sh(2).Cells(Cel.Row, Jj(6))\n\n            ' Find the 'ArtNo' row from the Info database\n            Y = Lo(3).ListColumns(Kk(2)).Find(Cel, LookIn:=xlValues, LookAt:=xlWhole).Row\n\n            ' Transferring from the Info database\n            .Cells(X, Ii(3)) = Sh(3).Cells(Y, Kk(3))\n            .Cells(X, Ii(4)) = Sh(3).Cells(Y, Kk(4))\n            .Cells(X, Ii(5)) = Sh(3).Cells(Y, Kk(5))\n\n            ' Calculating units and litres\n            .Cells(X, Ii(7)) = .Cells(X, Ii(6)) * .Cells(X, Ii(4))\n            .Cells(X, Ii(8)) = .Cells(X, Ii(6)) * .Cells(X, Ii(5))\n\n            X = X + 1\n        Next Cel\n    End With\n    CalcOn\n    End\nEnd Sub\n\nFunction CalcOff()\n    Application.Calculation = xlCalculationManual\n    Application.ScreenUpdating = False\n    Application.EnableEvents = False\nEnd Function\n\nFunction CalcOn()\n    Application.Calculation = xlCalculationAutomatic\n    Application.ScreenUpdating = True\n    Application.EnableEvents = True\nEnd Function\n</code></pre>\n\n<p><strong>My question is:</strong></p>\n\n<p>Is there an easier way to transfer data like this? I'm thinking classes, but I have never worked with them so I'd really appreciate if someone could give an example of how to implement classes while doing a transfer like this one. </p>\n\n<p><em>Please note that the code is just a quickly written example. I've placed all tables at \"A1\" in each sheet, otherwise I would have to do the following for each column:</em></p>\n\n<pre><code>Ii(1) = .ListColumns(\"Date\").Range.Column - .Range.Column + 1\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 29100, "user_id": 3611989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbc1601c4a55b2a7cf9589a6ab85eaa2?s=128&d=identicon&r=PG", "display_name": "Rory", "link": "https://stackoverflow.com/users/3611989/rory"}, "is_accepted": false, "score": 1, "last_activity_date": 1430896462, "creation_date": 1430896462, "answer_id": 30069936, "question_id": 30069624, "link": "https://stackoverflow.com/questions/30069624/select-method-of-range-class-failed-while-calling-a-sub-for-the-second-time/30069936#30069936", "title": "Select Method of Range class failed While calling a Sub for the second time", "body": "<p>The most likely cause is that that sheet is not active. However you don't need to select anything here - you can manipulate the cell directly:</p>\n\n<pre><code>Sub TNPopulate(tablename As String)\n\n    tablecount = tablecount + 1\n    existingtable = tablename\n    tablestart = Row + 1\n\n    With wb.Sheets(2).Cells(tablestart, col)\n        .Value = existingtable\n        .Font.Bold = True\n        With .Interior\n            .Pattern = xlSolid\n            .PatternColorIndex = xlAutomatic\n            .ThemeColor = xlThemeColorDark1\n            .TintAndShade = -0.249977111117893\n            .PatternTintAndShade = 0\n        End With\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 4869355, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd50ede099b5f630a6d8b852013650e1?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/4869355/ganesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1430896462, "creation_date": 1430895423, "last_edit_date": 1430896006, "question_id": 30069624, "link": "https://stackoverflow.com/questions/30069624/select-method-of-range-class-failed-while-calling-a-sub-for-the-second-time", "title": "Select Method of Range class failed While calling a Sub for the second time", "body": "<p>Hi Please find my piece of code below. I call this subroutine each time when I need to populate a table name into my worksheet. All the variables which are not declared including workbook are declared as PUBLIC. </p>\n\n<p>This sub is called many times during the entire run and for the first time it does what it is supposed to. But second time when the sub is called, it throws an error \"Select Method of Range class failed\". Not sure where it is going wrong. </p>\n\n<p>Note: the wb is used in other sub as well. Is this a problem? Should I have to declare it locally on all my sub separately?</p>\n\n<p>Kindly advice.</p>\n\n<pre><code>Sub TNPopulate(tablename As String)\n\n    tablecount = tablecount + 1\n    existingtable = tablename\n    tablestart = row + 1\n\n    wb.Sheets(2).Cells(tablestart, col) = existingtable\n    wb.Sheets(2).Cells(tablestart, col).Select\n    Selection.Font.Bold = True\n    With Selection.Interior\n        .Pattern = xlSolid\n        .PatternColorIndex = xlAutomatic\n        .ThemeColor = xlThemeColorDark1\n        .TintAndShade = -0.249977111117893\n        .PatternTintAndShade = 0\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "edited": false, "score": 1, "creation_date": 1430891733, "post_id": 30068501, "comment_id": 48251385, "body": "This site is not a free coding service. We can help when you get stuck, though, so show your code so far and explain where you need help. Edit your post."}], "answers": [{"tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1430902614, "creation_date": 1430902614, "answer_id": 30072005, "question_id": 30068501, "link": "https://stackoverflow.com/questions/30068501/finding-start-date-and-end-date-for-same-value-using-vba/30072005#30072005", "title": "Finding Start date and End date for same value using vba", "body": "<p>If you are too lazy to come up with a VBA code on your own try having a pivot do it. Have a data table.</p>\n\n<pre><code>Row# | Date       |Task | Date2\n-----+------------+-----+----------------\n1    | 2015-04-01 | ABC | =A2 [2015-04-01]\n2    | 2015-04-02 | ABC | \n3    | 2015-04-05 | 123 | \n4    | 2015-04-01 | 123 | \n5    | 2015-04-04 | ABC | \n6    | 2015-04-01 | 123 | \n7    | 2015-04-05 | 123 | \n8    | 2015-04-01 | ABC | \n</code></pre>\n\n<p>The output pivot will look like this:  </p>\n\n<pre><code>Row# | Task | Min / Date | Max / Date2\n-----+------+------------+-------------\n1    | 123  | 2015-04-01 | 2015-04-05\n2    | ABC  | 2015-04-01 | 2015-04-04\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 4890497, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pholU.png?s=128&g=1", "display_name": "luizast", "link": "https://stackoverflow.com/users/4890497/luizast"}, "is_accepted": false, "score": 0, "last_activity_date": 1431420662, "creation_date": 1431420662, "answer_id": 30186023, "question_id": 30068501, "link": "https://stackoverflow.com/questions/30068501/finding-start-date-and-end-date-for-same-value-using-vba/30186023#30186023", "title": "Finding Start date and End date for same value using vba", "body": "<p>The next could be improved, but it works:</p>\n\n<pre><code>Sub Fechas()\n        Dim startDate As Date\n        Dim endDate As Date        \n        Dim selected As String\n        startDate = #1/1/2999#\n        endDate = #1/1/1900#\n        'Item you want to know the start/end dates\n        'So select it before run the macro (i.e. ABC from Task)\n        selected = ActiveCell.Value\n        'Change the Range as you will\n        Range(\"B1\").Select\n        Do While ActiveCell.Value &lt;&gt; Empty\n        If (ActiveCell.Offset(0, 1).Value = selected) Then\n            If ActiveCell.Value &lt; startDate Then startDate = ActiveCell.Value\n            If ActiveCell.Value &gt; endDate Then endDate = ActiveCell.Value\n        Else\n        End If\n        ActiveCell.Offset(1, 0).Select\n        Loop\n        If startDate = endDate Then\n        MsgBox \"For: \" &amp; selected &amp; Chr$(13) &amp; \"Start date: \" &amp; startDate &amp; Chr$(13) &amp; \"Unknown End date/Same Dates\"\n        Else\n        MsgBox \"For: \" &amp; selected &amp; Chr$(13) &amp; \"Start date: \" &amp; startDate &amp; Chr$(13) &amp; \"End Date: \" &amp; endDate\n        End If\n    End Sub\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 4311390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c798d465bb371e4001aad7dea3018e9b?s=128&d=identicon&r=PG&f=1", "display_name": "kavitha", "link": "https://stackoverflow.com/users/4311390/kavitha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 832, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1431420662, "creation_date": 1430891203, "last_edit_date": 1430891918, "question_id": 30068501, "link": "https://stackoverflow.com/questions/30068501/finding-start-date-and-end-date-for-same-value-using-vba", "title": "Finding Start date and End date for same value using vba", "body": "<p>I have an Excel sheet looks like below. I want the start date and end date for a task. Ex: for the <code>ABC</code> task the start date is \"<code>2015-04-01</code>\" and the end date is \"<code>2015-04-04</code>\". How to summarize the dates?</p>\n\n<pre><code>Row# | Date       |Task\n-----+------------+-----\n1    | 2015-04-01 | ABC  \n2    | 2015-04-02 | ABC\n3    | 2015-04-05 | 123\n4    | 2015-04-01 | 123\n5    | 2015-04-04 | ABC\n6    | 2015-04-01 | 123\n7    | 2015-04-05 | 123\n8    | 2015-04-01 | ABC\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1430891977, "creation_date": 1430891977, "answer_id": 30068674, "question_id": 30068354, "link": "https://stackoverflow.com/questions/30068354/selecting-range-of-a-column-dynamically-in-excel/30068674#30068674", "title": "selecting Range of a column dynamically in Excel", "body": "<pre><code>strAddress2 = \"A3:A\" &amp; lastRow\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 3897155, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e6fc777dbccdd3f1e8fb4380337b4729?s=128&d=identicon&r=PG&f=1", "display_name": "mb1987", "link": "https://stackoverflow.com/users/3897155/mb1987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 30068674, "answer_count": 1, "score": 0, "last_activity_date": 1430891977, "creation_date": 1430890601, "question_id": 30068354, "link": "https://stackoverflow.com/questions/30068354/selecting-range-of-a-column-dynamically-in-excel", "title": "selecting Range of a column dynamically in Excel", "body": "<p>I want the name of the workbook to be filled in column A up to the last row where data exist in the worksheet , the code I am using to find the last row where data exist is </p>\n\n<pre><code>lastRow = ActiveSheet.UsedRange.Row - 1 + ActiveSheet.UsedRange.Rows.Count\n</code></pre>\n\n<p>and the code store name upto column A10 is  </p>\n\n<pre><code>Sub testValue()\n\nstrAddress2 = \"A3:A10\"\n\nwbName = ThisWorkbook.Name\n\nRange(strAddress2).Value = Left(wbName, InStrRev(wbName, \".\") - 1)\n\nEnd Sub\n</code></pre>\n\n<p>I want to select the range dynamically with the value stored in variable \"lastRow\" but not sure how to do that</p>\n"}, {"tags": ["excel", "transpose", "vba"], "comments": [{"owner": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "edited": false, "score": 0, "creation_date": 1430890046, "post_id": 30068140, "comment_id": 48250660, "body": "Why not using the &#39;Transpose&#39; function."}, {"owner": {"reputation": 1, "user_id": 4869079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3f5c768b7c35bb7757ffa368ae68ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Will292956", "link": "https://stackoverflow.com/users/4869079/will292956"}, "reply_to_user": {"reputation": 5527, "user_id": 4082955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e670bd7627dcaaceead20dfdc02a7589?s=128&d=identicon&r=PG&f=1", "display_name": "Fratyx", "link": "https://stackoverflow.com/users/4082955/fratyx"}, "edited": false, "score": 0, "creation_date": 1430893625, "post_id": 30068140, "comment_id": 48252261, "body": "If I try to transpose the formulas, it doesn&#39;t actually switch the position of the formulas. It transposes the format, but it for some reason if C55 is in the transposed matrix it will now be =&#39;Table2&#39;!C55 instead of what it should be. I attempted to fix the cells using $ but the outcome was the same."}], "answers": [{"tags": [], "owner": {"reputation": 4362, "user_id": 3890586, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/uk42f.png?s=128&g=1", "display_name": "AnalystCave.com", "link": "https://stackoverflow.com/users/3890586/analystcave-com"}, "is_accepted": false, "score": 1, "last_activity_date": 1430913663, "last_edit_date": 1430913663, "creation_date": 1430898859, "answer_id": 30070717, "question_id": 30068140, "link": "https://stackoverflow.com/questions/30068140/create-a-worksheet-that-automatically-updates-a-transposed-version-of-another/30070717#30070717", "title": "Create a worksheet that automatically updates a transposed version of another", "body": "<p>Use <strong>this formula</strong>:</p>\n\n<pre><code>=OFFSET(Sheet1!$A$1;COLUMN()-1; ROW()-1)\n</code></pre>\n\n<p><strong>Or this Array Formula</strong> (<kbd>CTRL</kbd>+<kbd>SHIFT</kbd>+<kbd>ENTER</kbd>):</p>\n\n<pre><code>= TRANSPOSE(Sheet1!A1:Z100)\n</code></pre>\n\n<p>(Change range appropriately)</p>\n"}], "owner": {"reputation": 1, "user_id": 4869079, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3f5c768b7c35bb7757ffa368ae68ed4?s=128&d=identicon&r=PG&f=1", "display_name": "Will292956", "link": "https://stackoverflow.com/users/4869079/will292956"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 836, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430913785, "creation_date": 1430889615, "last_edit_date": 1531161705, "question_id": 30068140, "link": "https://stackoverflow.com/questions/30068140/create-a-worksheet-that-automatically-updates-a-transposed-version-of-another", "title": "Create a worksheet that automatically updates a transposed version of another", "body": "<p>I am trying to transpose matrix from one Excel sheet into another and have that new Excel matrix automatically updated when the original is changed.\nI am trying to make it look like this in the new worksheet:</p>\n\n<pre><code>='Table 2'!A1 ='Table 2'!A2 ='Table 2'!A3 ='Table 2'!A4 \n\n='Table 2'!B1 ='Table 2'!B2 ='Table 2'!B3 ='Table 2'!B4 \n\n='Table 2'!C1 ='Table 2'!C1 ='Table 2'!C3 ='Table 2'!C4\n</code></pre>\n\n<p>I tried to make a macro but i cant figure it out. </p>\n"}, {"tags": ["vba", "excel", "installshield"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430886449, "post_id": 30067305, "comment_id": 48249506, "body": "Did you register the .dll and .tlb in the installer?"}, {"owner": {"reputation": 6481, "user_id": 848841, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7e26d050149199473393bafed79491d9?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Subramanian", "link": "https://stackoverflow.com/users/848841/vignesh-subramanian"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430886533, "post_id": 30067305, "comment_id": 48249544, "body": "No I have only selected and added the .dll and .tlb files how to register them?"}, {"owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "edited": false, "score": 0, "creation_date": 1430886588, "post_id": 30067305, "comment_id": 48249553, "body": "Does your installer run <code>RegAsm</code> for the dll?"}, {"owner": {"reputation": 6481, "user_id": 848841, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7e26d050149199473393bafed79491d9?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Subramanian", "link": "https://stackoverflow.com/users/848841/vignesh-subramanian"}, "reply_to_user": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "edited": false, "score": 0, "creation_date": 1430886638, "post_id": 30067305, "comment_id": 48249566, "body": "@dePatinkin No can we make it register the dll and tlb files after installing?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1430886684, "post_id": 30067305, "comment_id": 48249581, "body": "<a href=\"http://stackoverflow.com/questions/5665068/register-a-com-object-using-installshield\">Register a COM object using InstallShield</a> might be relevant.  Basically regasm and regsvr32, but I haven&#39;t used Installshield in years."}], "answers": [{"comments": [{"owner": {"reputation": 6481, "user_id": 848841, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7e26d050149199473393bafed79491d9?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Subramanian", "link": "https://stackoverflow.com/users/848841/vignesh-subramanian"}, "edited": false, "score": 0, "creation_date": 1431092051, "post_id": 30075457, "comment_id": 48359937, "body": "I am still facing some issues in the installer  :(  <a href=\"http://stackoverflow.com/questions/30123731/what-are-the-files-to-be-included-in-installshield-for-excel-add-in-com-object?noredirect=1#comment48359552_30123731\" title=\"what are the files to be included in installshield for excel add in com object\">stackoverflow.com/questions/30123731/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2039, "user_id": 3848861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhEKB.png?s=128&g=1", "display_name": "dePatinkin", "link": "https://stackoverflow.com/users/3848861/depatinkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1430911865, "creation_date": 1430911865, "answer_id": 30075457, "question_id": 30067305, "link": "https://stackoverflow.com/questions/30067305/dll-not-appearing-in-references-for-vba-after-installing-using-install-shield/30075457#30075457", "title": "Dll not appearing in references for VBA after installing using install shield", "body": "<p>This article gives you description of two methods to do the registration with Installshield: <a href=\"http://www.iwasdot.com/installshield-execute-a-batch-script/\" rel=\"nofollow\">Installshield Register.Net DLLs</a>. </p>\n\n<p>I definitely recommend <strong>Approach 2 - Run a .bat file to register the files</strong>. This approach runs the RegAsm for the install and uninstall processes using a batch file. This will give you control over the registration process, where you know exactly what is done, and you can handle all bitness scenarios 32/64/Wow64. In Approach 1 you don't, as stated in the article:</p>\n\n<blockquote>\n  <p>For some reason, perhaps that I am installing a 32bit component on a 64bit machine, this didn\u2019t work as expected. [...] some DLL\u2019s perform post registration actions the run when you run RegAsm.exe VirtualCam.dll /nologo /codebase but don\u2019t get captured when you run RegAsm.exe VirtualCam.dll /nologo /codebase /regfile</p>\n</blockquote>\n\n<p>If possible I would recommend switching to a different installation package creator, that supports run operations and gives better control over the process than using a batch.</p>\n\n<p>*As it's not a native COM dll but a dotNet dll exposed to COM, there's no need for regsvr32 registration.</p>\n"}], "owner": {"reputation": 6481, "user_id": 848841, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7e26d050149199473393bafed79491d9?s=128&d=identicon&r=PG&f=1", "display_name": "Vignesh Subramanian", "link": "https://stackoverflow.com/users/848841/vignesh-subramanian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430913396, "creation_date": 1430885102, "last_edit_date": 1430913396, "question_id": 30067305, "link": "https://stackoverflow.com/questions/30067305/dll-not-appearing-in-references-for-vba-after-installing-using-install-shield", "title": "Dll not appearing in references for VBA after installing using install shield", "body": "<p>I created an install shield project for an Excel add-in.</p>\n\n<p>I selected <code>.dll</code> file and the <code>.tlb</code> file to be moved to the <code>GAC</code> (in destination folder) and program files folder</p>\n\n<p><img src=\"https://i.stack.imgur.com/oV8q1.png\" alt=\"enter image description here\"></p>\n\n<p>Those files are present in the program files folder</p>\n\n<p>But when I go to Excel, click on tools-> reference, they are not appearing in that list!</p>\n\n<p>I had to manually browse to the location of that <code>.tlb</code> file and select it</p>\n\n<p>What change should i make so that it automatically comes in the references list</p>\n"}, {"tags": ["arrays", "vba", "excel"], "comments": [{"owner": {"reputation": 18474, "user_id": 2685412, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/8dPd0.jpg?s=128&g=1", "display_name": "L42", "link": "https://stackoverflow.com/users/2685412/l42"}, "edited": false, "score": 1, "creation_date": 1430883636, "post_id": 30066775, "comment_id": 48248650, "body": "AFAIK, there is no direct way to do this for 2D arrays. So you&#39;ll really have to loop through the elements of the array and compare them."}], "answers": [{"comments": [{"owner": {"reputation": 257, "user_id": 3927307, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e898f281113191bd76a441cda90aee38?s=128&d=identicon&r=PG&f=1", "display_name": "tony", "link": "https://stackoverflow.com/users/3927307/tony"}, "edited": false, "score": 0, "creation_date": 1430906855, "post_id": 30067221, "comment_id": 48260781, "body": "Thanks! This solutin does work. Just had one clarification that I should of made. Using the arrays defined as you have for MyArr1 and MyArr2 it works, but my arrays are actually 2d arrays that were intialized as: <code>MyArr1 = Worksheets(1).Range(&quot;a1:f5&quot;).Value</code> - in this case seems that every row matches regardless of content in range fo cells?"}, {"owner": {"reputation": 257, "user_id": 3927307, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e898f281113191bd76a441cda90aee38?s=128&d=identicon&r=PG&f=1", "display_name": "tony", "link": "https://stackoverflow.com/users/3927307/tony"}, "edited": false, "score": 0, "creation_date": 1430913881, "post_id": 30067221, "comment_id": 48265604, "body": "Update on error. seems to be a <b>Run Time error 13: type mismatch</b> that is occuring at the if condition when comparing : If Join(Application.Transpose(Application...)) Also I am only reading in around 100 rows. Saw some other posts mention it could have limitations for large number of rows but dont think that&#39;s the issue in my case"}, {"owner": {"reputation": 257, "user_id": 3927307, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e898f281113191bd76a441cda90aee38?s=128&d=identicon&r=PG&f=1", "display_name": "tony", "link": "https://stackoverflow.com/users/3927307/tony"}, "edited": false, "score": 0, "creation_date": 1430926919, "post_id": 30067221, "comment_id": 48276130, "body": "Well found that my issue was that one particular cell seemed to contain too much text. Deleted that cell as It was not needed for my compare, and seemed to work."}, {"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "reply_to_user": {"reputation": 257, "user_id": 3927307, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e898f281113191bd76a441cda90aee38?s=128&d=identicon&r=PG&f=1", "display_name": "tony", "link": "https://stackoverflow.com/users/3927307/tony"}, "edited": false, "score": 0, "creation_date": 1430951364, "post_id": 30067221, "comment_id": 48290602, "body": "Excellent news, glad we could help :)."}], "tags": [], "owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "is_accepted": true, "score": 3, "last_activity_date": 1430888569, "last_edit_date": 1430888569, "creation_date": 1430884569, "answer_id": 30067221, "question_id": 30066775, "link": "https://stackoverflow.com/questions/30066775/comparing-2-dimension-arrays-in-vb-excel/30067221#30067221", "title": "Comparing 2-dimension arrays in VB Excel", "body": "<p>Here is an example of how to loop and compare the elements of a 2D array:</p>\n\n<pre><code>Sub ArrayCompare()\nDim MyArr1 As Variant, MyArr2 As Variant, X as long, Y as long\nMyArr1 = [{1,2,3,4;4,5,6,2;3,3,4,4}]: MyArr2 = [{4,5,3,2;1,2,3,4;3,7,7,5}]\nFor X = LBound(MyArr1) To UBound(MyArr1)\n    For Y = LBound(MyArr1, 1) To UBound(MyArr1, 1)\n        If MyArr1(X, Y) = MyArr2(X, Y) Then MsgBox X &amp; \":\" &amp; Y &amp; \":\" &amp; MyArr1(X, Y)\n    Next\nNext\nEnd Sub\n</code></pre>\n\n<p>Here is my updated code to compare each row as a string (Thanks @Tim Williams :)):</p>\n\n<pre><code>Sub ArrayCompare()\nDim MyArr1 As Variant, MyArr2 As Variant, X As Long, Y As Long\nMyArr1 = [{1,2,3,4;4,5,6,2;3,3,4,4}]: MyArr2 = [{4,5,3,2;1,2,3,4;3,7,7,5}]\nFor X = LBound(MyArr1) To UBound(MyArr1)\n    For Y = LBound(MyArr2) To UBound(MyArr2)\n        If Join(Application.Transpose(Application.Transpose(Application.Index(MyArr1, X, 0))), \"|\") = Join(Application.Transpose(Application.Transpose(Application.Index(MyArr2, Y, 0))), \"|\") Then MsgBox \"Found a match at MyArr1 index:\" &amp; X &amp; \" and MyArr2 index:\" &amp; Y\n    Next\nNext\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 0, "creation_date": 1430886663, "post_id": 30067546, "comment_id": 48249573, "body": "Transpose of course, I was trying to do this and couldn&#39;t get it working :)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 5583, "user_id": 4556996, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/amIjI.jpg?s=128&g=1", "display_name": "Dan Donoghue", "link": "https://stackoverflow.com/users/4556996/dan-donoghue"}, "edited": false, "score": 1, "creation_date": 1430886788, "post_id": 30067546, "comment_id": 48249621, "body": "I just keep Transposing until it comes out right ;-)"}, {"owner": {"reputation": 257, "user_id": 3927307, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e898f281113191bd76a441cda90aee38?s=128&d=identicon&r=PG&f=1", "display_name": "tony", "link": "https://stackoverflow.com/users/3927307/tony"}, "edited": false, "score": 0, "creation_date": 1430914273, "post_id": 30067546, "comment_id": 48265919, "body": "thanks for input on this. Have any suggestions on dealing with <b>Run Time error 13: type mismatch</b> which is occuring at Application.Index()? (Array only contains around 100 rows)"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1430923597, "post_id": 30067546, "comment_id": 48273447, "body": "If you can update your question with the code which is giving you problems it would be easier to suggest something.  Without that I&#39;d guess you have declared a variable as a wrong type."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 2, "last_activity_date": 1430886502, "creation_date": 1430886502, "answer_id": 30067546, "question_id": 30066775, "link": "https://stackoverflow.com/questions/30066775/comparing-2-dimension-arrays-in-vb-excel/30067546#30067546", "title": "Comparing 2-dimension arrays in VB Excel", "body": "<p>If you really want to avoid loops then you use this approach to extract a single \"row\" out of your 2-d array for comparison purposes, but it might be faster to loop.</p>\n\n<pre><code>Sub Tester()\n\n    Dim arr, rw\n\n    arr = Range(\"A1:J10\").Value 'get 2-d array from worksheet\n\n    'get a 1-d array \"row\" out of the 2-d array\n    rw = Application.Transpose( _\n         Application.Transpose(Application.Index(arr, 1, 0)))\n\n    'then you can (eg) create a string for comparison purposes\n    Debug.Print Join(rw, Chr(0))\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 257, "user_id": 3927307, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e898f281113191bd76a441cda90aee38?s=128&d=identicon&r=PG&f=1", "display_name": "tony", "link": "https://stackoverflow.com/users/3927307/tony"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5421, "favorite_count": 0, "accepted_answer_id": 30067221, "answer_count": 2, "score": 1, "last_activity_date": 1430888569, "creation_date": 1430881715, "question_id": 30066775, "link": "https://stackoverflow.com/questions/30066775/comparing-2-dimension-arrays-in-vb-excel", "title": "Comparing 2-dimension arrays in VB Excel", "body": "<p>I'm trying to compare two 2d arrays in VBA Excel.</p>\n\n<p><strong>Source:</strong></p>\n\n<p>1 2 3 4</p>\n\n<p>4 5 6 2</p>\n\n<p>3 3 4 4</p>\n\n<p><strong>Target:</strong></p>\n\n<p>4 5 3 2</p>\n\n<p>1 2 3 4</p>\n\n<p>3 7 7 5</p>\n\n<p>Given the above two 2-d arrays which I will call source and target I want to compare each row from source with entire target and check if it exists in target. For\nExample row 1 from source (1 2 3 4) would be considered a match as it would found in target (at row 2). So I need to compare each row in target for a given row from source. If row in source does not exist in target then I will need to make note of this some how in order to mark as not existing in target.</p>\n\n<p>Something on the lines of (not actual code just idea):</p>\n\n<pre><code>For i to ubound(srcArray)\n    isFound = False\n    For j To ubound(trgArray)\n        If srcArray(i) = trgArray(j) Then\n            isFound = True\n\n    If Not isFound Then\n        //make note of some sort\n</code></pre>\n\n<p>I know approach worked ok for single dim. array. But trying to do this for 2d arrays in some sort of loop in VB or other method. Not too familiar with VB in Excel. I would also like to look at each row as entire array if possible rather than comparing each element for each array individually.</p>\n"}, {"tags": ["excel", "vba", "comparison"], "comments": [{"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430883047, "post_id": 30066702, "comment_id": 48248508, "body": "I just found out that ALL the data in <code>Sheets(&quot;JULY15Release_Dev status&quot;)</code> can be found in <code>Sheets(&quot;JULY15Release_Master Inventory&quot;)</code>, so maybe the comparison part can be ignored. Only rows with an &quot;eRequest ID&quot; <b>NOT FOUND IN</b> <code>Sheets(&quot;JULY15Release_Master Inventory)</code> needs to be copied over to <code>Sheets(&quot;Mismatch&quot;). Also, by editing the above code, I managed to copy the rows that are only found in </code>Sheets(&quot;JULY15Release_Dev status&quot;)`  but some rows in <code>Sheets(&quot;JULY15Release_Master Inventory)</code>  are copied along as well.. Hope this helps, thanks in advance!"}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430892364, "post_id": 30068058, "comment_id": 48251685, "body": "Hey there, I cant add another column as there is some format with my table.. Is there another way to do this without adding a new column? @Vasily answer seems pretty close, but it is still copying the wrong rows. Perhaps you can figure this out? Thank you!"}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430900558, "post_id": 30068058, "comment_id": 48256499, "body": "Hey there, thanks for helping out. I&#39;m getting a subscript out of range error however, on this line <code>p = Application.Match(Sheets(&quot;JULY15Release_Dev status&quot;).Range(&quot;A&quot; &amp; j).Value, Sheets(&quot;Sheet1&quot;).Range(&quot;A1&quot; &amp; &quot;:&quot; &amp; &quot;A&quot; &amp; lrow1), 0)</code> Would you fix it and get back to me? Really thankful :)"}, {"owner": {"reputation": 640, "user_id": 1249645, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d493682b92e96e45bb40e04927227399?s=128&d=identicon&r=PG", "display_name": "Punith GP", "link": "https://stackoverflow.com/users/1249645/punith-gp"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430900747, "post_id": 30068058, "comment_id": 48256599, "body": "Replace Sheet1 with your sheet name. replace Sheet1 = &#39;JULY15Release_Dev status&#39; and sheet2 = &#39;JULY15Release_Master Inventory&#39; however you need"}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430900910, "post_id": 30068058, "comment_id": 48256714, "body": "I just changed the Sheet names accordingly, but when I run the code nothings happening"}, {"owner": {"reputation": 640, "user_id": 1249645, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d493682b92e96e45bb40e04927227399?s=128&d=identicon&r=PG", "display_name": "Punith GP", "link": "https://stackoverflow.com/users/1249645/punith-gp"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430901024, "post_id": 30068058, "comment_id": 48256779, "body": "It is working for me, you might need to trace at each step, where it is going wrong for you"}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430901379, "post_id": 30068058, "comment_id": 48257008, "body": "what do you mean by &quot;trace&quot;? Sorry i&#39;m a total novice at this I dont really get some of the jargons used here. Btw, I mentioned I couldn&#39;t add another column due to my file&#39;s nature.. Would that be a problem? If so, can we work another way around this?"}, {"owner": {"reputation": 640, "user_id": 1249645, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d493682b92e96e45bb40e04927227399?s=128&d=identicon&r=PG", "display_name": "Punith GP", "link": "https://stackoverflow.com/users/1249645/punith-gp"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430902269, "post_id": 30068058, "comment_id": 48257626, "body": "press F8 on and see the result, however just try the edited code with your sheet names."}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430903787, "post_id": 30068058, "comment_id": 48258661, "body": "I just tried the edited code, its working without error but nothing&#39;s happening. I tried tracing, but it kept repeating at the <b>first for loop</b>, not moving onwards. Thanks for your help!"}], "tags": [], "owner": {"reputation": 640, "user_id": 1249645, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/d493682b92e96e45bb40e04927227399?s=128&d=identicon&r=PG", "display_name": "Punith GP", "link": "https://stackoverflow.com/users/1249645/punith-gp"}, "is_accepted": false, "score": 0, "last_activity_date": 1430902246, "last_edit_date": 1430902246, "creation_date": 1430889184, "answer_id": 30068058, "question_id": 30066702, "link": "https://stackoverflow.com/questions/30066702/vba-excel-copy-rows-based-on-column/30068058#30068058", "title": "VBA Excel copy rows based on column", "body": "<p>Try this, it should work, <strong>TESTED</strong>.  </p>\n\n<pre><code>Sub test()\n\nDim lrow1 As Long\nDim lrow2 As Long\nDim i As Long\nDim K As Long\nDim j As Long\nDim p As Variant\nDim wb As Workbook\n\nSet wb = ThisWorkbook\nK = 2\nlrow1 = wb.Sheets(\"JULY15Release_Master Inventory\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\nlrow2 = wb.Sheets(\"JULY15Release_Dev status\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\nFor i = 1 To lrow1\n\np = Application.Match(wb.Sheets(\"JULY15Release_Master Inventory\").Range(\"A\" &amp; i).Value, wb.Sheets(\"JULY15Release_Dev status\").Range(\"A1\" &amp; \":\" &amp; \"A\" &amp; lrow2), 0)\nIf IsError(p) Then\n        wb.Sheets(\"JULY15Release_Master Inventory\").Rows(i).Copy Destination:=Sheets(\"Mismatch\").Rows(K)\n        K = K + 1\nEnd If\nNext\n\nFor j = 1 To lrow2\np = Application.Match(wb.Sheets(\"JULY15Release_Dev status\").Range(\"A\" &amp; j).Value, wb.Sheets(\"JULY15Release_Master Inventory\").Range(\"A1\" &amp; \":\" &amp; \"A\" &amp; lrow1), 0)\nIf IsError(p) Then\n        wb.Sheets(\"JULY15Release_Dev status\").Rows(j).Copy Destination:=Sheets(\"Mismatch\").Rows(K)\n        K = K + 1\nEnd If\nNext\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430891826, "post_id": 30068121, "comment_id": 48251435, "body": "Hey there! Thanks for your help, the code is working fine and all, copying data from both worksheets. However, it is still copying the rows with data that has &quot;eRequest ID&quot; on both worksheets. I need the rows that only have an &quot;eRequest ID&quot; on <b>EITHER WORKSHEET*. Perhaps it has something to do with the **Range values</b>? I&#39;m not sure, I&#39;m a total beginner at this. Could you help me out? Thank you very much!"}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430894413, "post_id": 30068121, "comment_id": 48252736, "body": "@JunJie could you please provide data sample?"}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430894745, "post_id": 30068121, "comment_id": 48252893, "body": "Sure thing, how do I do it though? Not sure how things work around here.. Is there a feature that let me share files with you??"}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430894821, "post_id": 30068121, "comment_id": 48252949, "body": "@JunJie post has been updated, please recheck again, I think that problem was in case when <code>&quot;A&quot; = &quot;a&quot;</code> not matched due to Upper case not equal lower case"}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430895032, "post_id": 30068121, "comment_id": 48253061, "body": "I just tried the edited code.. It makes no difference though, is there any way I can share the files with you?"}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430895501, "post_id": 30068121, "comment_id": 48253337, "body": "@JunJie  please see my updated post with screenshots, is this what you trying to achieve?"}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430895959, "post_id": 30068121, "comment_id": 48253624, "body": "I took two pictures.. the links are <a href=\"http://imgur.com/S9lwigG\" rel=\"nofollow noreferrer\">this</a> and <a href=\"http://imgur.com/cxPctGS\" rel=\"nofollow noreferrer\">this</a> these two pictures show my <b>Inventory</b> and <b>Release</b> worksheets. I need to copy the records that have an &quot;eRequest ID&quot; <b>IN EITHER WORKSHEETS NOT BOTH</b>. For example, the record with &quot;eRequest ID of 41275 exists in both worksheets, therefore i dont need to copy it."}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430897340, "post_id": 30068121, "comment_id": 48254513, "body": "i tried that earlier on, but when I run the code nothing happens."}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430897529, "post_id": 30068121, "comment_id": 48254621, "body": "@JunJie as per your screenshots I see that criterias for matching in column &quot;A&quot; for both sheets, so the range in code has been updated, please recheck again."}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430897784, "post_id": 30068121, "comment_id": 48254791, "body": "Yup, I copied the edited codes over, but when I run it nothing is happening."}, {"owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "reply_to_user": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430898723, "post_id": 30068121, "comment_id": 48255396, "body": "@JunJie please share your file with google drive or using another resource"}, {"owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "edited": false, "score": 0, "creation_date": 1430899922, "post_id": 30068121, "comment_id": 48256093, "body": "I&#39;m sorry but the company I&#39;m working for is very strict with their files.. We are blocked from google drive, dropbox, social media platforms and similar websites. The files would also be encrypted if i were to remove it and I don&#39;t have permission to do so as I&#39;m only an intern. Is there another way we can do this? Sorry to bother you but I really need to get this done. Thank you!"}], "tags": [], "owner": {"reputation": 5367, "user_id": 4230409, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zTBBm.jpg?s=128&g=1", "display_name": "Vasily Ivoyzha", "link": "https://stackoverflow.com/users/4230409/vasily-ivoyzha"}, "is_accepted": false, "score": 0, "last_activity_date": 1430897282, "last_edit_date": 1430897282, "creation_date": 1430889532, "answer_id": 30068121, "question_id": 30066702, "link": "https://stackoverflow.com/questions/30066702/vba-excel-copy-rows-based-on-column/30068121#30068121", "title": "VBA Excel copy rows based on column", "body": "<p>another one variant</p>\n\n<pre><code>    Sub test()\n    Dim lastRowE&amp;, lastRowF&amp;, lastRowM&amp;, Key As Variant\n    Dim Cle As Range, Clf As Range\n    Dim DicInv As Object: Set DicInv = CreateObject(\"Scripting.Dictionary\")\n    Dim DicDev As Object: Set DicDev = CreateObject(\"Scripting.Dictionary\")\n\n    Application.ScreenUpdating = 0\n\n    lastRowE = Sheets(\"JULY15Release_Master Inventory\").Cells(Rows.Count, \"A\").End(xlUp).Row\n    lastRowF = Sheets(\"JULY15Release_Dev status\").Cells(Rows.Count, \"A\").End(xlUp).Row\n    lastRowM = Sheets(\"Mismatch\").Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    'add into dictionary row number from Inventory where cell is matched\n    For Each Cle In Sheets(\"JULY15Release_Master Inventory\").Range(\"A1:A\" &amp; lastRowE)\n        If Cle.Value &lt;&gt; \"\" Then\n            For Each Clf In Sheets(\"JULY15Release_Dev status\").Range(\"A1:A\" &amp; lastRowF)\n                If UCase(Cle.Value) = UCase(Clf.Value) Then DicInv.Add Cle.Row, \"\"\n            Next Clf\n        End If\n    Next Cle\n    'add into dictionary row number from Dev where cell is matched\n    For Each Clf In Sheets(\"JULY15Release_Dev status\").Range(\"A1:A\" &amp; lastRowF)\n        If Clf.Value &lt;&gt; \"\" Then\n            For Each Cle In Sheets(\"JULY15Release_Master Inventory\").Range(\"A1:A\" &amp; lastRowE)\n                If UCase(Clf.Value) = UCase(Cle.Value) Then DicDev.Add Clf.Row, \"\"\n            Next Cle\n        End If\n    Next Clf\n    'Get mismatch from Inventory\n    With Sheets(\"JULY15Release_Master Inventory\")\n        For Each Cle In .Range(\"A1:A\" &amp; lastRowE)\n            If Not DicInv.exists(Cle.Row) And Cle.Value &lt;&gt; \"\" Then\n                .Rows(Cle.Row).Copy Sheets(\"Mismatch\").Rows(lastRowM)\n                lastRowM = lastRowM + 1\n            End If\n        Next Cle\n    End With\n    'Get mismatch from Dev\n    With Sheets(\"JULY15Release_Dev status\")\n        For Each Clf In .Range(\"A1:A\" &amp; lastRowF)\n            If Not DicDev.exists(Clf.Row) And Clf.Value &lt;&gt; \"\" Then\n                .Rows(Clf.Row).Copy Sheets(\"Mismatch\").Rows(lastRowM)\n                lastRowM = lastRowM + 1\n            End If\n        Next Clf\n    End With\n\n    Application.ScreenUpdating = 1\n\n    End Sub\n</code></pre>\n\n<p><strong>Sample</strong></p>\n\n<p><code>JULY15Release_Master Inventory</code></p>\n\n<p><img src=\"https://i.stack.imgur.com/ZIJ4z.jpg\" alt=\"enter image description here\"></p>\n\n<p><code>JULY15Release_Dev status</code></p>\n\n<p><img src=\"https://i.stack.imgur.com/YBo9h.jpg\" alt=\"enter image description here\"></p>\n\n<p><strong>Output Result</strong></p>\n\n<p><code>Mismatch</code></p>\n\n<p><img src=\"https://i.stack.imgur.com/yQaCx.jpg\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 139, "user_id": 4794395, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/695a62e2322e37cebb5f4e0dbffd4c24?s=128&d=identicon&r=PG&f=1", "display_name": "Jun Jie", "link": "https://stackoverflow.com/users/4794395/jun-jie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 509, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1430902246, "creation_date": 1430881309, "last_edit_date": 1495541657, "question_id": 30066702, "link": "https://stackoverflow.com/questions/30066702/vba-excel-copy-rows-based-on-column", "title": "VBA Excel copy rows based on column", "body": "<p>I'm trying to create a macro which copies rows of data after comparing a column value. I previously asked this <a href=\"https://stackoverflow.com/questions/30050485/excel-vba-compare-column-data-copy-row\">question</a> but made some progress, and thought it would be less confusing if i posted another question. The column to be compared is \"eRequest ID\" and it consists of integers and text. </p>\n\n<p>I have two worksheets, both with \"eRequest ID\" as the first column. The goal here is to copy <strong>ANY</strong> rows of data that has an \"eRequest ID\" <strong>NOT FOUND</strong> in both worksheets. Meaning if this record's \"eRequest ID\" is only found on one worksheet and not both, the whole row of data has to be copied into a third new worksheet.</p>\n\n<p>I have worked out some codes after browsing through the net, and with the help of the coding experts here. The problem with this codes is that somehow I get a \"mismatch\" for every row. I tried changing the <code>foundTrue</code> value here and there but it doesn't seem to work. I need it to only copy rows of data with only <strong>1 \"eRequest ID\"</strong> on either worksheet. Greatful for any help and appreciate your effort!</p>\n\n<pre><code>Sub compareAndCopy()\n\nDim lastRowE As Integer\nDim lastRowF As Integer \nDim lastRowM As Integer\nDim foundTrue As Boolean\n\nApplication.ScreenUpdating = False\n\nlastRowE = Sheets(\"JULY15Release_Master Inventory\").Cells(Sheets(\"JULY15Release_Master Inventory\").Rows.Count, \"A\").End(xlUp).Row\nlastRowF = Sheets(\"JULY15Release_Dev status\").Cells(Sheets(\"JULY15Release_Dev status\").Rows.Count, \"A\").End(xlUp).Row\nlastRowM = Sheets(\"Mismatch\").Cells(Sheets(\"Mismatch\").Rows.Count, \"A\").End(xlUp).Row\n\nFor i = 1 To lastRowE\nfoundTrue = True\nFor j = 1 To lastRowF\n\n'If Sheets(\"JULY15Release_Master Inventory\").Cells(i, 2).Value = Sheets(\"JULY15Release_Dev status\").Cells(j, 7).Value Then\n If Sheets(\"JULY15Release_Master Inventory\").Cells(i, 2).Value &lt;&gt; Sheets(\"JULY15Release_Dev status\").Cells(j, 7).Value Then\n    foundTrue = False\n    Exit For\nEnd If\n\nNext j\n\nIf foundTrue Then\nSheets(\"JULY15Release_Dev status\").Rows(i).Copy Destination:= _\nSheets(\"Mismatch\").Rows(lastRowM + 1)\nlastRowM = lastRowM + 1\n\nEnd If\n\n\nNext i\n\nApplication.ScreenUpdating = False\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1430875011, "post_id": 30065814, "comment_id": 48246499, "body": "This formula is a mess and you should think about paring it down (and this is language agnostic advice)."}, {"owner": {"reputation": 1, "user_id": 4868620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f61dfff4465d41db5a1a4e7ebce69f6?s=128&d=identicon&r=PG&f=1", "display_name": "wingfield", "link": "https://stackoverflow.com/users/4868620/wingfield"}, "reply_to_user": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1430875535, "post_id": 30065814, "comment_id": 48246637, "body": "I&#39;m happy to do that.  do you have any guidance on what that might look like?  would I somehow split it into more than one piece?  I realize it&#39;s a long formula.  it&#39;s basically an if statement, with another nested if statement inside."}, {"owner": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 0, "creation_date": 1430875735, "post_id": 30065814, "comment_id": 48246694, "body": "Can you assign the inner <code>IF</code> statement to a separate variable?  This will also make it much easier to debug."}, {"owner": {"reputation": 1, "user_id": 4868620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f61dfff4465d41db5a1a4e7ebce69f6?s=128&d=identicon&r=PG&f=1", "display_name": "wingfield", "link": "https://stackoverflow.com/users/4868620/wingfield"}, "reply_to_user": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 2, "creation_date": 1430876603, "post_id": 30065814, "comment_id": 48246897, "body": "I&#39;ll give that a try.  I guess I could also extract the nested if statement, and get it to work first; but I think that&#39;s effectively what you&#39;re saying to do."}, {"owner": {"reputation": 381798, "user_id": 1863229, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/4sh1l.png?s=128&g=1", "display_name": "Tim Biegeleisen", "link": "https://stackoverflow.com/users/1863229/tim-biegeleisen"}, "edited": false, "score": 1, "creation_date": 1430876678, "post_id": 30065814, "comment_id": 48246905, "body": "Separate each piece and test them individually, then bring them together in one formula if you really want to do that."}], "answers": [{"tags": [], "owner": {"reputation": 571, "user_id": 4479888, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/dd43c6c7f3571cafaaa827796006d0a9?s=128&d=identicon&r=PG&f=1", "display_name": "JMichael", "link": "https://stackoverflow.com/users/4479888/jmichael"}, "is_accepted": false, "score": 0, "last_activity_date": 1436451870, "last_edit_date": 1436451870, "creation_date": 1435860484, "answer_id": 31191661, "question_id": 30065814, "link": "https://stackoverflow.com/questions/30065814/sql-syntax-error-in-excel-formula/31191661#31191661", "title": "SQL syntax error in excel formula", "body": "<p>Not sure why your title mentions SQL, there is none in your formula.</p>\n\n<p>That aside, I wasn't sure if you ever figured this out, but the issue looks to be a mismatch in parentheses, specifically you need an additional closing paren at the end of the formula.</p>\n\n<p>This formula is fairly messy though so I may have missed something else. That does get to another point though after having spent about 30 minutes trying to clean it up to be more readable I had to throw in the towel. So I would strongly suggest either:</p>\n\n<ul>\n<li>Moving the IF logic into your macro code and just determine the value there and then hard set it (i.e. set the cell's <code>.Value</code> instead of <code>.Formula</code>)</li>\n<li>Fill in a working version of the formula in a throw away cell somewhere in your workbook, and then just use copy paste to apply the formula where it's actually needed</li>\n</ul>\n\n<p>Since I don't have any context on what the formula is for and what else the macro is doing I can't tell which would be better in this case. However, either is better than trying to use what you have.</p>\n\n<p>There are a couple things I'll suggest as ways to make setting formulas from VBA cleaner and easier to read though for future use.\n1) You have a lot of places where you need a \" to appear in the formula. For readability sake I've found it's best to declare a variable and set it to \", like so:</p>\n\n<pre><code>Dim dq as string\ndq = chr(34) 'chr 34 is the unicode value for \"\n</code></pre>\n\n<p>2) Since we're using VBA code to fill in a formula, using <code>&amp;</code> in place of using the <code>CONCATENATE</code> formula makes things hard to follow (is that a concatenate for the VBA or for the formula?). So you should only use <code>&amp;</code> for VBA concatenation and use <code>CONCATENATE</code> inside the actual formula string. </p>\n"}], "owner": {"reputation": 1, "user_id": 4868620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f61dfff4465d41db5a1a4e7ebce69f6?s=128&d=identicon&r=PG&f=1", "display_name": "wingfield", "link": "https://stackoverflow.com/users/4868620/wingfield"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436451870, "creation_date": 1430874615, "last_edit_date": 1430874971, "question_id": 30065814, "link": "https://stackoverflow.com/questions/30065814/sql-syntax-error-in-excel-formula", "title": "SQL syntax error in excel formula", "body": "<p>I've got a VBA formula that is causing my excel macro to not run.  it gives a syntax error; but no specifics.  can anyone take a look and see what my issue might be?  I would appreciate it.</p>\n\n<p>thank you.</p>\n\n<pre><code>ActiveCell.FormulaR1C1 = \"=IF(\nRC[-14]=RC[-11],RC[-14]&amp;\"\" is Head of Household\nat \"\"&amp;IF(RC[-6]=\"\"\"\",RC[-9]&amp;\"\",\n    \"\"&amp;RC[-8]&amp;\"\",\"\"&amp;RC[-7],RC[-6]&amp;\"\",\"\"&amp;RC[-9]&amp;\"\",\"\"&amp;RC[-8]&amp;\"\",\"\"&amp;RC[-7]),\nIF(RC[-12]=\"\"Cen-Head\"\",\"\"Head of Household at\n \"\"&amp;IF(RC[-6]=\"\"\"\",RC[-9]&amp;\"\",\n\"\"&amp;RC[-8]&amp;\"\",\"\"&amp;RC[-7],RC[-6]&amp;\"\",\n\"\"&amp;RC[-9]&amp;\"\",\"\"&amp;RC[-8]&amp;\"\",\"\"&amp;RC[-7]),\n\"\"Enumerated with \"\"\n&amp;IF(RC[-6]=\"\"\"\",(RC[-14]&amp;\"\" at\n\"\"&amp;RC[-9]&amp;\"\",\"\"&amp;RC[-8]&amp;\"\",\"\"&amp;RC[-7]),\n(RC[-14]&amp;\"\" at \"\"&amp;RC[-6]&amp;\"\",\"\"&amp;RC[-9]&amp;\"\",\"\"&amp;RC[-8]&amp;\"\",\"\"&amp;RC[-7]))\n)\"\n</code></pre>\n"}, {"tags": ["sql-server", "ms-access", "vba", "odbc", "ms-access-2007"], "answers": [{"tags": [], "owner": {"reputation": 1561, "user_id": 4783374, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ktbGv.jpg?s=128&g=1", "display_name": "PhilS", "link": "https://stackoverflow.com/users/4783374/phils"}, "is_accepted": true, "score": 3, "last_activity_date": 1430894542, "creation_date": 1430894542, "answer_id": 30069356, "question_id": 30065697, "link": "https://stackoverflow.com/questions/30065697/how-to-use-connection-string-in-odbc-to-create-a-table-in-access-permanently-lin/30069356#30069356", "title": "How to use connection string in ODBC to create a table in Access permanently linked to a SQL source?", "body": "<p>You need to add the dbAttachSavePWD-Attribute to the created table to store your credentials with the linked table in Access.</p>\n\n<p>Before appending the tabledef you should put this line of code:</p>\n\n<pre><code>tblDef.Attributes = (tblDef.Attributes Or dbAttachSavePWD)\n</code></pre>\n"}], "owner": {"reputation": 221, "user_id": 2528708, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/27b2312693fb922b7cdf95e0815cdd8d?s=128&d=identicon&r=PG", "display_name": "Kambiz", "link": "https://stackoverflow.com/users/2528708/kambiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "accepted_answer_id": 30069356, "answer_count": 1, "score": 1, "last_activity_date": 1594644736, "creation_date": 1430873593, "last_edit_date": 1594644736, "question_id": 30065697, "link": "https://stackoverflow.com/questions/30065697/how-to-use-connection-string-in-odbc-to-create-a-table-in-access-permanently-lin", "title": "How to use connection string in ODBC to create a table in Access permanently linked to a SQL source?", "body": "<p>I have created a table in my Access front end application, and try to connect it to the back end database with the following subroutine:</p>\n\n<pre><code>Sub createFlowTable()\nDim db As Database\nDim tblDef As TableDef\nSet db = CurrentDb\nSet tblDef = db.CreateTableDef(\"myTable\")\ntblDef.Connect = \"ODBC;DRIVER=SQL Server;SERVER=myServer; Trusted_Connection=No;UID=&lt;myUID&gt;;PWD=&lt;myPWD&gt;;APP=2007 Microsoft Office system;DATABASE=myDataBase;Network=DBMSSOCN;TABLE=dbo.myTable\"\ntblDef.SourceTableName = \"mySourceTableName\"\ndb.TableDefs.Append tblDef\nEnd Sub\n</code></pre>\n\n<p>After I close the front end Access database, and upon reopening it, the table fails to open.  Even though I have set the Trusted_Connection to \"No\" in my string, the table still tries to use the Windows Authentication.  Also, when I open the table on design view, I see in front of \"Description\":</p>\n\n<pre><code>ODBC;DRIVER=SQL Server;Server=myServer;APP=2007 Microsoft Office System;DATABASE=myDatabase;Network=DBMSSOCN;Table=dbo.myTable\n</code></pre>\n\n<p>So obviously Access has not saved the UID and PWD, nor has it saved the instruction on setting the Trusted_Connection to \"No\".</p>\n\n<p>I insist to get this done with the connection string, and using DSN will not work for the purpose of my application. Help would be greatly appreciated.</p>\n"}, {"tags": ["vba", "excel", "variables", "sumifs"], "comments": [{"owner": {"reputation": 23, "user_id": 4718537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fabe5b2438004880c8750254034291?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4718537/jason"}, "edited": false, "score": 0, "creation_date": 1431017013, "post_id": 30065498, "comment_id": 48325245, "body": "I searched, but still cannot figure out where the Sumif formula is incorrect. Please help. I&#39;m stumped."}, {"owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "edited": false, "score": 0, "creation_date": 1431219351, "post_id": 30065498, "comment_id": 48401475, "body": "When relevant, always include <code>excel</code>, <code>excel-vba</code> and <code>vba</code> tags, because they are followed a lot. Therefore, a lot more people will see your question."}], "answers": [{"tags": [], "owner": {"reputation": 8006, "user_id": 2753501, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0a5ac280a03c3a9d89488dc33f0ef075?s=128&d=identicon&r=PG&f=1", "display_name": "ZygD", "link": "https://stackoverflow.com/users/2753501/zygd"}, "is_accepted": false, "score": 0, "last_activity_date": 1431218891, "creation_date": 1431218891, "answer_id": 30146541, "question_id": 30065498, "link": "https://stackoverflow.com/questions/30065498/sumif-formula-with-source-from-variable-name-and-fill-down-the-cells/30146541#30146541", "title": "Sumif formula with source from variable name and fill down the cells", "body": "<p>From what I see, you have too many quote symbols. Try this:</p>\n\n<pre><code>Range(\"AL8:AL\" &amp; Cells(Rows.Count, \"C\").End(xlUp).Row).Formula = _ \n  \"=SUMIF('[_INV_R12_ABC_Onhandreport.xlsx]Sheet'!C2,RC[-35],'[INV_R12_ABC_Onhandreport.xlsx]Sheet'!C17)\"\n</code></pre>\n\n<p>Let me know if it helps.</p>\n"}], "owner": {"reputation": 23, "user_id": 4718537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17fabe5b2438004880c8750254034291?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/4718537/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1431222632, "creation_date": 1430872240, "last_edit_date": 1431222632, "question_id": 30065498, "link": "https://stackoverflow.com/questions/30065498/sumif-formula-with-source-from-variable-name-and-fill-down-the-cells", "title": "Sumif formula with source from variable name and fill down the cells", "body": "<p>I looked around on the forum, but could not find enough information to succeed. Appreciate your help throughout the process. </p>\n\n<p>The top portion seems to work, but when I get to <code>range.formula</code> section, it doesn't work. I'm trying to reference to a sheet with variable name, then fill down the formula. To make sure formula goes all the way to the bottom, I refer it to column C as it will always have data without blanks. </p>\n\n<pre><code>Sub SubName()\n    If (Worksheets(\"Master Data\").AutoFilterMode And _\n      Worksheets(\"Master Data\").FilterMode) Or _\n      Worksheets(\"Master Data\").FilterMode Then\n        Worksheets(\"Master Data\").ShowAllData\n    End If\n    Dim curDate As String, Fname As String\n    curDate = Format(Date, \"yyyy-mm-dd\")\n    Dim wba As Workbook\n    Fname = \"Y:\\Consumables\\Company\\ABC\\DMC - Planning &amp; Materials\\On Hand Reports\\ABC Site\\\" &amp; _\n      curDate &amp; \"_INV_R12_ABC_Onhandreport.xlsx\"\n    Set wba = Workbooks.Open(Filename:=Fname, UpdateLinks:=False, Notify:=False)\n    Dim wb As Workbook\n\n    For Each wb In Application.Workbooks\n        If wb.Name Like \"*PFEP*\" Then wb.Activate\n    Next wb\n    Sheets(\"Master Data\").Select\n    Range(\"AL8:AL\" &amp; Cells(Rows.Count, \"C\").End(xlUp).Row).Formula = _\n      \"=SUMIF('[\" &amp;_INV_R12_ABC_Onhandreport.xlsx &amp; \"]Sheet'!C2,RC[-35],'[\" &amp; INV_R12_ABC_Onhandreport.xlsx &amp; \"]Sheet'!C17)\"\nEnd Sub\n</code></pre>\n"}, {"tags": ["php", "mysql", "ms-access", "vba"], "comments": [{"owner": {"reputation": 16278, "user_id": 4421474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b931f645dc56015b93aeaa5e20d0b5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4421474/alex"}, "edited": false, "score": 0, "creation_date": 1430871830, "post_id": 30065419, "comment_id": 48245572, "body": "just use the same mysql query!"}, {"owner": {"reputation": 2240, "user_id": 4099598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc50a32e3a3dffad460e83c0e02f6ba?s=128&d=identicon&r=PG", "display_name": "Nathan Tuggy", "link": "https://stackoverflow.com/users/4099598/nathan-tuggy"}, "reply_to_user": {"reputation": 16278, "user_id": 4421474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b931f645dc56015b93aeaa5e20d0b5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4421474/alex"}, "edited": false, "score": 0, "creation_date": 1430872195, "post_id": 30065419, "comment_id": 48245698, "body": "@Alex: He might be asking about the <code>DateAdd</code> part; the code is an odd mix of SQL and VB with no distinction made, probably because it&#39;s actually Access VBA, not VB.NET or VBScript."}, {"owner": {"reputation": 16278, "user_id": 4421474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b931f645dc56015b93aeaa5e20d0b5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4421474/alex"}, "reply_to_user": {"reputation": 2240, "user_id": 4099598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc50a32e3a3dffad460e83c0e02f6ba?s=128&d=identicon&r=PG", "display_name": "Nathan Tuggy", "link": "https://stackoverflow.com/users/4099598/nathan-tuggy"}, "edited": false, "score": 0, "creation_date": 1430872309, "post_id": 30065419, "comment_id": 48245721, "body": "@NathanTuggy maybe. but we have <code>DATEDIFF</code> with mysql. but he is not asking about mysql&lt;-&gt;sql transition, he is asking about vb&lt;-&gt;php ;-) :-)"}, {"owner": {"reputation": 2240, "user_id": 4099598, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfc50a32e3a3dffad460e83c0e02f6ba?s=128&d=identicon&r=PG", "display_name": "Nathan Tuggy", "link": "https://stackoverflow.com/users/4099598/nathan-tuggy"}, "reply_to_user": {"reputation": 16278, "user_id": 4421474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b931f645dc56015b93aeaa5e20d0b5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4421474/alex"}, "edited": false, "score": 0, "creation_date": 1430872464, "post_id": 30065419, "comment_id": 48245769, "body": "@Alex: And you&#39;re certain that the distinction between SQL dialect differences and host language differences is clear? Because as an Access programmer myself I wouldn&#39;t be surprised to see someone make the mistake I described."}, {"owner": {"reputation": 16278, "user_id": 4421474, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b931f645dc56015b93aeaa5e20d0b5f7?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4421474/alex"}, "edited": false, "score": 0, "creation_date": 1430873134, "post_id": 30065419, "comment_id": 48245972, "body": "I am sure that  any sql query is completely isolated from the programming language. so you always can access Access db from any language that have driver. And you can request from php or VB  any sql server MS SQL, MySQL or Oracle or any other."}], "answers": [{"tags": [], "owner": {"reputation": 79873, "user_id": 205608, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/61eE0.png?s=128&g=1", "display_name": "O. Jones", "link": "https://stackoverflow.com/users/205608/o-jones"}, "is_accepted": true, "score": 2, "last_activity_date": 1430876158, "creation_date": 1430876158, "answer_id": 30066006, "question_id": 30065419, "link": "https://stackoverflow.com/questions/30065419/convert-vb-date-and-dateadd-functions-to-php/30066006#30066006", "title": "Convert VB Date() and DateAdd functions to PHP", "body": "<p>In the MySQL dialect, you want</p>\n\n<pre><code>WHERE date_added BETWEEN CURDATE() - INTERVAL 21 DAY\n                     AND CURDATE()\n</code></pre>\n\n<p>Notice that this works correctly only if date_added is a DATE data type.  If it has a time component you want </p>\n\n<pre><code>WHERE date_added &gt;= CURDATE() - INTERVAL 21 DAY\n  AND date_added &lt;  CURDATE() + INTERVAL 1 DAY\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 2090886, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7979bc755b2cefaf37a924606bee29a7?s=128&d=identicon&r=PG&f=1", "display_name": "Frank Smith", "link": "https://stackoverflow.com/users/2090886/frank-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 30066006, "answer_count": 1, "score": -2, "last_activity_date": 1594644740, "creation_date": 1430871723, "last_edit_date": 1594644740, "question_id": 30065419, "link": "https://stackoverflow.com/questions/30065419/convert-vb-date-and-dateadd-functions-to-php", "title": "Convert VB Date() and DateAdd functions to PHP", "body": "<p>I have a simple VBA function that shows records from current date and anything back to 21 days old.</p>\n\n<pre><code>WHERE date_added between Date() and DateAdd('d', -21, Date())\n</code></pre>\n\n<p>How can I get the same effect using PHP and MySQL?</p>\n\n<p>When I run code above I get this error:</p>\n\n<p>\"You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near ') and DateAdd('d', -21, Date())' at line 1\"</p>\n"}, {"tags": ["excel", "functional-programming", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4868403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a2bc4ce8a0c06b37489b29f16720bc?s=128&d=identicon&r=PG&f=1", "display_name": "Nandesh K", "link": "https://stackoverflow.com/users/4868403/nandesh-k"}, "edited": false, "score": 0, "creation_date": 1430873865, "post_id": 30065485, "comment_id": 48246165, "body": "thank you for your prompt response Comintern :) that was helpful. Do you know why can&#39;t I find the function in a cell just unlike I can see list of inbuilt functions?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 1, "user_id": 4868403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a2bc4ce8a0c06b37489b29f16720bc?s=128&d=identicon&r=PG&f=1", "display_name": "Nandesh K", "link": "https://stackoverflow.com/users/4868403/nandesh-k"}, "edited": false, "score": 0, "creation_date": 1430873934, "post_id": 30065485, "comment_id": 48246184, "body": "@NandeshK - Is the code in a Module or a Class?  It has to be in a Module to be used in a cell."}], "tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": false, "score": 1, "last_activity_date": 1430872179, "creation_date": 1430872179, "answer_id": 30065485, "question_id": 30065353, "link": "https://stackoverflow.com/questions/30065353/user-created-functions-cant-be-resolved-in-vba-immediate-window-though-they-sho/30065485#30065485", "title": "User created functions can&#39;t be resolved in VBA immediate window though they show up in intellisense", "body": "<p>If your functions are in a Class module, you need to explicitly include the Class in the function call.  That includes UserForms, Worksheets, and Workbooks.  They will also only be available as a UDF if they are in a Module.  For example, if this is in Sheet1...</p>\n\n<pre><code>Function customdate() As String\n    customdate = Format(Date, \"ddd dd mm yyy\")\nEnd Function\n\nFunction Area(x As Double, y As Double) As Double\n    Area = x * y\nEnd Function\n</code></pre>\n\n<p>You need to use this in the immediate window:</p>\n\n<pre><code>?Sheet1.customdate\nTue 05 05 15125\n</code></pre>\n\n<p>For <code>Area</code>, you also need to pass it parameters:</p>\n\n<pre><code>?Sheet1.Area(5, 5)\n 25 \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4868403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90a2bc4ce8a0c06b37489b29f16720bc?s=128&d=identicon&r=PG&f=1", "display_name": "Nandesh K", "link": "https://stackoverflow.com/users/4868403/nandesh-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430883777, "creation_date": 1430871239, "last_edit_date": 1531164843, "question_id": 30065353, "link": "https://stackoverflow.com/questions/30065353/user-created-functions-cant-be-resolved-in-vba-immediate-window-though-they-sho", "title": "User created functions can&#39;t be resolved in VBA immediate window though they show up in intellisense", "body": "<p>I've created a user-defined function in VBA and it doesn't solve in the immediate window nor in a cell. Although I can see the created function, namely <code>customdate</code>, in Intellisense, it won't show up in the immediate window. I can, however, get built-in functions going. Please let me know if you need any more details. Unfortunately, I can't upload the image due to a lack of reputation but the code is below. I've also uploaded screenshots on Google Docs.</p>\n\n<p><img src=\"https://i.stack.imgur.com/PJyIb.png\" alt=\"enter image description here\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/lQNui.png\" alt=\"enter image description here\"></p>\n\n<p>Code:</p>\n\n<pre><code>Option Explicit\n\nFunction customdate() As String\ncustomdate = Format(Date, \"ddd dd mm yyy\")\nEnd Function\n\nFunction Area(x As Double, y As Double) As Double\nArea = x * y\nEnd Function\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1608156616, "post_id": 30065075, "comment_id": 115500400, "body": "&quot;Data/Macro Recorder&quot; is my best friend for WebQuery!"}], "answers": [{"comments": [{"owner": {"reputation": 6102, "user_id": 573546, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7a4b5a3e61cece6737e6e18e853ea11b?s=128&d=identicon&r=PG&f=1", "display_name": "J. Win.", "link": "https://stackoverflow.com/users/573546/j-win"}, "edited": false, "score": 0, "creation_date": 1528314685, "post_id": 30595121, "comment_id": 88464906, "body": "Doesn&#39;t answer the question as your solution is a different language.  How can we do this in vba?"}], "tags": [], "owner": {"reputation": 418, "user_id": 1738824, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0629e27db5dac7a8e0cc63a4a13249e4?s=128&d=identicon&r=PG", "display_name": "mainpart", "link": "https://stackoverflow.com/users/1738824/mainpart"}, "is_accepted": false, "score": -1, "last_activity_date": 1433245351, "creation_date": 1433245351, "answer_id": 30595121, "question_id": 30065075, "link": "https://stackoverflow.com/questions/30065075/how-to-choose-correct-table-using-querytable-webtables/30595121#30595121", "title": "How to choose correct table using QueryTable, WebTables", "body": "<p>You can use WebSelectionType with ID of table.\nFor example, this iqy file works with ID:</p>\n\n<pre><code>WEB\n1\nhttp://www.glav-dostavka.ru/prices/sbor/20120516175749-8424/?c=153396\n\nSelection=price_table\nFormatting=None\nPreFormattedTextToColumns=True\nConsecutiveDelimitersAsOne=True\nSingleBlockTextImport=False\nDisableDateRecognition=False\nDisableRedirections=False\n</code></pre>\n\n<p>since iqy describes pretty much the same as VBA can specify, i'm assuming you can use text</p>\n"}], "owner": {"reputation": 4721, "user_id": 1112586, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9d2f37f51ca9e490fe489624aebc3f13?s=128&d=identicon&r=PG", "display_name": "SCB", "link": "https://stackoverflow.com/users/1112586/scb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 790, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1433245351, "creation_date": 1430869471, "question_id": 30065075, "link": "https://stackoverflow.com/questions/30065075/how-to-choose-correct-table-using-querytable-webtables", "title": "How to choose correct table using QueryTable, WebTables", "body": "<p>I'm trying to pull multiple tables from multiple webpages. They're all identical, the only thing that differs between pages is the data in the tables and the url. I've been trying to use Web tables with the <code>.WebSelectionType = xlSpecifiedTables</code> however the website is designed entirely in tables, so I'm unsure how to actually go about working out what value I should give to the <code>.WebTables</code> property, there may be something like 50 <code>&lt;table&gt;</code> tags on the entire page, all nested into one huge mess so I'm not sure of the order and counting is a terrifying prospect.</p>\n\n<p>What I do know is the <code>id</code> of the table. Is there any way to use the table's <code>id</code> instead of a number that refers to the table? Or at least a way to figure out what number the table is from it?</p>\n\n<p>For now, I might just pull up the source code and go counting tables, but it would still be useful for future reference. Thanks.</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 1404, "user_id": 209942, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/df626edfce8ddc13702ec0b57a4898e9?s=128&d=identicon&r=PG", "display_name": "johny why", "link": "https://stackoverflow.com/users/209942/johny-why"}, "edited": false, "score": 0, "creation_date": 1618619802, "post_id": 30065254, "comment_id": 118665376, "body": "any workaround?"}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 2, "last_activity_date": 1498917684, "last_edit_date": 1498917684, "creation_date": 1430870586, "answer_id": 30065254, "question_id": 30065057, "link": "https://stackoverflow.com/questions/30065057/incorrect-result-from-currentregion-when-used-in-a-function-called-from-a-cell/30065254#30065254", "title": "Incorrect result from CurrentRegion when used in a function called from a cell", "body": "<p><strong>CurrentRegion</strong> does not work correctly in <em>UDF()'s</em> called from worksheet cells.  I have also found problems with <strong>FindNext</strong> and <strong>SpecialCells.</strong></p>\n\n<p>Called from a <em>Sub</em>, it is a different story:</p>\n\n<pre><code>Function GetVarRange(rng) As String\n    Dim rngRangeToLeft As Range, wks As Worksheet\n    Set rngRangeToLeft = rng.CurrentRegion\n    GetVarRange = rngRangeToLeft.Address\nEnd Function\n\nSub MAIN()\nMsgBox GetVarRange(Range(\"A1\"))\nEnd Sub\n</code></pre>\n\n<p>appears to work just fine.</p>\n"}], "owner": {"reputation": 444, "user_id": 3114352, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/725578758/picture?type=large", "display_name": "jivko", "link": "https://stackoverflow.com/users/3114352/jivko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 881, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1498917684, "creation_date": 1430869391, "last_edit_date": 1531164843, "question_id": 30065057, "link": "https://stackoverflow.com/questions/30065057/incorrect-result-from-currentregion-when-used-in-a-function-called-from-a-cell", "title": "Incorrect result from CurrentRegion when used in a function called from a cell", "body": "<p>I'm trying to write a VBA function to be called from a cell. In this function I need to use the CurrentRegion property but it returns an unexpected result.</p>\n\n<p>The function:</p>\n\n<pre><code>Function GetVarRange() As String\n\n    Dim rngRangeToLeft As Range, wks As Worksheet\n    Set wks = Application.Caller.Worksheet\n    Set rngRangeToLeft = wks.Range(\"A1\").CurrentRegion\n\n    GetVarRange = rngRangeToLeft.Address\n\nEnd Function\n</code></pre>\n\n<p>The result I get in the cell is $A$1.</p>\n\n<p>There are values in A1, and all around it, the CurrentRegion is actually A1:AD618 and this is the result I get when I access the property within the code editor (not in this function) and when I press ctrl+A when A1 is selected.</p>\n\n<p>Any ideas anyone?</p>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 7587, "user_id": 943010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/R7Q27.png?s=128&g=1", "display_name": "kdopen", "link": "https://stackoverflow.com/users/943010/kdopen"}, "edited": false, "score": 0, "creation_date": 1430869058, "post_id": 30064927, "comment_id": 48244756, "body": "What have you tried so far? What doesn&#39;t work for you? More precisely, what is the question you want answered?"}, {"owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "edited": false, "score": 0, "creation_date": 1430872188, "post_id": 30064927, "comment_id": 48245694, "body": "You will probably use <code>MoveFile</code> after creating a <code>FileSystemObject</code>.  <a href=\"https://msdn.microsoft.com/en-us/library/office/gg251462.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/office/gg251462.aspx</a>"}, {"owner": {"reputation": 1, "user_id": 4868424, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FY46Y5ZkXx4/AAAAAAAAAAI/AAAAAAAAAJI/Yb3WecgW7Ps/photo.jpg?sz=128", "display_name": "Ivor Shaer", "link": "https://stackoverflow.com/users/4868424/ivor-shaer"}, "edited": false, "score": 0, "creation_date": 1430983878, "post_id": 30064927, "comment_id": 48301358, "body": "Moving a single file is not the problem."}, {"owner": {"reputation": 1, "user_id": 4868424, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FY46Y5ZkXx4/AAAAAAAAAAI/AAAAAAAAAJI/Yb3WecgW7Ps/photo.jpg?sz=128", "display_name": "Ivor Shaer", "link": "https://stackoverflow.com/users/4868424/ivor-shaer"}, "edited": false, "score": 0, "creation_date": 1430985333, "post_id": 30064927, "comment_id": 48302281, "body": "I have code, which works, to copy one file at a time.                            FileToCopy = FileSourceDirectory &amp; lstSelectedFiles.Value  DestinationFolderName = UserRepositoryDirectory &amp; lstRepositoryFolders  CopiedFile = DestinationFolderName &amp; &quot;\\&quot; &amp; lstSelectedFiles.Value   Set fso = VBA.CreateObject(&quot;Scripting.FileSystemObject&quot;)  FileCopy FileToCopy, CopiedFile Unload frmCopyFileToRepository"}, {"owner": {"reputation": 1, "user_id": 4868424, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FY46Y5ZkXx4/AAAAAAAAAAI/AAAAAAAAAJI/Yb3WecgW7Ps/photo.jpg?sz=128", "display_name": "Ivor Shaer", "link": "https://stackoverflow.com/users/4868424/ivor-shaer"}, "edited": false, "score": 0, "creation_date": 1430986742, "post_id": 30064927, "comment_id": 48303087, "body": "I need to be able to select some of the files (from a multi-select list box) and simultaneously move all of then. I have coded selecting files from the full list (first list box) and moving them to the second list box. I need the code to copy all the files in the second list box to the destination folder"}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1431089135, "post_id": 30064927, "comment_id": 48357948, "body": "Took the sample code from a comment and embedded it in the original post - it&#39;s much easier to read that way"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4868424, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FY46Y5ZkXx4/AAAAAAAAAAI/AAAAAAAAAJI/Yb3WecgW7Ps/photo.jpg?sz=128", "display_name": "Ivor Shaer", "link": "https://stackoverflow.com/users/4868424/ivor-shaer"}, "is_accepted": false, "score": 0, "last_activity_date": 1431444020, "creation_date": 1431444020, "answer_id": 30195135, "question_id": 30064927, "link": "https://stackoverflow.com/questions/30064927/excel-vba-move-multiple-files-using-listbox/30195135#30195135", "title": "excel vba move multiple files using listbox", "body": "<pre><code>Dim i As Integer\n For i = 0 To lstSelectedFiles.ListCount - 1\n\n  FileToCopy = FileSourceDirectory &amp; lstSelectedFiles.List(i)\n\n      CopiedFile = DestinationFolderName &amp; \"\\\" &amp; lstSelectedFiles.List(i)\n\n  Set fso = VBA.CreateObject(\"Scripting.FileSystemObject\")\n\nFileCopy FileToCopy, CopiedFile\n\nNext i\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4868424, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FY46Y5ZkXx4/AAAAAAAAAAI/AAAAAAAAAJI/Yb3WecgW7Ps/photo.jpg?sz=128", "display_name": "Ivor Shaer", "link": "https://stackoverflow.com/users/4868424/ivor-shaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1594196336, "creation_date": 1430868594, "last_edit_date": 1594196336, "question_id": 30064927, "link": "https://stackoverflow.com/questions/30064927/excel-vba-move-multiple-files-using-listbox", "title": "excel vba move multiple files using listbox", "body": "<p>I have created a form with three list boxes. The first loads with the files in a selected folder. I then select several files in the first list and move them into the second list box. The files in the second list box now need to be copied into folders listed in the third list box. All the issues of setting the source and destination paths are done. I need the lines of code which cause the selected files in the second list to be copied to the selected destination in the third list box.</p>\n\n<p>Sample code:</p>\n\n<pre><code>FileToCopy = FileSourceDirectory &amp; lstSelectedFiles.Value\nDestinationFolderName = UserRepositoryDirectory &amp; lstRepositoryFolders\nCopiedFile = DestinationFolderName &amp; \"\\\" &amp; lstSelectedFiles.Value\nSet fso = VBA.CreateObject(\"Scripting.FileSystemObject\")\nFileCopy FileToCopy, CopiedFile Unload frmCopyFileToRepository\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430866594, "post_id": 30064409, "comment_id": 48243973, "body": "What isn&#39;t working with that example? How are you testing it?"}, {"owner": {"reputation": 14991, "user_id": 1690193, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/2hac9.jpg?s=128&g=1", "display_name": "Nick.McDermaid", "link": "https://stackoverflow.com/users/1690193/nick-mcdermaid"}, "edited": false, "score": 0, "creation_date": 1430867133, "post_id": 30064409, "comment_id": 48244185, "body": "Please expand on &#39;not working&#39;. If a user of your distributed computing system told you it was &#39;not working&#39;, how would you fix it? Do you get an error or unexpected result? For starters that function has has <code>On Error Resume Next</code> at the top which is bad news. That function sure has a lot of complicated code around &#39;result on bad file&#39;"}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430882733, "post_id": 30064409, "comment_id": 48248427, "body": "@Comintern I added an edit."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1430883052, "post_id": 30064409, "comment_id": 48248509, "body": "Are you sure the process that has the file &quot;open&quot; is locking it? Most text utilities don&#39;t lock files unless they are actively writing to them.  That said, have you considered memory mapped files?"}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430883272, "post_id": 30064409, "comment_id": 48248558, "body": "@Comintern To your first question: probably not. I&#39;ll have to look into how to test it. To your second question: No, please share if you can. I&#39;ll try to google it."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 1, "creation_date": 1430883819, "post_id": 30064409, "comment_id": 48248695, "body": "From the question, it sounds like you&#39;re looking for a form of inter-process communication.  Memory mapped files can be used similarly to shared memory.  There&#39;s some (really old and incomplete) code I posted on a forum back in the day <a href=\"http://www.vbforums.com/showthread.php?404085-VB6-Treat-a-file-like-an-array-without-reading-to-memory\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430927828, "post_id": 30064409, "comment_id": 48276763, "body": "@Comintern I looked into the memory mapping file stuff and it looks very interesting. Sadly, I don&#39;t have time. I decided to split the processing up via sorting the file names that have to be processed alphabetically on all the PCs and have them process the 1st x%, the 2nd y%, etc. depending on how many files there are. If someone wants to post something on memory mapping files via VBA Lars post will be a good start: <a href=\"http://vbcity.com/forums/t/93240.aspx\" rel=\"nofollow noreferrer\">vbcity.com/forums/t/93240.aspx</a>"}, {"owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1431529848, "post_id": 30064409, "comment_id": 48541567, "body": "@Comintern If you are able to chime in on this related post that would be great: <a href=\"http://stackoverflow.com/questions/30218821/how-to-store-data-in-and-get-data-out-of-memory-mapping-files-using-copymemory-i\" title=\"how to store data in and get data out of memory mapping files using copymemory i\">stackoverflow.com/questions/30218821/&hellip;</a>  I tried my solution above and it worked great, but it is not dynamic enough for me. Going back to memory mapping files (hopefully)."}], "answers": [{"comments": [{"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430869990, "post_id": 30065092, "comment_id": 48245073, "body": "Not sure it makes a difference to the OP, but: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/bb525378%28v=vs.85%29.aspx\" rel=\"nofollow noreferrer\">&quot;Only members of the Administrators or Server Operators local group can successfully execute the NetFileEnum function.&quot;</a>"}], "tags": [], "owner": {"reputation": 145, "user_id": 4855658, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/52988a9e8b5c67060718b0de863bd041?s=128&d=identicon&r=PG", "display_name": "Trigger", "link": "https://stackoverflow.com/users/4855658/trigger"}, "is_accepted": false, "score": -1, "last_activity_date": 1430887349, "last_edit_date": 1430887349, "creation_date": 1430869554, "answer_id": 30065092, "question_id": 30064409, "link": "https://stackoverflow.com/questions/30064409/how-to-test-if-a-txt-file-is-already-open-by-anyone/30065092#30065092", "title": "How to test if a .txt file is already open by anyone?", "body": "<p>The <em>OpenFiles</em> command uses <code>NetFileEnum</code></p>\n\n<blockquote>\n  <p>The NetFileEnum function returns information about some or all open files on a server, depending on the parameters specified.</p>\n</blockquote>\n\n<pre><code>NET_API_STATUS NetFileEnum(\n  LMSTR servername,\n  LMSTR basepath,\n  LMSTR username,\n  DWORD level,\n  LPBYTE* bufptr,\n  DWORD prefmaxlen,\n  LPDWORD entriesread,\n  LPDWORD totalentries,\n  PDWORD_PTR resume_handle\n);\n</code></pre>\n\n<p>It says it also does local computer but <em>Openfiles</em> requires a flag to be set for local files. Run <em>GFlags</em> and tick <em>Maintain a list of objects for each type</em>.</p>\n\n<p>Note Notepad opens, reads, and closes the file. Therefore Notepad holds no file open.</p>\n\n<p>For a local computer you can call <code>enumwindows</code>, and see if your filename is in any of the Window's Captions. This sample uses <code>GetWindow</code> but the docs say <code>EnumWindows</code> is preferred.</p>\n\n<pre><code>Public Declare Function GetTopWindow Lib \"user32\" (ByVal hwnd As Long) As Long\nPublic Declare Function GetWindow Lib \"user32\" (ByVal hwnd As Long, ByVal wCmd As Long) As Long\nPublic Declare Function GetClassName Lib \"user32\" Alias \"GetClassNameA\" (ByVal hwnd As Long, ByVal lpClassName As String, ByVal nMaxCount As Long) As Long\nPublic Declare Function GetWindowText Lib \"user32\" Alias \"GetWindowTextA\" (ByVal hwnd As Long, ByVal lpString As String, ByVal cch As Long) As Long\n       Private Const GW_CHILD = 5\n       Private Const GW_HWNDNEXT = 2\n    Sub WindowList()\n        Dim hwnd As Long\n            hwnd = GetTopWindow(0)\n            If hwnd &lt;&gt; 0 Then\n                AddChildWindows hwnd, 0\n            End If\n    End Sub\n\n    Private Function AddChildWindows(ByVal hwndParent As Long, ByVal Level As Long) As String\n        Dim gwfnhwnd As Long, X As Long, WT As String, CN As String, Length As Long, hwnd As Long, TID As Long, PID As Long, MN As String, Ret As Long, Parenthwnd As Long\n        Static Order As Long\n        Static FirstTime As Long\n        Parenthwnd = hwndParent\n        If Level = 0 Then\n                        hwnd = hwndParent\n        Else\n            hwnd = GetWindow(hwndParent, GW_CHILD)\n        End If\n        Do While hwnd &lt;&gt; 0\n                  WT = Space(512)\n                  Length = GetWindowText(hwnd, WT, 508)\n                  WT = Left$(WT, Length)\n                  If WT = \"\" Then WT = Chr(171) &amp; \"No Window Text \" &amp; Err.LastDllError &amp; Chr(187)\n                  CN = Space(512)\n                  Length = GetClassName(hwnd, CN, 508)\n                  CN = Left$(CN, Length)\n                  If CN = \"\" Then CN = \"Error=\" &amp; Err.LastDllError\n                  MsgBox WT &amp; \" \" &amp; CN\n                  hwnd = GetWindow(hwnd, GW_HWNDNEXT)\n        Loop\n    End Function\n</code></pre>\n\n<p>COM can communicate across computers and processes. Just use Class modules to build interfaces betweeen processes.</p>\n"}, {"tags": [], "owner": {"reputation": 36788, "user_id": 2887618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e643417e67e5a3bb9f659e4491ed26b0?s=128&d=identicon&r=PG&f=1", "display_name": "Florent B.", "link": "https://stackoverflow.com/users/2887618/florent-b"}, "is_accepted": true, "score": 1, "last_activity_date": 1455207679, "creation_date": 1455207679, "answer_id": 35344615, "question_id": 30064409, "link": "https://stackoverflow.com/questions/30064409/how-to-test-if-a-txt-file-is-already-open-by-anyone/35344615#35344615", "title": "How to test if a .txt file is already open by anyone?", "body": "<p>One way would be to try to rename the file with the same name:</p>\n\n<pre><code>Public Function IsFileLocked(file_path As String) As Boolean\n  Dim num As Long\n\n  On Error Resume Next\n  Name file_path As file_path\n  num = Err.Number\n  On Error GoTo 0\n\n  If num &lt;&gt; 0 And num &lt;&gt; 75 Then Error num\n  IsFileLocked = num &lt;&gt; 0\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 1207, "user_id": 3524158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eNErY.png?s=128&g=1", "display_name": "mountainclimber11", "link": "https://stackoverflow.com/users/3524158/mountainclimber11"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2374, "favorite_count": 0, "accepted_answer_id": 35344615, "answer_count": 2, "score": 0, "last_activity_date": 1455207679, "creation_date": 1430865546, "last_edit_date": 1525816189, "question_id": 30064409, "link": "https://stackoverflow.com/questions/30064409/how-to-test-if-a-txt-file-is-already-open-by-anyone", "title": "How to test if a .txt file is already open by anyone?", "body": "<p>I am trying to test if a .txt or .ini file is open already by anyone. I have several versions of IsFileOpen. Here is one taken directly from <a href=\"http://www.cpearson.com/excel/ISFILEOPEN.ASPX\" rel=\"nofollow noreferrer\">http://www.cpearson.com/excel/ISFILEOPEN.ASPX</a></p>\n\n<pre><code>Option Explicit\nOption Compare Text\nPublic Function isfileopen_test(FileName As String, _\n    Optional ResultOnBadFile As Variant) As Variant\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n' IsFileOpen_test\n' This function determines whether a the file named by FileName is\n' open by another process. The fuction returns True if the file is open\n' or False if the file is not open. If the file named by FileName does\n' not exist or if FileName is not a valid file name, the result returned\n' if equal to the value of ResultOnBadFile if that parameter is provided.xd\n' If ResultOnBadFile is not passed in, and FileName does not exist or\n' is an invalid file name, the result is False.\n'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''\n\nDim FileNum As Integer\nDim ErrNum As Integer\nDim V As Variant\n\nOn Error Resume Next\n\n''''''''''''''''''''''''''''''''''''''''''''\n' If we were passed in an empty string,\n' there is no file to test so return FALSE.\n''''''''''''''''''''''''''''''''''''''''''''\nIf VBA.Trim(FileName) = vbNullString Then\n    If IsMissing(ResultOnBadFile) = True Then\n        isfileopen_test = False\n    Else\n        isfileopen_test = ResultOnBadFile\n    End If\n    Exit Function\nEnd If\n\n''''''''''''''''''''''''''''''''''''''''''''\n' if the file doesn't exist, it isn't open\n' so get out now\n''''''''''''''''''''''''''''''''''''''''''''\nV = Dir(FileName, vbNormal)\nIf IsError(V) = True Then\n    ' syntactically bad file name\n    If IsMissing(ResultOnBadFile) = True Then\n        isfileopen_test = False\n    Else\n        isfileopen_test = ResultOnBadFile\n    End If\n    Exit Function\nElseIf V = vbNullString Then\n    ' file doesn't exist.\n    If IsMissing(ResultOnBadFile) = True Then\n        isfileopen_test = False\n    Else\n        isfileopen_test = ResultOnBadFile\n    End If\n    Exit Function\nEnd If\n\nFileNum = FreeFile()\n'''''''''''''''''''''''''''''''''''''''\n' Attempt to open the file and lock it.\n'''''''''''''''''''''''''''''''''''''''\nErr.Clear\nOpen FileName For Input Lock Read As #FileNum\nErrNum = Err.Number\n''''''''''''''''''''\n' Close the file.\n''''''''''''''''''''\nClose FileNum\nOn Error GoTo 0\n\n''''''''''''''''''''''''''''''''''''''\n' Check to see which error occurred.\n''''''''''''''''''''''''''''''''''''''\nSelect Case ErrNum\n    Case 0\n        ''''''''''''''''''''''''''''''''''''''''''''\n        ' No error occurred.\n        ' File is NOT already open by another user.\n        ''''''''''''''''''''''''''''''''''''''''''''\n        isfileopen_test = False\n    Case 70\n        ''''''''''''''''''''''''''''''''''''''''''''\n        ' Error number for \"Permission Denied.\"\n        ' File is already opened by another user.\n        ''''''''''''''''''''''''''''''''''''''''''''\n        isfileopen_test = True\n    Case Else\n        ''''''''''''''''''''''''''''''''''''''''''''\n        ' Another error occurred. Assume open.\n        ''''''''''''''''''''''''''''''''''''''''''''\n        isfileopen_test = True\nEnd Select\n\nEnd Function\n</code></pre>\n\n<p>I need to do this via VBA. I can't get it to work for a .txt or .ini file. How can I check if a txt or ini file is already open by someone on the network?</p>\n\n<p>Edit: It returns false for txt and ini files whether they are open or not.</p>\n\n<p>If you are so inclined, I am attempting to build a distributive computing system on a clients network. I've never done this before and I am looking to keep it as simple as possible, so I was thinking of communicating via txt files. MSMQ looks good, but it looks like a long learning curve. I've already read all of the posts on stackoverflow regarding distributive computing.</p>\n"}, {"tags": ["excel", "sum", "rows", "vba"], "comments": [{"owner": {"reputation": 314, "user_id": 4826390, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1087551701260251/picture?type=large", "display_name": "Vladislav Vazhenin", "link": "https://stackoverflow.com/users/4826390/vladislav-vazhenin"}, "edited": false, "score": 0, "creation_date": 1430866503, "post_id": 30064228, "comment_id": 48243939, "body": "Can you attach screen with desired result?"}, {"owner": {"reputation": 3, "user_id": 4584398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaf5e23b3a81d07a600a35df105abd0c?s=128&d=identicon&r=PG&f=1", "display_name": "tedi", "link": "https://stackoverflow.com/users/4584398/tedi"}, "reply_to_user": {"reputation": 314, "user_id": 4826390, "user_type": "registered", "accept_rate": 89, "profile_image": "https://graph.facebook.com/1087551701260251/picture?type=large", "display_name": "Vladislav Vazhenin", "link": "https://stackoverflow.com/users/4826390/vladislav-vazhenin"}, "edited": false, "score": 0, "creation_date": 1430921251, "post_id": 30064228, "comment_id": 48271620, "body": "I am unable to attach screen shots.  Not enough points it seems."}], "answers": [{"tags": [], "owner": {"reputation": 8906, "user_id": 1153513, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/87WJr.jpg?s=128&g=1", "display_name": "Ralph", "link": "https://stackoverflow.com/users/1153513/ralph"}, "is_accepted": false, "score": 0, "last_activity_date": 1430899269, "creation_date": 1430899269, "answer_id": 30070854, "question_id": 30064228, "link": "https://stackoverflow.com/questions/30064228/combine-and-sum-rows-based-on-multiple-criteria-with-vba/30070854#30070854", "title": "Combine and Sum rows based on multiple criteria with VBA", "body": "<p>Assuming that row 1 contains the headers for the columns and that the rest of the rows contain only values the following code should do the trick (for sheet1):</p>\n\n<pre><code>Public Sub SumByTwoCriteria()\nDim lngStartRow, lngSearchRow, lngLastRow As Long\n\nlngLastRow = Sheet1.Cells.Find(\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row\n\nFor lngStartRow = 2 To lngLastRow\n    For lngSearchRow = lngStartRow + 1 To lngLastRow\n        While Sheet1.Cells(lngStartRow, 2).Value2 = Sheet1.Cells(lngSearchRow, 2).Value2 And _\n            Sheet1.Cells(lngStartRow, 3).Value2 = Sheet1.Cells(lngStartRow, 3).Value2\n                Sheet1.Cells(lngStartRow, 1).Value2 = Sheet1.Cells(lngStartRow, 1).Value2 + Sheet1.Cells(lngSearchRow, 1).Value2\n                Sheet1.Rows(lngSearchRow &amp; \":\" &amp; lngSearchRow).Delete\n                lngLastRow = lngLastRow - 1\n        Wend\n    Next lngSearchRow\nNext lngStartRow\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4584398, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eaf5e23b3a81d07a600a35df105abd0c?s=128&d=identicon&r=PG&f=1", "display_name": "tedi", "link": "https://stackoverflow.com/users/4584398/tedi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1980, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1457044758, "creation_date": 1430864524, "last_edit_date": 1531164843, "question_id": 30064228, "link": "https://stackoverflow.com/questions/30064228/combine-and-sum-rows-based-on-multiple-criteria-with-vba", "title": "Combine and Sum rows based on multiple criteria with VBA", "body": "<p>I am a VBA novice and cannot figure out how to combine and sum rows based on certain column criteria. Say, Column B and Column C have text values while column A has number values.  Row 1 and Row 2 have the same values in Columns B and C.  I want to have these rows combined into one row with Columns B and C having the same values as before but Column A to have the sum of the previous rows.</p>\n"}, {"tags": ["xml", "vba", "excel", "onenote"], "owner": {"reputation": 1934, "user_id": 2942295, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/fRBy8.png?s=128&g=1", "display_name": "ZAR", "link": "https://stackoverflow.com/users/2942295/zar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1786, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1430861715, "creation_date": 1430861715, "last_edit_date": 1531164843, "question_id": 30063650, "link": "https://stackoverflow.com/questions/30063650/onenote-creating-new-notebook-via-vba", "title": "OneNote: Creating new notebook via VBA", "body": "<p>I'm trying to create a new notebook in OneNote from VBA. Ultimately, records in excel will automatically pull to new notes inside of a predefined section within a predefined notebook. IF the notebook and/or the section doesn't exist, it is created.</p>\n\n<p>I'm trying to use the UpdateHierarchy method to upload a new XML schema with the new notebook. I can't quite put a PATH down, since I want this script to be able to adapt to whatever user is using it (unless maybe I can grab the path from the context?).</p>\n\n<p>According to <a href=\"https://msdn.microsoft.com/en-us/library/office/gg649853(v=office.14).aspx\" rel=\"nofollow\">MSDN</a>, </p>\n\n<blockquote>\n  <p>If you pass only a partial OneNote XML string...OneNote attempts to\n  infer the changes you want. For example, if you include a NOTEBOOK\n  element that contains only one section, OneNote adds the section after\n  any existing sections.</p>\n</blockquote>\n\n<p>I took this to mean that I can supply partial XML and OneNote will autofill the rest. I can't find anywhere showing the minimum for adding a new notebook, and the following code produces:</p>\n\n<blockquote>\n  <p>hrNotebookDoesNotExist 0x80042015 The notebook does not exist.</p>\n</blockquote>\n\n<p>Here is the code:</p>\n\n<pre><code>Dim oneNote As OneNote14.Application\nSet oneNote = New OneNote14.Application\n\nDim targetNotebook As String, targetSection As String, targetPage As String\ntargetNotebook = \"The Notes\"\ntargetSection = \"Notes\"\n\nDim notebookXml As String\n\noneNote.GetHierarchy \"\", hsNotebooks, notebookXml, xs2010\n\nDim doc As MSXML2.DOMDocument\nSet doc = New MSXML2.DOMDocument\n\nIf doc.LoadXML(notebookXml) Then\n    Dim nodes As MSXML2.IXMLDOMNodeList, node As MSXML2.IXMLDOMNode\n    Dim notebookName As String, notebookPath As String, notebookId As String\n\n    Set nodes = doc.DocumentElement.SelectNodes(\"one:Notebook\")\n\n    For Each node In nodes\n        notebookName = node.Attributes.getNamedItem(\"name\").Text\n\n        If notebookName = targetNotebook Then\n            notebookPath = node.Attributes.getNamedItem(\"path\").Text\n            notebookId = node.Attributes.getNamedItem(\"ID\").Text\n        End If\n\n    Next\n\nIf notebookId = vbNullString Then\n\n            'create new notebook\n            Dim newNotebookXml As String\n            newNotebookXml = \"&lt;?xml version=\" &amp; Chr(34) &amp; \"1.0\" &amp; Chr(34) &amp; \"?&gt;\" _\n                            &amp; \"&lt;one:Notebooks xmlns:one=\" &amp; Chr(34) &amp; \"http://schemas.microsoft.com/office/onenote/2010/onenote\" &amp; Chr(34) &amp; \"&gt;\" _\n                                &amp; \"&lt;one:Notebook name=\" &amp; Chr(34) &amp; \"HUD Notes\" &amp; Chr(34) &amp; \"&gt;\" _\n                                &amp; \"&lt;/one:Notebook&gt;\" _\n                            &amp; \"&lt;/one:Notebooks&gt;\"\n            Debug.Print (newNotebookXml)\n            oneNote.UpdateHierarchy newNotebookXml  'This is where the error hits\nEnd If\n\n...\n</code></pre>\n\n<p>the code continues, but is irrelevant for this question.</p>\n\n<p>How can I change the code around to create a notebook named targetNotebook if it is not found and notebookId is null?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1430862775, "post_id": 30063015, "comment_id": 48242662, "body": "Try adding a button to your worksheet... First take your code out of the <code>Worksheet_Change</code> event and create a module with a <code>Public Sub MyButton()</code>. Next, from the Developer tab, add a button to your worksheet (anywhere will do) and you&#39;ll be prompted to connect the button to a macro. Once you connect it, you should be set."}, {"owner": {"reputation": 75, "user_id": 3060269, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45ee17bd6691ce3ccdec47e6c468aeb2?s=128&d=identicon&r=PG&f=1", "display_name": "LillieG", "link": "https://stackoverflow.com/users/3060269/lillieg"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1430865655, "post_id": 30063015, "comment_id": 48243657, "body": "Thank you for your response. It does not work. Maybe I not modifying the code properly. I have other buttons and other codes in the same sheet, is this why?"}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1430866887, "post_id": 30063015, "comment_id": 48244098, "body": "If you&#39;re following the suggestion in the comment from @PeterT you also need to explicitly set Target to <code>A:A</code> and take out the <code>Intersect</code> test."}, {"owner": {"reputation": 75, "user_id": 3060269, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45ee17bd6691ce3ccdec47e6c468aeb2?s=128&d=identicon&r=PG&f=1", "display_name": "LillieG", "link": "https://stackoverflow.com/users/3060269/lillieg"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430873689, "post_id": 30063015, "comment_id": 48246120, "body": "Thank you @Comintern, I tried it and it does not work for me. Like I said I am new in this, maybe I am not doing the modifications accordingly as you guys say :s."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 3060269, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45ee17bd6691ce3ccdec47e6c468aeb2?s=128&d=identicon&r=PG&f=1", "display_name": "LillieG", "link": "https://stackoverflow.com/users/3060269/lillieg"}, "edited": false, "score": 0, "creation_date": 1430873038, "post_id": 30065007, "comment_id": 48245940, "body": "Thank you Omar, your code works. I just want to highlight duplicates in Column A only, not comparing two columns with duplicates. Do you know how can I solve my second problem?: 2.) I would like to have (somewhere in the same worksheet), the number of duplicate results and a hyper link that when you click on it will direct you the duplicate result (this is because I have sometimes huge files that I need to validate)."}], "tags": [], "owner": {"reputation": 11116, "user_id": 4539709, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/0pdoL.jpg?s=128&g=1", "display_name": "0m3r", "link": "https://stackoverflow.com/users/4539709/0m3r"}, "is_accepted": true, "score": 1, "last_activity_date": 1430900611, "last_edit_date": 1430900611, "creation_date": 1430869112, "answer_id": 30065007, "question_id": 30063015, "link": "https://stackoverflow.com/questions/30063015/excel-vba-duplicates-run-with-button-add-location/30065007#30065007", "title": "Excel VBA-Duplicates run with button/add location", "body": "<p>Add the code to Module1 <kbd><strong>Alt</strong></kbd>+<kbd><strong>F11</strong></kbd></p>\n\n<pre><code>Option Explicit\n\nSub MyButton()\n    Dim RangeCell As Range, _\n    MyData As Range\n    Dim MyDupList As String\n    Dim intMyCounter As Integer\n    Dim MyUniqueList As Object\n    Dim lngLastRow As Long, lngLoopRow As Long\n    Dim lngWriteRow As Long\n\n    Set MyData = Range(\"A1:A\" &amp; Cells(Rows.Count, \"A\").End(xlUp).Row)\n    Set MyUniqueList = CreateObject(\"Scripting.Dictionary\")\n\n    Application.ScreenUpdating = False\n    MyDupList = \"\": intMyCounter = 0\n    '// Find Duplicate\n    For Each RangeCell In MyData\n        If RangeCell &lt;&gt; \"V\" And RangeCell &lt;&gt; \"R\" Then\n            If Evaluate(\"COUNTIF(\" &amp; MyData.Address &amp; \",\" &amp; RangeCell.Address &amp; \")\") &gt; 1 Then\n                '// Color. Change to suit RGB(141, 180, 226).\n                RangeCell.Interior.Color = RGB(141, 255, 226)\n                If MyUniqueList.exists(CStr(RangeCell)) = False Then\n                    intMyCounter = intMyCounter + 1\n                    MyUniqueList.Add CStr(RangeCell), intMyCounter\n                    If MyDupList = \"\" Then\n                        MyDupList = RangeCell\n                    Else\n                        MyDupList = MyDupList &amp; vbNewLine &amp; RangeCell\n                    End If\n                End If\n            Else\n                RangeCell.Interior.ColorIndex = xlNone\n            End If\n        End If\n    Next RangeCell\n    '// Move duplicate from Column 1 to Column 7 = (G:G)\n    lngWriteRow = 1\n    lngLastRow = Cells(Rows.Count, 1).End(xlUp).Row\n    For lngLoopRow = lngLastRow To 1 Step -1\n        With Cells(lngLoopRow, 1)\n            If WorksheetFunction.CountIf(Range(\"A1:A\" &amp; lngLastRow), .Value) &gt; 1 Then\n                If Range(\"G:G\").Find(.Value, lookat:=xlWhole) Is Nothing Then\n                    Cells(lngWriteRow, 7) = .Value\n                    lngWriteRow = lngWriteRow + 1\n                End If\n            End If\n        End With\n    Next lngLoopRow\n\n    Set MyData = Nothing: Set MyUniqueList = Nothing\n\n    Application.ScreenUpdating = False\n\n    If MyDupList &lt;&gt; \"\" Then\n        MsgBox \"Duplicate entries have been found:\" &amp; vbNewLine &amp; MyDupList\n    Else\n        MsgBox \"There were no duplicates found in \" &amp; MyData.Address\n    End If\nEnd Sub\n</code></pre>\n\n<p>.</p>\n\n<pre><code>Add Module\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/mhqum.png\" alt=\"enter image description here\"></p>\n\n<pre><code>Add Button\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/6p9oE.png\" alt=\"enter image description here\"></p>\n\n<pre><code>Assign to Macro\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/Z6VLv.png\" alt=\"enter image description here\"></p>\n"}], "owner": {"reputation": 75, "user_id": 3060269, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/45ee17bd6691ce3ccdec47e6c468aeb2?s=128&d=identicon&r=PG&f=1", "display_name": "LillieG", "link": "https://stackoverflow.com/users/3060269/lillieg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 679, "favorite_count": 0, "accepted_answer_id": 30065007, "answer_count": 1, "score": 2, "last_activity_date": 1430900611, "creation_date": 1430858955, "question_id": 30063015, "link": "https://stackoverflow.com/questions/30063015/excel-vba-duplicates-run-with-button-add-location", "title": "Excel VBA-Duplicates run with button/add location", "body": "<p>I am new to Excel VBA and I really need your help. I have a code that will look for the duplicate values in Column A. This code will highlight the duplicate values. I want:</p>\n\n<p>1.) This code to ONLY run when I click on a button. </p>\n\n<p>2.) I would like to have (somewhere in the same worksheet), the number of duplicate results and a hyper link that when you click on it will direct you the duplicate result (this is because I have sometimes huge files that I need to validate). Here is the code I currently have: </p>\n\n<pre><code>Sub Worksheet_Change(ByVal Target As Excel.Range)\nDim C As Range, i As Long\nIf Not Intersect(Target, Me.[A:A]) Is Nothing Then\n Application.EnableEvents = False\n For Each C In Target\n   If C.Column = 1 And C.Value &gt; \"\" Then\n      If WorksheetFunction.CountIf(Me.[A:A], C.Value) &gt; 1 Then\n         i = C.Interior.ColorIndex\n         f = C.Font.ColorIndex\n         C.Interior.ColorIndex = 3 ' Red\n         C.Font.ColorIndex = 6 ' Yellow\n          C.Select\n          MsgBox \"Duplicate Entry !\", vbCritical, \"Error\"\n         C.Interior.ColorIndex = i\n         C.Font.ColorIndex = f\n      End If\n   End If\n Next\n Application.EnableEvents = True\n End If\n End Sub\n</code></pre>\n\n<p>I would really appreciate it if you help me with this.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 10840, "user_id": 426422, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/cmD2F.jpg?s=128&g=1", "display_name": "Mike Cheel", "link": "https://stackoverflow.com/users/426422/mike-cheel"}, "edited": false, "score": 0, "creation_date": 1430855814, "post_id": 30062063, "comment_id": 48239322, "body": "It looks like some of your Mes are in quotes. EDITED: They definitely are."}, {"owner": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "reply_to_user": {"reputation": 10840, "user_id": 426422, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/cmD2F.jpg?s=128&g=1", "display_name": "Mike Cheel", "link": "https://stackoverflow.com/users/426422/mike-cheel"}, "edited": false, "score": 0, "creation_date": 1430855989, "post_id": 30062063, "comment_id": 48239424, "body": "It&#39;s saying in general that the Me.[fieldname] is an invalid use of Me. which doesn&#39;t make sense because I literally use a similar code in another macro and it works fine. It&#39;s just not working here. Not sure it that is because this is a Public Function and not a Private Sub"}, {"owner": {"reputation": 10840, "user_id": 426422, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/cmD2F.jpg?s=128&g=1", "display_name": "Mike Cheel", "link": "https://stackoverflow.com/users/426422/mike-cheel"}, "edited": false, "score": 0, "creation_date": 1430856019, "post_id": 30062063, "comment_id": 48239442, "body": "Replace the UPDATE with this: &quot;UPDATE CFRRR SET assignedto = &quot; &amp; GetNextAssignee &amp; &quot;, assignedby = &quot; &amp; Me.assignedby.Column(1) &amp; &quot;, Dateassigned = #&quot; &amp; Now &amp; &quot;#, actiondate = #&quot; &amp; Now &amp; &quot;#, Workername = &quot; &amp; _                               Me.assignedto.Column(0) &amp; &quot;, WorkerID = &quot; &amp; Me.assignedto.Column(0) &amp; &quot; WHERE CFRRRID = &quot; &amp; rs!CFRRRID             db.Execute strSQL, dbFailOnError"}, {"owner": {"reputation": 10840, "user_id": 426422, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/cmD2F.jpg?s=128&g=1", "display_name": "Mike Cheel", "link": "https://stackoverflow.com/users/426422/mike-cheel"}, "edited": false, "score": 0, "creation_date": 1430856071, "post_id": 30062063, "comment_id": 48239464, "body": "Let me know how it goes. I haven&#39;t done VB (or VBA) for many years but I think your problem is including Me in your hard coded parts (string literal) of the query."}, {"owner": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "reply_to_user": {"reputation": 10840, "user_id": 426422, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/cmD2F.jpg?s=128&g=1", "display_name": "Mike Cheel", "link": "https://stackoverflow.com/users/426422/mike-cheel"}, "edited": false, "score": 0, "creation_date": 1430856359, "post_id": 30062063, "comment_id": 48239625, "body": "No that didn&#39;t work. Still getting the same error. I&#39;m getting the error right here: <code>&quot; &amp; Me.assignedby.Column(1) &amp; &quot;</code>"}, {"owner": {"reputation": 10840, "user_id": 426422, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/cmD2F.jpg?s=128&g=1", "display_name": "Mike Cheel", "link": "https://stackoverflow.com/users/426422/mike-cheel"}, "edited": false, "score": 0, "creation_date": 1430856526, "post_id": 30062063, "comment_id": 48239724, "body": "Column(1) is only seen once in your code above. Is it part of the string still? What is the actual error? What happens if you remove the Me keyword from before the assignedby.Column(1) part?"}, {"owner": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "reply_to_user": {"reputation": 10840, "user_id": 426422, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/cmD2F.jpg?s=128&g=1", "display_name": "Mike Cheel", "link": "https://stackoverflow.com/users/426422/mike-cheel"}, "edited": false, "score": 0, "creation_date": 1430866728, "post_id": 30062063, "comment_id": 48244043, "body": "HansUp actually steered me in the right direction. Thank you though."}], "answers": [{"comments": [{"owner": {"reputation": 10840, "user_id": 426422, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/cmD2F.jpg?s=128&g=1", "display_name": "Mike Cheel", "link": "https://stackoverflow.com/users/426422/mike-cheel"}, "edited": false, "score": 0, "creation_date": 1430866942, "post_id": 30062560, "comment_id": 48244119, "body": "I totally forgot about modules and assumed you are in a form"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 2, "last_activity_date": 1430857306, "creation_date": 1430857306, "answer_id": 30062560, "question_id": 30062063, "link": "https://stackoverflow.com/questions/30062063/invalid-use-of-me-keyword/30062560#30062560", "title": "Invalid use of Me keyword", "body": "<p>Put that code in the form's code module.  When you try to use <code>Me</code> in a standard module, you will always get that <em>\"Invalid use of Me keyword\"</em> complaint.</p>\n\n<p>Check out the <em>\"Invalid use of Me keyword\"</em> and <em>\"Me &lt;keyword&gt;\"</em> topics in Access' help system for further details.</p>\n"}], "owner": {"reputation": 233, "user_id": 4413332, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/a476c5d8fddd24df8a25460d83efd04d?s=128&d=identicon&r=PG&f=1", "display_name": "Lilly", "link": "https://stackoverflow.com/users/4413332/lilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8096, "favorite_count": 0, "accepted_answer_id": 30062560, "answer_count": 1, "score": 2, "last_activity_date": 1430859193, "creation_date": 1430855658, "last_edit_date": 1430859193, "question_id": 30062063, "link": "https://stackoverflow.com/questions/30062063/invalid-use-of-me-keyword", "title": "Invalid use of Me keyword", "body": "<p>This code is a function and not a private subroutine. I'm suddenly getting this error with the Me.[field name here]. I'm not getting that error in my other code, just in this one. Here's my full code without the boring end part, but I'm getting the error starting from the line:</p>\n\n<p><code>Me.assignedby.Column(1)</code></p>\n\n<pre><code>Public Function AssignNullProjects() As Long\n\n    Dim db As dao.Database\n    Dim rs As dao.Recordset\n    Dim strSQL As String\n\n    assignedby = TempVars(\"user\").Value\n\n    Set db = CurrentDb\n    strSQL = \"SELECT CFRRRID FROM CFRRR WHERE assignedto Is Null\"\n    Set rs = db.OpenRecordset(strSQL, dbOpenDynaset)\n    If Not rs.BOF And Not rs.EOF Then\n        While Not rs.EOF\n            strSQL = \"UPDATE CFRRR SET assignedto = \" &amp; GetNextAssignee &amp; \", assignedby = \" &amp; Me.assignedby.Column(1) &amp; \", Me.Dateassigned = #\" &amp; Now &amp; \"#, Me.actiondate = #\" &amp; Now &amp; \"#, Me.Workername = \" &amp; _\n                              Me.assignedto.Column(0) &amp; \", Me.WorkerID = \" &amp; Me.assignedto.Column(0) &amp; \" WHERE CFRRRID = \" &amp; rs!CFRRRID\n            db.Execute strSQL, dbFailOnError\n            rs.MoveNext\n        Wend\n    End If\n\n    rs.Close\n    db.Close\n    Set rs = Nothing\n    Set db = Nothing\n</code></pre>\n\n<p>What could be the possible reason for the above-stated error, and how it could be removed?</p>\n"}, {"tags": ["vba", "excel", "find", "excel-2007", "quotation-marks"], "comments": [{"owner": {"reputation": 437, "user_id": 120101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98e307b5a1a764bc192f75b947b96b03?s=128&d=identicon&r=PG", "display_name": "Andrew Arace", "link": "https://stackoverflow.com/users/120101/andrew-arace"}, "edited": false, "score": 0, "creation_date": 1430855097, "post_id": 30061855, "comment_id": 48238877, "body": "Just checking if there&#39;s a typo here - if you said sComparisonText initially contains (8&quot;), you&#39;re not stripping off the final (&quot;) but instead adding 6 more double quotes, for a total of 7?"}, {"owner": {"reputation": 115, "user_id": 4513792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WYnVt.png?s=128&g=1", "display_name": "Dave 2.71828", "link": "https://stackoverflow.com/users/4513792/dave-2-71828"}, "reply_to_user": {"reputation": 437, "user_id": 120101, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98e307b5a1a764bc192f75b947b96b03?s=128&d=identicon&r=PG", "display_name": "Andrew Arace", "link": "https://stackoverflow.com/users/120101/andrew-arace"}, "edited": false, "score": 0, "creation_date": 1430855682, "post_id": 30061855, "comment_id": 48239255, "body": "Hi Andrew,  You are correct, I&#39;m not stripping the final (&quot;), just adding more to it.  I&#39;ve tried (desperation) adding from 1 to 6 (&quot;) characters, but nothing I&#39;ve tried will make the .find method actually find the cell.  Thank you!"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 4513792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WYnVt.png?s=128&g=1", "display_name": "Dave 2.71828", "link": "https://stackoverflow.com/users/4513792/dave-2-71828"}, "edited": false, "score": 0, "creation_date": 1430858578, "post_id": 30062011, "comment_id": 48240888, "body": "Your suggestion works!  I can use it hard-coded into the range.find as you&#39;ve shown above.  I can also use the string constant &quot;8&quot;&quot;&quot; to set a variable which is then used in the range.find line:   <code>sComparisonText = &quot;8&quot;&quot;&quot;</code>.  Unfortunately, what I can not make work is to take the original contents of <code>sComparisonText</code> (the 2 chars: 8&quot;) and have vba add a leading double quote and a pair of trailing double quotes.  The value shown in the watch window appears correct (although surrounded by and extra pair of quotes as the watch window always does)."}, {"owner": {"reputation": 1, "user_id": 4867997, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5ae8779c0ac84bf9f2b4c8914654e3ce?s=128&d=identicon&r=PG", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4867997/kyle"}, "reply_to_user": {"reputation": 115, "user_id": 4513792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WYnVt.png?s=128&g=1", "display_name": "Dave 2.71828", "link": "https://stackoverflow.com/users/4513792/dave-2-71828"}, "edited": false, "score": 0, "creation_date": 1430859220, "post_id": 30062011, "comment_id": 48241100, "body": "Assuming that sComparisonText starts with the value &#39;8&quot;&#39;: <code>sComparisonText = &quot;&quot;&quot;&quot; &amp; sComparisonText &amp; &quot;&quot;&quot;&quot;&quot;&quot;</code> Escaping quotes in VBA is kind of weird."}], "tags": [], "owner": {"reputation": 1, "user_id": 4867997, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/5ae8779c0ac84bf9f2b4c8914654e3ce?s=128&d=identicon&r=PG", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4867997/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1430855492, "creation_date": 1430855492, "answer_id": 30062011, "question_id": 30061855, "link": "https://stackoverflow.com/questions/30061855/excel-2007-vba-range-find-method-cant-locate-cell-containing-8-2-chars-long/30062011#30062011", "title": "Excel 2007 vba range.find method can&#39;t locate cell containing: 8&quot; (2 chars long, pronounced: 8 inches)", "body": "<pre><code>range.find \"8\"\"\" \n</code></pre>\n\n<p>Should do the trick. The first two quotes at the end escape the actual <code>\"</code> character, and the third quote terminates the string.</p>\n"}, {"comments": [{"owner": {"reputation": 115, "user_id": 4513792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WYnVt.png?s=128&g=1", "display_name": "Dave 2.71828", "link": "https://stackoverflow.com/users/4513792/dave-2-71828"}, "edited": false, "score": 0, "creation_date": 1430857673, "post_id": 30062116, "comment_id": 48240388, "body": "1) I though xlPart would match a cell with more content than just the search string, whereas xlWhole required the match to be with the entire contents of the cell.  Functionally, I need the later.  Have I misunderstood the use of the constants xlPart and xlWhole?     2)  Your WhatIsInThere() utility worked great!  It reported pretty much what we&#39;d expected:  a 2 character long string, 1st char = ASCII 8 or Decimal 56, and the 2nd char = ASCII &quot; or Decimal 34."}], "tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1430857078, "last_edit_date": 1430857078, "creation_date": 1430855821, "answer_id": 30062116, "question_id": 30061855, "link": "https://stackoverflow.com/questions/30061855/excel-2007-vba-range-find-method-cant-locate-cell-containing-8-2-chars-long/30062116#30062116", "title": "Excel 2007 vba range.find method can&#39;t locate cell containing: 8&quot; (2 chars long, pronounced: 8 inches)", "body": "<p>The first thing to consider is using <strong>xlPart</strong> rather than <strong>xlWhole</strong></p>\n\n<p>The second thing is to verify you really have double-quotes rather than a pair of single quotes.  Click on the miscreant cell and run:</p>\n\n<pre><code>Sub WhatIsInThere()\n    Dim st As String, msg As String\n    Dim i As Long, CH As String\n\n    st = ActiveCell.Text\n    msg = Len(st)\n    For i = 1 To Len(st)\n        CH = Mid(st, i, 1)\n        msg = msg &amp; vbCrLf &amp; CH &amp; vbTab &amp; Asc(CH)\n    Next i\n    MsgBox msg\nEnd Sub\n</code></pre>\n\n<p>To see an example of finding something with a trail double-quote, start with an empty worksheet and run:</p>\n\n<pre><code>Sub EightInchNails()\n    Dim DQ As String, WhereIsIt As Range\n    DQ = Chr(34)\n    Range(\"A15\").Value = \"8\" &amp; DQ\n\n    Set WhereIsIt = Range(\"A:A\").Find(what:=\"8\" &amp; DQ, after:=Range(\"A1\"), LookIn:=xlValues, LookAt:=xlPart)\n\n    If WhereIsIt Is Nothing Then\n    Else\n        MsgBox WhereIsIt.Address(0, 0)\n    End If\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "is_accepted": true, "score": 1, "last_activity_date": 1430867845, "creation_date": 1430867845, "answer_id": 30064820, "question_id": 30061855, "link": "https://stackoverflow.com/questions/30061855/excel-2007-vba-range-find-method-cant-locate-cell-containing-8-2-chars-long/30064820#30064820", "title": "Excel 2007 vba range.find method can&#39;t locate cell containing: 8&quot; (2 chars long, pronounced: 8 inches)", "body": "<p>It isn't clear why you are trying to escape something that isn't a string literal.  The reason you need to escape double-quotes in a string literal is so the <strong><em>compiler</em></strong> can parse it.  The <code>.Find</code> function only expects a single <code>\"</code> if you are only looking for a single <code>\"</code>.  If you already have a string stored in a variable that contains <code>\"</code> in the string, use that.  If you need to add one to a string, you can either use <code>Chr$(34)</code> or the escaped string literal <code>\"\"\"\"</code>. They give you exactly the same resulting string:</p>\n\n<pre><code>Dim sComparisonText As String\nDim rResult As Range\n\nsComparisonText = 8 &amp; Chr$(34) \nSet rResult = ActiveSheet.Cells.Find(What:=sComparisonText, LookIn:=xlValues, _\n              LookAt:=xlWhole, SearchOrder:=xlByColumns, _\n              SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\nDebug.Print rResult.Address\n</code></pre>\n\n<p>...is the same as...</p>\n\n<pre><code>sComparisonText = \"8\"\"\"\nSet rResult = ActiveSheet.Cells.Find(What:=sComparisonText, LookIn:=xlValues, _\n              LookAt:=xlWhole, SearchOrder:=xlByColumns, _\n              SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\nDebug.Print rResult.Address\n</code></pre>\n\n<p>...is the same as...</p>\n\n<pre><code>sComparisonText = 8 &amp; \"\"\"\"\n</code></pre>\n\n<p>...etc.</p>\n\n<p>The escape sequence has no meaning outside the compiler.</p>\n"}], "owner": {"reputation": 115, "user_id": 4513792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/WYnVt.png?s=128&g=1", "display_name": "Dave 2.71828", "link": "https://stackoverflow.com/users/4513792/dave-2-71828"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 0, "accepted_answer_id": 30064820, "answer_count": 3, "score": 1, "last_activity_date": 1430867845, "creation_date": 1430854896, "question_id": 30061855, "link": "https://stackoverflow.com/questions/30061855/excel-2007-vba-range-find-method-cant-locate-cell-containing-8-2-chars-long", "title": "Excel 2007 vba range.find method can&#39;t locate cell containing: 8&quot; (2 chars long, pronounced: 8 inches)", "body": "<p>In a particular 1-column-wide range in a spreadsheet I need to use Excel 2007 VBA's <code>range.find</code> method to locate a text-valued cell containing the 2-character long value:  8\"  (pronounced in the US as Eight Inches).  The <code>.find</code> method is in a sub that works fine for all other searches it's doing, but it cannot seem to find 8\", or in fact any text value with a trailing double-quotation mark.  </p>\n\n<p>In the code below, initially <code>sComparisonText</code> contains <code>8\"</code>    </p>\n\n<p>I've tried adding from 1 to 6 double-quotation marks to the end of <code>sComparisonText</code>, using <code>Chr(34)</code>, but the .find method still returns Nothing.</p>\n\n<p>Various searches have noted the <code>Chr(34)</code> approach, and also stacking double-quotation marks:  <code>\"\"\"\"</code> resolves to <code>\"</code>, <code>\"\"\"\"\"\"</code> resolves to <code>\"\"</code>, etc.  I've also looked into the <code>.find</code> method having a specialty escape character, but no success there either.</p>\n\n<pre><code>If Right(sComparisonText, 1) = \"\"\"\" Then\n    sComparisonText = sComparisonText &amp; Chr(34) &amp; Chr(34) &amp; Chr(34) &amp; Chr(34) &amp; Chr(34) &amp; Chr(34)\nEnd If\nSet rResult = rCT.Columns(InputColumn).Find(What:=sComparisonText, LookIn:=xlValues, LookAt:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False, SearchFormat:=False)\nIf (rResult Is Nothing) Then  'Add a new row to the bottom of the rCT range\n</code></pre>\n\n<p>Can someone tell me what I'm doing wrong?</p>\n\n<p>Thank you very much!\nDave</p>\n"}, {"tags": ["vba", "ms-access", "recordset"], "comments": [{"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 1, "creation_date": 1430857652, "post_id": 30061517, "comment_id": 48240376, "body": "What do you want to do with the recordset?  If you only want to look at something in it, try <code>Me.RecordsetClone</code>."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1430858016, "post_id": 30061517, "comment_id": 48240605, "body": "You can also consider an unbound form."}, {"owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "edited": false, "score": 0, "creation_date": 1430861044, "post_id": 30061517, "comment_id": 48241887, "body": "HansUp: I need to loop through all records in the recordset to search for duplicate combo box assignments. The form should also be editable so I&#39;m not sure if RecordsetClone would work since I think it is read only. PeterT: What do you mean by that?"}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1430906886, "creation_date": 1430906886, "answer_id": 30073629, "question_id": 30061517, "link": "https://stackoverflow.com/questions/30061517/how-to-reference-the-recordset-in-a-form-without-using-openrecordset/30073629#30073629", "title": "How to reference the recordset in a form without using Openrecordset()?", "body": "<blockquote>\n  <p>I'm not sure if RecordsetClone would work since I think it is read\n  only.</p>\n</blockquote>\n\n<p>This is the type of comments I never learn to understand. Why don't you just try? It will take you less time than sitting wondering.</p>\n\n<p>So follow Hans. The recordset will be updatable at the same level as the form.</p>\n"}], "owner": {"reputation": 769, "user_id": 4769865, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/oxMAK.gif?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/4769865/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1430906886, "creation_date": 1430853755, "question_id": 30061517, "link": "https://stackoverflow.com/questions/30061517/how-to-reference-the-recordset-in-a-form-without-using-openrecordset", "title": "How to reference the recordset in a form without using Openrecordset()?", "body": "<p>Is there a way to reference the recordset of a form without using Openrecordset()? My form has different records depending on different conditions, so it gets a little messy to do it that way. Is there anything similar to Me.Form.Recordset (which doesn't work, btw) that I can use? Thanks!</p>\n"}, {"tags": ["vba", "loops", "excel"], "comments": [{"owner": {"reputation": 1704, "user_id": 3070421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f25d8baf21f5d7b70da30b9cea62f71?s=128&d=identicon&r=PG&f=1", "display_name": "Sobigen", "link": "https://stackoverflow.com/users/3070421/sobigen"}, "edited": false, "score": 0, "creation_date": 1430852777, "post_id": 30061169, "comment_id": 48237486, "body": "Will there always be a - as a deliminator between product and variation?"}], "answers": [{"comments": [{"owner": {"reputation": 309, "user_id": 2026655, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3478339daa38d9d2a9a3f7fff87c5dd7?s=128&d=identicon&r=PG", "display_name": "Alex Klinghoffer", "link": "https://stackoverflow.com/users/2026655/alex-klinghoffer"}, "edited": false, "score": 0, "creation_date": 1430857307, "post_id": 30061431, "comment_id": 48240190, "body": "Hey thanks for the response. And it doesn&#39;t look like it works. Do you need to declare the variables this_prefix and last_prefix?"}, {"owner": {"reputation": 1118, "user_id": 3185763, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/30d9ad93840eec6e8c0b67b4210decf2?s=128&d=identicon&r=PG&f=1", "display_name": "jcropp", "link": "https://stackoverflow.com/users/3185763/jcropp"}, "reply_to_user": {"reputation": 309, "user_id": 2026655, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3478339daa38d9d2a9a3f7fff87c5dd7?s=128&d=identicon&r=PG", "display_name": "Alex Klinghoffer", "link": "https://stackoverflow.com/users/2026655/alex-klinghoffer"}, "edited": false, "score": 0, "creation_date": 1430865077, "post_id": 30061431, "comment_id": 48243480, "body": "Declare them and see if that works.  If not, put in a <code>Msgbox(this_prefix)</code> right before the <code>if</code> statement to test if it returns &quot;LDP2&quot;."}], "tags": [], "owner": {"reputation": 1118, "user_id": 3185763, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/30d9ad93840eec6e8c0b67b4210decf2?s=128&d=identicon&r=PG&f=1", "display_name": "jcropp", "link": "https://stackoverflow.com/users/3185763/jcropp"}, "is_accepted": false, "score": 0, "last_activity_date": 1430853455, "creation_date": 1430853455, "answer_id": 30061431, "question_id": 30061169, "link": "https://stackoverflow.com/questions/30061169/how-to-loop-through-an-excel-column-and-find-changes-in-product-names/30061431#30061431", "title": "How to loop through an Excel column and find changes in product names?", "body": "<p>Try:</p>\n\n<pre><code>Dim rw As Long\nDim lr As Long\nDim cnt As Long\nlr = 500\nrw = 2\ncnt = 1\nlast_prefix = \"\"\nDo\n    this_prefix = left(Range(\"A\" &amp; cnt).Value, 4)\n    If this_prefix &lt;&gt; last_prefix\n        Rows(rw).Insert Shift:=xlDown\n        cnt = cnt + 1\n    Else\n        cnt = cnt + 1\n    End If\n    last_prefix = this_prefix\n    rw = rw + 1\nLoop While rw &lt;&gt; lr\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3845, "user_id": 4288101, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O0Xld.jpg?s=128&g=1", "display_name": "Byron Wall", "link": "https://stackoverflow.com/users/4288101/byron-wall"}, "is_accepted": true, "score": 1, "last_activity_date": 1430853491, "creation_date": 1430853491, "answer_id": 30061441, "question_id": 30061169, "link": "https://stackoverflow.com/questions/30061169/how-to-loop-through-an-excel-column-and-find-changes-in-product-names/30061441#30061441", "title": "How to loop through an Excel column and find changes in product names?", "body": "<p><code>Split</code> is the function you are looking for if you will always have a single <code>-</code> in the name.  It will give you each part of the name and you can then compare to the previous row.</p>\n\n<p>Here is code that works for your example.</p>\n\n<pre><code>Sub SplitProductName()\n\n    Dim rng_cell As Range\n    Dim str_prev As String\n\n    For Each rng_cell In Range(Range(\"A1\"), Range(\"A1\").End(xlDown))\n\n        Dim parts As Variant\n\n        parts = Split(rng_cell, \"-\")\n\n        'check that it is different\n        If parts(0) &lt;&gt; str_prev Then\n            rng_cell.EntireRow.Insert xlUp\n        End If\n\n        'assign previous for next row\n        str_prev = parts(0)\n\n    Next rng_cell\nEnd Sub\n</code></pre>\n\n<p><strong>Before</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/E75G3.png\" alt=\"before macro\"></p>\n\n<p><strong>After</strong></p>\n\n<p><img src=\"https://i.stack.imgur.com/SDRDP.png\" alt=\"after macro\"></p>\n"}, {"tags": [], "owner": {"reputation": 956, "user_id": 3469496, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/4jWVm.jpg?s=128&g=1", "display_name": "CactusCake", "link": "https://stackoverflow.com/users/3469496/cactuscake"}, "is_accepted": false, "score": 0, "last_activity_date": 1430853513, "creation_date": 1430853513, "answer_id": 30061449, "question_id": 30061169, "link": "https://stackoverflow.com/questions/30061169/how-to-loop-through-an-excel-column-and-find-changes-in-product-names/30061449#30061449", "title": "How to loop through an Excel column and find changes in product names?", "body": "<p>You can check just the beginning of a cell's value with <code>Left</code>, like this:</p>\n\n<pre><code>Sub InsertHeaders()\n\nDim rw As Long\nDim lr As Long\nDim cnt As Long\nlr = 500\nrw = 2\ncnt = 1\nDo\n    If Range(\"A\" &amp; cnt).Value &lt;&gt; \"\" And Left(Range(\"A\" &amp; cnt).Value, 4) &lt;&gt; Left(Range(\"A\" &amp; cnt + 1).Value, 4) Then\n        Rows(rw).Insert Shift:=xlDown\n        cnt = cnt + 1\n    Else\n        cnt = cnt + 1\n    End If\n    rw = rw + 1\nLoop While rw &lt;&gt; lr\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 309, "user_id": 2026655, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3478339daa38d9d2a9a3f7fff87c5dd7?s=128&d=identicon&r=PG", "display_name": "Alex Klinghoffer", "link": "https://stackoverflow.com/users/2026655/alex-klinghoffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 30061441, "answer_count": 3, "score": 0, "last_activity_date": 1430883963, "creation_date": 1430852593, "last_edit_date": 1430883963, "question_id": 30061169, "link": "https://stackoverflow.com/questions/30061169/how-to-loop-through-an-excel-column-and-find-changes-in-product-names", "title": "How to loop through an Excel column and find changes in product names?", "body": "<p>I have an Excel sheet, and column <code>A</code> has a list of product names. Most of the products have multiple variations, such as:</p>\n\n<pre><code>A1: LDP2-sm\nA2: LDP2-med\nA3: LDP2-lg\nA4: LDP3-sm\nA5: LDP3-med\nA6: LDP3-lg\nA7: LDP3-xlg\n</code></pre>\n\n<p>Here, <code>LDP2</code> is 1 product with 3 variations and <code>LDP3</code> is 1 product with 4 variations</p>\n\n<p>How do I loop through this list and find the start of a new variation? In the above example, I'd want to find <code>A1</code> and <code>A4</code>. Then, I want to insert a row above each.</p>\n\n<p>Here is the code I have so far:</p>\n\n<pre><code>Dim rw As Long\nDim lr As Long\nDim cnt As Long\nlr = 500\nrw = 2\ncnt = 1\nDo\n    If Range(\"A\" &amp; cnt).Value = *FIRST VARIATION OF A NEW PRODUCT*\n        Rows(rw).Insert Shift:=xlDown\n        cnt = cnt + 1\n    Else\n        cnt = cnt + 1\n    End If\n    rw = rw + 1\nLoop While rw &lt;&gt; lr\n</code></pre>\n\n<p>What code do I need for <em>FIRST VARIATION OF A NEW PRODUCT</em>?</p>\n\n<p>It needs to determine if the value of the cell starts with a different prefix than the cell above it.</p>\n\n<p>I won't know what the product name starts with or how many variations the product has, but I do know that the first portion of the product name will change. I.e. <code>LDP2</code>, <code>LDP3</code>, <code>LDP4</code>, etc.</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 4867780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd29f541b99231b0e96ae181947503c?s=128&d=identicon&r=PG&f=1", "display_name": "Emily H.", "link": "https://stackoverflow.com/users/4867780/emily-h"}, "edited": false, "score": 0, "creation_date": 1430855076, "post_id": 30061172, "comment_id": 48238863, "body": "Thank you! I spent more time than I&#39;d like to admit deliberating how to solve this. Very much appreciated."}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "reply_to_user": {"reputation": 53, "user_id": 4867780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd29f541b99231b0e96ae181947503c?s=128&d=identicon&r=PG&f=1", "display_name": "Emily H.", "link": "https://stackoverflow.com/users/4867780/emily-h"}, "edited": false, "score": 0, "creation_date": 1430855194, "post_id": 30061172, "comment_id": 48238943, "body": "You&#39;re welcome.  And welcome to Stack Overflow.  :-)"}, {"owner": {"reputation": 53, "user_id": 4867780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd29f541b99231b0e96ae181947503c?s=128&d=identicon&r=PG&f=1", "display_name": "Emily H.", "link": "https://stackoverflow.com/users/4867780/emily-h"}, "edited": false, "score": 0, "creation_date": 1430858311, "post_id": 30061172, "comment_id": 48240777, "body": "I would like to add some clarifying text (i.e. Detection Method: <i>Memo1</i>) and spaces into my Comments field, but only if there is text in my Memo 1, 2 and 3 fields.  What is the best way to tackle this?"}, {"owner": {"reputation": 53, "user_id": 4867780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd29f541b99231b0e96ae181947503c?s=128&d=identicon&r=PG&f=1", "display_name": "Emily H.", "link": "https://stackoverflow.com/users/4867780/emily-h"}, "edited": false, "score": 0, "creation_date": 1430859501, "post_id": 30061172, "comment_id": 48241210, "body": "Nevermind!  I figured something out.  Thanks for your help. :)"}], "tags": [], "owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "is_accepted": true, "score": 3, "last_activity_date": 1430852602, "creation_date": 1430852602, "answer_id": 30061172, "question_id": 30061022, "link": "https://stackoverflow.com/questions/30061022/how-do-i-concatenate-memo-fields-in-access-using-vba/30061172#30061172", "title": "How do I concatenate Memo fields in Access using VBA?", "body": "<p>Load your table as a <code>DAO.Recordset</code> and update the <em>Comments</em> field in each row.</p>\n\n<p>Although this is a RBAR (row by agonizing row) approach, since it's for a migration, hopefully it will be something you need do only once.  The main benefit is it won't choke with text amounts greater than 255 characters.</p>\n\n\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim db As DAO.Database\nDim rs As DAO.Recordset\nSet db = CurrentDb\nSet rs = db.OpenRecordset(\"YourTable\", dbOpenTable)\nWith rs\n    Do While Not .EOF\n        .Edit\n        !Comments.Value = !Memo1.Value &amp; !Memo2.Value &amp; !Memo3.Value\n        .Update\n        .MoveNext\n    Loop\n    .Close\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 4867780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd29f541b99231b0e96ae181947503c?s=128&d=identicon&r=PG&f=1", "display_name": "Emily H.", "link": "https://stackoverflow.com/users/4867780/emily-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 0, "accepted_answer_id": 30061172, "answer_count": 1, "score": 5, "last_activity_date": 1430852821, "creation_date": 1430852032, "last_edit_date": 1430852821, "question_id": 30061022, "link": "https://stackoverflow.com/questions/30061022/how-do-i-concatenate-memo-fields-in-access-using-vba", "title": "How do I concatenate Memo fields in Access using VBA?", "body": "<p>I am migrating data from one data model to another and in doing so I need to concatenate a number of different Memo fields into one in order to prevent any data loss.</p>\n\n<p>I'm not very familiar with VBA but I understand that using an Update query limits my Memo fields to 255 characters.</p>\n\n<p>Can someone please provide some insight into how I should tackle this using VBA.</p>\n\n<p>Example of what I'd like to achieve:</p>\n\n<p>The comments for each record will be a result of concatenating 3 Memo fields:\n[Comments] = [Memo1] &amp; [Memo2] &amp; [Memo3]</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 1, "creation_date": 1430851240, "post_id": 30060633, "comment_id": 48236611, "body": "What exactly are you trying to achieve? Where&#39;s the problem to pass the ActiveWorkbook to your sub?"}, {"owner": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1430851369, "post_id": 30060633, "comment_id": 48236681, "body": "So if you pass the name of the table &quot;as a string&quot; ... what happens ?  Seems <code>ListObjects</code> is expecting a string, so you just need to pass the string name ? (ie not the actual table object ..) ??"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1430851599, "post_id": 30060633, "comment_id": 48236794, "body": "Procedure signatures are usually clearer when the parameters have an explicit type, and they&#39;re passed <code>ByRef</code> unless explicitly specified <code>ByVal</code> - so that procedure has two <code>ByRef table As Variant</code> parameters - i.e. it will happily take anything you throw at it. If you intend the procedure to work with <code>ListObject</code> objects, why not specify that in the signature? Or do you intend to work with strings? Then make it <code>ByVal sourceTableName As String</code>. Variants are VBA&#39;s ducks. Unless they&#39;re made of <a href=\"http://www.rubberduck-vba.com\" rel=\"nofollow noreferrer\">rubber</a>, you should avoid them."}, {"owner": {"reputation": 75, "user_id": 4864718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-XL8hHNmdvmo/AAAAAAAAAAI/AAAAAAAABh8/Ajz759Qx5N4/photo.jpg?sz=128", "display_name": "Mahmoud Tarief", "link": "https://stackoverflow.com/users/4864718/mahmoud-tarief"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1430852075, "post_id": 30060633, "comment_id": 48237068, "body": "@Mat&#39;sMug: Yes the procedure will work with list objects only I&#39;m actually not an expert in VBA, I don&#39;t know how to specify in the signature?"}, {"owner": {"reputation": 75, "user_id": 4864718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-XL8hHNmdvmo/AAAAAAAAAAI/AAAAAAAABh8/Ajz759Qx5N4/photo.jpg?sz=128", "display_name": "Mahmoud Tarief", "link": "https://stackoverflow.com/users/4864718/mahmoud-tarief"}, "reply_to_user": {"reputation": 2568, "user_id": 1354800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a71c67e2f068118e6608f28a5e40b07?s=128&d=identicon&r=PG", "display_name": "Peter Schneider", "link": "https://stackoverflow.com/users/1354800/peter-schneider"}, "edited": false, "score": 0, "creation_date": 1430852087, "post_id": 30060633, "comment_id": 48237080, "body": "@PeterSchneider, Please check on my update I will post the full code"}, {"owner": {"reputation": 75, "user_id": 4864718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-XL8hHNmdvmo/AAAAAAAAAAI/AAAAAAAABh8/Ajz759Qx5N4/photo.jpg?sz=128", "display_name": "Mahmoud Tarief", "link": "https://stackoverflow.com/users/4864718/mahmoud-tarief"}, "reply_to_user": {"reputation": 3112, "user_id": 2157378, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/00ecd09abb478d086696d9fa4f77b422?s=128&d=identicon&r=PG", "display_name": "Ditto", "link": "https://stackoverflow.com/users/2157378/ditto"}, "edited": false, "score": 0, "creation_date": 1430852097, "post_id": 30060633, "comment_id": 48237089, "body": "@Ditto Please check on my update I will post the full code"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1430852601, "post_id": 30060633, "comment_id": 48237388, "body": "<code>CopyAndFind(ByVal tableName As String, ByVal destTableName As String)</code>"}, {"owner": {"reputation": 75, "user_id": 4864718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-XL8hHNmdvmo/AAAAAAAAAAI/AAAAAAAABh8/Ajz759Qx5N4/photo.jpg?sz=128", "display_name": "Mahmoud Tarief", "link": "https://stackoverflow.com/users/4864718/mahmoud-tarief"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1430852816, "post_id": 30060633, "comment_id": 48237508, "body": "@RubberDuck: Thanks a lot... Same idea for worksheet and workbook to be passed like this?"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 1, "creation_date": 1430852919, "post_id": 30060633, "comment_id": 48237561, "body": "Yeah, but I would actually encourage you to refactor your code so that you&#39;re passing <code>ListObject</code>s and <code>Worksheet</code>s instead of strings."}, {"owner": {"reputation": 75, "user_id": 4864718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-XL8hHNmdvmo/AAAAAAAAAAI/AAAAAAAABh8/Ajz759Qx5N4/photo.jpg?sz=128", "display_name": "Mahmoud Tarief", "link": "https://stackoverflow.com/users/4864718/mahmoud-tarief"}, "reply_to_user": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "edited": false, "score": 0, "creation_date": 1430853050, "post_id": 30060633, "comment_id": 48237633, "body": "@RubberDuck: Can you provide 1 example and I&#39;ll do the research. I appreciate the help"}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 4864718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-XL8hHNmdvmo/AAAAAAAAAAI/AAAAAAAABh8/Ajz759Qx5N4/photo.jpg?sz=128", "display_name": "Mahmoud Tarief", "link": "https://stackoverflow.com/users/4864718/mahmoud-tarief"}, "edited": false, "score": 0, "creation_date": 1430853754, "post_id": 30061433, "comment_id": 48238056, "body": "awesome. What I don&#39;t get is why initializing listObjects in new sub?"}, {"owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "reply_to_user": {"reputation": 75, "user_id": 4864718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-XL8hHNmdvmo/AAAAAAAAAAI/AAAAAAAABh8/Ajz759Qx5N4/photo.jpg?sz=128", "display_name": "Mahmoud Tarief", "link": "https://stackoverflow.com/users/4864718/mahmoud-tarief"}, "edited": false, "score": 0, "creation_date": 1430853828, "post_id": 30061433, "comment_id": 48238098, "body": "Because you have to call it from <i>somewhere</i>. You can&#39;t run parameterized procedures without passing them parameters."}, {"owner": {"reputation": 75, "user_id": 4864718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-XL8hHNmdvmo/AAAAAAAAAAI/AAAAAAAABh8/Ajz759Qx5N4/photo.jpg?sz=128", "display_name": "Mahmoud Tarief", "link": "https://stackoverflow.com/users/4864718/mahmoud-tarief"}, "edited": false, "score": 0, "creation_date": 1430854720, "post_id": 30061433, "comment_id": 48238629, "body": "Worked..This is how I called the sub:  Sub Save()  Dim sourceTable As ListObject     Set sourceTable = ThisWorkbook.Worksheets(&quot;Sheet1&quot;).ListObjects(&quot;Table1&quot;)      Dim destTable As ListObject     Set destTable = ThisWorkbook.Worksheets(&quot;Sheet2&quot;).ListObjects(&quot;Table2&quot;)   Call Copyandfind(sourceTable, destTable)  End Sub"}], "tags": [], "owner": {"reputation": 10086, "user_id": 3198973, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cPPKQ.png?s=128&g=1", "display_name": "RubberDuck", "link": "https://stackoverflow.com/users/3198973/rubberduck"}, "is_accepted": true, "score": 2, "last_activity_date": 1430853456, "creation_date": 1430853456, "answer_id": 30061433, "question_id": 30060633, "link": "https://stackoverflow.com/questions/30060633/passing-excel-table-name-in-vba-sub-procedure-argument/30061433#30061433", "title": "passing excel table name in vba sub procedure argument", "body": "<p>Here. I didn't test it.</p>\n\n<pre><code>Sub Test()\n\n    Dim sourceTable As ListObject\n    Set sourceTable = ThisWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\")\n\n    Dim destTable As ListObject\n    Set destTable = ThisWorkbook.Worksheets(\"Sheet2\").ListObjects(\"Table2\")\n\n    Copyandfind\n\nEnd Sub\n\nSub Test2()\n\n    Copyandfind ThisWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\"), ThisWorkbook.Worksheets(\"Sheet2\").ListObjects(\"Table2\")\n\nEnd Sub\n\n\nSub Copyandfind(ByVal sourceTable As ListObject, ByVal destTable As ListObject)\n\n    SourceTableColumnCount = sourceTable.Range.Columns.Count\n    SourceTableRowCount = sourceTable.ListRows.Count\n    DestRowIndex = destTable.ListRows.Count\n\n\n    i = 1\n    r = 0\n\n    Do While r &lt; SourceTableRowCount\n\n        destTable.ListRows.Add AlwaysInsert:=True\n\n            Do While i &lt;= SourceTableColumnCount\n\n                    ColumnName = sourceTable.HeaderRowRange(i).Value\n                    On Error Resume Next\n                    DestColumnIndex = destTable.Range.Find(ColumnName, MatchCase:= _\n                    True, SearchFormat:=False, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, LookAt:=xlWhole).Column\n                        If Err.Number &lt;&gt; 0 Then\n                            'In case column name in source table is not found in destination table\n                        Else\n                            destTable.DataBodyRange(DestRowIndex + 1, DestColumnIndex).Value = sourceTable.DataBodyRange(r + 1, i).Value\n                        End If\n                    i = i + 1\n            Loop\n\n        r = r + 1\n        i = 1\n        DestRowIndex = DestRowIndex + 1\n    Loop\n    MsgBox (\"Total records saved: \" &amp; SourceTableRowCount)\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 4864718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-XL8hHNmdvmo/AAAAAAAAAAI/AAAAAAAABh8/Ajz759Qx5N4/photo.jpg?sz=128", "display_name": "Mahmoud Tarief", "link": "https://stackoverflow.com/users/4864718/mahmoud-tarief"}, "edited": false, "score": 0, "creation_date": 1430854948, "post_id": 30061616, "comment_id": 48238784, "body": "Thanks, I&#39;m actually not very much an expert in VBA. I&#39;m still learning. I didn&#39;t get what this should this do."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 75, "user_id": 4864718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-XL8hHNmdvmo/AAAAAAAAAAI/AAAAAAAABh8/Ajz759Qx5N4/photo.jpg?sz=128", "display_name": "Mahmoud Tarief", "link": "https://stackoverflow.com/users/4864718/mahmoud-tarief"}, "edited": false, "score": 0, "creation_date": 1430855098, "post_id": 30061616, "comment_id": 48238879, "body": "The first one would look for and intersect of the table&#39;s range and your defined range. If there is an intersect, it would define the listobject as the output."}, {"owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "reply_to_user": {"reputation": 75, "user_id": 4864718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-XL8hHNmdvmo/AAAAAAAAAAI/AAAAAAAABh8/Ajz759Qx5N4/photo.jpg?sz=128", "display_name": "Mahmoud Tarief", "link": "https://stackoverflow.com/users/4864718/mahmoud-tarief"}, "edited": false, "score": 0, "creation_date": 1430855190, "post_id": 30061616, "comment_id": 48238942, "body": "As the listobject is part of the worksheet, the second looks at every listobject in every worksheet of the active workbook. If its name matches your string, then it returns the table as a listobject."}], "tags": [], "owner": {"reputation": 1108, "user_id": 3819867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e08ff6f1bdf2ba013a902e5448de0cb6?s=128&d=identicon&r=PG&f=1", "display_name": "user3819867", "link": "https://stackoverflow.com/users/3819867/user3819867"}, "is_accepted": false, "score": 0, "last_activity_date": 1430855458, "last_edit_date": 1430855458, "creation_date": 1430854108, "answer_id": 30061616, "question_id": 30060633, "link": "https://stackoverflow.com/questions/30060633/passing-excel-table-name-in-vba-sub-procedure-argument/30061616#30061616", "title": "passing excel table name in vba sub procedure argument", "body": "<p>I would request ranges as inputs. The macro would start out with looking for an intersect of the range and a listobject in the worksheet along the lines of this macro.</p>\n\n<pre><code>Sub dfg(rng1 As Range)\nDim lo1 As ListObject, ws As Worksheet, lo As ListObject\nSet ws = rng1.Worksheet\n\nFor Each lo1 In ws.ListObjects\n    If Intersect(lo1.Range, rng1).Cells.Count &gt; 0 Then Set lo = lo1\nNext\nlo.Range.AutoFilter Field:=1, Criteria1:=\"=\", Operator:=xlAnd\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT</strong>\nMore clear, more concise:</p>\n\n<pre><code>Function DefineTable(str1 As String)\nDim lo As ListObject\nFor Each Worksheet In ActiveWorkbook.Worksheets\n    For Each lo In Worksheet.ListObjects\n        If lo.Name = str1 Then Set DefineTable = lo\n    Next\nNext\nEnd Function\nSub ert()\nDim str1 As String, lo As ListObject\nstr1 = \"T\u00e1bl\u00e1zat1\"\nSet lo = DefineTable(str1)\nlo.Range.AutoFilter Field:=1, Criteria1:=\"=\", Operator:=xlAnd\nEnd Sub\n</code></pre>\n\n<p>The DefineTable will find your name and spit out the listobject.</p>\n\n<p><strong>EDIT2</strong>\nFresher than ever before:</p>\n\n<pre><code>Function DefineTable(str1 As String, Optional wb1 As Workbook)\nDim lo As ListObject, wb As Workbook\n\nIf wb1 Is Nothing Then\n        Set wb = ActiveWorkbook\n    Else\n        Set wb = wb1\nEnd If\n\nFor Each Worksheet In wb.Worksheets\n    For Each lo In Worksheet.ListObjects\n        If lo.Name = str1 Then Set DefineTable = lo\n    Next\nNext\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 4864718, "user_type": "registered", "accept_rate": 91, "profile_image": "https://lh3.googleusercontent.com/-XL8hHNmdvmo/AAAAAAAAAAI/AAAAAAAABh8/Ajz759Qx5N4/photo.jpg?sz=128", "display_name": "Mahmoud Tarief", "link": "https://stackoverflow.com/users/4864718/mahmoud-tarief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4293, "favorite_count": 0, "accepted_answer_id": 30061433, "answer_count": 2, "score": -2, "last_activity_date": 1430855458, "creation_date": 1430850613, "last_edit_date": 1430852229, "question_id": 30060633, "link": "https://stackoverflow.com/questions/30060633/passing-excel-table-name-in-vba-sub-procedure-argument", "title": "passing excel table name in vba sub procedure argument", "body": "<p>I have an excel VBA sub procedure and I want to pass names of excel tables in the workbook to the arguments of this sub.</p>\n\n<p>For example:</p>\n\n<pre><code>Sub Copyandfind()\n\nSourceTableColumnCount = ThisWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\").Range.Columns.Count\nSourceTableRowCount = ThisWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\").ListRows.Count\nDestRowIndex = ThisWorkbook.Worksheets(\"Sheet2\").ListObjects(\"Table2\").ListRows.Count\n\n\ni = 1\nr = 0\n\nDo While r &lt; SourceTableRowCount\n\n    ThisWorkbook.Worksheets(\"Sheet2\").ListObjects(\"Table2\").ListRows.Add AlwaysInsert:=True\n\n        Do While i &lt;= SourceTableColumnCount\n\n                ColumnName = ThisWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\").HeaderRowRange(i).Value\n                On Error Resume Next\n                DestColumnIndex = ThisWorkbook.Worksheets(\"Sheet2\").ListObjects(\"Table2\").Range.Find(ColumnName, MatchCase:= _\n                True, SearchFormat:=False, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, LookAt:=xlWhole).column\n                    If Err.Number &lt;&gt; 0 Then\n                        'In case column name in source table is not found in destination table\n                    Else\n                        ThisWorkbook.Worksheets(\"Sheet2\").ListObjects(\"Table2\").DataBodyRange(DestRowIndex + 1, _\n                        DestColumnIndex).Value = _\n                        ThisWorkbook.Worksheets(\"Sheet1\").ListObjects(\"Table1\").DataBodyRange(r + 1, i).Value\n                    End If\n                i = i + 1\n        Loop\n\n    r = r + 1\n    i = 1\n    DestRowIndex = DestRowIndex + 1\nLoop\nMsgBox (\"Total records saved: \" &amp; SourceTableRowCount)\n\nEnd Sub\n</code></pre>\n\n<p>I need to replace all table1 and table2 to be passed as arguments to use this procedure with different tables by just passing table names.</p>\n\n<p>Thanks..</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1431029270, "post_id": 30060903, "comment_id": 48332215, "body": "so how does this fit in the SQL?"}, {"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1431042547, "post_id": 30060903, "comment_id": 48337868, "body": "OK...I think you mean :   SELECT Count(DISTINCT QAttendedLast30days.MemberID) AS CountOfMemberID FROM QAttendedLast30days;                                                  but I get &quot;Syntax Error (missing operator in query expression &#39;Count(DISTINCT QAttendedLast30days.MemberID)&#39;"}, {"owner": {"reputation": 362892, "user_id": 256196, "user_type": "moderator", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d84b558fd67be10d5a718fb94231909d?s=128&d=identicon&r=PG", "display_name": "Bohemian", "link": "https://stackoverflow.com/users/256196/bohemian"}, "reply_to_user": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1431042782, "post_id": 30060903, "comment_id": 48337937, "body": "Your SQL looks OK. To help debug this, please create an <a href=\"http://sqlfiddle.com\" rel=\"nofollow noreferrer\">SQLFiddle</a> and post the link."}, {"owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "edited": false, "score": 0, "creation_date": 1431124462, "post_id": 30060903, "comment_id": 48377675, "body": "SUCCESS....so the answer was found at this post: <a href=\"http://stackoverflow.com/questions/11880199/how-do-i-count-unique-items-in-field-in-access-query\" title=\"how do i count unique items in field in access query\">stackoverflow.com/questions/11880199/&hellip;</a>   .  The trick was the format as indicated in the post."}], "tags": [], "owner": {"reputation": 362892, "user_id": 256196, "user_type": "moderator", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d84b558fd67be10d5a718fb94231909d?s=128&d=identicon&r=PG", "display_name": "Bohemian", "link": "https://stackoverflow.com/users/256196/bohemian"}, "is_accepted": true, "score": 1, "last_activity_date": 1430851662, "creation_date": 1430851662, "answer_id": 30060903, "question_id": 30060369, "link": "https://stackoverflow.com/questions/30060369/can-anyone-figure-out-how-to-get-a-query-to-return-a-count-of-distinct-records/30060903#30060903", "title": "can anyone figure out how to get a query to return a count of distinct records?", "body": "<p>Use <code>count distinct ...)</code>:</p>\n\n<pre><code>select count(distinct memberId) memberCount\nfrom mytable\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 4526197, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/e752e7969ab15fcb1df21ae1e6544e2a?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4526197/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 30060903, "answer_count": 1, "score": -1, "last_activity_date": 1594644707, "creation_date": 1430849823, "last_edit_date": 1594644707, "question_id": 30060369, "link": "https://stackoverflow.com/questions/30060369/can-anyone-figure-out-how-to-get-a-query-to-return-a-count-of-distinct-records", "title": "can anyone figure out how to get a query to return a count of distinct records?", "body": "<p>I have a simple query:</p>\n\n<p><img src=\"https://i.stack.imgur.com/mv5ak.jpg\" alt=\"enter image description here\"></p>\n\n<p>If these are the query results :</p>\n\n<p><img src=\"https://i.stack.imgur.com/O0Nom.jpg\" alt=\"enter image description here\"></p>\n\n<p>Record Count =16.  How can I find the count of \u201cdistinct\u201d MemberIDs?  Should be 7.</p>\n\n<p>This is the SQL:</p>\n\n<p>SELECT tblAttendanceHistory.ActivityDate, tblAttendanceHistory.MemberID, tblAttendanceHistory.Attended\nFROM tblAttendanceHistory\nGROUP BY tblAttendanceHistory.ActivityDate, tblAttendanceHistory.MemberID, tblAttendanceHistory.Attended\nHAVING (((tblAttendanceHistory.ActivityDate)Date()-30) AND ((tblAttendanceHistory.Attended)=True))\nORDER BY tblAttendanceHistory.MemberID;</p>\n\n<p>Where would your suggestion fit?</p>\n"}, {"tags": ["vb.net", "vba", "substring"], "comments": [{"owner": {"reputation": 37205, "user_id": 1070452, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/osssV.jpg?s=128&g=1", "display_name": "\u0147\u024fssa P&#248;ngj\u01e3rdenlarp", "link": "https://stackoverflow.com/users/1070452/%c5%87%c9%8fssa-p%c3%b8ngj%c7%a3rdenlarp"}, "edited": false, "score": 1, "creation_date": 1430848527, "post_id": 30059930, "comment_id": 48234860, "body": "If you are comfortable with the legacy VB functions like <code>Len</code> and <code>Instr</code> then use them.  Personally, I dislike them because so many of them involve boxing arguments to and from Object with no other benefit.  &quot;Longer code&quot; is less meaningful than the boxing."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 5, "creation_date": 1430848920, "post_id": 30059930, "comment_id": 48235112, "body": "stringDate.Substring(stringDate.IndexOf(&quot;:&quot;) + 1).Trim() is shorter and does not bomb."}, {"owner": {"reputation": 370, "user_id": 4842378, "user_type": "registered", "profile_image": "https://graph.facebook.com/956662497699762/picture?type=large", "display_name": "Scott", "link": "https://stackoverflow.com/users/4842378/scott"}, "edited": false, "score": 0, "creation_date": 1430849228, "post_id": 30059930, "comment_id": 48235303, "body": "When doing.Net development I prefer the methods off of string for a couple of reasons.  For one, the VB versions are not instance methods so they have to check if the string passed in is null.  This can be a lot of unnecessary checks if you already know your string isn&#39;t null.  The more concerning issue is that methods like InStr use a one-base index instead of zero-base.  This doesn&#39;t play well with the .Net String functions that are zero-base.  Many developers also don&#39;t expect one-base results either."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1430849431, "post_id": 30059930, "comment_id": 48235437, "body": "Perhaps if <code>C$</code> had a meaningful name we (and/or maintainers of this code) could <i>glance</i> at it and know what it&#39;s <i>supposed</i> to be doing... oh right, it&#39;s extracting the <i>date</i> part of the string. If the format is fixed then you can greatly simplify this by just taking the 16 right-most characters..."}, {"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1430850261, "post_id": 30059930, "comment_id": 48235993, "body": "Thank to everybody. I&#39;ve a lot to learn..."}], "answers": [{"comments": [{"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1430987938, "post_id": 30063573, "comment_id": 48303789, "body": "Is it possible to use regex (without if ... else) for distinguish between &quot;Happy Xmas: 25/12/2014&quot; and &quot;Happy Xmas: 25/12/2014 10:04&quot; so to extract date or Date and time? If &quot;If...else&quot; are necessary I think it will be more easy to use substring."}, {"owner": {"reputation": 871, "user_id": 2115369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYR3O.png?s=128&g=1", "display_name": "Top Systems", "link": "https://stackoverflow.com/users/2115369/top-systems"}, "reply_to_user": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1430990683, "post_id": 30063573, "comment_id": 48305696, "body": "No, it is not necessary to use &quot;if .. else&quot;, you can check multiple date formats, just use the pipe <code>|</code> to separate the different patterns, for example : <code>\\d{2}&#47;\\d{2}&#47;\\d{4} \\d{2}:\\d{2}|\\d{2}&#47;\\d{2}&#47;\\d{4}</code>, this pattern will extract the both formats &quot;date&quot; and &quot;datetime&quot;."}, {"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1431013191, "post_id": 30063573, "comment_id": 48322668, "body": "It is great! Thanks. Only a last question: The obtained string is in format <code>&quot;dd&#47;mm&#47;yyyy hh:mm&quot;</code> but I need it in format <code>&quot;yyyy-mm-dd hh:mm&quot;</code> but <code>.ToString(&quot;yyyy-MM-dd hh:mm&quot;)</code> doesn&#39;t seems to work ... any idea?"}, {"owner": {"reputation": 871, "user_id": 2115369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYR3O.png?s=128&g=1", "display_name": "Top Systems", "link": "https://stackoverflow.com/users/2115369/top-systems"}, "reply_to_user": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1431017672, "post_id": 30063573, "comment_id": 48325642, "body": "You are welcome,  Do you mean that the input string contains dates in &quot;yyyy-mm-dd hh:mm&quot; format?  If so, you can replace <code>&#47;</code> in the pattern with <code>-</code> or even you can replace it with <code>[.&#47;-]</code> and in this case you can extract date formats like : <code>&quot;yyyy-mm-dd hh:mm&quot;</code> or <code>&quot;yyyy.mm.dd hh:mm&quot;</code> or <code>&quot;yyyy&#47;mm&#47;dd hh:mm&quot;</code>  But if you meant converting the <code>m.Value</code> from <code>&quot;yyyy&#47;mm&#47;dd hh:mm&quot;</code> format to <code>&quot;yyyy-mm-dd hh:mm&quot;</code> then you can simply use <code>m.Value.Replace(&quot;&#47;&quot;, &quot;-&quot;)</code>"}, {"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1431017896, "post_id": 30063573, "comment_id": 48325777, "body": "I mean converting &quot;dd/mm/yyyy hh:mm&quot; (for example 25/12/2014 12:30) to mySql style &quot;yyyy-mm-dd hh:mm&quot; (for example 2014-12-25 12:30)"}, {"owner": {"reputation": 871, "user_id": 2115369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYR3O.png?s=128&g=1", "display_name": "Top Systems", "link": "https://stackoverflow.com/users/2115369/top-systems"}, "reply_to_user": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "edited": false, "score": 0, "creation_date": 1431020384, "post_id": 30063573, "comment_id": 48327188, "body": "<code>Dim dt As String = Convert.ToDateTime(&quot;25&#47;12&#47;2014 11:31&quot;).ToString(&quot;yyyy-MM-dd hh:mm&quot;)</code>"}, {"owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "reply_to_user": {"reputation": 871, "user_id": 2115369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYR3O.png?s=128&g=1", "display_name": "Top Systems", "link": "https://stackoverflow.com/users/2115369/top-systems"}, "edited": false, "score": 0, "creation_date": 1431021373, "post_id": 30063573, "comment_id": 48327768, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/77234/discussion-between-genespos-and-muhammad\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 871, "user_id": 2115369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oYR3O.png?s=128&g=1", "display_name": "Top Systems", "link": "https://stackoverflow.com/users/2115369/top-systems"}, "is_accepted": true, "score": 1, "last_activity_date": 1430861482, "creation_date": 1430861482, "answer_id": 30063573, "question_id": 30059930, "link": "https://stackoverflow.com/questions/30059930/converting-right-and-instr-into-vb-net-substring/30063573#30063573", "title": "Converting Right and Instr into vb.net Substring", "body": "<p>I think that using Regex is the best way to extract the date from string, because you may use a different string every time, for example :</p>\n\n<pre><code>Dim stringDate = \"something happens: 03/12/2014 11:00\"\nDim stringDate = \"something 03/12/2014 11:00\"\nDim stringDate = \"something happens:::&gt;&gt; 03/12/2014 11:00\"\n</code></pre>\n\n<p>With the following code you can extract the date from all this strings :</p>\n\n<pre><code>Dim m As Match = New Regex(\"\\d{2}/\\d{2}/\\d{4} \\d{2}:\\d{2}\").Match(stringDate)\nIf m.Success Then\n    MsgBox(m.Value)\nEnd If\n</code></pre>\n\n<p>But if you don't care about \"Date\" and just asking about <code>Right</code> and <code>Instr</code> then the <code>Substring</code> will be a nice solution and the way to use it is depends on your input string.</p>\n"}], "owner": {"reputation": 2819, "user_id": 4293613, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/aeb458f2971ec752943d932d10940ae6?s=128&d=identicon&r=PG&f=1", "display_name": "genespos", "link": "https://stackoverflow.com/users/4293613/genespos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 0, "accepted_answer_id": 30063573, "answer_count": 1, "score": 1, "last_activity_date": 1430861482, "creation_date": 1430848328, "last_edit_date": 1430854308, "question_id": 30059930, "link": "https://stackoverflow.com/questions/30059930/converting-right-and-instr-into-vb-net-substring", "title": "Converting Right and Instr into vb.net Substring", "body": "<p>I wrote a code in VBA and I'm trying to transfer it to Vb.Net but I'm not sure of my job.</p>\n\n<p>VBA code (adapted to vb.net):</p>\n\n<pre><code>Dim stringDate$ = \"something happens: 03/12/2014 11:00\"\n    Dim C$ = Trim(Strings.Right(stringDate, Len(stringDate) - InStr(1, stringDate, \":\", vbTextCompare)))\n</code></pre>\n\n<p>Vb.Net code:</p>\n\n<pre><code>Dim C$ = stringDate.substring(stringDate.length - stringDate.indexof(\":\"), stringDate.length - (stringDate.length -stringDate.indexof(\":\"))).trim() \n</code></pre>\n\n<p>But a longer code doesn't seem like an improvement. Isn't it?</p>\n\n<p>What is the right way?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1430846400, "post_id": 30059241, "comment_id": 48233516, "body": "Is there an error in your posted code?  You set <code>NamedRange</code> within the loop, but then use <code>ArchiveNamedRange</code>, which you haven&#39;t assigned a value to in the code we can see.  If not a mistake, can we see where you set the value of <code>ArchiveNamedRange</code>?"}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1430848734, "post_id": 30059241, "comment_id": 48234979, "body": "Question edited to include that. To be clear, the same code works with a smaller range being used in refersto. But the ranges I&#39;m using do not exceed limits of named ranges which is exemplified by the fact that I&#39;m pulling it from a range already existing and working. In order for the Old Sheet NamedRange to exist, it means it was built in the code and in order for it to work, it can&#39;t refer to a larger range than named ranges can handle. So I&#39;m not sure why it fails."}, {"owner": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430868890, "post_id": 30059241, "comment_id": 48244692, "body": "<code>RefersTo</code> is also limited to 255 characters, but can return a string longer than that if it is fully qualified with the sheet name.  I&#39;d toss a <code>Debug.Print Len(n.RefersTo)</code> in the loop and test."}, {"owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1430898938, "post_id": 30059241, "comment_id": 48255505, "body": "Sorry if I&#39;m barking up the wrong tree, but 2 things stand out as odd. You are adding and removing objects from a collection while looping through that same collection (<code>OldSht.Names</code>).  This can give unpredictable results ranging from skipping items to an infinite loop.  Also you don&#39;t appear to modify the value of <code>ArchiveNamedRange</code> inside the loop, so each time you do <code>OldSht.Names.Add</code>, it&#39;s with the same Name value.  When I do that, it just overwrites the previous named range, but it&#39;s possible it could be causing your error?"}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "reply_to_user": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "edited": false, "score": 0, "creation_date": 1430921345, "post_id": 30059241, "comment_id": 48271697, "body": "@aucuparia, I recognize your concerns. This is not the full loop that I&#39;ve made. I can&#39;t paste the full loop as I have to scrub all of this code to make it not violate company standards (as silly as that is). Some of the other stuff being done would be difficult to scrub and wouldn&#39;t actually help solve the problem as the entirety of the issue is related to the refersto: being assigned on this single line of code. Thanks for the concern though."}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "reply_to_user": {"reputation": 20828, "user_id": 4088852, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41cfu.png?s=128&g=1", "display_name": "Comintern", "link": "https://stackoverflow.com/users/4088852/comintern"}, "edited": false, "score": 0, "creation_date": 1430923316, "post_id": 30059241, "comment_id": 48273205, "body": "@Comintern, Are you sure RefersTo is limited to 255 characters? That would be super small for a range object address. In my debug sessions I&#39;ve gotten the code to work flawlessly with NamedRangeRefersTo Len of 1000, 1460, 1771, 2027, 2043, 2075. So it obviously is accepting more than 255 characters as is. I just got a failure at 2091 characters, so Its looking likely that 2080 is the character limit (it&#39;s somewhere between 2075 and 2091)."}, {"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1430923527, "post_id": 30059241, "comment_id": 48273393, "body": "So let&#39;s just assume there is a character limit for some reason of 2080 (or whatever it actually is between 2075 and 2091). When I initially find and create these named ranges, they are being given a range object. When I am copying the ranges I am copying as a string. Somehow when I pass a ranged object into RefersTo: it accepts characters beyond 2080 but when I pass in a string it does not. Updating Question."}], "answers": [{"comments": [{"owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "edited": false, "score": 0, "creation_date": 1430933236, "post_id": 30082552, "comment_id": 48280258, "body": "That&#39;s a great idea! Thanks a lot! I had to do a few things to adapt it. I wasn&#39;t able to directly say OldRange = n.RefersToRange and had to instead do OldRange = OldSht.Range(n.Name) but the rest of it worked wonders. Thanks a lot @aucuparia"}], "tags": [], "owner": {"reputation": 1901, "user_id": 3590073, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddae1c2a3e6170997e7eaa0e9854a903?s=128&d=identicon&r=PG&f=1", "display_name": "aucuparia", "link": "https://stackoverflow.com/users/3590073/aucuparia"}, "is_accepted": true, "score": 1, "last_activity_date": 1430934144, "last_edit_date": 1430934144, "creation_date": 1430929998, "answer_id": 30082552, "question_id": 30059241, "link": "https://stackoverflow.com/questions/30059241/excel-vba-named-range-running-out-of-space-in-refersto/30082552#30082552", "title": "Excel VBA named range running out of space in refersto", "body": "<p>The reason the range definitions as strings are so long is that there are many areas within them.  So one workaround would be to build up a new <code>Range</code> object area by area.  You can use the string address of each area without running into any limits as each area only has a short reference.  Using <code>Range.Address</code> gets the cell reference without the sheet reference, so you can create a new <code>Range</code> on a different sheet but with the same cells.  Then use <code>Union()</code> to join all the areas and create the new name using the newly built <code>Range</code> instead of a string:</p>\n\n<pre><code>    Dim i As Long, oldRange As Range, newRange As Range\n\n    Set oldRange = n.RefersToRange\n    Set newRange = oldSht.Range(oldRange.Areas(1).Address(External:=False))\n    For i = 2 To oldRange.Areas.Count\n            Set newRange = Union(newRange, oldSht.Range(oldRange.Areas(i).Address(External:=False)))\n    Next i\n    oldSht.Names.Add Name:=\"ArchiveNamedRange\", RefersTo:=newRange\n</code></pre>\n\n<p>A couple of notes:</p>\n\n<p>For ranges with many areas this is <em>slow</em>.  If you can reliably tie down the threshold where you have problems, it would probably be worth testing for this first and only using this workaround where it was needed.</p>\n\n<p>When testing I also ran into problems with using <code>Worksheet.Range(\"some very long string range reference\")</code>, so this limitation isn't confined to named ranges.</p>\n"}], "owner": {"reputation": 212, "user_id": 4556092, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/528a167862c6b00144b7b938e09181af?s=128&d=identicon&r=PG&f=1", "display_name": "shagans", "link": "https://stackoverflow.com/users/4556092/shagans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 731, "favorite_count": 0, "accepted_answer_id": 30082552, "answer_count": 1, "score": 0, "last_activity_date": 1430934144, "creation_date": 1430845987, "last_edit_date": 1430924086, "question_id": 30059241, "link": "https://stackoverflow.com/questions/30059241/excel-vba-named-range-running-out-of-space-in-refersto", "title": "Excel VBA named range running out of space in refersto", "body": "<p>So I have a large suite of code that creates an archive of data in sheets used by employees. Part of what makes this functional is named ranges on each sheet of usable data. In order for the data integrity to remain, I need to copy the named range objects from the archive sheet to its copy. The named ranges are built programatically and function as expected on the sheets. The problem I'm having is when I go to archive the sheet. Here is the code I'm using to handle the named range object: </p>\n\n<pre><code>For Each n In OldSht.Names\n    NamedRangeRefersTo = n.RefersTo\n    NamedRange = n.Name\n    TrimmedName = Right(n.Name, Len(n.Name) - InStr(1, n.Name, \"!\", vbTextCompare))\n    OldSht.Names(n.Name).Delete\n    OldSht.Names.Add Name:=ArchiveNamedRange, RefersTo:=NamedRangeRefersTo\nNext n\n</code></pre>\n\n<p>The strings that grab data from n are used to add the same name object to the new sheet. </p>\n\n<p>The problem I'm having is when a named range is referencing too large of a range when it hits the line Oldsht.Names.Add, it returns error 1004. I figured out it was the size of the referenced range by messing around with it. I haven't found the exact triggering cause, but this code works as-is when I use it on most of the named ranges. On large data sets with a joined data type that results in a very large named range (it would take a long time to explain how the ranges are built in text. It's a group of 8 sub functions with over 2000 lines of code), this results in the 1004 error. </p>\n\n<p>What I'm confused by is why I can build the named range, use the named range, and copy the named range without issues (if I comment out the offending line, it executes perfectly but I lose data integrity). But when I take the referenced range into a code value, delete the old name reference, then add a new name(with a different name) and assign it the same refersto value of the old name, it can have this problem. I don't understand how it would be different doing this rather than just copying/renaming the name object. Unfortunately, I haven't found a workaround as of yet, nor have I found a clear cause of this error other than the fact that when I remove data or use smaller sets of data in test scenarios, I never have the problem. Does anyone have any ideas of what I can do? Does anyone have any ideas how a named range could be referring to a small enough range that it can be created, but using its refersto value to create a new named range could cause errors only when that is referencing a large range?</p>\n\n<p>I wish I could provide some more concrete examples but unfortunately it would be very difficult to scrub enough sensitive info to provide the full code that would be necessary to reproduce my exact scenarios. Any ideas would be much appreciated. </p>\n\n<p>As requested here's where ArchiveNamedRange gets set: </p>\n\n<pre><code>If Len(OldSht.Name) &gt; 21 Then\nArchiveShtName = Left(OldSht.Name, 21) &amp; DatePart(\"m\", Date) &amp; DatePart(\"d\", Date) &amp; DatePart(\"yyyy\", Date)\nElse\nArchiveShtName = OldSht.Name &amp; DatePart(\"m\", Date) &amp; DatePart(\"d\", Date) &amp; DatePart(\"yyyy\", Date)\nEnd If\n\nArchiveNamedRange = ArchiveShtName &amp; NameObjectName &amp; \"Test\"\n</code></pre>\n\n<p>NameObjectName is just the name of the type of object and is passed in from another function. I'm not having an issue with the name just fyi. In the most extreme example the ArchiveNamedRange value at debug run time is = \"OutageSystemProcedureMMDDYYYYSecurityRedactionTest\" so the name might reach 50 and if things get crazier it might run upwards of 60 characters but it won't ever go beyond that or come anywhere near the 255 character limit. Ultimately, I haven't seen ArchiveNamedRange have an invalid value. It's just a string and it always has a value. </p>\n\n<p>Edit- \nThrough my troubleshooting I've found that my code works when NamedRangeRefersTo has a length of 2075, but does not work when it has a length of 2091. So somewhere between 2075 characters and 2091 characters is a breaking point for assigning a string to RefersTo: in a named range. </p>\n\n<p>So let's just assume there is a character limit for some reason of 2080 (or whatever it actually is between 2075 and 2091). When I initially find and create these named ranges, they are being given a range object. When I am copying the ranges I am copying as a string. Somehow when I pass a ranged object into RefersTo: it accepts characters beyond 2080 but when I pass in a string it does not. Given that this is my only breaking point of a large suite of code I'd rather find a workaround for this than have to re-factor the entire concept of my archive system. If I use a range object for copying the named ranges, their references follow the old Sheet. That means that when I copy the name over it can be \"CriticalSystemsTest1\" and referto: \"CriticalSystemsTest1!$A$2,...\" but once I copy that over and rename the archive worksheet (now CriticalSystems562015) the references adjust to be \"CriticalSystems562015Test1!$A$2,...\"</p>\n\n<p>So I had to copy as a string to avoid that problem (it breaks data on the new sheet). All I really need is a creative way to overcome this character limit issue on my string. Rebuilding the named range from scratch on the new sheet is also not going to work. So I guess if anyone has ideas for how to work around this string size issue or a way of trimming the string while maintaining functionality of the named range, that would be amazing. </p>\n\n<p>Each of these names has a worksheet level scope, so maybe if there's a way of using just the cell address($A$2) in RefersTo: so it doesn't also contain the worksheet reference (SheetName!), that would be a potential solution but I haven't figured out if that's even possible. </p>\n"}, {"tags": ["forms", "vba", "ms-access", "formatting", "ms-access-2013"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4863747, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e112eebe2bfcaa9fa3c8ef71e252c908?s=128&d=identicon&r=PG&f=1", "display_name": "WUDA", "link": "https://stackoverflow.com/users/4863747/wuda"}, "edited": false, "score": 0, "creation_date": 1430848599, "post_id": 30059873, "comment_id": 48234900, "body": "That would work if I was done editing the data.  I still need to edit records, which is why I&#39;d like to use the DATASHEET Form."}, {"owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "reply_to_user": {"reputation": 13, "user_id": 4863747, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e112eebe2bfcaa9fa3c8ef71e252c908?s=128&d=identicon&r=PG&f=1", "display_name": "WUDA", "link": "https://stackoverflow.com/users/4863747/wuda"}, "edited": false, "score": 0, "creation_date": 1430850238, "post_id": 30059873, "comment_id": 48235970, "body": "If you want to stick with a form, then you will have to condtionally format each field separately, or do after update commands for each control. If you want to see it while you upload then that&#39;s all you can do, however you can go ahead and create the report and then just look at it whenever you want to see the data formatted with only a little interruption in your inputting. The report will automatically update with your new data whenever you open it"}], "tags": [], "owner": {"reputation": 176, "user_id": 4044346, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/0f147f8766920927c8692df420c250f8?s=128&d=identicon&r=PG&f=1", "display_name": "hypetech", "link": "https://stackoverflow.com/users/4044346/hypetech"}, "is_accepted": false, "score": 0, "last_activity_date": 1430848138, "creation_date": 1430848138, "answer_id": 30059873, "question_id": 30058812, "link": "https://stackoverflow.com/questions/30058812/access-2013-conditional-formatting-many-fields-with-same-rules/30059873#30059873", "title": "Access 2013 Conditional Formatting Many Fields with Same Rules", "body": "<p>This is easily done if you can create a report from your data. If you create a report from the data, switch to layout view and go to the format tab. Highlight all the fields you want to format for, and then go to conditional formatting. It should say \"Show formatting rules for Multiple\" at the top, and then you can create a new rule. Then just create the rule you want, which I assume would be field value is equal to 0, and then make sure it's formatted with a black background and apply!</p>\n"}], "owner": {"reputation": 13, "user_id": 4863747, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e112eebe2bfcaa9fa3c8ef71e252c908?s=128&d=identicon&r=PG&f=1", "display_name": "WUDA", "link": "https://stackoverflow.com/users/4863747/wuda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1206, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1430848138, "creation_date": 1430844531, "last_edit_date": 1430844912, "question_id": 30058812, "link": "https://stackoverflow.com/questions/30058812/access-2013-conditional-formatting-many-fields-with-same-rules", "title": "Access 2013 Conditional Formatting Many Fields with Same Rules", "body": "<p>I'm working with Access to manage weekly time sheets for ~70 employees.  Unfortunately I have to enter everything manually into Access thanks to an ancient time keeping system.  </p>\n\n<p>I have a table with LASTNAME, FIRSTNAME, and then about 90 hour fields for each month.  The table also has to be zero'ed out (to both avoid the NULL values issue and because they require everything to be zero'ed....)  In order to make life easier for my eyes, I want to conditionally format everything that has a zero with a black background.  </p>\n\n<p>What's the easiest way to go about this since Access doesn't allow you to format multiple fields at the same time.  I'm using a Datasheet Form on a desktop DB.</p>\n\n<p>I've been reading a bunch of things, but most seem to talk about formatting many rules.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 4250609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b7e726db6d89eb49bcae0e1d2abc114?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4250609/john-doe"}, "edited": false, "score": 0, "creation_date": 1430846684, "post_id": 30058730, "comment_id": 48233704, "body": "thanks! thats what I was thinking, but I wasn&#39;t sure. Actually, yesterday I tried to convert both to int, but I think either it didnt&#39; work or I didn&#39;t do it right (or both). I&#39;m using the &quot;2&quot; in worksheets(2) in a counter. can I do something like  if day(worksheets(&quot;sheet1&quot;).range(&quot;a5&quot;).value)) = Int(worksheets(2).name  instead?"}, {"owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "reply_to_user": {"reputation": 31, "user_id": 4250609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b7e726db6d89eb49bcae0e1d2abc114?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4250609/john-doe"}, "edited": false, "score": 0, "creation_date": 1430849043, "post_id": 30058730, "comment_id": 48235191, "body": "@JohnDoe Yes, you could also use your version, but my version is more universal. You can convert any <code>integer</code> to <code>string</code>, and your code will raise <code>Type mismatch</code> error if the worksheet name can&#39;t be converted to <code>integer</code> (like <code>&quot;sheet1&quot;</code>)"}, {"owner": {"reputation": 31, "user_id": 4250609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b7e726db6d89eb49bcae0e1d2abc114?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4250609/john-doe"}, "edited": false, "score": 0, "creation_date": 1430850868, "post_id": 30058730, "comment_id": 48236379, "body": "works for me! thanks a lot, i&#39;ve been stuck on this for a few days"}], "tags": [], "owner": {"reputation": 5598, "user_id": 3964075, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b9cbf64d99cdcd5bb751d16fcfa75b2f?s=128&d=identicon&r=PG&f=1", "display_name": "BrakNicku", "link": "https://stackoverflow.com/users/3964075/braknicku"}, "is_accepted": false, "score": 2, "last_activity_date": 1430844214, "creation_date": 1430844214, "answer_id": 30058730, "question_id": 30058283, "link": "https://stackoverflow.com/questions/30058283/excel-vba-script-wont-execute-the-intended-msgbox/30058730#30058730", "title": "excel vba script wont execute the intended msgbox?", "body": "<p><code>Day</code> function returns an <code>integer</code>. </p>\n\n<p><code>Worksheets(2).Name</code> is a <code>string</code> property. </p>\n\n<p>To compare those values, you have to convert them to the same type. </p>\n\n<pre><code>If CStr(Day(Worksheets(\"sheet1\").Range(\"a5\").Value)) = Worksheets(2).Name Then\n</code></pre>\n\n<p>You can read more about type conversion functions <a href=\"https://msdn.microsoft.com/en-us/library/s2dy91zy.aspx\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 31, "user_id": 4250609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b7e726db6d89eb49bcae0e1d2abc114?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/4250609/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1430844214, "creation_date": 1430842822, "last_edit_date": 1430843531, "question_id": 30058283, "link": "https://stackoverflow.com/questions/30058283/excel-vba-script-wont-execute-the-intended-msgbox", "title": "excel vba script wont execute the intended msgbox?", "body": "<p>I have an excel vba script (below) that I'm having trouble with displaying \"match\". I set my excel file up with the following information. column A5 to A10 has dates in the format of 3/1/2015, 3/2/2015, etc. (so A5 = 3/1/2015, A6 = 3/2/2015, etc.)</p>\n\n<p>My worksheet has 7 tabs, the first (with the code on it) is the default sheet1. the 2nd through the 7th tab are labeled just as \"1\" for the 2nd tab, \"2\", \"3\", etc to \"7\". For now I was just testing out A5 to match and display something if it matches tab 2, but isn't working. The commented (out) msgboxes shows that the values should match, but when I try to set an if (they are equal), no bueno. this is a simplified version, so an answer like \"why don't you just set the day equal to the day you want\" wont work.  Thanks!</p>\n\n<pre><code>Sub main()\n\n'MsgBox Day(Worksheets(\"sheet1\").Range(\"a5\").Value)\n\n'MsgBox Worksheets(2).Name\n\nIf Day(Worksheets(\"sheet1\").Range(\"a5\").Value) = Worksheets(2).Name Then\n\nMsgBox \"match\"\n\nEnd If\n\nEnd Sub\n</code></pre>\n"}]