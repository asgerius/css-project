[{"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1562800875, "post_id": 56979661, "comment_id": 100495397, "body": "How many lines of data do you typical have? I ask as its quicker to use arrays etc. but if its just a few lines each time a quick <code>for each</code> loop may suffice"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1562800953, "post_id": 56979661, "comment_id": 100495410, "body": "also if you are deleting <code>row</code> or <code>col</code> ensure you work BACKWARDS!"}, {"owner": {"reputation": 11, "user_id": 11767003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d5162f9587abf2d80fa9682ef5cdd7c?s=128&d=identicon&r=PG&f=1", "display_name": "Xtina", "link": "https://stackoverflow.com/users/11767003/xtina"}, "reply_to_user": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "edited": false, "score": 0, "creation_date": 1562805134, "post_id": 56979661, "comment_id": 100496178, "body": "The lines of data will be unknown as it will depend on how many times a person is contacted to collect."}], "answers": [{"tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1562801664, "creation_date": 1562801664, "answer_id": 56979864, "question_id": 56979661, "link": "https://stackoverflow.com/questions/56979661/capture-data-and-then-create-a-loop-in-existing-code/56979864#56979864", "title": "Capture data and then create a loop in existing code", "body": "<p>I would recommend the following changes.</p>\n\n<ul>\n<li>Use a <code>For</code> loop. It's easier and you'll be able to follow along easier.</li>\n<li>Delete your rows at the end of your macro. This can be done with the <code>KillRnG</code> in the code below.</li>\n<li><p>You can use the <code>Offset</code> to gather information from other columns on the matching row. See my example.</p>\n\n<pre><code>'If you insert this immediately after you turn off screen \n'updating you can loop through your rows.\ndim aCell as Range\nFor Each aCell In Intersect(Range(\"A:A\", ActiveCell.UsedRange)).Cells\n\n    If UCase(aCell.Value) = \"PAID\" Then\n        'do your thing of copying the row to some other other sheet.\n\n         'set the row for deletion... this will be done at the end.\n          Set killRNG = Union(killRNG, aCell.EntireRow)\n\n    Debug.Print \"This is the invoice: \" &amp; aCell.Offset(0, 3).Value\nEnd If\n\nNext cell\n\n'This will delete whatever you wanted\nkillRNG.ClearContents\nkillRNG.Delete\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 11767003, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d5162f9587abf2d80fa9682ef5cdd7c?s=128&d=identicon&r=PG&f=1", "display_name": "Xtina", "link": "https://stackoverflow.com/users/11767003/xtina"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562823452, "creation_date": 1562799794, "last_edit_date": 1562823452, "question_id": 56979661, "link": "https://stackoverflow.com/questions/56979661/capture-data-and-then-create-a-loop-in-existing-code", "title": "Capture data and then create a loop in existing code", "body": "<p>I've created a spreadsheet that has a macro that will delete and move to a new tab a row when the status in column A is marked 'paid'. I need to take that one step further so that if the status is marked 'paid' and invoice number in column D matches the same row that all same invoice #s will also be moved to the new tab. </p>\n\n<p>What is the code that will capture the invoice number of that row?</p>\n\n<p>Then do another for loop inside the first one that loops through all the rows and moves all those that match the invoice number to insert After <code>If CStr(xRg(K).Value) = \"paid\"</code>. current spreadsheet image. The code that I am using is below. The image is a snippit of the spreadsheet. In the example Sarah Phillips has data in rows 9-12 with 'paid' status in column A row 9. I need all 4 that has the same invoice # to move to the new spreadsheet.</p>\n\n<p>I'm new to writing code and it was suggested that I capture the invoice number of that row then dow a loop inside the first one that loops through all rows and moves those as well. I do not know how to do this or amend the current code so that will include the suggestion.</p>\n\n<pre><code>Sub TransferData()\n\nDim xRg As Range\nDim xCell As Range\nDim I As Long, J As Long, K As Long\n\nI = Worksheets(\"Sheet1\").UsedRange.Rows.Count\nJ = Worksheets(\"Sheet2\").UsedRange.Rows.Count\nIf J = 1 Then\n   If Application.WorksheetFunction.CountA(Worksheets(\"Sheet2\").UsedRange) = 0 Then J = 0\nEnd If\nSet xRg = Worksheets(\"Sheet1\").Range(\"A1:A\" &amp; I)\nOn Error Resume Next\nApplication.ScreenUpdating = False\nFor K = 1 To xRg.Count\n    If CStr(xRg(K).Value) = \"paid\" Then\n        xRg(K).EntireRow.Copy Destination:=Worksheets(\"Sheet2\").Range(\"A\" &amp; J + 1)\n        xRg(K).EntireRow.Delete\n        If CStr(xRg(K).Value) = \"paid\" Then\n            K = K - 1\n        End If\n        J = J + 1\n    End If\nNext\nApplication.ScreenUpdating = True\n\n\n End Sub\n</code></pre>\n\n<p>I expect the rows with matching Invoice numbers to all be moved when row A is marked 'paid' and the macro executed.</p>\n\n<p><a href=\"https://i.stack.imgur.com/hpxeC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/hpxeC.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6729765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89105f8acbc67cb3c56a0b8f4a02f58b?s=128&d=identicon&r=PG&f=1", "display_name": "svanschu", "link": "https://stackoverflow.com/users/6729765/svanschu"}, "edited": false, "score": 0, "creation_date": 1562856064, "post_id": 56979569, "comment_id": 100518068, "body": "Hi teylyn, thank you, the links helped a lot. But I didn&#39;t get it yet how to do the sort. I&#39;ll changed the loop and the get methods. But the sorting is still a question <code>Sub SortHorizontal() Dim tbl As ListObject Dim x As Long Set tbl = ActiveSheet.ListObjects(&quot;Tabelle1&quot;) For x = 1 To tbl.ListRows.Count Dim row As Range Set row = tbl.ListRows(x).Range Dim cellsToSort As Range Set cellsToSort = row.Range(cells(x, &quot;C&quot;), cells(x, &quot;F&quot;)) cellsToSort.Sort Key1:=Range(&quot;C&quot; &amp; x), _    Order1:=xlAscending, _    Orientation:=xlSortRows Next x End Sub</code>"}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 51, "user_id": 6729765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89105f8acbc67cb3c56a0b8f4a02f58b?s=128&d=identicon&r=PG&f=1", "display_name": "svanschu", "link": "https://stackoverflow.com/users/6729765/svanschu"}, "edited": false, "score": 0, "creation_date": 1562879111, "post_id": 56979569, "comment_id": 100528506, "body": "I&#39;m not even sure if it&#39;s possible to sort table columns by name. You could convert the table into a range, then do the sorting with the table elements resolved to normal cells, then turn the result into a table again."}, {"owner": {"reputation": 51, "user_id": 6729765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89105f8acbc67cb3c56a0b8f4a02f58b?s=128&d=identicon&r=PG&f=1", "display_name": "svanschu", "link": "https://stackoverflow.com/users/6729765/svanschu"}, "edited": false, "score": 0, "creation_date": 1562921522, "post_id": 56979569, "comment_id": 100539887, "body": "Wow that&#39;s a real brain.... So the choice is to don&#39;t use &quot;table formatting&quot; or do the failure shouting double conversion. I should have start writing a new application instead of using excel :("}, {"owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "reply_to_user": {"reputation": 51, "user_id": 6729765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89105f8acbc67cb3c56a0b8f4a02f58b?s=128&d=identicon&r=PG&f=1", "display_name": "svanschu", "link": "https://stackoverflow.com/users/6729765/svanschu"}, "edited": false, "score": 0, "creation_date": 1562932465, "post_id": 56979569, "comment_id": 100545574, "body": "I didn&#39;t say it was not possible. I just don&#39;t know if it is. Sorting a table by the column names is a rather unusual request, so you may understand that it&#39;s not a one-click-solution. If you&#39;re happy to use VBA to do the sort, what is the problem with converting the table to a range, sort, then re-apply the table? How does that hurt you? It&#39;s only a few lines of code."}, {"owner": {"reputation": 51, "user_id": 6729765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89105f8acbc67cb3c56a0b8f4a02f58b?s=128&d=identicon&r=PG&f=1", "display_name": "svanschu", "link": "https://stackoverflow.com/users/6729765/svanschu"}, "edited": false, "score": 0, "creation_date": 1567789271, "post_id": 56979569, "comment_id": 102082162, "body": "with myArray = tbl.DataBodyRange.Rows(x) I get a complete row, but i coudn&#39;t figure out how to only get a part of the row"}], "tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1562798853, "creation_date": 1562798853, "answer_id": 56979569, "question_id": 56979443, "link": "https://stackoverflow.com/questions/56979443/horizontal-sort-method-does-not-work-with-as-table-formated-worksheets/56979569#56979569", "title": "Horizontal sort method does not work with as table formated worksheets", "body": "<p>The blog post you're referring to was written before Tables were added to Excel (with Excel 2007). \"Formatting\" to a table actually turns the cells into a Table Object. That Table Object requires different code than the grid. see <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.tableobject\" rel=\"nofollow noreferrer\">https://docs.microsoft.com/en-us/office/vba/api/excel.tableobject</a> or <a href=\"https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables\" rel=\"nofollow noreferrer\">https://www.thespreadsheetguru.com/blog/2014/6/20/the-vba-guide-to-listobject-excel-tables</a> for code examples.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6729765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89105f8acbc67cb3c56a0b8f4a02f58b?s=128&d=identicon&r=PG&f=1", "display_name": "svanschu", "link": "https://stackoverflow.com/users/6729765/svanschu"}, "is_accepted": true, "score": 0, "last_activity_date": 1568200212, "last_edit_date": 1568200212, "creation_date": 1567805692, "answer_id": 57828768, "question_id": 56979443, "link": "https://stackoverflow.com/questions/56979443/horizontal-sort-method-does-not-work-with-as-table-formated-worksheets/57828768#57828768", "title": "Horizontal sort method does not work with as table formated worksheets", "body": "<p>Thx @teylyn for the guidens.</p>\n\n<p>Here is the current solution for the problem.</p>\n\n<pre><code>' sorts cells in all rows of current worksheet ascending from left to right\nSub horizontalSortOrig()\n    Dim tbl As ListObject\n    Dim x As Long\n    Dim startIndex As Long\n    startIndex = 13\n\n    Set tbl = ActiveSheet.ListObjects(\"Tabelle1\")\n\n    For x = 1 To tbl.DataBodyRange.Rows.Count\n        Dim myArray As Variant\n        myArray = tbl.ListRows(x).Range\n\n\n        Dim sortArray As Variant\n        Dim sortArrayDim As Long\n        sortArrayDim = tbl.DataBodyRange.Columns.Count - startIndex\n        ReDim sortArray(sortArrayDim)\n        Dim y, yy As Long\n        y = 0\n        yy = 0\n        For y = startIndex To tbl.DataBodyRange.Columns.Count\n            sortArray(yy) = myArray(1, y)\n            yy = yy + 1\n        Next\n\n        Dim nb As Long\n        Dim temp_array As Variant\n        Dim i, pos, l, ii As Long\n\n        nb = UBound(sortArray)\n        temp_array = sortArray\n        Erase sortArray\n        ReDim sortArray(sortArrayDim)\n        For i = 0 To nb\n            pos = 0\n            For l = 0 To nb\n                If temp_array(i) &gt; temp_array(l) And i &lt;&gt; l Then\n                    pos = pos + 1\n                End If\n            Next\n            For ii = 1 To 1\n                If sortArray(nb - pos) = \"\" Then\n                    sortArray(nb - pos) = temp_array(i)\n                Else\n                    pos = pos + 1\n                    ii = ii - 1\n                End If\n            Next\n        Next\n\n        y = 0\n        yy = 0\n        For y = startIndex To tbl.DataBodyRange.Columns.Count\n            myArray(1, y) = sortArray(yy)\n            yy = yy + 1\n        Next\n\n        tbl.ListRows(x).Range = myArray\n    Next x\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6729765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89105f8acbc67cb3c56a0b8f4a02f58b?s=128&d=identicon&r=PG&f=1", "display_name": "svanschu", "link": "https://stackoverflow.com/users/6729765/svanschu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 57828768, "answer_count": 2, "score": 0, "last_activity_date": 1568200212, "creation_date": 1562797802, "last_edit_date": 1562824712, "question_id": 56979443, "link": "https://stackoverflow.com/questions/56979443/horizontal-sort-method-does-not-work-with-as-table-formated-worksheets", "title": "Horizontal sort method does not work with as table formated worksheets", "body": "<p>I have a excel table which is formatted as table (Ctrl+T) and this table I want to sort horizontal each line.</p>\n\n<p>I found a snippet how to sort horizontal <a href=\"https://blog.stefan-macke.com/2006/01/23/zeilen_in_excel_horizontal_sortieren/\" rel=\"nofollow noreferrer\">https://blog.stefan-macke.com/2006/01/23/zeilen_in_excel_horizontal_sortieren/</a> and adapted this to my usecase.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Option Explicit\n' sorts cells in all rows of current worksheet ascending from left to right\nSub horizontalSort()\n    Dim i, lastRow As Integer\n    Const firstColumn As Integer = 15\n    Const lastColumn As Integer = 34\n    ' find last row\n    lastRow = Cells(1, 5).End(xlDown).Row\n    ' sort cells in each row ascending from left to right\n    For i = 2 To lastRow\n       Range(Cells(i, firstColumn), Cells(i, lastColumn)).Select\n       Selection.Sort Key1:=Range(\"O\" &amp; i), _\n            Order1:=xlDescending, _\n            Orientation:=xlSortRows\n    Next i\nEnd Sub\n\n' sorts cells in all rows of current worksheet ascending from left to right\nSub horizontalSortOrig()\n    Dim i, lastRow As Integer\n    Const firstColumn As Integer = 1\n    Const lastColumn As Integer = 5\n    ' find last row\n    lastRow = Cells(1, 1).End(xlDown).Row\n    ' sort cells in each row ascending from left to right\n    For i = 1 To lastRow\n       Range(Cells(i, firstColumn), Cells(i, lastColumn)).Select\n       Selection.Sort Key1:=Range(\"A\" &amp; i), _\n            Order1:=xlAscending, _\n            Orientation:=xlSortRows\n    Next i\nEnd Sub\n</code></pre>\n\n<p>If I have an unformated table, the sorting works perfectly. If I \"format the table as table\" (Ctrl+T) (Insert -> Table) the same makro stops to work.\nDoes someone know why?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1092, "user_id": 7622159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J6x0H.jpg?s=128&g=1", "display_name": "Gharbad The Weak", "link": "https://stackoverflow.com/users/7622159/gharbad-the-weak"}, "edited": false, "score": 0, "creation_date": 1562796954, "post_id": 56979298, "comment_id": 100494488, "body": "on worksheet 1 is the name in one column and the phone number in another column? if so you don&#39;t need a macro, you can use a formula on worksheet 2, if this is the case let me know and i can provide you with the formula..."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562797278, "post_id": 56979298, "comment_id": 100494569, "body": "You can use the <code>worksheet_change</code> event for this, or a formula using VLOOKUP"}, {"owner": {"reputation": 1, "user_id": 4941507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77ec40904394aae5e38636265ab72c0?s=128&d=identicon&r=PG&f=1", "display_name": "xep", "link": "https://stackoverflow.com/users/4941507/xep"}, "reply_to_user": {"reputation": 1092, "user_id": 7622159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/J6x0H.jpg?s=128&g=1", "display_name": "Gharbad The Weak", "link": "https://stackoverflow.com/users/7622159/gharbad-the-weak"}, "edited": false, "score": 0, "creation_date": 1562797680, "post_id": 56979298, "comment_id": 100494678, "body": "@GharbadTheWeak yes, they are in separate columns. Some may have more than one number listed too if that is a possibility for example in the directory - Column A = name, Column B = Phone number, Column C = Phone #2 (if available)"}], "answers": [{"tags": [], "owner": {"reputation": 62, "user_id": 11673304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368dcb9a50d5cfc7e27d6fc730d77684?s=128&d=identicon&r=PG&f=1", "display_name": "tmsdajpa", "link": "https://stackoverflow.com/users/11673304/tmsdajpa"}, "is_accepted": false, "score": 0, "last_activity_date": 1562801642, "creation_date": 1562801642, "answer_id": 56979857, "question_id": 56979298, "link": "https://stackoverflow.com/questions/56979298/if-name-is-x-insert-y-phone-number-from-z-worksheet-in-excel/56979857#56979857", "title": "If name is X insert Y phone number from Z worksheet in Excel", "body": "<p>Try this code and let me know if there's anything that I missed. Be sure to change <strong>Sheet4</strong> to the name of the sheet that has the phone # list.</p>\n\n<pre><code>Sub Macro12()\n   Range(\"B1\").Select\n    ActiveCell.FormulaR1C1 = \"=VLOOKUP(RC[-1],Sheet4!C[-1]:C,2,FALSE)\"\n    ActiveCell.Offset(0, 1).Range(\"A1\").Select\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4941507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b77ec40904394aae5e38636265ab72c0?s=128&d=identicon&r=PG&f=1", "display_name": "xep", "link": "https://stackoverflow.com/users/4941507/xep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562801642, "creation_date": 1562796680, "last_edit_date": 1562796913, "question_id": 56979298, "link": "https://stackoverflow.com/questions/56979298/if-name-is-x-insert-y-phone-number-from-z-worksheet-in-excel", "title": "If name is X insert Y phone number from Z worksheet in Excel", "body": "<p>I am trying to create a simple macro or VBA that will insert a phone number in column Y for value of someones name in Column X from a directory worksheet. </p>\n\n<p>So for example, worksheet 1 (directory) has names of individuals and phone numbers:</p>\n\n<pre><code>John Smith 123 456 789\nJoe Garden 555 555 555\nJill Spill 999 999 999\n</code></pre>\n\n<p>When creating a new worksheet 2, when I put John Smith in Column A, I want it to automatically populate 123 456 789 in Column B.</p>\n\n<p>Thanks for the help!</p>\n"}, {"tags": ["excel", "vba", "onedrive"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1562796057, "post_id": 56979146, "comment_id": 100494258, "body": "I am not too familiar with saving to OneDrive via VBA (I am actually curious myself now that I see this question). I wonder if it may have to do with dealing with login credentials since you are saving to a server. I am at work right now and OneDrive is blocked here, but perhaps try recording a macro and saving and see what the macro does."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562796966, "post_id": 56979146, "comment_id": 100494492, "body": "<a href=\"https://stackoverflow.com/questions/35024687/onedrive-unc-paths/42840430#42840430\" title=\"onedrive unc paths\">stackoverflow.com/questions/35024687/onedrive-unc-paths/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 10996767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f348b2aac3910fcf5d9d72b6b555a56?s=128&d=identicon&r=PG&f=1", "display_name": "BuffaloX", "link": "https://stackoverflow.com/users/10996767/buffalox"}, "edited": false, "score": 0, "creation_date": 1562871660, "post_id": 56979146, "comment_id": 100525641, "body": "K.Davis.  There isn&#39;t a way that I can see to upload the document to the OneDrive shared folder from within Excel&#39;s main interface.  The only OneDrive Business data I have access to is through the OneDrive app on my computer that lets me access MY DATA, but not the Shared Folders that I&#39;m trying to save a copy of the Excel document to."}, {"owner": {"reputation": 13, "user_id": 10996767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f348b2aac3910fcf5d9d72b6b555a56?s=128&d=identicon&r=PG&f=1", "display_name": "BuffaloX", "link": "https://stackoverflow.com/users/10996767/buffalox"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562871858, "post_id": 56979146, "comment_id": 100525707, "body": "@TimWilliams I appreciate the suggestion.  I have run across the solution before to map OneDrive to a UNC path but I&#39;m worried that this may fail when trying to do it for other people who run my tool.  I&#39;d like to find a more universal way, if possible (like uploading it through an API call)."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 10996767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f348b2aac3910fcf5d9d72b6b555a56?s=128&d=identicon&r=PG&f=1", "display_name": "BuffaloX", "link": "https://stackoverflow.com/users/10996767/buffalox"}, "edited": false, "score": 0, "creation_date": 1562874762, "post_id": 56996035, "comment_id": 100526844, "body": "Awesome!  Thank you very much Tim!  I had no idea that this was an option.  For those following up on this I had to dig a bit more in the current interface within IE.  I had to click on the menu (3 dashes) in the upper right hand corner and select &quot;Open with Explorer&quot; from there."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1562872997, "creation_date": 1562872997, "answer_id": 56996035, "question_id": 56979146, "link": "https://stackoverflow.com/questions/56979146/how-do-i-upload-a-file-to-onedrive-business-sharepoint-with-vba/56996035#56996035", "title": "How do I upload a file to OneDrive Business (Sharepoint) with VBA", "body": "<p>I just tried this and it worked fine:</p>\n\n<pre><code>Activeworkbook.SaveAs \"https://myComany.sharepoint.com/Departments/dept1/Documents/FGH/Text.xlsx\"\n</code></pre>\n\n<p>To get the required path, browse to the destination in IE, then use  <em>Library tab >> Open with Explorer</em> to open the destination in Windows Explorer: you can copy the path from the address bar there.</p>\n"}, {"tags": [], "owner": {"reputation": 312, "user_id": 3748818, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M6caX.png?s=128&g=1", "display_name": "Cekaleek", "link": "https://stackoverflow.com/users/3748818/cekaleek"}, "is_accepted": false, "score": 1, "last_activity_date": 1616437789, "last_edit_date": 1616437789, "creation_date": 1595956902, "answer_id": 63139557, "question_id": 56979146, "link": "https://stackoverflow.com/questions/56979146/how-do-i-upload-a-file-to-onedrive-business-sharepoint-with-vba/63139557#63139557", "title": "How do I upload a file to OneDrive Business (Sharepoint) with VBA", "body": "<p>Maybe this will help someone pulling their hair out. Make sure and spaces in your SharePoint URL are replaced by %20. Example &quot;New Folder&quot; should be &quot;New%20Folder, or remove the space from the folder name.</p>\n"}], "owner": {"reputation": 13, "user_id": 10996767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f348b2aac3910fcf5d9d72b6b555a56?s=128&d=identicon&r=PG&f=1", "display_name": "BuffaloX", "link": "https://stackoverflow.com/users/10996767/buffalox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3190, "favorite_count": 0, "accepted_answer_id": 56996035, "answer_count": 2, "score": 1, "last_activity_date": 1616437789, "creation_date": 1562795649, "last_edit_date": 1562824684, "question_id": 56979146, "link": "https://stackoverflow.com/questions/56979146/how-do-i-upload-a-file-to-onedrive-business-sharepoint-with-vba", "title": "How do I upload a file to OneDrive Business (Sharepoint) with VBA", "body": "<p>I'm trying to find a method to upload a file to Onedrive from VBA in Excel.\nI've done a lot of searching for acceptable methods, but most methods will not work for my scenario or the proposed solution will give an error.  </p>\n\n<p>I can upload files just fine if I'm using UNC paths or OneDrive locations that are synced locally (e.g. \"C:\\Users(username)\\OneDrive\\File Share\") but I need a method that lets me push(upload) files to a shared URL location (e.g. \"<a href=\"https://my.sharepoint.com/:f:/r/personal/(email_address)/Documents/SharedFiles?csf=1&amp;e=6WmUIO\" rel=\"nofollow noreferrer\">https://my.sharepoint.com/:f:/r/personal/(email_address)/Documents/SharedFiles?csf=1&amp;e=6WmUIO</a>\").  All the users that will need to use the tool will have access to this shared location in OneDrive.</p>\n\n<p>I tried the normal \"SaveAs\" method in VBA but that won't work.</p>\n\n<pre><code>Set Excelwb = ThisWorkbook\n\nExcelwb.SaveAs fileName:=\"https://my.sharepoint.com/:f:/r/personal/(email_address)/Documents/SharedFiles?csf=1&amp;e=6WmUIO\" _\n, FileFormat:=xlOpenXMLWorkbook, ConflictResolution:=xlLocalSessionChanges\n\nExcelwb.Saved = True\nExcelwb.Close SaveChanges:=False\nApplication.DisplayAlerts = True\n</code></pre>\n\n<p>I expected this to save the file, but I understand that since I'm saving to a URL and not a local file that another method is probably required, but I can't find one that will work.  </p>\n\n<p>The error I'm getting is:\nRun-time error '1004'\nMethod 'SaveAs' of object '_Workbook' failed</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1562795042, "post_id": 56979035, "comment_id": 100493987, "body": "In general you want to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using select</a> in your code. When deleting lines like that you need to start at the bottom: <code>For s = 22 To 2 step -1</code>"}, {"owner": {"reputation": 123, "user_id": 2134868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5db9a56c1af355d10eba04e465cd4d?s=128&d=identicon&r=PG", "display_name": "adnan", "link": "https://stackoverflow.com/users/2134868/adnan"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1562795257, "post_id": 56979035, "comment_id": 100494041, "body": "how can I delete the cells without using select? also starting from the bottom cause excel hanging and should be restarted"}], "answers": [{"comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1562795697, "post_id": 56979138, "comment_id": 100494166, "body": "I edited to match the sheet names :). Okay I actually made a few edits just in case :))"}, {"owner": {"reputation": 123, "user_id": 2134868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5db9a56c1af355d10eba04e465cd4d?s=128&d=identicon&r=PG", "display_name": "adnan", "link": "https://stackoverflow.com/users/2134868/adnan"}, "edited": false, "score": 0, "creation_date": 1562795965, "post_id": 56979138, "comment_id": 100494233, "body": "Yes, Right, sorry for asking about select quickly without think about it, about step backwards I don&#39;t know why if I do that the excel keep searching and searching with no end, so I should restart the excel itself before the code ends (it keeps searching on row 22"}, {"owner": {"reputation": 123, "user_id": 2134868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5db9a56c1af355d10eba04e465cd4d?s=128&d=identicon&r=PG", "display_name": "adnan", "link": "https://stackoverflow.com/users/2134868/adnan"}, "edited": false, "score": 0, "creation_date": 1562796153, "post_id": 56979138, "comment_id": 100494294, "body": "Ok, now after added &#39;.Value&#39; the crashing issue solved, but still deleting only the half results if the empty cells under each others, kindly recheck the attached screens"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1562796224, "post_id": 56979138, "comment_id": 100494317, "body": "I&#39;m not sure if I understand what you mean. Could you maybe edit your question and show us a screencap of the desired result?"}, {"owner": {"reputation": 123, "user_id": 2134868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5db9a56c1af355d10eba04e465cd4d?s=128&d=identicon&r=PG", "display_name": "adnan", "link": "https://stackoverflow.com/users/2134868/adnan"}, "edited": false, "score": 0, "creation_date": 1562796435, "post_id": 56979138, "comment_id": 100494377, "body": "photos attached already, for example in first photo the range that should be delted is (G5:H5) and (G6:H6) , but the delted is only one of them after execute the code"}, {"owner": {"reputation": 123, "user_id": 2134868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5db9a56c1af355d10eba04e465cd4d?s=128&d=identicon&r=PG", "display_name": "adnan", "link": "https://stackoverflow.com/users/2134868/adnan"}, "edited": false, "score": 0, "creation_date": 1562797162, "post_id": 56979138, "comment_id": 100494537, "body": "solved after change s from Integer to Long, and moving backwards, and avoid select , many thanks to your Awesome help"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1562797574, "post_id": 56979138, "comment_id": 100494649, "body": "FYI, Excel allows for more rows than <code>Integer</code> can handle. as a rule, you should always use <code>Long</code> since <code>Integer</code> has no benefit over it"}], "tags": [], "owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "is_accepted": true, "score": 2, "last_activity_date": 1562796572, "last_edit_date": 1562796572, "creation_date": 1562795627, "answer_id": 56979138, "question_id": 56979035, "link": "https://stackoverflow.com/questions/56979035/delete-cells-depend-on-thier-values-works-fine-but-skipped-the-half/56979138#56979138", "title": "Delete cells depend on thier values works fine but skipped the half", "body": "<pre><code>Sub Macro3()\n\nDim s As Long\nDim ws As Worksheet\n\nSet ws = ThisWorkbook.Worksheets(\"Sheet2\")\n\nFor s = 22 To 2 Step -1\n\n    If ws.Range(\"G\" &amp; s).Value = \"\" And ws.Range(\"H\" &amp; s).Value = \"\" Then \n        ws.Rows(s).Delete Shift:=xlUp\n        'or:\n        'ws.Range(\"G\" &amp; s &amp; \":H\" &amp; s).Delete Shift:=xlUp\n    End if\n\nNext s\n\nEnd Sub\n</code></pre>\n\n<p>After running the code:<br>\n<a href=\"https://i.stack.imgur.com/pqb93.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pqb93.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 123, "user_id": 2134868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a5db9a56c1af355d10eba04e465cd4d?s=128&d=identicon&r=PG", "display_name": "adnan", "link": "https://stackoverflow.com/users/2134868/adnan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 56979138, "answer_count": 1, "score": 0, "last_activity_date": 1562824674, "creation_date": 1562794958, "last_edit_date": 1562824674, "question_id": 56979035, "link": "https://stackoverflow.com/questions/56979035/delete-cells-depend-on-thier-values-works-fine-but-skipped-the-half", "title": "Delete cells depend on thier values works fine but skipped the half", "body": "<p>I need to delete 2 or more (variable depending on work) cells in the same row starting from row 2 if the 2 cells are = \"\"</p>\n\n<p>I used this code and it's already working fine except 1 problem</p>\n\n<pre><code>Sub Macro3()\n    Dim s As Integer\n    Dim ws As Worksheet\n\n    Set ws = ThisWorkbook.Worksheets(\"Sheet2\")\n\n    For s = 2 To 22\n        If ws.Range(\"G\" &amp; (s)) = \"\" And ws.Range(\"H\" &amp; (s)) = \"\" Then\n            Union(ws.Range(\"G\" &amp; s), ws.Range(\"H\" &amp; s)).Select\n            Selection.Delete Shift:=xlUp\n        End If\n    Next s\nEnd Sub\n</code></pre>\n\n<p>the problem is if I have for example from G2:H4 (2rows or more achieve the if condition) it's only delete half of them,</p>\n\n<p>if 5 rows delete 3 only...etc</p>\n\n<p>so I think the loop doesn't operate on the current cell (just guessing)</p>\n\n<p>Attach screens is before and after running the code for more clarification</p>\n\n<p>before</p>\n\n<p><a href=\"https://i.stack.imgur.com/tIGMa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tIGMa.png\" alt=\"before\"></a></p>\n\n<p>after</p>\n\n<p><a href=\"https://i.stack.imgur.com/JtKjV.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JtKjV.png\" alt=\"after\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11766985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dcc8db39b86d161ae2a2887848b2fea?s=128&d=identicon&r=PG&f=1", "display_name": "DevBLaud", "link": "https://stackoverflow.com/users/11766985/devblaud"}, "edited": false, "score": 0, "creation_date": 1562855948, "post_id": 56979098, "comment_id": 100517987, "body": "Thanks for taking a crack at this! Unfortunately I don&#39;t think a static range will work as the number of rows will be different every time."}, {"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "reply_to_user": {"reputation": 3, "user_id": 11766985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dcc8db39b86d161ae2a2887848b2fea?s=128&d=identicon&r=PG&f=1", "display_name": "DevBLaud", "link": "https://stackoverflow.com/users/11766985/devblaud"}, "edited": false, "score": 0, "creation_date": 1562862853, "post_id": 56979098, "comment_id": 100521716, "body": "The number of rows changing here won&#39;t matter, it&#39;s just static based on the column letters right now. If you have 5 rows or 100 rows this will work."}, {"owner": {"reputation": 3, "user_id": 11766985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dcc8db39b86d161ae2a2887848b2fea?s=128&d=identicon&r=PG&f=1", "display_name": "DevBLaud", "link": "https://stackoverflow.com/users/11766985/devblaud"}, "edited": false, "score": 0, "creation_date": 1563462821, "post_id": 56979098, "comment_id": 100716683, "body": "Ah you&#39;re right! Different approach than what I was thinking but this works. I really appreciate you&#39;re help!"}], "tags": [], "owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "is_accepted": true, "score": 0, "last_activity_date": 1562795391, "creation_date": 1562795391, "answer_id": 56979098, "question_id": 56978559, "link": "https://stackoverflow.com/questions/56978559/loop-or-for-statement-to-add-a-line-break-in-cells-of-selection-if-it-is-in-a-ce/56979098#56979098", "title": "Loop Or For Statement To Add A Line Break In Cells Of Selection If It Is In A Certain Row", "body": "<p>IMO I've never been a fan of that custom function - if you're okay with a static range solution, then this would work out fine:</p>\n\n<pre><code>Option Explicit\nSub Mail_Selected_Changes()\n\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim StrBody As String\n    Dim Signature As String\n    Dim mybody As String\n    Dim i As Long\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    For i = 2 To Cells(Rows.Count, 3).End(xlUp).Row\n        mybody = mybody &amp; Cells(i, 3).Value &amp; \"&lt;br&gt;\" &amp; _\n                Cells(i, 5).Value &amp; \"&lt;br&gt;\" &amp; _\n                Cells(i, 8).Value &amp; \" \" &amp; Cells(i, 9).Value &amp; \" \" &amp; Cells(i, 10).Value &amp; \" \" &amp; Cells(i, 11).Value &amp; \" \" &amp; Cells(i, 12).Value &amp; _\n                \"&lt;br&gt;&lt;br&gt;\"\n    Next i\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    'Body of message\n    StrBody = \"Hey Demi,\" &amp; \"&lt;br&gt;\" &amp; _\n              \" \" &amp; \"&lt;br&gt;\" &amp; _\n              \"Here is a list of changes:\" &amp; \"&lt;br&gt;&lt;br&gt;\"\n\n    'Signature\n    Signature = \" \" &amp; \"&lt;br&gt;\" &amp; _\n                \" \" &amp; \"&lt;br&gt;\" &amp; _\n                \"Thanks!\" &amp; \"&lt;br&gt;\" &amp; _\n                \" \" &amp; \"&lt;br&gt;\" &amp; _\n                \" \" &amp; \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\"\n\n    On Error Resume Next\n    With OutMail\n        .to = \"Email Address\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Changes\"\n        .HTMLBody = StrBody &amp; mybody &amp; Signature\n        .Display   'or use .Send\n\n    End With\n    On Error GoTo 0\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n</code></pre>\n\n<p>This code turns this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/oAZw2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oAZw2.png\" alt=\"img1\"></a></p>\n\n<p>Into this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/eOOxC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eOOxC.png\" alt=\"img2\"></a></p>\n\n<p>Just note that it's making a new section for every line in that section (not what's highlighted). This will not work if your row limit exceeds the VBA string char limit, which I think is 2GB?</p>\n"}], "owner": {"reputation": 3, "user_id": 11766985, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5dcc8db39b86d161ae2a2887848b2fea?s=128&d=identicon&r=PG&f=1", "display_name": "DevBLaud", "link": "https://stackoverflow.com/users/11766985/devblaud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 2, "accepted_answer_id": 56979098, "answer_count": 1, "score": 0, "last_activity_date": 1562856541, "creation_date": 1562792386, "last_edit_date": 1562856541, "question_id": 56978559, "link": "https://stackoverflow.com/questions/56978559/loop-or-for-statement-to-add-a-line-break-in-cells-of-selection-if-it-is-in-a-ce", "title": "Loop Or For Statement To Add A Line Break In Cells Of Selection If It Is In A Certain Row", "body": "<p>Hopefully that title makes sense. </p>\n\n<p>I have a selection of cells I need to add a line break to, but only if that cell is in specific columns (C,E, and H). The selection will then be copied to Outlook, but I've already figured that part out. So far this is all I have:</p>\n\n<pre><code>\nSub Mail_Selected_Changes()\n\n    Dim rng As Range\n    Dim OutApp As Object\n    Dim OutMail As Object\n    Dim StrBody As String\n    Dim Signature As String\n\n    Set rng = Nothing\n    On Error Resume Next\n    'Only the visible cells in the selection\n    Set rng = Selection.SpecialCells(xlCellTypeVisible)\n    'You can also use a fixed range if you want\n    'Set rng = Sheets(\"YourSheet\").Range(\"D4:D12\").SpecialCells(xlCellTypeVisible)\n    On Error GoTo 0\n\n    If rng Is Nothing Then\n        MsgBox \"The selection is not a range or the sheet is protected\" &amp; _\n               vbNewLine &amp; \"please correct and try again.\", vbOKOnly\n        Exit Sub\n    End If\n\n    With Application\n        .EnableEvents = False\n        .ScreenUpdating = False\n    End With\n\n    Set OutApp = CreateObject(\"Outlook.Application\")\n    Set OutMail = OutApp.CreateItem(0)\n\n    'Body of message\n    StrBody = \"Hey Demi,\" &amp; \"&lt;br&gt;\" &amp; _\n              \" \" &amp; \"&lt;br&gt;\" &amp; _\n              \"Here is a list of changes:\" &amp; \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\"\n\n    'Signature\n    Signature = \" \" &amp; \"&lt;br&gt;\" &amp; _\n                \" \" &amp; \"&lt;br&gt;\" &amp; _\n                \"Thanks!\" &amp; \"&lt;br&gt;\" &amp; _\n                \" \" &amp; \"&lt;br&gt;\" &amp; _\n                \" \" &amp; \"&lt;br&gt;&lt;br&gt;&lt;br&gt;\"\n\n    On Error Resume Next\n    With OutMail\n        .To = \"Email Address\"\n        .CC = \"\"\n        .BCC = \"\"\n        .Subject = \"Changes\"\n        .HTMLBody = StrBody &amp; RangetoHTML(rng) &amp; Signature\n        .Display   'or use .Send\n\n    End With\n    On Error GoTo 0\n\n    With Application\n        .EnableEvents = True\n        .ScreenUpdating = True\n    End With\n\n    Set OutMail = Nothing\n    Set OutApp = Nothing\nEnd Sub\n\n\nFunction RangetoHTML(rng As Range)\n\n    Dim fso As Object\n    Dim ts As Object\n    Dim TempFile As String\n    Dim TempWB As Workbook\n\n    TempFile = Environ$(\"temp\") &amp; \"\\\" &amp; Format(Now, \"dd-mm-yy h-mm-ss\") &amp; \".htm\"\n\n    'Copy the range and create a new workbook to past the data in\n    rng.Copy\n    Set TempWB = Workbooks.Add(1)\n    With TempWB.Sheets(1)\n        .Cells(1).PasteSpecial Paste:=8\n        .Cells(1).PasteSpecial xlPasteValues, , False, False\n        .Cells(1).PasteSpecial xlPasteFormats, , False, False\n        .Cells(1).Select\n        Application.CutCopyMode = False\n        On Error Resume Next\n        .DrawingObjects.Visible = True\n        .DrawingObjects.Delete\n        On Error GoTo 0\n    End With\n\n    'Publish the sheet to a htm file\n    With TempWB.PublishObjects.Add( _\n         SourceType:=xlSourceRange, _\n         Filename:=TempFile, _\n         Sheet:=TempWB.Sheets(1).Name, _\n         Source:=TempWB.Sheets(1).UsedRange.Address, _\n         HtmlType:=xlHtmlStatic)\n        .Publish (True)\n    End With\n\n    'Read all data from the htm file into RangetoHTML\n    Set fso = CreateObject(\"Scripting.FileSystemObject\")\n    Set ts = fso.GetFile(TempFile).OpenAsTextStream(1, -2)\n    RangetoHTML = ts.readall\n    ts.Close\n    RangetoHTML = Replace(RangetoHTML, \"align=center x:publishsource=\", _\n                          \"align=left x:publishsource=\")\n\n    'Close TempWB\n    TempWB.Close savechanges:=False\n\n    'Delete the htm file we used in this function\n    Kill TempFile\n\n    Set ts = Nothing\n    Set fso = Nothing\n    Set TempWB = Nothing\nEnd Function    \n</code></pre>\n\n<p>Basically I need to turn this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/dELuL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dELuL.png\" alt=\"enter image description here\"></a></p>\n\n<p>Into this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/1VIEm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1VIEm.png\" alt=\"enter image description here\"></a></p>\n\n<p>I will be adding this loop or for statement to the code from <a href=\"https://www.rondebruin.nl/win/s1/outlook/amail4.htm\" rel=\"nofollow noreferrer\">Ron de Bruin</a></p>\n\n<p>I've been trying for weeks now to figure this out but can't. Any help will be much appreciated!</p>\n\n<p>While this isn't correct I was thinking something like:</p>\n\n<pre><code>If Selection.cell Is In columns(A,C,D)\n     Then Selection.cell = vbCrLf &amp; Selection.cell\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1562792285, "creation_date": 1562792285, "answer_id": 56978534, "question_id": 56978465, "link": "https://stackoverflow.com/questions/56978465/dynamically-add-a-formula-with-my-excel-userform-everytime-i-hit-submit/56978534#56978534", "title": "Dynamically add a formula with my Excel userform everytime I hit submit", "body": "<p>Something like this:</p>\n\n<pre><code>Cells(emptyRow, 14).Formula = \"=TEXT(A\" &amp; emptyRow &amp; \", \"\"mmm yyyy\"\")\"\n</code></pre>\n\n<p>If the value in ColA is already a date there's no need to reconstruct it using DAY/MONTH/YEAR</p>\n"}], "owner": {"reputation": 17, "user_id": 7705456, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4229aaee6d917fc0f41297eed6d82130?s=128&d=identicon&r=PG&f=1", "display_name": "won_g", "link": "https://stackoverflow.com/users/7705456/won-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 56978534, "answer_count": 1, "score": 0, "last_activity_date": 1562824581, "creation_date": 1562791903, "last_edit_date": 1562824581, "question_id": 56978465, "link": "https://stackoverflow.com/questions/56978465/dynamically-add-a-formula-with-my-excel-userform-everytime-i-hit-submit", "title": "Dynamically add a formula with my Excel userform everytime I hit submit", "body": "<p>Here is the code I am using for my submit button </p>\n\n<pre><code>Private Sub cbsubmit_Click()\nDim emptyRow As Long\nSheets(\"ComplaintsData\").Activate\nemptyRow = WorksheetFunction.CountA(Range(\"A:A\")) + 1\nCells(emptyRow, 2).Value = emptyRow - 1\nCells(emptyRow, 1).Value = dtdate.Value\nCells(emptyRow, 3).Value = cmbSource.Value\nCells(emptyRow, 4).Value = cmbIssue.Value\nCells(emptyRow, 5).Value = cmbcomptype.ValueC\nCells(emptyRow, 6).Value = tbname.Value\nCells(emptyRow, 7).Value = ccdemail.Value\nCells(emptyRow, 8).Value = ccdphone.Value\nCells(emptyRow, 9).Value = cmbRegion.Value\nCells(emptyRow, 10).Value = tbreferred.Value\nCells(emptyRow, 11).Value = tbmanaged.Value\nCells(emptyRow, 12).Value = tbaction.Value\nCells(emptyRow, 13).Value = tbObjLink.Value\nCells(emptyRow, 14).Formula = \"=TEXT(DATE(YEAR(emptyrow,1),MONTH(emptyrow,1),DAY(emptyrow,1)),\"\"mmm\"\"&amp; \"\" \"\" &amp; \"\"yyyy\"\")\"\n</code></pre>\n\n<p>Everything works until the bit where I want to add a formula. What I am after is everytime I click submit, the formula is populated in column N based on date on column A and the row it is associated to. </p>\n\n<p>Hope someone can help me resolve this?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 2, "creation_date": 1562792309, "post_id": 56978335, "comment_id": 100493095, "body": "<a href=\"https://docs.microsoft.com/fr-fr/office/vba/api/excel.workbook.conflictresolution\" rel=\"nofollow noreferrer\">Microsoft docs</a> - <a href=\"https://docs.microsoft.com/fr-fr/office/vba/api/excel.xlsaveconflictresolution\" rel=\"nofollow noreferrer\">is your friend</a>"}, {"owner": {"reputation": 1, "user_id": 11767002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345129990cf6e242adab01e74726a185?s=128&d=identicon&r=PG&f=1", "display_name": "Moises CC", "link": "https://stackoverflow.com/users/11767002/moises-cc"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1562793482, "post_id": 56978335, "comment_id": 100493502, "body": "I already used this solution but it&#39;s not working. I saved my document with this code:  ActiveWorkbook.SaveAs Filename:= _         &quot;E:\\Users\\Document.xlsm&quot;, _         FileFormat:=xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False, accessMode:=xlShared, ConflictResolution:=xlLocalSessionChanges     bold**ActiveWorkbook.ConflictResolution = xlLocalSessionChanges  and the option what I am asking is still unselected."}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1562794859, "post_id": 56978335, "comment_id": 100493936, "body": "In this case, I suggest you add the already tried code into your question so people who may help will have a basis to start with."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11767002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345129990cf6e242adab01e74726a185?s=128&d=identicon&r=PG&f=1", "display_name": "Moises CC", "link": "https://stackoverflow.com/users/11767002/moises-cc"}, "edited": false, "score": 0, "creation_date": 1562795190, "post_id": 56978842, "comment_id": 100494024, "body": "I used your code:   ActiveWorkbook.ConflictResolution = xlLocalSessionChanges    ActiveWorkbook.Save  because I want to have the option &quot;The changes being saved win&quot; but, when I go to the option in excel manually, I see &quot;Ask me when changes win&quot; option selected :("}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 1, "user_id": 11767002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345129990cf6e242adab01e74726a185?s=128&d=identicon&r=PG&f=1", "display_name": "Moises CC", "link": "https://stackoverflow.com/users/11767002/moises-cc"}, "edited": false, "score": 0, "creation_date": 1562798146, "post_id": 56978842, "comment_id": 100494799, "body": "@MoisesCC that may not mean that it didn&#39;t work. Have you tested when there&#39;s a conflict? It&#39;s conceivable that the default setting may not update with VBA."}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": false, "score": 0, "last_activity_date": 1562793790, "creation_date": 1562793790, "answer_id": 56978842, "question_id": 56978335, "link": "https://stackoverflow.com/questions/56978335/conflicting-changes-between-users/56978842#56978842", "title": "conflicting changes between users", "body": "<p>While this doesn't matchup exactly with your screenshot, I think the below approach is how you would deal with this. You want to leverage the property <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.workbook.conflictresolution\" rel=\"nofollow noreferrer\">XlSaveConflictResolution</a> property. There's <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.xlsaveconflictresolution\" rel=\"nofollow noreferrer\">three ennumerated</a> options (even though your option box shows two). I think this would match what you're looking for:</p>\n\n<ul>\n<li><strong>xlUserResolution</strong> = Ask me when changes win</li>\n<li><strong>xlLocalSessionChanges</strong> = The changes being saved win</li>\n</ul>\n\n<p>Here's an example:</p>\n\n<pre><code>ActiveWorkbook.ConflictResolution = xlUserResolution\n</code></pre>\n\n<p>Let me know if this works as I didn't have time to test.</p>\n"}], "owner": {"reputation": 1, "user_id": 11767002, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345129990cf6e242adab01e74726a185?s=128&d=identicon&r=PG&f=1", "display_name": "Moises CC", "link": "https://stackoverflow.com/users/11767002/moises-cc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562793790, "creation_date": 1562791285, "last_edit_date": 1562791421, "question_id": 56978335, "link": "https://stackoverflow.com/questions/56978335/conflicting-changes-between-users", "title": "conflicting changes between users", "body": "<p>I created an excel macro for doing some calculations and at the end, save it as SHARED workbook. My problem is I can't find the EXCEL VBA code for activating the option THE CHANGES BEING SAVED WIN within Advanced tab in share workbook option \n<a href=\"https://i.stack.imgur.com/DcBsi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/DcBsi.png\" alt=\"enter image description here\"></a>\nAny idea? </p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562790494, "post_id": 56978133, "comment_id": 100492368, "body": "You&#39;re missing a period in front of the second <code>Cells</code> in the <code>Set pRange = ...</code> line."}, {"owner": {"reputation": 2074, "user_id": 9870211, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLEjk.png?s=128&g=1", "display_name": "Dean", "link": "https://stackoverflow.com/users/9870211/dean"}, "edited": false, "score": 2, "creation_date": 1562790588, "post_id": 56978133, "comment_id": 100492409, "body": "Side note: tips to create &quot;dynamic&quot; pivot tables: i) create the pivot table from a table, ii) create the pivot table using PowerQuery -&gt; PowerPivot."}, {"owner": {"reputation": 61, "user_id": 11442234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30221d1179a13aaf6d84e7f7544db79c?s=128&d=identicon&r=PG&f=1", "display_name": "radeg", "link": "https://stackoverflow.com/users/11442234/radeg"}, "edited": false, "score": 0, "creation_date": 1562790746, "post_id": 56978133, "comment_id": 100492473, "body": "I&#39;ve added the period, also forgot to add a variable: dim startPvt as String has been added. I am now getting an error message on the set pRange line stating &quot;run-time error &#39;1004&#39;: application-defined or object-defined error&quot;."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562790957, "post_id": 56978133, "comment_id": 100492549, "body": "You can&#39;t have <code>D1</code> as a column argument there..."}, {"owner": {"reputation": 4969, "user_id": 7558682, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0aa919494a7f9e7da118dc2998865ce?s=128&d=identicon&r=PG&f=1", "display_name": "Damian", "link": "https://stackoverflow.com/users/7558682/damian"}, "edited": false, "score": 1, "creation_date": 1562792048, "post_id": 56978133, "comment_id": 100493003, "body": "Make it easier... write a named ranged with this formula: <code>=OFFSET(A1,0,0,COUNTA(A:A),COUNTA(1:1))</code> use the sheet reference and you will have a dynamic range for your pivot table, then call that range on your source for the pivot table and thats all."}, {"owner": {"reputation": 61, "user_id": 11442234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30221d1179a13aaf6d84e7f7544db79c?s=128&d=identicon&r=PG&f=1", "display_name": "radeg", "link": "https://stackoverflow.com/users/11442234/radeg"}, "edited": false, "score": 0, "creation_date": 1562794206, "post_id": 56978133, "comment_id": 100493740, "body": "I changed the D1 to &quot;4&quot; and the code now works."}], "owner": {"reputation": 61, "user_id": 11442234, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30221d1179a13aaf6d84e7f7544db79c?s=128&d=identicon&r=PG&f=1", "display_name": "radeg", "link": "https://stackoverflow.com/users/11442234/radeg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 119, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562791642, "creation_date": 1562790290, "last_edit_date": 1562791642, "question_id": 56978133, "link": "https://stackoverflow.com/questions/56978133/how-can-i-create-a-dynamic-range-for-a-pivot-table", "title": "How can I create a dynamic range for a pivot table?", "body": "<p>I am trying to write a macro that creates a pivot table on a new sheet based on data from a master spreadsheet. How can I adjust my code to do this?</p>\n\n<p>I've gotten the code to work with static data but whenever the data is dynamic, the macro does not work. I believe the issue is with the first line starting with \"srcData = \". The line below, which is commented out, works without any issues.</p>\n\n<pre><code>Option Explicit\n\nDim pivotSht As Worksheet\nDim dataSht As Worksheet\nDim pCache As PivotCache\nDim pTable As PivotTable\nDim srcData As String\nDim pRange As Range\nDim lastR As Long\nDim lastC As Long\n\nPublic Sub buildPivot()\n\nSet dataSht = Worksheets(\"OOB\")\n\n'Defines data range in \"OOB\" sheet\nWith dataSht\n    lastR = .Cells(.Rows.Count, \"D\").End(xlUp).Row\n    lastC = .Cells(4, .Columns.Count).End(xlToLeft).Column\n    Set pRange = .Range(.Cells(1, \"D1\"), Cells(lastR, lastC))\nEnd With\n\nSheets(\"OOB\").Activate\nsrcData = ActiveSheet.Name &amp; \"!\" &amp; pRange.Address(ReferenceStyle:=xlR1C1)\n'srcData = ActiveSheet.Name &amp; \"!\" &amp; Range(\"D1:U714\").Address(ReferenceStyle:=xlR1C1)\n\n'Delete old \"PivotTable\" worksheet if it exists\nOn Error Resume Next\n    Application.DisplayAlerts = False\n    Worksheets(\"PivotTable\").Delete\n\n'Create new sheet and name it \"PivotTable\"\nSet pivotSht = Sheets.Add\nActiveSheet.Name = \"PivotTable\"\n\n'Set location of pivot table\nstartPvt = pivotSht.Name &amp; \"!\" &amp; pivotSht.Range(\"A3\").Address(ReferenceStyle:=xlR1C1)\n\n'Define pivot cache\nSet pCache = ActiveWorkbook.PivotCaches.Create( _\n    SourceType:=xlDatabase, _\n    SourceData:=srcData)\n\n'Creates pivot table from pivot cache\nSet pTable = pCache.CreatePivotTable( _\n    tabledestination:=startPvt, _\n    TableName:=\"Open Order Book Table\")\n\nEnd Sub\n\nThe expected output is a pivot table using all data as the source, even with changing data.\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1562790438, "post_id": 56978127, "comment_id": 100492348, "body": "<code>Auto_Open</code> is only refreshing all. How do you expect it to <code>SendToSql</code> if you don&#39;t tell it to?"}, {"owner": {"reputation": 87, "user_id": 11673018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097fd259703e1fa26ea7624761270bf?s=128&d=identicon&r=PG&f=1", "display_name": "nimavancouver", "link": "https://stackoverflow.com/users/11673018/nimavancouver"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562790771, "post_id": 56978127, "comment_id": 100492482, "body": "How should I tell it to? Sorry i should have started with i dont have much vba knowledge. This query is the result of research on internet/ answers from forum"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1562790904, "post_id": 56978127, "comment_id": 100492528, "body": "I don&#39;t see a reason for these to be in different modules. Move <code>SendToSQL</code> to the same module, and then add a new line in <code>Auto_Open</code>: <code>SendToSQL</code>."}], "answers": [{"comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562795628, "post_id": 56978914, "comment_id": 100494150, "body": "No need for <code>Call</code>. I didn&#39;t have that in my comment :)"}, {"owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562800277, "post_id": 56978914, "comment_id": 100495286, "body": "@BigBen yea habit on my end sorry. People at my work like to see <code>call</code> as it shows another sub being, well, called. Can either keep or omit the word <code>call</code> both will work"}], "tags": [], "owner": {"reputation": 720, "user_id": 10278914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd591e69f9b11478bbe911b7f444c274?s=128&d=identicon&r=PG&f=1", "display_name": "alowflyingpig", "link": "https://stackoverflow.com/users/10278914/alowflyingpig"}, "is_accepted": true, "score": 0, "last_activity_date": 1562794261, "creation_date": 1562794261, "answer_id": 56978914, "question_id": 56978127, "link": "https://stackoverflow.com/questions/56978127/several-module-automatic-to-be-launched-at-opening-excel-file-but-only-one-get-l/56978914#56978914", "title": "Several module automatic to be launched at opening excel file but only one get launch (VBA)", "body": "<p>As BigBen said, simply add it to <code>Auto_Open</code> like this:</p>\n\n<pre><code>Sub Auto_Open()\n    ActiveWorkbook.RefreshAll\n    Call SendToSQL\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 11673018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f097fd259703e1fa26ea7624761270bf?s=128&d=identicon&r=PG&f=1", "display_name": "nimavancouver", "link": "https://stackoverflow.com/users/11673018/nimavancouver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 56978914, "answer_count": 1, "score": 0, "last_activity_date": 1562794261, "creation_date": 1562790273, "last_edit_date": 1562791442, "question_id": 56978127, "link": "https://stackoverflow.com/questions/56978127/several-module-automatic-to-be-launched-at-opening-excel-file-but-only-one-get-l", "title": "Several module automatic to be launched at opening excel file but only one get launch (VBA)", "body": "<p>I have two macros (refresh data, send to SQL) that I am expecting to launch at the openning of the excel file. \nHowever only one works at the opening. I need to launch manually the second module. Why? Thank you</p>\n\n<p>Currently they are in different modules</p>\n\n<pre><code>Sub Auto_Open()\nActiveWorkbook.RefreshAll\nEnd Sub\n------------\nPrivate Sub SendtoSQL()\n\nDim cn As ADODB.connection\nDim ServerName As String\nDim DatabaseName As String\nDim TableName As String\nDim UserID As String\nDim Password As String\nDim rs As ADODB.recordset\nDim RowCounter As Long\nDim NoOfFields As Integer\nDim StartRow As Long\nDim EndRow As Long\nDim ColCounter As Integer\n\nSet rs = New ADODB.recordset\n\nServerName = \"xxx\" ' Enter your server name here\nDatabaseName = \"xxx\" ' Enter your  database name here\nTableName = \"xxx\" ' Enter your Table name here\nUserID = \"xxx\" ' Enter your user ID here\n' (Leave ID and Password blank if using windows Authentification\")\nPassword = \"xxx\" ' Enter your password here\nNoOfFields = 43 ' Enter number of fields to update (eg. columns in your worksheet)\nStartRow = 2 ' Enter row in sheet to start reading  records\nEndRow = 37 ' Enter row of last record in sheet\n\n '  CHANGES\nDim shtSheetToWork As Worksheet\nSet shtSheetToWork = ActiveWorkbook.Worksheets(\"Sheet2\")\n '********\n\nSet cn = New ADODB.connection\n\ncn.Open \"Driver={SQL Server};Server=\" &amp; ServerName &amp; \";Database=\" &amp; DatabaseName &amp; _\n\";Uid=\" &amp; UserID &amp; \";Pwd=\" &amp; Password &amp; \";\"\n\ncn.Execute \"delete from \" + TableName\n\n\nrs.Open TableName, cn, adOpenKeyset, adLockOptimistic\n\n 'EndRow = shtSheetToWork.Cells(Rows.Count, 1).End(xlUp).Row\nFor RowCounter = StartRow To EndRow\n    rs.AddNew\n    For ColCounter = 1 To NoOfFields\n    'On Error Resume Next\n        rs(ColCounter - 1) = shtSheetToWork.Cells(RowCounter, ColCounter)\n    Next ColCounter\n    Debug.Print RowCounter\nNext RowCounter\nrs.UpdateBatch\n\n ' Tidy up\nrs.Close\nSet rs = Nothing\ncn.Close\nSet cn = Nothing\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562791333, "post_id": 56978079, "comment_id": 100492705, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/10130300/how-do-we-know-the-sender-of-the-buttons-in-vba\">How do we know the sender of the buttons in VBA?</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562791357, "post_id": 56978079, "comment_id": 100492723, "body": "Or <a href=\"https://stackoverflow.com/questions/21010716/common-event-handler-to-get-the-name-of-activex-button-clicked-in-vba\">this question</a>."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562797501, "post_id": 56978079, "comment_id": 100494619, "body": "This would be easier if you don&#39;t use ActiveX buttons - you can use (eg) shapes formatted like buttons, set them all to the same &quot;onaction&quot; handler, and use <code>Application.Caller</code> inside the called code"}], "owner": {"reputation": 1, "user_id": 1573975, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59630cd311c16f215663ab5d7e98c575?s=128&d=identicon&r=PG", "display_name": "user1573975", "link": "https://stackoverflow.com/users/1573975/user1573975"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562824544, "creation_date": 1562790066, "last_edit_date": 1562824544, "question_id": 56978079, "link": "https://stackoverflow.com/questions/56978079/the-commant-me-activecontrol-name-is-giving-an-error", "title": "the commant Me.ActiveControl.Name is giving an error", "body": "<p>I am trying to get the name of the button (ActiveX command button) I clicked on my excel workbook but I am getting an error while trying to do that</p>\n\n<p>Button name in the sheet is \"Try\"\nThe error I am getting is \"Method of Data member not found\"</p>\n\n<p>The code I am trying to use is</p>\n\n<pre><code>Private Sub Try_Click()\n    Dim ButtonName As String\n    ButtonName = Me.ActiveControl.Name\n    MsgBox ButtonName\n</code></pre>\n\n<p>I want to use the name of the button as a condition to use in creating a filter for a table on a different worksheet (same workbook)</p>\n"}, {"tags": ["excel", "vba", "function"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1562788273, "post_id": 56977652, "comment_id": 100491530, "body": "What error are you getting?"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562788446, "post_id": 56977652, "comment_id": 100491593, "body": "<code>LastColumn = .Cells.Find(What:=&quot;*&quot;, after:=ActiveSheet.Cells(x, c), LookIn:=xlFormulas, LookAt:= _             xlPart, SearchOrder:=xlByColumns, SearchDirection:=xlPrevious, MatchCase:=False).column</code> gets the last column and saves you a loop"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562788466, "post_id": 56977652, "comment_id": 100491600, "body": "<code>x = CLng(Me.lblRow.Caption)</code> or something along those lines"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562788645, "post_id": 56977652, "comment_id": 100491682, "body": "@TimWilliams <code>RunTime Error 1004 Application - defined or object - defined error</code> Unfortunately your suggestion did not resolve the error."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 4, "creation_date": 1562788843, "post_id": 56977652, "comment_id": 100491759, "body": "What&#39;s the value of x and c when it fails?"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562788964, "post_id": 56977652, "comment_id": 100491797, "body": "@TimWilliams values on fail; <code>x=empty</code> &amp; <code>c=empty</code>"}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 1, "creation_date": 1562788997, "post_id": 56977652, "comment_id": 100491808, "body": "@Jose, isn&#39;t that the wrong use of <code>IsEmpty</code>? the cells are not variables that need to be initialised. What are you trying to achieve? If x and c are empty, then you will get a runtime error because you are trying to access a non-existent cell, which is an object defined error. If you state the purpose of the code or that line, then a solution can be prescribed"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 2, "creation_date": 1562789221, "post_id": 56977652, "comment_id": 100491879, "body": "@AAA <code>IsEmpty</code> works with any <code>Variant</code>. A cell&#39;s value will be <code>Variant&#47;Empty</code> when the cell has no content and no formula. No <code>Long</code> can ever be <code>Empty</code> though, so I dispute OP&#39;s claim that <code>x=empty</code> and <code>c=empty</code>, that&#39;s downright impossible. EDIT: Nevermind, I missed that we were looking at two separate scopes. OP is missing <code>Option Explicit</code>, <code>c</code> and <code>x</code> are undeclared/out-of-scope variables"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1562789241, "post_id": 56977652, "comment_id": 100491887, "body": "The problem is the two variables are themselves empty. .Cell(x,y) is 1 to x based so it would make sense youre getting an 1004 error"}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1562789294, "post_id": 56977652, "comment_id": 100491906, "body": "Or Mathieu could be more correct here, I was just commenting on what I saw/know about the function"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1562789466, "post_id": 56977652, "comment_id": 100491966, "body": "@DougCoats no, you&#39;re right, the variables are indeed <code>Empty</code>, because they&#39;re undeclared <code>Variant</code>s. Part of the problem is that the OP&#39;s code makes no sense whatsoever, <code>c</code> and <code>x</code> and others are being assigned outside of a procedure scope, so as presented, that code can&#39;t even compile, let alone produce a run-time error."}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1562789473, "post_id": 56977652, "comment_id": 100491970, "body": "@DougCoats the variables are not empty, i am declaring their value. Please see code"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562789511, "post_id": 56977652, "comment_id": 100491988, "body": "@MathieuGuindon i am hovering over the error line, which then reads  my variables are empty"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562789560, "post_id": 56977652, "comment_id": 100491999, "body": "Put <code>Option Explicit</code> at the top of your module, then try to compile. <code>callDate</code> has no knowledge of any of the variables it&#39;s using, and that&#39;s why they&#39;re all <code>Empty</code>."}, {"owner": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1562789617, "post_id": 56977652, "comment_id": 100492025, "body": "@Jose which is it dude? theyre either empty or theyre not. It sounds like theyre empty hence Im correct."}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562789919, "post_id": 56977652, "comment_id": 100492141, "body": "@MathieuGuindon thanks for making me realize the obvious. I rewrote my code after your suggestion. Posting answer below"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 4152, "user_id": 5009293, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/995762863775266/picture?type=large", "display_name": "Doug Coats", "link": "https://stackoverflow.com/users/5009293/doug-coats"}, "edited": false, "score": 0, "creation_date": 1562789949, "post_id": 56977652, "comment_id": 100492152, "body": "@DougCoats i never said they weren&#39;t empty, I said they are being declared"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1562791013, "post_id": 56977652, "comment_id": 100492569, "body": "&quot;the variables are not empty, i am declaring their value. Please see code \u2013 Jose 25 mins ago&quot; - just sayin&#39; ;-)"}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1562791749, "post_id": 56978208, "comment_id": 100492877, "body": "<code>CellRow</code> should be a <code>Long</code> - otherwise you can expect an overflow error (6) when its value is &gt;32,767 - i.e. <code>2 ^ 15 - 1</code>; <code>Integer</code> is a 16-bit integer type, while the maximum value of a <code>Long</code> is <code>2 ^ 31 - 1</code> (32-bit integer), which will accept any possible value for a row number on a worksheet. Also I&#39;d suggest moving the declarations into the <code>callDate</code> scope, since their meaning only makes sense inside that function. Keep variables&#39; scopes as tight as possible, you&#39;ll avoid many problems that way. And <code>Option Explicit</code> at the top, always. Cheers!"}, {"owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562792188, "post_id": 56978208, "comment_id": 100493056, "body": "@MathieuGuindon valuable feedback as always!"}], "tags": [], "owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "is_accepted": false, "score": 0, "last_activity_date": 1562790661, "creation_date": 1562790661, "answer_id": 56978208, "question_id": 56977652, "link": "https://stackoverflow.com/questions/56977652/how-to-resolve-function-runtime-error-in-vba/56978208#56978208", "title": "How to resolve Function RunTime Error in VBA", "body": "<p>Here is my solution</p>\n\n<p>By moving the variables inside of the function i was able to get the expected results with no runtime error.</p>\n\n<pre><code>Private LastRow As Long\nPrivate CellRow As Integer    ' create a variable to hold the cell row\nPrivate x As Long, c As Long, s As Long, z As Long\nConst CONTACT_START As Long = 13 ' Column E\nConst COL_PER_CONTACT As Long = 2 ' Columns per Contact\nConst CONTACT_DROPS As Long = 14 'Column G\nConst COL_PER_DROPS As Long = 2 'Columns per Contact\n\n\n\n\n\nPublic Function callDate() As Date\ns = CONTACT_START\nc = CONTACT_START\nx = CLng(addnewClient.lblRow.Caption)\nz = LastRow\nLastRow = Sheet3.Range(\"a\" &amp; Rows.count).End(xlUp).Row + 1\nCellRow = ActiveCell.Row\nWith ThisWorkbook.Sheets(\"clientmenu\")\n        c = CONTACT_START\n        x = CLng(addnewClient.lblRow.Caption)\n        ' Look for first empty one\n        Do Until IsEmpty(.Cells(x, c))\n            c = c + COL_PER_CONTACT\n        Loop\n        .Cells(x, c) = addnewClient.contact.value\n        '.Cells(x, c + 1) = Me.cdates1.Value\n    End With\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 11006826, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6cc1b338b0bce76e5eb23e1bdaba00a?s=128&d=identicon&r=PG", "display_name": "PP8", "link": "https://stackoverflow.com/users/11006826/pp8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562790661, "creation_date": 1562787980, "last_edit_date": 1562788882, "question_id": 56977652, "link": "https://stackoverflow.com/questions/56977652/how-to-resolve-function-runtime-error-in-vba", "title": "How to resolve Function RunTime Error in VBA", "body": "<p>I am getting a runtime error when calling my function from a SubRoutine. The highlighted line is <code>Do Until IsEmpty(.Cells(x, c))</code>.</p>\n\n<p>The generated error is <code>RunTime Error 1004 Application - defined or object - defined error</code></p>\n\n<p><strong>CODE</strong></p>\n\n<pre><code>Private LastRow As Long\nPrivate wb As Workbook: Set wb = ThisWorkbook\nPrivate ws As Worksheet: Set ws = wb.Sheets(\"clientmenu\")\nPrivate CellRow As Integer    ' create a variable to hold the cell row\nLastRow = Sheet3.Range(\"a\" &amp; Rows.count).End(xlUp).Row + 1\nCellRow = ActiveCell.Row\n\nPrivate x As Long, c As Long, s As Long\nConst CONTACT_START As Long = 13 ' Column E\nConst COL_PER_CONTACT As Long = 2 ' Columns per Contact\nConst CONTACT_DROPS As Long = 14 'Column G\nConst COL_PER_DROPS As Long = 2 'Columns per Contact\n\n\ns = CONTACT_START\nc = CONTACT_START\nx = Me.lblRow\nZ = LastRow\n\nPublic Function callDate() As Date\nWith ThisWorkbook.Sheets(\"clientmenu\")\n        ' Look for first empty one\n        Do Until IsEmpty(.Cells(x, c))\n            c = c + COL_PER_CONTACT\n        Loop\n        .Cells(x, c) = addnewClient.contact.value\n        '.Cells(x, c + 1) = Me.cdates1.Value\n    End With\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 3, "creation_date": 1562787512, "post_id": 56977511, "comment_id": 100491185, "body": "You can get the name of the currently opened file with <code>ActiveWorkbook.Name</code>"}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562793270, "post_id": 56977511, "comment_id": 100493427, "body": "@GraceBrazen, were you able to figure it?"}, {"owner": {"reputation": 1, "user_id": 11766385, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xHPtpN60v94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8FHWMa8VHTIXqZ9s0IRcF9xnS4A/photo.jpg?sz=128", "display_name": "Grace Brazen", "link": "https://stackoverflow.com/users/11766385/grace-brazen"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1562794978, "post_id": 56977511, "comment_id": 100493966, "body": "Thank you! @cybernetic.nomad That kind of worked, but since it includes the file extension, and since I&#39;m appending words at the end, I end up with file names like:  &quot;2019.07.10 octopus.xlsx \u2013 BACKUP.xlsx&quot;  Is there a way to remove the file extension from the name?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1562795124, "post_id": 56977511, "comment_id": 100494010, "body": "You can remove the extension by <a href=\"https://docs.microsoft.com/en-us/dotnet/visual-basic/language-reference/functions/string-functions\" rel=\"nofollow noreferrer\">manipulating the string</a>. Replacing <code>&quot;.xlsx&quot;</code> with <code>&quot;-- BACKUP.xlsx&quot;</code> should work"}, {"owner": {"reputation": 1, "user_id": 11766385, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xHPtpN60v94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8FHWMa8VHTIXqZ9s0IRcF9xnS4A/photo.jpg?sz=128", "display_name": "Grace Brazen", "link": "https://stackoverflow.com/users/11766385/grace-brazen"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1562796679, "post_id": 56977511, "comment_id": 100494435, "body": "@cybernetic.nomad thanks for the link! It&#39;s a bit advanced for me so I&#39;ll bookmark it to study later. In the meantime I found a thread on here that recommended using Left(Filename, Len(Filename) - 4), so I did that but replaced it with ActiveWorkbook.Name per your suggestion, and that did the trick. Thanks so much for your help! I&#39;m really grateful it was such a simple fix."}], "owner": {"reputation": 1, "user_id": 11766385, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-xHPtpN60v94/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rf8FHWMa8VHTIXqZ9s0IRcF9xnS4A/photo.jpg?sz=128", "display_name": "Grace Brazen", "link": "https://stackoverflow.com/users/11766385/grace-brazen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 629, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562787305, "creation_date": 1562787305, "question_id": 56977511, "link": "https://stackoverflow.com/questions/56977511/how-to-use-excel-macro-to-add-text-to-file-name", "title": "How to use Excel macro to add text to file name", "body": "<p>I recorded a macro in excel to make some formatting changes to spreadsheets. I\u2019m planning to run it every time I open a new export to begin working with it. I\u2019d also like my macro to rename the file, based on the original name but adding more words.</p>\n\n<p>For example:</p>\n\n<p>Old file name: Sales.xls</p>\n\n<p>New file name: 2019.07.10 Export Sales Backup.xlsx</p>\n\n<p>The original file name will be different every time (\u201cSales\u201d, \u201cMailing\u201d, etc.), so I need the code to be based on the old name and not just dub everything Sales. The folder will always be the same\u2014the file will always come from Desktop and get saved to Desktop. </p>\n\n<p>I\u2019ve read some questions about renaming but I can\u2019t figure out how to parse the original file name to separate out the file path and only keep the bit I need. I\u2019ve also seen questions that are about a batch rename, but I want to do this as part of an existing excel macro that I\u2019ll already be running anyway. I\u2019ve already read through these forums and figured out how to add the date and change the file format.</p>\n\n<p>My current code says:</p>\n\n<pre><code>Sub Test()\n\nFName = \"C:\\Users\\Grace\\Desktop\\\" &amp; Format(Date, \"yyyy.mm.dd\") &amp; \".xlsx\"\n    ActiveWorkbook.SaveAs Filename:=FName, _\n    FileFormat:= _\n        xlOpenXMLWorkbook, CreateBackup:=False\n\nEnd Sub\n</code></pre>\n\n<p>I don't know where to start with trying to keep the original file name. Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1562784958, "post_id": 56976998, "comment_id": 100490167, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/17733541/why-does-range-work-but-not-cells\">Why does Range work, but not Cells?</a>"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1562785002, "post_id": 56976998, "comment_id": 100490181, "body": "Also - test <code>If Not Rango Is Nothing</code> - you&#39;re assuming that the <code>Find</code> is successful."}, {"owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562785156, "post_id": 56976998, "comment_id": 100490261, "body": "Not duplicate because im testing it in a sheet that only has the value that im looking for. And already tried the If Not Rango is nothing And since here the find will always be succesful i didnt need to add that. Also for some reason its adding numbers in certain cells idk why."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1562785243, "post_id": 56976998, "comment_id": 100490303, "body": "Qualify the worksheet that the <code>Cells</code> are on. That&#39;s why it&#39;s a dupe. You can use a <code>With...End With</code> block."}, {"owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562785538, "post_id": 56976998, "comment_id": 100490408, "body": "Everything Starting on Rango is in Partida&#39;s sheet u mean i should make the with that already has bigger?"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562785601, "post_id": 56976998, "comment_id": 100490435, "body": "No. You have <code>Cells(1, RangoC_1), Cells(1, RangoC_2)</code>. There&#39;s no <code>Worksheet</code> specified before those <code>Cells</code>, so there&#39;s an implicit <code>ActiveSheet</code>. The <code>ActiveSheet</code> may not be <code>Sheets(&quot;Prueba&quot;)</code>. Also - what if the match is found in Column A? That will throw an error as well. I guess that&#39;s the point of the posted answer."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1562785861, "post_id": 56976998, "comment_id": 100490540, "body": "You&#39;re still missing a period <code>.</code> in front of those <code>Cells</code> calls. That&#39;s the same error."}, {"owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562786104, "post_id": 56976998, "comment_id": 100490630, "body": "It will never be in column A simply because the format on the original code will be always at least on column B. Right now im doing it on column D on the test sheet. Btw now the 1004 error is not appearing but its still not working :("}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1562786292, "post_id": 56976998, "comment_id": 100490717, "body": "&quot;And since here the find will always be succesful i didnt need to add that&quot; - fine, but don&#39;t ask why you&#39;re getting error 91 later."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 3, "creation_date": 1562786304, "post_id": 56976998, "comment_id": 100490721, "body": "&quot;It will never be in column A simply because...&quot; until someone changes the layout because they don&#39;t know that the layout of columns is critical to making the code work. @BigBen&#39;s suggestions are simple things that will make your code much more robust so you (or a coworker) don&#39;t have to come back here in a year and ask, &quot;this has been working for a year and now all of a sudden it doesn&#39;t. What happened?&quot;"}, {"owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1562786841, "post_id": 56976998, "comment_id": 100490937, "body": "I understan that @FreeMan but the whole point of the code is deleting a whole format, which is 3 columns lenght 1 on the left and 1 on the right from the value that im looking for."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1562788083, "post_id": 56976998, "comment_id": 100491428, "body": "@Armas.Chuy as a general rule, it&#39;s not appropriate to update your OP <i>code</i> with fixes along the way. That makes it difficult for someone coming along in the future to identify how the selected answer (or comments or unselected answer(s)) addressed/fixed the original problem - there&#39;s significant future value in that as well. It&#39;s quite OK to leave broken code posted - that&#39;s what this site is all about. It&#39;s perfectly OK to post additional code (particularly if it&#39;s requested) to help your helpers get &quot;the big picture&quot;, or to add additional explanatory text to clarify the problem."}, {"owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "edited": false, "score": 0, "creation_date": 1562788248, "post_id": 56976998, "comment_id": 100491515, "body": "Oh sry im new :( i thought it was better but yeah thanks"}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "edited": false, "score": 0, "creation_date": 1562785289, "post_id": 56977069, "comment_id": 100490320, "body": "No, since im trying it out on a test sheet, also in the actual code it won&#39;t ever be 0."}, {"owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "edited": false, "score": 0, "creation_date": 1562786180, "post_id": 56977069, "comment_id": 100490667, "body": "Right now its on column D, as i said on the answer above, in the original code will be at least on B."}, {"owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "edited": false, "score": 0, "creation_date": 1562786678, "post_id": 56977069, "comment_id": 100490872, "body": "Yeah im look for row 6"}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "reply_to_user": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "edited": false, "score": 0, "creation_date": 1562787112, "post_id": 56977069, "comment_id": 100491035, "body": "You are searching row 66, see update. Also you are searching for a variable that is never set"}, {"owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "edited": false, "score": 0, "creation_date": 1562787266, "post_id": 56977069, "comment_id": 100491093, "body": "Indeed im dumb :( Thank you"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "edited": false, "score": 3, "creation_date": 1562787373, "post_id": 56977069, "comment_id": 100491131, "body": "@Armas.Chuy add <code>Option Explicit</code> at the top of <i>every module</i> in the project, then try to compile. If it doesn&#39;t compile, you are using variables that aren&#39;t declared anywhere... which I suspect <code>Partida_N</code> is."}], "tags": [], "owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "is_accepted": true, "score": 1, "last_activity_date": 1562786818, "last_edit_date": 1562786818, "creation_date": 1562785172, "answer_id": 56977069, "question_id": 56976998, "link": "https://stackoverflow.com/questions/56976998/deleting-entire-columns-from-a-value-found/56977069#56977069", "title": "Deleting entire columns from a value found", "body": "<p>You put the txt.value into a var named Prueba_N but then search for Partida_N</p>\n\n<pre><code>**Prueba_N** = Partida.Txt.Value\nIf Prueba_N &lt;&gt; 0 Then\n    With Sheets(\"Prueba\").Rows(\"6:6\")\n        Set Rango = .Find(What:=**Partida_N**, After:=.Cells(.Cells.Count), LookIn:=xlValues, Lookat:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)\n    End With\n</code></pre>\n\n<p>Should be </p>\n\n<pre><code>**Partida_N**, = Partida.Txt.Value\nIf Prueba_N &lt;&gt; 0 Then\n    With Sheets(\"Prueba\").Rows(\"6:6\")\n        Set Rango = .Find(What:=**Partida_N**, After:=.Cells(.Cells.Count), LookIn:=xlValues, Lookat:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)\n    End With\n</code></pre>\n\n<p>Also</p>\n\n<pre><code>Rows(\"6,6\")\n</code></pre>\n\n<p>Searches Row 66</p>\n\n<p>You want </p>\n\n<pre><code>Rows(\"6\") \n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 11734600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6550b82e021da72e177ca692195cd8e?s=128&d=identicon&r=PG&f=1", "display_name": "Armas.Chuy", "link": "https://stackoverflow.com/users/11734600/armas-chuy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56977069, "answer_count": 1, "score": -1, "last_activity_date": 1562788262, "creation_date": 1562784854, "last_edit_date": 1562788262, "question_id": 56976998, "link": "https://stackoverflow.com/questions/56976998/deleting-entire-columns-from-a-value-found", "title": "Deleting entire columns from a value found", "body": "<p>So i want a value from a text box, that is in a form, to be looked for, then i want the value's column and the columns from the left and the right to get deleted. But for some reason the Rango.Column is not getting the columns correctly.\nThe code successfully finds the value.</p>\n\n<pre><code>Private Sub CommandButton1_Click()\nDim Rango As Range\n\nDim Prueba_N As String\n\n    Prueba_N = Partida.Txt.Value\n    If Prueba_N &lt;&gt; 0 Then\n        With Sheets(\"Prueba\").Rows(\"6:6\")\n            Set Rango = .Find(What:=Partida_N, After:=.Cells(.Cells.Count), LookIn:=xlValues, Lookat:=xlWhole, SearchOrder:=xlByColumns, SearchDirection:=xlNext, MatchCase:=False)\n\n        End With\n\n            RangoC_1 = Rango.Column - 1\n            RangoC_2 = Rango.Column + 1\n            Sheets(\"Prueba\").Range(Cells(1, RangoC_1), Cells(1, RangoC_2)).EntireColumn.Delete\n            Finalizar = MsgBox(\"Se ha eliminado la partida exitosamente\")\n            Partida.Hide\n            Sheets(\"Materiales\").Activate\n\n    Else\n        Partida_Err = MsgBox(\"Agregar Partida\", vbCritical)\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>I also dont know why sometimes if i start the partida's form from the button it returns me the 1004 error on the <code>Sheets(\"Prueba\").Range...</code> line but if i start the form directly it doesnt give me the error.</p>\n"}, {"tags": ["vba", "ms-access", "cmd"], "comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1562788629, "post_id": 56976483, "comment_id": 100491670, "body": "If you were to launch the jar using a command line, would you know the command (e.g. <code>java -jar yourJar.jar -yourParameters...</code>)? If so, you can just build the string in VBA, then use the code in the question you linked to open a shell and execute the program. You may have some path problems (if your jar is based on some env variables that are not available with the fresh shell created by VBA), but if you can launch it from a Windows command prompt, you should automatically inherit all the path variables of your computer."}, {"owner": {"reputation": 183, "user_id": 11593509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb49e8e27add0d97f19e6201e461d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Sunfile", "link": "https://stackoverflow.com/users/11593509/sunfile"}, "reply_to_user": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1562827394, "post_id": 56976483, "comment_id": 100501431, "body": "@MatteoNNZ I have edited the question because we use the same java program also with the help of only a .cmd-file and no PowerShell. Can you derive what code we need to launch the jar from command line? I am not familiar with this way of coding."}], "answers": [{"comments": [{"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "edited": false, "score": 0, "creation_date": 1562834396, "post_id": 56985011, "comment_id": 100504907, "body": "P.s. I think you may remove the tags java and jar from the question, as it&#39;s just a case that you&#39;re running a java program and not something else."}, {"owner": {"reputation": 183, "user_id": 11593509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb49e8e27add0d97f19e6201e461d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Sunfile", "link": "https://stackoverflow.com/users/11593509/sunfile"}, "edited": false, "score": 0, "creation_date": 1563015990, "post_id": 56985011, "comment_id": 100567870, "body": "I have used your line of code, changed it into: &quot;java -cp .\\yyyyy.jar -Djavax.net.ssl.trustStore=zzzz.keystore ...etc. It calls the WScript.Shell, but my java program now returns an error: Failed to create temporary file for /com/sun/jna/win32-x86/jnidispatch.dll library: not found in resource path. If i run the same code in VBA with the Shell command, the program runs fine. What do I need to change?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 183, "user_id": 11593509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb49e8e27add0d97f19e6201e461d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Sunfile", "link": "https://stackoverflow.com/users/11593509/sunfile"}, "edited": false, "score": 0, "creation_date": 1563056987, "post_id": 56985011, "comment_id": 100576579, "body": "I think your VBA Shell is missing the context defined in the PATH that your normal shell has. You should print the path from a command prompt, and export it into the VBA shell before running the command. Your VBA she\u2019ll is surely missing the path of some executables."}, {"owner": {"reputation": 183, "user_id": 11593509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb49e8e27add0d97f19e6201e461d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Sunfile", "link": "https://stackoverflow.com/users/11593509/sunfile"}, "edited": false, "score": 0, "creation_date": 1565001883, "post_id": 56985011, "comment_id": 101200798, "body": "I have checked the PATH between both normal and VBA Shell, but both are the same. Strangest thing is that when I have ran the cmd seperately from Access, and than calling it through VBA, it works. When I reboot computer and call it directly from VBA without using the CMD seperate first, It returns the error again. Any suggestions where to find the cause for this?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 183, "user_id": 11593509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb49e8e27add0d97f19e6201e461d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Sunfile", "link": "https://stackoverflow.com/users/11593509/sunfile"}, "edited": false, "score": 0, "creation_date": 1565085157, "post_id": 56985011, "comment_id": 101231479, "body": "@Avanasten I think it&#39;s a matter of user profiles. When you start the CMD manually, it&#39;s loading your user profile and keeping it for next executions. However, the same is not triggered when you run the shell directly from VBA. You should look on internet how to load the profile correctly in vba."}, {"owner": {"reputation": 183, "user_id": 11593509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb49e8e27add0d97f19e6201e461d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Sunfile", "link": "https://stackoverflow.com/users/11593509/sunfile"}, "edited": false, "score": 0, "creation_date": 1565261843, "post_id": 56985011, "comment_id": 101302078, "body": "can you guide me a little bit more into what I should google. I have found information about %userprofile% and checked both cmd&#39;s to show content of that variable, both are equal. Didn&#39;t find anything more about user permissions etc, do yuou have some links or keywords to help me?"}, {"owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "reply_to_user": {"reputation": 183, "user_id": 11593509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb49e8e27add0d97f19e6201e461d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Sunfile", "link": "https://stackoverflow.com/users/11593509/sunfile"}, "edited": false, "score": 0, "creation_date": 1565262801, "post_id": 56985011, "comment_id": 101302604, "body": "@Avanasten you understand what <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/desktop/legacy/bb776892(v=vs.85)\" rel=\"nofollow noreferrer\">user profiles</a> are, then you figure out which one is your by default, you search <a href=\"https://www.digi.com/resources/documentation/digidocs/90001458-13/task/t_command_line_load_profile.htm\" rel=\"nofollow noreferrer\">how to run command line under a specific profile</a> and you send your command along with the correct user profile."}], "tags": [], "owner": {"reputation": 8802, "user_id": 3111149, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/ez4Kx.png?s=128&g=1", "display_name": "Matteo NNZ", "link": "https://stackoverflow.com/users/3111149/matteo-nnz"}, "is_accepted": false, "score": 0, "last_activity_date": 1562834357, "creation_date": 1562834357, "answer_id": 56985011, "question_id": 56976483, "link": "https://stackoverflow.com/questions/56976483/how-to-call-java-object-in-vba-with-classpath/56985011#56985011", "title": "How to call java object in VBA with classpath", "body": "<p>What you are trying to do is to run a command via the command line. It just happens that this command runs <code>java</code>, as far as the VBA code is concerned it may run anything that the shell would understand. </p>\n\n<p>A sample code to run a command via a shell in VBA is the following (note there are many ways and it's super easy to find these samples on internet, I'm just using the first one I found): </p>\n\n<pre><code>Dim wsh As Object\nSet wsh = VBA.CreateObject(\"WScript.Shell\")\nDim waitOnReturn As Boolean: waitOnReturn = False\nDim windowStyle As Integer: windowStyle = 1\n\nwsh.Run \"cmd.exe /S /C \" &amp; yourCommand\n</code></pre>\n\n<p>... where <code>yourCommand</code> is the litteral string you would run in your command prompt. Now, it's all about string concatenation in VBA. Following your sample (and adding the username directly from VBA): </p>\n\n<pre><code>user = Environ(\"UserName\")\nyourCommand = \"java -Djavax.net.ssl.trustStore=zzzz.keystore com.router.router.router.Router -user:\" &amp; user \n</code></pre>\n\n<p>(please note that I replaced <code>%USR%</code> - which asks the shell to retrieve the username - with a variable <code>user</code> that I've defined in VBA, even though in this specific example, the function <code>Environ</code> is asking environment variables so it's still asking it to a shell).</p>\n"}], "owner": {"reputation": 183, "user_id": 11593509, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bb49e8e27add0d97f19e6201e461d2a?s=128&d=identicon&r=PG&f=1", "display_name": "Sunfile", "link": "https://stackoverflow.com/users/11593509/sunfile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1563014956, "creation_date": 1562782562, "last_edit_date": 1563014956, "question_id": 56976483, "link": "https://stackoverflow.com/questions/56976483/how-to-call-java-object-in-vba-with-classpath", "title": "How to call java object in VBA with classpath", "body": "<p>We use a CMD to call a PowerShell script. In the PowerShell script, a Java program is called. Both files are in the same directory. I want this all replaced by VBA within Microsoft Access. I have found several related topics but I can't decide whether it is possible or not based on these topics. Topics like <a href=\"https://stackoverflow.com/questions/41533076/launch-jar-file-from-vba-code\">Launch jar file from VBA code</a>  </p>\n\n<p>The CMD contains the following code: </p>\n\n<pre><code>SET CLASSPATH=.\\yyyyy.jar\npowershell .\\startscript.ps1\n</code></pre>\n\n<p>The PowerShell script contains the following sample: </p>\n\n<pre><code>&amp; java '-Djavax.net.ssl.trustStore=\"zzzz.keystore\"' com.router.router.router.Router -user:... etc. \n</code></pre>\n\n<p>We also run the same Java program in a different setting, only with the use of one .CMD-file. This is made like:</p>\n\n<pre><code>SET USR=user\nSET CLASSPATH=.\\yyyyy.jar\njava -Djavax.net.ssl.trustStore=zzzz.keystore com.router.router.router.Router -user:%USR% etc. \n</code></pre>\n\n<p>Preferably both PowerShell and CMD become obsolete and the parameters like \"-user\" are fed with variables from the VBA code. </p>\n\n<p>Does someone have a usable link, example or code? Please advice.</p>\n"}, {"tags": ["vba", "excel-2016"], "answers": [{"tags": [], "owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "is_accepted": false, "score": 0, "last_activity_date": 1562784596, "creation_date": 1562784596, "answer_id": 56976936, "question_id": 56976461, "link": "https://stackoverflow.com/questions/56976461/how-to-sort-two-data-sets-based-on-1-column-value-and-move-non-matched-to-bottom/56976936#56976936", "title": "How to Sort Two Data Sets Based on 1 Column Value and Move Non-Matched to Bottom?", "body": "<p>Iterate through the rows after the initial sort, then do a comparison if true put the iterator in an unused column. After sort the entire dataset by the column with the iterator value then delete the contents of the column.</p>\n\n<p>A rough example:</p>\n\n<pre><code>dim iter as long\ndim lastrow as long\nWith Sheets(\"Sheet1\")\n    with .Sort\n         Range(\"B2\").Sort Key1:=Range(\"B2\"), Order1:=xlAscending\n         .Apply\n    end with\n    lastrow = .cells(.rows.count, \"A\").end(xlup).row\n    for iter = 2 to lastrow\n        if .cells(iter, \"C\") = .cells(iter, \"H\") then\n            .cells(iter, \"K\").value = iter\n        end if\n    next\n    with .sort\n        range(.cells(1, 1), .cells(lastrow, \"H\").sort Key1:=Range(\"H\"), order1:=xlascending\n        .apply\n    end with\nEnd With\n</code></pre>\n\n<p>This example is only comparing names on the same line, if you need to compare the entire contents of both ranges you will probably want to use dictionaries to do the comparison.</p>\n"}], "owner": {"reputation": 9, "user_id": 10515481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e1a32799ba7aae111a53dd508d4e419?s=128&d=identicon&r=PG&f=1", "display_name": "Geni O", "link": "https://stackoverflow.com/users/10515481/geni-o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562784596, "creation_date": 1562782465, "last_edit_date": 1562783580, "question_id": 56976461, "link": "https://stackoverflow.com/questions/56976461/how-to-sort-two-data-sets-based-on-1-column-value-and-move-non-matched-to-bottom", "title": "How to Sort Two Data Sets Based on 1 Column Value and Move Non-Matched to Bottom?", "body": "<p>I would like to sort two datasets by the value in a particular column and then compare these datasets. If there is no match between the datasets for a particular entry, I would like this to be moved to the bottom.</p>\n\n<p>So, for example, I would like to sort the following data from column B-E by the value in column B and column G-J by the value in column G:\n<img src=\"https://i.stack.imgur.com/Wpm2G.png\" alt=\"Initial Data\"></p>\n\n<p>I have used the following code to sort the data:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>With Sheets(\"Sheet1\").Sort\n    Range(\"B2\").Sort Key1:=Range(\"B2\"), Order1:=xlAscending\n    .Apply\nEnd With\n</code></pre>\n\n<p>This leaves me with the following:\n<img src=\"https://i.stack.imgur.com/HhlNj.png\" alt=\"Data after sort\"></p>\n\n<p>However, I want to compare for matches from left to right after sorting, and would, therefore, like for extra entries that do not have a match to be moved to the bottom. i.e. the entry with the name Dorian in picture 2 would appear at the bottom of the data set, so that Sue, Adam, and Jake are aligned between the two sets of data.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1562782557, "post_id": 56976266, "comment_id": 100489109, "body": "Have you attempted to call your assigning macro during the initialization of the userform?"}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1562782858, "post_id": 56976266, "comment_id": 100489273, "body": "<code>But if I close the form and reopen it, it resets back to the previous control tip text. Any idea why this occurs?</code> That is the default behaviour. Once you close (Unload) the form, All those changes &quot;to the form&quot; are lost. Either assign them in the <code>UserForm_Initialize</code> or before you <code>.Show</code> the form."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562784209, "post_id": 56976266, "comment_id": 100489875, "body": "<a href=\"https://books.google.com/books?id=dtSdrjjVXrwC&amp;pg=PA884&amp;lpg=PA884&amp;dq=userform+runtime+vs+design+time&amp;source=bl&amp;ots=yWi4grprVi&amp;sig=ACfU3U1KWPMWY0z-hil9aM9wvM1LKrGThg&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwjin_zjgKvjAhVQrJ4KHUZFAKoQ6AEwBXoECAcQAQ#v=onepage&amp;q=userform%20runtime%20vs%20design%20time&amp;f=false\" rel=\"nofollow noreferrer\">books.google.com/&hellip;</a>"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562784527, "post_id": 56976266, "comment_id": 100489994, "body": "@TimWilliams - that is a good answer that warrants more than just a comment"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 0, "creation_date": 1562784746, "post_id": 56976266, "comment_id": 100490079, "body": "@Sam - it maybe does warrant a full write-up, but that already exists at the link I posted (and other places), so I&#39;m Ok with just posting the link.  Sid already explained the situation well enough I thought.  Mostly posting the link for the section title &quot;Design-time versus run-time userform manipulations&quot; to give the OP some terms to google for..."}], "answers": [{"comments": [{"owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "edited": false, "score": 0, "creation_date": 1563305793, "post_id": 56977855, "comment_id": 100653749, "body": "So do you mean to say that the form object does not exist outside of run-time?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "edited": false, "score": 0, "creation_date": 1563306118, "post_id": 56977855, "comment_id": 100653893, "body": "Kind of. In the case of MSForms it&#39;s a bit more complicated than that because the designer is itself an instance of the form (and notice how the designer is automatically closed in the VBE whenever the form is running, and reopens when the running form instance is destroyed), but yes, an <i>object</i> can only ever exist at run-time. If there&#39;s no runtime/execution context, there can be no objects; a class is a <i>data type</i>, an <i>instance</i> of a class is an object."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 2, "last_activity_date": 1562788952, "creation_date": 1562788952, "answer_id": 56977855, "question_id": 56976266, "link": "https://stackoverflow.com/questions/56976266/excel-user-form-keeps-resetting-control-tip-text/56977855#56977855", "title": "Excel user form keeps resetting control tip text", "body": "<p>You are missing the concept of <em>instance</em>. A <code>UserForm</code> is a class, and classes define the shape/interface of an <em>object</em>. What's special about a <code>UserForm</code> is that 1) it has a visual designer, and 2) it has a hidden <code>VB_PredeclaredId</code> attribute set to <code>True</code>, which means the class has a <em>default instance</em>.</p>\n\n<p>When you do this:</p>\n\n<pre><code>UserForm1.Show\n</code></pre>\n\n<p>You are invoking the <code>Show</code> method against the <em>default instance</em> of the form. When that form is closed, the object is destroyed... until it's automatically created again the next time you reference the <code>UserForm1</code> default instance.</p>\n\n<blockquote>\n  <p><em>I know that I can force new text at run time by assigning it in the UserForm_Initialize sub, but I'd prefer not to since that would add a layer of inefficiency.</em></p>\n</blockquote>\n\n<p>Not at all. Something, somewhere needs to initialize the form. If your form controls need to be configured at run-time, <code>UserForm_Initialize</code> is the <strong>single best possible place</strong> to initiate this configuration - it ensures that <em>every time</em> a new instance of the form is created, it's properly initialized. In the case of an instruction like <code>UserForm1.Show</code>, the handler runs at the <code>.</code> dereferencing operator, just before the <code>Show</code> method is invoked.</p>\n\n<p>The object retains its state as long as it exists. Problem is, \"X'ing-out\" of the form will destroy the object, and thus reset it to its original, design-time state.</p>\n\n<p>You can prevent the form instance from self-destructing by handling the <code>QueryClose</code> event and setting the <code>Cancel</code> parameter to <code>True</code> when the <code>CloseMode</code> parameter value is <a href=\"https://docs.microsoft.com/en-us/openspecs/microsoft_general_purpose_programming_languages/ms-vbal/89023539-ebf1-4e5c-ac50-b7d335ec42d3\" rel=\"nofollow noreferrer\"><code>VbQueryClose.vbFormControlMenu</code></a>, and then <code>Hide</code>ing the form rather than destroying it - of course you should never <code>Unload</code> the form either.</p>\n\n<p>Dealing with a <code>UserForm</code> becomes much simpler when <em>you</em> control when it's created, <em>and when it's destroyed</em>. In other words, when you <strong>avoid using its default instance</strong> to store any state.</p>\n\n<pre><code>With New UserForm1 ' _Initialize handler runs\n    '..setup initial form state here..\n    .Show\n    '..access form state here..\nEnd With ' _Terminate handler runs, object is destroyed\n</code></pre>\n\n<p>I wrote articles <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">UserForm1.Show</a> and <a href=\"https://rubberduckvba.wordpress.com/2019/07/08/about-class-modules/\" rel=\"nofollow noreferrer\">About Class Modules</a> covering these topics in-depth.</p>\n"}], "owner": {"reputation": 1407, "user_id": 5835002, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/mnMDz.jpg?s=128&g=1", "display_name": "SendETHToThisAddress", "link": "https://stackoverflow.com/users/5835002/sendethtothisaddress"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562788952, "creation_date": 1562781658, "last_edit_date": 1562787555, "question_id": 56976266, "link": "https://stackoverflow.com/questions/56976266/excel-user-form-keeps-resetting-control-tip-text", "title": "Excel user form keeps resetting control tip text", "body": "<p>I have a user form in Excel and all of the text boxes have control tip text. Since I have a lot of text boxes and control tip texts that I am reusing in many Excel workbooks, I found it easier to edit the text in a settings sheet then use a macro to assign the text from the sheet to the controls on my form. This gives me the benefit of using find &amp; replace and it's easier to edit text in a sheet compared to using the properties menu. The macro assigns the control tip text like this:</p>\n\n<pre><code>With formSettings\n    .textBox1.ControlTipText = Sheets(\"Settings\").Cells(4, 12).Text\nEnd With\n</code></pre>\n\n<p>But the behavior is bizarre. When I run the macro then open the form from the interface I see the new control tip text assigned to the controls. But if I close the form and reopen it, it resets back to the previous control tip text. Any idea why this occurs? I have tried saving before opening the form as well as saving, closing the workbook, then reopening, but I can't seem to figure out why it assigns the control tip text then reverts.</p>\n\n<p>I know that I can force new text at run time by assigning it in the UserForm_Initialize sub, but I'd prefer not to since that would add a layer of inefficiency.</p>\n"}, {"tags": ["excel", "vba", "ms-access"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 2, "creation_date": 1562781143, "post_id": 56975930, "comment_id": 100488479, "body": "<code>OpenDatabase</code> should be period qualified with a <a href=\"https://docs.microsoft.com/en-us/office/client-developer/access/desktop-database-reference/workspace-opendatabase-method-dao\" rel=\"nofollow noreferrer\">Workspace</a> object. Where are your <code>Dim</code> statements?"}], "answers": [{"comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1562784607, "post_id": 56976442, "comment_id": 100490025, "body": "While this is the ADO method, the DAO should still be able to work."}], "tags": [], "owner": {"reputation": 504, "user_id": 1560582, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e2f2053d3cf39be2d61c25c0a3f93f00?s=128&d=identicon&r=PG", "display_name": "kamelkid2", "link": "https://stackoverflow.com/users/1560582/kamelkid2"}, "is_accepted": false, "score": 0, "last_activity_date": 1562782412, "creation_date": 1562782412, "answer_id": 56976442, "question_id": 56975930, "link": "https://stackoverflow.com/questions/56975930/updating-mdb-records-with-excel-16-activex-component-cant-create-object/56976442#56976442", "title": "Updating MDB records with Excel 16 - ActiveX component can&#39;t create object", "body": "<pre><code>Sub UpdateAccess()\n\n    Dim oConn As Object\n    Dim rs As Object\n    Dim sConn As String\n    Dim s As String\n\n    MDBPath = Sheets(\"Setup\").Range(\"E19\").Value\n    TabName = Sheets(\"Setup\").Range(\"E20\").Value\n\n    s = MDBPath\n    sConn = \"Provider=Microsoft.ACE.OLEDB.12.0;Data Source=\" &amp; s 'Access 2010\n\n    Set oConn = CreateObject(\"ADODB.Connection\")\n    oConn.Open sConn\n\n    Set rs = CreateObject(\"ADODB.RecordSet\")\n    rs.Open TabName, oConn, 1, 3, &amp;H2\n\n    With Sheets(\"Batches\")\n        lRow = .Cells(Rows.Count, 1).End(xlUp).Row\n    End With\n\n    BatchNameColumn = Sheets(\"references\").Range(\"G22\").Value\n    BatchDEColumn = Sheets(\"references\").Range(\"G28\").Value\n\n    i = 1\n\n    Do While i &lt; lRow\n\n        i = i + 1\n\n        BatchName = Sheets(\"BatchesForLabels\").Range(BatchNameColumn &amp; i).Value\n\n        With rs\n            rs.MoveFirst\n            While Not rs.EOF\n                If rs.Fields(\"Name\").Value = BatchName Then\n                    'rs.Edit\n                    rs.Fields(\"ActualDE\").Value = Round(Sheets(\"BatchesForLabels\").Range(BatchDEColumn &amp; i).Value, 2)\n                    rs.Update\n                    rs.MoveNext\n                Else:\n                    rs.MoveNext\n                End If\n            Wend\n        End With\n\n    Loop\n\n    rs.Close\n    Set rs = Nothing\n    oConn.Close\n    Set oConn = Nothing\nEnd Sub\n</code></pre>\n\n<p>added dim statements and changed to oledb 12.0. this code works for my purposes. had to take out rs.edit for anyone referencing this in the future</p>\n"}], "owner": {"reputation": 504, "user_id": 1560582, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/e2f2053d3cf39be2d61c25c0a3f93f00?s=128&d=identicon&r=PG", "display_name": "kamelkid2", "link": "https://stackoverflow.com/users/1560582/kamelkid2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562782412, "creation_date": 1562780240, "last_edit_date": 1562780866, "question_id": 56975930, "link": "https://stackoverflow.com/questions/56975930/updating-mdb-records-with-excel-16-activex-component-cant-create-object", "title": "Updating MDB records with Excel 16 - ActiveX component can&#39;t create object", "body": "<p>I have an Excel VBA macro that would update an MDB record's specific field value in 2010.</p>\n\n<p>I just got updated to Excel16 and I am getting an ActiveX component can't create object error with the once functional code.</p>\n\n<p>it errors on <code>Set Db = OpenDatabase(MDBPath)</code></p>\n\n<p>here is the full code:</p>\n\n<pre><code>Sub UpdateAccess()\n\nMDBPath = Sheets(\"Setup\").Range(\"E19\").Value\nTabName = Sheets(\"Setup\").Range(\"E20\").Value\n\nSet Db = OpenDatabase(MDBPath)\nSet rs = Db.OpenRecordset(TabName, dbOpenTable)\n\nWith Sheets(\"Batches\")\n    lRow = .Cells(Rows.Count, 1).End(xlUp).Row\nEnd With\n\nBatchNameColumn = Sheets(\"references\").Range(\"G22\").Value\nBatchDEColumn = Sheets(\"references\").Range(\"G28\").Value\n\ni = 1\n\nDo While i &lt; lRow\n\n    i = i + 1\n\n    BatchName = Sheets(\"BatchesForLabels\").Range(BatchNameColumn &amp; i).Value\n\n    With rs\n        rs.MoveFirst\n        While Not rs.EOF\n            If rs.Fields(\"Name\").Value = BatchName Then\n                rs.Edit\n                rs.Fields(\"ActualDE\").Value = Round(Sheets(\"BatchesForLabels\").Range(BatchDEColumn &amp; i).Value, 2)\n                rs.Update\n                rs.MoveNext\n            Else:\n                rs.MoveNext\n            End If\n        Wend\n    End With\n\nLoop\n\nrs.Close\nSet rs = Nothing\nDb.Close\nSet Db = Nothing\n</code></pre>\n\n<p>here are the references I have enabled</p>\n\n<pre><code>Visual Basic For Applications\nMicrosoft Excel 16.0 Object Library\nOLE Automation\nMicrosoft Office 16.0 Object Library\nMicrosoft ADO Ext. 2.8 for DDL and Security\nMicrosoft ActiveX Data Objects 2.8 Library\nMicrosoft Windows Common Controls - 26.0 (sp6)\nMicrosoft Forms 2.0 Object Library\nMicrosoft DAO 3.6 Object Library\n</code></pre>\n\n<p>Is this a reference library issue or is there a different strategy I need to approach updating MDB records in this new environment?</p>\n\n<p>It is a workplace application and I can't exactly control various installation pieces at this time</p>\n"}, {"tags": ["vba", "function"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1562780913, "post_id": 56975900, "comment_id": 100488402, "body": "Not my downvote, but can you explain a bit more how <code>Opt</code> is related to <code>TirNoPer360</code>? I&#39;m not sure what you mean by &quot;This last step is performed by the second function (Opt) through simple try and error algo.&quot; I don&#39;t see that happening anywhere."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1562781447, "post_id": 56975900, "comment_id": 100488603, "body": "Please show how/when <code>Opt</code> is called."}, {"owner": {"reputation": 353, "user_id": 7978013, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2b50a2eefa63abde5c518cd920d33d71?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/7978013/newbie"}, "reply_to_user": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1562783694, "post_id": 56975900, "comment_id": 100489616, "body": "@ja72 that&#39;s part of the question (how can I show the result of the Opt?)."}, {"owner": {"reputation": 353, "user_id": 7978013, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2b50a2eefa63abde5c518cd920d33d71?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/7978013/newbie"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562784068, "post_id": 56975900, "comment_id": 100489795, "body": "@BigBen Sure. This a finding root algorithm. Function TirNoPer360 is what I try to optimize using Opt. The last step is the optimization per se (using a try-error) which is doing in Opt. I may be wrong of course since is what I am trying to verify."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 2, "creation_date": 1562784462, "post_id": 56975900, "comment_id": 100489973, "body": "<code>TirNoPer360 = Opt(sum)</code>? Your question is extremely unclear / hard to understand. I second @BigBen in requesting that you <a href=\"https://stackoverflow.com/posts/56975900/edit\">edit</a> your post to clarify how <code>Opt</code> relates to the other function, since right now it reads essentially like &quot;I have an apple and a banana, how do I get a banana-flavored orange by eating an apple&quot;."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 3, "creation_date": 1562785009, "post_id": 56975900, "comment_id": 100490185, "body": "In <code>TirNoPer360</code>, you <code>Dim Inicio As Date</code>, but you don&#39;t ever use it. You use <code>Initial</code>, but don&#39;t declare (<code>Dim</code>) it. You declare <code>n</code> and <code>j</code>, but don&#39;t use them. You have <code>Cash</code> as a parameter and treat it like a <code>Range</code>, but it&#39;s really a <code>Variant</code> - you should specify <code>As Range</code> in the parameter list if that&#39;s what you mean (<code>(Cash, Dates As Range)</code> declares a <code>Variant</code> and a <code>Range</code>, not 2 <code>Range</code>s)."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1562785082, "post_id": 56975900, "comment_id": 100490230, "body": "In <code>opt</code>, I&#39;m not sure what <code>funcion &lt; -tolerance</code> is supposed to do. Is that supposed to be <code>tolerance * -1</code> (i.e. the negative of <code>tolerance</code>) or something totally different or is it a typo?"}, {"owner": {"reputation": 353, "user_id": 7978013, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2b50a2eefa63abde5c518cd920d33d71?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/7978013/newbie"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1562788978, "post_id": 56975900, "comment_id": 100491803, "body": "@FreeMan you are right. it is the negative of &quot;tolerance&quot;"}, {"owner": {"reputation": 353, "user_id": 7978013, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2b50a2eefa63abde5c518cd920d33d71?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/7978013/newbie"}, "edited": false, "score": 0, "creation_date": 1562791118, "post_id": 56975900, "comment_id": 100492606, "body": "I rewrite my question leaving the main idea."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1562848952, "post_id": 56975900, "comment_id": 100513520, "body": "You <i>cannot</i> pass a function as a parameter to another function in VBA."}, {"owner": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1562849269, "post_id": 56975900, "comment_id": 100513723, "body": "Well, OK, you cannot <i>easily</i> or <i>natively</i> pass a function as a parameter to another function without a lot of hacking and low level witchcraftery."}, {"owner": {"reputation": 353, "user_id": 7978013, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2b50a2eefa63abde5c518cd920d33d71?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/7978013/newbie"}, "reply_to_user": {"reputation": 5531, "user_id": 2344413, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/MnkGM.jpg?s=128&g=1", "display_name": "FreeMan", "link": "https://stackoverflow.com/users/2344413/freeman"}, "edited": false, "score": 0, "creation_date": 1562853628, "post_id": 56975900, "comment_id": 100516544, "body": "I think I found a solution to my problem. I set up FunctOne with var1 and var2. Then I set up FunctTwo with two new variables (that match those in FunctOne). And the magic was done. I think is the same @FreeMan wrote."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1562866143, "post_id": 56975900, "comment_id": 100523238, "body": "Use does the user use <code>FunctOne</code>? Do they enter it in a cell, or do they call it from another subroutine/function?"}], "answers": [{"tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 0, "last_activity_date": 1562866387, "creation_date": 1562866387, "answer_id": 56994587, "question_id": 56975900, "link": "https://stackoverflow.com/questions/56975900/vba-calling-a-function-not-directly-using/56994587#56994587", "title": "VBA calling a function not directly using", "body": "<p>If you want to establish a sequence of computation that has to be done in a specific order then you need to create a subroutine that drives the computations.</p>\n\n<pre><code>Public Sub MyCalculations()\n    Dim var1 as Range, var2 as Range\n\n    var1 = ...\n    var2 = ...\n    Dim f1 as Variant\n    f1 = FunctOne(var1, var2)\n\n    Dim f2 as Variant\n    f2 = FunctTwo(f1)\n\nEnd Sub\n</code></pre>\n\n<p><strong>The above assumes that <code>FunctOne</code> and <code>FunctTwo</code> do not change the worksheet (not side effects assumption).</strong> It is best practice to declare the arguments <code>ByVal</code> so that the functions cannot change any of the local variables used above.</p>\n"}], "owner": {"reputation": 353, "user_id": 7978013, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2b50a2eefa63abde5c518cd920d33d71?s=128&d=identicon&r=PG", "display_name": "Newbie", "link": "https://stackoverflow.com/users/7978013/newbie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1562866387, "creation_date": 1562780126, "last_edit_date": 1562791013, "question_id": 56975900, "link": "https://stackoverflow.com/questions/56975900/vba-calling-a-function-not-directly-using", "title": "VBA calling a function not directly using", "body": "<p>I have two functions. Users call first function (<code>FunctOne</code>), in Excel, and select a range of inputs an perform something. A second function (<code>FunctTwo</code>) uses this partial output and it performs something more. I want to show <code>FunctTwo</code> output.</p>\n\n<p>My question is: how can I show the result of the <code>FunctTwo</code>? Do I need to create a third function? if yes, How does it look like?</p>\n\n<p>Thanks a lot,</p>\n\n<pre><code>Function FunctOne(var1, var2 As Range)\n\nDo something 'perform some calculations using inputs\n\nEnd Function\n</code></pre>\n\n<p>===========</p>\n\n<pre><code>Function FunctTwo(FunctOne As Variant) As Variant\n\nDo something 'use the output of FunctOne and do something\n\nEnd Function\n</code></pre>\n\n<p>PD: I tried to do all in just one function, but the loop doesn't work as I expected. So, maybe if I change my approach using two functions it might work. Any help would be appreciated.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 1, "creation_date": 1562779844, "post_id": 56975799, "comment_id": 100487947, "body": "Where do you <code>Set PlanNameRange</code>? Or is that just a typo that you have <code>Set aRange</code> right before using <code>PlanNameRange</code>?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1562783529, "post_id": 56975799, "comment_id": 100489559, "body": "I&#39;m surprised it&#39;s letting you copy to another worksheet.  It looks like you&#39;ve got <code>Sheets(1)</code> yet you are copying to <code>Sheets(2)</code>.  What version of Excel are you using?"}, {"owner": {"reputation": 3, "user_id": 11671997, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214233628256638/picture?type=large", "display_name": "Anton Paroski", "link": "https://stackoverflow.com/users/11671997/anton-paroski"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562783684, "post_id": 56975799, "comment_id": 100489610, "body": "@BigBen   You are correct, It was a typo from copying the script over and then changing variable names. I&#39;ve fixed the typos in the post."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1562783829, "post_id": 56975799, "comment_id": 100489681, "body": "Perhaps there is some subtle difference in the data that is causing it to return more uniques.  Non-printing character; trailing space.  I suggest you look carefully at the apparent discrepancy items."}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1562783888, "post_id": 56975799, "comment_id": 100489704, "body": "@Cyril Shouldn&#39;t the <code>Unique</code> parameter of the method accomplish that?"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1562784127, "post_id": 56975799, "comment_id": 100489824, "body": "@RonRosenfeld It should accomplish that.  My suggestion would be preference, as maintaining and checking keys in the immediate window is a bit easier (imo).  If the issue is with an incorrect number of unique records, or possibly not using the correct range (<code>Range(&quot;D1&quot;).End(xlDown)</code> stops on blank), it may be a more ideal approach to use the specific values between <code>cells(1,4)</code> and <code>cells(rows.count,4).end(xlup).row</code>.  Similarly, it might be as simple as using <code>cells(1,4)</code> and <code>cells(rows.count,4).end(xlup).row</code> over the xldown in the related line."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11671997, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214233628256638/picture?type=large", "display_name": "Anton Paroski", "link": "https://stackoverflow.com/users/11671997/anton-paroski"}, "edited": false, "score": 0, "creation_date": 1565023536, "post_id": 56976921, "comment_id": 101212173, "body": "Thanks, this will be useful for parsing past any blanks in a column.   I&#39;ve updated my script accordingly.   Unfortunately, there were no blanks in the data that I was using. So I still don&#39;t know what was causing the error."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 3, "user_id": 11671997, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214233628256638/picture?type=large", "display_name": "Anton Paroski", "link": "https://stackoverflow.com/users/11671997/anton-paroski"}, "edited": false, "score": 0, "creation_date": 1565024524, "post_id": 56976921, "comment_id": 101212606, "body": "@AntonParoski Please also note the final statement in the answer about qualifying <i>all</i> ranges."}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1562785005, "last_edit_date": 1562785005, "creation_date": 1562784543, "answer_id": 56976921, "question_id": 56975799, "link": "https://stackoverflow.com/questions/56975799/range-advancedfilter-yielding-inconsistent-results/56976921#56976921", "title": "Range.AdvancedFilter yielding inconsistent results", "body": "<p>You have used <code>.End(xlDown)</code>, though we don't know if there is a blank space in your data.</p>\n\n<p>Have you tried changed </p>\n\n<pre><code>Sheets(1).Range(Range(\"D1\"), Range(\"D1\").End(xlDown)).AdvancedFilter\n</code></pre>\n\n<p>to read:</p>\n\n<pre><code>With Sheets(1)\n    lr = .Cells(.Rows.Count, 4).End(xlUp).Row\n    .Range(.Range(\"D1\"), .Range(\"D\" &amp; lr)).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=Sheets(2).Range(\"A1\"), Unique:=True\nEnd With\n</code></pre>\n\n<p>Notice that I also added the Sheet references to the other range, since that would appropriately qualify the range (the first sheets(1) IS NOT carried through or assumed by VBA).</p>\n"}], "owner": {"reputation": 3, "user_id": 11671997, "user_type": "registered", "profile_image": "https://graph.facebook.com/10214233628256638/picture?type=large", "display_name": "Anton Paroski", "link": "https://stackoverflow.com/users/11671997/anton-paroski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 56976921, "answer_count": 1, "score": 0, "last_activity_date": 1562790213, "creation_date": 1562779676, "last_edit_date": 1562790213, "question_id": 56975799, "link": "https://stackoverflow.com/questions/56975799/range-advancedfilter-yielding-inconsistent-results", "title": "Range.AdvancedFilter yielding inconsistent results", "body": "<p>Using VBA, I am trying to create an array of individual worksheets based on the unique values in a column of data.</p>\n\n<p>Although I am using the same data, the number of elements created will vary between 263 (incorrect) and 268 (correct). </p>\n\n<p>These unique records are pulled from a master list containing 7667 records (with duplicates). </p>\n\n<p>The issue appears to be in the Range.AdvancedFilter portion of my script. This will usually copy over the correct number of unique records, but, rarely, it will be incorrect.</p>\n\n<p>It has returned both of these results, regardless of any changes made to the script. I haven't figured out how to replicate this error.</p>\n\n<p>When the error occurs, it looks like the bottom five unique records from the master list are missing from the filtered list. This appears to be consistent between errors. </p>\n\n<pre><code>Sub Test()\n    Dim aArray() As Variant\n    Dim cell As Range\n    Dim aRange As Range\n    Dim i As Integer\n\n    Worksheets.Add After:=Sheets(1)\n    ActiveSheet.Name = \"Temporary_1\"\n    Sheets(1).Activate\n    Sheets(1).Range(Range(\"D1\"), Range(\"D1\").End(xlDown)).AdvancedFilter \n    Action:=xlFilterCopy, CopyToRange:=Sheets(2).Range(\"A1\"), Unique:=True\n    Sheets(2).Activate\n\n    Set aRange = Sheets(2).Range(Range(\"A2\"), Range(\"A2\").End(xlDown))\n    Debug.Print aRange.Count\n    ReDim aArray(aRange.Count - 1)\n    For Each cell In aRange.Cells\n        aArray(x) = cell.Value\n        x = x + 1\n    Next cell\n\n    i = 0\n    For x = LBound(aArray) To UBound(aArray)\n        i = i + 1\n    Next x\n    Debug.Print i\n\nEnd Sub\n</code></pre>\n\n<p>Is there a more reliable way to create an array from the unique records within a column?</p>\n"}, {"tags": ["excel", "vba", "autofill"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 2, "creation_date": 1562779544, "post_id": 56975715, "comment_id": 100487830, "body": "This looks suspect: <code>tCell = tCell.Formula = ...</code>, but it&#39;s otherwise not clear what you mean by &quot;it&#39;s not working&quot;. Can you elaborate? Please revise the question with more detail."}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562779594, "post_id": 56975715, "comment_id": 100487856, "body": "Also if you&#39;re looking to use <code>Worksheet_Change</code>, don&#39;t rename it to <code>Autofill_scan_name</code>."}, {"owner": {"reputation": 15, "user_id": 11728021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7685beace5795142fb95e6eed98a06a4?s=128&d=identicon&r=PG&f=1", "display_name": "Arianne_2130p", "link": "https://stackoverflow.com/users/11728021/arianne-2130p"}, "edited": false, "score": 0, "creation_date": 1562779970, "post_id": 56975715, "comment_id": 100488007, "body": "Hi yes I was trying to do a worksheet_change , I will revise and elaborate on the question"}, {"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1562781338, "post_id": 56975715, "comment_id": 100488557, "body": "Are you sure you want to use this formula in <i>every single cell</i> in a column?  Also, I don&#39;t believe you can do <code>tCell = tCell.Formula = ...</code>  That would just be <code>tCell.Formula = ...</code>  Also, is <code>ThisWorkbook.Sheets(&quot;BOD_Barcode&quot;)</code> the sheet that this <code>Worksheet_Change()</code> event is on?  If not, you need to clarify because <code>tCell</code> will be whatever the active sheet is..."}, {"owner": {"reputation": 15, "user_id": 11728021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7685beace5795142fb95e6eed98a06a4?s=128&d=identicon&r=PG&f=1", "display_name": "Arianne_2130p", "link": "https://stackoverflow.com/users/11728021/arianne-2130p"}, "reply_to_user": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1562781464, "post_id": 56975715, "comment_id": 100488611, "body": "@BruceWayne yes I would like to put this formula in every cell within column C (minus the header), yes I believe that is the sheet that is associated with worksheet _change(), but just in case how do i know? New to VBA"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562781491, "post_id": 56975715, "comment_id": 100488622, "body": "Is using a table - formatted with Ctrl+T - not an option? That would replicate the formula downwards, if I understand your requirements."}, {"owner": {"reputation": 15, "user_id": 11728021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7685beace5795142fb95e6eed98a06a4?s=128&d=identicon&r=PG&f=1", "display_name": "Arianne_2130p", "link": "https://stackoverflow.com/users/11728021/arianne-2130p"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562781760, "post_id": 56975715, "comment_id": 100488720, "body": "@BigBen I do not think CTRL - T would work .... essentially what I am looking is I want it just like my timestamp code where as i enter the data it adds a timestamp , but now I also want as the time stamp to execute the formula"}, {"owner": {"reputation": 15, "user_id": 11728021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7685beace5795142fb95e6eed98a06a4?s=128&d=identicon&r=PG&f=1", "display_name": "Arianne_2130p", "link": "https://stackoverflow.com/users/11728021/arianne-2130p"}, "edited": false, "score": 0, "creation_date": 1562831742, "post_id": 56975715, "comment_id": 100503553, "body": "Figured out instead of using a VBA instead added formula straight to the cell and enable iteration from the options setting , used: =IF($A2&lt;&gt;&quot;&quot;,IF($C2=&quot;&quot;,IF(ISNUMBER(SEARCH(&quot;$&quot;,$A2)),&quot;Scanner 2&quot;, IF(ISNUMBER(SEARCH(&quot;#&quot;,$A2)),&quot;Scanner 1&quot;,&quot;Error&quot;)),$C2),&quot;&quot;)"}], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 11728021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7685beace5795142fb95e6eed98a06a4?s=128&d=identicon&r=PG&f=1", "display_name": "Arianne_2130p", "link": "https://stackoverflow.com/users/11728021/arianne-2130p"}, "is_accepted": false, "score": 1, "last_activity_date": 1562831986, "creation_date": 1562831986, "answer_id": 56984320, "question_id": 56975715, "link": "https://stackoverflow.com/questions/56975715/automatically-fill-and-execute-formula-to-cell-c2-and-so-forth-as-i-enter-data/56984320#56984320", "title": "Automatically fill and execute formula to &quot;Cell C2 and so forth&quot; as I enter data in &quot;Cell A2 and so forth&quot;", "body": "<p>Instead of using a VBA I used a formula straight to the cell and enable iteration from the options setting. Therefore as you enter data it will check if there is data if not- it will run in my case the formula but you can use it for timestamp or any function. </p>\n\n<pre><code>=IF($A2&lt;&gt;\"\",IF($C2=\"\",IF(ISNUMBER(SEARCH(\"$\",$A2)),\"Scanner 2\", IF(ISNUMBER(SEARCH(\"#\",$A2)),\"Scanner 1\",\"Error\")),$C2),\"\")\n</code></pre>\n"}], "owner": {"reputation": 15, "user_id": 11728021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7685beace5795142fb95e6eed98a06a4?s=128&d=identicon&r=PG&f=1", "display_name": "Arianne_2130p", "link": "https://stackoverflow.com/users/11728021/arianne-2130p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562831986, "creation_date": 1562779272, "last_edit_date": 1562783242, "question_id": 56975715, "link": "https://stackoverflow.com/questions/56975715/automatically-fill-and-execute-formula-to-cell-c2-and-so-forth-as-i-enter-data", "title": "Automatically fill and execute formula to &quot;Cell C2 and so forth&quot; as I enter data in &quot;Cell A2 and so forth&quot;", "body": "<p>Would like to automatically fill Cell (C:C) minus the heading, as I enter data in to Cell (A:A) minus the heading, using VBA. For the formula that I want to automatically fill into Cell C:C is a logic true/false, but instead replaced it with Scanner 1 and 2. </p>\n\n<pre><code>=IF(ISNUMBER(SEARCH(\"$\",$A2)),\"Scanner 2\",IF(ISNUMBER(SEARCH(\"#\",$A2)),\"Scanner 1\",\"Error\"))\n</code></pre>\n\n<p>Below is the VBA code I attempted, could it might be wrong since I am new to VBA: (maybe use a function instead of private sub?)  </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim rINT As Range\nDim rCell As Range\nDim tCell As Range\n\nSet rINT = Intersect(Target, Range(\"A:A\"))\nIf Not rINT Is Nothing Then\n    For Each rCell In rINT\n        Set tCell = rCell.Offset(0, 2)\n        If IsEmpty(tCell) Then\n            With ThisWorkbook.Sheets(\"BOD_Barcode\")\n            tCell = tCell.Formula = \"=IF(ISNUMBER(SEARCH(\"\"$\"\",$A2)),\"\"Scanner 2\"\",IF(ISNUMBER(SEARCH(\"\"#\"\",$A2)),\"\"Scanner 1\"\",\"\"Error\"\"))\"\n            End With\n        End If\n    Next\nEnd If\nEnd Sub \n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1562824530, "post_id": 56975714, "comment_id": 100500187, "body": "I recommend always to activate <code>Option Explicit</code>: In the VBA editor go to <i>Tools</i> \u203a <i>Options</i> \u203a <i><a href=\"https://www.excel-easy.com/vba/examples/option-explicit.html\" rel=\"nofollow noreferrer\">Require Variable Declaration</a></i>."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1562836926, "last_edit_date": 1562836926, "creation_date": 1562779266, "answer_id": 56975714, "question_id": 56975648, "link": "https://stackoverflow.com/questions/56975648/the-sum-function-in-vba-using-named-ranges-only-shows-errors/56975714#56975714", "title": "The SUM function in VBA using NAMED RANGES only shows errors", "body": "<p>(1) Get in the habit of declaring your variables (as per PEH's suggestion, use Option Explicit: in the VBA editor go to Tools \u203a Options \u203a Require Variable Declaration)</p>\n\n<p>(2) You need Set when assigning object variables such as ranges</p>\n\n<p>(3) <code>myplace</code> is already a range so no need for a 'wrapper'</p>\n\n<pre><code>Sub optelsom()\n\nDim myplace as range, myrange as range\n\nSet myplace = Range(\"plaats\") \nSet myrange = Range(\"deelsom\")\n\nmyplace.Value = Application.WorksheetFunction.Sum(myrange)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 11766237, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5c2261860153d9e556b8c667d0dc95f?s=128&d=identicon&r=PG&f=1", "display_name": "Bob Vekemans", "link": "https://stackoverflow.com/users/11766237/bob-vekemans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562836926, "creation_date": 1562778970, "last_edit_date": 1562824509, "question_id": 56975648, "link": "https://stackoverflow.com/questions/56975648/the-sum-function-in-vba-using-named-ranges-only-shows-errors", "title": "The SUM function in VBA using NAMED RANGES only shows errors", "body": "<p>I defined two named ranges; one (myplace) for the location to write the result to and one (myrange) for the range that needs to be summed.\nCompiler returns an error</p>\n\n<p>Tried the formula method for sum, but this returns \"#NAAM\" error</p>\n\n<p>This is the simple code I used:</p>\n\n<pre><code>Sub optelsom()\n\nmyplace = Range(\"plaats\") \nmyrange = Range(\"deelsom\")\n\nRange(myplace).Value = Application.WorksheetFunction.Sum(myrange)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 6, "creation_date": 1562778804, "post_id": 56975514, "comment_id": 100487462, "body": "If your code is working and you just want efficiency, it&#39;s better suit for <a href=\"https://codereview.stackexchange.com/\">Code Review</a>."}, {"owner": {"reputation": 7441, "user_id": 1575353, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rvz3i.png?s=128&g=1", "display_name": "S\u1d00\u1d0d On\u1d07\u1d0c\u1d00", "link": "https://stackoverflow.com/users/1575353/s%e1%b4%80%e1%b4%8d-on%e1%b4%87%e1%b4%8c%e1%b4%80"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1562783088, "post_id": 56975514, "comment_id": 100489374, "body": "@Cyril Please see <a href=\"https://meta.stackoverflow.com/q/266749/1575353\"><i>Migration of code questions from Stack Overflow to Code Review</i></a> and <a href=\"https://codereview.meta.stackexchange.com/a/5778/120114\">this answer to <i>A guide to Code Review for Stack Overflow users</i></a>"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 7441, "user_id": 1575353, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/rvz3i.png?s=128&g=1", "display_name": "S\u1d00\u1d0d On\u1d07\u1d0c\u1d00", "link": "https://stackoverflow.com/users/1575353/s%e1%b4%80%e1%b4%8d-on%e1%b4%87%e1%b4%8c%e1%b4%80"}, "edited": false, "score": 0, "creation_date": 1562783331, "post_id": 56975514, "comment_id": 100489483, "body": "@S\u1d00\u1d0dOn\u1d07\u1d0c\u1d00 thanks; i used the wrong close reason on that one.  Removed above question.  Given the criteria in the latter link, I would stick with this being more appropriate in CR than SO."}, {"owner": {"reputation": 1, "user_id": 11765720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb1b341ea2f30fafbea47584b8b4c91c?s=128&d=identicon&r=PG&f=1", "display_name": "lifeuhfindsaway", "link": "https://stackoverflow.com/users/11765720/lifeuhfindsaway"}, "edited": false, "score": 0, "creation_date": 1562786511, "post_id": 56975514, "comment_id": 100490806, "body": "Thank you dwirony for the direction. My mistake!"}], "owner": {"reputation": 1, "user_id": 11765720, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb1b341ea2f30fafbea47584b8b4c91c?s=128&d=identicon&r=PG&f=1", "display_name": "lifeuhfindsaway", "link": "https://stackoverflow.com/users/11765720/lifeuhfindsaway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1563317642, "creation_date": 1562778401, "last_edit_date": 1563317642, "question_id": 56975514, "link": "https://stackoverflow.com/questions/56975514/how-to-store-ranges-in-array-collection-or-dictionary-based-on-criteria", "title": "How to store ranges in array, collection, or dictionary based on criteria?", "body": "<p>I am attempting to parse through a contiguous range of data (orng) and create subranges from orng that contain the same string value in the 6th column of orng. Each subrange has 1-15 rows and 38 columns. As far as I know, I can't create a new range object for each subrange since the number of subranges is unknown. I've created an array that contains the data for the subranges (aData). I have gotten it to work with the code below, but I feel like there is a much cleaner way of doing it that I can't figure out. I've also tried using a dictionary with no success. I will eventually have to call upon all the data for calculations and using multiple nested for loops to access each element seems convoluted.</p>\n\n<p>I am using Excel Professional Plus 2016 (not sure if that matters).</p>\n\n<p>Using an array is the only way I could manage to get the end result I'm looking for, which is fine. I would prefer that the array was dynamic, but whenever I attempted the ReDim Preserve method the values would not be saved to the array. The size of the array would be perfect, but every element was \"Empty\". According to <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/can-t-assign-to-an-array\" rel=\"nofollow noreferrer\">Microsoft</a> \"each element of an array must have its value assigned individually\" so I guess I can't assign range values to an array in chunks. After I found that webpage I implemented an array with a predetermined structure and the nested for loops.</p>\n\n<p>Ideally, I could separate orng into different Areas, but since it is contiguous I am unable to do so. What I'd like to know is 1) is there a better way to do what I am trying to do? (Easier to read, faster, less code, etc. and 2) if there is not a better way, can I get some advice on how to make this code cleaner (dynamic range, less loops, better structure)?</p>\n\n<pre><code>Private Sub rangetest()\n\nDim twb As Workbook: Set twb = ThisWorkbook\nDim cws As Worksheet: Set cws = twb.Sheets(\"Cleaned_2019+\")\nDim orng As Range\nDim datelot As String, datelotcomp As String\nDim c As Long, i As Long, j As Long, k As Long, numrows As Long, lastrow \n    As Long, numlots As Long, _\n    curRow As Long, lotRows As Long, startRow As Long, layerRows As Long, \n    aRow As Long\nDim aLot() As Variant, aData(9, 49, 37) As Variant\nDim Z As Boolean\n\nSet orng = cws.Range(\"A973:AL1014\")   'Set initial range to work with.\nnumrows = orng.Rows.Count             'Number of rows in orng.\ncurRow = 1                            'Current row in orng.\nstartRow = 1                          'Starting row in orng for next \nlayer (changes when lot changes).\ni = 0                                 'Layer of array (for aLot and aData arrays).\nj = 0                                 'Row in orng where values for previous layer ended.\nZ = False\nDo Until Z = True\n    datelot = Left(orng.Cells(curRow, 6).Value, 10)                            'Lot that we want the data for. Corresponds to a layer in the aData array.\n    datelotcomp = Left(orng.Cells(curRow + 1, 6).Value, 10)                    'Lot of the next row in data sheet.\n    If datelot &lt;&gt; datelotcomp Then                                             'If datelotcomp &lt;&gt; to datelot then we want a new layer for array.\n        layerRows = curRow - j                                                 'Number of rows for a particular layer\n        ReDim Preserve aLot(i)                                                 'Array of lot names\n        aLot(i) = datelot                                                      'Assign lot name to aLot array\n        For aRow = 1 To layerRows                                              'Row index in array\n            For lotRows = startRow To curRow                                   'Loops through orng rows and sets those values in array\n                For c = 1 To 38                                                'Loops through columns. There are always 38 columns\n                    aData(i, aRow - 1, c - 1) = orng.Cells(lotRows, c).Value   'Add values to each index in array\n                Next c\n            Next lotRows\n        Next aRow\n        j = curRow\n        i = i + 1\n        startRow = curRow + 1\n    End If\n    If curRow = numrows Then                                                   'End loop at end of orng\n        Z = True\n    End If\n    curRow = curRow + 1\nLoop\nnumlots = i\n\nEnd Sub\n</code></pre>\n\n<p>The result I get is an array with the structure aData(9, 49, 37) that contains data in the first 4 layers aData(1-3, , ). This corresponds with the number of lots that are in orng so the code is working correctly. I'd just like advice on if I'm doing anything inefficiently.</p>\n\n<p>I will be checking back to answer questions or to add clarification.</p>\n\n<p>Edit 1:</p>\n\n<p>The question ended up being answered <a href=\"https://codereview.stackexchange.com/questions/223897/store-subranges-from-contiguous-range-into-array-based-on-criteria/223912#223912\">here</a> (Code Review) for those interested.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1562777665, "post_id": 56975275, "comment_id": 100486937, "body": "Are you concerned about the security risks of saving your password into the workbook?"}, {"owner": {"reputation": 4466, "user_id": 4876561, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/LrLr2.jpg?s=128&g=1", "display_name": "wundermahn", "link": "https://stackoverflow.com/users/4876561/wundermahn"}, "reply_to_user": {"reputation": 3423, "user_id": 1738572, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0VGr.jpg?s=128&g=1", "display_name": "Greg Viers", "link": "https://stackoverflow.com/users/1738572/greg-viers"}, "edited": false, "score": 0, "creation_date": 1562777689, "post_id": 56975275, "comment_id": 100486946, "body": "Not at all. This is completely maintained on my desktop, so no biggie. Worst case, I could make a userform to capture that."}], "answers": [{"comments": [{"owner": {"reputation": 4466, "user_id": 4876561, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/LrLr2.jpg?s=128&g=1", "display_name": "wundermahn", "link": "https://stackoverflow.com/users/4876561/wundermahn"}, "edited": false, "score": 0, "creation_date": 1562778044, "post_id": 56975400, "comment_id": 100487105, "body": "Even if I save the password, and then click &quot;Refresh All&quot;, do all ten queries execute simultaneously? Or do they still occur sequentially?"}, {"owner": {"reputation": 423, "user_id": 5261640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6ba67f8040ec478508f685a6784aec2?s=128&d=identicon&r=PG&f=1", "display_name": "GenericDisplayName", "link": "https://stackoverflow.com/users/5261640/genericdisplayname"}, "reply_to_user": {"reputation": 4466, "user_id": 4876561, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/LrLr2.jpg?s=128&g=1", "display_name": "wundermahn", "link": "https://stackoverflow.com/users/4876561/wundermahn"}, "edited": false, "score": 0, "creation_date": 1562778467, "post_id": 56975400, "comment_id": 100487294, "body": "They will all occur sequentially but you will not be required to enter your password for reach individual one if the password is saved for the specific connection, it will all happen automatically. I have done this using both VBA and save passwords, neither way was I able to have multiple data sources refresh in parallel if that is what you are referring to."}], "tags": [], "owner": {"reputation": 423, "user_id": 5261640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6ba67f8040ec478508f685a6784aec2?s=128&d=identicon&r=PG&f=1", "display_name": "GenericDisplayName", "link": "https://stackoverflow.com/users/5261640/genericdisplayname"}, "is_accepted": true, "score": 1, "last_activity_date": 1562777890, "creation_date": 1562777890, "answer_id": 56975400, "question_id": 56975275, "link": "https://stackoverflow.com/questions/56975275/refreshing-multiple-data-connections-simultaneously-in-excel/56975400#56975400", "title": "Refreshing multiple data connections simultaneously in Excel", "body": "<p>You can store the password in the data connection or do this inside VBA in the workbook. Please see this similar question <a href=\"https://stackoverflow.com/questions/47271322/refresh-a-connection-in-excel-to-sql-server-with-password-using-vba\">stackoverflow question</a></p>\n"}], "owner": {"reputation": 4466, "user_id": 4876561, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/LrLr2.jpg?s=128&g=1", "display_name": "wundermahn", "link": "https://stackoverflow.com/users/4876561/wundermahn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 462, "favorite_count": 0, "accepted_answer_id": 56975400, "answer_count": 1, "score": 0, "last_activity_date": 1562824392, "creation_date": 1562777347, "last_edit_date": 1562824392, "question_id": 56975275, "link": "https://stackoverflow.com/questions/56975275/refreshing-multiple-data-connections-simultaneously-in-excel", "title": "Refreshing multiple data connections simultaneously in Excel", "body": "<p>I have an Excel Workbook that has 10 sheets.</p>\n\n<p>Each sheet is connected to [the same] Oracle database, and each sheet issues a different SQL query that has been pasted into the \"Definition\".</p>\n\n<p>The database requires a sign in. So when I want to refresh these 10 sheets, I hit \"Refresh All\", and the following sequence commences:</p>\n\n<ol>\n<li>Refresh All</li>\n<li>Sign into database</li>\n<li>Issues SQL query</li>\n<li>Moves to next tab</li>\n<li>Repeat</li>\n</ol>\n\n<p>The process takes nearly two hours.</p>\n\n<p>My question is: How can I enter in my credentials <em>one time</em> and have all 10 kick off simultaneously? It is an ODBC connection.</p>\n\n<p>Please let me know what other information is needed. I can use VBA if needed.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 5, "creation_date": 1562777870, "post_id": 56975269, "comment_id": 100487025, "body": "Write a loop and fill a second array."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 3, "creation_date": 1562777883, "post_id": 56975269, "comment_id": 100487032, "body": "There&#39;s nothing to gain to shrink the array. Each cell in your range (assuming they are all integers 0..1) will be stored in the array as a <code>Long</code> data type. <a href=\"https://stackoverflow.com/a/26409520/4717755\">This excellent explanation</a> describes how and why this happens. Additionally, the <a href=\"https://docs.microsoft.com/en-us/previous-versions/office/developer/office2000/aa164500(v=office.10)\" rel=\"nofollow noreferrer\">Microsoft documentation for the <code>Boolean</code> type</a> shows that it&#39;s stored as an integer anyway."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 3, "creation_date": 1562780506, "post_id": 56975269, "comment_id": 100488238, "body": "Much more valuable to <i>actually</i> shrink your array to the size that&#39;s actually needed, i.e. if the sheet has 8721 rows and you still populate an array with a million rows, <i>that</i> is where the gain is. Don&#39;t worry about data type sizes, your computer has more than enough memory to handle it."}, {"owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 1, "creation_date": 1562927626, "post_id": 56975269, "comment_id": 100543261, "body": "@PeterT:  actually as I can see in the Locals window each cell is stored in Variant/Double type   :("}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562934936, "post_id": 56975269, "comment_id": 100546904, "body": "Ultimately you are the one who can determine the value to your application on shrinking the array size. The advice given here, especially by @TimWilliams and MattieuGuindon, can guide you to shrink the array as much as you may need. In the bad old days of limited memory and baud rates (if you needed to transmit the data), I&#39;d shrink it to a bit array, so I&#39;m glad memory is much cheaper now :)"}], "owner": {"reputation": 361, "user_id": 11738627, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sVrcM144Qb8/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdf8GVfYBMmDcu1kPwkGrFSZUDOVQ/photo.jpg?sz=128", "display_name": "6diegodiego9", "link": "https://stackoverflow.com/users/11738627/6diegodiego9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1570297447, "creation_date": 1562777333, "last_edit_date": 1562788331, "question_id": 56975269, "link": "https://stackoverflow.com/questions/56975269/range-to-array-shrink-variant-array-to-boolean-array", "title": "range to array: shrink variant array to boolean array", "body": "<p>Consider this code:</p>\n\n<pre><code>Dim array As Variant\narray = Range(\"a1:a1000000\").Value2\n</code></pre>\n\n<p>Knowing that the A column only contains boolean (1 or 0) numbers, what's the most efficient way to shrink the array converting its data type to boolean?</p>\n"}, {"tags": ["excel", "vba", "if-statement", "userform"], "comments": [{"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 2, "creation_date": 1562777259, "post_id": 56975203, "comment_id": 100486757, "body": "Unfortunately, there is no real way to prevent a userform from being closed. Password or not, all a user has to do is press Ctrl + Pause/Break and the code breaks, with the option to debug or end."}, {"owner": {"reputation": 3, "user_id": 11600870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16378c448ae458688cf23e71e017745c?s=128&d=identicon&r=PG&f=1", "display_name": "rnorkett", "link": "https://stackoverflow.com/users/11600870/rnorkett"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1562778459, "post_id": 56975203, "comment_id": 100487290, "body": "@K.D\u1d00\u1d20\u026as Is there a way to make the Userform pop back up (initialized) in this If statement though? Just trying to make it as &quot;difficult&quot; as possible for the average Excel user to close the form."}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1562778545, "post_id": 56975203, "comment_id": 100487335, "body": "You would need an <code>Exit Sub</code> under <code>.Show</code> to prevent the form from terminating"}, {"owner": {"reputation": 3, "user_id": 11600870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16378c448ae458688cf23e71e017745c?s=128&d=identicon&r=PG&f=1", "display_name": "rnorkett", "link": "https://stackoverflow.com/users/11600870/rnorkett"}, "reply_to_user": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1562780939, "post_id": 56975203, "comment_id": 100488416, "body": "@K.D\u1d00\u1d20\u026as When I use <code>Exit Sub</code> under <code>.Show</code> the userform shows up but is still not initialized"}, {"owner": {"reputation": 9344, "user_id": 5781745, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/lStUs.jpg?s=128&g=1", "display_name": "K.D\u1d00\u1d20\u026as", "link": "https://stackoverflow.com/users/5781745/k-d%e1%b4%80%e1%b4%a0%c9%aas"}, "edited": false, "score": 0, "creation_date": 1562781095, "post_id": 56975203, "comment_id": 100488464, "body": "What do you mean it&#39;s not initialized? It should have initialized from the first time the form was opened. The code doesn&#39;t run <code>UserForm_Initialize</code> again because you are not creating a new instance of the userform when the user fails to terminate due to an incorrect password. If you want to manually run this then type <code>UserForm_Initialize</code> inside your If statement."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11600870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16378c448ae458688cf23e71e017745c?s=128&d=identicon&r=PG&f=1", "display_name": "rnorkett", "link": "https://stackoverflow.com/users/11600870/rnorkett"}, "edited": false, "score": 0, "creation_date": 1562786851, "post_id": 56976282, "comment_id": 100490942, "body": "Thank you very much. I&#39;ll try that next"}], "tags": [], "owner": {"reputation": 1845, "user_id": 8876953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1c01635bcbcd8c68cfc963b5d497cdaa?s=128&d=identicon&r=PG&f=1", "display_name": "Josh Eller", "link": "https://stackoverflow.com/users/8876953/josh-eller"}, "is_accepted": true, "score": 1, "last_activity_date": 1562781718, "creation_date": 1562781718, "answer_id": 56976282, "question_id": 56975203, "link": "https://stackoverflow.com/questions/56975203/how-to-require-password-to-terminate-a-userform-in-vba/56976282#56976282", "title": "How to require password to terminate a userform in VBA", "body": "<p>You can use <code>UserForm_QueryClose</code> to intercept all 'close' actions on a userform. This code would go in the userform itself.</p>\n\n<pre><code>Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    Dim password As String\n\n    password = InputBox(\"Enter Password\")\n    If password = \"syntax\" Then\n        Cancel = False 'If password is correct, allow close event to proceed\n    ElseIf password &lt;&gt; \"syntax\" Then\n        Cancel = True 'If password is incorrect, cancel the close event\n    End If\nEnd Sub\n</code></pre>\n\n<p>Like K.D\u1d00\u1d20\u026as pointed out, this still won't prevent anyone from pausing the code execution and manually closing the form (Excel just doesn't provide that level of security).</p>\n"}], "owner": {"reputation": 3, "user_id": 11600870, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16378c448ae458688cf23e71e017745c?s=128&d=identicon&r=PG&f=1", "display_name": "rnorkett", "link": "https://stackoverflow.com/users/11600870/rnorkett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 56976282, "answer_count": 1, "score": 0, "last_activity_date": 1562781718, "creation_date": 1562777028, "last_edit_date": 1562777144, "question_id": 56975203, "link": "https://stackoverflow.com/questions/56975203/how-to-require-password-to-terminate-a-userform-in-vba", "title": "How to require password to terminate a userform in VBA", "body": "<p>I want to prevent the user from closing the form and editing the spreadsheet if they don't know the password. I can get the Userform to stay open but I cannot figure out how to initialize the form so all of the command buttons still function.</p>\n\n<p>I have tried using an if statement as described below. The userform stays open but isn't initialized so the user is unable to enter a password or run the userform at all.</p>\n\n<pre><code>Private Sub UserForm_Terminate()\n\n    Password = InputBox(\"Enter Password\")\n    If Password = \"syntax\" Then\n        UserForm1.Hide\n    ElseIf Password &lt;&gt; \"syntax\" Then\n        UserForm1.Show\n    End If\n    End\n\nEnd Sub\n</code></pre>\n\n<p>There aren't any error messages, but if the VBA editor window isn't open the user has to close Excel completely. Any advice on what to try next is appreciated. Thanks in advance</p>\n"}, {"tags": ["c#", "excel", "vba", "zipfile"], "comments": [{"owner": {"reputation": 51083, "user_id": 1467082, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/ZPeMR.jpg?s=128&g=1", "display_name": "David Zemens", "link": "https://stackoverflow.com/users/1467082/david-zemens"}, "edited": false, "score": 1, "creation_date": 1562777288, "post_id": 56975033, "comment_id": 100486776, "body": "In &quot;xl_rels\\workbook.xml.rels&quot; there&#39;s an entry that refers to the vbaProject.bin. There are probably other conditions. What you need to do is manually Save As XLSX format, and then diff the XLSX vs XLSM"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1562823931, "post_id": 56975033, "comment_id": 100499971, "body": "Why are you trying to manipulate the file like this? Why don&#39;t you just open the workbook in Excel and use <code>SaveAs</code> to save the workbook in the xlsx format? This could be done eg. by VBA or C# using the Excel API. That would be the proper way to go without manipulating the file. Also this way it cannot accidentally be corrupted."}, {"owner": {"reputation": 1918, "user_id": 3515969, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a9205ca177b36ad3246659a3b6c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "IngoB", "link": "https://stackoverflow.com/users/3515969/ingob"}, "edited": false, "score": 1, "creation_date": 1562831058, "post_id": 56975033, "comment_id": 100503188, "body": "P\u1d07\u029c: Because I didn&#39;t know how to programmatically answer the &quot;functionality gets removed&quot; question. Using excel.DisplayAlerts = false; did the trick, so I am going the proper way now. Thank you!"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562833968, "post_id": 56975033, "comment_id": 100504676, "body": "@IngoB Well, asking X while your actual issue is Y will (always) end up the wrong tree ;) To avoid this you might be interested in reading <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">What is the X/Y problem</a>."}, {"owner": {"reputation": 1918, "user_id": 3515969, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a9205ca177b36ad3246659a3b6c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "IngoB", "link": "https://stackoverflow.com/users/3515969/ingob"}, "edited": false, "score": 0, "creation_date": 1562846012, "post_id": 56975033, "comment_id": 100511682, "body": "P\u1d07\u029c: Right. But I found it cool to modify the Excel that way ;) and I learned a bit about what&#39;s possible."}], "owner": {"reputation": 1918, "user_id": 3515969, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/4a9205ca177b36ad3246659a3b6c0c9f?s=128&d=identicon&r=PG&f=1", "display_name": "IngoB", "link": "https://stackoverflow.com/users/3515969/ingob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 449, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562831288, "creation_date": 1562776297, "last_edit_date": 1562831288, "question_id": 56975033, "link": "https://stackoverflow.com/questions/56975033/removing-vbaproject-bin-in-xml-not-enough-to-save-as-xlsx", "title": "Removing vbaProject.bin in XML not enough to save as xlsx", "body": "<p>After exporting data into an Excel workbook with macros (xlsm), I run the macro and then remove the macro in order to be able to save the workbook as xlsx. For removing macros, I open the xlsm as zip archive (via C# ZipFile class), remove the entry \"xl/vbaProject.bin\" and remove a relation within \"xl/_rels/workbook.xml.rels\". Then I rename the file from xlsm to xlsx. That works fine so far but when I open the xlsx file in Excel, I get \"Excel cannot open the file because the file format or file extension is not valid. Verify that the file has not been corrupted and that the file extension matches the format of the file\", so there seems something to be missing in order to completely remove the vba code within the workbook. Can anyone help me here?</p>\n\n<pre><code>const string vbaProjectEntryName = \"xl/vbaProject.bin\"; // Contains the VBA code\nconst string relationsEntryName = \"xl/_rels/workbook.xml.rels\"; // Relation/Link to the vba project\n\nusing (var zip = ZipFile.Open(fileName, ZipArchiveMode.Update))\n{\n    var entry = zip.GetEntry(vbaProjectEntryName);\n    if (entry != null)\n    {\n        entry.Delete();\n\n        entry = zip.GetEntry(relationsEntryName);\n        if (entry != null)\n        {\n            var contents = string.Empty;\n            using (var streamReader = new StreamReader(entry.Open()))\n            {\n                contents = streamReader.ReadToEnd();\n            }\n\n            var relationText = \"&lt;Relationship Id=\\\"rId6\\\" Type=\\\"http://schemas.microsoft.com/office/2006/relationships/vbaProject\\\" Target=\\\"vbaProject.bin\\\"/&gt;\";\n            contents = contents.Replace(relationText, string.Empty);\n            entry.Delete();\n            entry = zip.CreateEntry(relationsEntryName);\n\n            using (var streamWriter = new StreamWriter(entry.Open()))\n            {\n                streamWriter.Write(contents);\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["vba", "powerpoint"], "answers": [{"tags": [], "owner": {"reputation": 1205, "user_id": 8578580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a063b2c15a5847791ed1e0007d04b8c0?s=128&d=identicon&r=PG&f=1", "display_name": "TechnoDabbler", "link": "https://stackoverflow.com/users/8578580/technodabbler"}, "is_accepted": true, "score": 2, "last_activity_date": 1562816518, "creation_date": 1562816518, "answer_id": 56981343, "question_id": 56974889, "link": "https://stackoverflow.com/questions/56974889/alert-if-empty-cell-found-in-power-point-tables-and-in-which-slide-using-vba/56981343#56981343", "title": "Alert if empty cell found in power point tables and in which slide using vba", "body": "<p>This code loops through each slide in the active presentation, and in each slide, check whether the each shape on the slide contains a table, and if it does, checks whether each cell is blank. Cheers.</p>\n\n<pre><code>Sub CheckTableCells()\n\n    Dim vSlide As Slide\n    Dim vShape As Shape\n    Dim vRow As Long\n    Dim vColumn As Long\n\n    For Each vSlide In Application.ActivePresentation.Slides\n        For Each vShape In vSlide.Shapes\n            If vShape.HasTable Then\n                For vRow = 1 To vShape.Table.Rows.Count\n                    For vColumn = 1 To vShape.Table.Columns.Count\n                        If vShape.Table.Cell(vRow, vColumn).Shape.TextFrame.TextRange.Text = \"\" Then\n                            MsgBox vSlide.Name &amp; \" Table: \"\"\" &amp; vShape.Name &amp; \"\"\" cell (\" &amp; vRow &amp; \",\" &amp; vColumn &amp; \") is blank.\"\n                        End If\n                    Next\n                Next\n            End If\n        Next\n    Next\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/RgfH7.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/RgfH7.jpg\" alt=\"screen\"></a></p>\n"}], "owner": {"reputation": 121, "user_id": 5011102, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f0785a504d8af6511363f553d028824b?s=128&d=identicon&r=PG&f=1", "display_name": "Darious", "link": "https://stackoverflow.com/users/5011102/darious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 56981343, "answer_count": 1, "score": 1, "last_activity_date": 1593700402, "creation_date": 1562775653, "last_edit_date": 1593700402, "question_id": 56974889, "link": "https://stackoverflow.com/questions/56974889/alert-if-empty-cell-found-in-power-point-tables-and-in-which-slide-using-vba", "title": "Alert if empty cell found in power point tables and in which slide using vba", "body": "<p>I have to find and alert that if empty cell found in each tables in power point. </p>\n\n<p>I have found the below code <a href=\"https://wordmvp.com/FAQs/MacrosVBA/TableCellEmpty.htm\" rel=\"nofollow noreferrer\">here</a>, but it does not work and it should not be find for all table, not for selected one.</p>\n\n<pre><code>    Sub CheckTableCells()\n\n    Dim oCell As Cell\n    Dim oRow As Row\n    Dim MyRange As Range\n\n    For Each oRow In Selection.Tables(1).Rows\n        For Each oCell In oRow.Cells\n            If Selection.Text = Chr(13) &amp; Chr(7) Then\n                oCell.Select\n                MsgBox oCell.RowIndex &amp; \" \" &amp; oCell.ColumnIndex &amp; \" is empty.\"\n            End If\n        Next oCell\n    Next oRow\n\n    End Sub\n</code></pre>\n\n<p>Please anyone help me for this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/j0SHu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/j0SHu.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562777947, "post_id": 56975258, "comment_id": 100487063, "body": "That could work though we have a changing task force and the array will be dynamic/vary - but can work around that - unless there&#39;s a way to automatically create an array? I&#39;ve got one set up on a separate sheet with a list of all the names, pulled from the tracker. There&#39;s over 100+ users, and it can change. I&#39;m getting a runtime error 13, type mismatch - will check through the code though."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562779039, "post_id": 56975258, "comment_id": 100487579, "body": "Yes you could loop through a range instead. Which line errors? I don&#39;t think I made provision for missing names."}, {"owner": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562779674, "post_id": 56975258, "comment_id": 100487884, "body": "When I add an array to test it, it errors once it gets to this the second time: <code>Set rFind1 = .Find(What:=vNames(i), After:=rFind1, lookat:=xlWhole, SearchDirection:=xlNext, _                           MatchCase:=False, SearchFormat:=False)</code>  The way the report is laid out is making this very difficult for me to get my head around.   <a href=\"https://docs.google.com/spreadsheets/d/1yZtsfAz0YfuJVPgd2l2cmviYmWu1Qswy9l956AucgEk/edit?usp=sharing\" rel=\"nofollow noreferrer\">docs.google.com/spreadsheets/d/&hellip;</a> - this is effectively what the report looks like.  The users are in A and the ranges I need to create per user start in B to I (in this example)."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562780891, "post_id": 56975258, "comment_id": 100488392, "body": "What are your actual values in column A - a named range can&#39;t contain a space (not causing the error you mention). Are the values you are looping through simply those in column A?"}, {"owner": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562781408, "post_id": 56975258, "comment_id": 100488589, "body": "They are, but I amended them in the table for testing the code. If it works when I amend the values in column A, I could set up some formula and separate macros to pull it to another sheet/changing the values. The issue I have is this report is generated every day and will automatically change the values back to what you see currently in A"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562781692, "post_id": 56975258, "comment_id": 100488695, "body": "Works for me on your file (with one small change above). Do some debugging, check the values when it errors, whether it does any ranges etc."}, {"owner": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562782268, "post_id": 56975258, "comment_id": 100488973, "body": "Ah, yes. This seems to be working now! Thank you very much - you&#39;ve made my life easier!"}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 0, "last_activity_date": 1562781653, "last_edit_date": 1562781653, "creation_date": 1562777274, "answer_id": 56975258, "question_id": 56974857, "link": "https://stackoverflow.com/questions/56974857/loop-through-cells-to-generate-a-set-of-named-ranges-in-vba-excel/56975258#56975258", "title": "Loop through cells to generate a set of named ranges in VBA / Excel", "body": "<p>Think this does what you want. It loops through a list of the range names so adjust to suit, ditto sheet name.</p>\n\n<pre><code>Sub x()\n\nDim rFind1 As Range, rFind2 As Range, vNames As Variant, i As Long\n\nvNames = Array(\"USER1\", \"USER2\", \"USER3\", \"RANGE_NAME_USER2\")\n\nWith Sheet1.Columns(1)\n    Set rFind1 = .Cells(.Cells.Count)\n    For i = LBound(vNames) To UBound(vNames) - 1\n        Set rFind1 = .Find(What:=vNames(i), After:=rFind1, lookat:=xlWhole, SearchDirection:=xlNext, _\n                          MatchCase:=False, SearchFormat:=False)\n        If Not rFind1 Is Nothing Then\n            Set rFind2 = .Find(What:=vNames(i + 1), After:=rFind1)\n            If Not rFind2 Is Nothing Then\n                .Range(\"B\" &amp; rFind1.Row + 1 &amp; \":Q\" &amp; rFind2.Row - 1).Name = vNames(i)\n            End If\n        End If\n    Next i\n    .Range(\"B\" &amp; rFind2.Row + 1 &amp; \":Q\" &amp; .Cells(Rows.Count, 2).End(xlUp).Row).Name = vNames(UBound(vNames))\nEnd With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562778053, "post_id": 56975311, "comment_id": 100487111, "body": "Unfortunately this won&#39;t work, as the range will vary (though is always between the two users) and aren&#39;t valid as a range name. They&#39;re all formatted as: Agent ####: LastName, FirstName.  I&#39;ve already ran a conversion formula (subtitute etc) in Excel to change them to valid range names - though I can&#39;t for the life of me think of a way to parse this into VBA. I&#39;m really having a blank moment!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562778690, "post_id": 56975311, "comment_id": 100487397, "body": "I&#39;m not sure what you mean by &quot;the range will vary&quot; - this code should account for that.  If you need to create a mapping between usernames and range names you can do that on a worksheet and use VLOOKUP to get the range name from the username."}, {"owner": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562779289, "post_id": 56975311, "comment_id": 100487705, "body": "Sorry, I wasn&#39;t very clear/made no sense.  The user names aren&#39;t laid out as valid range names and they can&#39;t be sorted/user names change every day on each report. I&#39;ve already got the range name based on each user name but unsure how to then have the macro know when each user stops and the next starts, in order to then grab a range from it.   For reference, the user names that I need the range generating from are formatting as <i>Agent ####: LastName, FirstName</i> and the range names I have generating is <i>FirstNameLastName</i>  Your code works - but not with the reports that get generated :("}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562782084, "post_id": 56975311, "comment_id": 100488885, "body": "See edit for how to create the range name from the user name"}, {"owner": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562782248, "post_id": 56975311, "comment_id": 100488958, "body": "Perfect thank you! I should be able to use this to get what I need!"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "reply_to_user": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562782534, "post_id": 56975311, "comment_id": 100489096, "body": "Just saw your sample file - that&#39;s totally different from what I&#39;d thought you were dealing with and explains your original approach...."}, {"owner": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "edited": false, "score": 0, "creation_date": 1562783351, "post_id": 56975311, "comment_id": 100489492, "body": "Oh haha - can you think of an easier way to do what I was hoping as I&#39;ev taken both codes and have basically butchered them to do what I want, but I&#39;d like it to be cleaner if possible"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": false, "score": 0, "last_activity_date": 1562782065, "last_edit_date": 1562782065, "creation_date": 1562777494, "answer_id": 56975311, "question_id": 56974857, "link": "https://stackoverflow.com/questions/56974857/loop-through-cells-to-generate-a-set-of-named-ranges-in-vba-excel/56975311#56975311", "title": "Loop through cells to generate a set of named ranges in VBA / Excel", "body": "<p>Assuming users are sorted and user names are valid as part of a range name, and that you want all user names to be created as range names.</p>\n\n<pre><code>Sub SetUserRanges()\n\n    Dim c As Range, sht As Worksheet\n    Dim usr, rngUsers As Range, n As Long\n\n    Set sht = ActiveSheet\n    Set rngUsers = sht.Range(sht.Range(\"A2\"), sht.Cells(Rows.Count, 1).End(xlUp))\n    Set c = rngUsers.Cells(1)\n    Do While c.Row &lt;= rngUsers.Cells(rngUsers.Cells.Count).Row\n\n        usr = c.Value 'current user\n        n = Application.CountIf(rngUsers, usr)\n\n        c.Offset(0, 1).Resize(n, 16).Name = Rangename(usr)\n\n        Set c = c.Offset(n, 0)\n    Loop\n\nEnd Sub\n\n'Convert a username formatted as \"Agent ####: LastName, FirstName\" into \n' \"FirstName_LastName\"\nFunction Rangename(usr As String) As String\n    Dim arr\n    'split on \":\" then split second part on \",\"\n    arr = Split(Split(usr, \":\")(1), \",\")\n    Rangename = Trim(arr(1)) &amp; \"_\" &amp; Trim(arr(0))\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 11766041, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b38e8bf245f0f329b116167cecf84e0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jon", "link": "https://stackoverflow.com/users/11766041/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 221, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1562782065, "creation_date": 1562775500, "last_edit_date": 1562776186, "question_id": 56974857, "link": "https://stackoverflow.com/questions/56974857/loop-through-cells-to-generate-a-set-of-named-ranges-in-vba-excel", "title": "Loop through cells to generate a set of named ranges in VBA / Excel", "body": "<p>I have a tracker at my work which pulls information from a report, the information then needs to be extracted per user with a named range. Doing it manually is a long and tedious process - I was wondering if there was a way to get it to automatically generate the named ranges based on the values between two cells in Column A.</p>\n\n<p>The values in Column A do change and aren't numbered (but they always follow the same format). So ideally it would just search for the next non-empty cell.</p>\n\n<p>The code below is what's being used to generate the named range, but I was wondering if it was possible to pre-fill USER1, USER2, RANGE_NAME_USER1 etc based on the next non-empty cell so it generates all the ranges needed. </p>\n\n<p>So once it's done with USER1, it will then be USER2, USER3, RANGE_NAME_USER2 etc?</p>\n\n<p>I've tried some while loops and such but I can't seem to figure out how to change the values of \"USER1\", \"USER2\" to automatically know what to do.</p>\n\n<pre><code>Sub SelectBetween()\n    Dim findrow As Long, findrow2 As Long\n    On Error GoTo errhandler\n    findrow = Range(\"A:A\").Find(\"USER1\", Range(\"A1\")).Row\n    findrow2 = Range(\"A:A\").Find(\"USER2\", Range(\"A\" &amp; findrow)).Row\n    Range(\"B\" &amp; findrow + 1 &amp; \":Q\" &amp; findrow2 - 1).Select\n    Selection.Name = \"RANGE_NAME_USER1\"\nerrhandler:\nExit Sub\n    MsgBox \"Can't find the cells! Please check!\"\nEnd Sub\n</code></pre>\n\n<p>The idea is that once it's found USER1 and allocated a named range to it, it would repeat the code but be similar to:</p>\n\n<pre><code>Sub SelectBetween()\n    Dim findrow As Long, findrow2 As Long\n    On Error GoTo errhandler\n    findrow = Range(\"A:A\").Find(\"USER2\", Range(\"A1\")).Row\n    findrow2 = Range(\"A:A\").Find(\"USER3\", Range(\"A\" &amp; findrow)).Row\n    Range(\"B\" &amp; findrow + 1 &amp; \":Q\" &amp; findrow2 - 1).Select\n    Selection.Name = \"RANGE_NAME_USER2\"\nerrhandler:\nExit Sub\n    MsgBox \"Can't find the cells! Please check!\"\nEnd Sub\n</code></pre>\n\n<p>Is this possible? Thank you!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562778756, "post_id": 56974830, "comment_id": 100487437, "body": "Are the workbooks you are trying to copy from and copy to open?"}, {"owner": {"reputation": 1, "user_id": 11766044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/685d9e036f18854b8e836cad5377262b?s=128&d=identicon&r=PG&f=1", "display_name": "jaynakvs", "link": "https://stackoverflow.com/users/11766044/jaynakvs"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562784058, "post_id": 56974830, "comment_id": 100489790, "body": "Yes, everything is already open, and it  works if it put the actual date in instead of the Format(date,...)"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562784693, "post_id": 56974830, "comment_id": 100490054, "body": "Are the names of the files using today&#39;s current date?"}, {"owner": {"reputation": 1, "user_id": 11766044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/685d9e036f18854b8e836cad5377262b?s=128&d=identicon&r=PG&f=1", "display_name": "jaynakvs", "link": "https://stackoverflow.com/users/11766044/jaynakvs"}, "reply_to_user": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562791201, "post_id": 56974830, "comment_id": 100492651, "body": "the files being opened are opened every business day, and are all coming in the same format of mm-dd-yyyy after the &quot;_&quot; in the filename"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562845736, "post_id": 56974830, "comment_id": 100511525, "body": "Well Date returns the current date, the format of the date is the string - &quot;mm-dd-yyyy&quot; so if the dates are not the same as today&#39;s date it won&#39;t find the file, you would need an input box or something."}], "owner": {"reputation": 1, "user_id": 11766044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/685d9e036f18854b8e836cad5377262b?s=128&d=identicon&r=PG&f=1", "display_name": "jaynakvs", "link": "https://stackoverflow.com/users/11766044/jaynakvs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 107, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562791299, "creation_date": 1562775405, "last_edit_date": 1562791299, "question_id": 56974830, "link": "https://stackoverflow.com/questions/56974830/how-to-open-files-with-variable-date-name-in-vba", "title": "How to open files with variable date name in VBA?", "body": "<p>I'm trying to open file names with different dates and format, pull certain worksheets and compile them into one separate workbook together. </p>\n\n<p>I've tried using Format(Date, \".....) see code</p>\n\n<pre><code>  Windows(\"Comparison NAV_ Fund Summary_\" &amp; Format(Date, \"mm-dd-yyyy\") &amp; \".xlsx\").Activate\n    Sheets(\"Comparison NAV- Fund Summary\").Select\n    Sheets(\"Comparison NAV- Fund Summary\").Copy After:=Workbooks(\"CurrentNew.xls\" _\n        ).Sheets(1)\n</code></pre>\n\n<p>With this section, I'm getting the </p>\n\n<blockquote>\n  <p>\"Run-time error '9': Subscript out of range\" </p>\n</blockquote>\n\n<p>when I try to run the code.</p>\n\n<p>As reference, I'm trying to open the file with the name: \n\"Comparison NAV_ Fund Summary_mm-dd-yyyy.xlsx\"</p>\n"}, {"tags": ["excel", "vba", "sum", "cell"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562777448, "post_id": 56974786, "comment_id": 100486854, "body": "What&#39;s the exact SUM code you are using now/"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11765731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e47e39947130c194a7d934452b05373?s=128&d=identicon&r=PG", "display_name": "Bradley Herron", "link": "https://stackoverflow.com/users/11765731/bradley-herron"}, "edited": false, "score": 0, "creation_date": 1562854483, "post_id": 56976071, "comment_id": 100517043, "body": "That will work.  I can put &quot;Blank&quot; as the first sheet.  I was trying to not confuse the individuals who actually add the new sheets and load the data.  I&#39;ll just get with them and make sure they understand to add any new sheets after &quot;Blank&quot;.  Thank you."}], "tags": [], "owner": {"reputation": 17, "user_id": 11609062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb75719ca0b3ecc7f8235d81c7685cbc?s=128&d=identicon&r=PG&f=1", "display_name": "z3115", "link": "https://stackoverflow.com/users/11609062/z3115"}, "is_accepted": false, "score": 0, "last_activity_date": 1562780840, "creation_date": 1562780840, "answer_id": 56976071, "question_id": 56974786, "link": "https://stackoverflow.com/questions/56974786/using-internal-excel-sheet-name-i-e-sheet1-sheet2-sheet3-to-sum-a-cell-acro/56976071#56976071", "title": "Using internal excel sheet name (i.e. sheet1, sheet2, sheet3) to sum a cell across multiple sheets", "body": "<p>You shouldn't need to use VBA, you can use the default sum formula. I recommend creating two blank sheets (e.g. \"Start\" and \"End\"), ensure that \"Start\" is always before the first sheet you want to some and \"End\" is always immediately after the last sheet you want to sum. Then, a formula like this would do what you're asking:</p>\n\n<pre><code>=SUM(Start:End!A1)\n</code></pre>\n\n<p>Edit: If the name of the first and/or last sheet that should be summed is static, you could avoid using the \"start\" or \"end\" placeholders and replace them with the names of the first/last sheets that should be summed.</p>\n"}], "owner": {"reputation": 1, "user_id": 11765731, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e47e39947130c194a7d934452b05373?s=128&d=identicon&r=PG", "display_name": "Bradley Herron", "link": "https://stackoverflow.com/users/11765731/bradley-herron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562780840, "creation_date": 1562775246, "last_edit_date": 1562775820, "question_id": 56974786, "link": "https://stackoverflow.com/questions/56974786/using-internal-excel-sheet-name-i-e-sheet1-sheet2-sheet3-to-sum-a-cell-acro", "title": "Using internal excel sheet name (i.e. sheet1, sheet2, sheet3) to sum a cell across multiple sheets", "body": "<p>I'm trying to sum the same cell across multiple sheets. The number of sheets increases by one each week and will be a new Sheet1. Each sheet will get a date for it's name. The last sheet will have the sum totals. The three sheets prior to that will contain instructions. i.e. 20 sheets, data on sheets 1-16, instructions on sheets 17-19 and totals on sheet 20.  </p>\n\n<p>This <a href=\"https://stackoverflow.com/questions/34343788/sum-across-dynamic-number-of-sheets\">Sum across dynamic number of sheets</a> question uses a User-defined Function, =autosum, in each cell and could work. I would rather use VBA to create a macro. I know how to get total sheets and sum across all the sheets, where I'm lost is how to sum across (total sheets -4), i.e. sheets 1-16.</p>\n\n<p>code I'm already using is </p>\n\n<pre><code>Dim sheets as Integer\n\nsheets = Application.sheets.Count\n\n=SUM('FirstSheet:LastSheet'!D6)\n</code></pre>\n\n<p>How do I get </p>\n\n<p><code>=SUM('FirstSheet:(LastSheet-4)'!D6</code>?</p>\n\n<p>I want to use the internal excel sheet1, sheet2, etc. vs the date name on each sheet, at least for FirstSheet. I can hardcode LastSheet since it won't change.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 2812, "user_id": 7177346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3606be407227771ae3f6077af6a801e5?s=128&d=identicon&r=PG", "display_name": "freeflow", "link": "https://stackoverflow.com/users/7177346/freeflow"}, "edited": false, "score": 1, "creation_date": 1562776471, "post_id": 56974741, "comment_id": 100486387, "body": ".cells(c).columnindex"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1562785723, "post_id": 56974741, "comment_id": 100490479, "body": "What is the <code>Select Case</code> acting on? It&#39;s not clear what <code>c.Range.Text</code> contains. And since that&#39;s determining what applies the various colours it would be important to know that? Right now, this code is cycling <i>all</i> cells in the table, regardless of column, and applying formatting based on the cell content, as far as I can tell, rather than the column..."}, {"owner": {"reputation": 9, "user_id": 11765955, "user_type": "registered", "profile_image": "https://graph.facebook.com/2843810952314412/picture?type=large", "display_name": "Vicky Evans", "link": "https://stackoverflow.com/users/11765955/vicky-evans"}, "edited": false, "score": 0, "creation_date": 1562834641, "post_id": 56974741, "comment_id": 100505018, "body": "Hi Cindy, I&#39;m not sure what you mean as i am novice VBA user. Have you any ides how to focus on the columns 5 and 6 in the table?"}], "owner": {"reputation": 9, "user_id": 11765955, "user_type": "registered", "profile_image": "https://graph.facebook.com/2843810952314412/picture?type=large", "display_name": "Vicky Evans", "link": "https://stackoverflow.com/users/11765955/vicky-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562776092, "creation_date": 1562775103, "last_edit_date": 1562776092, "question_id": 56974741, "link": "https://stackoverflow.com/questions/56974741/conditional-formatting-columns-in-a-table-ms-word-using-vba", "title": "Conditional formatting columns in a table MS word using VBA", "body": "<p>I have generated VBA code to help set conditional formatting for a table in MS word. I am trying to apply this code to only limited columns in the table. Only columns 5 and 6. Please help.</p>\n\n<p>I have a macro that changes the background colour of a table in Word depending upon the text within the same cell - akin to Excel's conditional formatting rules.</p>\n\n<p>However I want to restrict this to a specific columns - column 5 &amp; 6  in the table.</p>\n\n<p>My code is below; but this is applying it to both columns.</p>\n\n<p>Anyone know how to re-code so it only applies to table column 5 and 6.</p>\n\n<pre><code>Sub ColourSelectedTable()\n    Application.ScreenUpdating = False\n    Dim c As Cell\n    With Selection\n      If .Information(wdWithInTable) Then\n        For Each c In .Tables(1).Range.Cells\n          Select Case Split(c.Range.Text, vbCr)(0)\n            Case 1: c.Shading.BackgroundPatternColor = wdColorGreen\n            Case 2: c.Shading.BackgroundPatternColor = wdColorGreen\n            Case 3: c.Shading.BackgroundPatternColor = wdColorYellow\n            Case 4: c.Shading.BackgroundPatternColor = wdColorRed\n            Case Else: c.Shading.BackgroundPatternColor = wdColorAutomatic\n          End Select\n        Next\n      End If\n    End With\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "stream", "adodb", "recordset"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1562778516, "post_id": 56974503, "comment_id": 100487314, "body": "If you want to persist a recordset you can use a client-side cursor and disconnect it.  If you need to save it to a file you can use the <code>Save</code> method: <a href=\"https://docs.microsoft.com/en-us/sql/ado/guide/data/persisting-data?view=sql-server-2017\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/sql/ado/guide/data/&hellip;</a>  If you need to check for specific values you can use the <code>Find</code> method: <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/find-method-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\">docs.microsoft.com/en-us/sql/ado/reference/ado-api/&hellip;</a>"}, {"owner": {"reputation": 1968, "user_id": 7393973, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/527fd7a80369379d54890cf7021d093b?s=128&d=identicon&r=PG&f=1", "display_name": "user7393973", "link": "https://stackoverflow.com/users/7393973/user7393973"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562936571, "post_id": 56974503, "comment_id": 100547754, "body": "The <code>Find</code> method is what I was looking for. Thanks @TimWilliams."}], "answers": [{"tags": [], "owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "is_accepted": false, "score": 3, "last_activity_date": 1562775698, "last_edit_date": 1562775698, "creation_date": 1562775347, "answer_id": 56974815, "question_id": 56974503, "link": "https://stackoverflow.com/questions/56974503/check-if-adodb-recordset-contains-value-in-vba/56974815#56974815", "title": "Check if ADODB Recordset contains value in VBA", "body": "<p>From <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/bof-eof-properties-ado?view=sql-server-2017\" rel=\"nofollow noreferrer\">Microsofts documentation</a>:</p>\n\n<blockquote>\n  <p>Use the <strong>BOF</strong> and <strong>EOF</strong> properties to determine whether a <strong>Recordset</strong> object contains records or whether you have gone beyond the limits of a <strong>Recordset</strong> object when you move from record to record.</p>\n  \n  <p>The <strong>BOF</strong> property returns <strong>True</strong> (-1) if the current record position is before the first record and <strong>False</strong> (0) if the current record position is on or after the first record.</p>\n  \n  <p>The <strong>EOF</strong> property returns <strong>True</strong> if the current record position is after the last record and <strong>False</strong> if the current record position is on or before the last record.</p>\n  \n  <p>If either the <strong>BOF</strong> or <strong>EOF</strong> property is <strong>True</strong>, there is no current record.</p>\n</blockquote>\n\n<hr>\n\n<p>So you could check to see if either of these properties are true, then you would know there is no current record.</p>\n\n<p>Or you could do the opposite, and check to see if neither are true. Example:</p>\n\n<pre><code>If Not Rs.BOF And Not Rs.EOF Then\n    ' Do something with your recordset\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 1968, "user_id": 7393973, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/527fd7a80369379d54890cf7021d093b?s=128&d=identicon&r=PG&f=1", "display_name": "user7393973", "link": "https://stackoverflow.com/users/7393973/user7393973"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1033, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562775698, "creation_date": 1562774162, "question_id": 56974503, "link": "https://stackoverflow.com/questions/56974503/check-if-adodb-recordset-contains-value-in-vba", "title": "Check if ADODB Recordset contains value in VBA", "body": "<p>I have a <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/recordset-object-ado\" rel=\"nofollow noreferrer\">Recordset</a> which has 1 column/field of data/records.</p>\n\n<p>It has up to about hundreads or thousands of string values depending on the date range picked.</p>\n\n<p>I then clone that data into a <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/stream-object-ado\" rel=\"nofollow noreferrer\">Stream</a> (as explained in an <a href=\"https://stackoverflow.com/a/25554406\">answer</a> to another question) to keep it and reuse the Recordset. That Stream can be turned back into a new Recordset if needed or (probably) an array of some sort.</p>\n\n<p>Later in the code I need to check if some values are in that Stream/Recordset/Array/etc.</p>\n\n<p>Other than turning the Stream back into a Recordset and use a normal loop with <a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/movefirst-movelast-movenext-and-moveprevious-methods-ado\" rel=\"nofollow noreferrer\">Recordset.Move methods</a> (<a href=\"https://docs.microsoft.com/en-us/sql/ado/reference/ado-api/movefirst-movelast-movenext-and-moveprevious-methods-example-vb\" rel=\"nofollow noreferrer\">example</a>) to check if each of those values are or not in the stored data, is there any other more efficient way to check it?</p>\n"}, {"tags": ["sql", "vba"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 11765800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3530e6f0c7b9cdcf71f26a2e76670b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11765800/mark"}, "edited": false, "score": 0, "creation_date": 1562844266, "post_id": 56974679, "comment_id": 100510661, "body": "Hi Jeff  thanks for the response. I tried applying the above but got the error Compile Error Expected identifier,  then once i get past that it has an compile error Syntax error"}, {"owner": {"reputation": 11, "user_id": 11765800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3530e6f0c7b9cdcf71f26a2e76670b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11765800/mark"}, "edited": false, "score": 0, "creation_date": 1562846070, "post_id": 56974679, "comment_id": 100511709, "body": "after some elimination process sdate_interview and srundate after inserting apostraphe the date is inserted but in the format yyyy-dd-mm instead of yyyy-mm-dd. sdate_confirmed returns the error out of range. so have 2 of the fields working... kinda!"}, {"owner": {"reputation": 11, "user_id": 11765800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3530e6f0c7b9cdcf71f26a2e76670b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11765800/mark"}, "edited": false, "score": 0, "creation_date": 1562852298, "post_id": 56974679, "comment_id": 100515721, "body": "Answer for those YYYY-DD-MM is &#39;&quot; &amp; Format(sRundate, &quot;yyyy-mm-dd&quot;) &amp; &quot;&#39;,"}], "tags": [], "owner": {"reputation": 857, "user_id": 3786517, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sd06B.jpg?s=128&g=1", "display_name": "jefftrotman", "link": "https://stackoverflow.com/users/3786517/jefftrotman"}, "is_accepted": false, "score": 0, "last_activity_date": 1562774842, "creation_date": 1562774842, "answer_id": 56974679, "question_id": 56974462, "link": "https://stackoverflow.com/questions/56974462/why-does-1900-01-01-000000-000-appear-after-inserting-data-from-excel-into-sql/56974679#56974679", "title": "Why does 1900-01-01 00:00:00.000 appear after inserting data from excel into SQL table?", "body": "<p>Based on what I'm seeing, I'm surprised the INSERT statement is executing successfully and leaving the date fields blank, but what jumps out at me is - you need to wrap your date values in single quotes the way you are wrapping your strings. Even though you DIM'd them as Date types, when you concatenate them with the other strings to make up the insert statement, they are being cast into strings.</p>\n\n<p>The beginning of your Values clause should look like this:</p>\n\n<pre><code>\"Values ('\" &amp; sForename &amp; \"','\" &amp; sSurname &amp; \"','\" &amp; sdate_confirmed &amp; \"',\"' &amp; sdate_interview &amp; \"','\" &amp; ...\n</code></pre>\n\n<p>I would recommend that - instead of concatenating the command string on the same line as the call to execute it</p>\n\n<p><code>oCon.Execute \"Insert into [Interview_Info]</code></p>\n\n<p>concatenate your command string into a variable that you can examine (to ensure date values are wrapped in single quotes) before executing it.</p>\n\n<pre><code>string cmd = \"Insert into [Interview_Info]...\noCon.Execute cmd\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11765800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3530e6f0c7b9cdcf71f26a2e76670b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11765800/mark"}, "is_accepted": false, "score": 1, "last_activity_date": 1562854521, "creation_date": 1562854521, "answer_id": 56991295, "question_id": 56974462, "link": "https://stackoverflow.com/questions/56974462/why-does-1900-01-01-000000-000-appear-after-inserting-data-from-excel-into-sql/56991295#56991295", "title": "Why does 1900-01-01 00:00:00.000 appear after inserting data from excel into SQL table?", "body": "<p>I resolved it.</p>\n\n<p>I must have needed the nap!</p>\n\n<p>i kept the original script and fixed the format.</p>\n\n<p>it all works.</p>\n"}], "owner": {"reputation": 11, "user_id": 11765800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3530e6f0c7b9cdcf71f26a2e76670b4c?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/11765800/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562854521, "creation_date": 1562774021, "last_edit_date": 1562776085, "question_id": 56974462, "link": "https://stackoverflow.com/questions/56974462/why-does-1900-01-01-000000-000-appear-after-inserting-data-from-excel-into-sql", "title": "Why does 1900-01-01 00:00:00.000 appear after inserting data from excel into SQL table?", "body": "<p>I am trying to insert dates from a worksheet into a table into SQL. The original source for the date in the worksheet is from a connection to sql and the date field has been set up with a Cast(interview_date as date) but once the worksheet has been populated I need to insert back in to another table in SQL. When I do, i get 1900-01-01 00:00:00.000 in the date field(which is is date time) of the table. My extract into excel date format is yyyy-mm-dd and its the same on the Sql table i am inserting into.</p>\n\n<p>I have tried the following insert in VBA, the 3 fields in question are sdate_confirmed, sdate_interview and rundate.</p>\n\n<p>I have declared the fields as </p>\n\n<pre><code>Dim sForename As String\nDim sSurname As String\nDim sdate_confirmed As Date\nDim sdate_interview As Date\nDim sNumerator1 As Integer\nDim sDenominator1 As Integer\nDim sNumerator2 As Integer\nDim sDenominator2 As Integer\nDim sNumerator3 As Integer\nDim sDenominator3 As Integer\nDim sRundate As Date\nDim sDO_NOT_DELETE As Integer\n</code></pre>\n\n<p>I am using Excel 2010 and SQL server 2012.</p>\n\n<p>Thanks for any help in advance.</p>\n\n<p>I have tried cdate() and datevalue() in the VBA insert into...</p>\n\n<p>there are no null or missing dates in the excel worksheet.</p>\n\n<pre><code>oCon.Execute \"Insert into [Interview_Info].[dbo].Interview (Forename,Surname,date_confirmed,date_interview,Numerator1,Denominator1,Numerator2,Denominator2,Numerator3,Denominator3,Rundate,DO_NOT_DELETE) \" &amp; _\n             \"Values ('\" &amp; sForename &amp; \"','\" &amp; sSurname &amp; \"',\" &amp; sdate_confirmed &amp; \",\" &amp; sdate_interview &amp; \",'\" &amp; sNumerator1 &amp; \"','\" &amp; sDenominator1 &amp; \"','\" &amp; sNumerator2 &amp; \"','\" &amp; sDenominator2 &amp; \"','\" &amp; sNumerator3 &amp; \"','\" &amp; sDenominator3 &amp; \"',\" &amp; sRundate &amp; \",'\" &amp; sDO_NOT_DELETE &amp; \"')\"\n</code></pre>\n\n<p>I am hoping that dates in the fields in Excel will be inserted into the <code>[Interview_Info].[dbo].Interview</code> will have the correct dates as shown in the excel worksheet instead of <code>1900-01-01 00:00:00.000</code>.</p>\n"}, {"tags": ["excel", "vba", "macos"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562774508, "post_id": 56974379, "comment_id": 100485369, "body": "Check the output of <code>Debug.Print iPath &amp; &quot;:&quot; &amp; id &amp; &quot;_&quot; &amp; Format(ddate, &quot;yyyy-mm-dd&quot;) &amp; &quot;_&quot; &amp; gate &amp; &quot;_&quot; &amp; firstrow &amp; &quot;.csv&quot;</code> and tell us what it is."}, {"owner": {"reputation": 1, "user_id": 11761735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1665f8fc819acaade7b50091bef92d8?s=128&d=identicon&r=PG&f=1", "display_name": "ng999", "link": "https://stackoverflow.com/users/11761735/ng999"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562784777, "post_id": 56974379, "comment_id": 100490086, "body": "I run the code, now it errors out here: <a href=\"https://imgur.com/5pzollo\" rel=\"nofollow noreferrer\">imgur.com/5pzollo</a>"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562822839, "post_id": 56974379, "comment_id": 100499562, "body": "Ok the <code>Debug.Print</code> line prints something in the Immediate Window (you can open it via the menu). See <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/use-the-immediate-window\" rel=\"nofollow noreferrer\">Use the Immediate Window</a>. What was printed there?"}, {"owner": {"reputation": 1, "user_id": 11761735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1665f8fc819acaade7b50091bef92d8?s=128&d=identicon&r=PG&f=1", "display_name": "ng999", "link": "https://stackoverflow.com/users/11761735/ng999"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562867117, "post_id": 56974379, "comment_id": 100523708, "body": "<a href=\"https://imgur.com/a/6g0PoXd\" rel=\"nofollow noreferrer\">imgur.com/a/6g0PoXd</a>  is this one ok?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562909026, "post_id": 56974379, "comment_id": 100534409, "body": "Ok does this complete path exist for sure? And what was the error message of your <code>SaveAs</code> line?"}], "owner": {"reputation": 1, "user_id": 11761735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1665f8fc819acaade7b50091bef92d8?s=128&d=identicon&r=PG&f=1", "display_name": "ng999", "link": "https://stackoverflow.com/users/11761735/ng999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 614, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1593586761, "creation_date": 1562773715, "last_edit_date": 1593586761, "question_id": 56974379, "link": "https://stackoverflow.com/questions/56974379/vba-for-macbook-macro-not-saving-output-file", "title": "VBA for Macbook - macro not saving output file", "body": "<p>I'm working on macro for MacBook for separating codes that we paste in file. </p>\n\n<p>After running codes should show up in a folder on my desktop called Tour Codes. </p>\n\n<p>However, file is not getting saved and macro shows error. </p>\n\n<p>I've tried multiple adjustments and changing location of file but the problem remains.</p>\n\n<p>I would appreciate any suggestions.</p>\n\n<pre><code>\nSub create_files()\nApplication.ScreenUpdating = False\nDim iName, iPath\niName = GetUserNameMac\n'Get Path and Workbook Name\n'iPath = ActiveWorkbook.Path\niPath = \"Macintosh HD:Users:\" &amp; iName &amp; \":Desktop:Tour Codes\"\nSheets(\"Data\").Select\n\n...\n'create files\nDim r1, ddate, gate, id, cap, firstrow, rowcount, newcode\nr1 = 2\nfirstrow = 2\n...\n\n    Application.DisplayAlerts = False\n    'save file\n    ChDir \"Macintosh HD:Users:\" &amp; iName &amp; \":Desktop:Tour Codes\"\n    ActiveWorkbook.SaveAs Filename:= _\n    iPath &amp; \":\" &amp; id &amp; \"_\" &amp; Format(ddate, \"yyyy-mm-dd\") &amp; \"_\" &amp; gate &amp; \"_\" &amp; firstrow &amp; \".csv\", _\n        FileFormat:=xlCSV, CreateBackup:=False\n    'ActiveWorkbook.SaveAs iPath &amp; \":\" &amp; merchWk\n    'ActiveWorkbook.SaveAs iPath &amp; \"/\" &amp; merchWk\n    Windows(\"Gate 1 codes macro.xlsm\").Activate\n\n    'copy rows to file\n    'Rows(firstrow &amp; \":\" &amp; firstrow + rowcount - 2).Select\n    Range(Cells(firstrow, 1), Cells(firstrow + rowcount - 2, 1)).Select\n    Selection.Copy\n    Windows(id &amp; \"_\" &amp; Format(ddate, \"yyyy-mm-dd\") &amp; \"_\" &amp; gate &amp; \"_\" &amp; firstrow &amp; \".csv\").Activate\n    'Cells(2, 1).Select\n    Cells(1, 1).Select\n    ActiveSheet.Paste\n    'Columns(\"A:E\").EntireColumn.AutoFit\n    Columns(\"A:A\").EntireColumn.AutoFit\n\n    'save file\n    Cells(1, 1).Select\n    ActiveWorkbook.Save\n    ActiveWindow.Close\n    Application.DisplayAlerts = True\n    Windows(\"Gate 1 codes macro.xlsm\").Activate\n    firstrow = r1 - 1\n    r1 = firstrow\n\nLoop Until r1 &gt; lastrow\nEnd Sub\nFunction GetUserNameMac() As String\nDim sMyScript As String\nsMyScript = \"set userName to short user name of (system info)\" &amp; vbNewLine &amp; \"return userName\"   \nGetUserNameMac = MacScript(sMyScript)\n\nEnd Function\n</code></pre>\n\n<p>VBA errors out on these lines:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nKVzH.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nKVzH.png\" alt=\"error\"></a></p>\n"}, {"tags": ["excel", "vba", "replace"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1562774797, "post_id": 56974286, "comment_id": 100485517, "body": "Would you not want to loop through your content and just use <code>if right(cells(i,3).value,1) &lt;&gt; &quot;&#47;&quot; then cells(i,3).value = cells(i,3).value &amp; &quot;&#47;SUP&quot;</code> ?  As written, you are searching for <code>???</code> and replacing it, which wouldn&#39;t work as that exact string doesn&#39;t appear in your content."}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1562774892, "post_id": 56974286, "comment_id": 100485562, "body": "So, you are replacing the text <code>&quot;???&quot;</code> with <code>&quot;???&#47;SUP&quot;</code> - do your cells <b>actually</b> end with three question marks???"}, {"owner": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 1, "creation_date": 1562775053, "post_id": 56974286, "comment_id": 100485656, "body": "@Cyril Since the query is &quot;does not contain <code>&quot;&#47;&quot;</code>&quot;, I would suggest <code>If InStr(cells(i,3).Value,&quot;&#47;&quot;)&gt;0 Then</code> instead"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1562776367, "post_id": 56974286, "comment_id": 100486339, "body": "Good point, @Chronocidal , though you don&#39;t need the <code>&gt;0</code> as InStr returns boolean."}, {"owner": {"reputation": 111, "user_id": 10226260, "user_type": "registered", "profile_image": "https://graph.facebook.com/1606187699500187/picture?type=large", "display_name": "Gabriel Hardoim", "link": "https://stackoverflow.com/users/10226260/gabriel-hardoim"}, "reply_to_user": {"reputation": 5888, "user_id": 9290986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wUklh.png?s=128&g=1", "display_name": "Chronocidal", "link": "https://stackoverflow.com/users/9290986/chronocidal"}, "edited": false, "score": 0, "creation_date": 1562779371, "post_id": 56974286, "comment_id": 100487737, "body": "@Chronocidal I&#39;m using <code>???</code> as any three characters"}, {"owner": {"reputation": 111, "user_id": 10226260, "user_type": "registered", "profile_image": "https://graph.facebook.com/1606187699500187/picture?type=large", "display_name": "Gabriel Hardoim", "link": "https://stackoverflow.com/users/10226260/gabriel-hardoim"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1562779494, "post_id": 56974286, "comment_id": 100487804, "body": "@Cyril I haven&#39;t considered the option to loop the content because I thought that with this method would be more performatic"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1562781106, "post_id": 56974286, "comment_id": 100488468, "body": "@GabrielHardoim It looks like you would need a loop regardless, though if you are worried about performance, use a variant array to store the values in the column so the <code>if</code> check can be done inside of VBA, then change the cell value to be that of the array &amp; &quot;/lsup&quot;, e.g., <code>cell(i+1,3).value = arr(i,1) &amp; &quot;&#47;SUP&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1562775483, "creation_date": 1562775483, "answer_id": 56974853, "question_id": 56974286, "link": "https://stackoverflow.com/questions/56974286/concatenate-a-string-instead-a-replacement/56974853#56974853", "title": "Concatenate a string instead a replacement", "body": "<p>I don't think Range.Replace is going to work for your intended use case here.  Best bet is to loop over the data and append where necessary.  Something like this should work for you:</p>\n\n<pre><code>Sub tgr()\n\n    Dim ws As Worksheet\n    Dim aData() As Variant\n    Dim i As Long\n\n    Set ws = ActiveWorkbook.ActiveSheet\n\n    With ws.Range(\"C2\", ws.Cells(ws.Rows.Count, \"C\").End(xlUp))\n        If .Row &lt; 2 Then Exit Sub   'No data\n\n        If .Cells.Count = 1 Then\n            ReDim aData(1 To 1, 1 To 1)\n            aData(1, 1) = .Value\n        Else\n            aData = .Value\n        End If\n\n        For i = LBound(aData, 1) To UBound(aData, 1)\n            If InStr(1, aData(i, 1), \"/\", vbBinaryCompare) = 0 Then aData(i, 1) = aData(i, 1) &amp; \"/SUP\"\n        Next i\n\n        .Value = aData\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1562780941, "post_id": 56975405, "comment_id": 100488418, "body": "Should the <code>+</code> in the cel.value line be an ampersand (<code>&amp;</code>)?"}], "tags": [], "owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "is_accepted": false, "score": 1, "last_activity_date": 1562792206, "last_edit_date": 1562792206, "creation_date": 1562777905, "answer_id": 56975405, "question_id": 56974286, "link": "https://stackoverflow.com/questions/56974286/concatenate-a-string-instead-a-replacement/56975405#56975405", "title": "Concatenate a string instead a replacement", "body": "<p>If you want to use <code>AutoFilter</code> then you need to use <code>SpecialCells(xlCellTypeVisible)</code> and just add <code>\"/SUP\"</code> to the end of the cells value.</p>\n\n<pre><code>Dim cel As Range\nWith ActiveSheet 'It's better to use the worksheet(\"Name\") or a worksheet variable\n    'Filter \n    .Range(\"A1\").AutoFilter Field:=3, Criteria1:=\"&lt;&gt;*/*\"\n    'Loop through each visible cell in the range \n    For Each cel In .Range(\"C2\", .Cells(.Rows.Count, \"C\").End(xlUp)).SpecialCells(xlCellTypeVisible)\n        'Concatenate the cells value and \"/SUP\"\n        cel.Value = Left(cel.Value, Len(cel.Value)) + \"/SUP\"\n    Next cel 'Loop\nEnd With\n</code></pre>\n\n<p>Added_Just to be thorough; If you wanted to replace the last three characters in the cell and add <code>/SUP</code>, you can change this line...</p>\n\n<pre><code>cel.Value = Left(cel.Value, Len(cel.Value)) + \"/SUP\"\n</code></pre>\n\n<p>to...</p>\n\n<pre><code>cel.Value = Left(cel.Value, Len(cel.Value) - 3) + \"/SUP\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": false, "score": 1, "last_activity_date": 1562781412, "creation_date": 1562781412, "answer_id": 56976205, "question_id": 56974286, "link": "https://stackoverflow.com/questions/56974286/concatenate-a-string-instead-a-replacement/56976205#56976205", "title": "Concatenate a string instead a replacement", "body": "<p>Related to my last comment, loop using variant array, which should be quick as the check is performed by VBA, not referencing the cells each time:</p>\n\n<pre><code>Sub test()\n    Dim lr As Long, i As Long, arr As Variant\n    lr = Cells(Rows.Count, 1).End(xlUp).Row\n    arr = Range(Cells(1, 1), Cells(lr, 1)).Value\n    For i = 2 To UBound(arr)\n        If InStr(arr(i, 1), \"/\") Then\n            Cells(i, 2).Value = arr(i, 1)\n        Else\n            Cells(i, 2).Value = arr(i, 1) &amp; \"/SUP\"\n        End If\n    Next i\nEnd Sub\n</code></pre>\n\n<p>I output the values into column b (starting with row 2 in the loop for visualization purposes), which looks like:</p>\n\n<p><a href=\"https://i.stack.imgur.com/JV2Bv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/JV2Bv.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 111, "user_id": 10226260, "user_type": "registered", "profile_image": "https://graph.facebook.com/1606187699500187/picture?type=large", "display_name": "Gabriel Hardoim", "link": "https://stackoverflow.com/users/10226260/gabriel-hardoim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1562792206, "creation_date": 1562773378, "last_edit_date": 1562774544, "question_id": 56974286, "link": "https://stackoverflow.com/questions/56974286/concatenate-a-string-instead-a-replacement", "title": "Concatenate a string instead a replacement", "body": "<p>I'm filtering certain column from my table:</p>\n\n<pre><code>ActiveSheet.Range(\"A1\").AutoFilter Field:=3, Criteria1:=\"&lt;&gt;*/*\"\n</code></pre>\n\n<p>I want everything that doesn't contain <code>/</code></p>\n\n<p>Then I apply <code>Selection.Replace</code> in the intention of concatenating the contents of that cell with <code>/SUP</code></p>\n\n<pre><code>Selection.Replace What:=\"???\", Replacement:=\"???/SUP\", LookAt:=xlPart, _\n    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _\n    ReplaceFormat:=False\n</code></pre>\n\n<p>But it isn't working. The output I expected is:</p>\n\n<pre><code>cellWith/ --- replace --- cellWith/\ncellWithout --- replace --- cellWithout/SUP\n</code></pre>\n\n<p>Can someone help me? </p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1562774135, "post_id": 56974283, "comment_id": 100485176, "body": "Have you attempted to run these via scheduling a task?"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11632974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b32842f30cb9544130d0a0b7218e8eec?s=128&d=identicon&r=PG&f=1", "display_name": "AspiringTrader", "link": "https://stackoverflow.com/users/11632974/aspiringtrader"}, "edited": false, "score": 0, "creation_date": 1562776022, "post_id": 56974647, "comment_id": 100486163, "body": "Perfect! Thanks so much @wisniadj"}], "tags": [], "owner": {"reputation": 106, "user_id": 10396068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6440bc7f96d2200162628e880337288b?s=128&d=identicon&r=PG", "display_name": "wisniadj", "link": "https://stackoverflow.com/users/10396068/wisniadj"}, "is_accepted": true, "score": 0, "last_activity_date": 1562795840, "last_edit_date": 1562795840, "creation_date": 1562774715, "answer_id": 56974647, "question_id": 56974283, "link": "https://stackoverflow.com/questions/56974283/repeat-macro-for-specified-time-interval/56974647#56974647", "title": "Repeat Macro For Specified Time Interval", "body": "<p>You will need to create one more macro like this:</p>\n\n<pre><code>Sub Timer()\n\nApplication.OnTime Now + TimeValue(\"00:10:00\"), \"operation\"\n\nEnd Sub\n</code></pre>\n\n<p>Where <code>operation</code> is the name of the macro you want to run every 10 minutes. </p>\n\n<p>On the macro you have built you will need to add only one line at the end which is <code>Call Timer</code>.</p>\n\n<p>Explanation: \nAt the end of the macro <code>operation</code> it will call the macro <code>timer</code> which in 10 minutes will run <code>operation</code>.</p>\n\n<p>Let me know if it works or if you need any more help.</p>\n"}], "owner": {"reputation": 3, "user_id": 11632974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b32842f30cb9544130d0a0b7218e8eec?s=128&d=identicon&r=PG&f=1", "display_name": "AspiringTrader", "link": "https://stackoverflow.com/users/11632974/aspiringtrader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 0, "accepted_answer_id": 56974647, "answer_count": 1, "score": 0, "last_activity_date": 1562795840, "creation_date": 1562773362, "last_edit_date": 1562774548, "question_id": 56974283, "link": "https://stackoverflow.com/questions/56974283/repeat-macro-for-specified-time-interval", "title": "Repeat Macro For Specified Time Interval", "body": "<p>I have four macros that I want to run every 10 minutes in a specified order. Currently I just set a reminder to run them, but would like to automate the process. Ideally I would love to have a separate macro that repeats all four macros (in order) every 10 mins. </p>\n\n<p>I have tried adding <code>Application.OnTime Now + TimeValue(\"00:10:00\"), \"Macro_Name\"</code> at the end of the four macros. Issue is two of the macros take some time to process. </p>\n\n<p>Also tried creating a separate Macro \"Repeat_10mins\", and building it using the <code>OnTime</code> function. Only seems to work once, and doesn't repeat (i.e, runs 10 mins after setting but does not repeat).</p>\n\n<pre><code>Sub Repeat_10mins\n\nWorkbooks(\"Book1.xlsm\").RefreshAll\n\n'Repeat Macro1\n Application.OnTime Now + TimeValue (\"00:10:00\"), \"Macro1\"\n\n'Repeat Macro2\n Application.OnTime Now + TimeValue (\"00:10:00\"), \"Macro2\"\n\n(etc for Macro 3/4)\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562773679, "post_id": 56974115, "comment_id": 100484914, "body": "Is there any reason why you show the dialog rather than saving the file directly yourself?"}, {"owner": {"reputation": 60, "user_id": 9968466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xh78R.jpg?s=128&g=1", "display_name": "Pawels", "link": "https://stackoverflow.com/users/9968466/pawels"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562774153, "post_id": 56974115, "comment_id": 100485185, "body": "I want to offer them possibility to rename the file as they like and also to choose their own location if they use other"}], "answers": [{"tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 0, "last_activity_date": 1562775479, "creation_date": 1562775479, "answer_id": 56974849, "question_id": 56974115, "link": "https://stackoverflow.com/questions/56974115/save-as-dialog-defaulting-in-documents-folder/56974849#56974849", "title": "Save As Dialog Defaulting in Documents Folder", "body": "<p>Try this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim s As String\n'assuming an .xlsx file\ns = FYandQName &amp; \" \" &amp; CountryName &amp; \" \" &amp; BusValue &amp; \" \" &amp; \"Financial Narratives.xlsx\"\nWith Application.FileDialog(msoFileDialogSaveAs) \n        .InitialFileName = Environ$(\"USERPROFILE\") &amp; \"\\Documents\\\" &amp; s\n        .Show\n        .Execute\nEnd With\n\n</code></pre>\n"}], "owner": {"reputation": 60, "user_id": 9968466, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Xh78R.jpg?s=128&g=1", "display_name": "Pawels", "link": "https://stackoverflow.com/users/9968466/pawels"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 56974849, "answer_count": 1, "score": 1, "last_activity_date": 1562790243, "creation_date": 1562772848, "last_edit_date": 1562790243, "question_id": 56974115, "link": "https://stackoverflow.com/questions/56974115/save-as-dialog-defaulting-in-documents-folder", "title": "Save As Dialog Defaulting in Documents Folder", "body": "<p>I have a report in which I allow multiple users to generate their specific version and then save the file but I do not want them to overwrite my master file. </p>\n\n<p>So I created a save-as dialog that saves the file with a specific name (the parameters after <code>.show</code> property are just different parts of the file name).</p>\n\n<p>But the dialog allows users to save the file in the same folder I have the master file by default and I would like to change this to by default offering Documents folder. Is there a way to change this?</p>\n\n<pre><code>Application.Dialogs(xlDialogSaveAs).Show FYandQName &amp; \" \" &amp; _\n    CountryName &amp; \" \" &amp; BusValue &amp; \" \" &amp; \"Financial Narratives\"\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1562773113, "creation_date": 1562773113, "answer_id": 56974201, "question_id": 56973910, "link": "https://stackoverflow.com/questions/56973910/need-a-macro-that-will-ask-someone-for-their-username-so-that-it-can-open-a-work/56974201#56974201", "title": "Need a macro that will ask someone for their username so that it can open a workbook", "body": "<p>Use <code>Environ(\"USERNAME\")</code> to get the username or even better <code>Environ(\"USERPROFILE\")</code> to get the profile path.</p>\n\n<p>So you can use it like:</p>\n\n<pre><code>Dim MyWb As Workbook\nSet MyWb = Workbooks.Open(Environ(\"USERPROFILE\") &amp; \"\\Documents\\New Data.xlsx\")\n</code></pre>\n\n<p>Using the <code>Environ(\"USERPROFILE\")</code> has the advantage that it works independently from the Windows version.</p>\n"}], "owner": {"reputation": 1, "user_id": 11765761, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aa2dc95bc34364bfcc3ce5d054016fe0?s=128&d=identicon&r=PG&f=1", "display_name": "jmunoz339", "link": "https://stackoverflow.com/users/11765761/jmunoz339"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1562773113, "creation_date": 1562772080, "last_edit_date": 1562773065, "question_id": 56973910, "link": "https://stackoverflow.com/questions/56973910/need-a-macro-that-will-ask-someone-for-their-username-so-that-it-can-open-a-work", "title": "Need a macro that will ask someone for their username so that it can open a workbook", "body": "<p>I want to automate opening up a closed workbook and extracting some data however I would like a code that would work for multiple people. possibly asking them for their username so that it could open up successfully?  </p>\n\n<pre><code>Workbooks.Open \"C:\\Users\\username\\Documents\\New Data.xlsx\"\n</code></pre>\n\n<p>I have used something similar to the code and it works when i run the Macro because it is tailored to my specific username however not when someone else try's to run the Macro.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1562772194, "post_id": 56973892, "comment_id": 100484056, "body": "I might be mistaken, not understanding your question properly, but would <code>ActiveSheet.Range(&quot;G9&quot;).Value = ActiveSheet.Range(&quot;G9&quot;).Value &amp; I</code> fix it for you? Sidenote, you should avoid <code>ActiveSheet</code>"}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562774936, "post_id": 56973892, "comment_id": 100485589, "body": "@JvdV, I tried using that but (starting at number 105290) it resulted in 10529012345. I can try to explain more clearly, this cell value is currently 105290. I need to it to update continuously as the customer service people print copies. I need the value to go 105290,105291,105292...etc. without them having to change anything manually"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562775024, "post_id": 56973892, "comment_id": 100485644, "body": "So instead of &amp; you can use +"}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562775031, "post_id": 56973892, "comment_id": 100485648, "body": "Could I replace ActiveSheet with the name of the worksheet?"}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1562776131, "post_id": 56973892, "comment_id": 100486215, "body": "Yes: <code>Worksheet(&quot;Sheet name here&quot;).</code>"}, {"owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562777467, "post_id": 56973892, "comment_id": 100486859, "body": "@JvdV, Thank you. Changing it to + 1 instead of &amp; I made it work."}], "owner": {"reputation": 39, "user_id": 11198694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a4dff216cea93ce8764919d2899e2f4d?s=128&d=identicon&r=PG&f=1", "display_name": "Rats", "link": "https://stackoverflow.com/users/11198694/rats"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562772012, "creation_date": 1562772012, "question_id": 56973892, "link": "https://stackoverflow.com/questions/56973892/how-do-i-change-the-starting-value-of-my-autoincremental-code", "title": "How do I change the starting value of my autoincremental code", "body": "<p>I have this code to increment a cell after printing but I don't know how to change the starting value. Right now it starts at 1 but this form was being  used manually for a long time so I need it to start around 105,300</p>\n\n<p>I tried changing the value of the cell (G9) in the line </p>\n\n<pre><code>ActiveSheet.Range(\"G9\").Value = \"\" &amp; I \n</code></pre>\n\n<p>but it always reset. For example I print 3 copies and sequence works. I print 5 more but it reverted back to 105290 as a starting point.</p>\n\n<pre><code>Sub Macro1()\nDim xCount As Variant\nDim xScreen As Boolean\nDim I As Long\nOn Error Resume Next\nLInput:\nxCount = Application.InputBox(\"Please enter the number of copies you want to print:\")\nIf TypeName(xCount) = \"Boolean\" Then Exit Sub\nIf (xCount = \"\") Or (Not IsNumeric(xCount)) Or (xCount &lt; 1) Then\nMsgBox \"error entered, please enter again\", vbInformation\nGoTo LInput\nElse\nxScreen = Application.ScreenUpdating\nApplication.ScreenUpdating = False\nFor I = 1 To xCount\nActiveSheet.Range(\"G9\").Value = \"\" &amp; I\nActiveSheet.PrintOut\nNext\nActiveSheet.Range(\"G9\").UpdateContents\nApplication.ScreenUpdating = xScreen\nEnd If\nEnd Sub\n</code></pre>\n\n<p>I'm looking for this to continually update the cell so the user doesn't have to do this manually.</p>\n"}, {"tags": ["excel", "vba", "jira-rest-api"], "answers": [{"comments": [{"owner": {"reputation": 3653, "user_id": 1302318, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e886030108e8a73b1330db08811f3b15?s=128&d=identicon&r=PG", "display_name": "Eduardo Russo", "link": "https://stackoverflow.com/users/1302318/eduardo-russo"}, "edited": false, "score": 0, "creation_date": 1562847569, "post_id": 56985678, "comment_id": 100512636, "body": "Thanks a lot, @Dmitry. I got the same status code (that makes no sense) and the solution worked perfectly!"}, {"owner": {"reputation": 36, "user_id": 11545863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0878c0b8dda9a997c475302d4044cfef?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/11545863/dmitry"}, "reply_to_user": {"reputation": 3653, "user_id": 1302318, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e886030108e8a73b1330db08811f3b15?s=128&d=identicon&r=PG", "display_name": "Eduardo Russo", "link": "https://stackoverflow.com/users/1302318/eduardo-russo"}, "edited": false, "score": 0, "creation_date": 1617875639, "post_id": 56985678, "comment_id": 118432893, "body": "There is another answer with more explanations <a href=\"https://stackoverflow.com/questions/10046972/msie-returns-status-code-of-1223-for-ajax-request\">here on Stackoverflow</a>"}], "tags": [], "owner": {"reputation": 36, "user_id": 11545863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0878c0b8dda9a997c475302d4044cfef?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/11545863/dmitry"}, "is_accepted": true, "score": 1, "last_activity_date": 1562836398, "creation_date": 1562836398, "answer_id": 56985678, "question_id": 56973889, "link": "https://stackoverflow.com/questions/56973889/excel-vba-msxml2-xmlhttp60-put-request-fail-on-send-action/56985678#56985678", "title": "Excel VBA MSXML2.XMLHTTP60 PUT request fail on &quot;send&quot; action", "body": "<p>I am doing the same thing right now, and I've figured out, that updating an issue requers async connection:</p>\n\n<pre><code>JiraService.Open \"PUT\", URL, True\n</code></pre>\n\n<p>In that case</p>\n\n<pre><code>JiraService.send data\n</code></pre>\n\n<p>will be succesful, but <code>JiraService.status</code> returns 1223! However, an issue field will be updated...</p>\n\n<p>There is a discussion with the same \"problem\" with MSXML2.XMLHTTP60 and it seems, 1223 code is a kind of \"success code\":\n<a href=\"https://social.msdn.microsoft.com/Forums/en-US/c4911cd8-caba-4c25-b71c-fe2e1a7ef8be/update-sharepoint-list-metadata-using-rest-from-vba-using-msxml2xmlhttp60\" rel=\"nofollow noreferrer\">https://social.msdn.microsoft.com/Forums/en-US/c4911cd8-caba-4c25-b71c-fe2e1a7ef8be/update-sharepoint-list-metadata-using-rest-from-vba-using-msxml2xmlhttp60</a></p>\n"}], "owner": {"reputation": 3653, "user_id": 1302318, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e886030108e8a73b1330db08811f3b15?s=128&d=identicon&r=PG", "display_name": "Eduardo Russo", "link": "https://stackoverflow.com/users/1302318/eduardo-russo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 1, "accepted_answer_id": 56985678, "answer_count": 1, "score": 1, "last_activity_date": 1562836398, "creation_date": 1562772002, "last_edit_date": 1562773611, "question_id": 56973889, "link": "https://stackoverflow.com/questions/56973889/excel-vba-msxml2-xmlhttp60-put-request-fail-on-send-action", "title": "Excel VBA MSXML2.XMLHTTP60 PUT request fail on &quot;send&quot; action", "body": "<p>I'm creating an integration with Jira on Excel using VBA.</p>\n\n<p>I'm able to login securely (using <code>POST</code>) and retrieve Jira issues (using <code>GET</code>) using Jira's API.</p>\n\n<p>Now I'm trying to update issues, and the HTTP verb on Jira's API is <code>GET</code>. This shouldn't be a problem, but the fact is I can't even make the request.</p>\n\n<p>Here's my current code - it's based on the <code>POST</code> code, but I'm not sure if I'm missing some other params.</p>\n\n<p><em>I'm omitting some variable declarations - this is not the issue!</em></p>\n\n<pre><code>Public JiraService As New MSXML2.XMLHTTP60\nJiraDataUrl = \"https://atlassian.XXXXXXXX.com/jira/rest/api/2/issue/\" &amp; JiraId\nbody = \"{\"\"fields\"\" : {\"\"customfield_13800\"\":\"\"2011-10-03\"\"}}\"\n\nCall JiraLogin(user, pass) 'This calls another Sub that log into Jira\n\nJiraService.Open \"PUT\", JiraDataUrl, False\nJiraService.setRequestHeader \"Content-Type\", \"application/json\"\nJiraService.setRequestHeader \"Accept\", \"application/json\"\nJiraService.setRequestHeader \"X-Atlassian-Token:\", \"nocheck\"\nJiraService.send body\n\njsonText = JiraService.responseText\nsStatus = JiraService.Status\n</code></pre>\n\n<p>When I run the script, it's interrupted by excel with the following messages:</p>\n\n<p><a href=\"https://i.stack.imgur.com/u8Wmd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u8Wmd.png\" alt=\"First alert\"></a></p>\n\n<p>I click on <code>Debug</code> and the <code>JiraService.send body</code> part is marked on the code</p>\n\n<p><a href=\"https://i.stack.imgur.com/xIhx5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/xIhx5.png\" alt=\"Marked area on the code\"></a></p>\n\n<p>If I click on play, I get the final error (<code>This method cannot be called after the send method has been called</code>), that doesn't make any sense to me:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gfwra.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gfwra.png\" alt=\"This methodcannot\"></a></p>\n\n<p>If I replace <code>PUT</code> for <code>POST</code> it runs normally, but Jira API returns with 405 HTTP error - as the method I'm trying to use requires a PUT.</p>\n\n<p>Any idea on what am I doing wrong in this code?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1562772237, "post_id": 56973845, "comment_id": 100484080, "body": "Try changing to <code>.DataBodyRange.Offset(1).Resize(.DataBodyRange.Rows.Count - 1).Rows.Clear</code>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 11664678, "user_type": "registered", "profile_image": "https://graph.facebook.com/2662731147104257/picture?type=large", "display_name": "Chris Lafky", "link": "https://stackoverflow.com/users/11664678/chris-lafky"}, "edited": false, "score": 1, "creation_date": 1562774512, "post_id": 56974211, "comment_id": 100485374, "body": "worked flawlessly thank you so much! What is the best way to check if a table has an empty row at the bottom? Since I have to leave the tables with one row, then when I repopulate it, there is still a blank row in the table as my function that I repopulate it with adds a new row every time you add an item to the table. However if my function checked first to see if there was an empty row and if so used that, then if not made a new one for the values that would be way better but I have not been able to figure out what the best path is to do that"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 13, "user_id": 11664678, "user_type": "registered", "profile_image": "https://graph.facebook.com/2662731147104257/picture?type=large", "display_name": "Chris Lafky", "link": "https://stackoverflow.com/users/11664678/chris-lafky"}, "edited": false, "score": 0, "creation_date": 1562775845, "post_id": 56974211, "comment_id": 100486080, "body": "I think a table must always have at least one row. You can reference the first cell using <code>ActiveSheet.ListObjects(1).DataBodyRange(1, 1).Value = 4</code>."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 0, "last_activity_date": 1562773157, "creation_date": 1562773157, "answer_id": 56974211, "question_id": 56973845, "link": "https://stackoverflow.com/questions/56973845/making-list-reset-subroutine-not-delete-totals-row-or-the-formulas-it-contains/56974211#56974211", "title": "Making list reset subroutine not delete totals row or the formulas it contains", "body": "<p>You might also want to incorporate a check that the Total row is showing:</p>\n\n<pre><code>Sub ListReset(lst As ListObject)        ''clears a listobject while leaving one empty row and formulas\n\nOn Error Resume Next\n\nWith lst\n    If .ShowAutoFilter Then .AutoFilter.ShowAllData\n    If .DataBodyRange.Rows.Count = 1 Then Exit Sub ' Table is already clear\n    If .ShowTotals Then\n        .DataBodyRange.Offset(1).Resize(.DataBodyRange.Rows.Count - 1).Rows.Clear\n    Else\n        .DataBodyRange.Offset(1).Rows.Clear\n    End If\n    If .DataBodyRange.Columns.Count &gt; 1 Then ' Check to see if SpecialCells is going to evaluate just one cell.\n        .DataBodyRange.Rows(1).SpecialCells(xlCellTypeConstants).ClearContents\n    ElseIf Not .Range.HasFormula Then   ' Only one cell in range and it does not contain a formula.\n        .DataBodyRange.Rows(1).ClearContents\n    End If\n    .Resize .Range.Rows(\"1:2\")\n    .HeaderRowRange.Offset(1).Select        ' Reset used range on the sheet\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 11664678, "user_type": "registered", "profile_image": "https://graph.facebook.com/2662731147104257/picture?type=large", "display_name": "Chris Lafky", "link": "https://stackoverflow.com/users/11664678/chris-lafky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 56974211, "answer_count": 1, "score": 0, "last_activity_date": 1562773157, "creation_date": 1562771829, "question_id": 56973845, "link": "https://stackoverflow.com/questions/56973845/making-list-reset-subroutine-not-delete-totals-row-or-the-formulas-it-contains", "title": "Making list reset subroutine not delete totals row or the formulas it contains", "body": "<p>So I got the pretty snazzy piece of code below off of this forum and modified it slightly. It is perfect in that it deletes all rows of table but one, and leaves that one row with no values but all the formulas it previously contained. However, it also deletes the totals row which I need to stay in place with all of it's formulas. </p>\n\n<p>Nothing that I have tried has done anything except make this code not do the other half of its job right which is to clear the table. </p>\n\n<pre><code>Sub ListReset(lst As ListObject)        ''clears a listobject while leaving one empty row and formulas\nOn Error Resume Next\nWith lst\n  If .ShowAutoFilter Then .AutoFilter.ShowAllData\n  If .DataBodyRange.Rows.Count = 1 Then Exit Sub ' Table is already clear\n    .DataBodyRange.Offset(1).Rows.Clear\n  If .DataBodyRange.Columns.Count &gt; 1 Then ' Check to see if SpecialCells is going to evaluate just one cell.\n    .DataBodyRange.Rows(1).SpecialCells(xlCellTypeConstants).ClearContents\n  ElseIf Not .Range.HasFormula Then   ' Only one cell in range and it does not contain a formula.\n    .DataBodyRange.Rows(1).ClearContents\n  End If\n\n  .Resize .Range.Rows(\"1:2\")\n  .HeaderRowRange.Offset(1).Select        ' Reset used range on the sheet\n        Dim X\n        X = .Range.Worksheet.UsedRange.Rows.Count\nEnd With\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562771934, "post_id": 56973749, "comment_id": 100483898, "body": "<code>Range(&quot;U12:U&quot; &amp; DefDestLastRow)</code> ends where you are starting the paste if I understand correctly?"}, {"owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562772324, "post_id": 56973749, "comment_id": 100484136, "body": "@SJR <code>Range(&quot;L&quot; &amp; DefDestLastRow)</code> should be the end of the copy/pasting"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1562772648, "post_id": 56973749, "comment_id": 100484307, "body": "What I was getting at is as per AAA&#39;s answer."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "edited": false, "score": 0, "creation_date": 1562775333, "post_id": 56974036, "comment_id": 100485810, "body": "one quick question: this works if the pasted data is always from &quot;U12&quot; cell down. How do I make it so that it always makes the value of column U = 30 for ONLY the rows that are pasted, no matter where they are outputted?"}], "tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 2, "last_activity_date": 1562779384, "last_edit_date": 1562779384, "creation_date": 1562772550, "answer_id": 56974036, "question_id": 56973749, "link": "https://stackoverflow.com/questions/56973749/set-value-of-entire-column-in-respect-to-copied-data/56974036#56974036", "title": "Set value of entire column in respect to copied data", "body": "<p>You have to recalculate the last row. Recall that the last time you calculated it was to get the offset <em>before you pasted anything</em>. So replace your last line with this:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>NewLastRow = wsDest.Cells(wsDest.Rows.Count, 4).End(xlUp).Row\nwsDest.Range(\"U\" &amp; DefDestLastRow &amp; \":U\" &amp; NewLastRow).Value = 30\n</code></pre>\n\n<p><strong>Your amended code:</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub InsertData()\n\nDim wsCopy As Worksheet, wsDest As Worksheet\nDim DefCopyLastRow As Long, DefDestLastRow As Long, NewLastRow As Long\n\n\n'Set variables for copy and destination sheets\nSet wsCopy = Workbooks(\"Warranty Template.xlsm\").Worksheets(\"PivotTable\")\nSet wsDest = Workbooks(\"QA Matrix Template.xlsm\").Worksheets(\"Plant Sheet\")\n\n'1. Find last used row in the copy range based on data in column A\nDefCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, 1).End(xlUp).Offset(-1, 0).Row\n\n'2. Find first blank row in the destination range based on data in column D\n'Offset property moves down 1 row\nDefDestLastRow = wsDest.Cells(wsDest.Rows.Count, 4).End(xlUp).Offset(1, 0).Row\n\n\n'3. Copy &amp; Paste Data\nwsCopy.Range(\"A5:B\" &amp; DefCopyLastRow).Copy _\nwsDest.Range(\"D\" &amp; DefDestLastRow)\n\nwsCopy.Range(\"B5:B\" &amp; DefCopyLastRow).Copy _\nwsDest.Range(\"F\" &amp; DefDestLastRow)\n\nwsCopy.Range(\"D5:D\" &amp; DefCopyLastRow).Copy _\nwsDest.Range(\"I\" &amp; DefDestLastRow)\n\nwsCopy.Range(\"E5:E\" &amp; DefCopyLastRow).Copy _\nwsDest.Range(\"L\" &amp; DefDestLastRow)\n\nNewLastRow = wsDest.Cells(wsDest.Rows.Count, 4).End(xlUp).Row\nwsDest.Range(\"U\" &amp; DefDestLastRow &amp; \":U\" &amp; NewLastRow).Value = 30\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 56974036, "answer_count": 1, "score": 0, "last_activity_date": 1562779384, "creation_date": 1562771493, "question_id": 56973749, "link": "https://stackoverflow.com/questions/56973749/set-value-of-entire-column-in-respect-to-copied-data", "title": "Set value of entire column in respect to copied data", "body": "<p>I have a macro that copies data from one workbook and outputs it into a table in another workbook. I just need the value of column \"U\" in correspondence to the copied rows to have a set value of \"30\". I would like to have this code written at the end of the copy/paste code so that it all works together in one sub.</p>\n\n<p>Code for the copying/pasting:</p>\n\n<pre><code>Sub InsertData()\n\nDim wsCopy As Worksheet, wsDest As Worksheet\nDim DefCopyLastRow As Long, DefDestLastRow As Long\n\n\n'Set variables for copy and destination sheets\nSet wsCopy = Workbooks(\"Warranty Template.xlsm\").Worksheets(\"PivotTable\")\nSet wsDest = Workbooks(\"QA Matrix Template.xlsm\").Worksheets(\"Plant Sheet\")\n\n'1. Find last used row in the copy range based on data in column A\nDefCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, 1).End(xlUp).Offset(-1, 0).Row\n\n\n\n'2. Find first blank row in the destination range based on data in column D\n'Offset property moves down 1 row\nDefDestLastRow = wsDest.Cells(wsDest.Rows.Count, 4).End(xlUp).Offset(1, 0).Row\n\n\n\n'3. Copy &amp; Paste Data\nwsCopy.Range(\"A5:A\" &amp; DefCopyLastRow).Copy _\nwsDest.Range(\"D\" &amp; DefDestLastRow)\n\nwsCopy.Range(\"B5:B\" &amp; DefCopyLastRow).Copy _\nwsDest.Range(\"E\" &amp; DefDestLastRow)\n\nwsCopy.Range(\"B5:B\" &amp; DefCopyLastRow).Copy _\nwsDest.Range(\"F\" &amp; DefDestLastRow)\n\nwsCopy.Range(\"D5:D\" &amp; DefCopyLastRow).Copy _\nwsDest.Range(\"I\" &amp; DefDestLastRow)\n\nwsCopy.Range(\"E5:E\" &amp; DefCopyLastRow).Copy _\nwsDest.Range(\"L\" &amp; DefDestLastRow)\n\nwsDest.Range(\"U12:U\" &amp; DefDestLastRow).Value = 30\nEnd Sub\n</code></pre>\n\n<p>I tried adding the last line before the \"End Sub\" but that doesn't seem to do the trick...</p>\n\n<p>Picture of outputted data in table:\n<a href=\"https://i.stack.imgur.com/SPvxL.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SPvxL.png\" alt=\"\"></a></p>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1562773783, "post_id": 56973832, "comment_id": 100484972, "body": "Sorry a little confused. You say to use the code you have for the On Load event but you have your code setup as using the BeforeUpdate event? Or are you saying to call the BeforeUpdate event from an OnLoad event?"}, {"owner": {"reputation": 62, "user_id": 11673304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368dcb9a50d5cfc7e27d6fc730d77684?s=128&d=identicon&r=PG&f=1", "display_name": "tmsdajpa", "link": "https://stackoverflow.com/users/11673304/tmsdajpa"}, "reply_to_user": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1562776419, "post_id": 56973832, "comment_id": 100486363, "body": "Sorry about that. For your case, it should be BeforeInsert. I just tested this and it works. You can also delete the IF statement. I&#39;ll update the code."}, {"owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "edited": false, "score": 0, "creation_date": 1562777071, "post_id": 56973832, "comment_id": 100486663, "body": "Got ya! Thanks for the help that cleared it up and I&#39;ve got it working!"}], "tags": [], "owner": {"reputation": 62, "user_id": 11673304, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/368dcb9a50d5cfc7e27d6fc730d77684?s=128&d=identicon&r=PG&f=1", "display_name": "tmsdajpa", "link": "https://stackoverflow.com/users/11673304/tmsdajpa"}, "is_accepted": true, "score": 1, "last_activity_date": 1562777376, "last_edit_date": 1562777376, "creation_date": 1562771796, "answer_id": 56973832, "question_id": 56973425, "link": "https://stackoverflow.com/questions/56973425/adding-computer-name-or-user-id-to-new-record-in-access/56973832#56973832", "title": "Adding Computer name or User ID to new record in Access", "body": "<p>I worked on something similar a few days ago and started using the fields like you. I found a solution similar to the macro that you have.</p>\n\n<p>Create a macro event for the form's BeforeInsert property. Use the below code for the macro and update to fit your needs.</p>\n\n<pre><code>Private Sub Form_BeforeInsert(Cancel As Integer)\nDim Owner As String\nOwner = Environ(\"COMPUTERNAME\")\n\n            Me!AddedBy= Owner\nEnd Sub\n</code></pre>\n\n<p>EDIT\nRegarding the error that you're receiving, I'm not sure if this will help, but try defining Owner as</p>\n\n<pre><code>Dim wshNet As String\n\n Set wshNet = Environ(\"COMPUTERNAME\")\n</code></pre>\n"}], "owner": {"reputation": 379, "user_id": 6938883, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-bdjuVYp20PI/AAAAAAAAAAI/AAAAAAAAABc/AMGnlX-TW38/photo.jpg?sz=128", "display_name": "Deke", "link": "https://stackoverflow.com/users/6938883/deke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 363, "favorite_count": 0, "accepted_answer_id": 56973832, "answer_count": 1, "score": 0, "last_activity_date": 1594639434, "creation_date": 1562770480, "last_edit_date": 1594639434, "question_id": 56973425, "link": "https://stackoverflow.com/questions/56973425/adding-computer-name-or-user-id-to-new-record-in-access", "title": "Adding Computer name or User ID to new record in Access", "body": "<p>I'm attempting to setup a simple function to add the computer name of the person who adds a record into an access database. For example if user on computer 12345 creates a new record into table tblTasks then in the field \"Owner\" it would put that persons computer name.</p>\n\n<p>The way I'm going about this currently (And not sure it's the best way) is, on the form under the field \"Owner\" I have set the Default value to =owner and I have created the following function:</p>\n\n<pre><code>Function Owner()\n Dim cdb As DAO.Database, rst As DAO.Recordset\n Dim wshNet As Object\n\n Set wshNet = CreateObject(\"Wscript.Network\")\n Set cdb = CurrentDb\n Set rst = cdb.OpenRecordset(\"SELECT * FROM tblTasks\", dbOpenDynaset)\n rst.AddNew\n rst!Owner = wshNet.Computername\n rst.Update '&lt;---- Error starts here\n Set wshNet = Nothing\nEnd Function\n</code></pre>\n\n<p>I'm getting the following error when creating a new record:</p>\n\n<p><a href=\"https://i.stack.imgur.com/gLJli.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gLJli.png\" alt=\"error message\"></a></p>\n\n<p>I know part of the issue is to do with a validation rule I created not allowing a record to be created without a Task Name but I want to keep that in place.</p>\n\n<p>I'm thinking the issue of the \"Owner\" field giving an #Error is also to do with the fact that instead of using a button action to create a record I am keeping the ability to just add from the bottom of the record. Which I'd also like to keep in tact.</p>\n\n<p>Any help or advice would be greatly appreciated!</p>\n\n<p>Thanks!!\n-Deke</p>\n"}, {"tags": ["sql", "excel", "vba", "loops"], "comments": [{"owner": {"reputation": 10803, "user_id": 2548147, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cfKie.jpg?s=128&g=1", "display_name": "Raymond Nijland", "link": "https://stackoverflow.com/users/2548147/raymond-nijland"}, "edited": false, "score": 0, "creation_date": 1562770986, "post_id": 56973409, "comment_id": 100483337, "body": "<i>&quot;Basically, I would like to loop through ~100 or so rows then insert. Then loop through the next hundred rows and insert. &quot;</i> Using a Transaction also might speed things up and COMMIT after that number of records.."}], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": false, "score": 0, "last_activity_date": 1562832673, "creation_date": 1562832673, "answer_id": 56984515, "question_id": 56973409, "link": "https://stackoverflow.com/questions/56973409/slow-running-loop-looking-to-find-way-to-execute-multiple-records-per-execute/56984515#56984515", "title": "Slow running Loop. Looking to find way to execute multiple records per execute", "body": "<p>Tried your code with makeshift table in local SQL Server 2005 and found taking only 10 seconds for around 5000 records. In your case the delay may be due to Database Size, network speed etc. </p>\n\n<p>However after trying it with code to insert 100 records at a time the same time reduced to 1 odd second only.</p>\n\n<pre><code>Sub test2()\nDim conn As New ADODB.Connection\nDim LastRow As Long, LastCol As Long, iRowNo As Long, DataArr As Variant\nDim SqStr As String, ValStr As String, Rw As Long, Cl As Long\nDim Ws As Worksheet, tm As Double\ntm = Timer\n\nconn.Open \"Provider=SQLOLEDB.1;Integrated Security=SSPI;Persist Security Info=True;;Initial Catalog=test;Data Source=USER-PC\\SQLEXPRESS\"\nconn.Execute \"Delete FROM dbo.Test\"\n\nSet Ws = ThisWorkbook.Worksheets(\"Sheet1\")\niRowNo = 4\nLastRow = Ws.Range(\"C\" &amp; Rows.Count).End(xlUp).Row\nDataArr = Ws.Range(\"A\" &amp; iRowNo &amp; \":S\" &amp; LastRow)\nLastCol = UBound(DataArr, 2)\n\nSqStr = \"insert into dbo.Test (ID,STATUS,DATE,CHANNEL,ISSUE,QTY,LOB,[DESC],[IN],JN,[IS],PRIME,IU,TR,AU,RRSC,OA,OUTAGES,MEETINGS) \"\n'Sqlstr=Sqlstr &amp; \" Values \"  'May use for Sql Server 2008 and above\n\n    For Rw = 1 To UBound(DataArr, 1)\n    DataArr(Rw, 1) = Replace(DataArr(Rw, 1), \"'\", \"''\")\n    DataArr(Rw, 8) = Replace(DataArr(Rw, 8), \"'\", \"''\")\n    DataArr(Rw, 13) = Replace(DataArr(Rw, 13), \"'\", \"''\")\n    'ValStr = ValStr &amp; \"('\"   'May use for Sql Server 2008 and above\n    ValStr = ValStr &amp; \"Select '\"\n        For Cl = 1 To UBound(DataArr, 2)\n        'ValStr = ValStr &amp; DataArr(Rw, Cl) &amp; IIf(Cl &lt; LastCol, \"','\", \"')\")  'May use for Sql Server 2008 and above\n        ValStr = ValStr &amp; DataArr(Rw, Cl) &amp; IIf(Cl &lt; LastCol, \"','\", \"'\")   ' Used for test in Sql Server 2005\n        Next Cl\n\n        If Rw Mod 100 = 0 Then  ' exceute at 100 records\n        ValStr = SqStr &amp; ValStr\n        conn.Execute ValStr\n        DoEvents\n        ValStr = \"\"\n        Debug.Print Rw, Timer - tm\n        Else\n            If Rw &lt; UBound(DataArr, 1) Then\n            'ValStr = ValStr &amp; \", \"  'Modify Comma / Space between datasets of two rows according Sql version Syntax\n            ValStr = ValStr &amp; \" UNION ALL \"  'Used for test with Sql Server 2005.\n            End If\n        End If\n    Next Rw\n\n    If Rw Mod 100 &gt; 0 Then\n    ValStr = SqStr &amp; ValStr\n    conn.Execute ValStr\n    DoEvents\n    ValStr = \"\"\n    Debug.Print Rw, Timer - tm\n    End If\n\n\nDebug.Print \"Total Seconds Taken: \" &amp; Timer - tm\nEnd Sub\n</code></pre>\n\n<p>The INSERT SQl syntax along with connection string etc may please be modified for the type &amp; version used by you along with suggestion in @Raymond Nijland's comment.</p>\n"}], "owner": {"reputation": 3, "user_id": 11765632, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eH8x17ZYim0/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfMpco5qHq7n7SNXUeCQ2len40GBw/photo.jpg?sz=128", "display_name": "Matt Oliver", "link": "https://stackoverflow.com/users/11765632/matt-oliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1562832673, "creation_date": 1562770441, "question_id": 56973409, "link": "https://stackoverflow.com/questions/56973409/slow-running-loop-looking-to-find-way-to-execute-multiple-records-per-execute", "title": "Slow running Loop. Looking to find way to execute multiple records per execute", "body": "<p>I have an excel workbook that contains about 5,000 rows of data.  I have two buttons mapped to macros. One button will delete all data in the table, and reinsert it from the Excel Workbook, and the other will only insert the 'new' rows based on a unique ID. </p>\n\n<p>I am finding that both of these buttons are taking a long time to run. ~10-15 minutes.  Right now, it is performing the insert for every row, but I am looking to combine this.  </p>\n\n<p>Basically, I would like to loop through ~100 or so rows then insert. Then loop through the next hundred rows and insert. </p>\n\n<p>Any suggestions would be greatly appreciated. VBA / Coding in general is not my forte and i'm pulling a brick wall on this one. </p>\n\n<p>Thanks!</p>\n\n<pre><code>Sub Rebuild_Click()\n\n' ***********************\n' ** Declare Variables **\n' ***********************\n    Dim conn As New ADODB.Connection\n    Dim iRowNo As Integer\n    Dim sSTATUS, sCHANNEL, sISSUE, sLOB, sDESC, sIN, sJN, sIS, sPRIME, sIU, sTR, sAU As String\n    Dim answer, sQTY, sRRSC, sOA, sMeetings, sOutages As Integer\n    Dim sDATE As Date\n    With Sheets(\"OASYS ADMIN TRACKER\")\n\n' ****************************\n' ** Show Information Popup **\n' ****************************\n        answer = MsgBox(\"You are about to update the database with ~5,000 records.\" &amp; vbCrLf &amp; \"\" &amp; vbCrLf &amp; \"This will take approximately 5 minutes.\" &amp; vbCrLf &amp; \"\" &amp; vbCrLf &amp; \"If you wish to continue, please press Yes. Otherwise, Press No\" &amp; vbCrLf &amp; \"\" &amp; vbCrLf &amp; \"----------\" &amp; vbCrLf &amp; \"EXCEL IS NOT FROZEN.\" &amp; vbCrLf &amp; \"\" &amp; vbCrLf &amp; \"****DO NOT CLOSE EXCEL ****\", vbYesNo + vbQuestion, \"Update Database\")\n\n' ***********************\n' ** Open IF Statement **\n' ***********************\n        If answer = vbYes Then\n\n            ' ***********************\n            ' ** Connection String **\n            ' ***********************\n                conn.Open \"Provider=SQLNCLI11;Password=XXXXX;User ID=XXXXX;Initial Catalog=SupportAdmin;Data Source=tcp:XXXXX;\"\n\n            ' *************************\n            ' ** Purge Existing Data **\n            ' *************************\n                conn.Execute \"Delete FROM dbo.TestDB\"\n\n            ' *********************\n            ' ** Skip Leader Row **\n            ' *********************\n                iRowNo = 4\n\n            ' ************************\n            ' ** Begin Dataset Loop **\n            ' ************************\n                Do Until .Cells(iRowNo, 3) = \"\"\n                    sID = .Cells(iRowNo, 1)\n                    sSTATUS = .Cells(iRowNo, 2)\n                    sDATE = .Cells(iRowNo, 3)\n                    sCHANNEL = .Cells(iRowNo, 4)\n                    sISSUE = .Cells(iRowNo, 5)\n                    sQTY = .Cells(iRowNo, 6)\n                    sLOB = .Cells(iRowNo, 7)\n                    sDESC = .Cells(iRowNo, 8)\n                    sIN = .Cells(iRowNo, 9)\n                    sJN = .Cells(iRowNo, 10)\n                    sIS = .Cells(iRowNo, 11)\n                    sPRIME = .Cells(iRowNo, 12)\n                    sIU = .Cells(iRowNo, 13)\n                    sTR = .Cells(iRowNo, 14)\n                    sAU = .Cells(iRowNo, 15)\n                    sRRSC = .Cells(iRowNo, 16)\n                    sOA = .Cells(iRowNo, 17)\n                    sOutages = .Cells(iRowNo, 18)\n                    sMeetings = .Cells(iRowNo, 19)\n\n            ' ***********************\n            ' ** Replace ' in Data **\n            ' ***********************\n                sDESC = Replace(sDESC, \"'\", \"''\")\n                sIS = Replace(sIS, \"'\", \"''\")\n                sIU = Replace(sIU, \"'\", \"''\")\n\n            ' *****************\n            ' ** Execute SQL **\n            ' *****************\n                conn.Execute \"insert into dbo.TestDB (ID,STATUS,DATE,CHANNEL,ISSUE,QTY,LOB,[DESC],[IN],JN,[IS],PRIME,IU,TR,AU,RRSC,OA,OUTAGES,MEETINGS) \" &amp; _\n                             \"values ('\" &amp; sID &amp; \"','\" &amp; sSTATUS &amp; \"', '\" &amp; sDATE &amp; \"','\" &amp; sCHANNEL &amp; \"', '\" &amp; sISSUE &amp; \"', '\" &amp; sQTY &amp; \"', '\" &amp; sLOB &amp; \"', '\" &amp; sDESC &amp; \"', '\" &amp; sIN &amp; \"', '\" &amp; sJN &amp; \"', '\" &amp; sIS &amp; \"', '\" &amp; sPRIME &amp; \"', '\" &amp; sIU &amp; \"', '\" &amp; sTR &amp; \"', '\" &amp; sAU &amp; \"', '\" &amp; sRRSC &amp; \"', '\" &amp; sOA &amp; \"', '\" &amp; sOutages &amp; \"', '\" &amp; sMeetings &amp; \"')\"\n\n                iRowNo = iRowNo + 1\n             Loop\n\n' ****************************\n' ** Show Information Popup **\n' ****************************\n        MsgBox \"Database Update Complete!\"\n\n' *****************************\n' ** Close Connection String **\n' *****************************\n        conn.Close\n        Set conn = Nothing\n\n' ****************************\n' ** Close IF Statement **\n' ****************************\n        Else\n           ' do nothing\n     End If\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1562771792, "post_id": 56973369, "comment_id": 100483820, "body": "In general, you want to <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using <code>Select</code></a> in your code."}, {"owner": {"reputation": 336, "user_id": 10682216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4F8q_K4bBgc/AAAAAAAAAAI/AAAAAAAAAIA/thmq675Svfo/photo.jpg?sz=128", "display_name": "Jacob", "link": "https://stackoverflow.com/users/10682216/jacob"}, "reply_to_user": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 0, "creation_date": 1562771867, "post_id": 56973369, "comment_id": 100483863, "body": "Then do you have a suggestion on how to TextToColumns without selecting the A column?"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1562775267, "post_id": 56973369, "comment_id": 100485777, "body": "For the previous comment, this should work: Range(&quot;A:A&quot;).TextToColumns args"}, {"owner": {"reputation": 336, "user_id": 10682216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4F8q_K4bBgc/AAAAAAAAAAI/AAAAAAAAAIA/thmq675Svfo/photo.jpg?sz=128", "display_name": "Jacob", "link": "https://stackoverflow.com/users/10682216/jacob"}, "edited": false, "score": 0, "creation_date": 1562781776, "post_id": 56973369, "comment_id": 100488726, "body": "Even taking on the Select it is still having the same problem"}], "answers": [{"tags": [], "owner": {"reputation": 336, "user_id": 10682216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4F8q_K4bBgc/AAAAAAAAAAI/AAAAAAAAAIA/thmq675Svfo/photo.jpg?sz=128", "display_name": "Jacob", "link": "https://stackoverflow.com/users/10682216/jacob"}, "is_accepted": true, "score": 0, "last_activity_date": 1562782376, "creation_date": 1562782376, "answer_id": 56976429, "question_id": 56973369, "link": "https://stackoverflow.com/questions/56973369/macro-works-with-step-through-but-not-using-hotkey/56976429#56976429", "title": "Macro works with step through but not using hotkey", "body": "<p>Figured it out. It was because I was using the Shift key in the hotkey for the macro which was causing problems with the <code>Workbooks.Open</code>command.</p>\n"}], "owner": {"reputation": 336, "user_id": 10682216, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4F8q_K4bBgc/AAAAAAAAAAI/AAAAAAAAAIA/thmq675Svfo/photo.jpg?sz=128", "display_name": "Jacob", "link": "https://stackoverflow.com/users/10682216/jacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 56976429, "answer_count": 1, "score": 0, "last_activity_date": 1562782376, "creation_date": 1562770323, "question_id": 56973369, "link": "https://stackoverflow.com/questions/56973369/macro-works-with-step-through-but-not-using-hotkey", "title": "Macro works with step through but not using hotkey", "body": "<p>I have a relatively simple macro. It takes in a user selected text file and uses fixed width delimiters to cut it into columns that are always the same. My problem is that when I run my macro the selected file will open, however it doesn't perform the text-to-columns. </p>\n\n<p>It will perform this whenever you step-through the macro. It also works when you use the macro on the same file twice in a row.  </p>\n\n<pre><code>Sub Historical()\n\nWith Application.FileDialog(msoFileDialogFilePicker)\n        'Only one file\n        .AllowMultiSelect = False\n        'Add filters\n        .Filters.Add \"All\", \"*.*\"\n        'Show the dialog box\n        .Show\n\n        'Store in fullpath variable\n        fullpath = .SelectedItems.Item(1)\nEnd With\n\nDim WrkBk As Workbook\nDim WrkSht As Worksheet\nDim sheetname As String\n\nSet WrkBk = Workbooks.Open(fullpath)\n\n'Code stops here. The file will open but nothing below happens. I tried adding a wait.\nApplication.Wait (Now + TimeValue(\"0:00:02\"))\n\nColumns(\"A:A\").Select\n\nSelection.TextToColumns Destination:=Range(\"A1\"), DataType:=xlFixedWidth, _\n        FieldInfo:=Array(Array(0, 9), Array(14, 1), Array(17, 9), Array(18, 1), Array(23, 9), _\n        Array(24, 1), Array(30, 1), Array(62, 1), Array(72, 1), Array(84, 1), Array(94, 1), Array( _\n        118, 1)), TrailingMinusNumbers:=True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "edited": false, "score": 0, "creation_date": 1562771010, "post_id": 56973269, "comment_id": 100483350, "body": "Could you add a sample of your pivot table? I would guess that <code>.PivotItems(&quot;0&quot;)</code> is not a valid reference. If you are trying to do it based on the first item then the index starts at 1, not 0."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "edited": false, "score": 0, "creation_date": 1562771650, "post_id": 56973753, "comment_id": 100483739, "body": "Thank you so much"}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "reply_to_user": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "edited": false, "score": 1, "creation_date": 1562771796, "post_id": 56973753, "comment_id": 100483826, "body": "Glad it worked! Also note, since it is it&#39;s index I would also have it as a number vs a string. I did that in my example but forgot to mention it. Cheers!"}], "tags": [], "owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "is_accepted": true, "score": 1, "last_activity_date": 1562771512, "creation_date": 1562771512, "answer_id": 56973753, "question_id": 56973269, "link": "https://stackoverflow.com/questions/56973269/i-am-trying-to-add-in-a-pivot-filter-field-but-i-dont-know-what-is-wrong-with-m/56973753#56973753", "title": "I am trying to add in a pivot filter field but I don&#39;t know what is wrong with my code", "body": "<p>Looks to me like you are attempting to get the first <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.pivotitem\" rel=\"nofollow noreferrer\">PivotItem</a> within the collection.</p>\n\n<p>The index for a <code>PivotItem</code> Object starts at <code>1</code>. You are attempting to access the <code>0</code> index. Change that and see if that works.</p>\n\n<pre><code>With ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(sField)\n  .PivotItems(1).Visible = False\n  .PivotItems(2).Visible = True\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 11368587, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-u_ZmxO7n6NU/AAAAAAAAAAI/AAAAAAAAABQ/hmamE9F7q9s/photo.jpg?sz=128", "display_name": "Phiking", "link": "https://stackoverflow.com/users/11368587/phiking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 56973753, "answer_count": 1, "score": 1, "last_activity_date": 1562771512, "creation_date": 1562770026, "last_edit_date": 1562770775, "question_id": 56973269, "link": "https://stackoverflow.com/questions/56973269/i-am-trying-to-add-in-a-pivot-filter-field-but-i-dont-know-what-is-wrong-with-m", "title": "I am trying to add in a pivot filter field but I don&#39;t know what is wrong with my code", "body": "<p>I am trying to select a filter on my pivot table and I don't know why it not reading my code right. </p>\n\n<p>It is saying \"Unable to get the PivotItems property of the PivotField Class\"</p>\n\n<pre><code>Sub Filter_MasterCode()\n\n    Dim pt As PivotTable\n    Dim pf As PivotField\n    Dim sField As String\n\n    Set pt = ActiveSheet.PivotTables(\"PivotTable3\")\n    sField = ActiveSheet.Shapes(Application.Caller).TextFrame.Characters.Text\n\n    For Each pf In pt.PageFields\n        If pf.Name &lt;&gt; \"Values\" Then\n            pf.Orientation = xlHidden\n        End If\n    Next pf\n\n    For Each pf In pt.DataFields\n        If pf.Name &lt;&gt; \"Values\" Then\n            pf.Orientation = xlHidden\n        End If\n    Next pf\n\n    pt.PivotFields(sField).Orientation = xlPageField\n\n    With ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(sField)\n      .PivotItems(\"0\").Visible = False\n      .PivotItems(\"1\").Visible = True\n    End With\n\n    Select Case sField\n        Case Is = \"Apple\"\n          With ActiveSheet.PivotTables(\"PivotTable3\").PivotFields(\"2017\")\n              .Orientation = xlDataField\n          End With\n    End Select\n</code></pre>\n\n<p>It say error at <code>.PivotItems(\"0\").Visible = False</code></p>\n\n<p>Thank you</p>\n"}, {"tags": ["vba", "ms-word", "formatting", "footnotes"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 11765351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3414b8e28ddd38bab4dd6583490596?s=128&d=identicon&r=PG&f=1", "display_name": "Debra", "link": "https://stackoverflow.com/users/11765351/debra"}, "edited": false, "score": 0, "creation_date": 1562771386, "post_id": 56973628, "comment_id": 100483579, "body": "Hi JosephC, thanks for that.  I&#39;ve tried it but I get &quot;Method or data member not found&quot; ; it doesn&#39;t like the oFootNote.Range.Words(oFootNote.Range.  I do appreciate your help though.  Debbie"}, {"owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "reply_to_user": {"reputation": 35, "user_id": 11765351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3414b8e28ddd38bab4dd6583490596?s=128&d=identicon&r=PG&f=1", "display_name": "Debra", "link": "https://stackoverflow.com/users/11765351/debra"}, "edited": false, "score": 0, "creation_date": 1562773273, "post_id": 56973628, "comment_id": 100484671, "body": "Guessing not all foot notes are at least 2 words long?  edited code to check for that.  So it should now only bold last two words if footnote is longer than 2 words."}, {"owner": {"reputation": 35, "user_id": 11765351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3414b8e28ddd38bab4dd6583490596?s=128&d=identicon&r=PG&f=1", "display_name": "Debra", "link": "https://stackoverflow.com/users/11765351/debra"}, "edited": false, "score": 0, "creation_date": 1562773694, "post_id": 56973628, "comment_id": 100484924, "body": "Hi, thanks again but it still doesn&#39;t like oFootNote.Range; I&#39;m guessing it&#39;s because there is no intellisense for Range for oFootNote.  It&#39;s so frustrating I know, I&#39;ve been trying to work this out for a whole day.  Thanks and have a good evening"}], "tags": [], "owner": {"reputation": 703, "user_id": 9914902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570635b78e628529da1527be3f6c87c0?s=128&d=identicon&r=PG&f=1", "display_name": "JosephC", "link": "https://stackoverflow.com/users/9914902/josephc"}, "is_accepted": false, "score": 0, "last_activity_date": 1562773186, "last_edit_date": 1562773186, "creation_date": 1562771103, "answer_id": 56973628, "question_id": 56973200, "link": "https://stackoverflow.com/questions/56973200/how-do-i-make-the-last-two-words-of-each-footnote-bold-using-word-vba/56973628#56973628", "title": "How do I make the last two words of each footnote bold using Word VBA?", "body": "<p>Not super familiar with word objects, but try this.  Worked for my couple of tests.</p>\n\n<p>Basically it loops through all foot notes.  And uses the index of the word to set that word's bold property to true.</p>\n\n<pre><code>Sub Test()\n\n    Dim oFootNote As Footnote\n    Dim oLastIndex As Long\n\n    For Each oFootNote In ActiveDocument.Footnotes\n\n        oLastIndex = oFootNote.Range.Words.Count\n\n        If oLastIndex &gt; 2 Then\n            oFootNote.Range.Words(oLastIndex).Bold = True\n            oFootNote.Range.Words(oLastIndex - 1).Bold = True\n        End If\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 11765351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3414b8e28ddd38bab4dd6583490596?s=128&d=identicon&r=PG&f=1", "display_name": "Debra", "link": "https://stackoverflow.com/users/11765351/debra"}, "edited": false, "score": 0, "creation_date": 1562828844, "post_id": 56977617, "comment_id": 100502144, "body": "Cindy, thank you so much, that works perfectly.  I truly appreciate you explaining your code too.  Have a great day!"}], "tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 1, "last_activity_date": 1562787756, "creation_date": 1562787756, "answer_id": 56977617, "question_id": 56973200, "link": "https://stackoverflow.com/questions/56973200/how-do-i-make-the-last-two-words-of-each-footnote-bold-using-word-vba/56977617#56977617", "title": "How do I make the last two words of each footnote bold using Word VBA?", "body": "<p>There is usually more than one way to achieve something like this, but the key is usually to work with a dedicated <code>Range</code> object. </p>\n\n<p>In the code below, that bases on the code in the question, the <code>Range</code> object is assigned to each individual <code>Footnote</code> object in a loop of the <code>Footnotes</code>. It is then collapsed to its end-point and the start extended backwards by two words. (To better understand how this works, think of selecting the footnote, pressing right-arrow, then pressing ctrl+shift+left arrow twice to select the last two words.)</p>\n\n<pre><code>Dim oDoc As Document\nDim oFootnotes As Footnotes\nDim Ftnote As Footnote\nDim rngFootnote As Word.Range\n\n'Document is the ActiveDocument\nSet oDoc = Application.ActiveDocument\n\n'the author's name needs to be bold (the last two words in each footnote)\nSet oFootnotes = oDoc.Footnotes\nFor Each Ftnote In oFootnotes\n    Set rngFootnote = Ftnote.Range\n    rngFootnote.Collapse wdCollapseEnd\n    rngFootnote.MoveStart wdWord, -2\n    rngFootnote.Font.Bold = True\nNext\n</code></pre>\n\n<p>Note that the reason for one of the errors in the question is because <code>Words.Last</code> returns a <code>Range</code> object containing the last word. Since it contains only one word - the last - <code>Words(2)</code> can't find anything it can work with.</p>\n\n<p>The reason for the other error is that it's not possible to assign a <code>Range</code> to a <code>Footnote</code> or <code>Footnotes</code> object. They're different things, entirely...</p>\n"}], "owner": {"reputation": 35, "user_id": 11765351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe3414b8e28ddd38bab4dd6583490596?s=128&d=identicon&r=PG&f=1", "display_name": "Debra", "link": "https://stackoverflow.com/users/11765351/debra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 375, "favorite_count": 1, "accepted_answer_id": 56977617, "answer_count": 2, "score": 2, "last_activity_date": 1562787756, "creation_date": 1562769783, "last_edit_date": 1562786123, "question_id": 56973200, "link": "https://stackoverflow.com/questions/56973200/how-do-i-make-the-last-two-words-of-each-footnote-bold-using-word-vba", "title": "How do I make the last two words of each footnote bold using Word VBA?", "body": "<p>I've changed balloon comments to footnotes, taking the author's name too.  I need the author's name to be in bold but I can't get my code to read the footnotes.  My problem is in setting : oFootnote</p>\n\n<p>I've tried calling on the strAuthor and making that bold but because it is no longer a comment.author I can no longer set it as it's now in the footnote.  I've tried many examples on the internet but I just can't get them to work:\nStackOverflow's How do i make a string bold; Insert bold text into Word using VBA\nalso</p>\n\n<pre><code> Set oFootnote = oDoc.Footnotes.Add(Range:=Selection.Range, Text:=\"Some text\") \n</code></pre>\n\n<p>I am a trainee so please don't judge me too harshly</p>\n\n<pre><code>'Convert comments to footnotes with Author name in bold\nDim i As Long\nDim oDoc As Document\ndim oComment as Comments\nDim oFootnote As Footnotes\n\n'Document is the ActiveDocument\nSet oDoc = Application.ActiveDocument\n\n'the author's name needs to be bold (the last two words in each footnote)\nSet oFootnote = oDoc.Footnotes\n\n    With oFootnote\n      Selection.Range.Words.Last.Words (2)\n        'Make the last two words bold'\n        With Selection.Find\n        .Text = \"\"\n        .Replacement.Text = \"\"\n        .Font.bold = True\n        End With\n    End With\n    Selection.Find.Execute\n    'Set oFootnote = Nothing\n  Next\n</code></pre>\n\n<p>I tried </p>\n\n<pre><code> Set oFootnote = oDoc.Footnotes Range:=Selection.Words.Last.Words(2) \n</code></pre>\n\n<p>but it doesn't like \"Range:= onwards\" so I did </p>\n\n<pre><code> Selection.Range.Words.Last.Words (2)                invalid use of a property\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562770122, "post_id": 56973132, "comment_id": 100482840, "body": "it doesn&#39;t know that pypath is a control, it thinks its a variable which doesn&#39;t have a value method. You need userform(&quot;formnamehere&quot;).controls(&quot;pypath&quot;).value"}], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9273793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1af99297e62abb8c1e5b454976761c6?s=128&d=identicon&r=PG&f=1", "display_name": "Experimenter", "link": "https://stackoverflow.com/users/9273793/experimenter"}, "edited": false, "score": 0, "creation_date": 1562777288, "post_id": 56973669, "comment_id": 100486775, "body": "Here also <code>sPath</code> does not return anything."}], "tags": [], "owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "is_accepted": false, "score": 0, "last_activity_date": 1562771229, "creation_date": 1562771229, "answer_id": 56973669, "question_id": 56973132, "link": "https://stackoverflow.com/questions/56973132/how-to-add-a-textbox-value-to-variable-from-a-userform/56973669#56973669", "title": "How to add a textbox value to variable from a userform?", "body": "<p>Try this code </p>\n\n<pre><code>'In Standard Module\n'------------------\nPublic sPath As String\n\nSub LoopThroughFiles()\nLoad UIAutotestHeader\nsPath = UIAutotestHeader.pypath.Value\nUIAutotestHeader.Show\nEnd Sub\n\n'In UserForm Module\nPrivate Sub pypath_AfterUpdate()\nIf sPath = \"\" Then\n    MsgBox \"Please add a path having .py files.\"\nEnd If\nEnd Sub\n\nPrivate Sub CommandButton1_Click()\nIf sPath &lt;&gt; \"\" Then MsgBox sPath\nsPath = \"\"\nUnload UIAutotestHeader\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 157, "user_id": 9273793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1af99297e62abb8c1e5b454976761c6?s=128&d=identicon&r=PG&f=1", "display_name": "Experimenter", "link": "https://stackoverflow.com/users/9273793/experimenter"}, "edited": false, "score": 0, "creation_date": 1562777151, "post_id": 56974367, "comment_id": 100486697, "body": "It was giving error <code>member already exists</code> at line <code>Public Property Get PyPath() As String</code> so changed <code>PyPath()</code> to <code>PyPath1()</code>. But <code>path</code> is empty."}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "reply_to_user": {"reputation": 157, "user_id": 9273793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1af99297e62abb8c1e5b454976761c6?s=128&d=identicon&r=PG&f=1", "display_name": "Experimenter", "link": "https://stackoverflow.com/users/9273793/experimenter"}, "edited": false, "score": 0, "creation_date": 1562777440, "post_id": 56974367, "comment_id": 100486849, "body": "That&#39;s because  I just used a variable <code>path</code> as an example. I&#39;ll edit my answer so that you can see how to use it getting it from your <code>pypath.Value</code>, which I assume is some control in your userform? Which in that case you could have a conflict of names. Have the property you want to be exposed be the name that would make sense to you."}, {"owner": {"reputation": 157, "user_id": 9273793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1af99297e62abb8c1e5b454976761c6?s=128&d=identicon&r=PG&f=1", "display_name": "Experimenter", "link": "https://stackoverflow.com/users/9273793/experimenter"}, "edited": false, "score": 0, "creation_date": 1562780504, "post_id": 56974367, "comment_id": 100488236, "body": "Now could see value in <code>.pypath</code>. But unable access it after <code>With</code> block."}, {"owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "reply_to_user": {"reputation": 157, "user_id": 9273793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1af99297e62abb8c1e5b454976761c6?s=128&d=identicon&r=PG&f=1", "display_name": "Experimenter", "link": "https://stackoverflow.com/users/9273793/experimenter"}, "edited": false, "score": 0, "creation_date": 1562780922, "post_id": 56974367, "comment_id": 100488409, "body": "You could either use it within the <code>With</code> block and do your execution from there. The advantage there is that you don&#39;t have to declare additional variables, you have them already in your userform. Or, you can do like you did above and store that value into a variable <code>Path = .pypath</code>."}], "tags": [], "owner": {"reputation": 1681, "user_id": 8309643, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-GKYcGO_qCIE/AAAAAAAAAAI/AAAAAAAAB8o/PJdqYRCGzdU/photo.jpg?sz=128", "display_name": "Robert Todar", "link": "https://stackoverflow.com/users/8309643/robert-todar"}, "is_accepted": true, "score": 1, "last_activity_date": 1562777502, "last_edit_date": 1562777502, "creation_date": 1562773679, "answer_id": 56974367, "question_id": 56973132, "link": "https://stackoverflow.com/questions/56973132/how-to-add-a-textbox-value-to-variable-from-a-userform/56974367#56974367", "title": "How to add a textbox value to variable from a userform?", "body": "<p>First, see this helpful <a href=\"https://rubberduckvba.wordpress.com/2017/10/25/userform1-show/\" rel=\"nofollow noreferrer\">RubberDuck Blog</a> on working with UserForms, very helpful and applicable. This is what I'm basing my answer on.</p>\n\n<hr>\n\n<p>Try to instantiate your userform using a <code>With</code> statement so that you have a captured instance of it where you have access to its various properties that you expose. </p>\n\n<p>Note, in this case, you don't have to store your variables, as you still have access to them in your instance of your userform.  Here is an example below.</p>\n\n<pre><code>Sub LoopThroughFiles()\n   With New UIAutotestHeader\n        .Show\n        If Not .IsCancelled Then\n            If .PyPath = \"\" Then\n                MsgBox \"Please add a path having .py files.\"\n            End If\n        End If\n    End With\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>In your Userform, you can expose the properties that you want to have access to. I also added the <code>IsCancelled</code> method to make sure the user didn't press cancel.</p>\n\n<pre><code>Option Explicit\n\nPrivate cancelled As Boolean\n\nPublic Property Get PyPath() As String\n    PyPath = pypath.Value\nEnd Property\n\nPublic Property Get IsCancelled() As Boolean\n    IsCancelled = cancelled\nEnd Property\n\nPrivate Sub CommandButton1_Click()\n    Hide\nEnd Sub\n\nPrivate Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)\n    If CloseMode = VbQueryClose.vbFormControlMenu Then\n        Cancel = True\n        OnCancel\n    End If\nEnd Sub\n\nPrivate Sub OnCancel()\n    cancelled = True\n    Hide\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 9273793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1af99297e62abb8c1e5b454976761c6?s=128&d=identicon&r=PG&f=1", "display_name": "Experimenter", "link": "https://stackoverflow.com/users/9273793/experimenter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "accepted_answer_id": 56974367, "answer_count": 2, "score": 1, "last_activity_date": 1562777502, "creation_date": 1562769608, "last_edit_date": 1562776280, "question_id": 56973132, "link": "https://stackoverflow.com/questions/56973132/how-to-add-a-textbox-value-to-variable-from-a-userform", "title": "How to add a textbox value to variable from a userform?", "body": "<p>I've created a userform named <code>UIAutotestHeader</code> and textbox named <code>pypath</code>. And on button click I'm trying to pass a value to a variable but getting <code>runtime error 424</code>. Any help please.</p>\n\n<pre><code>Sub LoopThroughFiles()\n   Dim Path As String    \n   UIAutotestHeader.Show\n   Path = pypath.Value\n   If pypath.Value = \"\" Then\n       MsgBox \"Please add a path having .py files.\"\n   End If\nEnd sub\n</code></pre>\n\n<p>Button click code:</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n    UIAutotestHeader.Hide\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "edited": false, "score": 0, "creation_date": 1562771047, "post_id": 56973058, "comment_id": 100483375, "body": "Once your VBA code is executed, the Undo is cleared. This is by design. <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/ffbb5456-bc80-4c05-80f5-fb07245541aa/why-does-excel-not-allow-quotundoquot-after-a-vba-execution?forum=exceldev\" rel=\"nofollow noreferrer\">social.msdn.microsoft.com/Forums/office/en-US/&hellip;</a>"}, {"owner": {"reputation": 1, "user_id": 11765483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0727415129e974b176b892289127110?s=128&d=identicon&r=PG&f=1", "display_name": "BenjyCJ", "link": "https://stackoverflow.com/users/11765483/benjycj"}, "reply_to_user": {"reputation": 5170, "user_id": 1410246, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfce8c2aa420b800bb7595ac5fbc986d?s=128&d=identicon&r=PG", "display_name": "EylM", "link": "https://stackoverflow.com/users/1410246/eylm"}, "edited": false, "score": 0, "creation_date": 1562839210, "post_id": 56973058, "comment_id": 100507745, "body": "@EyIM Yes, this is the issue I&#39;m facing. If I could change the above code to work in a function, I believe that the Undo history would not be affected."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11765483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0727415129e974b176b892289127110?s=128&d=identicon&r=PG&f=1", "display_name": "BenjyCJ", "link": "https://stackoverflow.com/users/11765483/benjycj"}, "edited": false, "score": 0, "creation_date": 1562839422, "post_id": 56979145, "comment_id": 100507858, "body": "I could do this (or edit the VBA to put the dates in the required cells), however I would like to create a function that does this as it will be more versatile and will allow other users of the workbook to use it where needed (e.g. changing the target cells without editing the VBA). Thanks a lot for your suggestion though"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 1, "user_id": 11765483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0727415129e974b176b892289127110?s=128&d=identicon&r=PG&f=1", "display_name": "BenjyCJ", "link": "https://stackoverflow.com/users/11765483/benjycj"}, "edited": false, "score": 0, "creation_date": 1562885886, "post_id": 56979145, "comment_id": 100530218, "body": "@BenjyCJ: Just to clarify - your UDF that you are creating there does the equivalent of the formula posted here (filled down of course, and you can choose between absolute or relative (<code>A$6</code> or <code>A6</code>, noting that <code>$A$6</code> makes no sense in this context). Only using the native formula is faster and less prone to coding error. Check out <a href=\"https://en.wikipedia.org/wiki/Rube_Goldberg_machine\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Rube_Goldberg_machine</a>"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 1, "user_id": 11765483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0727415129e974b176b892289127110?s=128&d=identicon&r=PG&f=1", "display_name": "BenjyCJ", "link": "https://stackoverflow.com/users/11765483/benjycj"}, "edited": false, "score": 0, "creation_date": 1562885957, "post_id": 56979145, "comment_id": 100530230, "body": "Oh - and by using the native Excel functions/formula the <code>Undo</code> chain is maintained."}, {"owner": {"reputation": 1, "user_id": 11765483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0727415129e974b176b892289127110?s=128&d=identicon&r=PG&f=1", "display_name": "BenjyCJ", "link": "https://stackoverflow.com/users/11765483/benjycj"}, "edited": false, "score": 0, "creation_date": 1563205900, "post_id": 56979145, "comment_id": 100614314, "body": "Thanks for your help, although the text I quoted is not a User Defined Function, it is a subroutine, therefore it is not what I was after. Essentially I want to change the Subroutine quoted in to a UDF. This means that if the function was called &quot;moddate&quot;, I would be able to type &#39;=moddate(A1:A6)&#39; and the function would tell me the last time a cell in that range was updated. I would also be able to undo any changes (I have just tested this with a simplified &quot;A + B&quot; UDF, and was able to undo after typing it). I hope this makes sense? Thanks for your patience"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "reply_to_user": {"reputation": 1, "user_id": 11765483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0727415129e974b176b892289127110?s=128&d=identicon&r=PG&f=1", "display_name": "BenjyCJ", "link": "https://stackoverflow.com/users/11765483/benjycj"}, "edited": false, "score": 0, "creation_date": 1563226960, "post_id": 56979145, "comment_id": 100622383, "body": "@BenjyCJ: You are right, the text you quoted is not a UDF - but your question is about building a UDF. All my comments apply."}, {"owner": {"reputation": 1, "user_id": 11765483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0727415129e974b176b892289127110?s=128&d=identicon&r=PG&f=1", "display_name": "BenjyCJ", "link": "https://stackoverflow.com/users/11765483/benjycj"}, "edited": false, "score": 0, "creation_date": 1563442698, "post_id": 56979145, "comment_id": 100704740, "body": "I&#39;m not sure I follow. However I have found a solution and have posted it as a separate answer on this message thread. Thanks a lot for your time with this."}], "tags": [], "owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "is_accepted": false, "score": 0, "last_activity_date": 1562795646, "creation_date": 1562795646, "answer_id": 56979145, "question_id": 56973058, "link": "https://stackoverflow.com/questions/56973058/how-do-i-make-a-function-in-vba-to-display-the-date-that-a-cell-within-a-specifi/56979145#56979145", "title": "How do I make a function in VBA to display the date that a cell within a specified range was last updated?", "body": "<p>Based on your explanation, you can put in A6:</p>\n\n<pre><code>=A6\n</code></pre>\n\n<p>Because you already put the relevant value in <kbd>A6</kbd> in your <code>Worksheet_Change</code> routine.</p>\n"}, {"comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1563488928, "post_id": 57091453, "comment_id": 100727721, "body": "Obviously you have not tried this code or tested it."}], "tags": [], "owner": {"reputation": 1, "user_id": 11765483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0727415129e974b176b892289127110?s=128&d=identicon&r=PG&f=1", "display_name": "BenjyCJ", "link": "https://stackoverflow.com/users/11765483/benjycj"}, "is_accepted": true, "score": 0, "last_activity_date": 1563448633, "last_edit_date": 1563448633, "creation_date": 1563442603, "answer_id": 57091453, "question_id": 56973058, "link": "https://stackoverflow.com/questions/56973058/how-do-i-make-a-function-in-vba-to-display-the-date-that-a-cell-within-a-specifi/57091453#57091453", "title": "How do I make a function in VBA to display the date that a cell within a specified range was last updated?", "body": "<p>For anyone else with the same issue, I have managed to find a solution to this problem. The following function returns a timestamp that updates on each edit of any of the cells within the specified function range:</p>\n\n<pre><code>Function ModDate(Reference As Range)\nDim cell As Range\n\n\nFor Each cell In Reference\n    If cell.Value &lt;&gt; \"\" Then\n    Timestamp = Format(Now, \"dd-mm-yyyy hh:mm:ss\")\n    Else\n    Timestamp = \"\"\n    End If\n\nNext cell\n\nEnd Function\n</code></pre>\n\n<p>This requires a value to be present in the final cell in the range. A simpler version of this is (will always display a date/time):</p>\n\n<pre><code>Function ModDate(Reference As Range)\nDim cell As Range\n\nFor Each cell In Reference\n\n    ModDate = Format(Now, \"dd-mm-yyyy hh:mm:ss\")\n\nNext cell\n\nEnd Function\n</code></pre>\n\n<p>Hope this helps</p>\n"}], "owner": {"reputation": 1, "user_id": 11765483, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0727415129e974b176b892289127110?s=128&d=identicon&r=PG&f=1", "display_name": "BenjyCJ", "link": "https://stackoverflow.com/users/11765483/benjycj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 57091453, "answer_count": 2, "score": 0, "last_activity_date": 1563448633, "creation_date": 1562769356, "question_id": 56973058, "link": "https://stackoverflow.com/questions/56973058/how-do-i-make-a-function-in-vba-to-display-the-date-that-a-cell-within-a-specifi", "title": "How do I make a function in VBA to display the date that a cell within a specified range was last updated?", "body": "<p>I am trying to create a function that will return the date (and time) that a cell within the specified range was last updated.</p>\n\n<p>For example, I want to be able to type in to a cell (A8 for example) something like:</p>\n\n<p>= ModDate(A1:A7)</p>\n\n<p>and the result to display the date in A8 that a cell was last updated within the specified range (A1:A7). It also needs to update when a cell within that range A1:A7 is changed.</p>\n\n<p>So far I have done some digging around on this site and found a Sub that will do this, however, whenever this runs, it does not allow users of the sheet (other people I work with) to undo.</p>\n\n<p>The following code will put the timestamp I am after in column 6, when a cell value in a column to the left on the same row is updated:</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\nDim rInt As Range\nDim rCell As Range\nDim tCell As Range\nDim tColInt As Integer\n\ntColInt = 6 'Column Index, Example: A=1, B=2, ...... ,Z=26\n\n\nSet rInt = Intersect(Target, Range(\"A2:D43415\")) 'Change cell range\n If Not rInt Is Nothing Then\n    For Each rCell In rInt\n        Set tCell = Cells(rCell.Cells.Row, tColInt)\n        If IsEmpty(tCell) Or Not IsEmpty(tCell) Then\n            tCell = Now\n            tCell.NumberFormat = \"dd/mm/yyyy h:mm:ss AM/PM\" 'Custom Format\n        End If\n    Next\n End If\nEnd Sub\n</code></pre>\n\n<p>(this was courtesy of Asela Jayathissa in a separate stackoverflow thread)</p>\n\n<p>I am fairly new to VBA, and I've tried converting this to the required function described above, but can't work out how to do it. Any help that anyone could give would be much appreciated.</p>\n\n<p>Thanks a lot</p>\n"}, {"tags": ["excel", "vba", "transform"], "comments": [{"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 1, "creation_date": 1562769498, "post_id": 56973008, "comment_id": 100482475, "body": "On which line does the error occur? Also since you are saving by the reset date, don&#39;t you expect an error if you are saving with an existing file name?"}, {"owner": {"reputation": 343, "user_id": 11613489, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156365606457205/picture?type=large", "display_name": "Lorenzo Castagno", "link": "https://stackoverflow.com/users/11613489/lorenzo-castagno"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562769851, "post_id": 56973008, "comment_id": 100482693, "body": "Hi, @AAA I don&#39;t see any error, the VBA runs without issues. I can&#39;t see any message like overwriting/replacing an existing file,  following your question now my question would be: &quot; can I save the files, not by ResetDate? saving them like file_1, file_2, file_3,..., file_n?&quot; thanks for your message."}, {"owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562770784, "post_id": 56973008, "comment_id": 100483222, "body": "As mentioned by @AAA, You&#39;re using the following code to determine your filename <code>sFile = Format(.Cells(lRow, 1).Value, &quot;DD-MMM-YY&quot;)</code>, which references column 1, in which your `ResetDate1 is contained, hence two files will have the same name :0)"}, {"owner": {"reputation": 343, "user_id": 11613489, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156365606457205/picture?type=large", "display_name": "Lorenzo Castagno", "link": "https://stackoverflow.com/users/11613489/lorenzo-castagno"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562831402, "post_id": 56973008, "comment_id": 100503376, "body": "Hello @AAA sorry for the late reply, yesterday I didn&#39;t time to look at it. It&#39;s working fine now, fixed, thanks for your interest and your time. Regards!"}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562842444, "post_id": 56973008, "comment_id": 100509631, "body": "@LorenzoCastagno, if it worked for you, you should <a href=\"https://stackoverflow.com/help/someone-answers\">upvote and mark as accepted answer</a>."}, {"owner": {"reputation": 343, "user_id": 11613489, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156365606457205/picture?type=large", "display_name": "Lorenzo Castagno", "link": "https://stackoverflow.com/users/11613489/lorenzo-castagno"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562851739, "post_id": 56973008, "comment_id": 100515375, "body": "@AAA, of course, that was the first thing that I tried this morning, but I can&#39;t vote because I&#39;m under 15 points of reputation... update: done!!!"}], "answers": [{"tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 1, "last_activity_date": 1562771777, "last_edit_date": 1562771777, "creation_date": 1562770902, "answer_id": 56973556, "question_id": 56973008, "link": "https://stackoverflow.com/questions/56973008/excel-create-for-each-row-in-a-spreadsheet-a-xml-file-using-vba/56973556#56973556", "title": "Excel : Create for each row (in a spreadsheet) a .xml file (using VBA)", "body": "<p>Delete <code>doc.Save sFile</code> and replace with the following code:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Dim x as Long\nx = Application.CountIf(.Range(\"A2:A\" &amp; lrow), .Cells(lRow, 1))\nIf  x &gt; 1 Then doc.Save sFile &amp; \"_\" &amp; x Else doc.Save sFile\n</code></pre>\n\n<p><strong>So your amended code</strong> would be:</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub testXLStoXML()\nDim x as Long\nsTemplateXML = _\n    \"&lt;?xml version='1.0'?&gt;\" + vbNewLine + _\n    \"&lt;E&gt;\" + vbNewLine + _\n    \"   &lt;ResetDate&gt;\" + vbNewLine + _\n    \"   &lt;/ResetDate&gt;\" + vbNewLine + _\n    \"   &lt;ValueDate&gt;\" + vbNewLine + _\n    \"   &lt;/ValueDate&gt;\" + vbNewLine + _\n    \"   &lt;MaturityD&gt;\" + vbNewLine + _\n    \"   &lt;/MaturityD&gt;\" + vbNewLine + _\n    \"   &lt;Rate&gt;\" + vbNewLine + _\n    \"   &lt;/Rate&gt;\" + vbNewLine + _\n    \"   &lt;Quantity&gt;\" + vbNewLine + _\n    \"   &lt;/Quantity&gt;\" + vbNewLine + _\n    \"   &lt;ID&gt;\" + vbNewLine + _\n    \"   &lt;/ID&gt;\" + vbNewLine + _\n    \"&lt;/E&gt;\" + vbNewLine\n\nSet doc = CreateObject(\"MSXML2.DOMDocument\")\ndoc.async = False\ndoc.validateOnParse = False\ndoc.resolveExternals = False\n\nWith ActiveWorkbook.Worksheets(1)\n    lLastRow = .UsedRange.Rows.Count\n    For lRow = 2 To lLastRow\n        sFile = Format(.Cells(lRow, 1).Value, \"DD-MMM-YY\")\n        sBirthdate = Format(.Cells(lRow, 2).Value, \"DD-MMM-YY\")\n        sAmount = Format(.Cells(lRow, 3).Value, \"DD-MMM-YY\")\n        sRate = .Cells(lRow, 4).Value\n        sQuantity = .Cells(lRow, 5).Value\n        sID = .Cells(lRow, 6).Value\n        doc.LoadXML sTemplateXML\n        doc.getElementsByTagName(\"ResetDate\")(0).appendChild doc.createTextNode(ResetDate)\n        doc.getElementsByTagName(\"ValueDate\")(0).appendChild doc.createTextNode(ValueDate)\n        doc.getElementsByTagName(\"MaturityD\")(0).appendChild doc.createTextNode(MaturityD)\n        doc.getElementsByTagName(\"Rate\")(0).appendChild doc.createTextNode(sRate)\n        doc.getElementsByTagName(\"Quantity\")(0).appendChild doc.createTextNode(sQuantity)\n        doc.getElementsByTagName(\"ID\")(0).appendChild doc.createTextNode(sID)\n        x = Application.CountIf(.Range(\"A2:A\" &amp; lrow), .Cells(lRow, 1))\n        If  x &gt; 1 Then doc.Save sFile &amp; \"_\" &amp; x Else doc.Save sFile\n    Next lrow\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 343, "user_id": 11613489, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156365606457205/picture?type=large", "display_name": "Lorenzo Castagno", "link": "https://stackoverflow.com/users/11613489/lorenzo-castagno"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 0, "accepted_answer_id": 56973556, "answer_count": 1, "score": 1, "last_activity_date": 1562771777, "creation_date": 1562769201, "last_edit_date": 1562770414, "question_id": 56973008, "link": "https://stackoverflow.com/questions/56973008/excel-create-for-each-row-in-a-spreadsheet-a-xml-file-using-vba", "title": "Excel : Create for each row (in a spreadsheet) a .xml file (using VBA)", "body": "<p>I built a code that creates a .xml file for each row, for example, the below spreadsheet<br>\n<a href=\"https://i.stack.imgur.com/6cbwv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/6cbwv.png\" alt=\"Example: Rows to transform\"></a></p>\n\n<p>The following code works fine except for one case when <strong>ResetDate</strong> has the same value for more than 1 row.</p>\n\n<p>The VBA code (I'm not an expert) </p>\n\n<pre><code>Sub testXLStoXML()\n sTemplateXML = _\n        \"&lt;?xml version='1.0'?&gt;\" + vbNewLine + _\n        \"&lt;E&gt;\" + vbNewLine + _\n        \"   &lt;ResetDate&gt;\" + vbNewLine + _\n        \"   &lt;/ResetDate&gt;\" + vbNewLine + _\n        \"   &lt;ValueDate&gt;\" + vbNewLine + _\n        \"   &lt;/ValueDate&gt;\" + vbNewLine + _\n        \"   &lt;MaturityD&gt;\" + vbNewLine + _\n        \"   &lt;/MaturityD&gt;\" + vbNewLine + _\n        \"   &lt;Rate&gt;\" + vbNewLine + _\n        \"   &lt;/Rate&gt;\" + vbNewLine + _\n        \"   &lt;Quantity&gt;\" + vbNewLine + _\n        \"   &lt;/Quantity&gt;\" + vbNewLine + _\n        \"   &lt;ID&gt;\" + vbNewLine + _\n        \"   &lt;/ID&gt;\" + vbNewLine + _\n        \"&lt;/E&gt;\" + vbNewLine\n\n Set doc = CreateObject(\"MSXML2.DOMDocument\")\n doc.async = False\n doc.validateOnParse = False\n doc.resolveExternals = False\n\n With ActiveWorkbook.Worksheets(1)\n  lLastRow = .UsedRange.Rows.Count\n\n  For lRow = 2 To lLastRow\n   sFile = Format(.Cells(lRow, 1).Value, \"DD-MMM-YY\")\n   sBirthdate = Format(.Cells(lRow, 2).Value, \"DD-MMM-YY\")\n   sAmount = Format(.Cells(lRow, 3).Value, \"DD-MMM-YY\")\n   sRate = .Cells(lRow, 4).Value\n   sQuantity = .Cells(lRow, 5).Value\n   sID = .Cells(lRow, 6).Value\n   doc.LoadXML sTemplateXML\n   doc.getElementsByTagName(\"ResetDate\")(0).appendChild doc.createTextNode(ResetDate)\n   doc.getElementsByTagName(\"ValueDate\")(0).appendChild doc.createTextNode(ValueDate)\n   doc.getElementsByTagName(\"MaturityD\")(0).appendChild doc.createTextNode(MaturityD)\n  doc.getElementsByTagName(\"Rate\")(0).appendChild doc.createTextNode(sRate)\n  doc.getElementsByTagName(\"Quantity\")(0).appendChild doc.createTextNode(sQuantity)\n  doc.getElementsByTagName(\"ID\")(0).appendChild doc.createTextNode(sID)\n   doc.Save sFile\n  Next\n\n End With\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/5Qp5t.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5Qp5t.png\" alt=\"Output 10 files, output expected 11 files\"></a></p>\n\n<p>As you can see I get as output just 1 file for the date: </p>\n\n<blockquote>\n  <p><a href=\"https://i.stack.imgur.com/zj2vJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zj2vJ.png\" alt=\"enter image description here\"></a></p>\n</blockquote>\n\n<p>Any suggestions? Thanks in advance</p>\n"}, {"tags": ["vba", "extract"], "answers": [{"tags": [], "owner": {"reputation": 3108, "user_id": 5040941, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/291199b5e862bf2befb8ee158c6e544e?s=128&d=identicon&r=PG&f=1", "display_name": "3-14159265358979323846264", "link": "https://stackoverflow.com/users/5040941/3-14159265358979323846264"}, "is_accepted": true, "score": 0, "last_activity_date": 1562770142, "creation_date": 1562770142, "answer_id": 56973303, "question_id": 56972848, "link": "https://stackoverflow.com/questions/56972848/i-can-not-retrieve-information-on-a-web-page/56973303#56973303", "title": "I can not retrieve information on a web page", "body": "<p>The error you are receiving is because <code>Htable.getElementsByTagName</code> returns a collection of elements, and that collection doesn't have the method <code>maTable.getElementsByClassName</code>. You need to reference the first item in the collection (using <code>maTable(0)</code>), then you can access the <code>href</code> and <code>innertext</code> as follows:</p>\n\n<pre><code>Private Function CreerNavigateur()\nDim IE As Object\nDim oDoc As Object\nDim Htable, maTable, hyper As Object\nDim text As String\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.navigate \"www.w3schools.com\"\nWaitIE IE\n    ' Page charg\u00e9e, on continue\n    Set oDoc = IE.Document\n    Set Htable = oDoc.getElementsByTagName(\"div\")(1)\n    MsgBox Htable.innerhtml\n    Set maTable = Htable.getElementsByTagName(\"a\")\n    MsgBox maTable(0).href\n    MsgBox maTable(0).innertext\n IE.Quit\n    'On lib\u00e8re les variables\n    Set IE = Nothing\n    Set IEDoc = Nothing\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 11409702, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-268teNZBZdA/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reYDLnGgjxs-Tj3phsdKJT4fU7wAg/mo/photo.jpg?sz=128", "display_name": "corentin KOUNOU", "link": "https://stackoverflow.com/users/11409702/corentin-kounou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 22, "favorite_count": 0, "accepted_answer_id": 56973303, "answer_count": 1, "score": 1, "last_activity_date": 1562770142, "creation_date": 1562768670, "question_id": 56972848, "link": "https://stackoverflow.com/questions/56972848/i-can-not-retrieve-information-on-a-web-page", "title": "I can not retrieve information on a web page", "body": "<p>the principle: load a page and recover the information contained in the tag a</p>\n\n<p>here is the source code:</p>\n\n<pre><code>    &lt;div class=\"w3-row w3-white w3-padding w3-hide-medium w3-hide-small\" style=\"margin-top:5px;\"&gt;\n\n        &lt;div class=\"w3-col s5 notranslate\" style=\"margin:4px 0 6px 0\"&gt;\n            &lt;a class=\"w3schools-logo\" href=\"//www.w3schools.com\"&gt;w3schools&lt;/a&gt;\n        &lt;/div&gt;\n  &lt;/div&gt;\n</code></pre>\n\n<p>but at the execution of my code, I see this error : property or method not supported by this object</p>\n\n<pre><code>Private Function CreerNavigateur()\nDim IE As Object\nDim oDoc As Object\nDim Htable, maTable, hyper As Object\nDim text As String\n\nSet IE = CreateObject(\"InternetExplorer.Application\")\nIE.Visible = True\nIE.navigate \"www.w3schools.com\"\nWaitIE IE\n    ' Page charg\u00e9e, on continue\n   Set oDoc = IE.Document\n   Set Htable = oDoc.getElementsByTagName(\"div\")(1)\n   Set maTable = Htable.getElementsByTagName(\"a\")\n   MsgBox maTable\n   Set hyper = maTable.getElementsByClassName(\"w3schools-logo\")\n   text = hyper.innerText\n   MsgBox text\n IE.Quit\n    'On lib\u00e8re les variables\n    Set IE = Nothing\n    Set IEDoc = Nothing\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "lotusscript"], "answers": [{"tags": [], "owner": {"reputation": 1515, "user_id": 4114782, "user_type": "registered", "accept_rate": 11, "profile_image": "https://www.gravatar.com/avatar/a7a894ffea3afedf3f70c7cc54fa7518?s=128&d=identicon&r=PG&f=1", "display_name": "Duston", "link": "https://stackoverflow.com/users/4114782/duston"}, "is_accepted": true, "score": 2, "last_activity_date": 1562771883, "last_edit_date": 1562771883, "creation_date": 1562770353, "answer_id": 56973379, "question_id": 56972824, "link": "https://stackoverflow.com/questions/56972824/how-to-move-activesheet-to-the-end-of-sheets-in-lotusscript/56973379#56973379", "title": "How to move activesheet to the end of sheets in Lotusscript", "body": "<p>This will ultimately solve your problem.  Change the sixth line to:</p>\n\n<pre><code>Set xlsheet = xlapp.workbooks(1).Worksheets.Add(,lastsheet)\n</code></pre>\n\n<p>That will insert the new sheet at the end and return you a Worksheet object so you can change the name.</p>\n\n<p>If you need to use .move(), you have to either capture a return value or use a CALL, for example:</p>\n\n<pre><code>call xlapp.workbooks(1).Worksheets.Move(,lastsheet)\n</code></pre>\n\n<p>By the way, the parameter of Move isn't an integer, it's a worksheet object.</p>\n"}], "owner": {"reputation": 797, "user_id": 5452513, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh5.googleusercontent.com/-vTNZAnHvlT4/AAAAAAAAAAI/AAAAAAAAUsI/_UZfVPwZQzk/photo.jpg?sz=128", "display_name": "Cumhur Ata", "link": "https://stackoverflow.com/users/5452513/cumhur-ata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 56973379, "answer_count": 1, "score": 1, "last_activity_date": 1562771883, "creation_date": 1562768609, "last_edit_date": 1562770407, "question_id": 56972824, "link": "https://stackoverflow.com/questions/56972824/how-to-move-activesheet-to-the-end-of-sheets-in-lotusscript", "title": "How to move activesheet to the end of sheets in Lotusscript", "body": "<p>I have an excel file which has already been created. I can open thet excel file then what i want to do is just a add new worksheet then move that worksheet to the end. I found excel VBA codes but I could not convert to Lotusscript. :((</p>\n\n<pre><code>Set xlApp = CreateObject(\"Excel.application\")\nxlApp.Visible = True   \nxlApp.Workbooks.Open(fileN) \nsheetcount = xlApp.workbooks(1).Worksheets.Count\nSet lastsheet = xlapp.workbooks(1).Worksheets(sheetcount)\nSet xlsheet = xlapp.workbooks(1).Worksheets.Add(lastsheet)\nxlsheet.Name = sheetName \nxlapp.workbooks(1).Worksheets(sheetName).Move(2)\n</code></pre>\n\n<p>I think This code below will help me but I could not write correct syntax. </p>\n\n<pre><code>Sub MoverToEnd()\n    ActiveSheet.Move _\n    After: = ActiveWorkbook.Sheets(ActiveWorkbook.Sheets.Count)\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1562767925, "post_id": 56972516, "comment_id": 100481498, "body": "In your code <code>fldName</code> is defined as a String, which has no <code>.ForeColor</code> property. Perhaps you just need to change <code>Me.[fldName].ForeColor = vbRed</code> to <code>Me.Control(fldName).ForeColor = vbRed</code>"}, {"owner": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "reply_to_user": {"reputation": 1854, "user_id": 6071871, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/IfFKy.jpg?s=128&g=1", "display_name": "ArcherBird", "link": "https://stackoverflow.com/users/6071871/archerbird"}, "edited": false, "score": 0, "creation_date": 1562768515, "post_id": 56972516, "comment_id": 100481877, "body": "Thank you. How would I do this for each record in the continuous form?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1562769673, "post_id": 56972516, "comment_id": 100482584, "body": "You can&#39;t <code>Set</code> a <code>String</code>, <code>rstForm</code> should be declared <code>As Recordset</code>."}, {"owner": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "edited": false, "score": 0, "creation_date": 1562769762, "post_id": 56972516, "comment_id": 100482635, "body": "I changed the Dim statement to Dim rstForm As Recordset but I&#39;m still getting the method or data member not found"}, {"owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "edited": false, "score": 0, "creation_date": 1562770429, "post_id": 56972516, "comment_id": 100483028, "body": "The only way to achieve this is with <b>Conditional Formatting</b>, see e.g. <a href=\"https://stackoverflow.com/questions/39294487/how-can-i-conditionally-format-textbox-border-on-continuous-form\" title=\"how can i conditionally format textbox border on continuous form\">stackoverflow.com/questions/39294487/&hellip;</a> or <a href=\"https://stackoverflow.com/questions/13937493/access-conditional-formatting-for-continuous-form-on-individual-records\" title=\"access conditional formatting for continuous form on individual records\">stackoverflow.com/questions/13937493/&hellip;</a>"}, {"owner": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "edited": false, "score": 0, "creation_date": 1562770740, "post_id": 56972516, "comment_id": 100483201, "body": "I couldn&#39;t get the conditional formatting to work with Me.Controls(fldName)"}, {"owner": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "edited": false, "score": 0, "creation_date": 1562771195, "post_id": 56972516, "comment_id": 100483453, "body": "I have the code sort of working. I updated it in my question. What&#39;s going on is it&#39;s highlighting more than one field"}], "answers": [{"comments": [{"owner": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "edited": false, "score": 0, "creation_date": 1562768395, "post_id": 56972632, "comment_id": 100481807, "body": "You are so awesome! But how would I do this for each record in the continuous form?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "edited": false, "score": 0, "creation_date": 1562769023, "post_id": 56972632, "comment_id": 100482187, "body": "Oh, I&#39;ve no idea - I never use Access, so Access forms are a bit foreign to me. There&#39;s no code in the question that gives me any hint of a notion of there being more than a single instance of any given control, so... I&#39;ll try to find an Access expert."}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": false, "score": 1, "last_activity_date": 1562768007, "creation_date": 1562768007, "answer_id": 56972632, "question_id": 56972516, "link": "https://stackoverflow.com/questions/56972516/highlight-field-background-in-continuous-form/56972632#56972632", "title": "Highlight field background in continuous form", "body": "<p>You can't use a <code>String</code> variable like this, <code>fldName</code> is an identifier holding a <code>String</code> value.. not an <em>identifier</em> - in <code>Me.ControlName</code>, both <code>Me</code> and <code>ControlName</code> are <em>identifiers</em>.</p>\n\n<p>But not all hope is lost! You can use a <code>String</code> to pull a <code>Control</code> object from a form!</p>\n\n<p>All form controls should exist in the form's <code>Controls</code> collection, keyed by name:</p>\n\n<pre><code>Me.Controls(fldName).ForeColor = vbRed\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "edited": false, "score": 0, "creation_date": 1563202458, "post_id": 57015217, "comment_id": 100612298, "body": "I tried using both of your codes and it didn&#39;t work for me. I think it&#39;s because I&#39;m trying to compare the Fields name"}, {"owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "reply_to_user": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "edited": false, "score": 0, "creation_date": 1563208360, "post_id": 57015217, "comment_id": 100615442, "body": "@MaxineHammett Sorry I forgot to change<code>Field1</code>to<code>FieldModified</code>. Code is updated."}], "tags": [], "owner": {"reputation": 2534, "user_id": 9439330, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RdC41.jpg?s=128&g=1", "display_name": "ComputerVersteher", "link": "https://stackoverflow.com/users/9439330/computerversteher"}, "is_accepted": true, "score": 3, "last_activity_date": 1563208205, "last_edit_date": 1563208205, "creation_date": 1562976859, "answer_id": 57015217, "question_id": 56972516, "link": "https://stackoverflow.com/questions/56972516/highlight-field-background-in-continuous-form/57015217#57015217", "title": "Highlight field background in continuous form", "body": "<p>You set the default format for the control. Every copy of the control in the continuous form uses this format. To format by a condition (<code>fldName = Me.FieldModified.value</code>) you need <strong>Condtional Formatting</strong> as Andre told you or use the detail-sections paint event (see update on bottom)</p>\n\n<p>In conditional format wizard, you can create a condtion with<code>Expression Is</code>and<code>[Converted].Name =  [FieldModified]</code>for each control of the form that should be highlighted, if its name matches<code>FiledModified</code>. In Ms Access expressions you can't use<code>Me</code>, just omit it .</p>\n\n<p>You can use VBA to format all controls with <a href=\"https://docs.microsoft.com/en-us/office/vba/api/access.formatconditions\" rel=\"nofollow noreferrer\">FormatConditions</a> by code. If you want to modify an existing condition use<code>.Modify</code>instead of<code>.Add</code></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Form_Load()\n  Dim ctl As Access.Control\n  For Each ctl In Me.Controls ' loop through all controls of form\n      On Error Resume Next ' Not all controls can have conditional format (e.g. labels). To save the check of control type, we ignore errors here\n      ctl.FormatConditions.Add(acExpression, , ctl.Name &amp; \".Name=[FieldModified]\").BackColor = vbRed 'add o format condition to control if possible, else an error is raised but ignored\n      If Err.Number Then 'show errors\n          Debug.Print \"Error: \" &amp; Err.Number &amp; \" - \" &amp; Err.description &amp; \" in Control: \" &amp; ctl.Name &amp; \" Type is \" &amp; TypeName(ctl)\n          Err.Clear 'reset error to catch next\n      Else\n          Debug.Print \"FormatCondition added to Control: \" &amp; ctl.Name &amp; \" Type is \" &amp; TypeName(ctl)\n      End If\n  Next ctl\n  On Error GoTo 0 ' turn on errors again, maybe add an error handler (On Error Goto MyErrHandler)\nEnd Sub\n</code></pre>\n\n<p><strong><em>Update:</em></strong><br>\nYou can use the<code>Details_Paint</code>event of the form to format same control different per record. This enables conditional format for controls without<code>FormatConditions</code>property like labels, buttons.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Private Sub Detail_Paint()\nDim c As Access.Control\n\nFor Each c In Me.Detail.Controls\n    If c.Name = Me.FieldModified.Value Then\n        c.ForeColor = vbRed\n    Else\n        c.ForeColor = vbBlack\n    End If\nNext\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 539, "user_id": 7907121, "user_type": "registered", "accept_rate": 29, "profile_image": "https://lh3.googleusercontent.com/-dvQzB8VUazY/AAAAAAAAAAI/AAAAAAAAAH0/C_lgYIumVpc/photo.jpg?sz=128", "display_name": "mightymax", "link": "https://stackoverflow.com/users/7907121/mightymax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 57015217, "answer_count": 2, "score": 2, "last_activity_date": 1563208205, "creation_date": 1562767618, "last_edit_date": 1562770946, "question_id": 56972516, "link": "https://stackoverflow.com/questions/56972516/highlight-field-background-in-continuous-form", "title": "Highlight field background in continuous form", "body": "<p>I have an Access continuous form. I would like to change the forecolor of a specific record's field.</p>\n\n<p>I have the field to highlight from the FieldModified field. So for example  FieldModified = \"Converted\". Converted being a field on my form.</p>\n\n<p>I would like to change the color of the \"Converted\" field, and do this for each record in the form.</p>\n\n<p>I thought this code would work, but I get an error on Me.[FieldModified].ForeColor. And I need to do this for each record in the form.</p>\n\n<p>Code:</p>\n\n<pre><code>    Private Sub Form_Load()\n    Dim fldName As String\n    fldName = Me.FieldModified.value\n    If (Not IsNull(fldName)) Then\n     Me.[fldName].ForeColor = vbRed '&lt;--doesn't recognize fldName value\n    End If\nEnd Sub\n</code></pre>\n\n<p>Updated code but it gives me an error 438 saying object doesn't support this property or method. But the form does highlight fields on the form but it highlights more then the one field \"fldName\"</p>\n\n<pre><code>Private Sub Form_Load()\nDim rstForm As String\nDim fldName As String\nSet rstForm = Me.ChangedData.Form.Recordset\n\nDo While Not rstForm.EOF\nfldName = Me.FieldModified.value    \nIf (Not IsNull(fldName)) Then\n    Me.Controls(fldName).ForeColor = vbRed '&lt;--doesn't recognize fldName value\nEnd If\n\nrstForm.MoveNext\nLoop\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "autofilter"], "comments": [{"owner": {"reputation": 588, "user_id": 7049751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6b0e27ce4e8c20a20d34e793f4e4636?s=128&d=identicon&r=PG&f=1", "display_name": "Sphinx", "link": "https://stackoverflow.com/users/7049751/sphinx"}, "edited": false, "score": 1, "creation_date": 1562767773, "post_id": 56972261, "comment_id": 100481410, "body": "try <code>Range(&quot;C2&quot;).FormulaR1C1=&quot;=IF(ISNUMBER(SEARCH(&#39;$&#39;,RC[-2])),&#39;S&zwnj;&#8203;canner 2&#39;, IF(ISNUMBER(SEARCH(&#39;#&#39;,RC[-2])),&#39;Scanner 1&#39;,&#39;Error&#39;))&quot;</code>"}, {"owner": {"reputation": 15, "user_id": 11728021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7685beace5795142fb95e6eed98a06a4?s=128&d=identicon&r=PG&f=1", "display_name": "Arianne_2130p", "link": "https://stackoverflow.com/users/11728021/arianne-2130p"}, "edited": false, "score": 0, "creation_date": 1562769928, "post_id": 56972261, "comment_id": 100482731, "body": "No, adding .Formula or .FormulaR1C1 did not work"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1562771105, "post_id": 56972261, "comment_id": 100483403, "body": "<code>Range(&quot;C2&quot;).formular1c1=&quot;=IF(ISNUMBER(SEARCH(&quot;&quot;$&quot;&quot;,RC[-2])),&zwnj;&#8203;&quot;&quot;Scanner 2&quot;&quot;, IF(ISNUMBER(SEARCH(&quot;&quot;#&quot;&quot;,RC[-2])),&quot;&quot;Scanner 1&quot;&quot;,&quot;&quot;Error&quot;&quot;))&quot;</code>"}, {"owner": {"reputation": 15, "user_id": 11728021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7685beace5795142fb95e6eed98a06a4?s=128&d=identicon&r=PG&f=1", "display_name": "Arianne_2130p", "link": "https://stackoverflow.com/users/11728021/arianne-2130p"}, "edited": false, "score": 0, "creation_date": 1562772322, "post_id": 56972261, "comment_id": 100484133, "body": "Hi SJR Thank you so much , the double quotations rather than singles and .Formula instead of .Value worked"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 11728021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7685beace5795142fb95e6eed98a06a4?s=128&d=identicon&r=PG&f=1", "display_name": "Arianne_2130p", "link": "https://stackoverflow.com/users/11728021/arianne-2130p"}, "edited": false, "score": 0, "creation_date": 1562772198, "post_id": 56973657, "comment_id": 100484058, "body": "Thank you so much JvdV, greatly appreciate! Would you know how I can have this calculate or formula executed automatically  as i enter data into cell A?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 15, "user_id": 11728021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7685beace5795142fb95e6eed98a06a4?s=128&d=identicon&r=PG&f=1", "display_name": "Arianne_2130p", "link": "https://stackoverflow.com/users/11728021/arianne-2130p"}, "edited": false, "score": 0, "creation_date": 1562772355, "post_id": 56973657, "comment_id": 100484155, "body": "@Arianne_2130p, glad it helped you, please refer to <a href=\"https://stackoverflow.com/help/someone-answers\">this</a> link if you think this has answered your question. Edit: To calculate you could add a single line in my example code <code>.Calculate</code>."}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1562772283, "last_edit_date": 1562772283, "creation_date": 1562771188, "answer_id": 56973657, "question_id": 56972261, "link": "https://stackoverflow.com/questions/56972261/how-to-autofill-logical-formulas-to-a-certain-cell-using-vba/56973657#56973657", "title": "How to Autofill Logical Formulas to a certain cell using VBA?", "body": "<p>The problem is a combination of the use of single quotes + you didn't add as <code>. Formula</code>:</p>\n\n<p>So:</p>\n\n<pre><code>Range(\"C2\").Formula = \"=IF(ISNUMBER(SEARCH(\"\"$\"\",$A2)),\"\"Scanner 2\"\",IF(ISNUMBER(SEARCH(\"\"#\"\",$A2)),\"\"Scanner 1\"\",\"\"Error\"\"))\"\n</code></pre>\n\n<p>Should work</p>\n\n<p>Also, I see in your code you are using <code>.Select</code>, there are many ways to avoid using this. Check <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">this</a> link.</p>\n\n<p>The below example will do the same thing:</p>\n\n<pre><code>With ThisWorkbook.Sheets(\"Sheet1\")\n    .Range(\"C2:C100\").Formula = \"=IF(ISNUMBER(SEARCH(\"\"$\"\",$A2)),\"\"Scanner 2\"\",IF(ISNUMBER(SEARCH(\"\"#\"\",$A2)),\"\"Scanner 1\"\",\"\"Error\"\"))\"\nEnd With\n</code></pre>\n\n<p>You'll notice Excel will auto-adapt the formula to the correct cell references.</p>\n"}], "owner": {"reputation": 15, "user_id": 11728021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7685beace5795142fb95e6eed98a06a4?s=128&d=identicon&r=PG&f=1", "display_name": "Arianne_2130p", "link": "https://stackoverflow.com/users/11728021/arianne-2130p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 56973657, "answer_count": 1, "score": 0, "last_activity_date": 1562772283, "creation_date": 1562766851, "last_edit_date": 1562768357, "question_id": 56972261, "link": "https://stackoverflow.com/questions/56972261/how-to-autofill-logical-formulas-to-a-certain-cell-using-vba", "title": "How to Autofill Logical Formulas to a certain cell using VBA?", "body": "<p>Two questions 1) Can I autofill logical formulas to a cell using VBA and how (there is something wrong with my code) and 2)Can I autofill it only when data is entered and how?  </p>\n\n<p>The formula I want to put works when I put into a a cell but not VBA:</p>\n\n<pre><code>=IF(ISNUMBER(SEARCH(\"$\",$A2)),\"Scanner 2\",IF(ISNUMBER(SEARCH(\"#\",$A2)),\"Scanner 1\",\"Error\"))\n</code></pre>\n\n<p>For the VBA I also used Relative Coordinates, did not work: </p>\n\n<pre><code>Range(\"C2\").Value=\"=IF(ISNUMBER(SEARCH('$',RC[-2])),'Scanner 2', IF(ISNUMBER(SEARCH('#',RC[-2])),'Scanner 1','Error'))\"\n</code></pre>\n\n<p>Pictures that may help:</p>\n\n<p><img src=\"https://i.stack.imgur.com/yVWVW.png\" alt=\"Picture of VBA and debug highlighted!\"></p>\n\n<p><img src=\"https://i.stack.imgur.com/6FtXk.png\" alt=\"Picture of Spreadsheet\"></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 2, "creation_date": 1562766323, "post_id": 56972047, "comment_id": 100480508, "body": "Change <code>Row.Count</code> into <code>Rows.Count</code>. But also, for future reference, you can avoid using <code>.Activate</code>, rather specify which worksheet you working from, e.g.: <code>With Thisworkbook.Sheets(&quot;Database&quot;) ......code...... End with</code>"}, {"owner": {"reputation": 17, "user_id": 7160114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae579b1ae73db541f4c612c18c063177?s=128&d=identicon&r=PG&f=1", "display_name": "Kshitij Chhikara", "link": "https://stackoverflow.com/users/7160114/kshitij-chhikara"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562766947, "post_id": 56972047, "comment_id": 100480877, "body": "@JvdV it worked. Thank you for the prompt support."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1562767138, "post_id": 56972047, "comment_id": 100481004, "body": "FWIW &quot;Object Required&quot; is because you haven&#39;t specified <code>Option Explicit</code> at the top of the module, making your code vulnerable to silly things, like typos. <code>Row</code> is undefined, but without <code>Option Explicit</code> it&#39;s happily an on-the-fly <code>Variant&#47;Empty</code> variable - but you can&#39;t make a <code>.Count</code> member call against a <code>Variant&#47;Empty</code>, <i>an object is required</i>."}], "answers": [{"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1562766985, "post_id": 56972275, "comment_id": 100480904, "body": "Even better: dereference the sheet from the  <code>ThisWorkbook.Worksheets</code> collection. Better still: give that sheet a code name (say, <code>DbSheet</code>) and go <code>With DbSheet</code>. Also <code>rngTarget</code> can&#39;t possibly be <code>Nothing</code> (assuming the sheet exists), so that last <code>If</code> condition is superfluous."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 17, "user_id": 7160114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae579b1ae73db541f4c612c18c063177?s=128&d=identicon&r=PG&f=1", "display_name": "Kshitij Chhikara", "link": "https://stackoverflow.com/users/7160114/kshitij-chhikara"}, "edited": false, "score": 0, "creation_date": 1562767156, "post_id": 56972275, "comment_id": 100481019, "body": "@KshitijChhikara ALL recommendations in this answer are on point."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1562767201, "post_id": 56972275, "comment_id": 100481046, "body": "@MathieuGuindon, true, and one more thing, if last_row would be 1 (for whatever reason) OP will end up with a range of <code>$B$1:$B$2</code>. Thanks for the constuctive input!"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 1, "last_activity_date": 1562768359, "last_edit_date": 1562768359, "creation_date": 1562766870, "answer_id": 56972275, "question_id": 56972047, "link": "https://stackoverflow.com/questions/56972047/how-to-switch-the-code-from-select-range-input-box-to-row-count/56972275#56972275", "title": "How to switch the code from Select Range (Input Box) to Row Count?", "body": "<p>To get you started, you have refered to <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.row\" rel=\"nofollow noreferrer\"><code>Row</code></a> instead of a range object representing all <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.range.rows\" rel=\"nofollow noreferrer\"><code>Rows</code></a>. Follow the links to see the difference :)</p>\n\n<p>Next you have used <code>.Activate</code> and therefor not specified what worksheet you working from. A better practice would be to use something like:</p>\n\n<pre><code>With Thisworkbook.Sheets(\"Database\") 'Can even be dereferenced from worksheets collection\n    last_row = .Cells(.Rows.Count, \"B\").End(xlUp).Row \n    Set rngTarget = .Range(\"B2:B\" &amp; last_row) 'Tricky if last_row is 1\n    If rngTarget Is Nothing Then Exit Sub 'Superfluous and can be deleted\nEnd with\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 7160114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae579b1ae73db541f4c612c18c063177?s=128&d=identicon&r=PG&f=1", "display_name": "Kshitij Chhikara", "link": "https://stackoverflow.com/users/7160114/kshitij-chhikara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 56972275, "answer_count": 1, "score": 0, "last_activity_date": 1562768359, "creation_date": 1562766100, "last_edit_date": 1562767043, "question_id": 56972047, "link": "https://stackoverflow.com/questions/56972047/how-to-switch-the-code-from-select-range-input-box-to-row-count", "title": "How to switch the code from Select Range (Input Box) to Row Count?", "body": "<p>Current Code is provided below. The user selects the Range of cells from which unique values needs to be found out. Instead of this, I know the Range of cells which is entire Column B of Sheet Database. I tried switching the code by the code below but it's giving \"Run-time error '424': Object Required\" where I am trying to count the number of rows with data.</p>\n\n<pre><code>Sheets(\"Database\").Activate\n\nlast_row = Cells(Row.Count, \"B\").End(xlUp).Row         &lt;- Error \n\nSet rngTarget = Sheets(\"Database\").Range(\"B2:B\" &amp; last_row)\nIf rngTarget Is Nothing Then Exit Sub\n</code></pre>\n\n<p>Current Code:</p>\n\n<pre><code>strPrompt = \"Select the Range from which you'd like to extract uniques\"\n    On Error Resume Next\n        Set rngTarget = Application.InputBox(strPrompt, \"Get Range\", Type:=8)\n    On Error GoTo 0\n    If rngTarget Is Nothing Then Exit Sub\n</code></pre>\n\n<p>Changed Code: (Doesn't work - Gives Run-Time Error)</p>\n\n<pre><code>Sheets(\"Database\").Activate\n\nlast_row = Cells(Row.Count, \"B\").End(xlUp).Row         &lt;- Error \n\nSet rngTarget = Sheets(\"Database\").Range(\"B2:B\" &amp; last_row)\nIf rngTarget Is Nothing Then Exit Sub\n</code></pre>\n\n<p>rngTarget function should contain the range of cells from which unique values needs to be found out.</p>\n\n<p>Update 1\nComplete Code for reference:</p>\n\n<pre><code>Public Sub WriteUniquesToNewSheet()\n\n    Dim wksUniques As Worksheet\n    Dim rngUniques As Range, rngTarget As Range\n    Dim strPrompt As String\n    Dim varUniques As Variant\n    Dim lngIdx As Long\n    Dim last_row As Long\n    Dim colUniques As Collection\n    Set colUniques = New Collection\n\n    'Prompt the user to select a range to unique-ify\n    'strPrompt = \"Select the Range from which you'd like to extract uniques\"\n    'On Error Resume Next\n    '    Set rngTarget = Application.InputBox(strPrompt, \"Get Range\", Type:=8)\n    'On Error GoTo 0\n    'If rngTarget Is Nothing Then Exit Sub '&lt;~ in case the user clicks Cancel\n\n    Sheets(\"Database\").Activate\n\n    last_row = Cells(Row.Count, 2).End(xlUp).Rows\n\n    Set rngTarget = Sheets(\"Database\").Range(\"B2:B\" &amp; last_row)\n    If rngTarget Is Nothing Then Exit Sub\n\n    'Collect the uniques using the function we just wrote\n    Set colUniques = CollectUniques(rngTarget)\n\n    'Load a Variant array with the uniques\n    '(in preparation for writing them to a new sheet)\n    ReDim varUniques(colUniques.Count, 1)\n    For lngIdx = 1 To colUniques.Count\n        varUniques(lngIdx - 1, 0) = CStr(colUniques(lngIdx))\n    Next lngIdx\n\n    'Create a new worksheet (where we will store our uniques)\n    Set wksUniques = Worksheets(\"Lists\")\n\n    Set rngUniques = wksUniques.Range(\"A2:A\" &amp; colUniques.Count + 1)\n    rngUniques = varUniques\n\n    'Let the user know we're done!\n    MsgBox \"Finished!\"\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 11, "user_id": 10625846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fd32ab15819051388c1a8554ad54e?s=128&d=identicon&r=PG&f=1", "display_name": "lilsilenttigr1", "link": "https://stackoverflow.com/users/10625846/lilsilenttigr1"}, "edited": false, "score": 0, "creation_date": 1562769775, "post_id": 56972027, "comment_id": 100482641, "body": "So I altered it to look for entries not equal to &quot;&quot;. This code is now not skipping the blank entries and still won&#39;t go to the next column &quot;AN&quot; to pull more values. <code>Set S2 = Sheets(&quot;data&quot;).Range(&quot;AM:AM&quot;)  Set S3 = Sheets(&quot;data&quot;).Range(&quot;BD:BD&quot;)   Dim i As Integer, j As Integer   j = 1 For i = 1 To 12      If S2.Cells(i, 1).Value &lt;&gt; &quot;&quot; Then        S3.Cells(j, 2).Value = S2.Cells(i, 1).Value        j = j + 1     End If  Next i</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 10625846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fd32ab15819051388c1a8554ad54e?s=128&d=identicon&r=PG&f=1", "display_name": "lilsilenttigr1", "link": "https://stackoverflow.com/users/10625846/lilsilenttigr1"}, "edited": false, "score": 0, "creation_date": 1562770142, "post_id": 56972110, "comment_id": 100482852, "body": "It still is not looping through the other columns though. How can that be fixed?"}], "tags": [], "owner": {"reputation": 8351, "user_id": 4279155, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/841b7391f3f7873bec1a8d9d8d2dc759?s=128&d=identicon&r=PG&f=1", "display_name": "Dominique", "link": "https://stackoverflow.com/users/4279155/dominique"}, "is_accepted": false, "score": 1, "last_activity_date": 1562766354, "creation_date": 1562766354, "answer_id": 56972110, "question_id": 56972027, "link": "https://stackoverflow.com/questions/56972027/looping-through-an-array-in-excel/56972110#56972110", "title": "Looping through an array in Excel", "body": "<p>Replace:</p>\n\n<pre><code>&lt;&gt; \"#N/A\"\n</code></pre>\n\n<p>By:</p>\n\n<pre><code>Not(Application.WorksheetFunction.IfNa(...))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 771500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12c8badc278932fbc3959d180d52463e?s=128&d=identicon&r=PG", "display_name": "Hichem CHTARA", "link": "https://stackoverflow.com/users/771500/hichem-chtara"}, "is_accepted": false, "score": 0, "last_activity_date": 1562766584, "creation_date": 1562766584, "answer_id": 56972177, "question_id": 56972027, "link": "https://stackoverflow.com/questions/56972027/looping-through-an-array-in-excel/56972177#56972177", "title": "Looping through an array in Excel", "body": "<p>the best thing to is not to check if it is equal to \"#N/A\"\nThe best is to check if it is an error : If Not (IsError(S2.Cells(i, 1).Value)) Then</p>\n"}, {"comments": [{"owner": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "edited": false, "score": 0, "creation_date": 1562773723, "post_id": 56974324, "comment_id": 100484934, "body": "You would need to set the for loop of j to the number of columns you want to cycle through and the for loop of i for the number of rows"}, {"owner": {"reputation": 11, "user_id": 10625846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fd32ab15819051388c1a8554ad54e?s=128&d=identicon&r=PG&f=1", "display_name": "lilsilenttigr1", "link": "https://stackoverflow.com/users/10625846/lilsilenttigr1"}, "edited": false, "score": 0, "creation_date": 1562786048, "post_id": 56974324, "comment_id": 100490611, "body": "So this does work for me in getting all the data over, but now it doesn&#39;t condense them. it essentially just looks like a copy/paste values but instead of the errors in the cells, they are just blank."}, {"owner": {"reputation": 11, "user_id": 10625846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fd32ab15819051388c1a8554ad54e?s=128&d=identicon&r=PG&f=1", "display_name": "lilsilenttigr1", "link": "https://stackoverflow.com/users/10625846/lilsilenttigr1"}, "edited": false, "score": 0, "creation_date": 1562852830, "post_id": 56974324, "comment_id": 100516053, "body": "Thank you! It works great! I put multiple &quot;Call&quot;s to take care of multiple blank cells, but it is fantastic!"}, {"owner": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "reply_to_user": {"reputation": 11, "user_id": 10625846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fd32ab15819051388c1a8554ad54e?s=128&d=identicon&r=PG&f=1", "display_name": "lilsilenttigr1", "link": "https://stackoverflow.com/users/10625846/lilsilenttigr1"}, "edited": false, "score": 0, "creation_date": 1562875749, "post_id": 56974324, "comment_id": 100527268, "body": "Mark it as correct if it worked for you. It might help someone else"}], "tags": [], "owner": {"reputation": 120, "user_id": 10284862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59c8cb76f45f812b747dd189d2f208b2?s=128&d=identicon&r=PG&f=1", "display_name": "LafaMan", "link": "https://stackoverflow.com/users/10284862/lafaman"}, "is_accepted": false, "score": 1, "last_activity_date": 1562850714, "last_edit_date": 1562850714, "creation_date": 1562773547, "answer_id": 56974324, "question_id": 56972027, "link": "https://stackoverflow.com/questions/56972027/looping-through-an-array-in-excel/56974324#56974324", "title": "Looping through an array in Excel", "body": "<p>This works when i tested it. </p>\n\n<pre><code>    Sub CopyCell()\n\n    Set S2 = Sheets(\"data\").Range(\"A:A\")\n    Set S3 = Sheets(\"data\").Range(\"M:M\")\n\n    Dim i As Integer, j As Integer\n\n    For j = 1 To 2\n    For i = 1 To 12\n\n       If S2.Cells(i, j).Value &lt;&gt; \"#N/A\" Then\n          S3.Cells(i, j).Value = S2.Cells(i, j).Value\n\n       End If\n\n    Next i\n    Next j\n\n    Call DeleteBlank\n\n    End Sub\n\n\n\nSub DeleteBlank()\n\nDim x As Integer\nDim y As Integer\n\nFor y = 13 To 16 'Range numbers for the columns the data is copied to\nFor x = 1 To 10  ' Number of cells of data you want to loop through\n\nIf Cells(x, y).Value = \"\" Then\nCells(x, y).Delete Shift:=xlUp\n\nEnd If\n\nNext x\nNext y\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10625846, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fd32ab15819051388c1a8554ad54e?s=128&d=identicon&r=PG&f=1", "display_name": "lilsilenttigr1", "link": "https://stackoverflow.com/users/10625846/lilsilenttigr1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1562850714, "creation_date": 1562766017, "last_edit_date": 1562770400, "question_id": 56972027, "link": "https://stackoverflow.com/questions/56972027/looping-through-an-array-in-excel", "title": "Looping through an array in Excel", "body": "<p>Trying to loop through a sheets\"data\".Range\"AM1:AS12\" and copy the data to range beginning at BD1 as long as the data doesn't equal \"#N/A\"</p>\n\n<p>My code works with copying the first column, but doesn't do anything with the data after that. Where am I going wrong?</p>\n\n<pre><code>Set S2 = Sheets(\"data\").Range(\"AM:AM\")\nSet S3 = Sheets(\"data\").Range(\"BD:BD\")\n\nDim i As Integer, j As Integer \n\nj = 1\nFor i = 1 To 12 \n\n   If S2.Cells(i, 1).Value &lt;&gt; \"#N/A\" Then \n      S3.Cells(j, 2).Value = S2.Cells(i, 1).Value \n      j = j + 1 \n   End If\n\nNext i \n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562766688, "post_id": 56971952, "comment_id": 100480735, "body": "<code>lDestLastRow = wsDest.Cells(wsDest.Rows.Count, &quot;D12&quot;).End(xlUp).Offset(1).Row</code> Needs to have a column as the second argument, not a cell. Change &quot;D12&quot; to &quot;D&quot; and &quot;A5&quot; to &quot;A&quot; that should fix it"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1562766757, "post_id": 56971952, "comment_id": 100480769, "body": "Try removing the <code>5</code> and <code>12</code>"}, {"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562766767, "post_id": 56971952, "comment_id": 100480773, "body": "And <code>wsCopy.Range(&quot;A5&quot; &amp; lCopyLastRow).Copy</code> Will need to be &quot;A&quot; &amp; lcopylastrow"}, {"owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "edited": false, "score": 0, "creation_date": 1562767035, "post_id": 56971952, "comment_id": 100480941, "body": "I have changed &quot;D12&quot; to &quot;D&quot; and &quot;A5&quot; to &quot;A&quot; and no longer get an error. But no data is copied/pasted when I run the macro"}, {"owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "edited": false, "score": 0, "creation_date": 1562767245, "post_id": 56971952, "comment_id": 100481069, "body": "There are empty cells above the data which starts at A5 from the data copied and D12 in the destination range so I&#39;m not sure if this is what is causing the problem..."}], "answers": [{"tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 2, "last_activity_date": 1562767655, "creation_date": 1562767655, "answer_id": 56972526, "question_id": 56971952, "link": "https://stackoverflow.com/questions/56971952/vba-copying-data-from-one-workbook-to-another-using-lastrow-ranges/56972526#56972526", "title": "VBA Copying data from one workbook to another using lastrow ranges", "body": "<pre class=\"lang-vb prettyprint-override\"><code>Sub InsertData()\n\nDim wsCopy As Worksheet, wsDest As Worksheet\nDim lCopyLastRow As Long, lDestLastRow As Long\n\n'Set variables for copy and destination sheets\nSet wsCopy = Workbooks(\"Warranty Template.xlsm\").Worksheets(\"PivotTable\")\nSet wsDest = Workbooks(\"QA Matrix Template.xlsm\").Worksheets(\"Plant Sheet\")\n\n'1. Find last used row in the copy range based on data in column A\nlCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, 1).End(xlUp).Row\n\n'2. Find first blank row in the destination range based on data in column A\n'Offset property moves down 1 row\nlDestLastRow = wsDest.Cells(wsDest.Rows.Count, 4).End(xlUp).Offset(1,0).Row\n\n'3. Copy &amp; Paste Data\nwsCopy.Range(\"A5:A\" &amp; lCopyLastRow).Copy _\nwsDest.Range(\"D\" &amp; lDestLastRow)\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 11659563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de5ecd67f2fb7f12580ea0ec88304f6a?s=128&d=identicon&r=PG&f=1", "display_name": "aNobleNoob", "link": "https://stackoverflow.com/users/11659563/anoblenoob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 282, "favorite_count": 0, "accepted_answer_id": 56972526, "answer_count": 1, "score": 2, "last_activity_date": 1562772982, "creation_date": 1562765799, "last_edit_date": 1562772982, "question_id": 56971952, "link": "https://stackoverflow.com/questions/56971952/vba-copying-data-from-one-workbook-to-another-using-lastrow-ranges", "title": "VBA Copying data from one workbook to another using lastrow ranges", "body": "<p>I have a button on a sheet with a PivotTable in a workbook called \"Warranty Template.xlsm\". I want this button to copy the first column of data, which starts at A5, and paste this column into another workbook called \"QA Matrix Template.xlsm\". I want the copied data to end at the last blank row of the column and I want the range in which it is pasted to also be pasted on the first blank row starting from D12 down.</p>\n\n<pre><code>Sub InsertData()\n\n\nDim wsCopy As Worksheet\nDim wsDest As Worksheet\nDim lCopyLastRow As Long\nDim lDestLastRow As Long\n\n  'Set variables for copy and destination sheets\n  Set wsCopy = Workbooks(\"Warranty Template.xlsm\").Worksheets(\"PivotTable\")\n  Set wsDest = Workbooks(\"QA Matrix Template.xlsm\").Worksheets(\"Plant Sheet\")\n\n  '1. Find last used row in the copy range based on data in column A\n  lCopyLastRow = wsCopy.Cells(wsCopy.Rows.Count, \"A5\").End(xlUp).Row\n\n  '2. Find first blank row in the destination range based on data in column A\n  'Offset property moves down 1 row\n  lDestLastRow = wsDest.Cells(wsDest.Rows.Count, \"D12\").End(xlUp).Offset(1).Row\n\n  '3. Copy &amp; Paste Data\n  wsCopy.Range(\"A5\" &amp; lCopyLastRow).Copy _\n    wsDest.Range(\"D12\" &amp; lDestLastRow)\n\nEnd Sub\n</code></pre>\n\n<p>I am getting Subscript Error: '1004' and I am not sure why. It has to do with my <code>lCopyLastRow</code> &amp; <code>lDestLastRow</code> variables. The code works if I set static ranges but I need these ranges to be dynamic.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1562765608, "post_id": 56971797, "comment_id": 100480158, "body": "You need to specify which worksheet you working from. Who knows which sheet is active when this line runs <code>If Cells(i, 1) * 1 &gt;= x * 1 Then</code>? You can also avoid using <code>.Activate</code> or <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\"><code>.Select</code></a>. In fact, copy pasting can be done in one line, preventing Excel to store data onto the clipboard. Most of the time, copy pasting can be avoided alltogether. That being said, what line do you get an error on?"}, {"owner": {"reputation": 133, "user_id": 4040720, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QvfTgm9_FVA/AAAAAAAAAAI/AAAAAAAAAGc/y3T4WN6XCq8/photo.jpg?sz=128", "display_name": "flamingbird123", "link": "https://stackoverflow.com/users/4040720/flamingbird123"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562765748, "post_id": 56971797, "comment_id": 100480225, "body": "I added the Line in which I get the error on.  I made the form open on another sheet called &quot;Form.&quot; The form is opened when a button is pressed. And when a button is pressed on the form it runs the module."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 4040720, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QvfTgm9_FVA/AAAAAAAAAAI/AAAAAAAAAGc/y3T4WN6XCq8/photo.jpg?sz=128", "display_name": "flamingbird123", "link": "https://stackoverflow.com/users/4040720/flamingbird123"}, "edited": false, "score": 0, "creation_date": 1562766227, "post_id": 56971914, "comment_id": 100480451, "body": "Thanks I tried that, and it does solve the error. But, it would only print the row the 1st date and not the second"}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "reply_to_user": {"reputation": 133, "user_id": 4040720, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QvfTgm9_FVA/AAAAAAAAAAI/AAAAAAAAAGc/y3T4WN6XCq8/photo.jpg?sz=128", "display_name": "flamingbird123", "link": "https://stackoverflow.com/users/4040720/flamingbird123"}, "edited": false, "score": 1, "creation_date": 1562766738, "post_id": 56971914, "comment_id": 100480761, "body": "@flamingbird123, I have rewritten your entire code and that should work."}], "tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 2, "last_activity_date": 1562766600, "last_edit_date": 1562766600, "creation_date": 1562765713, "answer_id": 56971914, "question_id": 56971797, "link": "https://stackoverflow.com/questions/56971797/run-time-error-1004-application-defined-or-object-defined-error/56971914#56971914", "title": "Run-Time Error &#39;1004&#39;: Application Defined or Object-Defined Error", "body": "<p>First you should <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">avoid using Select in VBA</a>. There, almost always, are better ways to achieve whatever you are using <code>Select</code> for.</p>\n\n<p>In your case, <strong>and regarding only the specific error/question raised</strong>, delete the error-causing line and the next line (<code>Selection.Copy</code>) and replace with this:</p>\n\n<pre><code>With Sheets(\"Unit2Data\")\n    .Range(.Cells(i, 1), .Cells(i, 73)).Copy\nEnd With\n</code></pre>\n\n<p><strong>Rewriting your entire code to avoid using <code>Select</code>:</strong></p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Unit2Data()\nDim lrow As Long, i As Long, x As Date, y As Date, erow As Long\n\nx = TxtDateStart\ny = TxtDateEnd\n\nWith Sheets(\"Unit2Data\")\n    lrow = .Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    For i = 4 To lrow\n        If .Cells(i, 1) * 1 &gt;= x * 1 Then\n            If .Cells(i, 1) * 1 &lt;= y * 1 Then\n                With Sheets(\"Graphing Sheet\")\n                    erow = .Cells(.Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n                End With\n                .Range(.Cells(i, 1), .Cells(i, 73)).Copy _\n                    Destination:= Sheets(\"Graphing Sheet\").Cells(erow, 1)\n            End If\n        End If\n    Next i\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 4040720, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-QvfTgm9_FVA/AAAAAAAAAAI/AAAAAAAAAGc/y3T4WN6XCq8/photo.jpg?sz=128", "display_name": "flamingbird123", "link": "https://stackoverflow.com/users/4040720/flamingbird123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 56971914, "answer_count": 1, "score": 1, "last_activity_date": 1562766600, "creation_date": 1562765295, "last_edit_date": 1562766433, "question_id": 56971797, "link": "https://stackoverflow.com/questions/56971797/run-time-error-1004-application-defined-or-object-defined-error", "title": "Run-Time Error &#39;1004&#39;: Application Defined or Object-Defined Error", "body": "<p>I am trying to copy and paste data from one sheet to the next from a selected range entered by the user. TxtDateStart takes the start date, and TxtDateEnd takes the end date. Then it would copy and paste the data from the range of dates to a new sheet. \nWhen I run the code in a form, it works but I rather have the form call the module. This is where I get the run-time error. I'm no expert in VBA, help would be appreciated. \nThe sheet where the data is is called Unit2Data, and the sheet i want to paste the data is Graphing Sheet. </p>\n\n<p>The error occurs in this line </p>\n\n<pre><code>Sheets(\"Unit2Data\").Range(Cells(i, 1), Cells(i, 73)).Select\n</code></pre>\n\n<pre><code>Sub Unit2Data()\n\nDim lrow As Long, i As Long, x As Date, y As Date, erow As Long\n\nx = TxtDateStart\ny = TxtDateEnd\n\n'Find the Last Row of Sheet1\nlrow = Sheets(\"Unit2Data\").Range(\"A\" &amp; Rows.Count).End(xlUp).Row\n\n'start counting from row 3 to last row\nFor i = 4 To lrow\n' Date value converted as numeric value by multiplying with number 1\nIf Cells(i, 1) * 1 &gt;= x * 1 Then\nIf Cells(i, 1) * 1 &lt;= y * 1 Then\n\n'If above conditions matched then select the matched range/ entire column\n\nSheets(\"Unit2Data\").Range(Cells(i, 1), Cells(i, 73)).Select\n\n'copy the selected row\nSelection.Copy\n\n'to make sheet2 active where we want to paste the selected row\nSheets(\"Graphing Sheet\").Activate\n\n\n'to find the empty row from where the copied row of sheet1 to be pasted in sheet2\nerow = Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).Row\n\n'to activate or select the empty row of sheet2\nActiveSheet.Cells(erow, 1).Select\n\n'paste the copied data\nActiveSheet.Paste\n\n'to deselect the copy and selected mode\nApplication.CutCopyMode = False\n\n'for above the if we need 3 end if to close if conditions\nEnd If\nEnd If\n'to activate sheet1 for searching the matched data\nSheets(\"Unit2Data\").Activate\n'continue for look until above matched found\nNext i\nEnd Sub\n</code></pre>\n\n<pre><code>Date              Data \n01/01/2019          2\n02/02/2019          3\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11509084"}, "edited": false, "score": 0, "creation_date": 1562765522, "post_id": 56971516, "comment_id": 100480115, "body": "If the copy is using the same subforms as the original then it is likely that one of the subforms is what is causing the delay.  If the subform has already loaded into the original then it might not need to do (whatever it is it does) again.  The way to prove this would be to delete the copy, load the subforms and then open the original main form and see if it now loads instantly."}, {"owner": {"reputation": 1, "user_id": 2943196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e0f2161e06d9e73543e326dd67a57ef?s=128&d=identicon&r=PG&f=1", "display_name": "mkrause", "link": "https://stackoverflow.com/users/2943196/mkrause"}, "edited": false, "score": 0, "creation_date": 1562769644, "post_id": 56971516, "comment_id": 100482567, "body": "Thanks Gareth.  If I understand your suggestion, that was my plan but before removing any of the subforms from the copy and with the original main form closed, I opened the copy and it opened instantly. It seems to me that there might be some referencing of the original form that can happen more efficiently from a copy than it can if there&#39;s only one instance of the original form.  In other words, self-referencing causes thrashing but referencing of a duplicate results in no thrashing.  If this is a valid thought, it seems I might get an &quot;out of stack space&quot; error... but that&#39;s not happening."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2943196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e0f2161e06d9e73543e326dd67a57ef?s=128&d=identicon&r=PG&f=1", "display_name": "mkrause", "link": "https://stackoverflow.com/users/2943196/mkrause"}, "is_accepted": false, "score": 0, "last_activity_date": 1562934124, "creation_date": 1562934124, "answer_id": 57006939, "question_id": 56971516, "link": "https://stackoverflow.com/questions/56971516/very-slow-loading-access-form/57006939#57006939", "title": "Very slow loading Access form", "body": "<p>I've solved my problem but without a complete root cause understanding.\nWhile troubleshooting, as noted in my original problem statement, I noticed some unusual behavior that seemed to be associated with the form name.\nIn the end, I renamed the form, updated the call to it and Shazam!, problem solved.  The form now opens instantly and without any other changes.\nFor the record, the app consists of 160 forms, 44 code modules and 12 class modules.\nGareth, thank you for your input.\nIf anyone has any thoughts about what might have been the root cause, I'll very gladly look further but for now I need to move forward with development.</p>\n"}], "owner": {"reputation": 1, "user_id": 2943196, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e0f2161e06d9e73543e326dd67a57ef?s=128&d=identicon&r=PG&f=1", "display_name": "mkrause", "link": "https://stackoverflow.com/users/2943196/mkrause"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562934124, "creation_date": 1562764385, "last_edit_date": 1562779546, "question_id": 56971516, "link": "https://stackoverflow.com/questions/56971516/very-slow-loading-access-form", "title": "Very slow loading Access form", "body": "<p>I'm refactoring our Access app that currently has an Access backend to now use a SQL Server backend.\nAll but one form are now loading and working very well but one form, by no means the most complex or the most simple, takes about 1 minute or more to load.</p>\n\n<p>My plan was to create a copy, remove subforms from the copy and check it's load time to determine whether one of the subforms was the delay but with NO changes from the original, the copy loads immediately, provided the original is in place.  If I delete the original, the copy takes 1 minute or more to load.\nDoes anyone have any thoughts about what might be happening?</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 1, "creation_date": 1562764617, "post_id": 56971514, "comment_id": 100479625, "body": "First issue: does the performance improve if you comment out writing to Excel cells? Does the performance improve if you remove the <code>Worksheet_SelectionChange</code> function? Are there are event handlers?"}, {"owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "reply_to_user": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562764925, "post_id": 56971514, "comment_id": 100479815, "body": "@\u0141ukaszNojek I&#39;ve just tried, the performance is significantly better and most importantly linear without writing to the Excel cells. There is no performance change when the <code>Worksheet_SelectionChange</code> event is empty of code. I didn&#39;t get your question about event handlers, can you develop on it ?"}, {"owner": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562765864, "post_id": 56971514, "comment_id": 100480287, "body": "I understand that you checked both cases separately - not writing to Excel with the SelectionChanged sub, and writing to Excel without the SelectionChanged sub? By event handlers I meant functions similar to <code>Worksheet_SelectionChange</code>. Are there any other?"}, {"owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "reply_to_user": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562766276, "post_id": 56971514, "comment_id": 100480475, "body": "The only other event on the sheet is <code>Worksheet_Activate</code>, that I&#39;ve also emptied during the test. I&#39;ve tested both cases separately and together, to be sure they didn&#39;t impact each other. Result went accordingly to what was described."}, {"owner": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562767497, "post_id": 56971514, "comment_id": 100481236, "body": "Do you do any formatting to the rows/cells? Can you show the code that writes a row? I try to do as many bulk operations as possible, so e.g. I don&#39;t set format on a cell in 3rd column immediately when creating a new row, but I set format for the entire 3rd column or range &quot;C2:C700&quot; at once after I finished writing."}, {"owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "reply_to_user": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562767732, "post_id": 56971514, "comment_id": 100481385, "body": "I actually do, yeah. I&#39;ll move all the formatting to the step following all the writing, and edit this comment with the perf. result."}, {"owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "reply_to_user": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562769045, "post_id": 56971514, "comment_id": 100482204, "body": "The performance while writing is indeed better, but the slow down takes effect on all the formatting now, being overall slower :("}, {"owner": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562769223, "post_id": 56971514, "comment_id": 100482322, "body": "I could see if I can help if you shared some example that is slow. I have no further generic ideas ;)."}, {"owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "reply_to_user": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562770572, "post_id": 56971514, "comment_id": 100483112, "body": "I&#39;ll see what I can do about that :)"}, {"owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "reply_to_user": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562771484, "post_id": 56971514, "comment_id": 100483637, "body": "Would you accept moving it to chat ? It would be more fitting to our conversation, i think"}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1562771963, "post_id": 56971514, "comment_id": 100483916, "body": "I would post all code there may be room for improvement - I believe that arrays are faster than collections, where did you read otherwise? - great observation re the slowdown over time - maybe has to do with memory allocation?"}, {"owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "edited": false, "score": 1, "creation_date": 1562773118, "post_id": 56971514, "comment_id": 100484559, "body": "All code represents over 2000 actual lines of code, not including comments and blanks. Plus its company work, i can&#39;t just publish that online. I&#39;m trying to isolate parts of the code that may be related. It does look like its related to memory allocation, since closing &amp; reopening the file does the job, but i can&#39;t find in what way."}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1562779278, "post_id": 56971514, "comment_id": 100487696, "body": "still learning but you may want to take care to set objects = nothing see the following: <a href=\"https://stackoverflow.com/a/38850956/9721351\">stackoverflow.com/a/38850956/9721351</a>"}, {"owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "reply_to_user": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 1, "creation_date": 1562791183, "post_id": 56971514, "comment_id": 100492639, "body": "I&#39;ll watch that closely, thanks @learnAsWeGo, you taught me something!"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 1, "creation_date": 1562796001, "post_id": 56971514, "comment_id": 100494241, "body": "Consider reading your data into an array, and then inserting that in one hit into the Excel sheet. Then hide the relevant rows in one command/function (what that looks like will depend on how you choose rows to hide). This approach should significantly improve performance. Of course, without any code and sample (sanitised/anonymised) data can&#39;t provide specific hints."}, {"owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1562832975, "post_id": 56971514, "comment_id": 100504191, "body": "@AJD It is indeed a lot faster just sending an array to a range, it helped a lot. @learnAsWeGo setting objets to Nothing does help, but it is not very noticeable because i use a lot of primitives. Right now I use a <code>Application.SaveWorkspace</code> every 100 frames and it does the job. Despite pausing for a second, the amount of time saved afterward is a very good compensation. (question updated to add this)"}, {"owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "edited": false, "score": 0, "creation_date": 1562855753, "post_id": 56971514, "comment_id": 100517854, "body": "For whoever follows this thread, problem is solved, explanations in EDIT2 of the question. Thanks !"}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1562859725, "post_id": 56971514, "comment_id": 100520228, "body": "@ape I wonder why application.saveworkspace would speed up?"}, {"owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "edited": false, "score": 0, "creation_date": 1562860954, "post_id": 56971514, "comment_id": 100520873, "body": "I&#39;m not sure, it also created an additional file (extension was .xl something) that referred to the Excel file. To be honest, the speedup was seen once, may be a fluke. I should delete that from the main post, maybe"}, {"owner": {"reputation": 2207, "user_id": 3088510, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WDADX.png?s=128&g=1", "display_name": "learnAsWeGo", "link": "https://stackoverflow.com/users/3088510/learnaswego"}, "edited": false, "score": 0, "creation_date": 1562870634, "post_id": 56971514, "comment_id": 100525187, "body": "@ape maybe it moves memory out of RAM into hardrive or ssd?"}], "owner": {"reputation": 11, "user_id": 11640714, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/567dea621ed56c95b9e8032a232e40e9?s=128&d=identicon&r=PG&f=1", "display_name": "ape", "link": "https://stackoverflow.com/users/11640714/ape"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1562855596, "creation_date": 1562764382, "last_edit_date": 1562855596, "question_id": 56971514, "link": "https://stackoverflow.com/questions/56971514/performance-leak-at-runtime-with-vba", "title": "Performance leak at runtime with VBA", "body": "<p>I created an Excel sheet with a VBA macro. The data written is read from a binary file. From this binary file, I consider every x byte represents a frame. A frame is written on a row, with a header.</p>\n\n<p><strong>First issue :</strong>\nAs I write those data, there is a noticeable performance leak over time : the first 250 frames are done under a minute, then the next 150 take one minute. Overall, at the beginning of the process, ~10 frames are done in 1 second. After a few hundreds of frames, it takes more than a second to process 1 frame. Time is measured by hand, according to a progress bar.</p>\n\n<p><strong>Second issue :</strong>\nI have a <code>Worksheet_SelectionChange</code> event on the sheet that calls <code>Cells(row, 1).EntireRow.Hidden</code> setting it to <code>True</code> or <code>False</code> depending on the situation. After some debugger inspection, I have realized those instructions take an increasing amount of time depending on the amount of data written during the session. Example, it takes a good 10 seconds with ~400 frames.</p>\n\n<p><strong>Now the part that makes me think there is room for improvement :</strong> \nIf I save the file, close it, reopen it, and change the selection, <code>Cells(row, 1).EntireRow.Hidden</code> takes an insignificant amount of time. I'd even say, the expected amount of time.\nIf I only save the file and keep it open, there is no noticeable change.</p>\n\n<p><strong>What's I've tried :</strong>\nIn order to improve performances, at the beginning of the main sub, I call :</p>\n\n<pre><code>    Application.ScreenUpdating = False\n    Application.EnableEvents = False\n    Application.AskToUpdateLinks = False\n    Application.DisplayAlerts = False\n    Application.Calculation = xlcalculationmanual\n    ThisWorkbook.Date1904 = False\n    ActiveWindow.View = xlNormalView\n</code></pre>\n\n<p>(and swap them back to their original values at the end)</p>\n\n<p>I already avoid as much as possible the use of <code>Select</code> and <code>Activate</code>.\nI also avoid arrays, using Collections instead, since I've read its faster.\nI use the <code>With</code> statement whenever necessary.\nI make sure the <code>Worksheet_SelectionChange</code> is disabled before writing into the file.</p>\n\n<p>I believe both issues are related, but I do not understand what is the cause or how I can solve it. What am I doing wrong ?</p>\n\n<p><strong>EDIT:</strong>\nUsing <code>Application.SaveWorkspace</code> every 100 frames does the job : it pauses the process (visibly thanks to the progress bar) for ~2 seconds but the amount of time saved to process the next 100 frames is entirely compensated.\nI think that my problem is solved now, unless there is a cleaner way to do that. Thanks a lot to all of you in comments !</p>\n\n<p><strong>EDIT 2 :</strong>\nProblem solved : I was adding comments to some cells, using <code>selectedCell.Comment.Shape.TextFrame.AutoSize = True</code> every time like so :</p>\n\n<pre><code>    With sheet.Cells(row, column)\n        .AddComment txt\n        .Comment.Shape.TextFrame.AutoSize = True\n    End With\n</code></pre>\n\n<p>The goal being to make them look pretty. For some reasons, this is what was slowing down the whole process each time it was called.</p>\n\n<p>Instead, I now call the following snippet at the very end.\nFor the information, 100 frames are now processed in under 10s, and the process time is constant. For ~400 frames, the following snippet took 16s (approx).</p>\n\n<pre><code>    Dim comment As Comment\n    For Each comment In sheet.Comments\n        comment.Shape.TextFrame.AutoSize = True\n    Next comment\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562764440, "post_id": 56971475, "comment_id": 100479501, "body": "<code>Sheets</code> not <code>Sheet</code>."}, {"owner": {"reputation": 1, "user_id": 11754621, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v3JxTkPErqw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3refUxLZKDc8mdV_tcdpm5f-KF39yA/photo.jpg?sz=128", "display_name": "JAY LEWIS", "link": "https://stackoverflow.com/users/11754621/jay-lewis"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562765862, "post_id": 56971475, "comment_id": 100480283, "body": "i get a runtime error for that also which is subscript is out of range"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562766677, "post_id": 56971475, "comment_id": 100480727, "body": "Then there&#39;s no sheet of that name in the workbook."}, {"owner": {"reputation": 1, "user_id": 11754621, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v3JxTkPErqw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3refUxLZKDc8mdV_tcdpm5f-KF39yA/photo.jpg?sz=128", "display_name": "JAY LEWIS", "link": "https://stackoverflow.com/users/11754621/jay-lewis"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562767147, "post_id": 56971475, "comment_id": 100481009, "body": "the excel workbook has multiple sheets but i only want certain sheets that can be used for simulations. so i only mapped the worksheets that are needed for running sims"}, {"owner": {"reputation": 1, "user_id": 11754621, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v3JxTkPErqw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3refUxLZKDc8mdV_tcdpm5f-KF39yA/photo.jpg?sz=128", "display_name": "JAY LEWIS", "link": "https://stackoverflow.com/users/11754621/jay-lewis"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562845950, "post_id": 56971475, "comment_id": 100511645, "body": "I figured it out thanks"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562849576, "post_id": 56971475, "comment_id": 100513926, "body": "It would be good if you could post your solution."}], "owner": {"reputation": 1, "user_id": 11754621, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-v3JxTkPErqw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3refUxLZKDc8mdV_tcdpm5f-KF39yA/photo.jpg?sz=128", "display_name": "JAY LEWIS", "link": "https://stackoverflow.com/users/11754621/jay-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562770394, "creation_date": 1562764286, "last_edit_date": 1562770394, "question_id": 56971475, "link": "https://stackoverflow.com/questions/56971475/runtime-error-438-object-dosent-support-this-property-or-method", "title": "runtime error &#39;438&#39; object dosent support this property or method", "body": "<p>I try to run my code but get a runtime error when I try to store the variables in sht1 and sht2 to get the worksheets based on index</p>\n\n<p>ive tried to set the array \"lasSheets(i) and dataPull(i)\" to sht1 and sht2 so it can just select the array value at index i but I get a \"compiler error: Expected Sub, Function or Property\" so i ran out of ideas of what to do next</p>\n\n<pre><code> Private Sub CommandButton1_Click()\n    Dim source As Workbook\n    Dim sht1 As Worksheet\n    Dim destination As Workbook\n    Dim sht2 As Worksheet\n    Dim tmp As String\n    Dim startCell As Range\n    Dim lastRow As Long\n    Dim lastColumn As Long\n    Dim i As Integer\n    Dim mapDest As String\n    Dim mapSrc As String\n\n    setFile = Application.GetOpenFilename   'used to open the browser window\n    tmp = setFile                           'store the selected file in variable tmp\n    Application.ScreenUpdating = False      'preventing long runtimes\n\n    If Dir(tmp) &lt;&gt; \"\" Then\n    Set destination = ThisWorkbook     'workbook b1 is declared as the current worksheet opened\n    Set source = Workbooks.Open(tmp)      'the file the user selected is opened in excel\n\n    Dim lasSheets(1 To 9) As String        'array to list the sheet names\n\n    lasSheets(1) = \"L1 OVERVIEW\"\n    lasSheets(2) = \"LAS EFFL RELEASE PARAMS\"\n    lasSheets(3) = \"L1 EAL PARAMS rev4\"\n    lasSheets(4) = \"L1 EAL PARAMS\"\n    lasSheets(5) = \"L1 RAD STATUS\"\n    lasSheets(6) = \"L1 PLANT STATUS\"\n    lasSheets(7) = \"L1 CDAM\"\n    lasSheets(8) = \"L1 ERDS\"\n    lasSheets(9) = \"LAS STATE UPDATES\"\n\n    Dim dataPull(1 To 9) As String\n    dataPull(1) = \"Overview Paste\"\n    dataPull(2) = \"Eff Release Para Paste\"\n    dataPull(3) = \"EAL Rev4 Paste\"\n    dataPull(4) = \"EAL Para Paste\"\n    dataPull(5) = \"Radiological Stat Paste\"\n    dataPull(6) = \"Plant Status Paste\"\n    dataPull(7) = \"CDAM Paste\"\n    dataPull(8) = \"ERDS Paste\"  ' blank sheet\n    dataPull(9) = \"State Updates Paste\"   'blank sheet\n\n    For i = 1 To 9\n      mapSrc = lasSheets(i)\n      mapDest = dataPull(i)\n    i = i + 1\n     Set sht1 = source.Sheet(mapSrc)            '&lt;-- errors here set sht1 and sht2 to the source and destination worksheets   \n     Set sht2 = destination.Sheet(mapDest)  \n\n    Set startCell = sht1.Range(\"B2\")\n\n    'find last row and last column\n     lastRow = sht1.Cells(sht1.Rows.Count, startCell.Column).End(xlUp).Row\n     lastColumn = sht1.Cells(startCell.Row, sht1.Columns.Count).End(xlToLeft).Column\n\n     sht2.Range(startCell, sht1.Cells(lastRow, lastColumn).Address).Copy destination:=sht1.Range(\"D5\")\n\n    Application.CutCopyMode = False\n    Next i\n    destination.Close True\n\n    Else                                'used to prevent a error message from popping up when the user choose to cancel selecting a file\n\n    End If\n    End Sub\n</code></pre>\n\n<p>I expect the for loop to loop through both the arrays and output the excel worksheets based on index number within both the arrays</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1562762493, "post_id": 56970854, "comment_id": 100478353, "body": "Examine the contents of folders() before and after the redim"}, {"owner": {"reputation": 37, "user_id": 9920284, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Hg8wNfCxuak/AAAAAAAAAAI/AAAAAAAABmw/ULFdbz6Wd1c/photo.jpg?sz=128", "display_name": "ms_queen", "link": "https://stackoverflow.com/users/9920284/ms-queen"}, "reply_to_user": {"reputation": 3723, "user_id": 1169091, "user_type": "registered", "accept_rate": 9, "profile_image": "https://i.stack.imgur.com/5vE4L.jpg?s=128&g=1", "display_name": "nicomp", "link": "https://stackoverflow.com/users/1169091/nicomp"}, "edited": false, "score": 0, "creation_date": 1562762590, "post_id": 56970854, "comment_id": 100478408, "body": "Can you provide code.. I don&#39;t understand how to do that. Thanks for your help!"}, {"owner": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562768725, "post_id": 56970854, "comment_id": 100482004, "body": "Can you explain what is the problem?"}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1562769499, "post_id": 56970854, "comment_id": 100482477, "body": "Your problem is that <code>Dir</code> with no parameters links to the latest <code>Dir</code> with parameters.  You start with \u201cC:\\directory\u201d.  You must extract all files from that directory before looking at \u201cC:\\directory\\X\u201d and \u201cC:\\directory\\Y\u201d.  You must save the subfolders of each folder in private storage as you extract its files.  Only when processing of a folder is complete can you use <code>Dir</code> on a different folder.  I am busy this afternoon, if no one has posted a solution by this evening, I will create something for you."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1562769516, "post_id": 56970854, "comment_id": 100482486, "body": "It would be helpful if you posted more information about your requirement.  For example, does it matter what sequence folders and files are listed?  Sorting folders and files by name, or some other parameter, will make the solution more complicated."}, {"owner": {"reputation": 37, "user_id": 9920284, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Hg8wNfCxuak/AAAAAAAAAAI/AAAAAAAABmw/ULFdbz6Wd1c/photo.jpg?sz=128", "display_name": "ms_queen", "link": "https://stackoverflow.com/users/9920284/ms-queen"}, "reply_to_user": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1562769877, "post_id": 56970854, "comment_id": 100482711, "body": "@TonyDallimore There is no sorting required."}, {"owner": {"reputation": 37, "user_id": 9920284, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Hg8wNfCxuak/AAAAAAAAAAI/AAAAAAAABmw/ULFdbz6Wd1c/photo.jpg?sz=128", "display_name": "ms_queen", "link": "https://stackoverflow.com/users/9920284/ms-queen"}, "reply_to_user": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562769902, "post_id": 56970854, "comment_id": 100482722, "body": "@\u0141ukaszNojek the issue is that not all files in all folders are pulled, only some. That is stated above."}, {"owner": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 1, "creation_date": 1562770516, "post_id": 56970854, "comment_id": 100483078, "body": "@ms_queen This is a very specific and problematic folder traversing routine. For example, you exclude files starting with dot, like <code>.config</code> in line <code>If Left(fileName, 1) &lt;&gt; &quot;.&quot; Then</code>. It might be easier to find another solution online (there are many) than to fix it."}, {"owner": {"reputation": 37, "user_id": 9920284, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Hg8wNfCxuak/AAAAAAAAAAI/AAAAAAAABmw/ULFdbz6Wd1c/photo.jpg?sz=128", "display_name": "ms_queen", "link": "https://stackoverflow.com/users/9920284/ms-queen"}, "reply_to_user": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562771561, "post_id": 56970854, "comment_id": 100483678, "body": "@\u0141ukaszNojek I did find another solution but still cannot accomplish what I need to. I need to also change file names in subfolderss"}, {"owner": {"reputation": 1285, "user_id": 1454656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/561bed0472fea7af0e48404f8a548ac0?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz Nojek", "link": "https://stackoverflow.com/users/1454656/%c5%81ukasz-nojek"}, "edited": false, "score": 0, "creation_date": 1562771922, "post_id": 56970854, "comment_id": 100483892, "body": "@ms_queen <code>sNewName = FSOFolder.Path &amp; ...</code>. FSOSubFolder is not accessible in that line."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1562773925, "post_id": 56970854, "comment_id": 100485062, "body": "Have you considered opening the Command Prompt under Windows System and typing &quot;Dir C:\\directory &gt; C:\\Directory\\Dir.Txt&quot;?  Everything you want will be in file Dir.Txt although the format is not particularly convenient.  The possible advantage of the Command Prompt Dir is the number of formatting and sorting options.  The Command Prompt would also give you access to Rename which offers powerful options for renaming files."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1562773939, "post_id": 56970854, "comment_id": 100485071, "body": "To get a list of all the Dir options type \u201cHelp Dir\u201d.  To get the syntax of Rename type \u201cHelp Rename\u201d although the syntax does not show the power of this command.  For example, you can use wild cards to change multiple similar files in a single command."}, {"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1562773958, "post_id": 56970854, "comment_id": 100485082, "body": "For more information, look up \u201cWindows Batch files\u201d or, if you give more information on your objective, I can provide some examples."}], "answers": [{"tags": [], "owner": {"reputation": 24734, "user_id": 2665425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OhiJt.png?s=128&g=1", "display_name": "tigeravatar", "link": "https://stackoverflow.com/users/2665425/tigeravatar"}, "is_accepted": false, "score": 0, "last_activity_date": 1562773536, "last_edit_date": 1562773536, "creation_date": 1562772892, "answer_id": 56974128, "question_id": 56970854, "link": "https://stackoverflow.com/questions/56970854/loop-through-all-subfolders/56974128#56974128", "title": "Loop through all subfolders", "body": "<p>Here is a good, generic solution that can meet basically any search folder and its subfolders requirements.  It is a function that calls itself recursively and outputs a dictionary object containing the complete results, code commented for clarity:</p>\n\n<pre><code>Public Function SearchDirectory(ByVal arg_sFolderPath As String, _\n                                Optional ByVal arg_sSearch As String = \"*\", _\n                                Optional ByVal arg_bMatchCase As Boolean = False, _\n                                Optional ByVal arg_bIncludeSubFolders As Boolean = True, _\n                                Optional ByRef arg_hResults As Object) _\n  As Object\n'Purpose of this function is to search a directory (and probably all of its subfolders)\n'for files that match an optionally provided search string, and the match may or may\n'not be case sensitive. It then collects all of the results in a dictionary object and\n'returns that dictionary object as the function output\n'\n'Parameters:\n'  arg_sFolderPath:         [Required][String]              -The folder path of the original directory that will be searched\n'\n'  arg_sSearch:             [Optional][String]              -A pattern that will be matched against.\n'                                                           -For example, to find all Excel files you would use \"*.xls*\"\n'                                                           -Default value is \"*\" which will return all files\n'\n'  arg_bMatchCase:          [Optional][Boolean]             -Specifies whether or not to match arg_sSearch as case sensitive\n'                                                           -For example, if this is set to True and the arg_sSearch is set to \"*.xls*\",\n'                                                            then an Excel file named \"EXCELFILE.XLSX\" would NOT be found\n'                                                           -Default value is False which will make matches not case sensitive\n'\n'  arg_bIncludeSubFolders   [Optional][Boolean]             -Specifies whether or not to search all subfolders recursively\n'                                                           -Default value is True which will include results in all subfolders\n'\n'  arg_hResults             [Optional][Dictionary Object]   -An existing dictionary object to hold the results in\n'                                                           -Typically this will not be provided on initial call, and is used\n'                                                            during recursive calls to store all relevant results for output\n'\n'Author: tigeravatar on stackoverflow at https://stackoverflow.com/questions/56970854/loop-through-all-subfolders\n'Created: July 10, 2019\n\n    'Static so that during recursive search it doesn't need to be recreated on every recursive call\n    Static oFSO As Object\n    If oFSO Is Nothing Then Set oFSO = CreateObject(\"Scripting.FileSystemObject\")\n\n    'Check if arg_hResults was provided (typically not on first call, but will be on all subsequent recursive calls)\n    'This preserves all found matching file results throughout all recursive calls of the function\n    Dim hResults As Object\n    If arg_hResults Is Nothing Then Set hResults = CreateObject(\"Scripting.Dictionary\") Else Set hResults = arg_hResults\n\n    'Variable used to store the folder path separator\n    Dim sPS As String\n    sPS = Application.PathSeparator\n\n    'Adjust so that even if folder path isn't passed with an ending Path Separator, the function can handle it appropriately\n    Dim sFolderPath As String\n    If Right(arg_sFolderPath, Len(sPS)) = sPS Then sFolderPath = arg_sFolderPath Else sFolderPath = arg_sFolderPath &amp; sPS\n\n    'Verify the folder path provided is valid.  Allow for hidden folders to be searched as well\n    If Len(Dir(sFolderPath, vbDirectory + vbHidden)) = 0 Then\n        MsgBox \"Invalid directory path provided: \" &amp; Chr(10) &amp; arg_sFolderPath, , \"Search Directory Error\"\n        Set SearchDirectory = Nothing\n        Exit Function\n    End If\n\n    'Using the FileSystemObject, work with the provided and validated folder path\n    Dim oFolder As Object\n    Set oFolder = oFSO.GetFolder(sFolderPath)\n\n    'Loop through all files in the folder\n    Dim oFile As Object\n    Dim bMatch As Boolean\n    For Each oFile In oFolder.Files\n        'Verify the file matches the provided search pattern (if any) according to case sensitivity\n        bMatch = False\n        If arg_bMatchCase = True Then\n            If oFile.Name Like arg_sSearch Then bMatch = True\n        Else\n            If LCase(oFile.Name) Like LCase(arg_sSearch) Then bMatch = True\n        End If\n\n        'If match found, add it to the hResults dictionary\n        If bMatch = True Then\n            If Not hResults.Exists(oFile.Path) Then hResults.Add oFile.Path, oFile.Path\n        End If\n    Next oFile\n\n    'If set to search subfolders (default behavior), have the function recursively call itself to search all subfolders\n    If arg_bIncludeSubFolders = True Then\n        Dim oSubFolder As Object\n        For Each oSubFolder In oFolder.SubFolders\n            Set hResults = SearchDirectory(oSubFolder.Path, arg_sSearch, arg_bMatchCase, arg_bIncludeSubFolders, hResults)\n        Next oSubFolder\n    End If\n\n    'Set function output to the hResults dictionary if it contains any matched file results\n    If hResults Is Nothing Then\n        Set SearchDirectory = Nothing\n    Else\n        If hResults.Count = 0 Then Set SearchDirectory = Nothing Else Set SearchDirectory = hResults\n    End If\n\nEnd Function\n</code></pre>\n\n<p>This is an example of how to use the function and work with its results:</p>\n\n<pre><code>Sub tgr()\n\n    'Create an object variable and set it to the function SearchDirectory\n    'Provide SearchDirectory arguments as desired\n    Dim hFoundFiles As Object\n    Set hFoundFiles = SearchDirectory(\"C:\\Test\")\n\n    'Verify it actually found files matching your criteria in the folder specified\n    If hFoundFiles Is Nothing Then Exit Sub  'Didn't return any results\n\n    'Can output results to a worksheet\n    ActiveWorkbook.ActiveSheet.Range(\"A1\").Resize(hFoundFiles.Count).Value = Application.Transpose(hFoundFiles.Keys)\n\n    'Can loop through each result if you need to do something with them individually\n    Dim vFile As Variant\n    For Each vFile In hFoundFiles.Keys\n        'Do something here\n        Debug.Print vFile\n    Next vFile\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9920284, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Hg8wNfCxuak/AAAAAAAAAAI/AAAAAAAABmw/ULFdbz6Wd1c/photo.jpg?sz=128", "display_name": "ms_queen", "link": "https://stackoverflow.com/users/9920284/ms-queen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 313, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562773536, "creation_date": 1562762168, "last_edit_date": 1562772021, "question_id": 56970854, "link": "https://stackoverflow.com/questions/56970854/loop-through-all-subfolders", "title": "Loop through all subfolders", "body": "<p>I am trying to loop through all subfolders. This script works but then only pulls some folders and not others. I need it to pull all files in the folder. I did not create this full script but would like to modify it.</p>\n\n<p>UPDATE:</p>\n\n<p>I tried this alternate solution below and it works.</p>\n\n<pre><code>Sub loopAllSubFolderSelectStartDirectory()\n\nDim FSOLibrary As Object\nDim FSOFolder As Object\nDim folderName As String\n\n  'Set the folder name to a variable\n  folderName = \"C:\\Users\\dreid_000\\Desktop\\PhaseII\\\"\n\n  'Set the reference to the FSO Library\n  Set FSOLibrary = CreateObject(\"Scripting.FileSystemObject\")\n\n 'Another Macro must call LoopAllSubFolders Macro to start\n  LoopAllSubFolders FSOLibrary.GetFolder(folderName)\n\n  End Sub\n</code></pre>\n\n<hr>\n\n<pre><code>Sub LoopAllSubFolders(FSOFolder As Object)\n\nDim FSOSubFolder As Object\nDim FSOFile As Object\nDim soldname As String\nDim sNewName As String\nDim sTempFile() As String\nDim sPath As String\nSet Fso = CreateObject(\"Scripting.FileSystemObject\")\n\n\n   'For each subfolder call the macro\n   For Each FSOSubFolder In FSOFolder.subfolders\n   LoopAllSubFolders FSOSubFolder\n   Next\n\n   'For each file, print the name\n   For Each FSOFile In FSOFolder.Files\n\n'Insert the actions to be performed on each file\n    FSOFile.Name = \"PhaseII.xlsx\"\n'This example will print the full file path to the immediate window\n    Debug.Print FSOFile.Path\n\n\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3229, "user_id": 11643528, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kc3Zt.jpg?s=128&g=1", "display_name": "Warcupine", "link": "https://stackoverflow.com/users/11643528/warcupine"}, "edited": false, "score": 0, "creation_date": 1562761319, "post_id": 56970508, "comment_id": 100477711, "body": "This might be what you are looking for: <a href=\"https://stackoverflow.com/questions/29362456/what-event-is-triggered-when-user-selects-value-from-drop-down-combobox-activex\" title=\"what event is triggered when user selects value from drop down combobox activex\">stackoverflow.com/questions/29362456/&hellip;</a>"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562762043, "post_id": 56970508, "comment_id": 100478082, "body": "You are simply using form controls instead of ActiveX controls? In that case you can link a cell to the chosen index of the combobox. In cell <code>A12</code> you can then just put an index formula to get the corresponding value from the listrange."}, {"owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "edited": false, "score": 1, "creation_date": 1562762751, "post_id": 56970508, "comment_id": 100478512, "body": "Nothing wrong with your code. You need to right click on the combobox and then click on assign macro and then select <code>drop_down_16_change</code> ;) it will now work"}, {"owner": {"reputation": 47, "user_id": 10358672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6037bfc7ea69402f02339050d5f7044b?s=128&d=identicon&r=PG&f=1", "display_name": "Martinswe", "link": "https://stackoverflow.com/users/10358672/martinswe"}, "edited": false, "score": 0, "creation_date": 1562762757, "post_id": 56970508, "comment_id": 100478518, "body": "Thanks , problem solved!"}], "owner": {"reputation": 47, "user_id": 10358672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6037bfc7ea69402f02339050d5f7044b?s=128&d=identicon&r=PG&f=1", "display_name": "Martinswe", "link": "https://stackoverflow.com/users/10358672/martinswe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562760963, "creation_date": 1562760963, "question_id": 56970508, "link": "https://stackoverflow.com/questions/56970508/combo-box-form-control-paste-selected-string-name-to-cell", "title": "combo box (form control) paste selected string name to cell", "body": "<p>I would like to paste the value of the selected content in a combobox (form control) to a cell (B12) without having to add a button triggering this event. </p>\n\n<p>Here's my code;</p>\n\n<pre><code>Sub drop_down_16_change()\nWith Worksheets(\"Dashboard\").Shapes(\"Drop Down 16\").ControlFormat\nWorksheets(\"Dashboard\").Range(\"A12\") = .List(.Value)\nEnd With\nEnd Sub\n</code></pre>\n\n<p>However, it does not work when changing selected item in the dropdownbox, only works when running the script.</p>\n"}, {"tags": ["excel", "vba", "powerquery"], "answers": [{"tags": [], "owner": {"reputation": 1381, "user_id": 6908282, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sV0sfeGuIwQ/AAAAAAAAAAI/AAAAAAAAPvk/7xDwhLEI5BU/photo.jpg?sz=128", "display_name": "Gangula", "link": "https://stackoverflow.com/users/6908282/gangula"}, "is_accepted": false, "score": 0, "last_activity_date": 1562776110, "creation_date": 1562776110, "answer_id": 56974991, "question_id": 56970374, "link": "https://stackoverflow.com/questions/56970374/call-macro-afterrefresh-issue/56974991#56974991", "title": "Call macro AfterRefresh issue", "body": "<p>There is only one way to do it. For all of your Queries, <code>Query - PSTab</code>, <code>Query - PETab</code>, <code>Query - barTagData</code>, you need to uncheck the \"Enable Background refresh\" option in the query properties window.</p>\n\n<p>After doing this, the <code>DoEvents</code> function should wait until it refreshes the queries. So you can add a <code>MsgBox</code> function after the <code>DoEvents</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/7EKP9.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/7EKP9.png\" alt=\"Disable Query refresh\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11764770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aee131161d42c633478960742d6c7d73?s=128&d=identicon&r=PG&f=1", "display_name": "JPMurdie", "link": "https://stackoverflow.com/users/11764770/jpmurdie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 59, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562776110, "creation_date": 1562760474, "last_edit_date": 1562761614, "question_id": 56970374, "link": "https://stackoverflow.com/questions/56970374/call-macro-afterrefresh-issue", "title": "Call macro AfterRefresh issue", "body": "<p>I'd like a vbOK message box to appear after my queries have refresh. </p>\n\n<p>I've gone through some of the answers on here already and tried to piece it together but I'm not been able to work out what I am doing wrong.</p>\n\n<p>This is in ThisWorkbook: </p>\n\n<pre><code>Dim qtevent As qtclass\n-------------------------------------------------\n\nPrivate Sub Workbook_Open()\n\nSet qtevent = New qtclass\nSet qtevent.HookedTable = \nThisWorkbook.Worksheets(\"TagData\").ListObjects(\"barTagData\").QueryTable\n\nEnd Sub\n-------------------------------------------------\n\nSub refreshData()\n\nRefresh_Note.Show vbModeless\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = False\n\nWith ThisWorkbook\n.Connections(\"Query - PSTab\").OLEDBConnection.BackgroundQuery = True\n.Connections(\"Query - PETab\").OLEDBConnection.BackgroundQuery = True\n.Connections(\"Query - barTagData\").OLEDBConnection.BackgroundQuery = True\n\n.Connections(\"Query - PSTab\").Refresh\n.Connections(\"Query - PETab\").Refresh\n.Connections(\"Query - barTagData\").Refresh\n\nEnd With\n\nDoEvents\n\nApplication.ScreenUpdating = True\nApplication.DisplayAlerts = True\n\nEnd Sub\n-------------------------------------------------\n</code></pre>\n\n<p>This is the qtclass module:</p>\n\n<pre><code>Option Explicit\n\nPublic WithEvents qt As QueryTable\n-------------------------------------------------\n\nPublic Property Set HookedTable(q As Excel.QueryTable)\nSet qt = q\nEnd Property\n-------------------------------------------------\n\nPrivate Sub qt_AfterRefresh(ByVal Success As Boolean)\n\nMsgBox \"qt_AfterRefresh called successfully.\"\nIf Success = True Then\nCall hideForm\nMsgBox \"If called Successfully\"\nEnd Sub\n-------------------------------------------------\n\nSub hideForm()\n\nRefresh_Note.Hide\n\nEnd Sub\n-------------------------------------------------\n</code></pre>\n\n<p>Any help is appriciated! :) Thanks.</p>\n\n<p>I'm trying call the hideForm sub after the queries have refreshed which will also produce another msg box, stating \"Queries Refreshed\". This part is already taken care off, but the sub isn't being called AfterRefresh.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1562760466, "post_id": 56970272, "comment_id": 100477259, "body": "<code>MsgBox</code> returns an integer rather than a string (though I don&#39;t think that this is your problem). In any event -- what line throws the error, and exactly how can it be triggered?"}, {"owner": {"reputation": 1, "user_id": 11764816, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kMWnsNUDczs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMUGf_NTKaV3tq9ILYCmQmik-fAQ/photo.jpg?sz=128", "display_name": "Tom", "link": "https://stackoverflow.com/users/11764816/tom"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1562760566, "post_id": 56970272, "comment_id": 100477306, "body": "Best way to re-organise to avoid the error? Basically, the error is caused at &quot;rng4.Offset(1, 0).PasteSpecial. The code runs through perfectly fine if it attempts to paste in an empty cell that is not a part of an excel table. If it is a part of a table it breaks."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562762125, "post_id": 56970272, "comment_id": 100478133, "body": "What&#39;s the point of this loop which goes through one cell <code>For Each cell4 In Range(&quot;D&quot; &amp; LR4)</code>? And I don&#39;t think this is valid syntax <code>Big = Range(&quot;D2:AO2&quot;).Copy</code>."}, {"owner": {"reputation": 1, "user_id": 11764816, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kMWnsNUDczs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMUGf_NTKaV3tq9ILYCmQmik-fAQ/photo.jpg?sz=128", "display_name": "Tom", "link": "https://stackoverflow.com/users/11764816/tom"}, "edited": false, "score": 0, "creation_date": 1562762433, "post_id": 56970272, "comment_id": 100478314, "body": "The &quot;Big&quot; was a mistake. Wasn&#39;t intended to be included in the question, I&#39;ll delete it out. I seem to get a 1004 error when I don&#39;t include the loop."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562762799, "post_id": 56970272, "comment_id": 100478542, "body": "You should read up on indenting your code to make it easier to read. Try inserting <code>if not rng4 is nothing then rng4.Offset(1, 0).PasteSpecial</code> to see if the error stops."}, {"owner": {"reputation": 1, "user_id": 11764816, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kMWnsNUDczs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMUGf_NTKaV3tq9ILYCmQmik-fAQ/photo.jpg?sz=128", "display_name": "Tom", "link": "https://stackoverflow.com/users/11764816/tom"}, "reply_to_user": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562763278, "post_id": 56970272, "comment_id": 100478829, "body": "@AAA Essentially there is a huge table of data. The first empty row is not a part of this huge table until data is manually pasted into the first 3 columns of the table. When the code is run after this is done, the run time error occurs.   SJR noted. I am fairly new to this so am still learning about best practices. I&#39;ve pasted that piece of code in and this time I received a run time 13 error."}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 0, "creation_date": 1562763374, "post_id": 56970272, "comment_id": 100478875, "body": "What are you trying to achieve actually? Describe the logic behind the code."}, {"owner": {"reputation": 1, "user_id": 11764816, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kMWnsNUDczs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMUGf_NTKaV3tq9ILYCmQmik-fAQ/photo.jpg?sz=128", "display_name": "Tom", "link": "https://stackoverflow.com/users/11764816/tom"}, "edited": false, "score": 0, "creation_date": 1562763699, "post_id": 56970272, "comment_id": 100479058, "body": "It&#39;s a 5 step code  1) Display msg box to identify user intentions.  2) Copy the first row of data (Range(&quot;D2:AO2&quot;).Copy)  3) Look for the first empty row of data, or rather the first empty cell in column D  4) Paste the copied data in this row  5)* This is the step I was going to implement afterwards - paste the copied data in every empty row where there is a value in Column A."}, {"owner": {"reputation": 1, "user_id": 11764816, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kMWnsNUDczs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMUGf_NTKaV3tq9ILYCmQmik-fAQ/photo.jpg?sz=128", "display_name": "Tom", "link": "https://stackoverflow.com/users/11764816/tom"}, "edited": false, "score": 0, "creation_date": 1562766791, "post_id": 56970272, "comment_id": 100480790, "body": "So I&#39;ve found what I need with &quot;Cells(Rows.Count, &quot;D&quot;).End(xlUp).Offset(1)&quot;. The issue is, since I have a table, Excel finds the first cell below the table as it considers the table to hold a value. Is there any way to bypass this"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1562769045, "post_id": 56970272, "comment_id": 100482206, "body": "See <a href=\"https://stackoverflow.com/questions/43631926/lastrow-and-excel-table\">this question</a> perhaps."}], "owner": {"reputation": 1, "user_id": 11764816, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-kMWnsNUDczs/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3reMUGf_NTKaV3tq9ILYCmQmik-fAQ/photo.jpg?sz=128", "display_name": "Tom", "link": "https://stackoverflow.com/users/11764816/tom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 453, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562762452, "creation_date": 1562760033, "last_edit_date": 1562762452, "question_id": 56970272, "link": "https://stackoverflow.com/questions/56970272/excel-vba-runtime-error-5-invalid-procedure-call-or-argument", "title": "Excel VBA Runtime error &#39;5&#39; Invalid procedure call or argument", "body": "<p>Issues with code executing when the empty cell is a part of a table.</p>\n\n<p>Everything.</p>\n\n<pre><code>Private Sub Data()\n\nDim Answer As String\nDim Box As String\n\n'Question to confirm\n\n    Box = \"Have you pasted the data into the tab?\"\n\n'Display MsgBox\n\n    Answer = MsgBox(Box, vbQuestion + vbYesNo, \"Data\")\n\n'Code for No press\n\n    If Answer = vbNo Then\n    MsgBox \"Please paste the data in the tab before running this code\"\n\n    Else\n\n    If Answer = vbYes Then\n    MsgBox \"Running code.\"\n\n    Sheets(\"Data\").Activate\n    Range(\"D2:AO2\").Copy\n\n    Dim LR4 As Long, cell4 As Range, rng4 As Range\n    LR4 = Range(\"D\" &amp; Rows.Count).End(xlUp).Row\n    For Each cell4 In Range(\"D\" &amp; LR4)\n        If cell4.Value &lt;&gt; \"\" Then\n                Set rng4 = cell4\n            Else\n                Set rng4 = Union(rng4, cell4)\n            End If\n\n                Next cell4\n    rng4.Offset(1, 0).PasteSpecial\n\n    End If\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>The code runs through properly if it is run and the cell is not part of a table. If the cell is part of a table however the run time error pops up.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562762266, "post_id": 56969954, "comment_id": 100478212, "body": "You&#39;re always putting the data in the same rows <code>For iRow = 15 To Lastrow</code>."}, {"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562775111, "post_id": 56969954, "comment_id": 100485686, "body": "Any suggestions? I&#39;ve tried changing Lastrow = ws.Range(Selection, Cells(Rows.Count, Selection.Column).End(xlUp)).Select  and now its populating only in row 15 for all columns but overwriting all new entries."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562775978, "post_id": 56969954, "comment_id": 100486142, "body": "Let&#39;s say your item is found in column 8 and lastrow=20, you are putting stuff in H15 to H20. If it&#39;s found in column 8 again and lastrow=30 you are putting stuff in H15 to H30 whereas presumably you want it go in H21 to H30?"}, {"owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562776473, "post_id": 56969954, "comment_id": 100486389, "body": "If my item is found in column H, i want my first entry to be put in row 15 &amp; 16. If its the same item in column H, i want my next entry to be put in 17 &amp; 18 because it is the next blank row/cells to that column. As of now, my lastrow does not have a specific last row so it can go to row 10000 if needed (at least that&#39;s what i think)."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562777306, "post_id": 56969954, "comment_id": 100486787, "body": "That&#39;s my point. Your loop is always starting at 15 so will overwrite. You need to start at the first empty cell."}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "is_accepted": true, "score": 0, "last_activity_date": 1563289015, "creation_date": 1563289015, "answer_id": 57060167, "question_id": 56969954, "link": "https://stackoverflow.com/questions/56969954/populate-data-in-specific-column-based-on-search-criteria/57060167#57060167", "title": "Populate data in specific column based on search criteria", "body": "<p>Alright, after playing around i finally got it to work the way i want it. Code is</p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim ws As Worksheet\nDim iRow As Long\nDim Lastrow As Long\nDim Found As Range\nDim rangeheader As Range\nDim col As Long\n\nSet rangeheader = Range(\"8:8\")\nSet ws = Worksheets(\"Inventory Log\")\n\nWith ws\n    Set Found = rangeheader.Find(What:=Me.itemnumber.Value, _\n                                                   LookIn:=xlValues, _\n                                                   LookAt:=xlWhole, _\n                                                   SearchOrder:=xlByColumns, _\n                                                   SearchDirection:=xlNext, _\n                                                   MatchCase:=False)\n\n  If Not Found Is Nothing Then\n      col = Found.Column\n      Lastrow = Cells(Rows.Count, col).End(xlUp).Row\n      For iRow = 15 To Lastrow\n          If ws.Cells(iRow, col).Offset(0, 0).Value = \"\" Then\n            ws.Cells(iRow, col).Offset(0, 0).Value = \"-------\"\n            ws.Cells(iRow, col).Offset(1, 0).Value = Me.todaysdate.Value\n            ws.Cells(iRow, col).Offset(2, 0).Value = Me.ponumber.Value\n            ws.Cells(iRow, col).Offset(3, 0).Value = Me.quantity.Value\n          End If\n      Next iRow\n\n    Else\n      MsgBox \"not found\"\n  End If\nEnd With\n\nWith ws\n  .Cells(iRow, Found.Column).Offset(0, 0).Value = \"-------\"\n  .Cells(iRow, Found.Column).Offset(1, 0).Value = Me.todaysdate.Value\n  .Cells(iRow, Found.Column).Offset(2, 0).Value = \"PO#:\" &amp; \"\" &amp; Me.ponumber.Value\n  .Cells(iRow, Found.Column).Offset(3, 0).Value = Me.quantity.Value\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 7631256, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/890fd24830afe3b9dac9e03b4bfcb529?s=128&d=identicon&r=PG&f=1", "display_name": "Sid.  T.", "link": "https://stackoverflow.com/users/7631256/sid-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 57060167, "answer_count": 1, "score": 0, "last_activity_date": 1563289015, "creation_date": 1562758793, "last_edit_date": 1562759415, "question_id": 56969954, "link": "https://stackoverflow.com/questions/56969954/populate-data-in-specific-column-based-on-search-criteria", "title": "Populate data in specific column based on search criteria", "body": "<p>I'm trying to input data via userform to find a specific inventory item then find the last empty row to input the data. What's happening is the previous data is getting overwritten then the new data populates below it. Its not finding the last row of the specific column. </p>\n\n<pre><code>Private Sub CommandButton1_Click()\n\nDim ws As Worksheet\nDim iRow As Long\nDim Lastrow As Long\nDim Found As Range\n\nSet ws = Worksheets(\"Inventory Log\")\n\nLastrow = ws.Range(\"C:WD\").Find(\"*\", , , , xlByRows, xlPrevious).Row\n\n\nIf Me.itemnumber.Value = \"\" Then\n    MsgBox \"select item number please\"\n    Else\n        Set Found = ws.Range(\"C:WD\").Find(What:=Me.itemnumber.Value, _\n                                                   LookIn:=xlValues, _\n                                                   LookAt:=xlWhole, _\n                                                  SearchOrder:=xlByRows,_\n                                                SearchDirection:=xlNext,_                                                     \n                                                 MatchCase:=False)\n\n    If Found Is Nothing Then\n               MsgBox \"Not found\"\n    Else\n       For iRow = 15 To Lastrow\n           ws.Cells(iRow, Found.Column).Value = Me.ponumber.Value\n           ws.Cells(iRow, Found.Column).Offset(1, 0).Value = Me.quantity.Value\n       Next iRow\n    End If\nEnd If\n\n\nWith ws\n    .Cells(iRow, Found.Column).Value = \"PO#:\" &amp; \"\" &amp; Me.ponumber.Value\n    .Cells(iRow, Found.Column).Offset(1, 0).Value = Me.quantity.Value\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p>First entry works as should, but after second entry the previous data is overwritten then it populates into the cells that it should if its in the same column. If its a different column, the correct data populates below the first entry row and above it (see picture below).</p>\n\n<p><a href=\"https://i.stack.imgur.com/8EQLc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8EQLc.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["html", "vba", "web-scraping"], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1562814952, "post_id": 56978400, "comment_id": 100497860, "body": "Great code. When trying to study the code, I didn&#39;t know how to inspect the URL .. Can you add explanation to that part please?"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1562815386, "post_id": 56978400, "comment_id": 100497930, "body": "And why GET fails although the url works on the browser <code>url = &quot;https:&#47;&#47;companies.govmu.org:4343&#47;MNSOnlineSearch&#47;GetCompani&zwnj;&#8203;es?tabs=tab-1&amp;search&zwnj;&#8203;ByName=&amp;searchByFile&zwnj;&#8203;No=&quot; &amp; fileNo &amp; &quot;&amp;submitCompanies=&amp;searchByBusName=&amp;searchByBRN=&amp;searchByInc&zwnj;&#8203;DateFrom=&amp;searchByIn&zwnj;&#8203;cDateTo=&amp;doAction=se&zwnj;&#8203;arch&quot;</code>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1562824444, "post_id": 56978400, "comment_id": 100500168, "body": "As to your last point - I don&#39;t know. Perhaps the browser goes on to do a POST request in the background."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1562825313, "post_id": 56978400, "comment_id": 100500470, "body": "See edit to answer. You can probably monitor the GET request in browser via dev tools and see what is going on"}, {"owner": {"reputation": 25, "user_id": 11583986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fe403ad304019fda45001695e563de?s=128&d=identicon&r=PG&f=1", "display_name": "Darren LSH", "link": "https://stackoverflow.com/users/11583986/darren-lsh"}, "edited": false, "score": 0, "creation_date": 1563023599, "post_id": 56978400, "comment_id": 100569580, "body": "Thanks a lot for the detailed explanation @QHarr. The code works perfectly. On a side note, I&#39;m trying to understand why it&#39;s not possible to use the method I described? Since the body of the response HTML document already contains the status details after I click on search, why can&#39;t I extract it? Does it have something to do with the characteristics of POST vs GET requests?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563027485, "post_id": 56978400, "comment_id": 100570466, "body": "Hi, There is not enough of your code for me to comment on that."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1563178059, "post_id": 56978400, "comment_id": 100599553, "body": "After you click on search in the browser the browser does a POST request to update the page. A simple GET won&#39;t retrieve that."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": true, "score": 1, "last_activity_date": 1562824263, "last_edit_date": 1562824263, "creation_date": 1562791578, "answer_id": 56978400, "question_id": 56969863, "link": "https://stackoverflow.com/questions/56969863/extract-data-from-html-element-vba/56978400#56978400", "title": "Extract data from HTML Element - VBA", "body": "<p>The page does an xmlhttp POST request which retrieves data from a backend data store (likely Oracle GlassFish > JDBC API > data repository e.g. MySQL) . It returns all similar matches, possibly including exact.</p>\n\n<p>You can find the POST request in the network traffic of browser dev tools after you enter the fileNo and press the search button.</p>\n\n<p>Below is a function you can call in a loop over your fileNos to retrieve the company status</p>\n\n<pre><code>Option Explicit\n\nPublic Sub test()\n    Dim fileNo As String, xmlhttp As Object\n    fileNo = \"C5113\"\n    Set xmlhttp = CreateObject(\"MSXML2.XMLHTTP\")\n    MsgBox GetCompanyStatus(fileNo, xmlhttp)\nEnd Sub\n\nPublic Function GetCompanyStatus(ByVal fileNo As String, ByVal xmlhttp As Object) As String\n    Dim html As HTMLDocument, body As String, fileNos As Object, i As Long\n\n    Set html = New HTMLDocument\n    body = \"tabs=tab-1&amp;searchByName=&amp;searchByFileNo=PLACEHOLDER&amp;submitCompanies=&amp;searchByBusName=&amp;searchByBRN=&amp;searchByIncDateFrom=&amp;searchByIncDateTo=&amp;doAction=search\"\n\n    With xmlhttp\n        .Open \"POST\", \"https://companies.govmu.org:4343/MNSOnlineSearch/GetCompanies\", False\n        .setRequestHeader \"Content-Type\", \"application/x-www-form-urlencoded\"\n        .send Replace$(body, \"PLACEHOLDER\", fileNo)\n        html.body.innerHTML = .responseText\n        Set fileNos = html.querySelectorAll(\"td.tdFileNo\")\n        If fileNos.Length &gt; 0 Then\n            For i = 0 To fileNos.Length - 1\n                If fileNos.item(i).innerText = fileNo Then\n                    GetCompanyStatus = html.querySelectorAll(\"td.tdStatus\").item(i).innerText\n                    Exit Function\n                End If\n            Next i\n        End If\n        GetCompanyStatus = \"Not found\"\n    End With\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>I would instead consider how you can group your requests. As you can post partial file numbers you could cut down on the number of requests considerably by doing in batches with partial file numbers e.g. search for C5 or C51; the backend then does something like \"C5%\" to return all matches starting with the specified string, and then loop those results searching for your file numbers of interest that fall within that range. </p>\n\n<p>You could have a dictionary with <code>fileNo</code> as key and <code>status</code> as value and update this as you loop the results returned by a request. I think the number of keys is constrained by <code>Long</code>, so no problem I think for storing all your fileNos at the start, in a dictionary, and updating later during requests. You could even have multiple dictionaries that host ranges of fileNos, like the volumes of the good old Encyclop\u00e6dia Britannica. This would limit loops to dicts you hope to populate from the same request, for example. Is something to play around with an explore.</p>\n"}], "owner": {"reputation": 25, "user_id": 11583986, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16fe403ad304019fda45001695e563de?s=128&d=identicon&r=PG&f=1", "display_name": "Darren LSH", "link": "https://stackoverflow.com/users/11583986/darren-lsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 56978400, "answer_count": 1, "score": 2, "last_activity_date": 1563175500, "creation_date": 1562758487, "last_edit_date": 1563175500, "question_id": 56969863, "link": "https://stackoverflow.com/questions/56969863/extract-data-from-html-element-vba", "title": "Extract data from HTML Element - VBA", "body": "<p>I'm new to web scraping and the HTML language. </p>\n\n<p>I'm trying to write a code in VBA to extract data from the following website:\n<a href=\"https://companies.govmu.org:4343/MNSOnlineSearch/\" rel=\"nofollow noreferrer\">https://companies.govmu.org:4343/MNSOnlineSearch/</a></p>\n\n<p>I have an Excel sheet with over 5000 company names and their respective \"File No\" in columns A and B respectively, and I need to input their \"Status\" (either \"Live\" or \"Defunct\") in column C. This will be done after searching for each company by \"File No\" and then extracting their status to the Excel sheet.</p>\n\n<p>The issue is that I can't seem to get the element containing the data that I need.</p>\n\n<p>I've already written the bit of code which will extract the \"File No\" from my Excel sheet, paste it on the webpage in the \"File No\" search box, and run the search. (You can try searching C5113, as an example).</p>\n\n<p>However, on the resulting webpage, I've tried getting the element containing the data that I need, but it does not work. </p>\n\n<p>For example, I tried to MsgBox (MsgBox is my personal way to check whether my variable contains the data I need) the inner HTML of the tag fieldset (fs) with ID \"CompanyList\" as shown in the code below, but it returns an error. </p>\n\n<p>I've also tried with another variable named div, of data type HTMLDivElement, and then getting the element by ID \"companies\". </p>\n\n<p>And finally, I've also tried looping through a variable of type IHTMLElementCollection to look for the element that I need, but it still does not show the element that I need (it shows other elements that I don't need).</p>\n\n<pre><code>Option Explicit\n\nSub ExtractStatusDetails()\n    Dim ie As InternetExplorer\n    Dim html As HTMLDocument\n    Dim resultHtml As HTMLDocument\n    Dim fs As IHTMLElement\n    Dim searchBoxes As IHTMLElementCollection\n    Dim searchButton As Object\n    Dim homePage As String\n\n    homePage = \"https://companies.govmu.org:4343/MNSOnlineSearch/\"\n    Set ie = New InternetExplorer   \n    ie.Visible = False\n    ie.navigate homePage\n    Do While ie.readyState &lt;&gt; READYSTATE_COMPLETE\n        DoEvents\n    Loop\n\n    Set html = ie.document\n    Set searchBoxes = html.getElementsByClassName(\"col-md-6 col-lg-4\")\n\n    searchBoxes(0).innerHTML = Replace(searchBoxes(0).innerHTML, \"placeholder\", \"value\")\n    searchBoxes(0).innerHTML = Replace(searchBoxes(0).innerHTML, \"Search company by File No...\", \"C63\")\n\n    Set searchButton = searchBoxes(0).getElementsByClassName(\"btn btn-large btn-primary btn-raised\")\n    searchButton(0).Click\n    Do While ie.readyState &lt;&gt; READYSTATE_COMPLETE\n        DoEvents\n    Loop\n\n    Set resultHtml = ie.document\n    Set fs = resultHtml.getElementById(\"CompanyList\")\n\n    MsgBox fs.innerHTML\n\n    ie.Quit\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access", "outlook"], "answers": [{"tags": [], "owner": {"reputation": 24095, "user_id": 3820271, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZxCoE.jpg?s=128&g=1", "display_name": "Andre", "link": "https://stackoverflow.com/users/3820271/andre"}, "is_accepted": true, "score": 1, "last_activity_date": 1562763467, "creation_date": 1562763467, "answer_id": 56971242, "question_id": 56969842, "link": "https://stackoverflow.com/questions/56969842/add-text-to-email-thread/56971242#56971242", "title": "Add Text To Email Thread", "body": "<p>By setting</p>\n\n<pre><code>.HTMLBody = emailBody\n</code></pre>\n\n<p>you overwrite everything that was there before.</p>\n\n<p>You need to insert your text into the existing <code>.HTMLBody</code>.</p>\n\n<p>For new mailitems, where I want to preserve the default HTML signature, I use the following - inspect your existing <code>.HTMLBody</code> to find out if this will also work for Reply (if not: adapt).</p>\n\n<pre><code>' emailBody is plain text -&gt; encode as HTML\nemailBody = HtmlEncode(emailBody)\n\n' Outlook-HTML: mail text begins with this line:\n'  &lt;p class=MsoNormal&gt;&lt;o:p&gt;&amp;nbsp;&lt;/o:p&gt;&lt;/p&gt;\n' Insert my text instead of the first &amp;nbsp;\noItem.HtmlBody = Replace(oItem.HtmlBody, \"&amp;nbsp;\", emailBody, Count:=1)\n</code></pre>\n"}], "owner": {"reputation": 460, "user_id": 9747187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1677a6339138f941ad6dc80eb962958d?s=128&d=identicon&r=PG&f=1", "display_name": "HotTomales", "link": "https://stackoverflow.com/users/9747187/hottomales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 56971242, "answer_count": 1, "score": 1, "last_activity_date": 1597348905, "creation_date": 1562758400, "last_edit_date": 1597348905, "question_id": 56969842, "link": "https://stackoverflow.com/questions/56969842/add-text-to-email-thread", "title": "Add Text To Email Thread", "body": "<p>I search my Sent Mail in Outlook and open the last email to a specified email address (this part is done).</p>\n<p>I want to add text to the email chain, while keeping the previous messages intact.</p>\n<p>The code below creates a &quot;blank-slate&quot; so that all of the previous email correspondence is lost.</p>\n<p>What do I need to do to add text to the Body of the email?</p>\n<pre><code>FunctionComposeResponse(searchEmail As String, emailBody As String)\nDim currDateTime As Date: currDateTime = Now()\nDim tenDayPrior As Date: tenDayPrior = DateValue(CStr(Now())) - 10 &amp; &quot; 07:00:00 AM&quot;\nDim olApp As Outlook.Application\nDim olNS As NameSpace\nDim Fldr As Folder\nDim olReply As Outlook.MailItem\nDim msg As Object\nSet olApp = New Outlook.Application\nSet olNS = olApp.GetNamespace(&quot;MAPI&quot;)\nSet Fldr = olNS.GetDefaultFolder(olFolderSentMail)\nFor Each msg In Fldr.Items\n  If TypeName(msg) = &quot;MailItem&quot; Then\n    For Each recipient in msg.recipients\n       If recip.Address = searchEmail Then\n         If msg.SentOn &gt;= tenDayPrior And msg.SentOn &lt;= currDateTime Then\n           Set olReply = msg.ReplyAll\n           With olReply\n              .BodyFormat = olFormatHTML\n              .HTMLBody = emailBody\n              .Save\n              .Close olSave\n           End With\n         End If\n       End If\n    Next recip\n  End If\nNext msg\nEnd Function\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1562758913, "post_id": 56969706, "comment_id": 100476375, "body": "it is better to use <code>Find Method</code>"}, {"owner": {"reputation": 41, "user_id": 11753198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85474fe3238a26dc5f01a5d0f9002487?s=128&d=identicon&r=PG&f=1", "display_name": "SanderJensen", "link": "https://stackoverflow.com/users/11753198/sanderjensen"}, "reply_to_user": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1562758964, "post_id": 56969706, "comment_id": 100476403, "body": "Could you show me how? I haven&#39;t used it before"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 11753198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85474fe3238a26dc5f01a5d0f9002487?s=128&d=identicon&r=PG&f=1", "display_name": "SanderJensen", "link": "https://stackoverflow.com/users/11753198/sanderjensen"}, "edited": false, "score": 0, "creation_date": 1562760050, "post_id": 56970061, "comment_id": 100477032, "body": "That&#39;s just amazing! Thank you so much. Just wondering,  how does the <code>SourceAdresses</code> and <code>SourceDestination</code> know where to get the cells from without doing <code>Sheets(&quot;Arkiv&quot;)</code> and <code>Sheets(&quot;DN&quot;)</code> in front of the range? Worked perfectly by the way."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 41, "user_id": 11753198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85474fe3238a26dc5f01a5d0f9002487?s=128&d=identicon&r=PG&f=1", "display_name": "SanderJensen", "link": "https://stackoverflow.com/users/11753198/sanderjensen"}, "edited": false, "score": 0, "creation_date": 1562761546, "post_id": 56970061, "comment_id": 100477812, "body": "@SanderJensen <code>DestinationAddresses(i)</code> just contains an address of a range like <code>D9</code> and this is used in the <code>.Range()</code> of  <code>wsDestination.Range(DestinationAddresses(i))</code>. The worksheet is defined as  <code>wsDestination</code>"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1562759165, "creation_date": 1562759165, "answer_id": 56970061, "question_id": 56969706, "link": "https://stackoverflow.com/questions/56969706/copying-row-with-corresponding-id-number-into-a-different-worksheet/56970061#56970061", "title": "Copying row with corresponding ID number into a different worksheet", "body": "<ol>\n<li><p>If you use the find method always specify the <code>LookAt</code> patameter, otherwise VBA uses whatever was used last time (by either a user or VBA).</p></li>\n<li><p>You need to loop through the addresses, and copy them one by one. You cannot copy non-coninous ranges at once.</p></li>\n</ol>\n\n<p>So something like this should work.</p>\n\n<pre><code>Option Explicit\n\nPublic Sub CopyRanges()\n    Dim wsSource As Worksheet\n    Set wsSource = ThisWorkbook.Worksheets(\"Arkiv\")\n    Dim wsDestination As Worksheet\n    Set wsDestination = ThisWorkbook.Worksheets(\"DN\")\n\n    Dim IDnum As String\n    IDnum = TextBox1.Text\n\n    Dim idRow As Long\n    idRow = wsSource.Columns(\"A:A\").Find(What:=IDnum, LookAt:=xlWhole).Row\n\n    Dim SourceAddresses() As Variant\n    SourceAddresses = Array(\"B\" &amp; idRow, \"C\" &amp; idRow, \"D\" &amp; idRow, \"E\" &amp; idRow, \"F\" &amp; idRow, \"G\" &amp; idRow, \"H\" &amp; idRow, \"I\" &amp; idRow)\n\n    Dim DestinationAddresses() As Variant\n    DestinationAddresses = Array(\"D9\", \"E9\", \"I9\", \"C20\", \"D20\", \"E45\", \"G20\", \"H20\", \"I20\") \n\n    If UBound(SourceAddresses) &lt;&gt; UBound(DestinationAddresses) Then\n        MsgBox \"Amount of source addresses must be the same amount as destination addresses\"\n        Exit Sub\n    End If     \n\n    Dim i As Long\n    For i = LBound(SourceAddresses) To UBound(SourceAddresses)\n        wsDestination.Range(DestinationAddresses(i)).Value = wsSource.Range(SourceAddresses(i)).Value\n    Next i\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 1, "last_activity_date": 1562760230, "last_edit_date": 1562760230, "creation_date": 1562759631, "answer_id": 56970180, "question_id": 56969706, "link": "https://stackoverflow.com/questions/56969706/copying-row-with-corresponding-id-number-into-a-different-worksheet/56970180#56970180", "title": "Copying row with corresponding ID number into a different worksheet", "body": "<p>Give a try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRow As Long\n    Dim strSearchingValue As String\n    Dim rngSearchingArea As Range, rngFound As Range\n\n    'Set the value you are looking for\n    strSearchingValue = \"Test\"\n\n    'Let us assume that our data appears in Sheet1 - change if needed\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        'Let us assume that IDs appears in column A - Find the last row of column A\n        LastRow = .Cells(.Rows.Count, \"A\").End(xlUp).Row\n        'Let us assume that IDs start from row 2 and end at LastRow - Set the range we want to search\n        Set rngSearchingArea = .Range(\"A2:A\" &amp; LastRow)\n        'Use find method to check if there is any match\n        Set rngFound = rngSearchingArea.Find(strSearchingValue, LookIn:=xlvalues, LookAt:=xlWhole)\n        'Check the results\n        If Not rngFound Is Nothing Then\n            'If there is a match - you get back the row\n            Debug.Print rngFound.Row\n        Else\n            'If there is not a match - you get back a message box\n            MsgBox \"This ID is not appear in the data.\"\n        End If\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 11753198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85474fe3238a26dc5f01a5d0f9002487?s=128&d=identicon&r=PG&f=1", "display_name": "SanderJensen", "link": "https://stackoverflow.com/users/11753198/sanderjensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 56970061, "answer_count": 2, "score": 0, "last_activity_date": 1562760230, "creation_date": 1562757905, "last_edit_date": 1562758345, "question_id": 56969706, "link": "https://stackoverflow.com/questions/56969706/copying-row-with-corresponding-id-number-into-a-different-worksheet", "title": "Copying row with corresponding ID number into a different worksheet", "body": "<p>I have a userform that lets you type in an ID number, I want the row with the corresponding ID number to be copied into a different worksheet where the cells are not aligned.</p>\n\n<p>I have tried using an array for the destination of the data but it doesn't do anything when I run it. I know I could do it the ugly way and code every single cell to go to another cell but I thought using an array for the data that is being copied would work, now I need to know how I can put all the destination cells in one varable and copy the data in there</p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = Sheets(\"Arkiv\")\nDim DN As Worksheet\nSet DN = Sheets(\"DN\")\n\nidRow = Sheets(\"Arkiv\").Columns(\"A:A\").Find(what:=IDnum).Row\nIDnum = TextBox1.Text\n\n'Dim shipFrom As Range\n    'Set shipFrom = Sheets(\"Arkiv\").Range(\"B\" &amp; idRow)\n\nDim goTo1 As Variant\ngoTo1 = Array(DN.Range(\"D9\"), DN.Range(\"E9\"), DN.Range(\"I9\"), DN.Range(\"C20\"), DN.Range(\"D20\"), DN.Range(\"E45\"), DN.Range(\"G20\"), DN.Range(\"H20\"), DN.Range(\"I20\"))\n\nDim data As Variant\ndata = Array(ws.Range(\"B\" &amp; idRow), ws.Range(\"C\" &amp; idRow), ws.Range(\"D\" &amp; idRow), ws.Range(\"E\" &amp; idRow), ws.Range(\"F\" &amp; idRow), ws.Range(\"G\" &amp; idRow), ws.Range(\"H\" &amp; idRow), ws.Range(\"I\" &amp; idRow))\n\ngoTo1 = data\n</code></pre>\n\n<p>I expect the data from the variable \"data to be copied over to the cells inside of the \"goTo1\" variable in the corresponding order I put them into the array with.<code>enter code here</code></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "edited": false, "score": 1, "creation_date": 1562757036, "post_id": 56969375, "comment_id": 100475439, "body": "You&#39;re attempting to put text into a date variable. You need to convert it into a date first using the Cdate() function. So hour1 = cdate(txtTimeIn1.Text)"}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "edited": false, "score": 0, "creation_date": 1562933591, "post_id": 56969375, "comment_id": 100546136, "body": "Note that each <code>.Caption</code> is a string so <b>don&#39;t</b> do things like <code>lblSecUnit1.Caption = WorksheetFunction.Sum(lblMon1.Caption, lblTue1.Caption)</code>, Math should be done on numeric types (integers and floats) as I indicate in my answer."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 11764393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe76e142e21b9b3b21ee4434fa8a0e4?s=128&d=identicon&r=PG&f=1", "display_name": "Obota", "link": "https://stackoverflow.com/users/11764393/obota"}, "edited": false, "score": 0, "creation_date": 1562836364, "post_id": 56972208, "comment_id": 100505993, "body": "Thanks for the clarification and your answer. It worked as outlined. My next problem is, I want to sum the units and rate if a different times are entered for a next day into a another label as total_units for the week and total_rate for the week. I am using an option button to select the days."}, {"owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "reply_to_user": {"reputation": 1, "user_id": 11764393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe76e142e21b9b3b21ee4434fa8a0e4?s=128&d=identicon&r=PG&f=1", "display_name": "Obota", "link": "https://stackoverflow.com/users/11764393/obota"}, "edited": false, "score": 0, "creation_date": 1562846651, "post_id": 56972208, "comment_id": 100512043, "body": "@Obota - So what is your question? <a href=\"https://stackoverflow.com\">Stack Overflow</a> is not a code-writing service. <a href=\"https://stackoverflow.com/posts/56969375/edit\">Edit your post</a> and be specific on the parts you cannot make work right. Use a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal verifiable complete example</a> to demonstrate the problem."}, {"owner": {"reputation": 1, "user_id": 11764393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe76e142e21b9b3b21ee4434fa8a0e4?s=128&d=identicon&r=PG&f=1", "display_name": "Obota", "link": "https://stackoverflow.com/users/11764393/obota"}, "edited": false, "score": 0, "creation_date": 1562925994, "post_id": 56972208, "comment_id": 100542328, "body": "Thanks for your help, I am definitely not using the site as a coding service. I am not that familiar with VBA and I&#39;m stuck with what I&#39;m trying to do and need. Any help will be much appreciated. I have updated my question with the code I am having trouble. Basically, each time I select a day and enter the information for the employee, I want to tabulate add to the previous days hours, rate and units for get a total for the week in three labels."}, {"owner": {"reputation": 1, "user_id": 11764393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe76e142e21b9b3b21ee4434fa8a0e4?s=128&d=identicon&r=PG&f=1", "display_name": "Obota", "link": "https://stackoverflow.com/users/11764393/obota"}, "edited": false, "score": 0, "creation_date": 1562927315, "post_id": 56972208, "comment_id": 100543079, "body": "Thanks for your help, I am definitely not using the site as a coding service. I am not that familiar with VBA and I&#39;m stuck with what I&#39;m trying to do. Any help will be much appreciated. I have updated my question with the code I am having trouble with. Basically, each time I select a day and enter the information for the employee, I want to add to the previous days hours, rate and units for get a total for the week in three labels as total hours, total units and weekly average rate per sec."}], "tags": [], "owner": {"reputation": 23662, "user_id": 380384, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/uT3JH.png?s=128&g=1", "display_name": "John Alexiou", "link": "https://stackoverflow.com/users/380384/john-alexiou"}, "is_accepted": false, "score": 0, "last_activity_date": 1562846936, "last_edit_date": 1562846936, "creation_date": 1562766698, "answer_id": 56972208, "question_id": 56969375, "link": "https://stackoverflow.com/questions/56969375/sum-label-values-in-vba/56972208#56972208", "title": "Sum label values in VBA", "body": "<p>You are doing math with strings and hoping VBA interpreter does what you intended. Don't do that. Instead, handle the data in three distinct steps:</p>\n\n<ol>\n<li>Take the inputs from the labels and convert them into values of type <code>Integer</code>, <code>Single</code>, or <code>Date</code> using either <code>CInt()</code>, <code>CSng()</code> or <code>CDate()</code>.</li>\n<li>Do the math with the values.</li>\n<li>Convert the values into strings using the <code>Format()</code> function for display.</li>\n</ol>\n\n<p>In the simple example below </p>\n\n<p><a href=\"https://i.stack.imgur.com/ev75b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ev75b.png\" alt=\"output\"></a></p>\n\n<pre><code>Public Sub CalculateRate()\n\n    ' Input values\n    Dim start_time As Date, end_time As Date\n    Dim break_time As Integer, units As Single\n\n    start_time = CDate(Label1.Caption)\n    end_time = CDate(Label2.Caption)\n    break_time = CInt(Label3.Caption)\n    units = CSng(Label4.Caption)\n\n    ' Calculation\n    Dim hours_worked As Single, rate As Single\n    hours_worked = (CSng(end_time) - CSng(start_time)) * 24! - break_time / 60!\n    rate = units / (3600! * hours_worked)\n\n    ' Results\n    Label5.Caption = Format(rate, \"0.000\")\n\nEnd Sub\n</code></pre>\n\n<p>Note that the compiler interprets the following literals</p>\n\n<ul>\n<li><code>1000</code> as a <code>Integer</code> (16-bit)</li>\n<li><code>100000</code> as a <code>Long</code> (32-bit)</li>\n<li><code>1000!</code> as a <code>Single</code> floating point number (32-bit)</li>\n<li><code>1000#</code> as a <code>Double</code> floating point number (64-bit)</li>\n</ul>\n"}], "owner": {"reputation": 1, "user_id": 11764393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fe76e142e21b9b3b21ee4434fa8a0e4?s=128&d=identicon&r=PG&f=1", "display_name": "Obota", "link": "https://stackoverflow.com/users/11764393/obota"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 391, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1604796912, "creation_date": 1562756745, "last_edit_date": 1604796912, "question_id": 56969375, "link": "https://stackoverflow.com/questions/56969375/sum-label-values-in-vba", "title": "Sum label values in VBA", "body": "<p><img src=\"https://i.stack.imgur.com/t9S0Z.png\" alt=\"enter image description here\" /></p>\n<p>Basically, when a day is selected, I will enter each employee's time started and the time ended and their break time, and also enter their output for the day.</p>\n<p>When the next day is selected I want to do the exact calculation for that given day and tabulate in the last three columns.</p>\n<pre><code>Option Explicit\n\nDim hour1 As Date\nDim hour2 As Date\nDim hour3 As Date\nDim Totalhour As Date\nDim StartNumber As Integer\nDim EndNumber As Integer\nDim Sum As Double\nDim i As Integer\nDim x As Integer\nDim Total As Double\n\nPrivate Sub cmdHoursWorked_Click()\n\nIf OpMon.Value = True Then\n\nhour1 = txtTimeIn1.Text\nhour2 = txtTimeOut1.Text\nhour3 = cmbBreak1.Text\nTotal = txtUnitCom1.Text\nTotalhour = ((hour2 - hour1) - hour3)\nlblHrsWorked1.Caption = Round((Totalhour * 24), 2)\nlblMon1.Caption = Round(((lblHrsWorked1.Caption * 3600) / txtUnitCom1.Text), 1)\n'lblUnitWeek1.Caption = txtUnitCom1.Text'\n'lblTHW1.Caption = lblHrsWorked1'\n\nElseIf OpWed.Value = True Then\n\nhour1 = txtTimeIn1.Text\nhour2 = txtTimeOut1.Text\nhour3 = cmbBreak1.Text\nTotalhour = ((hour2 - hour1) - hour3)\nlblHrsWorked1.Caption = Round((Totalhour * 24), 2)\nlblWed1.Caption = Round(((lblHrsWorked1.Caption * 3600) / txtUnitCom1.Text), 1)\n'lblUnitWeek1.Caption = txtUnitCom1.Text'\n'lblHrsWorked1.Caption = lblTHW1.Caption'\nlblSecUnit1.Content = (lblMon1.Caption + lblTue1.Caption + lblWed1.Caption + lblThu1.Caption + lblFri1.Caption)\n\nEnd If\n\nEnd Sub\n</code></pre>\n<p>Say if I select Monday, I will enter 9:00 and 17:30 as start and End Time with 30 minutes break. And I enter 500 into the units completed textbox. I then calculate the hours worked (label) and also calculate the units completed per second on the label Monday label.</p>\n<p>Now if another day is selected I want to do exact same calculations and also adding to the last three columns based on the input from the user</p>\n<pre><code>ElseIf OpTue.Value = True Then\n    start_time = CDate(txtTimeIn1.Text)\n    end_time = CDate(txtTimeOut1.Text)\n    break_time = CInt(cmbBreak1.Text)\n    units = CSng(txtUnitCom1.Text)\n    ttl_secUnit1 = CSng(lblSecUnit1.Caption)\n    sec_Mon1 = CSng(lblMon1.Caption)\n    'sec_Tue1 = CSng(lblTue1.Caption)\n\n   ' Calculation\n    hours_worked = (CSng(end_time) - CSng(start_time)) * 24! - break_time / 60!\n    rate = units / (3600! * hours_worked)\n    ttl_secUnit1 = (CSng(sec_Mon1) + CSng(sec_Tue1))\n    lblSecUnit1.Caption = WorksheetFunction.Sum(lblMon1.Caption, lblTue1.Caption)\n\n\n    ' Results\n    lblHrsWorked1.Caption = Round((hours_worked), 2)\n    lblTue1.Caption = Format(rate, &quot;0.000&quot;)\n    'lblSecUnit1.Caption = Format(ttl_secUnit1, &quot;0.000&quot;)\n\nEnd If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562756834, "post_id": 56969295, "comment_id": 100475302, "body": "You want to replace every digit with an &#39;x&#39;?"}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1562756868, "post_id": 56969295, "comment_id": 100475325, "body": "Can you show some sample data with expected output?"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1562756947, "post_id": 56969295, "comment_id": 100475383, "body": "And is that really <code>vb.net</code> code?  Seems you could do that easily with a Regular Expressions"}], "answers": [{"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": false, "score": 1, "last_activity_date": 1562764775, "last_edit_date": 1562764775, "creation_date": 1562761522, "answer_id": 56970666, "question_id": 56969295, "link": "https://stackoverflow.com/questions/56969295/replacing-only-digits-inside-a-range-of-cells-in-an-excel/56970666#56970666", "title": "Replacing only digits inside a range of cells in an excel", "body": "<p>If you want to change both numbers and mixed text and numbers, then remove the <code>IsNumeric()</code> test:</p>\n\n<pre><code>Sub ReplaceNoX()\n    Dim cell As Range\n    Dim val As String\n    Dim i As Long\n    Dim n As String\n\n    Application.ScreenUpdating = False\n        For Each cell In Selection\n            val = cell.Text\n            For i = 1 To Len(val)\n                n = Mid(val, i, 1)\n                If n Like \"[0-9]\" Then\n                    Mid(val, i, 1) = \"x\"\n                End If\n            Next i\n            cell.Value = val\n        Next\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n\n<p><strong>NOTE:</strong></p>\n\n<ol>\n<li>use <code>Long</code> rather than <code>Integer</code></li>\n<li>use <code>Like</code> to check individual characters.</li>\n<li>use <code>Range</code> rather than <code>Object</code></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 1, "creation_date": 1562763177, "post_id": 56970923, "comment_id": 100478771, "body": "Can I use your answer to hand you a non-vba alternative? If you would use array formula: <code>=CONCAT(IF(ISNUMBER(--(MID(A1,ROW(A$1:INDEX(A:A,LEN(A1))),1)&zwnj;&#8203;)),&quot;x&quot;,MID(A1,ROW(A$&zwnj;&#8203;1:INDEX(A:A,LEN(A1))&zwnj;&#8203;),1)))</code>. It does the same thing and avoids VBA."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562764348, "post_id": 56970923, "comment_id": 100479447, "body": "OP wanted a VB solution, and you came up with what I had in mind as well (allthough both answers are good). So maybe it&#39;s a nice addition to your answer, to give OP a non-VBA alternative."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 3, "last_activity_date": 1562762376, "creation_date": 1562762376, "answer_id": 56970923, "question_id": 56969295, "link": "https://stackoverflow.com/questions/56969295/replacing-only-digits-inside-a-range-of-cells-in-an-excel/56970923#56970923", "title": "Replacing only digits inside a range of cells in an excel", "body": "<p>If you do want to replace every digit with an 'x', here is a different approach using regular expressions.</p>\n\n<pre><code>Sub Regex1()\n\nDim oRgx As Object, rCell As Range\n\nSet oRgx = CreateObject(\"VBScript.RegExp\")\n\nWith oRgx\n    .Global = True\n    .Pattern = \"\\d\"\n    For Each rCell In Selection\n        rCell.Value = .Replace(rCell, \"x\")\n    Next rCell\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/gWWiz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gWWiz.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 103, "user_id": 7163845, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh3.googleusercontent.com/-g0E4UxL0ZQs/AAAAAAAAAAI/AAAAAAAAAck/VyVOIQTqwdA/photo.jpg?sz=128", "display_name": "rahul raj", "link": "https://stackoverflow.com/users/7163845/rahul-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562768810, "creation_date": 1562756488, "last_edit_date": 1562768810, "question_id": 56969295, "link": "https://stackoverflow.com/questions/56969295/replacing-only-digits-inside-a-range-of-cells-in-an-excel", "title": "Replacing only digits inside a range of cells in an excel", "body": "<p>I have an excel column with cell values as string mixed with some numbers ar the end. I am not able to do a 'Text to column' as space cannot be a delimiter nor tab.I tried the below code but it works only if the entire cell is a only digits\n    I am a beginner in macros and vb</p>\n\n<pre><code>Sub ReplaceNoX()\n Dim cell As Object\n Dim val As String\n Dim i As Integer\n Dim n As String\n Application.ScreenUpdating = False\n For Each cell In Selection\n If IsNumeric(cell.Value) Then\n val = cell.Text\n For i = 1 To Len(val)\n n = Mid(val, i, 1)\n If \"0\" &lt;= n And n &lt;= \"9\" Then\n Mid(val, i, 1) = \"x\"\n End If\n Nextf\n cell.Formula = val\n End If\n Next\n Application.ScreenUpdating = True\n End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "excel-indirect"], "answers": [{"tags": [], "owner": {"reputation": 4631, "user_id": 4323786, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b5a408eeb9b2c589eacc93abd059b8a?s=128&d=identicon&r=PG&f=1", "display_name": "Harassed Dad", "link": "https://stackoverflow.com/users/4323786/harassed-dad"}, "is_accepted": false, "score": 1, "last_activity_date": 1562756622, "creation_date": 1562756622, "answer_id": 56969335, "question_id": 56969181, "link": "https://stackoverflow.com/questions/56969181/how-to-use-the-indirect-function-in-vba-in-my-code/56969335#56969335", "title": "How to use the indirect function in VBA in my code?", "body": "<p>No need to use indirect in code, you can just explicitly refer to the contents of the cell</p>\n\n<pre><code>Set xRng = Worksheets(\"Data1\").Range(Worksheets(\"Data1\").Range(\"c15\").text)\n</code></pre>\n\n<p>However your code uses a mix of explicit sheet references (Worksheet(\"data1\"), implicit references (range(\"B21\") will use whatever sheet is active at that moment) and references to the activesheet object. I suggest you explicitly specify which sheet you mean at every point.</p>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 11738013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edf78b33d3806c0024919e6059a9655?s=128&d=identicon&r=PG&f=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/11738013/jan"}, "is_accepted": false, "score": 0, "last_activity_date": 1562762652, "creation_date": 1562762652, "answer_id": 56970983, "question_id": 56969181, "link": "https://stackoverflow.com/questions/56969181/how-to-use-the-indirect-function-in-vba-in-my-code/56970983#56970983", "title": "How to use the indirect function in VBA in my code?", "body": "<p>I made it:) Used the following code:</p>\n\n<pre><code>Private Sub Unique_Click()\n\nDim xRng As Range\nDim xLastRow As Long\nDim xLastRow2 As Long\nDim I As Integer\nOn Error Resume Next\n\nSet xRng = Worksheets(\"Data1\").Range(Range(\"C15\"))\nIf xRng Is Nothing Then Exit Sub\nOn Error Resume Next\nxRng.Copy Range(\"B21\")\nxLastRow = xRng.Rows.Count + 1\nActiveSheet.Range(\"B21:B\" &amp; xLastRow).RemoveDuplicates Columns:=1, Header:=xlNo\n\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 11738013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edf78b33d3806c0024919e6059a9655?s=128&d=identicon&r=PG&f=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/11738013/jan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1562762652, "creation_date": 1562756066, "question_id": 56969181, "link": "https://stackoverflow.com/questions/56969181/how-to-use-the-indirect-function-in-vba-in-my-code", "title": "How to use the indirect function in VBA in my code?", "body": "<p>I need to use the indirect function in VBA. I want to indirect cell C15, or C14 and C15 if possible. </p>\n\n<p>C14 displays the sheet name: Data1\nC15 displays the range: J3:J45999</p>\n\n<p>This should follow the same concept as the indirect function in excel:\n=indirect(C14&amp;\"!\"&amp;C15)</p>\n\n<pre><code>Private Sub Unique_Click()\n\nDim xRng As Range\nDim xLastRow As Long\nDim xLastRow2 As Long\nDim I As Integer\nOn Error Resume Next\n\nSet xRng = Worksheets(\"Data1\").Range([indirect(\"c15\")]).Select\nIf xRng Is Nothing Then Exit Sub\nOn Error Resume Next\nxRng.Copy Range(\"B21\")\nxLastRow = xRng.Rows.Count + 1\nActiveSheet.Range(\"B21:B\" &amp; xLastRow).RemoveDuplicates Columns:=1, Header:=xlNo\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 1, "user_id": 11764465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0110f3fb68a61086f86b47cb9e11a850?s=128&d=identicon&r=PG&f=1", "display_name": "Tash", "link": "https://stackoverflow.com/users/11764465/tash"}, "edited": false, "score": 0, "creation_date": 1562757051, "post_id": 56969260, "comment_id": 100475447, "body": "where is the problem?"}, {"owner": {"reputation": 1, "user_id": 11764465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0110f3fb68a61086f86b47cb9e11a850?s=128&d=identicon&r=PG&f=1", "display_name": "Tash", "link": "https://stackoverflow.com/users/11764465/tash"}, "edited": false, "score": 0, "creation_date": 1562757535, "post_id": 56969260, "comment_id": 100475683, "body": "I&#39;m now struggling to paste the highlighted column as a row. I have used"}, {"owner": {"reputation": 1, "user_id": 11764465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0110f3fb68a61086f86b47cb9e11a850?s=128&d=identicon&r=PG&f=1", "display_name": "Tash", "link": "https://stackoverflow.com/users/11764465/tash"}, "edited": false, "score": 0, "creation_date": 1562757976, "post_id": 56969260, "comment_id": 100475910, "body": "I have used Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _ =False, Transpose:=True"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "reply_to_user": {"reputation": 1, "user_id": 11764465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0110f3fb68a61086f86b47cb9e11a850?s=128&d=identicon&r=PG&f=1", "display_name": "Tash", "link": "https://stackoverflow.com/users/11764465/tash"}, "edited": false, "score": 0, "creation_date": 1562838519, "post_id": 56969260, "comment_id": 100507329, "body": "<code>ThisWorkbook</code> refer to the workbook which includes the code. If you want to refer in different workbook you should replace <code>ThisWorkbook</code> with <code>Workbooks(&quot;Name&quot;)</code>"}], "tags": [], "owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "is_accepted": false, "score": 0, "last_activity_date": 1562758580, "last_edit_date": 1562758580, "creation_date": 1562756366, "answer_id": 56969260, "question_id": 56969106, "link": "https://stackoverflow.com/questions/56969106/copy-and-paste-the-last-5-active-cells-in-a-column/56969260#56969260", "title": "Copy and paste the last 5 active cells in a column", "body": "<p>The below code is dynamic in respect of last row ( calculate the last row of column D instead of using fix value - 1000) You could modify and try:</p>\n\n<pre><code>Option Explicit\n\nSub test()\n\n    Dim LastRow As Long\n\n    'Change worksheet name if needed\n    With ThisWorkbook.Worksheets(\"Sheet1\")\n        'Find the last row of co;lumn D\n        LastRow = .Cells(.Rows.Count, \"D\").End(xlUp).Row\n        .Range(\"D\" &amp; LastRow - 4 &amp; \":D\" &amp; LastRow).Copy\n        .Range(\"F1\").PasteSpecial Paste:=xlPasteValues, Transpose:=True\n    End With\n\nEnd Sub\n</code></pre>\n\n<p><strong>Results:</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/2cqT5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2cqT5.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 11764465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0110f3fb68a61086f86b47cb9e11a850?s=128&d=identicon&r=PG&f=1", "display_name": "Tash", "link": "https://stackoverflow.com/users/11764465/tash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562758580, "creation_date": 1562755819, "last_edit_date": 1562758264, "question_id": 56969106, "link": "https://stackoverflow.com/questions/56969106/copy-and-paste-the-last-5-active-cells-in-a-column", "title": "Copy and paste the last 5 active cells in a column", "body": "<p>I am trying to copy the last 5 active cells in column D. Everyday we add a new column and the summary data needs to reflect this. </p>\n\n<p>I need to copy these last five figures and paste them across in a row in a different worksheet. </p>\n\n<p>I have been able to select each of the individual cells and copy them, but I'm struggling at pasting them in a different worksheet.</p>\n\n<pre><code>Range(\"D1000\").End(xlDown).Select\nActiveCell.Offset(-4,0)\n</code></pre>\n\n<p>I cannot highlight all five of the figures at the same time.</p>\n"}, {"tags": ["excel", "vba", "listbox"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562755364, "post_id": 56968826, "comment_id": 100474568, "body": "Where is this code placed?"}, {"owner": {"reputation": 17, "user_id": 11692076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb29ca7c7eaf2dfd76ab488bc26d5b1c?s=128&d=identicon&r=PG", "display_name": "DXR", "link": "https://stackoverflow.com/users/11692076/dxr"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562755959, "post_id": 56968826, "comment_id": 100474860, "body": "@SJR I edited my post regarding your input"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562756542, "post_id": 56968826, "comment_id": 100475162, "body": "So these are Forms controls on the sheet and your code is a normal sub in a standard module? I&#39;m not clear how your code is run. I don&#39;t think <code>ActiveControl</code> is right. Forms listboxes don&#39;t have a Click event."}, {"owner": {"reputation": 17, "user_id": 11692076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb29ca7c7eaf2dfd76ab488bc26d5b1c?s=128&d=identicon&r=PG", "display_name": "DXR", "link": "https://stackoverflow.com/users/11692076/dxr"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562761607, "post_id": 56968826, "comment_id": 100477850, "body": "Yes. The Form Controls are generated and their Properties assigned in Module &quot;Generation&quot;. You are absolutely right, there is no &quot;OnClick&quot; Event but it seems, that there is a &quot;OnAction&quot; Event. I know that, because i programmed it with a &quot;OnAction&quot; Event and it worked. But only if i specify the ListBox."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562762048, "post_id": 56968826, "comment_id": 100478087, "body": "Then the answer below should work."}], "answers": [{"comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1562787932, "post_id": 56969637, "comment_id": 100491379, "body": "Great. I think this part <code>Shapes(Application.Caller)</code> should be preceded with <code>ActiveSheet</code> for example"}], "tags": [], "owner": {"reputation": 136405, "user_id": 1140579, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TbC2t.jpg?s=128&g=1", "display_name": "Siddharth Rout", "link": "https://stackoverflow.com/users/1140579/siddharth-rout"}, "is_accepted": false, "score": 2, "last_activity_date": 1562817666, "last_edit_date": 1562817666, "creation_date": 1562757696, "answer_id": 56969637, "question_id": 56968826, "link": "https://stackoverflow.com/questions/56968826/how-do-i-get-the-name-of-the-current-listbox-in-vba/56969637#56969637", "title": "How do I get the name of the current Listbox in VBA?", "body": "<p>You cannot use <code>ActiveControl</code> for Form listboxes. To get the name of the Form listbox which called the ONCLICK event, use <a href=\"https://docs.microsoft.com/en-us/office/vba/api/excel.application.caller\" rel=\"nofollow noreferrer\">Application.Caller property (Excel)</a></p>\n\n<p>In the <code>ONCLICK</code> event of the forms listbox, put this.</p>\n\n<pre><code>Sub ONCLICK()\n    Dim shp As Shape\n    Set shp = Shapes(Application.Caller)\n\n    '~~&gt; This will give you the value of what is selected in that listbox\n    MsgBox shp.ControlFormat.List(shp.ControlFormat.Value)\nEnd Sub\n</code></pre>\n\n<p><strong>Note</strong>: If the above code is not in the respective sheet code area then you will have to chnage <code>Shapes(Application.Caller)</code> to <code>Activesheet.Shapes(Application.Caller)</code> as Yasser mentioned below.</p>\n"}], "owner": {"reputation": 17, "user_id": 11692076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb29ca7c7eaf2dfd76ab488bc26d5b1c?s=128&d=identicon&r=PG", "display_name": "DXR", "link": "https://stackoverflow.com/users/11692076/dxr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 800, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562817666, "creation_date": 1562754764, "last_edit_date": 1562761937, "question_id": 56968826, "link": "https://stackoverflow.com/questions/56968826/how-do-i-get-the-name-of-the-current-listbox-in-vba", "title": "How do I get the name of the current Listbox in VBA?", "body": "<p>according to <a href=\"https://stackoverflow.com/questions/56871346/how-to-address-generated-listboxes-and-add-items-dynamically-in-vba\">How to address generated ListBoxes and add Items dynamically in VBA?</a> I generated several ListBoxes dynamically which I assigned a OnAction Sub to. The OnAction Event shall show me the amount of selected Items of the <em>current</em> ListBox.</p>\n\n<p>For better understanding: </p>\n\n<p>e.g. I generated 5 Listboxes (ListBox1, ListBox2, ...) on my Worksheet \"FS\". </p>\n\n<p>When I click 1 item on ListBox1, MsgBox shows up with \"1\". </p>\n\n<p>If I click an additional item on ListBox1, MsgBox shows \"2\". </p>\n\n<p>But If i click another Item of ListBox3, MsgBox shall show \"1\".</p>\n\n<pre><code>    'ListBoxName as a variable for current ListBox and probably the most problematic line\n    ListBoxName = ActiveControl.Name\n\n    selectedItems = 0\n\n    Set lb = FS.ListBoxes(ListBoxName)\n\n    'The following counts the selected items in target ListBox\n    For i = 1 To lb.ListCount Step 1\n        If lb.Selected(i) Then\n            selectedItems = selectedItems + 1\n        End If\n    Next i\n\n    'This part puts up the Message Box with the number of selected items in target ListBox\n    If selectedItems &gt; 0 Then\n        MsgBox selectedItems\n    End If\n</code></pre>\n\n<p>Additional information: I left out the declarations of the variables for better overview. I am <em>not</em> using ActiveX and I am <em>not</em> using a UserForm. Getting the current name of the Listbox will help me with further programming and tasks I want to do. In my mind it looked so easy to find the name of the ListBox on which I did my latest click...</p>\n\n<p>Thank you in advance!</p>\n\n<p><strong>EDIT</strong>:\nThe code is placed in a module \"Module1\" in Sub Module1. In another Module \"generation\", where I generate the ListBoxes, the Module1 is started with <code>lb.OnAction = \"Module1.Module1\"</code>.</p>\n\n<p><strong>EDIT2</strong>\nChanged \"OnClick\" to \"OnAction\"</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 1, "creation_date": 1562753168, "post_id": 56968175, "comment_id": 100473407, "body": "Look here: <a href=\"https://stackoverflow.com/a/56838292/7599798\">stackoverflow.com/a/56838292/7599798</a>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1562754031, "post_id": 56968175, "comment_id": 100473869, "body": "You are looking for a date but you have declared <code>cfdate as **Long**</code>"}, {"owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "edited": false, "score": 0, "creation_date": 1562754125, "post_id": 56968175, "comment_id": 100473923, "body": "declaring the cfdate as date returns the same error"}, {"owner": {"reputation": 7484, "user_id": 6774472, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KcAPv.png?s=128&g=1", "display_name": "Error 1004", "link": "https://stackoverflow.com/users/6774472/error-1004"}, "edited": false, "score": 0, "creation_date": 1562755471, "post_id": 56968175, "comment_id": 100474623, "body": "Check date format"}, {"owner": {"reputation": 2787, "user_id": 3688861, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54740a77960418f6992ef8e8cf88deba?s=128&d=identicon&r=PG&f=1", "display_name": "Tragamor", "link": "https://stackoverflow.com/users/3688861/tragamor"}, "edited": false, "score": 0, "creation_date": 1562756391, "post_id": 56968175, "comment_id": 100475095, "body": "<a href=\"https://stackoverflow.com/questions/31186598/find-date-variable-within-a-row-and-return-column-vba/31188450#31188450\" title=\"find date variable within a row and return column vba\">stackoverflow.com/questions/31186598/&hellip;</a>"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1562757791, "post_id": 56968175, "comment_id": 100475810, "body": "I cannot reproduce your problem with the information you have provided. Can you upload a workbook that demonstrates the problem (with sensitive information removed) to some sharing site and post a link here?  Are your Windows Regional Short Date settings <code>dd-MMM-yy</code>?"}, {"owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1562762043, "post_id": 56968175, "comment_id": 100478083, "body": "@RonRosenfeld here you are <a href=\"https://wetransfer.com/downloads/4f45c99c9bd0de3c4cc53baea656f56920190710123246/0dafde24b438b086d576ac121ba263a020190710123246/1ba131\" rel=\"nofollow noreferrer\">link</a>. Yes, the format date is as you have written in your comment"}, {"owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "reply_to_user": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1562762091, "post_id": 56968175, "comment_id": 100478117, "body": "@RonRosenfeld however i would like that the find methods works for all formats, not only for a specific one"}, {"owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "edited": false, "score": 0, "creation_date": 1562764368, "post_id": 56968175, "comment_id": 100479460, "body": "After looking at your worksheet, I believe your question is a duplicate of <a href=\"https://stackoverflow.com/questions/45639660/excel-vba-range-find-date-that-is-a-formula\">Excel VBA Range.Find Date That is a Formula</a>.  My answer explains the issue, and also provides two work-arounds."}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "edited": false, "score": 0, "creation_date": 1562754161, "post_id": 56968550, "comment_id": 100473934, "body": "nope. It returns nothing. If I search the variable in excel as 30-Jun-19 then it finds it, so there must be a problem with the code."}, {"owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "edited": false, "score": 0, "creation_date": 1562761326, "post_id": 56968550, "comment_id": 100477715, "body": "&quot;dd-mmm-yy&quot; so 30 june 2019 is 30-Jun-19"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "edited": false, "score": 0, "creation_date": 1562772306, "post_id": 56968550, "comment_id": 100484123, "body": "You need to share your workbook, otherwise I don&#39;t see why it isn&#39;t working"}, {"owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "edited": false, "score": 0, "creation_date": 1562776913, "post_id": 56968550, "comment_id": 100486580, "body": "here you are <a href=\"https://wetransfer.com/downloads/4f45c99c9bd0de3c4cc53baea656f56920190710123246/0dafde24b438b086d576ac121ba263a020190710123246/1ba131\" rel=\"nofollow noreferrer\">sample</a>"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 0, "last_activity_date": 1562753717, "creation_date": 1562753717, "answer_id": 56968550, "question_id": 56968175, "link": "https://stackoverflow.com/questions/56968175/find-returns-nothing-even-if-value-exists/56968550#56968550", "title": "Find returns nothing even if value exists", "body": "<p>This code should work:</p>\n\n<pre><code>Sub actual_cash_flow()\n\nDim cfdate As Date\nDim daterow As Long\nDim datecolumn As Long\nDim fnd As Range\n\ncfdate = WorksheetFunction.EoMonth(Date, -1)\n\nSet fnd = Worksheets(\"SheetName\").Cells.Find(What:=cfdate, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False, searchformat:=False)\n\nIf Not fnd Is Nothing Then\n\n    daterow = fnd.Row\n    datecolumn = fnd.Column\n\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p><strong><em>Put in your sheet Name in the Code.</em></strong> </p>\n\n<p>The problem was with the setup of variables, you should declare them as date when searching for a Date.</p>\n"}, {"tags": [], "owner": {"reputation": 39656, "user_id": 2872922, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/c99b8cacb44a4ada478397cb29da0cac?s=128&d=identicon&r=PG&f=1", "display_name": "Ron Rosenfeld", "link": "https://stackoverflow.com/users/2872922/ron-rosenfeld"}, "is_accepted": true, "score": 2, "last_activity_date": 1562776915, "creation_date": 1562776915, "answer_id": 56975169, "question_id": 56968175, "link": "https://stackoverflow.com/questions/56968175/find-returns-nothing-even-if-value-exists/56975169#56975169", "title": "Find returns nothing even if value exists", "body": "<p>As I pointed out in my answer to a previous question, working with dates and the <code>Range.Find</code> function can be tricky.  One of the reasons seems to be that the VBA Date datatype is not the same as the date stored on an Excel worksheet.  The latter is a <code>Double</code> formatted to look like a date.</p>\n\n<p>So, especially if you want your <code>.Find</code> method to be independent of the date settings, you are probably best off not using the <code>Range.Find</code> method but rather looping through the data.</p>\n\n<p>In the code below, I show an example of how this might work, making assumptions based on the workbook you provided, and also using a VBA array as this will run much faster than looping through a range on the worksheet:</p>\n\n<pre><code>Sub actualcf()\n\nDim cfdate As Long  'Yes --Long for this application\nDim daterow As Long\nDim datecolumn As Long\nDim fnd As Range\n\nDim srchRng As Range\nDim vSrch As Variant\nDim I As Long\n\nWith Worksheets(\"Peschiera CF\")\n\n'Find the row with the dates\nSet srchRng = .Cells.Find(what:=\"Yr. Ending\", after:=.Cells(1, 1), LookIn:=xlValues)\n\n'Read that row into a VBA array, but only the columns with data\n'Note that we are using `.Value2` which has no formatting\nIf Not srchRng Is Nothing Then\n    vSrch = .Range(.Cells(srchRng.Row, 1), .Cells(srchRng.Row, .Columns.Count).End(xlToLeft)).Value2\nEnd If\n\ncfdate = WorksheetFunction.EoMonth(Date, -1)\nFor I = 1 To UBound(vSrch, 2)\n    If vSrch(1, I) = cfdate Then\n        daterow = srchRng.Row\n        datecolumn = I\n    End If\nNext I\n\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4596886, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Mg76hKUUd0Q/AAAAAAAAAAI/AAAAAAAAAiA/VUXsfCZdnOk/photo.jpg?sz=128", "display_name": "Saverio", "link": "https://stackoverflow.com/users/4596886/saverio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 56975169, "answer_count": 2, "score": -1, "last_activity_date": 1562776915, "creation_date": 1562752586, "last_edit_date": 1562754404, "question_id": 56968175, "link": "https://stackoverflow.com/questions/56968175/find-returns-nothing-even-if-value-exists", "title": "Find returns nothing even if value exists", "body": "<p>So here I have the nth question about the find method. I have read many questions about it and the  problems it carries, but still couldnt find a solution to my problem.</p>\n\n<p>I simply want to return the number of row and number of column for a particular value (a date). However, the code runs always the same 91 error (object variable not set) because the find method does not find anything. </p>\n\n<p>I have tried to define the variable as range and change the code by setting the variable (i.e. set daterow = etc.). But the problem persists.</p>\n\n<pre><code>Sub actual_cash_flow()\nDim cfdate As Long\nDim today As Long\nDim daterow As Long\nDim datecolumn As Long\n\ntoday = Date\ncfdate = WorksheetFunction.EoMonth(today, -1)\n\ndaterow = Sheet2.Cells.Find(What:=cfdate, LookIn:=xlValues, LookAt:=xlWhole, MatchCase:=False, searchformat:=False).Row\ndatecolumn = Sheet2.Cells.Find(What:=cfdate).Column\n\n\nEnd Sub\n</code></pre>\n\n<p>I would like to have number of row and number of column in order to identify the cell and then perform some actions.</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>By editing the code as suggested by @mikku and by debugging the range where there is the value and the variable defined in the code I get the same value, however, I still get nothing as output. So I really dont know where the error is. See the image.</p>\n\n<p><a href=\"https://i.stack.imgur.com/SVt9f.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SVt9f.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba", "powerpoint"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1562752898, "post_id": 56967587, "comment_id": 100473246, "body": "Then the <code>tblSOP.Cells(r, iBUold).Value</code> is simply not an item within <code>ptTblCountry.PageFields(&quot;BUold&quot;)</code> - perhaps due to another spelling or an additional blank."}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 2, "creation_date": 1562753146, "post_id": 56967587, "comment_id": 100473395, "body": "Next time please try to provide your code as as <b><i>minimal</i></b>, complete and verifiable <a href=\"https://stackoverflow.com/help/mcve\">example</a>."}], "owner": {"reputation": 3, "user_id": 11764052, "user_type": "registered", "profile_image": "https://graph.facebook.com/1640989079329044/picture?type=large", "display_name": "Kristian Tonev", "link": "https://stackoverflow.com/users/11764052/kristian-tonev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 84, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562750790, "creation_date": 1562750790, "question_id": 56967587, "link": "https://stackoverflow.com/questions/56967587/vba-pivot-table-run-time-error-5-invalid-procedure-call-or-argument", "title": "VBA Pivot Table Run Time Error 5 Invalid Procedure Call or Argument", "body": "<p>I have a VBA code which basically puts filters on pivot tables and then copies them to PowerPoint based on some settings.</p>\n\n<p>The code is running fine except for one particular setting on a region. If I run the macro without that region it is all fine.</p>\n\n<p>Below is the full code and I get the error on the highlighted line.</p>\n\n<p>ptTblCountry.PageFields(\"BUold\").CurrentPage = tblSOP.Cells(r, iBUold).Value</p>\n\n<p>I have already checked everything from names to ranges to settings but I cannot find any issue.</p>\n\n<pre><code>Sub CreatePowerPoint()\n\n 'Add a reference to the Microsoft PowerPoint Library by:\n    '1. Go to Tools in the VBA menu\n    '2. Click on Reference\n    '3. Scroll down to Microsoft PowerPoint X.0 Object Library, check the box, and press Okay\n\n    'First we declare the variables we will be using\n        Dim newPowerPoint As PowerPoint.Application\n        Dim activeSlide As PowerPoint.Slide\n        Dim TemplateFile As String\n        TemplateFile = Range(\"SOPtemplate\")\n        Dim OutputPath As String\n        OutputPath = Range(\"SOPoutputPath\")\n        Dim cht As Excel.ChartObject\n        Dim tblSOP As Range\n        Dim iGenerate, iIndex, iBMC, iMnth_lng, iMnth_sht, iFilename, iBU, iBUold, iMAG, iMAG_name, iCluster, iChannel, iSlideNr, iView As Integer\n        Set tblSOP = Range(\"tbl_SOP\")\n        Dim sht As Worksheet\n        Set sht = Sheets(\"Run rate BMC S&amp;OP\")\n        Dim ptGrph As PivotTable\n        Set ptGrph = sht.PivotTables(\"ptSOP_RR\")\n        Dim ptTblMAG As PivotTable\n        Set ptTblMAG = sht.PivotTables(\"ptSOP_MAG\")\n        Dim ptTblAG As PivotTable\n        Set ptTblAG = sht.PivotTables(\"ptSOP_AG\")\n        Dim ptTblCAG As PivotTable\n        Set ptTblCAG = sht.PivotTables(\"ptSOP_CAG\")\n        Dim ptTblCountry As PivotTable\n        Set ptTblCountry = sht.PivotTables(\"ptSOP_Country\")\n        Dim pi As PivotItem\n        Dim sVal As String\n        Dim s As Integer\n        Dim sChannel As String\n        Dim sCluster As String\n        Dim bChanged As Boolean\n        Dim TimeStart, TimeEnd\n        Dim iSlides As Integer\n        Dim sYear As String\n\n    'Record time of start\n        TimeStart = Now()\n\n    'Define column heading numbers in tblSOP\n        iGenerate = 1\n        iIndex = 2\n        iBMC = 3\n        iMnth_lng = 4\n        iMnth_sht = 5\n        iFilename = 6\n        iBU = 7\n        iBUold = 8\n        iMAG = 9\n        iMAG_name = 10\n        iCluster = 11\n        iChannel = 12\n        iSlideNr = 13\n        iView = 14\n\n'     'Look for existing instance - if found, close it\n'        On Error Resume Next\n'        Set newPowerPoint = GetObject(, \"PowerPoint.Application\")\n'        On Error GoTo 0\n\n        MsgBox \"Make sure that powerpoint is not open! Close ALL powerpoint screens!\"\n    'Let's create a new PowerPoint\n        If newPowerPoint Is Nothing Then\n            Set newPowerPoint = New PowerPoint.Application\n        End If\n    'Show the PowerPoint\n        newPowerPoint.Visible = True\n    'Open template ppt\n        newPowerPoint.Presentations.Open TemplateFile\n\n        bChanged = False\n\n        For r = 1 To tblSOP.Rows.Count\n            'Check if this row in SOP_table needs to be executed. If not, skip copy actions\n                If tblSOP.Cells(r, iGenerate) = \"N\" Then GoTo SavePPT\n\n            'Adjust title slide\n                newPowerPoint.ActivePresentation.Slides(1).Shapes(\"BMC\").TextFrame.TextRange.Text = tblSOP.Cells(r, iBMC)\n                newPowerPoint.ActivePresentation.Slides(1).Shapes(\"Month\").TextFrame.TextRange.Text = tblSOP.Cells(r, iMnth_lng)\n\n            'Set pivot tables to right selection\n                Application.ScreenUpdating = False\n                Application.Calculation = xlCalculationManual\n                bChanged = True\n\n                sYear = Right(tblSOP.Cells(r, iMnth_lng), 4) 'used for sorting pivot tables\n\n                'Filter pivot table for graph\n                ptGrph.PageFields(\"BU desc\").CurrentPage = tblSOP.Cells(r, iBU).Value\n                ptGrph.PageFields(\"BUold\").CurrentPage = tblSOP.Cells(r, iBUold).Value\n                ptGrph.PageFields(\"MAG\").CurrentPage = tblSOP.Cells(r, iMAG).Value\n                ptGrph.PageFields(\"BMC\").CurrentPage = tblSOP.Cells(r, iBMC).Value\n                ptGrph.PageFields(\"Cluster\").CurrentPage = tblSOP.Cells(r, iCluster).Value\n                ptGrph.PageFields(\"Dchannel desc\").CurrentPage = tblSOP.Cells(r, iChannel).Value\n\n                Select Case tblSOP.Cells(r, iView)\n                    Case \"MAG\"\n                        'Filter pivot table\n                        ptTblMAG.PageFields(\"BU desc\").CurrentPage = tblSOP.Cells(r, iBU).Value\n                        ptTblMAG.PivotFields(\"BUold\").ClearAllFilters\n                        For Each pi In ptTblMAG.PivotFields(\"BUold\").PivotItems\n                            If pi = tblSOP.Cells(r, iBUold).Value Then pi.Visible = True Else pi.Visible = False\n                        Next pi\n                        ptTblMAG.PivotFields(\"MAG\").ClearAllFilters\n                        If tblSOP.Cells(r, iMAG).Value &lt;&gt; \"(All)\" Then\n                            For Each pi In ptTblMAG.PivotFields(\"MAG\").PivotItems\n                                If pi = tblSOP.Cells(r, iMAG).Value Then pi.Visible = True Else pi.Visible = False\n                            Next pi\n                        End If\n                        ptTblMAG.PageFields(\"BMC\").CurrentPage = tblSOP.Cells(r, iBMC).Value\n                        ptTblMAG.PageFields(\"Cluster\").CurrentPage = tblSOP.Cells(r, iCluster).Value\n                        ptTblMAG.PageFields(\"Dchannel desc\").CurrentPage = tblSOP.Cells(r, iChannel).Value\n                        'Sort pivot table\n                        ptTblMAG.PivotFields(\"MAG\").AutoSort xlDescending, \"Total \" &amp; sYear &amp; \" \"\n                    Case \"AG\"\n                        'Filter pivot table\n                        ptTblAG.PageFields(\"BU desc\").CurrentPage = tblSOP.Cells(r, iBU).Value\n                        ptTblAG.PivotFields(\"BUold\").ClearAllFilters\n                        For Each pi In ptTblAG.PivotFields(\"BUold\").PivotItems\n                            If pi = tblSOP.Cells(r, iBUold).Value Then pi.Visible = True Else pi.Visible = False\n                        Next pi\n'\n                        ptTblAG.PivotFields(\"MAG\").ClearAllFilters\n                        If tblSOP.Cells(r, iMAG).Value &lt;&gt; \"(All)\" Then\n                            For Each pi In ptTblAG.PivotFields(\"MAG\").PivotItems\n                                If pi = tblSOP.Cells(r, iMAG).Value Then pi.Visible = True Else pi.Visible = False\n                            Next pi\n                        End If\n\n'                        ptTblAG.PageFields(\"MAG\").CurrentPage = tblSOP.Cells(r, iMAG).Value\n                        ptTblAG.PageFields(\"BMC\").CurrentPage = tblSOP.Cells(r, iBMC).Value\n                        ptTblAG.PageFields(\"Cluster\").CurrentPage = tblSOP.Cells(r, iCluster).Value\n                        ptTblAG.PageFields(\"Dchannel desc\").CurrentPage = tblSOP.Cells(r, iChannel).Value\n                        'Sort pivot table\n                        ptTblAG.PivotFields(\"MAG\").AutoSort xlDescending, \"Total \" &amp; sYear &amp; \" \"\n                        ptTblAG.PivotFields(\"AG\").AutoSort xlDescending, \"Total \" &amp; sYear &amp; \" \"\n                    Case \"CAG\"\n                        'Filter pivot table\n                        ptTblCAG.PageFields(\"BU desc\").CurrentPage = tblSOP.Cells(r, iBU).Value\n                        ptTblCAG.PageFields(\"BUold\").CurrentPage = tblSOP.Cells(r, iBUold).Value\n                        ptTblCAG.PageFields(\"MAG\").CurrentPage = tblSOP.Cells(r, iMAG).Value\n                        ptTblCAG.PageFields(\"BMC\").CurrentPage = tblSOP.Cells(r, iBMC).Value\n                        ptTblCAG.PageFields(\"Cluster\").CurrentPage = tblSOP.Cells(r, iCluster).Value\n                        ptTblCAG.PageFields(\"Dchannel desc\").CurrentPage = tblSOP.Cells(r, iChannel).Value\n                        'Sort pivot table\n                        ptTblCAG.PivotFields(\"CAG\").AutoSort xlDescending, \"Total \" &amp; sYear &amp; \" \"\n                    Case \"Country\"\n                        'Filter pivot table\n\n                        ptTblCountry.PageFields(\"BU desc\").CurrentPage = tblSOP.Cells(r, iBU).Value\n------------&gt;           ptTblCountry.PageFields(\"BUold\").CurrentPage = tblSOP.Cells(r, iBUold).Value\n                        ptTblCountry.PageFields(\"MAG\").CurrentPage = tblSOP.Cells(r, iMAG).Value\n                        ptTblCountry.PageFields(\"BMC\").CurrentPage = tblSOP.Cells(r, iBMC).Value\n                        ptTblCountry.PivotFields(\"Cluster\").ClearAllFilters\n                        If tblSOP.Cells(r, iCluster) &lt;&gt; \"(All)\" Then\n                            For Each pi In ptTblCountry.PivotFields(\"Cluster\").PivotItems\n                                If pi = tblSOP.Cells(r, iCluster).Value Then pi.Visible = True Else pi.Visible = False\n                            Next pi\n                        End If\n                        ptTblCountry.PageFields(\"Dchannel desc\").CurrentPage = tblSOP.Cells(r, iChannel).Value\n                        'No need to sort - sorting clusters alphabetically\n                End Select\n\n                Application.Calculation = xlCalculationAutomatic\n                Application.ScreenUpdating = True\n\n        'Select chart in the Excel worksheet and paste them into the PowerPoint\n                sht.Visible = xlSheetVisible\n                sht.Activate\n                Set cht = sht.ChartObjects(\"chart_SOP_RR\")\n\n            'Add a new slide where we will paste the chart\n                s = tblSOP.Cells(r, iSlideNr)\n                newPowerPoint.ActivePresentation.Slides.Add s, ppLayoutText\n                newPowerPoint.ActiveWindow.View.GotoSlide s\n                Set activeSlide = newPowerPoint.ActivePresentation.Slides(s)\n\n            'Set the title of the slide\n                If tblSOP.Cells(r, iCluster) &lt;&gt; \"(All)\" Then sCluster = tblSOP.Cells(r, iCluster) &amp; \" \" Else sCluster = \"\"\n                If tblSOP.Cells(r, iChannel) &lt;&gt; \"(All)\" Then sChannel = tblSOP.Cells(r, iChannel) &amp; \" \" Else sChannel = \"\"\n                activeSlide.Shapes(1).TextFrame.TextRange.Text = \"Demand Evolution \" &amp; sCluster &amp; sChannel &amp; \"- \" &amp; tblSOP.Cells(r, iBUold) &amp; \" \" &amp; tblSOP.Cells(r, iMAG_name)\n                activeSlide.Shapes(2).TextFrame.TextRange.Text = \"LM - \" &amp; vbNewLine &amp; vbNewLine &amp; vbNewLine &amp; \"Changes in Demand -  \" &amp; vbNewLine &amp; vbNewLine &amp; vbNewLine &amp; \"AOB - \"\n            'Copy the chart and paste it into the PowerPoint as a Metafile Picture\n                cht.Select\n                ActiveChart.ChartArea.Copy\n                activeSlide.Shapes.PasteSpecial(DataType:=ppPasteEnhancedMetafile).Select 'Office2017\n            '                activeSlide.Shapes.PasteSpecial DataType:=ppPasteEnhancedMetafile 'Office2013\n\n            'Adjust the positioning of the Chart on Powerpoint Slide\n                newPowerPoint.ActiveWindow.Selection.ShapeRange.Left = 11\n                newPowerPoint.ActiveWindow.Selection.ShapeRange.Top = 70\n                newPowerPoint.ActiveWindow.Selection.ShapeRange.ScaleHeight 0.78, msoFalse\n\n        'Copy the AG/MAG/CAG/Country pivot table from Excel\n                Select Case tblSOP.Cells(r, iView)\n                    Case \"MAG\"\n                        sht.PivotTables(\"ptSOP_MAG\").TableRange1.Offset(-1, 0).Resize(ActiveSheet.PivotTables(\"ptSOP_MAG\").TableRange1.Rows.Count + 1).Select\n                    Case \"AG\"\n                        sht.PivotTables(\"ptSOP_AG\").TableRange1.Offset(-1, 0).Resize(ActiveSheet.PivotTables(\"ptSOP_AG\").TableRange1.Rows.Count + 1).Select\n                    Case \"CAG\"\n                        sht.PivotTables(\"ptSOP_CAG\").TableRange1.Offset(-1, 0).Resize(ActiveSheet.PivotTables(\"ptSOP_CAG\").TableRange1.Rows.Count + 1).Select\n                    Case \"Country\"\n                        sht.PivotTables(\"ptSOP_Country\").TableRange1.Offset(-1, 0).Resize(ActiveSheet.PivotTables(\"ptSOP_Country\").TableRange1.Rows.Count + 1).Select\n                End Select\n                Selection.Copy\n                Application.Wait Now + TimeValue(\"0:00:02\")\n                activeSlide.Shapes.PasteSpecial(DataType:=ppPasteEnhancedMetafile).Select 'Office2018\n                '                activeSlide.Shapes.PasteSpecial DataType:=ppPasteEnhancedMetafile 'Office2013\n            'Adjust the positioning of the AG/MAG table on Powerpoint Slide\n                newPowerPoint.ActiveWindow.Selection.ShapeRange.Left = 0\n                newPowerPoint.ActiveWindow.Selection.ShapeRange.Top = 321\n                newPowerPoint.ActiveWindow.Selection.ShapeRange.ScaleWidth 720 / newPowerPoint.ActiveWindow.Selection.ShapeRange.Width, msoFalse\n                newPowerPoint.ActiveWindow.Selection.ShapeRange.Fill.Solid\n                newPowerPoint.ActiveWindow.Selection.ShapeRange.Fill.ForeColor.RGB = RGB(255, 255, 255)\n                newPowerPoint.ActiveWindow.Selection.ShapeRange.Fill.Visible = msoTrue\n\n        'Increase the amount of slides which are created until now\n                iSlides = iSlides + 1\n\nSavePPT:\n            'Check if this was the last slide for this ppt. If so, adjust title slide and save\n            If tblSOP.Cells(r + 1, iIndex) &lt;&gt; tblSOP.Cells(r, iIndex) And bChanged Then\n                If newPowerPoint.Presentations.Count &gt; 0 Then\n                    'Adjust title slide\n'                    newPowerPoint.ActiveWindow.View.GotoSlide 1\n'                    newPowerPoint.ActivePresentation.Slides(1).Shapes(\"BMC\").TextFrame.TextRange.Text = tblSOP.Cells(r, iBMC)\n'                    newPowerPoint.ActivePresentation.Slides(1).Shapes(\"Month\").TextFrame.TextRange.Text = tblSOP.Cells(r, iMnth_lng)\n                    'Save and close presentation\n                    newPowerPoint.ActivePresentation.SaveAs OutputPath &amp; tblSOP.Cells(r, iFilename)\n                    newPowerPoint.ActivePresentation.Close\n                End If\n                'If there is another ppt to be made, open the template\n                If r &lt; tblSOP.Rows.Count Then\n                    newPowerPoint.Presentations.Open TemplateFile\n                    bChanged = False\n                End If\n            End If\n\n        Next r\n\n    Sheets(\"pptGen BMC S&amp;OP\").Activate\n\nexito:\n'    AppActivate (\"Microsoft PowerPoint\")\n    Set activeSlide = Nothing\n    newPowerPoint.Quit\n    Set newPowerPoint = Nothing\n\n    sVal = Format(Now() - TimeStart, \"Long time\")\n    MsgBox \"Ready!\" &amp; vbCrLf &amp; iSlides &amp; \" slides created in \" &amp; sVal &amp; \" :-)\", vbOKOnly\n\nEnd Sub\n\n\nSub Pivot_ResetAllPageFieldCaptions()\n    'retrieve original field names\n    'if captions have been typed into pt\n    Dim pt As PivotTable\n    Dim pf As PivotField\n    Dim pi As PivotItem\n    Dim i As Double\n'    On Error GoTo MyErr\n\n    Application.ScreenUpdating = False\n\n    For Each pt In Sheets(\"Run rate BMC S&amp;OP\").PivotTables\n        pt.ManualUpdate = True\n\n        For Each pf In pt.PageFields\n            'First set all captions to a random name (to prevent renaming to a name that is already taken)\n            i = 1\n            For Each pi In pf.PivotItems\n                pi.Caption = \"asdfa\" &amp; i\n                i = i + 1\n            Next pi\n            'Now, reset all captions to source name\n            For Each pi In pf.PivotItems\n                pi.Caption = pi.SourceName\n            Next pi\n        Next pf\n\n        pt.RefreshTable\n        pt.ManualUpdate = False\n    Next pt\n\nexitHandler:\n    Set pi = Nothing\n    Set pt = Nothing\n    Application.ScreenUpdating = True\n    MsgBox \"Pivot tables reset ready!\", vbOKOnly\n    Exit Sub\n\n'Error stuff\nMyErr:\n    If Err.Number = 1004 Then\n        MsgBox \"You must place your cursor inside of a pivot table.\"\n    Else\n        MsgBox Err.Number &amp; vbCrLf &amp; Err.Description\n        GoTo exitHandler\n    End If\n\n\nEnd Sub\n\n```**strong text**\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1562750332, "post_id": 56967179, "comment_id": 100471718, "body": "Did you use an ActiveX Object for a checkbox or a Form Control? For ActiveX your code should work... so i supect you are using a form control"}, {"owner": {"reputation": 7, "user_id": 11641610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/beOUs.png?s=128&g=1", "display_name": "Angie", "link": "https://stackoverflow.com/users/11641610/angie"}, "edited": false, "score": 0, "creation_date": 1562750419, "post_id": 56967179, "comment_id": 100471761, "body": "I have used a form control"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "edited": false, "score": 0, "creation_date": 1562750491, "post_id": 56967179, "comment_id": 100471805, "body": "Ok. I assumed that the line you get the error on was the one with the checkbox. You didn&#39;t specify. Please advise if my assumption is not correct."}], "answers": [{"comments": [{"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 7, "user_id": 11641610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/beOUs.png?s=128&g=1", "display_name": "Angie", "link": "https://stackoverflow.com/users/11641610/angie"}, "edited": false, "score": 0, "creation_date": 1562754436, "post_id": 56967462, "comment_id": 100474068, "body": "hi angie. glad it was the solution to you problem. If the answer solved your problem you can also set the check mark so that others know this question is solved. thanks!"}], "tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": true, "score": 1, "last_activity_date": 1562750445, "creation_date": 1562750445, "answer_id": 56967462, "question_id": 56967179, "link": "https://stackoverflow.com/questions/56967179/how-do-i-show-or-hide-buttons-based-on-certain-cell-criteria-in-vba/56967462#56967462", "title": "How do I show or hide buttons based on certain cell criteria in VBA?", "body": "<p>The type of CheckBox Control that you use matters. To use a form control use the second approach.</p>\n\n<pre><code>Sub test()\n\n'ActiveX Object\nSheet1.CheckBox1.Visible = True\n\n'Form Control Object\nSheet1.Shapes(\"Check Box 2\").Visible = False\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 11641610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/beOUs.png?s=128&g=1", "display_name": "Angie", "link": "https://stackoverflow.com/users/11641610/angie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 56967462, "answer_count": 1, "score": 0, "last_activity_date": 1562750445, "creation_date": 1562749418, "last_edit_date": 1562750012, "question_id": 56967179, "link": "https://stackoverflow.com/questions/56967179/how-do-i-show-or-hide-buttons-based-on-certain-cell-criteria-in-vba", "title": "How do I show or hide buttons based on certain cell criteria in VBA?", "body": "<p>Quite new to excel and VBA....I want to hide certain buttons on my excel sheet based on if a reference cell is empty or not. So the button should show if the reference cell contains any value, and should not be visible if the reference cell is empty. When I run my code, I get a Run-time error : Object doesn't support this property or method. I have renamed all of my buttons on my sheet. I'm not sure what the problem is. See code below....</p>\n\n<pre><code>Sub hideshowcheckboxes()\nApplication.ScreenUpdating = False\nSheets(\"Dispatch TOOL\").Select\nIf Range(\"D12\").Value = \" \" Then\n    Sheets(\"Dispatch TOOL\").check1.Visible = False\nElse\n    Sheets(\"Dispatch TOOL\").check1.Visible = True\nEnd If\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 157, "user_id": 9273793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1af99297e62abb8c1e5b454976761c6?s=128&d=identicon&r=PG&f=1", "display_name": "Experimenter", "link": "https://stackoverflow.com/users/9273793/experimenter"}, "edited": false, "score": 0, "creation_date": 1562750040, "post_id": 56967212, "comment_id": 100471540, "body": "Can we limit <code>MsgBox WorksheetFunction.CountA(Range(Cells(14, 4), Range(&quot;4&quot; &amp; Rows.Count).End(xlUp)))</code> to count till 45 row no.?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 157, "user_id": 9273793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1af99297e62abb8c1e5b454976761c6?s=128&d=identicon&r=PG&f=1", "display_name": "Experimenter", "link": "https://stackoverflow.com/users/9273793/experimenter"}, "edited": false, "score": 0, "creation_date": 1562750177, "post_id": 56967212, "comment_id": 100471628, "body": "Why not just <code>range(&quot;A14:A45&quot;)</code> then? <code>Cells(14, 4)</code> is D14 though."}, {"owner": {"reputation": 157, "user_id": 9273793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1af99297e62abb8c1e5b454976761c6?s=128&d=identicon&r=PG&f=1", "display_name": "Experimenter", "link": "https://stackoverflow.com/users/9273793/experimenter"}, "edited": false, "score": 0, "creation_date": 1562750510, "post_id": 56967212, "comment_id": 100471818, "body": "I&#39;ve to get count from each column. Basically I&#39;m printing the rows from each column from that range and I&#39;m counting cells for this reason so that I can use it in <code>for...next</code> loop. Filled cells from column are different."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 157, "user_id": 9273793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1af99297e62abb8c1e5b454976761c6?s=128&d=identicon&r=PG&f=1", "display_name": "Experimenter", "link": "https://stackoverflow.com/users/9273793/experimenter"}, "edited": false, "score": 0, "creation_date": 1562750574, "post_id": 56967212, "comment_id": 100471859, "body": "Do you mean you want to count the number of filled cells between row 14 and 45 in several different columns?"}, {"owner": {"reputation": 157, "user_id": 9273793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1af99297e62abb8c1e5b454976761c6?s=128&d=identicon&r=PG&f=1", "display_name": "Experimenter", "link": "https://stackoverflow.com/users/9273793/experimenter"}, "edited": false, "score": 0, "creation_date": 1562750658, "post_id": 56967212, "comment_id": 100471930, "body": "Yes. If above line can be in format <code>cells(row, column)</code> I can achieve what I want."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": true, "score": 1, "last_activity_date": 1562750678, "last_edit_date": 1562750678, "creation_date": 1562749540, "answer_id": 56967212, "question_id": 56967148, "link": "https://stackoverflow.com/questions/56967148/count-filled-cells-in-a-certain-rows-in-each-column/56967212#56967212", "title": "Count filled cells in a certain rows in each column", "body": "<p>Not sure I understand, but this will look at everything between A14 and the last filled cell in A:</p>\n\n<pre><code>msgbox worksheetfunction.counta(range(\"A14\",range(\"A\" &amp; rows.count).end(xlup)))\n</code></pre>\n\n<p>If for several columns perhaps this?</p>\n\n<pre><code>Sub x()\n\nDim c As Long\n\nFor c = 1 To 10 'A to J\n    MsgBox WorksheetFunction.CountA(Range(Cells(14, c), Cells(45, c)))\nNext c\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 9273793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1af99297e62abb8c1e5b454976761c6?s=128&d=identicon&r=PG&f=1", "display_name": "Experimenter", "link": "https://stackoverflow.com/users/9273793/experimenter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 56967212, "answer_count": 1, "score": 0, "last_activity_date": 1562762570, "creation_date": 1562749307, "last_edit_date": 1562762570, "question_id": 56967148, "link": "https://stackoverflow.com/questions/56967148/count-filled-cells-in-a-certain-rows-in-each-column", "title": "Count filled cells in a certain rows in each column", "body": "<p>I want to count filled cells from each column and from row 14 to 45.\nI'm using below code to find the count of filled cells in a fixed range but unable to check for each column as I'm unable to make 1st row in range type <code>cells(row,column)</code> format. Any help please.</p>\n\n<pre><code>Range(\"A14\", Range(\"A14\").End(xlDown)).Select\nm = Selection.Rows.Count\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1562749618, "post_id": 56967127, "comment_id": 100471292, "body": "Which line errors?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11732489"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562749719, "post_id": 56967127, "comment_id": 100471350, "body": "Here: &quot; End If         Sheets(&quot;Sheet&quot; &amp; IdSheet &amp; &quot;&quot;).Select         Range(&quot;B&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0).Select         ActiveSheet.Paste&quot;"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562750260, "post_id": 56967127, "comment_id": 100471671, "body": "Think the problem is you are trying to paste an entire row into a range starting in column B so you are falling off the edge of the spreadsheet."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11732489"}, "reply_to_user": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562751029, "post_id": 56967127, "comment_id": 100472163, "body": "how should I code it @JSR? Please help me, I&#39;m new to VBA :("}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1562751274, "post_id": 56967127, "comment_id": 100472336, "body": "You need to either not cut the whole row or paste starting in column A."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562751296, "post_id": 56967127, "comment_id": 100472348, "body": "And read this <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\" title=\"how to avoid using select in excel vba\">stackoverflow.com/questions/10714251/&hellip;</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user11732489"}, "edited": false, "score": 0, "creation_date": 1562752579, "post_id": 56967127, "comment_id": 100473041, "body": "its from a raw file provided by my proctor, it&#39;s my first time using VBA. I&#39;m still not great using it :("}, {"owner": {"user_type": "does_not_exist", "display_name": "user11732489"}, "edited": false, "score": 0, "creation_date": 1562752628, "post_id": 56967127, "comment_id": 100473072, "body": "I have a plan on how am I going to remove them, the only thing that&#39;s stopping me is this part. I am really in need to separate that execsdate in 5 sheets together with the lines below them :("}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user11732489"}, "edited": false, "score": 1, "creation_date": 1562814233, "post_id": 56970917, "comment_id": 100497725, "body": "It worked! thank you very much! I&#39;ll just delete the exceeding sheets. God bless you more!!"}, {"owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "edited": false, "score": 1, "creation_date": 1562822864, "post_id": 56970917, "comment_id": 100499568, "body": "@Zha, you are welcome. God bless you too. You can also upvote as well."}], "tags": [], "owner": {"reputation": 3300, "user_id": 5166387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4c101d57cdeeeabd02376fb96951672?s=128&d=identicon&r=PG&f=1", "display_name": "AAA", "link": "https://stackoverflow.com/users/5166387/aaa"}, "is_accepted": true, "score": 0, "last_activity_date": 1562762368, "creation_date": 1562762368, "answer_id": 56970917, "question_id": 56967127, "link": "https://stackoverflow.com/questions/56967127/how-to-find-a-specific-word-and-transfer-it-to-another-sheet-together-with-the-l/56970917#56970917", "title": "How to find a specific word and transfer it to another sheet together with the lines below the specific word", "body": "<p>This answer works if you get rid of all the double \"EXECSDATE\" like you said you would, and assumes B1 contains \"EXECSDATE\":</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Combine()\nDim x as Variant, rng as Range, CRng as Range, s as String\nDim LastRow as Long, i as Long\ni = 2 : s = \"EXECSDATE\"\n\nWith ThisWorkbook.Worksheets(\"Sheet1\")\n    LastRow = .Range(\"B\" &amp; .Rows.count).End(xlUp).Row\n    Do While i &lt;= LastRow\n        Set rng = .Range(\"B\" &amp; i &amp; \":B\" &amp; LastRow)\n        x = Application.Match(s, rng, 0)\n        If IsError(x) Then\n            Set CRng = .Rows(i-1 &amp; \":\" &amp; LastRow)\n            CRng.Copy Destination:= Worksheets.Add.Range(\"A1\")\n            Exit Do\n        Else\n            Set CRng = .Rows(i-1 &amp; \":\" &amp; i+x-2)\n            CRng.Copy Destination:= Worksheets.Add.Range(\"A1\")\n            i = i + x\n        End If\n    Loop\nEnd With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user11732489"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 56970917, "answer_count": 1, "score": 1, "last_activity_date": 1562763649, "creation_date": 1562749258, "last_edit_date": 1562763649, "question_id": 56967127, "link": "https://stackoverflow.com/questions/56967127/how-to-find-a-specific-word-and-transfer-it-to-another-sheet-together-with-the-l", "title": "How to find a specific word and transfer it to another sheet together with the lines below the specific word", "body": "<p>The code needs to detect the word \"EXECSDATE\" in Sheet1 Column B and copy the line together with the lines below it to Sheet2 until it reaches another word \"EXECSDATE.\" Since I have 5 \"EXECSDATE\" in Sheet1 there should be a total of 5 Sheets separated.</p>\n\n<p>I already have tried running my code but it shows some error and can't do what it must.</p>\n\n<pre><code>Sub Fails()\n    Dim mFind As Range\n    Dim Compteur As Integer\n    Dim IdSheet As Integer\n    Dim ErrorBool As Boolean\n\ndebut:\n    Set mFind = Columns(\"B\").Find(\"EXECSDATE\")\n    Set mfind2 = Columns(\"B\").Find(\"EXECSDATE\")\n    If mFind Is Nothing Then\n        MsgBox \"There is no cell found with the text 'EXECSDATE'\" _\n            &amp; \" in column A of the active sheet.\"\n        Exit Sub\n    End If\n\n    firstaddress = mFind.Address\n    IdSheet = 1\n    Compteur = 0\n\n    Do\n        Set mfind2 = Columns(\"B\").FindNext(mFind)\n        If mfind2 Is Nothing Then\n            Compteur = 0\n        Else:\n            If mFind.Row &lt; mfind2.Row Then\n                Compteur = mfind2.Row\n            End If\n\n            If mFind.Row &gt; mfind2.Row Then\n                ErrorBool = True\n            End If\n\n            If ErrorBool = True Then\n                Range(mFind, Cells(mFind.Row + 1, \"B\")).EntireRow.Cut\n            End If\n        End If\n\n        Range(\"B\" &amp; mFind.Row + 1 &amp; \":B\" &amp; Compteur - 1).EntireRow.Cut\n\n        If mFind Is Nothing Then\n        Else: IdSheet = IdSheet + 1\n        End If\n\n        Sheets(\"Sheet\" &amp; IdSheet &amp; \"\").Select\n        Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Select\n        ActiveSheet.Paste\nline:\n        Sheets(\"Sheet1\").Select\n        Range(mFind, Cells(mFind.Row, \"B\")).EntireRow.Delete\n        Set mFind = Columns(\"B\").Find(\"EXECSDATE\")\n        Set mfind2 = Columns(\"B\").Find(\"EXECSDATE\")\n        If mFind Is Nothing Then Exit Sub\n        Set mFind = Columns(\"B\").FindNext(mFind)\n\n    Loop While mFind.Address &lt;&gt; firstaddress\nEnd Sub\n</code></pre>\n\n<p>Error Message:</p>\n\n<blockquote>\n  <p>This selection isn't valid. Make sure the copy and paste areas don't overlap unless they are the same size and shape.</p>\n</blockquote>\n\n<p>Here is the first EXECSDATE word (which is supposed to go to Sheet1):\n<img src=\"https://i.stack.imgur.com/mqkWe.jpg\" alt=\"img1\"></p>\n\n<p>Here is the second EXECSDATE word (which is supposed to go to Sheet2):\n<img src=\"https://i.stack.imgur.com/JXyGM.jpg\" alt=\"img\"></p>\n"}, {"tags": ["excel", "vba", "filter"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 9558070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f4d852579664a42c2f1069064c4200b?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/9558070/jason"}, "edited": false, "score": 0, "creation_date": 1562836976, "post_id": 56966737, "comment_id": 100506324, "body": "Thanks for the code. I have tried it and I am still getting the overflow error. It is now correctly counting the correct range, which is 1 (the header)."}, {"owner": {"reputation": 39, "user_id": 9558070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f4d852579664a42c2f1069064c4200b?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/9558070/jason"}, "edited": false, "score": 0, "creation_date": 1562837178, "post_id": 56966737, "comment_id": 100506452, "body": "If Worksheets(&quot;Cash Data (XXX)&quot;).Range(&quot;A1:A&quot; &amp; N4).Rows.SpecialCells(xlCellTypeVisible).Count &gt; 1 Then"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 39, "user_id": 9558070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f4d852579664a42c2f1069064c4200b?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/9558070/jason"}, "edited": false, "score": 0, "creation_date": 1562837314, "post_id": 56966737, "comment_id": 100506542, "body": "@Jason ... I son&#39;t see any scope for that error now. Can you share the Workbook, I ll take a look at the code for you."}, {"owner": {"reputation": 39, "user_id": 9558070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f4d852579664a42c2f1069064c4200b?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/9558070/jason"}, "edited": false, "score": 0, "creation_date": 1562837700, "post_id": 56966737, "comment_id": 100506791, "body": "i am unable to share the workbook, as it has sensitive data in it. Are you happy to have a blank version with just the code?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 39, "user_id": 9558070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f4d852579664a42c2f1069064c4200b?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/9558070/jason"}, "edited": false, "score": 0, "creation_date": 1562837907, "post_id": 56966737, "comment_id": 100506913, "body": "Also, you can try one more thing, define all your integers to <code>Double</code> ... Basically change all <code>Dim &#47;&#47;&#47;&#47;&#47; As Integer</code> to <code>Dim &#47;&#47;&#47;&#47; As Double</code>"}, {"owner": {"reputation": 39, "user_id": 9558070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f4d852579664a42c2f1069064c4200b?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/9558070/jason"}, "edited": false, "score": 0, "creation_date": 1562838269, "post_id": 56966737, "comment_id": 100507161, "body": "I&#39;ve resolved this issue. I took SpecialCells(xlCellTypeVisible) out of the code. For some reason it kept returning 12 as the value when hovering over it."}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": false, "score": 1, "last_activity_date": 1562748649, "last_edit_date": 1562748649, "creation_date": 1562748067, "answer_id": 56966737, "question_id": 56966570, "link": "https://stackoverflow.com/questions/56966570/copy-filtered-range-to-new-workbook-ignore-no-results/56966737#56966737", "title": "Copy filtered range to new workbook (ignore no results)", "body": "<p>Actually when there are no results, your <code>End(xlUp)</code> is going to the last row and which is giving you a Overflow error</p>\n\n<p><strong>Change the Line:</strong></p>\n\n<pre><code>Worksheets(\"Cash Data (XXX)\").Range(\"A1\", Cells(Rows.Count, \"A\").End(xlUp)).SpecialCells(xlCellTypeVisible).Count\n</code></pre>\n\n<p><strong>with :</strong></p>\n\n<pre><code>Worksheets(\"Cash Data (XXX)\").Range(\"A1:A\" &amp; N4).Rows.SpecialCells(xlCellTypeVisible).Count\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39, "user_id": 9558070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f4d852579664a42c2f1069064c4200b?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/9558070/jason"}, "is_accepted": false, "score": 0, "last_activity_date": 1562838619, "creation_date": 1562838619, "answer_id": 56986425, "question_id": 56966570, "link": "https://stackoverflow.com/questions/56966570/copy-filtered-range-to-new-workbook-ignore-no-results/56986425#56986425", "title": "Copy filtered range to new workbook (ignore no results)", "body": "<p>Using Mikku's amended code, I have resolved the overflow error by taking out <code>SpecialCells(xlCellTypeVisible)</code> from the code. </p>\n\n<p><strong>Mikku's code:</strong></p>\n\n<pre><code>IF Worksheets(\"Cash Data (XXX)\").Range(\"A1:A\" &amp; N4).Rows.SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n</code></pre>\n\n<p><strong>Corrective code:</strong></p>\n\n<pre><code>If Worksheets(\"Cash Data (XXX)\").Range(\"A1:A\" &amp; N4).Rows.Count &gt; 1 Then\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 9558070, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f4d852579664a42c2f1069064c4200b?s=128&d=identicon&r=PG&f=1", "display_name": "Jason", "link": "https://stackoverflow.com/users/9558070/jason"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1562838619, "creation_date": 1562747540, "last_edit_date": 1562749736, "question_id": 56966570, "link": "https://stackoverflow.com/questions/56966570/copy-filtered-range-to-new-workbook-ignore-no-results", "title": "Copy filtered range to new workbook (ignore no results)", "body": "<p>What I'm trying to do is copy the filtered range (minus the headers), but when the filtered range returns no results, I want it to ignore.</p>\n\n<p>It seems to be working fine when there is data in the filtered range, however I am getting the following overflow error when the filtered range returns no results:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yargb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yargb.png\" alt=\"enter image description here\"></a></p>\n\n<p>When debugging, it highlighted the following code:</p>\n\n<pre><code>If Worksheets(\"Cash Data (XXX)\").Range(\"A1\", Cells(Rows.Count, \"A\").End(xlUp)).SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n</code></pre>\n\n<p>Here is my code in it entirety:</p>\n\n<pre><code>'   Filter 250000+ items (XXX)\n\n    With Workbooks(\"MI Dashboard.xlsm\").Worksheets(\"Cash Data (XXX)\").Range(\"A1\")\n\n        .AutoFilter field:=15, Criteria1:=\"&lt;&gt;Inactive\", Operator:=xlAnd, Criteria2:=\"&lt;&gt;Tax\"\n        .AutoFilter field:=8, Criteria1:=\"&gt;250000\"\n\n    End With\n\n'   Copy to risk items workbook\n\n    Workbooks(\"MI Dashboard.xlsm\").Sheets(\"Cash Data (XXX)\").Activate\n    Dim N4 As Long\n         N4 = Cells(Rows.Count, \"A\").End(xlUp).Row\n\n    If Worksheets(\"Cash Data (XXX)\").Range(\"A1\", Cells(Rows.Count, \"A\").End(xlUp)).SpecialCells(xlCellTypeVisible).Count &gt; 1 Then\n\n    Worksheets(\"Cash Data (XXX)\").Range(\"A2:I\" &amp; N4).Copy _\n    Destination:=Workbooks(\"Temp.xlsx\").Sheets(\"Cash\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0)\n\n    Worksheets(\"Cash Data (XXX)\").Range(\"J2:T\" &amp; N4).Copy _\n    Destination:=Workbooks(\"Temp.xlsx\").Sheets(\"Cash\").Cells(Rows.Count, 13).End(xlUp).Offset(1, -1)\n\n    Else\n\n    End If\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1562747516, "post_id": 56966517, "comment_id": 100470021, "body": "Remove the Last For Loop"}], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 11738013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edf78b33d3806c0024919e6059a9655?s=128&d=identicon&r=PG&f=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/11738013/jan"}, "edited": false, "score": 0, "creation_date": 1562748491, "post_id": 56966574, "comment_id": 100470559, "body": "Thanks Mikku! The code worked perfectly:) Do you know how to edit the line set xRng to be dynamic through the indirect function? In cell C14 I have the name of the sheet where I want to get the data (&quot;Data1&quot;) and in C15 I have the range (&quot;J3:J45999&quot;)."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 37, "user_id": 11738013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edf78b33d3806c0024919e6059a9655?s=128&d=identicon&r=PG&f=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/11738013/jan"}, "edited": false, "score": 0, "creation_date": 1562748782, "post_id": 56966574, "comment_id": 100470763, "body": "Added in the Answer"}, {"owner": {"reputation": 37, "user_id": 11738013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edf78b33d3806c0024919e6059a9655?s=128&d=identicon&r=PG&f=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/11738013/jan"}, "edited": false, "score": 0, "creation_date": 1562755066, "post_id": 56966574, "comment_id": 100474386, "body": "The issue is that I need to make the range dynamic, and hence use the indirect function..."}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1562748777, "last_edit_date": 1562748777, "creation_date": 1562747558, "answer_id": 56966574, "question_id": 56966517, "link": "https://stackoverflow.com/questions/56966517/how-can-i-improve-this-code-to-not-delete-empty-cells-but-just-ignore-them/56966574#56966574", "title": "How can I improve this code to not delete empty cells, but just ignore them?", "body": "<p>This will work:</p>\n\n<pre><code>Private Sub Unique_Click()\n\nDim xRng As Range\nDim xLastRow As Long\nDim xLastRow2 As Long\nDim I As Integer\nOn Error Resume Next\nSet xRng = Application.InputBox(\"Please select range:\", \"Kutools for Excel\", Selection.Address, , , , , 8)\nIf xRng Is Nothing Then Exit Sub\nOn Error Resume Next\nxRng.Copy Range(\"B21\")\nxLastRow = xRng.Rows.Count + 1\nActiveSheet.Range(\"B21:B\" &amp; xLastRow).RemoveDuplicates Columns:=1, Header:=xlNo\n\nEnd Sub\n</code></pre>\n\n<p>For Loop removed that was deleting the blank cells</p>\n\n<p>Try changing </p>\n\n<pre><code>Set xRng = Application.InputBox(\"Please select range:\", \"Kutools for Excel\", Selection.Address, , , , , 8)\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>Set xRng = Worksheets(\"Data1\").Range(\"J3:J45999\")\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 11738013, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9edf78b33d3806c0024919e6059a9655?s=128&d=identicon&r=PG&f=1", "display_name": "Jan", "link": "https://stackoverflow.com/users/11738013/jan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 56966574, "answer_count": 1, "score": 0, "last_activity_date": 1562748777, "creation_date": 1562747336, "last_edit_date": 1562747778, "question_id": 56966517, "link": "https://stackoverflow.com/questions/56966517/how-can-i-improve-this-code-to-not-delete-empty-cells-but-just-ignore-them", "title": "How can I improve this code to not delete empty cells, but just ignore them?", "body": "<p>When I use my code, I get the unique values. But one of the unique values is a blank cell and the code seems to delete this cell when the values are pasted. This messes up my formulas which are linked to these unique values. </p>\n\n<p>I am also wondering how to use the indirect function in vba and link the code to two specific cells to set a specific range. I will ofc give credit if someone can give me a good answer to all of this. </p>\n\n<p>I have also tried to use the following excel-formula to get the unique values: \n=IFERROR(INDEX(INDIRECT($C$14&amp;\"!\"&amp;$C$15); MATCH(0;COUNTIF($B$20:B20; INDIRECT($C$14&amp;\"!\"&amp;$C$15)&amp;\"\") + IF(INDIRECT($C$14&amp;\"!\"&amp;$C$15) = \"\";1;0);0));\"\")</p>\n\n<p>This formula works, but my data set is somewhat large. It therefore takes a lot of time...</p>\n\n<pre><code>Private Sub Unique_Click()\n\nDim xRng As Range\nDim xLastRow As Long\nDim xLastRow2 As Long\nDim I As Integer\nOn Error Resume Next\nSet xRng = Application.InputBox(\"Please select range:\", \"Kutools for Excel\", Selection.Address, , , , , 8)\nIf xRng Is Nothing Then Exit Sub\nOn Error Resume Next\nxRng.Copy Range(\"B21\")\nxLastRow = xRng.Rows.Count + 1\nActiveSheet.Range(\"B21:B\" &amp; xLastRow).RemoveDuplicates Columns:=1, Header:=xlNo\nxLastRow2 = Cells(Rows.Count, \"B\").End(xlUp).Row\nFor I = 1 To xLastRow2\n  If ActiveSheet.Range(\"B21:B\" &amp; xLastRow2).Cells(I).Value = \"\" Then\n     ActiveSheet.Range(\"B21:B\" &amp; xLastRow2).Cells(I).Delete\n  End If\nNext\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 35, "user_id": 11672599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b50020739d0580004d8b8bd246546abb?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelIsFun_Sometimes", "link": "https://stackoverflow.com/users/11672599/excelisfun-sometimes"}, "is_accepted": false, "score": 0, "last_activity_date": 1562748385, "creation_date": 1562748385, "answer_id": 56966843, "question_id": 56966318, "link": "https://stackoverflow.com/questions/56966318/how-to-recreate-a-sheet-and-keep-references-valid/56966843#56966843", "title": "How to Recreate a Sheet and Keep References Valid?", "body": "<p>AFTER I posted (of course :-)), this link came up on the right: <a href=\"https://stackoverflow.com/questions/4070930/how-to-preserve-a-formulas-reference-to-a-worksheet-when-the-worksheet-is-delet?rq=1\">Preserve references</a> that recommends using INDIRECT. I have now changed Sheet1 A1 to <code>=INDIRECT(\"Sheet2!\"&amp;\"A1\")</code>.</p>\n\n<p>I am not certain why the named ranges suggested in the link are needed. The indirect call above seems to work without a named range.</p>\n\n<p>If this works in the larger project, I will mark this as complete.</p>\n"}, {"comments": [{"owner": {"reputation": 35, "user_id": 11672599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b50020739d0580004d8b8bd246546abb?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelIsFun_Sometimes", "link": "https://stackoverflow.com/users/11672599/excelisfun-sometimes"}, "edited": false, "score": 0, "creation_date": 1562899285, "post_id": 56980376, "comment_id": 100532466, "body": "Thanks so much for this code. I am currently trying out a similar solution suggested by a colleague but instead of a new tab using a temporary variant array. See [link]<a href=\"https://excelmacromastery.com/excel-vba-array/#How_To_Make_Your_Macros_Run_at_Super_Speed\" rel=\"nofollow noreferrer\">excelmacromastery.com/excel-vba-array/&hellip;</a>. I found out Range.Value can be replaced with Range.Formula (All of the cells are formulae). I got the indirect to work, but it was really slow. 264,000 cells so no wonder. If I get the final code and it works I&#39;ll post it. If it doesn&#39;t work, yours will be the next attempt. BTW, really like how you&#39;ve used the Find command. Thanks again."}, {"owner": {"reputation": 35, "user_id": 11672599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b50020739d0580004d8b8bd246546abb?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelIsFun_Sometimes", "link": "https://stackoverflow.com/users/11672599/excelisfun-sometimes"}, "edited": false, "score": 0, "creation_date": 1563357793, "post_id": 56980376, "comment_id": 100670270, "body": "I tried out this solution and it worked well. I added a call to Application.FindFormat.Clear because Find does not clear from the last call [link]<a href=\"https://excelmacromastery.com/excel-vba-find/\" rel=\"nofollow noreferrer\">excelmacromastery.com/excel-vba-find</a>. I also tried an alternate solution that seems to work and would like to hear another comments."}], "tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 0, "last_activity_date": 1562807543, "last_edit_date": 1562807543, "creation_date": 1562806902, "answer_id": 56980376, "question_id": 56966318, "link": "https://stackoverflow.com/questions/56966318/how-to-recreate-a-sheet-and-keep-references-valid/56980376#56980376", "title": "How to Recreate a Sheet and Keep References Valid?", "body": "<p>Thank you presenting a real good question.</p>\n\n<p>First of all disclaimer: This is not an direct solution but and workaround we had to adopt years back. </p>\n\n<p>Exactly similar problem problem had been encountered in my workplace (literally made us to pull out our hairs), and we also tried to go for <code>iNDIRECT</code>. But since  the formulas in the working sheets are complex we failed to replace them with <code>INDIRECT</code>. So instead of lengthy manual replacement of the hundreds of Formulas in the working sheet, we used to insert a temp Sheet and change the formulas reference to that sheet. After importing new sheet and renaming it as old sheet's name, formulas were reverted back to original.\nI tried to reproduce the code used (since I don't have access to same files now). We only used the <code>Sub ChangeFormulas</code>, Here I used the same in line with your code.</p>\n\n<pre><code>Option Explicit\nSub TestSheet2Delete()\nDim Wb As Workbook\nDim Ws As Worksheet, Ws1 As Worksheet, Ws2 As Worksheet\nDim Xstr As String, Ystr As String\nSet Wb = ThisWorkbook\nSet Ws = Wb.Sheets(\"Sheet1\")\n\nXstr = \"Sheet2\"\nYstr = \"TempSheetX\"\nSet Ws1 = Wb.Sheets(Xstr)\n\nSet Ws2 = Worksheets.Add(After:=Ws)\nWs2.Name = Ystr\nDoEvents\nChangeFormulas Ws, Xstr, Ystr\n\nApplication.DisplayAlerts = False\nWs1.Delete\n\n' Now again add another sheet with Old name and change formulas back to Original\nSet Ws1 = Worksheets.Add(After:=Ws)\nWs1.Name = Xstr\nDoEvents\nChangeFormulas Ws, Ystr, Xstr\nWs2.Delete\n\nApplication.DisplayAlerts = True\n\nEnd Sub\nSub ChangeFormulas(Ws As Worksheet, Xstr As String, Ystr As String)\nDim Rng As Range, C As Range, FirstAddress As String\nSet Rng = Ws.UsedRange\nWith Rng\n    Set C = .Find(What:=Xstr, LookIn:=xlFormulas)\n    If Not C Is Nothing Then\n        FirstAddress = C.Address\n        Do\n            C.Formula = Replace(C.Formula, Xstr, Ystr)\n            Set C = .FindNext(C)\n            If C Is Nothing Then Exit Do\n            If C.Address = FirstAddress Then Exit Do\n        Loop\n    End If\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><em>Another simplest workaround is not to delete the Sheet at all and import the CSV and copy the full sheet onto the sheet in question.</em> However This fully depends on actual working conditions involving CSV and all.</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 11672599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b50020739d0580004d8b8bd246546abb?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelIsFun_Sometimes", "link": "https://stackoverflow.com/users/11672599/excelisfun-sometimes"}, "is_accepted": false, "score": 0, "last_activity_date": 1563358385, "creation_date": 1563358385, "answer_id": 57073515, "question_id": 56966318, "link": "https://stackoverflow.com/questions/56966318/how-to-recreate-a-sheet-and-keep-references-valid/57073515#57073515", "title": "How to Recreate a Sheet and Keep References Valid?", "body": "<p>My original answer did not work for non-contiguous cells. However, I really like the Range to Variants and then back to Range pattern. Very fast. So I rewrote my original answer into more reusable code that tests using non-contiguous cells.</p>\n\n<pre><code>Function PreserveFormulaeInVariantArr(ByVal aWorksheet As Worksheet, _\n                                      ByVal aIsNoFormulaErr As Boolean, _\n                                      ByRef aErrStr As String) As Variant\n  Dim TmpRange As Range\n  Dim TmpAreaCnt As Long\n  Dim TmpVarArr As Variant\n  Dim TmpAreaVarArr As Variant\n\n  PreserveFormulaeInVariantArr = Empty\n\n  If aWorksheet Is Nothing Then\n    aErrStr = \"PreserveFormulaeInVariantArr: Worksheet is Nothing.\"\n    Exit Function\n  End If\n\n  Err.Clear\n  On Error Resume Next\n  Set TmpRange = aWorksheet.Cells.SpecialCells(xlCellTypeFormulas)\n  If Err.Number &lt;&gt; 0 Then 'No Formulae.\n    PreserveFormulaeInVariantArr = Empty\n    If aIsNoFormulaErr Then\n      aErrStr = \"PreserveFormulaeInVariantArr: No cells with formulae.\"\n    End If\n    Exit Function\n  End If\n\n  TmpAreaVarArr = Empty\n  On Error GoTo ErrLabel\n  ReDim TmpVarArr(1 To TmpRange.Areas.Count, 1 To 2)\n\n  For TmpAreaCnt = LBound(TmpVarArr) To UBound(TmpVarArr)\n    TmpVarArr(TmpAreaCnt, 1) = TmpRange.Areas(TmpAreaCnt).Address 'Set 1st Element to Range\n    TmpAreaVarArr = TmpRange.Areas(TmpAreaCnt).Formula 'Left TmpArrVarArr for Debugging\n    TmpVarArr(TmpAreaCnt, 2) = TmpAreaVarArr 'Creates Jagged Array\n  Next TmpAreaCnt\n\n  PreserveFormulaeInVariantArr = TmpVarArr\n\n  Exit Function\nErrLabel:\n  aErrStr = \"PreserveFormulaeInVariantArr - Error Number: \" + CStr(Err.Number) + \" Error Description: \" + Err.Description\nEnd Function\n\nFunction RestoreFormulaeFromVariantArr(ByVal aWorksheet As Worksheet, _\n                                       ByVal aIsEmptyAreaVarArrError As Boolean, _\n                                       ByVal aAreaVarArr As Variant, _\n                                       ByRef aErrStr As String) As Boolean\n  Dim TmpVarArrCnt As Long\n  Dim TmpRange As Range\n  Dim TmpDim1Var As Variant\n  Dim TmpDim2Var As Variant\n  Dim TmpDim2Cnt As Long\n  Dim TmpDim2UBound As Long\n\n  RestoreFormulaeFromVariantArr = False\n\n  On Error GoTo ErrLabel\n\n  If aWorksheet Is Nothing Then\n    Exit Function\n  End If\n\n  If IsEmpty(aAreaVarArr) Then\n    If aIsEmptyAreaVarArrError Then\n      aErrStr = \"RestoreFormulaeFromVariantArr: Empty array passed.\"\n    Else\n      RestoreFormulaeFromVariantArr = True\n    End If\n    Exit Function\n  End If\n\n  For TmpVarArrCnt = 1 To UBound(aAreaVarArr)\n    TmpDim1Var = aAreaVarArr(TmpVarArrCnt, 1) 'This is always the range.\n    TmpDim2Var = aAreaVarArr(TmpVarArrCnt, 2) 'This can be a Variant or Variant Array\n    aWorksheet.Range(TmpDim1Var).Formula = TmpDim2Var\n  Next TmpVarArrCnt\n\n  RestoreFormulaeFromVariantArr = True\n\n  Exit Function\nErrLabel:\n  aErrStr = \"PreserveFormulaeInVariantArr - Error Number: \" + CStr(Err.Number) + \" Error Description: \" + Err.Description\nEnd Function\n\nSub TestPreserveFormulaeInVariantArr()\n  Dim TmpPreserveFormulaeArr As Variant\n  Dim TmpErrStr As String\n  Dim TmpIsNoFormulaErr As Boolean: TmpIsNoFormulaErr = True 'Change If Desired\n  Dim TmpEmptySheet1 As Boolean: TmpEmptySheet1 = False 'Change If Desired\n  Dim TmpSheet1 As Worksheet: Set TmpSheet1 = Sheets(\"Sheet1\")\n  Dim TmpSheet2 As Worksheet\n\n  Err.Clear\n  On Error Resume Next\n  Set TmpSheet2 = Sheets(\"Sheet2\")\n  On Error GoTo 0\n\n  'Always Delete Sheet2\n  If (TmpSheet2 Is Nothing) = False Then\n    Application.DisplayAlerts = False\n    TmpSheet2.Delete\n    Application.DisplayAlerts = True\n    Set TmpSheet2 = Nothing\n  End If\n\n  If TmpSheet2 Is Nothing Then\n    Set TmpSheet2 = Worksheets.Add(After:=Sheets(\"Sheet1\"))\n    TmpSheet2.Name = \"Sheet2\"\n    TmpSheet2.Range(\"A1\") = \"Sheet2A1\"\n    TmpSheet2.Range(\"B1\") = \"Sheet2A1\"\n    TmpSheet2.Range(\"C4\") = \"Sheet2C4\"\n\n    If TmpEmptySheet1 Then\n      TmpSheet1.Cells.ClearContents\n    Else\n      TmpSheet1.Range(\"A1\").Formula = \"=Sheet2!A1\"\n      TmpSheet1.Range(\"B1\").Formula = \"=Sheet2!B1\"\n      TmpSheet1.Range(\"C4\").Formula = \"=Sheet2!C4\"\n    End If\n  End If\n\n  TmpPreserveFormulaeArr = PreserveFormulaeInVariantArr(TmpSheet1, TmpIsNoFormulaErr, TmpErrStr)\n\n  If TmpErrStr &lt;&gt; \"\" Then\n    MsgBox TmpErrStr\n    Exit Sub\n  End If\n\n  'Break Formulae and Cause #Ref Violation\n  Application.DisplayAlerts = False\n  TmpSheet2.Delete\n  Application.DisplayAlerts = True\n\n  'Add Sheet2 Back\n  Set TmpSheet2 = Worksheets.Add(After:=Sheets(\"Sheet1\"))\n  TmpSheet2.Name = \"Sheet2\"\n  TmpSheet2.Range(\"A1\") = \"Sheet2A1\"\n  TmpSheet2.Range(\"B1\") = \"Sheet2A1\"\n  TmpSheet2.Range(\"C4\") = \"Sheet2C4\"\n\n  'Restore Formulas Back to Sheet1\n  If RestoreFormulaeFromVariantArr(TmpSheet1, TmpIsNoFormulaErr, TmpPreserveFormulaeArr, TmpErrStr) = False Then\n    MsgBox TmpErrStr\n    Exit Sub\n  End If\nEnd Sub\n</code></pre>\n\n<p>The TestPreserveFormulaeInVariantArr can be run in the VBE with options to set empty values. Any comments appreciated.</p>\n"}], "owner": {"reputation": 35, "user_id": 11672599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b50020739d0580004d8b8bd246546abb?s=128&d=identicon&r=PG&f=1", "display_name": "ExcelIsFun_Sometimes", "link": "https://stackoverflow.com/users/11672599/excelisfun-sometimes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 56980376, "answer_count": 3, "score": 1, "last_activity_date": 1563358385, "creation_date": 1562746641, "question_id": 56966318, "link": "https://stackoverflow.com/questions/56966318/how-to-recreate-a-sheet-and-keep-references-valid", "title": "How to Recreate a Sheet and Keep References Valid?", "body": "<p>I have a client who is hand holding a bunch of worksheets that should be standardized. They are created from importing CSV files. Basically, I need to replace the current manual sheets while they are being referenced from another tab without breaking the current references.</p>\n\n<p>I've reduced the problem to a single workbook with 2 sheets. Sheet1 cell A1 references Sheet2 cell A1 which holds the string \"Sheet2A1CellData\"</p>\n\n<p>Everything commented out below has been tried including Application.Volatile and Application.Calculation.</p>\n\n<pre><code>Option Explicit\nSub TestSheet2Delete()\n  Dim TmpSheet2 As Worksheet: Set TmpSheet2 = Sheets(\"Sheet2\")\n\n  'Application.Volatile\n\n  If TmpSheet2 Is Nothing Then\n    Exit Sub\n  End If\n\n  'Application.Calculation = False\n\n  Application.DisplayAlerts = False\n  TmpSheet2.Delete\n  Application.DisplayAlerts = True\n\n  Set TmpSheet2 = Worksheets.Add(After:=Sheets(\"Sheet1\"))\n\n  If TmpSheet2 Is Nothing Then\n    Exit Sub\n  End If\n\n  TmpSheet2.Name = \"Sheet2\"\n  TmpSheet2.Range(\"A1\").Value = \"Sheet2A1CellData\"\n\n  'Application.Calculation = True\nEnd Sub\n</code></pre>\n\n<p>Sheet1 A1 was originally =Sheet2!A1. When I run the function above from the VBE, Sheet1 cell A1 is set to =#REF!A1. </p>\n\n<p>How can I keep the reference valid after the sheet has been replaced?</p>\n\n<p>Obviously, the real world problem is much larger and re-importing CSV data requires updating 132,000 cells. 6000 rows x 22 Columns. </p>\n\n<p>Thanks for any help.</p>\n"}, {"tags": ["excel", "vba", "pivot-table"], "comments": [{"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1562859715, "post_id": 56966166, "comment_id": 100520222, "body": "What is &quot;9 data&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1562829848, "post_id": 56983669, "comment_id": 100502650, "body": "You should avoid using <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">Select</a> in your Code."}, {"owner": {"reputation": 63, "user_id": 11113852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f93bcd41adb47f473aa814f224ac5d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harvint Raj", "link": "https://stackoverflow.com/users/11113852/harvint-raj"}, "reply_to_user": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1562832357, "post_id": 56983669, "comment_id": 100503871, "body": "@Mikku do you have any other suggestions or way to make this better?"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1562832414, "post_id": 56983669, "comment_id": 100503897, "body": "Just avoid using Select &amp; Activate. As you are already referring to the correct objects."}], "tags": [], "owner": {"reputation": 63, "user_id": 11113852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f93bcd41adb47f473aa814f224ac5d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harvint Raj", "link": "https://stackoverflow.com/users/11113852/harvint-raj"}, "is_accepted": true, "score": 0, "last_activity_date": 1562829664, "creation_date": 1562829664, "answer_id": 56983669, "question_id": 56966166, "link": "https://stackoverflow.com/questions/56966166/how-do-i-select-data-from-the-excel-pivot-table/56983669#56983669", "title": "How do I select data from the excel pivot table?", "body": "<pre><code>Sub SelectAndCopyPaste()\nDim lastrow() As String\nDim pt As PivotTable\n\n\nWorksheets(\"Sheet1\").Activate\nActiveSheet.Cells.Clear\n\nWith Worksheets(\"Pivot Sheet\")\n    .Activate\n    Set pt = .PivotTables(\"PivotTable2\")\n    lastrow = Split(pt.RowRange.Address, \":\")\n    .Range(lastrow(1)).Offset(-1, 6).Select 'here is where you set which cell you want to choose\n    Selection.ShowDetail = True\n    Selection.Copy\nEnd With\n\n    Worksheets(\"Sheet1\").Select\n    ActiveSheet.Cells(1, 1).PasteSpecial xlPasteValues\n\nEnd Sub\n\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 11113852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f93bcd41adb47f473aa814f224ac5d2?s=128&d=identicon&r=PG&f=1", "display_name": "Harvint Raj", "link": "https://stackoverflow.com/users/11113852/harvint-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 56983669, "answer_count": 1, "score": 1, "last_activity_date": 1562829664, "creation_date": 1562746107, "last_edit_date": 1562749759, "question_id": 56966166, "link": "https://stackoverflow.com/questions/56966166/how-do-i-select-data-from-the-excel-pivot-table", "title": "How do I select data from the excel pivot table?", "body": "<p><a href=\"https://i.stack.imgur.com/ccxA2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ccxA2.png\" alt=\"Pivot Sheet\"></a>\n<strong>Pivot Sheet</strong></p>\n\n<p>So for example when I click the cell <code>G14</code> in the pivot sheet. It should display <code>9 data</code> in another sheet say Sheet1. The number of data depends on the cells in <code>column G</code> of pivot sheet. I cant seem to find any code to get that data.  </p>\n\n<p><a href=\"https://i.stack.imgur.com/46XBz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/46XBz.png\" alt=\"Sheet1\"></a>\n<strong>Sheet1</strong></p>\n\n<p>I need to to know how I can access that data using VBA.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1572, "user_id": 9935827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9LgG5.jpg?s=128&g=1", "display_name": "Stavros Jon", "link": "https://stackoverflow.com/users/9935827/stavros-jon"}, "edited": false, "score": 3, "creation_date": 1562745319, "post_id": 56965900, "comment_id": 100468890, "body": "You need to declare i as long, not double. Also when dealing with such a big amount of data you should work with bulk operations i.e. with ranges rather than individual cells."}, {"owner": {"reputation": 625, "user_id": 2880342, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/917a1ca96bd067832d2b7e4d8967d336?s=128&d=identicon&r=PG&f=1", "display_name": "GoodJuJu", "link": "https://stackoverflow.com/users/2880342/goodjuju"}, "edited": false, "score": 0, "creation_date": 1562746825, "post_id": 56965900, "comment_id": 100469657, "body": "If the range is fixed, I would prefix the range values with the dollar symbol to mark them as being absolute:  =singlecellextract($J1,$D$1:$E$12000,2)  or alternatively, set the Range as a defined Range in the spreadsheet."}, {"owner": {"reputation": 625, "user_id": 2880342, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/917a1ca96bd067832d2b7e4d8967d336?s=128&d=identicon&r=PG&f=1", "display_name": "GoodJuJu", "link": "https://stackoverflow.com/users/2880342/goodjuju"}, "edited": false, "score": 0, "creation_date": 1562747075, "post_id": 56965900, "comment_id": 100469795, "body": "It looks like an &#39;Index Match&#39; could work for you, rather than VBA.  Try =INDEX($D$1:$D$12000, MATCH($J1,$E$1:$E$12000,0))"}, {"owner": {"reputation": 3, "user_id": 5207405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3966d543aa747ef08dd676c6f1421e?s=128&d=identicon&r=PG&f=1", "display_name": "attle", "link": "https://stackoverflow.com/users/5207405/attle"}, "edited": false, "score": 0, "creation_date": 1562747733, "post_id": 56965900, "comment_id": 100470100, "body": "I am trying to return multiple matched values into a single cell, also I tried changing double to Longbut doesnt seem to fix the problem. Thanks"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562749156, "post_id": 56965900, "comment_id": 100470987, "body": "Your code works for me, albeit rather slowly."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562749317, "post_id": 56965900, "comment_id": 100471090, "body": "It&#39;s more likely you have an error value somewhere in your data. Using arrays would speed up your code if you&#39;re using big ranges."}, {"owner": {"reputation": 3, "user_id": 5207405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3966d543aa747ef08dd676c6f1421e?s=128&d=identicon&r=PG&f=1", "display_name": "attle", "link": "https://stackoverflow.com/users/5207405/attle"}, "edited": false, "score": 0, "creation_date": 1562750387, "post_id": 56965900, "comment_id": 100471742, "body": "Sorry Im not very good in coding in VBA, is there any chance you can give a sample code or point me in the right direction? Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5207405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3966d543aa747ef08dd676c6f1421e?s=128&d=identicon&r=PG&f=1", "display_name": "attle", "link": "https://stackoverflow.com/users/5207405/attle"}, "edited": false, "score": 0, "creation_date": 1562757669, "post_id": 56969289, "comment_id": 100475747, "body": "thanks, for the response! what are the recommended method I should use to increase the speed?"}, {"owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "reply_to_user": {"reputation": 3, "user_id": 5207405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3966d543aa747ef08dd676c6f1421e?s=128&d=identicon&r=PG&f=1", "display_name": "attle", "link": "https://stackoverflow.com/users/5207405/attle"}, "edited": false, "score": 0, "creation_date": 1562758982, "post_id": 56969289, "comment_id": 100476419, "body": "With your method, you are asking the code to go to each individual cell and inspect one at a time. As was suggested, you could read the entire range you want to inspect into an array and then parce it. Each time you inspect/interact with the worksheet costs time and effort."}], "tags": [], "owner": {"reputation": 3003, "user_id": 1540019, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8ca15171e2123d2218198e6a0a77e3d9?s=128&d=identicon&r=PG", "display_name": "rohrl77", "link": "https://stackoverflow.com/users/1540019/rohrl77"}, "is_accepted": true, "score": 0, "last_activity_date": 1562756475, "creation_date": 1562756475, "answer_id": 56969289, "question_id": 56965900, "link": "https://stackoverflow.com/questions/56965900/excel-vba-wont-work-for-large-column-numbers/56969289#56969289", "title": "excel VBA wont work for large column numbers", "body": "<p>The formula seems to work fine (although slow) as long as there are no errors.\nThe following adjustment will make it ignore errors.</p>\n\n<pre><code>Function SingleCellExtract(Lookupvalue As String, _\n                            LookupRange As Range, _\n                            ColumnNumber As Integer)\n  Dim i As Long\n  Dim result As String\n\n  For i = 1 To LookupRange.Columns(1).Cells.Count\n        If Not (IsError(LookupRange.Cells(i, 1)) Or _\n            IsError(LookupRange.Cells(i, ColumnNumber))) Then\n            If LookupRange.Cells(i, 1) = Lookupvalue Then\n                 result = result &amp; \" \" &amp; LookupRange.Cells(i, ColumnNumber) &amp; \",\"\n            End If\n        End If\n  Next i\n\n       SingleCellExtract = Left(result, Len(result) - 1)\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5207405, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3966d543aa747ef08dd676c6f1421e?s=128&d=identicon&r=PG&f=1", "display_name": "attle", "link": "https://stackoverflow.com/users/5207405/attle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 56969289, "answer_count": 1, "score": 0, "last_activity_date": 1562756475, "creation_date": 1562745170, "last_edit_date": 1562754670, "question_id": 56965900, "link": "https://stackoverflow.com/questions/56965900/excel-vba-wont-work-for-large-column-numbers", "title": "excel VBA wont work for large column numbers", "body": "<p>I am sadly not very proficient in dealing with VBA coding, and this if a sample code i found online. The issue I have with this is that the code doesnt seem to like very large column numbers. when \"LookupRange As Range\" becomes A1:A10000 the VBA no longer works properly. For example the code</p>\n\n<pre><code>=singlecellextract(J1,D1:E5,2)\n</code></pre>\n\n<p>works perfectly but </p>\n\n<pre><code>=singlecellextract(J1,D1:E12000,2)\n</code></pre>\n\n<p>returns a #VALUE! error</p>\n\n<p>Here is the VBA code i used for the function</p>\n\n<pre><code>Function SingleCellExtract(Lookupvalue As String, LookupRange As Range, ColumnNumber As Integer)\n  Dim i As Long\n  Dim result As String\n\n  For i = 1 To LookupRange.Columns(1).Cells.Count\n        If LookupRange.Cells(i, 1) = Lookupvalue Then\n             result = result &amp; \" \" &amp; LookupRange.Cells(i, ColumnNumber) &amp; \",\"\n       End If\n  Next i\n\n       SingleCellExtract = Left(result, Len(result) - 1)\n  End Function\n</code></pre>\n\n<p>Is there any chance for this code to work with large amount of column nubmers or better yet work with inputs such as A:A? many thanks.</p>\n\n<p>edit: i changed the double to long but it doesnt seem to effect tthe outcome </p>\n"}, {"tags": ["excel", "vba", "file", "save", "filesize"], "comments": [{"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1562744689, "post_id": 56965673, "comment_id": 100468572, "body": "So what seems to be the problem? Formatting uses Space, so that is to be expected, .xlsx also tend to use more space compared to .xlsb (which is by design)."}, {"owner": {"reputation": 431, "user_id": 9476917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q5NET.jpg?s=128&g=1", "display_name": "Maeaex1", "link": "https://stackoverflow.com/users/9476917/maeaex1"}, "reply_to_user": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1562745143, "post_id": 56965673, "comment_id": 100468800, "body": "Thats true, but this it is not an argument that the file increases in size 790 times, just because there are colour fillings and date formats applied. Also an .xlsb saves in best case around 50% of space considering same amount of data. The hard copied file has less data but is also almost 20 times bigger. (5mb vs 92.5mb)"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 0, "creation_date": 1562745711, "post_id": 56965673, "comment_id": 100469101, "body": "It can be, depending on the formatting and the way (XML) excel saves the data. My guess is that the new excel file saves the formatting for each cell separately. More on this: <a href=\"http://www.loc.gov/preservation/digital/formats/fdd/fdd000398.shtml\" rel=\"nofollow noreferrer\">loc.gov/preservation/digital/formats/fdd/fdd000398.shtml</a>  <a href=\"https://en.wikipedia.org/wiki/Microsoft_Office_XML_formats\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Microsoft_Office_XML_formats</a>  <a href=\"https://en.wikipedia.org/wiki/Microsoft_Office_XML_formats\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Microsoft_Office_XML_formats</a>"}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 1, "creation_date": 1562745792, "post_id": 56965673, "comment_id": 100469138, "body": "You could unzip your Excel File and check what exactly takes up the space."}, {"owner": {"reputation": 678, "user_id": 10223558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8aab0b9efcc3f6ef4d67308d870b1c6b?s=128&d=identicon&r=PG&f=1", "display_name": "L8n", "link": "https://stackoverflow.com/users/10223558/l8n"}, "edited": false, "score": 1, "creation_date": 1562746441, "post_id": 56965673, "comment_id": 100469450, "body": "Also, how big is <code>UsedRange</code>, are empty Cells also/formatted/filled even thought they are empty, all this would increase the size of the new file."}], "owner": {"reputation": 431, "user_id": 9476917, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q5NET.jpg?s=128&g=1", "display_name": "Maeaex1", "link": "https://stackoverflow.com/users/9476917/maeaex1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 11, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562744361, "creation_date": 1562744361, "question_id": 56965673, "link": "https://stackoverflow.com/questions/56965673/hard-copied-xlsx-file-is-manyfold-larger-compared-to-source-file", "title": "Hard copied .xlsx file is manyfold larger compared to source file", "body": "<p>I have a .xlsb file where I create a hard copied version of a sheet for history purpose.</p>\n\n<p>The .xlsb file (containing multiple sheets with formula and data) is roughly 5mb.</p>\n\n<p>The hard copied version with plain numbers (no formatting) is roughly 117kb.\nWhen I copy the formats as well the file gets 92.5mb and the code runs for almost 2 mins to be fully executed. </p>\n\n<p>I use the following code:</p>\n\n<pre><code>Sub save_db()\n\nApplication.DisplayAlerts = False\nApplication.ScreenUpdating = False\n\nDim db As Worksheet\nDim db_file As Workbook\n\nSet db = ThisWorkbook.Worksheets(\"Datenbank\")\n\nSet db_file = Workbooks.Add\n\ndb.UsedRange.Copy\ndb_file.Sheets(1).Range(\"A1\").PasteSpecial xlValues\ndb_file.Sheets(1).Range(\"A1\").PasteSpecial xlFormats\n\ndb_name = \"DB_\" &amp; CStr(Date) &amp; \".xlsx\"\n\ndb_file.SaveAs (\"User\\DB_Achieve\\\" &amp; db_name)\ndb_file.Close\n\n\nApplication.DisplayAlerts = True\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba", "userform"], "comments": [{"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 1, "creation_date": 1562744728, "post_id": 56965655, "comment_id": 100468600, "body": "Try it like <code>nextRowB.Resize(UBound(inputs), 1).Value = Application.Transpose(inputs)</code> for pasting the array contents in rows."}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 1, "creation_date": 1562745263, "post_id": 56965655, "comment_id": 100468860, "body": "For pasting Array values horizontally in columns may try <code>nextRowB.Resize(1, UBound(inputs) + 1).Value = inputs</code>.use +1 with <code>Ubound(inputs) </code> if array base is zero."}, {"owner": {"reputation": 41, "user_id": 11753198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85474fe3238a26dc5f01a5d0f9002487?s=128&d=identicon&r=PG&f=1", "display_name": "SanderJensen", "link": "https://stackoverflow.com/users/11753198/sanderjensen"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1562745383, "post_id": 56965655, "comment_id": 100468916, "body": "@AhmedAU where exactly? As I said I got this code from another person and tbh I&#39;m a newbie to coding only learnt VBA 3 days ago so I waas using 9 variables and some really ugly code for this before"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 1, "creation_date": 1562745569, "post_id": 56965655, "comment_id": 100469007, "body": "Where do you want to paste the array inputs?"}, {"owner": {"reputation": 41, "user_id": 11753198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85474fe3238a26dc5f01a5d0f9002487?s=128&d=identicon&r=PG&f=1", "display_name": "SanderJensen", "link": "https://stackoverflow.com/users/11753198/sanderjensen"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1562745615, "post_id": 56965655, "comment_id": 100469036, "body": "Array inputs are going to the next available row in columns B-J"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1562745822, "post_id": 56965655, "comment_id": 100469153, "body": "last two lines should be <code>Dim nextRowB As Range</code> : <code>Set nextRowB = Sheets(&quot;Arkiv&quot;).Range(&quot;B&quot; &amp; Rows.Count).End(xlUp).Offset(1, 0)</code> and     <code>nextRowB.Resize(1, UBound(inputs) + 1).Value = inputs</code>"}, {"owner": {"reputation": 41, "user_id": 11753198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85474fe3238a26dc5f01a5d0f9002487?s=128&d=identicon&r=PG&f=1", "display_name": "SanderJensen", "link": "https://stackoverflow.com/users/11753198/sanderjensen"}, "reply_to_user": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1562746531, "post_id": 56965655, "comment_id": 100469500, "body": "Thank you! I got it working now:)"}, {"owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "edited": false, "score": 0, "creation_date": 1562746562, "post_id": 56965655, "comment_id": 100469517, "body": "Welcome. You made my day"}], "answers": [{"tags": [], "owner": {"reputation": 2672, "user_id": 10405778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e5abab1318bc4dde6e9ed2a626ef76c?s=128&d=identicon&r=PG&f=1", "display_name": "Ahmed AU", "link": "https://stackoverflow.com/users/10405778/ahmed-au"}, "is_accepted": true, "score": 1, "last_activity_date": 1562746442, "creation_date": 1562746442, "answer_id": 56966245, "question_id": 56965655, "link": "https://stackoverflow.com/questions/56965655/using-arrays-and-copying-into-next-available-row-only-gives-me-data-in-the-first/56966245#56966245", "title": "Using arrays and copying into next available row only gives me data in the first cell (user form input)", "body": "<p>May try Like this</p>\n\n<pre><code>Dim inputs As Variant\ninputs = Array(TextBox1.Text, TextBox2.Text, TextBox3.Text, TextBox4.Text, TextBox10.Text, TextBox6.Text, TextBox7.Text, TextBox8.Text, TextBox9.Text)\nDim nextRowB As Range\nSet nextRowB = Sheets(\"Arkiv\").Range(\"B\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\nnextRowB.Resize(1, UBound(inputs) + 1).Value = inputs\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 11753198, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85474fe3238a26dc5f01a5d0f9002487?s=128&d=identicon&r=PG&f=1", "display_name": "SanderJensen", "link": "https://stackoverflow.com/users/11753198/sanderjensen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "accepted_answer_id": 56966245, "answer_count": 1, "score": 1, "last_activity_date": 1562752888, "creation_date": 1562744280, "last_edit_date": 1562752888, "question_id": 56965655, "link": "https://stackoverflow.com/questions/56965655/using-arrays-and-copying-into-next-available-row-only-gives-me-data-in-the-first", "title": "Using arrays and copying into next available row only gives me data in the first cell (user form input)", "body": "<p>I'm making an ERP-system, I have a working, but ugly, code that does what I want. I just tried using arrays for the first time and when using it I only get the first textbox input into my Archive spreadsheet even though I have 9 more textboxes assigned to that array. Kind of hard to explain but easier to see what I'm trying to do in the code.</p>\n\n<p>I have tried changing \"B2\" for nextRow variable to \"C2\" but it still gives me only the first textbox input and pastes that into whatever cell is first mentioned in my nextRow variable.</p>\n\n<p>(This code was given to me on the codereview site but I tried to make some changes too it without any luck.</p>\n\n<pre><code>'Making the variable that stores the input from all 9 textboxes in the userform\nDim inputs As Variant\n'Variabler for inputs\n    inputs = Array(TextBox1.Text, TextBox2.Text, TextBox3.Text, TextBox4.Text, TextBox10.Text, TextBox6.Text, TextBox7.Text, TextBox8.Text, TextBox9.Text)\n\n\n'Declaring the variable for the next available row from B to J so I can copy the input from each textbox into the corresponding cell in the Archive worksheet.\n\nDim nextRowB As Range\n    Set nextRowB = Sheets(\"Arkiv\").Range(\"C\" &amp; Rows.Count &amp; \":J\" &amp; Rows.Count).End(xlUp).Offset(1, 0)\n    nextRowB.Value = inputs\n</code></pre>\n\n<p>Instead of copying every textbox input over to the corresponding cells it copies only the first textbox input (textbox1) into the first column of the next available row and then lets the rest be empty.</p>\n\n<p>I was expecting this code to paste every textbox input into the next available row in column B all the way to J using the same order I used when assigning the different textbox inputs to the array.</p>\n"}, {"tags": ["excel", "vba", "excel-formula", "excel-r1c1-notation"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9699940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31dedf12eb040e96332cbb863bb989fa?s=128&d=identicon&r=PG&f=1", "display_name": "Deglupta", "link": "https://stackoverflow.com/users/9699940/deglupta"}, "edited": false, "score": 0, "creation_date": 1562747500, "post_id": 56965467, "comment_id": 100470011, "body": "I did not know that, great answer! Thanks."}], "tags": [], "owner": {"reputation": 42107, "user_id": 3915431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad2fe8d0c0e72bdbe3623e85a96b9b4?s=128&d=identicon&r=PG&f=1", "display_name": "Axel Richter", "link": "https://stackoverflow.com/users/3915431/axel-richter"}, "is_accepted": true, "score": 1, "last_activity_date": 1562744062, "last_edit_date": 1562744062, "creation_date": 1562743586, "answer_id": 56965467, "question_id": 56965056, "link": "https://stackoverflow.com/questions/56965056/r1c1-formula-result-gives-twice-the-given-variable/56965467#56965467", "title": "R1C1 Formula result gives twice the given variable", "body": "<p>You need understand the <code>R1C1</code> rules in terms of relative and absolute references.</p>\n\n<p><code>R15C7</code> is absolute: Row 15 and Column 7 = <code>$G$15</code>.</p>\n\n<p><code>R[15]C7</code> is row relative and means: The row where the formula is in plus 15 rows and Column 7. If formula is in row 15, then = <code>$G30</code>.</p>\n\n<p><code>RC7</code> means: The row where the formula is in and Column 7. If formula is in row 15, then = <code>$G15</code>.</p>\n\n<pre><code>Public Sub Test()\n a = 15\n Cells(a, 8).FormulaR1C1 = \"=R[\" &amp; a &amp; \"]C7\" '$G30\n Cells(a, 8).FormulaR1C1 = \"=R\" &amp; a &amp; \"C7\"   '$G$15\n Cells(a, 8).FormulaR1C1 = \"=RC7\"            '$G15\nEnd Sub\n</code></pre>\n\n<p>Translated to your locale Zeile/Spalte <code>Z1S1</code>:</p>\n\n<pre><code>Public Sub Test()\n a = 15\n Cells(a, 8).FormulaR1C1Local = \"=Z(\" &amp; a &amp; \")S7\" '$G30\n Cells(a, 8).FormulaR1C1Local = \"=Z\" &amp; a &amp; \"S7\"   '$G$15\n Cells(a, 8).FormulaR1C1Local = \"=ZS7\"            '$G15\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9699940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31dedf12eb040e96332cbb863bb989fa?s=128&d=identicon&r=PG&f=1", "display_name": "Deglupta", "link": "https://stackoverflow.com/users/9699940/deglupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28, "favorite_count": 0, "accepted_answer_id": 56965467, "answer_count": 1, "score": 0, "last_activity_date": 1562744694, "creation_date": 1562742045, "last_edit_date": 1562744694, "question_id": 56965056, "link": "https://stackoverflow.com/questions/56965056/r1c1-formula-result-gives-twice-the-given-variable", "title": "R1C1 Formula result gives twice the given variable", "body": "<p>I want to normalize some data and want this normalized data to change dynamically when the data changes, that's why I want to put Formula in Cells that reference different Cells. But that's not really relevant to the problem because even the simplest of Formula (shown below) doesn't work.</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Public Sub Test()\n    a = 15\n    Cells(a, 8).FormulaR1C1Local = \"=Z(\" &amp; a &amp; \")S7\"\nEnd Sub\n</code></pre>\n\n<p>The Formula in the Cell(15,8) is <code>=$G30</code>.<br>\nI expected the following output: <code>=$G15</code>.</p>\n\n<p>In many forums where people ask how to put variables in a <code>R1C1Formula</code> the answer is: <code>[\" &amp; a &amp; \"]</code>, but this gives a runtime error 1004, so I tried <code>()</code> instead and it doesn't give me any warnings, but the result is not what I expected.</p>\n"}, {"tags": ["excel", "vba", "office-js", "excel-addins"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1562747922, "post_id": 56964829, "comment_id": 100470216, "body": "No, it&#39;s not possible. Closest you could get, <i>maybe</i>, would be to put controls in the Ribbon. Then, <i>possibly</i>, the code could be called using <code>SendKeys</code> to emulate the keyboard presses used to run the control."}, {"owner": {"reputation": 17, "user_id": 6655747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FGPUHzrJ_Uw/AAAAAAAAAAI/AAAAAAAAAEs/LIM5OkXt_1w/photo.jpg?sz=128", "display_name": "Abhijeet Kumar", "link": "https://stackoverflow.com/users/6655747/abhijeet-kumar"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1562748263, "post_id": 56964829, "comment_id": 100470417, "body": "How we can call a excel js function on focus(Edit) mode of cell. I know change/selection-change is one option , but we have to change text for cell. I want to call function on keypress or onfocus of cell"}], "owner": {"reputation": 17, "user_id": 6655747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FGPUHzrJ_Uw/AAAAAAAAAAI/AAAAAAAAAEs/LIM5OkXt_1w/photo.jpg?sz=128", "display_name": "Abhijeet Kumar", "link": "https://stackoverflow.com/users/6655747/abhijeet-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 203, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562747832, "creation_date": 1562741222, "last_edit_date": 1562747832, "question_id": 56964829, "link": "https://stackoverflow.com/questions/56964829/is-is-possible-to-call-excel-js-api-from-excel-vba", "title": "Is is possible to call Excel JS API from Excel VBA", "body": "<p>I have created Web AddIns for Excel . I am also using VBA script in this excel.</p>\n\n<p>Is it possible to call/refer Excel JS API method of Web AddIns from VBA script.Please share code if possible.</p>\n\n<p>I want to call excel JS API function on focus of Cell using VBA and Excel JS API</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1562742178, "post_id": 56964747, "comment_id": 100467357, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39712856/excel-macro-to-take-a-screenshot-of-specific-cells-and-save-as-image-file\">Excel macro to take a screenshot of specific cells and save as image file</a>"}, {"owner": {"reputation": 43, "user_id": 5047050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ae65bdf40a9fe9c7cef0a9a20b09cd2a?s=128&d=identicon&r=PG&f=1", "display_name": "Dragon Warrior", "link": "https://stackoverflow.com/users/5047050/dragon-warrior"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562748374, "post_id": 56964747, "comment_id": 100470497, "body": "@P\u1d07\u029c: Thank you for your kind feedback! May I ask if the solution you had posted also works on Pivot Table? Or the coding needs to be changed slightly in VBA? Pardon my inexperience with VBA programming with Pivot tables. Your feedback is greatly appreciated! Thank you :)"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 1, "creation_date": 1562754732, "post_id": 56964747, "comment_id": 100474210, "body": "If you exchange <code>Range(&quot;G3:J14&quot;)</code> by <code>ActiveSheet.PivotTables(1).TableRange1</code> (pivot range without the filter area) or <code>ActiveSheet.PivotTables(1).TableRange2</code> (whole pivot table area), then the linked code should work."}, {"owner": {"reputation": 43, "user_id": 5047050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ae65bdf40a9fe9c7cef0a9a20b09cd2a?s=128&d=identicon&r=PG&f=1", "display_name": "Dragon Warrior", "link": "https://stackoverflow.com/users/5047050/dragon-warrior"}, "reply_to_user": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 0, "creation_date": 1562813753, "post_id": 56964747, "comment_id": 100497645, "body": "Thank you @Asger! Appreciate your comment. Let me try that out :)"}, {"owner": {"reputation": 3598, "user_id": 10908769, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W0XFB.png?s=128&g=1", "display_name": "Asger", "link": "https://stackoverflow.com/users/10908769/asger"}, "edited": false, "score": 1, "creation_date": 1563546344, "post_id": 56964747, "comment_id": 100747676, "body": "The above linked answer may not work for PivotTables, as the added Chart may be a PivotChart. Then it is not blank and the pasted picture has an additional PivotChart background. Please see my answer <a href=\"https://stackoverflow.com/a/57114187/10908769\">here</a> instead."}], "owner": {"reputation": 43, "user_id": 5047050, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ae65bdf40a9fe9c7cef0a9a20b09cd2a?s=128&d=identicon&r=PG&f=1", "display_name": "Dragon Warrior", "link": "https://stackoverflow.com/users/5047050/dragon-warrior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 243, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562742044, "creation_date": 1562740934, "last_edit_date": 1562742044, "question_id": 56964747, "link": "https://stackoverflow.com/questions/56964747/capture-save-screenshot-in-pivot-table-using-different-filters", "title": "Capture + Save Screenshot in Pivot table using different filters", "body": "<p>I tried to record a macro to save screenshots of a selected area from my Pivot table using different filters.</p>\n\n<p>But when I tried to re-run, it didn't return any pictures.\nIs there a way I can create and save snapshots (and save as picture without links), so that whenever I change the filter, it creates another snapshot of the same area?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 2, "creation_date": 1562741840, "post_id": 56964667, "comment_id": 100467175, "body": "You cannot test <code>Null</code> with <code>=</code>, any test with <code>Null</code>is always <code>Null</code>, not <code>True</code> and the test will evaluate to False. To test <code>Null</code> values, use <a href=\"https://docs.microsoft.com/en-us/office/vba/language/reference/user-interface-help/isnull-function\" rel=\"nofollow noreferrer\">IsNull</a>."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "edited": false, "score": 0, "creation_date": 1562752299, "post_id": 56964667, "comment_id": 100472876, "body": "Leave the <i>Null</i> values. You should never (try to) store zero-length strings unless for some very good and specific reason."}], "owner": {"reputation": 1, "user_id": 11340735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d36ff735c9af128d1f93f609b354580?s=128&d=identicon&r=PG&f=1", "display_name": "Rick Smith", "link": "https://stackoverflow.com/users/11340735/rick-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1594639457, "creation_date": 1562740571, "last_edit_date": 1594639457, "question_id": 56964667, "link": "https://stackoverflow.com/questions/56964667/im-using-nest-if-statements-and-for-next-statements-to-retrieve-and-change-data", "title": "I&#39;m using nest If statements and For Next statements to retrieve and change data in a table", "body": "<p>For some reason everyday of the week is being filled with \"Timed\". I'm testing for a null value, but it doesn't seem to be seeing any values in the table</p>\n\n<p>I am using a DLookup to test if the value is true, seems to be working fine.</p>\n\n<pre><code>Dim i As Integer\nDim j As Integer\nDim db As DAO.Database\nDim wc As DAO.Recordset\nDim stc As DAO.Recordset\nSet db = CurrentDb\nSet wc = db.OpenRecordset(\"Weekly_Challenges\")\nSet stc = db.OpenRecordset(\"Weekly_StartTime_Challenges\")\n\namRoutine = DLookup(\"AMRoutineStartTime\", \"Standard_Actions\", \"UserId=\" &amp; Me.UserID.Value &amp; \" And WeekNumber=\" &amp; Me.WeekNumber)\n\nIf Form_Weekly_Challenges_subform.StandardAction.Value = \"AM Routine\" Then\n    If amRoutine = -1 Then\n        For i = 0 To stc.RecordCount - 1\n        If stc.Fields(\"StartTimeAction\") = \"AM Routine\" Then\n            For j = 0 To wc.RecordCount - 1\n                If wc.Fields(\"StandardAction\") = \"AM Routine\" Then\n                    If stc.Fields(\"Monday\") = Null Then\n                    wc.Edit\n                    wc.Fields(\"Monday\") = \"\"\n                    wc.Update\n                    Else\n                    wc.Edit\n                    wc.Fields(\"Monday\") = \"Timed\"\n                    wc.Update\n                    End If\n                    If stc.Fields(\"Tuesday\") = Null Then\n                    wc.Edit\n                    wc.Fields(\"Tuesday\") = \"\"\n                    wc.Update\n                    Else\n                    wc.Edit\n                    wc.Fields(\"Tuesday\") = \"Timed\"\n                    wc.Update\n                    End If\n                    If stc.Fields(\"Wednesday\") = Null Then\n                    wc.Edit\n                    wc.Fields(\"Wednesday\") = \"\"\n                    wc.Update\n                    Else\n                    wc.Edit\n                    wc.Fields(\"Wednesday\") = \"Timed\"\n                    wc.Update\n                    End If\n                    If stc.Fields(\"Thursday\") = Null Then\n                    wc.Edit\n                    wc.Fields(\"Thursday\") = \"\"\n                    wc.Update\n                    Else\n                    wc.Edit\n                    wc.Fields(\"Thursday\") = \"Timed\"\n                    wc.Update\n                    End If\n                    If stc.Fields(\"Friday\") = Null Then\n                    wc.Edit\n                    wc.Fields(\"Friday\") = \"\"\n                    wc.Update\n                    Else\n                    wc.Edit\n                    wc.Fields(\"Friday\") = \"Timed\"\n                    wc.Update\n                    End If\n                    If stc.Fields(\"Saturday\") = Null Then\n                    wc.Edit\n                    wc.Fields(\"Saturday\") = \"\"\n                    wc.Update\n                    Else\n                    wc.Edit\n                    wc.Fields(\"Saturday\") = \"Timed\"\n                    wc.Update\n                    End If\n                    If stc.Fields(\"Sunday\") = Null Then\n                    wc.Edit\n                    wc.Fields(\"Sunday\") = \"\"\n                    wc.Update\n                    Else\n                    wc.Edit\n                    wc.Fields(\"Sunday\") = \"Timed\"\n                    wc.Update\n                    End If\n                End If\n            wc.MoveNext\n            Next j\n        End If\n        stc.MoveNext\n        Next i\n        End If\n     Else\nEnd If\n</code></pre>\n\n<p>Monday, Wednesday, and Friday should have \"Timed\" and the rest should be empty</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562741127, "post_id": 56964539, "comment_id": 100466845, "body": "The two options I know of are either <code>=TEXT(123456789,&quot;0&quot;)</code> or select the two columns/cells and center across columns through changing horizontal allignment to be across selection. Allthough the latter might not exactly &quot;overflowing&quot; at least it will let you calculate, while the former is technically transformed into text and would need recalculation through <code>=VALUE(A1)</code> or something like <code>=1*A1</code> to be used in a <code>SUM()</code>"}, {"owner": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1562741490, "post_id": 56964539, "comment_id": 100466992, "body": "I have to ask, why not adjust column to &quot;Autofit&quot; if the adjacent cells are Empty and you have room to display entire number?"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1562742314, "post_id": 56964539, "comment_id": 100467424, "body": "Excel by concept will not cheat the user by displaying/printing  only a portion of a number. It will explicitly indicate insufficient space with ##. You have to provide enough space by reducing font size, or merging the necessary amount of cells when you need narrow columns around. But merging will cause difficulties later at sorting or filtering."}, {"owner": {"reputation": 103, "user_id": 10899189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1348a61e573358bbce292eeea6788b5?s=128&d=identicon&r=PG&f=1", "display_name": "MDoe", "link": "https://stackoverflow.com/users/10899189/mdoe"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562742528, "post_id": 56964539, "comment_id": 100467526, "body": "@JvdV Thanks, but I have to ask further. If I want to sum up a range of number, which are formatted as text right now and have a format like &quot;12.3%&quot; (with the percentage symbol as part of the string), how could I convert these. I guess, I cannot do something like =SUM(VALUE(A1:A5)). I tried something similar, but it did not work. I am not even sure, if I can use VALUE on a range."}, {"owner": {"reputation": 103, "user_id": 10899189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1348a61e573358bbce292eeea6788b5?s=128&d=identicon&r=PG&f=1", "display_name": "MDoe", "link": "https://stackoverflow.com/users/10899189/mdoe"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562742628, "post_id": 56964539, "comment_id": 100467583, "body": "@JvdV About the horizontal alignment. What adds to the problem is that the numbers are not always in the same column. There position depends on other factors and VBA just fills them in. Still, I will think about that solution."}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562743870, "post_id": 56964539, "comment_id": 100468156, "body": "As an array you can, will try an answer later to show you"}, {"owner": {"reputation": 103, "user_id": 10899189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1348a61e573358bbce292eeea6788b5?s=128&d=identicon&r=PG&f=1", "display_name": "MDoe", "link": "https://stackoverflow.com/users/10899189/mdoe"}, "reply_to_user": {"reputation": 1716, "user_id": 5079799, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7ea769f6abda58c1c51a1c64845b73c7?s=128&d=identicon&r=PG&f=1", "display_name": "FreeSoftwareServers", "link": "https://stackoverflow.com/users/5079799/freesoftwareservers"}, "edited": false, "score": 0, "creation_date": 1562744387, "post_id": 56964539, "comment_id": 100468448, "body": "@FreeSoftwareServers I understand your question, but for formatting reasons all columns should have the same width in this spreadsheet."}, {"owner": {"reputation": 103, "user_id": 10899189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1348a61e573358bbce292eeea6788b5?s=128&d=identicon&r=PG&f=1", "display_name": "MDoe", "link": "https://stackoverflow.com/users/10899189/mdoe"}, "reply_to_user": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1562744527, "post_id": 56964539, "comment_id": 100468494, "body": "@AcsErno I know why Excel behaves like this, but still I would like to circumvent it by allowing the numbers to be displayed in full and overlap the adjacent cells. Just like text."}, {"owner": {"reputation": 103, "user_id": 10899189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1348a61e573358bbce292eeea6788b5?s=128&d=identicon&r=PG&f=1", "display_name": "MDoe", "link": "https://stackoverflow.com/users/10899189/mdoe"}, "reply_to_user": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "edited": false, "score": 0, "creation_date": 1562744561, "post_id": 56964539, "comment_id": 100468509, "body": "@JvdV Thanks, I will come back to this post later."}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 10899189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1348a61e573358bbce292eeea6788b5?s=128&d=identicon&r=PG&f=1", "display_name": "MDoe", "link": "https://stackoverflow.com/users/10899189/mdoe"}, "edited": false, "score": 0, "creation_date": 1562751777, "post_id": 56966057, "comment_id": 100472598, "body": "Thanks a lot. Still I have a problem. I want to generate that formula in VBA and to be inserted two cells below the last list entry. On first view, everything looks great. VBA generates the correct formula (I took your second option with the sumproduct function) in the correct cell. But then it displays again #NAME? I am not sure if this error message is the same in the English Excel version, but I guess it is. However, when I select that cell, go into the formula bar and just hit enter without changing anything, then the correct sum is displayed. I don&#39;t get it. :("}, {"owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "reply_to_user": {"reputation": 103, "user_id": 10899189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1348a61e573358bbce292eeea6788b5?s=128&d=identicon&r=PG&f=1", "display_name": "MDoe", "link": "https://stackoverflow.com/users/10899189/mdoe"}, "edited": false, "score": 0, "creation_date": 1562763920, "post_id": 56966057, "comment_id": 100479161, "body": "@Mdoe, I&#39;m not quite sure what you are doing wrong but when I use a line, for example: <code>Cells(1, 3).Formula = &quot;=SUMPRODUCT(--(A1:A5))&quot;</code> it works just fine"}, {"owner": {"reputation": 103, "user_id": 10899189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1348a61e573358bbce292eeea6788b5?s=128&d=identicon&r=PG&f=1", "display_name": "MDoe", "link": "https://stackoverflow.com/users/10899189/mdoe"}, "edited": false, "score": 0, "creation_date": 1562775348, "post_id": 56966057, "comment_id": 100485817, "body": "Thanks, I figured it out. I am actually not using an English Excel version. So I thought that I had to enter the translation of the sumproduct function name in my VBA code. But instead VBA needed the English function name and then translated it itself as soon as it was used in the spreadsheet. :)"}], "tags": [], "owner": {"reputation": 40744, "user_id": 9758194, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2eG6f.png?s=128&g=1", "display_name": "JvdV", "link": "https://stackoverflow.com/users/9758194/jvdv"}, "is_accepted": true, "score": 0, "last_activity_date": 1562746259, "last_edit_date": 1562746259, "creation_date": 1562745700, "answer_id": 56966057, "question_id": 56964539, "link": "https://stackoverflow.com/questions/56964539/how-can-long-numbers-be-allowed-to-go-beyond-cell-borders-in-excel-perhaps-with/56966057#56966057", "title": "How can long numbers be allowed to go beyond cell borders in Excel (perhaps with VBA)", "body": "<p>Here are a few examples on how you can still sum ranges that are tecnically text but looking like numbers:</p>\n\n<p><a href=\"https://i.stack.imgur.com/p2EpT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/p2EpT.png\" alt=\"enter image description here\"></a></p>\n\n<p>Notice that the last three formulas are entered as array through <kbd>Ctrl</kbd><kbd>Shift</kbd><kbd>Enter</kbd></p>\n\n<p>I'm sure you can pick up some techniques and apply them, combinations of above are possible too.</p>\n"}], "owner": {"reputation": 103, "user_id": 10899189, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1348a61e573358bbce292eeea6788b5?s=128&d=identicon&r=PG&f=1", "display_name": "MDoe", "link": "https://stackoverflow.com/users/10899189/mdoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 56966057, "answer_count": 1, "score": 1, "last_activity_date": 1562775403, "creation_date": 1562740047, "question_id": 56964539, "link": "https://stackoverflow.com/questions/56964539/how-can-long-numbers-be-allowed-to-go-beyond-cell-borders-in-excel-perhaps-with", "title": "How can long numbers be allowed to go beyond cell borders in Excel (perhaps with VBA)", "body": "<p>For different reasons I have fixed column widths in an Excel spreadsheet. Now I have to insert numbers, which have multiple digits. And as usual Excel only displays \"###\" (hashtags) instead of the values, because the numbers are too long for the strongly limited cell widths. But the adjacent cells are empty. So I need some kind of hack that the numbers will overlap into the adjacent cells and get to be displayed correctly.</p>\n\n<p>I have searched the web and did not find a direct solution.</p>\n\n<p>I have tried to transform the values to text and customized formats. With that I had some success, but then I could not use a sum function on these numbers.</p>\n\n<p>-</p>\n"}, {"tags": ["regex", "excel", "vba"], "comments": [{"owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1562745939, "post_id": 56964493, "comment_id": 100469213, "body": "Try removing the <code>ElseIf InStr(blue2Items, RegM) Then</code> branch and add this else part at the end of the If block: <code>Else Range(Target.Address).Characters(RegM.FirstIndex + 1, RegM.Length).Font.Color = RGB(0, 59, 255)</code>. You know it is the last condition that will match, and it is the only condition that matches unknown strings, all previous ones match literal hardcoded texts."}], "answers": [{"comments": [{"owner": {"reputation": 434, "user_id": 9374675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6000950f1e0083edfe38fe49bf835628?s=128&d=identicon&r=PG&f=1", "display_name": "MK01111000", "link": "https://stackoverflow.com/users/9374675/mk01111000"}, "edited": false, "score": 1, "creation_date": 1562740843, "post_id": 56964636, "comment_id": 100466718, "body": "Thanks Emma but that did not solve the problem. I just edited my post. I tried the same regex but than calling it with a simple sub and that worked, but still can not get it to work upon cell change"}], "tags": [], "owner": {"reputation": 1, "user_id": 6553328, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/omcAX.jpg?s=128&g=1", "display_name": "Emma", "link": "https://stackoverflow.com/users/6553328/emma"}, "is_accepted": false, "score": 0, "last_activity_date": 1562740443, "creation_date": 1562740443, "answer_id": 56964636, "question_id": 56964493, "link": "https://stackoverflow.com/questions/56964493/how-to-highlight-temperature-strings-with-a-regex-in-excel-vba/56964636#56964636", "title": "How to highlight temperature strings with a regex in excel VBA", "body": "<p>I think your expression is fine, maybe we'd add some optional spaces, for just in case, and hopefully it'd work:</p>\n\n<pre><code>(\\d{1,2}(?:\\s*)\u00b0(?:\\s*)-(?:\\s*)\\d{1,2}(?:\\s*)\u00b0)\\s*|(\\d{1,2}(?:\\s*)\u00b0)\n</code></pre>\n\n<p>The expression is explained on the top right panel of <a href=\"https://regex101.com/r/2qrtcZ/1/\" rel=\"nofollow noreferrer\">this demo</a>, if you wish to explore/simplify/modify it, and in <a href=\"https://regex101.com/r/2qrtcZ/1/debugger\" rel=\"nofollow noreferrer\">this link</a>, you can watch how it would match against some sample inputs step by step, if you like. </p>\n"}, {"tags": [], "owner": {"reputation": 481661, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 2, "last_activity_date": 1562747515, "last_edit_date": 1562747515, "creation_date": 1562746660, "answer_id": 56966321, "question_id": 56964493, "link": "https://stackoverflow.com/questions/56964493/how-to-highlight-temperature-strings-with-a-regex-in-excel-vba/56966321#56966321", "title": "How to highlight temperature strings with a regex in excel VBA", "body": "<p>Define the <code>blue2Items</code> as</p>\n\n<pre><code>blue2Items = \"(\\d{1,2}\u00b0(?:-\\d{1,2}\u00b0)?)\"\n</code></pre>\n\n<p>It is more concise and means <em>match 1 or 2 digits with <code>\u00b0</code> sign after them and then an optional sequence of <code>-</code> and again 1 or 2 digits with <code>\u00b0</code> sign</em>.</p>\n\n<p>Then, you need to change the font color based on the capturing group that matched. <code>match.Submatches(x)</code> lets you access these values and if you check their length, you will know which one matched.</p>\n\n<p>Use</p>\n\n<pre><code>If .test(Range(Target.Address).Value) Then\n    Set RegMC = .Execute(Range(Target.Address).Value)\n    For Each RegM In RegMC\n        If Len(RegM.Submatches(0)) &gt; 0 Then\n            Range(Target.Address).Characters(RegM.FirstIndex + 1, RegM.Length).Font.Color = RGB(255, 0, 0)\n        ElseIf Len(RegM.Submatches(1)) &gt; 0 Then\n            Range(Target.Address).Characters(RegM.FirstIndex + 1, RegM.Length).Font.Color = RGB(0, 59, 255)\n        ElseIf Len(RegM.Submatches(2)) &gt; 0 Then\n            Range(Target.Address).Characters(RegM.FirstIndex + 1, RegM.Length).Font.Color = RGB(0, 59, 255)\n        ElseIf Len(RegM.Submatches(3)) &gt; 0 Then\n            Range(Target.Address).Characters(RegM.FirstIndex + 1, RegM.Length).Font.Color = RGB(0, 176, 80)\n        End If\n    Next\nEnd If\n</code></pre>\n\n<p>Test:</p>\n\n<p><a href=\"https://i.stack.imgur.com/M49JA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/M49JA.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 434, "user_id": 9374675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6000950f1e0083edfe38fe49bf835628?s=128&d=identicon&r=PG&f=1", "display_name": "MK01111000", "link": "https://stackoverflow.com/users/9374675/mk01111000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 56966321, "answer_count": 2, "score": 3, "last_activity_date": 1562747515, "creation_date": 1562739837, "last_edit_date": 1562742203, "question_id": 56964493, "link": "https://stackoverflow.com/questions/56964493/how-to-highlight-temperature-strings-with-a-regex-in-excel-vba", "title": "How to highlight temperature strings with a regex in excel VBA", "body": "<p>When the contents of a cell changes, some strings are highlighted.\nThis part I got working already.\nNow I added a regex to highlight strings that contain a temperature as well (i.e. 13\u00b0 or 10\u00ad\u00b0-25\u00b0) This part however does not work (no error but just no output)</p>\n\n<p>This is what I have so far.\nThis all works except for this part (<code>blue2Items = \"(\\d{1,2}\u00b0-\\d{1,2}\u00b0|\\d{1,2}\u00b0)\"</code>)</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Not Intersect(Target, Range(\"J10:J80\")) Is Nothing Then\n        Dim objRegex As Object\n        Dim RegMC As Object\n        Dim RegM As Object\n        '-----------------------------------------------------\n        Target.Font.ColorIndex = 1\n        redItems = \"(RXB|RXG|RGX|RXC|RCX|RXD|RXE|RXS|RFG|RNG|RCL|RPG|RFL|RFS|RSC|RFW|ROX|ROP|RPB|RIS|RDS|RRW|RRY|RCM|ICE|MAG|RMD|RLI|RLM|RSB|RBI|RBM|ELI|ELM|CAO)\"\n        blueItems = \"(COL|CRT)\"\n        greenItems = \"(AVI|HEG)\"\n        blue2Items = \"(\\d{1,2}\u00b0-\\d{1,2}\u00b0|\\d{1,2}\u00b0)\"\n        '-----------------------------------------------------\n        allItems = redItems &amp; \"|\" &amp; blueItems &amp; \"|\" &amp; blue2Items &amp; \"|\" &amp; greenItems\n        Set objRegex = CreateObject(\"vbscript.regexp\")\n        With objRegex\n            .Global = True\n            .Pattern = allItems\n            '-----------------------------------------------------\n                'On Error Resume Next\n                If .test(Range(Target.Address).Value) Then\n                    Set RegMC = .Execute(Range(Target.Address).Value)\n                    For Each RegM In RegMC\n                        If InStr(redItems, RegM) Then\n                            Range(Target.Address).Characters(RegM.FirstIndex + 1, RegM.Length).Font.Color = RGB(255, 0, 0)\n                        ElseIf InStr(blueItems, RegM) Then\n                            Range(Target.Address).Characters(RegM.FirstIndex + 1, RegM.Length).Font.Color = RGB(0, 59, 255)\n                        ElseIf InStr(blue2Items, RegM) Then\n                            Range(Target.Address).Characters(RegM.FirstIndex + 1, RegM.Length).Font.Color = RGB(0, 59, 255)\n                        ElseIf InStr(greenItems, RegM) Then\n                            Range(Target.Address).Characters(RegM.FirstIndex + 1, RegM.Length).Font.Color = RGB(0, 176, 80)\n                        End If\n                    Next\n                End If\n        End With\n    End If\n\n\nI tried the regex with a simple sub and it worked, but I cant get it to work in the above code\n\n    Sub RegExpTemps()\n\n    Dim objRegex As Object\n    Dim RegMC As Object\n    Dim RegM As Object\n\n    Set objRegex = CreateObject(\"vbscript.regexp\")\n    With objRegex\n        .Global = True\n        .Pattern = \"(\\d{1,2}\u00b0-\\d{1,2}\u00b0|\\d{1,2}\u00b0)\"\n        For row = 10 To 80\n            If .test(Cells(row, 10).Value) Then\n                Set RegMC = .Execute(Cells(row, 10).Value)\n                For Each RegM In RegMC\n                    Cells(row, 10).Characters(RegM.FirstIndex + 1, RegM.Length).Font.Color = RGB(0, 0, 255) 'vbGreen\n                Next\n            End If\n        Next row\n    End With\nEnd Sub\n</code></pre>\n\n<p>The expected result is that strings that contain temperatures (have the degree character) are highlighted when the cell content changes</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562740694, "post_id": 56964422, "comment_id": 100466645, "body": "You cannot debug a code that uses <code>On Error Resume Next</code> like this. This line just hides <b>all</b> error messages, but the errors still occur (you just cannot see them). Remove <code>On Error Resume Next</code> and see which errors you get and fix them. \u2022 You might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. \u2022 Also you must ask a real question see <a href=\"https://meta.stackoverflow.com/a/284237/3219613\">Why is \u201cCan someone help me?\u201d not an actual question?</a>"}, {"owner": {"reputation": 1, "user_id": 8558583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdf4e7cbbb41924212dff98fcc626dbd?s=128&d=identicon&r=PG&f=1", "display_name": "anuprasad", "link": "https://stackoverflow.com/users/8558583/anuprasad"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562749380, "post_id": 56964422, "comment_id": 100471140, "body": "Thanks PEH, by help i was looking for the answer to this code behaviour as the logic seems true here. I am a novice with excel VBA."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562749527, "post_id": 56964422, "comment_id": 100471224, "body": "Sorry I don&#39;t get the point of your comment. Is it solved? Was it a question? Please be more clear."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1562754237, "post_id": 56964422, "comment_id": 100473966, "body": "Have you removed this line <code>On Error Resume Next</code> as PEH suggested?"}], "owner": {"reputation": 1, "user_id": 8558583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdf4e7cbbb41924212dff98fcc626dbd?s=128&d=identicon&r=PG&f=1", "display_name": "anuprasad", "link": "https://stackoverflow.com/users/8558583/anuprasad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 27, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562740617, "creation_date": 1562739446, "last_edit_date": 1562740617, "question_id": 56964422, "link": "https://stackoverflow.com/questions/56964422/filtering-and-copying-data-from-multiple-sheets-to-one-sheet", "title": "Filtering and copying data from multiple sheets to one sheet", "body": "<p>I have the below macro setup and running, But it will paste the data from the first sheet as many times the number of sheets. Not the data from each sheet to the sheet report.</p>\n\n<p>Can someone please help me why this happens!</p>\n\n<pre><code>Sub apply_autofilter_across_worksheets()\n    Dim xWs As Worksheet\n    Dim x As String\n\n    On Error Resume Next\n\n    For Each xWs In Worksheets\n        If xWs.Name &lt;&gt; \"Report\" Then            \n            xWs.Range(\"A1\").AutoFilter 14, \"&gt;0\"                \n            xWs.Range(\"A1\", Cells(Rows.Count, \"A\").End(xlUp)).Resize(, 17).Select                \n            Selection.Copy                \n            Worksheets(\"Report\").Activate                \n            Worksheets(\"Report\").Range(\"x1\").Select                \n            Worksheets(\"Report\").Cells(Rows.Count, 1).End(xlUp).Offset(1, 0).PasteSpecial xlPasteValues                            \n        End If        \n    Next\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1562740286, "post_id": 56964195, "comment_id": 100466484, "body": "You are copying 7 rows and pasting in 1 row. That&#39;s why you are getting this error"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562740816, "post_id": 56964195, "comment_id": 100466705, "body": "Note that <code>Offset(0, 0)</code> is completely meaningless. Remove it. Also you might benefit from reading  <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562740948, "post_id": 56964195, "comment_id": 100466774, "body": "<code>ActiveCell.EntireRow.Copy ActiveCell.Offset(0, 0).EntireRow</code> copys <b>and</b> pastes it in the same position.  After that you again paste it in the same position <code>ActiveCell.PasteSpecial xlPasteAll</code>. That is probably not what you wanted. Please clarify what your goal is."}, {"owner": {"reputation": 33, "user_id": 11762978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQOpf.jpg?s=128&g=1", "display_name": "Dave Cus", "link": "https://stackoverflow.com/users/11762978/dave-cus"}, "edited": false, "score": 0, "creation_date": 1562823886, "post_id": 56964195, "comment_id": 100499942, "body": "Hi Peh, Thanks for looking at it, I have cleaned up the code in line with your previous comments (please see amended above) and it is still giving me an error. I have copied a few screen shots to show what I am looking for the function to do. I want to insert a new range of cells and not over write the bold totals. line 14 before insert and line 21 after. When I open the debug it highlights the last line of code &quot;ActiveCell.Paste&quot; I hope this clarifies"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 11762978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQOpf.jpg?s=128&g=1", "display_name": "Dave Cus", "link": "https://stackoverflow.com/users/11762978/dave-cus"}, "edited": false, "score": 1, "creation_date": 1562830081, "post_id": 56983082, "comment_id": 100502754, "body": "Thank you very much it worked a treat. I was looking at the range option but was confused as to how to get it to refer to the one single (moving) cell. So you have shed a great deal of light on many dark subjects. Thanks again"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 0, "last_activity_date": 1562827744, "last_edit_date": 1562827744, "creation_date": 1562827368, "answer_id": 56983082, "question_id": 56964195, "link": "https://stackoverflow.com/questions/56964195/how-to-fix-run-time-error-1004-when-i-paste-with-vba/56983082#56983082", "title": "How to fix Run-time error 1004 when I paste with VBA", "body": "<ol>\n<li>Don't use <code>.Select</code> or <code>.Activate</code> (<a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>).</li>\n<li>Give the red cell a name for example <code>PasteBeforeHere</code>. So the user doesn't need to select this cell manually. If you use named ranges you can access the cell by <code>Range(\"PasteBeforeHere\")</code> easily.</li>\n<li>Then insert empty rows first before you copy/paste.</li>\n</ol>\n\n<p>Something like the following should work:</p>\n\n<pre><code>Option Explicit\n\nPrivate Sub CommandButton1_Click()\n    Dim Source As Range\n    Set Source = ThisWorkbook.Worksheets(\"Working Sheet\").Range(\"A1:AQ7\")\n\n    Dim InsertBefore As Range\n    Set InsertBefore = Selection 'better ThisWorkbook.Worksheets(\"FCTC\").Range(\"PasteBeforeHere\")\n    Set InsertBefore = ThisWorkbook.Worksheets(\"FCTC\").Range(\"PasteBeforeHere\")\n\n    'insert empty rows (same amount as source has)\n    Application.CutCopyMode = False\n    InsertBefore.Resize(RowSize:=Source.Rows.Count).EntireRow.Insert\n\n    'copy from source to destination\n    Source.Copy Destination:=InsertBefore.Offset(RowOffset:=-Source.Rows.Count)\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 11762978, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQOpf.jpg?s=128&g=1", "display_name": "Dave Cus", "link": "https://stackoverflow.com/users/11762978/dave-cus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 0, "accepted_answer_id": 56983082, "answer_count": 1, "score": 3, "last_activity_date": 1562827744, "creation_date": 1562738358, "last_edit_date": 1562826579, "question_id": 56964195, "link": "https://stackoverflow.com/questions/56964195/how-to-fix-run-time-error-1004-when-i-paste-with-vba", "title": "How to fix Run-time error 1004 when I paste with VBA", "body": "<p>I am pretty new to VBA so this might be a bit basic. I have a macro that copies a range of cells from sheet \"Working Sheet\" and pastes them into the active row in Sheet \"FCTC\". The macro also inserts new rows so the new pasted information is not written over any existing data. I think my issue is the range copy to active cell reference paste but I am not sure. I have posted the code below. Any help would be greatly appreciated.</p>\n\n<pre><code>`Private Sub CommandButton1_Click()\nApplication.Goto ActiveWorkbook.Sheets(\"Working Sheet\").Range(\"A1:AQ7\")\n    Selection.Copy\n    Sheets(\"FCTC\").Select\n    ActiveCell.Offset(0, 7).EntireRow.Insert\n    ActiveCell.Paste\nEnd Sub\n</code></pre>\n\n<p>The Macro actually works and inserts the required data and moves the rows down as desired. However I get a </p>\n\n<blockquote>\n  <p>run-time error 1004 \"PasteSpecial method of Range class failed\" </p>\n</blockquote>\n\n<p>There is clearly an issue with the structure but I haven't been able to resolve it. </p>\n\n<p><a href=\"https://i.stack.imgur.com/Vnjlo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vnjlo.png\" alt=\"Before I run the Macro\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/oa7uj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/oa7uj.png\" alt=\"After the macro with the new error message\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1562739625, "post_id": 56964139, "comment_id": 100466223, "body": "Have you tried to debug your program ? Execute it step by step (F8) and try to see where it behaves different as you expect."}, {"owner": {"user_type": "does_not_exist", "display_name": "user11732489"}, "reply_to_user": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "edited": false, "score": 0, "creation_date": 1562740014, "post_id": 56964139, "comment_id": 100466382, "body": "Yes @FunThomas, the last part is my problem. I have been trying to fix it for hours, still no luck. &quot;line:     Sheets(&quot;Sheet1&quot;).Select     Range(mFind, Cells(mFind.Row, &quot;A&quot;)).EntireRow.Delete     Set mFind = Columns(&quot;A&quot;).Find(&quot;Break&quot;)     Set mfind2 = Columns(&quot;A&quot;).Find(&quot;Break&quot;)     If mFind Is Nothing Then Exit Sub     Set mFind = Columns(&quot;A&quot;).FindNext(mFind)&quot;"}], "owner": {"user_type": "does_not_exist", "display_name": "user11732489"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1562742283, "creation_date": 1562738018, "last_edit_date": 1562742283, "question_id": 56964139, "link": "https://stackoverflow.com/questions/56964139/some-lines-remained-in-sheet1-when-they-are-supposed-to-be-in-sheet5", "title": "Some lines remained in Sheet1 when they are supposed to be in Sheet5", "body": "<p>The code is supposed to separate cells by finding the word \"BREAK\" and all the lines below it before another word \"BREAK.\" The problem is that the first to fourth \"BREAK\" and the lines below it was successfully transferred to other sheets but the last word \"BREAK\" was in Sheet5 with 1 line below it but the other lines remained in the first sheet. </p>\n\n<p>I have editing some parts but it is still not working</p>\n\n<pre><code>Sub Fails()\n    Dim mFind As Range\n    Dim Compteur As Integer\n    Dim IdSheet As Integer\n    Dim ErrorBool As Boolean\n\n    debut:\n    Set mFind = Columns(\"A\").Find(\"Break\")\n    Set mfind2 = Columns(\"A\").Find(\"Break\")\n    If mFind Is Nothing Then\n        MsgBox \"There is no cell found with the text 'Break'\" _\n        &amp; \" in column A of the active sheet.\"\n        Exit Sub\n    End If\n\n    firstaddress = mFind.Address\n    IdSheet = 1\n    Compteur = 0\n    Do\n            Set mfind2 = Columns(\"A\").FindNext(mFind)\n            If mfind2 Is Nothing Then\n            Else:\n            If mFind.Row &lt; mfind2.Row Then\n             Compteur = mfind2.Row\n            End If\n            If mFind.Row &gt; mfind2.Row Then\n             ErrorBool = True\n            End If\n\n            If ErrorBool = True Then\n            Range(mFind, Cells(mFind.Row + 1, \"A\")).EntireRow.Cut\n            End If\n            End If\n\n            Range(\"A\" &amp; mFind.Row + 1 &amp; \":A\" &amp; Compteur - 1).EntireRow.Cut\n            If mFind Is Nothing Then\n            Else: IdSheet = IdSheet + 1\n            End If\n            Sheets(\"Sheet\" &amp; IdSheet &amp; \"\").Select\n            Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1, 0).Select\n            ActiveSheet.Paste\n\n    line:\n        Sheets(\"Sheet1\").Select\n        Range(mFind, Cells(mFind.Row, \"A\")).EntireRow.Delete\n        Set mFind = Columns(\"A\").Find(\"Break\")\n        Set mfind2 = Columns(\"A\").Find(\"Break\")\n        If mFind Is Nothing Then Exit Sub\n        Set mFind = Columns(\"A\").FindNext(mFind)\n\n    Loop While mFind.Address &lt;&gt; firstaddress\nEnd Sub\n</code></pre>\n\n<p>Sheet5 should have all the information under the last \"Break\"</p>\n\n<p>Sheet1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/getZw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/getZw.png\" alt=\"enter image description here\"></a></p>\n\n<p>Sheet5:</p>\n\n<p><a href=\"https://i.stack.imgur.com/F9Opl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/F9Opl.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562736941, "post_id": 56963756, "comment_id": 100465250, "body": "When deleting rows, work from the bottom up.  And it&#39;s a good rule to follow to never modify the counter variable inside of a <code>For</code> loop."}, {"owner": {"reputation": 23, "user_id": 11757320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YwltNGWOZbA/AAAAAAAAAAI/AAAAAAAAAHQ/lJNYIjdhATg/photo.jpg?sz=128", "display_name": "jtm", "link": "https://stackoverflow.com/users/11757320/jtm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562737553, "post_id": 56963756, "comment_id": 100465475, "body": "Thanks for the pointers - appreciated. The error seems to be with my incorrectly modified <code>If Not</code> statement."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562737703, "post_id": 56963756, "comment_id": 100465519, "body": "Is it either a date or empty?  If so it&#39;s easiest to test for <code>If Len(xRg(K).Value) &gt; 0 Then</code>"}, {"owner": {"reputation": 23, "user_id": 11757320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YwltNGWOZbA/AAAAAAAAAAI/AAAAAAAAAHQ/lJNYIjdhATg/photo.jpg?sz=128", "display_name": "jtm", "link": "https://stackoverflow.com/users/11757320/jtm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562737912, "post_id": 56963756, "comment_id": 100465588, "body": "That&#39;s awesome! Thanks! Would you by any chance know how to fix the copy location from cell 600 odd to the top of the table? And if it can be automated by the occurrence as opposed to manually having to run the macro each time? Apologies, I am extremely new at coding."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562738091, "post_id": 56963756, "comment_id": 100465656, "body": "You&#39;re using UsedRange which is sensitive to formatting I think  - you might be better off using something like <code>J = Worksheets(&quot;LoansHistory&quot;).Cells(Rows.Count, 1).End(xlUp).Row +1</code> as long as there will always be content in ColA for any copied rows."}, {"owner": {"reputation": 23, "user_id": 11757320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YwltNGWOZbA/AAAAAAAAAAI/AAAAAAAAAHQ/lJNYIjdhATg/photo.jpg?sz=128", "display_name": "jtm", "link": "https://stackoverflow.com/users/11757320/jtm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562738811, "post_id": 56963756, "comment_id": 100465944, "body": "Cool, that does work better, but I have a table formatted in this sheet however, and am now trying to alter the code to copy it into the a new row in said table - is this easily done?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562739483, "post_id": 56963756, "comment_id": 100466163, "body": "If you have the destination sheet formatted as a table then you can use the methods available for listobjects to add the new row - eg see <a href=\"https://stackoverflow.com/questions/12299898/vba-copy-and-paste-table-row-to-another-table\" title=\"vba copy and paste table row to another table\">stackoverflow.com/questions/12299898/&hellip;</a>"}, {"owner": {"reputation": 23, "user_id": 11757320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YwltNGWOZbA/AAAAAAAAAAI/AAAAAAAAAHQ/lJNYIjdhATg/photo.jpg?sz=128", "display_name": "jtm", "link": "https://stackoverflow.com/users/11757320/jtm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562739590, "post_id": 56963756, "comment_id": 100466208, "body": "Great, thanks for your help!"}, {"owner": {"reputation": 23, "user_id": 11757320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YwltNGWOZbA/AAAAAAAAAAI/AAAAAAAAAHQ/lJNYIjdhATg/photo.jpg?sz=128", "display_name": "jtm", "link": "https://stackoverflow.com/users/11757320/jtm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562816210, "post_id": 56963756, "comment_id": 100498091, "body": "@TimWilliams I keep getting run time error 438 (object does not support this property or method) when I try to use <code>listobject.listrows.add</code> for my table. Any common causes of this?"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562820178, "post_id": 56963756, "comment_id": 100498892, "body": "Maybe update your post to add your revised code - difficult to say what the problem is without that."}, {"owner": {"reputation": 23, "user_id": 11757320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YwltNGWOZbA/AAAAAAAAAAI/AAAAAAAAAHQ/lJNYIjdhATg/photo.jpg?sz=128", "display_name": "jtm", "link": "https://stackoverflow.com/users/11757320/jtm"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1562824937, "post_id": 56963756, "comment_id": 100500335, "body": "Unfortunately, I haven&#39;t really been able to revise the code much at all - I am getting quite confused as to how to incorporate listobjects correctly. I&#39;ve been reading posts all day, still no clearer."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 11757320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YwltNGWOZbA/AAAAAAAAAAI/AAAAAAAAAHQ/lJNYIjdhATg/photo.jpg?sz=128", "display_name": "jtm", "link": "https://stackoverflow.com/users/11757320/jtm"}, "edited": false, "score": 0, "creation_date": 1562737771, "post_id": 56963909, "comment_id": 100465540, "body": "Thanks! The error seems to be within the <code>If Not</code>. Tim above assisted on how to fix!"}], "tags": [], "owner": {"reputation": 121, "user_id": 7988962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9db15cd1790c889705ad258dfa2d9c87?s=128&d=identicon&r=PG&f=1", "display_name": "SamP", "link": "https://stackoverflow.com/users/7988962/samp"}, "is_accepted": false, "score": 0, "last_activity_date": 1562736721, "last_edit_date": 1562736721, "creation_date": 1562736397, "answer_id": 56963909, "question_id": 56963756, "link": "https://stackoverflow.com/questions/56963756/moving-rows-from-one-table-to-another-excel-vba/56963909#56963909", "title": "Moving Rows from One Table to Another (Excel VBA)", "body": "<p>To debug this you could fairly easily see where it is crashing by putting a breakpoint in the code and stepping through it. </p>\n\n<p>Either click on the left bar next to the code area until the code line turns red, or just add a <code>Stop</code> command into your code.</p>\n\n<p>Also, comment out the two <code>Application.ScreenUpdating =</code> commands for now. While you are debugging these will only hinder you. If the error occurs in between them then you will struggle to get your screen updating back on. You can run the latter one in the debug window (Ctrl+G) to turn it back on. For now, just leave the screen updating on.</p>\n\n<p>Once you've hit a breakpoint you can press F8 to continue through the code one command at a time until you find the line which errors. Experiment with it, it will really help when you hit a stumbling block such as this.</p>\n\n<p>I don't like this part of the code at a glance <code>.Range(\"A\" &amp; J + 1)</code> though, try putting the J+1 in an extra set of brackets. <code>.Range(\"A\" &amp; (J + 1))</code>.</p>\n"}], "owner": {"reputation": 23, "user_id": 11757320, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YwltNGWOZbA/AAAAAAAAAAI/AAAAAAAAAHQ/lJNYIjdhATg/photo.jpg?sz=128", "display_name": "jtm", "link": "https://stackoverflow.com/users/11757320/jtm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 343, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562898313, "creation_date": 1562735433, "last_edit_date": 1562898313, "question_id": 56963756, "link": "https://stackoverflow.com/questions/56963756/moving-rows-from-one-table-to-another-excel-vba", "title": "Moving Rows from One Table to Another (Excel VBA)", "body": "<p>I am looking to automate somewhat of a cut and paste function within my workbook to transfer returned loan details from an outstanding loans sheet onto a 'LoansHistory' sheet. I found this code online and have been trying to modify it to add the row contents to an existing table based on the presence of a date (or any text, currently) in a corresponding 'column K' Cell.</p>\n\n<p>Essentially, being brand new at coding in general, I am having extreme difficulty modifying the below code to look for and paste rows into an existing table using <code>ListObjects.ListRows</code> instead of the next empty row (as it currently does). </p>\n\n<p>I understand there are a few other posts where others have addressed this, but as my knowledge of VBA is very limited, I am still struggling to apply the appropriate changes.</p>\n\n<p>I am constantly getting error codes such as \"Sub Script Out of Range\" or \"Object does not support this function\" when attempting to use <code>ListObjects.ListRows</code> functions.</p>\n\n<p>Any help at all would be extremely appreciated.</p>\n\n<pre><code>Sub Cheezy()\n\n    Dim xRg As Range\n    Dim xCell As Range\n    Dim i As Long\n    Dim J As Long\n    Dim K As Long\n\n   i = Worksheets(\"Loans\").UsedRange.Rows.count\n   J = Worksheets(\"LoansHistory\").Cells(Rows.count, 1).End(xlUp).Row\n\n    If J = 1 Then\n       If Application.WorksheetFunction.CountA(Worksheets(\"LoansHistory\").ListObjects(\"History\")) = 0 Then J = 0\n       End If\n  Set xRg = Worksheets(\"Loans\").Range(\"K4:K\" &amp; i)\n    On Error Resume Next\n    Application.ScreenUpdating = False\n   For K = 1 To xRg.count\n       If Len(xRg(K).Value) &gt; 0 Then\n          xRg(K).EntireRow.Copy Destination:=Worksheets(\"LoansHistory\").Range(\"A\" &amp; (J + 1))\n            xRg(K).EntireRow.Delete\n            If Len(xRg(K).Value) &gt; 0 Then\n                K = K - 1\n            End If\n         End If\n      Next\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562737201, "post_id": 56963711, "comment_id": 100465353, "body": "Bone \u2026 If this code is not used in an Excel Add-In there is a high probability that you meant to use <code>ThisWorkbook</code> instead of <code>ActiveWorkbook</code>. Note that <code>ThisWorkbook</code> is the workbook this code is running at while <code>ActiveWorkbook</code> is the workbook that has the focus (is on top). While <code>ThisWorkbook</code> is very reliable  <code>ActiveWorkbook</code> can easily change by a click of a user. So be careful you don&#39;t mix them up."}, {"owner": {"reputation": 3, "user_id": 11762928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XJMHwYPVadE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQExZs2q9q-KnKVW8BiFiBfarTkA/photo.jpg?sz=128", "display_name": "newbinator86", "link": "https://stackoverflow.com/users/11762928/newbinator86"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1562747767, "post_id": 56963711, "comment_id": 100470124, "body": "Ah well there you go, as you can probably tell I&#39;ve just pieced this together from some googling (this page in particular) and recording my own macros. Thanks for that!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 11762928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XJMHwYPVadE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQExZs2q9q-KnKVW8BiFiBfarTkA/photo.jpg?sz=128", "display_name": "newbinator86", "link": "https://stackoverflow.com/users/11762928/newbinator86"}, "edited": false, "score": 0, "creation_date": 1562793619, "post_id": 56963841, "comment_id": 100493557, "body": "Thank you so very much !"}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1562735918, "creation_date": 1562735918, "answer_id": 56963841, "question_id": 56963711, "link": "https://stackoverflow.com/questions/56963711/exporting-xlsx-and-pdf-where-filename-already-exists/56963841#56963841", "title": "Exporting .xlsx and .pdf where filename already exists", "body": "<p>See the lines with If Conditions added in the Code:</p>\n\n<pre><code>Dim Path As String\nDim filename As String\n\nPath = \"C:\\Users\\yard\\Dropbox\\Modus\\Purchase Orders\\\"\n\nfilename = Range(\"E4\")\n\n    Application.DisplayAlerts = False\n\n    If Not Len(dir(Path &amp; filename &amp; \".xls\")) = 0 Then MsgBox \"Xls File Already Exist\"\n    ActiveWorkbook.SaveAs filename:=Path &amp; filename &amp; \".xls\", FileFormat:=xlOpenXMLWorkbook\n\n    If Not Len(dir(Path &amp; filename &amp; \".pdf\")) = 0 Then MsgBox \"PDF File Already Exist\"\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, filename:=Path &amp; filename &amp; \".pdf\", Quality:= _\n        xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _\n        OpenAfterPublish:=True\n    Application.DisplayAlerts = True\n\nEnd Sub\n</code></pre>\n\n<p>You can use <code>Dir</code> to check if the File Exists </p>\n"}], "owner": {"reputation": 3, "user_id": 11762928, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-XJMHwYPVadE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdQExZs2q9q-KnKVW8BiFiBfarTkA/photo.jpg?sz=128", "display_name": "newbinator86", "link": "https://stackoverflow.com/users/11762928/newbinator86"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 56963841, "answer_count": 1, "score": 0, "last_activity_date": 1572395738, "creation_date": 1562735130, "last_edit_date": 1572395738, "question_id": 56963711, "link": "https://stackoverflow.com/questions/56963711/exporting-xlsx-and-pdf-where-filename-already-exists", "title": "Exporting .xlsx and .pdf where filename already exists", "body": "<p>I need some basic help that I can't get right in my code.</p>\n\n<p>Saving as both an .xlsx and PDF file, in the same location, just can't get it to prompt if filename already exists</p>\n\n<pre><code>Sub SaveAs()\nDim Path As String\nDim filename As String\nPath = \"C:\\Users\\yard\\Dropbox\\Modus\\Purchase Orders\\\"\nfilename = Range(\"E4\")\n            Application.DisplayAlerts = False\n    ActiveWorkbook.SaveAs filename:=Path &amp; filename &amp; \".xls\", FileFormat:=xlOpenXMLWorkbook\n\n    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, filename:=Path &amp; filename &amp; \".pdf\", Quality:= _\n        xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, _\n        OpenAfterPublish:=True\n\nEnd Sub\n</code></pre>\n\n<p>Or have I cancelled that out by using Application.DisplayAlerts = False?</p>\n\n<p>I don't want to be prompted regarding a macro enabled workbook when saving the excel file, however I would like it to prompt if the filename already exists.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1562732220, "post_id": 56963276, "comment_id": 100464059, "body": "Try to activate the worksheet after this line <code>For Each ws In Worksheets</code> in that way <code>ws.Activate</code>"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 1, "creation_date": 1562733191, "post_id": 56963276, "comment_id": 100464322, "body": "@YasserKhalil . i don&#39;t think you need to activate a sheet, because you are specifying the sheet in <code>ws</code>. And it&#39;s always better to avoid the use of <code>Activate</code> &amp; <code>Select</code>"}, {"owner": {"reputation": 4949, "user_id": 7657180, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c0ee64d62bb9980080e6881a20a15fc?s=128&d=identicon&r=PG", "display_name": "YasserKhalil", "link": "https://stackoverflow.com/users/7657180/yasserkhalil"}, "edited": false, "score": 0, "creation_date": 1562733286, "post_id": 56963276, "comment_id": 100464342, "body": "Thanks a lot. But I suggested that because the OP used Select method in the code posted."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 11716264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0316f19c0c1cf1f4a037d8dba020465d?s=128&d=identicon&r=PG&f=1", "display_name": "Moras", "link": "https://stackoverflow.com/users/11716264/moras"}, "edited": false, "score": 0, "creation_date": 1562778794, "post_id": 56963447, "comment_id": 100487453, "body": "my issue is - not directly offset from the ActiveCell, In a sheet if  &quot;abc&quot; - (f)  is row 50, I have data without blank till 54. So I want to offset 2 rows from Row 54 and delete rest of rows till 500."}, {"owner": {"reputation": 47, "user_id": 11716264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0316f19c0c1cf1f4a037d8dba020465d?s=128&d=identicon&r=PG&f=1", "display_name": "Moras", "link": "https://stackoverflow.com/users/11716264/moras"}, "edited": false, "score": 0, "creation_date": 1562779207, "post_id": 56963447, "comment_id": 100487656, "body": "So I have used the code - Selection.End(xlDown).Select"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 47, "user_id": 11716264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0316f19c0c1cf1f4a037d8dba020465d?s=128&d=identicon&r=PG&f=1", "display_name": "Moras", "link": "https://stackoverflow.com/users/11716264/moras"}, "edited": false, "score": 0, "creation_date": 1562798443, "post_id": 56963447, "comment_id": 100494882, "body": "this is always fixed that data is present for 4 more rows where &quot;abc&quot; is found ?"}, {"owner": {"reputation": 47, "user_id": 11716264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0316f19c0c1cf1f4a037d8dba020465d?s=128&d=identicon&r=PG&f=1", "display_name": "Moras", "link": "https://stackoverflow.com/users/11716264/moras"}, "edited": false, "score": 0, "creation_date": 1562866224, "post_id": 56963447, "comment_id": 100523265, "body": "Amended code the first one above is not working, i am looking for some support"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 47, "user_id": 11716264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0316f19c0c1cf1f4a037d8dba020465d?s=128&d=identicon&r=PG&f=1", "display_name": "Moras", "link": "https://stackoverflow.com/users/11716264/moras"}, "edited": false, "score": 0, "creation_date": 1562891515, "post_id": 56963447, "comment_id": 100531235, "body": "Okay @Moras .. Do one thing, try running your Code using F8 and check at every step what exactly is happening in your sheet. and see where the code goes wrong."}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 47, "user_id": 11716264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0316f19c0c1cf1f4a037d8dba020465d?s=128&d=identicon&r=PG&f=1", "display_name": "Moras", "link": "https://stackoverflow.com/users/11716264/moras"}, "edited": false, "score": 0, "creation_date": 1562891590, "post_id": 56963447, "comment_id": 100531250, "body": "Otherwise if possible, share your worksheet, I will see why it&#39;s not Working"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 47, "user_id": 11716264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0316f19c0c1cf1f4a037d8dba020465d?s=128&d=identicon&r=PG&f=1", "display_name": "Moras", "link": "https://stackoverflow.com/users/11716264/moras"}, "edited": false, "score": 0, "creation_date": 1562909064, "post_id": 56963447, "comment_id": 100534422, "body": "@Moras .. I have made the changes, use the code now. It will work"}, {"owner": {"reputation": 47, "user_id": 11716264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0316f19c0c1cf1f4a037d8dba020465d?s=128&d=identicon&r=PG&f=1", "display_name": "Moras", "link": "https://stackoverflow.com/users/11716264/moras"}, "edited": false, "score": 0, "creation_date": 1562953049, "post_id": 56963447, "comment_id": 100555946, "body": "Can you check the code got saved? I don&#39;t see any change, Macro stops in the second page"}, {"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "reply_to_user": {"reputation": 47, "user_id": 11716264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0316f19c0c1cf1f4a037d8dba020465d?s=128&d=identicon&r=PG&f=1", "display_name": "Moras", "link": "https://stackoverflow.com/users/11716264/moras"}, "edited": false, "score": 0, "creation_date": 1562976274, "post_id": 56963447, "comment_id": 100562082, "body": "@Moras, not in the File. Here in the Answer, use the Answer."}], "tags": [], "owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "is_accepted": true, "score": 0, "last_activity_date": 1562909046, "last_edit_date": 1562909046, "creation_date": 1562733065, "answer_id": 56963447, "question_id": 56963276, "link": "https://stackoverflow.com/questions/56963276/run-macro-in-all-worksheets2/56963447#56963447", "title": "Run Macro in all worksheets2", "body": "<p>There was issue in the Range Selection.</p>\n\n<p>Also be sure that <code>ActiveCell</code> corresponds to the correct cell you want to search from, because activecell can be different in each sheet.</p>\n\n<pre><code>Sub Test999()\n\n    Dim ws As Worksheet, f As Range\n\n       For Each ws In Worksheets\n\n            'Debug.Print ws.Name\n\n            Set f = ws.Cells.Find(What:=\"abc\", After:=ActiveCell, LookIn:=xlFormulas, _\n                    LookAt:=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, _\n                    MatchCase:=False, SearchFormat:=False)\n\n            If Not f Is Nothing Then\n                    ws.Activate\n                    ws.Range(f.Offset(-2, 0), ws.Range(\"A2\")).Select\n                    ws.Range(f.Offset(-2, 0), ws.Range(\"A2\")).EntireRow.Delete\n                    f.Select\n                    ws.Range(f, Selection.End(xlDown)).Select\n                    Selection.End(xlDown).Select\n                    ws.Range(ActiveCell.Offset(3, 0), ws.Range(\"A500\")).EntireRow.Delete\n\n            End If\n    Next ws\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 11716264, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0316f19c0c1cf1f4a037d8dba020465d?s=128&d=identicon&r=PG&f=1", "display_name": "Moras", "link": "https://stackoverflow.com/users/11716264/moras"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 56963447, "answer_count": 1, "score": 0, "last_activity_date": 1562909046, "creation_date": 1562731569, "question_id": 56963276, "link": "https://stackoverflow.com/questions/56963276/run-macro-in-all-worksheets2", "title": "Run Macro in all worksheets2", "body": "<p>I have data in a sheet and I want to keep a specific section and delete the rest unwanted data based on a specific text search.specific text is dynamic. </p>\n\n<p>So based on Activecell using offset I delete the portion above the specific text and want delete the below portion as well. (Say for example row 56-61 only the data I need, will not be same rows in all sheets)</p>\n\n<p>the current code runs for one worksheet and stops in the second sheet</p>\n\n<pre><code>Sub Test999()\n    Dim ws As Worksheet, f As Range\n    For Each ws In Worksheets\n            Set f = ws.Cells.Find(What:=\"abc\", After:=ActiveCell, \nLookIn:=xlFormulas, _\n                    LookAt:=xlPart, SearchOrder:=xlByRows, \nSearchDirection:=xlNext, _\n                    MatchCase:=False, SearchFormat:=False)\n\n            If Not f Is Nothing Then\n                    ws.Range(f.Offset(-2, 0), \nws.Range(\"A2\")).EntireRow.Delete\n                    ws.Range(f, Selection.End(xlDown)).Select\n                    Selection.End(xlDown).Select\n                    ws.Range(ActiveCell.Offset(2, 0), \nws.Range(\"A500\")).EntireRow.Delete\n            End If\n    Next ws\nEnd Sub\n</code></pre>\n\n<p>I want to run this code to all worksheets</p>\n"}, {"tags": ["excel", "vba", "formula", "countif"], "comments": [{"owner": {"reputation": 6373, "user_id": 5720144, "user_type": "registered", "profile_image": "https://graph.facebook.com/1061165080610672/picture?type=large", "display_name": "Mikku", "link": "https://stackoverflow.com/users/5720144/mikku"}, "edited": false, "score": 0, "creation_date": 1562729564, "post_id": 56963021, "comment_id": 100463580, "body": "Change the Format of the Cell to General in which you are applying the formula"}], "answers": [{"tags": [], "owner": {"reputation": 30680, "user_id": 447970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a73f02bfb0768bed345de389c7e094?s=128&d=identicon&r=PG", "display_name": "teylyn", "link": "https://stackoverflow.com/users/447970/teylyn"}, "is_accepted": false, "score": 0, "last_activity_date": 1562732876, "creation_date": 1562732876, "answer_id": 56963421, "question_id": 56963021, "link": "https://stackoverflow.com/questions/56963021/countif-function-shows-a-date-instead-of-a-number-as-a-result/56963421#56963421", "title": "COUNTIF function shows a date instead of a number as a result", "body": "<p>Excel tries to be helpful and takes a guess at the data type of the formula cell.</p>\n\n<p>Unfortunately, Excel often gets it wrong. Especially when the formula processes dates, Excel will often format the cell as a date, too, even though the result may not be a date at all. </p>\n\n<p>Your only option is to manually apply a different format to the cell. General or Number will show the real number.</p>\n"}], "owner": {"reputation": 1, "user_id": 11762655, "user_type": "registered", "profile_image": "https://graph.facebook.com/2105879409437317/picture?type=large", "display_name": "Murilo Caetano", "link": "https://stackoverflow.com/users/11762655/murilo-caetano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1562732876, "creation_date": 1562729187, "last_edit_date": 1562729638, "question_id": 56963021, "link": "https://stackoverflow.com/questions/56963021/countif-function-shows-a-date-instead-of-a-number-as-a-result", "title": "COUNTIF function shows a date instead of a number as a result", "body": "<p>I was creating a frequency worksheet for the new classes i'll be taking this semester, but when i try to use the <code>COUNTIF</code> function as a sum of three different parameters, i always get a date <strong>(like 00/jan)</strong> as the result, not a natural number as i'd expect. </p>\n\n<p>I've tried using the function <code>COUNTIFS</code> instead, only to achieve the same result. </p>\n\n<p>The function i was trying to create is </p>\n\n<pre><code>=COUNTIF(B5:B23;\"*criteria1*\")+COUNTIF(B5:B23;\"*criteria2*\")+COUNTIF(B5:B23;\"*criteria3*\")\n</code></pre>\n\n<p>With COUNTIFS, it is as follows:</p>\n\n<pre><code>=COUNTIFS(B5:B23;\"*criteria1*\";B5:B23;\"*criteria2*\";B5:B23;\"*criteria3*\")\n</code></pre>\n\n<p>There is no error message, and all i want to get is a real number, that is, the real sum of those \"criteria\" appearing in the given interval.</p>\n"}]