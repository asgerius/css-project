[{"tags": ["excel", "vbscript", "vba"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 5, "creation_date": 1528332777, "post_id": 50731124, "comment_id": 88470901, "body": "I think you need to show us the AutoPublish macro. Is it possible it&#39;s operating on <code>ActiveWorkbook</code> and not <code>ThisWorkbook</code> ?"}, {"owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528378137, "post_id": 50731124, "comment_id": 88492567, "body": "@Tim Williams Thank you.  I believe this was the problem.  I did have some ActiveWorkbook references in that macro as well as some variable assignments from range names that were not explicitly set to ThisWorkbook.  I changed those but still had a VBA error with an explicit (valid) tab selection:        ThisWorkbook.Sheets(&quot;SER&quot;).Select  I took a stab at getting the called macro&#39;s workbook focus with:     ThisWorkbook.Activate Right at the beginning of the code.  That seems to have fixed it.  If you post your reply as an answer I&#39;ll happily accept it.  Thanks for the help."}], "answers": [{"comments": [{"owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "edited": false, "score": 0, "creation_date": 1528378213, "post_id": 50737784, "comment_id": 88492638, "body": "EarlyBird2, thanks for this suggestion and your method."}, {"owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "reply_to_user": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "edited": false, "score": 0, "creation_date": 1528428384, "post_id": 50737784, "comment_id": 88513747, "body": "No problem, @shorton."}], "tags": [], "owner": {"reputation": 276, "user_id": 9379711, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KdliM.jpg?s=128&g=1", "display_name": "EarlyBird2", "link": "https://stackoverflow.com/users/9379711/earlybird2"}, "is_accepted": false, "score": 1, "last_activity_date": 1528363842, "creation_date": 1528363842, "answer_id": 50737784, "question_id": 50731124, "link": "https://stackoverflow.com/questions/50731124/executing-excel-macro-on-from-specific-open-file/50737784#50737784", "title": "Executing Excel macro on/from specific open file", "body": "<p>When tackling similar tasks, I usually work around by implementing a master Excel file first, and call a sub in this master file via VBS. The advantage to me seems it is way easier to fullfill all tasks in the VBA of the master file rather than having to code all that in VBS.</p>\n\n<p>Create a master file, e.g. \"Master.xlsm\", list all your files you need to open on a sheet named \"Files\" in column A, starting in  row 1.\nInsert a module and place the following sub in this module:</p>\n\n<pre><code>Sub Main()\n\n    Dim strPath As String\n    Dim strFile As String\n    Dim lRow As Long\n    Dim i As Long\n    Dim k As Integer\n    Dim n As Long\n    Dim wb(1 To 3) As Workbook\n    Dim wbTest As Workbook\n\n    Set wbMaster = ThisWorkbook\n    strPath = \"\\\\Gaalpa1cdfile19\\north_sa_staff\\Reports\\Rpt-ProductionCurves\\\"\n\n    'Check how many files you need to open\n    With Sheets(\"Files\")\n        lRow = Sheets(\"Files\").Range(\"A\" &amp; .Rows.Count).End(xlUp).Row\n    End With\n\n    'open all available files\n    For i = 1 To lRow\n        Workbooks.Open (wbMaster.Sheets(\"Files\").Range(\"A\" &amp; i).Value)\n    Next\n\n    'now run the two macros in each open file\n    For k = 2 To Workbooks.Count 'this will work only if your master file is the only one open when starting the sub!\n        Workbooks(k).Run \"'\" &amp; Workbooks(k).Name &amp; \"'!AutoRefresh\"\n        DoEvents\n        Workbooks(k).Run \"'\" &amp; Workbooks(k).Name &amp; \"'!AutoPublish\"\n        DoEvents\n    Next\n\n    'and close all files previously opened except for the master file\n    For n = Workbooks.Count To 2 Step -1\n        Workbooks(n).Close False\n    Next\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "edited": false, "score": 0, "creation_date": 1528386616, "post_id": 50744473, "comment_id": 88498571, "body": "Well, my ThisWorkbook.Activate in the macro didn&#39;t work after all.  But that lead me to try the solution posted in the original Q which did work."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1528383692, "creation_date": 1528383692, "answer_id": 50744473, "question_id": 50731124, "link": "https://stackoverflow.com/questions/50731124/executing-excel-macro-on-from-specific-open-file/50744473#50744473", "title": "Executing Excel macro on/from specific open file", "body": "<p>It seems like a possible explanation for what you're seeing is that your <code>AutoPublish</code> macro refers to <code>ActiveWorkbook</code> and not the safer <code>ThisWorkbook</code>.  If another workbook is active when it's called that could lead to unexpected results.</p>\n"}], "owner": {"reputation": 303, "user_id": 7471141, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/22babd4c799029e887d50c12e1a8fa86?s=128&d=identicon&r=PG&f=1", "display_name": "shorton", "link": "https://stackoverflow.com/users/7471141/shorton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "accepted_answer_id": 50744473, "answer_count": 2, "score": 0, "last_activity_date": 1528388231, "creation_date": 1528328599, "last_edit_date": 1531164843, "question_id": 50731124, "link": "https://stackoverflow.com/questions/50731124/executing-excel-macro-on-from-specific-open-file", "title": "Executing Excel macro on/from specific open file", "body": "<p>I've got a need to open some Excel files and \"pause\" then close them.  In this process I run one macro on opening, and another on closing.  The opening one works fine because it is done as each file is opened.  But the closing part of the code I can't get it to run the correct macro.  They have the same names, but the file contests are different, and what the macro does per file is different.</p>\n\n<p>This is the gist of what I'm doing now</p>\n\n<pre><code>Set xlApp = CreateObject(\"Excel.Application\")\nxlApp.Visible = True\n\npath = \"\\\\Gaalpa1cdfile19\\north_sa_staff\\Reports\\Rpt-ProductionCurves\\\"\n\nfilename2018P1 = \"2018 P1.xlsm\"\nSet xlbook2018P1 = xlApp.WorkBooks.Open(path &amp; filename2018P1)\n' Run Macro\nxlApp.Run \"AutoRefresh\"\n\nfilename2018P3 = \"P3 2018 HRR.xlsm\"\nSet xlbook2018P3 = xlApp.WorkBooks.Open(path &amp; filename2018P3)\n'Run Macro\nxlApp.Run \"AutoRefresh\"\n\n'My \"pause\"\nWScript.Echo (\"All Files were\" &amp; Chr(013) &amp; _\n              \"opened and refreshed, update ppt before OK\" &amp; Chr(013) &amp; _\n              \" DO NOT CLICK OK\" &amp; Chr(013))\n\n'==========================\n'Below is the trouble spot.\n'==========================\nxlapp.Run \"'\" &amp; filename2018P1 &amp; \"'\" &amp; \"!AutoPublish\"\nxlbook2018P1.Close False\nSet xlbook2018P1 = Nothing\n\nxlapp.run \"'\" &amp; filename2018P3 &amp; \"'\" &amp; \"!AutoPublish\"\nxlbook2018P3.Close False\nSet xlbook2018P3 = Nothing\n</code></pre>\n\n<p>The first part works fine, but trying to run the file's respective <code>AutoPublish</code> macro does not.  The code works fine if I leave out that <code>Run</code> line.  (The real file names have spaces and I had to add the single quotes to get it to accept the filename.)</p>\n\n<p>What it appears to be doing is using the macros from the last file opened, not the one it's directed to use it the run line.  I think I need a way to \"select\" the correct file, or give it focus so the macro could run without an explicit filename argument, which it appears to be ignoring anyway.</p>\n\n<p>EDIT:  </p>\n\n<p>Solution was:</p>\n\n<pre><code>xlbook2018P1.Activate ' This fixed it, I think\nxlapp.Run \"'\" &amp; filename2018P1 &amp; \"'\" &amp; \"!AutoPublish\"\nxlbook2018P1.Close False\nSet xlbook2018P1 = Nothing\n\nxlbook2018P3.Activate\nxlapp.run \"'\" &amp; filename2018P3 &amp; \"'\" &amp; \"!AutoPublish\"\nxlbook2018P3.Close False\nSet xlbook2018P3 = Nothing    \n</code></pre>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "edited": false, "score": 0, "creation_date": 1528380085, "post_id": 50736379, "comment_id": 88493951, "body": "Ahhh...that&#39;s a good way of putting it. So with further reading and experimentation last night, I came to the realization that all of the Index numbers for GroupLevels and Sections are reserved and limited. There can only be 10 groups, each with two sections, a header and footer. Any form or report has a detail, document and footer, and page hander and footer, with the groups after that, in that order (leading from the Access.acSection enumeration). That&#39;s a total of 25 maximum possible sections. Does that seem correct..?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "edited": false, "score": 0, "creation_date": 1528381818, "post_id": 50736379, "comment_id": 88495319, "body": "That makes sense, though I&#39;ve never done the counting myself."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1528360010, "creation_date": 1528360010, "answer_id": 50736379, "question_id": 50729887, "link": "https://stackoverflow.com/questions/50729887/in-access-vba-whats-the-difference-between-grouplevel-and-section-objects/50736379#50736379", "title": "In Access VBA, what&#39;s the difference between GroupLevel and Section objects..?", "body": "<p><em>Sections</em> are the \"physical\" parts of the report/form: headers, footers, detail.</p>\n\n<p><em>GroupLevels</em> are logical, determined by your data and how you define Groups in the report.</p>\n"}], "owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 50736379, "answer_count": 1, "score": 0, "last_activity_date": 1594634326, "creation_date": 1528320546, "last_edit_date": 1594634326, "question_id": 50729887, "link": "https://stackoverflow.com/questions/50729887/in-access-vba-whats-the-difference-between-grouplevel-and-section-objects", "title": "In Access VBA, what&#39;s the difference between GroupLevel and Section objects..?", "body": "<p>In Access VBA, what are the major differences &amp; issues between GroupLevel objects and Section objects..? I thought I understood, but then I got to a point in my code where I realized I didn't. I'm writing some code that automates the formatting of controls on a report that's open in design view. And while it's not normally necessary to know of Sections for this, the code does operate based on which section a control is in.</p>\n\n<p>From looking at the help file, online, and the Locals window of the IDE in debug mode, it seems to me GroupLevel is the greater of the two...almost. A GroupLevel object represents a report group level, if there's any grouping. But then a Section object for a header, footer, both, or neither will stem from a GroupLevel object, based on its properties.</p>\n\n<p>It's tempting to say that you can't have a Section without a GroupLevel, but there will always be a Detail section, even with no grouping. And moving up from there will be report header/footer, and page header/footer, and whether or not these exist determines whether or not a Section object exists for them. So I suppose it would be more accurate to say you can't have more than five Section objects without a GroupLevel for each of them.</p>\n\n<p>And this is just what I've found for Reports. I haven't even dusted the snow off the tip of the iceberg for forms yet. Any insights &amp; explanations in that vein would be most appreciated. </p>\n\n<p>There's a closely related issue: since GroupLevel objects and Section objects don't have their own respective collections (such as \"GroupLevels\" or \"Sections\"), are there any .Count properties for them hidden elsewhere..? Or does a programmer simply have to follow the conceptual logic and iterate through .GroupLevel(n) or .Section(n) until a runtime error occurs to indicate \"n\" doesn't exist..? </p>\n"}, {"tags": ["xml", "vba", "excel"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1528321574, "post_id": 50729728, "comment_id": 88467868, "body": "Have you tried <code>GroupChangesExcel</code>? This might only be for 2010 or later....."}], "answers": [{"tags": [], "owner": {"reputation": 1320, "user_id": 1445339, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/cON94.jpg?s=128&g=1", "display_name": "Profex", "link": "https://stackoverflow.com/users/1445339/profex"}, "is_accepted": false, "score": 2, "last_activity_date": 1528327405, "last_edit_date": 1592644375, "creation_date": 1528325592, "answer_id": 50730713, "question_id": 50729728, "link": "https://stackoverflow.com/questions/50729728/id-like-to-hide-not-disable-protect-workbook-from-the-review-tab-in-command/50730713#50730713", "title": "I&#39;d like to hide (not disable) &#39;protect workbook&#39; from the review tab in command bar Excel (customUI)", "body": "<p>Did you read Ron's article on how to <a href=\"http://www.rondebruin.nl/win/s2/win016.htm\" rel=\"nofollow noreferrer\">Change built-in groups in the Ribbon in Excel 2007-2016</a></p>\n<blockquote>\n<p>It is not possible to add to or remove controls from built-in groups in the Ribbon. For example, the Format Painter button from the Home tab's Clipboard group cannot be removed from this group.</p>\n<p>But there is a way around this restriction. We can hide a built-in group and then duplicate it with RibbonX. And then we can modify our duplicate group anyway we want.</p>\n</blockquote>\n<p><strong>Question is what version of Excel are you using?</strong></p>\n<p><strong>There are sample files for 2007/2010 &amp; 2016 that replace all groups</strong></p>\n<p>You can also find a list of the idMso values for Excel 2007 <a href=\"https://msdn.microsoft.com/en-us/library/dd909393(v=office.12).aspx\" rel=\"nofollow noreferrer\">HERE</a> and\na Word document with the idMso values for Excel 2007 - 2013 <a href=\"http://interoperability.blob.core.windows.net/files/MS-CUSTOMUI/%5BMS-CUSTOMUI%5D-160715.docx\" rel=\"nofollow noreferrer\">[MS-CUSTOMUI]-160715</a></p>\n<p>Since I wanted to test it myself, I might as well share what I came up with (it's different from what is in the sample files, since I'm using Excel 2013 and Ron doesn't have it available)</p>\n<pre><code>&lt;customUI xmlns=&quot;http://schemas.microsoft.com/office/2006/01/customui&quot;&gt;\n&lt;ribbon&gt; \n&lt;tabs&gt;\n\n&lt;!-- Set visible to false for the Changes group on the Review tab--&gt;\n&lt;tab idMso=&quot;TabReview&quot;&gt; \n&lt;group idMso=&quot;GroupChangesExcel&quot; visible=&quot;false&quot;/&gt;  \n&lt;/tab&gt;\n\n\n&lt;!-- Point to the Built-in tab to the ribbon --&gt;\n&lt;tab idMso=&quot;TabReview&quot;&gt; \n\n&lt;!-- Add Changes group --&gt;\n&lt;group id=&quot;DupChanges&quot; label=&quot;Changes&quot; insertBeforeMso=&quot;GroupChangesExcel&quot; &gt;    \n    &lt;button idMso=&quot;SheetProtect&quot; size=&quot;large&quot;/&gt; \n    &lt;!-- button idMso=&quot;ReviewProtectWorkbook&quot; size=&quot;large&quot; / --&gt; \n    &lt;button idMso=&quot;ReviewShareWorkbook&quot; size=&quot;large&quot;/&gt;\n\n    &lt;button idMso=&quot;ReviewProtectAndShareWorkbook&quot; /&gt;\n    &lt;button idMso=&quot;ReviewAllowUsersToEditRanges&quot; /&gt;\n    &lt;menu idMso=&quot;ReviewTrackChangesMenu&quot; /&gt;\n&lt;/group&gt; \n\n&lt;/tab&gt;\n\n\n&lt;/tabs&gt; \n&lt;/ribbon&gt; \n&lt;/customUI&gt;\n</code></pre>\n<p>Depending on which CUI file <code>customUI.xml</code> (2007) vs <code>customUI14.xml</code> (2010) the <code>idMso</code> may change, which happens to be the case for the <code>Protect Workbook</code> button your asking about.  I just stick to the 2007, since I haven't had a need for any Backstage stuff yet.</p>\n"}], "owner": {"reputation": 35, "user_id": 2572478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf1a9169f93b84a83163d89cf02ee5bf?s=128&d=identicon&r=PG", "display_name": "JHS", "link": "https://stackoverflow.com/users/2572478/jhs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 397, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528327405, "creation_date": 1528319758, "question_id": 50729728, "link": "https://stackoverflow.com/questions/50729728/id-like-to-hide-not-disable-protect-workbook-from-the-review-tab-in-command", "title": "I&#39;d like to hide (not disable) &#39;protect workbook&#39; from the review tab in command bar Excel (customUI)", "body": "<p>Hi I'd like to hide the protect workbook button in the Excel ribbon (in the review  tab). I know this is possible by implementing a customUI. (As explained on <a href=\"http://www.rondebruin.nl/\" rel=\"nofollow noreferrer\">http://www.rondebruin.nl/</a> )</p>\n\n<p>I already found the idMso for this button and managed to disable it.</p>\n\n<p>idMso: ReviewRestrictEditing</p>\n\n<p>I had no succes in my attempts for hinding the button from the ribbon. This is what I have so far:</p>\n\n<pre><code>&lt;customUI xmlns=\"http://schemas.microsoft.com/office/2006/01/customui\"&gt;     \n&lt;ribbon&gt;\n\n&lt;tabs&gt;\n\n&lt;tab idMso=\"TabReview\" &gt;\n&lt;group idMso=\"?????????????\" &gt;\n    &lt;button idMso=\"ReviewRestrictEditing\" visible = \"false\" /&gt; \n&lt;/group&gt;\n&lt;/tab&gt;\n\n&lt;/tabs&gt;\n\n&lt;/ribbon&gt;\n&lt;/customUI&gt; \n</code></pre>\n\n<p>How can I find the group idMso? I went over a list for excel 2007, but haven't found the correct id yet.</p>\n"}, {"tags": ["vba", "ms-word", "highlight"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528321778, "post_id": 50729254, "comment_id": 88467941, "body": "What&#39;s the text of the error you get?"}, {"owner": {"reputation": 11, "user_id": 9905181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jq4YK-c_S2k/AAAAAAAAAAI/AAAAAAAAB3E/0XOpinH9BRI/photo.jpg?sz=128", "display_name": "Shane Mulholland", "link": "https://stackoverflow.com/users/9905181/shane-mulholland"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528328694, "post_id": 50729254, "comment_id": 88469918, "body": "@TimWilliams, The error is &quot;Runt0time error &#39;5610&#39;: The Find What text for a Find All Word Forms search can only contain alphabetic letter. My guess is that it is recognizing a space as non-alphabetic but I don&#39;t know how to resolve."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528329983, "post_id": 50729254, "comment_id": 88470246, "body": "I guess Word can&#39;t do query expansion for multi-word queries?  You may stuck with that."}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 1, "creation_date": 1528380299, "post_id": 50729254, "comment_id": 88494123, "body": "Do you <i>need</i> to search &quot;all word forms&quot;? This can only work with a word, not a phrase. You could have your code &quot;branch&quot; depending on whether a search term contains more than one word (a space), setting <code>MatchAllWordForms</code> to False when that&#39;s the case."}], "owner": {"reputation": 11, "user_id": 9905181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jq4YK-c_S2k/AAAAAAAAAAI/AAAAAAAAB3E/0XOpinH9BRI/photo.jpg?sz=128", "display_name": "Shane Mulholland", "link": "https://stackoverflow.com/users/9905181/shane-mulholland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1031, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528380116, "creation_date": 1528317673, "last_edit_date": 1528380116, "question_id": 50729254, "link": "https://stackoverflow.com/questions/50729254/how-to-use-vba-to-search-for-a-list-of-words-and-phrases-in-a-word-document-and", "title": "How to use VBA to search for a list of words and phrases in a Word document and highlight them?", "body": "<p>So I have a large list of words and phrases that should not be used in a word document. I would like to write a macro to search a document for these words and phrases and highlight them.</p>\n\n<p>So far I have found and edited some code to search for specific words and it'll highlight those:</p>\n\n<pre><code>Sub Find_Liability_Words()\n'\n' Find_Liability_Words Macro\n'\n'\nApplication.ScreenUpdating = False\nOptions.DefaultHighlightColorIndex = wdBrightGreen\nDim StrFnd As String, i As Long, StrRpt As String\n\n' Words to search for\nStrFnd = \"actually,administer,advise,affirmative,all,always\"\n\nWith ActiveDocument.Range.Find\n  .ClearFormatting\n  .Replacement.ClearFormatting\n  .Replacement.Highlight = True\n  .Forward = True\n  .Wrap = wdFindContinue\n  .Format = True\n  .MatchCase = False\n  .MatchWholeWord = True\n  .MatchWildcards = False\n  .MatchSoundsLike = False\n  .MatchAllWordForms = True\n  For i = 0 To UBound(Split(StrFnd, \",\"))\n    .Text = Split(StrFnd, \",\")(i)\n    .Replacement.Text = \"^&amp;\"\n    .Execute Replace:=wdReplaceAll\n    If .Found = True Then StrRpt = StrRpt &amp; vbCr &amp; Split(StrFnd, \",\")(i)\n  Next\nEnd With\nIf StrRpt = \"\" Then\n  MsgBox \"None of the terms were found.\", vbOKOnly\nElse\n  MsgBox \"The following terms were found:\" &amp; StrRpt, vbInformation\nEnd If\nApplication.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n\n<p>Now the issue is that this can only do words and shows an error when trying to find to words together (such as \"adequate number\"). I am wondering how to make it search for a phrase as well.</p>\n\n<p>In addition to this, the list of words and phrases I'd like to search for is long and could change so editing the code for this could be tedious. Is it possible to have this code refer to a text file or an excel sheet in order to find it's words and phrases?</p>\n\n<p>Thank you so much for any help!!</p>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1528318217, "post_id": 50729253, "comment_id": 88466520, "body": "Use the API instead? <a href=\"https://cloud.google.com/translate/\" rel=\"nofollow noreferrer\">cloud.google.com/translate</a>"}, {"owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "reply_to_user": {"reputation": 5304, "user_id": 4839827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/wAyix.jpg?s=128&g=1", "display_name": "Ryan Wildry", "link": "https://stackoverflow.com/users/4839827/ryan-wildry"}, "edited": false, "score": 0, "creation_date": 1528318492, "post_id": 50729253, "comment_id": 88466645, "body": "I&#39;ve got to do it not using API."}], "answers": [{"comments": [{"owner": {"reputation": 825, "user_id": 1898524, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/p6C9A.jpg?s=128&g=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1898524/ben"}, "edited": false, "score": 0, "creation_date": 1582123966, "post_id": 50730152, "comment_id": 106669586, "body": "The <code>result_box</code> is no longer included in Google translate results (~summer 2019) but this http request method does.  <a href=\"https://stackoverflow.com/a/47249553/1898524\">stackoverflow.com/a/47249553/1898524</a>"}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 1, "last_activity_date": 1528321931, "creation_date": 1528321931, "answer_id": 50730152, "question_id": 50729253, "link": "https://stackoverflow.com/questions/50729253/how-to-refer-to-google-translate-result-box-in-vba/50730152#50730152", "title": "How to refer to Google translate result box in VBA", "body": "<p>Non-input elements don't have a <code>Value</code> property.  Try:</p>\n\n<pre><code>.getElementByID(\"result_box\").innerText\n</code></pre>\n"}], "owner": {"reputation": 325, "user_id": 9640782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/777f5981ccbedfef10d48ccdebc34735?s=128&d=identicon&r=PG&f=1", "display_name": "Arkadiusz", "link": "https://stackoverflow.com/users/9640782/arkadiusz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 50730152, "answer_count": 1, "score": 0, "last_activity_date": 1528321931, "creation_date": 1528317671, "question_id": 50729253, "link": "https://stackoverflow.com/questions/50729253/how-to-refer-to-google-translate-result-box-in-vba", "title": "How to refer to Google translate result box in VBA", "body": "<p>I'd like to refer to Google translate result box in VBA. Here's my piece of code: Kom.Offset(0, 1).Value = .getElementByID(\"result_box\").Value but I receive an error that \"Object doesn't support this property or method\".</p>\n"}, {"tags": ["excel", "pivot-table", "vba"], "comments": [{"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 0, "creation_date": 1528319563, "post_id": 50729089, "comment_id": 88467135, "body": "Hello,  Do you want to do this on VBA? your question is not clear. If so that&#39;s easy, just a loop through the Pivot fields and comparing that with your selected one and returning the position in the loop. Please explain if you need help."}, {"owner": {"reputation": 804, "user_id": 4829915, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/cf430a1257828409df788e154a5c8dea?s=128&d=identicon&r=PG&f=1", "display_name": "LWC", "link": "https://stackoverflow.com/users/4829915/lwc"}, "reply_to_user": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 0, "creation_date": 1528398083, "post_id": 50729089, "comment_id": 88504401, "body": "Yes, VBA is tagged. How can you compare when the text values could be completely identical in different fields (for example, Yc=Yd?"}, {"owner": {"reputation": 462, "user_id": 6644572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9BxA5.jpg?s=128&g=1", "display_name": "Mahhdy", "link": "https://stackoverflow.com/users/6644572/mahhdy"}, "edited": false, "score": 0, "creation_date": 1528401776, "post_id": 50729089, "comment_id": 88506226, "body": "As Peter mentioned, I meant the relative position of the selected field. I fyou are looking for the pivotfield, that should be enough, isn&#39;t it?"}], "answers": [{"comments": [{"owner": {"reputation": 804, "user_id": 4829915, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/cf430a1257828409df788e154a5c8dea?s=128&d=identicon&r=PG&f=1", "display_name": "LWC", "link": "https://stackoverflow.com/users/4829915/lwc"}, "edited": false, "score": 0, "creation_date": 1528398327, "post_id": 50729736, "comment_id": 88504515, "body": "Like I wrote in a previous comment, different fields could have completely identical texts and your loop will just assume you want the first of them."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "reply_to_user": {"reputation": 804, "user_id": 4829915, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/cf430a1257828409df788e154a5c8dea?s=128&d=identicon&r=PG&f=1", "display_name": "LWC", "link": "https://stackoverflow.com/users/4829915/lwc"}, "edited": false, "score": 0, "creation_date": 1528398590, "post_id": 50729736, "comment_id": 88504625, "body": "In your example of Yc=Yd, the position is still =2. Doesn&#39;t matter which is picked up, the answer is still correct. Unless you&#39;re saying Yc=Ze ?"}], "tags": [], "owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "is_accepted": false, "score": 1, "last_activity_date": 1528319805, "creation_date": 1528319805, "answer_id": 50729736, "question_id": 50729089, "link": "https://stackoverflow.com/questions/50729089/can-a-pivotfield-position-be-determined-from-a-selection/50729736#50729736", "title": "Can a PivotField position be determined from a Selection?", "body": "<p>The key is to make sure you're in the right range. Review Jon Peltier's excellent page on <a href=\"https://peltiertech.com/referencing-pivot-table-ranges-in-vba/\" rel=\"nofollow noreferrer\">pivot table ranges</a>. In your case, you want to restrict your cell selection to <code>RowFields</code>. The path to figuring out which position is to back out from which <code>Item</code> in which <code>Field</code>...</p>\n\n<pre><code>Option Explicit\n\nSub WhatPosition()\n    Dim pt As PivotTable\n    Set pt = ActiveSheet.PivotTables(1)\n\n    Debug.Print \"current cell selection is \" &amp; Selection.Address &amp; _\n                \" = '\" &amp; Selection.value &amp; \"'\"\n\n    '--- is the selection within the row label range of the pivot table?\n    If Not Intersect(Selection, pt.RowRange) Is Nothing Then\n        Debug.Print \"selection position = \" &amp; StringToPivotFieldPosition(pt, Selection.value)\n    Else\n        Debug.Print \"the selection is not within the pivot table\"\n    End If\nEnd Sub\n\nPrivate Function StringToPivotFieldPosition(ByRef pTable As PivotTable, _\n                                            ByVal value As String) As Long\n    Dim field As PivotField\n    StringToPivotFieldPosition = 0\n    For Each field In pTable.RowFields\n        Dim item As PivotItem\n        For Each item In field.PivotItems\n            If item.Name = value Then\n                StringToPivotFieldPosition = field.position\n                Exit Function\n            End If\n        Next item\n    Next field\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 804, "user_id": 4829915, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/cf430a1257828409df788e154a5c8dea?s=128&d=identicon&r=PG&f=1", "display_name": "LWC", "link": "https://stackoverflow.com/users/4829915/lwc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 705, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528319805, "creation_date": 1528317061, "last_edit_date": 1531164843, "question_id": 50729089, "link": "https://stackoverflow.com/questions/50729089/can-a-pivotfield-position-be-determined-from-a-selection", "title": "Can a PivotField position be determined from a Selection?", "body": "<p>If I select one of the PivotFields in the following PivotTable, is there a way to determine its position? For example, selecting Yc and deducing the position is 2.</p>\n\n<pre><code>Xa\n---- Yb\n---- Yc\n-------- Za\n-------- Zb\n-------- Zc\nXb\n---- Yd\n-------- Ze\n-------- Z5\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 2, "creation_date": 1528317196, "post_id": 50729081, "comment_id": 88466075, "body": "&quot;3:&quot; &amp; a (comment too short)"}, {"owner": {"reputation": 203, "user_id": 5604992, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gJmKxWWa60M/AAAAAAAAAAI/AAAAAAAAACs/odUcy1775-Y/photo.jpg?sz=128", "display_name": "Rowling", "link": "https://stackoverflow.com/users/5604992/rowling"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1528317497, "post_id": 50729081, "comment_id": 88466217, "body": "ThisWorkbook.Worksheets(&quot;Fleet Report&quot;).Rows(&quot;3&quot; &amp; a).EntireRow.Delete; there is no error, but it didn&#39;t  delete the rows"}], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 9825319, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zYs7i.png?s=128&g=1", "display_name": "Matt Gaydon", "link": "https://stackoverflow.com/users/9825319/matt-gaydon"}, "is_accepted": false, "score": 2, "last_activity_date": 1528317439, "creation_date": 1528317439, "answer_id": 50729193, "question_id": 50729081, "link": "https://stackoverflow.com/questions/50729081/delete-rows-from-a2-to-the-end-of-the-column-in-vba/50729193#50729193", "title": "Delete rows from A2 to the end of the column in VBA", "body": "<p>Your line of code for deleting is incorrectly written. It reads:</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Fleet Report\").Rows(\"3:a\").EntireRow.Delete\n</code></pre>\n\n<p>When it should say:</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Fleet Report\").Rows(\"3:\" &amp; a).EntireRow.Delete\n</code></pre>\n\n<p>Also to avoid row and column numbers, which I personally am not a fan of, you could format it as:</p>\n\n<pre><code>ThisWorkbook.Worksheets(\"Fleet Report\").Range(\"A3:A\" &amp; a).EntireRow.Delete\n</code></pre>\n\n<p>Hope this helps!</p>\n"}, {"comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1528317929, "post_id": 50729276, "comment_id": 88466404, "body": "&quot;Try this: {code dump}&quot; are rather poor answers IMO. Why not take 2 seconds to <a href=\"https://stackoverflow.com/posts/50729276/edit\">edit</a> your post and spell out what the solution is and why it works, instead of encouraging blind copy-pasta coding?"}, {"owner": {"reputation": 664, "user_id": 1285979, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/embHN.jpg?s=128&g=1", "display_name": "L0uis", "link": "https://stackoverflow.com/users/1285979/l0uis"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528318179, "post_id": 50729276, "comment_id": 88466503, "body": "Because 2 other people post answers before I can get a chance to try and answer. My code types the objects first, then sets them individually, one at a time, so the original poster can step through his code and see each line execute."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1528318387, "post_id": 50729276, "comment_id": 88466599, "body": "Protip: other answers don&#39;t matter if yours is better ;-) ..also you can always <a href=\"https://stackoverflow.com/posts/50729276/edit\">edit</a> it after it&#39;s posted."}, {"owner": {"reputation": 664, "user_id": 1285979, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/embHN.jpg?s=128&g=1", "display_name": "L0uis", "link": "https://stackoverflow.com/users/1285979/l0uis"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528377213, "post_id": 50729276, "comment_id": 88491823, "body": "I will try that! : )"}], "tags": [], "owner": {"reputation": 664, "user_id": 1285979, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/embHN.jpg?s=128&g=1", "display_name": "L0uis", "link": "https://stackoverflow.com/users/1285979/l0uis"}, "is_accepted": false, "score": 0, "last_activity_date": 1528317752, "creation_date": 1528317752, "answer_id": 50729276, "question_id": 50729081, "link": "https://stackoverflow.com/questions/50729081/delete-rows-from-a2-to-the-end-of-the-column-in-vba/50729276#50729276", "title": "Delete rows from A2 to the end of the column in VBA", "body": "<p>Try this:</p>\n\n<pre><code>Sub Ticket()\nDim a As Long\nDim WB As Workbook, WS As Worksheet\n\n\n\nSet WB = ActiveWorkbook\nSet WS = WB.Worksheets(\"Fleet Report\")\nApplication.Calculation = xlManual\na = WS.Range(\"A2\").End(xlDown).Row\n\n\nMsgBox \"Last Row is \" &amp; a\n</code></pre>\n"}], "owner": {"reputation": 203, "user_id": 5604992, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-gJmKxWWa60M/AAAAAAAAAAI/AAAAAAAAACs/odUcy1775-Y/photo.jpg?sz=128", "display_name": "Rowling", "link": "https://stackoverflow.com/users/5604992/rowling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1297, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528317752, "creation_date": 1528317010, "last_edit_date": 1531164843, "question_id": 50729081, "link": "https://stackoverflow.com/questions/50729081/delete-rows-from-a2-to-the-end-of-the-column-in-vba", "title": "Delete rows from A2 to the end of the column in VBA", "body": "<p>I am try to come up a code in VBA the will delete from A2(row 2) to the end of rows</p>\n\n<pre><code>Option Explicit\nSub Ticket()\n    Dim a As Long\n    Application.Calculation = xlManual\n\n    a = ThisWorkbook.Worksheets(\"Fleet Report\").Range(\"A2\").End(xlDown).Row\n    MsgBox \"Last Row is \" &amp; a\n\n    ThisWorkbook.Worksheets(\"Fleet Report\").Rows(\"3:a\").EntireRow.Delete\n\nEnd Sub\n</code></pre>\n\n<p>But I got error message: type mismatch. Does anyone has an idea?</p>\n\n<p><a href=\"https://i.stack.imgur.com/poxI1.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/poxI1.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "ms-word", "wsh"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1528317324, "post_id": 50728970, "comment_id": 88466131, "body": "You say this is Word VBA - sor are you trying to quit Word? If so why are you trying to use <code>Wscript</code> to quit?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 1, "creation_date": 1528317667, "post_id": 50728970, "comment_id": 88466288, "body": "@dbmitch more likely a copy-pasted snippet from some VBScript sample."}, {"owner": {"reputation": 11, "user_id": 9905181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jq4YK-c_S2k/AAAAAAAAAAI/AAAAAAAAB3E/0XOpinH9BRI/photo.jpg?sz=128", "display_name": "Shane Mulholland", "link": "https://stackoverflow.com/users/9905181/shane-mulholland"}, "reply_to_user": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1528317860, "post_id": 50728970, "comment_id": 88466375, "body": "@dbmitch, sorry! I am inexperienced with coding and am just learning. I found this code from a different source and I am trying to make it work for me. I didn&#39;t realize this was the wrong thing to use!"}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1528318077, "post_id": 50728970, "comment_id": 88466466, "body": "&quot;Access denied&quot; is not an appropriate title to match your MsgBox question either"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9905181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jq4YK-c_S2k/AAAAAAAAAAI/AAAAAAAAB3E/0XOpinH9BRI/photo.jpg?sz=128", "display_name": "Shane Mulholland", "link": "https://stackoverflow.com/users/9905181/shane-mulholland"}, "edited": false, "score": 0, "creation_date": 1528318169, "post_id": 50729198, "comment_id": 88466501, "body": "Thank you! Removing &#39;Wscript.Quit&#39; resolved the issue!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "reply_to_user": {"reputation": 11, "user_id": 9905181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jq4YK-c_S2k/AAAAAAAAAAI/AAAAAAAAB3E/0XOpinH9BRI/photo.jpg?sz=128", "display_name": "Shane Mulholland", "link": "https://stackoverflow.com/users/9905181/shane-mulholland"}, "edited": false, "score": 0, "creation_date": 1528318191, "post_id": 50729198, "comment_id": 88466511, "body": "@ShaneMulholland and adding <code>Option Explicit</code> in every module will prevent many more ;-)"}], "tags": [], "owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "is_accepted": true, "score": 0, "last_activity_date": 1528317459, "creation_date": 1528317459, "answer_id": 50729198, "question_id": 50728970, "link": "https://stackoverflow.com/questions/50728970/wscript-quit-gives-error-424-in-vba-for-word/50729198#50729198", "title": "Wscript.Quit gives error 424 in VBA for word", "body": "<p><code>WScript</code> is a VBScript object. You're writing VBA code. Remove the instruction altogether, <code>WScript</code> is undefined and means nothing.</p>\n\n<p>You're getting that error because, in your code, <code>WScript</code> is a <code>Variant/Empty</code>, only because <code>Option Explicit</code> is missing from the top of your module, which allows VBA code to compile &amp; run without validating that every variable is properly declared (this means typos happily compile &amp; run as well) - in other words it's an undeclared variable, and since you're making a member call on it, per VBA syntax this could only be an object... except it isn't, hence \"Object required\".</p>\n\n<ul>\n<li>Remote the instruction.</li>\n<li>Add <code>Option Explicit</code> to the top of your module</li>\n<li>Declare all variables. Look into how to use the <code>Dim</code> statement.</li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 9905181, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Jq4YK-c_S2k/AAAAAAAAAAI/AAAAAAAAB3E/0XOpinH9BRI/photo.jpg?sz=128", "display_name": "Shane Mulholland", "link": "https://stackoverflow.com/users/9905181/shane-mulholland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 50729198, "answer_count": 1, "score": 0, "last_activity_date": 1528380052, "creation_date": 1528316638, "last_edit_date": 1528380052, "question_id": 50728970, "link": "https://stackoverflow.com/questions/50728970/wscript-quit-gives-error-424-in-vba-for-word", "title": "Wscript.Quit gives error 424 in VBA for word", "body": "<p>I am writing some code in VBA for Word to redirect users to a link if they would like to or to close the window if not using a yes/no box. The problem is that if the user does not want to continue to the link, the code gives an <strong>error 424: Object required</strong>.</p>\n\n<pre><code>Set objShell = CreateObject(\"Wscript.Shell\")\nintMessage = MsgBox(\"Would you like to read about alternatives to these words?\", vbYesNo, \"Access Denied\")\nIf intMessage = vbYes Then\nobjShell.Run (\"LINK\")\nElse\nWscript.Quit\nEnd If\n</code></pre>\n\n<p><strong>The Error 424 highlights 'Wscript.Quit'</strong> when I debug the error.\nHow to I resolve this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 1472, "user_id": 1726522, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/0DUTN.gif?s=128&g=1", "display_name": "CMArg", "link": "https://stackoverflow.com/users/1726522/cmarg"}, "is_accepted": true, "score": 0, "last_activity_date": 1528329595, "creation_date": 1528329595, "answer_id": 50731241, "question_id": 50728612, "link": "https://stackoverflow.com/questions/50728612/pasting-data-into-next-empty-column-using-vba/50731241#50731241", "title": "Pasting data into next empty column using vba", "body": "<p><em>Not tested</em></p>\n\n<pre><code>Sub CopyData(OldWB As Worksheet, NewWB As Worksheet)\n    Dim title As Range\n    Dim lColumn As Long\n\n    With OldWB.Rows(1)\n        Set title = .Find(\"direction\")\n        If title Is Nothing Then Set title = .Find(\"instruction\")\n    End With\n\n    'Get last used column, and add 1 (for next one)\n    lColumn = NewWB.Cells(1, Columns.Count).End(xlToLeft).Column + 1\n\n    If Not title Is Nothing Then\n        title.EntireColumn.Copy\n        NewWB.Cells(1, lColumn).PasteSpecial (xlPasteValues)\n        Application.CutCopyMode = xlCopy\n        NewWB.Columns(lColumn).RemoveDuplicates Columns:=1, Header:=xlNo\n        Selection.SpecialCells(xlCellTypeBlanks).Select\n        Selection.Delete Shift:=xlUp\n        NewWB.Columns.AutoFit\n    Else\n        MsgBox \"Error\"\n    End If\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 9898719, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Soso", "link": "https://stackoverflow.com/users/9898719/soso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 50731241, "answer_count": 1, "score": 0, "last_activity_date": 1528375590, "creation_date": 1528315220, "last_edit_date": 1531164843, "question_id": 50728612, "link": "https://stackoverflow.com/questions/50728612/pasting-data-into-next-empty-column-using-vba", "title": "Pasting data into next empty column using vba", "body": "<p>I'm really new to VBA so this is some code that I found online and combined.\nRight now there are 3 parts (the last part isn't that important to my question). The first part \"compile\" loops through all the files in a folder and calls the second part \"copydata\" which copies data under columns with the header \"direction\" or \"instruction\" and pastes it into a new sheet \"Summary\". Right now it pastes the new data into the first column but the new data gets overwritten every time a new file is opened. How can I update my code so that every time a file is opened, the new data is put into the next empty column. </p>\n"}, {"tags": ["excel", "sap-gui", "vba"], "answers": [{"tags": [], "owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "is_accepted": false, "score": 1, "last_activity_date": 1528383843, "creation_date": 1528383843, "answer_id": 50744534, "question_id": 50728470, "link": "https://stackoverflow.com/questions/50728470/input-data-from-excel-to-sap-gui-then-output-specific-row-and-column-back-to-exc/50744534#50744534", "title": "Input data from excel to SAP GUI then output specific row and column back to excel", "body": "<p>Instead of </p>\n\n<pre><code>If InStr(StatusBarText, \" does not exist\") Then\n  GoTo NextIteration\nEnd If\n\nNextIteration:\n</code></pre>\n\n<p>Do something like that</p>\n\n<pre><code>If InStr(StatusBarText, \" does not exist\") Then\n  ' Do nothing \nelse\n   ' Do your stuff here\nEnd If\n</code></pre>\n\n<p>and remove the label <code>NextIteration:</code></p>\n\n<p>PS You seem to miss basic programming knowledge so you might have a look <a href=\"https://excelmacromastery.com/vba-articles/\" rel=\"nofollow noreferrer\">here</a> or other sites for beginners</p>\n"}], "owner": {"reputation": 9, "user_id": 9905387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfaf5f7d99a020d193704a37b7a0d578?s=128&d=identicon&r=PG&f=1", "display_name": "cynthiatmi", "link": "https://stackoverflow.com/users/9905387/cynthiatmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1528383843, "creation_date": 1528314635, "last_edit_date": 1531164843, "question_id": 50728470, "link": "https://stackoverflow.com/questions/50728470/input-data-from-excel-to-sap-gui-then-output-specific-row-and-column-back-to-exc", "title": "Input data from excel to SAP GUI then output specific row and column back to excel", "body": "<p><em>Initial question is at the bottom</em></p>\n\n<p>UPDATE:</p>\n\n<p>Here is what I'm working with so far, but it gives me error 619 because SAP isn't returning data when the notification number isn't found.</p>\n\n<pre><code>Sub QM03()\n\nSet SapGuiAuto = GetObject(\"SAPGUI\")  'Get the SAP GUI Scripting object\nSet SAPApp = SapGuiAuto.GetScriptingEngine 'Get the currently running SAP GUI\nSet SAPCon = SAPApp.Children(0) 'Get the first system that is currently connected\nSet session = SAPCon.Children(0) 'Get the first session (window) on that connection\n</code></pre>\n\n<p>'Start the transaction to view a table\n    session.StartTransaction \"QM03\"</p>\n\n<pre><code>Dim rngNotificationNumbers As Range\nSet rngNotificationNumbers = Range(\"A4:A704\")\nDim arrNotificationNumbers(700) As String\nDim cell As Range\nDim i As Long\ni = 0\n\nFor i = 0 To UBound(arrNotificationNumbers) - 1\nsession.FindById(\"wnd[0]/usr/ctxtRIWO00-QM03\").Text = arrNotificationNumbers(i)\nsession.FindById(\"wnd[0]\").SendVKey 0\nStatusBarText = session.FindById(\"wnd[0]/sbar/pane[0]\").Text\nIf InStr(StatusBarText, \" does not exist\") Then\n  GoTo NextIteration\nEnd If\n\nNextIteration:\nNext\n\nEnd Sub\n</code></pre>\n\n<p>`</p>\n\n<p>***I'm new to SAP and VBA, but I really need some help with it!</p>\n\n<p>I'm trying to take notification numbers from an excel sheet, input it into QM03, and from there go to 'Items' to output the 'Defect type' to excel and then go to 'Item Task', in the row with the task code P020, and output the 'Task Text' to excel.</p>\n\n<p>If the notification number is not found, I'd want to skip it and move on to the next one.</p>\n\n<p>I'm using SAP GUI for Windows.</p>\n\n<p>I'd truly appreciate any help! Thank you!***</p>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "edited": false, "score": 0, "creation_date": 1528397589, "post_id": 50728378, "comment_id": 88504176, "body": "If you try sorting in the UI there is a &quot;You cannot sort by this field.&quot; message. You may have to write your own sort program."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9899750, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bfRE7HrITtQ/AAAAAAAAAAI/AAAAAAAACWE/n9okHnLypRs/photo.jpg?sz=128", "display_name": "Steve Lee", "link": "https://stackoverflow.com/users/9899750/steve-lee"}, "is_accepted": false, "score": 0, "last_activity_date": 1528718922, "creation_date": 1528718922, "answer_id": 50797389, "question_id": 50728378, "link": "https://stackoverflow.com/questions/50728378/sorting-outlook-tasks-by-user-defined-field-in-vba/50797389#50797389", "title": "Sorting Outlook tasks by user-defined field in VBA", "body": "<p>Thanks for the comment, niton.  </p>\n\n<p>I've solved the problem.  I'm posting it here in case anyone has been having the same issue.  </p>\n\n<p>I don't know why, but the sort just wont work with a user-defined field when using an Items object.  However...I got it to work fine while using the Table object! :) Check out the new code below.</p>\n\n<pre><code>Sub TestSort()\n    Dim ToDoFolder As Folder\n    Dim Task As TaskItem\n    Dim Sel As Outlook.Table\n    Dim InitStartTime As Date\n    Dim RemindTime As Date\n    Dim FilterString As String\n    Dim oCol As Outlook.Column\n\n'FORCE CHANGE CURRENT FOLDER TO BE \"TO DO LIST\" AND VIEW TO BE \"Debug (Filter:TEST)\"\n    Set ToDoFolder = Session.GetDefaultFolder(olFolderToDo)\n    Set Application.ActiveExplorer.CurrentFolder = ToDoFolder\n    ToDoFolder.Views.Item(\"Debug (Filter:TEST)\").Apply\n\n'AUTOMATICALLY SELECT TASK ITEMS TO BE WORKED WITH\n\n    FilterString = \"@SQL=\" &amp; ToDoFolder.Views.Item(\"Debug (Filter:TEST)\").Filter\n    Set Sel = ToDoFolder.GetTable(FilterString)\n\n'CHECK DEFAULT COLUMNS\n    For i = 1 To Sel.Columns.Count\n        Set oColumn = Sel.Columns.Item(i)\n        Debug.Print oColumn.Name\n    Next i\n\n'ADD COLUMN FOR USER-DEFINED FIELD \"SEQ\"\n    Sel.Columns.Add (\"Seq\")\n\n'SHOW ORIGINAL SORTING\n    Debug.Print Chr(13); \"Sort by Original\"\n\n    Call CheckSortTable(Sel)\n\n'SORT TASKS IN MY SELECTION (AND CHECK SORT)\n\n    Sel.Sort \"[Seq]\", False\n    Debug.Print Chr(13); \"Sort by Seq Ascending\"\n    Call CheckSortTable(Sel)\n\n    Sel.Sort \"[Seq]\", True\n    Debug.Print Chr(13); \"Sort by Seq Descending\"\n    Call CheckSortTable(Sel)\n\n    Sel.Sort \"[DueDate]\", False\n    Debug.Print Chr(13); \"Sort by DueDate Ascending\"\n    Call CheckSortTable(Sel)\n\n    Sel.Sort \"[DueDate]\", True\n    Debug.Print Chr(13); \"Sort by DueDate Descending\"\n    Call CheckSortTable(Sel)\n\nEnd Sub\n\nSub CheckSortTable(oTable As Outlook.Table)\n\n    Dim Task As Outlook.Row\n\n'CHECK THAT IT WAS SORTED CORRECTLY\n\n    Debug.Print Chr(13);\n    Do Until (oTable.EndOfTable)\n        Set Task = oTable.GetNextRow()\n        Seq = Task(\"Seq\")\n        Debug.Print (Seq &amp; \" \" &amp; Task(\"Subject\") &amp; \" \" &amp; Task(\"DueDate\"))\n    Loop\nEnd Sub\n</code></pre>\n\n<p>...and the new output...</p>\n\n<pre><code>EntryID\nSubject\nCreationTime\nLastModificationTime\nMessageClass\nDueDate\nPercentComplete\nIsRecurring\n\nSort by Original\n\n2 Test_1 6/8/2018\n4 Test_2 6/10/2018\n1 Test_3 6/8/2018\n3 Test_4 6/10/2018\n\nSort by Seq Ascending\n\n1 Test_3 6/8/2018\n2 Test_1 6/8/2018\n3 Test_4 6/10/2018\n4 Test_2 6/10/2018\n\nSort by Seq Descending\n\n4 Test_2 6/10/2018\n3 Test_4 6/10/2018\n2 Test_1 6/8/2018\n1 Test_3 6/8/2018\n\nSort by DueDate Ascending\n\n2 Test_1 6/8/2018\n1 Test_3 6/8/2018\n4 Test_2 6/10/2018\n3 Test_4 6/10/2018\n\nSort by DueDate Descending\n\n4 Test_2 6/10/2018\n3 Test_4 6/10/2018\n2 Test_1 6/8/2018\n1 Test_3 6/8/2018\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9899750, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bfRE7HrITtQ/AAAAAAAAAAI/AAAAAAAACWE/n9okHnLypRs/photo.jpg?sz=128", "display_name": "Steve Lee", "link": "https://stackoverflow.com/users/9899750/steve-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1592986420, "creation_date": 1528314304, "last_edit_date": 1592986420, "question_id": 50728378, "link": "https://stackoverflow.com/questions/50728378/sorting-outlook-tasks-by-user-defined-field-in-vba", "title": "Sorting Outlook tasks by user-defined field in VBA", "body": "<p>I'm trying to sort my tasks by a user-defined field that I call \"Seq\". When I do this with VBA it seems to do nothing.  However, this works perfectly fine when sorting by default fields, like DueDate.  Does anyone have a solution?  I am including my code and results.  I'm using Outlook 2010. Thanks in advance!</p>\n\n<p>Here is the code: </p>\n\n<pre><code>Sub TestSort()\n    Dim ToDoFolder As Folder\n    Dim Task As TaskItem\n    Dim Sel As Outlook.Items\n    Dim InitStartTime As Date\n    Dim RemindTime As Date\n    Dim FilterString As String\n\n'FORCE CHANGE CURRENT FOLDER TO BE \"TO DO LIST\" AND VIEW TO BE \"Debug (Filter:TEST)\"\n    Set ToDoFolder = Session.GetDefaultFolder(olFolderToDo)\n    Set Application.ActiveExplorer.CurrentFolder = ToDoFolder\n    ToDoFolder.Views.Item(\"Debug (Filter:TEST)\").Apply\n\n'AUTOMATICALLY SELECT TASK ITEMS TO BE WORKED WITH\n\n    FilterString = \"@SQL=\" &amp; ToDoFolder.Views.Item(\"Debug (Filter:TEST)\").Filter\n    Set Sel = ToDoFolder.Items.Restrict(FilterString)\n\n'SHOW ORIGINAL SORTING\n    Debug.Print Chr(13); \"Sort by Original\"\n    Call CheckSort(Task, Sel)\n\n'SORT TASKS IN MY SELECTION (AND CHECK SORT)\n\n    Sel.Sort \"[Seq]\", False\n    Debug.Print Chr(13); \"Sort by Seq Ascending\"\n    Call CheckSort(Task, Sel)\n\n    Sel.Sort \"[Seq]\", True\n    Debug.Print Chr(13); \"Sort by Seq Descending\"\n    Call CheckSort(Task, Sel)\n\n    Sel.Sort \"[DueDate]\", False\n    Debug.Print Chr(13); \"Sort by DueDate Ascending\"\n    Call CheckSort(Task, Sel)\n\n    Sel.Sort \"[DueDate]\", True\n    Debug.Print Chr(13); \"Sort by DueDate Descending\"\n    Call CheckSort(Task, Sel)\n\nEnd Sub\n\nSub CheckSort(Task As Outlook.TaskItem, Sel As Outlook.Items)\n\n'CHECK THAT IT WAS SORTED CORRECTLY\n\n    Debug.Print Chr(13);\n    For Each Task In Sel\n        Seq = Task.UserProperties.Find(\"Seq\").Value\n        Debug.Print Seq &amp; \" \" &amp; Task.Subject &amp; \" \" &amp; Task.DueDate\n    Next Task\nEnd Sub\n</code></pre>\n\n<p>Here are the results:</p>\n\n<pre><code>Sort by Original\n\n2 Test 1 6/6/2018\n4 Test 2 6/8/2018\n1 Test 3 6/10/2018\n3 Test 4 6/9/2018\n\nSort by Seq Ascending\n\n2 Test 1 6/6/2018\n4 Test 2 6/8/2018\n1 Test 3 6/10/2018\n3 Test 4 6/9/2018\n\nSort by Seq Descending\n\n2 Test 1 6/6/2018\n4 Test 2 6/8/2018\n1 Test 3 6/10/2018\n3 Test 4 6/9/2018\n\nSort by DueDate Ascending\n\n2 Test 1 6/6/2018\n4 Test 2 6/8/2018\n3 Test 4 6/9/2018\n1 Test 3 6/10/2018\n\nSort by DueDate Descending\n\n1 Test 3 6/10/2018\n3 Test 4 6/9/2018\n4 Test 2 6/8/2018\n2 Test 1 6/6/2018\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 21742, "user_id": 4650297, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/x1byc.jpg?s=128&g=1", "display_name": "BruceWayne", "link": "https://stackoverflow.com/users/4650297/brucewayne"}, "edited": false, "score": 0, "creation_date": 1528314766, "post_id": 50728325, "comment_id": 88464961, "body": "Instead of posting the code you&#39;re working with as an Answer, please edit it in to your original post. Edit: Why this double post? This is exactly your other question, without any additional information or apparent difference.  Are you trying to ask about the code you&#39;ve posted? Can you please clarify any difference? Is there a question or are you simply posting the code?  Also &quot;...it doesn&#39;t seem to work&quot; doesn&#39;t help us in troubleshooting anything. <i>How</i> doesn&#39;t it work?"}, {"owner": {"reputation": 4164, "user_id": 7132300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb1ef2cdd4c48a1a36e8395bf0d17431?s=128&d=identicon&r=PG&f=1", "display_name": "algrid", "link": "https://stackoverflow.com/users/7132300/algrid"}, "edited": false, "score": 0, "creation_date": 1528316139, "post_id": 50728325, "comment_id": 88465615, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/50663504/sorting-a-range-of-values-correctly-in-vba\">Sorting a range of values correctly in vba</a>"}], "owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 76, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528351874, "creation_date": 1528314109, "last_edit_date": 1528351874, "question_id": 50728325, "link": "https://stackoverflow.com/questions/50728325/sorting-a-range-of-values-correctly", "title": "Sorting a range of values correctly", "body": "<p>The code for the question \"Sorting a range of values correctly in VBA\" is below:</p>\n\n<pre><code>'Legend\nWorksheets(1).Range(\"U1\").Value = \"Legend\"\nWorksheets(1).Range(\"U1:V1\").Merge\n\n'Classified Cases in Ranges\nWorksheets(1).Range(\"U2:V2\").Merge\nWorksheets(1).Range(\"U2\").Value = \"Classified Cases in Ranges\"\n\n'Format the Legend\nWorksheets(1).Range(\"U3:U40\").NumberFormat = \"@\"\nWorksheets(1).Range(\"V3:V40\").NumberFormat = \"@\"\n\n'Legend values\nWorksheets(1).Range(\"U3\").Value = 0\nWorksheets(1).Range(\"U4\").Value = 1\nWorksheets(1).Range(\"U5\").Value = 2\nWorksheets(1).Range(\"U6\").Value = 3\nWorksheets(1).Range(\"U7\").Value = 4\nWorksheets(1).Range(\"U8\").Value = 5\nWorksheets(1).Range(\"U9\").Value = 6\nWorksheets(1).Range(\"U10\").Value = 7\nWorksheets(1).Range(\"U11\").Value = 8\nWorksheets(1).Range(\"U12\").Value = 9\nWorksheets(1).Range(\"U13\").Value = 10\nWorksheets(1).Range(\"U14\").Value = 11\nWorksheets(1).Range(\"U15\").Value = 12\nWorksheets(1).Range(\"U16\").Value = 13\nWorksheets(1).Range(\"U17\").Value = 14\nWorksheets(1).Range(\"U18\").Value = 15\nWorksheets(1).Range(\"U19\").Value = 16\nWorksheets(1).Range(\"U20\").Value = 17\nWorksheets(1).Range(\"U21\").Value = 18\nWorksheets(1).Range(\"U22\").Value = 19\nWorksheets(1).Range(\"U23\").Value = 20\nWorksheets(1).Range(\"U24\").Value = 21\nWorksheets(1).Range(\"U25\").Value = 22\nWorksheets(1).Range(\"U26\").Value = 23\nWorksheets(1).Range(\"U27\").Value = 24\nWorksheets(1).Range(\"U28\").Value = 25\nWorksheets(1).Range(\"U29\").Value = 26\nWorksheets(1).Range(\"U30\").Value = 27\nWorksheets(1).Range(\"U31\").Value = 28\nWorksheets(1).Range(\"U32\").Value = 29\nWorksheets(1).Range(\"U33\").Value = 30\nWorksheets(1).Range(\"U34\").Value = 31\nWorksheets(1).Range(\"U35\").Value = 32\nWorksheets(1).Range(\"U36\").Value = 33\nWorksheets(1).Range(\"U37\").Value = 34\nWorksheets(1).Range(\"U38\").Value = 35\nWorksheets(1).Range(\"U39\").Value = 36\nWorksheets(1).Range(\"U40\").Value = \"(blank)\"\n\n'Classified Cases in Ranges values\nWorksheets(1).Range(\"V3\").Value = \"0-9\"\nWorksheets(1).Range(\"V4\").Value = \"10-19\"\nWorksheets(1).Range(\"V5\").Value = \"20-29\"\nWorksheets(1).Range(\"V6\").Value = \"30-39\"\nWorksheets(1).Range(\"V7\").Value = \"40-49\"\nWorksheets(1).Range(\"V8\").Value = \"50-59\"\nWorksheets(1).Range(\"V9\").Value = \"60-69\"\nWorksheets(1).Range(\"V10\").Value = \"70-79\"\nWorksheets(1).Range(\"V11\").Value = \"80-89\"\nWorksheets(1).Range(\"V12\").Value = \"90-99\"\nWorksheets(1).Range(\"V13\").Value = \"100-109\"\nWorksheets(1).Range(\"V14\").Value = \"110-119\"\nWorksheets(1).Range(\"V15\").Value = \"120-129\"\nWorksheets(1).Range(\"V16\").Value = \"130-139\"\nWorksheets(1).Range(\"V17\").Value = \"140-149\"\nWorksheets(1).Range(\"V18\").Value = \"150-159\"\nWorksheets(1).Range(\"V19\").Value = \"160-169\"\nWorksheets(1).Range(\"V20\").Value = \"170-179\"\nWorksheets(1).Range(\"V21\").Value = \"180-189\"\nWorksheets(1).Range(\"V22\").Value = \"190-199\"\nWorksheets(1).Range(\"V23\").Value = \"200-209\"\nWorksheets(1).Range(\"V24\").Value = \"210-219\"\nWorksheets(1).Range(\"V25\").Value = \"220-229\"\nWorksheets(1).Range(\"V26\").Value = \"230-239\"\nWorksheets(1).Range(\"V27\").Value = \"240-249\"\nWorksheets(1).Range(\"V28\").Value = \"250-259\"\nWorksheets(1).Range(\"V29\").Value = \"260-269\"\nWorksheets(1).Range(\"V30\").Value = \"270-279\"\nWorksheets(1).Range(\"V31\").Value = \"280-289\"\nWorksheets(1).Range(\"V32\").Value = \"290-299\"\nWorksheets(1).Range(\"V33\").Value = \"300-309\"\nWorksheets(1).Range(\"V34\").Value = \"310-319\"\nWorksheets(1).Range(\"V35\").Value = \"320-329\"\nWorksheets(1).Range(\"V36\").Value = \"330-339\"\nWorksheets(1).Range(\"V37\").Value = \"340-349\"\nWorksheets(1).Range(\"V38\").Value = \"350-359\"\nWorksheets(1).Range(\"V39\").Value = \"&gt;=360\"\nWorksheets(1).Range(\"V40\").Value = \"(blank)\"\n\n\n'***************************************************\n'***************************************************\n'***************************************************\n\n'Move to US MACRO worksheet\nWorksheets(2).Activate\n\n'Pivot Table 1\n'Pivot Table 1\n'Pivot Table 1\n\nLastRow = Cells(Rows.Count, 2).End(xlUp).Row\n'Use vlookup() function and perform conditional formatting\nFor x = 4 To (LastRow - 1)\nCells(x, 1).FormulaR1C1 = \"=VLOOKUP(RC[1],'US Master Macro'!R[-1]C[20]:R[36]C[21],2,FALSE)\"\nIf Cells(x, 2) &gt;= 8 Then\nCells(x, 1).Interior.ColorIndex = 3\nCells(x, 1).Font.ThemeColor = xlThemeColorDark1\nCells(x, 1).Font.Bold = True\nCells(x, 2).Interior.ColorIndex = 3\nCells(x, 2).Font.ThemeColor = xlThemeColorDark1\nCells(x, 2).Font.Bold = True\nCells(x, 3).Interior.ColorIndex = 3\nCells(x, 3).Font.ThemeColor = xlThemeColorDark1\nCells(x, 3).Font.Bold = True\nElse\nCells(x, 1).Interior.ColorIndex = 2\nEnd If\nNext x\n</code></pre>\n\n<p>\"I have the following data in a pivot table. To the left, is described a range and to the right the number of cells within that range. I would like to learn a code that correctly arranges the range in the left and color codes anything after \"80-89\". I have used the sort function but it doesn't seem to work. Please help.\"</p>\n\n<pre><code>Days   Count of PR ID\n\"10-19\"     656\n\"0-9\"       480\n\"20-29\"     190\n\"30-39\"     115\n\"40-49\"     65\n\"50-59\"     47\n\"70-79\"     28\n\"60-69\"     23\n\"80-89\"     12\n\"110-119\"   3\n\"120-129\"   2\n\"130-139\"   1\n\"100-109\"   1\n\"180-189\"   1\n</code></pre>\n\n<hr>\n"}, {"tags": ["excel", "vba", "fonts"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528349853, "post_id": 50728318, "comment_id": 88474999, "body": "Seems to me like you&#39;re working backwards.  Formatting conditionally and then trying to figure out which ones were formatted?  If you take a step back you could do everything in one fell swoop."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 13, "user_id": 5220114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d64059b0575da572c8fd5a2009c8c8d2?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Khub", "link": "https://stackoverflow.com/users/5220114/joseph-khub"}, "edited": false, "score": 0, "creation_date": 1528319246, "post_id": 50728982, "comment_id": 88466985, "body": "I have added up to 3 colours being accepted as arguments in version 2."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1528320509, "last_edit_date": 1528320509, "creation_date": 1528316673, "answer_id": 50728982, "question_id": 50728318, "link": "https://stackoverflow.com/questions/50728318/sum-cells-in-excel-by-their-font-color/50728982#50728982", "title": "SUM cells in Excel BY their font color", "body": "<p>You can't do <code>Target.Font.ColorIndex</code> on a range of more than one cell. Using a larger range will yield <code>null</code>.</p>\n\n<p>You could pass a range in and loop summing in the UDF. Also, pass the colour as an argument to the function.</p>\n\n<p><strong>Single colour:</strong></p>\n\n<pre><code>Public Function GetCellColor(ByRef Target As Range, ByVal targetColour As Long) As Long\n    Dim outValue As Long, currentcell As Range\n    For Each currentcell In Target.Cells\n        If currentcell.Font.ColorIndex = targetColour Then outValue = outValue + currentCell\n    Next currentcell\n    GetCellColor = outValue\nEnd Function\n</code></pre>\n\n<hr>\n\n<p><strong>Up to 3 colours:</strong></p>\n\n<p>This probably needs improving but if using up to 3 colours, with the last 2 being optional, and where individual colours should not be passed more than once, you could try something like:</p>\n\n<pre><code>Public Function GetCellColor(ByRef Target As Range, ByVal targetColour As Long, Optional ByVal targetColour2 As Variant, Optional ByVal targetColour3 As Variant) As Long\n    Dim outValue As Long, currentcell As Range\n\n    Select Case True\n    Case Not IsMissing(targetColour2) And Not IsMissing(targetColour3)\n        If targetColour2 = targetColour3 Or targetColour = targetColour2 Or targetColour = targetColour3 Then GoTo earlyExit\n    Case IsMissing(targetColour2) And Not IsMissing(targetColour3)\n        If targetColour = targetColour3 Then GoTo earlyExit\n    Case Not IsMissing(targetColour2) And IsMissing(targetColour3)\n        If targetColour = targetColour2 Then GoTo earlyExit\n    End Select\n\n    For Each currentcell In Target.Cells\n        If currentcell.Font.ColorIndex = targetColour Then outValue = outValue + currentcell\n        If Not IsMissing(targetColour2) Then\n            If currentcell.Font.ColorIndex = targetColour2 Then\n                outValue = outValue + currentcell\n            End If\n        End If\n        If Not IsMissing(targetColour3) Then\n            If currentcell.Font.ColorIndex = targetColour3 Then\n                outValue = outValue + currentcell\n            End If\n        End If\n    Next currentcell\n    GetCellColor = outValue\n\n    Exit Function\nearlyExit:\n  GetCellColor = CVErr(xlErrValue)\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528324722, "post_id": 50730343, "comment_id": 88468822, "body": "QHarr gave you a good answer - I think that deserves the &quot;accepted&quot; flag you orginally awarded.  Or you can flag &gt;1 answer I think."}], "tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 0, "last_activity_date": 1528322939, "creation_date": 1528322939, "answer_id": 50730343, "question_id": 50728318, "link": "https://stackoverflow.com/questions/50728318/sum-cells-in-excel-by-their-font-color/50730343#50730343", "title": "SUM cells in Excel BY their font color", "body": "<p>As QHarr points out you can't use <code>Font.ColorIndex</code> on a multi-cell range.</p>\n\n<p>Here's a version of your UDF which works in your original worksheet function:</p>\n\n<pre><code>Function GetCellColor(ByVal Target As Range)\n    Dim arr(), r As Long, c As Long\n    ReDim arr(1 To Target.Rows.Count, 1 To Target.Columns.Count)\n    For r = 1 To UBound(arr, 1)\n        For c = 1 To UBound(arr, 2)\n            arr(r, c) = Target(r, c).Font.ColorIndex\n        Next\n    Next\n    GetCellColor = arr\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5220114, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/d64059b0575da572c8fd5a2009c8c8d2?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Khub", "link": "https://stackoverflow.com/users/5220114/joseph-khub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1100, "favorite_count": 0, "accepted_answer_id": 50730343, "answer_count": 2, "score": 0, "last_activity_date": 1528349646, "creation_date": 1528314075, "last_edit_date": 1528349646, "question_id": 50728318, "link": "https://stackoverflow.com/questions/50728318/sum-cells-in-excel-by-their-font-color", "title": "SUM cells in Excel BY their font color", "body": "<p>I have a range of cells in Excel that need to be summed by their font color. \nColumn A is just names of vendors and it's obviously the entire month of May:<br>\n<img src=\"https://i.stack.imgur.com/MJxnom.png\" alt=\"img\"></p>\n\n<p>Ideally, I'd like to know the sum of black, red or blue cells for this range\nSo I developed two scenarios, one with and without macros.</p>\n\n<ol>\n<li><strong>without VBA</strong></li>\n</ol>\n\n<p>Add a string to red and black cells to know that they are \"different\"\nE.G. change 268 to 268c and 66.5 to 66.5u but leave 52.96 unchanged</p>\n\n<p>And use the array formula below:</p>\n\n<pre><code>{=SUM(IF(ISNUMBER(B7:C16),B7:C16,NUMBERVALUE(LEFT(B7:C16,3))))}\n</code></pre>\n\n<p>This skips the .5 in 66.5 but works, and as soon as I change the 3 in the <code>LEFT</code> function (which truncates the cell from text to string) to <code>LEN(B6:C17)-1</code> it doesn't work.</p>\n\n<ol start=\"2\">\n<li><strong>with VBA</strong></li>\n</ol>\n\n<p>Insert module and create this formula, which works on its own:</p>\n\n<pre><code>Function GetCellColor(ByVal Target As Range) As Integer\n    GetCellColor = Target.Font.ColorIndex\nEnd Function\n</code></pre>\n\n<p>Using the formula below (gives error if it's array formula or not):</p>\n\n<pre><code>=SUM(IF(getcellcolor(B7:C16)=3,B7:C16,0))\n</code></pre>\n\n<p>*I could write code which goes through each cell manually and adds, but I am wondering what the problem with each scenario is...</p>\n"}, {"tags": ["vba", "ms-word"], "answers": [{"tags": [], "owner": {"reputation": 9249, "user_id": 9170274, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BrcC8.jpg?s=128&g=1", "display_name": "macropod", "link": "https://stackoverflow.com/users/9170274/macropod"}, "is_accepted": true, "score": 0, "last_activity_date": 1528332110, "creation_date": 1528332110, "answer_id": 50731475, "question_id": 50728000, "link": "https://stackoverflow.com/questions/50728000/word-2016-how-do-i-find-and-replace-all-paragraph-marks-only-in-tables/50731475#50731475", "title": "Word 2016: How do I find and replace all paragraph marks only in tables?", "body": "<p>Try:</p>\n\n<pre><code>Sub ClearTblParaBreaks()\nApplication.ScreenUpdating = False\nDim Tbl As Table\nFor Each Tbl In ActiveDocument.Tables\n  With Tbl.Range.Find\n    .ClearFormatting\n    .Replacement.ClearFormatting\n    .Format = False\n    .Forward = True\n    .Wrap = wdFindStop\n    .MatchWildcards = True\n    .Text = \"[^13]{1,}\"\n    .Replacement.Text = \"\"\n    .Execute Replace:=wdReplaceAll\n  End With\nNext\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9905230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c434ade51e343d9d2fb9a9bda9c2e02c?s=128&d=identicon&r=PG", "display_name": "michaelschutz", "link": "https://stackoverflow.com/users/9905230/michaelschutz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 50731475, "answer_count": 1, "score": -2, "last_activity_date": 1528332110, "creation_date": 1528312567, "last_edit_date": 1528317168, "question_id": 50728000, "link": "https://stackoverflow.com/questions/50728000/word-2016-how-do-i-find-and-replace-all-paragraph-marks-only-in-tables", "title": "Word 2016: How do I find and replace all paragraph marks only in tables?", "body": "<p>I have a 300+ page Word 2016 doc imported from another program that has a huge amount of tables. In every table cell there is at least one paragraph mark. I want to Find and Replace every single paragraph mark with nothing, but only in tables (there are tons of other paragraph marks in normal text that I want to leave alone).</p>\n\n<p>I can use the Find/Replace dialog to do it manually, but that will take a huge amount of clicks and time. There is no \"only in tables\" option in the dialog box, so it seems I need to craft a VBA macro but I've never done that before. Below is the macro produced by recording the action of \"Find/Replace a paragraph mark in one table\". What needs to be changed to enable this to tackle all the tables at once?</p>\n\n<pre><code>Dim mytable As Table\nApplication.ScreenUpdating = False\n\nFor Each mytable In ActiveDocument.Tables\nmytable.Range.Editors.Add wdEditorEveryone\nNext\nActiveDocument.SelectAllEditableRanges (wdEditorEveryone)\nActiveDocument.DeleteAllEditableRanges (wdEditorEveryone)\nApplication.ScreenUpdating = True\nEnd Sub\nSub FindReplaceInTable()\n'\n' FindReplaceInTable Macro\n'\n'\n    Selection.Tables(1).Select\n    Selection.Find.ClearFormatting\n    Selection.Find.Replacement.ClearFormatting\n    With Selection.Find\n        .Text = \"^p\"\n        .Replacement.Text = \"\"\n        .Forward = True\n        .Wrap = wdFindAsk\n        .Format = False\n        .MatchCase = False\n        .MatchWholeWord = False\n        .MatchKashida = False\n        .MatchDiacritics = False\n        .MatchAlefHamza = False\n        .MatchControl = False\n        .MatchWildcards = False\n        .MatchSoundsLike = False\n        .MatchAllWordForms = False\n    End With\n    Selection.Find.Execute\nEnd Sub\n</code></pre>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1528312855, "post_id": 50727929, "comment_id": 88464065, "body": "I&#39;m assuming that since you have so many sheets, you don&#39;t want to be putting code into each worksheet&#39;s <code>.BeforeDelete</code> event?"}, {"owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "reply_to_user": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1528313158, "post_id": 50727929, "comment_id": 88464199, "body": "The sheets are created by using a template. So that might work, can that kind of code be added to a template? I keep list of all the names of the sheets, could I utilize that list to automate the .BeforeDelete event for each existing sheet and all new sheets?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528313506, "post_id": 50727929, "comment_id": 88464369, "body": "Just to be clear, nothing guarantees that anything is safe from &quot;accidental anything&quot;.  If this data is important, you need to have an appropriate backup strategy in place.  For example: what happens if cell OP15 &quot;accidentally&quot; has a value entered because someone thought they were on a different worksheet? (Then that worksheet will be accidentally deleted.)  It sounds like it may be time to move the data to MS Access for easier organizing and user interaction.."}, {"owner": {"reputation": 1688, "user_id": 9259306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EIROY.png?s=128&g=1", "display_name": "Mistella", "link": "https://stackoverflow.com/users/9259306/mistella"}, "edited": false, "score": 0, "creation_date": 1528315913, "post_id": 50727929, "comment_id": 88465511, "body": "@StevenGilbert I think you can add that kind of code to a template. I was thinking it might also be good to have a msgbox that asks for verification that you want to delete the sheet. If the msgbox only appears when OP15 has a value; it would help you (or anyone else) do a double-take on if they actually want that sheet deleted."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "edited": false, "score": 0, "creation_date": 1528466251, "post_id": 50729039, "comment_id": 88532121, "body": "Thank you. You have led me to an answer that worked for me."}], "tags": [], "owner": {"reputation": 15049, "user_id": 1370425, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/H8yZu.png?s=128&g=1", "display_name": "SeanC", "link": "https://stackoverflow.com/users/1370425/seanc"}, "is_accepted": false, "score": 0, "last_activity_date": 1528316852, "creation_date": 1528316852, "answer_id": 50729039, "question_id": 50727929, "link": "https://stackoverflow.com/questions/50727929/dynamically-protect-sheet-from-accidental-deletion-in-excel/50729039#50729039", "title": "Dynamically protect sheet from accidental deletion in Excel", "body": "<p>The <code>.BeforeDelete</code> does not have a cancel, so you can't stop them deleting the sheet.</p>\n\n<p>from <a href=\"http://datapigtechnologies.com/blog/index.php/prevent-worksheet-delete-without-workbook-protection/\" rel=\"nofollow noreferrer\">this</a> website, you can copy the sheet, and save it from deletion that way. You could use this routine to decide if you need to save the sheet from deletion or not:</p>\n\n<pre><code>Private Sub Worksheet_BeforeDelete()\n\nDim MyName As String\n\n'Abort if no value in OP15\nif [OP15].value&lt;&gt;'' then exit sub\n\n\u2018Capture the original worksheet name\nMyName = ThisWorkbook.ActiveSheet.Name\n\n\u2018Rename the worksheet\nThisWorkbook.ActiveSheet.Name = Left(MyName, 30) + \u201c#\u201d\n\n\u2018Create a copy of the worksheet\nThisWorkbook.ActiveSheet.Copy _\nAfter:=Sheets(ThisWorkbook.ActiveSheet.Index)\n\n\u2018Name the copy to the original name\nThisWorkbook.ActiveSheet.Name = MyName\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "is_accepted": true, "score": 0, "last_activity_date": 1528466162, "last_edit_date": 1528466162, "creation_date": 1528396242, "answer_id": 50747983, "question_id": 50727929, "link": "https://stackoverflow.com/questions/50727929/dynamically-protect-sheet-from-accidental-deletion-in-excel/50747983#50747983", "title": "Dynamically protect sheet from accidental deletion in Excel", "body": "<p>This code is pasted into the sheet code for my admin template. Cell A1 is hardcoded to say \"admin template\". When the template is copied Cell A1 changes to the name of the new tab. </p>\n\n<pre><code>     Option Explicit\n\n     Private Sub Worksheet_Deactivate()\n\n     'This sub prevents acidental deletion of tab until it has been hardcoded\n\n     If Range(\"a1\").Value = \"admin template Ticket Info\" Then\n     ThisWorkbook.Protect , False\n     Exit Sub\n     End If\n\n     If Range(\"OP15\").Value &lt;&gt; \"\" Then\n     MsgBox \"Cannot delete tab until the Onboarding details have been hardcoded.\"\n     Exit Sub\n     End If\n\n     ThisWorkbook.Protect , True\n\n     Application.OnTime Now, \"Unprotectbook\"\n\n     End Sub\n</code></pre>\n\n<p>This is copied into one of the modules</p>\n\n<pre><code>     Sub UnprotectBook()\n\n     ThisWorkbook.Unprotect\n\n     End Sub\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 9463032, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-LIOm_gfXAbY/AAAAAAAAAAI/AAAAAAAACxc/6NhRLdjKtDc/photo.jpg?sz=128", "display_name": "Steven Gilbert", "link": "https://stackoverflow.com/users/9463032/steven-gilbert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1341, "favorite_count": 0, "accepted_answer_id": 50747983, "answer_count": 2, "score": 1, "last_activity_date": 1528466162, "creation_date": 1528312293, "question_id": 50727929, "link": "https://stackoverflow.com/questions/50727929/dynamically-protect-sheet-from-accidental-deletion-in-excel", "title": "Dynamically protect sheet from accidental deletion in Excel", "body": "<p>I am trying to put a dynamic protection on the sheets in my workbook. I have many different sheets and sometimes I delete a sheet that I still need by accident. </p>\n\n<p>If Cell OP15 contains a value, this means I am okay to delete the sheet to clean up my workbook. How do I create a protection for the sheets that only lets me delete it if Cell OP15 contains a value?</p>\n\n<p>The closest thing I can find on the internet is something along these lines:</p>\n\n<pre><code>     ActiveSheet.Unprotect\n     ' your vba code here\n     ActiveSheet.Protect\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 3, "creation_date": 1528311213, "post_id": 50727593, "comment_id": 88463301, "body": "Post the code you have tried thusfar"}, {"owner": {"reputation": 1, "user_id": 9905110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c497cd2201f5957dce875d9c7a03c02?s=128&d=identicon&r=PG&f=1", "display_name": "user9905110", "link": "https://stackoverflow.com/users/9905110/user9905110"}, "reply_to_user": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1528312652, "post_id": 50727593, "comment_id": 88463980, "body": "Admittedly I haven&#39;t been able to get anything working together as I&#39;m very new to VBA..."}, {"owner": {"reputation": 32101, "user_id": 8404453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/616cb81bb678bb5b17869511b2a41367?s=128&d=identicon&r=PG&f=1", "display_name": "TheMaster", "link": "https://stackoverflow.com/users/8404453/themaster"}, "edited": false, "score": 0, "creation_date": 1528313437, "post_id": 50727593, "comment_id": 88464333, "body": "Which version of <a href=\"https://stackoverflow.com/questions/tagged/google-spreadsheet\">google-spreadsheet</a> supports <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a>?"}, {"owner": {"reputation": 2538, "user_id": 6388698, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7gWUL.png?s=128&g=1", "display_name": "GMalc", "link": "https://stackoverflow.com/users/6388698/gmalc"}, "edited": false, "score": 0, "creation_date": 1528342019, "post_id": 50727593, "comment_id": 88472799, "body": "Check out <a href=\"https://www.youtube.com/watch?v=9wBJDyXp2CU\" rel=\"nofollow noreferrer\">This Video</a> on how to generate a test paper from a question bank."}], "answers": [{"tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 0, "last_activity_date": 1528353589, "creation_date": 1528353589, "answer_id": 50734497, "question_id": 50727593, "link": "https://stackoverflow.com/questions/50727593/2-excel-vba-macros-one-to-move-data-from-master-sheet-into-separate-sheets-ano/50734497#50734497", "title": "2 Excel VBA Macros: One to move data from master sheet into separate sheets, another to move updated data from separate sheets into master sheets", "body": "<pre><code>Sub MoveMasterData()\n\n'Check each date\nFor Each Allocation In Worksheets(\"Master\").Columns(2).Cells    'Change Master to your sheet name\n    If Allocation.Value = \"\" Then Exit Sub 'Stop program if no data\n\n    If Allocation.Row &gt; 1 Then\n        shtName = Allocation.Value    'Assign sheet name\n\n        On Error GoTo errorhandler  'if no allocation Sheet, go to errorhandler to create new tab\n        If Worksheets(shtName).Range(\"A2\").Value = \"\" Then\n           Allocation.EntireRow.Copy Destination:=Worksheets(shtName).Range(\"A2\")\n           Worksheets(shtName).Range(\"A1:D1\").Columns.AutoFit\n        Else\n            Allocation.EntireRow.Copy Destination:=Worksheets(shtName).Range(\"A1\").End(xlDown).Offset(1)\n        End If\n    End If\nNext\n\nExit Sub\nerrorhandler:\nSheets.Add After:=Sheets(Sheets.Count) 'Create new tab\nActiveSheet.Name = shtName  'Name tab with Allocation\nWorksheets(\"Master\").Rows(1).EntireRow.Copy Destination:=ActiveSheet.Rows(1) 'Copy heading to new tab\nResume\n\nEnd Sub\n\nSub CompileMaster()\n\n'Check each Allocation\nFor Each Allocation In Worksheets(\"Master\").Columns(2).Cells    'Change Master to your sheet name\n    If Allocation.Value = \"\" Then Exit Sub 'Stop program if no data\n\n    If Allocation.Row &gt; 1 Then\n        For Each sht In Worksheets\n            If Allocation.Value = sht.Name Then\n                For Each QNo In sht.Columns(1).Cells\n                    If QNo.Value = \"\" Then Exit For 'Stop program if no data\n\n                    RowQ = WorksheetFunction.Match(QNo, Worksheets(\"Master\").Columns(1), 0) 'Check &amp; Assign Question No\n                    Worksheets(\"Master\").Range(\"D\" &amp; RowQ).Value = QNo.Offset(0, 3).Value   'Transfer answer to master\n                Next\n            End If\n        Next\n    End If\nNext\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9905110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c497cd2201f5957dce875d9c7a03c02?s=128&d=identicon&r=PG&f=1", "display_name": "user9905110", "link": "https://stackoverflow.com/users/9905110/user9905110"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1528353589, "creation_date": 1528311131, "last_edit_date": 1528313570, "question_id": 50727593, "link": "https://stackoverflow.com/questions/50727593/2-excel-vba-macros-one-to-move-data-from-master-sheet-into-separate-sheets-ano", "title": "2 Excel VBA Macros: One to move data from master sheet into separate sheets, another to move updated data from separate sheets into master sheets", "body": "<p>To give some context to the issue, I am trying to create a centralised master question and answer worksheet, which I will then allocate questions to different people. The spreadsheet that is given to people would only show the questions that are allocated to them.</p>\n\n<p>For example, this would be the initial master spreadsheet with questions unanswered.</p>\n\n<pre><code># Allocation Question Answer\n1 A          ABC\n2 A          DEF\n3 B          GHI\n4 A          JKL\n5 C          MNO\n6 B          PQR\n</code></pre>\n\n<p>But person A would only receive the following, and fill in the answer column before sending it back for consolidation to the master sheet.</p>\n\n<pre><code># Allocation Question Answer\n1 A          ABC\n2 A          DEF\n4 A          JKL\n</code></pre>\n\n<p>As the title suggests, I am having some difficulty trying to create a macro to do the following:</p>\n\n<ul>\n<li>Copy the entire table as values into separate tabs for each designated answered (i.e. a tab called A with just the second table above, and then the same for tab B and tab C, etc.)</li>\n<li>Once the designated answer has then populated their own sheets, they will send it back, and would then need a macro to populate the master sheet, with the answers now filled in</li>\n</ul>\n\n<p>Appreciate this seems like a lot but would be good to know if anyone has done something like this before and could help out if so?</p>\n\n<p>Thanks alot in advance.</p>\n\n<p>AT.</p>\n"}, {"tags": ["vba", "excel", "append"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1528310309, "post_id": 50727170, "comment_id": 88462870, "body": "I can&#39;t reproduce - is the column that you&#39;re getting your <code>LastRow</code> value from empty?"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528310786, "post_id": 50727170, "comment_id": 88463117, "body": "Ahem, do you have more than 6553 rows of data?"}, {"owner": {"reputation": 37, "user_id": 9356603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AdcT8n0jPEY/AAAAAAAAAAI/AAAAAAAAAQQ/xtuD27ktDaI/photo.jpg?sz=128", "display_name": "Salik Gilani", "link": "https://stackoverflow.com/users/9356603/salik-gilani"}, "edited": false, "score": 0, "creation_date": 1528310967, "post_id": 50727170, "comment_id": 88463197, "body": "No I do not have more than 6553 rows of data. But it would take longer to process because of such a large number of rows instead of the actual number, no?  dwirony-yes the last column can be empty in some cases as it is more of a comments column."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1528311198, "post_id": 50727170, "comment_id": 88463295, "body": "<i>But it would take longer to process because of such a large number of rows instead of the actual number, no?</i> - no. Try <code>&quot;A&quot; &amp; Rows.Count</code> instead. All you&#39;re doing is getting the <code>Range</code> object for one cell, and then invoking <code>.End(xlUp)</code> on it. The number makes no difference, other than whether or <code>LastRow</code> is correct or not given any number of rows."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1528311442, "post_id": 50727170, "comment_id": 88463417, "body": "Don&#39;t do <code>sht.Select</code>. Instead of using implicit <code>ActiveSheet</code> references (e.g. <code>Range</code>, <code>Cells</code>), qualify them with that <code>sht</code> variable and do <code>sht.Range</code>, <code>sht.Cells</code>. And instead of <code>Range(...).Select</code> followed by <code>ActiveSheet.Paste</code>, do <code>sht.Range(...).Paste</code>. Avoid <code>Select</code> and <code>Activate</code>, and qualify all worksheet member calls with an explicit <code>Worksheet</code> object."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528311479, "post_id": 50727170, "comment_id": 88463435, "body": "Also, your code <a href=\"http://rubberduckvba.com/indentation\" rel=\"nofollow noreferrer\">wants to be indented</a>."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528312321, "post_id": 50727170, "comment_id": 88463826, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/25657541/merge-two-excel-tables-based-on-matching-data-in-columns\">Merge two Excel tables Based on matching data in Columns</a>"}, {"owner": {"reputation": 37, "user_id": 9356603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AdcT8n0jPEY/AAAAAAAAAAI/AAAAAAAAAQQ/xtuD27ktDaI/photo.jpg?sz=128", "display_name": "Salik Gilani", "link": "https://stackoverflow.com/users/9356603/salik-gilani"}, "edited": false, "score": 0, "creation_date": 1528313666, "post_id": 50727170, "comment_id": 88464431, "body": "I will re do the code. I believe the reason it is not working is because column J is empty( and might be true in most cases). If the column is empty, is there a way I can copy everything from column A to J and still append it? Currently my code is dependent on there being a value in J."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1528320277, "post_id": 50727852, "comment_id": 88467414, "body": "You meant <code>With worksheets(i)</code>, right? (Not Activesheet)"}, {"owner": {"reputation": 37, "user_id": 9356603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AdcT8n0jPEY/AAAAAAAAAAI/AAAAAAAAAQQ/xtuD27ktDaI/photo.jpg?sz=128", "display_name": "Salik Gilani", "link": "https://stackoverflow.com/users/9356603/salik-gilani"}, "edited": false, "score": 0, "creation_date": 1528337675, "post_id": 50727852, "comment_id": 88471997, "body": "Thank you for your input Cyril. The excel file has multiple other tabs, which are irrelevant to the purpose for which this Macro is being used. If I used your code, it would be adding all the data from the other tabs as well."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1528375682, "post_id": 50727852, "comment_id": 88490660, "body": "@chrisneilsen good catch.  i was focused on showing the 2x last row declarations and missed that.  Will edit."}, {"owner": {"reputation": 37, "user_id": 9356603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AdcT8n0jPEY/AAAAAAAAAAI/AAAAAAAAAQQ/xtuD27ktDaI/photo.jpg?sz=128", "display_name": "Salik Gilani", "link": "https://stackoverflow.com/users/9356603/salik-gilani"}, "edited": false, "score": 0, "creation_date": 1528377378, "post_id": 50727852, "comment_id": 88491961, "body": "Hey! Works like a charm. I was trying to write an array but was defining the range incorrectly. You did this perfectly! I have voted for your solution, however, it does not show since I do not have enough reputation points. Thank you everyone!  PS. I do not know how to get the negative reputation for my question to go away."}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "reply_to_user": {"reputation": 37, "user_id": 9356603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AdcT8n0jPEY/AAAAAAAAAAI/AAAAAAAAAQQ/xtuD27ktDaI/photo.jpg?sz=128", "display_name": "Salik Gilani", "link": "https://stackoverflow.com/users/9356603/salik-gilani"}, "edited": false, "score": 0, "creation_date": 1528381745, "post_id": 50727852, "comment_id": 88495251, "body": "@SalikGilani You should be able to hit the check-mark below the voting to accept the answer, even if you can&#39;t give it a vote, regardless of reputation as the owner of the question.  Most folks downvote when there isn&#39;t sufficient info in the post originally, and if they dont&#39; come back later to review (or dont&#39; leave a comment so they can be notified of an update), it usually stays.  Yes, -1 feels bad, but it&#39;s not something to dwell on.  Glad that worked for you!"}], "tags": [], "owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "is_accepted": true, "score": 0, "last_activity_date": 1528376904, "last_edit_date": 1528376904, "creation_date": 1528311984, "answer_id": 50727852, "question_id": 50727170, "link": "https://stackoverflow.com/questions/50727170/macro-copy-data-from-two-worksheets-and-join-together-in-third/50727852#50727852", "title": "Macro : Copy data from two Worksheets and Join together in third", "body": "<p>dirty runthrough off the top of my head:</p>\n\n<pre><code>dim i as long, lrs as long, lrd as long\nfor i = 1 to sheets.count\n    if not sheets.name=\"Master\" then \n        with sheets(i)\n            lrs = .cells(.rows.count,1).end(xlup).row\n            .range(.cells(2,\"A\"),.cells(lrs,\"J\")).copy\n        end with\n        with sheets(\"Master\")\n            lrd = .cells(.rows.count,1).end(xlup).row\n            .cells(lrd+1,1).paste\n        end with\n    end if\nnext i\n</code></pre>\n\n<hr>\n\n<p>Edit1:</p>\n\n<p>Cleaned up the code to work for the two specified sheets:</p>\n\n<pre><code>Dim i As Worksheet, arr As Variant, lrs As Long, lrd As Long\narr = Array(\"Employee Access Arranged\", \"IERWAA Lookup Arranged\")\nFor Each i In Sheets(arr)\n    With i\n        lrs = .Cells(.Rows.Count, 1).End(xlUp).Row\n        .Range(.Cells(2, \"A\"), .Cells(lrs, \"J\")).Copy\n    End With\n    With Sheets(\"Master\")\n        lrd = .Cells(.Rows.Count, 1).End(xlUp).Row\n        .Range(.Cells(lrd + 1, \"A\"), .Cells(lrd + 1 + lrs, \"J\")).PasteSpecial xlValues\n    End With\nNext i\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9356603, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AdcT8n0jPEY/AAAAAAAAAAI/AAAAAAAAAQQ/xtuD27ktDaI/photo.jpg?sz=128", "display_name": "Salik Gilani", "link": "https://stackoverflow.com/users/9356603/salik-gilani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 50727852, "answer_count": 1, "score": 0, "last_activity_date": 1528376904, "creation_date": 1528309532, "last_edit_date": 1531164843, "question_id": 50727170, "link": "https://stackoverflow.com/questions/50727170/macro-copy-data-from-two-worksheets-and-join-together-in-third", "title": "Macro : Copy data from two Worksheets and Join together in third", "body": "<p>My excel file, has multiple tabs. One of the Sheets is \"Employee Access Arranged\" and another is \"IERWAA Lookup Arranged\". Both these sheets have the same data ( Columns A to J ) but having different sources they are pulling from ( which is why they are in two separate sheets). Headers are in Row 1 and number of rows are not fixed.</p>\n\n<p>I have a third tab \"Master\" in which I want the data from both these tabs to show up appended to each other. Row 1 will have headers, which are the same for all 3 sheets.</p>\n\n<p>I wrote a Macro but it is just copying the header instead of the data. </p>\n\n<pre><code>Dim Sht As Worksheet\nFor Each Sht In ActiveWorkbook.Worksheets\n    If Sht.Name = \"Employee Access Arranged\" Or Sht.Name = \"IERWAA Lookup\n    Arranged\" Then\n    Sht.Select\n\n    LastRow = Range(\"A6553\").End(xlUp).Row\n    Range(\"A2\", Cells(LastRow, \"J\")).Copy\n    Sheets(\"Master\").Select\n    Range(\"A6553\").End(xlUp).Offset(1, 0).Select\n    ActiveSheet.Paste\n\nElse\nEnd If\nNext Sh\n</code></pre>\n\n<p>Could someone please assist as to how I can make it work to copy the data from both the sheets instead of the header. Also, since the number of rows changes, i want it to be dynamic to pick up the last filled row automatically. </p>\n\n<p>Please Note : <strong>This is not a duplicate of another question. I do not want just matching values from both sheets, but all the values from both sheets. Furthermore, the problem is unique as the last column \"J\" might not have values in most cases, but the whole column would still need to be copied</strong></p>\n\n<p>Thank you in advance.</p>\n"}, {"tags": ["excel", "vba", "button", "formula"], "comments": [{"owner": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 1, "creation_date": 1528310517, "post_id": 50727123, "comment_id": 88462972, "body": "So what do you want to happen when you click up or down on the spin button?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528311478, "post_id": 50727123, "comment_id": 88463433, "body": "Not sure if useful but have you considered a timeline slicer?"}, {"owner": {"reputation": 23, "user_id": 9599118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/9599118/ryan-nguyen"}, "edited": false, "score": 0, "creation_date": 1528317671, "post_id": 50727123, "comment_id": 88466291, "body": "When i click up and down spin button, the Title of the chart change accordingly to cell E4 but the chart stay the same.I just wonder how can i link the spin button with the chart so it will change data on the chart."}, {"owner": {"reputation": 23, "user_id": 9599118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/9599118/ryan-nguyen"}, "edited": false, "score": 0, "creation_date": 1528317771, "post_id": 50727123, "comment_id": 88466326, "body": "QHarr-I know how to use the slicer but i want to keep it clean and use only spin button or scroll button. It will look better"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528320745, "post_id": 50727123, "comment_id": 88467576, "body": "I guess linked cell can index into months for plotting"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 5513, "user_id": 7668613, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/LBuId.png?s=128&g=1", "display_name": "dwirony", "link": "https://stackoverflow.com/users/7668613/dwirony"}, "edited": false, "score": 0, "creation_date": 1528345195, "post_id": 50727123, "comment_id": 88473529, "body": "And, as @dwirony points out, what change should we see when you press the spin button? A visual image of the desired result would help."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528313125, "post_id": 50728080, "comment_id": 88464183, "body": "Month by month made me think timeline slicer as an additional option."}, {"owner": {"reputation": 23, "user_id": 9599118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/9599118/ryan-nguyen"}, "edited": false, "score": 0, "creation_date": 1528318567, "post_id": 50728080, "comment_id": 88466679, "body": "Yeah, i did use  the splicer before. but it took too much space. I know there is away you can use either spin button or scroll button with formula to change the data on the chart by clicking on the arrow up and down. it is better and the title change accordingly to the data."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528337293, "post_id": 50728080, "comment_id": 88471902, "body": "It&#39;s a <i>slicer</i> and it doesn&#39;t have to remain visible.  Yes of course there&#39;s &quot;a way&quot;... in fact there are several ways it could work; the issue is finding the one right for your data and your experience level."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 23, "user_id": 9599118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/9599118/ryan-nguyen"}, "edited": false, "score": 0, "creation_date": 1528337338, "post_id": 50728080, "comment_id": 88471910, "body": "@RyanNguyen  You didn&#39;t mention any issue with my answer. You could just use the chart filters, programmatically controlled bu your buttons.  Problem solved?"}, {"owner": {"reputation": 23, "user_id": 9599118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/9599118/ryan-nguyen"}, "edited": false, "score": 0, "creation_date": 1528383503, "post_id": 50728080, "comment_id": 88496473, "body": "ashleedawg. How you link up the chart filter with the spin button? i would love to know how."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 23, "user_id": 9599118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/9599118/ryan-nguyen"}, "edited": false, "score": 0, "creation_date": 1528417349, "post_id": 50728080, "comment_id": 88511419, "body": "@RyanNguyen I added more information to my answer to help get you started."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 0, "last_activity_date": 1528418316, "last_edit_date": 1528418316, "creation_date": 1528312989, "answer_id": 50728080, "question_id": 50727123, "link": "https://stackoverflow.com/questions/50727123/spin-button-for-showing-month-by-month-on-chart-graph/50728080#50728080", "title": "Spin button for showing Month by Month on Chart Graph", "body": "<h2>How to do anything anything Excel can do, but with VBA code:</h2>\n\n<p>Virtually anything you can do manually in Excel (ie, via the ribbons/toolbars) has an equivalent in VBA. </p>\n\n<p>If you are unsure of which VBA method or property to use, you can turn on the macro recorder and manually perform the action. The macro recorder translates your actions into Visual Basic code. After you record your actions, you can modify the code to do exactly what you want. </p>\n\n<blockquote>\n  <p><sub> There are some limitations to recording macros, so if needed, certain actions have to be added after recording, such as conditional branches (eg., <code>IF</code> statements), variables usage  loops, error handling, and text selections made with the mouse <em>(however keyboard combinations <strong>do</strong> record)</em>. </sub>  </p>\n</blockquote>\n\n<hr>\n\n<h2>Record an action:</h2>\n\n<p>For example, if you want to automate the process of <strong>saving the file with a new name</strong>, but you don't know which property or method to use, you could do this:</p>\n\n<ol>\n<li>On the <strong>Developer</strong> ribbon, click <a href=\"https://i.stack.imgur.com/5ueMj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5ueMj.png\" alt=\"img\"></a><br>\nChange the default macro name to a name of your choice and click <kbd>OK</kbd> to start the recorder.  </li>\n<li>Hit <kbd>F12</kbd> to open the <em><code>Save As...</code></em> dialog and save the file with a new name.</li>\n<li>On the <strong>Developer</strong> ribbon, click <a href=\"https://i.stack.imgur.com/wkhNp.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wkhNp.png\" alt=\"img\"></a>   </li>\n<li>On the <strong>Developer</strong> ribbon, click  <a href=\"https://i.stack.imgur.com/4eRCS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/4eRCS.png\" alt=\"img\"></a>  <strong>Macros</strong>.</li>\n<li>Select the <strong><em>macro</em></strong> name that you assigned (in Step 2) and click <sub><img src=\"https://i.stack.imgur.com/LzjId.png\" alt=\"Edit\"></sub> to view the <strong><em>VBA code</em></strong> within.</li>\n</ol>\n\n<p>See the tips &amp; resources at the links below to help get you started with automatizing Excel (and other Office applications) using VBA code.</p>\n\n<hr>\n\n<h2>More information:</h2>\n\n<ul>\n<li><p>Office.com : <a href=\"https://support.office.com/article/assign-a-macro-to-a-form-or-a-control-button-d58edd7d-cb04-4964-bead-9c72c843a283\" rel=\"nofollow noreferrer\"><strong>Assign a macro to a Form or a Control button</strong></a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/vba/office-shared-vba/articles/getting-started-with-vba-in-office\" rel=\"nofollow noreferrer\"><strong>Getting Started with VBA in Office</strong></a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.comvba/word-vba/articles/recording-a-macro-to-generate-code\" rel=\"nofollow noreferrer\"><strong>Recording a Macro to Generate VBA Code</strong></a>)</p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/vba/word-vba/articles/revising-recorded-visual-basic-macros\" rel=\"nofollow noreferrer\"><strong>Revising Recorded VBA Macros</strong></a></p></li>\n<li><p>homeandlearn.org : <a href=\"http://www.homeandlearn.org/\" rel=\"nofollow noreferrer\"><strong>Excel VBA For Complete Beginners</strong></a> </p></li>\n<li><p>Stack Overflow : <a href=\"https://stackoverflow.com/q/50144020/8112776\"><strong>Overview of Form Controls and ActiveX Control</strong>s</a></p></li>\n</ul>\n\n<hr>\n\n<p><sub><em>Original Post:</em></sub>  </p>\n\n<h2>How to filter a chart</h2>\n\n<p>The ability to filter a chart by month is built-in to Excel.  After you create a chart, you can change the data series in two ways:  </p>\n\n<ul>\n<li><p>Use <strong>chart filters</strong> to show or hide data in your chart, <em>or,</em> </p></li>\n<li><p>Use the <strong>Select Data Source</strong> dialog box to edit the data in your series or rearrange them on your chart.  </p></li>\n</ul>\n\n<blockquote>\n  <h2>Filter data in your chart</h2>\n  \n  <ol>\n  <li><p>Click anywhere in your chart.</p></li>\n  <li><p>Click the <strong>Chart Filters</strong> button <img src=\"https://i.stack.imgur.com/isjlA.jpg\" alt=\"Chart Filters button\"> next to the chart.</p></li>\n  <li><p>On the <strong>Values</strong> tab, check or uncheck the series or categories you want to show or hide.\n  <a href=\"https://i.stack.imgur.com/m5Gyo.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nbQVQ.png\" alt=\"Values tab in the Chart Filters gallery\"></a></p></li>\n  <li><p>Click <strong>Apply</strong>.</p></li>\n  <li><p>If you want to edit or rearrange the data in your series, click <strong>Select Data</strong>, and then follow steps 2-4 in the next section.</p></li>\n  </ol>\n</blockquote>\n\n<p>Once you know how to use the filters, you can record a macro while filtering as required, an use the code for buttons or other controls.</p>\n\n<hr>\n\n<h2>More Information:</h2>\n\n<ul>\n<li><p>Office.com : <a href=\"https://support.office.com/article/change-the-data-series-in-a-chart-30b55a30-1c2e-42d5-8ed1-3cc3ffb68036\" rel=\"nofollow noreferrer\"><strong>Change the data series in a chart</strong></a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/vba/word-vba/articles/recording-a-macro-to-generate-code\" rel=\"nofollow noreferrer\"><strong>Recording a Macro to Generate Code</strong></a></p></li>\n<li><p>MSDN : <a href=\"https://msdn.microsoft.com/vba/word-vba/articles/revising-recorded-visual-basic-macros\" rel=\"nofollow noreferrer\"><strong>Revising Recorded Visual Basic Macros</strong></a></p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 9599118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/9599118/ryan-nguyen"}, "is_accepted": false, "score": 0, "last_activity_date": 1528384276, "creation_date": 1528384276, "answer_id": 50744694, "question_id": 50727123, "link": "https://stackoverflow.com/questions/50727123/spin-button-for-showing-month-by-month-on-chart-graph/50744694#50744694", "title": "Spin button for showing Month by Month on Chart Graph", "body": "<p>Thanks you all for your help. I did figure out one way to make it work for me. However, i will more than happy to learn new way or a better way to use spin button and scroll button to changing my chart. </p>\n\n<ol>\n<li>Changes data layout table</li>\n<li>Using index formula and vlookup (Cell F19, G19,H19) formula included in picture below)</li>\n<li>Changes define name formula to pull data from Cell (Cell F19, G19,H19).</li>\n<li>Now i can click on my spin button and the chart changing month by month for me.</li>\n</ol>\n\n<p>It is working fine for me. But i love to learn more if anyone can show me a better way to do it. Please include pictures and formula in your answer. It will help me and other easy to follow it. Thanks<a href=\"https://i.stack.imgur.com/BAqTS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BAqTS.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1528440116, "last_edit_date": 1528440116, "creation_date": 1528439514, "answer_id": 50754654, "question_id": 50727123, "link": "https://stackoverflow.com/questions/50727123/spin-button-for-showing-month-by-month-on-chart-graph/50754654#50754654", "title": "Spin button for showing Month by Month on Chart Graph", "body": "<p><strong>Steps</strong></p>\n\n<p>This is broadly similar to yours. Below is just meant to show you how to use dynamic named ranges as chart series sources. If you later decide to specify start and end ranges of months, you could use this same model and have the start and end indexes generate the height argument for Offset thus being able to plot ranges (though they would be aggregate).</p>\n\n<p>Using the same data layout as in your answer.</p>\n\n<hr>\n\n<p>\u2460 Add a forms control spin button, assign its linked cell as <code>K3</code>, then put the font to white so it is not visible. Its values run from 1-12 with increment 1.</p>\n\n<hr>\n\n<p>\u2461 I then create two dynamic ranges:</p>\n\n<ol>\n<li><code>LATE</code> with formula <code>=OFFSET(Sheet1!$G$4,Sheet1!$K$3-1,0,1,1)</code></li>\n<li><code>OnTime</code> with formula <code>=OFFSET(Sheet1!$H$4,Sheet1!$K$3-1,0,1,1)</code></li>\n</ol>\n\n<p>You can add these via name manager (<kbd>Alt</kbd>+<kbd>F3</kbd>)</p>\n\n<p>Name manager:</p>\n\n<p><a href=\"https://i.stack.imgur.com/QvRdF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QvRdF.png\" alt=\"Name manager\"></a></p>\n\n<hr>\n\n<p>\u2462 I then insert a bar chart and add two series which use these dynamic named ranges as their source:</p>\n\n<p><a href=\"https://i.stack.imgur.com/9FLWa.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9FLWa.png\" alt=\"Late series for chart\"></a></p>\n\n<p>The above is for <code>Late</code> and this is repeated for <code>OnTime</code>. Note that the workbook name goes before the reference to the dynamic range.</p>\n\n<hr>\n\n<p>\u2463 In <code>J2</code> I enter the chart title text <code>\"Monthly - 5 KPI Delivery\"</code> and point the chart title at this with <code>= J2</code> in formula bar whilst chart title is selected on the chart.</p>\n\n<hr>\n\n<p>\u2464 <code>K2</code> has the formula  <code>=INDEX(F4:F15,K3)</code> and is used to retrieve the Month name from the list of months via Index with row argument the linked cell value from the spin button.</p>\n\n<p>I then edit the chart X axis source with formula <code>=Sheet1!$K$2</code> so the month name appears on the bottom of the chart.</p>\n\n<hr>\n\n<p>\u2465 Finally, any other chart sprucing you like. I chose to group and lock the chart and spin button together so they will move as a unit and to ensure data point values where shown.</p>\n\n<hr>\n\n<p>Final result:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FTSvI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FTSvI.png\" alt=\"Output\"></a></p>\n\n<hr>\n\n<p>In action:</p>\n\n<p><a href=\"https://i.stack.imgur.com/nvmYq.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nvmYq.gif\" alt=\"Test run\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/N9aDx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/N9aDx.png\" alt=\"X axis\"></a></p>\n"}], "owner": {"reputation": 23, "user_id": 9599118, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ryan Nguyen", "link": "https://stackoverflow.com/users/9599118/ryan-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 666, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1528440116, "creation_date": 1528309369, "last_edit_date": 1528313951, "question_id": 50727123, "link": "https://stackoverflow.com/questions/50727123/spin-button-for-showing-month-by-month-on-chart-graph", "title": "Spin button for showing Month by Month on Chart Graph", "body": "<p>So i have the template layout in the picture attached below. I would like to know how to link the Spin button to able to show month by month when i click on the spin button. \nHere is the formula i have so far, everything working fine except for the chart doesn't connect to the spin.</p>\n\n<pre><code>E4 formula : =\"Monthly \"&amp;E5&amp;\" - Audit Sheet Delivery\"\ndata for eat month for LATE row:=IFERROR(VLOOKUP(G3,$A$4:$C$6000,2,FALSE),\" \")\nSame for On-Time:=IFERROR(VLOOKUP(G3,$A$4:$C$6000,3,FALSE),\" \")\nSpin button link to cell $E$5\n</code></pre>\n\n<p>I have created define name for each Month, Late and On-Time and linked it to the chart but it doesn't work. \nPlease point out what i have to do in this case. Also, please show the code on here due to i am new to this. Thanks<a href=\"https://i.stack.imgur.com/OOBPi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/OOBPi.png\" alt=\"enter image description here\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/q1B2l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/q1B2l.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "excel", "statusbar"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528352935, "post_id": 50726983, "comment_id": 88476336, "body": "How is it possible that you did not find an answer on Google? If I <a href=\"https://www.google.com/search?q=excel+vba+hide+status+bar\" rel=\"nofollow noreferrer\">google for &quot;excel vba hide status bar&quot;</a> there is a ton of tutorials plus the official Microsoft documentation on the first page. If you did not find something on Google you used Google wrong."}, {"owner": {"reputation": 27, "user_id": 3124520, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de3903494fd156e6cc0383636478ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Ezequiel Garay", "link": "https://stackoverflow.com/users/3124520/ezequiel-garay"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528386582, "post_id": 50726983, "comment_id": 88498550, "body": "There&#39;s no macro ready to copy-paste to change the state of status bar (shown or hidden) - so you can then assign a keyboard shortcut. Show me a link and I&#39;ll erase this."}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528358257, "post_id": 50726984, "comment_id": 88479316, "body": "You can simply say  If Application.DisplayStatusBar Then   I believe"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528358611, "post_id": 50726984, "comment_id": 88479491, "body": "You can even toggle the state of status bar in one line: <code>Application.DisplayStatusBar = Not Application.DisplayStatusBar</code>"}], "tags": [], "owner": {"reputation": 27, "user_id": 3124520, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de3903494fd156e6cc0383636478ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Ezequiel Garay", "link": "https://stackoverflow.com/users/3124520/ezequiel-garay"}, "is_accepted": false, "score": 0, "last_activity_date": 1528309583, "last_edit_date": 1528309583, "creation_date": 1528308774, "answer_id": 50726984, "question_id": 50726983, "link": "https://stackoverflow.com/questions/50726983/macro-to-show-hide-status-bar-in-excel/50726984#50726984", "title": "Macro to show/hide status bar in excel", "body": "<pre><code>Sub status_bar()\n\n' shortcut: ctrl+shift+k\n\n    If Application.DisplayStatusBar = \"True\" Then\n        Application.DisplayStatusBar = False\n    Else\n        Application.DisplayStatusBar = True\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 3124520, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de3903494fd156e6cc0383636478ac2?s=128&d=identicon&r=PG&f=1", "display_name": "Ezequiel Garay", "link": "https://stackoverflow.com/users/3124520/ezequiel-garay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2419, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1528352638, "creation_date": 1528308774, "last_edit_date": 1528352638, "question_id": 50726983, "link": "https://stackoverflow.com/questions/50726983/macro-to-show-hide-status-bar-in-excel", "title": "Macro to show/hide status bar in excel", "body": "<p>I've been googling this and couldn't find an answer, so I post it for the record, this a macro to show or hide the status bar in excel:</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528308818, "post_id": 50726893, "comment_id": 88462126, "body": "@QHarr will do! Your answer did fix the issue but the code was not provided... I will vote for your answer but also will provide the code as well. Thank you for reminding me!"}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1528308955, "post_id": 50726893, "comment_id": 88462207, "body": "What does the top couple rows of your data (that creates your pivot cache) look like? The error says &quot;PivotTable field name is not valid&quot;, which implies to me that one of the items in the first (header) row is probably a number or some other invalid value to be used as a field name."}, {"owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1528310528, "post_id": 50726893, "comment_id": 88462975, "body": "@PeterT Its a table with the first row as the header and the rest of the rows as the actual values for the table. None of the headers is a number."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528312169, "post_id": 50726893, "comment_id": 88463750, "body": "Make the <code>SData</code> range a table. The data source is rows &amp; columns anyway; an actual <i>named table</i> (&quot;format as table&quot; from the home ribbon) is <i>always</i> a valid pivot table data source - watch how Excel fixes whatever heading is wrong as you convert the range to a table."}, {"owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528314272, "post_id": 50726893, "comment_id": 88464718, "body": "@MathieuGuindon The source data is a formatted table. The code works perfectly for the first 7 Pivot Tables and ignores the 8th one-The one that I put the code for above."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528314440, "post_id": 50726893, "comment_id": 88464798, "body": "Per your code the source data is a string with a hard-coded sheet name and range address, not a <code>ListObject.DataBodyRange</code> which wouldn&#39;t need code changes when the number of rows/columns changes."}, {"owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528315007, "post_id": 50726893, "comment_id": 88465093, "body": "@MathieuGuindon Is it possible for you to submit the code for it? Thank you!!"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528315222, "post_id": 50726893, "comment_id": 88465199, "body": "<code>Dim srcTable As ListObject</code>; <code>Set srcTable = DSheet.ListObjects(&quot;name of the table&quot;)</code>; <code>Dim srcRange As Range</code>; <code>Set srcRange = srcTable.Range</code>; then use <code>srcRange</code> as a source."}, {"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1528318182, "post_id": 50726893, "comment_id": 88466505, "body": "One thing that is not obvious from your code or description is if you&#39;re using the same data range for all eight pivot tables. If so, then you can reuse the same pivot cache for all pivot tables and save that step (and memory)."}, {"owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528393677, "post_id": 50726893, "comment_id": 88502190, "body": "@MathieuGuindon I dont know the name of my table. How can I figure that out?"}, {"owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1528393681, "post_id": 50726893, "comment_id": 88502194, "body": "@PeterT I tried to store the pivot cache and it doesnt work. My PTable [Pivot Table &quot;InfoView Cases&quot;] seems to be = Nothing."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528393761, "post_id": 50726893, "comment_id": 88502233, "body": "If there&#39;s only 1 table then index <code>1</code> will do. Otherwise you can see it near the top-left corner of Excel when you&#39;re in it, under the dynamic &quot;Table Tools&quot; ribbon tab."}, {"owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528674059, "post_id": 50726893, "comment_id": 88584215, "body": "@MathieuGuindon your answer worked! Thank you! Can you make your answer in an answer format so I can vote for it?"}], "answers": [{"tags": [], "owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "is_accepted": true, "score": 0, "last_activity_date": 1528674477, "creation_date": 1528674477, "answer_id": 50789018, "question_id": 50726893, "link": "https://stackoverflow.com/questions/50726893/run-time-error-1004-the-pivottable-field-name-is-not-valid/50789018#50789018", "title": "Run-time error &#39;1004&#39;: The PivotTable field name is not valid", "body": "<p>This answer was provided by Mathieu Guindon:</p>\n\n<pre><code>Dim srcRange As Range\nsTable = \"DataTable\"\n   Set ListObj = ActiveSheet.ListObjects.Add(xlSrcRange, [A1].CurrentRegion, , xlYes)\n   ListObj.Name = sTable 'The name for the table\n   ListObj.TableStyle = \"TableStyleDark8\"\nDim srcRange_s As String\n srcRange_s = ActiveSheet.ListObjects(\"DataTable\")\n\n'Pivot Table 8\n'Pivot Table 8\n'Pivot Table 8\n\n'Define Pivot Cache and Insert Pivot Table\nSet PCache = ActiveWorkbook.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=srcRange_s)\n\nSet PTable = PCache.CreatePivotTable(Range(\"Y4\"), TableName:=\"InfoView Cases\")\n'Add Fields\nWith ActiveSheet.PivotTables(\"InfoView Cases\")\n .SmallGrid = False\n 'Add Days to Row Field\n With .PivotFields(\"Age of Case\")\n .Orientation = xlRowField\n .Position = 1\n End With\n 'Add PR ID to Values Field\n With .PivotFields(\"PR ID\")\n .Orientation = xlDataField\n .Function = xlCount\n .Position = 1\n End With\n 'Add Filter\n With .PivotFields(\"SAP Notification\")\n .Orientation = xlPageField\n .Position = 1\n End With\n</code></pre>\n"}], "owner": {"reputation": 113, "user_id": 6525460, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-TtuRYZl-wt8/AAAAAAAAAAI/AAAAAAAAABI/LGJ7UM8bIIw/photo.jpg?sz=128", "display_name": "Myriam Diaz Martinez", "link": "https://stackoverflow.com/users/6525460/myriam-diaz-martinez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2473, "favorite_count": 0, "accepted_answer_id": 50789018, "answer_count": 1, "score": 0, "last_activity_date": 1528674477, "creation_date": 1528308434, "last_edit_date": 1531164843, "question_id": 50726893, "link": "https://stackoverflow.com/questions/50726893/run-time-error-1004-the-pivottable-field-name-is-not-valid", "title": "Run-time error &#39;1004&#39;: The PivotTable field name is not valid", "body": "<p>I am creating an 8th Pivot Table in the same spreadsheet and I am getting the following error for the LAST PIVOT TABLE:</p>\n\n<p><strong>\"Run-time error '1004':\nThe PivotTable field name is not valid. To create a PivotTable report you must use data that is organized as a list of labeled columns. If you are changing the name of a PivotTable field, you must type a new name for the field.\n\"</strong> </p>\n\n<p>However, I have tried to change the name of Pivot Table several times and the issue has not been resolved. </p>\n\n<p>My code is as follows:</p>\n\n<pre><code>Sub Macro1()\n'Pivot Table 8\n'Declare Variables\nDim PSheet As Worksheet\nDim DSheet As Worksheet\nDim LastRow As String\nDim LastCol As String\nDim SData As String\nDim PCache As PivotCache\nDim PTable As PivotTable\n\nSet PSheet = Worksheets(\"US MASTER\")\nSet DSheet = Worksheets(\"US Master Macro\")\n\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nSData = \"'US Master Macro'!R1C1:R\" &amp; LastRow &amp; \"C\" &amp; LastCol\n\nSet PCache = ActiveWorkbook.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=SData)\n\nSet PTable = PCache.CreatePivotTable(TableDestination:=Worksheets(\"US MASTER\").Range(\"Y4\"), TableName:=\"InfoView Cases\")\n\nWith ActiveSheet.PivotTables(\"InfoView Cases\")\n .SmallGrid = False\n 'Add Days to Row Field\n With .PivotFields(\"Age of Case\")\n .Orientation = xlRowField\n .Position = 1\n End With\n 'Add PR ID to Values Field\n With .PivotFields(\"PR ID\")\n .Orientation = xlDataField\n .Function = xlCount\n .Position = 1\n End With\n 'Add Filter\n With .PivotFields(\"SAP Notification\")\n .Orientation = xlPageField\n .Position = 1\n End With\n 'Add Filter\n With .PivotFields(\"Case Status\")\n .Orientation = xlPageField\n .Position = 2\n End With\nEnd With\n\n'Deselect Filter\n\n    l = ActiveSheet.PivotTables(\"InfoView Cases\").PivotFields(\"SAP Notification\"). _\n        PivotItems.Count - 1\n\n    For k = 1 To l\n        With ActiveSheet.PivotTables(\"InfoView Cases\").PivotFields(\"SAP Notification\")\n            .PivotItems(k).Visible = False\n        End With\n    Next k\n\n        With ActiveSheet.PivotTables(\"InfoView Cases\").PivotFields(\"SAP Notification\")\n            .PivotItems(\"(blank)\").Visible = True\n        End With\n\n'Deselect Filter\n\n    n = ActiveSheet.PivotTables(\"InfoView Cases\").PivotFields(\"Case Status\"). _\n        PivotItems.Count - 1\n\n    For m = 1 To n\n        With ActiveSheet.PivotTables(\"InfoView Cases\").PivotFields(\"Case Status\")\n            .PivotItems(m).Visible = False\n        End With\n    Next m\n\n        With ActiveSheet.PivotTables(\"InfoView Cases\").PivotFields(\"Case Status\")\n            .PivotItems(\"(blank)\").Visible = True\n        End With\n\n\n'Add InfoView Cases\nPSheet.Range(\"Y3\").Value = \"InfoView Cases\"\nPSheet.Range(\"Y4\").Value = \"Days\"\n'Merge\nPSheet.Range(\"Y3:Z3\").Merge\n\n'Sort Pivot Table\n    Range(\"Y5:Y100\").Select\n    ActiveSheet.PivotTables(\"InfoView Cases\").PivotFields(\"Age of Case\").AutoSort _\n        xlAscending, \"Age of Case\"\n\n\nEnd Sub\n</code></pre>\n\n<p>My code breaks in the line</p>\n\n<pre><code>Set PTable = PCache.CreatePivotTable(TableDestination:=Worksheets(\"US MASTER\").Range(\"Y4\"), TableName:=\"InfoView Cases\")\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "edited": false, "score": 0, "creation_date": 1528308736, "post_id": 50726918, "comment_id": 88462089, "body": "are your sure pal, I can use declaration? because I haven&#39;t yet tested it but My friend is confidently said it will throw an error. and yes thank you for the quick reply."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1528308867, "post_id": 50726918, "comment_id": 88462159, "body": "I think this is really nothing but a google question  <a href=\"https://msdn.microsoft.com/en-us/VBA/Language-Reference-VBA/articles/longptr-data-type\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/VBA/Language-Reference-VBA/articles&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "reply_to_user": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "edited": false, "score": 1, "creation_date": 1528308933, "post_id": 50726918, "comment_id": 88462193, "body": "@KamalBharakhda Yes, I am sure that you can use this declaration. That is precisely the reason why <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/understanding-conditional-compilation\" rel=\"nofollow noreferrer\">conditional compilation</a> exists."}, {"owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "reply_to_user": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1528314852, "post_id": 50726918, "comment_id": 88464997, "body": "@Storax, pal, you have not understood my question properly. I have already googled this query and went through the same page, but they said, we can use LongPtr only on 2010 or after. Now, if I want to distribute my workbook to the clients, and if they have the earlier version where their system will not support the LongPtr data type then what? So, to make my application more portable I have placed here my query so I can find whether I&#39;m going in the right direction or not? If you have downvote my question then please upvote it. thanks."}, {"owner": {"reputation": 8301, "user_id": 6600940, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vI6Fn.jpg?s=128&g=1", "display_name": "Storax", "link": "https://stackoverflow.com/users/6600940/storax"}, "edited": false, "score": 0, "creation_date": 1528315443, "post_id": 50726918, "comment_id": 88465302, "body": "I understood the question and you still don&#39;t google. The page I mentioned is a starting point to get to, for example, the following page <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/compiler-constants\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/language-reference-vba/articles&zwnj;&#8203;/&hellip;</a>. And so on and on ..."}], "tags": [], "owner": {"reputation": 70686, "user_id": 11683, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d4d284c3c214d52f004df795aee394e3?s=128&d=identicon&r=PG", "display_name": "GSerg", "link": "https://stackoverflow.com/users/11683/gserg"}, "is_accepted": true, "score": 1, "last_activity_date": 1528308524, "creation_date": 1528308524, "answer_id": 50726918, "question_id": 50726873, "link": "https://stackoverflow.com/questions/50726873/longptr-datatype-for-vb6-and-vb7/50726918#50726918", "title": "Longptr datatype for VB6 and VB7", "body": "<blockquote>\n<pre><code>#If VBA7 Then\n    Dim X As LongPtr\n#Else\n    Dim X As Long\n#End If\n</code></pre>\n  \n  <p>Should I use above declaration? Will it cause the error?</p>\n</blockquote>\n\n<p>Yes, you should use the above declaration, and it will not cause an error, even in an ancient version of Office.</p>\n\n<p>However, you should understand when and why you need to use <code>LongPtr</code> instead of <code>Long</code> to begin with.<br>\n<code>Long</code> exists in all versions and means the same thing in all versions (32-bit integer). You should not change it to <code>LongPtr</code> for the sake of it. You should only use <code>LongPtr</code> for pointers or pointer-sized data types.</p>\n"}], "owner": {"reputation": 120, "user_id": 5671265, "user_type": "registered", "profile_image": "https://graph.facebook.com/1218282431520363/picture?type=large", "display_name": "Kamal Bharakhda", "link": "https://stackoverflow.com/users/5671265/kamal-bharakhda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 50726918, "answer_count": 1, "score": -1, "last_activity_date": 1528308554, "creation_date": 1528308361, "last_edit_date": 1592644375, "question_id": 50726873, "link": "https://stackoverflow.com/questions/50726873/longptr-datatype-for-vb6-and-vb7", "title": "Longptr datatype for VB6 and VB7", "body": "<p>What issue I'm facing is, I want to distribute one of my Excel VBA Template. Almost in all procedure, I have assigned LONG datatype. but, I found that for VBA7 or 2010 and later version, we can use LongPtr datatype for assigning. which will bypass the versioning issue. whether it will be a 64bit or 32bit of MS office.</p>\n<p>But one my mate has pointed out I can't use LongPtr for VB6 or for lower of 2010 office.</p>\n<p>So I have tried to use in the way to make it more usable for any office version</p>\n<pre><code>#If VBA7 Then\n    Dim X As LongPtr\n#Else\n    Dim X As Long\n#End If\n</code></pre>\n<p>Should I use above declaration? Will it cause the error? According to my friend, It will cause. He also added that compiler will bypass the if statement.</p>\n<p>I don't have a system to test it.</p>\n<p>My current system is,</p>\n<blockquote>\n<p>Windows 10 64bit</p>\n<p>MS Office 2016 32bit</p>\n</blockquote>\n<p>Please suggest me, where I'm missing the concept. And Why I can't use the above declaration in procedure?</p>\n<p>Thank you.</p>\n"}, {"tags": ["vba", "ms-word"], "comments": [{"owner": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1528309509, "post_id": 50726800, "comment_id": 88462483, "body": "What is <code>arControlName</code>... an array?"}, {"owner": {"reputation": 177, "user_id": 3857204, "user_type": "registered", "profile_image": "https://graph.facebook.com/1367903944/picture?type=large", "display_name": "Aaron Baxter", "link": "https://stackoverflow.com/users/3857204/aaron-baxter"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1528309875, "post_id": 50726800, "comment_id": 88462644, "body": "@PeterT Yes.  It&#39;s a <code>Split(ctl.Name, &quot;_&quot;)</code> In this particular case it&#39;s &quot;lblPort1&quot; &quot;13&quot; and &quot;Desc&quot; so that is true.  In addition to the 1st if not being true, the 3rd should error and &quot;Resume Next&quot; since a Label does not have a Value attribute."}, {"owner": {"reputation": 177, "user_id": 3857204, "user_type": "registered", "profile_image": "https://graph.facebook.com/1367903944/picture?type=large", "display_name": "Aaron Baxter", "link": "https://stackoverflow.com/users/3857204/aaron-baxter"}, "reply_to_user": {"reputation": 7101, "user_id": 4717755, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ehiyK.png?s=128&g=1", "display_name": "PeterT", "link": "https://stackoverflow.com/users/4717755/petert"}, "edited": false, "score": 0, "creation_date": 1528310243, "post_id": 50726800, "comment_id": 88462834, "body": "@PeterT Another interesting development.  If I split them out into 3 separate if statements the code works as expected.  See the edit"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528312212, "post_id": 50726800, "comment_id": 88463771, "body": "Is there any reason that the <i>order</i> of evaluation could be playing a role? Hard for us to judge with the information you provide - we just don&#39;t know what all these things represent, exactly. But you might try using () around the first two tests so that they&#39;re evaluated first, before the result is compared to the third? Or test two-by-two, to see where it&#39;s &quot;going wrong&quot;..."}, {"owner": {"reputation": 177, "user_id": 3857204, "user_type": "registered", "profile_image": "https://graph.facebook.com/1367903944/picture?type=large", "display_name": "Aaron Baxter", "link": "https://stackoverflow.com/users/3857204/aaron-baxter"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528312735, "post_id": 50726800, "comment_id": 88464019, "body": "@CindyMeister I don&#39;t see why order would matter with an AND statement as it should be all or nothing.  However that did give me an idea.  If I remove <code>And Trim(Me.Controls(ctl.Name).Value &amp; &quot;&quot;) = &quot;&quot;</code> from the evaluation, it works.  I&#39;ve tired <code>If ((strtmp = &quot;TextBox&quot;) And (arControlName(2) = &quot;Desc&quot;)) And (Trim(Me.Controls(ctl.Name).Value &amp; &quot;&quot;) = &quot;&quot;)</code> and it still returns the whole statement as true even thought one is false.  I&#39;ve even tried making 2 to return false.  Can you not execute a function in an If statement in VBA?"}], "answers": [{"tags": [], "owner": {"reputation": 177, "user_id": 3857204, "user_type": "registered", "profile_image": "https://graph.facebook.com/1367903944/picture?type=large", "display_name": "Aaron Baxter", "link": "https://stackoverflow.com/users/3857204/aaron-baxter"}, "is_accepted": true, "score": 0, "last_activity_date": 1528313197, "creation_date": 1528313197, "answer_id": 50728124, "question_id": 50726800, "link": "https://stackoverflow.com/questions/50726800/if-text-compairson-statement-failing-in-word-vba/50728124#50728124", "title": "If text compairson statement failing in Word VBA", "body": "<p>Thanks to the help of the comments that got my brain jogging in a different direction, I've determined the problem. </p>\n\n<p>It apparently has something to do with VBA and not liking to execute certain calls in an If Statement  It seems to work fine putting the <code>TypeName(ctl) = \"TextBox\"</code> in the if statement but not the call to <code>Me.Controls(ctl.Name).Value &amp; \"\"</code>.</p>\n\n<pre><code>strctlTypeName = TypeName(ctl)\nstrctlVal = Trim(Me.Controls(ctl.Name).Value &amp; \"\")\nIf ((strctlTypeName = \"TextBox\") And (arControlName(2) = \"Desc\")) And strctlVal = \"\" Then 'And (Trim(Me.Controls(ctl.Name).Value &amp; \"\") = \"\") Then\n 'Set the value and exit inner for loop\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 3857204, "user_type": "registered", "profile_image": "https://graph.facebook.com/1367903944/picture?type=large", "display_name": "Aaron Baxter", "link": "https://stackoverflow.com/users/3857204/aaron-baxter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24, "favorite_count": 0, "accepted_answer_id": 50728124, "answer_count": 1, "score": 0, "last_activity_date": 1528313197, "creation_date": 1528308135, "last_edit_date": 1528310222, "question_id": 50726800, "link": "https://stackoverflow.com/questions/50726800/if-text-compairson-statement-failing-in-word-vba", "title": "If text compairson statement failing in Word VBA", "body": "<p>I've been fighting with this for a while and I'm not getting why the if statement is returning true when one of the AND statements is obviously false.</p>\n\n<pre><code>strtmp = TypeName(ctl) 'Take for instance (and have verified) this returns String type with the value of Label. However the below is returning true in this case.\nIf (strtmp = \"TextBox\") And (arControlName(2) = \"Desc\") And Trim(Me.Controls(ctl.Name).Value &amp; \"\") = \"\" Then\n 'Do some stuff\nEnd If\n</code></pre>\n\n<p>My problem is the first statement of the if is somehow equating to true OR \"And\" is not working as I expect \"The AND = TRUE if <strong>all</strong> conditions are TRUE. The AND=FALSE if <strong>any</strong> of the conditions are FALSE.\" OR I'm using it wrong?</p>\n\n<p>Perhaps I am simply loosing my marbles as well :)</p>\n\n<p>EDIT: If the statements are broken out into 3 separate If statements (like below), the code works as expected.</p>\n\n<pre><code>If (strtmp = \"TextBox\") Then\n    If (arControlName(2) = \"Desc\") Then\n        If Trim(Me.Controls(ctl.Name).Value &amp; \"\") = \"\" Then\n         ' Set the value and exit loop\n        End If\n    End If\nEnd If\n</code></pre>\n"}, {"tags": ["vba", "excel", "pivot-table"], "answers": [{"tags": [], "owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "is_accepted": true, "score": 1, "last_activity_date": 1528307378, "creation_date": 1528307378, "answer_id": 50726602, "question_id": 50726493, "link": "https://stackoverflow.com/questions/50726493/creating-pivot-table-to-include-decimals-in-the-xlsum-number-format/50726602#50726602", "title": "Creating Pivot Table to Include Decimals in the xlSum number format", "body": "<p>Okay I cant believe I missed this...but I solved my own question shortly after posting.</p>\n\n<p>I just added the decimal to the <code>.NumberFormat =</code> field. Here is the update....</p>\n\n<pre><code>'Insert Data Field\nWith ActiveSheet.PivotTables(\"AR195Totals\").PivotFields(\"Amount\")\n.Orientation = xlDataField\n.Position = 1\n.Function = xlSum\n.NumberFormat = \"#,###.##\"\n.Name = \"Amount \"\nEnd With\n</code></pre>\n\n<p>I'm in awe I didnt notice this earlier...thanks anyway everybody!</p>\n"}], "owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 402, "favorite_count": 0, "accepted_answer_id": 50726602, "answer_count": 1, "score": 0, "last_activity_date": 1528307378, "creation_date": 1528307042, "question_id": 50726493, "link": "https://stackoverflow.com/questions/50726493/creating-pivot-table-to-include-decimals-in-the-xlsum-number-format", "title": "Creating Pivot Table to Include Decimals in the xlSum number format", "body": "<p>I am using some vba code to create a pivot table from scratch. It works almost perfectly, so I'm not looking to overhaul the code. </p>\n\n<p>There is just one issue...the numbers from the data include decimals, but once I create the pivot table, the numbers in the table do not include the decimal places, including the grand total.</p>\n\n<p>I need the table to show the decimals from the original data, especially in the grand total field. After searching the site, I havent been able to find anything down to this level of detail on pivot table VBA. Here is the VBA I'm currently using.</p>\n\n<pre><code>Sub Pivot_Table()\n\nDim PSheet As Worksheet\nDim DSheet As Worksheet\nDim PCache As PivotCache\nDim PTable As PivotTable\nDim PRange As Range\nDim LastRow As Long\nDim LastCol As Long\n\n'Insert a New Blank Worksheet\nOn Error Resume Next\nApplication.DisplayAlerts = False\nWorksheets(\"Cash AR195\").Delete\nSheets.Add Before:=ActiveSheet\nActiveSheet.Name = \"Cash AR195\"\nApplication.DisplayAlerts = True\nSet PSheet = Worksheets(\"Cash AR195\")\nSet DSheet = Worksheets(\"AR195 Detail\")\n\n'Define Data Range\nLastRow = DSheet.Cells(Rows.Count, 1).End(xlUp).Row\nLastCol = DSheet.Cells(1, Columns.Count).End(xlToLeft).Column\nSet PRange = DSheet.Cells(1, 1).Resize(LastRow, LastCol)\n\n'Define Pivot Cache\nSet PCache = ActiveWorkbook.PivotCaches.Create _\n(SourceType:=xlDatabase, SourceData:=PRange). _\nCreatePivotTable(TableDestination:=PSheet.Cells(2, 2), _\nTableName:=\"AR195Totals\")\n\n'Insert Blank Pivot Table\nSet PTable = PCache.CreatePivotTable _\n(TableDestination:=PSheet.Cells(1, 1), TableName:=\"AR195Totals\")\n\n'Insert Row Fields\nWith ActiveSheet.PivotTables(\"AR195Totals\").PivotFields(\"Batch #\")\n.Orientation = xlRowField\n.Position = 1\n.Name = \"Batch # \"\nEnd With\n\n'Insert Data Field\nWith ActiveSheet.PivotTables(\"AR195Totals\").PivotFields(\"Amount\")\n.Orientation = xlDataField\n.Position = 1\n.Function = xlSum\n.NumberFormat = \"#,##0\"\n.Name = \"Amount \"\nEnd With\n\n'Format Pivot Table\nActiveSheet.PivotTables(\"AR195Totals\").ShowTableStyleRowStripes = True\nActiveSheet.PivotTables(\"AR195Totals\").TableStyle2 = \"PivotStyleMedium9\"\n\nEnd Sub\n</code></pre>\n\n<p>I'll also include some images of the data fields, and the pivot table after I run the VBA.</p>\n\n<p><a href=\"https://i.stack.imgur.com/I16XD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/I16XD.png\" alt=\"The Original Data\"></a></p>\n\n<p><a href=\"https://i.stack.imgur.com/eswSz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eswSz.png\" alt=\"Pivot Table Data\"></a></p>\n\n<p>This might seem minor, but I absolutely need to include the decimal. Its probably something very simple I missed, but I'm struggling to get the correct number format to include the decimal in the final product (pivot table). </p>\n\n<p>Thank you for any help in advance, I appreciate it greatly!</p>\n"}, {"tags": ["json", "vba", "excel", "vbscript"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528307651, "post_id": 50726467, "comment_id": 88461551, "body": "You should be exporting the whole <code>JSON</code> object, not just one part of it.  Did you delete your previous queston?"}, {"owner": {"reputation": 303, "user_id": 6186911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ff1728afc7812e86ff0fdcfddfbdb07?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Jones", "link": "https://stackoverflow.com/users/6186911/kevin-jones"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528307870, "post_id": 50726467, "comment_id": 88461659, "body": "How would I do the whole JSON object"}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1528308232, "post_id": 50726467, "comment_id": 88461834, "body": "<code>Write #1, JsonConverter.ConvertToJson(JSON, Whitespace:=2)</code>   <a href=\"https://github.com/VBA-tools/VBA-JSON\" rel=\"nofollow noreferrer\">github.com/VBA-tools/VBA-JSON</a>"}, {"owner": {"reputation": 303, "user_id": 6186911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ff1728afc7812e86ff0fdcfddfbdb07?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Jones", "link": "https://stackoverflow.com/users/6186911/kevin-jones"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528308501, "post_id": 50726467, "comment_id": 88461964, "body": "...wow mind blown, put it as the answer so I can reward you"}], "answers": [{"tags": [], "owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "is_accepted": true, "score": 2, "last_activity_date": 1528309013, "creation_date": 1528309013, "answer_id": 50727042, "question_id": 50726467, "link": "https://stackoverflow.com/questions/50726467/modifying-vba-json-file/50727042#50727042", "title": "Modifying VBA JSON File", "body": "<p>You should be exporting the whole <code>JSON</code> object, not just one part of it.</p>\n\n<pre><code>Write #1, JsonConverter.ConvertToJson(JSON, Whitespace:=2)\n</code></pre>\n"}], "owner": {"reputation": 303, "user_id": 6186911, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0ff1728afc7812e86ff0fdcfddfbdb07?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Jones", "link": "https://stackoverflow.com/users/6186911/kevin-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 783, "favorite_count": 0, "accepted_answer_id": 50727042, "answer_count": 1, "score": 1, "last_activity_date": 1528309013, "creation_date": 1528306932, "last_edit_date": 1531164843, "question_id": 50726467, "link": "https://stackoverflow.com/questions/50726467/modifying-vba-json-file", "title": "Modifying VBA JSON File", "body": "<p>I want to modify a JSON file in excel using vba.</p>\n\n<p>So I have this JSON file</p>\n\n<pre><code>{\n    \"root\": [{\n        \"STATUS_RESPONSE\": {\n            \"STATUS\": {\n                \"STATUS\": {\n                    \"OWNER\": \"root\",\n                }\n            },\n            \"REQ_ID\": \"00000\",\n            \"RESULT\": [{\n                \"USER\": {\n                    \"BUSINESS_ID\": \"A\",\n                    \"USER_NUMBER\": \"45\",\n                    \"LANGUAGE\": \"F\",\n                }\n            },\n            {\n                \"USER_SESSION\": {\n                    \"USER_ID\": \"0000001009\",\n                    \"HELP_URL\": \"http://google.com\",\n                }\n            },\n            {\n                \"USER_ACCESS\": {\n                    \"SERVICES_ROLE\": \"true\",\n                    \"JOURNALLING\": \"true\",\n\n                }\n            }]\n        }\n    }]\n}\n</code></pre>\n\n<p>I want to modify just the \"BUSINESS_ID\"</p>\n\n<p>Then I can export to the same JSON file using this</p>\n\n<pre><code>   Private Sub CommandButton2_Click()\nDim rng As Range, items As New Collection, myitem As New Dictionary, i As Integer, cell As Variant, myfile As String\nDim FSO As New FileSystemObject\nDim buss As String\nDim JsonTS As TextStream\nSet rng = Range(\"A2\")\nSet JsonTS = FSO.OpenTextFile(\"test.json\", ForReading)\nJsonText = JsonTS.ReadAll\nJsonTS.Close\nSet JSON = ParseJson(JsonText)\nJSON(\"root\")(1)(\"STATUS_RESPONSE\")(\"RESULT\")(1)(\"USER\")(\"BUSINESS_ID\") = Sheets(1).Cells(2, 1).Value\nbuss = JSON(\"root\")(1)(\"STATUS_RESPONSE\")(\"RESULT\")(1)(\"USER\")(\"BUSINESS_ID\")\nmyfile = \"test.json\"\nOpen myfile For Output As #1\nWrite #1, buss\nClose #1\nEnd Sub\n</code></pre>\n\n<p>I can edit the cell and this would replace the JSON file but it takes away the whole structure from the JSON file above. </p>\n\n<p>I get something similar to this like in the json file if I change the business id to C:</p>\n\n<pre><code>\"C\"\n</code></pre>\n\n<p>Is there a way that I can just modify the thing I need in the existing file without everything else disappearing </p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1528306928, "post_id": 50726441, "comment_id": 88461154, "body": "Why not have the user chose the workbook and then choose the worksheet within that workbook, then you do not care about the names?  Then you can begin your macro processing on the selected worksheet.  I say this because I have a similar project where a user must specify 3 workbooks and worksheets in prompted order so that they can be &quot;merged/processed&quot;."}, {"owner": {"reputation": 1, "user_id": 9904828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ktyclr3MDy8/AAAAAAAAAAI/AAAAAAAAAHM/QR2jXIOntZE/photo.jpg?sz=128", "display_name": "Lacey LaDue", "link": "https://stackoverflow.com/users/9904828/lacey-ladue"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1528307251, "post_id": 50726441, "comment_id": 88461320, "body": "That&#39;s new territory for me .. how would I have the user specify them?"}, {"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1528307517, "post_id": 50726441, "comment_id": 88461479, "body": "Part 1 initiates a file selection dialogue, Part 2 is a little more tricky: usually a user form with a listbox (with worksheet names).  But here is another idea, are the worksheets in the selected workbook always in the right order? 7 workdays and then a summary worksheet (you said 8 worksheets).  Then you could ignore the names and use the worksheet position number (warning: this is not foolproof, if a user switches up the tab positions, the macro will no provide the desired results)."}, {"owner": {"reputation": 1, "user_id": 9904828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ktyclr3MDy8/AAAAAAAAAAI/AAAAAAAAAHM/QR2jXIOntZE/photo.jpg?sz=128", "display_name": "Lacey LaDue", "link": "https://stackoverflow.com/users/9904828/lacey-ladue"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1528307993, "post_id": 50726441, "comment_id": 88461723, "body": "Yes, they are always in the same order.  Summary sheet, followed by the 7 days of the given week."}, {"owner": {"reputation": 1, "user_id": 9904828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ktyclr3MDy8/AAAAAAAAAAI/AAAAAAAAAHM/QR2jXIOntZE/photo.jpg?sz=128", "display_name": "Lacey LaDue", "link": "https://stackoverflow.com/users/9904828/lacey-ladue"}, "reply_to_user": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1528309916, "post_id": 50726441, "comment_id": 88462662, "body": "Wookies-Will-Code, I don&#39;t believe that having a listbox with the worksheet names is the most feasible option.  I&#39;d end up with 365 as each tab is daily data.  The worksheet positioning idea seems like the better option.  Could you provide me any direction on how to do that?  Also, how do I get around the fact that the filename itself is different each week?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528353227, "post_id": 50726441, "comment_id": 88476474, "body": "@LaceyLaDue I recommend reading <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>. It solves many issues, makes your code much shorter (easier to maintain) a lot faster and more reliable/stable."}], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "edited": false, "score": 0, "creation_date": 1528311227, "post_id": 50727601, "comment_id": 88463309, "body": "If you want to copy the tabs from the selected workbook into your master workbook rather than specific data ranges, that is a different plan of attack, file selection is the same though."}], "tags": [], "owner": {"reputation": 715, "user_id": 8716187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9d379e724336936aa82cb81f348ef72?s=128&d=identicon&r=PG&f=1", "display_name": "Wookies-Will-Code", "link": "https://stackoverflow.com/users/8716187/wookies-will-code"}, "is_accepted": false, "score": 0, "last_activity_date": 1528311152, "creation_date": 1528311152, "answer_id": 50727601, "question_id": 50726441, "link": "https://stackoverflow.com/questions/50726441/macro-to-copy-data-from-one-workbook-to-another/50727601#50727601", "title": "Macro to copy data from one workbook to another", "body": "<p>@Lacey LaDue, I can't really make good sense of the copy and paste ranges but I know what you are doing, defining the range of the copy sheet, selected a cell in your master sheet and pasting it in.</p>\n\n<p>365 tabs?  I thought you were doing this weekly?</p>\n\n<p>You could always copy tab (worksheets) themselves but it looks like you are putting a weeks data on a single master sheet page.</p>\n\n<p>Here is the frame work in one sub (macro) but I did not perform the copy and paste for each worksheet into your master worksheet / workbook, but this gets you close as it shows you how to get the file, open the file, and then walk through the worksheets 1 at a time and perform tasks on them.</p>\n\n<p>I would need to know more about the copysheet and the master sheet to do the detail work. I hop this helps you out.  I am guessing your macro code is from the macro recorder because of all of the selects.</p>\n\n<pre><code>Option Explicit\n\n'Sub to get the Current urFileName\nPrivate Sub getFN()\n\n    Dim Finfo As String\n    Dim FilterIndex As Long\n    Dim Title As String\n\n    Dim CopyBook As Workbook    'Workbook to copy from\n    Dim CopySheet As Worksheet  'Worksheet to copy from\n    Dim FN As Variant           'File Name\n    Dim wsNum As Double         'worksheet # as you move through the Copy Book\n    Dim cwsLastRow As Long      'copy worksheet last row\n    Dim mwsLastRow As Long      'master worksheet last row\n    Dim masterWS As Worksheet   'thisworkbook, your master worksheet\n\n    Set masterWS = ThisWorkbook.Worksheets(\"Master Security Logs\")\n\n    'Set up file filter\n    Finfo = \"Excel Files (*.xls*),*.xls*\"\n    'Set filter index to Excel Files by default in case more are added\n    FilterIndex = 1\n    ' set Caption for dialogue box\n    Title = \"Select the Current AP Reconcile Workbook\"\n\n    'get the Forecast Filename\n    FN = Application.GetOpenFilename(Finfo, FilterIndex, Title)\n\n    'Handle file Selection\n    If FN = False Then\n        MsgBox \"No file was selected.\", vbExclamation, \"Not so fast\"\n    Else\n        'Do your Macro tasks here\n        'Supress Screen Updating but don't so this until you know your code runs well\n        Application.ScreenUpdating = False\n\n        'Open the AP File\n        Workbooks.Open (FN)\n        'Hide the file so it is out of the way\n        Set CopyBook = ActiveWorkbook\n\n        For wsNum = 1 To CopyBook.Sheets.Count 'you stated there will be 8, this is safer\n            'Do your work here, looks like you are copying certain ranges from wach sheet into ThisWorkbook\n            CopySheet = CopyBook.Worksheets(wsNum) '1,2,3,4,5,6,7,8\n\n            'Finds the lastRow in your Copysheet each time through\n            cwsLastRow = CopySheet.Cells(CopySheet.Rows.Count, \"A\").End(xlUp).Row\n\n            'so you would have to keep tabs on what the lastRow of this sheet is too and always start at +1\n            mwsLastRow = masterWS.Cells(masterWS.Rows.Count, \"A\").End(xlUp).Row\n\n            'Do some copy and pasting between copySheet and masterWS based on your ranges\n            'It looks like you copy data from each ws into your single master book worksheet\n\n            'Clear the clipboard before you go around again\n            Application.CutCopyMode = False\n        Next wsNum\n    End If\n\n    'Close the workbook opened for the copy\n    CopyBook.Close savechanges:=False 'Not needed now\n\n    'Screen Updating Back on\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9904828, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Ktyclr3MDy8/AAAAAAAAAAI/AAAAAAAAAHM/QR2jXIOntZE/photo.jpg?sz=128", "display_name": "Lacey LaDue", "link": "https://stackoverflow.com/users/9904828/lacey-ladue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 95, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528353089, "creation_date": 1528306788, "last_edit_date": 1528353089, "question_id": 50726441, "link": "https://stackoverflow.com/questions/50726441/macro-to-copy-data-from-one-workbook-to-another", "title": "Macro to copy data from one workbook to another", "body": "<p>I'm struggling with a macro that I'm trying to create that will pull data into a Master workbook from a different workbook that is updated weekly.</p>\n\n<p>The problem I'm having is that the file I receive weekly is always named differently (updated for the week ending) and 7 of the 8 tabs in the workbook are also named differently (one for each day of the week that applies in that week ending range).</p>\n\n<p>If it was a static file name, the macro is a piece of cake and works perfectly. I've read a great deal on a number of forums about how you can set it the macro to look at an ACTIVE workbook, rather than a specifically named one, but I just can't seem to get that to work.</p>\n\n<p>Below is my macro for the specifically name file; what do I need to do differently so that I can run it on the file I receive each week just by having it open and active?</p>\n\n<pre><code>Sub SecData()\n'\n' SecData Macro\n' Macro to move security badge-in data from weekly file to Master Security Log workbook.  Will overwrite Sheet1\n'\n\n'\n    Sheets(\"Sheet1\").Select\n    Range(\"D2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Selection.EntireRow.Delete\n    Range(\"A2\").Select\n    Windows(\"Framingham counts for the week ending 06-02-18.xlsx\").Activate\n    Sheets(\"05-27\").Select\n    Range(\"D2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToLeft)).Select\n    Selection.Copy\n    Windows(\"Master Security Logs.xlsx\").Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"A13\").Select\n    Windows(\"Framingham counts for the week ending 06-02-18.xlsx\").Activate\n    Sheets(\"05-28\").Select\n    Range(\"D2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToLeft)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(\"Master Security Logs.xlsx\").Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    ActiveWindow.SmallScroll Down:=18\n    Range(\"A32\").Select\n    Windows(\"Framingham counts for the week ending 06-02-18.xlsx\").Activate\n    Sheets(\"05-29\").Select\n    Range(\"D2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToLeft)).Select\n    Range(Selection, Selection.End(xlUp)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(\"Master Security Logs.xlsx\").Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"D32\").Select\n    Selection.End(xlDown).Select\n    ActiveWindow.SmallScroll Down:=18\n    Range(\"A2154\").Select\n    Windows(\"Framingham counts for the week ending 06-02-18.xlsx\").Activate\n    Sheets(\"05-30\").Select\n    Range(\"D2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToLeft)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(\"Master Security Logs.xlsx\").Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"D2154\").Select\n    Selection.End(xlDown).Select\n    ActiveWindow.SmallScroll Down:=9\n    Range(\"A4378\").Select\n    Windows(\"Framingham counts for the week ending 06-02-18.xlsx\").Activate\n    Sheets(\"05-31\").Select\n    Range(\"D2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToLeft)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(\"Master Security Logs.xlsx\").Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"D4378\").Select\n    Selection.End(xlDown).Select\n    ActiveWindow.SmallScroll Down:=12\n    Range(\"A6638\").Select\n    Windows(\"Framingham counts for the week ending 06-02-18.xlsx\").Activate\n    Sheets(\"06-01\").Select\n    Range(\"D2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToLeft)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(\"Master Security Logs.xlsx\").Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    Range(\"D6638\").Select\n    Selection.End(xlDown).Select\n    ActiveWindow.SmallScroll Down:=18\n    Range(\"A8435\").Select\n    Windows(\"Framingham counts for the week ending 06-02-18.xlsx\").Activate\n    Sheets(\"06-02\").Select\n    Range(\"D2\").Select\n    Range(Selection, Selection.End(xlDown)).Select\n    Range(Selection, Selection.End(xlToLeft)).Select\n    Application.CutCopyMode = False\n    Selection.Copy\n    Windows(\"Master Security Logs.xlsx\").Activate\n    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _\n        :=False, Transpose:=False\n    ActiveWindow.ScrollRow = 7397\n    ActiveWindow.ScrollRow = 2466\n    ActiveWindow.ScrollRow = 1\n    Application.CutCopyMode = False\n    ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Add Key:=Range _\n        (\"A1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\n    ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Clear\n    ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort.SortFields.Add Key:=Range _\n        (\"B1\"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _\n        xlSortNormal\n    With ActiveWorkbook.Worksheets(\"Sheet1\").AutoFilter.Sort\n        .Header = xlYes\n        .MatchCase = False\n        .Orientation = xlTopToBottom\n        .SortMethod = xlPinYin\n        .Apply\n    End With\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 9062432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9979426c2a8e2b81f5530d0c4f4b64?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9062432/alex"}, "edited": false, "score": 0, "creation_date": 1528308505, "post_id": 50726412, "comment_id": 88461966, "body": "When I run that code from custom button of email window - it works on that email window. Which is what I want. When I run that code from custom button of main Outlook window while there is a non active email window, it activates email window and works on that. When I run that code from custom button of main Outlook window I want to only affect the main Outlook window and not any other Outlook window. When I run that code from custom button of main Outlook window, on line .WindowState = olNormalWindow it gives &quot;Run-time error 91. Object variable or With block variable not set&quot;"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 55, "user_id": 9062432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9979426c2a8e2b81f5530d0c4f4b64?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9062432/alex"}, "edited": false, "score": 0, "creation_date": 1528309057, "post_id": 50726412, "comment_id": 88462249, "body": "Changed <code>ActiveInspector</code> to <code>ActiveWindow</code> - should have read the title more closely :). I got sidetracked by &quot;(e.g. email)&quot;"}, {"owner": {"reputation": 55, "user_id": 9062432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9979426c2a8e2b81f5530d0c4f4b64?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9062432/alex"}, "edited": false, "score": 0, "creation_date": 1528310632, "post_id": 50726412, "comment_id": 88463041, "body": "I need 3 more rep.points to be able to vote up your answer.  Maybe you could vote up my question?  Thanks anyways, it works a treat. @BigBen"}], "tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": true, "score": 1, "last_activity_date": 1528309011, "last_edit_date": 1528309011, "creation_date": 1528306698, "answer_id": 50726412, "question_id": 50726331, "link": "https://stackoverflow.com/questions/50726331/outlook-2016-vba-to-make-active-window-e-g-email-specific-size-and-location-o/50726412#50726412", "title": "Outlook 2016 VBA to make active window (e.g. email) specific size and location on screen", "body": "<p>Something like this?</p>\n\n<pre><code>Sub ActiveSize()\n    With Application.ActiveWindow\n        .WindowState = olNormalWindow\n        .Top = 0\n        .Left = 972\n        .Width = 468\n        .Height = 780\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9062432, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d9979426c2a8e2b81f5530d0c4f4b64?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/9062432/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 764, "favorite_count": 1, "accepted_answer_id": 50726412, "answer_count": 1, "score": 0, "last_activity_date": 1528464231, "creation_date": 1528306405, "last_edit_date": 1528464231, "question_id": 50726331, "link": "https://stackoverflow.com/questions/50726331/outlook-2016-vba-to-make-active-window-e-g-email-specific-size-and-location-o", "title": "Outlook 2016 VBA to make active window (e.g. email) specific size and location on screen", "body": "<p>I have this in Excel, but simply adding same code into Outlook Module does not do the trick </p>\n\n<pre><code>Sub ActiveSize_1()\nApplication.WindowState = xlNormal\nApplication.Top = 0\nApplication.Left = 972 \nApplication.Width = 468 \nApplication.Height = 780\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "ms-access"], "answers": [{"comments": [{"owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "edited": false, "score": 0, "creation_date": 1528316772, "post_id": 50728361, "comment_id": 88465894, "body": "Thanks. So based on that description, I&#39;d say AccessObject is a sort of stub; a metaobject that just has info about other objects, but not good for much else. Kind of like a small set of offices with a lobby and office doors that open to brick walls, lol."}], "tags": [], "owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "is_accepted": true, "score": 1, "last_activity_date": 1528314242, "creation_date": 1528314242, "answer_id": 50728361, "question_id": 50726293, "link": "https://stackoverflow.com/questions/50726293/in-access-2007-vba-can-unsaved-forms-and-reports-be-typed-as-accessobject/50728361#50728361", "title": "In Access 2007 VBA, can unsaved forms and reports be typed as &#39;AccessObject&#39;..?", "body": "<p>Nope, there's no common interface between the <code>Report</code> and the <code>Form</code> object (except for <code>Object</code>, of course, which can be used for any object. </p>\n\n<p>The <code>AccessObject</code> interface is <em>not</em> used for forms and reports like you normally use them. You can't access things like controls through it. It's mainly used for iterating through database objects (since you can use a common interface for iterating through forms, macros, modules and reports).</p>\n\n<p>If you want to modify forms and reports created on the fly, and want to store them in the same variable, you're limited to the <code>Object</code> type (or <code>Variant</code>, but that's even less specific).</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 11359126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e0fb17351cf29cb166bca2f71bbe1df?s=128&d=identicon&r=PG&f=1", "display_name": "edhdz1", "link": "https://stackoverflow.com/users/11359126/edhdz1"}, "is_accepted": false, "score": 0, "last_activity_date": 1567833128, "last_edit_date": 1567833128, "creation_date": 1567827462, "answer_id": 57830476, "question_id": 50726293, "link": "https://stackoverflow.com/questions/50726293/in-access-2007-vba-can-unsaved-forms-and-reports-be-typed-as-accessobject/57830476#57830476", "title": "In Access 2007 VBA, can unsaved forms and reports be typed as &#39;AccessObject&#39;..?", "body": "<p>Obtain the ability to use intellisense (formally known as picklist) in MS Access Module using VBA to reference the controls of any existing object (Table, Query, Form, Report).</p>\n\n<p>I used to heavily rely on 'Me' and found it to be quite convenient and useful, but never liked its limitations.</p>\n\n<p>The following solution is what I have developed, and implemented across multiple applications that I've worked on, as an alternative to 'Me'.</p>\n\n<pre><code>'Function Declaration to use 'this.':\nDim this As Form_myFormName\nSet this = Mee\n\n'Function Declaration to use 'Mee.':\nDim Mee As Form_myFormName\nSet Mee = this\n\n'Function Code Module:\n\nPublic Property Get Mee() As Object\nOn Error Resume Next\nDim dbApp As ezGetElementBy\nSet dbApp = New ezGetElementBy\n\u00a0 Set Mee = dbApp.obj\nEnd Property\n\nPublic Property Get this() As Object\nOn Error Resume Next\nSet this = Mee\nEnd Property\n\n\n'Class Module: ezGetElementBy\n\nPublic Function obj() As Object\nOn Error GoTo ErrHandler\nDim APP_OBJECT_NAME As String\nDim APP_OBJECT_TYPE As Integer\nDim dbObjectDesc As Variant\n\n\u00a0APP_OBJECT_NAME = Application.CurrentObjectName\n\u00a0APP_OBJECT_TYPE = Application.CurrentObjectType dbObjectDesc = Array(\"Table\", \"Query\", \"Form\", \"Report\", \"Macro\", \"Module\")\n\n\u00a0 AsObjectType = IIf( _\n\u00a0 \u00a0 APP_OBJECT_TYPE = 2 Or APP_OBJECT_TYPE = 3, _\n\u00a0 \u00a0 dbObjectDesc(APP_OBJECT_TYPE), Object _\n\u00a0 )\n\n\u00a0 Select Case APP_OBJECT_TYPE\n\u00a0 \u00a0 Case 0 ' \"Table\"\n\u00a0 \u00a0 \u00a0 Set obj = Screen.ActiveDatasheet\n\u00a0 \u00a0 Case 1 ' \"Query\"\n\u00a0 \u00a0 \u00a0 Set obj = Screen.ActiveDatasheet\n\u00a0 \u00a0 Case 2 ' \"Form\"\n\u00a0 \u00a0 \u00a0 Set obj = Forms(APP_OBJECT_NAME)\n\u00a0 \u00a0 Case 3 ' \"Report\"\n\u00a0 \u00a0 \u00a0 Set obj = Reports(APP_OBJECT_NAME)\n\u00a0 \u00a0 Case Else\n\u00a0 End Select\n\nExit Function\nErrHandler:\nOn Error Resume Next\n\n\u00a0 Select Case APP_OBJECT_TYPE\n\u00a0 \u00a0 Case 0 ' \"Table\"\nAPP_OBJECT_NAME=Screen.ActiveDatasheet.Name\nDoCmd.SelectObject acTable,APP_OBJECT_NAME, True\n\nDoCmd.OpenTable APP_OBJECT_NAME, acViewNormal\nSet obj = Screen.ActiveDatasheet\n\n\u00a0 \u00a0 Case 1 ' \"Query\"\nAPP_OBJECT_NAME=Screen.ActiveDatasheet.Name\n\nDoCmd.SelectObject acQuery,APP_OBJECT_NAME, True\n\nDoCmd.OpenQuery APP_OBJECT_NAME, acViewNormal\n\nSet obj = Screen.ActiveDatasheet\n\n\u00a0 \u00a0 Case 2 ' \"Form\"\nAPP_OBJECT_NAME =Screen.ActiveForm.Name\nDoCmd.SelectObject acForm,APP_OBJECT_NAME, True\n\nDoCmd.OpenForm APP_OBJECT_NAME, acNormal, , , , acWindowNormal\n\nSet obj = Screen.ActiveForm\n\n\u00a0 \u00a0 Case 3 ' \"Report\"\nAPP_OBJECT_NAME=Screen.ActiveReport.Name\n\nDoCmd.SelectObject acReport, APP_OBJECT_NAME, True\n\nDoCmd.OpenReport APP_OBJECT_NAME, acNormal, , , acWindowNormal\nSet obj = Screen.ActiveReport\n\nCase Else\nEnd Select\nExit Function\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 2524, "user_id": 2705042, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/ShRFK.jpg?s=128&g=1", "display_name": "spinjector", "link": "https://stackoverflow.com/users/2705042/spinjector"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 50728361, "answer_count": 2, "score": 0, "last_activity_date": 1594549105, "creation_date": 1528306304, "last_edit_date": 1594549105, "question_id": 50726293, "link": "https://stackoverflow.com/questions/50726293/in-access-2007-vba-can-unsaved-forms-and-reports-be-typed-as-accessobject", "title": "In Access 2007 VBA, can unsaved forms and reports be typed as &#39;AccessObject&#39;..?", "body": "<p>I'm in Access 2007 VBA, creating code which is used to automate the layout &amp; formatting of controls on forms &amp; reports in design view.</p>\n\n<p>In order to streamline my code, I'm trying to reference forms and reports as a common root type, so a single variable \"thisDoc\" can reference them. I thought that would be \"AccessObject\", but it seems not. I get runtime error #13, type mismatch.</p>\n\n<p>Do forms and reports have a common root type..? If so, what is it..?</p>\n\n<p>The type \"Object\" is certainly possible, but I would prefer something closer to the children in the Access object hierarchy. This is to avoid late-binding, and to satisfy my OCD, but mostly to have IntelliSense work properly.</p>\n\n<p>Here's the problem: my code accesses the active form or report currently on screen, which may not yet be saved. As such, they do not yet appear in AllForms or AllReports. And in the case of dynamic forms/reports, they never will.</p>\n\n<p>Here is example code that encapsulates the issue:</p>\n\n<pre><code>dim app      as Access.Application\ndim scr      as Access.Screen\ndim thisDoc  as Access.AccessObject 'but \"As Object\" works ok.\nset app       = Access.Application\nset scr       = app.Screen\nset thisDoc   = scr.ActiveReport     'or .ActiveForm       \n'Runtime error #13: Type Mismatch.\n</code></pre>\n\n<p>As noted, the vartype \"Object\" works, but as I mentioned above, I'd like to at least get a type that's in the Access object hierarchy.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1528306753, "post_id": 50726291, "comment_id": 88461033, "body": "Why dont you change the button to not move or size with cells. This way it is always stationary and you can manipulate it better if you need to."}, {"owner": {"reputation": 103, "user_id": 8122554, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/939313cb40ac81872af575000467a6f4?s=128&d=identicon&r=PG&f=1", "display_name": "N. Whyter", "link": "https://stackoverflow.com/users/8122554/n-whyter"}, "reply_to_user": {"reputation": 1271, "user_id": 7868938, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8faa591f8003d3cc428f152d656d59b0?s=128&d=identicon&r=PG&f=1", "display_name": "Ricardo A", "link": "https://stackoverflow.com/users/7868938/ricardo-a"}, "edited": false, "score": 0, "creation_date": 1528307096, "post_id": 50726291, "comment_id": 88461236, "body": "It needs to move with the row of data it corresponds with."}, {"owner": {"reputation": 5019, "user_id": 8260484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35e7d5435c75864734b3ef3bcbc271e5?s=128&d=identicon&r=PG&f=1", "display_name": "cybernetic.nomad", "link": "https://stackoverflow.com/users/8260484/cybernetic-nomad"}, "edited": false, "score": 1, "creation_date": 1528307499, "post_id": 50726291, "comment_id": 88461468, "body": "If it is just one button, why does its position matter so much? If it is one button for each line of data (if yes, how many? And do they all do the same thing, but to different lines of data?) then you should probably rethink how to accomplish what it is they do."}, {"owner": {"reputation": 103, "user_id": 8122554, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/939313cb40ac81872af575000467a6f4?s=128&d=identicon&r=PG&f=1", "display_name": "N. Whyter", "link": "https://stackoverflow.com/users/8122554/n-whyter"}, "edited": false, "score": 0, "creation_date": 1528307649, "post_id": 50726291, "comment_id": 88461550, "body": "There are close to one thousand lines of data with a button for each line. They all do the same thing but to different lines of data. I agree that having a button on each line doesn&#39;t make sense, but the person I am building the spreadsheet for wants it that way."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528307741, "post_id": 50726291, "comment_id": 88461595, "body": "Hyperlinks are easier to manage than buttons if data could be sorted or filtered."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528307780, "post_id": 50726291, "comment_id": 88461618, "body": "I&#39;d tell the person that wants it that way that this is Excel, not some web application. Go with <code>=HYPERLINK</code> formulas, not thousands of on-sheet controls... that&#39;s... pretty much <i>begging</i> for the book to get corrupted."}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3259118"}, "is_accepted": false, "score": 0, "last_activity_date": 1528338298, "creation_date": 1528338298, "answer_id": 50732130, "question_id": 50726291, "link": "https://stackoverflow.com/questions/50726291/how-can-i-get-buttons-to-move-when-i-sort-a-list/50732130#50732130", "title": "How can I get buttons to move when I sort a list?", "body": "<p>Rather than use all those buttons, why not use a Private Sub based on a cell selection \u2013 especially if, as you say, the same code is run (albeit for different lines) irrespective of which button is clicked?  The following sub works if any cell in column A in the used range is selected.  Just put your code where I suggest \u2013 then you can dispense with all the buttons.</p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n\nDim LastRow As Long\n\nLastRow = ActiveSheet.UsedRange.Rows(ActiveSheet.UsedRange.Rows.Count).Row\n\n    If Not Intersect(Range(\"A1:A\" &amp; LastRow), Target) Is Nothing Then\n\n      \u2018Put your generic code here\n\n    End If\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 8122554, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/939313cb40ac81872af575000467a6f4?s=128&d=identicon&r=PG&f=1", "display_name": "N. Whyter", "link": "https://stackoverflow.com/users/8122554/n-whyter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 158, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528338298, "creation_date": 1528306295, "question_id": 50726291, "link": "https://stackoverflow.com/questions/50726291/how-can-i-get-buttons-to-move-when-i-sort-a-list", "title": "How can I get buttons to move when I sort a list?", "body": "<p>I have a spreadsheet with buttons for each row of data. One column contains values that can be sorted in ascending order and another column contains a filter that can filter out rows by name. When I run my Sort and Filter macro that accomplishes both of these tasks, the button visibly remains in the same row, but when I click the button to do specific tasks based on the button's row it has moved. I am really lost with this one so I'll include the code that sorts and filters data, along with the code that gets the clicked button's row and column. The buttons' properties are set to move and size with the cell. The button turns a dark grey when its row address has changed for some reason. I have looked around and can't seem to find a solution to this problem... Sorry if I missed something somewhere and thanks in advance for the help. </p>\n\n<p>Code for identifying clicked button's row and column...</p>\n\n<pre><code>Dim b  As Object\n\nSet b = ActiveSheet.Buttons(Application.Caller)\n\nWith b.TopLeftCell\n    task_row = .Row\n    button_col = .Column\nEnd With\n</code></pre>\n\n<p>Code that sorts and filters rows...</p>\n\n<pre><code>Sub Filter_List()\n    ActiveSheet.Range(Cells(start_data_row - 1, 1), Cells(start_data_row +   num_tasks - 1, last_col)).AutoFilter _\n        Field:=name_col, Criteria1:=task_owner\nEnd Sub\n\nSub Sort_List()\n    Range(Cells(start_data_row, 1), Cells(start_data_row + num_tasks - 1, last_col)).Sort _\n        key1:=Range(Cells(start_data_row, days_left_col), Cells(start_data_row, days_left_col)), _\n        order1:=xlAscending\n    Worksheets(sht_name).Range(Cells(start_data_row - 1, days_left_col), Cells(start_data_row + num_tasks - 1, days_left_col)).AutoFilter _\n        Field:=days_left_col, Criteria1:=\"&lt;\" &amp; max_days, Operator:=xlAnd\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "checkbox", "userform", "multipage"], "comments": [{"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1528305984, "post_id": 50725702, "comment_id": 88460614, "body": "Needing to move controls around smells funny, this is very likely an X-Y problem. What you need is probably a <code>ListBox</code> control with checkbox style turned on. Simply add items checked in the listbox, and when the user unchecks an item in the listbox, remove that item from the listbox. No control moves anywhere."}, {"owner": {"reputation": 1, "user_id": 9904541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72579afdb544827c35b3f0dc91da83b?s=128&d=identicon&r=PG&f=1", "display_name": "Vergil", "link": "https://stackoverflow.com/users/9904541/vergil"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528308183, "post_id": 50725702, "comment_id": 88461812, "body": "Thanks Mathieu, I will try to use the ListBox. Actually I don&#39;t want the listbox to dissapear when unchecked.  I have 70+ checkboxes. Each checkbox selection generates a different section in the Word document. (I will add screenshots of what I have achieved and want to achieve a couple hours later)  Using the filter I hide the checkboxes that do not contain the searchword. I am able to reposition the checkboxes, just that it&#39;s not possible to reposition the checkbox on page1 instead of page2 of the multipage.  I will experiment with the ListBox and see if It&#39;s possible to achieve it."}], "owner": {"reputation": 1, "user_id": 9904541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a72579afdb544827c35b3f0dc91da83b?s=128&d=identicon&r=PG&f=1", "display_name": "Vergil", "link": "https://stackoverflow.com/users/9904541/vergil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528379198, "creation_date": 1528304009, "last_edit_date": 1528379198, "question_id": 50725702, "link": "https://stackoverflow.com/questions/50725702/how-to-move-a-checkbox-from-page1-to-page-2-of-a-multipage1-in-word-vba-userform", "title": "How to move a checkbox from page1 to page 2 of a multipage1 in Word-VBA Userform?", "body": "<p>I'm working on a searchfilter on 70+ checkbox choices. On each page from a multipage I've generated 44 checkboxes from an excel sheet.</p>\n\n<p>I'm almost done with the searchfilter.\nMy only issue is that I can't find a way to move a checkbox on page2 to page1 of a multipage.</p>\n\n<p>Moving the checkbox to page1 will preserve the selection of the checkboxes so that is the reason to NOT generate the checkboxes again.\nAnother reason is that the generation of checkboxes is will freeze the userform for a couple seconds.</p>\n\n<p>Currently I've the following idea to move the checkbox on page2 to page1:</p>\n\n<pre><code>C.Parent.Name = \"Page\" &amp;VAR_Sub.curMultipage + 1`    \n</code></pre>\n\n<p>However changing the <code>Parent.Name</code> doesn't seem to move the checkbox to page1.\nI\"ve confirmed that <code>C.Parent.Name</code> was Page2 and it has changed to Page1. C is the checkbox.</p>\n\n<p>The code for looping:</p>\n\n<pre><code>For Each C In UserForm1.MultiPage1.Pages(UserForm1.MultiPage1.Value).Controls\n     `If TypeName(C) = \"CheckBox\" Then\n          VAR_Sub.i = VAR_Sub.i + 1\n          If InStr(1, C.Caption, strSearchTerm, vbTextCompare) = 0 Then\n              C.Visible = False\n          Else\n          C.Visible = True\n          If Var_Sub.i &gt; 44 Then\n              chkName = C.Parent.Name\n              'MsgBox \"OLD\" &amp; chkName\n              C.Parent.Name = \"Page\" &amp; VAR_Sub.curMultiPage + 1\n              chkName = C.Parent.Name\n              'MsgBox \"NEW\" &amp; chkName\n          End If\n         ''Below more positioning code\n             ....\n     End If`\n Next C\n</code></pre>\n\n<p>Thanks in advance and kind regards.\nPS: If my post is lacking something, please give me a heads up. I will improve it.</p>\n\n<p>I try to achieve this:\n<a href=\"https://i.stack.imgur.com/eCqnj.png\" rel=\"nofollow noreferrer\">Wanted result</a></p>\n\n<p>Currently I have achieved the following:\n<a href=\"https://i.stack.imgur.com/YgkSS.png\" rel=\"nofollow noreferrer\">Page1 with generated checkboxes</a>\n<a href=\"https://i.stack.imgur.com/ZzsZ0.png\" rel=\"nofollow noreferrer\">Page2 with generated checkboxes</a>\nUsing the filter results into:\n<a href=\"https://i.stack.imgur.com/Lbh6f.png\" rel=\"nofollow noreferrer\">Page1 after filter</a>\n<a href=\"https://i.stack.imgur.com/111gl.png\" rel=\"nofollow noreferrer\">Page2 after filter</a></p>\n\n<p>As you can see in the images above of what I have achieved, the checkboxes are on a different page of a multipage. Even though the parent.name has been changed to Page1</p>\n\n<p>Added pictures of what I\"m trying to achieve. Currently I\"m trying to achieve the above with a listbox.</p>\n"}, {"tags": ["excel", "vba", "csv"], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 9897600, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/9897600/jonathan"}, "is_accepted": true, "score": 0, "last_activity_date": 1528406154, "creation_date": 1528406154, "answer_id": 50750273, "question_id": 50725682, "link": "https://stackoverflow.com/questions/50725682/looking-through-multiple-csv-files-with-vba/50750273#50750273", "title": "Looking Through Multiple .csv Files with VBA", "body": "<p>Here is the code that does what I was asking about correctly:</p>\n\n<pre><code>Sub finder()\n\nApplication.ScreenUpdating = False\nApplication.EnableEvents = False\n\nWorksheets(\"Sheet1\").Range(\"A5:J200\").Clear\n\n'Use user deffined part number to locate the file\nDim ParNum As String, FilePath As String, FileName As String\nParNum = Worksheets(\"Sheet1\").Cells(2, \"D\").Value\n\n'Variable that represents the file name\nFile = Dir(\"R:\\Series\\Serial No. AC710121\\\" &amp; ParNum &amp; \"\\*.csv\")\n\n'Looks through all the .csv files in the folder\nDo While File &lt;&gt; \"\"\n\n     'Variable that represents the name within the file\n     SheetVar = Left(File, 23)\n     'Variable that represents the file path to the file\n     FilePath = \"R:\\Series\\Serial No. AC710121\\\" &amp; ParNum &amp; \"\\\" &amp; File &amp; \"\"\n\n    'Declare Variables for populated excel sheet\n    Dim Book As Workbook\n    Dim Krange As Range\n    Dim Kcell\n\n    Set Book = Workbooks.Open(FilePath)\n    Set Krange = Book.Sheets(SheetVar).Range(\"A1:A200\")\n\n    'Declare Variables for finder excel sheet (Column D)\n    Dim Drange As Range\n    Dim Dcell\n\n    Set Drange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"D5:D205\")\n\n    'Declare Variables for finder excel sheet (Column C)\n    Dim Crange As Range\n    Dim Ccell\n\n    Set Crange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"C5:C205\")\n\n    'For loop for copying the information and pasting it in Finder\n    For Each Kcell In Krange\n\n        If Kcell.Value = \"IT\" Then\n            Book.Sheets(SheetVar).Range(Kcell.Offset(0, 2), Kcell.Offset(0, 8)).Copy\n\n            For Each Dcell In Drange\n                 If IsEmpty(Dcell.Value) = True And IsEmpty(Dcell.Offset(0, -1).Value) = True Then\n\n                     ThisWorkbook.Sheets(\"Sheet1\").Range(Dcell.Offset(0, 0), Dcell.Offset(0, 8)).PasteSpecial\n\n                    If Dcell.Offset(0, 6).Value = \"OK\" Then\n                        Range(Dcell.Offset(0, 0), Dcell.Offset(0, 6)).Interior.Color = RGB(113, 221, 131)\n                    End If\n\n                    If Dcell.Offset(0, 6).Value &lt;&gt; \"OK\" And IsEmpty(Dcell.Offset(0, 6).Value) = False Then\n                        Range(Dcell.Offset(0, 0), Dcell.Offset(0, 6)).Interior.Color = RGB(221, 100, 120)\n                    End If\n\n                    Exit For\n\n                 End If\n\n            Next Dcell\n\n        End If\n\n        If Kcell.Value = \"DA\" Then\n            Book.Sheets(SheetVar).Range(Kcell.Offset(0, 1), Kcell.Offset(0, 1)).Copy\n\n            For Each Ccell In Crange\n                If IsEmpty(Ccell.Value) = True And IsEmpty(Ccell.Offset(0, 1).Value) = True Then\n                    ThisWorkbook.Sheets(\"Sheet1\").Range(Ccell.Offset(0, 0), Ccell.Offset(0, 0)).PasteSpecial\n                    Exit For\n                End If\n            Next Ccell\n\n        End If\n\n    Next Kcell\n\n    Workbooks(File).Close SaveChanges = False\n\n    File = Dir\n\nLoop\n\nRange(\"C2:J200\").HorizontalAlignment = xlCenter\n'Range(\"F5:F200\").Sort Key1:=Range(\"F5\"), Order1:=xlAscending, Header:=xlNo\n\nEnd Sub\n</code></pre>\n\n<p>I'm sorry if some of the variables are different, but this should be able to highlight the changes that I implemented to get the code to do what I want. I assume there is a more elegant way to go about doing this task, this is just what I came up with.</p>\n\n<p>This code is able to do the following: </p>\n\n<p>It takes a user provided part number, then uses that number to find a folder and then looks through each .csv file in said folder. It goes through the .csv files and copies certain information and then pastes it into the workbook in which the code is saved. </p>\n\n<p>Hope this can help someone down the line.</p>\n"}], "owner": {"reputation": 15, "user_id": 9897600, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/9897600/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 50750273, "answer_count": 1, "score": 0, "last_activity_date": 1528406154, "creation_date": 1528303924, "question_id": 50725682, "link": "https://stackoverflow.com/questions/50725682/looking-through-multiple-csv-files-with-vba", "title": "Looking Through Multiple .csv Files with VBA", "body": "<p>I am trying to make an excel sheet that can look through a .csv file and then copy and paste certain information from that .csv file. I do not know anything about .csv files, but in this case, they look and act like an excel file.</p>\n\n<p>Here is the code that currently looks through a single .csv file (20180426IM-RV0K6OQH5MA2.csv) </p>\n\n<pre><code>Sub finder()\n\nWorksheets(\"Sheet1\").Range(\"A5:J200\").Clear\n\n'Use user deffined part number to locate the folder\nDim ParNum As String, FilePath As String, FileName As String\nParNum = Worksheets(\"Sheet1\").Cells(2, \"D\").Value\nFilePath = \"R:\\Series\\Serial No. AC710121\\\" &amp; ParNum &amp; \"\\20180426IM-RV0K6OQH5MA2.csv\"\n\n'Declare Variables populated excel sheet\nDim Book As Workbook\nDim Brange As Range\nDim Bcell\n\nSet Book = Workbooks.Open(FilePath)\nSet Brange = Book.Sheets(\"20180426IM-RV0K6OQH5MA2\").Range(\"A1:A200\")\n\n'Declare Variables for finder excel sheet\nDim Drange As Range\nDim Dcell\n\nSet Drange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"D5:D205\")\n\n'Declare Variables for finder excel sheet\nDim Crange As Range\nDim Ccell\n\nSet Crange = ThisWorkbook.Sheets(\"Sheet1\").Range(\"C5:C205\")\n\n'For loop for printing in Finder\nFor Each Bcell In Brange\n\nIf Bcell.Value = \"IT\" Then\n    Book.Sheets(\"20180426IM-RV0K6OQH5MA2\").Range(Bcell.Offset(0, 2), Bcell.Offset(0, 8)).Copy\n\n    For Each Dcell In Drange\n        If IsEmpty(Dcell.Value) = True And IsEmpty(Dcell.Offset(0, -1).Value) = True Then\n\n            ThisWorkbook.Sheets(\"Sheet1\").Range(Dcell.Offset(0, 0), Dcell.Offset(0, 8)).PasteSpecial\n        End If\n     Next Dcell       \nEnd If\nNext Bcell\n\n\nEnd Sub    \n</code></pre>\n\n<p>The .csv files are automatically generated, and over time, there will be multiple .csv files in the folder. I would like the code to be able to open one .csv file, do its thing, then open the next .csv file and repeat until all the .csv files in the folder have been looked through. </p>\n\n<p>Also, is there is a way to declare a variable as the name of the file being looked through and have the sheet in that file equal to the variable name? For example, if the file name is \"Bob,\" I would like to declare a variable that is \"Bob\" in order to tell the code that the worksheet in this workbook is also called \"Bob.\"   </p>\n\n<p>I hope this is clear enough. Thanks for your help!  </p>\n"}, {"tags": ["vba", "database", "ms-access"], "comments": [{"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1528331755, "post_id": 50725607, "comment_id": 88470659, "body": "There are many reasons for this issue. Most likely it is your network. Connection loss/intermittence, LAN traffic, power outage, low disk space, etc. while BE was opened. Check with network IT. Be sure to never run Access on non-Windows environments, in WAN connections, hard drives/thumb drives, and internet folders (Dropbox, Google Drive, etc.)."}, {"owner": {"reputation": 103, "user_id": 6296146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2de0e33ef75d6c299851af53b97bdca?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Dommer", "link": "https://stackoverflow.com/users/6296146/michael-dommer"}, "reply_to_user": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1528380848, "post_id": 50725607, "comment_id": 88494545, "body": "Parfait, LAN traffic, disk space, Non-Windows environments, WAN, thumb drives, and internet folders have been eliminated as factors in this case.  The affected systems have been stable for months or years."}, {"owner": {"reputation": 86789, "user_id": 1422451, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/sFFvX.jpg?s=128&g=1", "display_name": "Parfait", "link": "https://stackoverflow.com/users/1422451/parfait"}, "edited": false, "score": 0, "creation_date": 1528381459, "post_id": 50725607, "comment_id": 88495020, "body": "What changed in these stable systems then? Please edit post, describing your architecture and environment. How many BE/FE systems are we discussing here? How many users? MS Office version? OS version? Server version? Otherwise this question is too broad to be answerable."}, {"owner": {"reputation": 1, "user_id": 10956777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56bdc0eb35b7a013dc44efa1eec70b25?s=128&d=identicon&r=PG&f=1", "display_name": "user10956777", "link": "https://stackoverflow.com/users/10956777/user10956777"}, "edited": false, "score": 0, "creation_date": 1586426850, "post_id": 50725607, "comment_id": 108125778, "body": "For a potential solution without editing the registry, see: <a href=\"https://stackoverflow.com/a/61116823/10956777\">stackoverflow.com/a/61116823/10956777</a>"}], "answers": [{"comments": [{"owner": {"reputation": 103, "user_id": 6296146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2de0e33ef75d6c299851af53b97bdca?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Dommer", "link": "https://stackoverflow.com/users/6296146/michael-dommer"}, "edited": false, "score": 0, "creation_date": 1528380895, "post_id": 50736078, "comment_id": 88494586, "body": "Gustav, we will test your suggested registry mod.  Thanks."}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 103, "user_id": 6296146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2de0e33ef75d6c299851af53b97bdca?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Dommer", "link": "https://stackoverflow.com/users/6296146/michael-dommer"}, "edited": false, "score": 0, "creation_date": 1528381755, "post_id": 50736078, "comment_id": 88495261, "body": "I&#39;m just referring. I haven&#39;t seen the issue myself."}, {"owner": {"reputation": 103, "user_id": 6296146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2de0e33ef75d6c299851af53b97bdca?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Dommer", "link": "https://stackoverflow.com/users/6296146/michael-dommer"}, "edited": false, "score": 1, "creation_date": 1528836946, "post_id": 50736078, "comment_id": 88656243, "body": "Applying this suggestion appears to have resolved the &quot;Inconsistent State&#39; issue for us.  Our clients reported no significant change to their systems, but enough of our clients ran into the issue all pretty much at the same time, which coincided with Build 1803 more or less."}, {"owner": {"reputation": 406, "user_id": 1832104, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0d3fc001afdac7d9e52680485ab4468?s=128&d=identicon&r=PG", "display_name": "Hicsy", "link": "https://stackoverflow.com/users/1832104/hicsy"}, "edited": false, "score": 1, "creation_date": 1534911134, "post_id": 50736078, "comment_id": 90869726, "body": "<a href=\"https://support.office.com/en-us/article/access-reports-that-databases-are-in-an-inconsistent-state-%EF%BB%BF-7ec975da-f7a9-4414-a306-d3a7c422dc1d\" rel=\"nofollow noreferrer\">support.office.com/en-us/article/&hellip;</a>"}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 7, "last_activity_date": 1564676937, "last_edit_date": 1592644375, "creation_date": 1528359059, "answer_id": 50736078, "question_id": 50725607, "link": "https://stackoverflow.com/questions/50725607/recent-rash-of-microsoft-access-database-files-in-an-inconsistent-state/50736078#50736078", "title": "Recent rash of Microsoft Access database files in an inconsistent state", "body": "<p>It has recently been reported <a href=\"https://answers.microsoft.com/en-us/msoffice/forum/msoffice_access-mso_winother-msoversion_other/access-database-is-getting-corrupt-again-and-again/d3fcc0a2-7d35-4a09-9269-c5d93ad0031d\" rel=\"nofollow noreferrer\">several</a> <a href=\"https://social.msdn.microsoft.com/Forums/office/en-US/9dcbf0df-d1d8-49cb-8efa-86ef985a17b9/front-end-access-db-constantly-getting-inconsistent-state-error-when-more-than-1-user-opens-it?forum=accessdev\" rel=\"nofollow noreferrer\">times</a>. A very thorough coverage of this issue can be found <a href=\"https://www.devhut.net/2018/06/13/access-bug-database-is-in-an-unrecognized-format/\" rel=\"nofollow noreferrer\">here</a>.</p>\n<p>Strangely, the cure can - at least for some cases - be found in old support threads:</p>\n<p><a href=\"https://social.technet.microsoft.com/Forums/windowsserver/en-US/7336d31b-6c24-468a-9c47-750244ae3a8c/moved-to-server-2012-getting-access-database-corruption?forum=winserverfiles\" rel=\"nofollow noreferrer\">Moved to Server 2012 getting Access Database Corruption</a></p>\n<p><a href=\"https://support.microsoft.com/en-gb/help/2957623/cannot-access-shared-files-or-folders-on-a-drive-in-windows-server-201\" rel=\"nofollow noreferrer\">Cannot access shared files or folders on a drive in Windows Server 2012 or Windows Server 2012 R2</a></p>\n<p>Comments:</p>\n<blockquote>\n<p>It\u2019s a bit strange though as the patch to fix the issue is back in May\n2014 which is already installed on the server.</p>\n<p>I can only think that\nsomething in the latest Windows 10 Build 1803 has brought up the issue\nagain as it was PC\u2019s that are running that build were causing the\nproblem.</p>\n<p>The fix is adding the following entry into Vospers Server\n2012 R2 registry:</p>\n</blockquote>\n<pre><code>Key:   HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Services\\lanmanserver\\parameters\nValue: DisableLeasing\nType:  DWORD\nData:  0x1\n</code></pre>\n<blockquote>\n<p>We testing this on our server and the problem went away. As soon as we\nchanged the \u2018Disable leasing\u2019 value to \u20180\u2019 again, the problem\nreturned.</p>\n<p>I can\u2019t find a reasonable explanation yet as to why this\nhas started to happen last week but if it works and doesn\u2019t cause any\nfurther issues elsewhere then I\u2019m ok with that.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 9997657, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c2fd01cf96f71a02b626c102e0e53762?s=128&d=identicon&r=PG", "display_name": "user9997657", "link": "https://stackoverflow.com/users/9997657/user9997657"}, "is_accepted": false, "score": 1, "last_activity_date": 1530071726, "creation_date": 1530071726, "answer_id": 51054325, "question_id": 50725607, "link": "https://stackoverflow.com/questions/50725607/recent-rash-of-microsoft-access-database-files-in-an-inconsistent-state/51054325#51054325", "title": "Recent rash of Microsoft Access database files in an inconsistent state", "body": "<p>Also note that homegroups have been removed from Win10 1803.  This may affect rights on shared folders.</p>\n"}], "owner": {"reputation": 103, "user_id": 6296146, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2de0e33ef75d6c299851af53b97bdca?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Dommer", "link": "https://stackoverflow.com/users/6296146/michael-dommer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6487, "favorite_count": 1, "protected_date": 1596991917, "accepted_answer_id": 50736078, "answer_count": 2, "score": 7, "last_activity_date": 1596993190, "creation_date": 1528303652, "last_edit_date": 1596993190, "question_id": 50725607, "link": "https://stackoverflow.com/questions/50725607/recent-rash-of-microsoft-access-database-files-in-an-inconsistent-state", "title": "Recent rash of Microsoft Access database files in an inconsistent state", "body": "<p>A large number of our clients operating a split front end/back end Microsoft Access application we built are encountering frequent but intermittent database file corruption issues. When the back end file is opened this message appears: &quot;Microsoft Access has detected that this database is in an inconsistent state, and will attempt to recover the database \u2026 &quot;</p>\n<p>Opening the database with DAO using Visual Basic code results in error code 3343, &quot;Unrecognized database format.&quot;</p>\n<p>The repair attempt succeeds and we have not witnessed any data loss or dropping of primary keys, indexes, or relationships. Most cases involve where the back end file is located on a shared network drive. Some searches suggest that the latest Windows 10 update 1803 is suspect. Has anybody else encountered this?</p>\n"}, {"tags": ["ms-access", "vba", "controls", "visibility", "subforms"], "comments": [{"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1528303811, "post_id": 50725525, "comment_id": 88459450, "body": "<a href=\"http://access.mvps.org/Access/forms/frm0031.htm\" rel=\"nofollow noreferrer\">access.mvps.org/Access/forms/frm0031.htm</a>"}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1528306739, "post_id": 50725525, "comment_id": 88461028, "body": "What line triggers that error? String variables cannot hold Null, only Variant type can. So either declare the variable as Variant or test for empty string: <code>If sfrm = &quot;&quot; Then</code>."}, {"owner": {"reputation": 5, "user_id": 4009391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462a5d53cbd281e70028b4383bc6d9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Rock Darkwater", "link": "https://stackoverflow.com/users/4009391/rock-darkwater"}, "edited": false, "score": 0, "creation_date": 1528311841, "post_id": 50725525, "comment_id": 88463618, "body": "I thought that was it, but it wasn&#39;t. The line that starts &quot;Forms.Form(Report)...&quot; triggers the error. I set the sfrm variable to variant."}], "answers": [{"tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": true, "score": 0, "last_activity_date": 1528315373, "creation_date": 1528315373, "answer_id": 50728651, "question_id": 50725525, "link": "https://stackoverflow.com/questions/50725525/access-vba-change-visibility-of-a-variable-control-in-a-subform/50728651#50728651", "title": "access vba change visibility of a variable control in a subform", "body": "<p>If you type <code>sFrm</code> as <code>String</code> in VBA, it can never be null. Therefore your If statement will not work properly. To fix:</p>\n\n<p>Change your procedure declaration to: </p>\n\n<pre><code>Sub toggleDisappear(ByRef fields() As Variant, _\n    ByVal report As String, ByVal vis As Boolean, Optional ByVal sfrm As Variant)\n</code></pre>\n\n<p>Then, change your If statement to:</p>\n\n<pre><code>If IsMissing(sfrm) Then\n</code></pre>\n\n<p>Now your code can tell when <code>sFrm</code> is not supplied.</p>\n"}], "owner": {"reputation": 5, "user_id": 4009391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/462a5d53cbd281e70028b4383bc6d9f8?s=128&d=identicon&r=PG&f=1", "display_name": "Rock Darkwater", "link": "https://stackoverflow.com/users/4009391/rock-darkwater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 0, "accepted_answer_id": 50728651, "answer_count": 1, "score": 0, "last_activity_date": 1528315373, "creation_date": 1528303374, "question_id": 50725525, "link": "https://stackoverflow.com/questions/50725525/access-vba-change-visibility-of-a-variable-control-in-a-subform", "title": "access vba change visibility of a variable control in a subform", "body": "<p>I'm trying to create a sub that will toggle the visibility of a given array  of controls in a given form location. I've managed to make it work on a main form, but can't figure out the syntax for a subform control. I'm working with Access 2016.</p>\n\n<p>Here's what I have so far:</p>\n\n<pre><code>Sub toggleDisappear(ByRef fields() As Variant, _\n    ByVal report As String, ByVal vis As Boolean, Optional ByVal sfrm As String)\n\nIf IsNull(sfrm) Then\n    For i = 1 To UBound(fields)\n        Forms(report).Controls(fields(i)).Visible = vis\n    Next\nElse\n    For i = 1 To UBound(fields)\n        Forms.Form(report).Controls(sfrm).Form.Controls(fields(i)).Visible = vis\n    Next\nEnd If\n\nEnd Sub\n</code></pre>\n\n<p>Any ideas what I'm missing? I get a run-time error 438 - \"Object doesn't support this property or method.\"</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528303806, "post_id": 50725447, "comment_id": 88459446, "body": "You are basing your last row on column A so check if column A of the copied row has something in it. If it doesn&#39;t, it will overwrite."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528303865, "post_id": 50725447, "comment_id": 88459478, "body": "Your question is unclear.  Perhaps it would help if you included examples of what you have and what you&#39;re want to have when finished.  Also, have you look at the existing questions/answers? There are many similar questions with answers like these: <a href=\"https://stackoverflow.com/search?q=paste+first+empty\">stackoverflow.com/search?q=paste+first+empty</a>  Also I assume you mean &quot;the first empty line&quot; (not the last)."}, {"owner": {"reputation": 1, "user_id": 9904505, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chris R", "link": "https://stackoverflow.com/users/9904505/chris-r"}, "edited": false, "score": 0, "creation_date": 1528304439, "post_id": 50725447, "comment_id": 88459788, "body": "Yes it&#39;s the first empty line ^^ I simply want that each new detection of the word &quot;SAVE_01&quot; in my sheet1 the line is automatically copy / paste in my sheet 3 in continuation (without crushing the preceding)"}, {"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528310103, "post_id": 50725447, "comment_id": 88462753, "body": "Try to qualify the Rows.Count I.E. (sheet(x).Rows.Count) otherwise it will assume you are referencing active sheets Rows."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 9904505, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chris R", "link": "https://stackoverflow.com/users/9904505/chris-r"}, "is_accepted": false, "score": 0, "last_activity_date": 1528307851, "creation_date": 1528307851, "answer_id": 50726731, "question_id": 50725447, "link": "https://stackoverflow.com/questions/50725447/copy-row-if-cell-value-equals-and-paste-after-with-new-line/50726731#50726731", "title": "Copy row if cell value equals and paste after with new line", "body": "<p>I tried like this : </p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n\nIf Target.Value = \"SAVE_01\" Then Target.EntireRow.Copy _\nDestination:=Sheets(\"SAVE_03\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\n\nDim lastrow As Long\nlastrow = Worksheets(\"SAVE_03\").Cells(Rows.Count, \"A\").End(xlUp).Row + 1\nWorksheets(\"SAVE_03\").Cells(lastrow, \"A\").Value = \"*\"\n\nEnd Sub\n</code></pre>\n\n<p>it works but it's not clean and I have to put \"*\" to detect a character. Other worries if I have a shared cell on several lines it puts me an empty cell in the copy</p>\n"}], "owner": {"reputation": 1, "user_id": 9904505, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Chris R", "link": "https://stackoverflow.com/users/9904505/chris-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 317, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1528307851, "creation_date": 1528303138, "last_edit_date": 1528303518, "question_id": 50725447, "link": "https://stackoverflow.com/questions/50725447/copy-row-if-cell-value-equals-and-paste-after-with-new-line", "title": "Copy row if cell value equals and paste after with new line", "body": "<p>I have code that allows me to copy a row of a table if it contains the word <code>SAVE_01</code> in my sheet <code>SAVE_01</code>.  The copied line is then pasted in the sheet <code>SAVE_03</code> but each new line identified with the keyword <code>SAVE_01</code> does not start after the previous one.</p>\n\n<p>The new line detected and overwritten.</p>\n\n<p>Do you know how to detect the last empty line and put the new one after?</p>\n\n<pre><code>Private Sub Worksheet_Change(ByVal Target As Range)\n    If Target.Value = \"SAVE_01\" Then Target.EntireRow.Copy _\n        Destination:=Sheets(\"SAVE_03\").Range(\"A\" &amp; Rows.Count).End(xlUp).Offset(1)\nEnd Sub\n</code></pre>\n"}, {"tags": ["c#", ".net", "vba", "com", "interop"], "comments": [{"owner": {"reputation": 5358, "user_id": 1562451, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/qEhut.jpg?s=128&g=1", "display_name": "Fred", "link": "https://stackoverflow.com/users/1562451/fred"}, "edited": false, "score": 0, "creation_date": 1528303226, "post_id": 50725374, "comment_id": 88459125, "body": "This may help <a href=\"https://stackoverflow.com/questions/19954001/calling-a-net-library-method-from-vba\" title=\"calling a net library method from vba\">stackoverflow.com/questions/19954001/&hellip;</a>"}, {"owner": {"reputation": 116623, "user_id": 403671, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/454HU.jpg?s=128&g=1", "display_name": "Simon Mourier", "link": "https://stackoverflow.com/users/403671/simon-mourier"}, "edited": false, "score": 0, "creation_date": 1528303470, "post_id": 50725374, "comment_id": 88459265, "body": "try <code>regasm.exe your.dll &#47;codebase</code> and make sure the bitness (x86 vs x64) is consistent between your VBA and your DLL."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528303642, "post_id": 50725374, "comment_id": 88459357, "body": "Try <code>regasm.exe your.dll &#47;codebase &#47;tlb</code>, and then reference the .tlb file instead of the .dll."}, {"owner": {"reputation": 870061, "user_id": 17034, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cii6b.png?s=128&g=1", "display_name": "Hans Passant", "link": "https://stackoverflow.com/users/17034/hans-passant"}, "edited": false, "score": 0, "creation_date": 1528306407, "post_id": 50725374, "comment_id": 88460847, "body": "VBA does not know anything about .NET assemblies, it needs the type library for the DLL.  Plays the exact same role as metadata in an assembly.  Should already be present on your dev machine, so just copy it along.  Or have Regasm generate it for you with its /tlb option."}], "answers": [{"tags": [], "owner": {"reputation": 39, "user_id": 7668728, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f27d08460d6f042b7369b35c78139bd4?s=128&d=identicon&r=PG&f=1", "display_name": "patreilly", "link": "https://stackoverflow.com/users/7668728/patreilly"}, "is_accepted": false, "score": 0, "last_activity_date": 1528378542, "creation_date": 1528378542, "answer_id": 50742673, "question_id": 50725374, "link": "https://stackoverflow.com/questions/50725374/register-c-dll-to-use-in-ms-access-vba/50742673#50742673", "title": "Register C# dll to use in MS Access VBA", "body": "<p>As Simon, Mathieu and Hans said in the comments, I needed to use /codebase and reference the .tlb file.</p>\n\n<p>But I also needed to Sign the assembly with a strong name and following this <a href=\"https://docs.microsoft.com/en-us/dotnet/framework/app-domains/how-to-sign-an-assembly-with-a-strong-name\" rel=\"nofollow noreferrer\">article</a> I was able to do so through Visual Studio.</p>\n"}], "owner": {"reputation": 39, "user_id": 7668728, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f27d08460d6f042b7369b35c78139bd4?s=128&d=identicon&r=PG&f=1", "display_name": "patreilly", "link": "https://stackoverflow.com/users/7668728/patreilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 735, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1528378542, "creation_date": 1528302878, "last_edit_date": 1528303032, "question_id": 50725374, "link": "https://stackoverflow.com/questions/50725374/register-c-dll-to-use-in-ms-access-vba", "title": "Register C# dll to use in MS Access VBA", "body": "<p>I have created a class library in C#, called SimpleCalc on Visual Studio that I want to use in Access VBA.</p>\n\n<p>Following this <a href=\"http://www.geeksengine.com/article/create-dll.html\" rel=\"nofollow noreferrer\">article</a> I was able to get it working on development laptop.</p>\n\n<p>However, I am now trying to get it working on an end user's computer but I am having trouble figuring it out. </p>\n\n<p>I took the dll file, that was generated by visual studio when I built the project, and copied it over to the user's computer and then I began trying to register it.</p>\n\n<p>To register I need to use the command regsvr32 but that gave me an error saying that DLL was loaded but DllRegister Server entry point was not found.</p>\n\n<p>So I started using Regasm.exe to register the dll.</p>\n\n<p>That was able to register the dll, but when I tried to add reference in the VBA editor on Access I got an error message that says \"can't add a reference to the specified file\".</p>\n\n<p>Is there anything I overlooked or what should I do?</p>\n"}, {"tags": ["javascript", "vba", "ms-access", "internet-explorer", "ie-automation"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528302860, "post_id": 50725320, "comment_id": 88458926, "body": "<a href=\"https://stackoverflow.com/questions/2856513/how-can-i-trigger-an-onchange-event-manually\" title=\"how can i trigger an onchange event manually\">stackoverflow.com/questions/2856513/&hellip;</a>"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528305479, "post_id": 50725320, "comment_id": 88460343, "body": "Is there an URL to share?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528306160, "post_id": 50725320, "comment_id": 88460716, "body": "Drop the <code>Call</code> keyword."}, {"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528314609, "post_id": 50725320, "comment_id": 88464877, "body": "@MathieuGuindon I dropped, but it didn&#39;t work"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 2, "creation_date": 1528314685, "post_id": 50725320, "comment_id": 88464907, "body": "At least you&#39;re not using VB syntax from the early &#39;90s ;-)"}, {"owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528314773, "post_id": 50725320, "comment_id": 88464964, "body": "@QHarr  Unfortunately, I can&#39;t share the URL, The url is intranet"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7077360, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-lIL4jB60mKQ/AAAAAAAAAAI/AAAAAAAAACA/DUZdestHE_Q/photo.jpg?sz=128", "display_name": "DukeTogo", "link": "https://stackoverflow.com/users/7077360/duketogo"}, "is_accepted": false, "score": 1, "last_activity_date": 1533424988, "creation_date": 1533424988, "answer_id": 51690280, "question_id": 50725320, "link": "https://stackoverflow.com/questions/50725320/call-an-event-from-a-website-using-vba-to-internet-explorer/51690280#51690280", "title": "Call an event from a website - using VBA to Internet Explorer", "body": "<p>Since there is an <code>onChange</code> event associated with the element, dispatching the event should execute it. Give this a try after you populate the input field.</p>\n\n<pre><code>Dim ie as InternetExplorerMedium\nDim ieEvent\nDim htmldoc as HTMLDocument\n\nSet ie = 'however you're setting IE'\nSet htmldoc = ie.document\nSet ieEvent = htmldoc.createEvent(\"HTMLEvents\")\n\nieEvent.initEvent \"change\", False, True\nie.document.all.Item(\"ctl00_ContentPlaceHolder1_txtId\").dispatchEvent ieEvent\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1534054645, "creation_date": 1534054645, "answer_id": 51806261, "question_id": 50725320, "link": "https://stackoverflow.com/questions/50725320/call-an-event-from-a-website-using-vba-to-internet-explorer/51806261#51806261", "title": "Call an event from a website - using VBA to Internet Explorer", "body": "<p>The script you mention is associated with an onkeypress event so you could try:</p>\n\n<pre><code>htmldoc.querySelector(\"input[name='ctl00$ContentPlaceHolder1$txtId']\").FireEvent \"onkeypress\"\n</code></pre>\n"}], "owner": {"reputation": 552, "user_id": 5593502, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/128da5d9d241c75f44a9ba3a1a212641?s=128&d=identicon&r=PG&f=1", "display_name": "tdmsoares", "link": "https://stackoverflow.com/users/5593502/tdmsoares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1534054645, "creation_date": 1528302679, "question_id": 50725320, "link": "https://stackoverflow.com/questions/50725320/call-an-event-from-a-website-using-vba-to-internet-explorer", "title": "Call an event from a website - using VBA to Internet Explorer", "body": "<p>I'm using VBA in Microsoft Access for Internet Explorer automation. I've already open the website that I want, but there is an <em>input</em> that when typing the text inside, and pressing enter, the website tries to validate the data and fill other fields based on this input.</p>\n\n<p>Looking at the control I found this code:</p>\n\n<pre><code>      &lt;input name=\"ctl00$ContentPlaceHolder1$txtId\" type=\"text\" maxlength=\"8\" onchange=\"javascript:setTimeout('__doPostBack(\\'ctl00$ContentPlaceHolder1$txtId\\',\\'\\')', 0)\" onkeypress=\"if (WebForm_TextBoxKeyHandler(event) == false) return false;\njavascript:return ValidateNumber(event);\n       \" id=\"ctl00_ContentPlaceHolder1_txtId\" class=\"TextBox\" onfocus=\"javascript:sObjetoOnFocusCSS(this);\n       \" onblur=\"javascript:sObjetoOnBlurCSS(this,'TextBox');\" \n        style=\"font-weight:normal;\"&gt; \n</code></pre>\n\n<p>I think the <code>ValidateNumber(event)</code>is responsible for the Validation of the data inserted in this input to fill other fields in this website.</p>\n\n<p>I tried to do something like <code>Call document.all(ctl00$ContentPlaceHolder1$txtId).fireEvent(\"ValidateNumber(event)\");</code> but it didn't work.</p>\n\n<p>What can I do or fix to run the <code>ValidateNumber(event)</code> function that Validates the data inside <code>ctl00$ContentPlaceHolder1$txtId</code> control?</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2016"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1528303776, "post_id": 50725134, "comment_id": 88459429, "body": "Format property setting does not change the actual data. Have you changed date format in computer settings? Review <a href=\"http://allenbrowne.com/ser-36.html\" rel=\"nofollow noreferrer\">allenbrowne.com/ser-36.html</a>"}, {"owner": {"reputation": 35, "user_id": 1644556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2bd815b421729ded96808834ab0779?s=128&d=identicon&r=PG", "display_name": "hasibuddinahmed", "link": "https://stackoverflow.com/users/1644556/hasibuddinahmed"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1528305364, "post_id": 50725134, "comment_id": 88460286, "body": "No. I haven&#39;t. It&#39;s in date type in Access."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1528305988, "post_id": 50725134, "comment_id": 88460620, "body": "If your computer Regional settings are set for U.S. style date, then don&#39;t Format the date in code. If users input dates in dd/mm/yyyy order, many values are likely not stored as the date you expect. Access will understand 13/1/2018 as 13Jan2018 and save correctly. However, Access will accept 1/2/2018 in that order but will read it as 2Jan2018, not 1Feb2018. Did you read the AllenBrowne article?"}, {"owner": {"reputation": 35, "user_id": 1644556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2bd815b421729ded96808834ab0779?s=128&d=identicon&r=PG", "display_name": "hasibuddinahmed", "link": "https://stackoverflow.com/users/1644556/hasibuddinahmed"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1528306738, "post_id": 50725134, "comment_id": 88461026, "body": "Yes, I read the article. My computer regional settings are in the same format as my database date, &#39;dd-mm-yyyy&#39;. I have tried without the format function as well and it gives the same result."}, {"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1528307126, "post_id": 50725134, "comment_id": 88461252, "body": "Sorry, that&#39;s the limit of my understanding of International dates. I don&#39;t have to deal with the issue. Try formatting both the DOB field and the parameter."}], "answers": [{"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 0, "last_activity_date": 1528305939, "creation_date": 1528305939, "answer_id": 50726185, "question_id": 50725134, "link": "https://stackoverflow.com/questions/50725134/unable-to-query-data-for-particular-age-range-from-a-table-in-vba-access/50726185#50726185", "title": "Unable to query data for particular age range from a table in VBA Access", "body": "<p>Format is for display only, so:</p>\n\n<pre><code>select * from Customer \nwhere DOB &gt; DateAdd('yyyy', -25, Date())\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 1644556, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e2bd815b421729ded96808834ab0779?s=128&d=identicon&r=PG", "display_name": "hasibuddinahmed", "link": "https://stackoverflow.com/users/1644556/hasibuddinahmed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528306299, "creation_date": 1528302012, "last_edit_date": 1528306299, "question_id": 50725134, "link": "https://stackoverflow.com/questions/50725134/unable-to-query-data-for-particular-age-range-from-a-table-in-vba-access", "title": "Unable to query data for particular age range from a table in VBA Access", "body": "<p>I have a table with date-of-birth column and other columns. I want to extract all data for a particular age range (>25). I have written the following code but it's not working. It shows blank rows. I am using the format function because in my table the data is in 'dd-mm-yyyy' format.</p>\n\n<p>My table is in MS Access and I have written the query in VBA.</p>\n\n<pre><code>select * from Customer \nwhere DOB &gt; format(dateadd('yyyy', -25, date()), 'dd-mm-yyyy')\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 173, "user_id": 1983809, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100000587367806/picture?type=large", "display_name": "Jaquio", "link": "https://stackoverflow.com/users/1983809/jaquio"}, "edited": false, "score": 1, "creation_date": 1528300149, "post_id": 50724448, "comment_id": 88457472, "body": "What error do you get?"}, {"owner": {"reputation": 19, "user_id": 2621535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21e46d827930f0ad5137829617922ba5?s=128&d=identicon&r=PG", "display_name": "Jim A", "link": "https://stackoverflow.com/users/2621535/jim-a"}, "reply_to_user": {"reputation": 173, "user_id": 1983809, "user_type": "registered", "accept_rate": 62, "profile_image": "https://graph.facebook.com/100000587367806/picture?type=large", "display_name": "Jaquio", "link": "https://stackoverflow.com/users/1983809/jaquio"}, "edited": false, "score": 0, "creation_date": 1528300328, "post_id": 50724448, "comment_id": 88457599, "body": "Run-time error &#39;13&#39;: Type mismatch... at line: myData.SetText vAry"}, {"owner": {"reputation": 7422, "user_id": 1586390, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f07270207034d2bcbe347b028edc8f02?s=128&d=identicon&r=PG", "display_name": "Sorceri", "link": "https://stackoverflow.com/users/1586390/sorceri"}, "edited": false, "score": 0, "creation_date": 1528301080, "post_id": 50724448, "comment_id": 88458036, "body": "RecordSet.GetRows returns an array not a string of text."}], "answers": [{"tags": [], "owner": {"reputation": 19, "user_id": 2621535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21e46d827930f0ad5137829617922ba5?s=128&d=identicon&r=PG", "display_name": "Jim A", "link": "https://stackoverflow.com/users/2621535/jim-a"}, "is_accepted": false, "score": 0, "last_activity_date": 1528308012, "creation_date": 1528308012, "answer_id": 50726774, "question_id": 50724448, "link": "https://stackoverflow.com/questions/50724448/excel-vba-store-sql-select-content-to-clipboard/50726774#50726774", "title": "Excel VBA store SQL Select content to Clipboard", "body": "<p>I fixed the error by adding/modifying the code to convert array variant to string:</p>\n\n<pre><code>Dim strData As String\nFor i = 0 To UBound(vAry, 2) - LBound(vAry, 2)\n    strData = strData &amp; vAry(0, i) &amp; vbCrLf\nNext\n\nSet myData = New DataObject\nmyData.SetText strData\nmyData.PutInClipboard\nMsgBox (\"data has been copied to clipboard\")\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 2621535, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/21e46d827930f0ad5137829617922ba5?s=128&d=identicon&r=PG", "display_name": "Jim A", "link": "https://stackoverflow.com/users/2621535/jim-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528308012, "creation_date": 1528299754, "last_edit_date": 1531164843, "question_id": 50724448, "link": "https://stackoverflow.com/questions/50724448/excel-vba-store-sql-select-content-to-clipboard", "title": "Excel VBA store SQL Select content to Clipboard", "body": "<p>I'm trying write VBA code in Excel (when command button is clicked in UserForm)  to run a SQL query  and store the results to the windows clipboard.  Data will be one column with several records.</p>\n\n<p>Here is the code I tried, but get an error:\nRun-time error '13':\nType mismatch</p>\n\n<pre><code>Private Sub CommandButton4_Click()\n\n    Dim cn      As Object   'Connection\n    Dim rs      As Object   'Recordset\n    Dim vAry    As Variant  'Variant Array\n\n    Set cn = CreateObject(\"ADODB.Connection\")\n    Set rs = CreateObject(\"ADODB.Recordset\")\n\n    cn.Open \"Driver={MySQL ODBC 5.3 Unicode Driver};server=10.0.0.2;\" &amp; _\n            \"database=db uid=user; pwd=password;Port=3306\"\n    rs.Open \"Select Device_ID From returns Where Status = 'A';\", cn\n    vAry = rs.GetRows\n\n    rs.Close\n    cn.Close\n\n    Set rs = Nothing\n    Set cn = Nothing\n\n    Set myData = New DataObject\n    myData.SetText vAry\n    myData.PutInClipboard\n    MsgBox (\"data has been copied to clipboard\")\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9654842"}, "edited": false, "score": 0, "creation_date": 1528385027, "post_id": 50726676, "comment_id": 88497568, "body": "Thanks DecimalTurn"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9654842"}, "edited": false, "score": 0, "creation_date": 1528421541, "post_id": 50726676, "comment_id": 88512271, "body": "sorry, being bit optimist , I am reposting question once again. Is there a way that I can write some code to lock down the macros either in main method or else in form load of the macros?"}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1528445842, "post_id": 50726676, "comment_id": 88520290, "body": "Please edit your question directly if you want to give more precision. But as far as I know, when it&#39;s time to lock down macros, it will come down to one of those 2 methods or something along those lines."}, {"owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "edited": false, "score": 0, "creation_date": 1529516050, "post_id": 50726676, "comment_id": 88905757, "body": "Maybe have a look at this question:<a href=\"https://stackoverflow.com/questions/6760981/lock-down-microsoft-excel-macro\" title=\"lock down microsoft excel macro\">stackoverflow.com/questions/6760981/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2265, "user_id": 5958842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d6891cdbf84d1fab53a0d73b05ee467?s=128&d=identicon&r=PG", "display_name": "DecimalTurn", "link": "https://stackoverflow.com/users/5958842/decimalturn"}, "is_accepted": true, "score": 1, "last_activity_date": 1528329911, "last_edit_date": 1528329911, "creation_date": 1528307647, "answer_id": 50726676, "question_id": 50724167, "link": "https://stackoverflow.com/questions/50724167/how-to-lock-down-excel-macrosvb-code/50726676#50726676", "title": "how to lock down excel macros(VB code)", "body": "<p>In terms of protecting your macros from being edited by other users, the simplest method is certainly the <strong>Password Method</strong> you've been suggested (Lock Project from viewing). </p>\n\n<p>There is another way that I know to stop people from viewing your macros. It's a tool called <strong><a href=\"https://www.spreadsheet1.com/unviewable-vba-project-app-for-excel.html\" rel=\"nofollow noreferrer\">Unviewable+</a></strong>. This tool works well when you are a developer that want to distribute an add-in or a workbook with code to other people and you don't want them to have access or change the code.</p>\n\n<p><strong>Password</strong></p>\n\n<p>Pros:</p>\n\n<ul>\n<li>Simple to implement</li>\n</ul>\n\n<p>Cons:</p>\n\n<ul>\n<li>Need to remember the password.</li>\n<li>Less secure as there are ways to bypass the password using some techniques you can find online.</li>\n</ul>\n\n<p><strong>Unviewable+</strong></p>\n\n<p>Pros:</p>\n\n<ul>\n<li>This is a much more secure method</li>\n</ul>\n\n<p>Cons:</p>\n\n<ul>\n<li><p>This is not free</p></li>\n<li><p>You need to have a master version where you keep your code in a separate file. It will not be possible to reverse the process after making the code unviewable, so you want to apply this protection only to the file accessible to your end users.</p></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15750370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a1888a3b203121e58398d38ec33d6ec?s=128&d=identicon&r=PG&f=1", "display_name": "followhiterabit", "link": "https://stackoverflow.com/users/15750370/followhiterabit"}, "is_accepted": false, "score": 0, "last_activity_date": 1619215597, "creation_date": 1619215597, "answer_id": 67237347, "question_id": 50724167, "link": "https://stackoverflow.com/questions/50724167/how-to-lock-down-excel-macrosvb-code/67237347#67237347", "title": "how to lock down excel macros(VB code)", "body": "<blockquote>\n<p>Unviewable+ Pros:\nThis is a much more secure method</p>\n</blockquote>\n<p>I am not so optimistic about Unviewable+ protection.</p>\n<p>Any \u201cunviewable VBA code\u201d protection works only in Excel VBA editor, and that VBA code is reachable outside of Excel.</p>\n<p>Here is a 10-step guide on how to view VBA code protected with Unviewable+.</p>\n<p><strong>Step 1.</strong>\nDetect the file format of the workbook or Excel add-in protected with Unviewable+.\nTo do that, open the file in Notepad and look at its first 2 symbols.\nIf first symbols are &quot;PK&quot; \u2013 the file is in XLSM format, otherwise it is in XLSB format (compound OLE storage). If your file is in XLSM format, then go to Step 4.</p>\n<p><strong>Step 2.</strong>\nIf you have unviewable Excel add-in in XLSB format, then you need to save it as a workbook. To do that open the add-in file in Excel, open VBA Project (Alt+F11) and open &quot;Immediate window&quot; (Ctrl+G).\nType in the following command into the immediate window and press Enter (instead of &quot;TheNameOfAddin.xlam&quot; use your Unvewable+ protected add-in file name):</p>\n<pre><code>Workbooks(&quot;TheNameOfAddin.xlam&quot;).IsAddin = False\n</code></pre>\n<p>Then type the next command and press Enter:</p>\n<pre><code>Workbooks(&quot;TheNameOfAddin.xlam&quot;).SaveAs &quot;ProtectedWbk.xlsb&quot;, 50\n</code></pre>\n<p>Then close Excel.\nAs a result of the actions above the &quot;TheNameOfAddin.xlam&quot; Excel add-in is saved as a &quot;ProtectedWbk.xlsb&quot; workbook in the default saving location of your Excel, which is most likely your Documents folder.</p>\n<p><strong>Step 3.</strong>\nConvert the workbook in .XLSB format into a workbook in .XLSM format.\nTo do that open the .XLSB file in Excel and use File &gt; SaveAs to save it in a XLSM format (Excel Macro-Enabled Workbook) like \u201cProtectedWbk.xlsm\u201d.\nClose Excel.</p>\n<p><strong>Step 4.</strong>\nCreate a new, empty workbook in Excel and save it in XLSM format (for example with the name &quot;NewWbk.xlsm&quot;).\nOpen VBA Project (Alt+F11) in &quot;NewWbk.xlsm&quot; and add a new module into the project (by right-clicking on the &quot;Project \u2013 VBAProject&quot; explorer window, then left-clicking the Insert-&gt;Module buttons).  Save the workbook.\nClose Excel.</p>\n<p><strong>Step 5.</strong>\nRename the new workbook into a file with a zip extension, as such: &quot;NewWbk.zip&quot;\nRename the workbook with the unviewable VBA code from &quot;ProtectedWbk.xlsm&quot; into a zip file like &quot;ProtectedWbk.zip&quot;</p>\n<p><strong>Step 6.</strong>\nOpen ProtectedWbk.zip in Windows Explorer and go to the folder called &quot;xl&quot;\nIf you see one &quot;bin&quot; file called &quot;vbaProject.bin&quot; then unzip it onto the disk.\nIf you see 2 &quot;bin&quot; files called &quot;vbaProject.bin&quot; and &quot;printerSettings.bin&quot; then unzip the &quot;printerSettings.bin&quot; file on disk and rename the unzipped file from &quot;printerSettings.bin&quot; to &quot;vbaProject.bin&quot;.</p>\n<p><strong>Step 7.</strong>\nOpen NewWbk.zip in Windows Explorer and go to the &quot;xl&quot; folder and overwrite &quot;vbaProject.bin&quot; with &quot;vbaProject.bin&quot; you have unzipped on Step 6.</p>\n<p><strong>Step 8.</strong>\nIf you do not have LibreOffice installed, then download it from their official website (linked below) and install it on your computer.</p>\n<p><a href=\"https://www.libreoffice.org/download/download/\" rel=\"nofollow noreferrer\">https://www.libreoffice.org/download/download/</a></p>\n<p><strong>Step 9.</strong>\nOpen LibreOffice Calc.\nOpen &quot;NewWbk.zip&quot; in LibreOffice Calc.</p>\n<p><strong>Step 10.</strong>\nFollow the path -- LibreOffice Calc main menu &gt; Tools &gt; Macros &gt; Edit Macros. Open &quot;NewWbk.zip&quot; catalog and observe all the VBA code from the &quot;protected&quot; file.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9654842"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 1, "accepted_answer_id": 50726676, "answer_count": 2, "score": 0, "last_activity_date": 1619215597, "creation_date": 1528298892, "last_edit_date": 1531164843, "question_id": 50724167, "link": "https://stackoverflow.com/questions/50724167/how-to-lock-down-excel-macrosvb-code", "title": "how to lock down excel macros(VB code)", "body": "<p>I have an excel which has lot of macros written, now our security team has come back and reported the vulnerability since a tech savvy can modify or delete macros. So they suggested to lock down macros so that none of the user can even see it. Actually, I changed macros security by checking \u201cLock Project for viewing\u201d in protection Tab which will lock down the macros, but the problem of this approach is that I need to maintain a password. Is there any other approach where I can lock down the macros in order to restrict the user to view . help will be really appreciated.</p>\n"}, {"tags": ["vba", "excel", "excel-formula", "excel-2010"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1528298725, "post_id": 50724074, "comment_id": 88456534, "body": "See how to build a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 1, "creation_date": 1528298803, "post_id": 50724074, "comment_id": 88456578, "body": "Looks like the method &quot;cells&quot; of &quot;object_worksheet&quot; failed. Would need to see some code though to know why."}, {"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1528299329, "post_id": 50724074, "comment_id": 88456943, "body": "I edited my question with some code , hope it helps."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 1, "creation_date": 1528299754, "post_id": 50724074, "comment_id": 88457219, "body": "Drop the <code>Application.</code> qualifier in front of <code>ThisWorkbook</code>. Give the <code>Registos</code> sheet a code name (set its <code>(Name)</code> property in the properties toolwindow / F4) to e.g. <code>RegSheet</code> and then get rid of all these redundant <code>Worksheets(&quot;Registos&quot;)</code> calls, you can then simply do <code>RegSheet.Cells(...).Value = ...</code> instead"}, {"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1528299873, "post_id": 50724074, "comment_id": 88457292, "body": "Do you mean this <code>ThisWorkbook.Application</code> ?@MathieuGuindon"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528300317, "post_id": 50724074, "comment_id": 88457592, "body": "<code>Application</code> has nothing to do here. <code>ThisWorkbook</code> is already an unambiguous named object that can only ever refer to the workbook that contains the VBA code that you&#39;re looking at."}], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1528356491, "post_id": 50725185, "comment_id": 88478344, "body": "I did clean and restructure my code , deleting almost every <code>GoTo</code> and fixing <code>Me.Show</code> and <code>Me.Hide</code> as well the protection loop , but still having the same run time error."}, {"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1528356719, "post_id": 50725185, "comment_id": 88478462, "body": "It seems to me that the problem is in <code>last</code>"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "reply_to_user": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1528359169, "post_id": 50725185, "comment_id": 88479782, "body": "Good news! Getting closer to the bug. It is rather unusual to count over the last row but it looks safer to insert a control before referencing the cell like <code>If last + 2 &gt; ActiveSheet.Rows.Count Then Stop</code>"}, {"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1528362744, "post_id": 50725185, "comment_id": 88482104, "body": "Not quite sure if i understand what you mean , why <code>If last + 2...</code> and no <code>If last + 1 ...</code>"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "reply_to_user": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1528367799, "post_id": 50725185, "comment_id": 88485650, "body": "You get <code>last</code> as the last used row but what happens if you reference a cell 2 rows after the very last possible row? So check before you write."}], "tags": [], "owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "is_accepted": false, "score": 0, "last_activity_date": 1528302184, "creation_date": 1528302184, "answer_id": 50725185, "question_id": 50724074, "link": "https://stackoverflow.com/questions/50724074/excel-vba-run-time-error-2147417848/50725185#50725185", "title": "Excel VBA , run time error -2147417848", "body": "<p>The error indicates some overload. You could try to restucture the code in a way to put every (most of the) repeated instructions into a sub/function as the sub/function releases all variables (incl. objects) on return and so frees up memory. </p>\n\n<p>I have some more suggestions/questions: </p>\n\n<ol>\n<li><p>I would use <code>With ... End With</code> like this: </p>\n\n<pre><code>Dim regSh as Worksheet\nSet regSh = ThisWorkbook.Worksheets(\"Registos\")\nWith regSh\n    .Cells(last + 2, 1) = Now()\n    .Cells(last + 2, 6) = registos.ComboBox2\n    ....\nEnd With\n</code></pre></li>\n</ol>\n\n<p>This method will load the sheet object into the memory only once and keeps it there until <code>End With</code> resulting in some performance improvement. </p>\n\n<ol start=\"2\">\n<li>I would restructure the code to avoid <code>GoTos</code>.</li>\n<li>It is a bit obscure why you <code>Me.Show</code> the sheet immediately after <code>Me.Hide</code></li>\n<li>It looks like you unprotect all sheets in the workbook in every loop. Are you sure this is necessary? It needs quite an effort. </li>\n</ol>\n"}], "owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 618, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1528302184, "creation_date": 1528298596, "last_edit_date": 1528299305, "question_id": 50724074, "link": "https://stackoverflow.com/questions/50724074/excel-vba-run-time-error-2147417848", "title": "Excel VBA , run time error -2147417848", "body": "<p>I am running a UserForm that allow users scan with a barcode and print on a Worksheet , i also have a label that show's the count for the total scanned pieces so far. When i get to 170-180 scanned pieces it gives me an Run Time Error.</p>\n\n<pre><code>Run Time Error\n\n'-2147417848 (80010108)\n\nMethod 'Cells' of object_WorkSheet' failed\n\n\n\nIf KeyCode = 13 Then\n    'Application.ThisWorkbook.Worksheets(\"Registos\").Cells(1, 30) = Now()\n    last = Application.ThisWorkbook.Worksheets(\"Registos\").Range(\"A65536\").End(xlUp).Row\n    Length = Len(registos.TextBox3.Text)\n    If Length &gt; 32 Or Length &lt; 1 Then\n        MsgBox \"O c\u00f3digo inserido n\u00e3o tem um n\u00ba de caracteres v\u00e1lido!\", vbExclamation\n        'registos.Hide\n        'registos.Show\n        registos.TextBox3.Text = \"\"\n        registos.TextBox3.SetFocus\n            Else\n                If registos.TextBox3 &lt;&gt; \"\" And registos.TextBox1 &lt;&gt; \"\" And registos.TextBox2 &lt;&gt; \"\" And registos.TextBox4 = \"\" And registos.ComboBox5 &lt;&gt; \"\" Then\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Visible = True\n                    WS_Count = Application.ThisWorkbook.Worksheets.Count\n                    For j = 1 To WS_Count\n                        Application.ThisWorkbook.Worksheets(j).Unprotect Password:=\"stockregistos\"\n                    Next j\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 1) = Now()                                               'data\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 6) = registos.Label11.Caption                            'cc\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 5) = registos.Label20.Caption                               'ano fiscal\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 7) = a1logiin.TextBox1.Text                              'OPERARIO\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 8) = registos.TextBox1.Text                              'referencia formata\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 9) = registos.TextBox2.Text                              'ordem\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 10) = registos.TextBox3.Text                             'codigo\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 11) = 1                                                  'quantidade\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 12) = registos.ComboBox1                                 'Entrada/Saida\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 13) = registos.ComboBox5                                 ' ESTADO\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 14) = Format(registos.ComboBox3, \"#\")                    'CODIGO DEFEITO\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 16) = registos.ComboBox6                                 'ORIGEM DEFEITO\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 17) = registos.TextBox5                                  'OBSERVA\u00c7\u00d5ES\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 1, 18) = registos.ComboBox7                                    'TIPO\n                    contador = contador + 1\n                    registos.Label21.Caption = contador\n                    GoTo fim2\n                End If\nfim2:\n                If registos.ComboBox1 = \"SA\u00cdDA\" And registos.TextBox3 &lt;&gt; \"\" And registos.TextBox1 &lt;&gt; \"\" And registos.TextBox2 &lt;&gt; \"\" And registos.TextBox4 = \"\" And registos.ComboBox5 &lt;&gt; \"\" And registos.ComboBox2 &lt;&gt; \"\" Then\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 1) = Now()                                                 'data\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 6) = registos.ComboBox2                                    'cc\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 5) = registos.Label20.Caption                               'ano fiscal\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 7) = a1logiin.TextBox1.Text                                'operario\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 8) = registos.TextBox1                                     'referencia formata\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 9) = registos.TextBox2                                     'ordem\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 10) = registos.TextBox3.Text                               'codigo\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 11) = 1                                                    'quantidade\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 12) = \"ENTRADA\"                                            'Defenir sa\u00edda de um CC como a entrade de outro\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 13) = registos.ComboBox5                                   ' ESTADO\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 14) = Format(registos.ComboBox3, \"#\")                      'CODIGO DEFEITO\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 16) = registos.ComboBox6                                   'ORIGEM DEFEITO\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 17) = registos.TextBox5                                    'OBSERVA\u00c7\u00d5ES\n                    Application.ThisWorkbook.Worksheets(\"Registos\").Cells(last + 2, 18) = registos.ComboBox7                                    'TIPO\n                    GoTo salto\n                End If\n            registos.Hide\n            registos.Show\n            registos.TextBox3.Text = \"\"\n            registos.TextBox3.SetFocus\n    End If\n    registos.Hide\n    registos.Show\n    registos.TextBox3.Text = \"\"\n    registos.TextBox3.SetFocus\n End If\n</code></pre>\n\n<p>I added some more code , so you can understand what's going on and maybe see something that i didn't realize.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528299598, "post_id": 50724035, "comment_id": 88457122, "body": "what is <code>, ur</code> supposed to mean in the line that errors? seems like a typo that can be removed, to me"}, {"owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528299685, "post_id": 50724035, "comment_id": 88457171, "body": "@Marcucciboy2 <code>ur</code> is the 2nd <code>Range</code> argument for <code>UpdateWs</code>"}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "reply_to_user": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "edited": false, "score": 0, "creation_date": 1528300641, "post_id": 50724035, "comment_id": 88457776, "body": "@BigBen yikes, i dont know how i missed that"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1528301483, "post_id": 50724035, "comment_id": 88458252, "body": "<code>UpdateWs worksheets(wsTosaveto), ur</code> ?"}], "owner": {"reputation": 45, "user_id": 5234485, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c57946926066e4858e23aa939bd9c4fb?s=128&d=identicon&r=PG&f=1", "display_name": "Hwee7", "link": "https://stackoverflow.com/users/5234485/hwee7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528298470, "creation_date": 1528298470, "last_edit_date": 1531164843, "question_id": 50724035, "link": "https://stackoverflow.com/questions/50724035/copy-row-to-other-worksheets-based-on-a-column-value-in-a-table", "title": "Copy row to other worksheets based on a column value in a table", "body": "<p>I would like to have a macro that can read the values of a table, and copy the rows to a respective names worksheet if it match. </p>\n\n<p>Lets say I have a template and Sheet1 worksheets. (unable to embed image yet)\n<a href=\"https://i.stack.imgur.com/36H45.png\" rel=\"nofollow noreferrer\">Sheet1 Table</a></p>\n\n<p>'template' worksheet is the source where if column F value match one of the ID in Sheet1, it will be copied to the respective group(worksheet)\nExample - all rows that contain 123 in column F of template will be copied to 'North' worksheet.</p>\n\n<p>I have modified parts of the code provided from the excel masters here. \nHowever it is throwing a error 'Object variable or With Block variable not set' at this code <code>UpdateWs ws(wsTosaveto), ur</code></p>\n\n<p>Any help would be appreciated..</p>\n\n<pre><code>Sub sliceNdice()\n\n    Application.ScreenUpdating = False\n    Application.DisplayAlerts = False\n\n    Const master_ws As String = \"template\"\n    Const master_col As String = \"F\"    'AutoFilter column in Master sheet\n\n    Dim OldBook As Workbook\n    Dim LastRow As Long, i As Long\n    Dim valuetoFind As String, wsTosaveto As String\n    Dim ws As Worksheet, lr As Long, lc As Long, ur As Range, fCol As Range, done As Range\n    Dim wb As Workbook\n    Set wb = Application.ThisWorkbook\n\n    With wb.Worksheets(master_ws)\n        lr = .Cells(.Rows.Count, master_col).End(xlUp).Row   'find last row of template\n        lc = .Cells(1, .Columns.Count).End(xlToLeft).Column  'find last column template\n        Set ur = .Range(.Cells(3, 1), .Cells(lr, lc))  'set the range of data\n        Set fCol = .Range(.Cells(2, master_col), .Cells(lr, master_col))\n        Set done = .Range(.Cells(1, master_col), .Cells(2, master_col))\n    End With\n\n\n    Set OldBook = ThisWorkbook\n    'Find last row of Sheet1 table\n    LastRow = OldBook.Worksheets(\"Sheet1\").Cells(Rows.Count, 1).End(xlUp).Row\n\n    'Scan all rows of Sheet1 table\n    For i = 3 To LastRow 'Start in third row. First 2 row for titles\n      valuetoFind = OldBook.Worksheets(\"Sheet1\").Cells(i, 1).Value\n      wsTosaveto = OldBook.Worksheets(\"Sheet1\").Cells(i, 2).Value\n\n      fCol.AutoFilter Field:=1, Criteria1:=valuetoFind\n        If fCol.SpecialCells(xlCellTypeVisible).Cells.Count &gt; 1 Then\n          UpdateWs ws(wsTosaveto), ur\n          Set done = Union(done, fCol.SpecialCells(xlCellTypeVisible))\n        End If\n    Next i\n\n    If wb.Worksheets(master_ws).AutoFilterMode Then\n      fCol.AutoFilter\n      UpdateNA done, ur\n    End If\n    Application.ScreenUpdating = True\nEnd Sub\n\n\nPrivate Sub UpdateWs(ByRef ws As Worksheet, ByRef fromRng As Range)\n    fromRng.Copy\n    With ws.Cells(ws.Rows.Count, \"A\").End(xlUp).Offset(1, 0)\n        .PasteSpecial xlPasteAll\n    End With\n    ws.Activate\n    ws.Cells(1).Select\nEnd Sub\n\nPrivate Sub UpdateNA(ByRef done As Range, ByRef ur As Range)\n    done.EntireRow.Hidden = True\n    If ur.SpecialCells(xlCellTypeVisible).Cells.Count &gt; 1 Then\n        UpdateWs ThisWorkbook.Worksheets(NA_WS), ur.SpecialCells(xlCellTypeVisible)\n    End If\n    done.EntireRow.Hidden = False\n    Application.CutCopyMode = False\n    ur.Parent.Activate\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1528298721, "post_id": 50724025, "comment_id": 88456530, "body": "I&#39;m hoping <i>column</i> is supposed to be a letter.  It&#39;s also a reserved word that could refer to the current Selection&#39;s column index number."}, {"owner": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528299837, "post_id": 50724025, "comment_id": 88457273, "body": "@Jeeped it&#39;s supposed to be a parameter of his main sub <code>Sub Differences(ByVal column As String)</code>. That said, I don&#39;t know how it resolves that when it&#39;s a keyword"}, {"owner": {"reputation": 1, "user_id": 9903700, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Speedy", "link": "https://stackoverflow.com/users/9903700/speedy"}, "reply_to_user": {"reputation": 3033, "user_id": 2727437, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F9PHb.jpg?s=128&g=1", "display_name": "Marcucciboy2", "link": "https://stackoverflow.com/users/2727437/marcucciboy2"}, "edited": false, "score": 0, "creation_date": 1528305623, "post_id": 50724025, "comment_id": 88460415, "body": "@Marcucciboy2 Thats right. On the same note, I honestly wasn&#39;t thinking about it being a reserved word. I&#39;ll switch it to something else!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9903700, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Speedy", "link": "https://stackoverflow.com/users/9903700/speedy"}, "edited": false, "score": 0, "creation_date": 1528305421, "post_id": 50724112, "comment_id": 88460311, "body": "Thanks @madrac. So if I understand correctly in my master <i>sub test()</i>, I can only call RefreshAll in this scenario? (or any sub that doesn&#39;t need to utilize Access information)?"}], "tags": [], "owner": {"reputation": 114, "user_id": 9783373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/147fc00fbf8446be4fc953793063c12c?s=128&d=identicon&r=PG&f=1", "display_name": "madrac", "link": "https://stackoverflow.com/users/9783373/madrac"}, "is_accepted": false, "score": 0, "last_activity_date": 1528298704, "creation_date": 1528298704, "answer_id": 50724112, "question_id": 50724025, "link": "https://stackoverflow.com/questions/50724025/excel-vba-macro-completes-before-cells-on-worksheet-are-refreshed/50724112#50724112", "title": "Excel VBA macro completes before cells on worksheet are refreshed", "body": "<p>A way to get around this issue is to put all subs, etc that you want to run after pulling the Access/Database data into a different sub. You must do this each time you call Access information. If you call another sub in the \"master\" sub after the Application.OnTime Now +TimeValue(\"00:00:15\"), it will fail- you must put all subs following into a new master sub.</p>\n"}], "owner": {"reputation": 1, "user_id": 9903700, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Speedy", "link": "https://stackoverflow.com/users/9903700/speedy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528304383, "creation_date": 1528298437, "last_edit_date": 1528304383, "question_id": 50724025, "link": "https://stackoverflow.com/questions/50724025/excel-vba-macro-completes-before-cells-on-worksheet-are-refreshed", "title": "Excel VBA macro completes before cells on worksheet are refreshed", "body": "<p>I'm running into an issue with some Excel automation being used to create a dashboard. I have an Excel macro enabled workbook that also has data connections to an Access database. Every morning (Mon-Friday) another process automatically exports data to an Access database and then Excel connects to the necessary tables to show that data in charts and graphs.</p>\n\n<p>My issue:\nI'm using VBA to perform calculations on one of the charts that retrieves new data from a table produced by the data connection between Access and Excel. The idea is for the new day's data to be included in a calculation using the previous day's data. The new day's data is always the last cell with data in the column and the previous day's data is right above it in the same column. For some reason the new day's data does not get filled until AFTER the code below has finished executing. I've tried using <strong>Worksheets(\"Worksheet'sName\").Calculate</strong> because the chart uses an IF statement to get data from the table generated by the data connection but it still doesn't work. I've also tried using a delay thinking that the code was running way too fast but the result was the same. Has anyone else come across this issue?</p>\n\n<p>My code for this calculation:</p>\n\n<pre><code>Sub Differences(ByVal column As String)\n\nDim i As Integer\nDim ws As Sheets\nDim wks As Worksheet\nDim dailyDiff As Double\nDim busDayDiff As Double\nDim mtdDiff As Double\n\nSet ws = ThisWorkbook.Worksheets\nSet wks = ws(\"Charts\") \nwks.Activate\n\ni = 4\n\nwks.Range(column &amp; i).Select\n\nDo While Selection.Offset(1, 0).Value &lt;&gt; \"\"\n    i = i + 1\n    wks.Range(column &amp; i).Select\nLoop\n\n**dailyDiff = Selection.Value - Selection.Offset(-1, 0).Value** '&lt;---The Calculation i'm referring to\nbusDayDiff = Selection.Value - Selection.Offset(0, 1).Value\nmtdDiff = Selection.Value - wks.Range(column &amp; \"3\").Value\n\nws.Range(column &amp; \"28\") = busDayDiff\nws.Range(column &amp; \"29\") = dailyDiff\nws.Range(column &amp; \"30\") = mtdDiff\n\nEnd Sub\n\n\n\nSub AllDifferences()\n\nDifferences (\"b\")\nDifferences (\"d\")\nDifferences (\"f\")\nDifferences (\"h\")\nDifferences (\"j\")\nDifferences (\"l\")\n\nEnd Sub\n\n\nSub RefreshAll()\n\nApplication.ScreenUpdating = False\nActiveWorkbook.RefreshAll\nApplication.ScreenUpdating = True\n\nEnd Sub\n\n\nSub test()\n\nCall RefreshAll\nCall AllDifferences\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528297503, "post_id": 50723563, "comment_id": 88455654, "body": "As with your earlier question, again, use a pivottable."}, {"owner": {"reputation": 2041, "user_id": 5040775, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10207130495004756/picture?type=large", "display_name": "Jun Jang", "link": "https://stackoverflow.com/users/5040775/jun-jang"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528297595, "post_id": 50723563, "comment_id": 88455720, "body": "@QHarr I know that pivot table could work, but I have to use VBA for this project."}], "answers": [{"comments": [{"owner": {"reputation": 2041, "user_id": 5040775, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10207130495004756/picture?type=large", "display_name": "Jun Jang", "link": "https://stackoverflow.com/users/5040775/jun-jang"}, "edited": false, "score": 0, "creation_date": 1528297618, "post_id": 50723679, "comment_id": 88455741, "body": "how do I do that on VBA?"}, {"owner": {"reputation": 114, "user_id": 9783373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/147fc00fbf8446be4fc953793063c12c?s=128&d=identicon&r=PG&f=1", "display_name": "madrac", "link": "https://stackoverflow.com/users/9783373/madrac"}, "reply_to_user": {"reputation": 2041, "user_id": 5040775, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10207130495004756/picture?type=large", "display_name": "Jun Jang", "link": "https://stackoverflow.com/users/5040775/jun-jang"}, "edited": false, "score": 0, "creation_date": 1528298164, "post_id": 50723679, "comment_id": 88456135, "body": "Please have a look here: <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheetfunction-sumif-method-excel\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/vba/excel-vba/articles/&hellip;</a> hope this helps you."}], "tags": [], "owner": {"reputation": 114, "user_id": 9783373, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/147fc00fbf8446be4fc953793063c12c?s=128&d=identicon&r=PG&f=1", "display_name": "madrac", "link": "https://stackoverflow.com/users/9783373/madrac"}, "is_accepted": true, "score": 2, "last_activity_date": 1528297482, "creation_date": 1528297482, "answer_id": 50723679, "question_id": 50723563, "link": "https://stackoverflow.com/questions/50723563/selecting-specific-rows-in-excel-and-perform-calculations-using-vba/50723679#50723679", "title": "Selecting specific rows in Excel and perform calculations using VBA", "body": "<p>I would do an SUMIF formula specifying each category in the column F. </p>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528404511, "post_id": 50724571, "comment_id": 88507560, "body": "Did you try this?"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1528305539, "last_edit_date": 1528305539, "creation_date": 1528300159, "answer_id": 50724571, "question_id": 50723563, "link": "https://stackoverflow.com/questions/50723563/selecting-specific-rows-in-excel-and-perform-calculations-using-vba/50724571#50724571", "title": "Selecting specific rows in Excel and perform calculations using VBA", "body": "<p>Use a dictionary. The keys are the sector and values the percentages. If a key exists then add the percentage to the existing value.</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim lastRow As Long, dict As Object, i As Long, key As Variant\n\n    With ActiveSheet\n        Dim dataArr()\n        dataArr = .Range(\"C2:E\" &amp; .Cells(.Rows.Count, \"C\").End(xlUp).Row).Value\n    End With\n\n    Set dict = CreateObject(\"Scripting.Dictionary\")\n\n    For i = LBound(dataArr, 1) To UBound(dataArr, 1)\n        If Not dict.exists(dataArr(i, 1)) Then\n            dict.Add dataArr(i, 1), dataArr(i, 3)\n        Else\n            dict(dataArr(i, 1)) = dict(dataArr(i, 1)) + dataArr(i, 3)\n        End If\n    Next i\n\n   For Each key In dict.keys\n       Debug.Print key &amp; \" : \" &amp; dict(key)\n   Next key\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>Result in immediate window (Ctrl + G)</p>\n\n<p><a href=\"https://i.stack.imgur.com/yPFDG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yPFDG.png\" alt=\"Data\"></a></p>\n"}], "owner": {"reputation": 2041, "user_id": 5040775, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10207130495004756/picture?type=large", "display_name": "Jun Jang", "link": "https://stackoverflow.com/users/5040775/jun-jang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 50723679, "answer_count": 2, "score": 0, "last_activity_date": 1528305539, "creation_date": 1528297166, "question_id": 50723563, "link": "https://stackoverflow.com/questions/50723563/selecting-specific-rows-in-excel-and-perform-calculations-using-vba", "title": "Selecting specific rows in Excel and perform calculations using VBA", "body": "<p>I have this spreadsheet:\n<a href=\"https://i.stack.imgur.com/BQZf2.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BQZf2.png\" alt=\"enter image description here\"></a></p>\n\n<p>For each of the sectors (IT, Consumer Discretionary, Financials, etc), I want to add % invested and return the result summed values. For example, IT should return 7%(1+2+4) and Health Care should return 24%(7+8+9).</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>Dim sector_array As Variant\nDim sector As Variant\nDim ocell As Range\nDim rng As Range\nsector_array = Array(\"Information Technology\", \"Financials\", \"Consumer \nDiscretionary\", \"Energy\", \"Materials\", \"Consumer Staples\", \"Health Care\", \n\"Industrials\", \"Utilities\", \"Telecommunication Services\", \"Real Estate\")\n\n\nFor Each sector In sector_array\nFor Each ocell In Range(\"C:C\")\n    If ocell.Value = sector Then\n        If rng Is Nothing Then\n            Set rng = ocell.EntireRow\n        Else\n            Set rng = Union(rng, ocell.EntireRow)\n        End If\n    End If\nNext ocell\nIf Not rng Is Nothing Then\n    rng.Select\n\nEnd If\nNext sector\n</code></pre>\n\n<p>How would I achieve this please?</p>\n"}, {"tags": ["vba", "ms-access"], "comments": [{"owner": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1528303241, "post_id": 50723549, "comment_id": 88459137, "body": "Cannot replicate issue. Even without closing quote mark (testing in Immediate window), I still get the PDF output. VBA procedure also works (it automatically adds the missing quote)."}, {"owner": {"reputation": 939, "user_id": 4838721, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh5.googleusercontent.com/-KZmeSVO9RN0/AAAAAAAAAAI/AAAAAAAABcA/4e5nJAZ-VVo/photo.jpg?sz=128", "display_name": "Brian Battles", "link": "https://stackoverflow.com/users/4838721/brian-battles"}, "reply_to_user": {"reputation": 14352, "user_id": 7607190, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lt74X.png?s=128&g=1", "display_name": "June7", "link": "https://stackoverflow.com/users/7607190/june7"}, "edited": false, "score": 0, "creation_date": 1528305840, "post_id": 50723549, "comment_id": 88460535, "body": "It&#39;s driving me crazy because it happens all the time on some users&#39; computers, and only intermittently on mine! And I can&#39;t trap for any error because Access simply closes without warning....argh!"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1528306806, "post_id": 50723549, "comment_id": 88461067, "body": "Does the application include <code>DoCmd.SetWarnings False</code> ?"}, {"owner": {"reputation": 939, "user_id": 4838721, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh5.googleusercontent.com/-KZmeSVO9RN0/AAAAAAAAAAI/AAAAAAAABcA/4e5nJAZ-VVo/photo.jpg?sz=128", "display_name": "Brian Battles", "link": "https://stackoverflow.com/users/4838721/brian-battles"}, "edited": false, "score": 0, "creation_date": 1528307759, "post_id": 50723549, "comment_id": 88461603, "body": "No Hans. One other thing...after the crash I find a file named something like msoCFE.tmp leftover in the destination folder. I imagine Access builds a temp file as it&#39;s outputting the report, and when it&#39;s done it renames it to myfilename.pdf, and somewhere during this process it&#39;s crashing...but why???"}, {"owner": {"reputation": 92018, "user_id": 77335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/323f9580312f8701daae5088d9cf4ed7?s=128&d=identicon&r=PG&f=1", "display_name": "HansUp", "link": "https://stackoverflow.com/users/77335/hansup"}, "edited": false, "score": 0, "creation_date": 1528308120, "post_id": 50723549, "comment_id": 88461783, "body": "Can the user create the PDF somewhere on their local drive without error/crash?"}, {"owner": {"reputation": 939, "user_id": 4838721, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh5.googleusercontent.com/-KZmeSVO9RN0/AAAAAAAAAAI/AAAAAAAABcA/4e5nJAZ-VVo/photo.jpg?sz=128", "display_name": "Brian Battles", "link": "https://stackoverflow.com/users/4838721/brian-battles"}, "edited": false, "score": 0, "creation_date": 1528308612, "post_id": 50723549, "comment_id": 88462027, "body": "Hi Hans....that&#39;s what I&#39;m trying now...I&#39;ll report back!"}, {"owner": {"reputation": 165, "user_id": 8066894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f252696fd21bda400a5c6aaf08fa5e4?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/8066894/steve"}, "edited": false, "score": 0, "creation_date": 1528321335, "post_id": 50723549, "comment_id": 88467784, "body": "Are there instances where the file path is very long?  I know I&#39;ve had issues saving from Excel VBA where the file path ends up being more than 256 characters."}, {"owner": {"reputation": 4400, "user_id": 2419128, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/1BFhR.jpg?s=128&g=1", "display_name": "dbmitch", "link": "https://stackoverflow.com/users/2419128/dbmitch"}, "edited": false, "score": 0, "creation_date": 1528334004, "post_id": 50723549, "comment_id": 88471136, "body": "Do you have a split database - or is everyone sharing the code db? Is there possibility that two users could be trying to write to same filename at the same time?"}, {"owner": {"reputation": 939, "user_id": 4838721, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh5.googleusercontent.com/-KZmeSVO9RN0/AAAAAAAAAAI/AAAAAAAABcA/4e5nJAZ-VVo/photo.jpg?sz=128", "display_name": "Brian Battles", "link": "https://stackoverflow.com/users/4838721/brian-battles"}, "edited": false, "score": 0, "creation_date": 1528372608, "post_id": 50723549, "comment_id": 88488580, "body": "No, dbmitch, only one person ever uses this application at a time. And Steve, I&#39;m checking that now, seems to be intermittent, but the file paths can get a bit long...I haven&#39;t found a specific limit in the cases I&#39;ve tested, though."}, {"owner": {"reputation": 23837, "user_id": 10527, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cb42e8d0af98015cc089bf2e5908a7?s=128&d=identicon&r=PG", "display_name": "Albert D. Kallal", "link": "https://stackoverflow.com/users/10527/albert-d-kallal"}, "edited": false, "score": 0, "creation_date": 1528760176, "post_id": 50723549, "comment_id": 88620525, "body": "Is this using runtime by any chance? Any un handled error in a accDB used with runtime will shut down. if you compile to a accDE, then no such shutdown will occur with runtime. If you not using runtime version of access then my comments don&#39;t apply."}], "owner": {"reputation": 939, "user_id": 4838721, "user_type": "registered", "accept_rate": 42, "profile_image": "https://lh5.googleusercontent.com/-KZmeSVO9RN0/AAAAAAAAAAI/AAAAAAAABcA/4e5nJAZ-VVo/photo.jpg?sz=128", "display_name": "Brian Battles", "link": "https://stackoverflow.com/users/4838721/brian-battles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 526, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1594548963, "creation_date": 1528297139, "last_edit_date": 1594548963, "question_id": 50723549, "link": "https://stackoverflow.com/questions/50723549/creating-pdf-file-in-vba-code-causes-access-to-crash-close", "title": "Creating PDF file in VBA code causes Access to crash/close", "body": "<p>I have an MS Access 2016 application that contains a report which needs to be saved as a PDF file. Whenever the user presses the button that does the output to PDF the application closes without warning (crashes). Any idea what could cause this?</p>\n\n<p>The VBA code called by the button press looks like this:</p>\n\n<pre><code>DoCmd.OutputTo acOutputReport, \"MyReport\", acFormatPDF, \"\\\\myserver\\myfolder\\myfilename.pdf\"\n</code></pre>\n"}, {"tags": ["vba", "excel", "charts", "linechart"], "answers": [{"tags": [], "owner": {"reputation": 31868, "user_id": 9245853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4sRg.jpg?s=128&g=1", "display_name": "BigBen", "link": "https://stackoverflow.com/users/9245853/bigben"}, "is_accepted": false, "score": 0, "last_activity_date": 1528300783, "creation_date": 1528300783, "answer_id": 50724791, "question_id": 50723157, "link": "https://stackoverflow.com/questions/50723157/why-is-my-linechart-plotting-data-incorrectly/50724791#50724791", "title": "Why is my LineChart plotting data incorrectly?", "body": "<p>Your chart is plotting values by rows, not columns as you want. See <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/chart-setsourcedata-method-excel\" rel=\"nofollow noreferrer\">SetSourceData Method</a> for more info.</p>\n\n<p>Add <code>PlotBy:=xlColumns</code> to the <code>.SetSourceData</code> line to automatically plot by columns. </p>\n"}], "owner": {"reputation": 13, "user_id": 9706703, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8da28f01db00a2f5562d8547735782d1?s=128&d=identicon&r=PG&f=1", "display_name": "Dives", "link": "https://stackoverflow.com/users/9706703/dives"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528300783, "creation_date": 1528295986, "last_edit_date": 1531164843, "question_id": 50723157, "link": "https://stackoverflow.com/questions/50723157/why-is-my-linechart-plotting-data-incorrectly", "title": "Why is my LineChart plotting data incorrectly?", "body": "<p>I have been working on an excel Macro to graph some data on Chartsheet, but all of a sudden, it now graphs 7 different series instead of 2...</p>\n\n<p>The Code for the graph is:</p>\n\n<pre><code>Public Sub GraphResults()\nDim ws As Worksheet\nDim LineGraph As Chart\nSet ws = ActiveSheet\nSet LineGraph = Charts.Add\n\n    With LineGraph\n        .SetSourceData Source:=ws.Range(\"B29:B35,G29:G35\")\n        .ChartType = xlLineMarkers\n        .HasTitle = True\n        .ChartTitle.Text = \"\"\n        .Axes(xlCategory, xlPrimary).HasTitle = True\n        .Axes(xlCategory, xlPrimary).AxisTitle.Characters.Text = \"X-axis\"\n        .Axes(xlValue, xlPrimary).HasTitle = True\n        .Axes(xlValue, xlPrimary).AxisTitle.Characters.Text = \"Y-axis\"\n        .SeriesCollection(1).XValues = ws.Range(\"A29:A35\")\n    End With\n\n\nEnd Sub\n</code></pre>\n\n<p>Instead of graphing 2 lines where one line has Y-values of B29:B35 and the other has Y values of G29:G35, it graphs <a href=\"https://i.stack.imgur.com/TnGuv.png\" rel=\"nofollow noreferrer\">7 lines</a></p>\n\n<p>Each line has a B value and a G value. For example, series 1 contains 2 points: B29 and G29. Series 2 contains 2 points B30 and G30. I didn't change the code at all. In fact when I open the Macro from the last time it was saved, the graph that displays only has 2 lines! When I re-run the macro, the graph changes to 7 lines. </p>\n\n<p>What's going on here?...</p>\n"}, {"tags": ["ms-access", "vba"], "comments": [{"owner": {"reputation": 899, "user_id": 2186364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577ccc4bf7000c3f7eb734e543e4c7de?s=128&d=identicon&r=PG", "display_name": "TDP", "link": "https://stackoverflow.com/users/2186364/tdp"}, "edited": false, "score": 0, "creation_date": 1528296918, "post_id": 50722951, "comment_id": 88455279, "body": "Have you tried getting one of your 3 users with the issue to try on a machine where it&#39;s working?"}, {"owner": {"reputation": 1, "user_id": 9903694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e7f72c8e5e6014ed96ea28c3d2bdac?s=128&d=identicon&r=PG&f=1", "display_name": "JohnK", "link": "https://stackoverflow.com/users/9903694/johnk"}, "reply_to_user": {"reputation": 899, "user_id": 2186364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577ccc4bf7000c3f7eb734e543e4c7de?s=128&d=identicon&r=PG", "display_name": "TDP", "link": "https://stackoverflow.com/users/2186364/tdp"}, "edited": false, "score": 0, "creation_date": 1528384986, "post_id": 50722951, "comment_id": 88497533, "body": "@TDP This my first question. Just noticed that I had answered in edit, which is wrong. User with problem logged on to my machine (known good) with no issues. Conversely, I logged on to his machine; problem remained. Problem is machine-specific."}, {"owner": {"reputation": 899, "user_id": 2186364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577ccc4bf7000c3f7eb734e543e4c7de?s=128&d=identicon&r=PG", "display_name": "TDP", "link": "https://stackoverflow.com/users/2186364/tdp"}, "edited": false, "score": 0, "creation_date": 1528385635, "post_id": 50722951, "comment_id": 88497972, "body": "Good news. Nothing wrong with your code! Do you have a dedicated IT Pro type team you could delegate the issue to? Who builds the machines?"}, {"owner": {"reputation": 1, "user_id": 9903694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e7f72c8e5e6014ed96ea28c3d2bdac?s=128&d=identicon&r=PG&f=1", "display_name": "JohnK", "link": "https://stackoverflow.com/users/9903694/johnk"}, "reply_to_user": {"reputation": 899, "user_id": 2186364, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/577ccc4bf7000c3f7eb734e543e4c7de?s=128&d=identicon&r=PG", "display_name": "TDP", "link": "https://stackoverflow.com/users/2186364/tdp"}, "edited": false, "score": 0, "creation_date": 1528438288, "post_id": 50722951, "comment_id": 88516557, "body": "@TDP Unfortunately, no. We outsource that."}], "owner": {"reputation": 1, "user_id": 9903694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00e7f72c8e5e6014ed96ea28c3d2bdac?s=128&d=identicon&r=PG&f=1", "display_name": "JohnK", "link": "https://stackoverflow.com/users/9903694/johnk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 562, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528384048, "creation_date": 1528295344, "last_edit_date": 1528384048, "question_id": 50722951, "link": "https://stackoverflow.com/questions/50722951/ms-access-2016-navigationcontrol-tabs-not-displaying", "title": "MS-Access 2016 NavigationControl (Tabs) not displaying", "body": "<p>The NavigationControl (Tabs) does not show in an Access 2016 database, only for some users, after the first tab has been selected.</p>\n\n<p>We have 19 users, all running Windows 7 Professional Service Pack 1 and MS-Access 2016 Runtime. The database contains a central Navigation Form with 8 tabs in the Horizontal Tabs layout, forming a bar above the navigation sub-form. 17 users have no problem with the database, but 3 users have the following problem:</p>\n\n<p>After logging in to the database, the Navigation Form is presented, complete with horizontal tabs for selection. Once a selection has been made (does not matter which tab) the appropriate form is correctly displayed, but the NavigationControl (Tab Bar) disappears.</p>\n\n<p>I have checked all of the users' screen resolutions. There is no correlation with the problem. I have 2 users, both with 1920x1080 resolution; one has the problem and one does not.</p>\n\n<p>I have scoured all the forums, including this one, but I cannot find anything similar.</p>\n\n<p>I tried using VBA in the Navigation Form's Current as follows:</p>\n\n<pre><code>With Me!NavigationControl0\n        .Visible = True\n        .Height = 1.032\n        .Width = 43.817\n        .Top = 0\n        .Left = 0\n        .HorizontalAnchor = acHorizontalAnchorBoth\n        .VerticalAnchor = acVerticalAnchorBoth\n    End With\n</code></pre>\n\n<p>The problem persists. Has anyone witnessed this and come up with a solution?</p>\n\n<p>TDP - User with problem logged on to my machine (known good) with no issues. Conversely, I logged on to his machine; problem remained. Problem is machine-specific.</p>\n\n<p><strong>Edit 07 Jun 18</strong>\nI found that one affected user had two versions of the runtime installed (2010 and 2016) and that the file association was with 2010. I uninstalled the 2010 version and re-associated the database with 2016. It did not cure it.</p>\n\n<p>I also found that my statement that all tabs were affected was incorrect. Two of the tabs show forms that are in what I think is a datasheet view, i.e. displaying a table layout. The NavigationControl (tabs) displays correctly for these. The other tabs are the traditional Form View and the NavigationControl for these disappears.</p>\n\n<p>For each tab, in the Enter event, is <code>DoCmd.SetWarnings False</code>. Nothing else.\nFor the two affected tabs there is code under the Click event:</p>\n\n<pre><code>Private Sub NavigationButton9_Click() ' Enquiry Form\n    DoCmd.BrowseTo acBrowseToForm, \"Enquiry\", \"Navigation Form.NavigationSubform\", , , acFormEdit\n    Me.[NavigationSubform].SetFocus\n    Forms![Navigation Form]![NavigationSubform].Form.FilterOn = False\n    DoCmd.GoToRecord , , acNewRec\nEnd Sub\n</code></pre>\n\n<p>It is the only difference I can find but I cannot see what would invoke the NavigationControl to disappear.</p>\n\n<p>BTW: The Navigation Control itself has no events assigned in any of the categories (Macro, Expression or Code)</p>\n\n<p><strong>Edit 2 - 07 Jun 18</strong>.\nI added a button to the Navigation Form header and used its Click event to display a message box listing the Visibility, Height, Width, Top, Left, H Anchor, V Anchor, Span, Display When and Enabled variables for the NavigationControl. Even with the NavigationControl missing all the variables are OK.</p>\n\n<p>It seems, from relative positioning on the screen, that the sub-form is moving upwards. Could it be that it is lying over the front of the NavigationControl, obscuring it?</p>\n\n<p><strong>Edit 3 - 07 Jun 18</strong>.\nMonitored the .Top variable of the NavigationSubForm. The value is the same, regardless of whether the tabs are there or not; yet the sub-form (or form?) has physically moved upwards (I guess, to obscure the tags).</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1528296357, "post_id": 50723087, "comment_id": 88454912, "body": "@ChrisMelville well my Excel version says &quot;MyBook - MyApplication&quot;. So you might need to implement different options for different Excel versions (I use a German Excel 2016 on Windows 10). If it is the other way round in your Excel of course <code>Left$</code> then."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1528296486, "post_id": 50723087, "comment_id": 88454994, "body": "alternatively test if left of <code>Application.Caption</code> is same as <code>ActiveWindow.Caption</code> and then use <code>Right$</code> and else use <code>Left$</code> (see my edit above)."}, {"owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1528297708, "post_id": 50723087, "comment_id": 88455809, "body": "Yes, in English Excel it&#39;s Application - Window. Interesting that they&#39;re different. Okay thanks. So the basic answer is &quot;Microsoft made it that way&quot; :)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "edited": false, "score": 0, "creation_date": 1528351669, "post_id": 50723087, "comment_id": 88475733, "body": "@ChrisMelville Yes, basically. I cannot imagine any technically reason why it has to be that way, so it must be a Microsoft decision (or a bug). Does this solve your question?"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1528296632, "last_edit_date": 1528296632, "creation_date": 1528295767, "answer_id": 50723087, "question_id": 50722933, "link": "https://stackoverflow.com/questions/50722933/application-caption-behaviour-returning-window-caption-as-well/50723087#50723087", "title": "Application.Caption behaviour: returning Window caption as well", "body": "<p>You can workaround this with \u2026</p>\n\n<pre><code>Debug.Print Right$(Application.Caption, Len(Application.Caption) - Len(ActiveWindow.Caption) - 3)\n</code></pre>\n\n<p>to get the caption you originally set before.</p>\n\n<p>Why is it that it returns something else than was set before?<br>\n<em>Because Microsoft made it that way.</em></p>\n\n<hr>\n\n<p>Different versions seem to have a different order so</p>\n\n<pre><code>If Left$(Application.Caption, Len(ActiveWindow.Caption)) = ActiveWindow.Caption Then\n    Debug.Print Right$(Application.Caption, Len(Application.Caption) - Len(ActiveWindow.Caption) - 3)\nElse\n    Debug.Print Left$(Application.Caption, Len(Application.Caption) - Len(ActiveWindow.Caption) - 3)\nEnd If\n</code></pre>\n\n<p>might always return the correct result.</p>\n"}], "owner": {"reputation": 1310, "user_id": 5419821, "user_type": "registered", "accept_rate": 69, "profile_image": "https://graph.facebook.com/10153652816785960/picture?type=large", "display_name": "Chris Melville", "link": "https://stackoverflow.com/users/5419821/chris-melville"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 1, "accepted_answer_id": 50723087, "answer_count": 1, "score": 1, "last_activity_date": 1528296632, "creation_date": 1528295300, "last_edit_date": 1531161705, "question_id": 50722933, "link": "https://stackoverflow.com/questions/50722933/application-caption-behaviour-returning-window-caption-as-well", "title": "Application.Caption behaviour: returning Window caption as well", "body": "<p>Application.Caption behaves differently according to whether you\u2019re setting or returning the property.</p>\n\n<p>For example, the following Sub:</p>\n\n<pre><code>Sub SetCap()\n    With Application\n        Debug.Print .Caption ' Returns the default: something like \"Microsoft Excel - Book1\"\n        .Caption = \"MyCaption\" ' Set the .Caption property to a custom string\n        .Windows(1).Caption = \"MyWindow\" ' Also customise the Window caption\n        Debug.Print .Caption ' This still returns \"MyCaption - MyWindow\"\n    End With\nEnd Sub\n</code></pre>\n\n<p>I understand that the application caption and the window caption are two separate things, and by default they will appear in the title of the application together, separated by \u201c - \u201d.</p>\n\n<p>You can assign any string you like to Application.Caption.\nThe curiosity, however, is that when <em>returning</em> the Application.Caption, instead of returning the string which you just set, the text will <em>include</em> the separator, and the Window caption as well.</p>\n\n<p>Obviously you could split the string by \u201c - \u201d and return the first part:</p>\n\n<pre><code>Dim Arr As Variant\nArr = split(Application.Caption, \u201c - \u201d)\nDebug.Print Arr(0)\n</code></pre>\n\n<p>...however this would fail if the actual Caption included such a string. For example if you did:</p>\n\n<pre><code>Application.Caption = \u201cFirst Part \u2013 Second Part\u201d\n</code></pre>\n\n<p>... then splitting as above would exclude the second part.</p>\n\n<p>Does anyone know why this behaviour is present? And is there a way to only return the actual Application.Caption, without including the separator and Window caption?</p>\n"}, {"tags": ["vba", "checkbox", "ms-word", "word-contentcontrol"], "comments": [{"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528299794, "post_id": 50722889, "comment_id": 88457247, "body": "<code>CCtrl.Range.Paragraphs(1).Range.Characters.Last.Select</code>, for example. Then maybe <code>Selection.Collapse</code>"}, {"owner": {"reputation": 79, "user_id": 8748581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4874ca1a6ac350e7545bb83b5a41240c?s=128&d=identicon&r=PG&f=1", "display_name": "Reece", "link": "https://stackoverflow.com/users/8748581/reece"}, "reply_to_user": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528302271, "post_id": 50722889, "comment_id": 88458650, "body": "Worked like a charm. Thank you!"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528303109, "post_id": 50722889, "comment_id": 88459061, "body": "Good! I&#39;ll write it up as an answer, then, since others could find it interesting. Since you&#39;re relatively new to the site:  You know about confirming Answers on Stack Overflow?"}], "answers": [{"tags": [], "owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "is_accepted": true, "score": 2, "last_activity_date": 1528303494, "creation_date": 1528303494, "answer_id": 50725564, "question_id": 50722889, "link": "https://stackoverflow.com/questions/50722889/word-macro-to-deselect-a-content-control-after-macro/50725564#50725564", "title": "Word Macro to Deselect a content control after macro", "body": "<p>You can leverage the fact that, through the Content Control's Range the objects which contain it can be accessed. For example, you can \"drill up\" to the paragraph in which the content control is located:</p>\n\n<pre><code>CCtrl.Range.Paragraphs(1).Range.Characters.Last.Select\n</code></pre>\n\n<p>This could also be any character in the paragraph. The following (in my test) puts the selection immediately after the content control:</p>\n\n<pre><code>CCtrl.Range.Paragraphs(1).Range.Characters(4).Select\n</code></pre>\n\n<p>Incorporated into your code:</p>\n\n<pre><code>Private Sub Document_ContentControlOnEnter(ByVal CCtrl As ContentControl)\n  With CCtrl\n    If .Type = wdContentControlCheckBox Then\n      If .Checked = True Then\n        .Range.Paragraphs.First.Style = wdStyleNormal\n        ActiveDocument.TablesOfContents(1).Update\n        Selection.Collapse direction:=wdCollapseEnd\n      Else\n        .Range.Paragraphs.First.Style = wdStyleHeading2\n        ActiveDocument.TablesOfContents(1).Update\n        Selection.MoveRight 1\n      End If\n\n      'Select the last character in the paragraph (the paragraph mark)\n      CCtrl.Range.Paragraphs(1).Range.Characters.Last.Select\n      'Remove the selection, so the cursor blinks at the end of the paragraph\n      Selection.Collapse\n\n    End If\n  End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 8748581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4874ca1a6ac350e7545bb83b5a41240c?s=128&d=identicon&r=PG&f=1", "display_name": "Reece", "link": "https://stackoverflow.com/users/8748581/reece"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 1, "accepted_answer_id": 50725564, "answer_count": 1, "score": 2, "last_activity_date": 1545419257, "creation_date": 1528295165, "last_edit_date": 1545419257, "question_id": 50722889, "link": "https://stackoverflow.com/questions/50722889/word-macro-to-deselect-a-content-control-after-macro", "title": "Word Macro to Deselect a content control after macro", "body": "<p>My current project is making a list for a coworker and since I like to over-complicate everything, I'm running macros for him to check off as he completes work. The description of work will change from a header style to normal when he's completed it, then update the ToC. All of this is working, but I have trouble with the content control staying selected sometimes. I can usually check and uncheck it once or twice with no problem, but eventually the cursor doesn't move out of the check box for some reason so subsequent clicks don't fire the <code>OnEnter</code>.</p>\n\n<pre><code>Private Sub Document_ContentControlOnEnter(ByVal CCtrl As ContentControl)\nWith CCtrl\n  If .Type = wdContentControlCheckBox Then\n    If .Checked = True Then\n      .Range.Paragraphs.First.Style = wdStyleNormal\n      ActiveDocument.TablesOfContents(1).Update\n      Selection.Collapse direction:=wdCollapseEnd\n    Else\n      .Range.Paragraphs.First.Style = wdStyleHeading2\n      ActiveDocument.TablesOfContents(1).Update\n      Selection.MoveRight 1\n    End If\n  End If\nEnd With\nEnd Sub\n</code></pre>\n\n<p>Is there a way to force word to deselect the content control and move the cursor somewhere on the same line?</p>\n\n<p>I tried <code>Selection.MoveDown 1</code>, <code>Selection.Collapse direction:=wdCollapseEnd</code>, and also <code>Selection.MoveEnd</code> but none work.</p>\n"}, {"tags": ["excel", "vba"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 4321745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4467541504d5598f779fdb50b4477ac?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4321745/kyle"}, "edited": false, "score": 0, "creation_date": 1528297774, "post_id": 50722825, "comment_id": 88455857, "body": "Thanks this is helpful information to have. I actually figured it out just now. I went into the Map sources under the developer tab and deleted the XML Maps from the list."}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 0, "last_activity_date": 1528295333, "last_edit_date": 1528295333, "creation_date": 1528294991, "answer_id": 50722825, "question_id": 50722686, "link": "https://stackoverflow.com/questions/50722686/how-can-i-locate-data-ranges-that-fail-to-refresh-in-excel-that-arent-listed-in/50722825#50722825", "title": "How can I locate data ranges that fail to refresh in Excel that aren&#39;t listed in the connections list?", "body": "<p>Loop through all collections and refresh them:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim cnt As Long\n    Dim conns As Connections\n\n    Set conns = ThisWorkbook.Connections\n\n    For cnt = 1 To conns.Count\n        Debug.Print conns.Item(cnt).Name\n        conns.Item(cnt).Refresh\n    Next cnt\n\nEnd Sub\n</code></pre>\n\n<p>The line <code>Debug.Print conns.Item(cnt).Name</code> prints the name of the connection. The other connection properties and methods, which are easily available:</p>\n\n<p><a href=\"https://i.stack.imgur.com/je6N3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/je6N3.png\" alt=\"enter image description here\"></a></p>\n\n<p>And if you have more than one range per connection, a nested loop is quite ok:</p>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim cnt As Long\n    Dim cnt2 As Long\n    Dim conns As Connections\n\n    Set conns = ThisWorkbook.Connections\n\n    For cnt = 1 To conns.Count\n        Debug.Print conns.Item(cnt).Name\n\n        For cnt2 = 1 To conns.Item(cnt).Ranges.Count\n            Debug.Print conns.Item(cnt).Ranges.Item(cnt2).Address\n        Next cnt2\n\n        conns.Item(cnt).Refresh\n    Next cnt\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 4321745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4467541504d5598f779fdb50b4477ac?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4321745/kyle"}, "is_accepted": false, "score": 0, "last_activity_date": 1528297836, "creation_date": 1528297836, "answer_id": 50723817, "question_id": 50722686, "link": "https://stackoverflow.com/questions/50722686/how-can-i-locate-data-ranges-that-fail-to-refresh-in-excel-that-arent-listed-in/50723817#50723817", "title": "How can I locate data ranges that fail to refresh in Excel that aren&#39;t listed in the connections list?", "body": "<p>XML maps are handled separately from their web connections and can be managed from the XML group in the developer tab.</p>\n\n<p><a href=\"https://support.office.com/en-us/article/delete-xml-map-information-from-a-workbook-f3d9ef9f-5cbf-4964-b924-611959d53783\" rel=\"nofollow noreferrer\">https://support.office.com/en-us/article/delete-xml-map-information-from-a-workbook-f3d9ef9f-5cbf-4964-b924-611959d53783</a></p>\n"}], "owner": {"reputation": 181, "user_id": 4321745, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c4467541504d5598f779fdb50b4477ac?s=128&d=identicon&r=PG&f=1", "display_name": "Kyle", "link": "https://stackoverflow.com/users/4321745/kyle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 862, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1528297836, "creation_date": 1528294559, "question_id": 50722686, "link": "https://stackoverflow.com/questions/50722686/how-can-i-locate-data-ranges-that-fail-to-refresh-in-excel-that-arent-listed-in", "title": "How can I locate data ranges that fail to refresh in Excel that aren&#39;t listed in the connections list?", "body": "<p>I have a large workbook with several web and file connections. I have several macros that I run to update different sequences of these connections, the code is simply in the form:</p>\n\n<pre><code>ActiveWorkbook.Connections(\"XMLConnect3\").Refresh\nActiveWorkbook.Connections(\"XMLConnect4\").Refresh\n</code></pre>\n\n<p>When this code runs I get 4 pop ups for every refresh attempt that is in the macro, </p>\n\n<ol>\n<li>\"The following data range failed to refresh: XMLConnect\"</li>\n<li>\"The following data range failed to refresh: XMLConnect1\"</li>\n<li>\"The following data range failed to refresh: XMLConnect2\"</li>\n<li>\"The following data range failed to refresh: Table1\"</li>\n</ol>\n\n<p>I can click Ok on each one and the data refreshes normally. If I manually fresh my connections, these pop ups do not show, only when VBA executes Connections.Refresh does this happen.</p>\n\n<p>In my connections list, there is no XMLConnect, XMLConnect1, or XMLConnect2. I used to have XML-web connections with those names but have since deleted them. I searched through all of my VBA code and looked in my Names list, I can't find any reference to them. </p>\n\n<p>Any help would be appreciated! </p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 4239635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bf7b1af6b5b3b8fb86077eb589a09eb1?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/4239635/ganesh"}, "edited": false, "score": 0, "creation_date": 1528360859, "post_id": 50722554, "comment_id": 88480814, "body": "Thanks a ton! It worked like Gem. However I found few other scenario&#39;s based on that I have edited the question. It would be of great help if you could help me with the formula to get the desired output. Thanks in advance again."}], "tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": true, "score": 3, "last_activity_date": 1528362711, "last_edit_date": 1528362711, "creation_date": 1528294225, "answer_id": 50722554, "question_id": 50722496, "link": "https://stackoverflow.com/questions/50722496/how-to-delete-0-in-between-part-number-in-excel/50722554#50722554", "title": "How to delete 0 in between part number in Excel", "body": "<p>Try this:</p>\n\n<pre><code>=SUBSTITUTE(I8,\"-0\",\"-\")\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Your edit asks a totally different question. Assuming the pattern you show is consistent, you could use this horrendous formula:</p>\n\n<pre><code>=CONCATENATE(VALUE(SUBSTITUTE(LEFT(I8,FIND(\"-\",I8,FIND(\"-\",I8)+1)-1),\"-\",\"\")),RIGHT(I8,LEN(I8)-FIND(\"-\",I8,FIND(\"-\",I8)+1)+1))\n</code></pre>\n\n<p>Or you could use a small UDF:</p>\n\n<pre><code>Function GaneshFormat(ByVal sInput As String, ByVal sSeparator As String) As String\n    Dim s() As String\n    Dim i As Integer\n    s = Split(sInput, sSeparator)\n    For i = 1 To UBound(s)\n        s(i - 1) = CLng(s(i))\n    Next i\n    ReDim Preserve s(UBound(s) - 1)\n    GaneshFormat = Join(s, sSeparator)\nEnd Function\n</code></pre>\n\n<p>Which you can use like this:</p>\n\n<pre><code>=GaneshFormat(I8,\"-\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 4239635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bf7b1af6b5b3b8fb86077eb589a09eb1?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/4239635/ganesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1528376030, "last_edit_date": 1528376030, "creation_date": 1528370488, "answer_id": 50739935, "question_id": 50722496, "link": "https://stackoverflow.com/questions/50722496/how-to-delete-0-in-between-part-number-in-excel/50739935#50739935", "title": "How to delete 0 in between part number in Excel", "body": "<pre><code>=IF(LEFT($A2,5)=\"0-000\",REPLACE($A2,1,5,\"\"),IF(LEFT($A2,4)=\"0-00\",REPLACE($A2,1,4,\"\"),IF(LEFT($A2,3)=\"0-0\",REPLACE($A2,1,3,\"\"),IF(LEFT($A2,2)=\"0-\",REPLACE($A2,1,2,\"\"),IF(LEFT($A2,1)=\"0\",REPLACE($A2,1,1,\"\"),IFERROR(IF(FIND(\"-0\",$A2,1)=2,REPLACE($A2,FIND(\"0\",$A2,1),1,\"\"),$A2),A2))))))\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 4239635, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/bf7b1af6b5b3b8fb86077eb589a09eb1?s=128&d=identicon&r=PG&f=1", "display_name": "Ganesh", "link": "https://stackoverflow.com/users/4239635/ganesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 50722554, "answer_count": 2, "score": 0, "last_activity_date": 1528376030, "creation_date": 1528294050, "last_edit_date": 1531161705, "question_id": 50722496, "link": "https://stackoverflow.com/questions/50722496/how-to-delete-0-in-between-part-number-in-excel", "title": "How to delete 0 in between part number in Excel", "body": "<p>I am trying to delete 0 in between alpha numeric \"Part Number\".</p>\n\n<p>Part Number Expected output\n0-1379095-2 1379095-2\n0-0042899-3 42899-3\n0-0185309-1 185309-1</p>\n\n<p><a href=\"https://i.stack.imgur.com/22ZgN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/22ZgN.png\" alt=\"enter image description here\"></a></p>\n\n<p>Any help is deeply appreciated.</p>\n\n<p>Thanks,\nGanesh</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1528294530, "post_id": 50722443, "comment_id": 88453631, "body": "Perhaps it is communicating but failing because the date format that your sql server expects is not the same that VBA holds for a date. Consider using the <code>Test()</code> function to change the format like <code>Text(StartDate, &#39;YYYY-MM-DD&#39;)</code> in your sql."}, {"owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "reply_to_user": {"reputation": 38450, "user_id": 2221001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e19e92b3618d46eb6ab80e4bc38cec44?s=128&d=identicon&r=PG", "display_name": "JNevill", "link": "https://stackoverflow.com/users/2221001/jnevill"}, "edited": false, "score": 0, "creation_date": 1528294906, "post_id": 50722443, "comment_id": 88453902, "body": "Oh, I see how it works now.  You have to set Command Type = Default and then the Command Text is updated accordingly.  That&#39;s it."}], "answers": [{"tags": [], "owner": {"reputation": 276, "user_id": 9903850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ece9df0b43c989f387899ee248e309?s=128&d=identicon&r=PG&f=1", "display_name": "John F", "link": "https://stackoverflow.com/users/9903850/john-f"}, "is_accepted": true, "score": 4, "last_activity_date": 1528296772, "last_edit_date": 1528296772, "creation_date": 1528295344, "answer_id": 50722952, "question_id": 50722443, "link": "https://stackoverflow.com/questions/50722443/excel-vba-pass-parameter-to-oledbconnection/50722952#50722952", "title": "Excel VBA pass parameter to OLEDBConnection", "body": "<p>Your <code>.CommandText</code> string has an error around the <code>AND</code> (notice how it is blue in color... it is resolving as the VBA keyword <code>And</code>). </p>\n\n<p>It should read:</p>\n\n<pre><code>\"EXEC SELECT * FROM RECONCILIATION.dbo.TBL_FMDDATA_HIST_SPLIT \nWHERE AsOfDate between '\" &amp; StartDate &amp; \"'\" &amp; \" AND \" &amp; \"'\" &amp; EndDate &amp; \"'\"\n</code></pre>\n"}], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1130, "favorite_count": 2, "accepted_answer_id": 50722952, "answer_count": 1, "score": 2, "last_activity_date": 1528296772, "creation_date": 1528293889, "last_edit_date": 1528294917, "question_id": 50722443, "link": "https://stackoverflow.com/questions/50722443/excel-vba-pass-parameter-to-oledbconnection", "title": "Excel VBA pass parameter to OLEDBConnection", "body": "<p>In an Excel workbook I have several connections to a SQL Server DB.  I thought I could run a small script like the one below, but it's not doing what I want.  I want to refresh the OLEDBConnection, and pass in a StartDate and EndDate, but it's not actually communicating with the connection.</p>\n\n<pre><code>Sub RefreshWithDates()\n\nDim StartDate As Date\nDim EndDate As Date\n\nStartDate = Sheets(\"Pivot_Summary\").Range(\"B1\").Value\nEndDate = Sheets(\"Pivot_Summary\").Range(\"B2\").Value\n\n    With ActiveWorkbook.Connections(\"FMDDATA_HIST_SPLIT\").OLEDBConnection\n        .CommandText = \"SELECT * FROM RECONCILIATION.dbo.TBL_FMDDATA_HIST_SPLIT Where AsOfDate between '\" &amp; StartDate &amp; \"' &amp; \" And \" &amp; '\" &amp; EndDate &amp; \"'\"\n        ActiveWorkbook.Connections(\"FMDDATA_HIST_SPLIT\").Refresh\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel", "criteria", "median", "minimum"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 3, "creation_date": 1528291755, "post_id": 50721686, "comment_id": 88451717, "body": "Have you tried anything and hit a snag? I imagine there are many examples online. You probably need array formulae."}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 0, "creation_date": 1528292026, "post_id": 50721686, "comment_id": 88451903, "body": "I&#39;m in a good mood so have suggested an answer below, but in future you should show some effort first."}, {"owner": {"reputation": 2446, "user_id": 1532454, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aNEeA.jpg?s=128&g=1", "display_name": "Jeff Learman", "link": "https://stackoverflow.com/users/1532454/jeff-learman"}, "edited": false, "score": 0, "creation_date": 1528300116, "post_id": 50721686, "comment_id": 88457452, "body": "Welcome to Stack Overflow! Please take the <a href=\"https://stackoverflow.com/tour\">tour</a> and read <a href=\"https://stackoverflow.com/help/how-to-ask\">How do I ask a good question?</a> Your best bet here is to do your research, <a href=\"https://stackoverflow.com/help/searching\">search</a> for related topics on SO, and give it a go. If you get stuck and can&#39;t get unstuck after doing more research and searching, post a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable</a> example of your attempt and say specifically where you&#39;re stuck. People will be glad to help. Good luck!"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 9903612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b0df8a95aedb04a6385954a8a127ac3?s=128&d=identicon&r=PG&f=1", "display_name": "huw96", "link": "https://stackoverflow.com/users/9903612/huw96"}, "edited": false, "score": 0, "creation_date": 1528294622, "post_id": 50721830, "comment_id": 88453702, "body": "Hi, thanks for your message! I&#39;m looking for it to be written in vba code rather than excel formulas. So the report can be fully automated. Nothing I&#39;ve tried so far has worked!"}, {"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "reply_to_user": {"reputation": 1, "user_id": 9903612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b0df8a95aedb04a6385954a8a127ac3?s=128&d=identicon&r=PG&f=1", "display_name": "huw96", "link": "https://stackoverflow.com/users/9903612/huw96"}, "edited": false, "score": 0, "creation_date": 1528294779, "post_id": 50721830, "comment_id": 88453814, "body": "You could record a macro while you enter the formulas? I&#39;ll take a look later when I have a bit of time."}], "tags": [], "owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "is_accepted": false, "score": 1, "last_activity_date": 1528291992, "creation_date": 1528291992, "answer_id": 50721830, "question_id": 50721686, "link": "https://stackoverflow.com/questions/50721686/finding-the-minimum-and-median-values-in-a-column-if-they-match-criteria-using-v/50721830#50721830", "title": "Finding the minimum and median values in a column if they match criteria using vba", "body": "<p>In G2 and down</p>\n\n<pre><code>=min(if(b$2:b$20=f2,c$2:c$20))\n</code></pre>\n\n<p>In H2 and down</p>\n\n<pre><code>=median(if(b$2:b$20=f2,c$2:c$20))\n</code></pre>\n\n<p>Adjust ranges as necessary.</p>\n\n<p>Enter both as array formulas - use Ctrl + Shift + Enter to confirm. If done correctly curly brackets will surround the formula.</p>\n"}, {"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528296579, "post_id": 50722633, "comment_id": 88455057, "body": "@huw96 You can use the above function"}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 0, "last_activity_date": 1528294788, "last_edit_date": 1528294788, "creation_date": 1528294384, "answer_id": 50722633, "question_id": 50721686, "link": "https://stackoverflow.com/questions/50721686/finding-the-minimum-and-median-values-in-a-column-if-they-match-criteria-using-v/50722633#50722633", "title": "Finding the minimum and median values in a column if they match criteria using vba", "body": "<p>Here is an UDF, though I would go with the answer already given.</p>\n\n<p>Func <code>GetMinMedianIf</code>:</p>\n\n<p>Returns either the minimum or median, according to arg3, for the range specified in arg1, where the value in the first column of the range (arg1) matches that of the arg2 range.</p>\n\n<ol>\n<li>Arg1 <code>rng</code>: The entire data range</li>\n<li>Arg2 <code>searchValue</code>: The range containing the value to match on e.g. D2 (which is A)</li>\n<li>Arg3 <code>MinMedian</code>: The calculation to perform. <code>Min</code> for Minimum, Median for Median</li>\n</ol>\n\n<hr>\n\n<p><strong>Code:</strong></p>\n\n<pre><code>Option Explicit\n\nPublic Sub TEST() '&lt;== This is just a test sub to run\n    Debug.Print GetMinMedianIf([A2:B16], [F2], \"Min\") ' or \"Median\"\nEnd Sub\n</code></pre>\n\n<p><strong>UDF:</strong></p>\n\n<pre><code> Public Function GetMinMedianIf(ByRef rng As Range, ByVal searchValue As Range, ByVal MinMedian As String) As Long\n    'MinMedian args: \"Min\" for Min; \"Median\" for Median\n    Dim arr(), i As Long, counter As Long\n\n    If searchValue.Cells &gt; 1 Then\n        GetMinMedianIf = CVErr(xlErrValue)\n        Exit Function\n    End If\n\n    arr = rng.Value\n    Dim arr1()\n    ReDim arr1(0 To UBound(arr, 1) - 1)\n\n    For i = LBound(arr, 1) To UBound(arr, 1)\n        If arr(i, 1) = searchValue Then\n            arr1(counter) = arr(i, 2)\n            counter = counter + 1\n        End If\n    Next i\n\n    ReDim Preserve arr1(0 To counter)\n\n    Select Case MinMedian\n    Case \"Min\"\n        GetMinMedianIf = Application.WorksheetFunction.Min(arr1)\n    Case \"Median\"\n        GetMinMedianIf = Application.WorksheetFunction.Median(arr1)\n    End Select\nEnd Function\n</code></pre>\n\n<hr>\n\n<p>Usage in sheet</p>\n\n<p><a href=\"https://i.stack.imgur.com/9KrwE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/9KrwE.png\" alt=\"UDF\"></a></p>\n"}], "owner": {"reputation": 1, "user_id": 9903612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b0df8a95aedb04a6385954a8a127ac3?s=128&d=identicon&r=PG&f=1", "display_name": "huw96", "link": "https://stackoverflow.com/users/9903612/huw96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528294788, "creation_date": 1528291580, "last_edit_date": 1528291645, "question_id": 50721686, "link": "https://stackoverflow.com/questions/50721686/finding-the-minimum-and-median-values-in-a-column-if-they-match-criteria-using-v", "title": "Finding the minimum and median values in a column if they match criteria using vba", "body": "<p>I have a sheet with a load of data which corresponds to a certain group, in this case groups A, B, C, D and E.</p>\n\n<p>I would like to run a macro that would be on another sheet and would find the minimum and median values that correspond with what's in the first column of the table.</p>\n\n<p><img src=\"https://i.stack.imgur.com/PLGZA.png\" alt=\"Image\"></p>\n\n<p>Using the image, I'd like to run a macro that would look at the value in cell F2 and then give me the minimum value in column C that has \"A\" in the adjacent cell and so on for each group. Similarly I would like the median to then be calculated for each group</p>\n\n<p>Any suggestions would be much appreciated!</p>\n\n<p>Cheers</p>\n"}, {"tags": ["vba", "excel", "autofilter"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1528291637, "post_id": 50721630, "comment_id": 88451622, "body": "add a <code>, Operator:=xlFilterValues</code> as third parameter."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528291650, "post_id": 50721630, "comment_id": 88451633, "body": "What do you mean? You can use an array to assign the values to use exactly as @PEH has just said!"}, {"owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "edited": false, "score": 0, "creation_date": 1528295961, "post_id": 50721630, "comment_id": 88454635, "body": "@peh thanks I have used this now. Knew it was something basic missing :)"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 6, "last_activity_date": 1528292169, "last_edit_date": 1528292169, "creation_date": 1528291642, "answer_id": 50721703, "question_id": 50721630, "link": "https://stackoverflow.com/questions/50721630/vba-autofilter-using-multiple-criteria/50721703#50721703", "title": "VBA Autofilter Using Multiple Criteria", "body": "<p>You need Operator:=xlFilterValues.</p>\n\n<pre><code>Selection.AutoFilter field:=10, Operator:=xlFilterValues, Criteria1:=Array(\"Fixtures &amp; Fittings\", \"Furniture &amp; Equipment\", \"Land &amp; Buildings\", \"Motor Vehicles\", \"Plant &amp; Machinery\")\n</code></pre>\n\n<p>If the criteria is constant, I would assume that the filter range is consistent as well. You may wish to move away from using Selection in the near future. See <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>.</p>\n"}], "owner": {"reputation": 167, "user_id": 9630197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31d5cd6a208cf541aea4da0c87ac2e3e?s=128&d=identicon&r=PG&f=1", "display_name": "SB999", "link": "https://stackoverflow.com/users/9630197/sb999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12567, "favorite_count": 1, "accepted_answer_id": 50721703, "answer_count": 1, "score": 4, "last_activity_date": 1528292169, "creation_date": 1528291426, "last_edit_date": 1531164843, "question_id": 50721630, "link": "https://stackoverflow.com/questions/50721630/vba-autofilter-using-multiple-criteria", "title": "VBA Autofilter Using Multiple Criteria", "body": "<p>All, </p>\n\n<p>I am trying to filter on multiple criteria within VBA.</p>\n\n<p>However I cannot find a simple way of doing this. The criteria I am selecting will always be constant but greater than 2 therefore I cannot use the or operator. </p>\n\n<p>Code below;</p>\n\n<pre><code>Selection.AutoFilter field:=10, Criteria1:=Array(\"Fixtures &amp; Fittings\", \"Furniture &amp; Equipment\", \"Land &amp; Buildings\", \"Motor Vehicles\", \"Plant &amp; Machinery\")\n</code></pre>\n\n<p>My current solution only filters on the last criteria within the array.</p>\n\n<p>Due to the file set up I am unable to insert a formula in another column. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 3, "creation_date": 1528290366, "post_id": 50721161, "comment_id": 88450692, "body": "Just so I&#39;m clear, you want to edit the contents of another excel file without opening it...?"}, {"owner": {"reputation": 2884, "user_id": 6060083, "user_type": "registered", "accept_rate": 78, "profile_image": "https://graph.facebook.com/10153430563728202/picture?type=large", "display_name": "sudonym", "link": "https://stackoverflow.com/users/6060083/sudonym"}, "edited": false, "score": 0, "creation_date": 1528290464, "post_id": 50721161, "comment_id": 88450758, "body": "I guess he means &quot;without opening the file by clicking on it on the windows UI&quot;"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1528290570, "post_id": 50721161, "comment_id": 88450824, "body": "<i>without having to activate macro or open workbook</i> - call Bill Gates and ask for the source code of Excel. Then hire a team of rock-star devs  and give them about 6 months. Then ping me, I wanna see the result as well! :)"}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 2, "creation_date": 1528290582, "post_id": 50721161, "comment_id": 88450833, "body": "Technically if you disable and enable screen updating you could open, edit, save and close a workbook without ever seeing it, but to trigger this on every cell change would make using your workbook a nightmare."}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1528290635, "post_id": 50721161, "comment_id": 88450868, "body": "Assuming you mean that you want to automate a data transfer, rather than requiring manual steps... What&#39;s the trigger to copy data? It&#39;s going to get really slow and awkward if you open the target workbook, copy data to it, then close it again after every single cell changes..."}, {"owner": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528290845, "post_id": 50721161, "comment_id": 88451015, "body": "@TimWilkinson without physically opening the workbook...... obviously the workbooks will be opened and closed within the macro . My point was I do not want to open up my workbook every time I want to update these values and am wondering if there is a way this macro can be triggered on its own every time there is a cell change in the Master workbook so it runs on its own without me having to trigger it."}, {"owner": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1528290956, "post_id": 50721161, "comment_id": 88451113, "body": "@Olly currently its assigned to a button which is exactly my main problem because I have to trigger it physically and it is not automated"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528290984, "post_id": 50721161, "comment_id": 88451138, "body": "@DYilm \u2460 This macro needs no run in the master workbook to trigger anything. \u2461 If you open/update/close on every cell change this will slow you down to un-usable."}, {"owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 1, "creation_date": 1528291035, "post_id": 50721161, "comment_id": 88451188, "body": "@DYilm In that case the answer to your question is yes, but I wouldn&#39;t advise it as it would make your workbook almost unusable. You would be better off doing it manually like you have now, or catch the onsave or beforeclose events."}, {"owner": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "edited": false, "score": 0, "creation_date": 1528291894, "post_id": 50721161, "comment_id": 88451814, "body": "@Jeeped you are absolutely right, I have edited my post now to attach my code, that is my last intension just looking for some help or a better way of achieving my goal :)"}, {"owner": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "reply_to_user": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "edited": false, "score": 0, "creation_date": 1528291949, "post_id": 50721161, "comment_id": 88451847, "body": "@TimWilkinson that is a very good idea (to get it to catch onsave events). The workbook has an autosave macro so after each entry there is an autosave. How can i link my code to this?"}], "answers": [{"tags": [], "owner": {"reputation": 3541, "user_id": 1616731, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/c9adb6c09548c81a8a9a46d7497081f6?s=128&d=identicon&r=PG&f=1", "display_name": "Tim Wilkinson", "link": "https://stackoverflow.com/users/1616731/tim-wilkinson"}, "is_accepted": true, "score": 0, "last_activity_date": 1528292252, "creation_date": 1528292252, "answer_id": 50721920, "question_id": 50721161, "link": "https://stackoverflow.com/questions/50721161/how-to-automatically-copy-data-entry-from-1-workbook-into-another-without-having/50721920#50721920", "title": "How to automatically copy data entry from 1 workbook into another without having to activate macro or open workbook", "body": "<p>As per your comment, to run your code before save put the following into the <code>ThisWorkbook</code> object.</p>\n\n<pre><code>Private Sub Workbook_BeforeSave(Cancel As Boolean)\n\n    Dim wb As Workbook\n    Dim Reportwb As Workbook\n    Set Reportwb = Workbooks(\"Slave.xlsm\")\n    Set wb = Workbooks.Open(Filename:=\"C:\\Users\\yilmadu001          \\Desktop\\Master.xlsm\")\n    wb.Sheets(\"Data\").Range(\"A8:BL8\").Copy\n    Reportwb.Sheets(\"DATA\").Range(\"A8:BL8\").Insert Shift:=xlDown\n    Reportwb.Save\n    wb.Close False\n    Application.ScreenUpdating = True\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9903496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d131a8c4a45bd3f22e6c2da6e0ec39bb?s=128&d=identicon&r=PG&f=1", "display_name": "DYilm", "link": "https://stackoverflow.com/users/9903496/dyilm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 0, "accepted_answer_id": 50721920, "answer_count": 1, "score": 1, "last_activity_date": 1528292580, "creation_date": 1528290258, "last_edit_date": 1528292580, "question_id": 50721161, "link": "https://stackoverflow.com/questions/50721161/how-to-automatically-copy-data-entry-from-1-workbook-into-another-without-having", "title": "How to automatically copy data entry from 1 workbook into another without having to activate macro or open workbook", "body": "<p>I have come across a problem while trying to do the following:</p>\n\n<p>I have 2 workbooks 1 called Master and the other one called Slave. Master has a worksheet called Data where data is inputted into it automatically every so often. Data is inputted into cells ranging from A8 to BL8. Every time new data is stored, it pushes the old data downwards and saves it into again A8:BL8. Slave has a worksheet called DATA with the exact same format. </p>\n\n<p>My goal is the following:</p>\n\n<p>I want to write a VBA code where each time new data is inputted into(USUALLY 6-7 NEW DATA ENTRIES PER 24 HOURS) Master workbook(Worksheet called Data), I want it to update the same information onto the Slave workbook (worksheet called DATA) without having to even open or run the workbook(Data can be inputted at random times throughout the day so I am not always around to keep track and need it to transfer data on its own).</p>\n\n<p>Both workbooks are saved in different locations on my computer. My attempt worked, however I was only able to get it to work with copying the current values in the cell range A8:BL8 and moving it over to the workbook I want by triggering the macro with a button(inserting)... (I hope my problem is clear) so it only updates the very latest data and not ALL the data.</p>\n\n<p>My goal eventually is to be able to do this between many workbooks with the same format (into the same workbook Slave(worksheet DATA))</p>\n\n<p>My Code runs from workbook Slave (worksheet DATA) via a button assigned to this macro.</p>\n\n<pre><code>Sub OpenCopyPaste()\n\n    Dim wb As Workbook\n    Dim Reportwb As Workbook\n    Set Reportwb = Workbooks(\"Slave.xlsm\")\n    Set wb = Workbooks.Open(Filename:=\"C:\\Users\\yilmadu001          \\Desktop\\Master.xlsm\")\n    wb.Sheets(\"Data\").Range(\"A8:BL8\").Copy\n    Reportwb.Sheets(\"DATA\").Range(\"A8:BL8\").Insert Shift:=xlDown\n    Reportwb.Save\n    wb.Close False\n    Application.ScreenUpdating = True\nEnd Sub\n</code></pre>\n"}, {"tags": ["xml", "excel", "excel-2010", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1532202508, "post_id": 50721158, "comment_id": 89888413, "body": "Have you tried, on the failing machine(s) to use an API tester and see what message you get back?"}], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1528730017, "post_id": 50729477, "comment_id": 88607787, "body": "@JanWillem - did my approach to narrow the error field by an Extended load function help?"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1528318633, "creation_date": 1528318633, "answer_id": 50729477, "question_id": 50721158, "link": "https://stackoverflow.com/questions/50721158/requests-from-xmldom-to-retrieve-xml-from-api-are-blocked/50729477#50729477", "title": "Requests from XMLDom to retrieve XML from API are blocked", "body": "<p><strong>Approach by narrowing the error field</strong></p>\n\n<p>Apparently your code using late binding is executed, but displays an error message. Often XML code contains non readable character entities (e.g. ampersands <code>&amp;</code>).\nYou can narrow the error field by replacing the complete <code>Else</code> block in your code with the following statements:</p>\n\n<pre><code>  Dim xPE        As Object    ' Set xPE = CreateObject(\"MSXML2.IXMLDOMParseError\")\n  Dim strErrText As String\n  Set xPE = objDoc.parseError\n  With xPE\n     strErrText = \"Load error \" &amp; .ErrorCode &amp; \" xml file \" &amp; vbCrLf &amp; _\n      Replace(.URL, \"file:///\", \"\") &amp; vbCrLf &amp; vbCrLf &amp; _\n      xPE.reason &amp; _\n      \"Source Text: \" &amp; .srcText &amp; vbCrLf &amp; vbCrLf &amp; _\n      \"Line No.:    \" &amp; .Line &amp; vbCrLf &amp; _\n      \"Line Pos.: \" &amp; .linepos &amp; vbCrLf &amp; _\n      \"File Pos.:  \" &amp; .filepos &amp; vbCrLf &amp; vbCrLf\n  End With\n  MsgBox strErrText, vbExclamation\n  Set xPE = Nothing\n  Exit Function\n</code></pre>\n\n<p><strong>Additional hint</strong></p>\n\n<p>If you set your <code>objDoc</code> object to memory with <code>Set objDoc = CreateObject(\"MSXML2.DOMDocument\")</code> generally you are getting an older version (3.0), so in most cases it's preferrable to use explicitly <code>Set objDoc = CreateObject(\"MSXML2.DOMDocument.6.0\")</code> instead to get the latest 6.0 version.</p>\n"}], "owner": {"reputation": 352, "user_id": 249092, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/161da903a25258387bd55479b9a4efe9?s=128&d=identicon&r=PG", "display_name": "JanWillem", "link": "https://stackoverflow.com/users/249092/janwillem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528352931, "creation_date": 1528290253, "last_edit_date": 1531164843, "question_id": 50721158, "link": "https://stackoverflow.com/questions/50721158/requests-from-xmldom-to-retrieve-xml-from-api-are-blocked", "title": "Requests from XMLDom to retrieve XML from API are blocked", "body": "<p>I've written a macro in VBA for Excel 2010 to retrieve data from an API that returns XML. I'm doing this voluntarily to help my wife and her colleagues from doing a lot of manual work. So, the macro is used in an enterprise setting, where security settings are out of my hands and having never worked in an enterprise setting, I also have no idea what the possibilities are.</p>\n\n<p>However, the IT guys have stated they are willing to help, but have no idea how to fix it. So I wonder if anyone here can point in the right direction on how to get this to work on all PCs.</p>\n\n<p>The code is as below, and it works on the home PCs of all my wife's colleagues and my own too. It also works on some work PCs, but on some not. The code fails on the <code>objDoc.Load</code> part, it shows my error message: </p>\n\n<pre><code>MsgBox (\"There was an error when connecting to the API)\n</code></pre>\n\n<p>I wonder if there are enterprise settings, or individual Excel settings that block access to external URLs in macros. I wouldn't be surprised, as it would be good security, but I guess there should also be a way to whitelist the url of the API? </p>\n\n<p>Does anyone have an idea how this could be fixed? Either in the code, in Excel 2010 settings or any Office enterprise settings I'm not aware of?</p>\n\n<pre><code>Dim strUrl as String\nDim objDoc As Object\nSet objDoc = CreateObject(\"MSXML2.DOMDocument\")\nobjDoc.async = False\n\nstrUrl = {api URL}\n\n    If objDoc.Load(strUrl) Then\n        'it worked!\n    Else\n        MsgBox (\"There was an error when connecting to the API)\n        Exit Function\n    End If\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 8, "creation_date": 1528289726, "post_id": 50720924, "comment_id": 88450277, "body": "Why not use the FACT formula?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 2, "creation_date": 1528289812, "post_id": 50720924, "comment_id": 88450333, "body": "And change those Integers to Long"}, {"owner": {"reputation": 5586, "user_id": 3233363, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/pkWcW.jpg?s=128&g=1", "display_name": "Cyril", "link": "https://stackoverflow.com/users/3233363/cyril"}, "edited": false, "score": 0, "creation_date": 1528289884, "post_id": 50720924, "comment_id": 88450381, "body": "If you really have to use a For i ... next i (sounds like this is for a class), why not store values in an array from 1 to n, then multiply the previous stored output value using array(i) from lower to upper bound?  Or similarly, use a second variable to store the output so you get k = k * i"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1528290097, "post_id": 50720924, "comment_id": 88450526, "body": "As @pierre44 notes, you should not &#39;manually&#39; adjust the counter used in a For ... Next loop."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 0, "creation_date": 1528290399, "post_id": 50720924, "comment_id": 88450709, "body": "btw, if need to increment by something other than 1 for each loop, you can adjust the optional Step parameter."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1528290421, "post_id": 50720924, "comment_id": 88450727, "body": "Guys guys guys, I feel like you&#39;re overcomplicating things a little here. While I absolutely agree that there are other superior ways of achieving what OP intends to do and there&#39;s nothing wrong with pointing it out, let&#39;s keep in mind he/she probably is very new to programming altogether and has no / very little idea of how to impelement an array to a for loop, how to apply a WorksheetFunction or even why should the Integers be changed to Long."}, {"owner": {"reputation": 542, "user_id": 7099906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JfvZO.png?s=128&g=1", "display_name": "Taylor Scott", "link": "https://stackoverflow.com/users/7099906/taylor-scott"}, "edited": false, "score": 0, "creation_date": 1528292042, "post_id": 50720924, "comment_id": 88451918, "body": "In this case you can set the value of cell B5 to the factorial of cell B3 directly by using <code>[B5]=[Fact(B3)]</code>"}, {"owner": {"reputation": 13, "user_id": 9903383, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jessie", "link": "https://stackoverflow.com/users/9903383/jessie"}, "edited": false, "score": 0, "creation_date": 1528296579, "post_id": 50720924, "comment_id": 88455058, "body": "Thank you all. Yes,I&#39;m very new. It&#39;s not for my class but for learning how to write for...next."}], "answers": [{"tags": [], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "is_accepted": false, "score": 2, "last_activity_date": 1528290012, "creation_date": 1528290012, "answer_id": 50721077, "question_id": 50720924, "link": "https://stackoverflow.com/questions/50720924/vba-using-for-next-calculate-123-n/50721077#50721077", "title": "VBA Using for...next calculate 1*2*3...*n", "body": "<p>You need to add another variable to calculate it as below:    </p>\n\n<pre><code>Sub Try_Click()\n\n\n\nDim i As Integer\nDim n As Integer\nDim k As Long\nk = 1\nn = ThisWorkbook.Sheets(\"Sheet2\").Cells(3, 2).Value\n\nFor i = 1 To n\n\nk = k * (i)\nNext i\n\nThisWorkbook.Sheets(\"Sheet2\").Cells(5, 2) = k\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": false, "score": 2, "last_activity_date": 1528292283, "last_edit_date": 1528292283, "creation_date": 1528290033, "answer_id": 50721081, "question_id": 50720924, "link": "https://stackoverflow.com/questions/50720924/vba-using-for-next-calculate-123-n/50721081#50721081", "title": "VBA Using for...next calculate 1*2*3...*n", "body": "<p>You need an additional variable for the result. Because if you change <code>i</code> within the <code>For</code> loop you fail the auto increment of the loop.</p>\n\n<p>Also I recommend to use <code>Long</code> instead of <code>Integer</code> (for <code>result</code>). Why? Because for <code>n &gt; 7</code> it will already exceed the limits of <code>Integer</code> and throw an overflow error. <code>Long</code> at least lasts until <code>n = 12</code>. For more you will need to use <code>Double</code> but that will result in an approximated result for <code>n &gt; 18</code>.</p>\n\n<pre><code>Option Explicit\n\nSub MultiplyN()\n    Dim i As Long\n    Dim n As Long\n    n = 10 'ThisWorkbook.Sheets(\"Sheet 1\").Cells(3, 2).Value\n\n    Dim result As Long\n    result = 1\n\n    For i = 1 To n\n        Debug.Print result &amp; \" *\" &amp; i &amp; \"=\" 'look this output in the intermediate window\n        result = result * i\n    Next i 'auto increments i\n\n    Debug.Print result\n    'ThisWorkbook.Sheets(\"Sheet 1\").Cells(5, 2) = result\nEnd Sub\n</code></pre>\n\n<p>Note that all <code>Debug.Print</code> lines are not needed to calculate but just to illustrate in the intermediate window what happens.</p>\n"}, {"tags": [], "owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "is_accepted": true, "score": 3, "last_activity_date": 1528290200, "creation_date": 1528290200, "answer_id": 50721136, "question_id": 50720924, "link": "https://stackoverflow.com/questions/50720924/vba-using-for-next-calculate-123-n/50721136#50721136", "title": "VBA Using for...next calculate 1*2*3...*n", "body": "<p>Don't change <strong><em>i</em></strong> in the loop:</p>\n\n<pre><code>Sub Try_Click()\n\n    Dim i As Long\n    Dim n As Long\n    Dim prod As Long\n\n    n = ThisWorkbook.Sheets(\"Sheet 1\").Cells(3, 2).Value\n    prod = 1\n    For i = 1 To n\n        prod = prod * i\n    Next i\n\n    ThisWorkbook.Sheets(\"Sheet 1\").Cells(5, 2) = prod\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 2, "last_activity_date": 1528290417, "creation_date": 1528290417, "answer_id": 50721222, "question_id": 50720924, "link": "https://stackoverflow.com/questions/50720924/vba-using-for-next-calculate-123-n/50721222#50721222", "title": "VBA Using for...next calculate 1*2*3...*n", "body": "<p>As mentioned in comments, I also would have done:</p>\n\n<pre><code>Option Explicit\nPublic Sub Try_Click()\n    Dim n As Long\n    With ThisWorkbook.Sheets(\"Sheet 1\")\n        n = .Cells(3, 2)\n        .Cells(5, 2) = Application.WorksheetFunction.Fact(n)\n    End With\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 542, "user_id": 7099906, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JfvZO.png?s=128&g=1", "display_name": "Taylor Scott", "link": "https://stackoverflow.com/users/7099906/taylor-scott"}, "edited": false, "score": 0, "creation_date": 1528292447, "post_id": 50721286, "comment_id": 88452226, "body": "You don&#39;t even need that much overhead to do this calculation - it can be done with <code>[B5]=[Fact(B2)]</code> or <code>Sheet1.[B5]=[Fact(Sheet1!B3)]</code>, if necessary."}], "tags": [], "owner": {"reputation": 5324, "user_id": 8759927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B8ktI.jpg?s=128&g=1", "display_name": "shrivallabha.redij", "link": "https://stackoverflow.com/users/8759927/shrivallabha-redij"}, "is_accepted": false, "score": 1, "last_activity_date": 1528290597, "creation_date": 1528290597, "answer_id": 50721286, "question_id": 50720924, "link": "https://stackoverflow.com/questions/50720924/vba-using-for-next-calculate-123-n/50721286#50721286", "title": "VBA Using for...next calculate 1*2*3...*n", "body": "<p>You can use @SJR suggestion in VBA if you don't want to use formula in cell B5:</p>\n\n<p><code>=FACT(B3)</code></p>\n\n<p>Code will be:</p>\n\n<pre><code>Sub Try_Click()\nWith ThisWorkbook.Sheets(\"Sheet 1\").Cells(5, 2)\n    .FormulaR1C1 = \"=FACT(R[-2]C)\"\n    .Value = .Value\nEnd With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9903383, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jessie", "link": "https://stackoverflow.com/users/9903383/jessie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 50721136, "answer_count": 5, "score": 1, "last_activity_date": 1528292283, "creation_date": 1528289544, "question_id": 50720924, "link": "https://stackoverflow.com/questions/50720924/vba-using-for-next-calculate-123-n", "title": "VBA Using for...next calculate 1*2*3...*n", "body": "<p>I'm a beginner of VBA. My problem as title and I really don't know how to correct the code.Below is what I try but I think it's all wrong... Thanks in advance.</p>\n\n<pre><code>Sub Try_Click()\n\nDim i As Integer\nDim n As Integer\n\nn = ThisWorkbook.Sheets(\"Sheet 1\").Cells(3, 2).Value\n\nFor i = 1 To n\ni = i * (i + 1)\n\nNext i\n\nThisWorkbook.Sheets(\"Sheet 1\").Cells(5, 2) = i\n\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "outlook"], "comments": [{"owner": {"reputation": 11957, "user_id": 973283, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7647caae40a358f96e6c8e6a2bf29aa4?s=128&d=identicon&r=PG", "display_name": "Tony Dallimore", "link": "https://stackoverflow.com/users/973283/tony-dallimore"}, "edited": false, "score": 0, "creation_date": 1528314550, "post_id": 50720921, "comment_id": 88464849, "body": "My understanding is that these options are recorded in the Registry.  If there is VBA access to the Registry, I have never discovered it.  The tricks in the answers to this question might help: <a href=\"https://stackoverflow.com/q/247546/973283\">Outlook autocleaning my line breaks and screwing up my email format</a>"}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 9906608, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-L_OhVdLFc3k/AAAAAAAAAAI/AAAAAAAAABc/OHSFrrK8GvI/photo.jpg?sz=128", "display_name": "Chris Bosse AC1EO", "link": "https://stackoverflow.com/users/9906608/chris-bosse-ac1eo"}, "is_accepted": true, "score": 2, "last_activity_date": 1528379567, "last_edit_date": 1528379567, "creation_date": 1528345895, "answer_id": 50732996, "question_id": 50720921, "link": "https://stackoverflow.com/questions/50720921/vba-outlook-how-to-uncheck-remove-extra-line-breaks-in-plain-text/50732996#50732996", "title": "VBA Outlook how to uncheck Remove Extra Line Breaks in Plain Text", "body": "<p><a href=\"https://stackoverflow.com/questions/50720921/vba-outlook-how-to-uncheck-remove-extra-line-breaks-in-plain-text#comment88464849_50720921\">Tony Dallimore</a> is right.</p>\n\n<p><a href=\"https://stackoverflow.com/a/38209178/9906608\">Outlook reads registry changes on start.</a> So changes won't be immediate.  Example code with helper functions below.</p>\n\n<p>Outlook stores Options like <strong>Remove extra line breaks in plain text messages</strong> in the Windows Registry.  (For Outlook 2016 on my machine the key is (note the version <code>16.0</code>):</p>\n\n<pre><code>HKCU\\Software\\Microsoft\\Office\\16.0\\Outlook\\Options\\Mail\\AutoFormatPlainText\n</code></pre>\n\n<p>VBA reads and writes to a limited area of the Windows Registry, <code>HKEY_CURRENT_USER\\Software\\VB and VBA Program Settings\\</code>.  You can use the <strong>Windows Script Host Object Model</strong> library to <a href=\"https://vba-corner.livejournal.com/3054.html\" rel=\"nofollow noreferrer\">read and edit the registry</a>.</p>\n\n<p>VBA side note: <a href=\"http://www.vbaexpress.com/forum/showthread.php?16704-VBA-Write-to-the-registry&amp;p=127030&amp;viewfull=1#post127030\" rel=\"nofollow noreferrer\">Early binding</a> and adding the references for  <strong>Windows Script Host Object Model</strong> helps with code prompting.  (Visual Basic > Tools > References...)</p>\n\n<pre><code>Option Explicit\n\nFunction isRemoveExtraLineBreaksChecked() As Boolean\n    ' Outlook &gt;\n    '  File &gt; Options &gt;\n    '   Mail &gt; Message format &gt;\n    '    Remove extra line breaks in plain text messages\n    ' Tested on Outlook 2016 Professional Plus running on Windows 7 Professional\n    Dim wsh As New WshShell\n    Dim appVer As String\n    Dim key As String\n    Dim val As Integer\n\n    appVer = partialVersionNumberAsString(Application.version)\n    key = \"HKCU\\Software\\Microsoft\\Office\\\" + appVer + \"\\Outlook\\Options\\Mail\\AutoFormatPlainText\"\n    val = wsh.RegRead(key)\n\n    'Tidy Up\n    Set wsh = Nothing\n\n    isRemoveExtraLineBreaksChecked = val = 1\nEnd Function\n\nSub setRemoveExtraLineBreaksCheck(ByVal checked As Boolean)\n    ' Outlook &gt;\n    '  File &gt; Options &gt;\n    '   Mail &gt; Message format &gt;\n    '    Remove extra line breaks in plain text messages\n    ' Tested on Outlook 2016 Professional Plus running on Windows 7 Professional\n    '\n    ' Must restart Outlook so it can read new Registry value\n    Dim wsh As New WshShell\n    Dim appVer As String\n    Dim key As String\n    Dim val As Integer\n\n    If checked Then\n        val = 1\n    Else\n        val = 0\n    End If\n\n    appVer = partialVersionNumberAsString(Application.version)\n    key = \"HKCU\\Software\\Microsoft\\Office\\\" + appVer + \"\\Outlook\\Options\\Mail\\AutoFormatPlainText\"\n    wsh.RegWrite key, val, \"REG_DWORD\"\n\n    'Tidy Up\n    Set wsh = Nothing\nEnd Sub\n\nFunction partialVersionNumberAsString(ByVal version As String, _\n    Optional ByVal numberOfGroups As Integer = 2, _\n    Optional ByVal inputSeparator As String = \".\", _\n    Optional ByVal outputSeparator As String = \".\" _\n) As String\n    ' Given a version number like 16.0.0.9226\n    '  Return 16.0\n    Debug.Assert numberOfGroups &gt;= 0\n    Debug.Assert Len(inputSeparator) = 1\n    Debug.Assert Len(outputSeparator) = 1\n\n    Dim versionExpanded() As String\n    Dim versionToOutput() As String\n\n    versionExpanded = Split(Application.version, inputSeparator)\n\n    Dim actualNumberOfGroups As Integer\n    Dim maxGroups As Integer\n    actualNumberOfGroups = arrayLen(versionExpanded)\n    If actualNumberOfGroups &lt; numberOfGroups Then\n        maxGroups = actualNumberOfGroups - 1\n    Else\n        maxGroups = numberOfGroups - 1\n    End If\n\n    ReDim versionToOutput(maxGroups)\n    Dim i As Integer\n    For i = 0 To maxGroups\n        versionToOutput(i) = versionExpanded(i)\n    Next i\n\n    partialVersionNumberAsString = Join(versionToOutput, outputSeparator)\nEnd Function\n\nFunction arrayLen(anyArray As Variant) As Integer\n    arrayLen = UBound(anyArray) - LBound(anyArray) + 1\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 2313079, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8a07ca0241d50327242eec03be916f92?s=128&d=identicon&r=PG", "display_name": "Lance", "link": "https://stackoverflow.com/users/2313079/lance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 457, "favorite_count": 0, "accepted_answer_id": 50732996, "answer_count": 1, "score": 2, "last_activity_date": 1592986408, "creation_date": 1528289539, "last_edit_date": 1592986408, "question_id": 50720921, "link": "https://stackoverflow.com/questions/50720921/vba-outlook-how-to-uncheck-remove-extra-line-breaks-in-plain-text", "title": "VBA Outlook how to uncheck Remove Extra Line Breaks in Plain Text", "body": "<p>I am not really a VBA developer, that said I am trying to fix a few issues with an Outlook 2013 macro. The last issue I am having is with regards to the default \"We removed extra line breaks from this message.\" I figured out where to uncheck this option in the options>mail>message format but I cannot find anything on how to do this programmatically. </p>\n\n<p>Is it possible?</p>\n\n<p><a href=\"https://i.stack.imgur.com/kv9g5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/kv9g5.png\" alt=\"line breaks\"></a></p>\n"}, {"tags": ["excel", "vba", "outlook", "dialog", "runtime-error"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4269416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932b64140f8122108a3c347cc9c62f57?s=128&d=identicon&r=PG&f=1", "display_name": "stevica", "link": "https://stackoverflow.com/users/4269416/stevica"}, "edited": false, "score": 0, "creation_date": 1528290968, "post_id": 50720938, "comment_id": 88451118, "body": "After calling this sub I get a Run-time err &#39;438&#39; - object doesn&#39;t support this property or method"}, {"owner": {"reputation": 21, "user_id": 4269416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932b64140f8122108a3c347cc9c62f57?s=128&d=identicon&r=PG&f=1", "display_name": "stevica", "link": "https://stackoverflow.com/users/4269416/stevica"}, "edited": false, "score": 0, "creation_date": 1528297654, "post_id": 50720938, "comment_id": 88455780, "body": "thanks, it solved the problem of the color picker not appearing. Apparently you have to add the workbook so it works. On the other hand, the color picker appears in background and when I select a color, he brings up the workbook in front which I don&#39;t want, as I&#39;m working with Outlook and need Excel only for the color picker."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 21, "user_id": 4269416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932b64140f8122108a3c347cc9c62f57?s=128&d=identicon&r=PG&f=1", "display_name": "stevica", "link": "https://stackoverflow.com/users/4269416/stevica"}, "edited": false, "score": 0, "creation_date": 1528297805, "post_id": 50720938, "comment_id": 88455880, "body": "@stevica - you can probably try with <code>xlApp.Visible = False</code> (although Idk whether the color picker would be shown in that case, cannot try it now)"}, {"owner": {"reputation": 21, "user_id": 4269416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932b64140f8122108a3c347cc9c62f57?s=128&d=identicon&r=PG&f=1", "display_name": "stevica", "link": "https://stackoverflow.com/users/4269416/stevica"}, "edited": false, "score": 0, "creation_date": 1528298135, "post_id": 50720938, "comment_id": 88456109, "body": "May I ask why do I need to add a Workbook in order to be able to use this dialog, since the dialog is a member of Application class and not of Workbook? Sorry if it&#39;s a dumb question but I&#39;m a novice..."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 21, "user_id": 4269416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932b64140f8122108a3c347cc9c62f57?s=128&d=identicon&r=PG&f=1", "display_name": "stevica", "link": "https://stackoverflow.com/users/4269416/stevica"}, "edited": false, "score": 0, "creation_date": 1528298521, "post_id": 50720938, "comment_id": 88456383, "body": "@stevica - I am using the workbook only to write to its range whatever is selected - <code>someWb.Worksheets(1).Range(&quot;A1&quot;).Interior.Color</code>"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 0, "last_activity_date": 1528292296, "last_edit_date": 1528292296, "creation_date": 1528289589, "answer_id": 50720938, "question_id": 50720876, "link": "https://stackoverflow.com/questions/50720876/outlook-vba-calling-an-excel-dialog-show-fails/50720938#50720938", "title": "outlook vba calling an Excel dialog.show fails", "body": "<p>Some minimal code, that would work out, following the idea with public <code>xlApp</code> variable:</p>\n\n<pre><code>Option Explicit\n\nPrivate xlApp As Excel.Application\n\nSub TestMe()\n\n    Set xlApp = CreateObject(\"Excel.Application\")\n\n    Dim someWb As Workbook\n    Set someWb = xlApp.Workbooks.Add\n    xlApp.Visible = True\n\n    If xlApp.Dialogs(xlDialogEditColor).Show(56) Then\n        someWb.Worksheets(1).Range(\"A1\").Interior.Color = ActiveWorkbook.Colors(56)\n    End If\n\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>These are the parameters of <code>xlDialogEditColor</code> - color_num, red_value, green_value, blue_value </p>\n\n<ul>\n<li><a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/built-in-dialog-box-argument-lists\" rel=\"nofollow noreferrer\">MSDN Built-In Dialog Box Argument Lists</a></li>\n</ul>\n"}], "owner": {"reputation": 21, "user_id": 4269416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/932b64140f8122108a3c347cc9c62f57?s=128&d=identicon&r=PG&f=1", "display_name": "stevica", "link": "https://stackoverflow.com/users/4269416/stevica"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 50720938, "answer_count": 1, "score": 1, "last_activity_date": 1592986445, "creation_date": 1528289417, "last_edit_date": 1592986445, "question_id": 50720876, "link": "https://stackoverflow.com/questions/50720876/outlook-vba-calling-an-excel-dialog-show-fails", "title": "outlook vba calling an Excel dialog.show fails", "body": "<p>I have an Outlook macro that's failing with a run-time error 1004 \"show method of dialog class failed\" on line:</p>\n\n<pre><code>xlApp.Dialogs(xlDialogColorPalette).Show\n</code></pre>\n\n<p>The relevant parts of code (or so I think) are:</p>\n\n<pre><code>Private WithEvents oExpl As Explorer\nPrivate WithEvents oItem As MailItem\nPrivate WithEvents respItem As MailItem\nPrivate xlApp As Excel.Application\n\nPrivate bDiscardEvents As Boolean\n\n\nPrivate Sub Application_Startup()\n\n   Set xlApp = CreateObject(\"Excel.Application\")    \n\n   Set oExpl = Application.ActiveExplorer\n   bDiscardEvents = False\n\nEnd Sub\n</code></pre>\n\n<p></p>\n\n<pre><code>Private Sub respItem_Send(cancel As Boolean)    \n\n   bDiscardEvents = True\n\n    Dim orgbody As String       \n    orgbody = respItem.HTMLBody\n\n\n    xlApp.Dialogs(xlDialogColorPalette).Show       \n</code></pre>\n\n<p>Thanks a many!</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528292659, "post_id": 50720869, "comment_id": 88452398, "body": "Why not have your data as a table or pivottable and just filter?"}, {"owner": {"reputation": 467, "user_id": 9490000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a996f5c51b98710f55f20aaf72f376b?s=128&d=identicon&r=PG&f=1", "display_name": "DirtyDeffy", "link": "https://stackoverflow.com/users/9490000/dirtydeffy"}, "edited": false, "score": 0, "creation_date": 1528292723, "post_id": 50720869, "comment_id": 88452441, "body": "Sounds like a userform would do the trick"}], "answers": [{"tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": true, "score": 1, "last_activity_date": 1528355067, "creation_date": 1528355067, "answer_id": 50734874, "question_id": 50720869, "link": "https://stackoverflow.com/questions/50720869/how-do-i-go-about-choosing-rows-in-a-spreadsheet-with-user-input-value-in-column/50734874#50734874", "title": "how do I go about choosing rows in a spreadsheet with user input value in column", "body": "<pre><code>SelectCountry = InputBox(\"Type country name\")   'Inputbox to get contry name\n\nIf SelectCountry &lt;&gt; \"\" Then     'filter is user type country name\n    'My data is insert Table named Table1, change it according to your table name\n    ActiveSheet.Range(\"Table1\").AutoFilter Field:=2         'Table must be clear before filter, 2 refer country column no\n    ActiveSheet.Range(\"Table1\").AutoFilter Field:=2, Criteria1:=SelectCountry   'Filter\nEnd If\n</code></pre>\n"}], "owner": {"reputation": 2041, "user_id": 5040775, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/10207130495004756/picture?type=large", "display_name": "Jun Jang", "link": "https://stackoverflow.com/users/5040775/jun-jang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 50734874, "answer_count": 1, "score": -3, "last_activity_date": 1528355067, "creation_date": 1528289391, "last_edit_date": 1528291563, "question_id": 50720869, "link": "https://stackoverflow.com/questions/50720869/how-do-i-go-about-choosing-rows-in-a-spreadsheet-with-user-input-value-in-column", "title": "how do I go about choosing rows in a spreadsheet with user input value in column", "body": "<p>I have a spreadsheet with columns like stock name, country, industry, and stock price. I want to have the user provide the name of the country and VBA selects rows corresponding with that country. The end result should be a range of rows corresponding that country only. How would I achieve this?</p>\n"}, {"tags": ["ms-access", "vba", "recordset"], "comments": [{"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 1, "creation_date": 1528289544, "post_id": 50720702, "comment_id": 88450169, "body": "This is an endless loop since <code>i</code> is never incremented. You need to move to the last record in order to get the recordcount on a DAO recordset."}, {"owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1528289814, "post_id": 50720702, "comment_id": 88450335, "body": "@KostasK. Sorry, I have i incremented in my real code. Just threw this together as a quick example to remove unrelated code and shorten variable names and forgot to add that part. Thank you for pointing it out."}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "edited": false, "score": 0, "creation_date": 1528289195, "post_id": 50720735, "comment_id": 88449964, "body": "Please refer back to my question. I attempted this already and it did not work."}, {"owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "edited": false, "score": 0, "creation_date": 1528289424, "post_id": 50720735, "comment_id": 88450100, "body": "I have tired to put the movefirst/movelast functions after opening the recordset but before calling the .recordcount function, as you have suggested. It still does not work. Even if I move my debug.print statement around, I have a lopp that relies on the result of the recordcount that does not happend becuase the result is still 0 regardless."}, {"owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "edited": false, "score": 0, "creation_date": 1528289511, "post_id": 50720735, "comment_id": 88450152, "body": "Additionally, the loop with the debug.print statement inside is just to try to print out all the values in the recordset. It will still print just the first then throw an error regardless of if I have movefirst/movelast calls as you recommended"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "edited": false, "score": 0, "creation_date": 1528290066, "post_id": 50720735, "comment_id": 88450505, "body": "@jpc  Can you share the code where you tried that? I suspect I know the issue. Also, what about after you retrieve the records?"}, {"owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "edited": false, "score": 0, "creation_date": 1528290622, "post_id": 50720735, "comment_id": 88450861, "body": "I edited the original code to be what I tired with the movefirst/movelast calls. Again though, this unfortunately did not work. I even tried moving those statements to other locations to see if anything worked but to no avail."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "edited": false, "score": 0, "creation_date": 1528290865, "post_id": 50720735, "comment_id": 88451040, "body": "@jpc I edited my solution - make sure you have the one with the <code>RecordCount</code> property...  slight oversight on the earlier draft :)"}, {"owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "edited": false, "score": 0, "creation_date": 1528290970, "post_id": 50720735, "comment_id": 88451121, "body": "Thanks! I tried your solutions with the added edit, and it printed out the first and second record values! Although there are 10, I guess the first two is better than the first one so that is progress, but also makes it a bit more odd..."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": false, "score": 1, "last_activity_date": 1528290745, "last_edit_date": 1528290745, "creation_date": 1528289055, "answer_id": 50720735, "question_id": 50720702, "link": "https://stackoverflow.com/questions/50720702/ms-access-vba-recordcount-returning-0-when-records-exist-and-debug-print-retur/50720735#50720735", "title": "MS Access VBA .recordcount returning 0 when records exist, and debug.print returns value", "body": "<h1>EDIT:</h1>\n\n<p>Try this:</p>\n\n<pre><code>Sub Demo_IterateRecords()\n    Const tblName = \"YOUR TABLE NAME HERE\"\n    Dim rs As Recordset\n\n    Set rs = CurrentDb.OpenRecordset(tblName)\n    With rs\n        .MoveLast\n        .MoveFirst\n\n        If MsgBox(\"Do you want to list all \" &amp; .RecordCount &amp; \" records?\", _\n            vbOKCancel, \"Confirmation\") &lt;&gt; vbOK Then GoTo ExitMySub\n\n        Do While Not .EOF\n            Debug.Print .Fields(0), .Fields(1), .Fields(2)\n            rs.MoveNext\n        Loop\n\nExitMySub:\n        .Close\n    End With\n    Set rs = Nothing\n\nEnd Sub\n</code></pre>\n\n<p>I used <code>.Fields(_)</code> because I'm not sure what your fields are called, but a better way to refer to them would be by name, like: </p>\n\n<pre><code>        Debug.Print !myID, !myEmployeeName, !myEmployeeAddress\n</code></pre>\n\n<hr>\n\n<h2>Original Answer:</h2>\n\n<p>Try this:</p>\n\n<pre><code>RS.MoveLast\nRS.MoveFirst\nrecCount = RS.RecordCount\nDebug.Print(recCount)\n</code></pre>\n\n<p>Access doesn't know how many records there are until you move through them at least once.</p>\n\n<p>If you would have checked the value of <code>RS.RecordCount</code> <em>after</em> your loop, you would have got a number.</p>\n\n<blockquote>\n  <h2>Remarks</h2>\n  \n  <p>Use the <code>Recordcount</code> property to find out how many records in a Recordset or <code>TableDef</code> object have been accessed. The <code>RecordCount</code> property doesn't indicate how many records are contained in a dynaset\u2013, snapshot\u2013, or forward\u2013only\u2013type Recordset object until all records have been accessed. Once the last record has been accessed, the <code>RecordCount</code> property indicates the total number of undeleted records in the Recordset or TableDef object. To force the last record to be accessed, use the MoveLast method on the Recordset object. You can also use an SQL <code>Count</code> function to determine the approximate number of records your query will return.</p>\n  \n  <h1>Important Note</h1>\n  \n  <p>Using the <code>MoveLast</code> method to populate a newly opened Recordset negatively impacts performance. <strong>Unless it is necessary to have an accurate <code>RecordCount</code> as soon as you open a Recordset</strong>, it's better to <strong>wait until you populate the Recordset with other portions of code</strong> before checking the <code>RecordCount</code> property.  </p>\n</blockquote>\n\n<p><sup>(<a href=\"https://msdn.microsoft.com/library/office/ff821452.asp\" rel=\"nofollow noreferrer\">Source</a>)</sup></p>\n\n<hr>\n\n<p>See also: <strong>MSDN : <a href=\"https://msdn.microsoft.com/library/office/ff821452.asp\" rel=\"nofollow noreferrer\">Recordset.RecordCount Property</a></strong></p>\n"}, {"tags": [], "owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "is_accepted": true, "score": 1, "last_activity_date": 1528292240, "creation_date": 1528292240, "answer_id": 50721916, "question_id": 50720702, "link": "https://stackoverflow.com/questions/50720702/ms-access-vba-recordcount-returning-0-when-records-exist-and-debug-print-retur/50721916#50721916", "title": "MS Access VBA .recordcount returning 0 when records exist, and debug.print returns value", "body": "<p>I managed to fix this issue but I have no idea why this worked. Instead of creating a new table and typing in the values for the ten records, I instead used an insert query to put the values I wanted from a query into a table. Using this new table, it worked. </p>\n"}, {"tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": false, "score": 2, "last_activity_date": 1528292569, "creation_date": 1528292569, "answer_id": 50722039, "question_id": 50720702, "link": "https://stackoverflow.com/questions/50720702/ms-access-vba-recordcount-returning-0-when-records-exist-and-debug-print-retur/50722039#50722039", "title": "MS Access VBA .recordcount returning 0 when records exist, and debug.print returns value", "body": "<p>You could list the records while counting:</p>\n\n<pre><code>Set RS = db.OpenRecordset(\"Table Name\")\n\nWhile Not RS.EOF\n    Debug.Print RS![Only Field Name].Value\n    i = i + 1\n    RS.MoveNext\nLoop\n\nDebug.Print i &amp; \" records found.\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 9537607, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-NIIa1GsfYZQ/AAAAAAAAAAI/AAAAAAAAASM/Jm2e6ijjaZc/photo.jpg?sz=128", "display_name": "Rof", "link": "https://stackoverflow.com/users/9537607/rof"}, "is_accepted": false, "score": 1, "last_activity_date": 1528379193, "last_edit_date": 1528379193, "creation_date": 1528375580, "answer_id": 50741598, "question_id": 50720702, "link": "https://stackoverflow.com/questions/50720702/ms-access-vba-recordcount-returning-0-when-records-exist-and-debug-print-retur/50741598#50741598", "title": "MS Access VBA .recordcount returning 0 when records exist, and debug.print returns value", "body": "<p>Perhaps you could try something similar to this in your sub routine:</p>\n\n<pre><code>Dim db As DAO.Database\nDim RS As DAO.Recordset\nDim recCount As Integer\nSet db = CurrentDb\nSet RS = db.OpenRecordset(\"Table Name\")\nIf Not (RS.EOF And RS.BOF) Then\nRS.MoveFirst\nDo Until RS.EOF = True\nRS.MoveNext\nLoop\nMsgBox (\"There are:\" &amp; \" \" &amp; RS.RecordCount &amp; \" \" &amp; \"records in the database\")\nEnd If\nRS.Close\nSet RS = Nothing\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 9822933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbf07952826b03c3fe3e31371a97ce70?s=128&d=identicon&r=PG&f=1", "display_name": "jpc", "link": "https://stackoverflow.com/users/9822933/jpc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2050, "favorite_count": 0, "accepted_answer_id": 50721916, "answer_count": 4, "score": 0, "last_activity_date": 1528379193, "creation_date": 1528288946, "last_edit_date": 1528290500, "question_id": 50720702, "link": "https://stackoverflow.com/questions/50720702/ms-access-vba-recordcount-returning-0-when-records-exist-and-debug-print-retur", "title": "MS Access VBA .recordcount returning 0 when records exist, and debug.print returns value", "body": "<p>I have an Access table with 10 records and one field of short text. I am using the .recordcount function to return the number of records in this table. Code below:</p>\n\n<pre><code>Dim db as DAO.Database\nDim RS as DAO.Recordset\nDim recCount as Integer\nSet db = CurrentDb\nSet RS = db.OpenRecordset(\"Table Name\")\n\nRS.MoveFirst\nRS.MoveLast\nrecCount = RS.recordcount\n\nDebug.Print(recCount)\n\nDim i as Integer\ni = 0\nRS.MoveFirst\n'Option one. Commented out when option two is active and vice verse\nDo While i &lt; 10\n    Debug.Print(RS(i))\n    i = i + 1\nLoop\n\nDo While i &lt; 10\n    Debug.print(RS![Only Field Name])\n    i = i + 1\n    RS.MoveNext\nLoop\n</code></pre>\n\n<p>recCount always prints out to be 0. Attempting to print out the records in the recordset will return the first value only of the recordset and nothing else. After reading the first record, the program throws the error \"Item not found in collection.\" I'm unsure of what could be causing this error, as I use the exact same method with another table in another VBA module, which works just fine.</p>\n\n<p>I look at solutions to this elsewhere and the only one I could find was to add a <code>RS.moveFirst</code> and <code>RS.moveLast</code> after opening, however this does not work. I think this is becuase the opened recordset does not actually contain all the records in the table.</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 2, "creation_date": 1528288868, "post_id": 50720643, "comment_id": 88449770, "body": "<a href=\"https://stackoverflow.com/questions/3576211/string-similarity-algorithms\" title=\"string similarity algorithms\">stackoverflow.com/questions/3576211/&hellip;</a>"}, {"owner": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 1, "creation_date": 1528289284, "post_id": 50720643, "comment_id": 88450017, "body": "Unclear..... do you want <b>all</b> matching sub-strings or only <b>one</b> ??"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1528289780, "post_id": 50720643, "comment_id": 88450300, "body": "What do you mean <i>identifies the portion they have in common</i>? Do you mean the pattern column are the answers returned by the function?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528290075, "post_id": 50720643, "comment_id": 88450510, "body": "The attempt at the table was not bad. There are tools to help you like <a href=\"https://www.tablesgenerator.com/markdown_tables\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "edited": false, "score": 0, "creation_date": 1528293084, "post_id": 50720643, "comment_id": 88452668, "body": "Do you want the longest string common between at least two URLs, or do you want the string (of length at least 3) that can be found in the most URLs, or do you want a balance between the two (e.g., determined by some formula, like the product of the string length and number of occurrences)?"}, {"owner": {"reputation": 91, "user_id": 1563345, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d932eb46ea3339346553bc1d2852c4b6?s=128&d=identicon&r=PG&f=1", "display_name": "pedroteixeira07", "link": "https://stackoverflow.com/users/1563345/pedroteixeira07"}, "reply_to_user": {"reputation": 91725, "user_id": 2474656, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/pYqJv.jpg?s=128&g=1", "display_name": "Gary&#39;s Student", "link": "https://stackoverflow.com/users/2474656/garys-student"}, "edited": false, "score": 0, "creation_date": 1528324277, "post_id": 50720643, "comment_id": 88468690, "body": "@Gary&#39;sStudent apologies, I want at least one matching sub-string."}, {"owner": {"reputation": 91, "user_id": 1563345, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d932eb46ea3339346553bc1d2852c4b6?s=128&d=identicon&r=PG&f=1", "display_name": "pedroteixeira07", "link": "https://stackoverflow.com/users/1563345/pedroteixeira07"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1528324326, "post_id": 50720643, "comment_id": 88468704, "body": "@Brian yes, the pattern is the answer returned by the function, in better words as Gary notes: the matching sub-substring."}, {"owner": {"reputation": 91, "user_id": 1563345, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d932eb46ea3339346553bc1d2852c4b6?s=128&d=identicon&r=PG&f=1", "display_name": "pedroteixeira07", "link": "https://stackoverflow.com/users/1563345/pedroteixeira07"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528324346, "post_id": 50720643, "comment_id": 88468710, "body": "@QHarr many thanks for the tip - precious ;)"}, {"owner": {"reputation": 91, "user_id": 1563345, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d932eb46ea3339346553bc1d2852c4b6?s=128&d=identicon&r=PG&f=1", "display_name": "pedroteixeira07", "link": "https://stackoverflow.com/users/1563345/pedroteixeira07"}, "reply_to_user": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "edited": false, "score": 0, "creation_date": 1528324432, "post_id": 50720643, "comment_id": 88468736, "body": "@jblood94 the second,  the string (of length at least 3) that can be found in the most URLs."}, {"owner": {"reputation": 91, "user_id": 1563345, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d932eb46ea3339346553bc1d2852c4b6?s=128&d=identicon&r=PG&f=1", "display_name": "pedroteixeira07", "link": "https://stackoverflow.com/users/1563345/pedroteixeira07"}, "reply_to_user": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "edited": false, "score": 0, "creation_date": 1528324789, "post_id": 50720643, "comment_id": 88468848, "body": "Apologies guys, I knew it wouldn&#39;t be straightforward to explain my goal but now just realized it&#39;s really challenging.  I think @jblood94 interpretation is the closest: The sub-string (at least 3 characters) that can be found in most URLs. The goal ultimatly is to find sub-string patterns between several URLs but bearing in mind there might be expections when there&#39;s no similarity, therefore  &quot;most&quot; URLs. Hope this clears a bit a further."}, {"owner": {"reputation": 91, "user_id": 1563345, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d932eb46ea3339346553bc1d2852c4b6?s=128&d=identicon&r=PG&f=1", "display_name": "pedroteixeira07", "link": "https://stackoverflow.com/users/1563345/pedroteixeira07"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1528324892, "post_id": 50720643, "comment_id": 88468882, "body": "@Vityata thanks for sharing! I had a look and it&#39;s not exactly what I need. Rather than &quot;similarity&quot; I want exact character matches."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 1563345, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d932eb46ea3339346553bc1d2852c4b6?s=128&d=identicon&r=PG&f=1", "display_name": "pedroteixeira07", "link": "https://stackoverflow.com/users/1563345/pedroteixeira07"}, "edited": false, "score": 0, "creation_date": 1528324561, "post_id": 50721662, "comment_id": 88468773, "body": "what I&#39;d be looking to get from your example would be &quot;test&quot;"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528465940, "post_id": 50721662, "comment_id": 88531909, "body": "Hey there - sorry to ping you here.. I noticed you <a href=\"https://stackoverflow.com/review/suggested-edits/19968206\">suggested an edit</a> to add &quot;thank you&quot; and &quot;please help&quot; and add an incorrect tag while removing a perfectly appropriate one - please note the <a href=\"https://stackoverflow.com/questions/tagged/macros\">macros</a> tag has nothing to do with <a href=\"https://stackoverflow.com/questions/tagged/excel-vba\">excel-vba</a> or <a href=\"https://stackoverflow.com/questions/tagged/vba\">vba</a>. Please avoid tagging VBA questions with <a href=\"https://stackoverflow.com/questions/tagged/macros\">macros</a> (see tag info). Also &quot;thank you&quot; and &quot;please help&quot; is typically noise that gets weeded out, not added in. ...thank you!"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528466389, "post_id": 50721662, "comment_id": 88532206, "body": "@MathieuGuindon On this question or a different one? The &quot;thank you&quot; was added because there were too few edits to save (just formatting with few character strokes). I don&#39;t remember changing tags (I normally don&#39;t). I have only edited twice, I think, over the past two days and someone edited before me. Maybe the tag was part of their edit?"}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528466600, "post_id": 50721662, "comment_id": 88532335, "body": "IDK, I rejected the edit specifically because the [excel-vba] tag was being removed and the incorrect [macros] tag was being added - just wanted to make sure you weren&#39;t going on an edit spree to sprinkle [macros] across the [vba] tag... spent quite a lot of time getting rid of that misplaced tag a few years ago."}, {"owner": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528466950, "post_id": 50721662, "comment_id": 88532576, "body": "BTW I see you&#39;re writing some C#, with a VBA background... if you&#39;re ever interested in contributing to <a href=\"http://www.github.com/rubberduck-vba/Rubberduck\" rel=\"nofollow noreferrer\">Rubberduck</a>, don&#39;t hesitate to meet the devs in <a href=\"https://chat.stackexchange.com/rooms/14929/vba-rubberducking\">SE chat</a>! Cheers! =)"}, {"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "reply_to_user": {"reputation": 64429, "user_id": 1188513, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/wNdZG.jpg?s=128&g=1", "display_name": "Mathieu Guindon", "link": "https://stackoverflow.com/users/1188513/mathieu-guindon"}, "edited": false, "score": 0, "creation_date": 1528468215, "post_id": 50721662, "comment_id": 88533303, "body": "@MathieuGuindon Thank you Mathieu! I&#39;m somewhat familiar with Rubberduck for VBA IDE. I&#39;ll keep that in mind."}], "tags": [], "owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "is_accepted": false, "score": 1, "last_activity_date": 1528392203, "last_edit_date": 1528392203, "creation_date": 1528291507, "answer_id": 50721662, "question_id": 50720643, "link": "https://stackoverflow.com/questions/50720643/finding-patterns-identify-the-string-portion-that-is-common-to-a-group-of-cells/50721662#50721662", "title": "Finding Patterns: Identify the string portion that is common to a group of cells", "body": "<p>This doesn't fully answer the question but I think it will give you what you need to get it. Give it a try. Place the following code in a new moudule:</p>\n\n<pre><code>Public Sub FindStrings()\n    Dim rng1 As Excel.Range\n    Dim rng2 As Excel.Range\n\n    Set rng1 = ActiveSheet.Range(\"A1\")\n    Set rng2 = ActiveSheet.Range(\"A2\")\n\n    Dim i As Integer\n    Dim j As Integer\n    Dim searchVal As String\n    For i = 3 To Len(rng2)\n        For j = 1 To Len(rng1)\n            searchVal = Mid(rng1, j, i)\n            If Len(searchVal) &lt; i Then Exit For\n            If InStr(1, rng2, searchVal) Then Debug.Print searchVal\n        Next j\n    Next i\nEnd Sub\n</code></pre>\n\n<p>In cell <code>A1</code> put <em>example.net/test</em><br>\nIn cell <code>A2</code> put <em>www.test.com</em></p>\n\n<p><strong>Result</strong></p>\n\n<pre><code>tes\nest\ntest\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>I updated the code to search for a minimum of 4 characters instead of 3 (as you mentioned above). Furthermore, I guessed you wouldn't want strings such as <code>www.</code> and <code>.com</code> returned, nor strings with the <code>/</code> or <code>.</code> character. So the code pulls those out as well. Also, it compares every column combination.</p>\n\n<pre><code>Option Explicit\nPublic Sub CompareStrings()\n    Dim Arr As Variant\n    Dim i As Integer\n    Dim j As Integer\n    Dim StartRange As Excel.Range\n    Dim SearchRange As Excel.Range\n    Dim Counter As Integer\n    Dim ComparableRange As Variant\n    Dim Comparable As Integer\n    Dim Compared As Integer\n    Dim SearchVal As String\n\n    Set StartRange = ActiveSheet.Range(\"A1\")\n\n    Counter = 0\n    For Each ComparableRange In ActiveSheet.Range(\"A1:A2\")\n    Set SearchRange = Range(StartRange.Offset(Counter), Cells(StartRange.Offset(Counter).Row, Columns.Count).End(xlToLeft))\n    Arr = Application.Transpose(Application.Transpose(SearchRange.Value))\n    Debug.Print \"Row \" &amp; SearchRange.Row &amp; \":\"\n        For j = LBound(Arr) To UBound(Arr)\n            For i = j + 1 To UBound(Arr)\n                For Comparable = 4 To Len(Arr(j))\n                    For Compared = 1 To Len(Arr(i))\n                        SearchVal = Mid(Arr(j), Compared, Comparable)\n                        If InStr(1, SearchVal, \".\") = 0 Then\n                            If InStr(1, SearchVal, \"/\") = 0 Then\n                                If Len(SearchVal) &lt; Comparable Then Exit For\n                                If InStr(1, Arr(i), SearchVal) &gt; 0 Then Debug.Print vbTab &amp; SearchVal\n                            End If\n                        End If\n                    Next Compared\n                Next Comparable\n            Next i\n        Next j\n        Counter = Counter + 1\n    Next ComparableRange    \nEnd Sub\n</code></pre>\n\n<p>When comparing <code>test.com/q=age</code> with <code>another.com?q=age</code> You will still get results such as:</p>\n\n<pre><code>q=ag\n=age \nq=age \n</code></pre>\n\n<p>...though I suspect you only want the third one. The longer the matching strings are the more results you will get. The last results are the ones you will probably want. </p>\n"}, {"tags": [], "owner": {"reputation": 1742, "user_id": 9463489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "jblood94", "link": "https://stackoverflow.com/users/9463489/jblood94"}, "is_accepted": false, "score": 1, "last_activity_date": 1528394058, "last_edit_date": 1528394058, "creation_date": 1528384161, "answer_id": 50744647, "question_id": 50720643, "link": "https://stackoverflow.com/questions/50720643/finding-patterns-identify-the-string-portion-that-is-common-to-a-group-of-cells/50744647#50744647", "title": "Finding Patterns: Identify the string portion that is common to a group of cells", "body": "<p>Copy the following code into a module. Read the comments at the top of <code>CommonString</code> for usage.</p>\n\n<pre><code>Option Explicit\n\nPublic Function CommonString(rng As Range, iMinLen As Integer, Optional strDelimiter As String = \",\") As String\n    'Finds the maximum number of cells (iMax) in \"rng\" that have a common substring of length at least \"iMinLen\".\n    'The function returns a string with the format \"iMax: substring1,substring2,substring3...\"\n    ' where substring1, substring2, etc. are unique substrings found in exactly iMax cells.\n    'The output does not include any substrings of the unique substrings.\n    'The delimter between substrings can be specified by the optional parameter \"strDelimiter\".\n    'If no common substrings of length at least \"iMinLen\" are found, \"CommonString\" will return an empty string.\n    Dim blnRemove() As Boolean\n    Dim dicSubStrings As Object 'records the number of times substrings are found in pairwise string comparisons\n    Dim iCandidates As Integer\n    Dim iCol As Integer\n    Dim iCurrCommon As Integer\n    Dim iCurrLen As Integer\n    Dim iMax As Integer\n    Dim iMaxCommon As Integer\n    Dim iNumStrings As Integer\n    Dim iOutCount As Integer\n    Dim iRow As Integer\n    Dim iString1 As Integer\n    Dim iString2 As Integer\n    Dim iSubStr1 As Integer\n    Dim iSubStr2 As Integer\n    Dim lngSumLen As Long\n    Dim str1D() As String\n    Dim strCandidates() As String\n    Dim strOut() As String\n    Dim strSim() As String\n    Dim strSub As String\n    Dim vKey As Variant\n    Dim vStringsIn() As Variant\n\n    Set dicSubStrings = CreateObject(\"Scripting.Dictionary\")\n    vStringsIn = rng.Value\n    iNumStrings = Application.CountA(rng)\n    ReDim str1D(1 To iNumStrings)\n    ' pull the strings into a 1-D array\n    For iRow = 1 To UBound(vStringsIn, 1)\n        For iCol = 1 To UBound(vStringsIn, 2)\n            iCurrLen = Len(vStringsIn(iRow, iCol))\n\n            If iCurrLen &gt; 0 Then\n                iString1 = iString1 + 1\n                str1D(iString1) = vStringsIn(iRow, iCol)\n                lngSumLen = lngSumLen + iCurrLen\n            End If\n        Next iCol\n    Next iRow\n    'initialize the array that will hold the substrings to output\n    ReDim strOut(1 To lngSumLen - iNumStrings * (iMinLen - 1))\n    'find common substrings from all pairwise combination of strings\n    For iString1 = 1 To iNumStrings - 1\n        For iString2 = iString1 + 1 To iNumStrings\n            strSim = Sim2Strings(str1D(iString1), str1D(iString2), iMinLen)\n            'loop through all common substrings\n            For iSubStr1 = 1 To UBound(strSim)\n                If dicSubStrings.Exists(strSim(iSubStr1)) Then\n                    iCurrCommon = dicSubStrings(strSim(iSubStr1)) + 1\n                    dicSubStrings(strSim(iSubStr1)) = iCurrCommon\n                    If iCurrCommon &gt; iMaxCommon Then iMaxCommon = iCurrCommon\n                Else    'add common substrings to the \"dicSubStrings\" dictionary\n                    dicSubStrings.Add strSim(iSubStr1), 1\n                    If iMaxCommon = 0 Then iMaxCommon = 1\n                End If\n            Next iSubStr1\n        Next iString2\n    Next iString1\n\n    If dicSubStrings.Count = 0 Then Exit Function\n    ReDim strCandidates(1 To dicSubStrings.Count)\n    'add the candidate substrings to the \"strCandidates\" array\n    'candidate substrings are those found in exactly \"iMaxCommon\" pairwise comparisons\n    For Each vKey In dicSubStrings.keys\n        If dicSubStrings(vKey) = iMaxCommon Then\n            iCandidates = iCandidates + 1\n            strCandidates(iCandidates) = CStr(vKey)\n        End If\n    Next vKey\n\n    ReDim blnRemove(1 To iCandidates)\n    iOutCount = iCandidates\n    'keep only the candidate substrings that are not a substring within another candidate substring\n    For iSubStr1 = 1 To iCandidates - 1\n        If Not blnRemove(iSubStr1) Then\n            For iSubStr2 = 1 To iCandidates - 1\n                If Not blnRemove(iSubStr2) Then\n                    If Len(strCandidates(iSubStr1)) &lt;&gt; Len(strCandidates(iSubStr2)) Then\n                        If Len(strCandidates(iSubStr1)) &gt; Len(strCandidates(iSubStr2)) Then\n                            If InStr(strCandidates(iSubStr1), strCandidates(iSubStr2)) &gt; 0 Then\n                                blnRemove(iSubStr2) = True\n                                iOutCount = iOutCount - 1\n                            End If\n                        Else\n                            If InStr(strCandidates(iSubStr2), strCandidates(iSubStr1)) &gt; 0 Then\n                                blnRemove(iSubStr1) = True\n                                iOutCount = iOutCount - 1\n                            End If\n                        End If\n                    End If\n                End If\n            Next iSubStr2\n        End If\n    Next iSubStr1\n\n    ReDim strOut(1 To iOutCount)\n    iOutCount = 0\n    'add the successful candidates to \"strOut\"\n    For iSubStr1 = 1 To iCandidates\n        If Not blnRemove(iSubStr1) Then\n            iOutCount = iOutCount + 1\n            strOut(iOutCount) = strCandidates(iSubStr1)\n        End If\n    Next iSubStr1\n    'convert \"iMaxCommon\" (pairwise counts) to number of cells (iMax) by solving the formula:\n    '(iMax ^ 2 - iMax) / 2 = iMaxCommon\n    iMax = ((8 * iMaxCommon + 1) ^ 0.5 + 1) / 2\n    CommonString = iMax &amp; \": \" &amp; Join(strOut, strDelimiter)\nEnd Function\n\nPrivate Function Sim2Strings(str1 As String, str2 As String, iMinLen As Integer) As String()\n    'Returns a list of unique substrings common to both \"str1\" and \"str2\" that\n    ' have a length of at least \"iMinLen\".\n    Dim dicInList As Object\n    Dim iCharFrom As Integer\n    Dim iLen1 As Integer\n    Dim iSearchLen As Integer\n    Dim iSubStr As Integer\n    Dim strCurr As String\n    Dim strList() As String\n    Dim vKey As Variant\n\n    iLen1 = Len(str1)\n    Set dicInList = CreateObject(\"Scripting.Dictionary\")\n    'add common substrings to the \"dicInList\" dictionary\n    For iCharFrom = 1 To iLen1 - iMinLen + 1\n        For iSearchLen = iMinLen To iLen1 - iCharFrom + 1\n            strCurr = Mid(str1, iCharFrom, iSearchLen)\n\n            If InStr(str2, strCurr) = 0 Then\n                Exit For\n            Else\n                If Not dicInList.Exists(strCurr) Then\n                    dicInList.Add strCurr, 0\n                End If\n            End If\n        Next iSearchLen\n    Next iCharFrom\n\n    If dicInList.Count = 0 Then\n        ReDim strList(0)\n    Else\n        ReDim Preserve strList(1 To dicInList.Count)\n        'output the keys in the \"dicInList\" dictionary to the \"strList\" array\n        For Each vKey In dicInList.keys\n            iSubStr = iSubStr + 1\n            strList(iSubStr) = vKey\n        Next vKey\n    End If\n\n    Sim2Strings = strList\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 1563345, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d932eb46ea3339346553bc1d2852c4b6?s=128&d=identicon&r=PG&f=1", "display_name": "pedroteixeira07", "link": "https://stackoverflow.com/users/1563345/pedroteixeira07"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1528394058, "creation_date": 1528288761, "last_edit_date": 1531161705, "question_id": 50720643, "link": "https://stackoverflow.com/questions/50720643/finding-patterns-identify-the-string-portion-that-is-common-to-a-group-of-cells", "title": "Finding Patterns: Identify the string portion that is common to a group of cells", "body": "<p>I don't know how to search for this or how to explain without an example.</p>\n\n<p>I'm looking for an excel function that compares cell strings and identifies the portion they have in common. </p>\n\n<p><strong>Conditions</strong></p>\n\n<ul>\n<li>Compares 2 or more cells.</li>\n<li>The common string is identified as long as 2 cells share it. *(ie: if comparing more than 2, it's enough to have 2 cells with that string. Not all the compared cells need to have it.) * </li>\n<li>The string has at least 3 or more chars to avoid single characters and pairs being flagged. </li>\n</ul>\n\n<p><strong>Example</strong> </p>\n\n<pre>\n----------------------------------------------------------------------\n|  Pattern  | Page URL 1           | Page URL 2     | Page URL 3     |\n----------------------------------------------------------------------\n|    test   | example.net/test/    | www.test.com   | www.notest.com |  \n----------------------------------------------------------------------\n|   q=age   | another.com?q=age    | test.com/q=age | test.com/q=lol |\n----------------------------------------------------------------------\n\n</pre>\n\n<p>Probably obvious by now, but what I'm trying to achieve/analyze is if there are string patterns that are common to large sets of URLs.</p>\n\n<p><em>(forgive my poor attempt trying to draw a table)</em></p>\n"}, {"tags": ["excel", "vba", "lotus-notes"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1528287581, "post_id": 50720192, "comment_id": 88448919, "body": "On which line is the error?"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 0, "creation_date": 1528287783, "post_id": 50720192, "comment_id": 88449059, "body": "If you write <code>MsgBox MailDbName</code> before the line <code>Set Maildb = Session.GetDatabase(&quot;&quot;, MailDbName)</code> what do you get? Does it make sense?"}, {"owner": {"reputation": 4047, "user_id": 3246362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6da9a197d0f0e5f19875d8a97550e58e?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/3246362/sam"}, "edited": false, "score": 1, "creation_date": 1528288069, "post_id": 50720192, "comment_id": 88449233, "body": "I had a similar issue and I found it to be related to how fast I sent the mails. When I put a two second delay (or something - don&#39;t remember) between the calls it did not fail."}, {"owner": {"reputation": 1, "user_id": 6359907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3417dbc9144cb70f518ed9d292aa11?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/6359907/miguel"}, "edited": false, "score": 0, "creation_date": 1528389194, "post_id": 50720192, "comment_id": 88499987, "body": "Thank you both for your time! Everything appears to be fine because I am able to run the code properly and successfully send the email, but my colleague cannot using the same code. It appears to be on the email session at the very beginning.. when I place the mouse pointer over &#39;Set Session = CreateObject (&quot;Notes.NotesSession&quot;)&#39; gives me value &#39;session = nothing&#39;. By the way, we both have our IBM lotus notes opened"}], "owner": {"reputation": 1, "user_id": 6359907, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c3417dbc9144cb70f518ed9d292aa11?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/6359907/miguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 689, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528288147, "creation_date": 1528287376, "question_id": 50720192, "link": "https://stackoverflow.com/questions/50720192/excel-vba-code-system-error-the-server-threw-an-exception", "title": "Excel VBA code: system error (the server threw an exception)", "body": "<p>I am somewhat new to VBA coding.  I have an excel file in which I have a list of users to whom an email is automatically sent requesting their validation through ticking the relevant checkbox. </p>\n\n<p>I have managed to get the below code which is working fine. Lately, however, the code has begun to generate the following error message for no apparent reasons 'System error &amp;H80010105 (-2147417851)': The server threw an exception.</p>\n\n<pre><code>Sub SendEmailUsingCOM()\n\n'This macro will open an email session with Lotus Notes,\n'add text from the sheet \"email\" to the body of the email,\n'give the email a name and place an email adress.\n\n 'Set up the objects requiered for automation into lotus notes\n  Dim Maildb As Object 'The mail database\n  Dim UserName As String 'The current users notes name\n  Dim MailDbName As String 'The current users notes mail database name\n  Dim AttachME As Object 'the attachment richtextfile object\n  Dim vToList     As Variant, vCCList As Variant, vBody As Variant\n  Dim MailDoc As Object 'the mail document itself\n  Dim Session As Object 'The notes session\n  Dim EmbedObj As Object 'The embedded object attachment)\n\n  'Open and locate current lotus Notes user\n   Set Session = CreateObject(\"Notes.NotesSession\")\n\n   UserName = Session.UserName\n   MailDbName = Left$(UserName, 1) &amp; Right$(UserName, (Len(UserName) - InStr(1, UserName, \" \"))) &amp; \".nsf\"\n\n  Set Maildb = Session.GetDatabase(\"\", MailDbName) 'already open for mail\n  If Maildb.IsOpen = True Then\n  Else\n  Maildb.OpenMail\n  End If\n  'Set up the new mail document\n   Set MailDoc = Maildb.CreateDocument\n   vToList = Application.Transpose(Range(\"S1\").Resize(Range(\"S\" &amp; Rows.Count).End(xlUp).Row).Value)\n   vCCList = Application.Transpose(Range(\"B1\").Resize(Range(\"B\" &amp; Rows.Count).End(xlUp).Row).Value)\n   MailDoc.Form = \"Memo\"\n\n   MailDoc.Subject = \"Demande de Validation\"\n   MailDoc.Body = [F1].Value\n   MailDoc.SavemessageOnSend = True\n   MailDoc.PostedDate = Now() 'Gets the mail to appear in the sent items folder\n   On Error GoTo errorhandler1\n   MailDoc.Send 0, vToList\n\n   MsgBox (\"Les validations ont \u00e9t\u00e9 demand\u00e9es\")\n\n   Set MailDoc = Nothing\n   Set Maildb = Nothing\n   Set Session = Nothing\n   Set AttachME = Nothing\n   Set EmbedObj1 = Nothing\n\n   errorhandler1:\n\n   Set MailDoc = Nothing\n   Set Maildb = Nothing\n   Set Session = Nothing\n   Set AttachME = Nothing\n   Set EmbedObj1 = Nothing\n\n  End Sub\n</code></pre>\n\n<p>Many users have different excel spreadsheets with the same script and this error only occurs to one one of them. Also, if any other user tries to send an email (again, ticking any checkbox with the name of the validator in order to send an email to this person), no error message pops up. Could you please help me out with this error? </p>\n\n<p>Many thanks.</p>\n\n<p>Miguel</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1528285753, "post_id": 50719626, "comment_id": 88447662, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12393524/excel-delete-row-if-column-contains-value-from-to-remove-list\">excel delete row if column contains value from to-remove-list</a>"}], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 9019076, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/446e309be0f5d46819de8b9d287935a0?s=128&d=identicon&r=PG&f=1", "display_name": "inadvisableguy", "link": "https://stackoverflow.com/users/9019076/inadvisableguy"}, "edited": false, "score": 0, "creation_date": 1528286476, "post_id": 50719791, "comment_id": 88448167, "body": "&quot;NA&quot; is text not a blank cell"}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 101, "user_id": 9019076, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/446e309be0f5d46819de8b9d287935a0?s=128&d=identicon&r=PG&f=1", "display_name": "inadvisableguy", "link": "https://stackoverflow.com/users/9019076/inadvisableguy"}, "edited": false, "score": 0, "creation_date": 1528286545, "post_id": 50719791, "comment_id": 88448202, "body": "I edited the answer, is it work ? You can adjust the range to find last row (change column letter) and the end of loop (change to &quot;2&quot; for something else)"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1528286867, "post_id": 50719791, "comment_id": 88448419, "body": "Don&#39;t use <code>Integer</code> for row counting! Excel has more rows than <code>Integer</code> can handle. It is recommended <a href=\"https://stackoverflow.com/a/26409520/3219613\">always to use Long instead of Integer</a> in VBA."}, {"owner": {"reputation": 194, "user_id": 5618967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336cb8a0142efdf19bc8c9e394384854?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Dean", "link": "https://stackoverflow.com/users/5618967/sam-dean"}, "edited": false, "score": 0, "creation_date": 1528286917, "post_id": 50719791, "comment_id": 88448457, "body": "I would use &quot;UsedRange&quot; to get the rows. &quot;Sheets(1).UsedRange.Rows&quot;"}, {"owner": {"reputation": 101, "user_id": 9019076, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/446e309be0f5d46819de8b9d287935a0?s=128&d=identicon&r=PG&f=1", "display_name": "inadvisableguy", "link": "https://stackoverflow.com/users/9019076/inadvisableguy"}, "edited": false, "score": 0, "creation_date": 1528286950, "post_id": 50719791, "comment_id": 88448480, "body": "@JC Guidicelli not really"}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 101, "user_id": 9019076, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/446e309be0f5d46819de8b9d287935a0?s=128&d=identicon&r=PG&f=1", "display_name": "inadvisableguy", "link": "https://stackoverflow.com/users/9019076/inadvisableguy"}, "edited": false, "score": 0, "creation_date": 1528287109, "post_id": 50719791, "comment_id": 88448592, "body": "@inadvisableguy what&#39;s wrong ? do you have error message ?"}, {"owner": {"reputation": 101, "user_id": 9019076, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/446e309be0f5d46819de8b9d287935a0?s=128&d=identicon&r=PG&f=1", "display_name": "inadvisableguy", "link": "https://stackoverflow.com/users/9019076/inadvisableguy"}, "edited": false, "score": 0, "creation_date": 1528287341, "post_id": 50719791, "comment_id": 88448746, "body": "No, somehow it deletes some other rows in the process as well. @TBoulz &#39;s answer worked fine.  Thanks though :)"}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 101, "user_id": 9019076, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/446e309be0f5d46819de8b9d287935a0?s=128&d=identicon&r=PG&f=1", "display_name": "inadvisableguy", "link": "https://stackoverflow.com/users/9019076/inadvisableguy"}, "edited": false, "score": 0, "creation_date": 1528287420, "post_id": 50719791, "comment_id": 88448805, "body": "@inadvisableguy I edited the answer, adjust variables sheet name"}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "edited": false, "score": 0, "creation_date": 1528287435, "post_id": 50719791, "comment_id": 88448818, "body": "Ok no problem !"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528287926, "post_id": 50719791, "comment_id": 88449144, "body": "@JCGuidicelli <code>lastrow</code> will be the last row of <code>ActiveSheet</code> you might want to move that behind your worksheet declaration and use <code>ws.Range\u2026</code> and also declare <code>i as Long</code> too."}], "tags": [], "owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "is_accepted": false, "score": 1, "last_activity_date": 1528288010, "last_edit_date": 1528288010, "creation_date": 1528286064, "answer_id": 50719791, "question_id": 50719626, "link": "https://stackoverflow.com/questions/50719626/macro-to-delete-rows-in-excel-where-cells-contain-certain-text/50719791#50719791", "title": "Macro to delete rows in excel where cells contain certain text", "body": "<p>Try this. You need to start loop from the end :</p>\n\n<pre><code>Sub test()\n\n\n    Dim wb As Workbook\n    Set wb = ThisWorkbook\n\n    Dim ws As Worksheet\n    Set ws = wb.Sheets(\"sh_test\") 'edit your sheet name\n    Dim lastrow As Long\n    lastrow = ws.Range(\"C\" &amp; Rows.Count).End(xlUp).Row + 1 'maybe change letter of the column\n\n    For i = lastrow To 2 Step -1\n        If ws.Cells(i, 3).Value = \"NA\" And ws.Cells(i, 4).Value = \"NA\" Then\n            ws.Rows(i).EntireRow.Delete     \n        End If\n    Next i \nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 329, "user_id": 9893792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/275b85520413c6cbf42db999f9832801?s=128&d=identicon&r=PG&f=1", "display_name": "TBoulz", "link": "https://stackoverflow.com/users/9893792/tboulz"}, "is_accepted": true, "score": 1, "last_activity_date": 1528286724, "creation_date": 1528286724, "answer_id": 50719985, "question_id": 50719626, "link": "https://stackoverflow.com/questions/50719626/macro-to-delete-rows-in-excel-where-cells-contain-certain-text/50719985#50719985", "title": "Macro to delete rows in excel where cells contain certain text", "body": "<p>Here is something I've used before. This applies filters, filters for NA in both column C and D, then removes those rows (excluding the header). Note that this will only remove the row if NA is in BOTH columns. If NA is in C but not in D then it will not remove the row.</p>\n\n<pre><code>'Applies filter to the columns. You will want to adjust your range.\nCells.Select\nSelection.AutoFilter\nActiveSheet.Range(\"$A$1:$D$6\").AutoFilter Field:=3, Criteria1:=\"NA\"\nActiveSheet.Range(\"$A$1:$D$6\").AutoFilter Field:=4, Criteria1:=\"NA\"\n\n'Removes the rows that are displayed, except the header\nApplication.DisplayAlerts = False\nActiveSheet.UsedRange.Offset(1, 0).Resize(ActiveSheet.UsedRange.Rows.Count - 1).Rows.Delete\nApplication.DisplayAlerts = True\n\n'Removes the filter\nCells.Select\nSelection.AutoFilter\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 101, "user_id": 9019076, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/446e309be0f5d46819de8b9d287935a0?s=128&d=identicon&r=PG&f=1", "display_name": "inadvisableguy", "link": "https://stackoverflow.com/users/9019076/inadvisableguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4078, "favorite_count": 0, "accepted_answer_id": 50719985, "answer_count": 2, "score": -1, "last_activity_date": 1528288010, "creation_date": 1528285532, "last_edit_date": 1531164843, "question_id": 50719626, "link": "https://stackoverflow.com/questions/50719626/macro-to-delete-rows-in-excel-where-cells-contain-certain-text", "title": "Macro to delete rows in excel where cells contain certain text", "body": "<p>I'm new to VBA and not very adept with the programming so I'm hoping for some help here. </p>\n\n<p>Here's the thing:</p>\n\n<p>I have an excel sheet where I need to scan the entire rows and delete rows where Column C and Column D have the text \"NA\" in the same row. </p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["vba", "excel", "excel-2010"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 2, "creation_date": 1528284854, "post_id": 50719295, "comment_id": 88447103, "body": "Note <code>Format(registos.TextBox4, &quot;#&quot;)</code> always returns a string not a number. This might cause strange issues when comparing against numbers. Better to convert it into a proper number type than into a string."}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1528284940, "post_id": 50719295, "comment_id": 88447152, "body": "You also need to add Brackets in the form: If A And (B Or C) Then"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1528285047, "post_id": 50719295, "comment_id": 88447223, "body": "What are you trying to do with <code>Format(___,&quot;#&quot;)</code> ?"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1528285110, "post_id": 50719295, "comment_id": 88447264, "body": "Also your <code>OR</code>&#39;s are a little ambiguous.  ...like @Pierre44 mentioned... Excel can&#39;t guess whether you mean <code>A And (B Or C)</code> or <code>(A And B) Or C</code> etc"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528285683, "post_id": 50719295, "comment_id": 88447612, "body": "@ashleedawg Well, I think it will not guess but just go from left to right so it will always perform the first condition (here the <code>And</code>) and then take that result to perform the second (here the <code>Or</code>) so it will always do <code>(A And B) Or C</code> if no brackets are used. \u2022 Nevertheless it is a very good idea to use brackets for clarification here!"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528288443, "post_id": 50719295, "comment_id": 88449487, "body": "@P\u1d07\u029c Yeah, let&#39;s teach them right, instead of it &quot;accidentally working&quot; and expecting that next time...  Of course Excel&#39;s not going to <i>guess</i>, it was an expression. \ud83e\udd13\u200e"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1528285597, "post_id": 50719636, "comment_id": 88447555, "body": "Do I see a Val? :-)"}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "reply_to_user": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 1, "creation_date": 1528285665, "post_id": 50719636, "comment_id": 88447596, "body": "@QHarr yes i thought of you.. we don&#39;t know the data type"}, {"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1528287581, "post_id": 50719636, "comment_id": 88448921, "body": "Still no results. When condition is supposed to be true it doesn&#39;t verifies."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1528287725, "post_id": 50719636, "comment_id": 88449022, "body": "@PedroGaspar You can debug your code. Go through it step by step (F8) and check the value of  <code>registos.TextBox4</code> and <code>Worksheets(&quot;calculos2&quot;).Range(&quot;B4&quot;)</code>. Note that <code>Range(&quot;B4&quot;)</code> might also return a text string not a value and try <code>Range(&quot;B4&quot;).Value</code> instead."}, {"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1528287930, "post_id": 50719636, "comment_id": 88449147, "body": "Given values should make the condition verifies but it just does not , i also tried usinge .Value but made no difference."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 1, "creation_date": 1528288027, "post_id": 50719636, "comment_id": 88449205, "body": "@PedroGaspar what exactly are these values that you get <b>during debug from the variables</b>?"}, {"owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "edited": false, "score": 0, "creation_date": 1528288546, "post_id": 50719636, "comment_id": 88449550, "body": "Got it , the problema was from CC = registos.TextBox4 , as that would always fall into fake , it was my mistake. Anyways , thanks for the help and info."}], "tags": [], "owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "is_accepted": true, "score": 1, "last_activity_date": 1528285605, "last_edit_date": 1528285605, "creation_date": 1528285553, "answer_id": 50719636, "question_id": 50719295, "link": "https://stackoverflow.com/questions/50719295/excel-vba-if-condition/50719636#50719636", "title": "Excel VBA If Condition", "body": "<p>Perhaps you meant something like this:</p>\n\n<pre><code>If CC = \"63165-POLIMENTO\" And _\n    (Val(registos.TextBox4) &lt; 0 Or _\n      Val(registos.TextBox4) &gt; Worksheets(\"calculos2\").Range(\"B4\")) Then\n</code></pre>\n\n<ul>\n<li><p><code>Val</code> converts the string to a number</p></li>\n<li><p>This says \"<code>CC</code> has to match <code>63165-POLIMENTO</code>\"  <em>AND</em> :</p>\n\n<ul>\n<li><strong><em>EITHER</em></strong> ( <code>TextBox4</code> is <strong>negative</strong>, <strong><em>OR</em></strong>,</li>\n<li><code>TextBox4</code> is larger than <code>B4</code>  )</li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 75, "user_id": 7395776, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XO-DLPFtH-4/AAAAAAAAAAI/AAAAAAAAAVQ/5YVUhPGuqUU/photo.jpg?sz=128", "display_name": "Pedro Gaspar", "link": "https://stackoverflow.com/users/7395776/pedro-gaspar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 50719636, "answer_count": 1, "score": -1, "last_activity_date": 1528285605, "creation_date": 1528284501, "last_edit_date": 1528284768, "question_id": 50719295, "link": "https://stackoverflow.com/questions/50719295/excel-vba-if-condition", "title": "Excel VBA If Condition", "body": "<p>For some reason the i'm running everytime into the condition even when it doesn't verifies.</p>\n\n<pre><code>If CC = \"63165-POLIMENTO\" And Format(registos.TextBox4, \"#\") &lt; 0 Or Format(registos.TextBox4, \"#\") &gt; ThisWorkbook.Worksheets(\"calculos2\").Range(\"B4\") Then\n</code></pre>\n\n<p>My problem is on greater and less operators , i believe they are misplaced.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1528285734, "post_id": 50719239, "comment_id": 88447651, "body": "It s quite hard to follow your question as it is so long. What do you exactly need? Only the timestamp (an additionnal column) inside your new chart?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9828520"}, "reply_to_user": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1528285886, "post_id": 50719239, "comment_id": 88447751, "body": "yes, that is correct... the question is in the title?"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1528289535, "post_id": 50719239, "comment_id": 88450162, "body": "I added an example for the orientation in my answer, I am not sure that this is what you need"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9828520"}, "reply_to_user": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1528289819, "post_id": 50719239, "comment_id": 88450339, "body": "thats cool...thx, gonna keep that....but can u show me how to move the xaxis to the bottom of the chart, like just like in the second picture in the second edit?"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1528290309, "post_id": 50719239, "comment_id": 88450659, "body": "TickLabelPosition = xlLow (as in my edit)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9828520"}, "reply_to_user": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1528290494, "post_id": 50719239, "comment_id": 88450775, "body": "Thanks man, u saved me....I sit on this problem, for like 20 hours..."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9828520"}, "edited": false, "score": 0, "creation_date": 1528288042, "post_id": 50720030, "comment_id": 88449217, "body": "First, let me say that i appreciate you for taking time for me, also, I tried you solution, and thx, for the missing row, Is there a way for me to ignore the 1st row in that selection, cause, they are all generated zeros....not important...and I did your code, and the cart didn&#39;t have the dates as the x axis :("}, {"owner": {"user_type": "does_not_exist", "display_name": "user9828520"}, "edited": false, "score": 0, "creation_date": 1528288341, "post_id": 50720030, "comment_id": 88449424, "body": "thanks for your advise, I moved the timestamp one row up, used =Now() function there and modified the number by 1, now i am almost there....I get the dates as XAxis, but it kinda looks weird...please take a look on the edited question i a minute"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1528288504, "post_id": 50720030, "comment_id": 88449522, "body": "So your X Axis should have only the minutes / seconds? You will always have the same date I guess"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9828520"}, "edited": false, "score": 0, "creation_date": 1528288851, "post_id": 50720030, "comment_id": 88449762, "body": "dont worry, i ll need the dates as well...please take a look on the question again, on edit2 and bellow..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user9828520"}, "edited": false, "score": 0, "creation_date": 1528712452, "post_id": 50720030, "comment_id": 88596760, "body": "sorry for bothering you again....but can you show me how to make the chart look equidistant? I mean, that the chart can look ugly if the data is submitted in very different time periods....I want the markers always to have the same distance from each other....can u help me?"}, {"owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "edited": false, "score": 0, "creation_date": 1528721962, "post_id": 50720030, "comment_id": 88602539, "body": "Sure, can you ask it inanother question? maybe other people will have the same one"}], "tags": [], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "is_accepted": true, "score": 1, "last_activity_date": 1528290049, "last_edit_date": 1528290049, "creation_date": 1528286878, "answer_id": 50720030, "question_id": 50719239, "link": "https://stackoverflow.com/questions/50719239/how-to-add-the-x-axis-into-an-already-created-line-chart-using-vba/50720030#50720030", "title": "How to add the X axis into an already created line chart using VBA?", "body": "<p>One possible solution would be to define the whole range of your graph from the beginning:</p>\n\n<p>For this you can replace:</p>\n\n<pre><code>Set rng = ActiveSheet.range(Cells(2, \"Y\"), Cells(row_Position, \"AB\"))\n</code></pre>\n\n<p>By:</p>\n\n<pre><code>Set rng = ActiveSheet.Range(\"Sheet1!$F$1:$F$\" &amp; row_Position &amp; \",Sheet1!$Y$1:$AB$\" &amp; row_Position)\n</code></pre>\n\n<p>Note that I changed F4:F28 to \"F1:F\" &amp; row_Position as you need to have as many values here as you have in the other columns</p>\n\n<p>As your X values are quite long, you might want to change their orientation\nExample: </p>\n\n<pre><code>ActiveSheet.ChartObjects(\"Chart\").Activate\nActiveChart.Axes(xlCategory).TickLabelPosition = xlLow\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user9828520"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 50720030, "answer_count": 1, "score": 0, "last_activity_date": 1528290049, "creation_date": 1528284326, "last_edit_date": 1528288783, "question_id": 50719239, "link": "https://stackoverflow.com/questions/50719239/how-to-add-the-x-axis-into-an-already-created-line-chart-using-vba", "title": "How to add the X axis into an already created line chart using VBA?", "body": "<p>I got this problem:</p>\n\n<p>I am using VBA, to make some charts.</p>\n\n<p>I made some input fields...those input fields are transferred via button to a table, and from that table, I draw the line chart.</p>\n\n<p>Looks like this:</p>\n\n<p>Answers in column D, they are all changeable, but the number is constant, always 12...</p>\n\n<p><a href=\"https://i.stack.imgur.com/lp0EW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lp0EW.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then I got the table, where on button press, the answers are transferred:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bY8Ws.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bY8Ws.png\" alt=\"enter image description here\"></a></p>\n\n<p>Point is, on button click, I add a new row to the table, the last rows (from S to AB) are generic data, which I make with formulas out of the answers.</p>\n\n<p>Once I add the new row, I also add the time stamp to the left side...</p>\n\n<p>Now, I am ready to make a line chart...with the last 4 columns Y, Z, AA and AB\nI made it, but I don't know how to add the timestamp to be on the x axis. </p>\n\n<p>Timestamp looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/k9YLE.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/k9YLE.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code of my button:</p>\n\n<pre><code>Sub AddData()\n'\n' AddData Macro\n' Adds data to the table\n'\n' Keyboard Shortcut: Ctrl+d\n'\nDim cellValue As Variant\nDim rowSize As Integer\nDim i As Integer\nDim myRange As Variant\nDim cell As Variant\nDim column_Position As Integer\nDim row_Position As Integer\nDim rangeFormula As Variant\n\nrowSize = 12\nrow_Position = -1\nSet myRange = range(\"G1:G1000\")\n\n'Find first empty row\nFor Each cell In myRange\n    If IsEmpty(cell.Value) Then\n        column_Position = cell.Column\n        row_Position = cell.row\n        Exit For\n    End If\nNext cell\n\n'Do for loop and fill the cells from G(7) to R(18) with data\nFor i = 1 To rowSize\n    cellValue = range(\"D2:D13\").Cells(i).Value\n    range(Cells(row_Position, \"G\"), Cells(row_Position, \"R\")).Cells(i).Value = cellValue\nNext i\n\n'Copy formulas one row bellow, from S(19) to AB(28)\nIf row_Position &gt; 4 Then\n    range(Cells(row_Position - 1, \"S\"), Cells(row_Position - 1, \"AB\")).Select\n    Selection.Copy\n    range(Cells(row_Position, \"S\"), Cells(row_Position, \"AB\")).Select\n    Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks _\n        :=False\nEnd If\n\n'Add timestamp to F cells\nCells(row_Position, \"F\") = Now()\nCells(row_Position, \"F\") = Format(Now(), \"dd-mm-yyyy hh:mm:ss\")\n\n'Remove Selections\nCells(1, 1).Select\nApplication.CutCopyMode = False\n\n'Delete all old charts\nIf Not Worksheets(\"Data\").ChartObjects.Count = 0 Then\n    Worksheets(\"Data\").ChartObjects.Delete\nEnd If\n\n'Draw a chart\nDim rng As range\nDim cht As ChartObject\n\n'Your data range for the chart\nSet rng = ActiveSheet.range(Cells(2, \"Y\"), Cells(row_Position, \"AB\"))\n\n'Create a chart\nSet cht = ActiveSheet.ChartObjects.Add( _\n    Left:=ActiveCell.Left, _\n    Width:=775, _\n    Top:=275, _\n    Height:=250)\n\n'Populate chart with data\ncht.Chart.SetSourceData Source:=rng\n\n'Add gridlines\ncht.Chart.Axes(xlCategory).HasMajorGridlines = True\n\n'Determine the chart type\ncht.Chart.ChartType = xlXYScatterLines\n\n\ncht.Activate\ncht.Chart.SeriesCollection(1).XValues = \"=$F$4:$F$28\"\n</code></pre>\n\n<p>End Sub</p>\n\n<p>Now, I have something like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/YSNEN.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YSNEN.png\" alt=\"enter image description here\"></a></p>\n\n<p>A line chart with the 4 rows I used to make the chart.</p>\n\n<p>But I have no idea how to add the F(F4 to last filled row) column as the x axis.</p>\n\n<p>Edit1: Forgot to mention, once I add the row to the table, the current chart is deleted, and I make a new one, with the all data as before, plus the new row...</p>\n\n<p>Edit2: Thanks to Pierre44, I moved the timestamp column a row higher, and added one extra row, so that the arrays all have the same length...and it looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/bMLcl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/bMLcl.png\" alt=\"enter image description here\"></a>\nPlease help.</p>\n\n<p>And it is almost done, but can you show me how to move the x axis, bellow the graph?</p>\n\n<p>Like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rj7Ce.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rj7Ce.png\" alt=\"enter image description here\"></a></p>\n\n<p>Thanks.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 15917, "user_id": 5211833, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Pyme2.jpg?s=128&g=1", "display_name": "Adriaan", "link": "https://stackoverflow.com/users/5211833/adriaan"}, "edited": false, "score": 0, "creation_date": 1528283713, "post_id": 50718920, "comment_id": 88446373, "body": "So what did you try to collect this info? Note that some research on the subject is required by Stack Overflow policy, see <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>. For starters: get a matrix of the numbers (meaning of <code>matrix(2:end,2:end)</code>, and use <code>isnan</code> to extract the numbers. Also is is unclear how different numbers act; in the sense that <code>one C</code> is <code>3</code>, but appears only once. Please <a href=\"https://stackoverflow.com/posts/50718920/edit\">edit</a> the question with more details and what you already tried to solve this problem."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1528284365, "post_id": 50718920, "comment_id": 88446798, "body": "It&#39;s a bit unclear to me, what should be your output? I get that you want to store the column names for each numerical values for respctive rows in an array, but it&#39;s not clear to me, once you actually save the data in the array what should we do with it. Display it in a row? Something else..? Or are you only interested in the algorhytm for filling the array with string values?"}, {"owner": {"reputation": 33, "user_id": 8434643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1013c884fbc9e7a7f40c9ff00303f49?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/8434643/paul"}, "edited": false, "score": 0, "creation_date": 1528284720, "post_id": 50718920, "comment_id": 88447025, "body": "Yes I created a minimum example of my problem and I&#180;m only interested in the algorithm to store the values for each numerical values for respective rows in a column array. I edited my questions just with numerical values by &quot;1&quot;.  The different numbers are interesting for another function."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1528285365, "post_id": 50718920, "comment_id": 88447397, "body": "One more question. Do your arrays have to absolutely be called <code>&#39;One&#39;</code> <code>&#39;Two&#39;</code>etc? Could it perhaps be for example <code>&#39;array1&#39;</code> <code>&#39;array2&#39;</code> and so on? I&#39;m asking, because it&#39;s generally a bad practice to use <code>.toString()</code> method for variable names. Would be much easier if we used a static variable name with increasing index series"}, {"owner": {"reputation": 33, "user_id": 8434643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1013c884fbc9e7a7f40c9ff00303f49?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/8434643/paul"}, "edited": false, "score": 0, "creation_date": 1528285864, "post_id": 50718920, "comment_id": 88447736, "body": "The strings in the first column have specific names in several sheets. For example I have six sheets and each one of them has in the second row the string &#39;technology&#39; and in the third row &#39;process&#39;. For a good overview of this, it would be nice to have these specific strings as an array tag. Does this answer your question?"}, {"owner": {"reputation": 33, "user_id": 8434643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1013c884fbc9e7a7f40c9ff00303f49?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/8434643/paul"}, "edited": false, "score": 0, "creation_date": 1528291555, "post_id": 50718920, "comment_id": 88451559, "body": "OK, &#39;array1&#39;, &#39;array2&#39; or something like that would be ok as well for a start. I just don&#39;t know how to start because I tried &#39;find&#39; and &#39;nan&#39; is not working for a raw matrix."}], "owner": {"reputation": 33, "user_id": 8434643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1013c884fbc9e7a7f40c9ff00303f49?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/8434643/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528285051, "creation_date": 1528283305, "last_edit_date": 1531161705, "question_id": 50718920, "link": "https://stackoverflow.com/questions/50718920/matlab-matrix-get-a-cell-array-of-strings-of-the-header-for-values-in-each-row", "title": "Matlab matrix: Get a cell array of strings of the header for values in each row", "body": "<p>I get a raw matrix from a Excel-File like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FcbMW.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FcbMW.png\" alt=\"enter image description here\"></a></p>\n\n<p>with this code:</p>\n\n<pre><code>% Read Excel File\nfilename = 'Name_of_Excel_File.xlsx';\n\n% Set Sheet and Size\n% If you want to try, use the correct sheet number\nSheet = 3; \nImpact = 'A1:H7';\n\n% Read and save to matrix\n[~,~,Impact] = xlsread(filename,Sheet,Impact);\n</code></pre>\n\n<p>I get this raw impact matrix:</p>\n\n<p><a href=\"https://i.stack.imgur.com/2NycF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2NycF.png\" alt=\"enter image description here\"></a></p>\n\n<p>Now comes the tricky part and I don't know how to start my problem solving process. </p>\n\n<p>I\u00b4d like to get a seperate string cell array for each row.\nFor example </p>\n\n<pre><code>One = 'A'    'C'    'D'    'F'\n</code></pre>\n\n<p>and </p>\n\n<pre><code>Two = 'B'    'G'\n</code></pre>\n\n<p>and so on.</p>\n\n<p>I\u00b4d like to get for each row a cell array of strings. The strings should be the ones in the header for the numbers in their column. </p>\n\n<p>Which possibilities do I have for this problem?</p>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 1, "creation_date": 1528284004, "post_id": 50718703, "comment_id": 88446567, "body": "Nice code! Just curious why you leave your function to return a variant instead of a string."}, {"owner": {"reputation": 31, "user_id": 9845029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad861d3bbca2dc3da568ceda1f88a40c?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmay", "link": "https://stackoverflow.com/users/9845029/tanmay"}, "edited": false, "score": 0, "creation_date": 1528284547, "post_id": 50718703, "comment_id": 88446917, "body": "I was also looping through the names right now but felt that it is not really an optimal solution. Because here for every change it will check for every named range and then return. But thanks anyways. Your code is way cleaner than mine"}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "reply_to_user": {"reputation": 1987, "user_id": 4434652, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/94ee978abf31b6cb604ec929a54ae4e1?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/4434652/brian"}, "edited": false, "score": 0, "creation_date": 1528284941, "post_id": 50718703, "comment_id": 88447154, "body": "@Brian - no real reason - I think I was initially considering returning a Boolean, then thought it MAY be useful to return the (first) matching named range name... Not sure it will make a massive performance difference either way! Tanmay - are you seeing a performance hit from this approach?"}, {"owner": {"reputation": 31, "user_id": 9845029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad861d3bbca2dc3da568ceda1f88a40c?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmay", "link": "https://stackoverflow.com/users/9845029/tanmay"}, "edited": false, "score": 0, "creation_date": 1528286220, "post_id": 50718703, "comment_id": 88447994, "body": "@Olly - Not much. A direct solution would have been best but, I think I can modify my current code to make it better."}], "tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": false, "score": 4, "last_activity_date": 1528283235, "last_edit_date": 1528283235, "creation_date": 1528282705, "answer_id": 50718703, "question_id": 50718616, "link": "https://stackoverflow.com/questions/50718616/how-to-check-in-the-sheetchange-event-whether-the-change-made-was-in-a-named-ran/50718703#50718703", "title": "How to check in the SheetChange event whether the change made was in a named Range", "body": "<p>Try</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    'Some code\n    If Not Intersect(Target, Range(\"MyNamedRange\")) Is Nothing Then\n        'Some code here\n    End If\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>The above works to test if the target is part of one specific named range. If your requirement is to test whether the target is part of ANY named range, then you will indeed have to loop through the existing names - something like this would work:</p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n    'Some code\n    Dim sName As String\n    sName = InAnyNamedRange(Target)\n    If Not sName = \"\" Then\n        'Some code here\n        Debug.Print Target.Address &amp; \" changed, and is in named range \" &amp; sName\n    End If\nEnd Sub\n\nFunction InAnyNamedRange(ByRef rng As Range)\n    Dim nm As Name\n    For Each nm In ThisWorkbook.Names\n        If Not Intersect(rng, Range(nm)) Is Nothing Then\n            InAnyNamedRange = nm.Name\n            Exit Function\n        End If\n    Next nm\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 9845029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad861d3bbca2dc3da568ceda1f88a40c?s=128&d=identicon&r=PG&f=1", "display_name": "Tanmay", "link": "https://stackoverflow.com/users/9845029/tanmay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528283235, "creation_date": 1528282469, "last_edit_date": 1528282797, "question_id": 50718616, "link": "https://stackoverflow.com/questions/50718616/how-to-check-in-the-sheetchange-event-whether-the-change-made-was-in-a-named-ran", "title": "How to check in the SheetChange event whether the change made was in a named Range", "body": "<p>So I am coding in the SheetChange event in Excel. I want to know if the change was made in a named Range. So essentially:  </p>\n\n<pre><code>Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)\n'Some code\nIf ('Target address is a part of one of the named ranges')\n    'Some code here\n</code></pre>\n\n<p>Note that I have multiple Named Ranges in different Sheets which I would like to check. One way can be to loop through every named range whenever a change is made somewhere. But I don't think that's a good way to code. Any help would be appreciated. </p>\n"}, {"tags": ["vba", "catia"], "comments": [{"owner": {"reputation": 859, "user_id": 3563563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb456db94804e2a88e57e5970ac8e60?s=128&d=identicon&r=PG&f=1", "display_name": "gdir", "link": "https://stackoverflow.com/users/3563563/gdir"}, "edited": false, "score": 0, "creation_date": 1528342669, "post_id": 50718526, "comment_id": 88472936, "body": "There&#39;s no direct way in VBA because the Automation API hardly contains methods to read the mathematical description of surfaces or curves. Without that it is difficult to check whether two surfaces or two curves are identical."}], "answers": [{"comments": [{"owner": {"reputation": 859, "user_id": 3563563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb456db94804e2a88e57e5970ac8e60?s=128&d=identicon&r=PG&f=1", "display_name": "gdir", "link": "https://stackoverflow.com/users/3563563/gdir"}, "edited": false, "score": 0, "creation_date": 1528381032, "post_id": 50740483, "comment_id": 88494710, "body": "Another (complicated) way would be to save the part as IGES and then search for duplicates in the IGES file. Collect the names of the duplicates and use them to delete the features in the CATIA part."}], "tags": [], "owner": {"reputation": 821, "user_id": 6937632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a1554053245e86d609b83f201aa6bf8?s=128&d=identicon&r=PG&f=1", "display_name": "C R Johnson", "link": "https://stackoverflow.com/users/6937632/c-r-johnson"}, "is_accepted": true, "score": 0, "last_activity_date": 1528372227, "creation_date": 1528372227, "answer_id": 50740483, "question_id": 50718526, "link": "https://stackoverflow.com/questions/50718526/delete-overlapping-identical-surfaces-in-catia-using-vba/50740483#50740483", "title": "Delete overlapping identical surfaces in CATIA using VBA", "body": "<p>As gdir said there is no direct way. </p>\n\n<p>However you can compare some properties which you can measure such as surface area, length of boundary, number of verticies on the boundary, various extremum points, center of gravity, moments of inertia, etc. </p>\n\n<p>Although these properties don't mathematically prove or disprove that two surfaces are the identical/different in most cases some combination of them will suffice. </p>\n"}], "owner": {"reputation": 105, "user_id": 9455965, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Diego Blanco", "link": "https://stackoverflow.com/users/9455965/diego-blanco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 50740483, "answer_count": 1, "score": -1, "last_activity_date": 1528372227, "creation_date": 1528282158, "question_id": 50718526, "link": "https://stackoverflow.com/questions/50718526/delete-overlapping-identical-surfaces-in-catia-using-vba", "title": "Delete overlapping identical surfaces in CATIA using VBA", "body": "<p>I have a file that contains many identical surfaces overlapped. How could I check if two surfaces are identical and overlapped and delete one of them using VBA functions?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528281073, "post_id": 50718003, "comment_id": 88444696, "body": "May I ask <i>why</i> you need to list the ranges?"}, {"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528281433, "post_id": 50718003, "comment_id": 88444920, "body": "This is one of the questions in my internship assignment."}], "answers": [{"comments": [{"owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 1, "creation_date": 1528281496, "post_id": 50718201, "comment_id": 88444961, "body": "Sorry, I didn&#39;t knew that. I deleted all the #REF ranges from the Names Manager, and now it is working perfectly fine. Thank you for the answer."}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "edited": false, "score": 0, "creation_date": 1528281563, "post_id": 50718201, "comment_id": 88445003, "body": "@AmanDevrath - no need to be sorry for this :). You are welcome :)"}], "tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": true, "score": 2, "last_activity_date": 1528281111, "creation_date": 1528281111, "answer_id": 50718201, "question_id": 50718003, "link": "https://stackoverflow.com/questions/50718003/listing-named-ranges-resulting-in-error-ref/50718201#50718201", "title": "Listing named ranges resulting in error #REF", "body": "<p>Ribbon > Formulas > Names Manager:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NPe40.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NPe40.png\" alt=\"enter image description here\"></a></p>\n\n<p>You would see anything, which is declared in the workbook and how it is declared. In your code you are looping through <code>ActiveWorkbook.Names</code> and in your screenshot you are showing only the names in the current worksheet. </p>\n"}], "owner": {"reputation": 335, "user_id": 8436087, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh4.googleusercontent.com/-i987-d7cvuI/AAAAAAAAAAI/AAAAAAAAB80/t2kBIerq0ZI/photo.jpg?sz=128", "display_name": "Aman Devrath", "link": "https://stackoverflow.com/users/8436087/aman-devrath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 50718201, "answer_count": 1, "score": 1, "last_activity_date": 1528281111, "creation_date": 1528280506, "last_edit_date": 1592644375, "question_id": 50718003, "link": "https://stackoverflow.com/questions/50718003/listing-named-ranges-resulting-in-error-ref", "title": "Listing named ranges resulting in error #REF", "body": "<p><a href=\"https://i.stack.imgur.com/32Zaz.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/32Zaz.jpg\" alt=\"enter image description here\" /></a></p>\n<p>These are 4 ranges (demo ranges). As you can see, the selected range is named as numbers2. Similarly, a5:a9 is numbers1, b2:b3 is alphabets1 and d2:d3 is alphabets2. I am displaying the named ranges in another sheet in same workbook.\nHere's the code :</p>\n<pre><code>Sub namedRanges()\nDim nm As Name, n As Long, y As Range, z As Worksheet\nApplication.ScreenUpdating = False\n\nDim sheet_name As String: sheet_name = InputBox(&quot;Provide the name of the worksheet where to list all the named ranges&quot;)\nSheets.Add After:=Sheets(Sheets.Count)\nSheets(ActiveSheet.Name).Name = sheet_name\n\nSet z = ActiveSheet\nn = 2\nWith z\n    .[a1:xfd104856].ClearContents\n    .[a1:b1] = [{&quot;Name&quot;,&quot;Refers to&quot;}]\n    For Each nm In ActiveWorkbook.Names\n        .Cells(n, 1).End(xlUp)(2) = nm.Name\n        .Cells(n, 2).End(xlUp)(2) = &quot;'&quot; &amp; nm.RefersTo\n        n = n + 1\n    Next nm\nEnd With\nApplication.ScreenUpdating = True\nEnd Sub\n</code></pre>\n<p>Everything is working fine, except I am getting some extra named ranges which aren't there in the worksheet.</p>\n<p><a href=\"https://i.stack.imgur.com/fmgEB.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fmgEB.jpg\" alt=\"enter image description here\" /></a></p>\n<p>See, the new worksheet which is created. and there are two columns created. But I should get 4 named ranges, instead I am getting more.</p>\n<p>Any thing which is wrong in the code ?</p>\n"}, {"tags": ["excel", "excel-formula", "vba"], "comments": [{"owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "edited": false, "score": 0, "creation_date": 1528280586, "post_id": 50717788, "comment_id": 88444391, "body": "Will Kadabra-Jam relation be hard coded in the formula or will you have a match table etc? And will you also be using the values of Abra &amp; Jimmy (1, 2 &amp; 3) in this matching?"}, {"owner": {"reputation": 53, "user_id": 8085292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5fcdb70143e2a2743af5f76282cc0a1?s=128&d=identicon&r=PG&f=1", "display_name": "Ishaan Shakunt", "link": "https://stackoverflow.com/users/8085292/ishaan-shakunt"}, "reply_to_user": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "edited": false, "score": 0, "creation_date": 1528281668, "post_id": 50717788, "comment_id": 88445052, "body": "Either hardcoded in the formula or I can create a match table. ( I hadn&#39;t thought about a match table yet.) Yes. Abra:1 will Match with Jimmy:1 and will give other column values relatively. Also, I&#39;m relatively new to Excel. Apologies for not using the correct slang."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 8085292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5fcdb70143e2a2743af5f76282cc0a1?s=128&d=identicon&r=PG&f=1", "display_name": "Ishaan Shakunt", "link": "https://stackoverflow.com/users/8085292/ishaan-shakunt"}, "edited": false, "score": 0, "creation_date": 1528283074, "post_id": 50718653, "comment_id": 88445974, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 7497, "user_id": 8670372, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ir8a4Lbosmo/AAAAAAAAAAI/AAAAAAAAOtE/2eY5jK1atcc/photo.jpg?sz=128", "display_name": "Xabier", "link": "https://stackoverflow.com/users/8670372/xabier"}, "is_accepted": true, "score": 2, "last_activity_date": 1528282571, "creation_date": 1528282571, "answer_id": 50718653, "question_id": 50717788, "link": "https://stackoverflow.com/questions/50717788/how-to-manually-map-columns-in-excel-with-different-headers/50718653#50718653", "title": "How to manually map columns in Excel with different headers", "body": "<p>One way to achieve this would be to use an Index Match Match formula as below, if you were to enter this formula into cell B8:</p>\n\n<p><code>=INDEX($A$1:$C$4,MATCH(A8,$A$1:$A$4,0),MATCH(\"Kadabra\",$1:$1,0))</code></p>\n\n<p>And in C8:</p>\n\n<p><code>=INDEX($A$1:$C$4,MATCH(A8,$A$1:$A$4,0),MATCH(\"Shadabra\",$1:$1,0))</code></p>\n\n<p>Then you could fill the formula down and it should bring the appropriate values into your Jimmy/Jim/Jam Table.</p>\n"}, {"tags": [], "owner": {"reputation": 1026, "user_id": 8788388, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-j4tnBdMaXfk/AAAAAAAAAAI/AAAAAAACwcU/Jg67BYcCeW0/photo.jpg?sz=128", "display_name": "Hakan ERDOGAN", "link": "https://stackoverflow.com/users/8788388/hakan-erdogan"}, "is_accepted": false, "score": 1, "last_activity_date": 1528282623, "creation_date": 1528282623, "answer_id": 50718674, "question_id": 50717788, "link": "https://stackoverflow.com/questions/50717788/how-to-manually-map-columns-in-excel-with-different-headers/50718674#50718674", "title": "How to manually map columns in Excel with different headers", "body": "<p>First please check below screenshot:</p>\n\n<p><a href=\"https://i.stack.imgur.com/D64KF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/D64KF.png\" alt=\"enter image description here\"></a></p>\n\n<p>I have created a match table at <code>E:F</code> in order to avoid nested <code>IF</code>s for that condition. You may move the match table to another sheet and change your formula accordingly.</p>\n\n<p>Formula for <code>B8</code> is as below. You may drag-copy it down and right:</p>\n\n<pre><code>=VLOOKUP($A8,$A$2:$C$4,MATCH(VLOOKUP(B$7,$E:$F,2,0),$A$1:$C$1,0),0)\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 8085292, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b5fcdb70143e2a2743af5f76282cc0a1?s=128&d=identicon&r=PG&f=1", "display_name": "Ishaan Shakunt", "link": "https://stackoverflow.com/users/8085292/ishaan-shakunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 50718653, "answer_count": 2, "score": -1, "last_activity_date": 1528282623, "creation_date": 1528279868, "last_edit_date": 1531161705, "question_id": 50717788, "link": "https://stackoverflow.com/questions/50717788/how-to-manually-map-columns-in-excel-with-different-headers", "title": "How to manually map columns in Excel with different headers", "body": "<p><a href=\"https://i.stack.imgur.com/uF7df.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/uF7df.jpg\" alt=\"Excel example\"></a></p>\n\n<p>I want to write a function similar to simple Index-Match or Vlookup-Match.</p>\n\n<p>Problem:\nThe values of the \"Kadabra\" columns should be shown in the \"Jam\" column and the \"Shadabra\" column in the \"Jim\" column. Given that the Columns will have consistent headers(Jim, Jam, Kadabra, Shadabra) but their positions may change(which means we cannot use column numbers).\n\"Abra\" and \"Jimmy\" are the index values.</p>\n\n<p>I'm looking for an excel formula solution. If there isn't one then a Visual Basic solution is also welcome.</p>\n"}, {"tags": ["excel", "vba", "filenames", "filepath", "insert-into"], "comments": [{"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1528278426, "post_id": 50716814, "comment_id": 88442968, "body": "Just wondering - I have noticed this <code>x1Up</code> problem in quite a lot of questions in StackOverflow. Where is it coming from initially? (To see what I mean, search the code for <code>x1Up</code>.)"}, {"owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "reply_to_user": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "edited": false, "score": 1, "creation_date": 1528290381, "post_id": 50716814, "comment_id": 88450701, "body": "@Vityata Good spot!"}, {"owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "reply_to_user": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "edited": false, "score": 0, "creation_date": 1528290638, "post_id": 50716814, "comment_id": 88450871, "body": "@Olly - Thanks. I see this too often here and there and I really don&#39;t know where is it coming from? <a href=\"https://stackoverflow.com/questions/35513779/run-time-error-1004\">stackoverflow.com/questions/35513779/run-time-error-1004</a> and <a href=\"https://stackoverflow.com/questions/36102903/run-time-error-1004-excel-2013\" title=\"run time error 1004 excel 2013\">stackoverflow.com/questions/36102903/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6533, "user_id": 8466523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNrm6.jpg?s=128&g=1", "display_name": "Olly", "link": "https://stackoverflow.com/users/8466523/olly"}, "is_accepted": true, "score": 1, "last_activity_date": 1528290335, "last_edit_date": 1528290335, "creation_date": 1528277742, "answer_id": 50716998, "question_id": 50716814, "link": "https://stackoverflow.com/questions/50716814/how-can-i-change-dynamicly-the-file-name-in-the-file-path/50716998#50716998", "title": "How can I change dynamicly the file name in the file path?", "body": "<p>You can use a string variable for a file name, and append that to the hard coded filepath:</p>\n\n<pre><code>Sub openfile(ByVal sFileName As String)\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;C:\\Users\\HarrsionDavid\\Desktop\\\\source\\\" &amp; sFileName, _\n        Destination:=Range(\"A1\"))\n        .Name = \"customer.txt\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 1250\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = True\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = True\n        .TextFileColumnDataTypes = Array(1, 9, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\n    Range(\"A1:C3\").Selection\n    Selection.Delete Shift:=xlUp\n    Range(\"A1:C3\").Selection\n    Selection.Delete Shift:=xlUp\nEnd Sub\n</code></pre>\n\n<p>Then call by passing the filename:</p>\n\n<pre><code>Sub TestOpenFile()\n    openfile \"customer.txt\"\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39694, "user_id": 5448626, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/jwYwY.jpg?s=128&g=1", "display_name": "Vityata", "link": "https://stackoverflow.com/users/5448626/vityata"}, "is_accepted": false, "score": 1, "last_activity_date": 1528277836, "creation_date": 1528277836, "answer_id": 50717032, "question_id": 50716814, "link": "https://stackoverflow.com/questions/50716814/how-can-i-change-dynamicly-the-file-name-in-the-file-path/50717032#50717032", "title": "How can I change dynamicly the file name in the file path?", "body": "<ol>\n<li><p>Write the paths in <code>Range(\"A1:A5\")</code> and loop through them, passing them as a parameter to the <code>Sub OpenFile</code>.</p></li>\n<li><p>Then in your code change the <code>C:\\Users\\HarrsionDavid\\Desktop\\\\source</code> to the passed parameter.</p></li>\n<li><p>Try to make your code better, by trying to avoid <code>Select</code> and <code>Activate</code> - <a href=\"https://stackoverflow.com/questions/10714251/how-to-avoid-using-select-in-excel-vba\">How to avoid using Select in Excel VBA</a>:</p></li>\n</ol>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPublic Sub TestMe()\n\n    Dim paths As Variant        \n    paths = Range(\"A1:A5\")\n    Dim singlePath As Variant\n\n    For Each singlePath In paths\n        OpenFile (singlePath)\n    Next singlePath\n\nEnd Sub\n\nPublic Sub OpenFile(singlePath As String)\n\n    With ActiveSheet.QueryTables.Add(Connection:= _\n            \"TEXT;\" &amp; singlePath, Destination:=Range(\"A1\"))\n        'more code...\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 385, "user_id": 9564026, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ricards Porins", "link": "https://stackoverflow.com/users/9564026/ricards-porins"}, "is_accepted": false, "score": 0, "last_activity_date": 1528278521, "creation_date": 1528278521, "answer_id": 50717286, "question_id": 50716814, "link": "https://stackoverflow.com/questions/50716814/how-can-i-change-dynamicly-the-file-name-in-the-file-path/50717286#50717286", "title": "How can I change dynamicly the file name in the file path?", "body": "<p>Insert another code to create a basic loop, and change one line in your current code as per below:</p>\n\n<pre><code>Public Path As String\nPublic rng As Range\nSub Loop_Through_Files()\n'ensure that public path is the first line in this module literally at the very top\n'set this as your first set of data\nSet rng = ThisWorkbook.Worksheets(\"Sheet1\").Range(\"A1\")\nRepeat:\nPath = rng.Value\nCall openfile\nSet rng = rng.Offset(1, 0)\nIf IsEmpty(rng.Value) Then ' checks if the cell is blank and ends macro, ensure that after the last path there is a blank cell\nElse\nGoTo Repeat\nEnd If\nEnd Sub\n</code></pre>\n\n<p>This is your code slightly modified, i replaced your path with the word path.</p>\n\n<pre><code>Sub openfile()\n'ensure that public path is the first line in this module literally at the very top\n  With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;\" &amp; Path _\n        , Destination:=Range(\"A1\"))\n        .Name = \"customer.txt\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 1250\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = True\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = True\n        .TextFileColumnDataTypes = Array(1, 9, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n  End With\n\n  Range(\"A1:C3\").Selection\n  Selection.delete Shift:=x1Up\n  Range(\"A1:C3\").Selection\n  Selection.delete Shift:=x1Up\n\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 155, "user_id": 3154315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53b37778d71955574dc976022fe02ee2?s=128&d=identicon&r=PG", "display_name": "blackcornail", "link": "https://stackoverflow.com/users/3154315/blackcornail"}, "is_accepted": false, "score": 0, "last_activity_date": 1528358129, "creation_date": 1528358129, "answer_id": 50735792, "question_id": 50716814, "link": "https://stackoverflow.com/questions/50716814/how-can-i-change-dynamicly-the-file-name-in-the-file-path/50735792#50735792", "title": "How can I change dynamicly the file name in the file path?", "body": "<p>Make a variable which will store the path of the files. If you take it the \"opening code\" in an <code>if</code> you can open every file what you want (if the filenames are in the first column in excel).</p>\n\n<pre><code>Sub openfile()\n\n    Dim Con As String\n\n    For i = 3 To 400\n\n    Con = \"TEXT;\" &amp; Cells(1,4).Value &amp; \"\\\" &amp; Cells(i,1).Value\n\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        Con _\n        ,Destination:=Cells(i,2)\n        .Name = Cells(i,1).Value\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileConsecutiveDelimiter = True\n        .TextFileTabDelimiter = True\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = False\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\n\n    Next i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 9901990, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Black Cornail", "link": "https://stackoverflow.com/users/9901990/black-cornail"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 50716998, "answer_count": 4, "score": 0, "last_activity_date": 1528358129, "creation_date": 1528277256, "last_edit_date": 1528289881, "question_id": 50716814, "link": "https://stackoverflow.com/questions/50716814/how-can-i-change-dynamicly-the-file-name-in-the-file-path", "title": "How can I change dynamicly the file name in the file path?", "body": "<p>I want to import multiple TXT files into excel (into the same sheet - every file has only 6 rows). How can I do the files path change in every cycle (I will take it in a for cycle)?</p>\n\n<pre><code>Sub openfile()\n    With ActiveSheet.QueryTables.Add(Connection:= _\n        \"TEXT;C:\\Users\\HarrsionDavid\\Desktop\\\\source\\customer.txt\", _\n        Destination:=Range(\"A1\"))\n        .Name = \"customer.txt\"\n        .FieldNames = True\n        .RowNumbers = False\n        .FillAdjacentFormulas = False\n        .PreserveFormatting = True\n        .RefreshOnFileOpen = False\n        .RefreshStyle = xlInsertDeleteCells\n        .SavePassword = False\n        .SaveData = True\n        .AdjustColumnWidth = True\n        .RefreshPeriod = 0\n        .TextFilePromptOnRefresh = False\n        .TextFilePlatform = 1250\n        .TextFileStartRow = 1\n        .TextFileParseType = xlDelimited\n        .TextFileTextQualifier = xlTextQualifierDoubleQuote\n        .TextFileConsecutiveDelimiter = True\n        .TextFileTabDelimiter = False\n        .TextFileSemicolonDelimiter = False\n        .TextFileCommaDelimiter = False\n        .TextFileSpaceDelimiter = True\n        .TextFileColumnDataTypes = Array(1, 9, 1, 1)\n        .TextFileTrailingMinusNumbers = True\n        .Refresh BackgroundQuery:=False\n    End With\n    Range(\"A1:C3\").Selection\n    Selection.Delete Shift:=x1Up\n    Range(\"A1:C3\").Selection\n    Selection.Delete Shift:=x1Up\nEnd Sub\n</code></pre>\n\n<p>In this question (<a href=\"https://stackoverflow.com/questions/41786126/import-multiple-text-files-into-excel\">Import multiple text files into excel</a>) there is an answer, but I need to change the file name only in the path, because the file names will be get from an other excel column. On Google and Stackoveflow I have no found anything.</p>\n"}, {"tags": ["vba", "excel", "pivot-table"], "comments": [{"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 2, "creation_date": 1528275992, "post_id": 50716291, "comment_id": 88441279, "body": "A quick question - why are you creating a pivot table in a seperate workbook? If anything, that should be a normal table. Pivot tables are supposed to be directly referring to an internal data source"}, {"owner": {"reputation": 103, "user_id": 7262930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nc5Nx.png?s=128&g=1", "display_name": "youssef mhiri", "link": "https://stackoverflow.com/users/7262930/youssef-mhiri"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1528276392, "post_id": 50716291, "comment_id": 88441552, "body": "I want my user to select data file (worksheet) and do all my calculation  in another workbook. It&#39;s more clean."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 1, "creation_date": 1528276492, "post_id": 50716291, "comment_id": 88441627, "body": "I can tell you from my personal coding experience, that it&#39;s not &quot;more clean&quot;. If anything, you are going to cause interconnectivity issues doing this. If you need to showcase data for some basic user editing a simple table (<code>ListObject</code>) will do."}, {"owner": {"reputation": 103, "user_id": 7262930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nc5Nx.png?s=128&g=1", "display_name": "youssef mhiri", "link": "https://stackoverflow.com/users/7262930/youssef-mhiri"}, "reply_to_user": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1528276615, "post_id": 50716291, "comment_id": 88441716, "body": "I want to use pivot table just to make a groupby name list in my rows and then sum values in another column. Is there another way to do it fast without pivot tables?"}], "answers": [{"tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 1, "last_activity_date": 1528278470, "creation_date": 1528278470, "answer_id": 50717259, "question_id": 50716291, "link": "https://stackoverflow.com/questions/50716291/create-a-pivot-table-in-a-new-workbook-from-data-in-another-workbook/50717259#50717259", "title": "Create a pivot table in a new workbook from data in another workbook", "body": "<pre><code>Sub CreatePT()\n\nSet wb = Workbooks.Add 'Create new workbook\nSet ws = wb.Worksheets(1)\npRange = \"[\" &amp; ThisWorkbook.Name &amp; \"]\" &amp; Sheet15.Name &amp; \"!\" &amp; ThisWorkbook.Sheets(15).Range(\"A1\").CurrentRegion.Address(ReferenceStyle:=xlR1C1)\nActiveWorkbook.PivotCaches.Create(xlDatabase, SourceData:=pRange). _\n    CreatePivotTable TableDestination:=\"[\" &amp; wb.Name &amp; \"]\" &amp; ws.Name &amp; \"!R1C1\", TableName:=\"PivotTable4\"\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 7262930, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nc5Nx.png?s=128&g=1", "display_name": "youssef mhiri", "link": "https://stackoverflow.com/users/7262930/youssef-mhiri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2127, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1528641045, "creation_date": 1528275646, "last_edit_date": 1528641045, "question_id": 50716291, "link": "https://stackoverflow.com/questions/50716291/create-a-pivot-table-in-a-new-workbook-from-data-in-another-workbook", "title": "Create a pivot table in a new workbook from data in another workbook", "body": "<p>I want to create a pivot table in a new workbook from data selected in another workbook.</p>\n\n<p>I have tried the code from <a href=\"https://stackoverflow.com/questions/44644002/pivot-cache-in-one-one-workbook-pivot-table-in-another-workbook/50715949\">this answer</a> but I get a reference error \"1004\" in the last line of code.</p>\n\n<pre><code>Sub test()\n    Dim wb As Workbook\n    Dim ws As Worksheet\n    Dim pRange As Range\n    Dim pc As PivotCache\n    Dim pt As PivotTable\n    Dim InitialPivotCache As PivotCache\n    Dim CopyPivotCache As PivotCache\n\n\n    Set wb = Workbooks.Add\n    Set ws = wb.Worksheets(1)\n\n    Set pRange = ThisWorkbook.Sheets(1).Range(\"A1:B6\")\n\n    Set pc = ThisWorkbook.PivotCaches.Create(xlDatabase, pRange) 'Cache in ThisWorkbook\n\n    Call CountCaches\n\n    Set CopyPivotCache = wb.PivotCaches.Create(pc.SourceType, pc.SourceData)\n    Set pt = ws.PivotTables.Add(CopyPivotCache, Range(\"A3\"), \"MyPivotTable\") \n\nEnd Sub\n</code></pre>\n\n<p>I Counted number of caches with this code in my thisworkbook after I have set the \"pc\" cache I found 0 caches.</p>\n\n<pre><code>Sub CountCaches()\n  MsgBox \"There are \" _\n      &amp; ThisWorkbook.PivotCaches.Count _\n      &amp; \" pivot caches in the active workook.\"\nEnd Sub\n</code></pre>\n\n<p>I don't know what's wrong in my code. How can I fix it?</p>\n"}, {"tags": ["ms-access", "vba"], "answers": [{"comments": [{"owner": {"reputation": 832, "user_id": 1176482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c7837deb24bae5b0f96198b03d29ff29?s=128&d=identicon&r=PG", "display_name": "Naz", "link": "https://stackoverflow.com/users/1176482/naz"}, "edited": false, "score": 0, "creation_date": 1528276776, "post_id": 50716456, "comment_id": 88441808, "body": "Although PON is unique, what if someone passes a record with both existent PON and SUI but the PON is not for that SUI. That&#39;s what I want to catch."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 832, "user_id": 1176482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c7837deb24bae5b0f96198b03d29ff29?s=128&d=identicon&r=PG", "display_name": "Naz", "link": "https://stackoverflow.com/users/1176482/naz"}, "edited": false, "score": 0, "creation_date": 1528277984, "post_id": 50716456, "comment_id": 88442665, "body": "I understood what you mean. I believe you should break it down into two parts. 1) Check the order exists 2) if the order exists, validate the SUI."}, {"owner": {"reputation": 832, "user_id": 1176482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c7837deb24bae5b0f96198b03d29ff29?s=128&d=identicon&r=PG", "display_name": "Naz", "link": "https://stackoverflow.com/users/1176482/naz"}, "edited": false, "score": 0, "creation_date": 1528278699, "post_id": 50716456, "comment_id": 88443164, "body": "Is that what you solution is doing?"}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "reply_to_user": {"reputation": 832, "user_id": 1176482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c7837deb24bae5b0f96198b03d29ff29?s=128&d=identicon&r=PG", "display_name": "Naz", "link": "https://stackoverflow.com/users/1176482/naz"}, "edited": false, "score": 0, "creation_date": 1528279630, "post_id": 50716456, "comment_id": 88443790, "body": "No, not really. It returns True only if both PON and SUI supplied exist in table."}], "tags": [], "owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "is_accepted": false, "score": 0, "last_activity_date": 1528276173, "creation_date": 1528276173, "answer_id": 50716456, "question_id": 50715897, "link": "https://stackoverflow.com/questions/50715897/ms-access-if-record-exists-for-person/50716456#50716456", "title": "MS Access If Record Exists for Person", "body": "<p>Not sure I understand your table fields correctly since I presume the Purchase_Order_Number is unique? If that's the case, why do you need the Service_User_ID? </p>\n\n<p>Anyways, try this.</p>\n\n<p>Wrap it in a function to be able to call it from multiple places.</p>\n\n<pre><code>Function OrderExists(ByVal purchaseOrder As String, ByVal personId As Long)\n    OrderExists = DCount(\"Purchase_Order_Number\", \"tblPurchaseOrders\", \"Purchase_Order_Number='\" &amp; purchaseOrder &amp; \"' AND Service_User_ID=\" &amp; personId) &gt; 0\nEnd Function\n</code></pre>\n\n<p>To call it:</p>\n\n<pre><code>Sub T()\n\n    Dim bool As Boolean\n    bool = OrderExists(\"ABCD\", 112)\n\n    Debug.Print bool\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 832, "user_id": 1176482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c7837deb24bae5b0f96198b03d29ff29?s=128&d=identicon&r=PG", "display_name": "Naz", "link": "https://stackoverflow.com/users/1176482/naz"}, "edited": false, "score": 0, "creation_date": 1528278729, "post_id": 50716567, "comment_id": 88443184, "body": "Is this checking that they exists as one record?"}, {"owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "reply_to_user": {"reputation": 832, "user_id": 1176482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c7837deb24bae5b0f96198b03d29ff29?s=128&d=identicon&r=PG", "display_name": "Naz", "link": "https://stackoverflow.com/users/1176482/naz"}, "edited": false, "score": 0, "creation_date": 1528278979, "post_id": 50716567, "comment_id": 88443370, "body": "Yes, that&#39;s it."}], "tags": [], "owner": {"reputation": 43048, "user_id": 3527297, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lyoyg.jpg?s=128&g=1", "display_name": "Gustav", "link": "https://stackoverflow.com/users/3527297/gustav"}, "is_accepted": true, "score": 1, "last_activity_date": 1528276489, "creation_date": 1528276489, "answer_id": 50716567, "question_id": 50715897, "link": "https://stackoverflow.com/questions/50715897/ms-access-if-record-exists-for-person/50716567#50716567", "title": "MS Access If Record Exists for Person", "body": "<p>Just check for <em>Null</em>:</p>\n\n<pre><code>Found = Not IsNull(DLookup(\"Service_User_ID\", \"tblPurchaseOrders\", \"Service_User_ID = \" &amp; .Person_ID &amp; \" And Purchase_Order_Number = '\" &amp; .Purchase_Order &amp; \"'\"))\n</code></pre>\n"}], "owner": {"reputation": 832, "user_id": 1176482, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c7837deb24bae5b0f96198b03d29ff29?s=128&d=identicon&r=PG", "display_name": "Naz", "link": "https://stackoverflow.com/users/1176482/naz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2116, "favorite_count": 0, "accepted_answer_id": 50716567, "answer_count": 2, "score": 0, "last_activity_date": 1528383070, "creation_date": 1528274483, "last_edit_date": 1528383070, "question_id": 50715897, "link": "https://stackoverflow.com/questions/50715897/ms-access-if-record-exists-for-person", "title": "MS Access If Record Exists for Person", "body": "<p>I have the following VBA code that I wanted to use before realising it was not correct;</p>\n\n<pre><code>Len(DLookup(\"Service_User_ID\", \"tblPurchaseOrders\", \"Service_User_ID=\" &amp; .Person_ID) &gt; 0) And IsNull(DLookup(\"Purchase_Order_Number\", \"tblPurchaseOrders\", \"Purchase_Order_Number='\" &amp; .Purchase_Order &amp; \"'\"))\n</code></pre>\n\n<p>What I want the code to do is to check if the <code>Purchase_Order_Number</code> exists for records with that <code>Service_User_ID</code>.</p>\n"}, {"tags": ["vba", "catia"], "comments": [{"owner": {"reputation": 788, "user_id": 997088, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/354c6358174c3e539ca9fe427d25391c?s=128&d=identicon&r=PG", "display_name": "GisMofx", "link": "https://stackoverflow.com/users/997088/gismofx"}, "edited": false, "score": 0, "creation_date": 1528288764, "post_id": 50715873, "comment_id": 88449697, "body": "Just a thought, would you consider just rebuilding the surfaces individually as opposed to using the disassemble command?"}, {"owner": {"reputation": 859, "user_id": 3563563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cb456db94804e2a88e57e5970ac8e60?s=128&d=identicon&r=PG&f=1", "display_name": "gdir", "link": "https://stackoverflow.com/users/3563563/gdir"}, "edited": false, "score": 0, "creation_date": 1528342879, "post_id": 50715873, "comment_id": 88472992, "body": "No, with VBA it&#39;s possible to disassemble surfaces into isolated domains, but it&#39;s not possible to keep the association to the original surface."}], "answers": [{"tags": [], "owner": {"reputation": 81, "user_id": 11406592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7936eee7323219a1e5be7da54ce4089b?s=128&d=identicon&r=PG&f=1", "display_name": "Dewydd", "link": "https://stackoverflow.com/users/11406592/dewydd"}, "is_accepted": true, "score": 0, "last_activity_date": 1556226059, "creation_date": 1556226059, "answer_id": 55857566, "question_id": 50715873, "link": "https://stackoverflow.com/questions/50715873/disassemble-surfaces-in-catia-using-vba/55857566#55857566", "title": "Disassemble surfaces in CATIA using VBA", "body": "<p>I can suggest 2 options, I have already employed both of them in my works in a similar way. None of them will of course be guaranteed to update after input changes, but associativity with existing domains will exist.\nOption 1: </p>\n\n<ol>\n<li>Pick a random face in automation using Search (within topology option in the query string. To get to the right query string, first try it using manual searches with Include Topology option active).\n\n<ol start=\"2\">\n<li>Create two Extract with Point continuity based on this face: one will be the first domain you're looking for, the second will be in Complementary mode and the input for the next step</li>\n<li>Repeat recursively from step 1 until all domains are extracted. Last complementary extract will probably raise an error (manage it with On Error Statement)</li>\n</ol></li>\n</ol>\n\n<p>Option 2: </p>\n\n<ol>\n<li>Disassemble in domains getting dumb surfaces, store them.\n\n<ol start=\"2\">\n<li>Create a point on surface on each of them</li>\n<li>Create many Near, always on the same input surface, using each of the points obtained before.\nIf you don't like keeping relationships with dumb surfaces, insert this step after step 2: read point's coordinates using GetCoordinates method, then create another point by coordinates and use that into the Near. Then delete all dumb surfs and points created on them.\nRegards</li>\n</ol></li>\n</ol>\n"}], "owner": {"reputation": 105, "user_id": 9455965, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Diego Blanco", "link": "https://stackoverflow.com/users/9455965/diego-blanco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 466, "favorite_count": 0, "accepted_answer_id": 55857566, "answer_count": 1, "score": 0, "last_activity_date": 1556226059, "creation_date": 1528274424, "question_id": 50715873, "link": "https://stackoverflow.com/questions/50715873/disassemble-surfaces-in-catia-using-vba", "title": "Disassemble surfaces in CATIA using VBA", "body": "<p>Is there a way to disassemble a surface in domains in CATIA through VBA, maintaining the dependencies between the initial surface and the separated domains?</p>\n"}, {"tags": ["vba", "excel", "pdf", "pdf-generation"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528274065, "post_id": 50715598, "comment_id": 88440111, "body": "You could use the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/pagesetup-zoom-property-excel\" rel=\"nofollow noreferrer\">PageSetup.Zoom Property</a> like <code>Worksheets(&quot;Sheet1&quot;).PageSetup.Zoom = 150</code> to zoom to a fixed value instead of letting Excel fit it. Or use the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/pagesetup-fittopageswide-property-excel\" rel=\"nofollow noreferrer\">PageSetup.FitToPagesWide Property</a> to fit it the width of a page."}, {"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528274100, "post_id": 50715598, "comment_id": 88440126, "body": "Have you checked out the existing questions/answers?  This is a pretty common question."}, {"owner": {"reputation": 102, "user_id": 9754567, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003328662752/picture?type=large", "display_name": "Hamouza", "link": "https://stackoverflow.com/users/9754567/hamouza"}, "edited": false, "score": 0, "creation_date": 1528274155, "post_id": 50715598, "comment_id": 88440163, "body": "Hi Peh, thanks for ur answer. I have the following lines in my Pdf export code: .Zoom = 200 .FitToPagesWide = 1 .FitToPagesTall = 0 But still cant help."}, {"owner": {"reputation": 102, "user_id": 9754567, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003328662752/picture?type=large", "display_name": "Hamouza", "link": "https://stackoverflow.com/users/9754567/hamouza"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528274243, "post_id": 50715598, "comment_id": 88440210, "body": "Hi @ashleedawg, Yes, I&#39;ve been looking for it for hours, The only thing I find is to print multiple sheets to pdf, but not a sheet to multiple pdf pages..  Thanks for ur answer tho"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528274298, "post_id": 50715598, "comment_id": 88440239, "body": "@Hamouza you really mean multiple PDF files or just multiple pages?"}, {"owner": {"reputation": 102, "user_id": 9754567, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003328662752/picture?type=large", "display_name": "Hamouza", "link": "https://stackoverflow.com/users/9754567/hamouza"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528274333, "post_id": 50715598, "comment_id": 88440259, "body": "@P\u1d07\u029c, single pdf but multiple pages"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528274402, "post_id": 50715598, "comment_id": 88440299, "body": "Well, then don&#39;t touching all the <code>.Fit\u2026</code>  and only use <code>.Zoom</code> should work."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528287290, "post_id": 50715598, "comment_id": 88448701, "body": "@Hamouza You can add page breaks. Is that what you want? Have a look at the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-hpagebreaks-property-excel\" rel=\"nofollow noreferrer\">Worksheet.HPageBreaks Property</a> on how to add page breaks after specific rows. \u2022 Otherwise please explain what exactly you mean by <i>&quot;different ranges in multiple pages&quot;</i> this is very unclear."}, {"owner": {"reputation": 6322, "user_id": 1392235, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9c11ab2312c3c59df33b8b9ec0fb2ba2?s=128&d=identicon&r=PG", "display_name": "Davesexcel", "link": "https://stackoverflow.com/users/1392235/davesexcel"}, "edited": false, "score": 0, "creation_date": 1528301206, "post_id": 50715598, "comment_id": 88458104, "body": "From what I understand, the OP is asking for different print areas and page setups on the same sheet, but wants the different pages on the same pdf"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528352380, "post_id": 50715598, "comment_id": 88476061, "body": "Well, different print areas on one worksheet are possible like <code>.PrintArea = &quot;$2:$3,$10:$11,$18:$22&quot;</code> where each area starts a new page."}], "answers": [{"comments": [{"owner": {"reputation": 102, "user_id": 9754567, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003328662752/picture?type=large", "display_name": "Hamouza", "link": "https://stackoverflow.com/users/9754567/hamouza"}, "edited": false, "score": 0, "creation_date": 1528278708, "post_id": 50717187, "comment_id": 88443168, "body": "Thanks for your answer, It&#39;s exactly the code I&#39;m using, but still, It does only print the sheet on multiple pages, but the pages are still hard to read (It&#39;s only a 4 columns sheet)"}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 102, "user_id": 9754567, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003328662752/picture?type=large", "display_name": "Hamouza", "link": "https://stackoverflow.com/users/9754567/hamouza"}, "edited": false, "score": 0, "creation_date": 1528278860, "post_id": 50717187, "comment_id": 88443285, "body": "Can we have just a first row of data to have an idea of the dimension ?"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528279555, "post_id": 50717187, "comment_id": 88443740, "body": "Probably you need to set the print are to  these 4 columns only in addition to the above code: <code>.PrintArea = &quot;$A$A:$D$D&quot;</code>. If that doesn&#39;t help please provide a screenshot of your sheet and the print preview in your original question, so we can see the differences"}, {"owner": {"reputation": 102, "user_id": 9754567, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003328662752/picture?type=large", "display_name": "Hamouza", "link": "https://stackoverflow.com/users/9754567/hamouza"}, "edited": false, "score": 0, "creation_date": 1528286392, "post_id": 50717187, "comment_id": 88448121, "body": "I updated my post, hope it does help making me clear. Thanks you all for giving me a part of your precious time !"}], "tags": [], "owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "is_accepted": true, "score": 0, "last_activity_date": 1528278294, "creation_date": 1528278294, "answer_id": 50717187, "question_id": 50715598, "link": "https://stackoverflow.com/questions/50715598/vba-print-an-excel-sheet-to-multiple-pdf-pages/50717187#50717187", "title": "Vba: Print an Excel sheet to multiple pdf pages", "body": "<p>try to adapt the Orientation and fit the data horizontally, something like this :</p>\n\n<pre><code>With ActiveSheet.PageSetup\n    .PrintTitleRows = \"$1:$1\" 'to repeat your header on each page \n    .CenterHorizontally = True\n    .CenterVertically = True\n    .Orientation = xlLandscape ' or xlPortrait\n    .Zoom = False\n    .FitToPagesWide = 1 'fit to wide only\n    .FitToPagesTall = 0\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 102, "user_id": 9754567, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003328662752/picture?type=large", "display_name": "Hamouza", "link": "https://stackoverflow.com/users/9754567/hamouza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1677, "favorite_count": 0, "accepted_answer_id": 50717187, "answer_count": 1, "score": 1, "last_activity_date": 1528286342, "creation_date": 1528273499, "last_edit_date": 1528286342, "question_id": 50715598, "link": "https://stackoverflow.com/questions/50715598/vba-print-an-excel-sheet-to-multiple-pdf-pages", "title": "Vba: Print an Excel sheet to multiple pdf pages", "body": "<p>I'll try to keep this short. I'm working on a Excel project and I have to print at the end a single sheet, the problem is the printed PDF is too small, so I've looked up for it in different forums and I found out that I had to turn <code>.FitToPagesTall = 0</code> In order that the excel worksheet don't get fit to one pdf page. The problem I'm struggling with now is that even if the pdf pages are bigger than before, It still small and It's making it hard to read. My idea is to print each 30 rows (for example) in a pdf page (Page1 --> Range(\"A1:E30\"), Page2 --> Range(\"A31:E60\").. etc, you got the idea) </p>\n\n<p>Any ideas how I can do that please ? </p>\n\n<p>Thanks in advance !</p>\n\n<p>Update #1: Here's a screen shot of only a slice of my data range\n<a href=\"https://i.stack.imgur.com/YOh0q.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/YOh0q.png\" alt=\"enter image description here\"></a></p>\n\n<p>Even if I set the <code>.PrintArea</code> to A:D, it still give the same result. To rephrase my request: I'm looking for a way to print different ranges in multiple pages.</p>\n\n<p>thanks everyone for giving me a part out of ur time.</p>\n"}, {"tags": ["ms-access", "vba", "ms-access-2010"], "comments": [{"owner": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1528273422, "post_id": 50715503, "comment_id": 88439703, "body": "Strange. Try swapping your <code>.Filter</code> and <code>.FilterOn</code> lines (clearing the filter first). Can you share the code applying the filter?"}, {"owner": {"reputation": 139, "user_id": 9035439, "user_type": "registered", "profile_image": "https://graph.facebook.com/2025223510824531/picture?type=large", "display_name": "Tom&#225;\u0161 Kruli\u0161", "link": "https://stackoverflow.com/users/9035439/tom%c3%a1%c5%a1-kruli%c5%a1"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1528273868, "post_id": 50715503, "comment_id": 88439977, "body": "@ErikvonAsmuth Tryed swapping those two lines, gives same error (only swapping Method for &#39;filter&#39;), again highlighting first row (now the one clearing the filter) while Debuging. I edit the question with used filter code and notify you in comment."}, {"owner": {"reputation": 139, "user_id": 9035439, "user_type": "registered", "profile_image": "https://graph.facebook.com/2025223510824531/picture?type=large", "display_name": "Tom&#225;\u0161 Kruli\u0161", "link": "https://stackoverflow.com/users/9035439/tom%c3%a1%c5%a1-kruli%c5%a1"}, "reply_to_user": {"reputation": 28257, "user_id": 7296893, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6de7cdb4df21e89f2351e7b6cfea4709?s=128&d=identicon&r=PG&f=1", "display_name": "Erik A", "link": "https://stackoverflow.com/users/7296893/erik-a"}, "edited": false, "score": 0, "creation_date": 1528275312, "post_id": 50715503, "comment_id": 88440844, "body": "@ErikvonAsmuth Finished editing"}, {"owner": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1528389455, "post_id": 50715503, "comment_id": 88500112, "body": "Don&#39;t use a filter  on a report embedded on a form, it seems to be very difficult (Impossible) to make work.  Instead add the criteria to your reports underlying recordsource and perform a requery.  I had the same problems and couldn&#39;t get past the issue, I used a combo(s) in the form header as the criteria in the end, And reset the combo&#39;s to clear the filtering."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1528390120, "post_id": 50715503, "comment_id": 88500442, "body": "Is this code in the myForm class file, or in a standard module?"}, {"owner": {"reputation": 139, "user_id": 9035439, "user_type": "registered", "profile_image": "https://graph.facebook.com/2025223510824531/picture?type=large", "display_name": "Tom&#225;\u0161 Kruli\u0161", "link": "https://stackoverflow.com/users/9035439/tom%c3%a1%c5%a1-kruli%c5%a1"}, "reply_to_user": {"reputation": 1595, "user_id": 6847949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/00fc40c71814d3ead488ab90ca84bf76?s=128&d=identicon&r=PG&f=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/6847949/minty"}, "edited": false, "score": 0, "creation_date": 1528459250, "post_id": 50715503, "comment_id": 88527694, "body": "@Minty I actually managed to work around all these issues. I am not removing the filter, instead I am setting the filter SQL to match with criteria for bound-fields, since <i>myReport</i> is bound to <i>myForm</i> through one field.  But another problem emerged, which is that after filtering and removing the filter I cant set another. One of these operations puts <i>myForm</i>,<i>myReport</i> or my <i>filterOptionOne</i> multi-select listbox to constant refresh, which causes repeating unselecting of ItemsSelected.  I might try to create another question for it... But I am almost finished with making this work :D"}, {"owner": {"reputation": 139, "user_id": 9035439, "user_type": "registered", "profile_image": "https://graph.facebook.com/2025223510824531/picture?type=large", "display_name": "Tom&#225;\u0161 Kruli\u0161", "link": "https://stackoverflow.com/users/9035439/tom%c3%a1%c5%a1-kruli%c5%a1"}, "reply_to_user": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "edited": false, "score": 0, "creation_date": 1528459307, "post_id": 50715503, "comment_id": 88527728, "body": "@kismert All the code is in <i>myForm</i> class file, not in standard module. I have no code in standard module."}], "answers": [{"comments": [{"owner": {"reputation": 139, "user_id": 9035439, "user_type": "registered", "profile_image": "https://graph.facebook.com/2025223510824531/picture?type=large", "display_name": "Tom&#225;\u0161 Kruli\u0161", "link": "https://stackoverflow.com/users/9035439/tom%c3%a1%c5%a1-kruli%c5%a1"}, "edited": false, "score": 0, "creation_date": 1528715217, "post_id": 50769074, "comment_id": 88598452, "body": "Thank you for the thorough answer. Code for applyFilterButton works OK, but disabling filter button happens to be issue. Using code you suggested, Access crashes without any Debug option of error message. Only drops to reset program. Do you have any idea what could cause this? i am still considering Mintys reaction to choose different approach whatsoever...."}, {"owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "reply_to_user": {"reputation": 139, "user_id": 9035439, "user_type": "registered", "profile_image": "https://graph.facebook.com/2025223510824531/picture?type=large", "display_name": "Tom&#225;\u0161 Kruli\u0161", "link": "https://stackoverflow.com/users/9035439/tom%c3%a1%c5%a1-kruli%c5%a1"}, "edited": false, "score": 0, "creation_date": 1528742736, "post_id": 50769074, "comment_id": 88614354, "body": "You are doing something that likely can&#39;t be adequately diagnosed using the StackOverflow question/answer format. Too many pieces are left out to even guess at what might be wrong. I would offer to look at the whole application, and debug it myself, but I don&#39;t have the time to do that right now. So I will end my involvement here by saying &quot;good luck&quot;."}, {"owner": {"reputation": 139, "user_id": 9035439, "user_type": "registered", "profile_image": "https://graph.facebook.com/2025223510824531/picture?type=large", "display_name": "Tom&#225;\u0161 Kruli\u0161", "link": "https://stackoverflow.com/users/9035439/tom%c3%a1%c5%a1-kruli%c5%a1"}, "edited": false, "score": 0, "creation_date": 1528814227, "post_id": 50769074, "comment_id": 88644858, "body": "I understand. You already helped me with the recommended coding syntax. I wasnt able to find the source yet and have to put this project on hold. If you would have any suggestion on how to debug whole application it would be most helpfull.  Marking your reaction as answer, since it helped me to understand the topic more, and actually it got me to get rid of the error (eventhough I have gained another :D).  With regards, Tom&#225;\u0161"}], "tags": [], "owner": {"reputation": 1597, "user_id": 4783621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04e6600de9afdbb951f11e7edbb626d0?s=128&d=identicon&r=PG&f=1", "display_name": "kismert", "link": "https://stackoverflow.com/users/4783621/kismert"}, "is_accepted": true, "score": 1, "last_activity_date": 1528498160, "last_edit_date": 1528498160, "creation_date": 1528496432, "answer_id": 50769074, "question_id": 50715503, "link": "https://stackoverflow.com/questions/50715503/run-time-error-2147417848-80010108-when-disabling-filteron-property-of-report/50769074#50769074", "title": "Run time error -2147417848 (80010108) when disabling FilterOn property of Report", "body": "<p>Tom\u00e1\u0161,</p>\n\n<p>Since all of the code in your example is in the <em>myForm</em> class, let me explain some Access coding basics.</p>\n\n<ol>\n<li><p>The <code>[Forms]![Form]![Control]</code> syntax is really intended for Queries, Form &amp; Report events &amp; properties, and Macros. While valid in VBA, there is <em>no</em> compile-time verification of this syntax! So, a VBA line like: </p>\n\n<pre><code>varValue = [Forms]![Blah]![BlahBlah]  ' doesn't exist\n</code></pre>\n\n<p>will compile OK, but fail at runtime. </p></li>\n<li><p>Controls in a form with a class module become public members of the form class. Take your form <em>myForm</em>: you can refer to its controls in code by using:</p>\n\n<pre><code>varValue = Form_myForm.filterOptionOne.Value \n</code></pre>\n\n<p><code>Form_myForm</code> is the name of the form class. This line of code <em>will</em> throw errors if <code>filterOptionOne</code> gets renamed or removed.</p></li>\n<li><p>In any VBA class, <code>Me</code> refers to the public interface of that class. \"Public interface\" simply means all of the public functions, subroutines and properties defined in the class. So, if you were using the line of code above within <em>myForm</em>, the best style would look like this:</p>\n\n<pre><code>varValue = Me.filterOptionOne.Value \n</code></pre>\n\n<p><code>Me</code> in this context constrains <code>filterOptionOne</code> to be actually defined in the class, providing further compile-time checks.</p></li>\n</ol>\n\n<p>So, in light of these three points, I would refactor your code like so:</p>\n\n<pre><code>Private Sub disableFilterButton_Click()\n     Me.myReport.Report.FilterOn = False\n     Me.myReport.Report.Filter = \"\"\n     Me.myReport.Requery\nEnd Sub\n</code></pre>\n\n<p>Likewise: </p>\n\n<pre><code>Private Sub applyFilterButton_Click()\n\n    Dim ctl As Control\n    Dim varVyber As Variant\n    Dim filtrVolba As String\n    Dim filtrUplny As String\n\n    'Criteria creation for filter SQL\n    Set ctl = Me.filterOptionOne\n    If ctl.ItemsSelected.Count &lt;&gt; 0 Then\n        For Each varVyber In ctl.ItemsSelected\n            filtrVolba = filtrVolba &amp; ctl.Column(0, varVyber) &amp; \"\"\" OR (sourceQuery.sourceColumn) = \"\"\"\n        Next varVyber\n\n        filtrVolba = Left$(filtrVolba, Len(filtrVolba) - Len(\" OR (qry_sourceQuery.sourceColumn) = \"))\n        Me.myReport.Report.Filter = \"(((sourceQuery.fieldBoundToMyReport)=\" &amp; Me.TextBoxBoundToMyReport.Value &amp; \") AND ((sourceQuery.filterOptionOneSourceField) = \"\"\" &amp; filtrVolba &amp; \"))\"\n        Me.myReport.Report.FilterOn = True\n    Else\n        MsgBox \"Not yet\"\n    End If\n\nEnd Sub\n</code></pre>\n\n<p>This may not solve all your problems, but this should put you on a much sounder footing for understanding how to code Access forms.</p>\n"}], "owner": {"reputation": 139, "user_id": 9035439, "user_type": "registered", "profile_image": "https://graph.facebook.com/2025223510824531/picture?type=large", "display_name": "Tom&#225;\u0161 Kruli\u0161", "link": "https://stackoverflow.com/users/9035439/tom%c3%a1%c5%a1-kruli%c5%a1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 50769074, "answer_count": 1, "score": 1, "last_activity_date": 1528498160, "creation_date": 1528273214, "last_edit_date": 1528364131, "question_id": 50715503, "link": "https://stackoverflow.com/questions/50715503/run-time-error-2147417848-80010108-when-disabling-filteron-property-of-report", "title": "Run time error -2147417848 (80010108) when disabling FilterOn property of Report", "body": "<p>I am working on creating filtering options of <em>myReport</em> contained in subform container.\nI have used solution described in this question:\n<a href=\"https://stackoverflow.com/questions/35919251/filtering-report\">Filtering Report</a></p>\n\n<p>from HansUp. Using described code filter is succesfully created, stored and applied with OnClick event of apllyFilterButton.</p>\n\n<p>Then I create disableFilterButton and in OnClick event I put code suggested in before mentioned thread. While testing, I get this error:</p>\n\n<p>\"Run-time error '-2147417848 (80010108)':</p>\n\n<p>Method 'FilterOn' of object '_Report_myReport' failed\"</p>\n\n<p>If I enable/disable filter using Access Ribbon (switch-filter button  on/off) everything works fine with no error. So my mistake might be simple, even in syntax, but I cant find the source.</p>\n\n<p>Code:</p>\n\n<pre><code>Private Sub disableFilterButton_Click()\nForms![myForm]![myReport].Report.FilterOn = False\nForms![myForm]![myReport].Report.Filter = \"\"\nForms![myForm]![myReport].Requery\nEnd Sub\n</code></pre>\n\n<p>After crash, using \"Debug\" option, the first row of code above is highlighted. My research here and around net suggested adding the \"blank filter\" row, and also registry problem or an existing loop in code, which creates the crash. But since using Ribbon buttons everything works, I think its something simple that I am missing. I am still an beginner.</p>\n\n<p>Code used in myFilterButton to create filter is not fully completed, but should be working:</p>\n\n<pre><code>Private Sub applyFilterButton_Click()\n\nDim ctl As Control\nDim varVyber As Variant\nDim filtrVolba As String\nDim filtrUplny As String\n\n'Criteria creation for filter SQL\n Set ctl = Forms![myForm]![filterOptionOne]\n If ctl.ItemsSelected.Count &lt;&gt; 0 Then\n    For Each varVyber In ctl.ItemsSelected\n    filtrVolba = filtrVolba &amp; ctl.Column(0, varVyber) &amp; \"\"\" OR (sourceQuery.sourceColumn) = \"\"\"\n    Next varVyber\n\nfiltrVolba = Left$(filtrVolba, Len(filtrVolba) - Len(\" OR (qry_sourceQuery.sourceColumn) = \"))\n    Forms![myForm]![myReport].Report.Filter = \"(((sourceQuery.fieldBoundToMyReport)=[Forms]![myForm]![TextBoxBoundToMyReport]) AND ((sourceQuery.filterOptionOneSourceField) = \"\"\" &amp; filtrVolba &amp; \"))\"\n Forms![myForm]![myReport].Report.FilterOn = True\n\nElse\n\nMsgBox \"Not yet\"\nEnd If\nEnd Sub\n</code></pre>\n\n<p>Help will be much appreciated! Thomas</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "edited": false, "score": 1, "creation_date": 1528271618, "post_id": 50714934, "comment_id": 88438650, "body": "I give you an answer below, but I can see also that you declare &quot;ws&quot; for the worksheet but you set &quot;ps&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1528273448, "post_id": 50714997, "comment_id": 88439715, "body": "Good news is the error is gone, bad news another one popped up. If I run the code (changed the last part into &quot;ws.Range(&quot;A3&quot;).PasteSpecial Format:=&quot;Text&quot;, Link:=False, DisplayAsIcon:= _    False&quot;) it highlights the -Format:=&quot;Text&quot;- part and give Named argument not found"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1528274412, "post_id": 50714997, "comment_id": 88440305, "body": "@perbrethil, that is because Range.PasteSpecial doesn&#39;t have the <i>Format</i> named argument. Only Worksheet.PasteSpecial has that named argument"}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1528274511, "post_id": 50714997, "comment_id": 88440359, "body": "@perbrethil I edited the answer. Format:=&quot;Text&quot; is remplaced by &quot;xlValues&quot;"}], "tags": [], "owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "is_accepted": false, "score": 0, "last_activity_date": 1528274464, "last_edit_date": 1528274464, "creation_date": 1528271482, "answer_id": 50714997, "question_id": 50714934, "link": "https://stackoverflow.com/questions/50714934/vba-troubles-with-removing-select-from-code/50714997#50714997", "title": "VBA Troubles with removing .select from code", "body": "<p>try to declare your workbook : </p>\n\n<pre><code>Dim wb As Workbook\nSet wb = ThisWorkbook\n</code></pre>\n\n<p>and after your worksheet : </p>\n\n<pre><code>Dim ws As Worksheet\nSet ws = wb.Sheets(\"Orders\")\n</code></pre>\n\n<p>and past :</p>\n\n<pre><code>ws.Range(\"a3\").PasteSpecial xlValues\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1681, "user_id": 8564401, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e7431293bb849db6b82d446c3f7236ed?s=128&d=identicon&r=PG&f=1", "display_name": "Pierre44", "link": "https://stackoverflow.com/users/8564401/pierre44"}, "is_accepted": false, "score": 0, "last_activity_date": 1528271941, "creation_date": 1528271941, "answer_id": 50715124, "question_id": 50714934, "link": "https://stackoverflow.com/questions/50714934/vba-troubles-with-removing-select-from-code/50715124#50715124", "title": "VBA Troubles with removing .select from code", "body": "<p>For the first option you forgot the <strong><em>\"\"</em></strong> </p>\n\n<p>This should work:</p>\n\n<pre><code>Worksheets(\"Orders\").Range(\"A3\").PasteSpecial _\nFormat:=\"Text\", Link:=False, DisplayasIcon:=False\n</code></pre>\n\n<p>For the second option change <em>ps</em> in <em>ws</em> as JC Guidicelli said.</p>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1528275006, "post_id": 50715317, "comment_id": 88440650, "body": "You&#39;re right, I did not have the code from where I copied it because there isn&#39;t any. The data is copied from a web page so the data is on the clipboard"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1528275602, "post_id": 50715317, "comment_id": 88441015, "body": "@perbrethil, I see.. I&#39;ve updated my answer. Let me know if that works for you now :)"}, {"owner": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1528276514, "post_id": 50715317, "comment_id": 88441644, "body": "Though this is a more elegant version of my current code (and it works!), my purpose was to remove the .select from my code with the purpose i could run it from another tab in my workbook without the code having to switch tabs back and forth, is this possible?"}, {"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "reply_to_user": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1528277280, "post_id": 50715317, "comment_id": 88442157, "body": "@perbrethil, because you are not specifying where on the worksheet to paste the data when you use Sheet.PasteSpecial you need to specify beforehand by selecting the range. If you don&#39;t mind where the data is pasted then remove the <code>.Select</code>, otherwise you will have to switch tabs I&#39;m afraid."}], "tags": [], "owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "is_accepted": false, "score": 1, "last_activity_date": 1528277781, "last_edit_date": 1528277781, "creation_date": 1528272562, "answer_id": 50715317, "question_id": 50714934, "link": "https://stackoverflow.com/questions/50714934/vba-troubles-with-removing-select-from-code/50715317#50715317", "title": "VBA Troubles with removing .select from code", "body": "<p><strong>Updated</strong> based on comments</p>\n\n<p>As you are pasting from the clipboard directly, not from another range, you will need the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/worksheet-pastespecial-method-excel\" rel=\"nofollow noreferrer\"><code>Worksheet.PasteSpecial</code></a> version, rather than <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-pastespecial-method-excel\" rel=\"nofollow noreferrer\"><code>Range.PasteSpecial</code></a>. </p>\n\n<pre><code>Sub PasteFromClipboard() \n    '\n    'code which loads clipboard\n    '\n    With Worksheets(\"Orders\")\n        .Activate 'activate the worksheet so that you can select a range on this sheet\n        .Range(\"A3\").Select        \n        .PasteSpecial Format:=\"Text\", Link:=False, DisplayasIcon:=False \n    End With   \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11381, "user_id": 2859347, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/00bC9.png?s=128&g=1", "display_name": "CallumDA", "link": "https://stackoverflow.com/users/2859347/callumda"}, "edited": false, "score": 0, "creation_date": 1528291677, "post_id": 50720933, "comment_id": 88451660, "body": "How does this differ, in any meaningful way, to the other answers already given? In fact, if you follow the progression of the question you&#39;ll realise that this solution doesn&#39;t work for OP."}, {"owner": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "edited": false, "score": 0, "creation_date": 1528353608, "post_id": 50720933, "comment_id": 88476677, "body": "You would think that, and yet this works exactly as i intended"}], "tags": [], "owner": {"reputation": 7206, "user_id": 8107092, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dce232725da0108d5e43f3eebcaddd91?s=128&d=identicon&r=PG&f=1", "display_name": "Dy.Lee", "link": "https://stackoverflow.com/users/8107092/dy-lee"}, "is_accepted": true, "score": 1, "last_activity_date": 1528289578, "creation_date": 1528289578, "answer_id": 50720933, "question_id": 50714934, "link": "https://stackoverflow.com/questions/50714934/vba-troubles-with-removing-select-from-code/50720933#50720933", "title": "VBA Troubles with removing .select from code", "body": "<p>Try like this</p>\n\n<pre><code>Dim Ws As Worksheet\nSet Ws = Sheets(\"Orders\")\nWs.Range(\"A3\").PasteSpecial xlPasteAll\n</code></pre>\n"}], "owner": {"reputation": 117, "user_id": 5282448, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/2Uooa.jpg?s=128&g=1", "display_name": "perbrethil", "link": "https://stackoverflow.com/users/5282448/perbrethil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 50720933, "answer_count": 4, "score": 1, "last_activity_date": 1528289578, "creation_date": 1528271299, "last_edit_date": 1528275885, "question_id": 50714934, "link": "https://stackoverflow.com/questions/50714934/vba-troubles-with-removing-select-from-code", "title": "VBA Troubles with removing .select from code", "body": "<p>I have been trying to remove the .Select from my code because I found out recently it's not really an efficient way to do things, but i can't get this piece of code to work.</p>\n\n<p>The data I am pasting comes from another program so it is on the clipboard</p>\n\n<p>My current code(which works):</p>\n\n<pre><code>Range(\"A3:A3\").Select\n        ActiveSheet.PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:= _\n        False\n</code></pre>\n\n<p>I have been trying to fix it in two ways, but both give errors.\nOption 1:</p>\n\n<pre><code>Worksheets(\"Orders\").Range(\"A3\").PasteSpecial _\nFormat:=\"Text\", Link:=False, DisplayasIcon:=False\n</code></pre>\n\n<p>Option 2:</p>\n\n<pre><code>Dim ws As Worksheet\n\nSet ps = Sheets(\"Orders\")\n\nWith ps.Range(\"A3\")\n    .PasteSpecial Format:=\"Text\", Link:=False, DisplayAsIcon:= _\n   False\nEnd With\n</code></pre>\n\n<p>Both give \"application defined or object defined error\" so I'm doing something wrong, i just can't figure out where the wrong part is.</p>\n"}, {"tags": ["sql", "excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 11690, "user_id": 7599798, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WyPLd.png?s=128&g=1", "display_name": "FunThomas", "link": "https://stackoverflow.com/users/7599798/funthomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1528289014, "creation_date": 1528289014, "answer_id": 50720721, "question_id": 50714918, "link": "https://stackoverflow.com/questions/50714918/import-sqlight-database-on-excel/50720721#50720721", "title": "Import SQLight database on Excel", "body": "<p>It seems that, while the data is present in the recordset, the <code>CopyFromRecordset</code> method fails to work. As I have used this method quite a lot against other data sources, I would assume that there is an issue with the ODBC driver.</p>\n\n<p>There are many ways to read the data from a recordset. You can loop over it manually, or you can use the <code>GetRows</code> method to build a 2-dimensional array. This 2-dimensional array has the <em>column</em> as first index and the <em>row</em> as second, both dimensions are 0-based.</p>\n\n<p>The following code uses this method and writes the data into a sheet - only that rows and columns are exchanged. I did a test with <code>Worksheetfunction.Transpose</code> to change this but got a runtime error <code>Type mismatch</code>.</p>\n\n<pre><code>Dim myData\nmyData = rst.GetRows\n\nDim r As Range\nWith ThisWorkbook.Sheets(1)\n    Set r = .Range(.Cells(1, 1), .Cells(UBound(x, 1) + 1, UBound(x, 2) + 1))        \n    r.Value = x\nEnd With\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9899027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d52dda4baf491f4fdfb503312a9301d9?s=128&d=identicon&r=PG", "display_name": "Mocken", "link": "https://stackoverflow.com/users/9899027/mocken"}, "is_accepted": false, "score": 0, "last_activity_date": 1528357092, "creation_date": 1528357092, "answer_id": 50735487, "question_id": 50714918, "link": "https://stackoverflow.com/questions/50714918/import-sqlight-database-on-excel/50735487#50735487", "title": "Import SQLight database on Excel", "body": "<p>Thank you for your answer. I also think that there is an issue with the ODBC driver and the function CopyFromRecordset. I have solved my issue with a loop on each value of the sql database and an Array that I paste in my Excel : </p>\n\n<pre><code>ReDim Contract_Array(nb_row - 1, Nb_col_DB_Contracts - 1)\nFor row_runner = 0 To nb_row - 1\n    For col_runner = 0 To Nb_col_DB_Contracts - 1 \n        Contract_Array(row_runner, col_runner) = rst(col_runner)\n    Next col_runner\n    rst.MoveNext\nNext row_runner\n\nsh_test_sql.Range(\"A1:G2\").Value = Contract_Array\n</code></pre>\n\n<p>Thank you for your help !</p>\n"}], "owner": {"reputation": 1, "user_id": 9899027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d52dda4baf491f4fdfb503312a9301d9?s=128&d=identicon&r=PG", "display_name": "Mocken", "link": "https://stackoverflow.com/users/9899027/mocken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1559726798, "creation_date": 1528271240, "last_edit_date": 1559726798, "question_id": 50714918, "link": "https://stackoverflow.com/questions/50714918/import-sqlight-database-on-excel", "title": "Import SQLight database on Excel", "body": "<p>I'm trying to import data from a SQLight database to EXCEL with vba and here is my code :</p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>Sub Importer_Contrat()\n    Dim conn As Object, rst As Object\n    Dim strSQL As String, table_name As String\n\n    Set conn = CreateObject(\"ADODB.Connection\")\n    Set rst = CreateObject(\"ADODB.Recordset\")\n\n    ' OPEN CONNECTION\n    conn.Open \"DRIVER=SQLite3 ODBC Driver;Database=\" &amp; Chemin_BDD &amp; BDD2 &amp; \";\"\n\n    strSQL = \"SELECT * FROM \" &amp; Contract_Table\n\n    ' OPEN RECORDSET]\n    rst.Open strSQL, conn\n\n    ' OUTPUT TO WORKSHEET\n    sh_test_sql.Range(\"test_paste\").CopyFromRecordset rst\n    rst.Close\nEnd Sub\n</code></pre>\n\n<p>My data data base has only 3 columns (chrono is <code>Integer</code>, Nom is <code>Text</code> and Date is <code>Integer</code>)</p>\n\n<p>The vba works wells when I request an Integer but each time it is asked to import Data from the column Name which is Text and not Integer it doesn't work. </p>\n\n<p>With the code above I just receive the first colum Chrono in Integer. </p>\n\n<p>What is also very strange is that if i use this code : </p>\n\n<pre class=\"lang-vb prettyprint-override\"><code>strSQL = \"SELECT * FROM \" &amp; Contract_Table\n\n' OPEN RECORDSET]\nrst.Open strSQL, conn\n\nDo While Not rst.EOF\n    MsgBox rst(1)\n    rst.MoveNext\nLoop\n</code></pre>\n\n<p>I can see the Text I want to import but it doesn't work with the recorset. Do you know where the problem is coming from ? I need to paste a big table on my Excel sheet and I've been looking the answer for days now. </p>\n\n<p>Thank you in advance !</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 600, "user_id": 8923830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MbJogn0Ac18/AAAAAAAAAAI/AAAAAAAAAGY/Xh76EIIP2vI/photo.jpg?sz=128", "display_name": "Badda_Bing", "link": "https://stackoverflow.com/users/8923830/badda-bing"}, "edited": false, "score": 0, "creation_date": 1528272708, "post_id": 50714849, "comment_id": 88439285, "body": "You say all the excel files should have the same worksheet names. Maybe you can add some validation to an existing loop (For Each/Next, or maybe Do While/Loop) so that if a ws name is not pre-defined ,your code can either ignore it or rename it or something. Something like: &quot;If ws Is Name1 or Name2 or etc.. Then (do something)&quot; or you could use &quot;If Not ws Is Name1 or Name2 or etc Then (do something or exit to go to next)&quot; etc..."}, {"owner": {"reputation": 149, "user_id": 9841498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27aa12062d3d5d420d3053597581f374?s=128&d=identicon&r=PG&f=1", "display_name": "Aneta", "link": "https://stackoverflow.com/users/9841498/aneta"}, "edited": false, "score": 0, "creation_date": 1528275814, "post_id": 50714849, "comment_id": 88441147, "body": "Try to research <code>on error resume next</code> and <code>on error goto 0</code>, but if not used carefully some critical errors can be skipped."}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 1, "creation_date": 1528278082, "post_id": 50714849, "comment_id": 88442741, "body": "Please <a href=\"https://stackoverflow.com/posts/50714849/edit\">edit</a> your question and provide the code you use or add a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>. Otherwise we need to guess what you are doing. Reading <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a> might help to improve your question too."}, {"owner": {"reputation": 71, "user_id": 3381431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376706ab43b787a9a6dacaa2d83feed1?s=128&d=identicon&r=PG&f=1", "display_name": "user3381431", "link": "https://stackoverflow.com/users/3381431/user3381431"}, "edited": false, "score": 0, "creation_date": 1528328379, "post_id": 50714849, "comment_id": 88469855, "body": "thanks I ended up using the application.exceute4macro function to test whether the sheet exists."}], "owner": {"reputation": 71, "user_id": 3381431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/376706ab43b787a9a6dacaa2d83feed1?s=128&d=identicon&r=PG&f=1", "display_name": "user3381431", "link": "https://stackoverflow.com/users/3381431/user3381431"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1528270998, "creation_date": 1528270998, "last_edit_date": 1531164843, "question_id": 50714849, "link": "https://stackoverflow.com/questions/50714849/excel-vba-macro-stopped-by-select-sheet-worksheet-not-found-popup-box", "title": "excel vba macro stopped by select sheet worksheet not found popup box", "body": "<p>I have a macro which creates formula links in cells to many different excel files in a saved directory.</p>\n\n<p>All the excel files should have the same worksheet names but sometimes one will slip through where it doesn't.</p>\n\n<p>As a result this select sheet worksheet not found popup box appears and will halt the macro from continuing unless a user clicks ok or cancel.</p>\n\n<p>I have tried <code>application.displayalerts = false</code> but it doesn't prevent this. Also tried an autoIT script but even this popup box seems to halt the script until a user clicks the mouse somewhere.</p>\n\n<p>Is there a way to stop this pop up box from appearing?</p>\n\n<p><a href=\"https://i.stack.imgur.com/hjdvS.png\" rel=\"nofollow noreferrer\">excel popup box</a></p>\n"}, {"tags": ["vba", "outlook", "userform"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9901579, "user_type": "registered", "profile_image": "https://graph.facebook.com/2061374080571114/picture?type=large", "display_name": "Martijn Wilke", "link": "https://stackoverflow.com/users/9901579/martijn-wilke"}, "edited": false, "score": 1, "creation_date": 1528274851, "post_id": 50715777, "comment_id": 88440556, "body": "Isn&#39;t Worksheet_SelectionChange an excel thing? (It doesnt seem to work in outlook)"}], "tags": [], "owner": {"reputation": 102, "user_id": 9754567, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003328662752/picture?type=large", "display_name": "Hamouza", "link": "https://stackoverflow.com/users/9754567/hamouza"}, "is_accepted": false, "score": 0, "last_activity_date": 1528274079, "creation_date": 1528274079, "answer_id": 50715777, "question_id": 50714484, "link": "https://stackoverflow.com/questions/50714484/adding-userform-to-top-readingpane/50715777#50715777", "title": "Adding userform to top readingpane", "body": "<p>Did you try to go to the macro of worksheet and add this code: </p>\n\n<pre><code>Private Sub Worksheet_SelectionChange(ByVal Target As Range)\n     UserForme1.show\nEnd Sub\n</code></pre>\n\n<p>It will automatically display your userforme when you open the worksheet.</p>\n\n<p>Not sure if this is what you are looking for but I hope i can help.</p>\n"}, {"tags": [], "owner": {"reputation": 56418, "user_id": 332059, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/cSNOK.png?s=128&g=1", "display_name": "Dmitry Streblechenko", "link": "https://stackoverflow.com/users/332059/dmitry-streblechenko"}, "is_accepted": true, "score": 0, "last_activity_date": 1528318304, "creation_date": 1528318304, "answer_id": 50729411, "question_id": 50714484, "link": "https://stackoverflow.com/questions/50714484/adding-userform-to-top-readingpane/50729411#50729411", "title": "Adding userform to top readingpane", "body": "<p>You can create a task pane, where you can put any controls. See <a href=\"https://msdn.microsoft.com/en-us/library/office/aa338197(v=office.12).aspx\" rel=\"nofollow noreferrer\">https://msdn.microsoft.com/en-us/library/office/aa338197(v=office.12).aspx</a> for more details.</p>\n"}], "owner": {"reputation": 13, "user_id": 9901579, "user_type": "registered", "profile_image": "https://graph.facebook.com/2061374080571114/picture?type=large", "display_name": "Martijn Wilke", "link": "https://stackoverflow.com/users/9901579/martijn-wilke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 50729411, "answer_count": 2, "score": 1, "last_activity_date": 1592986472, "creation_date": 1528269794, "last_edit_date": 1592986472, "question_id": 50714484, "link": "https://stackoverflow.com/questions/50714484/adding-userform-to-top-readingpane", "title": "Adding userform to top readingpane", "body": "<p>Let me begin by saying i am no expert in VBA what so ever. I tinker around with it since yesterday...</p>\n\n<p>Our company recently switched to Office 2016, Yay!\nThe only issue we have is that we cant directly modify subjects from the reading pane in outlook anymore. (We store handler data there)</p>\n\n<p>This can be resolved by eighter opening the whole email, expanding the headers and editing the subject...</p>\n\n<p>This is tiresome, so i've made a VBA script to edit the headers instead. \nIt works fine when i input it as a macro on the ribbon but it misses a certain feature. </p>\n\n<p>I've created an userform that allows the user to fill in his employee number and input his remarks.\nHere's the issue; i need the userform to always display near the email, preferribly on top of the reading pane. </p>\n\n<p>If i put it in the ribbon the userform will display (on click) but that requires three button presses instead of just one.</p>\n\n<p>I've seen this kind of system before, so i know its possible. I just have no clue how.</p>\n\n<p>tl;dr\nHow do i add a userform to the position(s) located in the image.</p>\n\n<p>Edit1: Extra info: \nI know how to call the UserForm. I want to hook it on the locations stated on the picture. (On load with outlook, as an \"extra menu\" ~ ish</p>\n\n<p><a href=\"https://i.stack.imgur.com/doFhN.png\" rel=\"nofollow noreferrer\">Outlook location / userform</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/gQ2K7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/gQ2K7.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["vba", "radio-button"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528345348, "post_id": 50714426, "comment_id": 88473557, "body": "where is the html for the radio button? what site is this?"}, {"owner": {"reputation": 1, "user_id": 9899746, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4fgn3o0714Q/AAAAAAAAAAI/AAAAAAAAADU/t2JUxu3HYAE/photo.jpg?sz=128", "display_name": "Octavien", "link": "https://stackoverflow.com/users/9899746/octavien"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528352343, "post_id": 50714426, "comment_id": 88476047, "body": "i have given the html for the page already. Please check"}], "answers": [{"comments": [{"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9899746, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4fgn3o0714Q/AAAAAAAAAAI/AAAAAAAAADU/t2JUxu3HYAE/photo.jpg?sz=128", "display_name": "Octavien", "link": "https://stackoverflow.com/users/9899746/octavien"}, "edited": false, "score": 0, "creation_date": 1528636549, "post_id": 50715588, "comment_id": 88574568, "body": "What message did you get?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9899746, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4fgn3o0714Q/AAAAAAAAAAI/AAAAAAAAADU/t2JUxu3HYAE/photo.jpg?sz=128", "display_name": "Octavien", "link": "https://stackoverflow.com/users/9899746/octavien"}, "edited": false, "score": 0, "creation_date": 1528637739, "post_id": 50715588, "comment_id": 88574907, "body": "And is this an internal URL?"}, {"owner": {"reputation": 1, "user_id": 9899746, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4fgn3o0714Q/AAAAAAAAAAI/AAAAAAAAADU/t2JUxu3HYAE/photo.jpg?sz=128", "display_name": "Octavien", "link": "https://stackoverflow.com/users/9899746/octavien"}, "edited": false, "score": 0, "creation_date": 1528786312, "post_id": 50715588, "comment_id": 88627109, "body": "Let me be clear. The first code enters a data and clicks submit. After submitting it moves on to next page that is where the radio button exists.   I think it needs a code that understands that it should find the radio button in the current page rather than searching in old page. Help me in this."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9899746, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4fgn3o0714Q/AAAAAAAAAAI/AAAAAAAAADU/t2JUxu3HYAE/photo.jpg?sz=128", "display_name": "Octavien", "link": "https://stackoverflow.com/users/9899746/octavien"}, "edited": false, "score": 0, "creation_date": 1528787807, "post_id": 50715588, "comment_id": 88627930, "body": "I added further info in notes section."}, {"owner": {"reputation": 1, "user_id": 9899746, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4fgn3o0714Q/AAAAAAAAAAI/AAAAAAAAADU/t2JUxu3HYAE/photo.jpg?sz=128", "display_name": "Octavien", "link": "https://stackoverflow.com/users/9899746/octavien"}, "edited": false, "score": 0, "creation_date": 1528831818, "post_id": 50715588, "comment_id": 88653968, "body": "I am getting object doesnt support this property error for this code                           &quot;&quot;&quot; ie.document.querySelector (&quot;input[type=&quot;&quot;radio&quot;&quot;]&quot;)&quot;&quot;&quot;"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9899746, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4fgn3o0714Q/AAAAAAAAAAI/AAAAAAAAADU/t2JUxu3HYAE/photo.jpg?sz=128", "display_name": "Octavien", "link": "https://stackoverflow.com/users/9899746/octavien"}, "edited": false, "score": 0, "creation_date": 1528831882, "post_id": 50715588, "comment_id": 88654001, "body": "Are you on IE 9 or above though I think that may only apply to .querySelectorAll ?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9899746, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4fgn3o0714Q/AAAAAAAAAAI/AAAAAAAAADU/t2JUxu3HYAE/photo.jpg?sz=128", "display_name": "Octavien", "link": "https://stackoverflow.com/users/9899746/octavien"}, "edited": false, "score": 0, "creation_date": 1529754659, "post_id": 50715588, "comment_id": 88995511, "body": "you could loop the input tags otherwise"}, {"owner": {"reputation": 1, "user_id": 9899746, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4fgn3o0714Q/AAAAAAAAAAI/AAAAAAAAADU/t2JUxu3HYAE/photo.jpg?sz=128", "display_name": "Octavien", "link": "https://stackoverflow.com/users/9899746/octavien"}, "edited": false, "score": 0, "creation_date": 1529949398, "post_id": 50715588, "comment_id": 89050966, "body": "Please give me a example. i am new at this"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "reply_to_user": {"reputation": 1, "user_id": 9899746, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4fgn3o0714Q/AAAAAAAAAAI/AAAAAAAAADU/t2JUxu3HYAE/photo.jpg?sz=128", "display_name": "Octavien", "link": "https://stackoverflow.com/users/9899746/octavien"}, "edited": false, "score": 0, "creation_date": 1529950361, "post_id": 50715588, "comment_id": 89051416, "body": "Example given above."}], "tags": [], "owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "is_accepted": false, "score": 1, "last_activity_date": 1529950352, "last_edit_date": 1529950352, "creation_date": 1528273469, "answer_id": 50715588, "question_id": 50714426, "link": "https://stackoverflow.com/questions/50714426/unable-to-select-radiobutton-in-website-using-vba/50715588#50715588", "title": "Unable to select Radiobutton in website using VBA", "body": "<p>You could try using a CSS selector</p>\n\n<pre><code>ie.document.querySelector(\"input[type=\"\"radio\"\"]\").Click\n</code></pre>\n\n<hr>\n\n<p>CSS selector tested using HTML supplied:</p>\n\n<p><a href=\"https://i.stack.imgur.com/BRCij.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BRCij.png\" alt=\"CSS query\"></a></p>\n\n<p>More about CSS selectors here:  <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors\" rel=\"nofollow noreferrer\">CSS Selectors</a> </p>\n\n<hr>\n\n<p><strong>Notes:</strong></p>\n\n<p>If the page is being refreshed, due to a prior click, then you may need, after that click, to introduce a wait:</p>\n\n<pre><code>Application.Wait Now + TimeSerial(0,0,3)\nie.document.querySelector(\"input[type=\"\"radio\"\"]\").Click    \n</code></pre>\n\n<p>or,  </p>\n\n<pre><code>While .Busy = True Or .readyState &lt; 4: DoEvents: Wend  \nie.document.querySelector(\"input[type=\"\"radio\"\"]\").Click    \n</code></pre>\n\n<p>A combination of the above or even a loop, with a timeout, attempting to set the element for clicking:</p>\n\n<pre><code>Dim a As Object, exitTime As Date\nexitTime = Now + TimeSerial(0, 0, 5)\n\nDo\n    DoEvents\n    On Error Resume Next\n    Set a = IE.document.querySelector(\"input[type=\"\"radio\"\"]\")\n    On Error GoTo 0\n    If Now &gt; exitTime Then Exit Do\nLoop While a Is Nothing\n\na.Click\n</code></pre>\n\n<p>If a new window if opened then you will need to look for that window's handle potentially, or the window with the highest count (most recent). There are methodss on SO detailing this.</p>\n\n<p>Here is an example of looping input tags looking for one with a <code>type</code> attribute  of <code>radio</code>. This depends on whether you have more than one as to whether it clicks the right one, but gives you an idea.</p>\n\n<pre><code>Option Explicit\nPublic Sub test()\n    Dim n As HTMLDocument\n    Set n = New HTMLDocument\n    n.body.innerHTML = [A1]  '&lt;== your sample of HTML place in a cell\n\n    Dim aList As Object, item As Object\n    Set aList = n.getElementsByTagName(\"input\")\n    For Each item In aList\n        On Error Resume Next\n        If InStr(item.getAttribute(\"type\").innerText, \"radio\", 1) &gt; 0 Then\n            Debug.Print item.outerHTML\n            item.Click\n            Exit For\n        End If\n        On Error GoTo 0\n    Next item\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9899746, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4fgn3o0714Q/AAAAAAAAAAI/AAAAAAAAADU/t2JUxu3HYAE/photo.jpg?sz=128", "display_name": "Octavien", "link": "https://stackoverflow.com/users/9899746/octavien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1530257497, "creation_date": 1528269635, "last_edit_date": 1530257497, "question_id": 50714426, "link": "https://stackoverflow.com/questions/50714426/unable-to-select-radiobutton-in-website-using-vba", "title": "Unable to select Radiobutton in website using VBA", "body": "<p>Here is the code I am using:</p>\n\n<pre><code>Sub Websitedata()\n    Dim ie As Object\n    Dim myURL As String\n    myURL = \"FIRST PAGE\"\n\n    Set ie = New InternetExplorerMedium\n    ie.Visible = True\n    ie.navigate myURL\n\n    Do While ie.readyState &lt;&gt; 4 And ie.Busy\n        DoEvents\n    Loop\n\n    'Selects a type from a dropdown bar\n    ie.document.forms(\"actionForm\").elements(\"dropdownbar\").Value = \"311\"\n    'Inputs data\n    ie.document.forms(\"actionForm\").elements(\"inputbox1\").Value = \"\"\n    'Inputs data\n    ie.document.forms(\"actionForm\").elements(\"inputbox2\").Value = \"\"\n    'Inputs data\n    ie.document.forms(\"actionForm\").elements(\"inputbox3\").Value = \"\"\n    'Inputs data\n    ie.document.forms(\"actionForm\").elements(\"inputbox4\").Value = \"\"\n    'Inputs data\n    ie.document.forms(\"actionForm\").elements(\"inputbox5\").Value = \"\"\n    'Pressed submit and goes to next page.\n    ie.document.forms(\"actionForm\").elements(\"_eventId_Search\").Click\n    'Needs to press a radiobutton.\n    ie.document.getElementByName(\"declarationId\").Click\nEnd Sub\n</code></pre>\n\n<p>I am having issue clicking the radio button. Tried checked, click, value everything.</p>\n\n<p>Here is the HTML of the page:</p>\n\n<pre><code>&lt;TABLE id=declarationList class=\"list sortable\" cellSpacing=0 cellPadding=0 width=\"100%\"&gt;&lt;TBODY&gt;\n&lt;TR class=header&gt;\n    &lt;TH style=\"TEXT-ALIGN: center\" align=center&gt;&lt;/TH&gt;\n    &lt;TH&gt;&lt;A onclick=\"ts_resortTable(this);return false;\" class=sortheader href=\"\"&gt;Type&lt;SPAN class=sortarrow sortdir=\"down\"&gt;&amp;nbsp;&amp;nbsp;?&lt;/SPAN&gt;&lt;/A&gt;&lt;/TH&gt;\n    &lt;TH&gt;&lt;A onclick=\"ts_resortTable(this);return false;\" class=sortheader href=\"\"&gt;rts&lt;SPAN class=sortarrow&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/SPAN&gt;&lt;/A&gt;&lt;/TH&gt;\n    &lt;TH&gt;&lt;A onclick=\"ts_resortTable(this);return false;\" class=sortheader href=\"\"&gt;tyi&lt;SPAN class=sortarrow&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/SPAN&gt;&lt;/A&gt;&lt;/TH&gt;\n    &lt;TH&gt;&lt;A onclick=\"ts_resortTable(this);return false;\" class=sortheader href=\"\"&gt;trtjm&lt;SPAN class=sortarrow&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/SPAN&gt;&lt;/A&gt;&lt;/TH&gt;\n    &lt;TH&gt;&lt;A onclick=\"ts_resortTable(this);return false;\" class=sortheader href=\"\"&gt;erch&lt;SPAN class=sortarrow&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/SPAN&gt;&lt;/A&gt;&lt;/TH&gt;\n    &lt;TH&gt;&lt;A onclick=\"ts_resortTable(this);return false;\" class=sortheader href=\"\"&gt;dft&lt;SPAN class=sortarrow&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&lt;/SPAN&gt;&lt;/A&gt;&lt;/TH&gt;\n&lt;/TR&gt;\n&lt;TR class=evenRow&gt;\n    &lt;TD style=\"TEXT-ALIGN: center\" align=center&gt;&lt;INPUT onclick=\"updateButtons('Import','GF','79295876',false,'null',false,true,true,false,false,false)\" type=radio value=79295876 name=declarationId&gt; &lt;/TD&gt;\n    &lt;TD&gt;IM A &lt;/TD&gt;\n    &lt;TD&gt;4561548 &lt;/TD&gt;\n    &lt;TD&gt;29/03/2018 &lt;/TD&gt;\n    &lt;TD&gt;32856 &lt;/TD&gt;\n    &lt;TD&gt;0313 &lt;/TD&gt;\n    &lt;TD&gt;40 00 , 40 00 &lt;/TD&gt;\n&lt;/TR&gt;\n&lt;/TBODY&gt;&lt;/TABLE&gt;\n</code></pre>\n\n<p>I need it to select the radio button which appears in the next page. Do I have to change some kind of data in the top? Please let me know. I am confused. </p>\n\n<p>Update- Still no answer for this query. Please help </p>\n"}, {"tags": ["excel", "userform", "vba"], "comments": [{"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528272522, "post_id": 50714209, "comment_id": 88439190, "body": "I wonder why this got down-voted. Sounds like a legit question to me, has an example and has to do with programming."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "reply_to_user": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "edited": false, "score": 0, "creation_date": 1528273250, "post_id": 50714209, "comment_id": 88439602, "body": "@P\u1d07\u029c It&#39;s difficult to find what is really appropriate to post over here. Although if I can get some progress it&#39;s all that matters to me despite getting downvotes. I try my best not to spam though. I google first then try to search it here"}], "answers": [{"comments": [{"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1528272904, "post_id": 50715190, "comment_id": 88439399, "body": "Thanks. I tried it out and noticed it doesn&#39;t auto-complete anymore. So I guess that&#39;s the trade off. I&#39;ll just probably make it all caps lock so that there won&#39;t be a problem"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1528272938, "post_id": 50715190, "comment_id": 88439412, "body": "@MarcSantos Alternatively use a TextBox to enter and add the new entry as a trade-off."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1528273391, "post_id": 50715190, "comment_id": 88439682, "body": "Although the code in the combobox will detect if the item is not in the listbox, then if it isn&#39;t it should add it. Having an auto-complete is good so the user won&#39;t duplicate entries. It&#39;s shown in the photo I added above"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1528273739, "post_id": 50715190, "comment_id": 88439907, "body": "Well, you can sort out duplicates by letting your code check that before you perform the add. Personally I would add a small button behind the ComboBox triggering an InputBox to add a new entry. This would leave the ComboBox a simple select only box and the user cannot accidentally add new entries. He has to explicitly decide to add one by the button."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1528273982, "post_id": 50715190, "comment_id": 88440060, "body": "I put a <code>Msgbox</code> with a <code>vbQuestion+vbYesNo</code> Then make an <code>If-Then</code> statement to ask for clarification to minimize accidents. Also, sometimes there are many variations of a certain entry such as <code>Communication, Lights, and Water</code> or <code>Communication, Light, and Water</code> and I want the user to see that it already exists because the sorting may probably be bypassed if i&#39;m not mistaken"}, {"owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "reply_to_user": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1528274447, "post_id": 50715190, "comment_id": 88440323, "body": "@MarcSantos I understand your concerns but I suspect there is no perfect solution."}, {"owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "edited": false, "score": 0, "creation_date": 1528274539, "post_id": 50715190, "comment_id": 88440375, "body": "It&#39;s good to know you can disable to auto complete feature though. I&#39;ll just workaround it by making all capitalized. The users always have caps lock on anyway"}], "tags": [], "owner": {"reputation": 44454, "user_id": 3219613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01a7cc73ab19f844bdbcd951876ecb5?s=128&d=identicon&r=PG", "display_name": "P\u1d07\u029c", "link": "https://stackoverflow.com/users/3219613/p%e1%b4%87%ca%9c"}, "is_accepted": true, "score": 1, "last_activity_date": 1528272911, "last_edit_date": 1528272911, "creation_date": 1528272157, "answer_id": 50715190, "question_id": 50714209, "link": "https://stackoverflow.com/questions/50714209/how-to-prevent-the-auto-complete-of-a-userform-combobox/50715190#50715190", "title": "How to prevent the auto complete of a UserForm ComboBox?", "body": "<p>I think the only way to prevent this is to disable matching of the entries.\nTherefore you need to set the <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/matchentry-property\" rel=\"nofollow noreferrer\">MatchEntry Property</a> of the ComboBox.</p>\n\n<p>In the <em>Properties</em> window change the <code>MatchEntry</code> property to <code>2</code> - <code>fmMatchEntryNone</code>.</p>\n\n<p>Alternatively you can use a TextBox to add a new entry into the ComboBox.</p>\n"}], "owner": {"reputation": 1035, "user_id": 8393101, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/aMexg.jpg?s=128&g=1", "display_name": "Pherdindy", "link": "https://stackoverflow.com/users/8393101/pherdindy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 50715190, "answer_count": 1, "score": -1, "last_activity_date": 1528273109, "creation_date": 1528268934, "last_edit_date": 1531161705, "question_id": 50714209, "link": "https://stackoverflow.com/questions/50714209/how-to-prevent-the-auto-complete-of-a-userform-combobox", "title": "How to prevent the auto complete of a UserForm ComboBox?", "body": "<p>When I'm typing in a ComboBox in an Excel UserForm, for example I have a list item called <code>SHEEP</code> (all uppercase), then if I want to add another item called <code>Shear</code> (only the first letter is uppercase), the program will force it to look like this: <code>SHEar</code></p>\n\n<p>I do not want to disable the auto completing feature though, just not overwrite the upper/lower case typed by the keyboard.</p>\n\n<p>The combo books is as shown below:\n<a href=\"https://i.stack.imgur.com/K4EB0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/K4EB0.png\" alt=\"Userform\"></a></p>\n"}, {"tags": ["excel", "inputbox", "vba"], "comments": [{"owner": {"reputation": 2077, "user_id": 630535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dead23c2ab3ad4cd3b418fc6d33ec233?s=128&d=identicon&r=PG", "display_name": "nabuchodonossor", "link": "https://stackoverflow.com/users/630535/nabuchodonossor"}, "edited": false, "score": 1, "creation_date": 1528267639, "post_id": 50713732, "comment_id": 88436313, "body": "You have to write your own &quot;Inputbox&quot; with a timer (just bild a form). But consider: It may last longer than your timeout, if someone is slow on entering data. so reset the timeout each time a key is pressed."}, {"owner": {"reputation": 790, "user_id": 4207883, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZKFKq.jpg?s=128&g=1", "display_name": "Shivani Katukota", "link": "https://stackoverflow.com/users/4207883/shivani-katukota"}, "edited": false, "score": 0, "creation_date": 1528267875, "post_id": 50713732, "comment_id": 88436459, "body": "have you tried something?"}], "answers": [{"tags": [], "owner": {"reputation": 1634, "user_id": 3468925, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/W8Z2v.jpg?s=128&g=1", "display_name": "avb", "link": "https://stackoverflow.com/users/3468925/avb"}, "is_accepted": false, "score": 0, "last_activity_date": 1528268286, "creation_date": 1528268286, "answer_id": 50714040, "question_id": 50713732, "link": "https://stackoverflow.com/questions/50713732/visual-basic-inputbox-wait-time/50714040#50714040", "title": "Visual Basic InputBox Wait time", "body": "<p>In your form code:</p>\n\n<pre><code>Private Sub UserForm_Activate()\n    Application.OnTime Now + TimeValue(\"00:00:10\"), \"closeIfNoValueEntered\"\nEnd Sub\n</code></pre>\n\n<p>closing procedure:</p>\n\n<pre><code>Sub closeIfNoValueEntered()\n    If UserForm1.TextBox1.Text = \"\" Then Unload UserForm1\nEnd Sub\n</code></pre>\n\n<p>this procedure must be placed in a separate module, not in userform module .</p>\n"}], "owner": {"reputation": 1, "user_id": 9243609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d722d0b0b8697d88b40f046163fcf63?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/9243609/rajesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 437, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1528268286, "creation_date": 1528267153, "last_edit_date": 1531164843, "question_id": 50713732, "link": "https://stackoverflow.com/questions/50713732/visual-basic-inputbox-wait-time", "title": "Visual Basic InputBox Wait time", "body": "<p>Is it possible to Program in VB so that program wait for 10 seconds for user input? If no input entered, Program process with default value after 10 seconds. If yes, then how to program.</p>\n"}, {"tags": ["excel", "vba", "combobox"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1528269399, "post_id": 50713555, "comment_id": 88437381, "body": "<code>Range(&quot;E2&quot;)</code> and <code>Range(&quot;E1048576&quot;)</code> are linked to the active sheet, not to <code>Worksheets(&quot;DataCMB&quot;)</code>"}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1528269565, "post_id": 50713555, "comment_id": 88437491, "body": "in <code>Set Division = ...</code>, <code>Division</code> is not a named range, it is a <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/range-object-excel\" rel=\"nofollow noreferrer\">Range</a> variable."}, {"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1528269655, "post_id": 50713555, "comment_id": 88437554, "body": "If you want to modify a named range in vba, look for the <a href=\"https://msdn.microsoft.com/en-us/vba/excel-vba/articles/names-object-excel\" rel=\"nofollow noreferrer\">Names</a> collection"}], "answers": [{"comments": [{"owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "edited": false, "score": 0, "creation_date": 1528268508, "post_id": 50713996, "comment_id": 88436877, "body": "If want to use vba try change to                                                        Division=Worksheets(&quot;DataCMB&quot;).Range(Range(&quot;E2&quot;), Range(&quot;E1048576&quot;).End(xlUp)).address"}, {"owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1528269743, "post_id": 50713996, "comment_id": 88437590, "body": "Thanks for answer. But when I used table as you said I got debug message."}, {"owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "reply_to_user": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1528270246, "post_id": 50713996, "comment_id": 88437873, "body": "Private Sub UserForm_Initialize()           Division = Range(Range(&quot;A2&quot;), Range(&quot;A2&quot;).End(xlDown)).Address           Me.ComboBox1.RowSource = Division         End Sub"}], "tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 1, "last_activity_date": 1528268118, "creation_date": 1528268118, "answer_id": 50713996, "question_id": 50713555, "link": "https://stackoverflow.com/questions/50713555/creating-dynamic-range-for-vba-combobox/50713996#50713996", "title": "Creating dynamic range for VBA Combobox", "body": "<p>You can insert your A2:A61 as table and define as \"Division\" name. So when you add new data, new data will auto include into \"Division\"name.</p>\n"}, {"comments": [{"owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "edited": false, "score": 0, "creation_date": 1528270437, "post_id": 50714667, "comment_id": 88437992, "body": "Are you using code similar to this? I not facing error with the code."}, {"owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "edited": false, "score": 0, "creation_date": 1528270516, "post_id": 50714667, "comment_id": 88438031, "body": "Alternatively, you can insert table to your data and define name as &quot;Division&quot;. It will auto include new data into your &quot;Division&quot; name."}], "tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 0, "last_activity_date": 1528270386, "creation_date": 1528270386, "answer_id": 50714667, "question_id": 50713555, "link": "https://stackoverflow.com/questions/50713555/creating-dynamic-range-for-vba-combobox/50714667#50714667", "title": "Creating dynamic range for VBA Combobox", "body": "<pre><code>Private Sub UserForm_Initialize()\n  Division = Range(Range(\"A2\"), Range(\"A2\").End(xlDown)).Address\n  Me.ComboBox1.RowSource = Division\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "edited": false, "score": 0, "creation_date": 1528276251, "post_id": 50716178, "comment_id": 88441440, "body": "Daniel, Thanks. These advises fixed error happening when I stand on not DataCMB sheet."}], "tags": [], "owner": {"reputation": 131, "user_id": 8512734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58acdfd72aa886283741ad4b4912cbf6?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Bailey", "link": "https://stackoverflow.com/users/8512734/daniel-bailey"}, "is_accepted": false, "score": 1, "last_activity_date": 1528275342, "creation_date": 1528275342, "answer_id": 50716178, "question_id": 50713555, "link": "https://stackoverflow.com/questions/50713555/creating-dynamic-range-for-vba-combobox/50716178#50716178", "title": "Creating dynamic range for VBA Combobox", "body": "<p>The first problem you have, and some of the other answers here have, is that you are not telling your 2nd and 3rd Range calls which sheet they should reference, so in the line below you can see I have added Worksheets(\"DataCMB\") in front of them. Without that it will use the ActiveSheet which may not be set to DataCMB, so it will be looking for a range that is on a different sheet, and not find it.</p>\n\n<p>The other problem was that your .End(xlUp) was working from a single cell and not a range, so I have changed it to look at the whole column and to look down instead of up. So the line below will give you the whole range of whatever is in that column, but will not include any blanks at the bottom, nor the header.</p>\n\n<pre><code>Set Division = Worksheets(\"DataCMB\").Range(Worksheets(\"DataCMB\").Range(\"E2\"), Worksheets(\"DataCMB\").Range(\"E2:E1048576\").End(xlDown))\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 8505098, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c0fef8d3bc3416d1f92817b306ea3d1?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar", "link": "https://stackoverflow.com/users/8505098/khazar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1514, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1528275342, "creation_date": 1528266552, "question_id": 50713555, "link": "https://stackoverflow.com/questions/50713555/creating-dynamic-range-for-vba-combobox", "title": "Creating dynamic range for VBA Combobox", "body": "<p>Currently I am making user form on Excel VBA and using combobox.\nI have range(A2:A61) named \"Division\" in which was included divisions of company.\nWhen I add this data into combo row source, I put named range - Division.\nBut on the other hand divisions are dynamic, I mean new divisions are created during the year.</p>\n\n<p>The problem is when I created new division I can see its name on Cell A62 but it doesn't include range - named division. As the result I can't see updated combobox list.</p>\n\n<p>Firstly I tried to choose range as (A:A) and called it division. In this case I can see updated combobox list but the blank cells within range makes other problems for me.</p>\n\n<p>Secondly I had this code and I tried to use it as Row Source for combobox but came out error.</p>\n\n<pre><code>Set Division = Worksheets(\"DataCMB\").Range(Range(\"E2\"), Range(\"E1048576\").End(xlUp))\n</code></pre>\n\n<p>Please, help to find out the issue.</p>\n"}, {"tags": ["excel", "vba", "search"], "comments": [{"owner": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 2, "creation_date": 1528266793, "post_id": 50713510, "comment_id": 88435904, "body": "&quot;someone did not manage to find anything on Google&quot; and indeed someone is now asking someone to do their work for them. This is really a site to help fix or upgrade code, not to create it from scratch, that would be a job. Saying that, I would say your query while possible to do, is ultimately incorrect, the folder could have &#39;File.jpg&#39;, &#39;File.ai&#39;, &#39;File.doc&#39;, &#39;File.xlsx&#39; and all would be valid hits but could return a false positive if you don&#39;t know the extension you are looking for i.e. &#39;File.png&#39;. A file called &#39;File&#39; exists so would return true, but no file called &#39;File.png&#39; is there."}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1528266934, "post_id": 50713510, "comment_id": 88435973, "body": "autocorrect: somehow, not someone. my idea is to manipulate the string at the for each file in folder part in a way that from the right I remove everything until the first &#39;.&#39; and then everything after a &#39;\\&#39; appears."}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "reply_to_user": {"reputation": 1782, "user_id": 6299399, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/555bacb911dbaa9810ed4e546a3a7ef2?s=128&d=identicon&r=PG", "display_name": "Gary Evans", "link": "https://stackoverflow.com/users/6299399/gary-evans"}, "edited": false, "score": 0, "creation_date": 1528267147, "post_id": 50713510, "comment_id": 88436079, "body": "regarding your concern with different extensions. there only one filename with an unknown extension, but not more than 1"}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1528267790, "post_id": 50713510, "comment_id": 88436401, "body": "@smartini, I am pretty sure my code works. I didn&#39;t know what you wanted to do if you found it, but this answers your question."}], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "edited": false, "score": 0, "creation_date": 1528273279, "post_id": 50713859, "comment_id": 88439614, "body": "thanks. this InStr search will also find files named &quot;test13&quot;, but I search for &quot;test1&quot; e.g."}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "edited": false, "score": 1, "creation_date": 1528274850, "post_id": 50713859, "comment_id": 88440555, "body": "your code works as well, thanks for your update effort. user can use both codes now."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "reply_to_user": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "edited": false, "score": 0, "creation_date": 1528297584, "post_id": 50713859, "comment_id": 88455712, "body": "Thanks @smartini. I&#39;m not sure what your code is aiming to do, but your <code>for i loop</code> doesn&#39;t have an <code>i</code> in it, so it&#39;s just spinning redundantly. Additionally, it doesn&#39;t look like it&#39;s using the correct function. If you&#39;re using the <code>right</code> function and testing if it&#39;ll &lt;&gt; &quot;.&quot; that&#39;s only going to be the first instance. No loop needed. Perhaps you mean the <code>mid</code> function? I&#39;m not sure, but I appreciate the tick. Best of luck."}], "tags": [], "owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "is_accepted": true, "score": 1, "last_activity_date": 1528274075, "last_edit_date": 1528274075, "creation_date": 1528267656, "answer_id": 50713859, "question_id": 50713510, "link": "https://stackoverflow.com/questions/50713510/vba-check-if-file-exist-without-knowing-extension/50713859#50713859", "title": "VBA - check if file exist without knowing extension", "body": "<p>This should do it.</p>\n\n<pre><code>Const dirPath As String = \"C:\\whateveryourPathIs\\\"\n\nSub RunIt()\n    Dim Rcell As Range\n    For Each Rcell In Intersect(Range(\"A:A\"), ActiveSheet.UsedRange).Cells\n\n        If Not IsEmpty(Rcell) Then\n\n            If CheckIfFileExists(dirPath, Rcell.Value) Then\n                'whatever you want to happen when it finds a match\n                Debug.Print Rcell.Value &amp; \" was found\"\n\n            End If\n        End If\n\n    Next Rcell\n\nEnd Sub\n\n\n\nPrivate Function CheckIfFileExists(srchDIR As String, MatchMember As String) As Boolean\n    Dim file As Variant, nameOfFile As String\n\n    If Right(srchDIR, 1) &lt;&gt; \"\\\" Then srchDIR = srchDIR &amp; \"\\\"\n\n    file = Dir(srchDIR)\n    While (file &lt;&gt; \"\")\n\n        nameOfFile = Left(file, InStrRev(file, \".\", -1, vbTextCompare) - 1)\n\n\n        If UCase(nameOfFile) = UCase(MatchMember) Then\n            CheckIfFileExists = True\n            Exit Function\n        End If\n\n        file = Dir\n    Wend\nEnd Function\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1528298548, "post_id": 50715921, "comment_id": 88456399, "body": "As my other comment said... your <code>for i loop</code> has some problems. No <code>i</code> in the loop and I think you mean <code>mid</code> not <code>Right</code>."}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1528298848, "post_id": 50715921, "comment_id": 88456613, "body": "thanks for the hint. indeed the for i loop makes no sense, i rather meant do while (I only wanted to limit the loop in as much as it has a max loop like the length of the string). the purpose of thise Right() function is that i only want to erase  the file extension from the string. - it works. but I know, it is not well writting code though."}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1528299509, "post_id": 50715921, "comment_id": 88457062, "body": "your edit makes no sense it the program does not what it should do. did you try to run it? look into the debut.print windows please, you&#39;ll see that a loop is nessassary."}, {"owner": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 0, "creation_date": 1528301114, "post_id": 50715921, "comment_id": 88458053, "body": "Now I see what you&#39;re doing. That&#39;s excessive and inefficient (welcome to SO!! \u2620\ud83d\ude1c) I&#39;ll append a correction to your code, without touching yours, so you can see the difference. I don&#39;t think your answer provides anything that mine doesn&#39;t, but I enjoy a healthy discussion. You look like you&#39;re just getting your feet wet with VBA and I admire your creative approach. We&#39;ve all been there."}, {"owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "reply_to_user": {"reputation": 4245, "user_id": 8276474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sm6MV.jpg?s=128&g=1", "display_name": "PGSystemTester", "link": "https://stackoverflow.com/users/8276474/pgsystemtester"}, "edited": false, "score": 1, "creation_date": 1528355526, "post_id": 50715921, "comment_id": 88477749, "body": "not quite new to VBA, but this time I was a little rusty. Appreciate your help though!"}], "tags": [], "owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "is_accepted": false, "score": 0, "last_activity_date": 1528274548, "creation_date": 1528274548, "answer_id": 50715921, "question_id": 50713510, "link": "https://stackoverflow.com/questions/50713510/vba-check-if-file-exist-without-knowing-extension/50715921#50715921", "title": "VBA - check if file exist without knowing extension", "body": "<p>@PGCodeRider Thanks, I modified your code to my needs and it works now. anyone who is interested (\"or also did not find anything on google\") below the code:</p>\n\n<pre><code>Const dirPath As String = \"C:\\folderpath\\...\"\n\nSub RunIt()\n    Dim Rcell As Range\n    For Each Rcell In Intersect(Range(\"A:A\"), ActiveSheet.UsedRange).Cells\n\n        If Not IsEmpty(Rcell) Then\n\n            If CheckIfFileExists(dirPath, Rcell.Value) Then\n                'whatever you want to happen when it finds a match\n                Debug.Print Rcell.Value &amp; \" was found\"\n\n            End If\n        End If\n\n    Next Rcell\n\nEnd Sub\n\nPrivate Function CheckIfFileExists(srchDIR As String, MatchMember As String) As Boolean\n    Dim file As Variant\n    Dim length As Long\n\n    If Right(srchDIR, 1) &lt;&gt; \"\\\" Then srchDIR = srchDIR &amp; \"\\\"\n\n        file = Dir(srchDIR)\n\n        While (file &lt;&gt; \"\")\n\n            length = Len(file)\n                For i = 1 To length\n                    If Right(file, 1) &lt;&gt; \".\" Then\n                        file = Left(file, length - 1)\n                        length = Len(file)\n                    Else\n                    Exit For\n                    End If\n                Next i\n\n            file = Left(file, length - 1)\n\n        'If InStr(1, file, MatchMember, vbTextCompare) &gt; 0 Then\n            If file = MatchMember Then\n                CheckIfFileExists = True\n                Exit Function\n            End If\n            file = Dir\n        Wend\nEnd Function\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 9121235, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e481ddd5d81db5e202bde36a65652d21?s=128&d=identicon&r=PG&f=1", "display_name": "smartini", "link": "https://stackoverflow.com/users/9121235/smartini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "accepted_answer_id": 50713859, "answer_count": 2, "score": 1, "last_activity_date": 1544953059, "creation_date": 1528266394, "last_edit_date": 1544953059, "question_id": 50713510, "link": "https://stackoverflow.com/questions/50713510/vba-check-if-file-exist-without-knowing-extension", "title": "VBA - check if file exist without knowing extension", "body": "<p>I have an excel workbook with column [A] having numerous filenames. But only the name of the file, so without any extension. I would like to loop through each cell and check whether a file in a specific folder exist matching this string in the cell. </p>\n\n<p>someone did not manage to find anything on Google.</p>\n\n<p>thanks </p>\n"}, {"tags": ["forms", "excel", "vba"], "comments": [{"owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "edited": false, "score": 3, "creation_date": 1528266134, "post_id": 50713235, "comment_id": 88435593, "body": "Maybe you can post what you tried by far?"}, {"owner": {"reputation": 600, "user_id": 8923830, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MbJogn0Ac18/AAAAAAAAAAI/AAAAAAAAAGY/Xh76EIIP2vI/photo.jpg?sz=128", "display_name": "Badda_Bing", "link": "https://stackoverflow.com/users/8923830/badda-bing"}, "edited": false, "score": 0, "creation_date": 1528270906, "post_id": 50713235, "comment_id": 88438259, "body": "This is a very broad question and it would help to see what you have done so far. Is the code for each form on a separate workbook or are they both on the same? If they are on the same, you might want to consider integrating both into one form with separate pages or tabs instead of having two forms. If you insist on two forms on the same workbook however, you should start by looking at the initialize events for each form and determine whether you want the second form to be launched from the first while the first is active, or what other event is suitable depending on what you are looking for."}, {"owner": {"reputation": 1, "user_id": 9901411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd494563760516e92053d3bf7791872?s=128&d=identicon&r=PG&f=1", "display_name": "Kyebosh", "link": "https://stackoverflow.com/users/9901411/kyebosh"}, "edited": false, "score": 0, "creation_date": 1528852677, "post_id": 50713235, "comment_id": 88660231, "body": "I understand that it was kind of a broad question, and I understand there are many ways to skin a cat, but i was kind of thinking that what I was coding on the two forms wouldn&#39;t necessarily matter on having forms unlock-able. At that time it was in concept mode and I hadn&#39;t started coding anything to be able to show you."}, {"owner": {"reputation": 1, "user_id": 9901411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd494563760516e92053d3bf7791872?s=128&d=identicon&r=PG&f=1", "display_name": "Kyebosh", "link": "https://stackoverflow.com/users/9901411/kyebosh"}, "edited": false, "score": 0, "creation_date": 1528852869, "post_id": 50713235, "comment_id": 88660268, "body": "And Since I posted till now, I did end up changing the concept around to where having them on one form makes more sense, but I&#39;ve also been pulled away from the project for awhile and possibly may be abandoning it. Thanks for posting tho."}], "answers": [{"comments": [{"owner": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1528278795, "post_id": 50714760, "comment_id": 88443222, "body": "Your code examples use <code>C#</code>, not <code>Excel VBA</code> which OP wants"}, {"owner": {"reputation": 23543, "user_id": 2281790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/pP0ow.jpg?s=128&g=1", "display_name": "Harald Coppoolse", "link": "https://stackoverflow.com/users/2281790/harald-coppoolse"}, "reply_to_user": {"reputation": 7686, "user_id": 2626313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/613888ad5bbd9ddba4bd81bbbfeb7a05?s=128&d=identicon&r=PG", "display_name": "xmojmr", "link": "https://stackoverflow.com/users/2626313/xmojmr"}, "edited": false, "score": 0, "creation_date": 1528295357, "post_id": 50714760, "comment_id": 88454223, "body": "Oops! Still I hope KyeBosh understands the code and can translate it to his language. This answer might be useful for  a C# user has the same question"}], "tags": [], "owner": {"reputation": 23543, "user_id": 2281790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/pP0ow.jpg?s=128&g=1", "display_name": "Harald Coppoolse", "link": "https://stackoverflow.com/users/2281790/harald-coppoolse"}, "is_accepted": false, "score": -1, "last_activity_date": 1528270692, "creation_date": 1528270692, "answer_id": 50714760, "question_id": 50713235, "link": "https://stackoverflow.com/questions/50713235/how-to-freely-click-between-to-open-forms-vba/50714760#50714760", "title": "How to freely click between to open forms. VBA", "body": "<p>What you need is a modeless dialog box. See: <a href=\"https://docs.microsoft.com/en-us/previous-versions/visualstudio/visual-studio-2008/39wcs2dh(v=vs.90)\" rel=\"nofollow noreferrer\">how to display modal and modeless dialog boxes</a></p>\n\n<h2>Modal Dialog Box</h2>\n\n<p>A modal dialog box is a dialog box that takes all user input of the application. While this dialog box is open, the other forms of the application won't respond to user input. This is the most used form of dialog boxes. Example: <em>the save file dialog box</em>. While this dialog box is open, you can't edit your document. You'll first have to close the dialog box before you can continue changing the document. You can see this in <em>Notepad</em> when you save the file. While the save file dialog box is open you can't do anything with the main form</p>\n\n<p>A modal dialog box is usually shown as follows:</p>\n\n<pre><code>private void onButton1_Clicked(object sender, ...)\n{\n    using(var dlg = new MyModalDialog())\n    {\n        dlg.PropertyA = ...;  // set some properties of the dialog\n        dlg.PropertyB = ...;\n        var dlgResult = dlg.ShowDialog(this); // show the dialog. I am the parent\n\n        // this procedure is blocked until the dialog is closed.\n        // if here: result is available:\n        switch (dlgResult)\n        {\n            case DialogResult.OK:\n                ProcessResult(dlg.GetResult());\n                break;\n            case DialogResult.Cancel:\n                ProcessCancel();\n                break;\n            default:\n                 ...\n        }\n    }\n}\n</code></pre>\n\n<h2>Modeless Dialog Box</h2>\n\n<p>You want a modeless dialog box: after showing one form, you want to continue in your code to be able to show the other form. For this you don't use <a href=\"https://msdn.microsoft.com/en-us/library/c7ykbedk(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Form.ShowDialog</a> but <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.form.show%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Form.Show</a></p>\n\n<pre><code>private MyForm1 formA = null;\nprivate MyForm2 formB = null;\nprivate void onButton1_Clicked(object sender, ...)\n{\n    this.formA = new MyForm1())\n    this.formA.PropertyA = ...;\n\n    this.formB = new MyForm2())\n    this.formB.PropertyA = ...;\n\n    // make sure the forms are shown side by side\n    this.formA.Position = ...\n    this.formA.Size = ...\n    this.formB.Position = ...\n    this.formB.Size = ...\n\n    // show the forms:\n    this.formA.Show(this);\n    this.formB.Show(this);\n\n    // while the form are shown, your main form can continue\n    ...\n}\n</code></pre>\n\n<p>You'll have to subscribe to the <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.form.closed%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Form.Closed</a> event before you show the forms, so you can take actions, like Disposing the forms.</p>\n\n<pre><code>this.FormA.Closing += new System.EventHandler(this.OnSubFormClosed);\nthis.FormA.Show(this);\n</code></pre>\n\n<p>In <code>OnSubFormClosed</code> you should check the 'Sender` to inspect which form is closed and act accordingly:</p>\n\n<pre><code>void OnSunFormClosed(object sender, EventArgs e)\n{\n    if (Object.ReferenceEquals(sender, this.formA)\n    {   // FormA closed:\n        this.ProcessFormAClosed();\n        this.FormA.Dispose();\n        this.FormA = null;\n    }\n    else if (Object.ReferenceEquals(sender, this.FormB)\n    {\n        ...\n    }\n}\n</code></pre>\n\n<p>Finally: you should inform your forms when your main form is being closed. If you do this in <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.form.onclosing%28v=vs.110%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Form.OnClosing</a> instead of <a href=\"https://msdn.microsoft.com/en-us/library/system.windows.forms.form.onclosed(v=vs.110).aspx\" rel=\"nofollow noreferrer\">Form.OnClosed</a> you can ask your forms whether they are ok with it to being closed. For example, the form may ask the operator to save the file and give the opportunity to anser yes / no / cancel. In the latter case the application should not be closed. Check this behaviour if you try to close Notepad with unsaved edits.</p>\n\n<pre><code>protected override void OnFormClosing(cancelEventArgs e)\n{\n     // the following may be optimized\n     bool closeFormAallowed = this.formA?.IsClosingAllowed ?? true;\n     bool closeFormBallowed = this.formB?.IsClosingAllowed ?? true;\n\n     // cancel closing if closing is not allowed\n     e.Cancel = !closeFormAallowed || !closeFormBallowed;\n\n     // don't forget to raise the event so my subscribers my decide to cancel closing:\n     if (!e.cancel) base.OnClosing(e);\n\n     // if no one wants to cancel closing: close the forms:\n     if (!e.Cancel)\n     {\n         if (this.formA != null) this.formA.Close();\n         it (this.formB != null) this.formB.Close();\n         // this will raise the events, so the forms are properly disposed\n     }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9901411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd494563760516e92053d3bf7791872?s=128&d=identicon&r=PG&f=1", "display_name": "Kyebosh", "link": "https://stackoverflow.com/users/9901411/kyebosh"}, "edited": false, "score": 0, "creation_date": 1528853394, "post_id": 50715987, "comment_id": 88660383, "body": "I had like the looks for this simple coding, however I tried and it didn&#39;t work."}, {"owner": {"reputation": 1, "user_id": 9901411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd494563760516e92053d3bf7791872?s=128&d=identicon&r=PG&f=1", "display_name": "Kyebosh", "link": "https://stackoverflow.com/users/9901411/kyebosh"}, "edited": false, "score": 0, "creation_date": 1528870912, "post_id": 50715987, "comment_id": 88664795, "body": "I googled around a little, turns out microsoft for mac doesn&#39;t support the mode. Lame"}], "tags": [], "owner": {"reputation": 31, "user_id": 5554106, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NoPWG.jpg?s=128&g=1", "display_name": "Pharsided", "link": "https://stackoverflow.com/users/5554106/pharsided"}, "is_accepted": false, "score": 3, "last_activity_date": 1528274775, "creation_date": 1528274775, "answer_id": 50715987, "question_id": 50713235, "link": "https://stackoverflow.com/questions/50713235/how-to-freely-click-between-to-open-forms-vba/50715987#50715987", "title": "How to freely click between to open forms. VBA", "body": "<p>VBA Userforms have the property \"ShowModal\" setting this to False will allow the form to be selected or deselected at will, as well as multiple forms to be shown and used simultaneously (as long as they are all modeless)</p>\n\n<p>This can also be accomplished in code in the show event using</p>\n\n<pre><code>Userform1.Show vbModeless\n</code></pre>\n\n<p>you could then use the initialize event of one form to show the second form.</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n     UserForm2.Show vbModeless\nEnd Sub\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9901411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd494563760516e92053d3bf7791872?s=128&d=identicon&r=PG&f=1", "display_name": "Kyebosh", "link": "https://stackoverflow.com/users/9901411/kyebosh"}, "is_accepted": false, "score": 0, "last_activity_date": 1528853181, "creation_date": 1528853181, "answer_id": 50827927, "question_id": 50713235, "link": "https://stackoverflow.com/questions/50713235/how-to-freely-click-between-to-open-forms-vba/50827927#50827927", "title": "How to freely click between to open forms. VBA", "body": "<p>Thanks everyone for your posts and feedback. I had been pulled away from the project for the last while, and since then have changed up the concept of it... also I may be abandoning it, but I will play around with some of the stuff you guys had advised and see what I can learn from it.</p>\n\n<p>Thanks again.</p>\n"}], "owner": {"reputation": 1, "user_id": 9901411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd494563760516e92053d3bf7791872?s=128&d=identicon&r=PG&f=1", "display_name": "Kyebosh", "link": "https://stackoverflow.com/users/9901411/kyebosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 1, "answer_count": 3, "score": 0, "last_activity_date": 1528853181, "creation_date": 1528265317, "last_edit_date": 1531164843, "question_id": 50713235, "link": "https://stackoverflow.com/questions/50713235/how-to-freely-click-between-to-open-forms-vba", "title": "How to freely click between to open forms. VBA", "body": "<p>I've been searching for a bit but not seeming to be hitting the right keywords.</p>\n\n<p>What I am hoping to achieve is to have 2 separate user forms visible side by side. Both forms will have their own functionality and purpose but are meant to be used in conjunction with each other at times (hence the side by side). I would like to be able to click back and forth between the two forms freely, preferably with just a mouse click, like one would with their open applications on their desktop or OS.</p>\n\n<p>I can't seem to even find ways or methods to make make the unfocused form active.</p>\n\n<p>I am not a super strong programmer but I wouldn't consider myself a noob, but there are still a lot of syntax I've been seeing that looks greek to me and don't understand.</p>\n\n<p>working on Microsoft Office Excel for Mac 2011</p>\n\n<p>Thanks for any help guys and gals.</p>\n\n<p>Cheers</p>\n"}, {"tags": ["excel", "vba", "crash", "listbox", "userform"], "comments": [{"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1528265047, "post_id": 50713013, "comment_id": 88435166, "body": "Don&#39;t use <code>On Error Resume Next</code>, That could be hiding the cause of the issue. Apart from that, how do you know Excel stops working - what error messages or symptoms do you get?"}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1528265098, "post_id": 50713013, "comment_id": 88435184, "body": "Also - use <code>Option Explicit</code> - that will show up uninitialised variables and possible spelling errors."}, {"owner": {"reputation": 63, "user_id": 9674137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e18977a861ecf3fc2fd9c381525cf97?s=128&d=identicon&r=PG&f=1", "display_name": "Raji", "link": "https://stackoverflow.com/users/9674137/raji"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1528265150, "post_id": 50713013, "comment_id": 88435209, "body": "I will try that. To answer your question, the file crashes and excel stops working."}, {"owner": {"reputation": 63, "user_id": 9674137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e18977a861ecf3fc2fd9c381525cf97?s=128&d=identicon&r=PG&f=1", "display_name": "Raji", "link": "https://stackoverflow.com/users/9674137/raji"}, "reply_to_user": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1528265479, "post_id": 50713013, "comment_id": 88435337, "body": "I noticed that the file crashes specifically when the listbox has more number of rows to display e.g. 43 rows. It seemed to work fine for 2 to 5 rows"}, {"owner": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1528269517, "post_id": 50713013, "comment_id": 88437456, "body": "Where did it crash if you step through? What <code>lr</code> you get?"}, {"owner": {"reputation": 63, "user_id": 9674137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e18977a861ecf3fc2fd9c381525cf97?s=128&d=identicon&r=PG&f=1", "display_name": "Raji", "link": "https://stackoverflow.com/users/9674137/raji"}, "edited": false, "score": 0, "creation_date": 1528269913, "post_id": 50713013, "comment_id": 88437696, "body": "lr may vary from anything from 2 to 65000. However I observe the issue is not dependent on lr value. It seems like the file crashes when any of the listbox contents have too long string with many characters."}, {"owner": {"reputation": 5229, "user_id": 5512705, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/OoYN6.png?s=128&g=1", "display_name": "Samuel Hulla", "link": "https://stackoverflow.com/users/5512705/samuel-hulla"}, "edited": false, "score": 0, "creation_date": 1528283402, "post_id": 50713013, "comment_id": 88446187, "body": "What error message did you receive after you removed <code>On Error Resume Next</code>? In general, unless you absolutely know what you are doing, you should not be surpressing any of your errors. If anything, you should welcome them with open arms!"}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 1, "creation_date": 1528285521, "post_id": 50713013, "comment_id": 88447505, "body": "You may have encountered a size limit. This article <a href=\"https://msdn.microsoft.com/en-us/library/ms997541.aspx\" rel=\"nofollow noreferrer\">msdn.microsoft.com/en-us/library/ms997541.aspx</a> (dates back to 1992) speaks about a global limit of 32K and 64K (supposedly bytes - though 1 char needed 1 byte at that time) so you may consider it when dealing with &quot;too long&quot; strings."}, {"owner": {"reputation": 63, "user_id": 9674137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e18977a861ecf3fc2fd9c381525cf97?s=128&d=identicon&r=PG&f=1", "display_name": "Raji", "link": "https://stackoverflow.com/users/9674137/raji"}, "reply_to_user": {"reputation": 6187, "user_id": 2636247, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HRKcD.png?s=128&g=1", "display_name": "PatricK", "link": "https://stackoverflow.com/users/2636247/patrick"}, "edited": false, "score": 0, "creation_date": 1528289339, "post_id": 50713013, "comment_id": 88450052, "body": "@PatricK When stepping through it, it did not crash. I tried this multiple times. However, when I run the code, it crashes. Removing the &#39;&#211;n Error Resume Next&#39; did not result in any error."}, {"owner": {"reputation": 63, "user_id": 9674137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e18977a861ecf3fc2fd9c381525cf97?s=128&d=identicon&r=PG&f=1", "display_name": "Raji", "link": "https://stackoverflow.com/users/9674137/raji"}, "reply_to_user": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1528289675, "post_id": 50713013, "comment_id": 88450240, "body": "@AcsErno Thank you for the link. It does seem to be due to size limit. However, I do not understand why the issue does not replicate when I step through the code from VBA Editor."}, {"owner": {"reputation": 2242, "user_id": 9101981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a24c02fa607778b89aa21709e3bd534b?s=128&d=identicon&r=PG&f=1", "display_name": "AJD", "link": "https://stackoverflow.com/users/9101981/ajd"}, "edited": false, "score": 0, "creation_date": 1528313280, "post_id": 50713013, "comment_id": 88464254, "body": "what type of values are in the cells, particularly BA:BF.  Also, you are trying to push a 2-dimensional array into a List (<code>LBx</code>) - is the list box set up to take this array?."}, {"owner": {"reputation": 63, "user_id": 9674137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e18977a861ecf3fc2fd9c381525cf97?s=128&d=identicon&r=PG&f=1", "display_name": "Raji", "link": "https://stackoverflow.com/users/9674137/raji"}, "edited": false, "score": 0, "creation_date": 1528355721, "post_id": 50713013, "comment_id": 88477859, "body": "BA: BF have strings. I am trying to push a 6 dimensional array to the listbox, which is nothing but the values present in columns BA:BF."}, {"owner": {"reputation": 63, "user_id": 9674137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e18977a861ecf3fc2fd9c381525cf97?s=128&d=identicon&r=PG&f=1", "display_name": "Raji", "link": "https://stackoverflow.com/users/9674137/raji"}, "edited": false, "score": 0, "creation_date": 1528441106, "post_id": 50713013, "comment_id": 88517867, "body": "FYI. Since I wasn&#39;t able to resolve this issue and was running out of time, I am now using an excel range to display the output (and not list box) as an alternative. Thanks to everyone for your attempts in helping me out."}], "owner": {"reputation": 63, "user_id": 9674137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e18977a861ecf3fc2fd9c381525cf97?s=128&d=identicon&r=PG&f=1", "display_name": "Raji", "link": "https://stackoverflow.com/users/9674137/raji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1528264818, "creation_date": 1528264150, "last_edit_date": 1528264818, "question_id": 50713013, "link": "https://stackoverflow.com/questions/50713013/excel-vba-file-stops-working-after-form-initialization", "title": "excel vba file stops working after form initialization", "body": "<p>I am initializing a userform once user double clicks on any cell in a certain sheet. The excel file stops working after one or few initialization. Please help resolve this issue.\nThe form contains a list box that is populated using a multi dimensional array.This array is populated using values from a cell range that contains 6 columns and varying number of rows. Here is my code:</p>\n\n<pre><code>Private Sub UserForm_Initialize()\n\n    Dim lr, plr As Long\n    Dim a As Variant\n\n\n    Set psh = ThisWorkbook.Sheets(\"P\")\n\n    psh.Activate\n    lr = GetFilteredRangeBottomRow() 'function to get row number of lastrow from filtered range\n\n    psh.Range(\"A1:F\" &amp; lr).SpecialCells(xlCellTypeVisible).Copy\n\n    On Error Resume Next\n    psh.Range(\"BA1\").PasteSpecial xlPasteValues\n    psh.ShowAllData\n    plr = psh.Columns(53).Find(What:=\"*\", SearchOrder:=xlByRows, SearchDirection:=xlPrevious).Row 'last row in column BA\n    a = psh.Range(\"BA1:BF\" &amp; plr).Value\n\n    With Form1.LBx 'LBx is the list box I am trying to populate\n    .ColumnCount = 6\n    .List = a\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9901292, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Daren S", "link": "https://stackoverflow.com/users/9901292/daren-s"}, "edited": false, "score": 0, "creation_date": 1531923006, "post_id": 50715508, "comment_id": 89779240, "body": "Hi, thanks so much! I tried running it but it didn&#39;t seem to work."}], "tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 0, "last_activity_date": 1528273228, "creation_date": 1528273228, "answer_id": 50715508, "question_id": 50712814, "link": "https://stackoverflow.com/questions/50712814/excel-vba-macro-merge-if-column-has-specific-value/50715508#50715508", "title": "Excel VBA Macro merge if column has specific value", "body": "<pre><code>Sub MergeSameValue()\n\nFor Each cell In Sheet1.Columns(1).Cells\n    If cell.Value = \"\" Then Exit Sub\n    If cell.Value = cell.Offset(0, 1).Value Then\n        cell.Offset(0, 1).Value = \"\"\n        Range(cell, cell.Offset(0, 1)).Merge\n    End If\nNext\n</code></pre>\n\n<p>End Sub</p>\n"}], "owner": {"reputation": 11, "user_id": 9901292, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Daren S", "link": "https://stackoverflow.com/users/9901292/daren-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1528273228, "creation_date": 1528262985, "last_edit_date": 1528269365, "question_id": 50712814, "link": "https://stackoverflow.com/questions/50712814/excel-vba-macro-merge-if-column-has-specific-value", "title": "Excel VBA Macro merge if column has specific value", "body": "<p>Column A: values not a concern \nColumn B: certain number for example B3 may be 3, B4 may be 3, B5 may be 3, B6 may be 4, etc. </p>\n\n<p>I want to be able to merge cells in column A if the adjacent cells in column B are the same\nUsing the same example, A3-A5 would be merged </p>\n\n<p>Any and all help is greatly appreciated! </p>\n"}, {"tags": ["python", "vba", "xlwings"], "answers": [{"tags": [], "owner": {"reputation": 634, "user_id": 2478928, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9e1fe8ece423a7c689c4821f4340da94?s=128&d=identicon&r=PG", "display_name": "Bishonen_PL", "link": "https://stackoverflow.com/users/2478928/bishonen-pl"}, "is_accepted": false, "score": 0, "last_activity_date": 1528262512, "creation_date": 1528262512, "answer_id": 50712738, "question_id": 50712699, "link": "https://stackoverflow.com/questions/50712699/paramarray-in-xlwings/50712738#50712738", "title": "ParamArray in xlWings", "body": "<p>Nevermind. It was as easy as to declare the last variable as *args in the xlwings module. After importing the UDF, the VBA code generates itself. Beautiful :)</p>\n"}], "owner": {"reputation": 634, "user_id": 2478928, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/9e1fe8ece423a7c689c4821f4340da94?s=128&d=identicon&r=PG", "display_name": "Bishonen_PL", "link": "https://stackoverflow.com/users/2478928/bishonen-pl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1528262512, "creation_date": 1528262242, "question_id": 50712699, "link": "https://stackoverflow.com/questions/50712699/paramarray-in-xlwings", "title": "ParamArray in xlWings", "body": "<p>Is there a way to pass an unknown list of variables to an UDF in xlWings?</p>\n\n<p>e.g. this python code:</p>\n\n<pre><code>def redistribute_with_old(dfFC, dfHist, columns=['site_name'])\n</code></pre>\n\n<p>does not work with this vba:</p>\n\n<pre><code>Function redistribute_with_old(dfFC, dfHist, ParamArray Columns())\n</code></pre>\n\n<p>columns results in a pyldispatch instead of a list. If that doesn't work, how does one create a function which accepts an unknown amount of variables?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 1, "creation_date": 1528262133, "post_id": 50712571, "comment_id": 88434176, "body": "You question is a little hard to follow, partially because you did not include any sample data or desired output. Are you trying to put a value in the first empty cell at the bottom of a column that matches a column name?  If so, <code>MATCH</code> is probably an easier way to get the column number."}, {"owner": {"reputation": 103, "user_id": 7683911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/219a9e348c08c8aa8d3dd0d37ce74b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Chandrasekar R", "link": "https://stackoverflow.com/users/7683911/chandrasekar-r"}, "reply_to_user": {"reputation": 16956, "user_id": 8112776, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Tj3MU.png?s=128&g=1", "display_name": "ashleedawg", "link": "https://stackoverflow.com/users/8112776/ashleedawg"}, "edited": false, "score": 0, "creation_date": 1528262358, "post_id": 50712571, "comment_id": 88434244, "body": "<b>ActiveSheet.Paste Destination:=Range(&quot;BV1:BV&quot; &amp; lastrow)</b>. Instead of mentioning column name here, I would require to paste with Header name as mentioned in the question."}], "answers": [{"comments": [{"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "edited": false, "score": 0, "creation_date": 1528262396, "post_id": 50712721, "comment_id": 88434261, "body": "<a href=\"https://stackoverflow.com/q/10714251/445425\">You might want to read this</a>"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": false, "score": 1, "last_activity_date": 1528262381, "creation_date": 1528262381, "answer_id": 50712721, "question_id": 50712571, "link": "https://stackoverflow.com/questions/50712571/search-for-header-copy-paste-value-till-last-row/50712721#50712721", "title": "Search for header, copy paste value till last row", "body": "<p>Just build your paste range from <code>rngUsernameHeader</code></p>\n\n<pre><code>ActiveSheet.Paste Destination:=Range( _\n  Cells(1, rngUsernameHeader.Column), _\n  Cells(lastrow, rngUsernameHeader.Column))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 26, "user_id": 9901234, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-08rot9DnG2Q/AAAAAAAAAAI/AAAAAAAAARs/h8NusFEMAVM/photo.jpg?sz=128", "display_name": "SebastianG", "link": "https://stackoverflow.com/users/9901234/sebastiang"}, "is_accepted": true, "score": 1, "last_activity_date": 1528262822, "creation_date": 1528262822, "answer_id": 50712786, "question_id": 50712571, "link": "https://stackoverflow.com/questions/50712571/search-for-header-copy-paste-value-till-last-row/50712786#50712786", "title": "Search for header, copy paste value till last row", "body": "<p>is this what you are looking for?</p>\n\n<pre><code>Range(\"A1\").Select\nDim rngUsernameHeader As Range\nDim rngHeaders As Range\nSet rngHeaders = Range(\"1:1\")\nSet rngUsernameHeader = rngHeaders.Find(what:=\"Total\", After:=Cells(1, 1))\nrngUsernameHeader.Copy\nlastrow = Range(\"A65536\").End(xlUp).Row\nActiveSheet.Paste Destination:=Range(rngUsernameHeader, rngUsernameHeader.Offset(lastrow - 1))\n\nSelection.End(xlUp).Select\nApplication.CutCopyMode = False\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12905, "user_id": 9312892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/873adbcf73c646c120393a0ceb270604?s=128&d=identicon&r=PG&f=1", "display_name": "DisplayName", "link": "https://stackoverflow.com/users/9312892/displayname"}, "is_accepted": false, "score": 0, "last_activity_date": 1528274265, "creation_date": 1528274265, "answer_id": 50715825, "question_id": 50712571, "link": "https://stackoverflow.com/questions/50712571/search-for-header-copy-paste-value-till-last-row/50715825#50715825", "title": "Search for header, copy paste value till last row", "body": "<p>if you want to paste the content of row 1 cell containing \"Total\" in the found cell column from row 1 down to the row corresponding to column A last not empty one, then use:</p>\n\n<pre><code>Sub main()\n    With Range(\"1:1\").Find(what:=\"Total\", After:=Cells(1, 1))\n        .Resize(Cells(Rows.Count, 1).End(xlUp).Row).Value = .Value\n    End With\nEnd Sub\n</code></pre>\n\n<p>or, if you know that \"Total\" is the whole content of the header</p>\n\n<pre><code>Sub main()\n    Range(\"1:1\").Find(what:=\"Total\", After:=Cells(1, 1)).Resize(Cells(Rows.Count, 1).End(xlUp).Row).Value = \"Total\"\nEnd Sub\n</code></pre>\n\n<p>while, if you want to paste the content of row 1 cell containing \"Total\" in the found cell column from row 1 down to the last not empty cell of that same column, then use:</p>\n\n<pre><code>Sub main2()\n    With Range(\"1:1\").Find(what:=\"Total\", After:=Cells(1, 1))\n        .Resize(Cells(Rows.Count, .Column).End(xlUp).Row).Value = .Value\n    End With\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 103, "user_id": 7683911, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/219a9e348c08c8aa8d3dd0d37ce74b3f?s=128&d=identicon&r=PG&f=1", "display_name": "Chandrasekar R", "link": "https://stackoverflow.com/users/7683911/chandrasekar-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 50712786, "answer_count": 3, "score": 0, "last_activity_date": 1528274265, "creation_date": 1528261480, "last_edit_date": 1528269382, "question_id": 50712571, "link": "https://stackoverflow.com/questions/50712571/search-for-header-copy-paste-value-till-last-row", "title": "Search for header, copy paste value till last row", "body": "<p>I have created a macro to search for header and Copy the header and paste it till the last row of that particular column. But when I do it I have to specify the column which i dont want . But I need to paste it with the Header search in the same column till last row. Ex:Total is the Header name in BV column. Please assist.</p>\n\n<pre><code>Range(\"A1\").Select\nDim rngUsernameHeader As Range\nDim rngHeaders As Range\nSet rngHeaders = Range(\"1:1\")\nSet rngUsernameHeader = rngHeaders.Find(what:=\"Total\", After:=Cells(1, 1))\nrngUsernameHeader.Copy\nlastrow = Range(\"A65536\").End(xlUp).Row\n**ActiveSheet.Paste Destination:=Range(\"BV1:BV\" &amp; lastrow)**\nSelection.End(xlUp).Select\nApplication.CutCopyMode = False\n</code></pre>\n"}, {"tags": ["string", "vba", "delimiter"], "comments": [{"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 2, "creation_date": 1528262876, "post_id": 50712394, "comment_id": 88434408, "body": "Always helps to post your existing code..."}, {"owner": {"reputation": 1, "user_id": 9900468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177e08125243a51089b4906db58161e?s=128&d=identicon&r=PG&f=1", "display_name": "Grahagblah", "link": "https://stackoverflow.com/users/9900468/grahagblah"}, "reply_to_user": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 0, "creation_date": 1528270531, "post_id": 50712394, "comment_id": 88438039, "body": "I know, im sorry, i thought the way i explained it was enough since the problem is not much coding based but lack of knowledge of the VBA functions, since the import is working the only thing that was missing was a way to find something that you dont know the complete name of."}, {"owner": {"reputation": 121871, "user_id": 478884, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rLckc.jpg?s=128&g=1", "display_name": "Tim Williams", "link": "https://stackoverflow.com/users/478884/tim-williams"}, "edited": false, "score": 1, "creation_date": 1528305001, "post_id": 50712394, "comment_id": 88460096, "body": "It&#39;s much easier to tweak a line of existing code than to try to make suggestions when we have no idea how your code is structured.  Posting your code also gives people here some idea about what level to pitch their response at."}], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 9901234, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-08rot9DnG2Q/AAAAAAAAAAI/AAAAAAAAARs/h8NusFEMAVM/photo.jpg?sz=128", "display_name": "SebastianG", "link": "https://stackoverflow.com/users/9901234/sebastiang"}, "is_accepted": false, "score": 0, "last_activity_date": 1528261764, "creation_date": 1528261764, "answer_id": 50712606, "question_id": 50712394, "link": "https://stackoverflow.com/questions/50712394/vba-undefined-string-structure/50712606#50712606", "title": "VBA undefined string structure", "body": "<p>Looks like you could use RegEx. Just gooogle RegEx VBA and get familiar with the concept. With it you can create a lookup query for any regular pattern.</p>\n\n<p>here you can see some examples on <a href=\"https://stackoverflow.com/questions/22542834/how-to-use-regular-expressions-regex-in-microsoft-excel-both-in-cell-and-loops\">StackOverflow</a></p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 9900468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177e08125243a51089b4906db58161e?s=128&d=identicon&r=PG&f=1", "display_name": "Grahagblah", "link": "https://stackoverflow.com/users/9900468/grahagblah"}, "edited": false, "score": 0, "creation_date": 1528267950, "post_id": 50712643, "comment_id": 88436514, "body": "Ahh ok, so i can use &quot;*&quot; and define 2 fake variables which are equal to * and then search for fake_fake_Y_Z.txt? Where fake = *"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 1, "user_id": 9900468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177e08125243a51089b4906db58161e?s=128&d=identicon&r=PG&f=1", "display_name": "Grahagblah", "link": "https://stackoverflow.com/users/9900468/grahagblah"}, "edited": false, "score": 0, "creation_date": 1528270370, "post_id": 50712643, "comment_id": 88437952, "body": "@Grahagblah I&#39;m guessing that you can search for the string expression <code>&quot;*_&quot; + Y + &quot;_&quot; + Z + &quot;.txt&quot;</code>, where <code>Y</code> and <code>Z</code> contain the values from the form fields. But without seeing some code, it&#39;s hard to say for certain."}, {"owner": {"reputation": 1, "user_id": 9900468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177e08125243a51089b4906db58161e?s=128&d=identicon&r=PG&f=1", "display_name": "Grahagblah", "link": "https://stackoverflow.com/users/9900468/grahagblah"}, "edited": false, "score": 0, "creation_date": 1528271076, "post_id": 50712643, "comment_id": 88438355, "body": "I will try this and see if it works. Thank you for the help and sorry for the nature of the question."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1528286264, "post_id": 50712643, "comment_id": 88448026, "body": "Just explaining @Zev&#39;s comment: you can compile the search pattern and test if Windows Explorer lists only the desired files. Once you have the proper format, you can go on with programming. I prefer <code>Dir</code> to <code>FileSystemObject</code> and <code>RegEx</code> (as they are way more complex), see an example here: <a href=\"https://stackoverflow.com/questions/50275517/using-vba-to-import-multiple-text-files-with-different-delimiters/50289246#50289246\" title=\"using vba to import multiple text files with different delimiters\">stackoverflow.com/questions/50275517/&hellip;</a>"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1528286609, "post_id": 50712643, "comment_id": 88448239, "body": "@AcsErno It&#39;s possible to do what you suggest, but the meaning of my comment was only that this string format could be used either with the VBA <code>Like</code> operator, or passed into the <code>Dir</code> function."}, {"owner": {"reputation": 1444, "user_id": 9122140, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6207fe125b0cbaefce70e98e5ce2c6f?s=128&d=identicon&r=PG&f=1", "display_name": "AcsErno", "link": "https://stackoverflow.com/users/9122140/acserno"}, "edited": false, "score": 0, "creation_date": 1528288799, "post_id": 50712643, "comment_id": 88449724, "body": "@Zev, what you said was absolutely correct. I just wanted to show Grahagblah an easy way to go on."}, {"owner": {"reputation": 1, "user_id": 9900468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177e08125243a51089b4906db58161e?s=128&d=identicon&r=PG&f=1", "display_name": "Grahagblah", "link": "https://stackoverflow.com/users/9900468/grahagblah"}, "edited": false, "score": 0, "creation_date": 1528334909, "post_id": 50712643, "comment_id": 88471309, "body": "If i make 2  string variables: rndm = &quot;*&quot; rndm2 = &quot;hey&quot; If rndm = rndm2 Then MsgBox &quot;Working&quot; Else MsgBox &quot;Not Working&quot;  This is not working, so im wondering how can i make it work? Do i have to give it point marks as in something that is similar in both cases?"}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 1, "user_id": 9900468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177e08125243a51089b4906db58161e?s=128&d=identicon&r=PG&f=1", "display_name": "Grahagblah", "link": "https://stackoverflow.com/users/9900468/grahagblah"}, "edited": false, "score": 0, "creation_date": 1528336727, "post_id": 50712643, "comment_id": 88471771, "body": "@Grahagblah <code>If rndm2 Like rndm Then MsgBox &quot;Working&quot; Else MsgBox &quot;Not Working&quot;</code> should work."}, {"owner": {"reputation": 1, "user_id": 9900468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177e08125243a51089b4906db58161e?s=128&d=identicon&r=PG&f=1", "display_name": "Grahagblah", "link": "https://stackoverflow.com/users/9900468/grahagblah"}, "edited": false, "score": 0, "creation_date": 1528339751, "post_id": 50712643, "comment_id": 88472398, "body": "So now it will find W_X_Y_Z if i give tell it to search for strImportFile   Where strImportFile = rndm_rndm_Y_Z.  The only problem i can see which i can not test until im in the office is that the code searches for a string that is = to and not Like, not sure if &quot;*&quot; will work then.  The search uses If Len(Dir$(strImportFile)) = 1 Then &#39;starts copying values from the file."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 1, "user_id": 9900468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177e08125243a51089b4906db58161e?s=128&d=identicon&r=PG&f=1", "display_name": "Grahagblah", "link": "https://stackoverflow.com/users/9900468/grahagblah"}, "edited": false, "score": 0, "creation_date": 1528372102, "post_id": 50712643, "comment_id": 88488264, "body": "@Grahagblah In order to understand how the <code>Like</code> operator works, I suggest you don&#39;t think about variables (fake, random or otherwise); think about the results which actual strings will return -- <code>Debug.Print &quot;*&quot; Like &quot;hey&quot;</code> prints <code>False</code>; <code>Debug.Print &quot;hey&quot; Like &quot;*&quot;</code> prints <code>True</code> etc. This is also a style of code you can paste into the Immediate pane, and see the results immediately."}, {"owner": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1528399246, "post_id": 50712643, "comment_id": 88504930, "body": "Another possible advantage to VBA&#39;s DIR vs FileSystemObject is that the former will work on Macs, the latter won&#39;t.  If you need to support Macs, wildcards won&#39;t work, if I remember correctly."}, {"owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "reply_to_user": {"reputation": 12482, "user_id": 1667023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JXaUt.png?s=128&g=1", "display_name": "Steve Rindsberg", "link": "https://stackoverflow.com/users/1667023/steve-rindsberg"}, "edited": false, "score": 0, "creation_date": 1528401045, "post_id": 50712643, "comment_id": 88505872, "body": "@SteveRindsberg Thanks; I&#39;ve incorporated into my answer."}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528404387, "post_id": 50712643, "comment_id": 88507505, "body": "You can also issue a command line loop but that is perhaps stretching things."}, {"owner": {"reputation": 1, "user_id": 9900468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177e08125243a51089b4906db58161e?s=128&d=identicon&r=PG&f=1", "display_name": "Grahagblah", "link": "https://stackoverflow.com/users/9900468/grahagblah"}, "edited": false, "score": 0, "creation_date": 1528421255, "post_id": 50712643, "comment_id": 88512211, "body": "I have updated the question and added some code now to clarify the problem a bit, i hope it makes it easier to understand what i mean now."}], "tags": [], "owner": {"reputation": 10104, "user_id": 111794, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c209be384649abcc5a4bf8babb132572?s=128&d=identicon&r=PG", "display_name": "Zev Spitz", "link": "https://stackoverflow.com/users/111794/zev-spitz"}, "is_accepted": false, "score": 1, "last_activity_date": 1528401017, "last_edit_date": 1528401017, "creation_date": 1528261940, "answer_id": 50712643, "question_id": 50712394, "link": "https://stackoverflow.com/questions/50712394/vba-undefined-string-structure/50712643#50712643", "title": "VBA undefined string structure", "body": "<p>AFAIK there are two methods you can use in VBA to iterate over files:</p>\n\n<ul>\n<li>the <strong><a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/dir-function\" rel=\"nofollow noreferrer\">Dir</a></strong> function, or</li>\n<li>the <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/windows-scripting/hww8txat%28v%3dvs.84%29\" rel=\"nofollow noreferrer\"><strong>FileSystemObject</strong> object</a> and the <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/windows-scripting/1ft05taf%28v%3dvs.84%29\" rel=\"nofollow noreferrer\"><strong>File</strong> object</a> in the <a href=\"https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/windows-scripting/bstcxhf7(v%3dvs.84)\" rel=\"nofollow noreferrer\">Scripting Runtime library</a>.<sup>1</sup></li>\n</ul>\n\n<p>If you are using the <strong>FileSystemObject</strong>, then you iterate over each file and verify the file name, using any of the followi\\ng:</p>\n\n<ul>\n<li>VBA string functions, such as <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/instr-function\" rel=\"nofollow noreferrer\"><strong>Instr</strong></a> and <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/left-function\" rel=\"nofollow noreferrer\"><strong>Left</strong></a></li>\n<li>VBA <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/like-operator\" rel=\"nofollow noreferrer\"><strong>Like</strong></a> operator, comparing against a pattern-match string</li>\n<li>regular expressions</li>\n</ul>\n\n<p>If you are using <strong>Dir</strong> (calling <strong>Dir</strong> each time without parameters to get the next file name), then in addition to the previous methods, you can pass in a filename pattern to the function<sup>2</sup>, and it will only return results matching the pattern.</p>\n\n<p>Whether you use the <strong>Like</strong> operator or you pass in a pattern to the <strong>Dir</strong> function, <code>?</code> in the pattern matches any single character, while <code>*</code> matches any number of characters:</p>\n\n<ul>\n<li><code>\"ab?d\"</code> matches <code>\"abcd\"</code>, <code>\"abgd\"</code>, but not <code>\"abcgd\"</code></li>\n<li><code>\"ab*d\"</code> matches <code>\"abcd\"</code>, <code>\"abgd\"</code>, and <code>\"abcgd\"</code></li>\n</ul>\n\n<p>For more information about using regular expressions in VBA, see <a href=\"https://stackoverflow.com/a/22542835/111794\">here</a>.</p>\n\n<hr>\n\n<p><sup>1. On Windows only, because Office on Macintosh doesn't support the use of ActiveX / COM Automation.<br>\n2. On Windows only. On Macintosh, <code>?</code> and <code>*</code> are valid filename characters, and therefore can't be used for wildcard characters.</sup></p>\n"}], "owner": {"reputation": 1, "user_id": 9900468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5177e08125243a51089b4906db58161e?s=128&d=identicon&r=PG&f=1", "display_name": "Grahagblah", "link": "https://stackoverflow.com/users/9900468/grahagblah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1528421208, "creation_date": 1528260276, "last_edit_date": 1528421208, "question_id": 50712394, "link": "https://stackoverflow.com/questions/50712394/vba-undefined-string-structure", "title": "VBA undefined string structure", "body": "<p>I am trying to write a function in my code that allows me to search for a specific file based on it's name. The function is working but now the structure of the name has changed and it has caused trouble for me.</p>\n\n<p>My code is in the form of macros that control a word document. This document gets information from another program and puts it in formfields on the word document.\nMy code then takes the \"value\" of the formfields and uses them to search a specific folder for a .txt with a name that matches the stored value from the formfields.</p>\n\n<p>Now the name of the .txt has been altered, the name will have some extra information that i do not have access to through the word document.</p>\n\n<p>Example:\nW_X_Y_Z.txt\nWhere Y and Z are available in the formfields of the document and can be accessed, but W and X are unknown to me.</p>\n\n<p>Need to solve:\nSo what i need to do is to figure out a way to ignore W and X and base the search on Y and Z only.</p>\n\n<p>Ideas:\nOne idea i have is to search for a file with the structre such as\n??_??_Y_Z.txt but i am uncertain how this will work as in does \"??\" include numbers if it is in a string and does \"??\" mean only 2 unknown characters or any amount? If only two is there a way to define an unknown string where both the characters are unknown and the amount of characters?</p>\n\n<p>Second idea is to use a delimiter on the <code>_</code> and somehow figure out how i can tell the macro how to ignore everything after the second <code>_</code>.</p>\n\n<p>Any ideas or recommended investigations i should make are welcome.</p>\n\n<p>Thank you.</p>\n\n<hr>\n\n<p>I will try to add some code now, but keep in mind i inheritated alot of the code in this document and therefore i do not know exactly what every detail does thats why i have avoided typing the code.</p>\n\n<p>Code as of now:</p>\n\n<pre><code>ActiveDocument.FormFields(\"Remissnummer\").Select\nRemiss = Selection.Text\nSelection.Collapse Direction:=wdCollapseStart\n\nActiveDocument.FormFields(\"Personid\").Select\nstrTmpPersonnr = Selection.Text\nintNumCharsPersNr = Len(strTmpPersonnr)\nSelection.Collapse Direction:=wdCollapseStart\n\nstrFileName = strTmpPersonnr\np_strFileReportPath = \"G:\\HMC\\Fysiologiska kliniken\\Eko\\Export\\\"\nstrImportFile = p_strFileReportPath &amp; \"*\" &amp; strFileName &amp; \"_\" &amp; Remiss &amp; strFileExt\n\nIf Len(Dir$(strImportFile)) = 0 Then\nMsgBox \"Error\"\nElse\n'starts importing values from the file\n</code></pre>\n\n<p>This method has worked when the file name had a know structure i.e only Y_Z.txt\nNow though the structure has changed as i explained above, the two new variables are unknown, can be anything from letters to numbers.</p>\n\n<p>i tried with:</p>\n\n<pre><code>Ignore = \"*\"\n\nstrImportFile = p_strFileReportPath &amp; Ignore &amp; \"_\" &amp; Ignore &amp; \"_\" &amp; strFileName &amp; \"_\" &amp; Remiss &amp; strFileExt\n</code></pre>\n\n<p>but it just froze and when going to task manager you could see more and more memory was allocated to word... I stoped it after 10 minutes.</p>\n\n<p>So im guessing i cant account for the unknown parts of the file name with \"*\" but im kinda lost now.</p>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 1, "creation_date": 1528269885, "post_id": 50712121, "comment_id": 88437676, "body": "I suggest you always use <a href=\"https://msdn.microsoft.com/en-us/vba/language-reference-vba/articles/option-explicit-statement\" rel=\"nofollow noreferrer\">Option Explicit</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": false, "score": 0, "last_activity_date": 1528258461, "creation_date": 1528258461, "answer_id": 50712169, "question_id": 50712121, "link": "https://stackoverflow.com/questions/50712121/excel-vba-variable-doesnt-work-and-brings-up-object-required-error/50712169#50712169", "title": "(Excel VBA) Variable doesn&#39;t work and brings up &quot;Object Required error&quot;", "body": "<p>You're assigning cells(1, 1).value to A. If you want the range object properties of cells(1, 1) (like 'characters') you need to Set a range-type var to cells(1,1).</p>\n\n<pre><code>Sub remove()\n  dim A as range\n  set A = Cells(1, 1)\n  pos = InStr(A.value, \"e\")\n  A.characters(pos,1).delete'   \nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11, "user_id": 9260275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/629797054328812a69491a3d08b79fd4?s=128&d=identicon&r=PG&f=1", "display_name": "Ka Fai", "link": "https://stackoverflow.com/users/9260275/ka-fai"}, "edited": false, "score": 0, "creation_date": 1528263697, "post_id": 50712237, "comment_id": 88434665, "body": "I get it I think.  So I&#39;m making A=Cells(1,1).value by not typing set.  Thanks very  much :)"}], "tags": [], "owner": {"reputation": 108, "user_id": 8961085, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-umFoDqrJUwg/AAAAAAAAAAI/AAAAAAAAAC8/sGDiw6lbbkA/photo.jpg?sz=128", "display_name": "MikeFromCanmore", "link": "https://stackoverflow.com/users/8961085/mikefromcanmore"}, "is_accepted": false, "score": 1, "last_activity_date": 1528259069, "creation_date": 1528259069, "answer_id": 50712237, "question_id": 50712121, "link": "https://stackoverflow.com/questions/50712121/excel-vba-variable-doesnt-work-and-brings-up-object-required-error/50712237#50712237", "title": "(Excel VBA) Variable doesn&#39;t work and brings up &quot;Object Required error&quot;", "body": "<p>Jeeped beat me to it. VBA is not strongly typed, so unless you explicitly tell it that the variable you are assigning is an object-type by using 'Set', the value that A takes is, in this case, the contents of the cell instead of the cell itself. </p>\n\n<p>You don't even need to Dim it, although it is good practice. </p>\n\n<pre><code>Sub remove()\n  Set A = Cells(1, 1) 'Need to use Set\n  pos = InStr(A, \"e\")\n\n  'This works just fine now\n  A.characters(pos,1).delete'\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9260275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/629797054328812a69491a3d08b79fd4?s=128&d=identicon&r=PG&f=1", "display_name": "Ka Fai", "link": "https://stackoverflow.com/users/9260275/ka-fai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1528259069, "creation_date": 1528258066, "question_id": 50712121, "link": "https://stackoverflow.com/questions/50712121/excel-vba-variable-doesnt-work-and-brings-up-object-required-error", "title": "(Excel VBA) Variable doesn&#39;t work and brings up &quot;Object Required error&quot;", "body": "<p>So I was testing a simple program to find the letter e and remove it from the cell. Except that Variable A doesn't work even though Cells(1,1) does. </p>\n\n<pre><code>Sub remove()\n  A = Cells(1, 1)\n  pos = InStr(A, \"e\")\n       'A works for pos though I don't know why\n  'A.characters(pos,1).delete'\n       'The above doesn't work for some reason'   \n  Cells(1, 1).Characters(pos, 1).delete    \nEnd Sub\n</code></pre>\n\n<p>Things that I have tried</p>\n\n<ul>\n<li>Dim A as Range</li>\n<li>Using Range</li>\n</ul>\n\n<p>Also Sorry for not being more specific about my problem. I'm not sure about the terminology behind VBA and coding in general though I'm working on it</p>\n"}, {"tags": ["excel", "vba", "loops"], "comments": [{"owner": {"reputation": 3045, "user_id": 5350831, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f92cda196408a91bcf88ca37ad7b18e?s=128&d=identicon&r=PG&f=1", "display_name": "Vincent G", "link": "https://stackoverflow.com/users/5350831/vincent-g"}, "edited": false, "score": 0, "creation_date": 1528270400, "post_id": 50711552, "comment_id": 88437972, "body": "You have <code>dict.Item(arr(1, 3)) = arr(1, 4)</code> instead of <code>dict.Item(arr(i, 3)) = arr(i, 4)</code> in your code."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "edited": false, "score": 1, "creation_date": 1528254776, "post_id": 50711691, "comment_id": 88432325, "body": "See the error control I added for the dict.add method. The earlier shorthand version doesn&#39;t need it as it overwrites duplicates. dict.add key, item requires it or it will choke on duplicates."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4039065"}, "is_accepted": true, "score": 2, "last_activity_date": 1528254393, "creation_date": 1528254393, "answer_id": 50711691, "question_id": 50711552, "link": "https://stackoverflow.com/questions/50711552/vba-find-and-replace-not-working-for-all-columns/50711691#50711691", "title": "VBA find and replace not working for all columns", "body": "<p>Use Combined column A as the dictionary key and combine the multiple columns into an array to be stored as the dictionary Item</p>\n\n<pre><code>Sub tranferData()\n    Dim i As Long, arr As Variant, dict As Object\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n    dict.comparemode = vbTextCompare\n\n    With Worksheets(\"COMBINED\")\n        'put combined!a:d into a variant array\n        arr = .Range(.Cells(2, \"A\"), .Cells(.Rows.Count, \"D\").End(xlUp)).Value2\n        'loop through array and build dictionary keys from combined!a:a, dictionary item from rows b:d\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            'add key and multiple items as array\n            If not dict.exists(arr(i, 1)) Then _\n              dict.Add Key:=arr(i, 1), Item:=Array(arr(i, 2), arr(i, 3), arr(i, 4))\n        Next i\n    End With\n\n    With Worksheets(\"All SAMs Backlog\")\n        arr = .Range(.Cells(3, \"C\"), .Cells(.Rows.Count, \"C\").End(xlUp).Offset(0, 3)).Value2\n        'loop through array and if c:c matches combined!a:a then put combined!b:d into d:f\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            If dict.exists(arr(i, 1)) Then\n                arr(i, 2) = dict.Item(arr(i, 1))(0)\n                arr(i, 3) = dict.Item(arr(i, 1))(1)\n                arr(i, 4) = dict.Item(arr(i, 1))(2)\n            Else\n                arr(i, 2) = vbNullString\n                arr(i, 3) = vbNullString\n                arr(i, 4) = vbNullString\n            End If\n        Next i\n        'put populated array back into c3 (resized by rows and columns)\n        .Cells(3, \"C\").Resize(UBound(arr, 1), UBound(arr, 2)) = arr\n    End With\n\n    MsgBox (\"done\")\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 700, "user_id": 6274595, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/fbccb62f5faf92749bd3183879fbd21e?s=128&d=identicon&r=PG&f=1", "display_name": "PL200", "link": "https://stackoverflow.com/users/6274595/pl200"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "accepted_answer_id": 50711691, "answer_count": 1, "score": 1, "last_activity_date": 1528254393, "creation_date": 1528253081, "question_id": 50711552, "link": "https://stackoverflow.com/questions/50711552/vba-find-and-replace-not-working-for-all-columns", "title": "VBA find and replace not working for all columns", "body": "<p>I am using a piece of code that loops through a Excel worksheet, uses the keys from it to copy another set of data into it. The two datasets (Dataset A to Dataset B) looks like following:</p>\n\n<p>Dataset A:</p>\n\n<pre><code>Key  Val1  Val2  Val3\n123  yes   up    right\n324  no    down  right\n314  no    up    left\n</code></pre>\n\n<p>Dataset B:</p>\n\n<pre><code>Key  Val1  Val2  Val3\n123\n314\n324\n</code></pre>\n\n<p>When the script is ran, it copies the data based on the Key. My code works for Val1 and Val2, but results in only blank entries for Val3, which is unexpected and unwanted. My code is as follows:</p>\n\n<pre><code>    Sub copyData()\n    Dim i As Long, arr As Variant, dict As Object\n\n    Set dict = CreateObject(\"scripting.dictionary\")\n    dict.comparemode = vbTextCompare\n\n    With Worksheets(\"COMBINED\")\n        'put combined!a:d into a variant array\n        arr = .Range(.Cells(2, \"A\"), .Cells(.Rows.Count, \"D\").End(xlUp)).Value2\n        'loop through array and build dictionary keys from combined!a:a, dictionary item from rows b:d\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            dict.Item(arr(i, 1)) = arr(i, 2)\n            dict.Item(arr(i, 2)) = arr(i, 3)\n            dict.Item(arr(1, 3)) = arr(1, 4)\n        Next i\n    End With\n\n    With Worksheets(\"All SAMs Backlog\")\n        arr = .Range(.Cells(3, \"C\"), .Cells(.Rows.Count, \"C\").End(xlUp).Offset(0, 3)).Value2\n        'loop through array and if c:c matches combined!a:a then put combined!b:b into d:d\n        For i = LBound(arr, 1) To UBound(arr, 1)\n            If dict.exists(arr(i, 1)) Then\n                arr(i, 2) = dict.Item(arr(i, 1))\n                arr(i, 3) = dict.Item(arr(i, 2))\n                arr(i, 4) = dict.Item(arr(i, 3))\n            Else\n                arr(i, 2) = vbNullString\n                arr(i, 3) = vbNullString\n                arr(i, 4) = vbNullString\n            End If\n        Next i\n        'put populated array back into c3 (resized by rows and columns)\n        .Cells(3, \"C\").Resize(UBound(arr, 1), UBound(arr, 2)) = arr\n    End With\n\n    MsgBox (\"done\")\n\nEnd Sub\n</code></pre>\n\n<p>Any help is appreciated.</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user9900785"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528341882, "post_id": 50711523, "comment_id": 88472775, "body": "Its a pivot cache everything is defined elsewhere in the code, the error only occurs when i make the data range much larger"}, {"owner": {"user_type": "does_not_exist", "display_name": "user9900785"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528853819, "post_id": 50711523, "comment_id": 88660467, "body": "tested that no effect, I have cut the problem down to a certain column within my excel data worksheet. The column  contains a very long string ~200 chars per cell. the code runs perfectly fine if I exclude it from the range. I dont need to include it but there is crucial data on either side of it. Is there a way to exclude the data from the cache without moving the two segments elsewhere and creating a cache from that."}], "owner": {"user_type": "does_not_exist", "display_name": "user9900785"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 32, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1528260543, "creation_date": 1528252767, "last_edit_date": 1528260543, "question_id": 50711523, "link": "https://stackoverflow.com/questions/50711523/vba-pivottable-type-mismatch-error-cross-workbooks", "title": "VBA PivotTable Type mismatch error cross workbooks", "body": "<p>Here is a snippet of the code that is giving me trouble, I cant figure out a solution, because it works for a smaller range and then runs into Run-time error '13': Type mismatch when I increase the range to its actually size</p>\n\n<pre><code>Set dataRange = wbData.Sheets(\"RawData\").Range(Cells(1, \"A\"), Cells(endCell, \"AA\"))\n'create root cause pivot chart\nwbReviewPivots.Sheets(\"RootCausesCleaned\").Activate\nSet rcPTCache = ActiveWorkbook.PivotCaches.Create(SourceType:=xlDatabase, SourceData:=dataRange)\nSet rcPT = ActiveSheet.PivotTables.Add(PivotCache:=rcPTCache, TableDestination:=Range(\"A1\"))\n    With rcPT\n        .PivotFields(\"Root Cause\").Orientation = xlRowField\n        .PivotFields(\"Root Cause (Sub Category)\").Orientation = xlRowField\n        .PivotFields(\"Remedy Task ID\").Orientation = xlDataField\n    End With\n</code></pre>\n\n<p>The problem occurs on line 4 creating the cache, I have heard unexpected errors can be run into when passing a Range. Is there a easy way to fix this or do I need to configure my range as a String?</p>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 2003, "user_id": 6414203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b25f1c657b4306a0d459c874e859789?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6414203/alan"}, "edited": false, "score": 0, "creation_date": 1528253132, "post_id": 50711499, "comment_id": 88431980, "body": "What version of Excel? Can&#39;t you use SUMIFS?"}, {"owner": {"reputation": 131, "user_id": 7700568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac428b78c5437a180445365bd648abdd?s=128&d=identicon&r=PG&f=1", "display_name": "java404", "link": "https://stackoverflow.com/users/7700568/java404"}, "reply_to_user": {"reputation": 54586, "user_id": 1505120, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f49dbeced705687b92e851736d48f208?s=128&d=identicon&r=PG", "display_name": "pnuts", "link": "https://stackoverflow.com/users/1505120/pnuts"}, "edited": false, "score": 1, "creation_date": 1528255594, "post_id": 50711499, "comment_id": 88432499, "body": "@pnuts I know PivotTable can solve it but I want to do it in VBA because this is just a sub program that I am trying to code."}, {"owner": {"reputation": 131, "user_id": 7700568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac428b78c5437a180445365bd648abdd?s=128&d=identicon&r=PG&f=1", "display_name": "java404", "link": "https://stackoverflow.com/users/7700568/java404"}, "reply_to_user": {"reputation": 2003, "user_id": 6414203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9b25f1c657b4306a0d459c874e859789?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/6414203/alan"}, "edited": false, "score": 0, "creation_date": 1528255622, "post_id": 50711499, "comment_id": 88432501, "body": "@Alan, we do not need to use SUMIF"}, {"owner": {"reputation": 2181, "user_id": 3468139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fhetA.jpg?s=128&g=1", "display_name": "jainashish", "link": "https://stackoverflow.com/users/3468139/jainashish"}, "edited": false, "score": 0, "creation_date": 1528256111, "post_id": 50711499, "comment_id": 88432598, "body": "You can either use worksheetfunction in VBA. For eg. Application.WorksheetFunction.Index or apply a formula in the range."}], "answers": [{"comments": [{"owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "edited": false, "score": 0, "creation_date": 1528260494, "post_id": 50712413, "comment_id": 88433662, "body": "The program can auto fill new YYYYMM and Item No."}, {"owner": {"reputation": 131, "user_id": 7700568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac428b78c5437a180445365bd648abdd?s=128&d=identicon&r=PG&f=1", "display_name": "java404", "link": "https://stackoverflow.com/users/7700568/java404"}, "edited": false, "score": 0, "creation_date": 1528266390, "post_id": 50712413, "comment_id": 88435716, "body": "thanks for your advise. I alr found the solution that given by @Chris"}], "tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 0, "last_activity_date": 1528260786, "last_edit_date": 1528260786, "creation_date": 1528260427, "answer_id": 50712413, "question_id": 50711499, "link": "https://stackoverflow.com/questions/50711499/using-vba-instead-of-using-formula-index-match-in-every-cells-excel/50712413#50712413", "title": "Using VBA instead of using formula (INDEX &amp; MATCH) in every cells Excel", "body": "<pre><code>Sub FillData()\n\nFor Each cell In Worksheets(\"Data\").Columns(2).Cells\n\n    If cell.Value = \"\" Then Exit Sub    'stop program if no value\n    If WorksheetFunction.IsText(cell.Value) = True Then GoTo line1  'do not perform action if YYYYMM\n\n    Set FindMth = Worksheets(\"Final\").Rows(2).Find(cell.Value)  'Find Month at Final Sheet\n    Set FindItem = Worksheets(\"Final\").Columns(1).Find(cell.Offset(0, -1).Value, lookat:=xlWhole)   'Find Item Number at Final Sheet\n\n    If Not FindMth Is Nothing Then\n        C = FindMth.Column  'Column Month\n    Else        \n        If Worksheets(\"Final\").Range(\"B2\").Value &lt;&gt; \"\" Then\n            Worksheets(\"Final\").Range(\"A2\").End(xlToRight).Offset(0, 1).Value = cell.Value\n            C = Worksheets(\"Final\").Range(\"A2\").End(xlToRight).Column   'Column Month if B2 not empty\n        Else\n            Worksheets(\"Final\").Range(\"B2\").Value = cell.Value\n            C = 2\n        End If\n    End If\n\n    If Not FindItem Is Nothing Then\n        R = FindItem.Row    'Row Item Number\n    Else\n        Worksheets(\"Final\").Range(\"A1\").End(xlDown).Offset(1).Value = cell.Offset(0, -1).Value\n        R = Worksheets(\"Final\").Range(\"A1\").End(xlDown).Row\n    End If\n\n    Worksheets(\"Final\").Cells(R, C).Value = cell.Offset(0, 1).Value 'Assign Order Qty\n    Worksheets(\"Final\").Range(\"B1:\" &amp; Cells(1, C).Address).Merge    'Merge YYYYMM cell\n\nline1:\nNext\n\nEnd Sub\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 131, "user_id": 7700568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac428b78c5437a180445365bd648abdd?s=128&d=identicon&r=PG&f=1", "display_name": "java404", "link": "https://stackoverflow.com/users/7700568/java404"}, "edited": false, "score": 0, "creation_date": 1528266334, "post_id": 50712552, "comment_id": 88435686, "body": "It&#39;s working perfectly. Thanks for your expertise advise and coding."}, {"owner": {"reputation": 131, "user_id": 7700568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac428b78c5437a180445365bd648abdd?s=128&d=identicon&r=PG&f=1", "display_name": "java404", "link": "https://stackoverflow.com/users/7700568/java404"}, "edited": false, "score": 0, "creation_date": 1528277122, "post_id": 50712552, "comment_id": 88442061, "body": "....the current Output is start from Column B. if I want to start from Column H, how can I modify the code? Please advise."}, {"owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "reply_to_user": {"reputation": 131, "user_id": 7700568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac428b78c5437a180445365bd648abdd?s=128&d=identicon&r=PG&f=1", "display_name": "java404", "link": "https://stackoverflow.com/users/7700568/java404"}, "edited": false, "score": 0, "creation_date": 1528279009, "post_id": 50712552, "comment_id": 88443391, "body": "@java404 change the range(s) you call <code>FillTable</code> with to refer to the cells I defined in the answer"}], "tags": [], "owner": {"reputation": 48277, "user_id": 445425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72d4504b4e5a6e3930ebd8a4ae4935c5?s=128&d=identicon&r=PG", "display_name": "chris neilsen", "link": "https://stackoverflow.com/users/445425/chris-neilsen"}, "is_accepted": true, "score": 1, "last_activity_date": 1528261296, "creation_date": 1528261296, "answer_id": 50712552, "question_id": 50711499, "link": "https://stackoverflow.com/questions/50711499/using-vba-instead-of-using-formula-index-match-in-every-cells-excel/50712552#50712552", "title": "Using VBA instead of using formula (INDEX &amp; MATCH) in every cells Excel", "body": "<p>Here's a sample that uses a variant Array to collect the results, so will be Fast.</p>\n\n<p>Assumes you have pre-built your Results Table Item and Number headers </p>\n\n<pre><code>Sub Demo()\n    'Call FillTable with parameters\n    ' Top Left Cell of Source Data range, including headers\n    ' Top Left Cell of Destination Table range, including headers\n    ' Column to match in Source\n    ' Column to return from Source\n    FillTable Worksheets(\"Data\").Range(\"A1\"), Worksheets(\"Final\").Range(\"A2\"), 4, 3\nEnd Sub\n\nSub FillTable(rSrc As Range, rTable As Range, MatchCol As Long, QtyCol As Long)\n    Dim vSrc As Variant, vTable As Variant\n    Dim Items As Variant, Dates As Variant\n    Dim rw As Long, cl As Long\n\n\n    Set rSrc = Range(rSrc.Offset(1, 0), rSrc.End(xlDown)).Resize(, Application.Max(MatchCol, QtyCol))\n    Set rTable = Range(rTable.End(xlToRight).Offset(1, 0), rTable.End(xlDown).Offset(0, 1))\n\n    vSrc = rSrc.Value2\n    vTable = rTable.Value2\n\n    Items = rTable.Columns(0).Value2\n    Dates = rTable.Rows(0).Value2\n\n    For cl = 1 To UBound(vTable, 2)\n    For rw = 1 To UBound(vTable, 1)\n        With Application\n            vTable(rw, cl) = .IfNa(.Index(rSrc.Columns(QtyCol), .Match(Items(rw, 1) &amp; Dates(1, cl), rSrc.Columns(MatchCol), 0)), vbNullString)\n        End With\n    Next rw, cl\n\n    rTable = vTable\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 7700568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac428b78c5437a180445365bd648abdd?s=128&d=identicon&r=PG&f=1", "display_name": "java404", "link": "https://stackoverflow.com/users/7700568/java404"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1163, "favorite_count": 0, "accepted_answer_id": 50712552, "answer_count": 2, "score": 0, "last_activity_date": 1528261296, "creation_date": 1528252522, "last_edit_date": 1528253178, "question_id": 50711499, "link": "https://stackoverflow.com/questions/50711499/using-vba-instead-of-using-formula-index-match-in-every-cells-excel", "title": "Using VBA instead of using formula (INDEX &amp; MATCH) in every cells Excel", "body": "<p>As you can see on the \"Data\" sheet, I have data table like this (Pls see below)</p>\n\n<p><a href=\"https://i.stack.imgur.com/AnXRM.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AnXRM.jpg\" alt=\"Data Sheet\"></a></p>\n\n<p>The Output that I want to be is like this :</p>\n\n<p><a href=\"https://i.stack.imgur.com/C34WC.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/C34WC.jpg\" alt=\"Output Sheet\"></a></p>\n\n<p>Currently in the Output sheet,</p>\n\n<ol>\n<li>I have to manually add-in YYYYMM each column for every month </li>\n<li><p>For each month of the column, I have to put formula to get the Order Qty.\nformula is like this:</p>\n\n<pre><code>=IFNA(INDEX(Data!C:C,(MATCH(A3&amp;$B$2,Data!D:D,0))),\"\")\n</code></pre></li>\n</ol>\n\n<p>The code can give me the Order Qty of each month.</p>\n\n<p>However, what I wanted to do is generate monthly and get the Order Qty by using <strong>VBA</strong>.</p>\n"}, {"tags": ["excel", "listbox", "userform", "vba"], "comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1528267809, "post_id": 50711238, "comment_id": 88436412, "body": "I don&#39;t understand exactly what you mean by &quot;How can I display and at the same time modify the data into my textbox when I click the column inside the listbox?&quot; - Could you describe the wanted steps and results? 1., 2., 3. ... BTW looping through a whole range cell by cell to fill your data array is very time consuming"}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1528316261, "post_id": 50711238, "comment_id": 88465672, "body": "Added a tricky solution to your problem to get the clicked value in a listbox by wrapping it into a \u25bascrolling frame. BTW I improved code to speed up the loading process (cf. above comment), but didn&#39;t change the way you write back the search value to column B in the original range."}, {"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1528317104, "post_id": 50711238, "comment_id": 88466031, "body": "Try to avoid <code>GoTo</code> statements - also known as spaghetti code in former BASIC times. If not you will loose track easily; today these statements occur only in error handling."}], "answers": [{"comments": [{"owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "edited": false, "score": 0, "creation_date": 1528730546, "post_id": 50728729, "comment_id": 88608124, "body": "@Ronald-Morre - would be pleased to hear if my answer solved your Problem. If so you are invited to help other users,too to identify a helpful solution by marking it as accepted (cf. <a href=\"https://stackoverflow.com/help/someone-answers\">stackoverflow.com/help/someone-answers</a>)"}], "tags": [], "owner": {"reputation": 6469, "user_id": 6460297, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a20d70d2e073cd02e653abc40af678db?s=128&d=identicon&r=PG&f=1", "display_name": "T.M.", "link": "https://stackoverflow.com/users/6460297/t-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1528315700, "creation_date": 1528315700, "answer_id": 50728729, "question_id": 50711238, "link": "https://stackoverflow.com/questions/50711238/how-to-collaborate-excel-listbox-as-data-grid-using-search-button-and-shown-in-t/50728729#50728729", "title": "How to collaborate excel listbox as data-grid using search button and shown in the textbox?", "body": "<p><strong>Get clicked value in listbox and write to textbox</strong></p>\n\n<p>Your OP states: \"How can I display and at the same time modify the data into my <em>TextBox</em> when I <strong>click the column inside the listbox</strong>?\" </p>\n\n<blockquote>\n  <p>Actually your question is asking how to get the <strong>clicked column index</strong> in a listbox. Using the helper function <code>getColIndex()</code> you receive this essential information and get easily the clicked data value via the <code>list</code> property for the current listindex. </p>\n</blockquote>\n\n<p>In the code example below I use the listbox <code>MouseUp</code> event to [1] get the clicked column index via the <code>x</code> argument showing the position in points within the listbox based on a cumulated column widths array created when loading data to the listbox and [2] to modify the textbox <code>FbSNtxt</code> with the clicked data value <code>dListBox.List(Me.dListBox.ListIndex, ColIndex)</code>. </p>\n\n<p><strong>Amplifying remark to a tricky method</strong></p>\n\n<p>In order to get the <em>correct column index</em> via the listbox <code>x</code> position, it's necessary to display the \u25ba<strong>entire listbox width</strong> and to wrap it into a <strong>scrolling Frame</strong> (cf. listbox and frame settings in the loading procedure <code>Dloadbtn_Click()</code>)</p>\n\n<p><strong>Declaration head of UserForm</strong></p>\n\n<pre><code>Option Explicit\n\nDim cumulWidths() As Double      ' cumulated column widths\nDim ColIndex      As Integer     ' current column index\n</code></pre>\n\n<p><strong>A. Solution via Listbox MouseUp event</strong></p>\n\n<p>IMO it's the best to use the \u25ba <strong><code>MouseUp</code></strong> event to get the horizontal position (in points) within the listbox via ist <code>x</code> argument as you get the actual listindex only there (and not already in the <code>MouseDown</code> event). Furthermore it gets triggered in any case, whereas the <code>click</code> event only once within the same row.</p>\n\n<pre><code>Private Sub dListBox_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)\n' Purpose: find search value in first column and write it to corresponding row in range (column B)\n' Escape if no data\n  If dListBox.ListIndex &lt; 0 Then Exit Sub\n' [1] get the column index via helper function getColIndex\n  ColIndex = getColIndex(X)\n' [2] get clicked data in column ColIndex and write it into textbox (i.e. modify latest value)\n  FbSNtxt.Text = Me.dListBox.List(Me.dListBox.ListIndex, ColIndex)\nEnd Sub\n</code></pre>\n\n<p><em>\u25baHelper function to get the current column index</em></p>\n\n<pre><code>Private Function getColIndex(ByVal X) As Integer\n' Purpose: get column number analyzing your click position x\n' Method:  uses array cumulWidths (created by Dloadbtn_Click() calling initCumulWidths)\n' Note:    called by dListBox_MouseUp event\nDim i As Integer\nFor i = 0 To UBound(cumulWidths)\n    If X &lt; cumulWidths(i) Then\n       getColIndex = i          ' return value (listbox index is zero based)\n       Exit For\n    End If\nNext i\nEnd Function\n</code></pre>\n\n<p><strong>B. Improved search procedures</strong></p>\n\n<pre><code>Private Sub DSearchbtn_Click()\n' Purpose: find search value in first column and write it to corresponding row in range (column B)\n' Method:  calls procedure dSearch\n  dSearch\nEnd Sub\n\nPrivate Sub dSearch()\n' Purpose: find value in first column and write it to corresponding row in range (column B)\n' Note:  called a) by dListBox_DblClick or b) DSearchbtn_Click()\nIf Me.dListBox.ListCount = 0 Then Exit Sub\nDim i As Long, bFound As Boolean\n'Dim Colodbs As Worksheet\n'Set Colodbs = ThisWorkbook.Worksheets(\"Colodbs\")\nFor i = 0 To Me.dListBox.ListCount - 1\n    If Me.dListBox.List(i, 0) = FbSNtxt.Text Then\n       ' write to cell in found row (i+1, Column B)\n         Colodbs.Cells(i + 1, 2).Value = FbSNtxt.Text\n       ' correct ListBox value in Column B\n         Me.dListBox.List(i, 1) = FbSNtxt.Text\n       bFound = True: Exit For\n    End If\nNext i\nIf Not bFound Then\n   MsgBox FbSNtxt.Text &amp; \" ColIndex \" &amp; ColIndex &amp; \" not found.\", vbInformation\nEnd If\nEnd Sub\n</code></pre>\n\n<p><strong>C. Loading procedures</strong></p>\n\n<p>Improved CommandButton code to speed up the loading process by assigning the range in one statement and using <em>subprocedure</em> <strong>initCumulWidths</strong>. </p>\n\n<pre><code>Private Sub Dloadbtn_Click()\n'Purpose: Load Diret Colo data into Direct Colo Listbox data grid.\n\nDim ws  As Worksheet\nDim rng As Range\nDim hd  As Range\nDim Myarray As Variant\n\n'~~&gt; Change your sheetname here\nSet ws = ThisWorkbook.Worksheets(\"Colodbs\")\n\n'~~&gt; Set yourrelevant range here\nSet rng = ws.Range(\"A1:N10000\")\n\nWith Me.dListBox\n    .Clear\n    .ColumnHeads = False\n    .ColumnCount = rng.Columns.Count\n\n    ' -----------------------------------------------------\n    ' Variant a): assign data to array and array to listbox\n    ' -----------------------------------------------------\n    '    Myarray = rng\n    '    .List = Myarray\n\n    ' -----------------------------------------------------\n    ' Variant b): assign data in one step to listbox\n    ' -----------------------------------------------------\n      .List = rng.Value2\n    '~~&gt; Set the column widths of the column here.\n      .ColumnWidths = \"50;70;30;50;30;120;120;30;150;30;50;50;70;200\"\n      .TopIndex = 0\n\n    ' =====================================================\n    ' calls subprocedure to cumulate column widths\n    ' -----------------------------------------------------\n      initCumulWidths\n    ' set total width of listbox to max as it gets shown within a frame\n      .Width = cumulWidths(UBound(cumulWidths)) + 16\n    ' set scroll width within frame\n      Frame1.ScrollWidth = .Width ' Frame1.InsideWidth * 4\n\nEnd With\n\nEnd Sub\n</code></pre>\n\n<p><em>\u25baSubprocedure called by above CommandButton Click event to get cumulated widths</em></p>\n\n<p>This subprocedure reads the columnwidths described in Points and assigns cumulated values to an array defined in the Userform module's declaration head.</p>\n\n<pre><code>Private Sub initCumulWidths()\n' Purpose: calculate cumulated widths and assign values to common userform variable cumulWidths\n' Method:  splits ColumnWidths property of listbox and sums converted Point values\n' Note: called by above Dloadbtn_Click() event\n  Dim a: a = Split(Me.dListBox.ColumnWidths, \";\")\n  Dim previous As Double, i As Integer\n  ReDim cumulWidths(UBound(a))\n  For i = 0 To UBound(a)\n      cumulWidths(i) = val(Replace(a(i), \" Pt\", \"\")) + previous\n      previous = cumulWidths(i)\n  Next i\n  If UBound(a) &gt; 0 Then\n     Debug.Print cumulWidths(UBound(a))\n  End If\nEnd Sub\n</code></pre>\n\n<p><strong>Additional note</strong></p>\n\n<p>As you didn't declare <code>Colodbs</code> as Worksheet in your search procedures, I assume you are using the <code>CodeName</code> property instead of an object.</p>\n"}], "owner": {"reputation": 21, "user_id": 9900628, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Ronald Morre", "link": "https://stackoverflow.com/users/9900628/ronald-morre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 414, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1528328837, "creation_date": 1528250371, "last_edit_date": 1531164843, "question_id": 50711238, "link": "https://stackoverflow.com/questions/50711238/how-to-collaborate-excel-listbox-as-data-grid-using-search-button-and-shown-in-t", "title": "How to collaborate excel listbox as data-grid using search button and shown in the textbox?", "body": "<p>I have this code to show all my data in the sheets and load them into the listbox. How can I display and at the same time modify the data into my textbox when I clicking the column inside the listbox?</p>\n\n<pre><code>Private Sub Dloadbtn_Click()\n\n'Load Diret Colo data into Direct Colo Listbox data grid.\n\nDim ws As Worksheet\nDim rng As Range\nDim hd As Range\nDim i As Long, j As Long, rw As Long\nDim Myarray() As String\n\n'~~&gt; Change your sheetname here\nSet ws = Sheets(\"Colodbs\")\n\n'~~&gt; Set you relevant range here\nSet rng = ws.Range(\"A1:N10000\")\n\nWith Me.Dlistbox\n    .Clear\n    .ColumnHeads = False\n    .ColumnCount = rng.Columns.count\n\n    ReDim Myarray(rng.Rows.count, rng.Columns.count)\n\n    rw = 0\n\n    For i = 1 To rng.Rows.count\n        For j = 0 To rng.Columns.count\n            Myarray(rw, j) = rng.Cells(i, j + 1)\n        Next\n        rw = rw + 1\n    Next\n\n    .List = Myarray\n\n    '~~&gt; Set the widths of the column here. Ex: For 5 Columns\n    '~~&gt; Change as Applicable\n    .ColumnWidths = \"50;70;30;50;30;120;120;30;150;30;50;50;70;200\"\n    .TopIndex = 0\nEnd With\nEnd Sub\n\nPrivate Sub DSearchbtn_Click()\n\nDim i As Long\nDim rno As Integer\ni = 0\n\nDo While Colodbs.Cells(i + 1, 1).Value &lt;&gt; \"\"\n\n        If Colodbs.Cells(i + 1, 1).Value = FbSNtxt.Text Then\n\n            rno = Colodbs.Cells(i + 1, 1).Row\n            GoTo Condition\n        Else\n        rno = 0\n\n        End If\n    i = i + 1\nLoop\n\nCondition:\nIf rno &lt;&gt; 0 Then\n    Colodbs.Cells(rno, 2).Value = FbSNtxt.Text\nElse\n    MsgBox (\"No Such number is found\")\nEnd If\nEnd Sub\n</code></pre>\n"}, {"tags": ["vba", "excel"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528250471, "post_id": 50711210, "comment_id": 88431436, "body": "Disable screen updating and run 2 separate loops"}, {"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528250680, "post_id": 50711210, "comment_id": 88431477, "body": "deactivate it before loop and activate it again after loop?"}, {"owner": {"reputation": 71123, "user_id": 6241235, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/dCxzx.png?s=128&g=1", "display_name": "QHarr", "link": "https://stackoverflow.com/users/6241235/qharr"}, "edited": false, "score": 0, "creation_date": 1528354514, "post_id": 50711210, "comment_id": 88477182, "body": "What does it doesn&#39;t work mean? Is there an error? What happens? Also, where are lastRow and val1,2,3 assigned? And where is i declared?"}], "answers": [{"tags": [], "owner": {"reputation": 586, "user_id": 9633414, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a17a4ec5f0dbe53ee0a2153b37138b17?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/9633414/j-doe"}, "is_accepted": false, "score": 1, "last_activity_date": 1528258814, "creation_date": 1528258814, "answer_id": 50712217, "question_id": 50711210, "link": "https://stackoverflow.com/questions/50711210/looping-through-ranges-in-different-sheets-excel/50712217#50712217", "title": "Looping through ranges in different sheets (Excel)", "body": "<p><code>.Range(i, 2)</code> seems wrong. Prefer <code>Cells(Row,Column)</code> when looping through rows/columns.</p>\n\n<pre><code>For i = 1 to LastRow\n\nWith Worksheets(\"Project_Name\")\n  .Cells(i, 1).Value = val1\n  .Cells(i, 2).Value = val2\nEnd With\n\nWith Worksheets(\"Admin\")\n  .Cells(i, 1).Value = val3\nEnd With\n\nNext i\n</code></pre>\n\n<p>Is working fine on both sheets on my set up.</p>\n"}, {"comments": [{"owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 0, "creation_date": 1528326705, "post_id": 50713141, "comment_id": 88469404, "body": "Does that mean I cannot do a single loop in two sheets?"}, {"owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "reply_to_user": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "edited": false, "score": 0, "creation_date": 1528351541, "post_id": 50713141, "comment_id": 88475681, "body": "If the last Row is the same cell on the both of sheet, you can  move With ws_admin   .Cells(i, 1).Value = val3 End With in the first loop and delete the last loop."}], "tags": [], "owner": {"reputation": 1236, "user_id": 9839748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sUzkp.jpg?s=128&g=1", "display_name": "JC Guidicelli", "link": "https://stackoverflow.com/users/9839748/jc-guidicelli"}, "is_accepted": true, "score": 2, "last_activity_date": 1528354302, "last_edit_date": 1528354302, "creation_date": 1528264798, "answer_id": 50713141, "question_id": 50711210, "link": "https://stackoverflow.com/questions/50711210/looping-through-ranges-in-different-sheets-excel/50713141#50713141", "title": "Looping through ranges in different sheets (Excel)", "body": "<p>Try this and adapt the vars, it's work for me (note that .Range is remplaced  by .Cells) :</p>\n\n<pre><code>Sub test2()\n\n' Active workbook\nDim wb As Workbook\nSet wb = ThisWorkbook\nDim i As Integer\n\n'*******************************************\n'Adapt this vars\n\n\n'define your sheets\nDim ws_pname As Worksheet\nDim ws_admin As Worksheet\nSet ws_pname = wb.Sheets(\"Project_Name\")\nSet ws_admin = wb.Sheets(\"Admin\")\n\n'define your values\nDim val1 As String\nDim val2 As String\nDim val3 As String\n\nval1 = \"test_val1\"\nval2 = \"test_val2\"\nval3 = \"test_val3\"\n\n'definie the last Rows\nDim lastRow_pname As Integer\nDim lastRow_admin As Integer\n\nlastRow_pname = ws_pname.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\nlastRow_admin = ws_admin.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n'*******************************************\n\nFor i = 1 To lastRow_pname\n\n\nWith ws_pname\n  .Cells(i, 1).Value = val1\n  .Cells(i, 2).Value = val2\nEnd With\n\nNext i\n\nFor i = 1 To lastRow_admin\nWith ws_admin\n  .Cells(i, 1).Value = val3\nEnd With\n  Next i\n\nEnd Sub\n</code></pre>\n\n<p><strong>EDIT :</strong> Code below to have only one loop.</p>\n\n<pre><code>Sub test2()\n\n' Active workbook\nDim wb As Workbook\nSet wb = ThisWorkbook\nDim i As Integer\n\n'*******************************************\n'Adapt this vars\n\n\n'define your sheets\nDim ws_pname As Worksheet\nDim ws_admin As Worksheet\nSet ws_pname = wb.Sheets(\"Project_Name\")\nSet ws_admin = wb.Sheets(\"Admin\")\n\n'define your values\nDim val1 As String\nDim val2 As String\nDim val3 As String\n\nval1 = \"test_val1\"\nval2 = \"test_val2\"\nval3 = \"test_val3\"\n\n'definie the last Rows\nDim lastRow_pname As Long\nDim lastRow_admin As Long\nDim lastRow As Long\n\nlastRow_pname = ws_pname.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\nlastRow_admin = ws_admin.Range(\"A\" &amp; Rows.Count).End(xlUp).Row + 1\n'*******************************************\n\n'determine biggest last row\nIf lastRow_pname &gt;= lastRow_admin Then\n    lastRow = lastRow_pname\nElse\n    lastRow = lastRow_admin\nEnd If\n\n\nFor i = 1 To lastRow\n\n    If i &lt;= lastRow_pname Then\n      With ws_pname\n        .Cells(i, 1).Value = val1\n        .Cells(i, 2).Value = val2\n      End With\n    End If\n\n    If i &lt;= lastRow_admin Then\n      With ws_admin\n        .Cells(i, 1).Value = val3\n      End With\n    End If\n\nNext i\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 1009, "user_id": 8981066, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-HFh7Jm-OT-E/AAAAAAAAAAI/AAAAAAAABl8/oDH6HzC4eFw/photo.jpg?sz=128", "display_name": "Oday Salim", "link": "https://stackoverflow.com/users/8981066/oday-salim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2042, "favorite_count": 0, "accepted_answer_id": 50713141, "answer_count": 2, "score": 2, "last_activity_date": 1528354302, "creation_date": 1528250035, "question_id": 50711210, "link": "https://stackoverflow.com/questions/50711210/looping-through-ranges-in-different-sheets-excel", "title": "Looping through ranges in different sheets (Excel)", "body": "<p>I have two sheets: 'Project_Name' and 'Admin'. </p>\n\n<p>I also have a set of data on both. I have a code that attempts to loop through data in both sheets, but it does not work.</p>\n\n<p>Code works if loop is only done on one sheet, but not both. I am not sure what the problem is? </p>\n\n<pre><code>Dim val1 As String\nDim val2 As String\nDim val3 As String\n\nFor i = 1 to LastRow\n\nWith Worksheets(\"Project_Name\")\n  .Range(i, 1).Value = val1\n  .Range(i, 2).Value = val2\nEnd With\n\nWith Worksheets(\"Admin\")\n  .Range(i, 1).Value = val3\nEnd With\n\nNext i\n</code></pre>\n"}, {"tags": ["excel", "vba", "outlook", "hyperlink", "ms-word"], "comments": [{"owner": {"reputation": 111, "user_id": 9459609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/633ac4ebf02493111c5474380384c433?s=128&d=identicon&r=PG&f=1", "display_name": "aicirtap", "link": "https://stackoverflow.com/users/9459609/aicirtap"}, "edited": false, "score": 0, "creation_date": 1528249944, "post_id": 50711193, "comment_id": 88431345, "body": "I really need help on this issue, please help."}, {"owner": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1528269473, "post_id": 50711193, "comment_id": 88437427, "body": "I usually add it in plain old html: <code>&quot;Contact the &lt;a href=&quot; &amp; Chr(34) &amp; &quot;mailto:whatever@whatever.com&quot; &amp; Chr(34) &amp; &quot;&gt;Support Team&lt;&#47;a&gt;.&quot;</code>"}, {"owner": {"reputation": 23462, "user_id": 3077495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZE6fb.png?s=128&g=1", "display_name": "Cindy Meister", "link": "https://stackoverflow.com/users/3077495/cindy-meister"}, "edited": false, "score": 0, "creation_date": 1528290734, "post_id": 50711193, "comment_id": 88450943, "body": "I already tried helping you with the same question, which you&#39;ve apparently now deleted. If you can&#39;t answer the questions people ask you when they try to help then you may not ever get a satisfactory answer."}, {"owner": {"reputation": 111, "user_id": 9459609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/633ac4ebf02493111c5474380384c433?s=128&d=identicon&r=PG&f=1", "display_name": "aicirtap", "link": "https://stackoverflow.com/users/9459609/aicirtap"}, "reply_to_user": {"reputation": 6200, "user_id": 7923463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8063a07902a59be5f26d31626600dee?s=128&d=identicon&r=PG&f=1", "display_name": "Kostas K.", "link": "https://stackoverflow.com/users/7923463/kostas-k"}, "edited": false, "score": 0, "creation_date": 1528338175, "post_id": 50711193, "comment_id": 88472093, "body": "@KostasK. i need to insert it at the bottom part of the body of the email and i can&#39;t use html because it has been used at the start of my email, by the way thanks for the insights."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 9459609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/633ac4ebf02493111c5474380384c433?s=128&d=identicon&r=PG&f=1", "display_name": "aicirtap", "link": "https://stackoverflow.com/users/9459609/aicirtap"}, "edited": false, "score": 0, "creation_date": 1528874124, "post_id": 50748221, "comment_id": 88666477, "body": "how can i add a signature at the bottom part of the code?"}, {"owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "reply_to_user": {"reputation": 111, "user_id": 9459609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/633ac4ebf02493111c5474380384c433?s=128&d=identicon&r=PG&f=1", "display_name": "aicirtap", "link": "https://stackoverflow.com/users/9459609/aicirtap"}, "edited": false, "score": 0, "creation_date": 1528887705, "post_id": 50748221, "comment_id": 88674836, "body": "Search the site and if necessary ask a new question."}], "tags": [], "owner": {"reputation": 7058, "user_id": 1571407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yIpMW.png?s=128&g=1", "display_name": "niton", "link": "https://stackoverflow.com/users/1571407/niton"}, "is_accepted": true, "score": 1, "last_activity_date": 1528397086, "creation_date": 1528397086, "answer_id": 50748221, "question_id": 50711193, "link": "https://stackoverflow.com/questions/50711193/inserting-hyperlink-in-outlook-body-using-word-vba/50748221#50748221", "title": "Inserting hyperlink in Outlook body using Word VBA", "body": "<p>Move the selection to the end of the message then insert the hyperlink.</p>\n\n<pre><code>'Reference to Word Object Library required\n objSel.EndKey Unit:=wdStory\n\n' Reference to Word Object Library not required\nobjSel.EndKey Unit:=6\n</code></pre>\n\n<p>This is a less noisy example than the code in your question.</p>\n\n<pre><code>Sub AUTOMAIL()\n\n    Dim ol As Object 'Outlook.Application\n    Dim olEmail As Object 'Outlook.MailItem\n    Dim olInsp As Object 'Outlook.Inspector\n    Dim wd As Object 'Word.Document\n\n     '/* if outlook is running use GO, create otherwise */\n    Set ol = GetObject(Class:=\"Outlook.Application\")\n    Set olEmail = ol.CreateItem(0) 'olMailItem\n\n    With olEmail\n\n        '/* bonus basic html */\n        .HTMLBody = \"&lt;html&gt;&lt;body style=\"\"font-family:calibri\"\"&gt;\" &amp; _\n                    \"&lt;p&gt;&lt;b&gt;Dear All,&lt;/b&gt;&lt;br&gt;&lt;br&gt; Please see below summary of invoices and links to the &lt;b&gt;Volume Tracker&lt;/b&gt; and &lt;b&gt;Ageing Report&lt;/b&gt; (Data Entry and Workflow).\" &amp; _\n                    \"&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;\"\n\n        Set olInsp = .GetInspector\n        If olInsp.EditorType = 4 Then 'olEditorWord\n            Set wd = olInsp.WordEditor\n            wd.Range.InsertParagraphAfter\n        End If\n\n        wd.Paragraphs(wd.Paragraphs.Count).Range.Text = Chr(11) &amp; \"Please click on this link to view the details:\" &amp; vbCrLf &amp; \"Those who are encountering problems accessing the Sharepoint site, please refer to attachment for Data Entry and Workflow Report. \" &amp; Chr(11) &amp; \"Please note though that the file has been truncated, complete details of the report are available in the links indicated above.\" &amp; Chr(11) &amp; Chr(11) &amp; \"Should you have questions/clarifications, kindly reach out to Service Management at\"\n\n        wd.Range.InsertParagraphAfter\n\n        Dim objSel As Object\n        Set objSel = wd.Windows(1).Selection\n\n        'Reference to Word Object Library required\n        'objSel.EndKey Unit:=wdStory\n\n        ' Reference to Word Object Library not required\n        objSel.EndKey Unit:=6\n\n        wd.Range.Hyperlinks.Add Anchor:=objSel.Range, _\n          Address:=\"mailto:Service_Management@xyz.com\"\n\n        .Display\n\n    End With\n\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 111, "user_id": 9459609, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/633ac4ebf02493111c5474380384c433?s=128&d=identicon&r=PG&f=1", "display_name": "aicirtap", "link": "https://stackoverflow.com/users/9459609/aicirtap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1175, "favorite_count": 0, "accepted_answer_id": 50748221, "answer_count": 1, "score": 0, "last_activity_date": 1592986542, "creation_date": 1528249903, "last_edit_date": 1592986542, "question_id": 50711193, "link": "https://stackoverflow.com/questions/50711193/inserting-hyperlink-in-outlook-body-using-word-vba", "title": "Inserting hyperlink in Outlook body using Word VBA", "body": "<p>How can I add a hyperlink to the last part of my email combining with a text?</p>\n\n<p>This must be the last sentence in my paragraph </p>\n\n<blockquote>\n  <p>\"Should you have questions/clarifications, kindly reach out to Service Management at Service_Management@xyz.com\"</p>\n</blockquote>\n\n<p>The word \"Service_Management@xyz.com\" must have a hyperlink.</p>\n\n<p>I tried editing the code from this:</p>\n\n<pre><code>wd.Hyperlinks.Add wd.Range(wd.Paragraphs.Count), _\n  \"mailto:Service_Management@xyz.com\" &amp; \"Service_Management@xyz.com\"\n</code></pre>\n\n<p>The problem is the bottom part of the body of email becomes a link. And there is no text display at the body of the email. How do I declare the link properly so it won't affect the other part of the range?</p>\n\n<pre><code> Sub AUTOMAIL()\n\n    Dim ol As Object 'Outlook.Application\n    Dim olEmail As Object 'Outlook.MailItem\n    Dim olInsp As Object 'Outlook.Inspector\n    Dim wd As Object 'Word.Document\n    Dim rCol As Collection, r As Range, i As Integer\n    Dim Table1 As Collection\n\n    Dim ETo As String\n    Dim CTo As String\n\n    ETo = Join(Application.Transpose(Worksheets(\"Data Entry\").Range(\"AD5:AD100\").Value), \";\")\n    CTo = Join(Application.Transpose(Worksheets(\"Data Entry\").Range(\"AI5:AI15\").Value), \";\")\n\n     '/* if outlook is running use GO, create otherwise */\n    Set ol = GetObject(Class:=\"Outlook.Application\")\n    Set olEmail = ol.CreateItem(0) 'olMailItem\n\n    Set Table1 = New Collection\n\n    With Table1\n        .Add Sheet14.Range(\"A1:O20\")\n    End With\n\n    Set rCol = New Collection\n    With rCol   \n        .Add Sheet11.Range(\"a1:i1\", \"a6:i20\")\n        .Add Sheet10.Range(\"a1:i1\", \"A6:I20\")\n        .Add Sheet9.Range(\"A1:J18\")\n    End With\n\n    With olEmail\n        .To = ETo\n        .CC = CTo\n        .Subject = \"Step+ Volume Tracker, Data Entry/Workflow Ageing Report and Rejection Report | \" &amp; Format(Date, \"MMMM dd, yyyy\") &amp; \" | 9:15AM\"\n\n        '/* bonus basic html */\n        .HTMLBody = \"&lt;html&gt;&lt;body style=\"\"font-family:calibri\"\"&gt;\" &amp; _\n                    \"&lt;p&gt;&lt;b&gt;Dear All,&lt;/b&gt;&lt;br&gt;&lt;br&gt; Please see below summary of invoices and links to the &lt;b&gt;Volume Tracker&lt;/b&gt; and &lt;b&gt;Ageing Report&lt;/b&gt; (Data Entry and Workflow).\" &amp; _\n                    \"&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;\"\n\n           Set olInsp = .GetInspector\n           If olInsp.EditorType = 4 Then 'olEditorWord\n               Set wd = olInsp.WordEditor\n               For i = 1 To Table1.Count '/* iterate all ranges */\n                   Set r = Table1.Item(i): r.Copy\n                   wd.Range.insertparagraphafter\n                   wd.Paragraphs(wd.Paragraphs.Count).Range.PasteAndFormat 16\n                   '16 - wdFormatOriginalFormatting\n            Next\n        End If\n        wd.Paragraphs(wd.Paragraphs.Count).Range.Text = Chr(11) &amp; \"Please click on this link to view the details:\"\n\n        Set olInsp = .GetInspector\n        If olInsp.EditorType = 4 Then 'olEditorWord\n            Set wd = olInsp.WordEditor\n            For i = 1 To rCol.Count '/* iterate all ranges */\n                Set r = rCol.Item(i): r.Copy\n                wd.Range.insertparagraphafter\n                wd.Paragraphs(wd.Paragraphs.Count).Range.PasteAndFormat 16\n                '16 - wdFormatOriginalFormatting\n            Next\n        End If\n\n        wd.Paragraphs(wd.Paragraphs.Count).Range.Text = Chr(11) &amp; \"Please click on this link to view the details:\" &amp; vbCrLf &amp; \"Those who are encountering problems accessing the Sharepoint site, please refer to attachment for Data Entry and Workflow Report. \" &amp; Chr(11) &amp; \"Please note though that the file has been truncated, complete details of the report are available in the links indicated above.\" &amp; Chr(11) &amp; Chr(11) &amp; \"Should you have questions/clarifications, kindly reach out to Service Management at\"\n        wd.Range(wd.Paragraphs(wd.Paragraphs.Count).Range.Characters(98).Start, _\n        wd.Paragraphs(wd.Paragraphs.Count).Range.Characters(128).End).Font.Bold = True\n\n        wd.Range.Hyperlinks.Add Anchor:=wd.Range, _\n        Address:=\"mailto:Service_Management@xyz.com\"\n        wd.Range.Font.Size = 10\n        .Display\n\n    End With\n\nEnd Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "comments": [{"owner": {"reputation": 22213, "user_id": 7008044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c6cc9d1d49f6edcfa73e6c15d2ad58b?s=128&d=identicon&r=PG", "display_name": "SJR", "link": "https://stackoverflow.com/users/7008044/sjr"}, "edited": false, "score": 1, "creation_date": 1528266372, "post_id": 50711117, "comment_id": 88435707, "body": "<code>Range(&quot;b2:b&quot;)</code> is not a valid range."}], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 9399360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a986754f4d2ce4bfc8973a96000684de?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Holder", "link": "https://stackoverflow.com/users/9399360/jessica-holder"}, "edited": false, "score": 0, "creation_date": 1530791491, "post_id": 50713737, "comment_id": 89362825, "body": "Thank you for this\u2014. Sorry for the delay in responding...  B"}], "tags": [], "owner": {"reputation": 10269, "user_id": 4914662, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IROda.jpg?s=128&g=1", "display_name": "paul bica", "link": "https://stackoverflow.com/users/4914662/paul-bica"}, "is_accepted": false, "score": 0, "last_activity_date": 1528267183, "creation_date": 1528267183, "answer_id": 50713737, "question_id": 50711117, "link": "https://stackoverflow.com/questions/50711117/using-variant-array-to-update-cells/50713737#50713737", "title": "Using variant array to update cells", "body": "<p>Your code:</p>\n\n<ul>\n<li>declares and assigns <code>objWBtoAdd</code> and <code>newWS</code> but they're not used anywhere</li>\n<li>variables <code>i</code> and <code>cell</code> are also not used</li>\n<li>It simply attempts to assign an invalid range <code>.Range(\"b2:b\").Value</code> to another Range variable</li>\n<li>Then the Range variable back to the invalid range, without modifying the values</li>\n</ul>\n\n<p>This notation is not a valid Range: <code>.Range(\"b2:b\")</code></p>\n\n<ul>\n<li>It should contain the address of 1st cell - <code>\"B2\"</code> &amp; <code>\":\"</code> &amp; <code>\"B9\"</code> (address of last cell in range)</li>\n</ul>\n\n<p>If you need to <em>\"update the second column by adding an apostrophe to the beginning of each cell in the range\"</em> and copy the column to a new sheet, try the code bellow</p>\n\n<hr>\n\n<pre><code>Option Explicit\n\nPrivate Sub cmdTest_Click()\n\n    Const INI_PATH = \"C:\\TEST\\Drop\\Bank.xlsx\"\n    Const NEW_PATH = \"C:\\TEST\\Drop\\BankNew.xlsx\"\n\n    Dim xlApp As Excel.Application: Set xlApp = New Excel.Application\n    Dim wbIni As Excel.Workbook:    Set wbIni = xlApp.Workbooks.Open(INI_PATH, , False)\n    Dim wbNew As Excel.Workbook:    Set wbNew = xlApp.Workbooks.Add\n\n    Dim ws As Excel.Worksheet, colBIni As Range, colBNew As Range, lr As Long\n\n    'xlApp.Visible = True\n    Set ws = wbIni.ActiveSheet  'Prefer explicit: Set ws = wbIni.Worksheets(\"Sheet3\")\n\n    lr = ws.Cells(ws.Rows.Count, \"B\").End(xlUp).Row\n\n    Set colBIni = ws.Range(ws.Cells(2, \"B\"), ws.Cells(lr, \"B\"))\n    Set ws = wbNew.ActiveSheet  'Prefer explicit: Set ws = wbNew.Worksheets(\"Sheet1\")\n    Set colBNew = ws.Range(ws.Cells(2, \"B\"), ws.Cells(lr, \"B\"))\n\n    Dim arr As Variant, r As Long\n\n    arr = colBIni.Value2            'copy colB to array\n    For r = 1 To UBound(arr)\n        arr(r, 1) = \"'\" &amp; arr(r, 1) 'modify array values\n    Next\n    'colBIni.Value2 = arr           'paste array to colB (Ini file)\n    colBNew.Value2 = arr            'paste array to colB (New file)\n\n    wbNew.Close SaveChanges:=True, Filename:=NEW_PATH   'Save new File\n    wbIni.Close SaveChanges:=False\nEnd Sub\n</code></pre>\n\n<hr>\n\n<p>.</p>\n\n<p>If column B contains only formulas, or URLs you don't need to use a <code>For</code> loop</p>\n\n<pre><code>With ws.UsedRange.Columns(\"B\")  'all cells with data (and formatting) in column B\n    .Replace \"=\", \"'=\"\n    .Replace \"https://\", \"'https://\"\nEnd With\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 9399360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a986754f4d2ce4bfc8973a96000684de?s=128&d=identicon&r=PG&f=1", "display_name": "Jessica Holder", "link": "https://stackoverflow.com/users/9399360/jessica-holder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1528267183, "creation_date": 1528249120, "last_edit_date": 1531164843, "question_id": 50711117, "link": "https://stackoverflow.com/questions/50711117/using-variant-array-to-update-cells", "title": "Using variant array to update cells", "body": "<p>In the following subset of code, I am trying to have Excel vba update the second column by adding an apostrophe to the beginning of each cell in the range. How do I reference each cell to add apostrophe to after this line:</p>\n\n<blockquote>\n  <p>myRange = .Range(\"b2:b\").Value</p>\n</blockquote>\n\n<p>Here is the rest of the code so far:</p>\n\n<pre><code>&gt; Private Sub cmdTest_Click()\n&gt; \n&gt; Dim objExcel As Excel.Application Dim objWB As Excel.Workbook Dim\n&gt; objWBtoAdd As Excel.Workbook Dim newWS As Excel.Worksheet Dim objWS As\n&gt; Excel.Worksheet Dim i As Long Dim myRange As Range Dim Cell As Range\n&gt; \n&gt;   Set objExcel = New Excel.Application   objExcel.Visible = True   Set\n&gt; objWB = Workbooks.Open(\"C:\\TEST\\Drop\\Bank.xlsx\", , False) Set\n&gt; objWBtoAdd = Workbooks.Add Set newWS = objWBtoAdd.ActiveSheet   Set\n&gt; objWS = objWB.ActiveSheet\n&gt;  \n&gt;     With objWS\n&gt;    \n&gt;         \n&gt;         myRange = .Range(\"b2:b\").Value\n&gt;         \n&gt;         .Range(\"b2:b\").Value = myRange\n&gt;         \n&gt;                  \n&gt;     \n&gt;     End With\n&gt; \n&gt;  \n&gt; \n&gt; \n&gt; \n&gt; End Sub\n</code></pre>\n"}, {"tags": ["excel", "vba"], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 9542263, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/av9ZD.png?s=128&g=1", "display_name": "Customizer", "link": "https://stackoverflow.com/users/9542263/customizer"}, "is_accepted": false, "score": 2, "last_activity_date": 1528248173, "creation_date": 1528248173, "answer_id": 50711012, "question_id": 50710973, "link": "https://stackoverflow.com/questions/50710973/vba-manipulate-large-csv-file-using-sql-statement/50711012#50711012", "title": "VBA manipulate large csv file using SQL statement", "body": "<p>One option is to use ADO to read the CSV file as a recordset.  That will allow you to then make use of the recordset's .Filter property to apply the user's filter.</p>\n\n<p>This answer to another question shows how to open the file as a recordset:\n<a href=\"https://stackoverflow.com/a/11637197/9542263\">https://stackoverflow.com/a/11637197/9542263</a></p>\n\n<p>You'll want to check on how memory intensive this is since you've indicated that your CSV file will be quite large.</p>\n"}, {"tags": [], "owner": {"reputation": 15100, "user_id": 5212614, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/tITr9.jpg?s=128&g=1", "display_name": "ASH", "link": "https://stackoverflow.com/users/5212614/ash"}, "is_accepted": false, "score": 0, "last_activity_date": 1529756231, "creation_date": 1529756231, "answer_id": 51001081, "question_id": 50710973, "link": "https://stackoverflow.com/questions/50710973/vba-manipulate-large-csv-file-using-sql-statement/51001081#51001081", "title": "VBA manipulate large csv file using SQL statement", "body": "<p>You should have a few options available to you.  Consider the following VBA code.</p>\n\n<pre><code>Sub TryThis()\nDim sSQLQry As String\nDim ReturnArray\n\nDim Conn As New ADODB.Connection\nDim mrs As New ADODB.Recordset\n\nDim DBPath As String, sconnect As String\n\nDBPath = \"C:\\Users\\Excel\\Desktop\\\"\n\nsconnect = \"Provider=Microsoft.Jet.OLEDB.4.0;Data Source=\" &amp; DBPath &amp; \";Extended Properties='text;HDR=YES;FMT=Delimited'\"\n\nConn.Open sconnect\n    sSQLSting = \"SELECT * From CSV1.csv WHERE ID = 2\"\n    mrs.Open sSQLSting, Conn\n        ActiveSheet.Range(\"A2\").CopyFromRecordset mrs\n    'Close Recordset\n    mrs.Close\n\nConn.Close\n\nEnd Sub\n</code></pre>\n\n<p>File looks like this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/aOjS0.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aOjS0.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>After the code runs, you get this.</p>\n\n<p><a href=\"https://i.stack.imgur.com/ckje3.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ckje3.jpg\" alt=\"enter image description here\"></a>\nAlso, see the link below.</p>\n\n<p><a href=\"https://blogs.technet.microsoft.com/josebda/2017/02/12/loading-csvtext-files-with-more-than-a-million-rows-into-excel/\" rel=\"nofollow noreferrer\">https://blogs.technet.microsoft.com/josebda/2017/02/12/loading-csvtext-files-with-more-than-a-million-rows-into-excel/</a></p>\n\n<p>Finally, consider using Power Pivot, which is a free AddIn.</p>\n\n<p><a href=\"https://professor-excel.com/how-to-work-with-large-data-and-powerpivot/\" rel=\"nofollow noreferrer\">https://professor-excel.com/how-to-work-with-large-data-and-powerpivot/</a></p>\n"}], "owner": {"reputation": 898, "user_id": 6523898, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/935c79bf76880f06154ee0090d22b593?s=128&d=identicon&r=PG&f=1", "display_name": "VincFort", "link": "https://stackoverflow.com/users/6523898/vincfort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3176, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1529756231, "creation_date": 1528247764, "question_id": 50710973, "link": "https://stackoverflow.com/questions/50710973/vba-manipulate-large-csv-file-using-sql-statement", "title": "VBA manipulate large csv file using SQL statement", "body": "<p>I am not sure if this question makes sense/is dumb or is not specific enough. Please advise.</p>\n\n<p>I need to create an excel macro that will output part of a large csv file that meet a certain criteria. </p>\n\n<p>For example, in the csv, there is a list of 20m or so phone numbers with other columns (city, gender, ...). I would like to have the user input those criteria and have outputted either a new csv file with the results or be in a new tab.</p>\n\n<p>Is there a way query the csv file with pandas or SQL like statements ? Like <code>df[df[city] == 'CA']</code>.</p>\n\n<p>I would like to be able to distribute this macro and so if it is possible to do without having to install some database.</p>\n\n<p>If this is possible, how efficient/inefficient is this, as compared to installing a SQL database for example ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["vba", "excel", "subtotal"], "comments": [{"owner": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528250113, "post_id": 50710966, "comment_id": 88431375, "body": "You should edit your question down to the things that someone would need to answer your question. How many columns does the report have? What col has the target dates in question? A lot of unnecessary information here. Also, have you tried anything?"}, {"owner": {"reputation": 3, "user_id": 9900569, "user_type": "registered", "profile_image": "https://graph.facebook.com/2042013919449148/picture?type=large", "display_name": "ssue1216", "link": "https://stackoverflow.com/users/9900569/ssue1216"}, "reply_to_user": {"reputation": 13473, "user_id": 6706419, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Cp6Ow.png?s=128&g=1", "display_name": "urdearboy", "link": "https://stackoverflow.com/users/6706419/urdearboy"}, "edited": false, "score": 0, "creation_date": 1528251680, "post_id": 50710966, "comment_id": 88431680, "body": "thanks for the feedback- Spreadsheet has 16 columns the column titled &quot;week ending&quot; has the data.  example spreadsheet has  PROJECT, HOURS, CONSULTANT, WEEK ENDING.    I need all rows with the same week ending date moved to another tab so if there are 4 different values in the week ending field I end up with 4 tabs with the values on each tab."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9900569, "user_type": "registered", "profile_image": "https://graph.facebook.com/2042013919449148/picture?type=large", "display_name": "ssue1216", "link": "https://stackoverflow.com/users/9900569/ssue1216"}, "edited": false, "score": 0, "creation_date": 1528385880, "post_id": 50716458, "comment_id": 88498131, "body": "This worked perfectly! thank you!  only one question - how do I get the formatting &amp; column width of the new tabs to be the same as the source tabs?"}, {"owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "reply_to_user": {"reputation": 3, "user_id": 9900569, "user_type": "registered", "profile_image": "https://graph.facebook.com/2042013919449148/picture?type=large", "display_name": "ssue1216", "link": "https://stackoverflow.com/users/9900569/ssue1216"}, "edited": false, "score": 0, "creation_date": 1528416674, "post_id": 50716458, "comment_id": 88511266, "body": "Autofit column to fit text length."}], "tags": [], "owner": {"reputation": 254, "user_id": 9651005, "user_type": "registered", "profile_image": "https://graph.facebook.com/10156222119417368/picture?type=large", "display_name": "Lee Li Fong", "link": "https://stackoverflow.com/users/9651005/lee-li-fong"}, "is_accepted": false, "score": 0, "last_activity_date": 1528276180, "creation_date": 1528276180, "answer_id": 50716458, "question_id": 50710966, "link": "https://stackoverflow.com/questions/50710966/excel-vba-macro-to-select-data-based-on-date-and-move-it-to-a-new-tab/50716458#50716458", "title": "Excel VBA macro to select data based on date and move it to a new tab", "body": "<pre><code>Sub TransferReport()\n\n'Check each date\n For Each DateEnd In Sheet15.Columns(4).Cells    'Change Sheet15 refer to your report tab\n    If DateEnd.Value = \"\" Then Exit Sub 'Stop program if no date\n    If IsDate(DateEnd.Value) Then\n        shtName = Format(DateEnd.Value, \"dd.mm\")    'Change date to valid tab name\n\n        On Error GoTo errorhandler  'if no Date Sheet, go to errorhandler to create new tab\n        If Worksheets(shtName).Range(\"A2\").Value = \"\" Then\n           DateEnd.EntireRow.Copy Destination:=Worksheets(shtName).Range(\"A2\")\n           Worksheets(shtName).Range(\"A1:J1\").Columns.AutoFit\n        Else\n            DateEnd.EntireRow.Copy Destination:=Worksheets(shtName).Range(\"A1\").End(xlDown).Offset(1)\n        End If\n    End If\nNext\n\nExit Sub\nerrorhandler:\nSheets.Add After:=Sheets(Sheets.Count) 'Create new tab\nActiveSheet.Name = shtName  'Name tab with date\nSheet15.Rows(1).EntireRow.Copy Destination:=ActiveSheet.Rows(1) 'Copy heading to new tab\nResume\nEnd Sub\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9900569, "user_type": "registered", "profile_image": "https://graph.facebook.com/2042013919449148/picture?type=large", "display_name": "ssue1216", "link": "https://stackoverflow.com/users/9900569/ssue1216"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1295, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1528276180, "creation_date": 1528247680, "last_edit_date": 1528252164, "question_id": 50710966, "link": "https://stackoverflow.com/questions/50710966/excel-vba-macro-to-select-data-based-on-date-and-move-it-to-a-new-tab", "title": "Excel VBA macro to select data based on date and move it to a new tab", "body": "<p>I am hoping you can help me.  I'm not great at vba and your community has been a great help in the past.   I have to, on a monthly basis, run a report showing hours that are worked for my team on a a consulting project.  Screen print attached\n<a href=\"https://i.stack.imgur.com/GAuPb.png\" rel=\"nofollow noreferrer\">report</a></p>\n\n<p>there are about 1,000 rows and I  need to move rows with the same date in the week ending field to a new tab.   in the example above the result would be the data copied to two tabs with 3/23 records on one sheet and 3/30 on another.     I have found macro samples that will copy data based on input, but not that are the same and the report updates quarterly with 9 different weeks listed.   This will give me a good start </p>\n"}]